{
    "document_name": "23122-i50.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\tindicates that something is possible\ncannot\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document gives an overview of the tasks undertaken by the Core network protocols of a Mobile Station (MS) when in idle mode, that is, switched on but typically not having a dedicated channel allocated. It also describes the corresponding network functions. The idle mode functions are also performed by a GPRS MS as long as no dedicated channel is allocated to the MS. The conditions when the idle mode functions are performed by an MS in the UTRA RRC connected mode states are specified in 3GPP TS 25.331 [33]. The conditions when the idle mode functions are performed by an MS in the E-UTRAN are specified in 3GPP TS 36.304 [43]. The conditions when the idle mode functions are performed by an MS in the NG-RAN are specified in 3GPP TS 36.304 [43] and 3GPP TS 38.304 [61]. The conditions when the idle mode functions are performed by an MS in the NG-RAN RRC inactive state are specified in 3GPP TS 36.331 [42] and 3GPP TS 38.331 [65].\nThe present document defines the PLMN selection for a multi mode MS that supports both 3GPP and 3GPP2 systems. The common PLMN selection logic covers also PLMNs that are available in 3GPP2 system, but the present document makes no changes on the cdma2000® signalling towards networks that are available via 3GPP2 system.\nThe present document gives procedures for using the CSG cells, whenever such use is permitted.\nThe present document gives procedures for using the CAG cells, when the MS supports CAG.\nThe present document specifies the SNPN selection.\nThis 3GPP TS outlines how the requirements of the 22 series Technical Specifications (especially 3GPP TS 22.011 [9]) on idle mode operation shall be implemented. Further details are given in 3GPP TS 24.008 [23].\nClause 2 of this 3GPP TS gives a general description of the idle mode process. Clause 3 outlines the main requirements and technical solutions of those requirements. Clause 4 describes the processes used in idle mode. There is inevitably some overlap between these clauses.\nNOTE:\tcdma2000® is a registered trademark of the Telecommunications Industry Association (TIA-USA).\nThe present document describes the procedures for control plane solution of steering of roaming in 5GS in annex C.\nAnnex C is applicable to the MS, the AMF, the UDM and the SOR-AF in the 5GS.\nThe present document does not consider GERAN Iu mode.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "1.1\tReferences",
                    "description": "",
                    "summary": "",
                    "text_content": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\tVoid.\n[2]\tVoid.\n[3]\tVoid.\n[4]\tVoid.\n[5]\tVoid.\n[6]\tVoid.\n[7]\tVoid\n[8]\tVoid.\n[9]\t3GPP TS 22.011: \"Service accessibility\".\n[10]\tVoid.\n[11]\tVoid.\n[12]\tVoid.\n[13]\tVoid.\n[14]\tVoid.\n[15]\tVoid.\n[16]\tVoid.\n[17]\tVoid.\n[18]\tVoid.\n[19]\tVoid.\n[20]\tVoid.\n[21]\tVoid.\n[22]\tVoid.\n[22A]\t3GPP TS 23.003: \"Numbering, addressing and identification\".\n[23]\t3GPP TS 24.008: \"Mobile Radio Interface Layer 3 specification, Core Network Protocols - Stage 3\".\n[23A]\t3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet System (EPS); Stage 3\".\n[24]\t3GPP TS 45.002: \"Multiplexing and multiple access on the radio path\".\n[25]\t3GPP TS 45.008: \"Radio subsystem link control\".\n[26]\tVoid.\n[27]\t3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service description; Stage 2\".\n[27A]\t3GPP TS 23.682: \"Architecture enhancements to facilitate communications with packet data networks and applications\".\n[28]\tVoid.\n[29]\tVoid.\n[30]\tVoid.\n[31]\tVoid.\n[32]\t3GPP TS 25.304: \"UE Procedures in Idle Mode and Procedures for Cell Reselection in Connected Mode\".\n[33]\t3GPP TS 25.331: \"RRC Protocol Specification\".\n[34]\t3GPP TS 44.018:\"Mobile radio interface layer 3 specification, Radio Resource Control Protocol\".\n[35]\t3GPP TS 43.022: \"Functions related to Mobile Station (MS) in idle mode and group receive mode\".\n[35A]\t3GPP TS 43.318: \"Generic Access Network (GAN); Stage 2\".\n[35B]\t3GPP TS 44.318: \"Generic Access Network (GAN); Mobile GAN interface layer 3 specification; Stage 3\".\n[36]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[37]\tVoid.\n[38]\t3GPP TS 21.111: \"USIM and IC card requirements\".\n[39]\t3GPP TS 44.060: \"General Packet Radio Service (GPRS);Mobile Station (MS) - Base Station System (BSS) interface; Radio Link Control/Medium Access Control (RLC/MAC) protocol\".\n[40]\t3GPP TS 31.102: \"Characteristics of the USIM Application\".\n[41]\t3GPP TS 31.111: \"Universal Subscriber Identity Module (USIM), Application Toolkit (USAT)\".\n[42]\t3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA) Radio Resource Control (RRC); Protocol specification\".\n[43]\t3GPP TS 36.304: \"Evolved Universal Terrestrial Radio Access (E-UTRA); User Equipment (UE) procedures in idle mode\".\n[44]\t3GPP2 C.S0016-D v1.0: \"Over-the-Air Service Provisioning of Mobile Stations in Spread Spectrum Standards\".\n[45]\t3GPP2 C.S0011-C v2.0: \"Recommended Minimum Performance Standards for cdma2000 Spread Spectrum Mobile Stations\".\n[46]\t3GPP2 C.S0033-A v2.0: \"Recommended Minimum Performance Standards for cdma2000 High Rate Packet Data Access Terminal\".\n[47]\t3GPP TS 24.285: \"Allowed Closed Subscriber Group (CSG) List Management Object (MO)\".\n[48]\tVoid.\n[49]\t3GPP TS 22.220: \"Service requirements for Home Node B (HNB) and Home eNode B (HeNB)\".\n[50]\t3GPP TS 24.368: \"Non-Access Stratum (NAS) configuration Management Object (MO)\".\n[51]\t3GPP TS 24.334: \"Proximity-services (ProSe) User Equipment (UE) to Proximity-services (ProSe) Function Protocol aspects; Stage 3\".\n[52]\t3GPP TS 24.333: \"Proximity-services (ProSe) Management Objects (MO)\".\n[53]\t3GPP TS 24.105: \"Application specific Congestion control for Data Communication (ACDC) Management Object (MO)\".\n[54]\t3GPP TS 36.306: \"Evolved Universal Terrestrial Radio Access (E-UTRA); User Equipment (UE) radio access capabilities\".\n[55]\t3GPP TS 43.064: \"Overall description of the GPRS Radio Interface; Stage 2\".\n[56]\t3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Overall description\".\n[57]\t3GPP TS 23.167: \"IP Multimedia Subsystem (IMS) emergency sessions\".\n[58]\t3GPP TS 23.401: \"GPRS enhancements for E-UTRAN access\".\n[59]\t3GPP TS 24.386: \"User Equipment (UE) to V2X control function; protocol aspects; Stage 3\".\n[60]\t3GPP TS 24.385: \"V2X services Management Object (MO)\".\n[61]\t3GPP TS 38.304: \"NR; User Equipment (UE) procedures in Idle mode and RRC Inactive state\".\n[62]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[63]\t3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".\n[64]\t3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS); Stage 3\".\n[65]\t3GPP TS 38.331: \"NR; Radio Resource Control (RRC) protocol specification\".\n[66]\t3GPP TS 33.501: \"Security architecture and procedures for 5G System\".\n[67]\t3GPP TS 31.115: \"Secured packet structure for (Universal) Subscriber Identity Module (U)SIM Toolkit applications\".\n[68]\t3GPP TS 23.246: \"Multimedia Broadcast/Multicast Service (MBMS); Architecture and Functional Description\".\n[69]\t3GPP TS 23.221: \"Architectural requirements\".\n[70]\t3GPP TS 23.273: \"5G System (5GS) Location Services (LCS)\".\n[71]\t3GPP TS 29.544: \"5G System (5GS); Secured Packet Application Function (SP-AF) services; Stage 3\".\n[72]\t3GPP TS 29.571: \"5G System (5GS); Common Data Types for Service Based Interfaces; Stage 3\".\n[73]\tETSI TS 102 225: \"Smart Cards; Secured packet structure for UICC based applications\".\n[74]\t3GPP TS 22.261: \"Service requirements for the 5G system; Stage 1\".\n[75]\t3GPP TS 24.587: \"Vehicle-to-Everything (V2X) services in 5G System (5GS); Stage 3\".\n[76]\tITU-T Recommendation E.212: \"The international identification plan for public networks and subscriptions\".\n[77]\t3GPP TS 24.526: \"UE policies for 5G System (5GS); Stage 3\".\n[78]\t3GPP TS 29.503: \"5G System; Unified Data Management Services; Stage 3\".\n[79]\t3GPP TS 24.588: \"Vehicle-to-Everything (V2X) services in 5G System (5GS); User Equipment (UE) policies; Stage 3\".\n[80]\t3GPP TS 24.554: \" Proximity-services (ProSe) in 5G System (5GS) protocol aspects; Stage 3\".\n[81]\t3GPP TS 24.555: \"Proximity-services (ProSe) in 5G System (5GS); User Equipment (UE) policies; Stage 3\".\n[82]\t3GPP TS 29.504: \"5G System; Unified Data Repository Services; Stage 3\".\n[83]\t3GPP TS 29.505: \"5G System; Usage of the Unified Data Repository services for Subscription Data; Stage 3\".\n[84]\t3GPP TS 24.229: \"IP multimedia call control protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".\n[85]\t3GPP TS 23.247: \"Architectural enhancements for 5G multicast-broadcast services; Stage 2\".\n[86]\t3GPP TS 24.577: \"Aircraft-to-Everything (A2X) services in 5G System (5GS) protocol aspects; Stage 3\".\n[87]\t3GPP TS 24.578: \"Aircraft-to-Everything (A2X) services in 5G System (5GS); UE policies; Stage 3\".\n[88]\t3GPP TS 29.550: \"5G System; Steering of roaming application function services; Stage 3\".\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "1.2\tDefinitions and abbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations defined in 3GPP TR 21.905 [36] apply.\n(A/Gb mode only): Indicates this clause applies only to a GSM system which operates in A/Gb mode. For multi system case this is determined by the current serving radio access network.\n(Iu mode only): Indicates this clause applies only to UMTS. For multi system case this is determined by the current serving radio access network.\nNOTE 1:\tIn accordance with the description of packet services in Iu mode in 3GPPS TS 24.008 [23], the terms 'CS/PS mode of operation' and 'PS mode of operation' are not used in the present document. Instead the terms 'MS operation mode A' and 'MS operation mode C' are used.\n(S1 mode only): Indicates this clause applies only to an EPS. For multi system case this is determined by the current serving radio access network.\nAcceptable Cell: This is a cell that the MS may camp on to make emergency calls or to access RLOS. It must satisfy criteria which are defined for A/Gb mode in 3GPP TS 43.022 [35], for Iu mode in 3GPP TS 25.304 [32], for S1 mode in 3GPP TS 36.304 [43], and for NR access in N1 mode in 3GPP TS 38.304 [61] and for E-UTRA access in N1 mode in 3GPP TS 36.304 [43]. For an MS in eCall only mode, an acceptable cell must further satisfy the criteria defined in clause 4.4.3.1.1.\nAccess Technology: The access technology associated with a PLMN or SNPN. The MS uses this information to determine what type(s) of radio carrier to search for when attempting to select a specific PLMN or SNPN The following access technologies are defined: GSM, UTRAN, GSM COMPACT, EC-GSM-IoT, cdma2000 1xRTT, cdma2000 HRPD, E-UTRAN (WB-S1 mode and NB-S1 mode), NG-RAN, satellite NG-RAN and satellite E-UTRAN (WB-S1 mode and NB-S1 mode). A PLMN may support more than one access technology. SNPNs only support NG-RAN.\nNOTE 2:\tAccess technology \"E-UTRAN\" maps to core network type \"EPC\" and access technology \"NG-RAN\" maps to core network type \"5GCN\", see 3GPP TS 24.501 [64].\nACDC: Application specific Congestion control for Data Communication, see 3GPP TS 22.011 [9].\nAllowable PLMN: In the case of an MS operating in MS operation mode A or B, this is a PLMN which is not in the list of \"forbidden PLMNs\" in the MS. In the case of an MS operating in MS operation mode C or an MS not supporting A/Gb mode and not supporting Iu mode, this is a PLMN which is not in the list of \"forbidden PLMNs\" and not in the list of \"forbidden PLMNs for GPRS service\" in the MS.\nAllowable SNPN: In the case of an MS operating in SNPN access operation mode over 3GPP access and for an SNPN candidate which is not an SNPN selected for localized services in SNPN, this is an SNPN which is not in the list of \"permanently forbidden SNPNs\" which is, if the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, and is not in the list of \"temporarily forbidden SNPNs\" which is, if the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription. In the case of an MS operating in SNPN access mode and for an SNPN candidate which is an SNPN selected for localized services in SNPN, this is an SNPN which is not in the list of \"permanently forbidden SNPNs for access for localized services in SNPN\" which is associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, and is not in the list of \"temporarily forbidden SNPNs for access for localized services in SNPN\" which is associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription.\nAllowable PLMN/access technology combination: For an MS operating in MS operation mode C or an MS not supporting A/Gb mode and not supporting Iu mode, this is an allowable PLMN in any specific access technology. For an MS operating in MS operation mode A or B, this is a PLMN/access technology combination where:\n-\tthe PLMN is an allowable PLMN and the specific access technology is supporting non-GPRS services; or\n-\tthe PLMN is not in the list of \"forbidden PLMNs\" and not in the list of \"forbidden PLMNs for GPRS service\" in the MS and the specific access technology is only supporting GPRS services.\nEXAMPLE:\tE-UTRAN, satellite E-UTRAN, satellite NG-RAN (see 3GPP TS 22.261 [74]) and NG-RAN are access technologies that are only supporting GPRS services.\nAvailable PLMN: For GERAN A/Gb mode see 3GPP TS 43.022 [35]. For UTRAN see 3GPP TS 25.304 [32]. For E-UTRAN see 3GPP TS 36.304 [43]. For satellite E-UTRAN see 3GPP TS 36.304 [43]. For NG-RAN see 3GPP TS 36.304 [43] and 3GPP TS 38.304 [61]. For satellite NG-RAN, see 3GPP TS 38.304 [61]. For cdma2000® 1xRTT and cdma2000® HRPD see 3GPP2 C.S0016 [44].\nAvailable SNPN: For NG-RAN see 3GPP TS 38.304 [61].\nAvailable PLMN/access technology combination: This is an available PLMN in a specific access technology.\nCAG-ID authorized based on \"Allowed CAG list\": A CAG-ID in an \"Allowed CAG list\", without a time validity information, or with a time validity information with at least one time period matching UE's current time.\nCamped on a cell: The MS (ME if there is no SIM) has completed the cell selection/reselection process and has chosen a cell from which it plans to receive all available services. Note that the services may be limited, and that the PLMN or the SNPN may not be aware of the existence of the MS (ME) within the chosen cell.\nCountry: A country is identified by a single MCC value defined in ITU-T recommendation E.212 [76], with the exception of the following MCC ranges that identify a single country:\n-\tvalues 310 through 316 (USA);\n-\tvalues 404 through 406 (India);\n-\tvalues 440 through 441 (Japan);\n-\tvalues 460 through 461 (China); and\n-\tvalues 234 through 235 (United Kingdom).\nPermitted CSG list: See 3GPP TS 36.304 [43].\nCurrent serving cell: This is the cell on which the MS is camped.\nCTS MS: An MS capable of CTS services is a CTS MS.\nDiscontinuous coverage: Deployment option for satellite E-UTRAN access, in which shorter periods of satellite E-UTRAN access radio coverage are followed by longer periods of satellite E-UTRAN access coverage gaps. During coverage gaps, the access stratum may be deactivated. For more details see 3GPP TS 23.401 [58] and 3GPP TS 36.304 [43].\nEAB: Extended Access Barring, see 3GPP TS 22.011 [9].\nExtended Coverage in GSM for Internet of Things (EC-GSM-IoT): Extended coverage in GSM for IoT is a feature which enables extended coverage operation. See 3GPP TS 43.064 [55].\nEHPLMN: Any of the PLMN entries contained in the Equivalent HPLMN list.\nEquivalent HPLMN list: To allow provision for multiple HPLMN codes, PLMN codes that are present within this list shall replace the HPLMN code derived from the IMSI for PLMN selection purposes. This list is stored on the USIM and is known as the EHPLMN list. The EHPLMN list may also contain the HPLMN code derived from the IMSI. If the HPLMN code derived from the IMSI is not present in the EHPLMN list then it shall be treated as a Visited PLMN for PLMN selection purposes.\nGeneric Access Network (GAN): See 3GPP TS 43.318 [35A].\nGAN mode: See 3GPP TS 43.318 [35A].\nGPRS MS: An MS capable of GPRS services is a GPRS MS.\nMS operation mode: See 3GPP TS 23.060 [27].\nHigh quality signal: The high quality signal limit is used in the PLMN selection procedure. It is defined in the appropriate AS specification: 3GPP TS 43.022 [35] for the GSM radio access technology, 3GPP TS 25.304 [32] for the UMTS radio access technology (FDD or TDD mode), 3GPP TS 36.304 [43] for the E-UTRAN radio access technology (WB-S1 mode, NB-S1 mode, WB-N1 mode or NB-N1 mode), 3GPP TS 36.304 [43] and 3GPP TS 38.304 [61] for the NG-RAN radio access technology. For 3GPP2 access technologies the high quality signal limit is defined in 3GPP2 C.S0011 [45] for cdma2000® 1xRTT and in 3GPP2 C.S0033 [46] for cdma2000® HRPD. A mobile station attempting to find a cell that supports EC-GSM-IoT (see 3GPP TS 43.064 [55]) does not use high quality signal limit in the PLMN selection procedure, i.e. for the purpose of PLMN selection, when attempting to find a cell that supports EC-GSM-IoT, any found cell supporting EC-GSM-IoT is considered to be received with high quality signal. A UE attempting to find a cell that supports enhanced coverage when operating in any WB-S1 or WB-N1 enhanced coverage mode does not use high quality signal limit in the PLMN selection procedure, i.e. for the purpose of PLMN selection, when attempting to find a cell that supports enhanced coverage, any found cell supporting enhanced coverage and satisfying the coverage specific quality signal limit defined for CE mode (see 3GPP TS 36.304 [43]) is considered to be received with high quality signal.\nHome PLMN: This is a PLMN where the MCC and MNC of the PLMN identity match the MCC and MNC of the IMSI. Matching criteria are defined in Annex A.\nIn A/Gb mode: Indicates this clause applies only to a GSM system which operates in A/Gb mode. For multi system case this is determined by the current serving radio access network.\nIn Iu mode: Indicates this clause applies only to UMTS. For multi system case this is determined by the current serving radio access network.\nIn N1 mode: Indicates this clause applies only to an 5GS. For multi system case this is determined by the current serving radio access network.\nIn NB-N1 mode: Indicates this paragraph applies only to a system which operates in NB-N1 mode. For a multi-access system this case applies if the current serving radio access network provides access to 5G network services via E-UTRA connected to 5GCN by NB-IoT (see 3GPP TS 36.300 [56], 3GPP TS 36.331 [42], 3GPP TS 36.306 [54]).\nIn WB-N1 mode: Indicates this paragraph applies only to a system which operates in WB-N1 mode. For a multi-access system this case applies if the system operates in N1 mode with E-UTRA connected to 5GCN, but not in NB-N1 mode.\nIn S1 mode: Indicates this clause applies only to an EPS. The S1 mode includes WB-S1 mode and NB-S1 mode. For multi system case this is determined by the current serving radio access network.\nIn NB-S1 mode: Indicates this paragraph applies only to a system which operates in NB-S1 mode. For a multi-access system this case applies if the current serving radio access network provides access to network services via E-UTRA by NB-IoT (see 3GPP TS 36.300 [56], 3GPP TS 36.331 [22], 3GPP TS 36.306 [54]).\nIn WB-S1 mode: Indicates this paragraph applies only to a system which operates in WB-S1 mode. For a multi-access system this case applies if the system operates in S1 mode, but not in NB-S1 mode.\nLimited Service State: See clause 3.5.\nLocalised Service Area (LSA): A localised service area consists of a cell or a number of cells. The cells constituting a LSA may not necessarily provide contiguous coverage.\nLocalized services in NPN: Localized services in NPN are services, which are provided by an NPN at specific or limited area, are bounded in time, or both.\nLocalized services in SNPN: Localized services in SNPN are localized services in NPN, which are provided by an SNPN at specific or limited area, are bounded in time, or both.\nLocation Registration (LR): An MS which is IMSI attached to non-GPRS services only performs location registration by the location updating procedure. A GPRS MS which is IMSI attached to GPRS services or to GPRS and non-GPRS services performs location registration by the routing area update procedure only when in a network of network operation mode I. Both location updating and routing area update procedures are performed independently by the GPRS MS when it is IMSI attached to GPRS and non-GPRS services in a network of network operation mode II (see 3GPP TS 23.060 [27]). An MS which is attached via the E-UTRAN performs location registration by the tracking area update procedure. An MS which is registered via the NG-RAN performs location registration by the registration procedure for mobility and periodic registration update (see 3GPP TS 24.501 [64]).\nMINT: Minimization of service interruption (see 3GPP TS 22.261 [71]).\nMS: Mobile Station. The present document makes no distinction between MS and UE.\nN1 mode capability: Capability of the UE associated with an N1 NAS signalling connection between the UE and network. The present document refers to the N1 mode capability over 3GPP access only (see 3GPP TS 24.501 [64]).\nNarrowBand Internet of Things (NB-IoT): NB-IoT is a non-backward compatible variant of E-UTRAN supporting a reduced set of functionality. NB-IoT allows access to EPC or 5GCN network services via E-UTRA with a channel bandwidth limited to 180 kHz (see 3GPP TS 36.300 [20], 3GPP TS 36.331 [42], 3GPP TS 36.306 [44]).\nNetwork Type: The network type associated with HPLMN or a PLMN on the PLMN selector (see 3GPP TS 31.102 [40]). The MS uses this information to determine what type of radio carrier to search for when attempting to select a specific PLMN. A PLMN may support more than one network type.\nOnboarding services in SNPN: Onboarding services in SNPN allow an MS to access an SNPN indicating that onboarding is allowed, using default UE credentials for primary authentication in order for the MS to be configured with one or more entries of the \"list of subscriber data\".\nNOTE 3:\tWhen the MS is registered for onboarding services in SNPN, services other than the onboarding services in SNPN are not available. When the MS is not registered for onboarding services in SNPN, onboarding services in SNPN are not available.\nMS determined PLMN with disaster condition: A PLMN to which a disaster condition applies, determined as described in clause 4.4.3.1.1.\nRegistered PLMN (RPLMN): This is the PLMN on which certain LR outcomes have occurred (see table 1). In a shared network the RPLMN is the PLMN defined by the PLMN identity of the CN operator that has accepted the LR.\nRegistered SNPN (RSNPN): This is the SNPN on which certain LR outcomes have occurred. In a shared network the RSNPN is the SNPN defined by the SNPN identity of the CN operator that has accepted the LR.\nRegistration: This is the process of camping on a cell of the PLMN or the SNPN and doing any necessary LRs.\nRegistration Area: A registration area is an area in which mobile stations may roam without a need to perform location registration. The registration area corresponds to location area (LA) for performing location updating procedure, to routing area for performing the GPRS attach or routing area update procedures, and to a list of tracking areas (TAs) for performing the EPS attach, tracking area update, or 5GS registration procedure.\nThe PLMN to which a cell belongs (PLMN identity):\n-\tfor GERAN, in the system information (MCC + MNC part of LAI) broadcast as specified in 3GPP TS 44.018 [34];\n-\tfor UTRA, see the broadcast information as specified in 3GPP TS 25.331 [33];\n-\tfor E-UTRA, see the broadcast information as specified in 3GPP TS 36.331 [42]; and\n-\tfor NR, see the broadcast information as specified in 3GPP TS 38.331 [65].\nThe SNPN to which a cell belongs (SNPN identity):\n-\tfor NR, see the broadcast information as specified in 3GPP TS 38.331 [65].\nIn a shared network, a cell belongs to all PLMNs given in the system information broadcasted as specified in 3GPP TS 44.018 [34] for GERAN, in 3GPP TS 25.331 [33] for UTRAN, and in 3GPP TS 36.331 [42] for E-UTRAN, and a cell belongs to all PLMNs, all SNPNs, or all PLMNs and all SNPNs, given in the system information broadcasted as specified in 3GPP TS 36.331 [42] for E-UTRA connected to 5GCN, and in 3GPP TS 38.331 [65] for NR.\nSecured packet: In this specification, a secured packet contains one or more of the following:\n-\tlist of preferred PLMN/access technology combinations;\n-\tSOR-CMCI; and\n-\tSOR-SENSE\nencapsulated with a security mechanism as described in 3GPP TS 31.115 [67].\nSelected PLMN: This is the PLMN that has been selected according to clause 3.1, either manually or automatically.\nSelected SNPN: This is the SNPN that has been selected according to clause 3.9, either manually or automatically.\nShared MCC: MCC assigned by ITU-T as shared MCC according to ITU-T E.212 [76], except within this specification for PLMN selection purposes the MCC of value 999 is not considered a shared MCC.\nShared Network: An MS considers a cell to be part of a shared network, when multiple PLMN identities are received as specified in 3GPP TS 44.018 [34] for GERAN, in 3GPP TS 25.331 [33] for UTRAN, and in 3GPP TS 36.331 [42] for E-UTRAN, and when multiple PLMN identities, multiple SNPN identities or one or more PLMN identities and one or more SNPN identities are received as specified in 3GPP TS 36.331 [42] for E-UTRA connected to 5GCN, and in 3GPP TS 38.331 [65] for NR.\nSIM: Subscriber Identity Module (see 3GPP TS 21.111 [38]). The present document makes no distinction between SIM and USIM.\nSNPN identity: a PLMN ID and an NID combination.\nSoLSA exclusive access: Cells on which normal camping is allowed only for MS with Localised Service Area (LSA) subscription.\nSteering of Roaming (SOR): A technique whereby a roaming UE is encouraged to roam to a preferred roamed-to-network indicated by the HPLMN.\nSteering of Roaming application function (SOR-AF): An application function that can provide UDM with one of the following:\na)\tone or more of the following:\n-\tlist of preferred PLMN/access technology combinations;\n-\tSOR-CMCI, together with the \"Store SOR-CMCI in ME\" indicator if applicable;\n-\tSOR-SNPN-SI; and\n-\tSOR-SNPN-SI-LS;\nb)\ta secured packet, together with the indicator, if applicable, that \"the list of preferred PLMN/access technology combinations is not included in the secured packet\"; or\nc)\tneither of a) or b),\ngenerated dynamically based on operator specific data analytics solutions.\nSteering of roaming connected mode control information (SOR-CMCI): HPLMN information to control the timing for a UE in connected mode to move to idle mode in order to perform steering of roaming.\nSteering of roaming operator controlled signal threshold per access technology information (SOR-SENSE): Home operator’s provision of \"Operator controlled signal threshold per access technology\" for signal level enhance network selection (SENSE). This information is the EFOCST file provided in the secured packet by network.\nSteering of Roaming information: This consists of the following HPLMN or subscribed SNPN protected information (see 3GPP TS 33.501 [66]):\na)\tthe following indicators, of whether:\n-\tthe UDM requests an acknowledgement from the UE for successful reception of the steering of roaming information.\n-\tthe UDM requests the UE to store the SOR-CMCI in the ME, which is provided along with the SOR-CMCI in plain text; and\nb)\tone of the following:\n1)\tone or more of the following:\n-\tlist of preferred PLMN/access technology combinations with an indication that it is included;\n-\tSOR-CMCI;\n-\tSOR-SNPN-SI; and\n-\tSOR-SNPN-SI-LS;\n2)\ta secured packet with an indication that it is included;\n3)\tthe HPLMN indication that 'no change of the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the UE is needed and thus no list of preferred PLMN/access technology combinations is provided'; or\n4)\tthe subscribed SNPN or HPLMN indication that 'no change of the SOR-SNPN-SI stored in the UE is needed and thus no SOR-SNPN-SI is provided'.\nSteering of roaming SNPN selection information (SOR-SNPN-SI): Provisioning information for SNPN selection consisting of:\na)\tthe credentials holder controlled prioritized list of preferred SNPNs;\nb)\tthe credentials holder controlled prioritized list of GINs; or\nc)\tboth of the above.\nSteering of roaming SNPN selection information for localized services in SNPN (SOR-SNPN-SI-LS): Provisioning information for SNPN selection by an MS supporting access to an SNPN providing access for localized services in SNPN consisting of:\na)\ta \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\", where each entry contains:\n1)\tan SNPN identity;\n2)\ta validity information consisting of time validity information and optionally, location validity information; and\n3)\t optionally, location assistance information;\nb)\ta \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\", where each entry contains:\n1)\ta GIN;\n2)\t a validity information consisting of time validity information and optionally, location validity information; and\n3)\toptionally, location assistance information; or\nc)\tboth of the above.\nSubscribed SNPN: An SNPN for which the UE has a subscription.\nSuitable Cell: This is a cell on which an MS may camp. It must satisfy criteria which are defined for GERAN A/Gb mode in 3GPP TS 43.022 [35], for UTRAN in 3GPP TS 25.304 [32], for E-UTRAN in 3GPP TS 36.304 [43] and for NG-RAN see 3GPP TS 36.304 [43] and 3GPP TS 38.304 [61]. For 3GPP2 access technologies the criteria are defined in 3GPP2 C.S0011 [45] for cdma2000® 1xRTT and in 3GPP2 C.S0033 [46] for cdma2000® HRPD. For an MS in eCall only mode, a suitable cell must further satisfy the criteria defined in clause 4.4.3.1.1.\nVisited PLMN: This is a PLMN different from the HPLMN (if the EHPLMN list is not present or is empty) or different from an EHPLMN (if the EHPLMN list is present).\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.167 [57] apply:\neCall over IMS\nEPC\nE-UTRAN\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.401 [58] apply:\neCall only mode\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.221 [69] apply:\nRestricted local operator services (RLOS)\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.501 [62] apply:\nClosed Access Group (CAG)\nCredentials holder\nGroup ID for Network Selection (GIN)\nNetwork identifier (NID)\nNG-RAN\nNR RedCap\nStand-alone Non-Public Network (SNPN)\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 24.501 [64] apply:\n5GCN\nCAG cell\nEmergency PDU session\nInitial registration for emergency services\nInitial registration for onboarding services in SNPN\nNon-CAG cell\nNSSAI\nRegistered for emergency services\nRegistered for onboarding services in SNPN\nSNPN access operation mode\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 22.261 [74] apply:\nDisaster condition\nDisaster roaming\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 33.501 [66] apply:\nDefault UE credentials for primary authentication\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 24.229 [84] apply:\nIMS registration related signalling\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "2\tGeneral description of idle mode",
            "description": "When an MS is switched on, it attempts to make contact with a public land mobile network (PLMN) or stand-alone non-public network (SNPN). The particular PLMN or SNPN to be contacted may be selected either automatically or manually.\nThe MS looks for a suitable cell of the chosen PLMN or SNPN and chooses that cell to provide available services, and tunes to its control channel. This choosing is known as \"camping on the cell\". The MS will then register its presence in the registration area of the chosen cell if necessary, by means of a location registration (LR), GPRS attach, IMSI attach or registration procedure.\nIf the MS loses coverage of a cell, or find a more suitable cell, it reselects onto the most suitable cell of the selected PLMN or SNPN and camps on that cell. If the new cell is in a different registration area, an LR request is performed.\nIf the MS loses coverage of a PLMN or SNPN, either a new PLMN or SNPN is selected automatically, or an indication of which PLMNs or SNPNs are available is given to the user, so that a manual selection can be made.\nRegistration is not performed by MSs only capable of services that need no registration.\nThe purpose of camping on a cell in idle mode is fourfold:\na)\tIt enables the MS to receive system information from the PLMN or SNPN.\nb)\tIf the MS wishes to initiate a call, it can do this by initially accessing the network on the control channel of the cell on which it is camped.\nc)\tIf the PLMN or SNPN receives a call for the MS, it knows (in most cases) the registration area of the cell in which the MS is camped. It can then send a \"paging\" message for the MS on control channels of all the cells in the registration area. The MS will then receive the paging message because it is tuned to the control channel of a cell in that registration area, and the MS can respond on that control channel.\nd)\tIt enables the MS to receive cell broadcast messages.\nIf the MS is unable to find a suitable cell to camp on, or the SIM is not inserted, or there is no valid entry in \"list of subscriber data\" in case the MS is operating in SNPN access operation mode over 3GPP access, or if it receives certain responses to an LR request (e.g., \"illegal MS\"), it attempts to camp on a cell irrespective of the PLMN identity or the SNPN identity, and enters a \"limited service\" state in which it can only attempt to make emergency calls or to access RLOS. An MS operating in NB-S1 mode, never attempts to make emergency calls or to access RLOS. An MS operating in N1 mode never attempts to access RLOS.\nIf the MS is in eCall only mode, it attempts to camp on a suitable cell and enters an \"eCall inactive\" state in which it can only attempt an eCall over IMS, or a call to a non-emergency MSISDN or URI for test or terminal reconfiguration services as specified in 3GPP TS 31.102 [40].\nIf the MS is in eCall only mode and is unable to find a suitable cell to camp on, it attempts to camp on an acceptable cell in limited service state, and enters an \"eCall inactive\" state in which it can only attempt an eCall over IMS.\nWhile in eCall inactive state, the MS does not perform LR with the PLMN of the cell on which the MS is camped.\nIn A/Gb mode, if the CTS MS is in CTS mode only or in automatic mode with CTS preferred, it will start by attempting to find a CTS fixed part on which it is enrolled.\nThe idle mode tasks can be subdivided into the following processes:\n-\tPLMN selection;\n-\tSNPN selection (N1 mode only);\n-\tCSG selection (Iu mode and S1 mode only);\n-\tCell selection and reselection;\n-\tLocation registration;\n-\tCTS fixed part selection (A/Gb mode only); and\n-\tCAG selection (N1 mode only).\nIn A/Gb mode, to make this initial CTS fixed part selection, the MS shall be enrolled on at least one fixed part.\nExcept for SNPN selection, the relationship between these processes is illustrated in figure 1 in clause 5. The states and state transitions within each process are shown in figure 2a, figure 2b, and figure 3 in clause 5.\nIn the present document, EMM-IDLE mode with suspend indication (see 3GPP TS 24.301 [23A]) and 5GMM-IDLE mode with suspend indication (see 3GPP TS 24.501 [64]) shall be considered the same as idle mode.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tRequirements and technical solutions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.0\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The following clauses list the main requirements of idle mode operation and give an outline of the technical solution.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.1\tPLMN selection and roaming",
                    "description": "",
                    "summary": "",
                    "text_content": "The MS normally operates on its home PLMN (HPLMN) or equivalent home PLMN (EHPLMN). However, a visited PLMN (VPLMN) may be selected, e.g., if the MS loses coverage. There are two modes for PLMN selection:\ni)\tAutomatic mode - This mode utilizes a list of PLMN/access technology combinations in priority order. The highest priority PLMN/access technology combination which is available and allowable is selected.\nii)\tManual mode - Here the MS indicates to the user which PLMNs are available. Only when the user makes a manual selection does the MS try to obtain normal service on the VPLMN.\nTo prevent repeated attempts to have roaming service on a not allowed area (i.e. LA or TA), when the MS is informed that an area is forbidden, the LA or TA is added to a list of \"forbidden location areas for roaming\" or \"forbidden tracking areas for roaming\" respectively which is stored in the MS. These lists, if existing, are deleted when the MS is switched off or when the SIM is removed, and periodically (with period in the range 12 to 24 hours). LA area restrictions are always valid for complete location areas independent of possible subdivision into GPRS routing areas. The structure of the routing area identifier (see 3GPP TS 23.003 [22A]) supports area restriction on LA basis.\nTo prevent repeated attempts to obtain service on a PLMN through satellite NG-RAN or satellite E-UTRAN access technology, when the MS receives an integrity protected reject message with cause value #78 \"PLMNs not allowed to operate at the present UE location\" from a satellite NG-RAN cell or a satellite E-UTRAN cell, the MS maintains a list of \"PLMNs not allowed to operate at the present UE location\" in which it stores the PLMN ID of the rejecting PLMN, the current geographical location, if known by the MS. A timer is started when the PLMN ID of the rejecting PLMN is added to the list of \"PLMNs not allowed to operate at the present UE location\". If the geographical location exists, a MS implementation specific distance value needs to be stored. An entry in the list is deleted if the timer associated to the entry expires or the MS successfully registers to the PLMN stored in the entry. An entry in the list may be deleted if the current UE location is known, a geographical location is stored for the entry of this PLMN, and the distance to the current UE location is larger than a UE implementation specific value. For details see 3GPP TS 24.501 [64] and 3GPP TS 24.301 [23A].\nNOTE 1:\tThe list of \"PLMNs not allowed to operate at the present UE location\" is provided to the AS, see 3GPP TS 38.304 [61].\nIn automatic PLMN selection mode, if the MS detects a PLMN in satellite NG-RAN access technology which is part of the list of \"PLMNs not allowed to operate at the present UE location\" the MS shall consider the PLMN as PLMN selection candidate for satellite NG-RAN access technology only if the current MS location is known, a geographical location is stored for the entry of this PLMN, and the distance to the current MS location is larger than a MS implementation specific value.\nThis does not prevent selection of such a PLMN if it is available in another RAT.\nA timer is started when the PLMN ID of the rejecting PLMN is added to the list of \"PLMNs not allowed to operate at the present UE location\".\nIn automatic PLMN selection mode, if the MS detects a PLMN in satellite E-UTRAN access technology which is part of the list of \"PLMNs not allowed to operate at the present UE location\" the MS shall consider the PLMN as PLMN selection candidate for satellite E-UTRAN access technology only if the current MS location is known, a geographical location is stored for the entry of this PLMN, and the distance to the current UE location is larger than a UE implementation specific value.\nThis does not prevent selection of such a PLMN if it is available in another RAT.\nIf a message with cause value #15 (see 3GPP TS 24.008 [23], 3GPP TS 24.301 [23A] and 3GPP TS 24.501 [64]) is received by an MS, then the MS shall take the following actions depending on the mode in which the message was received:\nA/Gb mode or Iu mode:\nThe location area is added to the list of \"forbidden location areas for roaming\" which is stored in the MS. The MS shall then search for a suitable cell in the same PLMN but belonging to an LA or TA which is not in the \"forbidden location areas for roaming\" or \"forbidden tracking areas for roaming\" list respectively.\nS1-mode:\nThe tracking area is added to the list of \"forbidden tracking areas for roaming\" which is stored in the MS. The MS shall then search for a suitable cell in the same PLMN but belonging to a TA or LA which is not in the \"forbidden tracking areas for roaming\" or \"forbidden location areas for roaming\" list respectively\nN1-mode:\nThe tracking area is added to the list of \"5GS forbidden tracking areas for roaming\" which is stored in the MS. The MS shall then search for a suitable cell in the same PLMN but belonging to a tracking area which is not in the \"5GS forbidden tracking areas for roaming\" list.\nIn manual or automatic mode, a VPLMN is added to a list of \"forbidden PLMNs\" in the SIM if a message with cause value \"PLMN not allowed\" or \"Requested service option not authorized in this PLMN\" or \"Serving network not authorized\" is received by an MS in response to an LR request from that VPLMN and:\n-\tthe MS is configured to use timer T3245 as defined in 3GPP TS 24.008 [23], 3GPP TS 24.301 [23A], and 3GPP TS 24.501 [64];\n-\tthe MS is not configured to use timer T3245 and the message is integrity-protected;\n-\tthe MS is not configured to use timer T3245, the message is not integrity-protected and the MS does not maintain a list of PLMN-specific attempt counters; or\n-\tthe MS is not configured to use timer T3245, the message is not integrity-protected, the MS maintains a list of PLMN-specific attempt counters and the value of the PLMN-specific attempt counter for that VPLMN is equal to the MS implementation specific maximum value as defined in 3GPP TS 24.008 [23], 3GPP TS 24.301 [23A] and 3GPP TS 24.501 [64].\nIf:\n-\tafter a subsequent manual selection of that PLMN, there is a successful LR not for disaster roaming services, then the PLMN is removed from the \"forbidden PLMNs\" list;\n-\tthe MS is configured to use timer T3245 and the timer T3245 expires, then the PLMN is removed from the \"forbidden PLMNs\" list ; or\n-\tthe MS is not configured to use timer T3245 and:\n1)\tthe MS maintains a list of PLMN-specific attempt counters, the value of the PLMN-specific attempt counter for that PLMN is greater than zero and less than the MS implementation specific maximum value, and timer T3247 expires, then the PLMN is removed from the \"forbidden PLMNs\" list stored in memory as defined in 3GPP TS 24.301 [23A] and 3GPP TS 24.501 [64]; or\n2)\tthe MS does not maintain a list of PLMN-specific attempt counters, the PLMN is stored in the \"forbidden PLMNs\" list in the SIM, and the timer T3247 expires, then the PLMN is removed from the \"forbidden PLMNs\" list in the SIM as defined in 3GPP TS 24.301 [23A].\nThis list is retained when the MS is switched off or the SIM is removed. The HPLMN (if the EHPLMN list is not present or is empty) or an EHPLMN (if the EHPLMN list is present) shall not be stored on the list of \"forbidden PLMNs\".\nIn A/Gb mode, an ME not supporting SoLSA may consider a cell with the escape PLMN code (see 3GPP TS 23.073) to be a part of a PLMN belonging to the list of \"forbidden PLMNs\".\nOptionally the ME may store in its memory an extension of the \"forbidden PLMNs\" list. The contents of the extension of the list shall be deleted when the MS is switched off or the SIM is removed.\nA VPLMN may be stored in the extension of the \"forbidden PLMNs\" list if a message with cause value \"PLMN not allowed\" or \"Requested service option not authorized in this PLMN\" or \"Serving network not authorized\" is received by an MS in response to an LR request from that VPLMN, and the following is valid:\n-\tthe MS is not configured to use timer T3245, the message is not integrity-protected, the MS maintains a list of PLMN-specific attempt counters and the value of the PLMN-specific attempt counter for that VPLMN is less than an MS implementation specific maximum value as defined in 3GPP TS 24.008 [23], 3GPP TS 24.301 [23A] and 3GPP TS 24.501 [64].\nIn manual or automatic mode, if a message with cause value \"GPRS services not allowed in this PLMN\" or \"EPS services not allowed in this PLMN\" is received by an MS in response to an GPRS attach, routing area update, EPS attach or tracking area update request or received in a network initiated GPRS detach or EPS detach request (see 3GPP TS 24.008 [23] and 3GPP TS 24.301 [23A]) from a VPLMN, that VPLMN is added to a list of \"forbidden PLMNs for GPRS service\" which is stored in the MS. This list is deleted when the MS is switched off or when the SIM is removed. A PLMN is removed from the list of \"forbidden PLMNs for GPRS service\" if:\n-\tafter a subsequent manual selection of that PLMN, there is a successful GPRS attach, routing area update, EPS attach, tracking area update or registration procedure (see 3GPP TS 24.501 [64]);\n-\tthe MS is configured to use timer T3245 and timer T3245 expires; or\n-\tthe MS is not configured to use timer T3245, the MS maintains a list of PLMN-specific PS-attempt counters as specified in 3GPP TS 24.008 [23] and 3GPP TS 24.301 [23A], the value of the PLMN-specific PS-attempt counter for that PLMN has a value greater than zero and less than the MS implementation-specific maximum value as defined in clause 5.3.7b in 3GPP TS 24.301 [23A], and T3247 expires.\nThe maximum number of possible entries in this list is implementation dependant, but must be at least one entry. The HPLMN (if the EHPLMN list is not present or is empty) or an EHPLMN (if the EHPLMN list is present) shall not be stored on the list of \"forbidden PLMNs for GPRS service\".\nAn MS that is attaching for emergency bearer services or for access to RLOS, or is attached for emergency bearer services or for access to RLOS, may access PLMNs in the list of \"forbidden PLMNs\" or the list of \"forbidden PLMNs for GPRS service\". The MS shall not remove any entry from the list of \"forbidden PLMNs\" or the list of \"forbidden PLMNs for GPRS service\" as a result of such accesses.\nAn MS that is registered for disaster roaming services, may access PLMNs in the list of \"forbidden PLMNs\" or the list of \"forbidden PLMNs for GPRS service\" following the criteria as specified in clause 4.4.3.1.1 and shall not remove any entry from the list of \"forbidden PLMNs\" or the list of \"forbidden PLMNs for GPRS service\" as a result of such accesses.\nA UE capable of S101 mode maintains a list \"forbidden PLMNs for attach in S101 mode\"; the properties and handling in NAS signalling is defined in clause 5.3.3 of 3GPP TS 24.301 [23A].\nIf the MS is in GAN mode and a \"Location not allowed\" message is received (see 3GPP TS 44.318 [35B]), then the MS may attempt to select another PLMN so that further GAN registrations may again be attempted. The selection of the PLMN either automatically or manually is implementation dependent.\nIf an MS that has disabled its E-UTRA capability re-enables it when PLMN selection is performed, then the MS of which usage setting is \"voice centric\":\n-\tshould, for duration of timer TD, memorize the PLMNs where E-UTRA capability was disabled as PLMNs where voice service was not possible in E-UTRAN. The number of PLMNs where voice service was not possible in E-UTRAN that the MS can store is implementation specific, but it shall be at least one. The value of timer TD is MS implementation specific, but shall not exceed the maximum possible value of background scanning timer T as specified in clause 4.4.3.3.1.\n-\tin automatic PLMN selection, shall not consider PLMNs where voice service was not possible in E-UTRAN as PLMN selection candidates for E-UTRA access technology, unless no other PLMN is available. This does not prevent selection of such a PLMN if it is available in another RAT; and\n-\tshall delete stored information on PLMNs where voice service was not possible in E-UTRAN when the MS is switched off, the USIM is removed, timer TD expires or MS voice domain configuration changes so that E-UTRA capability disabling is no longer necessary.\nThe MS may support \"E-UTRA Disabling for EMM cause #15\" as specified in 3GPP TS 24.301 [23A]. If the MS supports \"E-UTRA Disabling for EMM cause #15\" and the \"E-UTRA Disabling Allowed for EMM cause #15\" parameter as specified in 3GPP TS 24.368 [50] or 3GPP TS 31.102 [40] is present and set to enabled:\n-\tthe MS shall maintain a list of \"PLMNs with E-UTRAN not allowed\";\n-\twhen the MS disables its E-UTRA capability on a PLMN due to E-UTRAN not allowed, it shall add the PLMN to the \"PLMNs with E-UTRAN not allowed\" list, and start timer TE if timer TE is not already running;\n-\tthe number of PLMNs that the MS can store in the \"PLMNs with E-UTRAN not allowed\" list is implementation specific, but it shall be at least one;\n-\tthe value of timer TE is MS implementation specific, but it shall not exceed the maximum possible value of background scanning timer T (8 hours or 240 hours for MSs supporting EC-GSM-IoT, Category M1 or Category NB1 as defined in 3GPP TS 36.306 [54])) as specified in clause 4.4.3.3.1;\n-\tin automatic PLMN selection the MS shall not consider PLMNs included in the \"PLMNs with E-UTRAN not allowed\" list as PLMN selection candidates for E-UTRAN access technology, unless no other PLMN is available. This does not prevent selection of such a PLMN if it is available in another RAT; and\n-\tthe MS shall delete stored information in the \"PLMNs with E-UTRAN not allowed\" list when the MS is switched off, the USIM is removed or timer TE expires.\nThe MS should maintain a list of PLMNs where the N1 mode capability was disabled because IMS voice was not available and the MS's usage setting was \"voice centric\" as PLMNs where voice service was not possible in N1 mode. When the MS disables its N1 mode capability because IMS voice was not available and the MS's usage setting was \"voice centric\":\n-\tthe MS should add the identity of the PLMN to the list of PLMNs where voice service was not possible in N1 mode and should start timer TF if timer TF is not already running. The number of PLMNs that the MS can store where voice services is not possible is implementation specific, but it shall be at least one. The value of timer TF is MS implementation specific, but shall not exceed the maximum possible value of background scanning timer T as specified in clause 4.4.3.3.1;\n-\tin automatic PLMN selection the MS shall not consider PLMNs where voice service was not possible in N1 mode as PLMN selection candidates for NG-RAN access technology, unless no other PLMN is available. This does not prevent selection of such a PLMN if it is available in another RAT; and\n-\tthe MS shall delete stored information on PLMNs where voice service was not possible in N1 mode when the MS is switched off, the USIM is removed, timer TF expires or the MS's usage setting changes so that N1 mode capability disabling is no longer necessary.\nThe MS should maintain a list of PLMNs where the N1 mode capability was disabled due to receipt of a reject from the network with 5GMM cause #27 \"N1 mode not allowed\", as PLMNs where N1 mode is not allowed for 3GPP access. When the MS disables its N1 mode capability due to receipt of a reject from the network with 5GMM cause #27 \"N1 mode not allowed\":\n-\tthe MS should add the identity of the PLMN to the list of PLMNs where N1 mode is not allowed for 3GPP access and should start timer TG if timer TG is not already running. The number of PLMNs that the MS can store where N1 mode is not allowed for 3GPP access is implementation specific, but it shall be at least one. The value of timer TG is MS implementation specific, but shall not exceed the maximum possible value of background scanning timer T as specified in clause 4.4.3.3.1;\n-\tin automatic PLMN selection the MS shall not consider PLMNs where N1 mode is not allowed for 3GPP access as PLMN selection candidates for NG-RAN access technology, unless no other PLMN is available. This does not prevent selection of such a PLMN if it is available in another RAT;\n-\tif the MS is not configured to use timer T3245, the MS maintains a list of PLMN-specific N1 mode attempt counters for 3GPP access as specified in 3GPP TS 24.501 [64] and T3247 expires, then the MS removes for each PLMN-specific N1 mode attempt counter for 3GPP access that has a value greater than zero and less than the MS implementation-specific maximum value the respective PLMN from the list of PLMNs where N1 mode is not allowed for 3GPP access, as specified in clause 5.3.20.2 in 3GPP TS 24.501 [64]; and\n-\tthe MS shall delete stored information on PLMNs where N1 mode is not allowed for 3GPP access when the MS is switched off, the USIM is removed or timer TG expires.\nNOTE 2:\tThe expiry of timer TG does not cause a reset of the PLMN-specific N1 mode attempt counters for 3GPP access (see 3GPP TS 24.501 [64]).\nNOTE 3:\tIf an access technology is disabled for a PLMN that is part of the list of \"equivalent PLMNs\", the UE implementation ensures that registration to a different PLMN within the list of \"equivalent PLMNs\" does not result in reselection or inter-system change to the disabled access technology of that PLMN.\nThe MS in NB-S1 mode may maintain a list of \"PLMNs with NB-IoT not allowed\" where the NB-IoT capability was disabled due to receipt of a reject from the network with EMM cause #15 \"no suitable cells in tracking area\" and an Extended EMM cause IE with value \"NB-IoT not allowed\", as PLMNs where NB-S1 mode is not allowed. When the MS disables its NB-IoT capability due to receipt of a reject from the network with EMM cause #15 \"no suitable cells in tracking area\" and an Extended EMM cause IE with value \"NB-IoT not allowed\":\n-\tthe MS may add the identity of the PLMN to the list of \"PLMNs with NB-IoT not allowed\" and start timer TH if timer TH is not already running. The number of PLMNs that the MS can store in the \"PLMNs with NB-IoT not allowed\" list is implementation specific, but it shall be at least one. The value of timer TH is MS implementation specific, but shall not exceed the maximum possible value of background scanning timer T as specified in clause 4.4.3.3.1;\n-\tin automatic PLMN selection the MS shall not consider PLMNs included in the \"PLMNs with NB-IoT not allowed\" list as PLMN selection candidates for the access technology E-UTRAN in NB-S1 mode, unless no other PLMN is available. This does not prevent selection of such a PLMN if it is available in another RAT; and\n-\tthe MS shall delete stored information in the \"PLMNs with NB-IoT not allowed\" list when the MS is switched off, the USIM is removed or timer TH expires.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.1A\tCSG selection / restriction",
                    "description": "",
                    "summary": "",
                    "text_content": "If the MS supports CSG, it is provisioned with an Allowed CSG list and an Operator CSG list and associated PLMN identities. Both lists can be retrieved either from the USIM if the lists are available in the USIM, or as described in 3GPP TS 24.285 [47] if the lists are not available in the USIM. These lists have zero or more entries.\nNOTE 1:\tThe network also updates the Allowed CSG list in the same updating operation if one or more entries are removed from the Operator CSG list. This avoids an entry removed from the Operator CSG list remaining in the Allowed CSG list.\nThere are two modes of CSG selection:\n-\tAutomatic mode: This mode utilizes the Allowed CSG list and the Operator CSG list. After a PLMN is selected, the MS camps on a cell in that PLMN only if the cell is either not a CSG cell or it is a CSG cell with a CSG identity that is in the Allowed CSG list or in the Operator CSG List. The idle mode procedures of NAS are not impacted by this mode. Upon switch on the MS is in automatic mode.\n-\tManual mode: In this mode, the MS indicates to the user a list of available CSGs and the associated PLMNs. Based on configuration by the HPLMN, the list of CSGs provided to the user for a certain PLMN is either:\n-\tnot restricted by the Allowed CSG list and the Operator CSG List stored in the MS; or\n-\trestricted to entries in the Operator CSG List only.\nAfter the user makes a selection, the MS camps on a cell with the selected CSG identity and may attempt to register with the associated PLMN (see 3GPP TS 24.008 [23] and 3GPP TS 24.301 [23A]).\nThe permitted CSG list is a combination of Operator CSG list and the Allowed CSG list. NAS shall provide the permitted CSG list to the AS. If the contents of the permitted CSG list have changed, NAS shall provide an updated permitted CSG list to the AS.\nNOTE 2:\tThe same CSG ID and its associated PLMN can exist in both the Operator CSG list and the Allowed CSG list. Such duplicates can be removed when combining these lists to form the permitted CSG list.\nIf an integrity protected message with cause value #25 (see 3GPP TS 24.008 [23] and 3GPP TS 24.301 [23A]) is received by an MS for a CSG ID and associated PLMN identity present in the Operator CSG list, then for an implementation dependent time which is not shorter than 60 minutes, or until the MS is switched off, or the SIM/USIM is removed, or the Operator CSG list is updated:\na)\tThe NAS shall not include this CSG ID and the associated PLMN identity in the permitted CSG list provided to the AS; and\nb)\tIn CSG manual mode selection, the MS shall not indicate to the user that this CSG ID and the associated PLMN identity is in the Operator CSG List stored in the MS.\nNOTE 3:\tAs an implementation option, the user can be informed that the MS has not been authorized for a CSG included in the Operator CSG list.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.1B\tPLMN selection triggered by ProSe communications",
                    "description": "",
                    "summary": "",
                    "text_content": "If the MS supports ProSe communications and needs to perform PLMN selection for ProSe communications as specified in 3GPP TS 24.334 [51] or 3GPP TS 24.554 [80], then the MS shall proceed as follows:\ni)\tthe MS shall store a duplicate value of the RPLMN and a duplicate of the PLMN selection mode that were in use before PLMN selection due to ProSe communications was initiated, unless this PLMN selection due to ProSe communications follows another PLMN selection due to ProSe communications or a manual CSG selection as specified in clause 4.4.3.1.3.3;\nii)\tthe MS shall enter into Automatic mode of PLMN selection as specified in clause 4.4 taking into account the additional requirements in items iii) to x) below;\niii)\tamong the PLMNs advertised by the E-UTRA cell or NR cell operating in the radio resources provisioned to the MS for ProSe communications as specified in 3GPP TS 24.333 [52], 3GPP TS 24.555 [81] or 3GPP TS 31.102 [40], the MS shall choose one allowable PLMN which meets:\n1)\tthe following:\n-\tis advertised by the E-UTRA cell;\n-\tprovides radio resources for ProSe communications over E-UTRA PC5;\n-\tis in the list of authorised PLMNs for ProSe communications as specified in 3GPP TS 24.334 [51]; and\n-\tis not in the list of \"PLMNs with E-UTRAN not allowed\" as specified in clause 3.1; or\n2)\tthe following:\n-\tis advertised by the NR cell;\n-\tprovides radio resources for 5G ProSe communications over NR PC5;\n-\tis in the list of authorised PLMNs for 5G ProSe communications over PC5 as specified in 3GPP TS 24.554 [80];\n-\tis the advertised PLMN(s) of the 5G ProSe layer-2 UE-to-network relay UE if the MS is acting as a 5G ProSe layer-2 remote UE;\n-\tis not in the list of PLMNs where the N1 mode capability was disabled due to IMS voice not available and the MS's usage setting was \"voice centric\" as PLMNs where voice service was not possible; and\n-\tis not in the list of PLMNs where the N1 mode capability was disabled due to receipt of a reject from the network with 5GMM cause #27 \"N1 mode not allowed\" in N1 mode as specified in clause 3.1;\nif either condition 1) or condition 2) above is met then the MS shall attempt to register on that PLMN. If none of the PLMNs meet either condition 1) or condition2) above, the MS shall return to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action;\niv)\tif the registration fails due to \"PLMN not allowed\" or \"EPS services not allowed\" as specified in 3GPP TS 24.334 [51], or due to \"PLMN not allowed\" or \"5GS services not allowed\" as specified in 3GPP TS 24.554 [80], then the MS shall update the appropriate list of forbidden PLMNs as specified in clause 3.1, and shall either:\nA)\tif the PLMN provides common radio resources needed by the MS to do ProSe communications as specified in 3GPP TS 36.331 [42] or 3GPP TS 38.331 [65], perform ProSe communications on the selected PLMN in limited service state. In this case the MS shall not search for available and allowable PLMNs during the duration of ProSe communications;\nB)\treturn to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action; or\nC)\tperform the action described in iii) again with the choice of PLMNs further excluding the PLMNs on which the MS has failed to register.\nWhether the MS performs A), B) or C) above is left up to MS implementation.\nv)\tif the registration fails due to causes other than \"PLMN not allowed\" or \"EPS services not allowed\" or \"5GS services not allowed\", the MS shall:\n-\tif the handling of the failure requires updating a list of forbidden PLMNs, update the appropriate list (as specified in 3GPP TS 24.301 [23A] or 3GPP TS 24.501 [64]); and\n-\tif the handling of the failure does not require updating a list of forbidden PLMNs (as specified in 3GPP TS 24.301 [23A] or 3GPP TS 24.501 [64]), remember the PLMN as a PLMN on which the MS has failed to register;\nNOTE 1:\tHow long the MS memorizes the PLMNs on which it has failed to register is implementation dependent.\nand the MS shall either:\nA1)\treturn to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action;\nB1)\tperform the action described in iii) again with the choice of PLMNs further excluding the PLMNs on which the MS has failed to register; or\nC1)\tperform ProSe communications in limited service state on a PLMN advertised by the cell operating in the radio resources provisioned to the MS for ProSe communications as specified in 3GPP TS 24.333 [52], 3GPP TS 24.555 [81] or 3GPP TS 31.102 [40], if registration on this PLMN has previously failed due to \"PLMN not allowed\" or \"EPS services not allowed\" as specified in 3GPP TS 24.334 [51] or due to \"PLMN not allowed\" or \"5GS services not allowed\" as specified in 3GPP TS 24.554 [80] and if this PLMN provides common radio resources needed by the MS to do ProSe communications as specified in 3GPP TS 36.331 [42] or 3GPP TS 38.331 [65]. In this case the MS shall not search for available and allowable PLMNs during the duration of ProSe communications;\nWhether the MS performs A1), B1) or C1) above is left up to MS implementation.\nvi)\tif the MS is no longer in the coverage of the selected PLMN, then the MS shall either:\nA2)\tperform ProSe communications procedures for MS to use provisioned radio resources as specified in 3GPP TS 24.334 [51] or 3GPP TS 24.554 [80]; or\nB2)\treturn to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action.\nWhether the MS performs A2) or B2) above is left up to MS implementation.\nvii)\tif the MS is unable to find a suitable cell on the selected PLMN as specified in 3GPP TS 24.334 [51], then the MS shall either:\nA3)\tif the PLMN provides common radio resources needed by the MS to do ProSe communications as specified in 3GPP TS 36.331 [42] or 3GPP TS 38.331 [65], perform ProSe communications on the selected PLMN in limited service state. In this case the MS shall not search for available and allowable PLMNs during the duration of ProSe communications; or\nB3)\treturn to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action.\nWhether the MS performs A3) or B3) above is left up to MS implementation.\nviii)\tif the MS is switched off while on the selected PLMN and switched on again, the MS shall use the stored duplicate value of RPLMN as RPLMN and behave as specified in clause 4.4.3.1;\nix)\tif the user initiates a PLMN selection while on the selected cell, the MS shall delete the stored duplicate value of PLMN selection mode, use the stored duplicate value of RPLMN as RPLMN and follow the procedures (as specified for switch-on or recovery from lack of coverage) in clause 4.4.3.1. The MS shall delete the stored duplicate value of RPLMN once the MS has successfully registered to the selected PLMN; and\nx)\tif the MS no longer needs to perform Prose communications, the MS shall return to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action.\nNOTE 2:\tIf the MS returns to the RPLMN due to a failure to register in the selected PLMN, the upper layers of the MS can trigger PLMN selection again to initiate ProSe communications.\nIf the PLMN selected for ProSe communications is a VPLMN, the MS shall not periodically scan for higher priority PLMNs during the duration of ProSe communications.\nThe solution to prevent potential ping-pong between the RPLMN and the PLMN selected for ProSe communications is MS implementation specific.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.1C\tPLMN selection triggered by V2X communication over PC5",
                    "description": "",
                    "summary": "",
                    "text_content": "If the MS supports V2X communication over E-UTRA-PC5 or NR-PC5 and needs to perform PLMN selection for V2X communication over PC5 as specified in 3GPP TS 24.386 [59] or 3GPP TS 24.587 [75], then the MS shall proceed as follows:\ni)\tthe MS shall store a duplicate value of the RPLMN and a duplicate of the PLMN selection mode that were in use before PLMN selection due to V2X communication over PC5 was initiated, unless this PLMN selection due to V2X communication over PC5 follows another PLMN selection due to V2X communication over PC5 or a manual CSG selection as specified in clause 4.4.3.1.3.3;\nii)\tthe MS shall enter into Automatic mode of PLMN selection as specified in clause 4.4 taking into account the additional requirements in items iii) to x) below;\niii)\tAmong the PLMNs advertised by the E-UTRA or NG-RAN cell operating in the radio resources provisioned to the MS for V2X communication over PC5 as specified in 3GPP TS 24.385 [60], 3GPP TS 24.588 [79] or 3GPP TS 31.102 [40], the MS shall choose one allowable PLMN which meets:\n1)\tthe following:\n-\tprovides radio resources for V2X communication over PC5;\n-\tis in the list of authorised PLMNs for V2X communication over PC5 as specified in 3GPP TS 24.386 [59] or 3GPP TS 24.587 [75]; and\n-\tis not in the list of \"PLMNs with E-UTRAN not allowed\" as specified in clause 3.1; or\n2)\tthe following:\n-\tprovides radio resources for V2X communication over PC5;\n-\tis in the list of authorised PLMNs for V2X communication over PC5 as specified in 3GPP TS 24.386 [59] or 3GPP TS 24.587 [75];\n-\tis not in the list of PLMNs where the N1 mode capability was disabled due to IMS voice not available and the MS's usage setting was \"voice centric\" as PLMNs where voice service was not possible; and\n-\tis not in the list of PLMNs where the N1 mode capability was disabled due to receipt of a reject from the network with 5GMM cause #27 \"N1 mode not allowed\" in N1 mode as specified in clause 3.1;\nif condition 1) or 2) above are met then the MS shall attempt to register on that PLMN. If none of the PLMNs meet condition 1) or 2) above, the MS shall return to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action;\niv)\tif the registration fails due to \"PLMN not allowed\" or \"EPS services not allowed\" as specified in 3GPP TS 24.386 [59], or due to \"PLMN not allowed\" or \"5GS services not allowed\" as specified in 3GPP TS 24.587 [75], or both, then the MS shall update the appropriate list of forbidden PLMNs as specified in clause 3.1, and shall:\nA)\tif the PLMN provides common radio resources needed by the MS to do V2X communication over PC5 as specified in 3GPP TS 36.331 [42] or 3GPP TS 38.331 [65], perform V2X communication over PC5 on the selected PLMN in limited service state. In this case the MS shall not search for available and allowable PLMNs during the duration of V2X communication over PC5;\nB)\treturn to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action; or\nC)\tperform the action described in iii) again with the choice of PLMNs further excluding the PLMNs on which the MS has failed to register.\nWhether the MS performs A), B) or C) above is left up to MS implementation.\nv)\tif the registration fails due to causes other than \"PLMN not allowed\" or \"EPS services not allowed\" or \"5GS services not allowed\", the MS shall:\n-\tif the handling of the failure requires updating a list of forbidden PLMNs, update the appropriate list (as specified in 3GPP TS 24.301 [23A] or 3GPP TS 24.501 [64]); and\n-\tif the handling of the failure does not require updating a list of forbidden PLMNs (as specified in 3GPP TS 24.301 [23A] or 3GPP TS 24.501 [64]), remember the PLMN as a PLMN on which the MS has failed to register;\nNOTE 1:\tHow long the MS memorizes the PLMNs on which it has failed to register is implementation dependent.\nand the MS shall:\nA1)\treturn to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action;\nB1)\tperform the action described in iii) again with the choice of PLMNs further excluding the PLMNs on which the MS has failed to register; or\nC1)\tperform V2X communication over PC5 in limited service state on a PLMN advertised by the cell operating in the radio resources provisioned to the MS for V2X communication over PC5 as specified in 3GPP TS 24.385 [60], 3GPP TS 24.588 [79] or 3GPP TS 31.102 [40], if registration on this PLMN has previously failed due to \"PLMN not allowed\" or \"EPS services not allowed\" as specified in 3GPP TS 24.386 [59], or due to \"PLMN not allowed\" or \"5GS services not allowed\" as specified in 3GPP TS 24.587 [75], or both, and if this PLMN provides common radio resources needed by the MS to do V2X communication over PC5 as specified in 3GPP TS 36.331 [42] or 3GPP TS 38.331 [65]. In this case the MS shall not search for available and allowable PLMNs during the duration of V2X communication over PC5;\nWhether the MS performs A1), B1) or C1) above is left up to MS implementation.\nvi)\tif the MS is no longer in the coverage of the selected PLMN, then the MS shall:\nA2)\tperform V2X communication over PC5 procedures for MS to use provisioned radio resources as specified in 3GPP TS 24.386 [59] or 3GPP TS 24.587 [75]; or\nB2)\treturn to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action.\nWhether the MS performs A2) or B2) above is left up to MS implementation.\nvii)\tif the MS is unable to find a suitable cell on the selected PLMN as specified in 3GPP TS 24.386 [59] or 3GPP TS 24.587 [75], then the MS shall:\nA3)\tif the PLMN provides common radio resources needed by the MS to do V2X communication over PC5 as specified in 3GPP TS 36.331 [42] or 3GPP TS 38.331 [65], perform V2X communication over PC5 on the selected PLMN in limited service state. In this case the MS shall not search for available and allowable PLMNs during the duration of V2X communication over PC5; or\nB3)\treturn to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action.\nWhether the MS performs A3) or B3) above is left up to MS implementation.\nviii)\tif the MS is switched off while on the selected PLMN and switched on again, the MS shall use the stored duplicate value of RPLMN as RPLMN and behave as specified in clause 4.4.3.1;\nix)\tif the user initiates a PLMN selection while on the selected cell, the MS shall delete the stored duplicate value of PLMN selection mode, use the stored duplicate value of RPLMN as RPLMN and follow the procedures (as specified for switch-on or recovery from lack of coverage) in clause 4.4.3.1. The MS shall delete the stored duplicate value of RPLMN once the MS has successfully registered to the selected PLMN; and\nx)\tif the MS no longer needs to perform V2X communication over PC5, the MS shall return to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action.\nNOTE 2:\tIf the MS returns to the RPLMN due to a failure to register in the selected PLMN, the upper layers of the MS can trigger PLMN selection again to initiate V2X communication over PC5.\nIf the PLMN selected for V2X communication over PC5 is a VPLMN, the MS shall not periodically scan for higher priority PLMNs during the duration of V2X communication over PC5.\nThe solution to prevent potential ping-pong between the RPLMN and the PLMN selected for V2X communication over PC5 is MS implementation specific.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.1D\tPLMN selection triggered by A2X communication over PC5",
                    "description": "",
                    "summary": "",
                    "text_content": "If the MS supports A2X communication over E-UTRA-PC5 or NR-PC5 and needs to perform PLMN selection for A2X communication over PC5 as specified in 3GPP TS 24.577 [86], then the MS shall proceed as follows:\ni)\tthe MS shall store a duplicate value of the RPLMN and a duplicate of the PLMN selection mode that were in use before PLMN selection due to A2X communication over PC5 was initiated, unless this PLMN selection due to A2X communication over PC5 follows another PLMN selection due to A2X communication over PC5 or a manual CSG selection as specified in clause 4.4.3.1.3.3;\nii)\tthe MS shall enter into Automatic mode of PLMN selection as specified in clause 4.4 taking into account the additional requirements in items iii) to x) below;\niii)\tamong the PLMNs advertised by the E-UTRA cell or NR cell operating in the radio resources provisioned to the MS for A2X communication over PC5 as specified in 3GPP TS 24.577 [86], 3GPP TS 24.578 [87] or 3GPP TS 31.102 [40], the MS shall choose one allowable PLMN which meets:\n1)\tthe following:\n-\tprovides radio resources for A2X communication over PC5;\n-\tis in the list of authorised PLMNs for A2X communication over PC5 as specified in 3GPP TS 24.577 [86]; and\n-\tis not in the list of \"PLMNs with E-UTRAN not allowed\" as specified in clause 3.1; or\n2)\tthe following:\n-\tprovides radio resources for A2X communication over PC5;\n-\tis in the list of authorised PLMNs for A2X communication over PC5 as specified in 3GPP TS 24.577 [86];\n-\tis not in the list of PLMNs where the N1 mode capability was disabled due to IMS voice not available and the MS's usage setting was \"voice centric\" as PLMNs where voice service was not possible; and\n-\tis not in the list of PLMNs where the N1 mode capability was disabled due to receipt of a reject from the network with 5GMM cause #27 \"N1 mode not allowed\" in N1 mode as specified in clause 3.1;\nif either condition 1) or condition 2) above is met then the MS shall attempt to register on that PLMN. If none of the PLMNs meet either condition 1) or condition 2) above, the MS shall return to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action;\niv)\tif the registration fails due to \"PLMN not allowed\" or \"EPS services not allowed\" in case of EPS, due to \"PLMN not allowed\" or \"5GS services not allowed\" in case of 5GS, or both as specified in 3GPP TS 24.577 [86], then the MS shall update the appropriate list of forbidden PLMNs as specified in clause 3.1, and shall:\nA)\tif the PLMN provides common radio resources needed by the MS to do A2X communication over PC5 as specified in 3GPP TS 36.331 [42] or 3GPP TS 38.331 [65], perform A2X communication over PC5 on the selected PLMN in limited service state. In this case the MS shall not search for available and allowable PLMNs during the duration of A2X communication over PC5;\nEditor's note (pCR, UAS_Ph2): 3GPP TS 38.331 and 3GPP TS 36.331 still need to be updated for A2X communication over PC5.\nB)\treturn to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action; or\nC)\tperform the action described in iii) again with the choice of PLMNs further excluding the PLMNs on which the MS has failed to register.\nWhether the MS performs A), B) or C) above is left up to MS implementation.\nv)\tif the registration fails due to causes other than \"PLMN not allowed\" or \"EPS services not allowed\" or \"5GS services not allowed\", the MS shall:\n-\tif the handling of the failure requires updating a list of forbidden PLMNs, update the appropriate list (as specified in 3GPP TS 24.301 [23A] or 3GPP TS 24.501 [64]); and\n-\tif the handling of the failure does not require updating a list of forbidden PLMNs (as specified in 3GPP TS 24.301 [23A] or 3GPP TS 24.501 [64]), remember the PLMN as a PLMN on which the MS has failed to register;\nNOTE 1:\tHow long the MS memorizes the PLMNs on which it has failed to register is implementation dependent.\nand the MS shall either:\nA1)\treturn to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action;\nB1)\tperform the action described in iii) again with the choice of PLMNs further excluding the PLMNs on which the MS has failed to register; or\nC1)\tperform A2X communication over PC5 in limited service state on a PLMN advertised by the cell operating in the radio resources provisioned to the MS for A2X communication over PC5 as specified in 3GPP TS 24.577 [86], 3GPP TS 24.578 [87] or 3GPP TS 31.102 [40], if registration on this PLMN has previously failed due to \"PLMN not allowed\" or \"EPS services not allowed\" in case of EPS, due to \"PLMN not allowed\" or \"5GS services not allowed\" in case of 5GS, or both as specified in 3GPP TS 24.577 [86], and if this PLMN provides common radio resources needed by the MS to do A2X communication over PC5 as specified in 3GPP TS 36.331 [42] or 3GPP TS 38.331 [65]. In this case the MS shall not search for available and allowable PLMNs during the duration of A2X communication over PC5;\nEditor's note (pCR, UAS_Ph2): 3GPP TS 38.331 and 3GPP TS 36.331 still need to be updated for A2X communication over PC5.\nWhether the MS performs A1), B1) or C1) above is left up to MS implementation.\nvi)\tif the MS is no longer in the coverage of the selected PLMN, then the MS shall:\nA2)\tperform A2X communication over PC5 procedures for MS to use provisioned radio resources as specified in 3GPP TS 24.577 [86]; or\nB2)\treturn to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action.\nWhether the MS performs A2) or B2) above is left up to MS implementation.\nvii)\tif the MS is unable to find a suitable cell on the selected PLMN as specified in 3GPP TS 24.577 [86], then the MS shall:\nA3)\tif the PLMN provides common radio resources needed by the MS to do A2X communication over PC5 as specified in 3GPP TS 36.331 [42] or 3GPP TS 38.331 [65], perform A2X communication over PC5 on the selected PLMN in limited service state. In this case the MS shall not search for available and allowable PLMNs during the duration of A2X communication over PC5; or\nEditor's note (pCR, UAS_Ph2): 3GPP TS 38.331 and 3GPP TS 36.331 still need to be updated for A2X communication over PC5.\nB3)\treturn to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action.\nWhether the MS performs A3) or B3) above is left up to MS implementation.\nviii)\tif the MS is switched off while on the selected PLMN and switched on again, the MS shall use the stored duplicate value of RPLMN as RPLMN and behave as specified in clause 4.4.3.1;\nix)\tif the user initiates a PLMN selection while on the selected cell, the MS shall delete the stored duplicate value of PLMN selection mode, use the stored duplicate value of RPLMN as RPLMN and follow the procedures (as specified for switch-on or recovery from lack of coverage) in clause 4.4.3.1. The MS shall delete the stored duplicate value of RPLMN once the MS has successfully registered to the selected PLMN; and\nx)\tif the MS no longer needs to perform A2X communication over PC5, the MS shall return to the stored duplicate PLMN selection mode and use the stored duplicate value of RPLMN for further action.\nNOTE 2:\tIf the MS returns to the RPLMN due to a failure to register in the selected PLMN, the upper layers of the MS can trigger PLMN selection again to initiate A2X communication over PC5.\nIf the PLMN selected for A2X communication over PC5 is a VPLMN, the MS shall not periodically scan for higher priority PLMNs during the duration of A2X communication over PC5.\nThe solution to prevent potential ping-pong between the RPLMN and the PLMN selected for A2X communication over PC5 is MS implementation specific.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tRegional provision of service",
                    "description": "",
                    "summary": "",
                    "text_content": "An MS may have a \"regionally restricted service\" where it can only obtain service on certain areas (i.e. LAs or TAs). If such an MS attempts to camp on a cell of an area for which it does not have service entitlement, when it does an LR request, it will receive a message with cause value #12 (see 3GPP TS 24.008 [23], 3GPP TS 24.301 [23A] and 3GPP TS 24.501 [64]). In this case, the MS shall take the following actions depending on the mode in which the message was received:\nA/Gb mode or Iu mode:\n-\tThe MS stores the forbidden LA identity (LAI) in a list of \"forbidden location areas for regional provision of service\", to prevent repeated access attempts on a cell of the forbidden LA. This list is deleted when the MS is switched off, the SIM is removed or periodically (with period in the range 12 to 24 hours). The MS enters the limited service state.\nS1-mode:\nThe MS stores the forbidden TA identity (TAI) in a list of \"forbidden tracking areas for regional provision of service\", to prevent repeated access attempts on a cell of the forbidden TA. This list is deleted when the MS is switched off, the SIM is removed or periodically (with period in the range 12 to 24 hours). The MS enters the limited service state.\nN1-mode:\nThe MS stores the forbidden TA identity (TAI) in a list of \"5GS forbidden tracking areas for regional provision of service\", to prevent repeated access attempts on a cell of the forbidden TA. This list is deleted when the MS is switched off, the SIM is removed or periodically (with period in the range 12 to 24 hours). The MS enters the limited service state.\nIn A/Gb mode, a cell may be reserved for SoLSA exclusive access (see 3GPP TS 24.008 [23] and 3GPP TS 44.060 [39]). An MS is only allowed to camp normally on such a cell if it has a Localised Service Area subscription to the cell. Other MS may enter the limited service state.\nNOTE 1:\tIn A/Gb mode, in a SoLSA exclusive cell the MCC+MNC code is replaced by a unique escape PLMN code (see 3GPP TS 23.073), not assigned to any PLMN, in SI3 and SI4. An MS not supporting SoLSA may request for location update to an exclusive access cell. In this case the location attempt is rejected with the cause \"PLMN not allowed\" and the escape PLMN code is added to the list of the \"forbidden PLMNs\".\nThe MS operating in SNPN access operation mode over 3GPP access shall maintain one or more lists of \"5GS forbidden tracking areas for regional provision of service\", each associated with an SNPN and, if the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, entry of the \"list of subscriber data\" or, if the MS supports access to an SNPN using credentials from a credentials holder, the PLMN subscription. The MS shall use the list of \"5GS forbidden tracking areas for regional provision of service\" associated with the selected SNPN and, if the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the selected entry of the \"list of subscriber data\" or the selected PLMN subscription. If the MS selects a new SNPN, the MS shall keep the list of \"5GS forbidden tracking areas for regional provision of service\" associated with the previously selected SNPN and, if the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the previously selected entry of the \"list of subscriber data\" or the previously selected PLMN subscription. If the number of the lists to be kept is higher than supported, the MS shall delete the oldest stored list of \"5GS forbidden tracking areas for regional provision of service\". The MS shall delete all lists of \"5GS forbidden tracking areas for regional provision of service\", when the MS is switched off. The MS shall delete the list of \"5GS forbidden tracking areas for regional provision of service\" associated with an SNPN:\na)\twhen the entry with the subscribed SNPN identifying the SNPN in the \"list of subscriber data\" is updated;\nb)\twhen the USIM is removed if:\n-\tEAP based primary authentication and key agreement procedure using EAP-AKA'; or\n-\t5G AKA based primary authentication and key agreement procedure;\nwas performed in the selected SNPN; or\nc)\tif the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, when the list of \"5GS forbidden tracking areas for regional provision of service\" is associated with:\n-\tthe entry of the \"list of subscriber data\" and the entry of the \"list of subscriber data\" is updated; or\n-\tthe PLMN subscription and USIM is removed.\nNOTE 2:\tThe number of the lists of \"5GS forbidden tracking areas for regional provision of service\" supported by the MS is MS implementation specific.\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.3\tBorders between registration areas",
                    "description": "",
                    "summary": "",
                    "text_content": "If the MS is moving in a border area between registration areas, it might repeatedly change between cells of different registration areas. Each change of registration area would require an LR, which would cause a heavy signalling load and increase the risk of a paging message being lost. The access stratum shall provide a mechanism to limit this effect.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.4\tAccess control",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "3.4.1\tAccess control",
                            "text_content": "Due to problems in certain areas, network operators may decide to restrict access from some MSs (e.g., in case of congestion), and for this reason, a mechanism for common access control is provided. In A/Gb mode and Iu mode a mechanism for domain specific access control is also provided (see 3GPP TS 43.022 [35], 3GPP TS 44.018 [34] and 3GPP TS 25.304 [32]).\nA mechanism to restrict access is provided via EAB. A network operator can restrict network access of those MSs that are configured for EAB in addition to common access control and domain specific access control.\nThe MS can be configured for EAB in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]). An MS that supports EAB shall follow the EAB mechanism (see 3GPP TS 24.008 [23], 3GPP TS 24.301 [23A], 3GPP TS 44.018 [34], 3GPP TS 25.331 [33], 3GPP TS 36.331 [42]) when configured for EAB.\nThe MS can be configured for ACDC in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.105 [53]). An MS that supports ACDC shall follow the ACDC mechanism (see 3GPP TS 24.008 [23], 3GPP TS 24.301 [23A], 3GPP TS 25.331 [33], 3GPP TS 36.331 [42]) when configured for ACDC.\nThe MS can be configured in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]) to override EAB. An MS that supports overriding EAB shall follow the overriding EAB mechanism (see 3GPP TS 24.008 [23], 3GPP TS 24.301 [23A]) when configured to allow overriding EAB.\nIn the case that a network operator decides to restrict access they may as an option allow restricted MSs to respond to paging messages and/or to perform location registrations. Mechanisms to allow this optional access are provided (see 3GPP TS 25.304 [32]).\nA network operator can also restrict some MSs to access the network for location registration, although via common access class control or domain specific access class control the MSs are permitted to access the network for other purposes.\nIf the MS is accessing the network with a special access class (Access classes 11 to 15), then the MS shall ignore EAB and ACDC.\nNOTE:\tThe conditions when the MS is allowed to access the network with access class 11 – 15 are specified in 3GPP TS 22.011 [138].\nIf an MS configured for EAB is initiating an emergency call, then the MS shall ignore EAB.\nIf an MS configured for EAB is responding to paging, then the MS shall ignore EAB.\nIf an MS configured for ACDC is responding to paging, then the MS shall ignore ACDC.\nIf an MS configured for ACDC is initiating an emergency call, then the MS shall ignore ACDC.\nIf an MS configured for ACDC and the MO MMTEL voice call is started, the MO MMTEL video call is started or the MO SMSoIP is started (see 3GPP TS 24.008 [23], 3GPP TS 24.301 [23A]), then the MS shall ignore ACDC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "3.4.2\tForbidden LA or TA for regional provision of service",
                            "text_content": "The MS is not allowed to initiate establishment of a CM connection except for an emergency call when camped on a cell of an LA or TA of which belongs to the list of \"forbidden location areas for regional provision of service\" or \"forbidden tracking areas for regional provision of service\". The MS may respond to paging.\nThe MS is not allowed to request GPRS services except for an emergency bearer services or for access to RLOS when camped on a cell of an LA or TA of which belongs to the list of \"forbidden location areas for regional provision of service\" or \"forbidden tracking areas for regional provision of service\".\nThe MS is not allowed to request 5GS services except emergency services when camped on a cell of a TA of which belongs to the list of \"5GS forbidden tracking areas for regional provision of service\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "3.5\tNo suitable cell (limited service state)",
                    "description": "",
                    "summary": "",
                    "text_content": "There are a number of situations in which the MS is unable to obtain normal service from a PLMN or SNPN. These include:\na)\tFailure to find a suitable cell of the selected PLMN or of the selected SNPN;\nb)\tNo SIM in the MS or the \"list of subscriber data\" with no valid entry;\nc)\tA \"PLMN not allowed\", \"Requested service option not authorized in this PLMN\" ,\"Serving network not authorized\" or \"PLMNs not allowed to operate at the present UE location\" response in case of PLMN or a \"Temporarily not authorized for this SNPN\" or \"Permanently not authorized for this SNPN\" response in case of SNPN when an LR is received;\nd)\tAn \"illegal MS\" or \"illegal ME\" response when an LR is received (Any SIM or the corresponding entry of the \"list of subscriber data\" in the ME is then considered \"invalid\");\ne)\tAn \"IMSI unknown in HLR\" response when an LR is received (Any SIM in the ME is then considered \"invalid\" for non-GPRS services);\nf)\tA \"GPRS services not allowed\" response when an LR of a GPRS MS attached to GPRS services only is received (The cell selection state of GPRS MSs attached to GPRS and non-GPRS depends on the outcome of the location updating), or an \"EPS services not allowed\" response is received when an EPS attach, tracking area update or service request is performed, or a \"5GS services not allowed\" response is received when a registration or service request is performed;\ng)\tVoid;\nh)\tVoid;\ni)\tMS supporting CAG is camped on a CAG cell belonging to a PLMN, the CAG-ID of the CAG cell is not manually selected by the user and none of the CAG-ID(s) of the CAG cell are authorized based on the \"Allowed CAG list\" associated with that PLMN in the \"CAG information list\";\nj)\tMS supporting CAG is camped on a non-CAG cell belonging to a PLMN, the PLMN ID of the non-CAG cell without a CAG-ID is not manually selected by the user and the UE is configured with \"indication that the MS is only allowed to access 5GS via CAG cells\" for that PLMN in the \"CAG information list\"; and\nk)\tMS supporting CAG is camped on a CAG cell belonging to a PLMN, the CAG-ID of the CAG cell is not manually selected by the user and the \"CAG information list\" does not contain an entry for the PLMN (e.g. because the UE is not (pre-)configured with a \"CAG information list\").\nl)\tMS selected a PLMN for disaster roaming, the timer precluding registration for disaster roaming in the selected PLMN for disaster roaming is running and the MS is not registering or registered for emergency services in the selected PLMN for disaster roaming.\nm)\tMS determined that a disaster condition has ended, selected the PLMN previously with disaster condition, the timer precluding registration in the PLMN previously with disaster condition is running and the MS is not registering or registered for emergency services in the PLMN previously with disaster condition.\n(In automatic PLMN selection mode, items a, c and f would normally cause a new PLMN selection, but even in this case, the situation may arise when no PLMNs are available and allowable for use).\n(In automatic SNPN selection mode, items a, c, d, and f would normally cause a new SNPN selection if there are two or more entries in the \"list of subscriber data\", but even in this case, the situation may arise when no SNPNs are available and allowable for use).\nFor the items a to f, if the MS does not operate in SNPN access operation mode over 3GPP access, the MS attempts to camp on an acceptable cell, irrespective of its PLMN identity, so that emergency calls or access to RLOS can be made if necessary, with the exception that an MS operating in NB-S1 mode, shall never attempt to make emergency calls or to access RLOS. When in the limited service state with a valid SIM, the MS shall search for available and allowable PLMNs in the manner described in clause 4.4.3.1 and when indicated in the SIM also as described in clause 4.4.3.4. For an MS that is not in eCall only mode, with the exception of performing GPRS attach or EPS attach for emergency bearer services, performing an initial registration for emergency services, or performing EPS attach for access to RLOS, no LR requests are made until a valid SIM is present and either a suitable cell is found or a manual network reselection is performed. For an MS in eCall only mode, no LR requests are made except for performing EPS attach for emergency bearer services or an initial registration for emergency services. When performing GPRS attach or EPS attach for emergency bearer services, an initial registration for emergency services, or performing EPS attach for access to RLOS, the PLMN of the current serving cell is considered as the selected PLMN for the duration the MS is attached for emergency bearer services, registered for emergency services, or attached for access to RLOS. In the limited service state the presence of the MS need not be known to the PLMN on whose cell it has camped. If the MS is enabled for SNPN, the MS needs to make an emergency call, there is no available PLMN supporting emergency services and the MS determines that there is an available SNPN supporting emergency services (based on broadcasted information of SNPN support for emergency services), the MS may start operating in SNPN access operation mode over 3GPP access and attempt to camp on a cell of the SNPN supporting emergency services. After an emergency call is released, the MS should stop operating in SNPN access operation mode over 3GPP access and perform PLMN selection. If the MS is enabled for SNPN and wants to perform configuration of SNPN subscription parameters in PLMN via the user plane, but there is no available PLMN for normal services, either because of no available PLMN or all available PLMNs being in forbidden PLMN list due to LR failure, the MS may start operating in SNPN access operation mode over 3GPP access (if the MS is configured with default UE credentials) and perform SNPN selection as per subclause 4.9.3.1.3 or 4.9.3.1.4. After the onboarding services in SNPN are complete, the MS may stop operating in SNPN access operation mode over 3GPP access and perform PLMN selection.\nFor the items a, c, d and f, if the MS operates in SNPN access operation mode over 3GPP access and the MS has a valid entry in the \"list of subscriber data\", the MS shall search for available and allowable SNPNs in the manner described in clause 4.9.3.1. For the item b, if the MS operates in SNPN access operation mode over 3GPP access, the MS:\n-\tattempts to camp on an acceptable cell so that emergency calls can be made if supported and necessary; and\n-\tmay perform SNPN selection procedure for onboarding services in SNPN if the MS is configured with the default UE credentials for primary authentication.\nFor the item l, the MS shall search for available and allowable PLMNs in the manner described in clause 4.4.3.1 and when indicated in the SIM also as described in clause 4.4.3.4.\nWhen in the limited service state, with the exception of performing an initial registration for emergency services, no LR requests are made until a valid entry of the \"list of subscriber data\" is present and either a suitable cell is found or a manual network reselection is performed. In the limited service state, the presence of the MS need not be known to the SNPN on whose cell it has camped. If the MS needs to make an emergency call, the MS supports accessing a PLMN, and there is no available SNPN supporting emergency services and the MS determines that there is an available PLMN supporting emergency services (based on broadcasted information of PLMN support for emergency services), the MS shall stop operating in SNPN access operation mode over 3GPP access and attempt to camp on a cell of the PLMN supporting emergency services so that emergency calls can be made. After an emergency call is released, the MS may re-start operating in SNPN access operation mode over 3GPP access and perform SNPN selection. If the MS is enabled for SNPN and wants to select an SNPN for onboarding services in SNPN, but finds no suitable SNPN as per subclause 4.9.3.1.3 or 4.9.3.1.4, the MS may stop operating in SNPN access operation mode over 3GPP access, and perform PLMN selection (if the MS is configured with PLMN credentials in USIM). The MS may perform PLMN selection as per clause 4.4. After the configuration of SNPN subscription parameters in PLMN via the user plane is complete, the MS may start operating in SNPN access operation mode over 3GPP access and perform SNPN selection. If the MS supports access to an SNPN providing access for localized services in SNPN and access for localized services in SNPN is enabled, and the MS is in limited service state because no SNPN is available as per subclause 4.9.3.1, when the validity information of an SNPN based on the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" or \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" changes from not met to met, the MS shall perform an SNPN selection as per subclause 4.9.3.1.\nThere are also other conditions under which only emergency calls or access to RLOS may be made if the MS does not operate in SNPN access operation mode over 3GPP access. These are shown in table 2 in clause 5. ProSe communications can be initiated in case of PLMN if necessary (see 3GPP TS 24.334 [51] or 3GPP TS 24.554 [80]) when in the limited service state due to items a) or c) or f). V2X communication over PC5 can be initiated if necessary (see 3GPP TS 24.386 [59] or 3GPP TS 24.587 [75]) when in the limited service state due to items a) or c) or f). A2X communication over PC5 can be initiated if necessary (see 3GPP TS 24.577 [86]) when in the limited service state due to items a) or c) or f).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.6\tCTS fixed part selection (A/Gb mode only)",
                    "description": "",
                    "summary": "",
                    "text_content": "In CTS mode only or in automatic mode with CTS preferred, the CTS MS normally operates on a CTS fixed part on which the mobile station is already enrolled. If the CTS MS loses CTS coverage in these modes, it shall attempt periodically to select again a CTS fixed part.\nTo select a CTS fixed part, the CTS MS shall listen to the CTSBCH frequencies of all the fixed parts on which the MS is currently enrolled.\nIf the CTS MS is moving in a border area between one area with CTS coverage and one without it, it might repeatedly require CTS attachments and LU on the PLMN. To prevent this, the criteria C1_CTS and C2_CTS (defined in 3GPP TS 45.008 [25] clause 11.1) are used. To attach to a CTS FP, the C1_CTS criterion shall be greater than zero. When the C2_CTS criterion falls below zero, the CTS MS shall consider itself to be no more under CTS coverage.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.7\tNAS behaviour configuration",
                    "description": "",
                    "summary": "",
                    "text_content": "NAS behaviour can be operator configurable using parameters in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]). For parameters available in both the USIM and the ME, precedence is specified in 3GPP TS 31.102 [40] clause 5.2.29.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.8\tCAG selection (N1 mode only)",
                    "description": "",
                    "summary": "",
                    "text_content": "The MS may support CAG.\nThe MS may support enhanced CAG information. If the MS supports enhanced CAG information, the MS shall support CAG.\nIf the MS supports CAG, the MS can be provisioned by the network with a \"CAG information list\", consisting of zero or more entries, each containing:\na)\ta PLMN ID;\nb)\tan \"Allowed CAG list\". The \"Allowed CAG list\" contains zero or more CAG-IDs .If the UE supports enhanced CAG information, each CAG-ID in the \"Allowed CAG list\" can be associated with time validity information. The time validity information contains one or more time periods; and\nc)\tan optional \"indication that the MS is only allowed to access 5GS via CAG cells\".\nThe \"CAG information list\" provisioned by the network is stored in the non-volatile memory of the ME, as specified in 3GPP TS 24.501 [64] annex C.\nNOTE 1:\tWhen the MS is registering or registered to a PLMN other than the HPLMN or EHPLMN, then the HPLMN will send a \"CAG information list\" consisting of CAG subscription information related to the serving PLMN only. When the MS is registering or registered to the HPLMN or EHPLMN then the HPLMN or EHPLMN can send CAG subscription information related to any PLMN in the \"CAG information list\".\nIn addition, the MS can also be pre-configured with a \"CAG information list\" stored in the USIM (see 3GPP TS 31.102 [40]). The \"Allowed CAG list\" included in the entry for the HPLMN or EHPLMN in \"CAG information list\" stored in the USIM can contain a range of CAG-IDs.\nNOTE 2:\tFor a given PLMN ID, no more than one entry containing the MCC value and the MNC value of the PLMN ID is necessary to be provided in the \"CAG information list\" stored in the USIM (see TS 31.102 [22]).\n3GPP TS 24.501 [64] annex C specifies condition under which the \"CAG information list\" stored in the ME is deleted. Additionally, when a USIM is inserted, if:\n-\tno \"CAG information list\" is stored in the non-volatile memory of the ME; or\n-\tthe SUPI from the USIM does not match the SUPI stored together with the \"CAG information list\" in the non-volatile memory of the ME;\nand the MS has a \"CAG information list\" stored in the USIM (see 3GPP TS 31.102 [22]), the MS shall store the \"CAG information list\" from the USIM into the ME, as specified in 3GPP TS 24.501 [64] annex C. If an entry in the \"CAG information list\" stored in the USIM includes an \"Allowed CAG list\" which contains a range of CAG-IDs, the range of CAG-IDs can be replaced with individual CAG-IDs matching the range up to ME implementation.\nNOTE 3:\tThe MS ignores the \"CAG information list\" stored in the USIM except when the USIM is inserted.\nIf the MS supports CAG and a PLMN is selected as described in clause 4.4.3.1.1, the automatic CAG selection is performed as part of clause 4.4.3.1.1.\nIf the MS supports CAG and a PLMN is selected as described in clause 4.4.3.1.2, the manual CAG selection is performed as part of clause 4.4.3.1.2.\nThe NAS shall provide the AS with a \"CAG information list\", if available, where the \"CAG information list\" contains only the CAG-IDs authorized by the \"Allowed CAG list\" for the entries in the \"CAG information list\", if available. If the contents of the \"CAG information list\" have changed, or the time validity information of an entry of \"Allowed CAG list\" in the \"CAG information list\" starts or stops matching the MS’s current time, the NAS shall provide an updated \"CAG information list\" to the AS, where the \"CAG information list\" contains only the CAG-IDs authorized by the \"Allowed CAG list\" for the entries in the \"CAG information list\", if available. If an entry in the \"CAG information list\" includes an \"Allowed CAG list\" which contains a range of CAG-IDs, whether the NAS provides the AS the range of CAG-IDs or individual CAG-IDs matching the range is up to ME implementation.\nThe \"indication that the MS is only allowed to access 5GS via CAG cells\" is not applicable in EPS.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.9\tSNPN selection",
                    "description": "",
                    "summary": "",
                    "text_content": "An MS may be enabled for SNPN.\nAn MS enabled for SNPN may operate in SNPN access operation mode over 3GPP access.\nAn MS may support onboarding services in SNPN.\nAn MS enabled for SNPN may support access to an SNPN using credentials from a credentials holder.\nAn MS enabled for SNPN may support access to an SNPN providing access for localized services in SNPN. If the MS supports access to an SNPN providing access for localized services in SNPN, the MS shall support access to an SNPN using credentials from a credentials holder.\nWith the exception of onboarding services in SNPN, the MS operating in SNPN access operation mode over 3GPP access selects:\na)\tan SNPN for which it is configured with a subscriber identifier and credentials;\nb)\tif the MS supports equivalent SNPNs, an equivalent SNPN; or\nc)\tif the MS supports access to an SNPN using credentials from a credentials holder, an SNPN which supports access using credentials from a credentials holder.\nThe MS can have several sets of subscriber identifiers, credentials, SNPN identities, and other parameters related to SNPN selection (see clause 4.9.3.0). There are two modes for SNPN selection:\ni)\tAutomatic SNPN selection mode.\nii)\tManual SNPN selection mode.\nFor onboarding services in SNPN, the MS operating in SNPN access operation mode over 3GPP access selects an SNPN indicating that onboarding is allowed. There are two modes for SNPN selection for onboarding services in SNPN:\ni)\tAutomatic SNPN selection mode.\nii)\tManual SNPN selection mode.\nAn SNPN selected for localized services in SNPN is an SNPN that is selected by an MS supporting access to an SNPN providing access for localized services in SNPN, when the access for localized services in SNPN is enabled, and the SNPN is selected according to:\na)\tclause 4.9.3.1.1 bullet a0);\nb)\tclause 4.9.3.2.1 bullet a0); or\nc)\tis manually selected by the user; and\ni)\tthe validity information of the SNPN is met;\nii)\tthe validity information of GIN(s) broadcasted by the SNPN is met; or\niii)\tboth.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.10\tMinimization of service interruption",
                    "description": "",
                    "summary": "",
                    "text_content": "The MS may support Minimization of service interruption (MINT).\nMINT is not applicable in SNPNs.\nFor a PLMN that provides disaster roaming services, if one of the CAG-ID(s) broadcasted by a CAG cell for the PLMN is authorized based on the \"Allowed CAG list\" included in the entry for the PLMN in the \"CAG information list\", then the UE may attempt to access the PLMN on the CAG cell for disaster roaming services.\nIf the MS supports MINT, the MS can be provisioned by the network with:\na)\tan indication of whether disaster roaming is enabled in the UE, provided by the HPLMN;\nb)\ta \"list of PLMN(s) to be used in disaster condition\" provided by the HPLMN, consisting of zero or more entries, each containing a PLMN ID. The PLMNs are listed in order of decreasing priority, with the first PLMN being the highest priority PLMN;\nc)\tone or more \"list of PLMN(s) to be used in disaster condition\", where each VPLMN can provide one \"list of PLMN(s) to be used in disaster condition\", consisting of zero or more entries, each containing a PLMN ID. The PLMNs are listed in order of decreasing priority, with the first PLMN being the highest priority PLMN;\nd)\ta disaster roaming wait range consisting of a minimum wait time and a maximum wait time;\ne)\ta disaster return wait range consisting of a minimum wait time and a maximum wait time; and\nf)\tan indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN', provided by the HPLMN.\nThe network may provide the \"list of PLMN(s) to be used in disaster condition\", the disaster roaming wait range and the disaster return wait range to the UE during a successful registration procedure or a generic UE configuration update procedure. The network may also provide the disaster return wait range to the UE during a network initiated de-registration procedure, an unsuccessful registration procedure or an unsuccessful service request procedure. The HPLMN may also provide an indication of whether disaster roaming is enabled in the UE and an indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN' during a UE parameters update procedure.\nThe indication of whether disaster roaming is enabled in the UE, the indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN', one or more instances of \"list of PLMN(s) to be used in disaster condition\" each stored with the PLMN identity of the PLMN that provided it, the disaster roaming wait range and the disaster return wait range provisioned by the network are stored in the non-volatile memory of the ME, as specified in 3GPP TS 24.501 [64] annex C.\nIn addition, the MS can also be pre-configured with an indication of whether disaster roaming is enabled in the UE, the indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN', a \"list of PLMN(s) to be used in disaster condition\" provided by the HPLMN, a disaster roaming wait range and a disaster return wait range stored in the USIM (see 3GPP TS 31.102 [40]).\n3GPP TS 24.501 [64] annex C specifies the conditions under which the indication of whether disaster roaming is enabled in the UE, the indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN', the one or more \"lists of PLMN(s) to be used in disaster condition\", the disaster roaming wait range and the disaster return wait range stored in the ME are deleted. Additionally:\na)\twhen a USIM is inserted:\n1)\tif:\ni)\tno indication of whether disaster roaming is enabled in the UE is stored in the non-volatile memory of the ME; or\nii)\tthe SUPI from the USIM does not match the SUPI stored together with the indication of whether disaster roaming is enabled in the UE in the non-volatile memory of the ME;\nand the MS has an indication of whether disaster roaming is enabled in the UE stored in the USIM (see 3GPP TS 31.102 [22]), the MS shall store the indication of whether disaster roaming is enabled in the UE from the USIM into the ME, as specified in 3GPP TS 24.501 [64] annex C;\n2)\tif:\ni)\tno disaster roaming wait range is stored in the non-volatile memory of the ME; or\nii)\tthe SUPI from the USIM does not match the SUPI stored together with the disaster roaming wait range in the non-volatile memory of the ME;\nand the MS has a disaster roaming wait range stored in the USIM (see 3GPP TS 31.102 [22]), the MS shall store the disaster roaming wait range from the USIM into the ME, as specified in 3GPP TS 24.501 [64] annex C; and\n3)\tif:\ni)\tno disaster return wait range is stored in the non-volatile memory of the ME; or\nii)\tthe SUPI from the USIM does not match the SUPI stored together with the disaster return wait range in the non-volatile memory of the ME;\nand the MS has a disaster return wait range stored in the USIM (see 3GPP TS 31.102 [22]), the MS shall store the disaster return wait range from the USIM into the ME, as specified in 3GPP TS 24.501 [64] annex C;\n4)\tif:\ni)\tthe indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN' is stored in the non-volatile memory of the ME; or\nii)\tthe SUPI from the USIM does not match the SUPI stored together with the indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN' in the non-volatile memory of the ME;\nand the MS has an indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN' stored in the USIM (see 3GPP TS 31.102 [22]), the MS shall store the indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN' from the USIM into the ME, as specified in 3GPP TS 24.501 [64] annex C; and\n5)\tif:\ni)\tno \"list of PLMN(s) to be used in disaster condition\" provided by the HPLMN is stored in the non-volatile memory of the ME; or\nii)\tthe SUPI from the USIM does not match the SUPI stored together with the \"list of PLMN(s) to be used in disaster condition\" provided by the HPLMN in the non-volatile memory of the ME;\nand the MS has a \"list of PLMN(s) to be used in disaster condition\" provided by the HPLMN stored in the USIM (see 3GPP TS 31.102 [22]), the MS shall store the \"list of PLMN(s) to be used in disaster condition\" provided by HPLMN from the USIM into the ME, as specified in 3GPP TS 24.501 [64] annex C;\nb)\twhen the ME receives a USAT REFRESH command indicating that:\n1)\tthe indication of whether disaster roaming is enabled in the UE stored in the USIM has been updated, the MS shall store the indication of whether disaster roaming is enabled in the UE from the USIM into the ME, as specified in 3GPP TS 24.501 [64] annex C;\n2)\tthe disaster roaming wait range stored in the USIM has been updated, the MS shall store the disaster roaming wait range from the USIM into the ME, as specified in 3GPP TS 24.501 [64] annex C;\n3)\tthe disaster return wait range stored in the USIM has been updated, the MS shall store the disaster return wait range from the USIM into the ME, as specified in 3GPP TS 24.501 [64] annex C;\n4)\tthe indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN' stored in the USIM has been updated, the MS shall store the indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN' from the USIM into the ME, as specified in 3GPP TS 24.501 [64] annex C; or\n5)\tthe \"list of PLMN(s) to be used in disaster condition\" provided by the HPLMN stored in the USIM has been updated, the MS shall store the \"list of PLMN(s) to be used in disaster condition\" provided by the HPLMN from the USIM into the ME, as specified in 3GPP TS 24.501 [64] annex C; or\nNOTE 1:\tThe MS ignores the indication of whether disaster roaming is enabled in the UE stored in the USIM except when the USIM is inserted or when the ME receives a USAT REFRESH command indicating that the indication of whether disaster roaming is enabled in the UE stored in the USIM has been updated.\nNOTE 2:\tThe MS ignores the disaster roaming wait range stored in the USIM except when the USIM is inserted or when the ME receives a USAT REFRESH command indicating that the disaster roaming wait range stored in the USIM has been updated.\nNOTE 3:\tThe MS ignores the disaster return wait range stored in the USIM except when the USIM is inserted or when the ME receives a USAT REFRESH command indicating that the disaster return wait range stored in the USIM has been updated.\nNOTE 4:\tThe MS ignores the indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN' stored in the USIM except when the USIM is inserted or when the ME receives a USAT REFRESH command indicating that the indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN' stored in the USIM has been updated.\nNOTE 5:\tThe MS ignores the \"list of PLMN(s) to be used in disaster condition\" provided by the HPLMN stored in the USIM except when the USIM is inserted or when the ME receives a USAT REFRESH command indicating that the \"list of PLMN(s) to be used in disaster condition\" provided by the HPLMN stored in the USIM has been updated.\nIf the MS does not have an indication of whether disaster roaming is enabled in the UE stored in the ME, or the indication of whether disaster roaming is enabled in the UE stored in the ME is set to \"Disaster roaming is disabled in the UE\", disaster roaming is disabled at the MS. In this case, the MS shall not perform disaster roaming.\nUpon selecting a PLMN for disaster roaming, if there is a disaster roaming wait range stored in the ME, the MS shall generate a random number within the disaster roaming wait range and start a timer set to the generated random number. While the timer is running, the MS shall not initiate registration with the exception of performing an initial registration for emergency services, in the selected PLMN. If performing an initial registration for emergency services in the selected PLMN, the MS shall keep the timer running. Upon expiration of the timer, if the MS does not have an emergency PDU session, the MS may initiate registration, if still camped on the selected PLMN. Upon expiration of the timer, if the MS has an emergency PDU session, the MS shall initiate registration after release of the emergency PDU session, if still camped on the selected PLMN.\nUpon determining that a disaster condition has ended and selecting the PLMN previously with disaster condition, if there is a disaster return wait range stored in the ME, the MS shall generate a random number within the disaster return wait range and start a timer set to the generated random number. While the timer is running, the MS shall not initiate registration with the exception of performing an initial registration for emergency services, in the selected PLMN. If performing an initial registration for emergency services in the selected PLMN, the MS shall keep the timer running. Upon expiration of the timer, if the MS does not have an emergency PDU session, the MS may initiate registration, if still camped on the selected PLMN. Upon expiration of the timer, if the MS has an emergency PDU session, the MS shall initiate registration after release of the emergency PDU session, if still camped on the selected PLMN.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.11\tSignal level enhanced network selection",
                    "description": "",
                    "summary": "",
                    "text_content": "Signal level enhanced network selection is optionally supported by the home operator.\nSignal level enhanced network selection applies only to NB-IoT, GERAN EC-GSM-IoT and Category M1 or M2 of E-UTRA. An MS supporting any, or a combination, of NB-IoT, GERAN EC-GSM-IoT and Category M1 or M2 of E-UTRA shall apply signal level enhanced network selection if the following conditions are fulfilled:\n1)\tThe MS is in automatic PLMN selection mode;\n2)\tThe MS supports the \"Operator controlled signal threshold per access technology\" as specified in 3GPP TS 22.011 [19];\n3)\tThe MS is configured for using signal level enhanced network selection as specified in 3GPP TS 24.368 [50];\n4)\tThe MS is configured for using signal level enhanced network selection as specified in 3GPP TS 31.102 [40]; and\n5)\tThe \"Operator controlled signal threshold per access technology\" is configured in the USIM as specified in 3GPP TS 31.102 [40].\nNOTE 1:\tThe usage of the \"Operator controlled signal threshold per access technology\" is intended only for IoT stationary devices (see 3GPP TS 22.011 [19]).\nNOTE 2:\t\"Operator controlled signal threshold per access technology\" is not expected to be supported by non-IoT devices.\nThe HPLMN can configure the MS with an \"Operator controlled signal threshold per access technology\" stored in the USIM (see 3GPP TS 31.102 [40]), which consists of one or more entries, each containing:\na)\ta home operator controlled signal threshold; and\nb)\tan access technology.\nThe \"Operator controlled signal threshold per access technology\" is specific for a certain access technology and when applicable, applies to all allowable PLMNs with the corresponding access technology combination.\nThe HPLMN can update the \"Operator controlled signal threshold per access technology\" via steering of roaming information. When the ME receives a USAT REFRESH command indicating that the \"Operator controlled signal threshold per access technology\" stored in the USIM has been updated, an MS which applies SENSE shall use the \"Operator controlled signal threshold per access technology\" provided by the HPLMN for the subsequent PLMN selections.\nThe \"Operator controlled signal threshold per access technology\" can also be received from the HPLMN over the control plane steering of roaming mechanism.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tOverall process structure",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tProcess goal",
                    "description": "",
                    "summary": "",
                    "text_content": "The aim of the idle mode processes is to ensure that the registered PLMN is the selected PLMN and that the registered SNPN is the selected SNPN.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tStates description",
                    "description": "",
                    "summary": "",
                    "text_content": "Each of the processes of PLMN selection and SNPN selection, cell selection and location registration can be described by a set of states. The overall state of the mobile is thus a composite of the states of the three processes. In some cases, an event which causes a change of state in one process may trigger a change of state in another process, e.g., camping on a cell in a new registration area triggers an LR request. Except for SNPN selection, the relationship between the processes is illustrated in figure 1 in clause 5.\nExcept for SNPN selection, the states in which the MS may be, for each of the processes, are described below and illustrated in figures 2a, 2b and 3 in clause 5. For many of the states, a fuller description can be found in other Technical Specifications, and a reference to the Technical Specification is given after the state description.\nIn the event of any conflict between the diagrams and the text in the present document, the text takes precedence.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.3\tList of states",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.3.1\tList of states for the PLMN selection process",
                            "text_content": "A1\tTrying RPLMN - The MS is trying to perform a Location Registration on the registered PLMN.\nA2\tOn PLMN - The MS has successfully registered on a PLMN.\nA3\tTrying PLMN - The MS is trying to register on a PLMN in the ordered list of PLMNs.\nA4\tWait for PLMNs to appear - There are no allowable and available PLMNs at present and the MS is waiting for one to appear.\nA5\tHPLMN search in progress - The MS is trying to find if the HPLMN is available.\nA6\tNo SIM - There is no SIM in the MS, or certain LR responses have been received.\nM1\tTrying registered PLMN - The MS is trying to perform a Location Registration on the registered PLMN.\nM2\tOn PLMN - The MS has successfully registered on a PLMN.\nM3\tNot on PLMN - The MS has failed to register on the selected PLMN.\nM4\tTrying PLMN - The MS is trying to register on a user selected PLMN.\nM5\tNo SIM - There is no SIM in the MS, or certain LR responses have been received.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.2\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.3\tList of states for location registration (figure 3)",
                            "text_content": "The states are entered depending on responses to location registration (LR) requests. Independent update states exist for GPRS and for non-GPRS operation in MSs capable of GPRS and non-GPRS services.\nL0\tNull – The MS is considered in this state when switched off.\nL1\tUpdated - The MS enters this state if an LR request is accepted. The update status is set to \"UPDATED\". The GPRS and the non-GPRS update state of an MS may enter \"Updated\" as a result of combined signalling or as a result of individual signalling depending on the capabilities of the network.\nL2\tIdle, No IMSI - The MS enters this state if an LR request is rejected with cause:\na)\tIMSI unknown in HLR;\nb)\tillegal ME;\nc)\tillegal MS;\nd)\tGPRS services not allowed,\ne)\tGPRS services and non-GPRS services not allowed,\nor if there is no SIM. All update states of an MS enter this state regardless whether received by individual or combined signalling for events b) and c). Event a) has no influence on the GPRS update state. Events b) and c) result in \"ROAMING NOT ALLOWED\" for the GPRS and/or non-GPRS update status depending on the specific location registration procedure. Event d) results in \"ROAMING NOT ALLOWED\" for the GPRS update status. Event e) results in \"ROAMING NOT ALLOWED\" for the GPRS update status and non-GPRS update status.\nIf a SIM is present, the non-GPRS update status of the SIM is set to \"ROAMING NOT ALLOWED\".\nL3\tRoaming not allowed - The MS enters this state if it receives an LR reject message with the cause:\na)\tPLMN not allowed;\nb)\tLocation area not allowed;\nc)\tTracking area not allowed;\nd)\tRoaming not allowed in this location area;\ne)\tRoaming not allowed in this tracking area;\nf)\tGPRS services not allowed in this PLMN;\ng)\tNo suitable cells in location area;\nh)\tNo suitable cells in tracking area;\ni)\tNot authorized for this CSG.\nExcept from event f) all update states of the MS are set to \"Roaming not allowed\" regardless whether received by individual or combined signalling. Event f) results in \"Roaming not allowed\" for the GPRS update state only. Event f) has no influence on the non-GPRS update state.\tThe behaviour of the MS in the roaming not allowed state is dependent on the LR reject cause as shown in table 2 in clause 5. Additionally:\n-\tin automatic mode, \"PLMN not allowed\", \"Roaming not allowed in this location area\" and \"Roaming not allowed in this tracking area\" cause the Automatic Network Selection procedure of clause 4.4.3.1.1 to be started; it is also caused by \"GPRS services not allowed in this PLMN\" when received by a GPRS MS operating in MS operation mode C;\n-\tin manual mode, \"PLMN not allowed\" and \"Roaming not allowed\" cause the Manual Network Selection procedure of clause 4.4.3.1.2 to be started; it is also caused by \"GPRS services not allowed in this PLMN\" when received by a GPRS MS operating in MS operation mode C.\nL4\tNot updated - The MS enters this state if any LR failure not specified for states L2 or L3 occurs, in which cases the MS is not certain whether or not the network has received and accepted the LR attempt. The non-GPRS update status on the SIM and/or the GPRS update status are set to \"NOT UPDATED\" depending on the specific location registration procedure and their outcome.\nL5\tLR request – The MS enters this state when determining that a LR request is to be made.\nL6\tLR pending – The MS enters this state after having started the LR, waiting for the outcome (response message from the network).\nNOTE\tThis clause does not describe all the cases. For more details refer to 3GPP TS 24.008 [23], 3GPP TS 24.301 [23A] and 3GPP TS 24.501 [64].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.4\tPLMN selection process",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.4.1\tIntroduction",
                            "text_content": "There are two modes for PLMN selection, automatic and manual. These are described in clauses 4.4.3 below and illustrated in figures 2a to 2b in clause 5.\nNOTE:\tFigures 2a to 2b in clause 5 do not cover CAG selection aspects.\nThe MS not operating in SNPN access operation mode over 3GPP access shall perform PLMN selection process.\nThe MS operating in SNPN access operation mode over 3GPP access shall not perform PLMN selection process.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.2\tRegistration on a PLMN",
                            "text_content": "The MS shall perform registration on the PLMN if the MS is capable of services which require registration. In both automatic and manual modes, the concept of registration on a PLMN is used. An MS successfully registers on a PLMN if:\na)\tthe MS has found a suitable cell of the PLMN to camp on; and\nb)\tan LR request from the MS has been accepted in the registration area of the cell on which the MS is camped (see table 1).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.3\tPLMN selection",
                            "text_content": "The registration on the selected PLMN and the location registration are only necessary if the MS is capable of services which require registration. Otherwise, the PLMN selection procedures are performed without registration.\nThe ME shall utilise all the information stored in the SIM related to the PLMN selection; e.g. \"HPLMN Selector with Access Technology\", \"User Controlled PLMN Selector with Access Technology\", \"Forbidden PLMNs\", \"Equivalent HPLMN\", see 3GPP TS 31.102 [40]. The ME shall also utilise the extension of the \"forbidden PLMNs\" list that it has stored locally on the ME if available.\nThe ME shall either utilise the \"Operator controlled PLMN Selector with Access Technology\" that it has stored locally on the ME, or the Operator controlled PLMN Selector with Access Technology\" stored in the SIM, for the purposes of PLMN selection.\nThe \"HPLMN Selector with Access Technology\", \"User Controlled PLMN Selector with Access Technology\" and \"Operator Controlled PLMN Selector with Access Technology\" data files in the SIM include associated access technologies for each PLMN entry, see 3GPP TS 31.102 [40]. The PLMN/access technology combinations are listed in priority order. If an entry indicates more than one access technology, then no priority is defined for the access technologies within this entry and the priority applied to each access technology within this entry is an implementation issue. If no particular access technology is indicated in an entry, it shall be assumed that all access technologies supported by the ME apply to the entry. If an entry only indicates access technologies not supported by the ME, the entry shall be ignored. If an entry indicates at least one access technology supported by the ME, the entry shall be used in the PLMN selection procedures if the other criteria defined for the specific PLMN selection procedures are fulfilled.\nThe Mobile Equipment stores a list of \"equivalent PLMNs\". This list is replaced or deleted at the end of each location update procedure, routing area update procedure, GPRS attach procedure, tracking area update procedure, EPS attach procedure, and registration procedure. The list is deleted by an MS attached for emergency bearer services or for access to RLOS after detach or registered for emergency services after de-registration. The stored list consists of a list of equivalent PLMNs as downloaded by the network plus the PLMN code of the registered PLMN that downloaded the list. All PLMNs in the stored list, in all access technologies supported by the PLMN, are regarded as equivalent to each other for PLMN selection, cell selection/re-selection and handover.\nWhen the MS reselects to a cell in a shared network, and the cell is a suitable cell for multiple PLMN identities received on the BCCH or on the EC-BCCH the AS indicates these multiple PLMN identities to the NAS according to 3GPP TS 44.018 [34], 3GPP TS 44.060 [39], 3GPP TS 25.304 [32], 3GPP TS 36.304 [43] and 3GPP TS 38.304 [61]. The MS shall choose one of these PLMNs. If the registered PLMN is available among these PLMNs, the MS shall not choose a different PLMN.\nThe MS shall not use the PLMN codes contained in the \"HPLMN Selector with Access Technology\" data file.\nIt is possible for the home network operator to identify alternative Network IDs as the HPLMN. If the EHPLMN list is present, and not empty, the entries in the EHPLMN list are used in the network selection procedures. When attempting to select a network the highest priority EHPLMN that is available shall be selected. If the EHPLMN list is present and is empty or if the EHPLMN list is not present, the HPLMN derived from the IMSI is used for network selection procedures.\nNOTE 1:\tThe \"HPLMN Selector with Access Technology\" data file is only used by the MS to get the HPLMN access technologies related to the HPLMN code which corresponds to the PLMN code included in the IMSI if the EHPLMN list is not present or is empty. If the EHPLMN list is present then this data field is applicable to all the entries within the EHPLMN list.\nNOTE 2:\tDifferent GSM frequency bands (e.g. 900, 1800, 1900, 400) are all considered GSM access technology. An MS supporting more than one band should scan all the bands it's supports when scanning for GSM frequencies. However GSM COMPACT systems which use GSM frequency bands but with the CBPCCH broadcast channel are considered as a separate access technology from GSM.\nNOTE 3:\tThe inclusion of the HPLMN derived from the IMSI in the EHPLMN list is allowed. The priority of the HPLMN derived from the IMSI is given by its position in the EHPLMN list, see 3GPP TS 31.102 [40].\nThe MS may support minimization of service interruption (MINT).\na)\tif\n-\tsignal level enhanced network selection is not applicable (see clause 3.11); or\n-\tthe MS has stopped applying signal level enhanced network selection according to requirement v) of clause 4.4.3.1.1;\nthen the MS selects the registered PLMN or equivalent PLMN (if it is available) using all access technologies that the MS is capable of without considering the \"Operator controlled signal threshold per access technology\" stored in the USIM; or\nb)\tif:\n-\tsignal level enhanced network selection is applicable (see clause 3.11); and\n-\tthe received signal quality from a candidate PLMN/access technology combination comprising of a registered PLMN or an equivalent PLMN (if it is available) is equal to or greater than the \"Operator controlled signal threshold per access technology\" of the access technology configured in the USIM.\nthe MS shall select the registered PLMN or equivalent PLMN (if it is available) and the access technology for which the received signal quality is equal to or greater than the \"Operator controlled signal threshold per access technology\" stored in the USIM. If for the registered PLMN or equivalent PLMN there are two or more access technologies for which the received signal quality is equal to or greater than the \"Operator controlled signal threshold per access technology\" stored in the USIM, it is up to implementation which access technology is selected by the MS.\nand if necessary (in the case of recovery from lack of coverage, see clause 4.5.2) attempts to perform a Location Registration.\nNOTE 1:\tThe MS in automatic network selection mode can end the PLMN search procedure once the registered PLMN or equivalent PLMN is found on an access technology.\nNOTE 2:\tAn MS in automatic network selection mode can use location information to determine which PLMNs can be available in its present location.\nEXCEPTION: As an alternative option to this, if the MS is in automatic network selection mode and it finds coverage of an EHPLMN, the MS may register to that EHPLMN and not return to the registered PLMN or equivalent PLMN. If the EHPLMN list is not present or is empty, and the HPLMN is available, the MS may register on the HPLMN and not return to the registered PLMN or equivalent PLMN. The operator shall be able to control by SIM configuration whether an MS that supports this option is permitted to perform this alternative behaviour. If signal level enhanced network selection is applicable (see clause 3.11), the MS may register to that EHPLMN or HPLMN only over an access technology for which the received signal quality is equal to or greater than the \"Operator controlled signal threshold per access technology\" stored in the USIM.\nEXCEPTION: As an alternative option to this, if the MS is in automatic network selection mode, the MS has a list of \"PLMNs where registration was aborted due to SOR\" and the registered PLMN is part of the list of \"PLMNs where registration was aborted due to SOR\", the MS may choose not to return to the registered PLMN or equivalent PLMN and proceed as defined in clause 4.4.3.1.1 with the exception that in iii), the MS considers PLMNs which are in the list of \"PLMNs where registration was aborted due to SOR\" as lowest priority.\nEXCEPTION: In A/Gb mode an MS with voice capability, shall not search for CPBCCH carriers. In A/Gb mode an MS not supporting packet services shall not search for CPBCCH carriers.\nIf successful registration is achieved, the MS indicates the selected PLMN.\nIf:\n-\tthere is no registered PLMN;\n-\tregistration is not possible due to the PLMN being unavailable or registration failure; or\n-\tsignal level enhanced network selection is applicable (see clause 3.11) and the received signal quality of all access technologies (if the MS is capable of and if it is available) from the registered PLMN or equivalent PLMN (if available) is lower than the \"Operator controlled signal threshold per access technology\" stored in the USIM of the corresponding access technology.\nthe MS follows one of the following two procedures depending on its PLMN selection operating mode. At switch on, if the MS provides the optional feature of user preferred PLMN selection operating mode at switch on then this operating mode shall be used. Otherwise, the MS shall use the PLMN selection mode that was used before switching off.\nEXCEPTION: At switch on, if the MS is in manual mode and neither registered PLMN nor PLMN that is equivalent to it is available, but EHPLMN is available, then instead of performing the manual network selection mode procedure of clause 4.4.3.1.2 the MS may select and attempt registration on the highest priority EHPLMN. If the EHPLMN list is not available or is empty and the HPLMN is available, then the MS may select and attempt registration on the HPLMN. If the MS supports CAG and needs to select or attempt registration on the highest priority EHPLMN or HPLMN, the MS follows network selection procedures of clause 4.4.3.1.1 bullet m). The MS shall remain in manual mode.\nNOTE 3:\tIf successful registration is achieved, then the current serving PLMN becomes the registered PLMN and the MS does not store the previous registered PLMN for later use.\nEXCEPTION: If registration is not possible on recovery from lack of coverage due to the registered PLMN being unavailable, an MS attached to GPRS services, attached via E-UTRAN or registered via the NG-RAN may, optionally, continue looking for the registered PLMN for an implementation dependent time.\nNOTE 4:\tAn MS attached to GPRS services, attached via E-UTRAN or registered via the NG-RAN should use the above exception only if one or more PDP contexts, PDN connections or PDU sessions are currently active.\nEXCEPTION: At switch on, if the RPLMN is a PLMN with which the MS was registered for disaster roaming services and the MS is registered via non-3GPP access connected to 5GCN or an NG-RAN cell of the RPLMN broadcasts neither the disaster related indication nor a \"list of one or more PLMN(s) with disaster condition for which disaster roaming services is offered by the available PLMN\" including the MS determined PLMN with disaster condition or an allowable PLMN is available then the MS will ignore RPLMN and its equivalent PLMN.\nThe MS selects and attempts registration on other PLMN/access technology combinations, if available and, for bullets i, ii, iii, iv, v, allowable, in the following order:\ni)\teither the HPLMN (if the EHPLMN list is not present or is empty) or the highest priority EHPLMN that is available (if the EHPLMN list is present);\nii)\teach PLMN/access technology combination in the \"User Controlled PLMN Selector with Access Technology\" data file in the SIM (in priority order);\niii)\teach PLMN/access technology combination in the \"Operator Controlled PLMN Selector with Access Technology\" data file in the SIM (in priority order) or stored in the ME (in priority order);\niv)\tother PLMN/access technology combinations with received high quality signal in random order;\nNOTE 1:\tHigh quality signal is defined in the appropriate AS specification.\nv)\tother PLMN/access technology combinations in order of decreasing signal quality.\nvi)\tPLMN/NG-RAN combinations for any forbidden PLMNs broadcasting the PLMN ID of the MS determined PLMN with disaster condition or broadcasting the disaster related indication and matching the below conditions:\na)\tif the indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN' is set to true:\n-\teach PLMN in the \"list of PLMN(s) to be used in disaster condition\" stored in the ME which is associated with the PLMN ID of the MS determined PLMN with disaster condition, if any, ordered based on this list; otherwise\n-\tif the ME does not have a stored \"list of PLMN(s) to be used in disaster condition\" associated with the PLMN ID of the MS determined PLMN with disaster condition, each PLMN in the \"list of PLMN(s) to be used in disaster condition\" stored in the ME which is associated with the PLMN ID of the HPLMN, if any, ordered based on this list.\nb)\tif the indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN' is set to false:\n-\teach PLMN in the \"list of PLMN(s) to be used in disaster condition\" stored in the ME which is associated with the HPLMN, if any, ordered based on this list.\nvii)\tPLMN /NG-RAN combinations for other forbidden PLMNs broadcasting the PLMN ID of the MS determined PLMN with disaster condition or broadcasting the disaster related indication, in random order.\nWhen following the above procedure the following requirements apply:\na)\tAn MS with voice capability shall ignore PLMNs for which the MS has identified at least one GSM COMPACT.\nb)\tIn A/Gb mode or GSM COMPACT, an MS with voice capability, or an MS not supporting packet services shall not search for CPBCCH carriers.\nc)\tIn ii and iii, the MS should limit its search for the PLMN to the access technology or access technologies associated with the PLMN in the appropriate PLMN Selector with Access Technology list (User Controlled or Operator Controlled selector list).\nAn MS using a SIM without access technology information storage (i.e. the \"User Controlled PLMN Selector with Access Technology\" and the \"Operator Controlled PLMN Selector with Access Technology\" data files are not present) shall instead use the \"PLMN Selector\" data file, for each PLMN in the \"PLMN Selector\" data file, the MS shall search for all access technologies it is capable of. The priority ordering amongst the access technologies is implementation dependent.\nd)\tIn iv, v, vi and vii, the MS shall search for all access technologies it is capable of, before deciding which PLMN to select.\ne)\tIn ii, and iii, a packet only MS which supports GSM COMPACT, but using a SIM without access technology information storage (i.e. the \"User Controlled PLMN Selector with Access Technology\" and the \"Operator Controlled PLMN Selector with Access Technology\" data files are not present) shall instead use the \"PLMN Selector\" data file, for each PLMN in the \"PLMN Selector\" data file, the MS shall search for all access technologies it is capable of and shall assume GSM COMPACT access technology as the lowest priority radio access technology.\nf)\tIn i, the MS shall search for all access technologies it is capable of. No priority is defined for the preferred access technology and the priority is an implementation issue, but \"HPLMN Selector with Access Technology\" data file on the SIM may be used to optimise the procedure.\ng)\tIn i, an MS using a SIM without access technology information storage (i.e. the \"HPLMN Selector with Access Technology\" data file is not present) shall search for all access technologies it is capable of. The priority ordering amongst the access technologies is implementation dependent. A packet only MS which supports GSM COMPACT using a SIM without access technology information storage shall also assume GSM COMPACT access technology as the lowest priority radio access technology.\nNOTE 2:\tFor f) and g), the MS in automatic network selection mode can end the PLMN search procedure once the HPLMN or the highest priority EHPLMN is found on an access technology.\nNOTE 3:\tFor i, ii and iii, the MS can use location information to determine which PLMNs can be available in its present location.\nh)\tIn v, the MS shall order the PLMN/access technology combinations in order of decreasing signal quality within each access technology. The order between PLMN/access technology combinations with different access technologies is an MS implementation issue.\nNOTE 4:\tRequirements a) and b) apply also to requirement d), so a GSM voice capable MS should not search for GSM COMPACT PLMNs, even if capable of GSM COMPACT.\nNOTE 5:\tRequirements a) and b) apply also to requirement f), so a GSM voice capable MS should not search for GSM COMPACT PLMNs, even if this is the only access technology on the \"HPLMN Selector with Access Technology\" data file on the SIM.\ni)\tIn i to vii, the MS shall not consider PLMNs where voice service was not possible as PLMN selection candidate, unless such PLMN is available in GERAN or UTRAN or no other allowed PLMN is available.\nj)\tIn i to v, if the MS only supports EMM-REGISTERED without PDN connection (see 3GPP TS 24.301 [23A]), the MS shall not consider PLMNs which do not advertise support of EMM-REGISTERED without PDN connection.\nk)\tIn i to v, if the MS only supports control plane CIoT EPS optimization (see 3GPP TS 24.301 [23A]) and the MS camps on a E-UTRA cell which is not NB-IoT cell (see 3GPP TS 36.304 [43], 3GPP TS 36.331 [42]), the MS shall not consider PLMNs which do not advertise support of EPS services with control plane CIoT EPS optimization.\nl)\tIn i to vii, if the MS is in eCall only mode, the MS shall not consider PLMNs which do not advertise support for eCall over IMS, unless such PLMNs are available in GERAN or UTRAN.\nNOTE 6:\tAs an implementation option, an MS in eCall only mode that was not able to select any PLMN according to l) can perform a second iteration of i to v with no restriction.\nm)\tIn i to vii, if the MS supports CAG and:\n1)\tis provisioned with a non-empty \"CAG information list\", the MS shall consider a PLMN indicated by an NG-RAN cell only if:\nA)\tthe cell is a CAG cell and broadcasts a CAG-ID for the PLMN such that there exists an entry with the PLMN ID of the PLMN in the \"CAG information list\" and the CAG-ID is authorized based on the \"Allowed CAG list\" of the entry; or\nB)\tthe cell is not a CAG cell and:\n-\tthere is no entry with the PLMN ID of the PLMN in the \"CAG information list\"; or\n-\tthere exists an entry with the PLMN ID of the PLMN in the \"CAG information list\" but the \"indication that the MS is only allowed to access 5GS via CAG cells\" is not included in the entry; or\n2)\tis provisioned with an empty \"CAG information list\" or is not provisioned with a \"CAG information list\", the MS shall consider a PLMN indicated by an NG-RAN cell only if the cell is not a CAG cell.\nn)\tIn i to vii, if the MS only supports control plane CIoT 5GS optimization (see 3GPP TS 23.501 [62]) and the MS camps on an E-UTRA cell connected to 5GCN, which is not NB-IoT cell (see 3GPP TS 36.304 [43], 3GPP TS 36.331 [42]), the MS shall not consider PLMNs which do not advertise support of 5GS services with control plane CIoT 5GS optimization.\no)\tIn i to vii, if the MS supports CIoT 5GS optimizations, the MS shall not consider the PLMN/access technology combinations for which the MS preferred CIoT network behaviour is not advertised as supported by the PLMN/access technology combination (see 3GPP TS 24.501 [64]).\nNOTE 7:\tAs an implementation option, the MS supporting CIoT 5GS optimizations that was not able to select any PLMN according to o) can perform a second iteration of i to v with no restriction.\np)\tIn iii, the MS shall use the PLMN/access technology combination in the \"Operator Controlled PLMN Selector with Access Technology\" stored in the ME, if the last update of the \"Operator Controlled PLMN Selector with Access Technology\" was due to receiving steering of roaming information containing the \"list of preferred PLMN/access technology combinations\" (see annex C) and storing it in the ME. Otherwise, the MS shall use the \"Operator Controlled PLMN Selector with Access Technology\" list retrieved from the SIM.\nq1)\tfor vi and vii, if a forbidden PLMN is broadcasting the \"list of one or more PLMN(s) with disaster condition for which disaster roaming services is offered by the available PLMN\", the MS shall determine the MS determined PLMN with disaster condition as follows:\ni)\tif the MS's RPLMN is included in any \"list of one or more PLMN(s) with disaster condition for which disaster roaming services is offered by the available PLMN\" broadcast by any NG-RAN cell and is allowable, the MS shall consider that the MS's RPLMN is the MS determined PLMN with disaster condition; or\nii)\tif the MS's RPLMN is not included in any \"list of one or more PLMN(s) with disaster condition for which disaster roaming services is offered by the available PLMN\" broadcast by any NG-RAN cell or the MS's RPLMN is not allowable or the MS does not have a RPLMN (see table 1), the MS shall determine the MS determined PLMN with disaster condition from PLMNs:\n-\tin the \"list of one or more PLMN(s) with disaster condition for which disaster roaming services is offered by the available PLMN\" broadcast by any NG-RAN cell; and\n-\twhich are allowable;\nin the following order:\n-\teither the HPLMN (if the EHPLMN list is not present or is empty) or the highest priority EHPLMN that is available (if the EHPLMN list is present);\n-\teach PLMN in the \"User Controlled PLMN Selector with Access Technology\" data file in the SIM (in priority order);\n-\teach PLMN in the \"Operator Controlled PLMN Selector with Access Technology\" data file in the SIM (in priority order) or stored in the ME (in priority order); and\n-\tother PLMNs.\nq2)\tfor vi and vii, if a forbidden PLMN is broadcasting the \"disaster related indication\", the MS shall attempt to determine the MS determined PLMN with disaster condition as follows:\n1)\tif the country of the MS's RPLMN matches the country of a PLMN for which any NG-RAN cell broadcasts the \"disaster related indication\" and the MS's RPLMN is allowable, the MS shall consider that the MS's RPLMN is the MS determined PLMN with disaster condition; or\n2)\tif the country of the MS's RPLMN does not match the country of any PLMN for which any NG-RAN cell broadcasts the \"disaster related indication\" or the MS's RPLMN is not allowable, the MS shall determine the MS determined PLMN with disaster condition from allowable PLMN(s) where the country of allowable PLMN(s) matches the country of a PLMN for which any NG-RAN cell broadcasts the \"disaster related indication\" in the following order:\n-\teither the HPLMN (if the EHPLMN list is not present or is empty) or the highest priority EHPLMN that is available (if the EHPLMN list is present);\n-\teach PLMN in the \"User Controlled PLMN Selector with Access Technology\" data file in the SIM (in priority order);\n-\teach PLMN in the \"Operator Controlled PLMN Selector with Access Technology\" data file in the SIM (in priority order) or stored in the ME (in priority order).\nr)\tThe MS shall perform vi and vii to select a PLMN for disaster roaming services only if:\n1)\tthe MS supports MINT;\n2)\tthe indication of whether disaster roaming is enabled in the UE stored in the ME is set to \"Disaster roaming is enabled in the UE\";\n3)\tthere is no available PLMN which is allowable;\n4)\tthe MS is not in 5GMM-REGISTERED state and 5GMM-CONNECTED mode over non-3GPP access (see 3GPP TS 24.501 [64]);\n4a)\tthe MS does not have a PDN connection via an ePDG connected to EPC; and\n5)\tan NG-RAN cell of the PLMN or of a shared network where the PLMN is available:\nA)\tbroadcasts the disaster related indication for the PLMN. The disaster related indication broadcasted by the NG-RAN cell for the PLMN indicates that the PLMN is accessible for disaster inbound roamers, that this PLMN accepts disaster inbound roamers from any PLMN(s) other than the PLMN(s) available on the NG-RAN cell, and that a disaster condition applies to all PLMN(s) other than the PLMN(s) available on the NG-RAN cell in the location of the broadcast. If the disaster related indication is broadcasted, the disaster inbound roamers attempt to determine the MS determined PLMN with disaster condition as per bullet q2); or\nNOTE 8: \tIn case of a shared network, the disaster related indication is broadcasted per PLMN.\nB)\tbroadcasts a \"list of one or more PLMN(s) with disaster condition for which disaster roaming services is offered by the available PLMN\" which includes the MS determined PLMN with disaster condition as determined in bullet q1).\ns)\tIn i to vii, if the MS only supports NR RedCap and the MS camps on an NR cell connected to 5GCN, the MS shall not consider PLMNs which do not advertise support of NR RedCap.\nt)\tIn i to vii, if the MS detects a PLMN in satellite NG-RAN access technology which fulfils the conditions related to the list of \"PLMNs not allowed to operate at the present UE location\" as defined in clause 3.1, it shall not consider the PLMN as PLMN selection candidate for satellite NG-RAN access technology.\nu)\tIn i to vii, if the MS detects a PLMN in a satellite E-UTRAN access technology which fulfils the conditions related to the list of \"PLMNs not allowed to operate at the present UE location\" as defined in clause 3.1, it shall not consider the PLMN as PLMN selection candidate for the satellite E-UTRAN access technology.\nv)\tIn i), ii), iii), and v), if:\n-\tsignal level enhanced network selection is applicable (see clause 3.11); and\n-\tthe received signal quality of the candidate PLMN/access technology combination is lower than the threshold value indicated for the access technology in the \"Operator controlled signal threshold per access technology\" stored in the USIM.\nthe MS shall not consider the PLMN(s) in i) and PLMN/access technology combination(s) in ii), iii) and v) as selection candidate. If the received signal quality from none of the candidate PLMN(s) or PLMN/access technology combination(s) is equal to or greater than the \"Operator controlled signal threshold per access technology\" stored in the USIM, the MS shall stop applying signal level enhanced network selection and repeat the network selection procedure as specified in clause 4.4.3.1.\nIf successful registration is achieved, the MS indicates the selected PLMN.\nIf registration cannot be achieved because no PLMNs are available and allowable, and the MS does not support access to RLOS, the MS indicates \"no service\" to the user, waits until a new PLMN is available and allowable and then repeats the procedure.\nIf there were one or more PLMNs which were available and allowable, but an LR failure made registration on those PLMNs unsuccessful or an entry in any of the lists \"forbidden location areas for roaming\", \"forbidden tracking areas for roaming\", \"5GS forbidden tracking areas for roaming\", \"forbidden location areas for regional provision of service\", \"forbidden tracking areas for regional provision of service\", \"5GS forbidden tracking areas for regional provision of service\", \"CAG information list\", or \"PLMNs not allowed to operate at the present UE location\" prevented a registration attempt, the MS selects the first such PLMN again and enters a limited service state.\nIf:\n-\tthe MS supports access to RLOS;\n-\teither the UICC containing the USIM is not present in the MS, or the UICC containing the USIM is present in the MS and the MCC part of the IMSI in the USIM is present in the RLOS allowed MCC list configured in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]);\n-\tone or more PLMNs offering access to RLOS has been found;\n-\tregistration cannot be achieved on any PLMN; and\n-\tthe MS is in limited service state,\nthe MS shall select a PLMN offering access to RLOS as follows:\na)\tif at least one preferred PLMN exists based on the RLOS preferred PLMN list configured in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]) and the MCC part of the preferred PLMN ID is present in the RLOS allowed MCC list configured in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]), the MS shall select the preferred PLMN offering access to RLOS and indicate the selected preferred PLMN for access to RLOS; and\nb)\tif none of the preferred PLMNs for access to RLOS is available, the MS shall evaluate the remaining PLMNs offering access to RLOS that are not in the RLOS preferred PLMN list. If the MCC part of a PLMN ID is present in the RLOS allowed MCC list configured in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]), the MS shall select this PLMN and indicate the selected PLMN for access to RLOS.\nIf registration cannot be achieved because no PLMNs are available and allowable, and if no PLMN offering access to RLOS has been found, or none of the PLMNs offering access to RLOS is allowed to be accessed according to the RLOS allowed MCC list configured in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]), or the MS does not support access to RLOS, the MS indicates \"no service\" to the user, waits until a new PLMN is available and then repeats the procedure.\nThe MS indicates whether there are any PLMNs, which are available using all supported access technologies. This includes PLMNs in the \"forbidden PLMNs\" list, \"forbidden PLMNs for GPRS service\" list, PLMNs which only offer services not supported by the MS, and the list of \"PLMNs not allowed to operate at the present UE location\". An MS which supports GSM COMPACT shall also indicate GSM COMPACT PLMNs (which use PBCCH).\nIf displayed, PLMNs meeting the criteria above are presented in the following order:\ni)\teither the HPLMN (if the EHPLMN list is not present or is empty) or, if one or more of the EHPLMNs are available then based on an optional data field on the SIM either only the highest priority available EHPLMN is to be presented to the user or all available EHPLMNs are presented to the user in priority order. If the data field is not present on the SIM, then only the highest priority available EHPLMN is presented;\nii)\tPLMN/access technology combinations contained in the \" User Controlled PLMN Selector with Access Technology \" data file in the SIM (in priority order);\niii)\tPLMN/access technology combinations contained in the \"Operator Controlled PLMN Selector with Access Technology\" data file in the SIM (in priority order) or stored in the ME (in priority order);\niv)\tother PLMN/access technology combinations with received high quality signal in random order;\nNOTE 1:\tHigh quality signal is defined in the appropriate AS specification.\nv) \tother PLMN/access technology combinations in order of decreasing signal quality.\nIn ii and iii, an MS using a SIM without access technology information storage (i.e. the \"User Controlled PLMN Selector with Access Technology\" and the \"Operator Controlled PLMN Selector with Access Technology\" data files are not present) shall instead present the PLMNs contained in the \"PLMN Selector\" data file in the SIM (in priority order).\nIn v, requirement h) in clause 4.4.3.1.1 applies.\nIn i to v, requirements j), k) and l) in clause 4.4.3.1.1 apply.\nIn iii, requirement p) in clause 4.4.3.1.1 applies.\nIn GSM COMPACT, the non-support of voice services shall be indicated to the user.\nThe HPLMN may provide on the SIM additional information on the available PLMNs. If this information is provided, then the MS shall indicate it to the user. This information, provided as free text may include:\n-\tpreferred partner,\n-\troaming agreement status,\n-\tsupported services\nFurthermore, the MS may indicate whether the available PLMNs are present on the EHPLMN list, the Forbidden list, the User Controlled PLMN List or the Operator Controlled PLMN List. The MS may also indicate that the PLMN is not present on any of these lists.\nIf:\n-\tthe MS supports MINT;\n-\tthe MS is not registered via non-3GPP access connected to 5GCN;\n-\tthe MS has detected that the RPLMN is a MS determined PLMN with disaster condition as broadcasted by an NG-RAN cell of an available PLMN(s) (see clause 4.4.3.1.1);\n-\tonly forbidden PLMN(s) are available; and\n-\tthe MS receives indication that some of the forbidden PLMN(s) provide disaster roaming services to the MS(s) of the RPLMN (see clause 4.4.3.1.1),\nthen the MS may indicate to the user that those PLMN(s) support disaster roaming services.\nIn i to v, if the MS supports CAG, for each PLMN/access technology combination of NG-RAN access technology, the MS shall present to the user:\na)\tthe PLMN/access technology combination and a list of CAG-IDs composed of one or more CAG-IDs such that for each CAG-ID:\n1)\tthere is an available CAG cell which broadcasts the CAG-ID for the PLMN; and\n2)\tthe following is true:\ni)\tthere exists an entry with the PLMN ID of the PLMN in the \"CAG information list\" and the CAG-ID is authorized based on the \"Allowed CAG list\" of the entry; or\nii)\tthe available CAG cell broadcasting the CAG-ID for the PLMN also broadcasts that the PLMN allows a user to manually select the CAG-ID.\nFor each of the presented CAG-ID, the MS may indicate to the user whether the CAG-ID is authorized based on the \"Allowed CAG list\" stored in the UE; and\nb)\tthe PLMN/access technology combination without a list of CAG-IDs, if there is an available NG-RAN cell which is not a CAG cell for the PLMN. If there exists an entry for the presented PLMN in the \"CAG information list\" and the entry includes an \"indication that the MS is only allowed to access 5GS via CAG cells\", the MS may indicate to the user that the MS is only allowed to access the PLMN via CAG cells.\nIf the NAS receives a human-readable network name associated with a CAG-ID and a PLMN ID from the AS, the human-readable network name shall be sent along with the CAG-ID and PLMN ID to the upper layer for use in manual CAG selection.\nNOTE 2:\tA human-readable network name can be broadcasted per CAG-ID and PLMN ID by a CAG cell.\nUpon selection of a PLMN (and CAG-ID if the user selected a desired CAG-ID as well) by the user, the NAS shall provide the AS with the selected PLMN ID (and CAG-ID if the user selected a desired CAG-ID as well or an indication to select a non-CAG cell if the user did not select any CAG-ID) and the MS initiates registration on this PLMN (and on a cell which broadcasts the CAG-ID if the user selected a desired CAG-ID as well) using the access technology chosen by the user for that PLMN or using the highest priority available access technology for that PLMN, if the associated access technologies have a priority order (this may take place at any time during the presentation of PLMNs). For such a registration, the MS shall ignore the contents of the \"forbidden location areas for roaming\", \"forbidden tracking areas for roaming\", \"5GS forbidden tracking areas for roaming\", \"forbidden location areas for regional provision of service\", \"forbidden tracking areas for regional provision of service\", \"5GS forbidden tracking areas for regional provision of service\", \"forbidden PLMNs for GPRS service\", \"PLMNs not allowed to operate at the present UE location\" and \"forbidden PLMNs\" lists. Also for such a registration, if the NAS has provided the AS with an indication to select:\n-\ta non-CAG cell, the MS shall ignore the \"indication that the MS is only allowed to access 5GS via CAG cells\", if any, in the \"CAG information list\" for the selected PLMN; or\n-\ta selected CAG-ID and the CAG-ID is not authorized based on the \"Allowed CAG list\" associated with that PLMN in the \"CAG information list\", the MS shall consider the selected CAG-ID of the selected PLMN as authorized based on the \"Allowed CAG list\" for the selected PLMN for this registration attempt.\nNOTE 3:\tIt is an MS implementation option whether to indicate access technologies to the user. If the MS does display access technologies, then the access technology selected by the user is only used for initial registration on the selected PLMN. If the MS does not display access technologies, then the access technology chosen for a particular PLMN should be the highest priority available access technology for that PLMN, if the associated access technologies have a priority order, and is only used for initial registration.\nIf the MS has, or is establishing, a PDU session for emergency services, a PDN connection for emergency bearer services or a PDP context for emergency bearer services or CS emergency call, being registered for emergency services or having an ongoing emergency services fallback procedure, manual network selection shall not be performed.\nAfter selection of a PLMN and CAG-ID, if the AS does not provide an indication of finding a cell belonging to the selected PLMN and which broadcasts the selected CAG-ID for the registration procedure (see 3GPP TS 38.304 [40]), then:\ni)\tthe MS shall indicate to user that it can not find the selected PLMN and CAG-ID; and\nii)\tIf there is an \"indication that the MS is only allowed to access 5GS via CAG cells\" in the \"CAG information list\" for the selected PLMN, the MS may attempt to camp on a suitable CAG cell broadcasting a CAG-ID authorized based on the \"Allowed CAG list\" for the selected PLMN or an acceptable cell, otherwise the MS may attempt to camp on a suitable cell belonging to the selected PLMN (i.e. a non-CAG cell or a CAG cell broadcasting a CAG-ID authorized based on the \"Allowed CAG list\" for the selected PLMN) or an acceptable cell.\nOnce the MS has registered on a PLMN selected by the user, the MS shall not automatically register on a different PLMN unless:\ni)\tthe new PLMN is declared as an equivalent PLMN by the registered PLMN. If the MS is registered for disaster roaming services, the UE shall also detect that the new PLMN offers disaster roaming services to the MS determined PLMN with disaster condition as broadcasted by the NG-RAN cell of the new PLMN (see clause 4.4.3.1.1) and that the MS determined PLMN with disaster condition in the old PLMN is also a MS determined PLMN with disaster condition in the new PLMN;\nii)\tthe user selects automatic mode;\niii)\tthe user initiates an emergency call while the MS is in limited service state and either the network does not broadcast the indication of support of emergency calls in limited service state, the registration request for emergency services is rejected by the network or the attach request for emergency bearer services is rejected by the network; or\niv)\tthe user initiates access to RLOS, while the MS is in limited service state and either the network does not broadcast the indication of support of RLOS in limited service state, or the EPS attach request for access to RLOS is rejected by the network, or the EPS tracking area update request for access to RLOS is rejected by the network.\nNOTE 4:\tIf case iii) or iv) occurs, the MS can provide an indication to the upper layers that the MS has exited manual network selection mode.\nOnce the MS has registered on a PLMN selected by the user, the MS may automatically register on a different PLMN if:\n1)\tthe MS supports MINT;\n2)\tthe \"list of PLMN(s) to be used in disaster condition\" is non-empty;\n3)\tthere is no available PLMN which is declared as an equivalent PLMN by the RPLMN; and\n4)\tthe RPLMN of the MS is considered as the MS determined PLMN with disaster condition based on the determination of the MS determined PLMN with disaster condition as specified in clause 4.4.3.1.1.\nNOTE 5:\tIf the above case occurs, the MS can provide an indication to the upper layers that the MS has exited manual network selection mode.\nIf the user does not select a PLMN (or PLMN and CAG-ID), the selected PLMN shall be the one that was selected before the PLMN selection procedure started. If no such PLMN was selected or that PLMN is no longer available, then the MS shall attempt to camp on any acceptable cell and enter the limited service state.\nIf:\n-\tthe MS supports access to RLOS;\n-\teither the UICC containing the USIM is not present in the MS, or the UICC containing the USIM is present in the MS and the MCC part of the IMSI in the USIM is present in the RLOS allowed MCC list configured in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]);\n-\tone or more PLMNs offering access to RLOS has been found;\n-\tregistration cannot be achieved on any PLMN; and\n-\tthe MS is in limited service state,\nthe MS indicates the PLMNs offering access to RLOS, presented in the following order:\ni)\tPLMNs contained in the RLOS preferred PLMN list configured in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]) (in priority order) if the MCC part of the preferred PLMN ID is present in the RLOS allowed MCC list configured in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]); and\nii)\tany of the remaining PLMNs offering access to RLOS that are not in the RLOS preferred PLMN list if the MCC part of the PLMN ID is present in the RLOS allowed MCC list configured in the USIM (see 3GPP TS 31.102 [40]) or in the ME (see 3GPP TS 24.368 [50]).\nUpon selection of a PLMN by the user, the MS initiates registration for access to RLOS on the PLMN chosen by the user (this may take place at any time during the presentation of PLMNs).\n4.4.3.1.3.1\tGeneral\nThe HPLMN may configure the MS whether to provide to the user CSGs for a certain PLMN without any restriction or to provide to the user only CSGs in the Operator CSG List for that PLMN.This configuration may be done either:\n-\tin the USIM if the Operator CSG list is available in the USIM; or\n-\tas described in 3GPP TS 24.285 [47].\nIn the absence of such configuration from the HPLMN for a certain PLMN, the MS shall by default provide to the user CSGs for that PLMN without any restriction.\nFor PLMNs where no restriction is configured, the MS provides to the user the CSGs that are available and the associated PLMNs using all access technologies which support CSGs (see 3GPP TS 23.003 [22A]) and which are supported by the MS. For each entry in the list, an indication is provided whether that CSG identity is in the Allowed CSG list or in the Operator CSG list stored in the MS for this PLMN.\nFor PLMNs where the MS is configured to provide to the user only CSGs in the Operator CSG List, the MS provides to the user the CSGs that are available and in the Operator CSG list, using all access technologies which support CSGs (see 3GPP TS 23.003 [22A]) and which are supported by the MS. For each entry in the list, the MS provides to the user the associated PLMN and an indication that the CSG identity is in the Operator CSG List stored in the MS for this PLMN.\nAdditional requirements for the display, including for the display of HNB name, can be found in 3GPP TS 22.220 [49].\nThe user may select a CSG from the indicated CSGs.\nIf the MS has a PDN connection for emergency bearer services, manual CSG selection shall not be performed.\n4.4.3.1.3.2\tManual CSG selection within the RPLMN\nIf the user selects a CSG whose CSG identity is not included in the Allowed CSG list or Operator CSG list, then the MS shall attempt to register on a cell that corresponds to the CSG. For such a registration, the MS shall ignore the contents of the \"forbidden location areas for roaming\", \"forbidden tracking areas for roaming\", \"forbidden location areas for regional provision of service\", \"forbidden tracking areas for regional provision of service\" and \"forbidden PLMNs for GPRS service\" lists.\nUpon successful or unsuccessful completion of the registration or if registration is not possible, because the MS is no longer in the coverage of the selected CSG, the MS shall return to automatic CSG selection mode.\nManual CSG selection within the RPLMN does not affect the current PLMN selection mode.\n4.4.3.1.3.3\tManual CSG selection in a PLMN different from the RPLMN\nIf the user selects a CSG in a PLMN that is different from the RPLMN, then the following applies:\ni)\tThe MS shall store a duplicate of the RPLMN and a duplicate of the PLMN selection mode that were in use before the manual CSG selection was initiated, unless this manual CSG selection follows another manual CSG selection or a PLMN selection triggered by ProSe communications as specified in clause 3.1B or a PLMN selection triggered by V2X communication over PC5 as specified in clause 3.1C or a PLMN selection triggered by A2X communication over PC5 as specified in clause 3.1D;\nii)\tThe MS shall enter into Manual mode of PLMN selection in state M4 (Trying PLMN) as defined in clause 4.3.1.2;\niii)\tThe MS shall select the PLMN corresponding to the CSG and attempt to register on the selected CSG cell in the PLMN. For such a registration, the MS shall ignore the contents of the \"forbidden location areas for roaming\", \"forbidden tracking areas for roaming\", \"forbidden location areas for regional provision of service\", \"forbidden tracking areas for regional provision of service\", \"forbidden PLMNs for GPRS service\" and \"forbidden PLMNs\" lists. If the registration is successful the MS remains in manual CSG selection mode, until the user selects automatic CSG selection mode, the MS is switched off or the condition of any of items iv) to viii) below is fulfilled;\niv)\tIf the registration fails or the MS is no longer in the coverage of the selected CSG, then the MS shall return to the stored duplicate PLMN selection mode and automatic CSG selection mode and use the stored duplicate value of RPLMN for further action;\nv)\tIf the MS is switched off while on the selected CSG and switched on again, the MS should return to the stored duplicate PLMN selection mode, unless the MS provides the optional feature of user preferred PLMN selection operating mode at switch on. Additionally, the MS shall use the stored duplicate value of RPLMN and automatic CSG selection mode for further action;\nvi)\tIf the user initiates a PLMN selection while on the selected CSG, the MS shall delete the stored duplicate PLMN selection mode, use the stored duplicate value of RPLMN as RPLMN, return to automatic CSG selection mode and follow the procedures (as specified for switch-on or recovery from lack of coverage) in clause 4.4.3.1. The MS shall delete the stored duplicate value of RPLMN once the PLMN selection has been completed successfully;\nvii)\tIf the MS's E-UTRA capability is disabled as a result of successful registration (as described in 3GPP TS 24.301 [23A] clauses 5.5.1.3.4.2, 5.5.1.3.4.3, 5.5.3.3.4.2 and 5.5.3.3.4.3) and the selected CSG is not available on UTRAN radio access technology, the MS shall re-enable the E-UTRA capability, return to the stored duplicate PLMN selection mode and automatic CSG selection mode and use the stored duplicate value of RPLMN for further action; and\nviii)\tIf the MS's E-UTRA capability is disabled as a result of performing the service request procedure (as described in 3GPP TS 24.301 [23A] clause 5.6.1.5), the selected CSG is not available on UTRAN radio access technology and the MS performed a CS call, then after the end of the call, the MS shall re-enable the E-UTRA capability, return to the stored duplicate PLMN selection mode and automatic CSG selection mode and use the stored duplicate value of RPLMN for further action.\nAt any time the user may request the MS to initiate reselection and registration onto an available PLMN, according to the following procedures, dependent upon the operating mode.\nThe MS selects and attempts registration on PLMN/access technology combinations, if available and allowable, in all of its bands of operation in accordance with the following order:\ni)\tthe HPLMN (if the EHPLMN list is not present or is empty) or the highest priority EHPLMN that is available (if the EHPLMN list is present);\nii)\tPLMN/access technology combinations contained in the \"User Controlled PLMN Selector with Access Technology\" data file in the SIM (in priority order) excluding the previously selected PLMN/access technology combination;\niii)\tPLMN/access technology combinations contained in the \"Operator Controlled PLMN Selector with Access Technology\" data file in the SIM (in priority order) or stored in the ME (in priority order) excluding the previously selected PLMN/access technology combination;\niv)\tother PLMN/access technology combinations with the received high quality signal in random order excluding the previously selected PLMN/access technology combination;\nNOTE 1:\tHigh quality signal is defined in the appropriate AS specification.\nv)\tother PLMN/access technology combinations, excluding the previously selected PLMN/access technology combination in order of decreasing signal quality or, alternatively, the previously selected PLMN/access technology combination may be chosen ignoring its signal quality;\nvi)\tThe previously selected PLMN/access technology combination.\nThe previously selected PLMN/access technology combination is the PLMN/access technology combination which the MS has selected prior to the start of the user reselection procedure.\nNOTE 2:\tIf the previously selected PLMN is chosen, and registration has not been attempted on any other PLMNs, then the MS is already registered on the PLMN, and so registration is not necessary.\nThe equivalent PLMNs list shall not be applied to the user reselection in Automatic Network Selection Mode.\nWhen following the above procedure, the requirements a), b), c), e), f), g), h), j), k), l), m), n), o), p) and v) in clause 4.4.3.1.1 apply: Requirement d) shall apply as shown below:\nd)\tIn iv, v, and vi, the MS shall search for all access technologies it is capable of before deciding which PLMN/access technology combination to select.\nThe Manual Network Selection Mode Procedure of clause 4.4.3.1.2 is followed.\nThe procedure of clause 4.4.3.1.3 is followed.\n4.4.3.3.1.1\tAutomatic and manual network selection modes when not registered for disaster roaming services\nIf the MS is in a VPLMN and not registered for disaster roaming services, and the MS shall periodically attempt to obtain service on its HPLMN (if the EHPLMN list is not present or is empty) or one of its EHPLMNs (if the EHPLMN list is present) or a higher priority PLMN/access technology combinations listed in \"user controlled PLMN selector\" or \"operator controlled PLMN selector\" by scanning in accordance with the requirements that are applicable to i), ii) and iii) as defined in the Automatic Network Selection Mode in clause 4.4.3.1.1.\nNOTE 1:\tAdditionally if signal level enhanced network selection is applicable and the received signal quality of the registered PLMN is lower than the \"Operator controlled signal threshold per access technology\", the procedures defined in clause 4.4.3.5 are applicable.\nFor this purpose, a value of timer T may be stored in the SIM. The interpretation of the stored value depends on the radio capabilities supported by the MS:\n-\tFor an MS that does not support any of the following: EC-GSM-IoT, Category M1 or Category NB1 (as defined in 3GPP TS 36.306 [54]);\na)\tif the MS is in a VPLMN through satellite NG-RAN access or satellite E-UTRAN access with a shared MCC, T is in the range 6 multiplied by integer M minutes to 8 multiplied by integer M hours in 6 multiplied by integer M minutes steps or T indicates that no periodic attempts shall be made. If no value for M is stored in the SIM, a default value of M equal to one is used; or\nb)\totherwise, T is either in the range 6 minutes to 8 hours in 6 minutes steps or it indicates that no periodic attempts shall be made. If no value for T is stored in the SIM, a default value of 60 minutes is used for T.\n-\tFor an MS that only supports any of the following or a combination of: EC-GSM-IoT, Category M1 or Category NB1 (as defined in 3GPP TS 36.306 [54]), T is either in the range 2 hours to 240 hours, using 2 hour steps from 2 hours to 80 hours and 4 hour steps from 84 hours to 240 hours, or it indicates that no periodic attempts shall be made. If no value for T is stored in the SIM, a default value of 72 hours is used.\n-\tFor an MS that supports both:\na)\tany of the following or a combination of: EC-GSM-IoT, Category M1 or Category NB1 (as defined in 3GPP TS 36.306 [54]); and\nb)\tany other than the following: EC-GSM-IoT, Category M1 or Category NB1 (as defined in 3GPP TS 36.306 [54]),\nT is interpreted depending on what is in use as specified below:\na)\tif the MS is using any of the following at the time of starting timer T: EC-GSM-IoT, Category M1 or Category NB1 (as defined in 3GPP TS 36.306 [54]), T is either in the range 2 hours to 240 hours, using 2 hour steps from 2 hours to 80 hours and 4 hour steps from 84 hours to 240 hours, or it indicates that no periodic attempts shall be made. If no value for T is stored in the SIM, a default value of 72 hours is used; and\nb)\tif the MS is not using any of the following at the time of starting timer T: EC-GSM-IoT, Category M1 or Category NB1 (as defined in 3GPP TS 36.306 [54]), T is either in the range 6 minutes to 8 hours in 6 minutes steps or it indicates that no periodic attempts shall be made. If the MS is using the satellite NG-RAN access technology or the satellite E-UTRAN access technology with a shared MCC at the time of starting timer T: T is in the range 6 multiplied by integer M minutes to 8 multiplied by integer M hours in 6 multiplied by integer M minutes steps. If no value for M is stored in the SIM, a default value of M equal to one is used. If no value for T is stored in the SIM, a default value of 60 minutes is used for T.\nIf the MS is configured with the MinimumPeriodicSearchTimer as specified in 3GPP TS 24.368 [50] or 3GPP TS 31.102 [40], the MS shall not use a value for T that is less than the MinimumPeriodicSearchTimer. If the value stored in the SIM, or the default value for T (when no value is stored in the SIM), is less than the MinimumPeriodicSearchTimer, then T shall be set to the MinimumPeriodicSearchTimer.\nThe MS does not stop timer T, as described in 3GPP TS 24.008 [23] and 3GPP TS 24.301 [23A], when it activates power saving mode (PSM) (see 3GPP TS 23.682 [27A]) or mobile initiated connection only mode (MICO) as described in 3GPP TS 24.501 [64].\nThe MS does not stop timer T, as described in 3GPP TS 24.008 [23] and 3GPP TS 24.301 [23A], when the access stratum is de-activated due to discontinuous coverage (see 3GPP TS 23.401 [58] and 3GPP TS 24.301 [23A]).\nThe MS does not stop timer T when it activates unavailability period as described in 3GPP TS 24.501 [64].\nThe MS can be configured for Fast First Higher Priority PLMN search as specified in 3GPP TS 31.102 [40] or 3GPP TS 24.368 [50]. Fast First Higher Priority PLMN search is enabled if the corresponding configuration parameter is present and set to enabled. Otherwise, Fast First Higher Priority PLMN search is disabled.\nThe attempts to access the HPLMN or an EHPLMN or higher priority PLMN shall be as specified below:\na)\tThe periodic attempts shall only be performed in automatic mode when the MS is roaming, and not while the MS is attached for emergency bearer services, is registered for emergency services, has a PDU session for emergency services or has a PDN connection for emergency bearer services;\nb)\tThe MS shall make the first attempt after a period of at least 2 minutes and at most the time configured for T:\n-\tonly after switch on if Fast First Higher Priority PLMN search is disabled; or\n-\tafter switch on or upon selecting a VPLMN if Fast First Higher Priority PLMN search is enabled.\nc)\tThe MS shall make the following attempts if the MS is on the VPLMN at time T after the last attempt according to the present clause or according to clause 4.4.3.5;\nd)\tPeriodic attempts shall only be performed by the MS while in idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]);\nd1)\tPeriodic attempts may be postponed while the MS is in power saving mode (PSM) (see 3GPP TS 23.682 [27A]) or when the access stratum is deactivated due to discontinuous coverage (see 3GPP TS 23.401 [58] and 3GPP TS 24.301 [23A]).\nd2)\tPeriodic attempts may be postponed while the MS is receiving eMBMS transport service in idle mode (see 3GPP TS 23.246 [68]).\nd3)\tPeriodic attempts may be postponed while the MS is receiving broadcast MBS service in idle mode (see 3GPP TS 23.247 [85]).\nd4)\tPeriodic attempts may be postponed till the next eDRX occasion while the MS is configured with eDRX.\nd5)\tPeriodic attempts may be postponed while the MS is in relaxed monitoring (see 3GPP TS 36.304 [43]).\nd6)\tPeriodic attempts may be postponed while the MS is in Mobile Initiated Connection Only mode (MICO).\nd7)\tPeriodic attempts may be postponed while the MS unavailability period is activated as described in 3GPP TS 24.501 [64].\ne)\tIf the HPLMN (if the EHPLMN list is not present or is empty) or a EHPLMN (if the list is present) or a higher priority PLMN is not found, the MS shall remain on the VPLMN.\nf)\tIn steps i), ii) and iii) of clause 4.4.3.1.1 the MS shall limit its attempts to access higher priority PLMN/access technology combinations to PLMN/access technology combinations of the same country as the current serving VPLMN, as defined in Annex B.\nEXCEPTION: If the MS is in a VPLMN through satellite NG-RAN access or satellite E-UTRAN access with a shared MCC, the MS may attempt to access higher priority PLMN/access technology combinations irrespective of their MCC values.\nEXCEPTION: If the MS is in a VPLMN, the MS may attempt to access higher priority PLMNs with a shared MCC with satellite NG-RAN access technology or satellite E-UTRAN access technology irrespective of their MCC values.\nf1)\tIn the case that the MS has a stored \"Equivalent PLMNs\" list the MS shall only select a PLMN if it is of a higher priority than those of the same country as the current serving PLMN which are stored in the \"Equivalent PLMNs\" list.\nEXCEPTION: If the MS is in a VPLMN through satellite NG-RAN access or satellite E-UTRAN access with a shared MCC, the MS shall only select a PLMN if it is of a higher priority than those which are stored in the \"Equivalent PLMNs\" list.\nEXCEPTION: If the MS is in a VPLMN, the MS shall only select a PLMN if it is of a higher priority than those of the same country as the current serving PLMN or those with a shared MCC with satellite NG-RAN access technology or satellite E-UTRAN access technology which are stored in the \"Equivalent PLMNs\" list.\ng)\tOnly the priority levels of Equivalent PLMNs of the same country as the current serving VPLMN, as defined in Annex B, and which are not in the list of \"PLMNs where registration was aborted due to SOR\" if the UE has a list of \"PLMNs where registration was aborted due to SOR\" shall be taken into account to compare with the priority level of a selected PLMN.\nh)\tIf the PLMN of the highest priority PLMN/access technology combination available is the current VPLMN, or one of the PLMNs in the \"Equivalent PLMNs\" list and is not in the list of \"PLMNs where registration was aborted due to SOR\" if the UE has a list of \"PLMNs where registration was aborted due to SOR\", the MS shall remain on the current PLMN/access technology combination.\ni)\tIn step iii) of clause 4.4.3.1.1 the MS shall consider PLMNs which are in the list of \"PLMNs where registration was aborted due to SOR\" as lowest priority, if the UE has a list of \"PLMNs where registration was aborted due to SOR\".\nj)\tIn steps i), ii) and iii) of clause 4.4.3.1.1, if signal level enhanced network selection is applicable (see clause 3.11 and step d) of clause 4.4.3.5), the MS shall only select a PLMN, if the received signal quality of the candidate PLMN/access technology combination is equal to or greater than the \"Operator controlled signal threshold per access technology\".\nNOTE 2:\tAs an MS implementation option, the MS can make an attempt when the timer TD, TE, TF, TG or TH expires and there is a PLMN/access technology combination which the MS could not select while the timer was running (e.g. the PLMN was in the list of PLMNs where voice service was not possible in E-UTRAN) that is higher priority than the current serving PLMN and belongs to the same country as the current serving PLMN, as defined in Annex B.\nNOTE 3:\tAs an MS implementation option, upon a transition in or out of international areas, a UE supporting satellite NG-RAN or satellite E-UTRAN can attempt to obtain service on a higher priority PLMN as defined in this clause. It is up to the UE implementation to determine when it is transitioning in and out of international areas. What constitutes an international area is out of scope of this specification and not the responsibility of 3GPP.\n4.4.3.3.1.2\tAutomatic and manual network selection modes when registered for disaster roaming services\nIf the MS is registered for disaster roaming services, the MS shall periodically attempt to obtain service on an allowable PLMN of the same country as the current serving PLMN in accordance with the requirements as defined in the Automatic Network Selection Mode in clause 4.4.3.1.1.\nIf the MS is registered for disaster roaming services, timer T is either in the range 30 minutes to 40 hours in 30 minute steps, or it indicates that no periodic attempts shall be made. If no value for T is stored in the SIM, a default value of 60 minutes is used for T.\nIf the MS is configured with the MinimumPeriodicSearchTimer as specified in 3GPP TS 24.368 [50] or 3GPP TS 31.102 [40], the MS shall not use a value for T that is less than the MinimumPeriodicSearchTimer. If the value stored in the SIM, or the default value for T (when no value is stored in the SIM), is less than the MinimumPeriodicSearchTimer, then T shall be set to the MinimumPeriodicSearchTimer.\nThe MS does not stop timer T, as described in 3GPP TS 24.008 [23] and 3GPP TS 24.301 [23A], when it activates power saving mode (PSM) (see 3GPP TS 23.682 [27A]) or mobile initiated connection only mode (MICO) as described in 3GPP TS 24.501 [64].\nThe MS does not stop timer T when it activates unavailability period as described in 3GPP TS 24.501 [64].\nThe attempts to obtain service on an allowable PLMN shall be as specified below:\na)\tThe periodic attempts shall only be performed in automatic mode when the MS is registered for disaster roaming services and does not have a PDU session for emergency services;\na1)\tThe MS shall make the first attempt after a period of at least 2 minutes and at most the time configured for T upon selecting a VPLMN for disaster roaming;\nb)\tThe MS shall make the following attempts if the MS is registered for disaster roaming services at time T after the last attempt;\nc)\tThe periodic attempts shall only be performed by the MS while in idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]);\nd)\tThe periodic attempts may be postponed:\n-\twhile the MS is in power saving mode (PSM) (see 3GPP TS 23.682 [27A]);\n-\twhile the MS is receiving eMBMS transport service in idle mode (see 3GPP TS 23.246 [68]);\n-\twhile the MS is receiving broadcast MBS service in idle mode (see 3GPP TS 23.247 [85]);\n-\ttill the next eDRX occasion while the MS is configured with eDRX;\n-\twhile the MS is in relaxed monitoring (see 3GPP TS 36.304 [43]);\n-\twhile the MS is in Mobile Initiated Connection Only mode (MICO).\n-\twhile the unavailability period is activated in MS as described in 3GPP TS 24.501 [64].\ne)\tThe MS shall limit its attempts to access allowable PLMN/access technology combinations of the same country as the current serving VPLMN, as defined in Annex B.\nEXCEPTION: If the MS is in a VPLMN through satellite NG-RAN access or satellite E-UTRAN access with a shared MCC, the MS may attempt to access higher priority PLMN/access technology combinations irrespective of their MCC values.\nEXCEPTION: If the MS is in a VPLMN through non-satellite access, the MS may attempt to access higher priority PLMNs with a shared MCC with satellite NG-RAN access technology or satellite E-UTRAN access technology.\nThe procedure of clause 4.4.3.1.3 is followed.\nThe support of this procedure is mandatory if the ME supports GSM COMPACT and otherwise optional.\nAn MS capable of both GSM voice and packet service shall, when indicated in the SIM, investigate if there is service from a higher prioritized PLMN not offering GSM voice service, either HPLMN (if the EHPLMN list is not present or is empty) or one of its EHPLMNs (if the EHPLMN list is present) or a PLMN in a \"PLMN Selector with Access Technology \" data file on the SIM.\nThe MS shall scan for PLMNs in accordance with the requirements described for automatic network selection mode in clause 4.4.3.1.1 that are applicable to i), ii) and iii) with the exception of requirement a) and b) in clause 4.4.3.1. Requirement a) and b) that are specified for automatic network selection mode in clause 4.4.3.1 shall be ignored during the investigation scan.\nIf indicated on the SIM, the investigation scan shall be performed:\ni)\tAfter each successful PLMN selection and registration is completed, when the MS is in idle mode. This investigation scan may rely on the information from the already performed PLMN selection and may not necessarily require a rescan\nii)\tWhen the MS is unable to obtain normal service from a PLMN, (limited service state) see clause 3.5.\nThe investigation scan is restricted to automatic selection mode and shall only be performed by an MS that is capable of both voice and packet data. It shall only be performed if the selected PLMN is not already the highest prioritized PLMN in the current country. (HPLMN in home country, otherwise according to PLMN selector lists)\nThe MS shall return to RPLMN after the investigation scan is performed.\nIf a higher prioritized PLMN not offering GSM voice service is found, this shall be indicated to the user. The MS shall not select the PLMN unless requested by the user.\nIf signal level enhanced network selection is applicable (see clause 3.11) and the received signal quality of registered PLMN observed over an averaging window is lower than the \"Operator controlled signal threshold per access technology\" the MS shall periodically attempt to obtain service on an allowable PLMN/access technology combination for which the received signal quality of the candidate PLMN/access technology combination is equal to or greater than the \"Operator controlled signal threshold per access technology\" in accordance with the requirements that are applicable to i), ii), iii), iv) and v) as defined in the Automatic Network Selection Mode in clause 4.4.3.1.1. For this purpose, the value of the timer TSENSE is configured with an MS implementation specific value with a minimum value of 2 min and a maximum value set to the value applicable for timer T as defined in clause 4.4.3.3.1.1.\nThe averaging window shall be shorter than the value of the timer TSENSE.\nThe MS does not stop timer TSENSE, as described in 3GPP TS 24.008 [23] and 3GPP TS 24.301 [23A], when it activates power saving mode (PSM) (see 3GPP TS 23.682 [27A]) or mobile initiated connection only mode (MICO) as described in 3GPP TS 24.501 [64].\nThe MS does not stop timer TSENSE, as described in 3GPP TS 24.008 [23] and 3GPP TS 24.301 [23A], when the access stratum is de-activated due to discontinuous coverage (see 3GPP TS 23.401 [58] and 3GPP TS 24.301 [23A]) or when the MS activates unavailability period as described in 3GPP TS 24.501 [64].\nThe attempts to obtain service on an allowable PLMN shall be as specified below:\na)\tThe periodic attempts shall only be performed in automatic mode, and not while the MS is attached for emergency bearer services, is registered for emergency services, has a PDN connection for emergency bearer services or has a PDU session for emergency services.\nb)\tWhen the MS detects that the received signal quality of the current cell of the registered PLMN is below the \"Operator controlled signal threshold per access technology\" either upon registration or any time later, the MS shall start timer TSENSE, if not already running.\nc)\tIf upon expiry of timer TSENSE the received signal quality of the registered PLMN observed over an averaging window is equal to or greater than the \"Operator controlled signal threshold per access technology\" the MS shall stay on the current selected PLMN. If timer T defined in clause 4.4.3.3.1.1 expires while timer TSENSE is running and the received signal quality of registered PLMN observed over an averaging window is lower than the \"Operator controlled signal threshold per access technology\", the MS shall stop timer TSENSE and shall perform the actions defined in this clause instead of the action defined for timer T expiry defined in clause 4.4.3.3.1.1.\nd)\tIf the received signal quality of the registered PLMN and all other available and allowable PLMN/access technology combinations are lower than the \"Operator controlled signal threshold per access technology\", the MS shall stop applying signal level enhanced network selection and repeat the network selection procedure as specified in clause 4.4.3.3.1.1.\ne)\tThe attempts shall only be performed by the MS while in idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]).\nf)\tThe attempts may be postponed:\n-\twhile the MS is in power saving mode (PSM) (see 3GPP TS 23.682 [27A]) or when the access stratum is deactivated due to discontinuous coverage or when the UE activated unavailability period (see 3GPP TS 23.401 [58] and 3GPP TS 24.301 [23A]);\n-\twhile the MS is receiving eMBMS transport service in idle mode (see 3GPP TS 23.246 [68]);\n-\ttill the next eDRX occasion while the MS is configured with eDRX;\n-\twhile the MS is in relaxed monitoring (see 3GPP TS 36.304 [43]);\n-\twhile the MS is in Mobile Initiated Connection Only mode (MICO).\ng)\tThe MS shall limit its attempts to access allowable PLMN/access technology combinations of the same country as the current serving VPLMN, as defined in Annex B.\nEXCEPTION: If the MS is in a VPLMN through satellite NG-RAN access or satellite E-UTRAN access with a shared MCC, the MS may attempt to access higher priority PLMN/access technology combinations irrespective of their MCC values.\nEXCEPTION: If the MS is in a VPLMN through non-satellite access, the MS may attempt to access higher priority PLMNs with a shared MCC with satellite NG-RAN access technology or satellite E-UTRAN access technology.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.4\tAbnormal cases",
                            "text_content": "If there is no SIM in the MS, if there is an authentication failure, or if the MS receives an \"IMSI unknown in HLR\", \"illegal ME\" or \"illegal MS\" response to an LR request, then effectively there is no selected PLMN (\"No SIM\" state). In these cases, the states of the cell selection process are such that no PLMN selection information is used. Except when performing GPRS attach, EPS attach for emergency bearer services, an initial registration for emergency services, or EPS attach for access to RLOS, no further attempts at registration on any PLMN are made until the MS is switched off and on again, or a SIM is inserted. When performing GPRS attach, EPS attach for emergency bearer services, an initial registration for emergency services or EPS attach for access to RLOS, the PLMN of the current serving cell is temporarily considered as the selected PLMN.\nWhen in Automatic Network Selection mode and the MS is in the \"not updated\" state with one or more suitable cells to camp on; then after the maximum allowed unsuccessful LR requests (controlled by the specific attempt counters) the MS may continue (or start if it is not running) the user reselection procedure of clause 4.4.3.2.1.\nA multi mode MS that also supports 3GPP2 access technology may fall back to 3GPP2 mode if no SIM is inserted.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.5\tRoaming not allowed in this LA or TA",
                            "text_content": "If in either PLMN selection mode the LR response \"Roaming not allowed in this LA\" or \"Roaming not allowed in this TA\" is received:\nThe PLMN Automatic or Manual Mode Selection Procedure of clause 4.4.3.1 are followed, depending on whether the MS is in automatic or manual mode.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.6\tSteering of roaming",
                            "text_content": "If the MS receives a USAT REFRESH command qualifier (3GPP TS 31.111 [41]) of type \"Steering of Roaming\", the MS shall:\na)\treplace the highest priority entries in the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the ME with the list provided in the REFRESH command, if any, or replace the SOR-CMCI in the ME with the SOR-CMCI provided in REFRESH command, if any, or both;\nb)\tdelete the PLMNs identified by the list in the REFRESH command from the Forbidden PLMN list and from the Forbidden PLMNs for GPRS service list, if they are present in these lists. This includes any information stored in the SIM and the ME internal memory;\nc)\ttake the new information into account in subsequent attempts to access a higher priority PLMN; and\nd)\tattempt to obtain service on a higher priority PLMN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired.\nIn order to avoid unnecessary signalling, the network operator should avoid repeatedly using steering of roaming of a particular MS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.5\tLocation registration process",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.5.1\tGeneral",
                            "text_content": "When the MS is switched on and capable of services requiring registration, the action taken by the location registration process is as follows:\na)\tSIM present and no LR needed (because of the status of the stored registration area identity and \"attach\" flag): The MS is in the update state \"Updated\";\nb)\tSIM present and LR needed: A LR request is made;\nc)\tNo SIM present: The MS enters the update state \"Idle, No IMSI\".\nIn case b) above, and subsequently whenever a LR request is made, the MS enters a state depending on the outcome of the LR request, as listed in clause 4.3.3 above. In case c) the GPRS and the non-GPRS update state enters \"Idle, No IMSI\".\nWhenever the MS goes to connected mode and then returns to idle mode again, the MS selects the appropriate state.\nA multi mode MS that also supports 3GPP2 access technology may fall back to 3GPP2 mode if no SIM is inserted.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.5.2\tInitiation of Location Registration",
                            "text_content": "An LR request indicating Normal Updating is made when, in idle mode,\n-\tthe MS changes cell while the update status is \"NOT UPDATED\"; (for MS capable of GPRS and non-GPRS services when at least one of both update statuses is \"NOT UPDATED\")\n-\tthe MS detects that it has entered a new registration area, i.e., when the received registration area identity differs from the one stored in the MS, and the LAI, TAI or PLMN identity is not contained in any of the lists of \"forbidden location areas for roaming\", \"forbidden tracking areas for roaming\", \"5GS forbidden tracking areas for roaming\", \"forbidden location areas for regional provision of service\", \"forbidden tracking areas for regional provision of service\", \"5GS forbidden tracking areas for regional provision of service\", \"forbidden PLMNs for GPRS service\" or \"forbidden PLMNs\" respectively, while being in one of the following update statuses:\n-\tUPDATED;\n-\tNOT UPDATED;\n-\tROAMING NOT ALLOWED.\n-\tthe MS detects that it has entered a new registration area, i.e., when the received registration area identity differs from the one stored in the MS, and the MS is attached for access to RLOS;\n-\tthe MS detects that it has entered a registration area that has the same identity as the one stored in the MS, while the update status is \"ROAMING NOT ALLOWED\", and\nthe LAI, TAI or PLMN identity is not contained in any of the lists of \"forbidden location areas for roaming\", \"forbidden tracking areas for roaming\", \"5GS forbidden tracking areas for roaming\", \"forbidden location areas for regional provision of service\", \"forbidden tracking areas for regional provision of service\", \"5GS forbidden tracking areas for regional provision of service\", \"forbidden PLMNs for GPRS service\" or \"forbidden PLMNs\" respectively; and\n-\tif the selected cell is a satellite NG-RAN cell or a satellite E-UTRAN cell, it does not fulfil the conditions related to the list of \"PLMNs not allowed to operate at the present UE location\" as defined in clause 3.1, i.e. it is considered as candidate for PLMN selection.\n-\tthe periodic location updating timer expires while the non-GPRS update status is \"NOT UPDATED\" (triggers location updating);\n-\tthe periodic routing area update timer expires while the GPRS update status is \"NOT UPDATED\" (triggers routing area update);\n-\tthe periodic tracking area update timer expires while the EPS update status is \"NOT UPDATED\" (triggers tracking area update);\n-\tthe periodic registration update timer expires while the 5GS update status is \"NOT UPDATED\" (triggers mobility and periodic registration update procedure);\n-\ta manual network reselection has been performed, an acceptable cell of the selected PLMN or the selected SNPN is present, and the MS is not in the update status \"UPDATED\" on the selected PLMN or the selected SNPN; or\n-\temergency bearer services over packet services are requested by upper layers.\nAn MS which is attached for PS services other than RLOS and enters a new PLMN shall perform a routing area update or a tracking area update or an MS which is registered via NG-RAN and enters a new PLMN or SNPN shall perform a registration update if the following conditions are fulfilled:\na)\tif the MS:\n1)\tdoes not operate in SNPN access operation mode over 3GPP access, is in S1 mode or N1 mode and the currently stored TAI list does not contain the TAI of the current serving cell; or\n2)\toperates in SNPN access operation mode over 3GPP access;\nb)\tthe LAI, TAI or PLMN identity of the current serving cell is not contained in any of the lists \"forbidden location areas for roaming\", \"forbidden tracking areas for roaming\", \"5GS forbidden tracking areas for roaming\", \"forbidden location areas for regional provision of service\", \"forbidden tracking areas for regional provision of service\", \"5GS forbidden tracking areas for regional provision of service\", \"forbidden PLMNs for GPRS service\" or \"forbidden PLMNs\", or the MS has a PDN connection for emergency bearer services, or the MS has a PDU session for emergency services;\nb1)\tif the selected cell is a satellite NG-RAN cell or a satellite E-UTRAN cell, it does not fulfil the conditions related to the list of \"PLMNs not allowed to operate at the present UE location\" as defined in clause 3.1, i.e. it is considered as candidate for PLMN selection; and\nc)\tthe current update state is different from \"Idle, No IMSI\"; and\n1)\tthe MS is configured to perform the attach procedure with IMSI at PLMN change (see \"AttachWithIMSI\" leaf of the NAS configuration MO in 3GPP TS 24.368 [50] or USIM file NASCONFIG in 3GPP TS 31.102 [40]) and the new PLMN is the registered PLMN or an equivalent PLMN; or\n2)\tthe MS is not configured to perform the attach procedure with IMSI at PLMN change.\nAn MS which is attached for access to RLOS and enters a new PLMN shall perform tracking area update if the following condition is fulfilled:\n-\tthe currently stored TAI list does not contain the TAI of the current serving cell.\nIf the new PLMN the MS has entered is neither the registered PLMN nor an equivalent PLMN, an MS which is attached for PS services and configured to perform the attach procedure with IMSI at PLMN change (see \"AttachWithIMSI\" leaf of the NAS configuration MO in 3GPP TS 24.368 [50] or USIM file NASCONFIG in 3GPP TS 31.102 [40]) shall perform an attach procedure using IMSI as mobile identity.\nAn LR request indicating periodic location updating is made when, in idle mode, the periodic location updating timer expires while the non-GPRS update status is \"UPDATED\".\nAn LR request indicating periodic routing area update is made when the periodic routing area update timer expires while the GPRS update status is \"UPDATED\", except when the MS is attached for emergency bearer services.\nAn LR request indicating periodic tracking area update is made when the periodic tracking area update timer expires while the EPS update status is \"UPDATED\", except when the MS is attached for emergency bearer services.\nAn LR request indicating Periodic Registration Updating is made when the periodic registration timer expires while the 5GS update status is \"UPDATED\", except when the MS is registered for emergency services.\nAn LR request indicating IMSI attach is made when the MS is activated in the same location area in which it was deactivated while the non-GPRS update status is \"UPDATED\", and the system information indicates that IMSI attach/detach shall be used.\nA GPRS attach is made by a GPRS MS when activated and capable of services which require registration. A GPRS attach may only be performed if the selected PLMN is not contained in the list of \"forbidden PLMNs for GPRS service\". Depending on system information about GPRS network operation mode MSs operating in MS operation mode A or B perform combined or non-combined location registration procedures. When the combined routing area update or GPRS attach is accepted with indication \"MSC not reachable\" or is not answered the MS performs also the corresponding location updating procedure or falls back to a GPRS only MS. When the combined routing area update or GPRS attach is rejected with cause \"GPRS not allowed\" the GPRS update status is \"ROAMING NOT ALLOWED\" and the MS performs the corresponding location updating procedure.\nAn LR request indicating Disaster Roaming registration updating is made when the MS supporting MINT needs to register to the PLMN offering disaster roaming services for the first time.\nFurthermore, an LR request indicating normal location updating is also made when the response to an outgoing request shows that the MS is unknown in the VLR or SGSN, respectively.\nTable 2 in clause 5 summarizes the events in each state that trigger a new LR request. The actions that may be taken while being in the various states are also outlined in table 2.\nA GPRS MS which is both IMSI attached for GPRS and non-GPRS services and which is capable of simultaneous operation of GPRS and non-GPRS services shall perform routing area update in connected mode when it has entered a new routing area which is not part of a LA contained in the list of \"forbidden location areas for roaming\" or \"forbidden location areas for regional provision of service\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.5.3\tPeriodic Location Registration",
                            "text_content": "A Periodic Location Updating timer (for non-GPRS operation), a Periodic Routing Area Update timer (for GPRS operation), a Periodic Tracking Area Update timer (for EPS operation) and a Periodic Registration Update timer (for 5GS operation) with the following characteristics shall be implemented in the MS (MS shall implement all timers corresponding to supported operations):\ni)\tUpon switch on of the MS or when the system information indicates that periodic location registration shall be applied, and the timer is not running, the timer shall be loaded with a random value between 0 and the broadcast or signalled time-out value and started.\nii)\tThe time-out value for the periodic location updating timer shall be within the range of 1 deci-hour to 255 deci-hours with a granularity of 1 deci-hour.\niii)\tWhen the timer reaches its expiry value, it shall be initiated with respect to the relevant time-out value, and the MS shall initiate the periodic location registration corresponding to the expired timer. If the MS is attached for emergency bearer services or the MS is registered for emergency services, the MS shall locally detach instead of performing periodic location registration.\niv)\tThe periodic location updating timer shall be prevented from triggering periodic location updating during connected mode. When the MS returns to idle mode, the periodic location updating timer shall be initiated with respect to the broadcast time-out value, then started. Thereafter, the procedure in iii) shall be followed.\nv)\tThe periodic routing area update timer shall be prevented from triggering the periodic routing area update during Ready state. At transition from Ready to Standby state the periodic routing area update timer shall be initiated with respect to its time-out value, then started. Thereafter, the procedure in iii) shall be followed.\nvi)\tIf the MS performs a successful combined routing area update the periodic location updating timer shall be prevented from triggering the periodic location updating until the MS starts using location updating procedure, for example because of a changed network operation mode or the MS uses non-GPRS services only.\nvii)\tWhen a change in the time-out value occurs (at a change of serving cell or a change in the broadcast time-out value or a change in the signalled time-out value), the related timer shall be reloaded so that the new time to expiry will be: \"old time to expiry\" modulo \"new time-out value\".\nviii)\tThe periodic tracking area update timer shall be prevented from triggering periodic tracking Area updating during connected mode. When the MS returns to idle mode, the periodic tracking area update timer shall be initiated with respect to the signalled time-out value, then started. Thereafter, the procedure in iii) shall be followed.\nix)\tThe periodic registration update timer shall be prevented from triggering periodic registration updating during connected mode. If periodic timer is not running due to Strictly periodic registration feature, when the MS returns to idle mode, the periodic registration update timer shall be initiated with respect to the signalled time-out value, then started. Thereafter, the procedure in iii) shall be followed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.5.4\tIMSI attach/detach operation",
                            "text_content": "The system information will contain an indicator indicating whether or not IMSI attach/detach operation is mandatory to use in the cell. The MS shall operate in accordance with the received value of the indicator.\nA GPRS MS shall perform GPRS attach/detach procedures independent of the value of the IMSI attach/detach indicator. When a GPRS MS has to perform IMSI attach/detach independent of GPRS procedures (for example GPRS network operation mode 2) the handling described in the clause above applies.\nWhen IMSI attach/detach operation applies, an MS shall send the IMSI detach message to the network when the MS is powered down or the SIM is removed while the update status is \"UPDATED\". The IMSI detach message will not be acknowledged by the network.\nWhen the MS returns to the active state, the MS shall perform an LR request indicating IMSI attach, provided that the MS still is in the same registration area. If the registration area has changed, an LR request indicating normal location updating according to clause 4.5.2 shall be performed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.5.5\tNo Suitable Cells In Location Area",
                            "text_content": "If during location registration the LR response \"No Suitable Cells In Location Area\" or \"No Suitable Cells In Tracking Area\" is received:\n-\tThe MS shall attempt to find another LA or TA of the same PLMN, the same SNPN, an equivalent PLMN or an equivalent SNPN, on which it received the LR response. If the MS is able to find another LA or TA it shall attempt registration. If the MS is unable to find an LA or TA, the PLMN Automatic or Manual Mode Selection Procedure of clause 4.4.3.1 or the SNPN Automatic or Manual Mode Selection Procedure of clause 4.9.3.1 shall be followed, depending on whether the MS is in automatic or manual mode and whether the MS operates in SNPN access operation mode over 3GPP access.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.6\tService indication (A/Gb mode only)",
                    "description": "",
                    "summary": "",
                    "text_content": "This is an indication to the user that service or CTS service is available.\nThe service indication should be set if the following conditions are all satisfied:\na)\tCell Selection: Camped on a suitable cell and in updated state, or in connected mode having been camped on a suitable cell.\nb)\tLocation registration: In updated state, for MSs capable of services requiring registration.\nA specific CTS service indication should be set when the CTS MS is attached to a CTS FP.\nHowever due to the fact that there may be some transitory changes of state, the service indication is permitted to continue to be set for up to 10 seconds after the above conditions cease to be met. Also the service indication is permitted to take up to 1 second to be set after the above conditions are met.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.7\tPageability of the mobile subscriber",
                    "description": "",
                    "summary": "",
                    "text_content": "An MS is required to listen to all paging messages that could address it (see 3GPP TS 45.002 [24]), when the following conditions are all satisfied:\n-\tA SIM is inserted;\n-\tThe MS is camped on a cell;\n-\tThe MS is not in state \"Idle, No IMSI\"; and\n-\tThe MS is not performing the task to search for available PLMNs or available SNPNs. (Whenever possible during this task, the MS should listen for paging.). However, when the MS is camped on a cell, is registered in a PLMN and is performing its regular search for a higher priority PLMN, as specified in 3GPP TS 22.011 [9], then it shall listen to all paging messages that could address it.\nNOTE:\tIn A/Gb mode, during cell reselection there is a certain period when the MS is no longer camped on the old cell but must decode the full BCCH, CPBCCH or EC-BCCH before camping on the new cell. This leads to a period of slightly more than 8 51 frame multiframes when the MS will not necessarily be pageable (full BCCH or CPBCCH is decoded) or up to 32 51 frame multiframes when the MS will not necessarily be pageable (full EC-BCCH is decoded).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.8\tMM Restart Procedure",
                    "description": "",
                    "summary": "",
                    "text_content": "In some cases, e.g. on change of SIM data, there is a need for the MM to be restarted without the need for user intervention.\nTo perform the procedure the MS shall behave as if the SIM is removed and afterwards a new SIM is inserted.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.9\tSNPN selection process",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.9.1\tGeneral",
                            "text_content": "The MS operating in SNPN access operation mode over 3GPP access shall perform the SNPN selection process.\nThe MS not operating in SNPN access operation mode over 3GPP access shall not perform the SNPN selection process.\nThere are two SNPN selection modes - automatic SNPN selection mode and manual SNPN selection mode.\nIn the SNPN selection process, the MS shall consider only the access networks of the NG-RAN access technology.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.9.2\tRegistration on an SNPN",
                            "text_content": "The MS shall perform registration on the SNPN if the MS is capable of services which require registration. In both automatic SNPN selection mode and manual SNPN selection mode, the concept of registration on an SNPN is used. An MS successfully registers on an SNPN if:\na)\tthe MS has found a suitable cell of the SNPN to camp on; and\nb)\tan LR request from the MS has been accepted in the registration area of the cell on which the MS is camped.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.9.3\tSNPN selection",
                            "text_content": "The ME is configured with a \"list of subscriber data\" containing zero or more entries. Each entry of the \"list of subscriber data\" consists of:\na)\ta subscriber identifier in the form of a SUPI with the SUPI format \"network specific identifier\" containing a network-specific identifier or with the SUPI format \"IMSI\" containing an IMSI, except when the subscribed SNPN uses:\n1)\tthe EAP based primary authentication and key agreement procedure using the EAP-AKA'; or\n2)\tthe 5G AKA based primary authentication and key agreement procedure;\nNOTE 1:\tA subscriber identifier in the form of a SUPI with the SUPI format \"network specific identifier\" containing a network-specific identifier or with the SUPI format \"IMSI\" containing an IMSI, is available in USIM if the subscribed SNPN uses the EAP based primary authentication and key agreement procedure using the EAP-AKA' or the 5G AKA based primary authentication and key agreement procedure.\nNOTE 2:\tIf the MS supports access to an SNPN using credentials from a credentials holder and is configured with the SNPN selection parameters as described in h), the subscriber identifier in the form of a SUPI configured in the ME or the USIM needs to be:\n-\twith the SUPI format \"network specific identifier\"; or\n-\twith the SUPI format \"IMSI\", if the subscribed SNPN has an assigned PLMN ID.\nb)\tcredentials except when the subscribed SNPN uses:\n1)\tthe EAP based primary authentication and key agreement procedure using the EAP-AKA'; or\n2)\tthe 5G AKA based primary authentication and key agreement procedure.\nIf the MS supports access to an SNPN using credentials from a credentials holder, the credentials can include an indication to use MSK for derivation of KAUSF after success of primary authentication and key agreement procedure;\nNOTE 3:\tCredentials are available in USIM if the subscribed SNPN uses the EAP based primary authentication and key agreement procedure using the EAP-AKA' or the 5G AKA based primary authentication and key agreement procedure. If the MS supports access to an SNPN using credentials from a credentials holder, credentials available in USIM can include an indication to use MSK for derivation of KAUSF after success of primary authentication and key agreement procedure.\nba)\toptionally, a routing indicator, except when the subscribed SNPN uses:\n1)\tthe EAP based primary authentication and key agreement procedure using the EAP-AKA'; or\n2)\tthe 5G AKA based primary authentication and key agreement procedure;\nNOTE 3A:\tRouting indicator is available in USIM if the subscribed SNPN uses the EAP based primary authentication and key agreement procedure using the EAP-AKA' or the 5G AKA based primary authentication and key agreement procedure.\nbb)\toptionally, the protection scheme identifier as specified in 3GPP TS 33.501 [66], except when the subscribed SNPN uses:\n1)\tthe EAP based primary authentication and key agreement procedure using the EAP-AKA'; or\n2)\tthe 5G AKA based primary authentication and key agreement procedure;\nIf the protection scheme identifier is configured in the entry of the \"list of subscriber data\" and not set to \"null-scheme\", the entry of the \"list of subscriber data\" also contains the home network public key and the home network public key identifier as specified in in 3GPP TS 33.501 [66];\nNOTE 3B:\tThe protection scheme identifier, the home network public key and the home network public key identifier are available in USIM if the subscribed SNPN uses the EAP based primary authentication and key agreement procedure using the EAP-AKA' or the 5G AKA based primary authentication and key agreement procedure.\nc)\tan SNPN identity of the subscribed SNPN;\nd)\toptionally, the unified access control configuration indicating for which access identities (see 3GPP TS 24.501 [64]) the ME is configured, when the MS accesses an SNPN using the entry.\nAccess identity 11 or 15, if configured, is applicable for the MS only in the subscribed SNPN.\nAccess identity 12, 13 or 14, if configured, is applicable for the MS only:\n1)\tin the subscribed SNPN; and\n2)\tif the MCC of the SNPN identity of the subscribed SNPN is not the MCC of value 999, in the non-subscribed SNPNs of the same country as the subscribed SNPN;\nAccess identity 1 or 2, if configured, is applicable for the MS only:\n1)\tin the subscribed SNPN;\n2)\tif the MCC of the SNPN identity of the subscribed SNPN is not the MCC of value 999, in the non-subscribed SNPNs of the same country as the subscribed SNPN; and\n3)\tin an SNPN equivalent to the subscribed SNPN;\ne)\tzero or more sets of pre-configured URSP rules (see 3GPP TS 24.526 [77]), each set for the subscribed SNPN or a non-subscribed SNPN;\nf)\toptionally, the default configured NSSAI (see 3GPP TS 24.501 [64]);\ng)\toptionally, if the MS supports access to an SNPN using credentials from a credentials holder:\n1) \tthe SNPN selection parameters, consisting of:\ni)\ta user controlled prioritized list of preferred SNPNs, where each entry contains an SNPN identity;\nii)\ta credentials holder controlled prioritized list of preferred SNPNs, where each entry contains an SNPN identity;\niii)\ta credentials holder controlled prioritized list of Group IDs for Network Selection (GINs); and\niv)\toptionally, if the MS supports access to an SNPN providing access for localized services in SNPN, the SNPN selection parameters for access for localized services in SNPN, consisting of:\nA)\ta \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\", where each entry contains:\n-\tan SNPN identity;\n-\tvalidity information consisting of time validity information and optionally, location validity information; and\n-\toptionally, location assistance information; and\nB)\ta \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\", where each entry contains:\n-\ta GIN;\n-\tvalidity information consisting of time validity information and optionally, location validity information; and\n-\toptionally, location assistance information; and\n2)\toptionally, an indication to expect to receive the steering of roaming information due to initial registration in a non-subscribed SNPN;\nNOTE 4:\tHow the ME is configured with the \"list of subscriber data\" is out of scope of 3GPP in this release of the specification.\nNOTE 5:\tMultiple entries can include the same subscriber identifier and credentials.\nNOTE 6:\tHandling of more than one entry with the same SNPN identity is left up to MS implementation.\nNOTE 7:\tHandling of the case when the subscribed SNPN uses the EAP based primary authentication and key agreement procedure using the EAP-AKA' or the 5G AKA based primary authentication and key agreement procedure and the MS has multiple valid USIMs (3GPP TS 31.102 [40]) is left up to MS implementation.\nNOTE 8:\tTo enable UE mobility between SNPNs in 5GMM-IDLE mode, SNPN identities in the credentials holder controlled prioritized list of preferred SNPNs are assumed to be globally-unique SNPN identities.\nh)\toptionally:\n1)\tan indication of whether the MS shall ignore all warning messages received in the subscribed SNPN or an equivalent SNPN of the subscribed SNPN; and\n2)\tan indication of whether the MS shall ignore all warning messages received in an non-subscribed SNPN or an equivalent SNPN of the non-subscribed SNPN.\nNOTE 9:\tThe ME can be configured with an indication to use anonymous SUCI associated with an entry of \"list of subscriber data\" when the EAP method associated with the credentials of the entry supports SUPI privacy at the EAP layer.\nNOTE 10:\tAnonymous SUCI is not used if the subscribed SNPN of the entry uses the EAP based primary authentication and key agreement procedure using the EAP-AKA' or the 5G AKA based primary authentication and key agreement procedure.\nThe MS which supports onboarding services in SNPN shall be pre-configured with default UE credentials for primary authentication and may be pre-configured with onboarding SNPN selection information. Contents of the onboarding SNPN selection information are MS implementation specific. Contents of default UE credentials for primary authentication are out of scope of 3GPP.\nAdditionally, if the MS has a USIM with a PLMN subscription, the ME may be configured with the SNPN selection parameters associated with the PLMN subscription, consisting of:\na)\ta user controlled prioritized list of preferred SNPNs, where each entry contains an SNPN identity;\nb)\ta credentials holder controlled prioritized list of preferred SNPNs, where each entry contains an SNPN identity;\nc)\ta credentials holder controlled prioritized list of GINs;and\nd)\toptionally, if the MS supports access to an SNPN providing access for localized services in SNPN, with the following SNPN selection parameters for access for localized services in SNPN associated with the PLMN subscription, consisting of:\n1)\ta \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\", where each entry contains:\n-\tan SNPN identity;\n-\tvalidity information consisting of time validity information and optionally, location validity information; and\n-\toptionally, location assistance information; and\n2)\ta \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\", where each entry contains:\n-\ta GIN;\n-\tvalidity information consisting of time validity information and optionally, location validity information; and\n-\toptionally, location assistance information\nand with the following configuration parameters associated with the PLMN subscription:\na)\tzero or more sets of pre-configured URSP rules (see 3GPP TS 24.526 [77]), each set for the HPLMN or a non-subscribed SNPN; and\nb)\toptionally, an indication to expect to receive the steering of roaming information due to initial registration in a non-subscribed SNPN.\nNOTE 11:\tTo enable MS mobility between SNPNs in 5GMM-IDLE mode, SNPN identities in the credentials holder controlled prioritized list of preferred SNPNs are assumed to be globally-unique SNPN identities.\nNOTE 12: If an MS accesses an SNPN using the PLMN subscription, access identity 1, 2, 12, 13, or 14 is configured in the USIM of the MS, and the SNPN is of the same country as the HPLMN, then the configured access identity 1, 2, 12, 13, or 14 is applicable for the MS.\nNOTE 13:\tIf an MS accesses an SNPN using the PLMN subscription, an indication of whether the MS shall ignore all warning messages in an SNPN is configured in the USIM of the MS.\nNOTE 14: Handling of URSP rules is specified in 3GPP TS 24.526 [77].\nThe time validity information contains one or more time periods.\nThe location validity information contains one or more location information.\nIf:\na)\tthe location validity information is not available and at least one time period of the time validity information matches UE's current time; or\nb)\tthe location validity information is available, at least one time period of the time validity information matches UE's current time and at least one location information of the location validity information matches UE's current location;\nthen the validity information is met otherwise the validity information is not met.\nThe MS shall maintain a list of \"temporarily forbidden SNPNs\" and a list of \"permanently forbidden SNPNs\" in the ME. Each entry of those lists consists of an SNPN identity. If the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the MS shall maintain one list of “temporarily forbidden SNPNs” and one list of “permanently forbidden SNPNs” per entry of the “list of subscriber data”. If the MS supports access to an SNPN using credentials from a credentials holder, the MS shall maintain one list of \"temporarily forbidden SNPNs\" and one list of \"permanently forbidden SNPNs\" per the PLMN subscription. If the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the MS shall use the lists associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription. In addition, if the MS supports access to an SNPN providing access for localized services in SNPN, the MS shall maintain one list of \"temporarily forbidden SNPNs for access for localized services in SNPN\" and one list of \"permanently forbidden SNPNs for access for localized services in SNPN\" per entry of the \"list of subscriber data\" and per the PLMN subscription. If the MS supports access to an SNPN providing access for localized services in SNPN, the MS shall use the lists associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription. In addition, if the MS supports onboarding services in SNPN, a \"permanently forbidden SNPNs\" list for onboarding services and a \"temporarily forbidden SNPNs\" list for onboarding services shall be maintained.\nThe MS shall add an SNPN to the list of \"temporarily forbidden SNPNs\" (for access for localized services in SNPN, if the SNPN is an SNPN selected for localized services in SNPN) (for onboarding services, if the MS is registered for onboarding services in SNPN or performing initial registration for onboarding services in SNPN) which is, if the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, if a message with cause value #74 \"Temporarily not authorized for this SNPN\" (see 3GPP TS 24.501 [64]) is received by the MS in response to an LR request from the SNPN. In addition, if:\n-\tthe message is integrity-protected; or\n-\tthe message is not integrity-protected, and the value of the SNPN-specific attempt counter for that SNPN is equal to the MS implementation specific maximum value as defined in 3GPP TS 24.501 [64];\nthen the MS shall start an MS implementation specific timer not shorter than 60 minutes.\nThe MS shall remove an SNPN from the list of \"temporarily forbidden SNPNs\" (for access for localized services in SNPN, if the SNPN is an SNPN selected for localized services in SNPN) (for onboarding services, if the MS is registered for onboarding services in SNPN or performing initial registration for onboarding services in SNPN) which is, if the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, if:\na)\tthere is a successful LR after a subsequent manual selection of the SNPN;\nb)\tthe MS implementation specific timer not shorter than 60 minutes expires;\nc)\tthe MS is configured to use timer T3245 and timer T3245 expires;\nd)\tthe MS is not configured to use timer T3245, the timer T3247 expires and the value of the SNPN-specific attempt counter for that SNPN is less than the MS implementation specific maximum value as defined in 3GPP TS 24.501 [64];\ne)\tthe MS is switched off;\nf)\tan entry of the \"list of subscriber data\" with the subscribed SNPN identity identifying the SNPN is updated or the USIM is removed if:\n-\tEAP based primary authentication and key agreement procedure using EAP-AKA'; or\n-\t5G AKA based primary authentication and key agreement procedure;\nwas performed in the selected SNPN; or\ng)\tthe selected entry of the \"list of subscriber data\" is updated or USIM is removed for the selected PLMN subscription.\nIf an SNPN is removed from the list of \"temporarily forbidden SNPNs\" list, the MS shall stop the MS implementation specific timer not shorter than 60 minutes, if running.\nNOTE 15:\tIf the MS supports access to an SNPN providing access for localized services in SNPN, the UE ensures that such an SNPN is not inaccessible due to being in the list of \"temporarily forbidden SNPNs for access for localized services in SNPN\" when the validity information of the SNPN changes from not met to met. As a UE implementation option, the MS can remove an SNPN from the list of \"temporarily forbidden SNPNs for access for localized services in SNPN\" associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, when the validity information of the SNPN changes from not met to met.\nThe MS shall add an SNPN to the list of \"permanently forbidden SNPNs\" (for access for localized services in SNPN, if the SNPN is an SNPN selected for localized services in SNPN) (for onboarding services, if the MS is registered for onboarding services in SNPN or performing initial registration for onboarding services in SNPN) which is, if the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, if a message with cause value #75 \"Permanently not authorized for this SNPN\", #3 \"Illegal UE\" (applicable in an onboarding SNPN only), #6 \"Illegal ME\" (applicable in an onboarding SNPN only), or #7 \"5GS services not allowed\" (applicable in an onboarding SNPN only) (see 3GPP TS 24.501 [64]) is received by the MS in response to an LR request from the SNPN.\nThe MS shall remove an SNPN from the list of \"permanently forbidden SNPNs\" (for access for localized services in SNPN, if the SNPN is an SNPN selected for localized services in SNPN) (for onboarding services, if the MS is registered for onboarding services in SNPN or performing initial registration for onboarding services in SNPN) which is, if the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, if:\na)\tthere is a successful LR after a subsequent manual selection of the SNPN;\nb)\tthe MS is configured to use timer T3245 and timer T3245 expires;\nc)\tthe MS is not configured to use timer T3245, the timer T3247 expires and the value of the SNPN-specific attempt counter for that SNPN is less than the MS implementation specific maximum value as defined in 3GPP TS 24.501 [64];\nd)\tan entry of the \"list of subscriber data\" with the subscribed SNPN identity identifying the SNPN is updated or the USIM is removed if:\n-\tEAP based primary authentication and key agreement procedure using EAP-AKA'; or\n-\t5G AKA based primary authentication and key agreement procedure;\nwas performed in the selected SNPN; or\ne)\tthe selected entry of the \"list of subscriber data\" is updated or USIM is removed for the selected PLMN subscription.\nNOTE 16:\tIf the MS supports access to an SNPN providing access for localized services in SNPN, the UE ensures that such an SNPN is not inaccessible due to being in the list of \"permanently forbidden SNPNs for access for localized services in SNPN\" when the validity information of the SNPN changes from not met to met. As a UE implementation option the MS can remove an SNPN from the list of \"permanently forbidden SNPNs for access for localized services in SNPN\" associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, when the validity information of the SNPN changes from not met to met.\nWhen the MS reselects to a cell in a shared network, and the cell is a suitable cell for multiple SNPN identities received in the broadcast information as specified in 3GPP TS 38.331 [65], the AS indicates these multiple SNPN identities to the NAS according to 3GPP TS 38.304 [61]. The MS shall select one of these SNPNs. If the registered SNPN is available among these SNPNs, the MS shall not select a different SNPN.\nThe MS operating in SNPN access operation mode over 3GPP access shall maintain one or more lists of \"5GS forbidden tracking areas for roaming\", each associated with an SNPN and, if the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, entry of the \"list of subscriber data\" or, if the MS supports access to an SNPN using credentials from a credentials holder, the PLMN subscription. The MS shall use the list of \"5GS forbidden tracking areas for roaming\" associated with the selected SNPN and, if the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the selected entry of the \"list of subscriber data\" or the selected PLMN subscription. If the MS selects a new SNPN, the MS shall keep the list of \"5GS forbidden tracking areas for roaming\" associated with the previously selected SNPN and, if the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the selected entry of the \"list of subscriber data\" or the selected PLMN subscription. If the number of the lists to be kept is higher than supported, the MS shall delete the oldest stored list of \"5GS forbidden tracking areas for roaming\". The MS shall delete all lists of \"5GS forbidden tracking areas for roaming\", periodically (with period in the range 12 to 24 hours) or when the MS is switched off. The MS shall delete the list of \"5GS forbidden tracking areas for roaming\" associated with an SNPN:\na)\twhen the entry with the subscribed SNPN identifying the SNPN in the \"list of subscriber data\" is updated;\nb)\twhen the USIM is removed if:\n-\tthe EAP based primary authentication and key agreement procedure using the EAP-AKA'; or\n-\tthe 5G AKA based primary authentication and key agreement procedure;\nwas performed in the selected SNPN; or\nc)\tif the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, when the list of \"5GS forbidden tracking areas for roaming\" is associated with:\n-\tthe entry of the \"list of subscriber data\" and the entry of the \"list of subscriber data\" is updated; or\n-\tthe PLMN subscription and USIM is removed.\nNOTE 17:\tThe number of the lists of \"5GS forbidden tracking areas for roaming\" supported by the MS is MS implementation specific.\nIf a message with cause value #15 (see 3GPP TS 24.501 [64]) is received by an MS operating in SNPN access operation mode over 3GPP access, the TA is added to the list of \"5GS forbidden tracking areas for roaming\" of the selected SNPN and, if the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the selected entry of the \"list of subscriber data\" or the selected PLMN subscription,. The MS shall then search for a suitable cell in the same SNPN but belonging to a TA which is not in the \"5GS forbidden tracking areas for roaming\" list of the selected SNPN and, if the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the selected entry of the \"list of subscriber data\" or the selected PLMN subscription.\nThe MS should maintain a list of SNPNs for which the N1 mode capability was disabled due to receipt of a reject from the network with 5GMM cause #27 \"N1 mode not allowed\". When the MS disables its N1 mode capability due to receipt of a reject from an SNPN with 5GMM cause #27 \"N1 mode not allowed\":\n-\tthe MS should add the SNPN identity of the SNPN which sent a reject with 5GMM cause #27 \"N1 mode not allowed\" to the list of SNPNs for which the N1 mode capability was disabled and should start timer TJ if timer TJ is not already running. The number of SNPNs for which the N1 mode capability was disabled that the MS can store is implementation specific, but it shall be at least one. The value of timer TJ is MS implementation specific;\n-\tin automatic SNPN selection, the MS shall not select an SNPN for which the N1 mode capability was disabled as SNPN selection candidates, unless no other SNPN is available;\n-\tif the MS is not configured to use timer T3245, the MS maintains a list of SNPN-specific attempt counters for 3GPP access as specified in 3GPP TS 24.501 [64], and T3247 expires, then the MS removes for each SNPN-specific attempt counter for 3GPP access that has a value greater than zero and less than the MS implementation-specific maximum value the respective SNPN from the list of SNPNs for which the N1 mode capability was disabled, as specified in clause 5.3.20.3 in 3GPP TS 24.501 [64]; and\n-\tthe MS shall delete stored information on SNPNs for which the N1 mode capability was disabled when the MS is switched off, the USIM is removed, the entries of the \"list of subscriber data\" for the SNPNs are updated, or timer TJ expires.\nNOTE 18:\tThe expiry of timer TJ does not cause a reset of the SNPN-specific attempt counters for 3GPP access (see 3GPP TS 24.501 [64]).\nIf the MS does not support access to an SNPN using credentials from a credentials holder and does not support equivalent SNPNs, the MS should maintain a list of SNPNs where the N1 mode capability was disabled because IMS voice was not available and the MS's usage setting was \"voice centric\". If the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both the MS should maintain one or more lists of SNPNs where the N1 mode capability was disabled because IMS voice was not available and the MS's usage setting was \"voice centric\", each associated with an entry of the \"list of subscriber data\" or with the PLMN subscription. If the MS supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the MS shall use the lists associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription. When the MS disables its N1 mode capability due to IMS voice not available and the MS's usage setting was \"voice centric\":\n-\tthe MS should add the SNPN identity of the SNPN to the list of SNPNs where voice service was not possible in N1 mode and should start timer TK if timer TK is not already running. The number of SNPNs that the MS can store where voice services is not possible is implementation specific, but it shall be at least one. The value of timer TK is MS implementation specific;\n-\tin automatic SNPN selection the MS shall not consider SNPNs where voice service was not possible in N1 mode as SNPN selection candidates, unless no other SNPN is available; and\n-\tthe MS shall delete stored information on SNPNs where voice service was not possible in N1 mode when the MS is switched off, the USIM is removed, the entries of the \"list of subscriber data\" for the SNPNs are updated, or timer TK expires.\nThe MS may support equivalent SNPNs. If the MS supports equivalent SNPNs, the ME shall store up to one list of equivalent SNPNs:\n-\tper entry of \"list of subscriber data\"; or\n-\tper the PLMN subscription, if the MS supports access to an SNPN using credentials from a credentials holder.\nSNPNs in the list of equivalent SNPNs associated with the selected entry of \"list of subscriber data\" or the selected PLMN subscription shall be regarded by the MS as equivalent to each other for SNPN selection, cell selection, and cell re-selection. The list of equivalent SNPNs associated with the selected entry of \"list of subscriber data\" or the selected PLMN subscription is created, replaced or deleted at the end of each registration procedure. The stored list consists of a list of equivalent SNPNs as provided by the network plus the SNPN identity of the registered SNPN that provided the list. When the MS is switched off, the MS shall keep the stored list(s) so that they can be used for SNPN selection after switch on. The MS shall delete the stored list associated with an entry of \"list of subscriber data\" or the PLMN subscription, when the USIM is removed, the associated entry of \"list of subscriber data\" is updated, or the MS registered for emergency services deregisters.\nNOTE 19:\tThe MS can provide the list of equivalent SNPNs associated with the selected entry of \"list of subscriber data\" or the selected PLMN subscription to the lower layers.\nNOTE 20:\tThe list of equivalent SNPNs is not provided by the network when the MS is registering or is registered for onboarding services in SNPN.\nAt switch on, following recovery from lack of coverage, or when the MS starts operating in the SNPN access operation mode over 3GPP access, the MS selects the registered SNPN or an equivalent SNPN (if it is available) using NG-RAN access technology and if necessary (in the case of recovery from lack of coverage, see clause 4.5.2) attempts to perform an LR.\nNOTE 1:\tThe MS in automatic SNPN selection mode can end the SNPN search procedure once the registered SNPN or an equivalent SNPN is found on NG-RAN access technology.\nNOTE 2:\tAn MS in automatic SNPN selection mode can use location information to determine which SNPNs can be available in its present location.\nIf successful registration is achieved, the MS indicates the selected SNPN.\nIf there is no registered SNPN, or registration is not possible due to the SNPN and all equivalent SNPNs, if any, being unavailable or registration failure, unless the MS needs to select an SNPN for onboarding services in SNPN, the MS follows the procedure in clause 4.9.3.1.1 or clause 4.9.3.1.2 depending on its SNPN selection mode. If the MS needs to select an SNPN for onboarding services in SNPN, the MS follows the procedure in clause 4.9.3.1.3 or clause 4.9.3.1.4 depending on its SNPN selection mode for onboarding services in SNPN. At switch on, the MS shall use the SNPN selection mode and the SNPN selection mode for onboarding services in SNPN that were used before switching off.\nNOTE 3:\tIf successful registration is achieved, then the current serving SNPN becomes the registered SNPN and the MS does not store the previous registered SNPN for later use.\nIf registration is not possible on recovery from lack of coverage due to the registered SNPN and all equivalent SNPNs, if any, being unavailable, an MS may, optionally, continue looking for the registered SNPN or an equivalent SNPN for an implementation dependent time.\nNOTE 4:\tAn MS registered to an SNPN should behave as described above only if one or more PDU sessions are currently active.\nEXCEPTION: As an alternative option to this, if the MS is in automatic SNPN selection mode and it finds coverage of a subscribed SNPN (for the selected entry of \"list of subscriber data\"), the MS may register to that SNPN and not return to the registered SNPN or equivalent SNPN.\nIf:\n-\tthere is at least one entry in the \"list of subscriber data\"; or\n-\tthere is zero or more entries in the \"list of subscriber data\", the MS has a USIM with a PLMN subscription and the ME is provisioned with the SNPN selection parameters associated with the PLMN subscription,\nthe MS shall select one entry in the \"list of subscriber data\", if any, or the PLMN subscription, if any, to be used for automatic SNPN selection. How the MS selects the entry in the \"list of subscriber data\" or the PLMN subscription is MS implementation specific.\nThe MS selects an SNPN, if available and allowable, in the following order:\na0)\tif the MS supports access to an SNPN providing access for localized services in SNPN and access for localized services in SNPN is enabled, then, using the SNPN selection parameters for access for localized services in SNPN in the selected entry of the \"list of subscriber data\" or associated with the selected PLMN subscription:\n1)\tthe SNPN previously selected as result of an entry of a list of bullet a0) 2) or a0) 3) with which the UE was last registered, if validity information of the entry is still met, or the equivalent SNPN if it is available and validity information of the entry of the SNPN previously selected as result of an entry of a list of bullet a0) 2) or a0) 3) with which the UE was last registered is still met;\n2)\teach SNPN which broadcasts the indication that access using credentials from a credentials holder is supported and which is identified by an SNPN identity contained in an entry of the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" (in priority order), if the validity information of the entry is met; and\n3)\teach SNPN which broadcasts the indication that access using credentials from a credentials holder is supported and which broadcast a GIN contained in an entry of the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" (in priority order), if the validity information of the entry is met. If more than one such SNPN broadcast the same GIN, the order in which the MS attempts registration on those SNPNs is MS implementation specific;\na)\tthe SNPN with which the UE was last registered or an equivalent SNPN, except if the registered SNPN was previously selected as result of an entry of a list of bullet a0) 2) or a0) 3) and validity information of the entry is no longer met or access for localized services in SNPN is no longer enabled;\nb)\tthe SNPN identified by an SNPN identity of the subscribed SNPN in the selected entry of the \"list of subscriber data\" in the ME, if any;\nc)\tif the MS supports access to an SNPN using credentials from a credentials holder, using the SNPN selection parameters in the selected entry of the \"list of subscriber data\" or associated with the selected PLMN subscription:\n1)\teach SNPN which broadcasts the indication that access using credentials from a credentials holder is supported and which is identified by an SNPN identity contained in the user controlled prioritized list of preferred SNPNs (in priority order);\n2)\teach SNPN which broadcasts the indication that access using credentials from a credentials holder is supported and which is identified by an SNPN identity contained in the credentials holder controlled prioritized list of preferred SNPNs (in priority order);\n3)\teach SNPN which broadcasts the indication that access using credentials from a credentials holder is supported and which broadcast a GIN contained in the credentials holder controlled prioritized list of GINs (in priority order). If more than one such SNPN broadcast the same GIN, the order in which the MS attempts registration on those SNPNs is MS implementation specific; and\n4)\teach SNPN identified by an SNPN identity which is included neither in the SNPN selection parameters of the entries of the \"list of subscriber data\" nor in the SNPN selection parameters associated with the PLMN subscription, which does not broadcast a GIN which is included in the credentials holder controlled prioritized list of GINs, and which broadcasts an indication that the SNPN allows registration attempts from MSs that are not explicitly configured to select the SNPN. If more than one such SNPN is available, the order in which the MS attempts registration on those SNPNs is MS implementation specific.\nThe MS shall limit its search for the SNPN to the NG-RAN access technology.\nOnce the MS selects the SNPN, the MS attempts registrations on the selected SNPN using the NG-RAN access technology, the subscriber identifier and the credentials from the selected entry of the \"list of subscriber data\" or from the USIM, if the PLMN subscription is selected.\nIf successful registration is achieved, the MS indicates the selected SNPN.\nIf:\na)\tin bullet a0), the MS is unable to select an SNPN for access for localized services in SNPN and the validity information of\n-\tan entry of the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\"; or\n-\tan entry of the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\",\nof the selected entry of the \"list of subscriber data\" or associated with the selected PLMN subscription is still met;\nb)\tthe MS is not registered for emergency services; and\nc)\tthe MS does not have an established emergency PDU session,\nthe MS shall re-attempt to perform the SNPN selection to select an SNPN providing access for localized services in SNPN in accordance with the requirements that are applicable to bullets a0). This re-attempt and subsequent re-attempts if still required is determined by the MS in an implementation specific way, and should be triggered if the validity information is still met.\nIf registration cannot be achieved because no SNPNs are available, allowable, and identified by an SNPN identity in an entry of the \"list of subscriber data\" in the ME, the MS indicates \"no service\" to the user, waits until a new SNPN is available, allowable, and identified by an SNPN identity in an entry of the \"list of subscriber data\" in the ME and then repeats the procedure.\nIf there were one or more SNPNs which were available, allowable, and identified by an SNPN identity in an entry of the \"list of subscriber data\" in the ME but an LR failure made registration on those SNPNs unsuccessful, the MS selects one of those SNPNs again and enters a limited service state.\nIf an SNPN is being removed from the \"temporarily forbidden SNPNs\" or the \"permanently forbidden SNPNs\" list (e.g due to MS implementation specific timer not shorter than 60 minutes expires or timer T3245 expires), and the MS is in limited service state, and the MS does not have a PDU session for emergency services, the MS shall perform SNPN selection as described in subclause 4.9.3.1. If the MS has an established emergency PDU session, then the UE shall attempt to perform the SNPN selection subsequently after the emergency PDU session is released.\n\nIf:\na)\tthe MS supports access to an SNPN providing access for localized services in SNPN;\nb)\tthe access for localized services in SNPN has been enabled;\nc)\tthe MS is in limited service state;\nd)\tthe MS does not have a PDU session for emergency services; and\ne)\tan SNPN is being removed from the list of \"permanently forbidden SNPNs for access for localized services in SNPN\" or \"temporarily forbidden SNPNs for access for localized services in SNPN\" (e.g due to MS implementation specific timer not shorter than 60 minutes expires, timer T3245 expires or validity information of the SNPN becomes valid);\nthe MS shall perform SNPN selection as described in subclause 4.9.3.1. If the MS has an established emergency PDU session, then the UE shall attempt to perform the SNPN selection subsequently after the emergency PDU session is released.\n\nThe MS indicates to the user any available SNPNs which meet the criteria specified in bullets a) and b). If the MS does not support access to an SNPN using credentials from a credentials holder, this includes SNPNs in the list of \"permanently forbidden SNPNs\", and the list of \"temporarily forbidden SNPNs\". The MS may indicate to the user whether the available SNPNs are present in the list of \"temporarily forbidden SNPNs\" or the list of \"permanently forbidden SNPNs\". If the MS supports access to an SNPN using credentials from a credentials holder, this includes SNPNs in the lists of \"permanently forbidden SNPNs\", and the lists of \"temporarily forbidden SNPNs\" associated with each entry of the \"list of subscriber data\" or the PLMN subscription. If the MS supports equivalent SNPNs, this includes SNPNs in the lists of \"permanently forbidden SNPNs\", and the lists of \"temporarily forbidden SNPNs\" associated with each entry of the \"list of subscriber data\". The MS may indicate to the user whether the available SNPNs are present in a list of \"temporarily forbidden SNPNs\" or a list of \"permanently forbidden SNPNs\" for an entry of the \"list of subscriber data\" or the PLMN subscription. If the MS supports access to an SNPN providing access for localized services in SNPN, this includes SNPNs in the lists of \"permanently forbidden SNPNs for access for localized services in SNPN\", and the lists of \"temporarily forbidden SNPNs for access for localized services in SNPN\" associated with each entry of the \"list of subscriber data\" or the PLMN subscription. If the MS supports access to an SNPN providing access for localized services in SNPN, the MS may indicate to the user whether an available SNPN is identified by an SNPN identity contained in an entry of one of the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" and whether the validity information of the entry is met, whether an available SNPN is broadcasting a GIN contained in an entry of one of the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" and whether the validity information of the entry is met and whether an available SNPNs are present in a list of \"temporarily forbidden SNPNs for access for localized services in SNPN\" or a list of \"permanently forbidden SNPNs for access for localized services in SNPN\" for an entry of the \"list of subscriber data\" or the PLMN subscription.\na)\tSNPNs with the following order:\n1)\tidentified by an SNPN identity contained in one of the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" configured in the ME if the validity information of the entry is met, the MS supports access to an SNPN providing access for localized services in SNPN. Prioritization between the different lists is MS implementation specific;\n2)\tbroadcast a GIN contained in one of the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" configured in the ME if the validity information of the entry is met, the MS supports access to an SNPN providing access for localized services in SNPN. Prioritization between the different lists is MS implementation specific. If more than one SNPN broadcast the same GIN, the order in which those SNPNs are indicated is MS implementation specific;\n3)\tidentified by an SNPN identity contained in one of the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" configured in the ME if the validity information of the entry is not met, the MS supports access to an SNPN providing access for localized services in SNPN. Prioritization between the different lists is MS implementation specific;\n4)\tbroadcast a GIN contained in one of the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" configured in the ME if the validity information of the entry is not met, the MS supports access to an SNPN providing access for localized services in SNPN. Prioritization between the different lists is MS implementation specific. If more than one SNPN broadcast the same GIN, the order in which those SNPNs are indicated is MS implementation specific; and\n5)\tidentified by an SNPN identity in an entry of the \"list of subscriber data\" in the ME, if any. The order in which those SNPNs are indicated is MS implementation specific;\nb)\tif the MS supports access to an SNPN using credentials from a credentials holder, for the SNPNs which broadcast the indication that access using credentials from a credentials holder is supported:\n1)\teach SNPN which is identified by an SNPN identity contained in one of the user controlled prioritized lists of preferred SNPNs configured in the ME. SNPNs included in the same list are indicated in the order in which they are included in the list. Prioritization between the different lists is MS implementation specific;\n2)\teach SNPN which is identified by an SNPN identity contained in one of the credentials holder controlled prioritized lists of preferred SNPNs configured in the ME. SNPNs included in the same list are indicated in the order in which they are included in the list. Prioritization between the different lists is MS implementation specific;\n3)\teach SNPN which broadcasts a GIN contained in one of the credentials holder controlled prioritized lists of GINs configured in the ME. SNPNs broadcasting a GIN included in the same list are indicated in the order in which the GIN is included in the list. Prioritization between the different lists is MS implementation specific. If more than one SNPN broadcast the same GIN, the order in which those SNPNs are indicated is MS implementation specific; and\n4)\teach SNPN identified by an SNPN identity which is not indicated in any of bullets a), b) 1), b) 2) or b) 3). The order in which those SNPNs are indicated is MS implementation specific.\nFor each of the SNPNs indicated to the user, the MS shall forward a human-readable network name along with the SNPN identity to the upper layers if the system information broadcasted for the SNPN includes the human-readable network name for the SNPN.\nThe MS shall limit its search for the SNPN to the NG-RAN access technology.\nIf the UE has a PDU session for emergency services manual SNPN selection shall not be performed.\nThe user may select an SNPN. If the user selects an SNPN, the MS then initiates registration on this SNPN using the NG-RAN access technology and for such registration the MS shall ignore the contents of the \"5GS forbidden tracking areas for roaming\", \"5GS forbidden tracking areas for regional provision of service\", \"temporarily forbidden SNPNs\", \"permanently forbidden SNPNs\", \"permanently forbidden SNPNs for access for localized services in SNPN\" and \"temporarily forbidden SNPNs for access for localized services in SNPN\". For such registration, the subscriber identifier and the credentials from the selected entry of the \"list of subscriber data\" or from USIM, if the PLMN subscription is selected, are determined as follows:\n-\tfor bullet a) 1) above:\ni)\tthe entry of the \"list of subscriber data\" which contains the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" that includes the SNPN identity of the selected SNPN shall be considered as selected, if the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" that includes the SNPN identity of the selected SNPN is included in the entry of the \"list of subscriber data\" and validity information of the selected SNPN in the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" that includes the SNPN identity of the selected SNPN is met; or\nii)\tthe PLMN subscription shall be considered as selected, if the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" associated with the PLMN subscription includes the SNPN identity of the selected SNPN and validity information of the selected SNPN in the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" that includes the SNPN identity of the selected SNPN is met;\n-\tfor bullet a) 2) above:\ni)\tthe entry of the \"list of subscriber data\" which contains the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" that includes the GIN broadcast by the selected SNPN shall be considered as selected, if the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" that includes the GIN broadcasted by the selected SNPN is included in the entry of the \"list of subscriber data\" and validity information of the GIN in the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" that includes the GIN is met; or\nii)\tthe PLMN subscription shall be considered as selected, if the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" associated with the PLMN subscription includes the GIN broadcast by the selected SNPN and validity information of the GIN in the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" that includes the GIN is met;\n-\tfor bullet a) 3) above:\ni)\tthe entry of the \"list of subscriber data\" which contains the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" that includes the SNPN identity of the selected SNPN shall be considered as selected, if the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" that includes the SNPN identity of the selected SNPN is included in the entry of the \"list of subscriber data\" and validity information of the selected SNPN in the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" that includes the SNPN identity of the selected SNPN is not met; or\nii)\tthe PLMN subscription shall be considered as selected, if the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" associated with the PLMN subscription includes the SNPN identity of the selected SNPN and validity information of the selected SNPN in the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" that includes the SNPN identity of the selected SNPN is not met;\n-\tfor bullet a) 4) above:\ni)\tthe entry of the \"list of subscriber data\" which contains the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" that includes the GIN broadcast by the selected SNPN shall be considered as selected, if the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" that includes the GIN broadcasted by the selected SNPN is included in the entry of the \"list of subscriber data\" and validity information of the GIN in the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" that includes the GIN is not met; or\nii)\tthe PLMN subscription shall be considered as selected, if the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" associated with the PLMN subscription includes the GIN broadcast by the selected SNPN and validity information of the GIN in the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" that includes the GIN is not met;\n-\tfor bullet a) 5) above, the entry of the \"list of subscriber data\", with the SNPN identity matching the selected SNPN (this may take place at any time during the presentation of SNPNs), shall be considered as selected;\n-\tfor bullet b-1) above:\ni)\tthe entry of the \"list of subscriber data\" which contains the user controlled prioritized lists of preferred SNPNs that includes the SNPN identity of the selected SNPN shall be considered as selected, if the user controlled prioritized list of preferred SNPNs that includes the SNPN identity of the selected SNPN is included in the entry of the \"list of subscriber data\"; or\n-\tthe PLMN subscription shall be considered as selected, if the user controlled prioritized list of preferred SNPNs associated with the PLMN subscription includes the SNPN identity of the selected SNPN;\n-\tfor bullet b-2) above:\ni)\tthe entry of the \"list of subscriber data\" which contains the credentials holder controlled prioritized list of preferred SNPNs that includes the SNPN identity of the selected SNPN shall be considered as selected, if the credentials holder controlled prioritized list of preferred SNPNs that includes the SNPN identity of the selected SNPN is included in the entry of the \"list of subscriber data\"; or\nii)\tthe PLMN subscription shall be considered as selected, if the credentials holder controlled prioritized list of preferred SNPNs associated with the PLMN subscription includes the SNPN identity of the selected SNPN;\n-\tfor bullet b-3) above:\ni)\tthe entry of the \"list of subscriber data\" which contains the credentials holder controlled prioritized list of GINs that includes the GIN broadcast by the selected SNPN shall be considered as selected, if the credentials holder controlled prioritized list of GINs that includes the GIN broadcast by the selected SNPN is included in the entry of the \"list of subscriber data\"; or\nii)\tthe PLMN subscription shall be considered as selected, if the credentials holder controlled prioritized list of GINs associated with the PLMN subscription includes the GIN broadcast by the selected SNPN; and\n-\tfor bullet b-4) above, the entry of the \"list of subscriber data\" or the PLMN subscription shall be selected by MS implementation specific means.\nNOTE1:\tIf the SNPN identity of the selected SNPN is included in more than one of the following: one or more user controlled prioritized list(s) of preferred SNPNs configured in the ME, one or more credentials holder controlled prioritized list(s) of preferred SNPNs configured in the ME or the list of SNPNs which are broadcasting a GIN included in one or more credentials holder controlled prioritized list(s) of GINs configured in the ME, which subscription is selected is MS implementation specific.\nOnce the MS has registered on an SNPN selected by the user, the MS shall not automatically register on a different SNPN unless:\na)\tthe user selects automatic SNPN selection mode;\nb)\tthe user initiates an emergency call while the MS is in limited service state and either the SNPN does not broadcast the indication of support of emergency calls in limited service state or the registration request for emergency services is rejected by the network; or\nc)\tthe new SNPN is declared as an equivalent SNPN by the registered SNPN.\nNOTE 2:\tIf case b) occurs, the MS can provide an indication to the upper layers that the MS has exited manual network SNPN selection mode.\nIf the user does not select an SNPN, the selected SNPN shall be the one that was selected either automatically or manually before the SNPN selection procedure started. If no such SNPN was selected or that SNPN is no longer available, then the MS shall attempt to camp on any acceptable cell and enter the limited service state.\nWhen the MS needs to access an SNPN for onboarding services in SNPN, the MS shall select an SNPN indicating that onboarding is allowed and, if the onboarding SNPN selection information is pre-configured, also matching the onboarding SNPN selection information. If more than one such SNPNs are available, how the MS selects one of those SNPNs is MS implementation specific. The MS shall not select an SNPN not indicating that onboarding is allowed or not matching the onboarding SNPN selection information, if pre-configured, for onboarding services in SNPN.\nThe MS shall limit its search for the SNPN to the NG-RAN access technology.\nOnce the MS selects the SNPN, the MS shall attempt initial registration for onboarding services in SNPN on the selected SNPN using the NG-RAN access technology and the default UE credentials for primary authentication.\nIf successful registration is achieved, the MS may indicate to upper layers the selected SNPN. How this indication is displayed by upper layers is implementation specific.\nIf successful registration is not achieved and one or more other SNPNs indicating that onboarding is allowed and matching the onboarding SNPN selection information, if pre-configured, are available, the MS can select such other SNPN and attempt initial registration for onboarding services in SNPN on the selected SNPN using the NG-RAN access technology and the default UE credentials for primary authentication, or the MS can perform SNPN selection not for onboarding services in SNPN as specified in clause 4.9.3.1.1 or clause 4.9.3.1.2 depending on its SNPN selection mode.\nIf:\n-\tregistration cannot be achieved because no SNPNs indicating that onboarding is allowed and matching the onboarding SNPN selection information, if pre-configured, are available; or\n-\tthere were one or more SNPNs indicating that onboarding is allowed and matching the onboarding SNPN selection information, if pre-configured, but an LR failure made registration on all those SNPNs unsuccessful;\nthe MS can indicate no onboarding services to upper layers, enter limited service state and wait until a new SNPN indicating that onboarding is allowed and matching the onboarding SNPN selection information, if pre-configured, is available and then repeat the procedure, or the MS can perform SNPN selection not for onboarding services in SNPN as specified in clause 4.9.3.1.1 or clause 4.9.3.1.2 depending on its SNPN selection mode.\nThe MS shall indicate to upper layers one or more SNPNs, which are available and indicate that onboarding is allowed.\nThese include SNPNs in the list of \"permanently forbidden SNPNs\" for onboarding services and the list of \"temporarily forbidden SNPNs\" for onboarding services. The MS may indicate to the user whether the available SNPNs are present in the list of \"temporarily forbidden SNPNs\" or the list of \"permanently forbidden SNPNs\".\nThe MS shall limit its search for the SNPN to the NG-RAN access technology.\nFor each SNPN indicated to upper layers, the MS shall indicate to the upper layers along with the SNPN identity:\na)\twhether the SNPN matches the onboarding SNPN selection information, if pre-configured; and\nb)\tthe human-readable network name, if the system information broadcast includes the human-readable network name for the SNPN.\nOnce the user selects the SNPN for onboarding services, the MS shall attempt initial registration for onboarding services in SNPN on the selected SNPN using the default UE credentials for primary authentication. For such a registration the MS shall ignore the contents of the \"5GS forbidden tracking areas for roaming\", \"5GS forbidden tracking areas for regional provision of service\", \"temporarily forbidden SNPNs\" for onboarding services and \"permanently forbidden SNPNs\" for onboarding services.\n\nAt any time the user may request the MS to initiate reselection and registration onto an available SNPN, according to the following procedures, dependent upon the SNPN selection mode of the UE.\nIf:\n-\tthere is at least one entry in the \"list of subscriber data\"; or\n-\tthere is zero or more entries in the \"list of subscriber data\", the MS has a USIM with a PLMN subscription and the ME is provisioned with the SNPN selection parameters associated with the PLMN subscription,\nthe MS shall select one entry in the \"list of subscriber data\", or the PLMN subscription, if any, to be used for automatic SNPN selection. How the MS selects the entry in the \"list of subscriber data\" or the PLMN subscription is MS implementation specific.\nThe MS selects an SNPNs, if available and allowable, in accordance with the following order:\na0)\tif the MS supports access to an SNPN providing access for localized services in SNPN and access for localized services in SNPN is enabled, then, using the SNPN selection parameters for access for localized services in SNPN in the selected entry of the \"list of subscriber data\" or associated with the selected PLMN subscription:\n1)\teach SNPN which broadcasts the indication that access using credentials from a credentials holder is supported and is identified by an SNPN identity contained in an entry of the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" (in priority order), if the validity information of the entry is met, excluding the previously selected SNPN; and\n2)\teach SNPN which broadcasts the indication that access using credentials from a credentials holder is supported and broadcasts a GIN contained in an entry of the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" (in priority order), if the validity information of the entry is met, excluding the previously selected SNPN. If more than one such SNPN broadcast the same GIN, the order in which the MS attempts registration on those SNPNs is MS implementation specific;\na)\tthe SNPN identified by an SNPN identity of the subscribed SNPN in the selected entry of the \"list of subscriber data\" in the ME, if any, excluding the previously selected SNPN;\nb)\tif the MS supports access to an SNPN using credentials from a credentials holder, using the SNPN selection parameters in the selected entry of the \"list of subscriber data\" or associated with the selected PLMN subscription:\n1)\teach SNPN which broadcasts the indication that access using credentials from a credentials holder is supported and which is identified by an SNPN identity contained in the user controlled prioritized list of preferred SNPNs (in priority order), excluding the previously selected SNPN;\n2)\teach SNPN which broadcasts the indication that access using credentials from a credentials holder is supported and which is identified by an SNPN identity contained in the credentials holder controlled prioritized list of preferred SNPNs (in priority order), excluding the previously selected SNPN;\n3)\teach SNPN which broadcasts the indication that access using credentials from a credentials holder is supported and which broadcast a GIN contained in the credentials holder controlled prioritized list of GINs (in priority order), excluding the previously selected SNPN. If more than one such SNPN broadcast the same GIN, the order in which the MS attempts registration on those SNPNs is MS implementation specific; and\n4)\teach SNPN identified by an SNPN identity which is included neither in the SNPN selection parameters of the entries of the \"list of subscriber data\" nor in the SNPN selection parameters associated with the PLMN subscription and which broadcasts an indication that the SNPN allows registration attempts from MSs that are not explicitly configured to select the SNPN, excluding the previously selected SNPN. If more than one such SNPN is available, the order in which the MS attempts registration on those SNPNs is MS implementation specific.\nc)\tthe previously selected SNPN.\nThe MS shall limit its search for the SNPN to the NG-RAN access technology.\nThe previously selected SNPN is the SNPN which the MS has selected prior to the start of the user reselection procedure.\nThe equivalent SNPNs list shall not be applied to the user reselection in automatic SNPN selection mode.\nOnce the MS selects an SNPN, if the selected SNPN is other than the previously selected SNPN, the MS attempts registrations on the selected SNPN using the NG-RAN access technology, the subscriber identifier and the credentials from the selected entry of the \"list of subscriber data\" or from the USIM, if the PLMN subscription is selected.\nNOTE:\tIf the previously selected SNPN is selected, and registration has not been attempted on any other SNPNs, then the MS is already registered on the SNPN, and so registration is not necessary.\nThe manual SNPN selection mode procedure of clause 4.9.3.1.2 is followed.\nIf the MS supports access to an SNPN providing access for localized services in SNPN, the UE is in automatic SNPN selection mode and:\na)\taccess for localized services in SNPN is changed between disabled and enabled; or\nb)\taccess for localized services in SNPN is enabled; and:\n1)\tthe selected SNPN is an SNPN selected for localized services in SNPN, and the validity information for the selected SNPN is no longer met; or\n2)\tthe selected SNPN is not an SNPN selected for localized services in SNPN, and the validity information for an entry in the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" or \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" changes from not met to met;\nthen:\n-\tif the MS does not have an emergency PDU session and is not registered for emergency services, the MS may perform SNPN selection according to clause 4.9.3.1.1; or\n-\totherwise, if the validity information for the selected SNPN is no longer met the MS shall perform a local release of all PDU sessions except for the emergency PDU session. The MS may perform SNPN selection according to clause 4.9.3.1.1 after the emergency PDU session is released.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.9.4\tAbnormal cases",
                            "text_content": "If:\na)\tthe MS does not support access to an SNPN using credentials from a credentials holder and:\n1)\tthe \"list of subscriber data\" is empty; or\n2)\tfor each entry of the \"list of subscriber data\", such that an SNPN with the SNPN identity of the entry or an equivalent SNPN, is available:\ni)\tthere has been an authentication failure for the subscriber identifier of the entry on the SNPN or an equivalent SNPN; or\nii)\tthe MS has received an \"illegal ME\" or \"illegal UE\" response to an LR request for the subscriber identifier of entry on the SNPN or an equivalent SNPN; or\nb)\tthe MS supports access to an SNPN using credentials from a credentials holder and:\n1)\tthe \"list of subscriber data\" is empty and:\ni)\tthe MS is not provisioned with SNPN selection parameters associated with the PLMN subscription;\nii)\tthe MS does not have a USIM; or\niii)\tboth of the above;\n2)\tfor each entry of the \"list of subscriber data\", such that an SNPN with the SNPN identity of the subscribed SNPN of the entry or an equivalent SNPN, is available:\ni)\tthere has been an authentication failure for the subscriber identifier of the entry on the SNPN or an equivalent SNPN; or\nii)\tthe MS has received an \"illegal ME\" or \"illegal UE\" response to an LR request for the subscriber identifier of entry on the SNPN or an equivalent SNPN;\nand:\ni)\tthe MS is not provisioned with SNPN selection parameters associated with the PLMN subscription;\nii)\tthe MS does not have a USIM; or\niii)\tboth of the above; or\n3)\tfor each available SNPN which broadcasts an indication that access using credentials from a credentials holder is supported and:\ni)\tis identified by an SNPN identity contained in one of the user controlled prioritized lists of preferred SNPNs configured in the ME;\nii)\tis identified by an SNPN identity contained in one of:\n-\tthe credentials holder controlled prioritized lists of preferred SNPNs configured in the ME; or\n-\tthe \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" configured in the ME supporting access to an SNPN providing access for localized services in SNPN and the access for localized services in SNPN is enabled and the validity information of the SNPN is met;\niii)\tbroadcasts a GIN contained in one of:\n-\tthe credentials holder controlled prioritized lists of GINs configured in the ME; or\n-\tthe \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" configured in the ME supporting access to an SNPN providing access for localized services in SNPN and the access for localized services in SNPN is enabled and the validity information of the SNPN is met;\niv)\tis identified by an SNPN identity which is included neither in the SNPN selection parameters of the entries of the \"list of subscriber data\" nor in the SNPN selection parameters associated with the PLMN subscription, which does not broadcast a GIN which is included in one of the credentials holder controlled prioritized lists of GINs configured in the ME and which broadcasts an indication that the SNPN allows registration attempts from MSs that are not explicitly configured to select the SNPN;\nthe following applies:\ni)\tthere has been an authentication failure in the SNPN; or\nii)\tthe MS has received an \"illegal ME\" or \"illegal UE\" response to an LR request from the SNPN;\nthen effectively there is no selected SNPN (\"No SIM\" state).\nIn these cases, the states of the cell selection process are such that the \"list of subscriber data\" (if any) or the PLMN subscription (if any) is not used. An MS in \"No SIM\" state configured with default UE credentials for primary authentication may perform SNPN selection procedure for onboarding services in SNPN. Except when an MS in \"No SIM\" state performs an initial registration for emergency services to an SNPN or an MS in \"No SIM\" state configured with default UE credentials for primary authentication performs registration for onboarding services in SNPN, no further attempts at registration on any SNPN are made until the MS is switched off and on again, or an entry of the \"list of subscriber data\" with the SNPN identity of the SNPN is updated or the USIM is inserted. When performing an initial registration for emergency services, an SNPN supporting emergency services, of the current serving cell is temporarily considered as the selected SNPN. If the MS needs to make an emergency call, the MS supports accessing a PLMN and there is no available SNPN supporting emergency services, the MS shall stop operating in SNPN access operation mode over 3GPP access and attempt to camp on a cell of a PLMN so that emergency calls can be made. After an emergency call is released, the MS may re-start operating in SNPN access operation mode over 3GPP access and perform SNPN selection.\nWhen in automatic SNPN selection mode and the MS is in the \"not updated\" state with one or more suitable cells to camp on; then after the maximum allowed unsuccessful LR requests (controlled by the specific attempt counters) the MS may continue (or start if it is not running) the user reselection procedure in clause 4.9.3.2.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "5\tTables and Figures",
            "description": "Table 1: Effect of LR Outcomes on PLMN Registration\n\nTable 2: LR Process States and Allowed Actions\n\n\n\n\nFigure 1 illustrates the overall idle mode process in a wireless communication system, showcasing the synchronization between the transmitter and receiver. The figure depicts the synchronization signals exchanged between the two devices, ensuring that they are operating at the same frequency and phase. This synchronization is crucial for maintaining a stable connection and preventing interference. The figure also highlights the role of the base station in coordinating the communication process, as well as the importance of timing accuracy in maintaining a reliable connection. Overall, the figure provides a clear overview of the synchronization process in wireless communication systems.\nFigure 1: Overall Idle Mode process\nThe individual steps are the following (they are not necessarily executed in the number sequence):\n(1) The PLMN selection mode is set (e.g. by the user via the user interface or by AT command).\n(2) The list of available PLMNs is presented to the user, according to the rules given in clause 4.4.3.1.2.\n(3) In manual PLMN selection mode the user selects from the available PLMNs.\n(4) If the MS supports CSGs, the list of available PLMNs and CSGs, together with an indication as to which of the available CSGs is in the Allowed or Operator CSG list, is presented to the user upon request. The detailed rules are defined in clause 5.5.4 of 3GPP TS 22.220 [49].\n(5) Only for MSs supporting CSGs: when camping on a cell, the available CSGs (with PLMN information) are conveyed to the CSG selection/restriction procedure (see clause 3.1A).\n(6) Only for MSs supporting CSGs: in manual CSG selection mode the user selects from the available CSGs.\n(7) Only for MSs supporting CSGs: if the selected CSG is associated with the RPLMN, the MS performs selection of a cell belonging to this CSG.\n(8) Only for MSs supporting CSGs: if the selected CSG is associated with a PLMN different from the RPLMN, the MS enters the PLMN selection process and performs the parts applicable after manual selection of a PLMN.\n(9) After it has selected a PLMN, the MS performs selection of a cell belonging to this PLMN; this selection is additionally restricted by the selected CSG, if the PLMN selection was triggered by a manual CSG selection.\n(10) After having selected a new cell and the registration area has changed, the MS shall enter the LR process (see figure 3).\n(10a) An MS's CM requests may lead to a registration request.\n(11) If the LR is not successful, and if the cause received from the network does not exclude the RPLMN, the MS performs another cell selection (i.e. cell re-selection) within the RPLMN.\n(12) The information on available PLMNs, as detected by the cell selection process from detectable broadcast information, is made available to the PLMN selection process.\n(13) If the LR is not successful, and if the cause received from the network excludes the RPLMN, the MS performs PLMN selection.\n(14) The positive result of cell selection (suitable cell and in updated state, or in connected mode having been camped on a suitable cell) and location registration (updated, for MSs capable of services requiring registration) is indicated to the user.\n\nPossible sequences of steps are e.g.:\n1) 1 2  3  9  10  11 (manual PLMN selection, MS is not CSG capable)\n2) 1  9  4  5  6  8  9  10  11 (automatic PLMN selection, MS is CSG capable, manual CSG selection);\n\n\nFigure 2a illustrates the process of PLMN selection in automatic mode, depicting the various states a mobile device may transition through when establishing a connection. The figure showcases the initial state, where the device searches for available networks, and progresses through the selection process, including the discovery of neighboring cells, the selection of the best cell, and the establishment of a connection. Key elements include the mobile device, serving and neighboring cells, and the signaling process between them. The diagram emphasizes the importance of efficient network selection for optimal connectivity and performance.\nFigure 2a: PLMN Selection State diagram (automatic mode)\nFigure 2b illustrates the manual mode of PLMN selection state diagram, depicting the process of selecting a Public Land Mobile Network (PLMN) based on the signal strength and quality. The diagram showcases the various stages, including the initial connection attempt, signal strength measurement, and subsequent PLMN selection, all of which are crucial for establishing a reliable and efficient communication link. Key elements include the mobile station (MS), serving PLMN, and the network elements involved in the selection process. The visual representation emphasizes the importance of accurate signal strength and quality assessment for successful network connectivity.\nFigure 2b: PLMN Selection State diagram (manual mode)\n\n\nThe given telecommunication figure illustrates the state selection process of a mobile station (MS) when transitioning between connected and idle modes. The figure shows a timeline with different states, such as connected, idle, and roaming, indicating the MS's connection status at various points in time. The figure emphasizes the importance of selecting the appropriate state to ensure seamless communication and optimal resource utilization in a dynamic telecommunication environment.\nNOTE 1:\tWhenever the MS goes to connected mode and then returns to idle mode again the MS selects appropriate state.\nNOTE 2:\tAn MS capable of GPRS and non-GPRS services has two Task State machines one for GPRS and one for non-GPRS operation.\n\nFigure 3: Location Registration Task State diagram\n",
            "summary": "",
            "tables": [
                {
                    "description": "Table 1: Effect of LR Outcomes on PLMN Registration",
                    "table number": 3,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "Table 2: LR Process States and Allowed Actions",
                    "table number": 4,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "6\tMS supporting access technologies defined both by 3GPP and 3GPP2",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "An MS that supports access technologies defined both by 3GPP and 3GPP2 (see 3GPP TS 31.102 [40]) shall consider all supported access technologies in all supported bands when performing PLMN selection.\nThe goal of the PLMN selection process for such a multi mode MS is to find the highest priority PLMN and to attempt to register to it.\nA multi mode MS shall follow the requirements in the present document for the PLMN selection procedures across both 3GPP and 3GPP2 access technologies. Additionally, the MS shall follow the requirements of the present document in its signalling procedures towards any 3GPP network. If the common PLMN selection procedure leads to selection of a 3GPP2 network, then the MS shall follow 3GPP2 specifications in meeting any 3GPP2 specific system selection constraints and in all signalling procedures towards the 3GPP2 network.\nWhile registered to VPLMN via 3GPP2 access, the MS shall follow the 3GPP2 specifications for scan of higher priority PLMNs. Additionally to the requirements specified for 3GPP2 system, a multi mode MS while registered to a 3GPP2 VPLMN shall follow the requirements specified in clause 4.4.3.3.\nNOTE:\tIt is assumed that the MS can determine the PLMN identity of networks supporting 3GPP2 technologies from the information broadcast over the air.\nWith the introduction of PCS1900 with the regulatory mandate to allocate 3-digit MNC codes, additional functionality is required to identify the HPLMN.\nAssumptions\nAn MNC code shall consist of 2 or 3 decimal digits. In NA PCS1900, all SIMs shall store 3 digit MNCs.\nAny network using a 2 digit MNC code shall broadcast the hexadecimal code \"F\" in place of the 3rd digit.\nFor PCS1900 for North America, regulations mandate that a 3-digit MNC shall be used; however during a transition period, a 2 digit MNC may be broadcast by the Network and, in this case, the 3rd digit of the SIM is stored as 0 (this is the 0 suffix rule).\nWith the exception of North America during the transition period:\na)\tWithin a single country (or area identified by a MCC) all networks shall broadcast a 2 digit MNC code, or all networks shall broadcast a 3 digit MNC code. A mixture of broadcast 2 and 3 digit MNC codes is not permitted within a single country (or area identified by a MCC).\nb)\tA network which broadcasts a 2 digit MNC code, will issue SIMs with a 2 digit MNC code in the IMSI on the SIM. A network which broadcasts a 3 digit MNC code, will issue SIMs with a 3 digit MNC code in the IMSI on the SIM.\nDefinitions and abbreviations\nBCCH-MCC\tFor GERAN, the MCC part of the LAI read from System Information type 3 messages broadcast on the BCCH by the network (see 3GPP TS 44.018 [34]), for UTRA, the MCC part of the PLMN broadcasted as specified in 3GPP TS 25.331 [33], for E-UTRA, the MCC part of the PLMN broadcasted as specified in 3GPP TS 36.331 [42], or for NR, the MCC part of the PLMN broadcasted as specified in 3GPP TS 38.331 [65].\nBCCH-MNC\tFor GERAN the MNC part of the LAI read from System Information type 3 messages broadcast on the BCCH by the network (see 3GPP TS 44.018 [34]), for UTRA, the MNC part of the PLMN broadcasted as specified in 3GPP TS 25.331 [33], for E-UTRA, the MNC part of the PLMN broadcasted as specified in 3GPP TS 36.331 [42], or for NR, the MNC part of the PLMN broadcasted as specified in 3GPP TS 38.331 [65].\nSIM-MCC\tThe MCC part of the IMSI or of additional entries in the EHPLMN list read from the SIM.\nSIM-MNC\tThe MNC part of the IMSI or of additional entries in the EHPLMN list read from the SIM.\nHPLMN Matching Criteria in mobiles which don't support PCS1900 for NA:\nFigure A.1 illustrates the logic flow described below. The text below is normative. Figure A.1 is informative.\n(1)\tThe MS shall compare using all 3 digits of the SIM-MCC with the BCCH-MCC. If the values do not match, then the HPLMN match fails.\nNOTE:\tIf the MCC codes match, then the number of digits used for the SIM-MNC must be the same as the number of digits used for the BCCH-MNC.\n(2)\tThe MS shall read the 3rd digit of the BCCH-MNC. If the 3rd digit is Hex F, then proceed to step (4).\n(3)\tThe MS shall compare using all 3 digits of the SIM-MNC with the BCCH-MNC. If the values match, then the HPLMN match succeeds, otherwise the HPLMN match fails.\n(4)\tThe MS shall compare using just the 1st 2 digits the SIM-MNC with the BCCH-MNC. If the values match, then the HPLMN match succeeds, otherwise the HPLMN match fails.\nIf the EHPLMN list is present and is empty or if the EHPLMN list is not present, the matching procedure shall be done for the MCC/MNC of the IMSI.\nIf the EHPLMN list is present and is not empty, the matching procedure shall be done for all entries in the EHPLMN list until a match is found or all matches fail.\n\nFigure A.1 illustrates the logic flow for HPLMN matching criteria for mobile devices that support GSM and DCS1800 networks. The figure outlines the process of how mobile devices are matched with the appropriate Home PLMN (Public Land Mobile Network) and Foreign PLMN based on various factors such as network type, signal strength, and roaming agreements. The flowchart begins with the mobile device initiating a call or data session, which then triggers a series of checks and comparisons between the device's capabilities and the available networks. The process ensures seamless connectivity and efficient resource allocation, enabling mobile users to maintain consistent service quality regardless of their location.\nFigure A.1: HPLMN Matching Criteria Logic Flow for mobiles which support GSM and DCS1800 (informative)\nHPLMN Matching Criteria for mobiles which support PCS1900 for NA:\nFigure A.2 illustrates the logic flow described below. The text below is normative. Figure A.2 is informative.\n(1)\tThe MS shall compare using all 3 digits the SIM-MCC with the BCCH-MCC. If the values do not match, then the HPLMN match fails.\n(2)\tThe MS shall read the 3rd digit of the BCCH-MNC. If the 3rd digit is Hex F, then proceed to step (4).\n(3)\tThe MS shall compare using all 3 digits the SIM-MNC with the BCCH-MNC. If the values match, then the HPLMN match succeeds, otherwise the HPLMN match fails.\nNOTE:\tThese rules (1) – (3) are the same as for mobiles which don't support PCS1900 for NA, except step (4) is different.\n(4)\tThe MS shall determine if the BCCH-MCC lies in the range 310-316 (i.e., whether this network is a PCS1900 for NA network). If the BCCH-MCC lies outside the range 310-316, then proceed to step (6).\n(5)\tThe MS shall compare the 3rd digit of the SIM-MNC with '0'. If the 3rd digit is not '0' then the HPLMN match fails.\nNOTE:\tThis is the '0' suffix rule.\n(6)\tThe MS shall compare using just the 1st 2 digits of the SIM-MNC with the BCCH-MNC. If the values match, then the HPLMN match succeeds, otherwise the HPLMN match fails.\nNOTE:\tWhen PCS1900 for NA switches over to broadcasting 3 digit MNCs in all networks, then the additional requirements for PCS1900 for NA can be deleted.\nIf the EHPLMN list is present and is empty or if the EHPLMN list is not present, the matching procedure shall be done for the MCC/MNC of the IMSI.\nIf the EHPLMN list is present and is not empty, the matching procedure shall be done for all entries in the EHPLMN list until a match is found or all matches fail.\nGuidance for Networks in PCS1900 for NA\nThere may be some problems in the transition period from broadcasting 2 MNC digits to broadcasting 3 MNC digits. Here are some guidelines to avoid these problems.\n(1)\tExisting network codes. Operators who currently use a 2 digit BCCH-MNC xy should use the new code xy0.\n(2)\tNew operators allocated 3 digit MNC codes with the same 1st 2 digits as an existing operator shall not use a 3rd digit of 0.\nFigure A.2 illustrates the logic flow for HPLMN matching criteria for mobile devices supporting PCS1900 in North America. The figure depicts the process of how mobile devices are matched with the appropriate Home PLMN (Public Land Mobile Network) and Foreign PLMN based on the PCS1900 standard. The flow begins with the mobile device initiating a call or data session, which then triggers a series of events and decisions made by the network infrastructure. The figure highlights the importance of accurate PLMN matching for seamless connectivity and efficient resource allocation.\nFigure A.2: HPLMN Matching Criteria Logic Flow for mobiles which support PCS1900 for NA (informative)\nWhile an MS is roaming on a VPLMN, the VPLMN and a PLMN are of the same country only if their MCC values identify the same country. See clause 1.2 for the definition of country.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "C.0\tRequirements for 5G steering of roaming over the control plane",
            "description": "In addition to the requirements specified in 3GPP TS 22.011 [9] clause 3.2.2.8, 3GPP TS 22.261 [74] clause 6.30 and 3GPP TS 23.501 [62] clause 5.30.2.2, the requirements in this clause apply.\nThe UE supporting N1 mode shall support the control plane solution for steering of roaming in 5GS. If the HPLMN or subscribed SNPN supports and wants to use the control plane solution for steering of roaming in 5GS, then the HPLMN or subscribed SNPN shall provide the steering of roaming information to the UE using the control plane mechanism defined in this annex.\nThe VPLMN shall transparently relay the steering of roaming information received from the HPLMN to the UE. The UE shall be able to detect whether the VPLMN removed the steering of roaming information during the initial registration procedure in the VPLMN. The UE shall be able to detect whether the VPLMN altered the steering of roaming information. If the UE detects that the VPLMN altered or removed the steering of roaming information then the UE shall consider the current VPLMN as the lowest priority PLMN and perform PLMN selection as defined in this annex.\nThe non-subscribed SNPN shall transparently relay the steering of roaming information received from the HPLMN or subscribed SNPN to the UE. The UE shall be able to detect whether the non-subscribed SNPN removed the steering of roaming information during the initial registration procedure in the non-subscribed SNPN. The UE shall be able to detect whether the non-subcribed SNPN altered the steering of roaming information. If the UE detects that the non-subscribed SNPN altered or removed the steering of roaming information then the UE shall consider the current SNPN as the lowest priority SNPN and perform SNPN selection as defined in this annex.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "C.1\tGeneral",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "C.1.1\tSteering of roaming over the control plane in a PLMN",
                    "description": "",
                    "summary": "",
                    "text_content": "The purpose of the control plane solution for steering of roaming in 5GS procedure in a PLMN is to allow the HPLMN to update one or more of the following via NAS signalling:\na)\tthe \"Operator Controlled PLMN Selector with Access Technology\" list in the UE by providing the HPLMN protected list of preferred PLMN/access technology combinations or a secured packet;\nb)\tthe SOR-CMCI;\nc)\tthe SOR-SNPN-SI associated with the selected PLMN subscription in the ME;\nd)\tthe SOR-SNPN-SI-LS associated with the selected PLMN subscription in the ME; and\ne) \tthe SOR-SENSE (i.e the \"Operator controlled signal threshold per access technology\") provided in a secured packet.\nIf the selected PLMN is a VPLMN, the HPLMN can provide the steering of roaming information to the UE using the control plane mechanism during and after registration. If the selected PLMN is the HPLMN, the HPLMN can provide the steering of roaming information to the UE using the control plane mechanism after registration only. The HPLMN updates the \"Operator Controlled PLMN Selector with Access Technology\" based on the operator policies, which can be based on the registered VPLMN, the location of the UE, etc.\nThe HPLMN may update the \"Operator controlled signal threshold per access technology\" based on the operator policies and the operator specific data analytic information.\nThe HPLMN can configure their subscribed UE's USIM to indicate that the UE is expected to receive the steering of roaming information due to initial registration in 5GS in a VPLMN. At the same time the HPLMN will mark the UE is expected to receive the steering of roaming information due to initial registration in 5GS in a VPLMN, in the subscription information in the UDM. In this case, it is mandatory for the HPLMN to provide the steering of roaming information to the UE during initial registration in a VPLMN. Otherwise, if such configuration is not provided in the USIM, it is optional for the HPLMN to provide the steering of roaming information to the UE during initial registration (based on operator policy). The HPLMN can provide the steering of roaming information to the UE during the registration procedure for mobility and periodic registration update (see 3GPP TS 24.501 [64]) and initial registration procedure for emergency services. In addition, the HPLMN can request the UE to provide an acknowledgement of successful reception of the steering of roaming information.\nNOTE 1:\tIn annex C of this specification, the User Data Repository (UDR) is considered as part of the UDM.\nAs the HPLMN needs to consider certain criteria including the number of customers distributed through multiple VPLMNs in the same country or region, the list of the preferred PLMN/access technology combinations is not necessarily the same at all times and for all users. The list of the preferred PLMN/access technology combinations needs to be dynamically generated, e.g. generated on demand, by a dedicated steering of roaming application function (SOR-AF) providing operator specific data analytics solutions.\nNOTE 2:\tThe functional description of this dedicated application function (SOR-AF) is out of scope of 3GPP.\nThe steering of roaming connected mode control information (SOR-CMCI) enables the HPLMN to control the timing of a UE in 5GS connected mode to move to idle mode to perform the steering of roaming. If the UE selects a cell of any access technology other than NG-RAN, the SOR procedure is terminated (see clause C.4.2). The UE shall support the SOR-CMCI. The support and use of SOR-CMCI by the HPLMN is based on the HPLMN's operator policy.\nThe following requirements are applicable for the SOR-CMCI:\n-\tThe HPLMN may configure SOR-CMCI in the UE and may also send SOR-CMCI over N1 NAS signalling. The SOR-CMCI received over N1 NAS signalling has precedence over the SOR-CMCI configured in the UE.\nNOTE 3:\tBased on HPLMN policy, while setting the SOR-CMCI the HPLMN can take into consideration the user preference for the service(s) not to be interrupted due to SOR (e.g. MMTEL voice call, MMTEL video call, HPLMN defined services, among others). The user can communicate its preference for the service(s) not to be interrupted due to SOR to the HPLMN utilizing non-standard operator-specific mechanisms, e.g. web-based.\n-\tThe UE shall indicate ME's support for SOR-CMCI to the HPLMN.\nNOTE 4:\tThe HPLMN has the knowledge of the USIM's capabilities in supporting SOR-CMCI.\n-\tWhile performing SOR, the UE shall consider the list of preferred PLMN/access technology combinations or secured packet received in the SOR information together with the available SOR-CMCI.\n-\tThe HPLMN may provision the SOR-CMCI in the UE over N1 NAS signalling. The UE shall store the configured SOR-CMCI in the non-volatile memory of the ME or in the USIM as described in clause C.4.\nThe following requirement is applicable for the SOR-SNPN-SI:\n-\tIf the UE supports access to an SNPN using credentials from a credentials holder, the UE shall indicate ME's support for SOR-SNPN-SI to the HPLMN.\nThe following requirement is applicable for the SOR-SNPN-SI-LS:\n-\tIf the UE supports access to an SNPN providing access for localized services in SNPN, the UE shall indicate ME's support for SOR-SNPN-SI-LS to the HPLMN.\nIn order to support various deployment scenarios, the UDM may support at least one of the following functionalities:\na)\tobtaining a list of preferred PLMN/access technology combinations, SOR-CMCI, if any (if supported by the UDM and required by the HPLMN), or a secured packet which is available or becomes available in the UDM (i.e. retrieved from the UDR); or\nNOTE 5:\tA secured packet can be made available at the UDR via implementation specific means. In this case the implementation specific means are required to ensure that the secured packet satisfies the \"Replay detection and Sequence Integrity counter\" (see ETSI TS 102 225 [73]) every time it is sent out from the HPLMN to the UE.\nb)\tobtaining a list of preferred PLMN/access technology combinations, SOR-CMCI, if any (if supported by the UDM and required by the HPLMN), or a secured packet from the SOR-AF.\nThe HPLMN policy for the SOR-AF invocation can be present in the UDM only if the UDM supports obtaining a list of preferred PLMN/access technology combinations, SOR-CMCI, if any, or a secured packet from the SOR-AF.\nThe UDM discards any list of preferred PLMN/access technology combinations, SOR-CMCI, if any, or any secured packet obtained from the SOR-AF or which is or becomes available in the UDM (i.e. retrieved from the UDR), either during registration (as specified in annex C.2) or after registration (as specified in annex C.3 and C.4.3), when the UDM cannot successfully forward the SOR information to the AMF (e.g. in case the UDM receives the response from the SOR-AF with the list of preferred PLMN/access technology combinations, the SOR-CMCI, if any, if any, the secured packet after the expiration of the operator specific timer, or if there is no AMF registered for the UE).\nThe UE maintains a list of \"PLMNs where registration was aborted due to SOR\". If the UE receives steering of roaming information in the REGISTRATION ACCEPT or DL NAS TRANSPORT message and the security check to verify that the steering of roaming information is provided by HPLMN is successful, the UE shall remove the current selected PLMN from the list of \"PLMNs where registration was aborted due to SOR\". The UE shall delete the list of \"PLMNs where registration was aborted due to SOR\" when the MS is switched off or the USIM is removed. The UE may also remove PLMN(s) from the list of \"PLMNs where registration was aborted due to SOR\" after a UE implementation dependent time.\nIf:\na)\tthe UE's USIM is configured to indicate that the UE shall expect to receive the steering of roaming information during initial registration procedure but did not receive it or security check on the steering of roaming information fails;\nb)\tthe current chosen VPLMN is not contained in the list of \"PLMNs where registration was aborted due to SOR\";\nc)\tthe current chosen VPLMN is not part of \"User Controlled PLMN Selector with Access Technology\" list; and\nd)\tthe UE is not in manual mode of operation;\nthen the UE will perform PLMN selection with the current VPLMN considered as lowest priority.\nIt is mandatory for the VPLMN to transparently forward to the UE the steering of roaming information received from HPLMN and to transparently forward to the HPLMN the acknowledgement of successful reception of the steering of roaming information received from UE, both while the UE is trying to register onto the VPLMN as described in clause C.2, and after the UE has registered onto the VPLMN as described in clause C.3 and C.4.3.\nIf the last received steering of roaming information contains the list of preferred PLMN/access technology combinations then the ME shall not delete the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the non-volatile memory of the ME when the UE is switched off.\nThe \"Operator Controlled PLMN Selector with Access Technology\" list shall be stored in the non-volatile memory of the ME together with the SUPI from the USIM. The ME shall delete the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the ME when a new USIM is inserted.\nThe procedure in this annex for steering of UE in VPLMN can be initiated by the network while the UE is trying to register onto the VPLMN as described in clause C.2, or after the UE has registered onto the HPLMN or the VPLMN as described in clause C.3, C.7 and C.4.3.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.1.2\tSteering of roaming over the control plane in an SNPN",
                    "description": "",
                    "summary": "",
                    "text_content": "The purpose of the control plane solution for steering of roaming in 5GS procedure in an SNPN is to allow the HPLMN or subscribed SNPN to update one or more of the following via NAS signalling:\na)\tthe SOR-SNPN-SI associated with the selected entry of \"list of subscriber data\" or the selected PLMN subscription in the ME, for a UE which supports access to an SNPN using credentials from a credential holder;\nb)\tthe SOR-CMCI; and\nc)\tthe SOR-SNPN-SI-LS associated with the selected entry of \"list of subscriber data\" or the selected PLMN subscription in the ME, if the UE supports access to an SNPN providing access for localized services in SNPN.\nThe control plane solution for steering of roaming in 5GS procedure in an SNPN can also be used by the HPLMN to update the \"Operator Controlled PLMN Selector with Access Technology\" list in the UE by providing the HPLMN protected list of preferred PLMN/access technology combinations or a secured packet via NAS signalling.\nThe HPLMN or subscribed SNPN can provide the steering of roaming information to the UE using the control plane mechanism during and after registration. The HPLMN or subscribed SNPN updates the SOR-SNPN-SI based on the HPLMN or subscribed SNPN policies, which can be based on the registered SNPN, the location of the UE, etc. The control plane solution for steering of roaming in 5GS procedure in an SNPN is not applicable for credentials holder with AAA server.\nIf the UE supports access to an SNPN using credentials from a credentials holder:\na)\tthe UE shall indicate ME's support for SOR-SNPN-SI when registering in a subscribed SNPN or in the HPLMN; and\nb)\tthe UE may indicate ME's support for SOR-SNPN-SI when sending an SOR transparent container including a UE acknowledgement in a PLMN.\nWhen the UE indicates ME's support for SOR-SNPN-SI in the 5GMM capability in initial registration or emergency registration or when ME's support for SOR-SNPN-SI changes in mobility registration update, the AMF shall inform the UDM.\nThe HPLMN or subscribed SNPN can configure their subscribed UEs' SNPN configuration parameters associated with the PLMN subscription or the selected entry of the \"list of subscriber data\", respectively, to expect to receive the steering of roaming information due to initial registration in a non-subscribed SNPN. At the same time the HPLMN or subscribed SNPN will mark the UE as expecting to receive the steering of roaming information due to initial registration in a non-subscribed SNPN, in the subscription information in the UDM. In this case, it is mandatory for the HPLMN or subscribed SNPN to provide the steering of roaming information to the UE during initial registration in a non-subscribed SNPN. Otherwise if such configuration is not provided in the ME, it is optional for the HPLMN or subscribed SNPN to provide the steering of roaming information to the UE during initial registration (based on HPLMN or subscribed SNPN policy). The HPLMN or subscribed SNPN can provide the steering of roaming information to the UE during the registration procedure for mobility and periodic registration update (see 3GPP TS 24.501 [64]) and initial registration procedure for emergency services. In addition, the HPLMN or subscribed SNPN can request the UE to provide an acknowledgement of successful reception of the steering of roaming information.\nNOTE 1:\tIn annex C of this specification, the User Data Repository (UDR) is considered as part of the UDM.\nAs the HPLMN or subscribed SNPN needs to consider certain criteria including the number of customers distributed through multiple SNPNs in the same country or region, the SOR-SNPN-SI is not necessarily the same at all times and for all users.\nNOTE 2:\tThe functional description of this dedicated application function (SOR-AF) is out of scope of 3GPP.\nThe steering of roaming connected mode control information (SOR-CMCI) enables the HPLMN or subscribed SNPN to control the timing of a UE in connected mode to move to idle mode, if the UE decides to perform SNPN selection upon receiving the steering of roaming information. The UE shall support the SOR-CMCI. The support and use of SOR-CMCI by the HPLMN or subscribed SNPN is based on the HPLMN or subscribed SNPN policy.\nThe following requirements are applicable for the SOR-CMCI:\n-\tThe HPLMN or subscribed SNPN may configure SOR-CMCI in the UE and may also send SOR-CMCI over N1 NAS signalling. The SOR-CMCI received over N1 NAS signalling has precedence over the SOR-CMCI configured in the UE.\n-\tThe UE shall indicate ME's support for SOR-CMCI to the HPLMN or subscribed SNPN.\nNOTE 3:\tIf the credentials holder is the HPLMN, the HPLMN has the knowledge of the USIM's capabilities in supporting SOR-CMCI.\n-\tWhile performing SOR, the UE shall consider the SOR-SNPN-SI and SOR-SNPN-SI-LS (if any) received in the SOR information together with the available SOR-CMCI.\n-\tThe HPLMN or subscribed SNPN may provision the SOR-CMCI in the UE over N1 NAS signalling. The UE shall store the configured SOR-CMCI in the non-volatile memory of the ME or in the USIM as described in clause C.4.\nThe following requirement is applicable for the SOR-SNPN-SI-LS:\n-\tIf the UE supports access to an SNPN providing access for localized services in SNPN, the UE shall indicate ME's support for SOR-SNPN-SI-LS to the subscribed SNPN or the HPLMN.\nIn order to support various deployment scenarios, the UDM may support:\n-\tobtaining the SOR-SNPN-SI and SOR-SNPN-SI-LS, if any (if supported by the UDM and required by the HPLMN), which are or becomes available in the UDM (i.e. retrieved from the UDR);\n-\tobtaining the SOR-SNPN-SI and SOR-SNPN-SI-LS, if any (if supported by the UDM and required by the HPLMN), from the SOR-AF; or\n-\tboth of the above.\nThe HPLMN or subscribed SNPN policy for the SOR-AF invocation can be present in the UDM only if the UDM supports obtaining the SOR-SNPN-SI and SOR-SNPN-SI-LS, if any, from the SOR-AF.\nThe UDM discards any SOR-SNPN-SI and SOR-SNPN-SI-LS, if any, obtained from the SOR-AF or which are or becomes available in the UDM (i.e. retrieved from the UDR), either during registration (as specified in annex C.5) or after registration (as specified in annex C.6), when the UDM cannot successfully forward the SOR information to the AMF (e.g. in case the UDM receives the response from the SOR-AF with the SOR-SNPN-SI and SOR-SNPN-SI-LS, if any, after the expiration of the HPLMN or subscribed SNPN specific timer, or if there is no AMF registered for the UE).\nThe UE maintains a list of \"SNPNs where registration was aborted due to SOR\" per entry of the \"list of subscriber data\" or the PLMN subscription. If the UE receives steering of roaming information in the REGISTRATION ACCEPT or DL NAS TRANSPORT message in an SNPN and the security check to verify that the steering of roaming information is provided by the HPLMN or subscribed SNPN is successful, the UE shall remove the current selected SNPN from the list of \"SNPNs where registration was aborted due to SOR\" for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription. The UE shall delete the list of \"SNPNs where registration was aborted due to SOR\" when the selected entry of the \"list of subscriber data\" is updated or the UICC containing the USIM is removed.\nIf:\n-\tthe UE's ME is configured to indicate that the UE shall expect to receive the steering of roaming information during initial registration procedure for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription but did not receive it or security check on the steering of roaming information fails;\n-\tthe current chosen non-subscribed SNPN is not contained in the list of \"SNPNs where registration was aborted due to SOR\" for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription;\n-\tthe current chosen non-subscribed SNPN is not part of the user controlled prioritized list of preferred SNPNs for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription; and\n-\tthe UE is not in manual mode of operation;\nthen the UE will perform SNPN selection with the current SNPN considered as lowest priority.\nIt is mandatory for the non-subscribed SNPN to transparently forward to the UE the steering of roaming information received from the HPLMN or subscribed SNPN and to transparently forward to the HPLMN or subscribed SNPN the acknowledgement of successful reception of the steering of roaming information received from the UE, both while the UE is trying to register onto the non-subscribed SNPN as described in clause C.5, and after the UE has registered onto the non-subscribed SNPN as described in clause C.6.\nThe ME shall delete the SOR-SNPN-SI and SOR-SNPN-SI-LS (if available) stored in the ME when the subscriber identifier, the SNPN identity of the subscribed SNPN, or both, of the selected entry of the \"list of subscriber data\" are updated or the UICC containing the USIM is removed.\nThe procedure in this annex for steering of UE in an SNPN can be initiated by the network while the UE is trying to register onto a non-subscribed SNPN as described in clause C.5, or after the UE has registered onto the subscribed SNPN or a non-subscribed SNPN as described in clause C.6 and C.8.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "C.2\tStage-2 flow for steering of UE in VPLMN during registration",
            "description": "The stage-2 flow for the case when the UE registers with VPLMN AMF is described below in figure C.2.1. The selected PLMN is the VPLMN. The AMF is located in the selected VPLMN.\nFigure C.2.1 illustrates the step-by-step procedure for providing a list of preferred Public Land Mobile Network (PLMN)/access technology combinations and the Supplementary OR-CMCI (OR-CMCI) during the registration process. The figure showcases the interaction between the mobile device and the network operator, highlighting the importance of selecting the most suitable PLMN/access technology combination for optimal network performance. The OR-CMCI, if applicable, ensures secure communication and packet delivery, contributing to a seamless user experience.\nFigure C.2.1: Procedure for providing list of preferred PLMN/access technology combinations and the SOR-CMCI, if any, or secured packet during registration\nFor the steps below, security protection is described in 3GPP TS 33.501 [66].\n1)\tThe UE to the VPLMN AMF: The UE initiates initial registration, emergency registration or registration procedure for mobility and periodic registration update (see 3GPP TS 24.501 [64]) to the VPLMN AMF by sending REGISTRATION REQUEST message with the 5GS registration type IE indicating \"initial registration\", \"emergency registration\" or \"mobility registration updating\";\n2)\tUpon receiving REGISTRATION REQUEST message, the VPLMN AMF executes the registration procedure as defined in clause 4.2.2.2 of 3GPP TS 23.502 [63]. As part of the registration procedure:\na)\tthe AMF provides the registration type to the UDM using Nudm_UECM_Registration. As a consequence, in case of the 5GS registration type message indicates \"initial registration\" or \"emergency registration\" the UDM shall delete the stored \"ME support of SOR-CMCI\" indicator, if any, the stored \"ME support of SOR-SNPN-SI\" indicator, if any, and the stored \"ME support of SOR-SNPN-SI-LS\" indicator, if any, in UDR using Nudr_DM_Update service operation (see 3GPP TS 23.502 [63]).\nNOTE 1:\tNudr_DM_Update service operation corresponds to Nudr_DR_Update service operation (see 3GPP TS 29.504 [82] and 3GPP TS 29.505 [83]).\nIn addition:\na)\tif the VPLMN AMF does not have subscription data for the UE, the VPLMN AMF invokes Nudm_SDM_Get service operation to the HPLMN UDM to get amongst other information the Access and Mobility Subscription data for the UE (see step 14b in clause 4.2.2.2.2 of 3GPP TS 23.502 [63]); or\nb)\tif the VPLMN AMF already has subscription data for the UE and:\ni)\tthe 5GS registration type IE in the received REGISTRATION REQUEST message indicates \"initial registration\" and the \"SoR Update Indicator for Initial Registration\" field in the UE context is set to 'the UDM requests the AMF to retrieve SoR information when the UE performs NAS registration type \"initial registration\"' as specified in table 5.2.2.2.2-1 of 3GPP TS 23.502 [63]); or\nii)\tthe 5GS registration type IE in the received REGISTRATION REQUEST message indicates \"emergency registration\" and the \"SoR Update Indicator for Emergency Registration\" field in the UE context is set to 'the UDM requests the AMF to retrieve SoR information when the UE performs NAS registration type \"emergency registration\"' as specified in table 5.2.2.2.2-1 of 3GPP TS 23.502 [63]);\nthen the VPLMN AMF invokes Nudm_SDM_Get service operation message to the HPLMN UDM to retrieve the steering of roaming information (see step 14b in clause 4.2.2.2.2 of 3GPP TS 23.502 [63]);\notherwise the VPLMN AMF sends a REGISTRATION ACCEPT message without the steering of roaming information to the UE and steps 3a, 3b, 3c, 3d, 4, 5, 6 are skipped;\n3a)\tIf the user subscription information indicates to send the steering of roaming information due to initial registration in a VPLMN, then the HPLMN UDM shall provide the steering of roaming information to the UE when the UE performs initial registration in a VPLMN, otherwise the HPLMN UDM may provide the steering of roaming information to the UE, based on operator policy.\nNOTE 2:\tBased on operator deployment and policy, if the UDM receives the list of preferred PLMN/access technology combinations from the UDR, and the UDM supports communication with the SP-AF, the UDM can send this list to the SP-AF requesting it to provide this information in a secured packet as defined in 3GPP TS 29.544 [71].\nIf the HPLMN UDM is to provide the steering of roaming information to the UE when the UE performs the registration in a VPLMN, and the HPLMN policy for the SOR-AF invocation is absent then steps 3b and 3c are not performed and the HPLMN UDM obtains the available list of preferred PLMN/access technology combinations or the available secured packet (i.e. all retrieved from the UDR). In addition, if the HPLMN UDM obtains the list of preferred PLMN/access technology combinations and the \"ME support of SOR-CMCI\" indicator is stored for the UE, then the HPLMN UDM shall obtain the SOR-CMCI, if available, otherwise the HPLMN UDM shall not obtain the SOR-CMCI. If the SOR-CMCI is provided then the HPLMN UDM may indicate to the UE to store the SOR-CMCI in the ME by providing the \"Store SOR-CMCI in ME\" indicator set to \"Store SOR-CMCI in ME\".\nNOTE 3:\tThe secured packet obtained by the UDM can include SOR-CMCI only if the \"ME support of SOR-CMCI\" indicator is stored for the UE and the USIM of the indicated SUPI supports SOR-CMCI. Otherwise if only the \"ME support of SOR-CMCI\" indicator is stored for the UE, then SOR-CMCI, if any, cannot be included in the secured packet.\nNOTE 4:\tThe secured packet obtained by the UDM can include SOR-SENSE only if the USIM of the indicated SUPI supports SOR-SENSE.\nIf the HPLMN UDM is to provide the steering of roaming information to the UE when the UE performs the registration in a VPLMN, and the HPLMN policy for the SOR-AF invocation is present, then the HPLMN UDM obtains the list of preferred PLMN/access technology combinations, SOR-CMCI, if any, or the secured packet from the SOR-AF using steps 3b and 3c;\n3b)\tThe HPLMN UDM to the SOR-AF: Nsoraf_SoR_Get request (VPLMN ID, SUPI of the UE, access type (see 3GPP TS 29.550 [88])). The VPLMN ID and the access type parameters, indicating where the UE is registering, are stored in the HPLMN UDM;\nNOTE 5:\tInformation about UE supporting SOR-SENSE can be available directly in SOR-AF (or in OAM which configures the secure packet in UDM/UDR).\n3c)\tThe SOR-AF to the HPLMN UDM: Nsoraf_SoR_Get response (the list of preferred PLMN/access technology combinations, the SOR-CMCI, if any, and the \"Store SOR-CMCI in ME\" indicator, if any, or the secured packet, or neither of them);\nBased on the information received in step 3b and any operator specific criteria, the SOR-AF may either:\n-\tinclude the list of preferred PLMN/access technology combinations, the SOR-CMCI, if any, and optionally the \"Store SOR-CMCI in ME\" indicator, if any;\n-\tprovide the secured packet in the Nsoraf_SoR_Get response; or\n-\tprovide the Nsoraf_SoR_Get response with neither of the information above.\nIf the SOR-AF includes the list of preferred PLMN/access technology combinations and the ME supports the SOR-CMCI, the SOR-AF may provide the SOR-CMCI and optionally the \"Store SOR-CMCI in ME\" indicator, otherwise the SOR-AF shall provide neither the SOR-CMCI nor \"Store the SOR-CMCI in ME\" indicator.\nNOTE 6:\tIn this version of the specification, when the access type where the UE is registering indicates 3GPP access, then the UE is registering over the NG-RAN access technology.\nNOTE 7:\tBased on operator deployment and policy, if the UDM receives the list of preferred PLMN/access technology combinations, and the SOR-CMCI, if any, in the Nsoraf_SoR_Get response from the SOR-AF, and the UDM supports communication with SP-AF, it can send this list, and the SOR-CMCI, if any, to SP-AF requesting it to provide this information in a secured packet as defined in 3GPP TS 29.544 [71].\nNOTE 8:\tThe SOR-AF can include a different list of preferred PLMN/access technology combinations, different SOR-CMCI, if any, and different \"Store SOR-CMCI in ME\" indicator, if any, or a different secured packet for each Nsoraf_SoR_Get request even if the same VPLMN ID, the SUPI of the UE, and the access type are provided to the SOR-AF.\nNOTE 9:\tThe SOR-AF can subscribe to the HPLMN UDM to be notified about the changes of the roaming status of the UE identified by SUPI.\nNOTE 10:\tThe SOR-AF can determine that the ME supports the SOR-CMCI if the Nsoraf_SoR_Info service operation has returned the \"ME support of SOR-CMCI\" indicator.\nNOTE 11:\tSecured packet provided by the SOR-AF can include SOR-CMCI only if the SOR-AF has determined that the ME supports the SOR-CMCI and the USIM of the indicated SUPI supports SOR-CMCI. Otherwise if only the \"ME support of SOR-CMCI\" indicator is stored for the UE, then SOR-CMCI, if any, cannot be included in the secured packet.\nNOTE 12:\tSecured packets do not include the \"Store SOR-CMCI in ME\" indicator.\n3d)\tThe HPLMN UDM forms the steering of roaming information as specified in 3GPP TS 33.501 [66] from:\n-\tthe list of preferred PLMN/access technology combinations, the SOR-CMCI, if any, and the \"Store SOR-CMCI in ME\" indicator, if any, or the secured packet obtained in step 3a; or\nthe list of preferred PLMN/access technology combinations and the SOR-CMCI, if any, and \"Store the SOR-CMCI in ME\" indicator, if any, or the secured packet, obtained in step 3c.\nIf:\n-\tneither the list of preferred PLMN/access technology combinations nor the secured packet was obtained in steps 3a or 3c; or\n-\tthe SOR-AF has not sent to the HPLMN UDM an Nsoraf_SoR_Get response (step 3c) within an operator defined time after the HPLMN UDM sending to the SOR-AF an Nsoraf_SoR_Get request (step 3b);\nNOTE 13:\tStage 3 to define the timer needed for the SOR-AF to respond to the HPLMN UDM. The max time needs to be defined considering that this procedure is part of the registration procedure.\nand the UE is performing initial registration in a VPLMN and the user subscription information indicates to send the steering of roaming information due to initial registration in a VPLMN, then the HPLMN UDM forms the steering of roaming information as specified in 3GPP TS 33.501 [66] from the HPLMN indication that 'no change of the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the UE is needed and thus no list of preferred PLMN/access technology combinations is provided';\nIf the \"Store SOR-CMCI in ME\" indicator was not obtained in step 3a or 3c and the \"ME support of SOR-CMCI\" indicator is stored for the UE in the HPLMN UDM, the HPLMN UDM forms the steering of roaming information with the \"Store SOR-CMCI in ME\" indicator set to \"Do not store SOR-CMCI in ME\";\n4)\tThe HPLMN UDM to the VPLMN AMF: The HPLMN UDM sends a response to the Nudm_SDM_Get service operation to the VPLMN AMF, which includes the steering of roaming information within the Access and Mobility Subscription data. The Access and Mobility Subscription data type is defined in clause 5.2.3.3.1 of 3GPP TS 23.502 [63]).\nNOTE 14:\tThe UDM cannot provide the SOR-CMCI, if any, to the VPLMN AMF which does not support receiving SoR transparent container (see 3GPP TS 29.503 [78]).\nIf the UE is performing initial registration or emergency registration and the HPLMN UDM supports SOR-CMCI, the HPLMN shall request the UE to acknowledge the successful security check of the received steering of roaming information, by providing the indication as part of the steering of roaming information in the Nudm_SDM_Get response service operation. Otherwise, the HPLMN may request the UE to acknowledge the successful security check of the received steering of roaming information, by providing the indication as part of the steering of roaming information in the Nudm_SDM_Get response service operation;\nNOTE 15:\tIf the UE is performing registration procedure for mobility and periodic registration update (see 3GPP TS 24.501 [64]) after inter-system change from S1 mode to N1 mode and the HPLMN UDM supports SOR-CMCI, the HPLMN requests the UE to acknowledge the successful security check of the received steering of roaming information, by providing the indication as part of the steering of roaming information in the Nudm_SDM_Get response service operation, unless the HPLMN UDM has already received and stored the \"ME support of SOR-CMCI\" indicator for the UE during its former registration on the current VPLMN.\n5)\tThe VPLMN AMF to the HPLMN UDM: As part of the registration procedure, the VPLMN AMF also invokes Nudm_SDM_Subscribe service operation to the HPLMN UDM to subscribe to notification of changes of the subscription data (e.g. received in step 4) including notification of updates of the steering of roaming information included in the Access and Mobility Subscription data (see step 14c in clause 4.2.2.2.2 of 3GPP TS 23.502 [63]);\n6)\tThe VPLMN AMF to the UE: The VPLMN AMF shall transparently send the received steering of roaming information to the UE in the REGISTRATION ACCEPT message;\n7)\tIf the steering of roaming information is received and the security check is successful, then:\na)\tif the UDM has not requested an acknowledgement from the UE, then the UE shall send the REGISTRATION COMPLETE message to the serving AMF without including an SOR transparent container;\nb)\tif the steering of roaming information contains a secured packet (see 3GPP TS 31.115 [67]):\n-\tthe ME shall upload the secured packet to the USIM using procedures in 3GPP TS 31.111 [41], if the service \"data download via SMS Point-to-point\" is allocated and activated in the USIM Service Table (see 3GPP TS 31.102 [40]);\nNOTE 16:\tHow the ME handles UICC responses and failures in communication between the ME and UICC is implementation specific and out of scope of this release of the specification.\nNOTE 17:If the SOR-SENSE has been updated in the USIM, the UE uses the \"Operator controlled signal threshold per access technology\" information stored on the USIM in accordance to clause 3.11 of this specification.\n-\tif the UDM has not requested an acknowledgement from the UE and:\nA)\tthe ME receives a USAT REFRESH with command qualifier (3GPP TS 31.111 [41]) of type \"Steering of Roaming\" and either a SOR-CMCI is included, or the UE is configured with the SOR-CMCI, the UE shall perform items a), b) and c) of the procedure for steering of roaming in clause 4.4.6, and if the UE is in automatic network selection mode, then it shall apply the actions in clause C.4.2. In this case steps 8 to 11 are skipped; or\nB)\tthe ME receives a USAT REFRESH command qualifier (3GPP TS 31.111 [41]) of type \"Steering of Roaming\" and neither a SOR-CMCI is included, nor the UE is configured with the SOR-CMCI, it shall perform items a), b) and c) of the procedure for steering of roaming in clause 4.4.6 and if:\ni)\tthe UE has a list of available and allowable PLMNs in the area and based on this list or any other implementation specific means the UE determines that there is a higher priority PLMN than the selected VPLMN; or\nii)\tthe UE does not have a list of available and allowable PLMNs in the area and is unable to determine whether there is a higher priority PLMN than the selected VPLMN using any other implementation specific means;\nand the UE is in automatic network selection mode, then the UE shall either:\ni)\trelease the current N1 NAS signalling connection locally and then attempt to obtain service on a higher priority PLMN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired. In this case, steps 8 to 11 are skipped. The UE shall suspend the transmission of 5GSM messages until the N1 NAS signalling is released. The UE shall not initiate the establishment of a new N1 NAS signalling connection, unless for the purpose of initiating a registration procedure for emergency services, establishing an emergency PDU session or performing emergency service fallback until the attempts to obtain service on a higher priority PLMN are completed. If the UE has an established emergency PDU session or is performing emergency services fallback (see 3GPP TS 24.501 [64]), the receipt of the steering of roaming information shall not trigger the release of the N1 NAS signalling connection. If camped on a NG-RAN cell, the UE shall release the current N1 NAS signalling connection locally subsequently after the emergency PDU session is released, otherwise the UE shall not take any further actions; or\nii)\tnot release the current N1 NAS signalling connection locally (e.g. if the UE has established PDU session(s)) and skip steps 8 to 10;\nc)\tif the steering of roaming information contains the list of preferred PLMN/access technology combinations, the ME shall replace the highest priority entries in the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the ME with the received list of preferred PLMN/access technology combinations, and delete the PLMNs identified by the list of preferred PLMN/access technology combinations from the Forbidden PLMN list and from the Forbidden PLMNs for GPRS service list, if they are present in these lists. Additionally, if:\ni)\tthe UE has a list of available and allowable PLMNs in the area and based on this list or any other implementation specific means the UE determines that there is a higher priority PLMN than the selected VPLMN; or\nii)\tthe UE does not have a list of available and allowable PLMNs in the area and is unable to determine whether there is a higher priority PLMN than the selected VPLMN using any other implementation specific means;\nand the UE is in automatic network selection mode:\nA)\tif the UE is configured with the SOR-CMCI or received the SOR-CMCI over N1 NAS signalling, the UE shall apply the actions in clause C.4.2. In this case steps 8 to 11 are skipped;\nB)\totherwise, the UE shall:\ni)\trelease the current N1 NAS signalling connection locally and then attempt to obtain service on a higher priority PLMN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired. In this case, steps 8 to 11 are skipped. The UE shall suspend the transmission of 5GSM messages until the N1 NAS signalling is released. The UE shall not initiate the establishment of a new N1 NAS signalling connection, unless for the purpose of initiating a registration procedure for emergency services, establishing an emergency PDU session or performing emergency services fallback, until the attempts to obtain service on a higher priority PLMN are completed. If the UE has an established emergency PDU session or is performing emergency services fallback (see 3GPP TS 24.501 [64]), the receipt of the steering of roaming information shall not trigger the release of the N1 NAS signalling connection. If camped on a NG-RAN cell, he UE shall release the current N1 NAS signalling connection locally subsequently after the emergency PDU session is released, otherwise the UE shall not take any further actions. If the UE needs to disable the N1 mode capability (see 3GPP TS 24.501 [64]) and there is no emergency service pending, the UE shall first attempt to obtain service on a higher priority PLMN as described in this step, and if no higher priority PLMN can be selected but the last registered PLMN is selected, then the UE shall disable the N1 mode capability; or\nii)\tnot release the current N1 NAS signalling connection locally (e.g. if the UE has established PDU session(s)) and skip steps 8 to 10;\nNOTE 18:\tWhen the UE is in the manual mode of operation or the current chosen VPLMN is part of the \"User Controlled PLMN Selector with Access Technology\" list, the UE stays on the VPLMN.\n8)\tIf the UE's USIM is configured with indication that the UE is to receive the steering of roaming information due to initial registration in a VPLMN, but neither the list of preferred PLMN/access technology combinations nor the secured packet nor the HPLMN indication that 'no change of the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the UE is needed and thus no list of preferred PLMN/access technology combinations is provided' is received in the REGISTRATION ACCEPT message, when the UE performs initial registration in a VPLMN or if the steering of roaming information is received but the security check is not successful, then the UE shall:\na)\tif the SOR transparent container is included in the REGISTRATION ACCEPT message, send the REGISTRATION COMPLETE message to the serving AMF without including an SOR transparent container;\nb)\tif the current chosen VPLMN is not contained in the list of \"PLMNs where registration was aborted due to SOR\", and is not part of \"User Controlled PLMN Selector with Access Technology\" list and the UE is not in manual mode of operation:\ni)\tif the steering of roaming information is received but the security check is not successful when the UE performs registration procedure for mobility and periodic registration update (see 3GPP TS 24.501 [64]) in a VPLMN and the UE has a stored SOR-CMCI, and there are ongoing PDU sessions or services, the UE shall apply the actions in clause C.4.2. In this case, current PLMN is considered as lowest priority and steps 9 to 11 are skipped;\nii)\totherwise, the UE shall release the current N1 NAS signalling connection locally and attempt to obtain service on a higher priority PLMN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired, with an exception that the current PLMN is considered as lowest priority, and skip steps 9 to 11. The UE shall suspend the transmission of 5GSM messages until the N1 NAS signalling is released. The UE shall not initiate the establishment of a new N1 NAS signalling connection, unless for the purpose of initiating a registration procedure for emergency services, establishing an emergency PDU session or performing emergency services fallback until the attempts to obtain service on a higher priority PLMN are completed. If the UE has an established emergency PDU session (see 3GPP TS 24.501 [64]), if camped on a NG-RAN cell, the UE shall release the current N1 NAS signalling connection locally after the release of the emergency PDU session, otherwise the UE shall not take any further actions. If the UE needs to disable the N1 mode capability (see 3GPP TS 24.501 [64]) and there is no emergency service pending, the UE shall first attempt to obtain service on a higher priority PLMN as described in this step, and if no higher priority PLMN can be selected but the last registered PLMN is selected, then the UE shall disable the N1 mode capability; and\nc)\tif the current chosen VPLMN is not contained in the list of \"PLMNs where registration was aborted due to SOR\", store the PLMN identity in the list of \"PLMNs where registration was aborted due to SOR\";\nNOTE 19:\tWhen the UE is in the manual mode of operation or the current chosen VPLMN is part of the \"User Controlled PLMN Selector with Access Technology\" list, the UE stays on the VPLMN.\n9)\tThe UE to the VPLMN AMF: If the UDM has requested an acknowledgement from the UE and the UE verified that the steering of roaming information has been provided by the HPLMN in step 7, then:\na)\tthe UE sends the REGISTRATION COMPLETE message to the serving AMF with an SOR transparent container including the UE acknowledgement;\nb)\tthe UE shall set the \"ME support of SOR-CMCI\" indicator in the header of the SOR transparent container to \"supported\";\nc)\tif the UE supports access to an SNPN using credentials from a credentials holder, the UE may set the \"ME support of SOR-SNPN-SI\" indicator in the header of the SOR transparent container to \"supported\";\nc1)\tif the UE supports access to an SNPN providing access for localized services in SNPN, the UE shall set the \"ME support of SOR-SNPN-SI-LS\" indicator in the header of the SOR transparent container to \"supported\"; and\nd)\tif:\n-\tthe steering of roaming information contained a secured packet, then when the UE receives the USAT REFRESH command qualifier of type \"Steering of Roaming\" and neither a SOR-CMCI is included, nor the UE is configured with the SOR-CMCI, it performs items a), b) and c) of the procedure for steering of roaming in clause 4.4.6;\n-\tthe steering of roaming information contained a secured packet, then when the UE receives a USAT REFRESH with command qualifier (3GPP TS 31.111 [41]) of type \"Steering of Roaming\" and either a SOR-CMCI is included, or the UE is configured with the SOR-CMCI, the UE shall perform items a), b) and c) of the procedure for steering of roaming in clause 4.4.6 and if the UE is in automatic network selection mode, then it shall apply the actions in clause C.4.2, and step 11 is skipped;\n-\tthe steering of roaming information contains the list of preferred PLMN/access technology combinations, the UE is configured with the SOR-CMCI or received the SOR-CMCI over N1 NAS signalling, and the UE is in automatic network selection mode, then the UE shall apply the actions in clause C.4.2, and step 11 is skipped; or\n-\tthe steering of roaming information contains an indication that 'no change of the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the UE is needed and thus no list of preferred PLMN/access technology combinations is provided', then step 11 is skipped;\n10)\tThe VPLMN AMF to the HPLMN UDM: If an SOR transparent container is received in the REGISTRATION COMPLETE message, the AMF uses the Nudm_SDM_Info service operation to provide the received SOR transparent container to the UDM. If the HPLMN decided that the UE is to acknowledge the successful security check of the received steering of roaming information in step 4, the UDM verifies that the acknowledgement is provided by the UE as specified in 3GPP TS 33.501 [66]. If:\n-\tthe \"ME support of SOR-CMCI\" indicator in the header of the SOR transparent container is set to \"supported\", then the HPLMN UDM shall store the \"ME support of SOR-CMCI\" indicator, otherwise the HPLMN UDM shall delete the stored \"ME support of SOR-CMCI\" indicator, if any;\n-\tthe \"ME support of SOR-SNPN-SI\" indicator in the header of the SOR transparent container is set to \"supported\", then the HPLMN UDM shall store the \"ME support of SOR-SNPN-SI\" indicator, otherwise the HPLMN UDM shall delete the stored \"ME support of SOR-SNPN-SI\" indicator, if any; and\n-\tthe \"ME support of SOR-SNPN-SI-LS\" indicator in the header of the SOR transparent container is set to \"supported\", then the HPLMN UDM shall store the \"ME support of SOR-SNPN-SI-LS\" indicator, otherwise the HPLMN UDM shall delete the stored \"ME support of SOR-SNPN-SI-LS\" indicator, if any.\nNOTE 20:\tThe UDM cannot receive the \"ME support of SOR-CMCI\" indicator, the \"ME support of SOR-SNPN-SI\" indicator, or \"ME support of SOR-SNPN-SI-LS\" indicator from the VPLMN AMF which does not support receiving SoR transparent container (see 3GPP TS 29.503 [78]).\n10a)\tThe HPLMN UDM to the SOR-AF: Nsoraf_SoR_Info (SUPI of the UE, successful delivery, \"ME support of SOR-CMCI\" indicator, if any, \"ME support of SOR-SNPN-SI\" indicator, if any, \"ME support of SOR-SNPN-SI-LS\" indicator, if any). If the HPLMN policy for the SOR-AF invocation is present and the HPLMN UDM received and verified the UE acknowledgement in step 10, then the HPLMN UDM informs the SOR-AF about successful delivery of the list of preferred PLMN/access technology combinations, or of the secured packet to the UE. If:\n-\tthe \"ME support of SOR-CMCI\" indicator is stored for the UE, the HPLMN UDM shall include the \"ME support of SOR-CMCI\" indicator\n-\tthe \"ME support of SOR-SNPN-SI\" indicator is stored for the UE, the HPLMN UDM shall include the \"ME support of SOR-SNPN-SI\" indicator; and\n-\tthe \"ME support of SOR-SNPN-SI-LS\" indicator is stored for the UE, the HPLMN UDM shall include the \"ME support of SOR-SNPN-SI-LS\" indicator; and\nNOTE 21:\tHow the SOR-AF determines that the USIM for the indicated SUPI supports SOR-CMCI is implementation specific.\n11)\t\tIf the UE has a list of available PLMNs in the area and based on this list the UE determines that there is a higher priority PLMN than the selected VPLMN and the UE is in automatic network selection mode, then the UE shall attempt to obtain service on a higher priority PLMN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired after the release of the N1 NAS signalling connection. If within an implementation dependent time the N1 NAS signalling connection is not released, then the UE may locally release the N1 NAS signalling connection except when the UE has an established emergency PDU session or is performing emergency services fallback (see 3GPP TS 24.501 [64]). The UE shall not initiate the establishment of a new N1 NAS signalling connection, unless for the purpose of initiating a registration procedure for emergency services, establishing an emergency PDU session or performing emergency services fallback, until the attempts to obtain service on a higher priority PLMN are completed.\nWhen the UE performs initial registration for emergency services (see 3GPP TS 24.501 [64] and 3GPP TS 23.502 [63]) while the UE has a valid USIM and the AMF performs the authentication procedure, then based on HPLMN policy, the SOR procedure described in this clause may apply.\nIf:\n-\tthe UE in manual mode of operation encounters scenario mentioned in step 8 above; and\n-\tupon switching to automatic network selection mode, the UE remembers that it is still registered on the PLMN where the missing or security check failure of SOR information was encountered as described in clause 8;\nthe UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority PLMN as specified in clause 4.4.3.3, by acting as if timer T that controls periodic attempts has expired, with an exception that the current registered PLMN is considered as lowest priority. The UE shall not initiate the establishment of a new N1 NAS signalling connection, unless for the purpose of initiating a registration procedure for emergency services, emergency services fallback or establishing an emergency PDU session, until the attempts to obtain service on a higher priority PLMN are completed. If the UE has an established emergency PDU session, then the UE shall attempt to perform the PLMN selection subsequently after the emergency PDU session is released.\nNOTE 22:\tThe receipt of the steering of roaming information by itself does not trigger the release of the emergency PDU session.\nNOTE 23:\tThe list of available and allowable PLMNs in the area is implementation specific.\nNOTE 24:\tIf the UE is served by any access technology other than NG-RAN, the HPLMN can initiate a steering of roaming procedure as specified in clause 4.4.6.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "C.3\tStage-2 flow for steering of UE in HPLMN or VPLMN after registration",
            "description": "The stage-2 flow for the steering of UE in HPLMN or VPLMN after registration is indicated in figure C.3.1. The selected PLMN can be the HPLMN or a VPLMN. The AMF is located in the selected PLMN. In this procedure, the SOR-CMCI, if any, is sent together with the list of preferred PLMN/access technology combinations in plain text or is sent within the secured packet.\nThe procedure is triggered:\n-\tIf the HPLMN UDM supports obtaining a list of preferred PLMN/access technology combinations and SOR-CMCI, if any, or a secured packet from the SOR-AF, the HPLMN policy for the SOR-AF invocation is present in the HPLMN UDM, and the SOR-AF provides the HPLMN UDM with a new list of preferred PLMN/access technology combinations or a secured packet for a UE identified by SUPI. If the ME supports the SOR-CMCI, the SOR-AF may provide the SOR-CMCI and optionally provides the \"Store SOR-CMCI in ME\" indicator otherwise the SOR-AF shall provide neither the SOR-CMCI nor the \"Store SOR-CMCI in ME\" indicator.\nThe secured packet provided by the SOR-AF may include SOR-CMCI only if the SOR-AF has determined that the ME supports the SOR-CMCI and the USIM of the indicated SUPI supports SOR-CMCI. Otherwise if only the \"ME support of SOR-CMCI\" indicator is stored for the UE, then the SOR-AF shall not include the SOR-CMCI, if any, in the secured packet; or\nNOTE 1:\tThe SOR-AF can determine that the ME supports the SOR-CMCI if the Nsoraf_SoR_Info service operation has returned the \"ME support of SOR-CMCI\" indicator. How the SOR-AF determines that the USIM for the indicated SUPI supports SOR-CMCI is implementation specific.\n-\tWhen a new list of preferred PLMN/access technology combinations or a secured packet becomes available in the HPLMN UDM (i.e. retrieved from the UDR).\nIf the \"ME support of SOR-CMCI\" indicator is stored for the UE and the new list of preferred PLMN/access technology combinations becomes available in the HPLMN UDM (i.e. retrieved from the UDR), the HPLMN UDM shall obtain the SOR-CMCI and the \"Store SOR-CMCI in ME\" indicator, if available, otherwise the HPLMN UDM shall obtain neither the SOR-CMCI nor the \"Store SOR-CMCI in ME\" indicator.\nNOTE 3:\tBased on operator deployment and policy, if the UDM receives the list of preferred PLMN/access technology combinations, SOR-CMCI, if any, the \"Store SOR-CMCI in ME\" indicator, if any, and the USIM of the indicated SUPI supports SOR-CMCI from the UDR, and the UDM supports communication with the SP-AF, the UDM can send this list and SOR-CMCI to the SP-AF requesting it to provide this information in a secured packet as defined in 3GPP TS 29.544 [71].\nNOTE 4:\tBefore providing the HPLMN UDM with a new list of preferred PLMN/access technology combinations or a secured packet for a UE identified by SUPI, the SOR-AF, based on operator policies or criteria, can obtain the user location information by triggering the unified location service exposure procedure as defined in 3GPP TS 23.273 [70] clause 6.5, or additionally based on implementation specific criteria, by requesting the UE location information from other application function using implementation specific method. This user location information can then be used in the SOR-AF algorithms.\nNOTE 5:\tThe secured packet obtained by the UDM can include SOR-CMCI only if the \"ME support of SOR-CMCI\" indicator is stored for the UE and the USIM of the indicated SUPI supports SOR-CMCI. Otherwise if only the \"ME support of SOR-CMCI\" indicator is stored for the UE, then the SOR-CMCI, if any, cannot be included in the secured packet.\nFigure C.3.1 illustrates the process of providing a list of preferred Public Land Mobile Network (PLMN)/access technology combinations and the Supplementary OR-CMCI (OR-CMCI) or secured packet after registration. The figure depicts the various stages involved in this procedure, including the initial registration of the subscriber, the transmission of the preferred PLMN/access technology combinations, and the subsequent delivery of the OR-CMCI or secured packet. The figure emphasizes the importance of accurate and timely communication between the network operator and the subscriber, ensuring a seamless and efficient registration process.\nFigure C.3.1: Procedure for providing list of preferred PLMN/access technology combinations and the SOR-CMCI, if any, or secured packet after registration\nFor the steps below, security protection is described in 3GPP TS 33.501 [66].\n1)\tThe SOR-AF to the HPLMN UDM: Nudm_ParameterProvision_Update request is sent to the HPLMN UDM to trigger the update of the UE with the new list of preferred PLMN/access technology combinations, the SOR-CMCI, if any, and the \"Store SOR-CMCI in ME\" indicator, if any, or a secured packet for a UE identified by SUPI.\n2) The HPLMN UDM to the AMF: The UDM notifies the changes of the user profile to the affected AMF by the means of invoking Nudm_SDM_Notification service operation. The Nudm_SDM_Notification service operation contains the steering of roaming information that needs to be delivered transparently to the UE over NAS within the Access and Mobility Subscription data. If the HPLMN decided that the UE is to acknowledge successful security check of the received steering of roaming information, the Nudm_SDM_Notification service operation also contains an indication that the UDM requests an acknowledgement from the UE as part of the steering of roaming information. If the SOR-CMCI was obtained, the HPLMN UDM shall include the SOR-CMCI into the steering of roaming information. If the \"Store SOR-CMCI in ME\" indicator was obtained, the HPLMN UDM shall include the \"Store SOR-CMCI in ME\" indicator; otherwise, the HPLMN UDM shall include the \"Store SOR-CMCI in ME\" indicator set to \"Do not store SOR-CMCI in ME\";\nNOTE 6:\tThe UDM cannot provide the SOR-CMCI, if any, to the VPLMN AMF which does not support receiving SoR transparent container (see 3GPP TS 29.503 [78]).\n3)\tThe AMF to the UE: the AMF sends a DL NAS TRANSPORT message to the served UE. The AMF includes in the DL NAS TRANSPORT message the steering of roaming information received from the UDM.\n4)\tUpon receiving the steering of roaming information, the UE shall perform a security check on the steering of roaming information included in the DL NAS TRANSPORT message to verify that the steering of roaming information is provided by HPLMN, and:\n-\tif the security check is successful and:\na)\tif the steering of roaming information contains a secured packet (see 3GPP TS 31.115 [67]) and the service \"data download via SMS Point-to-point\" is allocated and activated in the USIM Service Table (see 3GPP TS 31.102 [40]), the ME shall upload the secured packet to the USIM using procedures in 3GPP TS 31.111 [41].\nIf the UDM has requested an acknowledgement from the UE in the DL NAS TRANSPORT message and the ME receives UICC responses indicating that the UICC has received the secured packet successfully, then the UE sends an UL NAS TRANSPORT message to the serving AMF with an SOR transparent container including the UE acknowledgement and the UE:\n-\tshall set the \"ME support of SOR-CMCI\" indicator in the header of the SOR transparent container to \"supported\";\n-\tmay set the \"ME support of SOR-SNPN-SI\" indicator in the header of the SOR transparent container to \"supported\" if the UE supports access to an SNPN using credentials from a credentials holder; and\n-\tshall set the \"ME support of SOR-SNPN-SI-LS\" indicator in the header of the SOR transparent container to \"supported\" if the UE supports access to an SNPN providing access for localized services in SNPN; and\nNOTE 7:\tHow the ME handles UICC responses that do not indicate that the UICC has received the secured packet successfully and failures in communication between the ME and UICC is implementation specific and out of scope of this release of the specification.\n-\twhen the ME receives a USAT REFRESH command qualifier (see 3GPP TS 31.111 [41]) of type \"Steering of Roaming\" and neither a SOR-CMCI is included, nor the UE is configured with the SOR-CMCI, it performs the procedure for steering of roaming in clause 4.4.6 with an exception that if the UE is in automatic network selection mode, then the UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority PLMN (specified in clause 4.4.6 bullet d); or\n-\twhen the ME receives a USAT REFRESH with command qualifier (see 3GPP TS 31.111 [41]) of type \"Steering of Roaming\" and either a SOR-CMCI is included, or the UE is configured with the SOR-CMCI, the UE shall perform items a), b) and c) of the procedure for steering of roaming in clause 4.4.6. If the UE is in automatic network selection mode it shall apply the actions in clause C.4.2;\nb)\tif the steering of roaming information contains the list of preferred PLMN/access technology combinations, the ME shall replace the highest priority entries in the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the ME with the received list of preferred PLMN/access technology combinations, and delete the PLMNs identified by the list of preferred PLMN/access technology combinations from the Forbidden PLMN list and from the Forbidden PLMNs for GPRS service list, if they are present in these lists.\nIf the UDM has requested an acknowledgement from the UE in the DL NAS TRANSPORT message, the UE sends an UL NAS TRANSPORT message to the serving AMF with an SOR transparent container including the UE acknowledgement and the UE:\n-\tshall set the \"ME support of SOR-CMCI\" indicator to \"supported\"\n-\tmay set the \"ME support of SOR-SNPN-SI\" indicator in the header of the SOR transparent container to \"supported\" if the UE supports access to an SNPN using credentials from a credentials holder; and\n-\tshall set the \"ME support of SOR-SNPN-SI-LS\" indicator in the header of the SOR transparent container to \"supported\" if the UE supports access to an SNPN providing access for localized services in SNPN.\nIf the UE is in automatic network selection mode and the selected PLMN is a VPLMN, then:\n-\tif the UE has a stored SOR-CMCI or received the SOR-CMCI over N1 NAS signalling, the UE shall apply the actions in clause C.4; or\n-\tthe UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority PLMN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired. The UE shall not initiate the establishment of a new N1 NAS signalling connection, unless for the purpose of initiating a registration procedure for emergency services, emergency services fallback or establishing an emergency PDU session, until the attempts to obtain service on a higher priority PLMN are completed.\nIf the selected PLMN is a VPLMN and the UE has an established emergency PDU session then the UE shall attempt to perform the PLMN selection subsequently after the emergency PDU session is released, if the UE is in automatic network selection mode.\nIf the UDM has not requested an acknowledgement from the UE, then step 5 is skipped; and\n-\tif the selected PLMN is a VPLMN, the security check is not successful and the UE is in automatic network selection mode, then:\n-\tif the UE has a stored SOR-CMCI, the current PLMN is considered as lowest priority and the UE shall apply the actions in clause C.4.2; or\n-\tif there are ongoing PDU sessions or services, the UE shall apply the actions in clause C.4.2; or\n-\tthe UE shall release the current N1 NAS signalling connection locally and attempt to obtain service on a higher priority PLMN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired. The UE shall not initiate the establishment of a new N1 NAS signalling connection, unless for the purpose of initiating a registration procedure for emergency services, establishing an emergency PDU session or performing emergency services fallback, until the attempts to obtain service on a higher priority PLMN are completed;\n-\tif the UE does not have a stored SOR-CMCI, then:\n-\tif there are ongoing PDU sessions or services, the UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority PLMN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired, with an exception that the current PLMN is considered as lowest priority. The UE shall not initiate the establishment of a new N1 NAS signalling connection, unless for the purpose of initiating a registration procedure for emergency services, establishing an emergency PDU session or performing emergency services fallback, until the attempts to obtain service on a higher priority PLMN are completed. If the selected PLMN is a VPLMN and the UE has an established emergency PDU session, then the UE shall attempt to perform the PLMN selection after the emergency PDU session is released; or\n-\tif there are no ongoing PDU sessions or services, the UE shall release the current N1 NAS signalling connection locally and attempt to obtain service on a higher priority PLMN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired, with an exception that the current PLMN is considered as lowest priority. The UE shall not initiate the establishment of a new N1 NAS signalling connection, unless for the purpose of initiating a registration procedure for emergency services, establishing an emergency PDU session or performing emergency services fallback, until the attempts to obtain service on a higher priority PLMN are completed.\nStep 5 is skipped;\nNOTE 8:\tWhen the UE is in the manual mode of operation or the current chosen VPLMN is part of the \"User Controlled PLMN Selector with Access Technology\" list, the UE stays on the VPLMN.\n5)\tThe AMF to the HPLMN UDM: If the UL NAS TRANSPORT message with an SOR transparent container is received, the AMF uses the Nudm_SDM_Info service operation to provide the received SOR transparent container to the UDM. If the HPLMN decided that the UE is to acknowledge successful security check of the received steering of roaming information in step 1, the UDM verifies that the acknowledgement is provided by the UE. If:\n-\tthe \"ME support of SOR-CMCI\" indicator in the header of the SOR transparent container is set to \"supported\", then the HPLMN UDM shall store the \"ME support of SOR-CMCI\" indicator, otherwise the HPLMN UDM shall delete the stored \"ME support of SOR-CMCI\" indicator, if any;\n-\tthe \"ME support of SOR-SNPN-SI\" indicator in the header of the SOR transparent container is set to \"supported\", then the HPLMN UDM shall store the \"ME support of SOR-SNPN-SI\" indicator, otherwise the HPLMN UDM shall delete the stored \"ME support of SOR-SNPN-SI\" indicator, if any; and\n-\tthe \"ME support of SOR-SNPN-SI-LS\" indicator in the header of the SOR transparent container is set to \"supported\", then the HPLMN UDM shall store the \"ME support of SOR-SNPN-SI-LS\" indicator, otherwise the HPLMN UDM shall delete the stored \"ME support of SOR-SNPN-SI-LS\" indicator, if any; and\n6)\tThe HPLMN UDM to the SOR-AF: Nsoraf_SoR_Info (SUPI of the UE, successful delivery, \"ME support of SOR-CMCI\" indicator, if any, \"ME support of SOR-SNPN-SI\" indicator, if any, \"ME support of SOR-SNPN-SI-LS\" indicator, if any). If the HPLMN policy for the SOR-AF invocation is present and the HPLMN UDM received and verified the UE acknowledgement in step 5, then the HPLMN UDM informs the SOR-AF about successful delivery of the list of preferred PLMN/access technology combinations, SOR-CMCI, if any, or of the secured packet to the UE. If:\n-\tthe \"ME support of SOR-CMCI\" indicator is stored for the UE, the HPLMN UDM shall include the \"ME support of SOR-CMCI\" indicator;\n-\tthe \"ME support of SOR-SNPN-SI\" indicator is stored for the UE, the HPLMN UDM shall include the \"ME support of SOR-SNPN-SI\" indicator; and\n-\tthe \"ME support of SOR-SNPN-SI-LS\" indicator is stored for the UE, the HPLMN UDM shall include the \"ME support of SOR-SNPN-SI-LS\" indicator.\nIf the selected PLMN is a VPLMN and:\n-\tthe UE in manual mode of operation encounters security check failure of SOR information in DL NAS TRANSPORT message; and\n-\tupon switching to automatic network selection mode, the UE remembers that it is still registered on the PLMN where the security check failure of SOR information was encountered;\nthe UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority PLMN as specified in clause 4.4.3.3, by acting as if timer T that controls periodic attempts has expired, with an exception that the current registered PLMN is considered as lowest priority. The UE shall not initiate the establishment of a new N1 NAS signalling connection, unless for the purpose of initiating a registration procedure for emergency services, establishing an emergency PDU session or performing emergency services fallback, until the attempts to obtain service on a higher priority PLMN are completed. If the selected PLMN is a VPLMN and the UE has an established emergency PDU session, then the UE shall attempt to perform the PLMN selection after the emergency PDU session is released.\nNOTE 9:\tThe receipt of the steering of roaming information by itself does not trigger the release of the emergency PDU session.\nNOTE 10:\tIf the selected PLMN is the HPLMN, regardless of whether the UE is in automatic network selection mode or manual network selection mode, regardless of whether the UE has an established emergency PDU session or not, and regardless of whether the security check is successful or not successful, the UE is not required to perform the PLMN selection.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "C.4\tEnhanced 5G control plane steering of roaming for the UE in connected mode",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "C.4.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The HPLMN or subscribed SNPN, based on operator policy, may provide the UE with SOR-CMCI to control the timing when the UE enters idle mode and performs higher priority PLMN/access technology or SNPN selection. This is achieved by the HPLMN indicating to the UE the criteria for releasing specific PDU session(s) or services and entering idle mode.\nNOTE 1:\tThe released PDU sessions may be re-established by the application once the UE successfully registers on a higher priority PLMN or SNPN. User interaction is required for some applications.\nThe HPLMN or subscribed SNPN may configure the SOR-CMCI in the UE, and may also provide the SOR-CMCI to the UE over N1 NAS signalling. The SOR-CMCI received over N1 NAS signalling takes precedence over the SOR-CMCI stored in the non-volatile memory of the ME or stored in the USIM.\nNOTE 2:\tThe SOR-CMCI received over N1 NAS signalling in the steering of roaming information is either the SOR-CMCI in the USAT REFRESH with command qualifier of type \"Steering of Roaming\" (see 3GPP TS 31.111 [41]) which is received in a secured packet, or the SOR-CMCI received in plain text.\nIf the UE receives SOR information containing the list of preferred PLMN/access technology combinations or SOR-SNPN-SI without SOR-CMCI, or the ME receives USAT REFRESH with command qualifier (see 3GPP TS 31.111 [41]) of type \"Steering of Roaming\" without SOR-CMCI, or the security check of the received steering of roaming information is not successful as described in clause C.2, clause C.3 and clause C.4.3, then:\n1)\tif the UE has SOR-CMCI stored in the non-volatile memory of the ME, the UE shall use the SOR-CMCI stored in the non-volatile memory of the ME; and\n2)\tif the UE has no SOR-CMCI stored in the non-volatile memory of the ME, the UE shall use the SOR-CMCI stored in the USIM, if any.\nThe UE shall delete the stored SOR-CMCI, if any, in the non-volatile memory of the ME and store the received SOR-CMCI in the non-volatile memory of the ME when:\n1)\tthe ME receives SOR-CMCI in the USAT REFRESH with command qualifier (see 3GPP TS 31.111 [41]) of type \"Steering of Roaming\"; or\n2)\tthe UE receives the steering of roaming information containing the SOR-CMCI over N1 NAS signalling and the UE receives the \"Store SOR-CMCI in ME\" indicator set to \"Store SOR-CMCI in ME\";\nThe SOR-CMCI shall be stored in the non-volatile memory of the ME together with the SUPI from the USIM. The ME shall not delete the SOR-CMCI when the UE is switched off. The ME shall delete the SOR-CMCI when a new USIM is inserted.\nThe MS shall be able to handle at least:\n-\t4 SOR-CMCI rules for PDU session attribute type criterion DNN of the PDU session;\n-\t4 SOR-CMCI rules for PDU session attribute type criterion S-NSSAI STT of the PDU session or S-NSSAI SST and SD of the PDU session; and\n-\t6 SOR-CMCI rules for any of the following types: service type criterion, SOR security check criterion or match all type criterion.\nIf the UE receives the steering of roaming information over N1 NAS signalling containing the SOR-CMCI together with the \"Store SOR-CMCI in ME\" indicator set to \"Do no store SOR-CMCI in ME\", the UE shall not overwrite the SOR-CMCI stored in the ME, if any, with the received SOR-CMCI, and shall apply the received SOR-CMCI for the procedure triggered by receiving the steering of roaming information containing that SOR-CMCI. If there is an ongoing SOR procedure, then the UE shall apply the received SOR-CMCI as described in clause C.4.2.\nSOR-CMCI consists of SOR-CMCI rules. Each SOR-CMCI rule consists of the following parameters:\ni)\ta criterion of one of the following types:\n-\tPDU session attribute type criterion;\n-\tservice type criterion;\n-\tSOR security check criterion; or\n-\tmatch all type criterion; and\nii)\ta value for Tsor-cm timer associated with each criterion presented in i) indicating the time the UE shall wait before releasing the PDU sessions or the services and entering idle mode.\nSOR-CMCI contains zero, one or more SOR-CMCI rules with PDU session attribute type criterion, zero, one or more SOR-CMCI rules with service type criterion, and zero or one SOR-CMCI rule with match all type criterion.\nPDU session attribute type criterion consists of one of the following:\na)\tDNN of the PDU session;\nb)\tS-NSSAI STT of the PDU session; or\nc)\tS-NSSAI SST and SD of the PDU session.\nService type criterion consists of one of the following:\na)\tIMS registration related signalling;\nb)\tMMTEL voice call;\nc)\tMMTEL video call; or\nd)\tSMS over NAS or SMSoIP.\nSOR security check criterion consists of:\na)\tSOR security check not successful.\nMatch all type criterion consists of:\na)\tmatch all.\nWhen the SOR-CMCI received by the UE over N1 NAS signalling contains no SOR-CMCI rules, the UE shall stop all running Tsor-cm timers, if any, and act as if no SOR-CMCI is configured. Additionally:\n-\tif the SOR-CMCI is received in plain text and it also contains the \"Store SOR-CMCI in ME\" indicator set to \"Store SOR-CMCI in ME\", the UE shall delete the stored SOR-CMCI in the non-volatile memory of the ME, if any; and\n-\tif the SOR-CMCI is received in a secured packet, and the USIM provides the ME with the SOR-CMCI in the USAT REFRESH with command qualifier of type \"Steering of Roaming\" (see 3GPP TS 31.111 [41]), then the UE shall delete the stored SOR-CMCI in the non-volatile memory of the ME, if any.\nThe HPLMN may update the SOR-CMCI in the USIM such that it contains no SOR-CMCI rules, in which case the UE behaviour described in clause C.4.2 applies. Also the HPLMN may make the SOR-CMCI file in the USIM unavailable (see 3GPP TS 31.102 [40]).\nIf there are more than one criterion applicable for a PDU session (e.g., a criterion for the PDU session and another one for the service) then the Tsor-cm timer with the highest value shall apply.\nIf there are more than one criterion applicable to different ongoing PDU sessions or services leading to multiple applicable Tsor-cm timers, then all the applicable Tsor-cm timers shall be started. Further handling of such cases is described in clause C.4.2.\nIf the value for Tsor-cm timer equals \"infinity\" then the UE shall wait until the PDU session is released or the service is stopped.\nThe Tsor-cm timer is applicable only if the UE is in automatic network selection mode.\nUpon switching to the manual network selection mode, the UE shall stop any Tsor-cm timer, if running. In this case, the UE is not required to enter idle mode and perform the de-registration procedure.\nThe UE shall consider the following services as exempted from being forced to release the related established PDU session, if any, enter idle mode and perform high priority PLMN/access technology or SNPN selection. These services are known to the UE by default and the UE shall not follow the SOR-CMCI criteria even if configured to interrupt such services:\ni)\temergency services.\nThe UE configured with high priority access in the selected PLMN or SNPN shall consider all services and all related established PDU sessions, if any, to be exempted from being forced to be released to enter idle mode and perform high priority PLMN/access technology or SNPN selection.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.4.2\tApplying SOR-CMCI in the UE",
                    "description": "",
                    "summary": "",
                    "text_content": "During SOR procedure and while applying SOR-CMCI, the UE shall determine the time to release the PDU session(s) or the services as follows:\n-\tIf the UE encounters SOR security check not successful on the received steering of roaming information, and:\n-\tif a matching criterion \"SOR security check not successful\" is included in the stored SOR-CMCI, then the UE shall:\n-\tif the timer value is not zero, start an associated Tsor-cm timer with the value included in the SOR-CMCI;\n-\tstop all other running Tsor-cm timers, if any; and\n-\tnot start any new Tsor-cm timer while Tsor-cm timer associated with \"SOR security check not successful\" criterion is running;\n-\totherwise, the UE shall keep the Tsor-cm timers running, if any, and apply actions when the timers expire as described in this clause.\n-\tIf one or more SOR-CMCI rules are included in SOR-CMCI, where for each criterion:\na)\tDNN of the PDU session:\nthe UE shall check whether it has a PDU session with a DNN matching to the DNN included in SOR-CMCI, and if any, the UE shall, if the timer value is not zero, start an associated Tsor-cm timer with the value included in the SOR-CMCI;\nb)\tS-NSSAI SST of the PDU session:\nthe UE shall check whether it has a PDU session with a S-NSSAI SST matching the S-NSSAI SST included in SOR-CMCI, and if any, the UE shall, if the timer value is not zero, start an associated Tsor-cm timer with the value included in the SOR-CMCI;\nb1)\tS-NSSAI SST and SD of the PDU session:\nthe UE shall check whether it has a PDU session with a S-NSSAI SST and SD matching the S-NSSAI SST and SD included in SOR-CMCI, and if any, the UE shall, if the timer value is not zero, start an associated Tsor-cm timer with the value included in the SOR-CMCI;\nc)\tIMS registration related signalling:\nthe UE shall check whether IMS registration related signalling is ongoing, and if it is ongoing, the UE shall, if the timer value is not zero, start an associated Tsor-cm timer with the value included in the SOR-CMCI;\nd)\tMMTEL voice call:\nthe UE shall check whether MMTEL voice call is ongoing, and if it is ongoing, the UE shall, if the timer value is not zero, start an associated Tsor-cm timer with the value included in the SOR-CMCI;\ne)\tMMTEL video call:\nthe UE shall check whether MMTEL video call is ongoing, and if it is ongoing, the UE shall, if the timer value is not zero, start an associated Tsor-cm timer with the value included in the SOR-CMCI;\nf)\tSMS over NAS or SMSoIP:\nthe UE shall check whether SMS over NAS or SMSoIP services is ongoing, and if it is ongoing, the UE shall, if the timer value is not zero, start an associated Tsor-cm timer with the value included in the SOR-CMCI; or\ng)\tmatch all:\nthe UE shall check whether there are any PDU sessions or services for which there is no matching criterion in a) to f) above. If such PDU session or service exists, then for each of these PDU sessions or services, the UE shall, if the timer value is not zero, start an associated Tsor-cm timer with the value included in the SOR-CMCI.\nIf the SOR-CMCI is available, and:\n-\tthe SOR-CMCI used is in the USIM, contains no SOR-CMCI rule;\n-\tthere are one or more SOR-CMCI rules but there is no criterion matched with any ongoing PDU session or service; or\n-\tthere are one or more SOR-CMCI rules and there is one or more criteria matched with an ongoing PDU session or service, but the highest Tsor-cm timer value associated with the matched criteria is equal to zero;\nthen there is no Tsor-cm timer started for any PDU session or service.\nWhile one or more Tsor-cm timers are running, the UE shall check the newly established PDU session or service for a matching criterion in the SOR-CMCI:\n-\tIf a matching criterion is found and the applicable Tsor-cm timer indicated the value \"infinity\" then the UE shall start the Tsor-cm timer associated to the newly established PDU session or service with the value set to infinity; or\n-\tFor all other cases, if a matching criterion is found and the timer value is not zero then the UE shall start the Tsor-cm timer associated to the newly established PDU session or service with the value included in the SOR-CMCI, with the exception that if the value of the Tsor-cm timer included in the SOR-CMCI exceeds the highest value among the current values of all running Tsor-cm timers, then the value of the Tsor-cm timer for the newly established PDU session or service shall be set to the highest value among the current values of all running Tsor-cm timers.\nNOTE 1:\tFor newly established PDU session or service as described above, the timer is set irrespective of whether other ongoing PDU sessions or services that match the same criteria exist and for which corresponding Tsor-cm timers are running.\nNOTE 2:\tNAS 5GMM layer will receive an explicit indication from the upper layers that a service is started or stopped. When a service is started, it is handled as a new service in the procedures described in this clause.\nNOTE 3:\tWhile one or more Tsor-cm timers are running, the UE can trigger any 5GSM procedure or start new services.\nWhile one or more Tsor-cm timers are running, upon receiving a new SOR-CMCI as described in annex C.4.3, the UE shall check if there is a matching criterion found for any ongoing PDU session or service in the new SOR-CMCI:\n-\tif a matching criterion is found and the value of Tsor-cm timer in the new SOR-CMCI indicates the value \"infinity\", then:\na)\tif the Tsor-cm timer associated to the PDU session or service is not running, then the UE shall start the Tsor-cm timer associated to the PDU session or service with the value set to infinity; or\nb)\tif the Tsor-cm timer associated to the PDU session or service is already running, then the UE shall set the value of the Tsor-cm timer associated to the PDU session or service to infinity without stopping and restarting the timer;\n-\tif a matching criterion is found and the value of Tsor-cm timer in the new SOR-CMCI is other than infinity and is smaller than the current value of the running Tsor-cm timer for the associated PDU session or service, then the Tsor-cm timer value for the associated PDU session or service shall be replaced with the value in the new SOR-CMCI without stopping and restarting the timer; or\n-\tfor all other cases, the running Tsor-cm timers for the associated PDU sessions or services are kept unchanged.\nThe Tsor-cm timer shall be stopped when the associated PDU session is released or the associated service is stopped.\nIf the security check on the received steering of roaming information is successful, the UE shall stop the Tsor-cm timer associated with \"SOR security check not successful\", if running, and act on the received steering of roaming information. The current PLMN or SNPN is not considered as lowest priority.\nNOTE 4:\tThis also applies to the case when the current PLMN or SNPN is different from the PLMN or SNPN in which the Tsor-cm timer associated with \"SOR security check not successful\" was started.\nIf the UE, while one or more Tsor-cm timers are running:\na)\tenters idle mode not due to lower layer failure (see 3GPP TS 24.501 [64]);\nb)\tis not able to successfully recover the N1 NAS signalling connection (see 3GPP TS 24.501 [64]); or\nc)\tenters 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]);\nthen the UE shall stop the timer(s). In these cases, if:\na)\tthe UE has a list of available and allowable PLMNs or SNPNs in the area and based on this list or any other implementation specific means, the UE determines that there is a higher priority PLMN or SNPN than the selected VPLMN or non-subscribed SNPN; or\nb)\tthe UE does not have a list of available and allowable PLMNs or SNPNs in the area and is unable to determine whether there is a higher priority PLMN or SNPN than the selected VPLMN or non-subscribed SNPN using any other implementation specific means;\nthen the UE shall attempt to obtain service on a higher priority PLMN or SNPN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired or as specified in clause 4.9.3.\nNOTE 5:\tWhen the UE enters idle mode due to lower layer failure while one or more Tsor-cm timers are running, then the UE does not stop Tsor-cm timer(s) as recovery of NAS signalling connection is possible (see 3GPP TS 24.501 [64]).\nWhen the UE determines that no Tsor-cm timer is started for any PDU session or service, the last running Tsor-cm timer is stopped due to release of the associated PDU sessions or stop of the associated services, or the last running Tsor-cm timer expires, if:\ni)\tthe UE has a list of available and allowable PLMNs or SNPNs in the area and based on this list or any other implementation specific means, the UE determines that there is a higher priority PLMN or SNPN than the selected VPLMN or non-subscribed SNPN; or\nii)\tthe UE does not have a list of available and allowable PLMNs or SNPNs in the area and is unable to determine whether there is a higher priority PLMN or SNPN than the selected VPLMN or non-subscribed SNPNusing any other implementation specific means;\nthen if the UE is in 5GMM-CONNECTED mode, the UE shall perform the de-registration procedure (see clause 4.2.2.3 of 3GPP TS 23.502 [63]) that releases all the established PDU sessions and services, if any, and once the UE enters idle mode it shall attempt to obtain service on a higher priority PLMN or SNPN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired or as specified in clause 4.9.3.\nNOTE 6:\tThe list of available and allowable PLMNs or SNPNs in the area is implementation specific.\nThe UE which has an emergency PDU session, receives a request from the upper layers to establish an emergency PDU session or perform emergency services fallback, registers for emergency services, or is configured for high priority access in the selected PLMN or SNPN is not required to enter idle mode if the last running Tsor-cm timer for any PDU session or service stops or expires. In this case, the UE shall attempt to perform the PLMN or SNPN selection after the emergency PDU session or the high priority service is released and after the UE enters idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]).\nIf the UE selects a cell of any access technology other than NG-RAN, the ongoing SOR procedure is terminated and the UE shall stop applying SOR-CMCI and stop all running Tsor-cm timers without triggering any further actions.\nNOTE 7:\tIf the UE is served by any access technology other than NG-RAN, the HPLMN can initiate a steering of roaming procedure as specified in clause 4.4.6.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.4.3\tStage-2 flow for providing UE with SOR-CMCI in HPLMN, VPLMN, subscribed SNPN or non-subscribed SNPN after registration",
                    "description": "",
                    "summary": "",
                    "text_content": "The stage-2 flow for providing UE with SOR-CMCI in HPLMN, VPLMN, subscribed SNPN or non-subscribed SNPN after registration is indicated in figure C.4.3.1, when the ME supports the SOR-CMCI. The selected PLMN or SNPN can be the HPLMN, a VPLMN, the subscribed SNPN or a non-subscribed SNPN. The AMF is located in the selected PLMN or SNPN. The UDM is located in the HPLMN or the subscribed SNPN.\nIn this procedure, the SOR-CMCI is sent without the list of preferred PLMN/access technology combinations and the SOR-SNPN-SI. In this procedure, the SOR-CMCI is sent in plain text or is sent within the secured packet.\nNOTE 0:\tWhen the UE is registered in a non-subscribed SNPN, the SOR-CMCI can be provided in a secured packet only if the UE is using a PLMN subscription to access the non-subscribed SNPN.\nNOTE 1:\tThe SOR-AF can determine that the ME supports the SOR-CMCI if the Nsoraf_SoR_Info service operation has returned the \"ME support of SOR-CMCI\" indicator. The UDM can determine that the ME supports the SOR-CMCI if the \"ME support of SOR-CMCI\" indicator is stored for the UE. How the SOR-AF determines that the USIM for the indicated SUPI supports SOR-CMCI is implementation specific.\nNOTE 2:\tThe secured packet provided by the SOR-AF can include SOR-CMCI only if the SOR-AF has determined that the ME supports the SOR-CMCI and the USIM of the indicated SUPI supports SOR-CMCI. Otherwise if only the \"ME support of SOR-CMCI\" indicator is stored for the UE, then SOR-CMCI, if any, cannot be included in the secured packet.\nThe procedure is triggered:\n-\tIf the UDM supports obtaining the parameters of the list of preferred PLMN/access technology combinations, the SOR-SNPN-SI, the SOR-CMCI, and the \"Store SOR-CMCI in ME\" indicator, if any, or a secured packet from the SOR-AF, the HPLMN or subscribed SNPN policy for the SOR-AF invocation is present in the UDM and the SOR-AF provides the UDM with the SOR-CMCI for a UE identified by SUPI; or\n-\tWhen the SOR-CMCI becomes available in the UDM (i.e., retrieved from the UDR).\n\nFigure C.4.3.1: Procedure for configuring UE with SOR-CMCI after registration\nFor the steps below, security protection is described in 3GPP TS 33.501 [66].\n1)\tThe SOR-AF to the UDM: Nudm_ParameterProvision_Update request is sent to the UDM to trigger the update of the UE with the SOR-CMCI (in plain text or secured packet). In case of providing SOR-CMCI in plain text, include the \"Store SOR-CMCI in ME\" indicator, if applicable. In case of providing SOR-CMCI in a secured packet, include an indication that \"the list of preferred PLMN/access technology combinations is not included in the secured packet\".\n2)\tThe UDM to the AMF: The UDM notifies the changes of the user profile to the affected AMF by the means of invoking Nudm_SDM_Notification service operation. The Nudm_SDM_Notification service operation contains the steering of roaming information that needs to be delivered transparently to the UE over NAS within the Access and Mobility Subscription data. If the HPLMN or subscribed SNPN decided that the UE is to acknowledge successful security check of the received steering of roaming information, the Nudm_SDM_Notification service operation also contains an indication that the UDM requests an acknowledgement from the UE as part of the steering of roaming information. The UDM:\n-\tupon receiving the SOR-CMCI (in plain text), shall:\ni)\tif the UE is registered in the HPLMN or a VPLMN, include the SOR-CMCI, the \"Store SOR-CMCI in ME\" indicator, if any, and the HPLMN indication that 'no change of the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the UE is needed and thus no list of preferred PLMN/access technology combinations is provided';\nii)\tif the UE is registered in a non-subcribed SNPN, include the SOR-CMCI, the \"Store SOR-CMCI in ME\" indicator, if any, and the HPLMN or subscribed SNPN indication that 'no change of the SOR-SNPN-SI stored in the UE is needed and thus no SOR-SNPN-SI is provided'; and\niii)\tif the UE is registered in a subcribed SNPN and the AMF has reported to the UDM that the UE supports SOR-SNPN-SI, include the SOR-CMCI, the \"Store SOR-CMCI in ME\" indicator, if any, and the HPLMN or subscribed SNPN indication that 'no change of the SOR-SNPN-SI stored in the UE is needed and thus no SOR-SNPN-SI is provided'; or\n-\tupon receiving the SOR-CMCI in secured packet, shall include the secured packet into the steering of roaming information;\nNOTE 3:\tThe UDM considers \"the list of preferred PLMN/access technology combinations is not included in the secured packet\" received together with the secured packet from the SOR-AF to indicate that the UE is not expected to perform SOR based on the associated steering of roaming information sent to the UE. However, the SOR-CMCI included in the secured packet can be applied by the UE if the UE has one or more Tsor-cm timers running as described in C.4.2.\nNOTE 4:\tThe UDM cannot provide the SOR-CMCI, if any, to the AMF which does not support receiving SoR transparent container (see 3GPP TS 29.503 [78]).\n3)\tThe AMF to the UE: the AMF sends a DL NAS TRANSPORT message to the served UE. The AMF includes in the DL NAS TRANSPORT message the steering of roaming information received from the UDM.\n4)\tUpon receiving the steering of roaming information containing the SOR-CMCI and the HPLMN indication that 'no change of the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the UE is needed and thus no list of preferred PLMN/access technology combinations is provided' or the HPLMN or subscribed SNPN indication that 'no change of the SOR-SNPN-SI stored in the UE is needed and thus no SOR-SNPN-SI is provided', or the secured packet, the UE shall perform a security check on the steering of roaming information included in the DL NAS TRANSPORT message to verify that the steering of roaming information is provided by HPLMN or subscribed SNPN, and:\na)\tif the security check is successful, the UE shall store the SOR-CMCI according to clause C.4.1. If the UE has one or more Tsor-cm timers running, the UE shall apply the received SOR-CMCI as described in C.4.2.\nIf the steering of roaming information contains a secured packet and the UDM has requested an acknowledgement from the UE in the DL NAS TRANSPORT message, the UE sends an UL NAS TRANSPORT message to the serving AMF with an SOR transparent container including the UE acknowledgement and the UE shall set the \"ME support of SOR-CMCI\" indicator to \"supported\" only after the ME receives UICC responses indicating that the UICC has received the secured packet successfully. Otherwise, if the UDM has requested an acknowledgement from the UE in the DL NAS TRANSPORT message, the UE sends an UL NAS TRANSPORT message to the serving AMF with an SOR transparent container including the UE acknowledgement and the UE shall set the \"ME support of SOR-CMCI\" indicator to \"supported\". Additionally, if the UE supports access to an SNPN using credentials from a credentials holder and the UE is in a PLMN, the UE may set the \"ME support of SOR-SNPN-SI\" indicator to \"supported\".\nIf the UDM has not requested an acknowledgement from the UE then step 5 is skipped; and\nb)\tif the selected PLMN is a VPLMN or a non-subscribed SNPN, the security check is not successful and the UE is in automatic network selection mode, then:\n-\tif the UE has a stored SOR-CMCI, the current PLMN is considered as lowest priority and the UE shall apply the actions in clause C.4.2;\n-\totherwise, the UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority PLMN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired, with an exception that the current PLMN is considered as lowest priority, or before attempting to obtain service on a higher priority SNPN as specified in clause 4.9.3, with an exception that the current registered SNPN is considered as lowest priority. If the selected PLMN or SNPN is a VPLMN or a non-subscribed SNPN and the UE has an established emergency PDU session then the UE shall attempt to perform the PLMN selection after the emergency PDU session is released and after the UE enters idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]).\nStep 5 is skipped;\nNOTE 5:\tWhen the UE is in the manual mode of operation or the current chosen VPLMN is part of the \"User Controlled PLMN Selector with Access Technology\" list or the current chosen non-subscribed SNPN is part of the user controlled prioritized list of preferred SNPNs for the selected entry of the \"list of subscriber data\" the selected PLMN subscription, the UE stays on the VPLMN or non-subscribed SNPN.\n5)\tThe AMF to the UDM: If the UL NAS TRANSPORT message with an SOR transparent container is received, the AMF uses the Nudm_SDM_Info service operation to provide the received SOR transparent container to the UDM. If the HPLMN or subscribed SNPN decided that the UE is to acknowledge successful security check of the received steering of roaming information in step 2, the UDM verifies that the acknowledgement is provided by the UE. The UDM shall store the \"ME support of SOR-CMCI\" indicator and the \"ME support of SOR-SNPN-SI\" indicator, if any; and\n6)\tThe UDM to the SOR-AF: Nsoraf_SoR_Info (SUPI of the UE, successful delivery, \"ME support of SOR-CMCI\" indicator, \"ME support of SOR-SNPN-SI\" indicator, if any). If the HPLMN or subscribed SNPN policy for the SOR-AF invocation is present and the UDM received and verified the UE acknowledgement in step 5, then the UDM informs the SOR-AF about successful delivery of the SOR-CMCI to the UE. The UDM shall include the \"ME support of SOR-CMCI\" indicator and the \"ME support of SOR-SNPN-SI\" indicator, if any.\nIf the selected PLMN is a VPLMN or a non-subscribed SNPN and:\n-\tthe UE in manual mode of operation encounters security check failure of SOR information in DL NAS TRANSPORT message; and\n-\tupon switching to automatic network selection mode the UE remembers that it is still registered on the PLMN the non-subscribed SNPN where the security check failure of SOR information was encountered;\nthe UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority PLMN as specified in clause 4.4.3.3, by acting as if timer T that controls periodic attempts has expired, with an exception that the current registered PLMN is considered as lowest priority, or before attempting to obtained service on a higher priority SNPN as specified in clause 4.9.3, with an exception that the current registered SNPN is considered as lowest priority. If the selected PLMN is a VPLMN or the selected SNPN is a non-subscribed SNPN and the UE has an established emergency PDU session then the UE shall attempt to perform the PLMN selection after the emergency PDU session is released and after the UE enters idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]).\nNOTE 6:\tThe receipt of the steering of roaming information by itself does not trigger the release of the emergency PDU session.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "C.5\tStage-2 flow for steering of UE in SNPN during registration",
            "description": "The stage-2 flow for the case when the UE registers in a non-subscribed SNPN is described below in figure C.5.1. The AMF is located in the non-subscribed SNPN. The UDM is located in the HPLMN or subscribed SNPN.\nFigure C.5.1 illustrates the step-by-step procedure for providing SOR-SNPN-SI and SOR-SNPN-SI-LS (if any) during registration in a telecommunication system. The figure outlines the process, starting with the initial registration request, followed by the establishment of the SOR-SNPN-SI and SOR-SNPN-SI-LS connections. The figure emphasizes the importance of these procedures in ensuring secure and reliable communication between the network elements and the user equipment. The various components involved, such as the network elements, user equipment, and signaling protocols, are clearly labeled and interconnected, providing a comprehensive overview of the registration process.\nFigure C.5.1: Procedure for providing SOR-SNPN-SI and SOR-SNPN-SI-LS (if any) during registration\nFor the steps below, security protection is described in 3GPP TS 33.501 [66].\n1)\tThe UE to the AMF: The UE initiates initial registration, emergency registration or registration procedure for mobility and periodic registration update (see 3GPP TS 24.501 [64]) to the AMF by sending REGISTRATION REQUEST message with the 5GS registration type IE indicating \"initial registration\", \"emergency registration\" or \"mobility registration updating\";\n2)\tUpon receiving the REGISTRATION REQUEST message, the AMF executes the registration procedure as defined in clause 4.2.2.2 of 3GPP TS 23.502 [63]. As part of the registration procedure:\na)\tthe AMF provides the registration type to the UDM using Nudm_UECM_Registration. As a consequence, in case of the 5GS registration type message indicates \"initial registration\" or \"emergency registration\" the UDM shall delete the stored \"ME support of SOR-CMCI\" indicator, if any, and the stored \"ME support of SOR-SNPN-SI-LS\" indicator, if any, in UDR using Nudr_DM_Update service operation (see 3GPP TS 23.502 [63]).\nNOTE 1:\tNudr_DM_Update service operation corresponds to Nudr_DR_Update service operation (see 3GPP TS 29.504 [82] and 3GPP TS 29.505 [83]).\nIn addition:\na)\tif the AMF does not have subscription data for the UE, the AMF invokes Nudm_SDM_Get service operation to the UDM to get amongst other information the Access and Mobility Subscription data for the UE (see step 14b in clause 4.2.2.2.2 of 3GPP TS 23.502 [63]); or\nb)\tif the AMF already has subscription data for the UE and:\ni)\tthe 5GS registration type IE in the received REGISTRATION REQUEST message indicates \"initial registration\" and the \"SoR Update Indicator for Initial Registration\" field in the UE context is set to 'the UDM requests the AMF to retrieve SoR information when the UE performs NAS registration type \"initial registration\"' as specified in table 5.2.2.2.2-1 of 3GPP TS 23.502 [63]); or\nii)\tthe 5GS registration type IE in the received REGISTRATION REQUEST message indicates \"emergency registration\" and the \"SoR Update Indicator for Emergency Registration\" field in the UE context is set to 'the UDM requests the AMF to retrieve SoR information when the UE performs NAS registration type \"emergency registration\"' as specified in table 5.2.2.2.2-1 of 3GPP TS 23.502 [63]);\nthen the AMF invokes Nudm_SDM_Get service operation message to the UDM to retrieve the steering of roaming information (see step 14b in clause 4.2.2.2.2 of 3GPP TS 23.502 [63]);\notherwise the AMF sends a REGISTRATION ACCEPT message without the steering of roaming information to the UE and steps 3a, 3b, 3c, 3d, 4, 5, 6 are skipped;\n3a)\tIf the user subscription information indicates to send the steering of roaming information due to initial registration in a non-subscribed SNPN, then the UDM shall store the \"ME support of SOR-SNPN-SI\" indicator and shall provide the steering of roaming information to the UE when the UE performs initial registration in a non-subscribed SNPN. Otherwise:\na)\tIf the UE is registering on the subscribed SNPN and the UE has not indicated support for SOR-SNPN-SI in the REGISTRATION REQUEST message, the UDM shall delete the stored \"ME support of SOR-SNPN-SI\" indicator, if any, and shall not provide the SOR-SNPN-SI to the UE; and\nb)\tIf:\na)\tthe UE is registering on the subscribed SNPN and the UE has indicated support for SOR-SNPN-SI in the REGISTRATION REQUEST message; or\nb)\tthe UE is registering on a non-subscribed SNPN;\nthe UDM shall store the \"ME support of SOR-SNPN-SI\" indicator and may provide the SOR-SNPN-SI to the UE based on the subscribed SNPN or HPLMN policy.\nIf the UDM is to provide the steering of roaming information to the UE when the UE performs the registration in a non-subscribed SNPN and the subscribed SNPN or HPLMN policy for the SOR-AF invocation is absent then steps 3b and 3c are not performed and the UDM obtains the available SOR-SNPN-SI (i.e. all retrieved from the UDR). In addition, if the UDM obtains the SOR-SNPN-SI and\n-\tthe \"ME support of SOR-CMCI\" indicator is stored for the UE, then the UDM shall obtain the SOR-CMCI, if available, otherwise the UDM shall not obtain the SOR-CMCI. If the SOR-CMCI is provided then the UDM may indicate to the UE to store the SOR-CMCI in the ME by providing the \"Store the SOR-CMCI in the ME\" indicator; and\n-\tthe \"ME support of SOR-SNPN-SI-LS\" indicator is stored for the UE, then the UDM shall obtain the SOR-SNPN-SI-LS, if available, otherwise the UDM shall not obtain the SOR-SNPN-SI-LS.\nIf the UDM is to provide the steering of roaming information to the UE when the UE performs the registration in a non-subscribed SNPN and the subscribed SNPN or HPLMN policy for the SOR-AF invocation is present, then the UDM obtains the SOR-SNPN-SI, SOR-CMCI, if any, and SOR-SNPN-SI-LS, if any, from the SOR-AF using steps 3b and 3c;\n3b)\tThe UDM to the SOR-AF: Nsoraf_SoR_Get request (SNPN identity, SUPI of the UE, access type (see 3GPP TS 29.571 [72])). The SNPN identity and the access type parameters, indicating where the UE is registering, are stored in the UDM;\n3c)\tThe SOR-AF to the UDM: Nsoraf_SoR_Get response (the SOR-SNPN-SI, the SOR-CMCI, if any, the \"Store the SOR-CMCI in the ME\" indicator, if any, and the SOR-SNPN-SI-LS, if any);\nBased on the information received in step 3b and any subscribed SNPN or HPLMN specific criteria, the SOR-AF may include the SOR-SNPN-SI, the SOR-CMCI, if any, optionally the \"Store the SOR-CMCI in the ME\" indicator, if any, and the SOR-SNPN-SI-LS, if any.\nIf the SOR-AF includes the SOR-SNPN-SI and the ME supports:\n-\tthe SOR-CMCI, the SOR-AF may provide the SOR-CMCI and optionally the \"Store the SOR-CMCI in the ME\" indicator, otherwise the SOR-AF shall provide neither the SOR-CMCI nor the \"Store the SOR-CMCI in the ME\" indicator;and\n-\tthe SOR-SNPN-SI-LS, the SOR-AF may provide the SOR-SNPN-SI-LS, otherwise the SOR-AF shall not provide SOR-SNPN-SI-LS.\nNOTE 1:\tIn this version of the specification, when the access type where the UE is registering indicates 3GPP access, then the UE is registering over the NG-RAN access technology.\nNOTE 2:\tThe SOR-AF can include a different SOR-SNPN-SI, different SOR-CMCI, if any, different \"Store the SOR-CMCI in the ME\" indicator, if any, and different SOR-SNPN-SI-LS, if any, for each Nsoraf_SoR_Get request even if the same SNPN identity, the SUPI of the UE, and the access type are provided to the SOR-AF.\nNOTE 3:\tThe SOR-AF can subscribe to the UDM to be notified about the changes of the roaming status of the UE identified by SUPI.\nNOTE 4:\tThe SOR-AF can determine that the ME supports the SOR-CMCI or the SOR-SNPN-SI-LS if the Nsoraf_SoR_Info service operation has returned the \"ME support of SOR-CMCI\" indicator or the \"ME support of SOR-SNPN-SI-LS\" indicator, respectively.\n3d)\tThe UDM forms the steering of roaming information as specified in 3GPP TS 33.501 [66] from the SOR-SNPN-SI, the SOR-CMCI, if any, the \"Store the SOR-CMCI in the ME\" indicator, if any, and SOR-SNPN-SI-LS, if any, obtained in step 3a or the SOR-SNPN-SI, the SOR-CMCI, if any, the \"Store the SOR-CMCI in the ME\" indicator, if any, and SOR-SNPN-SI-LS, if any, obtained in step 3c.\nIf:\n-\tthe SOR-SNPN-SI was not obtained in steps 3a or 3c; or\n-\tthe SOR-AF has not sent to the UDM an Nsoraf_SoR_Get response (step 3c) within an operator defined time after the UDM sending to the SOR-AF an Nsoraf_SoR_Get request (step 3b);\nNOTE 5:\tStage 3 to define the timer needed for the SOR-AF to respond to the UDM. The max time needs to be defined considering that this procedure is part of the registration procedure.\nand the UE is performing initial registration in a non-subscribed SNPN and the user subscription information indicates to send the steering of roaming information due to initial registration in a non-subscribed SNPN, then the UDM forms the steering of roaming information as specified in 3GPP TS 33.501 [66] from the subscribed SNPN or HPLMN indication that 'no change of the SOR-SNPN-SI stored in the UE is needed and thus no SOR-SNPN-SI is provided';\n4)\tThe UDM to the AMF: The UDM sends a response to the Nudm_SDM_Get service operation to the AMF, which includes the steering of roaming information within the Access and Mobility Subscription data. The Access and Mobility Subscription data type is defined in clause 5.2.3.3.1 of 3GPP TS 23.502 [63]).\nNOTE 6:\tThe UDM cannot provide the SOR-SNPN-SI, the SOR-CMCI, if any, or the SOR-SNPN-SI-LS to the AMF which does not support receiving SOR transparent container (see 3GPP TS 29.503 [78]).\nIf the UE is performing initial registration or emergency registration and the UDM supports SOR-CMCI or SOR-SNPN-SI-LS, the subscribed SNPN or HPLMN shall request the UE to acknowledge the successful security check of the received steering of roaming information, by providing the indication as part of the steering of roaming information in the Nudm_SDM_Get response service operation. Otherwise, the subscribed SNPN or HPLMN may request the UE to acknowledge the successful security check of the received steering of roaming information, by providing the indication as part of the steering of roaming information in the Nudm_SDM_Get response service operation;\n5)\tThe AMF to the UDM: As part of the registration procedure, the SNPN also invokes Nudm_SDM_Subscribe service operation to the UDM to subscribe to notification of changes of the subscription data (e.g. received in step 4) including notification of updates of the steering of roaming information included in the Access and Mobility Subscription data (see step 14c in clause 4.2.2.2.2 of 3GPP TS 23.502 [63]);\n6)\tThe AMF to the UE: The AMF shall transparently send the received steering of roaming information to the UE in the REGISTRATION ACCEPT message;\n7)\tIf the steering of roaming information is received and the security check is successful, then:\na)\tif the UDM has not requested an acknowledgement from the UE, then the UE shall send the REGISTRATION COMPLETE message to the serving AMF without including an SOR transparent container; and\nb)\tif the steering of roaming information contains the SOR-SNPN-SI, the ME shall replace the credentials holder controlled prioritized list of preferred SNPNs for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription with the received credentials holder controlled prioritized list of preferred SNPNs, if any, and the ME shall replace the credentials holder controlled prioritized list of GINs for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription with the received credentials holder controlled prioritized list of GINs, if any, and delete the SNPNs identified by the credentials holder controlled prioritized list of preferred SNPNs or the SNPN(s) stored along with GIN(s) identified by the credentials holder controlled prioritized list of GINs from the list of \"temporarily forbidden SNPNs\" and the list of \"permanently forbidden SNPNs\", if they are present in these lists. If the SOR information contains the SOR-SNPN-SI-LS, the ME shall replace the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription with the received \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\", if any, and the ME shall replace the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription with the received \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\", if any, and delete the SNPNs identified by the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" or the SNPN(s) stored along with GIN(s) identified by the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" from the list of \"temporarily forbidden SNPNs for access for localized services in SNPN\" and the list of \"permanently forbidden SNPNs for access for localized services in SNPN\", if they are present in these lists. Additionally, the UE may perform SNPN selection. If the UE decides to perform SNPN selection:\ni)\tif the UE has a list of available and allowable SNPN in the area and based on this list or any other implementation specific means the UE determines that there is a higher priority SNPN than the selected SNPN; or\nii)\tthe UE does not have a list of available and allowable SNPN in the area and is unable to determine whether there is a higher priority SNPN than the selected SNPN using any other implementation specific means;\nand the UE is in automatic network selection mode:\nA)\tif the UE is configured with the SOR-CMCI or received the SOR-CMCI over N1 NAS signalling, the UE shall apply the actions in clause C.4.2. In this case steps 8 to 11 are skipped;\nB)\totherwise, the UE shall:\ni)\trelease the current N1 NAS signalling connection locally and then attempt to obtain service on a higher priority SNPN as specified in clause 4.9.3. In this case, steps 8 to 11 are skipped. The UE shall suspend the transmission of 5GSM messages until the N1 NAS signalling is released. The UE shall not initiate the establishment of a new N1 signalling connection, unless for the purpose of initiating a registration procedure for emergency services or establishing an emergency PDU session, until the attempts to obtain service on a higher priority SNPN are completed. If the UE has an established emergency PDU session (see 3GPP TS 24.501 [64]), the receipt of the steering of roaming information shall not trigger the release of the N1 NAS signalling connection. The UE shall release the current N1 NAS signalling connection locally subsequently after the emergency PDU session is released. If the UE needs to disable the N1 mode capability (see 3GPP TS 24.501 [64]) and there is no emergency service pending, the UE shall first attempt to obtain service on a higher priority SNPN as described in this step, and if no higher priority SNPN can be selected but the last registered SNPN is selected, then the UE shall disable the N1 mode capability; or\nii)\tnot release the current N1 NAS signalling connection locally (e.g. if the UE has established PDU session(s)) and skip steps 8 to 10;\nNOTE 7:\tWhen the UE is in the manual mode of operation or the current chosen non-subscribed SNPN is part of the user controlled prioritized list of preferred SNPNs, the UE stays on the current chosen non-subscribed SNPN.\n8)\tIf the UE's ME is configured with an indication that the UE is to receive the steering of roaming information due to initial registration in a non-subscribed SNPN, but neither the SOR-SNPN-SI nor the subscribed SNPN or HPLMN indication that 'no change of the SOR-SNPN-SI stored in the UE is needed and thus no SOR-SNPN-SI is provided' is received in the REGISTRATION ACCEPT message, when the UE performs initial registration in a VPLMN or if the steering of roaming information is received but the security check is not successful, then the UE shall:\na)\tif the SOR transparent container is included in the REGISTRATION ACCEPT message, send the REGISTRATION COMPLETE message to the serving AMF without including an SOR transparent container;\nb)\tif the current chosen non-subscribed SNPN is not contained in the list of \"SNPNs where registration was aborted due to SOR\" for the selected entry in the \"list of subscriber data\" or the selected PLMN subscription, and is not part of the user controlled prioritized list of preferred SNPNs for the selected entry in the \"list of subscriber data\" or the selected PLMN subscription, and the UE is not in manual mode of operation, release the current N1 NAS signalling connection locally and attempt to obtain service on a higher priority SNPN as specified in clause 4.9.3, with an exception that the current SNPN is considered as lowest priority, and skip steps 9 to 11. The UE shall suspend the transmission of 5GSM messages until the N1 NAS signalling is released. If the UE has an established emergency PDU session (see 3GPP TS 24.501 [64]), the UE shall release the current N1 NAS signalling connection locally after the release of the emergency PDU session. If the UE needs to disable the N1 mode capability (see 3GPP TS 24.501 [64]) and there is no emergency service pending, the UE shall first attempt to obtain service on a higher priority SNPN as described in this step, and if no higher priority SNPN can be selected but the last registered SNPN is selected, then the UE shall disable the N1 mode capability; and\nc)\tif the current chosen non-subscribed SNPN is not contained in the list of \"SNPNs where registration was aborted due to SOR\" for the selected entry in the \"list of subscriber data\" or the selected PLMN subscription, store the SNPN identity in the list of \"SNPNs where registration was aborted due to SOR\" for the selected entry in the \"list of subscriber data\" or the selected PLMN subscription;\nNOTE 8:\tWhen the UE is in the manual mode of operation or the current chosen non-subscribed SNPN is part of the user controlled prioritized list of preferred SNPNs, the UE stays on the current chosen non-subscribed SNPN.\n9)\tThe UE to the AMF: If the UDM has requested an acknowledgement from the UE and the UE verified that the steering of roaming information has been provided by the subscribed SNPN or HPLMN in step 7, then:\na)\tthe UE sends the REGISTRATION COMPLETE message to the serving AMF with an SOR transparent container including the UE acknowledgement;\nb)\tthe UE shall set the \"ME support of SOR-CMCI\" indicator in the header of the SOR transparent container to \"supported\";\nb1)\tif the UE supports access to an SNPN providing access for localized services in SNPN, the UE shall set the \"ME support of SOR-SNPN-SI-LS\" indicator in the header of the SOR transparent container to \"supported\"; and\nc)\tif:\n1)\tthe steering of roaming information contains the SOR-SNPN-SI, the UE is configured with the SOR-CMCI or received the SOR-CMCI over N1 NAS signalling, the UE is in automatic network selection mode and the UE decides to perform SNPN selection, then the UE shall apply the actions in clause C.4.2, and step 11 is skipped; or\n2)\tthe steering of roaming information contains subscribed SNPN or HPLMN indication that 'no change of the SOR-SNPN-SI stored in the UE is needed and thus no SOR-SNPN-SI is provided', then step 11 is skipped;\n10)\tThe AMF to the UDM: If an SOR transparent container is received in the REGISTRATION COMPLETE message, the AMF uses the Nudm_SDM_Info service operation to provide the received SOR transparent container to the UDM. If the subscribed SNPN or HPLMN decided that the UE is to acknowledge the successful security check of the received steering of roaming information in step 4, the UDM verifies that the acknowledgement is provided by the UE as specified in 3GPP TS 33.501 [66]. If:\n-\tthe “ME support of SOR-CMCI” indicator in the header of the SOR transparent container is set to “supported”, then the UDM shall store the “ME support of SOR-CMCI” indicator, otherwise the UDM shall delete the stored “ME support of SOR-CMCI” indicator, if any; and\n-\tthe \"ME support of SOR-SNPN-SI-LS\" indicator in the header of the SOR transparent container is set to \"supported\", then the UDM shall store the \"ME support of SOR-SNPN-SI-LS\" indicator, otherwise the UDM shall delete the stored \"ME support of SOR-SNPN-SI-LS\" indicator, if any\nNOTE 9:\tThe UDM cannot receive the \"ME support of SOR-CMCI\" indicator or the \"ME support of SOR-SNPN-SI-LS\" indicator from the AMF which does not support receiving SoR transparent container (see 3GPP TS 29.503 [78]).\n10a)\tThe UDM to the SOR-AF: Nsoraf_SoR_Info (SUPI of the UE, successful delivery, \"ME support of SOR-CMCI\" indicator, if any, \"ME support of SOR-SNPN-SI-LS\" indicator, if any). If the subscribed SNPN or HPLMN policy for the SOR-AF invocation is present and the UDM received and verified the UE acknowledgement in step 10, then the UDM informs the SOR-AF about successful delivery of the SOR-SNPN-SI to the UE. If:\n-\tthe \"ME support of SOR-CMCI\" indicator is stored for the UE, the UDM shall include the \"ME support of SOR-CMCI\" indicator; and\n-\tthe \"ME support of SOR-SNPN-SI-LS\" indicator is stored for the UE, the UDM shall include the \"ME support of SOR-SNPN-SI-LS\" indicator; and\n11)\tIf the UE has a list of available SNPNs in the area and based on this list the UE determines that there is a higher priority SNPN than the selected SNPN and the UE is in automatic network selection mode, then the UE may attempt to obtain service on a higher priority SNPN as specified in clause 4.9.3 after the release of the N1 NAS signalling connection. If within an implementation dependent time the N1 NAS signalling connection is not released, then the UE may locally release the N1 signalling connection except when the UE has an established emergency PDU session (see 3GPP TS 24.501 [64]).\nWhen the UE performs initial registration for emergency services (see 3GPP TS 24.501 [64] and 3GPP TS 23.502 [63]) and the AMF performs the authentication procedure, then based on subscribed SNPN or HPLMN policy, the SOR procedure described in this clause may apply.\nIf:\n-\tthe UE in manual mode of operation encounters scenario mentioned in step 8 above; and\n-\tupon switching to automatic network selection mode, the UE remembers that it is still registered on the where the security check failure of SOR information was encountered as described in step 8;\nthe UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority SNPN as specified in clause 4.9.3, with an exception that the current registered SNPN is considered as lowest priority. If the UE has an established emergency PDU session, then the UE shall attempt to perform the SNPN selection subsequently after the emergency PDU session is released.\nNOTE 10:\tThe receipt of the steering of roaming information by itself does not trigger the release of the emergency PDU session.\nNOTE 11:\tThe list of available and allowable SNPNs in the area is implementation specific.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "C.6\tStage-2 flow for steering of UE in SNPN after registration",
            "description": "The stage-2 flow for the steering of UE in SNPN after registration is indicated in figure C.6.1. The UE is registered on an SNPN which can be the subscribed SNPN or a non-subscribed SNPN. The AMF is located in the selected SNPN. The UDM is located in the HPLMN or subscribed SNPN.\nThe procedure is triggered if:\na) \tthe UDM supports obtaining SOR-SNPN-SI, if any, SOR-CMCI, if any, and SOR-SNPN-SI-LS, if any, from the SOR-AF, the subscribed SNPN or HPLMN policy for the SOR-AF invocation is present in the UDM, and the SOR-AF provides the UDM with:\n-\tthe SOR-SNPN-SI for a UE identified by SUPI if the ME supports SOR-SNPN-SI;\n-\tthe SOR-CMCI for a UE identified by SUPI if the ME supports SOR-CMCI; or\n-\tthe SOR-SNPN-SI-LS for a UE identified by SUPI if the ME supports SOR-SNPN-SI-LS; or\nNOTE 0:\tThe SOR-AF can determine that the ME supports SOR-SNPN-SI if the Nsoraf_SoR_Info service operation has returned the \"ME support of SOR-SNPN-SI\" indicator. The UDM determines that the ME supports SOR-SNPN-SI if the UDM stores \"ME support of SOR-SNPN-SI\" indicator.\nNOTE 1:\tThe SOR-AF can determine that the ME supports the SOR-CMCI if the Nsoraf_SoR_Info service operation has returned the \"ME support of SOR-CMCI\" indicator. How the SOR-AF determines that the USIM for the indicated SUPI supports SOR-CMCI is implementation specific.\nNOTE 1a:\tThe SOR-AF can determine that the ME supports SOR-SNPN-SI-LS if the Nsoraf_SoR_Info service operation has returned the \"ME support of SOR-SNPN-SI-LS\" indicator. The UDM determines that the ME supports SOR-SNPN-SI-LS.\nb) \ta SOR-SNPN-SI (if supported by ME), a SOR-CMCI (if supported by ME), or a SOR-SNPN-SI-LS (if supported by ME) becomes available in the UDM (i.e. retrieved from the UDR).\nNOTE 2:\tBefore providing the UDM with SOR-SNPN-SI for a UE identified by SUPI, the SOR-AF, based on subscribed SNPN or HPLMN policies or criteria, can obtain the user location information by triggering the unified location service exposure procedure as defined in 3GPP TS 23.273 [70] clause 6.5, or additionally based on implementation specific criteria, by requesting the UE location information from other application function using implementation specific method. This user location information can then be used in the SOR-AF algorithms.\nNOTE 3:\tBefore providing the UDM with a new SOR-SNPN-SI for a UE identified by SUPI, the SOR-AF, based on subscribed SNPN or HPLMN policies or criteria, can obtain the user location information by triggering the unified location service exposure procedure as defined in 3GPP TS 23.273 [70] clause 6.5, or additionally based on implementation specific criteria, by requesting the UE location information from other application function using implementation specific method. This user location information can then be used in the SOR-AF algorithms.\n\nFigure C.6.1 illustrates the step-by-step procedure for providing SOR-SNPN-SI and SOR-SNPN-SI-LS after registration in a telecommunication system. The figure outlines the process, which begins with the registration of the service request, followed by the activation of the service. The activation process involves the allocation of resources, such as spectrum and network elements, to ensure the successful provision of the service. The figure also highlights the importance of coordination between different network entities, including the service provider, network elements, and regulatory bodies, to ensure the smooth and efficient delivery of the service. The figure serves as a useful reference for service providers and regulatory bodies to understand the process of providing SOR-SNPN-SI and SOR-SNPN-SI-LS services after registration.\nFigure C.6.1: Procedure for providing SOR-SNPN-SI (if any) and SOR-SNPN-SI-LS (if any) after registration\nFor the steps below, security protection is described in 3GPP TS 33.501 [66].\n1)\tThe SOR-AF to the UDM: Nudm_ParameterProvision_Update request is sent to the UDM to trigger the update of the UE with the SOR-SNPN-SI,if any, the SOR-CMCI, if any, the \"Store the SOR-CMCI in the ME\" indicator, if any, and the SOR-SNPN-SI-LS, if any, for a UE identified by SUPI.\n2)\tThe UDM to the AMF: The UDM notifies the changes of the user profile to the affected AMF by the means of invoking Nudm_SDM_Notification service operation. The Nudm_SDM_Notification service operation contains the steering of roaming information that needs to be delivered transparently to the UE over NAS within the Access and Mobility Subscription data. If the subscribed SNPN or HPLMN decided that the UE is to acknowledge successful security check of the received steering of roaming information, the Nudm_SDM_Notification service operation also contains an indication that the UDM requests an acknowledgement from the UE as part of the steering of roaming information. If the SOR-SNPN-SI was obtained, the UDM shall include the SOR-SNPN-SI in to the SOR information. If the SOR-CMCI was obtained, the UDM shall include the SOR-CMCI into the steering of roaming information and shall requests an acknowledgement from the UE as part of the steering of roaming information. If the \"Store the SOR-CMCI in the ME\" indicator was obtained, the UDM shall include the \"Store the SOR-CMCI in the ME\" indicator If the SOR-SNPN-SI-LS was obtained, the UDM shall include the SOR-SNPN-SI-LS into the SOR information;\nNOTE 4:\tThe UDM cannot provide the SOR-SNPN-SI SOR-CMCI, or SOR-SNPN-SI-LS to the AMF which does not support receiving SOR transparent container (see 3GPP TS 29.503 [78]).\n3)\tThe AMF to the UE: the AMF sends a DL NAS TRANSPORT message to the served UE. The AMF includes in the DL NAS TRANSPORT message the steering of roaming information received from the UDM.\n4)\tUpon receiving the steering of roaming information, the UE shall perform a security check on the steering of roaming information included in the DL NAS TRANSPORT message to verify that the steering of roaming information is provided by the subscribed SNPN or HPLMN, and\ni)\tif the security check is successful, then:\na)\tif the steering of roaming information contains the SOR-SNPN-SI, the ME shall replace the credentials holder controlled prioritized list of preferred SNPNs for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription with the received credentials holder controlled prioritized list of preferred SNPNs, if any, the ME shall replace the credentials holder controlled prioritized list of GINs for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription with the received credentials holder controlled prioritized list of GINs, if any, and the ME shall delete the SNPNs identified by the credentials holder controlled prioritized list of preferred SNPNs or the SNPN(s) stored along with GIN(s) identified by the credentials holder controlled prioritized list of GINs from the list of \"temporarily forbidden SNPNs\" and the list of \"permanently forbidden SNPNs\", if they are present in these lists. If the SOR information contains the SOR-SNPN-SI-LS, the ME shall replace the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription with the received \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\", if any, and the ME shall replace the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription with the received \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\", if any, and delete the SNPNs identified by the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" or the SNPN(s) stored along with GIN(s) identified by the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" from the list of \"temporarily forbidden SNPNs for access for localized services in SNPN\" and the list of \"permanently forbidden SNPNs for access for localized services in SNPN\", if they are present in these lists;\nb)\tif the UDM has requested an acknowledgement from the UE in the DL NAS TRANSPORT message, the UE sends an UL NAS TRANSPORT message to the serving AMF with an SOR transparent container including the UE acknowledgement and the UE shall set:\n-\tthe \"ME support of SOR-CMCI\" indicator to \"supported\"; and\n-\tthe \"ME support of SOR-SNPN-SI-LS\" indicator to \"supported\" if the UE supports access to an SNPN providing access for localized services in SNPN.\nc)\tif the UE is in automatic network selection mode, the selected SNPN is a non-subscribed SNPN and the UE decides to perform SNPN selection, then:\n-\tif the UE is configured with the SOR-CMCI or received the SOR-CMCI over N1 NAS signalling, the UE shall apply the actions in clause C.4; or\n-\tthe UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority SNPN as specified in clause 4.9.3.\nd)\tif the selected SNPN is a non-subscribed SNPN and the UE has an established emergency PDU session then the UE may attempt to perform the SNPN selection subsequently after the emergency PDU session is released, if the UE is in automatic network selection mode.\ne)\tif the UDM has not requested an acknowledgement from the UE, then steps 4 is skipped; and\nii)the security check is not successful:\na)\tstep 5 is skipped; and\nb)\tif the selected SNPN is a non-subscribed SNPN and the UE is in automatic network selection mode, then:\nA)\tif the UE has a stored SOR-CMCI, then:\n-\tif there are ongoing PDU sessions or services, the UE shall apply the actions in clause C.4.2, and the current SNPN is considered as lowest priority; or\n-\tif there are no ongoing PDU sessions or services, the UE shall release the current N1 NAS signalling connection locally and attempt to obtain service on a higher priority SNPN as specified in clause 4.9.3, with an exception that the current SNPN is considered as lowest priority;\nB)\tif the UE does not have a stored SOR-CMCI, then:\n-\tif there are ongoing PDU sessions or services, the UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority SNPN as specified in clause 4.9.3, with an exception that the current SNPN is considered as lowest priority. If the selected SNPN is a non-subscribed SNPN and the UE has an established emergency PDU session, then the UE shall attempt to perform the SNPN selection after the emergency PDU session is released; or\n-\tif there are no ongoing PDU sessions or services, the UE shall release the current N1 NAS signalling connection locally and attempt to obtain service on a higher priority SNPN as specified in clause 4.9.3, with an exception that the current SNPN is considered as lowest priority.\nNOTE 5:\tWhen the UE is in the manual mode of operation and the current chosen non-subscribed SNPN is part of the user controlled prioritized list of preferred SNPNs, the UE stays on the current chosen non-subscribed SNPN.\n5)\tThe AMF to the UDM: If the UL NAS TRANSPORT message with an SOR transparent container is received, the AMF uses the Nudm_SDM_Info service operation to provide the received SOR transparent container to the UDM. If the subscribed SNPN or HPLMN decided that the UE is to acknowledge successful security check of the received steering of roaming information in step 1, the UDM verifies that the acknowledgement is provided by the UE. If:\n-\tthe \"ME support of SOR-CMCI\" indicator in the header of the SOR transparent container is set to \"supported\", then the UDM shall store the \"ME support of SOR-CMCI\" indicator, otherwise the UDM shall delete the stored \"ME support of SOR-CMCI\" indicator, if any; and\n-\tthe \"ME support of SOR-SNPN-SI-LS\" indicator in the header of the SOR transparent container is set to \"supported\", then the UDM shall store the \"ME support of SOR-SNPN-SI-LS\" indicator, otherwise the UDM shall delete the stored \"ME support of SOR-SNPN-SI-LS\" indicator, if any.\nIf the present flow was invoked by the UDM after receiving from the SOR-AF the SOR-SNPN-SI, if any, SOR-CMCI, if any, and SOR-SNPN-SI-LS, if any, for a UE identified by SUPI using an Nudm_ParameterProvision_Update request, and the UDM verification of the UE acknowledgement is successful, then the UDM informs the SOR-AF about successful delivery of the SOR-SNPN-SI,if any SOR-CMCI, if any, and SOR-SNPN-SI-LS, if any, using Nsoraf_SoR_Info (SUPI of the UE, successful delivery); and\n6)\tThe UDM to the SOR-AF: Nsoraf_SoR_Info (SUPI of the UE, successful delivery, \"ME support of SOR-CMCI\" indicator, if any, \"ME support of SOR-SNPN-SI-LS\" indicator, if any). If the subscribed SNPN or HPLMN policy for the SOR-AF invocation is present and the UDM received and verified the UE acknowledgement in step 5, then the UDM informs the SOR-AF about successful delivery of the SOR-SNPN-SI, if any, SOR-CMCI, if any, SOR-SNPN-SI-LS, if any, to the UE. If:\n-\tthe \"ME support of SOR-CMCI\" indicator is stored for the UE, the UDM shall include the \"ME support of SOR-CMCI\" indicator; and\n-\tthe \"ME support of SOR-SNPN-SI-LS\" indicator is stored for the UE, the UDM shall include the \"ME support of SOR-SNPN-SI-LS\" indicator.\nIf the selected SNPN is a non-subscribed SNPN and:\n-\tthe UE in manual mode of operation encounters security check failure of SOR information in DL NAS TRANSPORT message; and\n-\tupon switching to automatic network selection mode, the UE remembers that it is still registered on the where the security check failure of SOR information was encountered;\nthe UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority SNPN as specified in clause 4.9.3, with an exception that the current registered SNPN is considered as lowest priority. If the selected SNPN is a non-subscribed SNPN and the UE has an established emergency PDU session, then the UE shall attempt to perform the SNPN selection after the emergency PDU session is released.\nNOTE 6:\tThe receipt of the steering of roaming information by itself does not trigger the release of the emergency PDU session.\nNOTE 7:\tIf the selected SNPN is the subscribed SNPN, regardless of whether the UE is in automatic network selection mode or manual network selection mode, regardless of whether the UE has an established emergency PDU session or not, and regardless of whether the security check is successful or not successful, the UE is not required to perform the SNPN selection.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "C.7\tStage-2 flow for providing UE with SOR-SNPN-SI or SOR-SNPN-SI-LS in HPLMN or VPLMN after registration",
            "description": "The stage-2 flow for providing UE with SOR-SNPN-SI or SOR-SNPN-SI-LS in HPLMN or VPLMN after registration is indicated in figure C.7.1, when the ME and the HPLMN support the SOR-SNPN-SI or SOR-SNPN-SI-LS, respectively. The selected PLMN can be the HPLMN or a VPLMN. The AMF is located in the selected PLMN. The UDM is located in the HPLMN.\nIn this procedure, the SOR-SNPN-SI or SOR-SNPN-SI-LS is sent without the list of preferred PLMN/access technology combinations.\nNOTE 1:\tThe SOR-AF can determine that the ME supports the SOR-SNPN-SI or SOR-SNPN-SI-LS if the Nsoraf_SoR_Info service operation has returned the \"ME support of SOR-SNPN-SI\" indicator or \"ME support of SOR-SNPN-SI-LS\" indicator, respectively. The UDM can determine that the ME supports the SOR-SNPN-SI or SOR-SNPN-SI-LS if the \"ME support of SOR-SNPN-SI\" indicator or \"ME support of SOR-SNPN-SI-LS\" indicator, respectively, is stored for the UE.\nThe procedure is triggered if:\na) the UDM supports obtaining the SOR-SNPN-SI or SOR-SNPN-SI-LS from the SOR-AF, the HPLMN policy for the SOR-AF invocation is present in the UDM, and the SOR-AF provides the UDM with the SOR-SNPN-SI or the SOR-SNPN-SI-LS for a UE identified by SUPI; or\nb) the SOR-SNPN-SI or the SOR-SNPN-SI-LS becomes available in the UDM (i.e., retrieved from the UDR).\n\nFigure C.7.1 illustrates the step-by-step procedure for configuring a User Equipment (UE) with Supplementary Optical Network (SOR) - Single Network Per Tenor (SNPN) - Single Implantation (SI) or SOR-SNPN-SI-LS in a Public Land Mobile Network (PLMN) after successful registration. The figure outlines the process, starting with the UE's initial configuration and network registration, followed by the establishment of the SOR-SNPN-SI or SOR-SNPN-SI-LS link, and finally, the UE's connection to the PLMN. Key components include the UE, SOR, SNPN, SI, and PLMN, with the process facilitated by the network operator and the UE's interaction with the network. The figure emphasizes the importance of accurate configuration and network synchronization for seamless communication and service delivery.\nFigure C.7.1: Procedure for configuring UE with SOR-SNPN-SI or SOR-SNPN-SI-LS in a PLMN after registration\nFor the steps below, security protection is described in 3GPP TS 33.501 [66].\n1)\tThe SOR-AF to the UDM: Nudm_ParameterProvision_Update request is sent to the UDM to trigger the update of the UE with the SOR-SNPN-SI or SOR-SNPN-SI-LS.\n2)\tThe UDM to the AMF: The UDM notifies the changes of the user profile to the affected AMF by the means of invoking Nudm_SDM_Notification service operation. The Nudm_SDM_Notification service operation contains the steering of roaming information that needs to be delivered transparently to the UE over NAS within the Access and Mobility Subscription data. If the HPLMN or subscribed SNPN decided that the UE is to acknowledge successful security check of the received steering of roaming information, the Nudm_SDM_Notification service operation also contains an indication that the UDM requests an acknowledgement from the UE as part of the steering of roaming information. Upon receiving the SOR-SNPN-SI or the SOR-SNPN-SI-LS, the UDM shall include the SOR-SNPN-SI (if any), SOR-SNPN-SI-LS (if any), and the HPLMN indication that 'no change of the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the UE is needed and thus no list of preferred PLMN/access technology combinations is provided'.\nNOTE 2:\tThe UDM cannot provide the SOR-SNPN-SI, or the SOR-SNPN-SI-LS to the AMF which does not support receiving SoR transparent container (see 3GPP TS 29.503 [78]).\n3)\tThe AMF to the UE: the AMF sends a DL NAS TRANSPORT message to the served UE. The AMF includes in the DL NAS TRANSPORT message the steering of roaming information received from the UDM.\n4)\tUpon receiving the steering of roaming information containing the SOR-SNPN-SI (if any), the SOR-SNPN-SI-LS (if any), and the HPLMN indication that 'no change of the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the UE is needed and thus no list of preferred PLMN/access technology combinations is provided', the UE shall perform a security check on the steering of roaming information included in the DL NAS TRANSPORT message to verify that the steering of roaming information is provided by HPLMN, and:\na)\tif the security check is successful, then:\n-\tthe ME shall replace the credentials holder controlled prioritized list of preferred SNPNs for the selected PLMN subscription with the received credentials holder controlled prioritized list of preferred SNPNs, if any, the ME shall replace the credentials holder controlled prioritized list of GINs for the selected PLMN subscription with the received credentials holder controlled prioritized list of GINs, if any, and the ME shall delete the SNPNs identified by the credentials holder controlled prioritized list of preferred SNPNs or the SNPN(s) stored along with GIN(s) identified by the credentials holder controlled prioritized list of GINs from the list of \"temporarily forbidden SNPNs\" and the list of \"permanently forbidden SNPNs\", if they are present in these lists: and\n-\tthe ME shall replace the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" for the selected PLMN subscription with the received \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\", if any, the ME shall replace the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" for the selected PLMN subscription with the received \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\", if any, and the ME shall delete the SNPNs identified by the \"credentials holder controlled prioritized list of preferred SNPNs for access for localized services in SNPN\" or the SNPN(s) stored along with GIN(s) identified by the \"credentials holder controlled prioritized list of preferred GINs for access for localized services in SNPN\" from the list of \"temporarily forbidden SNPNs for access for localized services in SNPN\" and the list of \"permanently forbidden SNPNs for access for localized services in SNPN\", if they are present in these lists.\nIf the UDM has requested an acknowledgement from the UE in the DL NAS TRANSPORT message, the UE sends an UL NAS TRANSPORT message to the serving AMF with an SOR transparent container including the UE acknowledgement and the UE shall set:\n-\tthe \"ME support of SOR-SNPN-SI\" indicator to \"supported\"; and\n-\tthe \"ME support of SOR-SNPN-SI-LS\" indicator to \"supported\" if the UE supports access to an SNPN providing access for localized services in SNPN.\nIf the UDM has not requested an acknowledgement from the UE then step 5 is skipped; and\nb)\tif the selected PLMN is a VPLMN, the security check is not successful and the UE is in automatic network, then\n-\tif the UE has a stored SOR-CMCI, then:\n-\tif there are ongoing PDU sessions or services, the current PLMN is considered as lowest priority and the UE shall apply the actions in clause C.4.2;\n-\tif there are no ongoing PDU sessions or services, the UE shall release the current N1 NAS signalling connection locally and attempt to obtain service on a higher priority PLMN as specified in clause 4.9.3, with an exception that the current PLMN is considered as lowest priority;\n-\tif the UE does not have a SOR-CMCI stored in the non-volatile memory of the ME, then:\n-\tif there are ongoing PDU sessions or services, the UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority PLMN as specified in clause 4.4.3.3 by acting as if timer T that controls periodic attempts has expired, with an exception that the current PLMN is considered as lowest priority. If the selected PLMN is a VPLMN and the UE has an established emergency PDU session then the UE shall attempt to perform the PLMN selection after the emergency PDU session is released and after the UE enters idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]); or\n-\tif there are no ongoing PDU sessions or services, the UE shall release the current N1 NAS signalling connection locally and attempt to obtain service on a higher priority PLMN as specified in clause 4.9.3, with an exception that the current PLMN is considered as lowest priority.\nStep 5 is skipped;\nNOTE 3:\tWhen the UE is in the manual mode of operation or the current chosen VPLMN is part of the \"User Controlled PLMN Selector with Access Technology\" list, the UE stays on the VPLMN.\n5)\tThe AMF to the UDM: If the UL NAS TRANSPORT message with an SOR transparent container is received, the AMF uses the Nudm_SDM_Info service operation to provide the received SOR transparent container to the UDM. If the HPLMN decided that the UE is to acknowledge successful security check of the received steering of roaming information in step 2, the UDM verifies that the acknowledgement is provided by the UE. The UDM shall store the \"ME support of SOR-SNPN-SI\" indicator. If the \"ME support of SOR-SNPN-SI-LS\" indicator in the header of the SOR transparent container is set to \"supported\", then the UDM shall store the \"ME support of SOR-SNPN-SI-LS\" indicator, otherwise the UDM shall delete the stored \"ME support of SOR-SNPN-SI-LS\" indicator, if any.\nIf the present flow was invoked by the UDM after receiving from the SOR-AF the SOR-SNPN-SI or the SOR-SNPN-SI-LS for a UE identified by SUPI using an Nudm_ParameterProvision_Update request, and the UDM verification of the UE acknowledgement is successful, then the UDM informs the SOR-AF about successful delivery of the SOR-SNPN-SI or the SOR-SNPN-SI-LS using Nsoraf_SoR_Info (SUPI of the UE, successful delivery); and\n6)\tThe UDM to the SOR-AF: Nsoraf_SoR_Info (SUPI of the UE, successful delivery, \"ME support of SOR-SNPN-SI\" indicator, \"ME support of SOR-SNPN-SI-LS\" indicator, if any). If the HPLMN policy for the SOR-AF invocation is present and the HPLMN UDM received and verified the UE acknowledgement in step 5, then the UDM informs the SOR-AF about successful delivery of the SOR-SNPN-SI or the SOR-SNPN-SI-LS to the UE. The UDM shall include the \"ME support of SOR-SNPN-SI\" indicator. If the \"ME support of SOR-SNPN-SI-LS\" indicator is stored for the UE, the UDM shall include the \"ME support of SOR-SNPN-SI-LS\" indicator.\nIf the selected PLMN is a VPLMN and:\n-\tthe UE in manual mode of operation encounters security check failure of SOR information in DL NAS TRANSPORT message; and\n-\tupon switching to automatic network selection mode the UE remembers that it is still registered on the PLMN where the security check failure of SOR information was encountered;\nthe UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority PLMN as specified in clause 4.4.3.3, by acting as if timer T that controls periodic attempts has expired, with an exception that the current registered PLMN is considered as lowest priority. If the selected PLMN is a VPLMN and the UE has an established emergency PDU session then the UE shall attempt to perform the PLMN selection after the emergency PDU session is released and after the UE enters idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]).\nNOTE 4:\tThe receipt of the steering of roaming information by itself does not trigger the release of the emergency PDU session.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "C.8\tStage-2 flow for providing UE with list of preferred PLMN/access technology combinations in SNPN after registration",
            "description": "The stage-2 flow for providing UE with the list of preferred PLMN/access technology combinations in an SNPN after registration is indicated in figure C.8.1. The selected SNPN is a non-subscribed SNPN. The AMF is located in the selected SNPN. The UDM is located in the HPLMN.\nIn this procedure, the list of preferred PLMN/access technology combinations is sent in plain text or sent within the secured packet, without the SOR-SNPN-SI.\nBased on HPLMN policy, if the HPLMN supports sending the list of preferred PLMN/access technology combinations in plain text or secured packet to the UE when the UE is registered to an SNPN, then the procedure is triggered:\n-\tIf the UDM supports obtaining a list of preferred PLMN/access technology combinations or a secured packet from the SOR-AF, the HPLMN policy for the SOR-AF invocation is present in the UDM and the SOR-AF provides the UDM with a new list of preferred PLMN/access technology combinations or a secured packet for a UE identified by SUPI; or\n-\tWhen a new list of preferred PLMN/access technology combinations or a secured packet becomes available in the UDM (i.e., retrieved from the UDR).\n\nFigure C.8.1: Procedure for configuring UE with list of preferred PLMN/access technology combinations in an SNPN after registration\nFor the steps below, security protection is described in 3GPP TS 33.501 [66].\n1)\tThe SOR-AF to the UDM: Nudm_ParameterProvision_Update request is sent to the UDM to trigger the update of the UE with the new list of preferred PLMN/access technology combinations or a secured packet for a UE identified by SUPI.\n2)\tThe UDM to the AMF: The UDM notifies the changes of the user profile to the affected AMF by the means of invoking Nudm_SDM_Notification service operation. The Nudm_SDM_Notification service operation contains the steering of roaming information that needs to be delivered transparently to the UE over NAS within the Access and Mobility Subscription data. If the HPLMN or subscribed SNPN decided that the UE is to acknowledge successful security check of the received steering of roaming information, the Nudm_SDM_Notification service operation also contains an indication that the UDM requests an acknowledgement from the UE as part of the steering of roaming information.\n3)\tThe AMF to the UE: the AMF sends a DL NAS TRANSPORT message to the served UE. The AMF includes in the DL NAS TRANSPORT message the steering of roaming information received from the UDM.\n4)\tUpon receiving the steering of roaming information, the UE shall perform a security check on the steering of roaming information included in the DL NAS TRANSPORT message to verify that the steering of roaming information is provided by HPLMN, and:\na)\tif the security check is successful:\n-\tif the steering of roaming information contains a secured packet (see 3GPP TS 31.115 [67]) and the service \"data download via SMS Point-to-point\" is allocated and activated in the USIM Service Table (see 3GPP TS 31.102 [40]), the ME shall upload the secured packet to the USIM using procedures in 3GPP TS 31.111 [41]; and\n-\tif the steering of roaming information contains the list of preferred PLMN/access technology combinations, the ME shall replace the highest priority entries in the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the ME with the received list of preferred PLMN/access technology combinations, and delete the PLMNs identified by the list of preferred PLMN/access technology combinations from the Forbidden PLMN list and from the Forbidden PLMNs for GPRS service list, if they are present in these lists.\nIf the UDM has requested an acknowledgement from the UE in the DL NAS TRANSPORT message, the UE sends an UL NAS TRANSPORT message to the serving AMF with an SOR transparent container including the UE acknowledgement and the UE shall set the \"ME support of SOR-SNPN-SI\" indicator to \"supported\".\nIf the UDM has not requested an acknowledgement from the UE then step 5 is skipped; and\nb)\tif the security check is not successful and the UE is in automatic network selection mode, then:\n-\tif the UE has a stored SOR-CMCI, then:\n-\tif there are ongoing PDU sessions or services, the current SNPN is considered as lowest priority and the UE shall apply the actions in clause C.4.2;\n-\tif there are no ongoing PDU sessions or services, the UE shall release the current N1 NAS signalling connection locally and attempt to obtain service on a higher priority SNPN as specified in clause 4.9.3, with an exception that the current SNPN is considered as lowest priority;\n-\tif the UE does not have a SOR-CMCI stored in the non-volatile memory of the ME, then:\n-\tif there are ongoing PDU sessions or services, the UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority SNPN as specified in clause 4.9.3, with an exception that the current SNPN is considered as lowest priority. If the UE has an established emergency PDU session then the UE shall attempt to perform the SNPN selection after the emergency PDU session is released and after the UE enters idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]); or\n-\tif there are no ongoing PDU sessions or services, the UE shall release the current N1 NAS signalling connection locally and attempt to obtain service on a higher priority SNPN as specified in clause 4.9.3, with an exception that the current SNPN is considered as lowest priority.\nStep 5 is skipped;\nNOTE 1:\tWhen the UE is in the manual mode of operation or the current chosen non-subscribed SNPN is part of the user controlled prioritized list of preferred SNPNs, the UE stays on current chosen non-subscribed SNPN.\n5)\tThe AMF to the UDM: If the UL NAS TRANSPORT message with an SOR transparent container is received, the AMF uses the Nudm_SDM_Info service operation to provide the received SOR transparent container to the UDM. If the HPLMN decided that the UE is to acknowledge successful security check of the received steering of roaming information in step 2, the UDM verifies that the acknowledgement is provided by the UE. The UDM shall store the \"ME support of SOR-SNPN-SI\" indicator.\nIf the present flow was invoked by the UDM after receiving from the SOR-AF a list of preferred PLMN/access technology combinations or a secured packet for a UE identified by SUPI using an Nudm_ParameterProvision_Update request, and the UDM verification of the UE acknowledgement is successful, then the UDM informs the SOR-AF about successful delivery of the steering of roaming information using Nsoraf_SoR_Info (SUPI of the UE, successful delivery); and\n6)\tThe UDM to the SOR-AF: Nsoraf_SoR_Info (SUPI of the UE, successful delivery, \"ME support of SOR-SNPN-SI\" indicator). If the HPLMN policy for the SOR-AF invocation is present and the HPLMN UDM received and verified the UE acknowledgement in step 5, then the UDM informs the SOR-AF about successful delivery of the steering of roaming information to the UE. The UDM shall include the \"ME support of SOR-SNPN-SI\" indicator.\nIf:\n-\tthe UE in manual mode of operation encounters security check failure of SOR information in DL NAS TRANSPORT message; and\n-\tupon switching to automatic network selection mode the UE remembers that it is still registered on non-subscribed SNPN where the security check failure of SOR information was encountered;\nthe UE shall wait until it moves to idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]) before attempting to obtain service on a higher priority SNPN as specified in clause 4.9.3, with an exception that the current registered SNPN is considered as lowest priority. If the UE has an established emergency PDU session then the UE shall attempt to perform the SNPN selection after the emergency PDU session is released and after the UE enters idle mode or 5GMM-CONNECTED mode with RRC inactive indication (see 3GPP TS 24.501 [64]).\nNOTE 2:\tThe receipt of the steering of roaming information by itself does not trigger the release of the emergency PDU session.\n\n\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "",
                    "table number": 5,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "",
                    "table number": 6,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        }
    ]
}