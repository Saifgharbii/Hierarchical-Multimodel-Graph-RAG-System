{
    "document_name": "24282-i50.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\tindicates that something is possible\ncannot\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document specifies the signalling control protocols needed to support Mission Critical Data (MCData) communications as specified by 3GPP TS 23.282 [2]. The present document specifies both on-network and off-network protocols.\nThe present document utilises the common functional architecture to support mission critical services as specified in 3GPP TS 23.280 [3], in support of MCData communications.\nThe MCData service can be used for public safety applications and also for general commercial applications e.g. utility companies and railways.\nThe present document is applicable to User Equipment (UE) supporting the MCData client functionality, and to application servers supporting the MCData server functionality.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.282: \"Functional architecture and information flows to support Mission Critical Data (MCData); Stage 2\".\n[3]\t3GPP TS 23.280:\" Common functional architecture to support mission critical services; Stage 2\".\n[4]\tIETF RFC 3261 (June 2002): \"SIP: Session Initiation Protocol\".\n[5]\t3GPP TS 24.229: \"IP multimedia call control protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".\n[6]\tIETF RFC 3428 (December 2002): \"Session Initiation Protocol (SIP) Extension for Instant Messaging\".\n[7]\tIETF RFC 6050 (November 2010): \"A Session Initiation Protocol (SIP) Extension for the Identification of Services\".\n[8]\tIETF RFC 3841 (August 2004): \"Caller Preferences for the Session Initiation Protocol (SIP)\".\n[9]\tIETF RFC 4826 (May 2007): \"Extensible Markup Language (XML) Formats for Representing Resource Lists\".\n[10]\t3GPP TS 24.379: \"Mission Critical Push To Talk (MCPTT) call control Protocol specification\".\n[11]\t3GPP TS 24.481: \"Mission Critical Services (MCS) group management Protocol specification\".\n[12]\t3GPP TS 24.484: \"Mission Critical Services (MCS) configuration management Protocol specification\".\n[13]\tIETF RFC 4483 (May 2006): \"A Mechanism for Content Indirection in Session Initiation Protocol (SIP) Messages.\n[14]\tIETF RFC 4122 (July 2005): \"A Universally Unique IDentifier (UUID) URN Namespace\".\n[15]\t3GPP TS 24.582: \"Mission Critical Data (MCData) media plane control Protocol specification\".\n[16]\tIETF RFC 3840 (August 2004): \"Indicating User Agent Capabilities in the Session Initiation Protocol (SIP)\".\n[17]\tIETF RFC 4975 (September 2007): \"The Message Session Relay Protocol (MSRP)\".\n[18]\tIETF RFC 5366 (October 2008): \"Conference Establishment Using Request-Contained Lists in the Session Initiation Protocol (SIP)\".\n[19]\tIETF RFC 6135 (February 2011): \"An Alternative Connection Model for the Message Session Relay Protocol (MSRP) \".\n[20]\tIETF RFC 6714 (August 2012): \"Connection Establishment for Media Anchoring (CEMA) for the Message Session Relay Protocol (MSRP)\".\n[21]\tIETF RFC 6086 (January 2011): \"Session Initiation Protocol (SIP) INFO Method and Package Framework\".\n[22]\tIETF RFC 7230: \"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing\".\n[23]\tIETF RFC 7231: \"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content\".\n[24]\t3GPP TS 24.482: \"Mission Critical Services (MCS) identity management Protocol specification.\n[25]\t3GPP TS 24.334: \"Proximity-services (ProSe) User Equipment (UE) to Proximity-services (ProSe) Function Protocol aspects; Stage 3\".\n[26]\t3GPP TS 33.180: \"Security of the Mission Critical Service\".\n[27]\tVoid.\n[28]\tW3C: \"XML Encryption Syntax and Processing Version 1.1\", .\n[29]\tW3C: \"XML Signature Syntax and Processing (Second Edition)\", .\n[30]\tIETF RFC 4648 (October 2006): \"The Base16, Base32, and Base64 Data Encodings\".\n[31]\t3GPP TS 23.003: \"Numbering, addressing and identification\".\n[32]\tIETF RFC 2045 (November 1996): \"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies\".\n[33]\tIETF RFC 2392 (August 1998): \"Content-ID and Message-ID Uniform Resource Locators\".\n[34]\tIETF RFC 3903 (October 2004): \"Session Initiation Protocol (SIP) Extension for Event State Publication\".\n[35]\tIETF RFC 4354 (January 2006): \"A Session Initiation Protocol (SIP) Event Package and Data Format for Various Settings in Support for the Push-to-Talk over Cellular (PoC) Service\".\n[36]\tIETF RFC 6665 (July 2012): \"SIP-Specific Event Notification\".\n[37]\t3GPP TS 29.283: \"Diameter Data Management Applications\".\n[38]\tIETF RFC 4028 (April 2005): \"Session Timers in the Session Initiation Protocol (SIP)\".\n[39]\tIETF RFC 3856 (August 2004): \"A Presence Event Package for the Session Initiation Protocol (SIP)\".\n[40]\tIETF RFC 3863 (August 2004): \"Presence Information Data Format (PIDF)\".\n[41]\tIETF RFC 4661 (September 2006): \"An Extensible Markup Language (XML)-Based Format for Event Notification Filtering\".\n[42]\t3GPP TS 24.483: \"Mission Critical Services (MCS) Management Object (MO)\".\n[43]\t3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet System (EPS); Stage 3\".\n[44]\tIETF RFC 5627 (October 2009): \"Obtaining and Using Globally Routable User Agent URIs (GRUUs) in the Session Initiation Protocol (SIP)\".\n[45]\tIETF RFC 4567 (July 2006): \"Key Management Extensions for Session Description Protocol (SDP) and Real Time Streaming Protocol (RTSP)\".\n[46]\tIETF RFC 3986 (January 2005): \"Uniform Resource Identifier (URI): Generic Syntax\".\n[47]\t3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".\n[48]\t3GPP TS 29.582: \"Mission Critical Data (MCData) signalling control interworking with LMR systems; Protocol specification\".\n[49]\t3GPP TS 29.214: \"Policy and Charging Control over Rx reference point\".\n[50]\tVoid.\n[51]\tIETF RFC 3515 (April 2003): \"The Session Initiation Protocol (SIP) Refer Method\".\n[52]\tIETF RFC 7647 (September 2015): \"Clarifications for the use of REFER with RFC 6665\".\n[53]\tIETF RFC 4488 (May 2006): \"Suppression of Session Initiation Protocol (SIP) REFER Method Implicit Subscription\".\n[54]\tIETF RFC 4538 (June 2006): \"Request Authorization through Dialog Identification in the Session Initiation Protocol (SIP)\".\n[55]\tIETF RFC 6509 (February 2012): \"MIKEY-SAKKE: Sakai-Kasahara Key Encryption in Multimedia Internet KEYing (MIKEY)\".\n[56]\t3GPP TS 23.468: \"Group Communication System Enablers for LTE (GCSE_LTE); Stage 2\".\n[57]\t3GPP TS 29.468: \"Group Communication System Enablers for LTE (GCSE_LTE); MB2 reference point; Stage 3\".\n[58]\tVoid.\n[59]\tIETF RFC 5761 (April 2010): \"Multiplexing RTP Data and Control Packets on a Single Port\".\n[60]\tIETF RFC 5795 (March 2010): \"The RObust Header Compression (ROHC) Framework\".\n[61]\tIETF RFC 3095 (July 2001): \"RObust Header Compression (ROHC): Framework and four profiles: RTP, UDP, ESP, and uncompressed\".\n[62]\t3GPP TS 24.008: \"Mobile radio interface Layer 3 specification; Core network protocols; Stage 3\".\n[63]\t3GPP TS 23.203: \"Policy and charging control architecture\".\n[64]\t3GPP TS 29.061: \"Interworking between the Public Land Mobile Network (PLMN) supporting packet based services and Packet Data Networks (PDN)\".\n[65]\t3GPP TS 29.199-09: \"Open Service Access (OSA); Parlay X web services; Part 9: Terminal location\".\n[66]\tOMA-TS-REST_NetAPI_NMS-V1_0-20190528-C: \"RESTful Network API for Network Message Storage\".\n[67]\tIETF RFC 8101 (March 2017): \"IANA Registration of New Session Initiation Protocol (SIP) Resource-Priority Namespace for Mission Critical Push To Talk Service\".\n[68]\t3GPP TS 22.280: \"Mission Critical Services Common Requirements (MCCoRe); Stage 1\".\n[69]\tIETF RFC 5547: \"A Session Description Protocol (SDP) Offer/Answer Mechanism to Enable File Transfer\".\n[70]\tIETF RFC 1738: \"Uniform Resource Locators (URL)\".\n[71]\tIETF RFC 4566 (July 2006): \"SDP: Session Description Protocol\".\n[72]\tIETF RFC 5888 (June 2010): \"The Session Description Protocol (SDP) Grouping Framework\".\n[73]\tISO 8601 (2019):\t\"Date and Time – Representations for Information Exchange\".\n[74]\tIETF RFC 4412 (February 2006): \"Communications Resource Priority for the Session Initiation Protocol (SIP)\".\n[75]\tIETF RFC 5234 (January 2008): \"Augmented BNF for Syntax Specifications: ABNF\".\n[76]\tOMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C: \"RESTful Network API for Notification Channel\".\n[77]\tIETF RFC 8445 (July 2018): \"Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal\".\n[78]\tIETF RFC 8839 (January 2021): \"Session Description Protocol (SDP) Offer/Answer Procedures for Interactive Connectivity Establishment (ICE)\".\n[79]\t3GPP TS 29.501: \"5G System; Principles and Guidelines for Services Definition; Stage 3\".\n[80]\tIETF RFC 2017 (October 1996): \"Definition of the URL MIME External-Body Access-Type\".\n[81]\t3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS); Stage 3\".\n[82]\tIETF RFC 2046 (November 1996): \"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types\".\n[83]\tIETF RFC 5322 (October 2008): \"Internet Message Format\".\n[84]\t3GPP TS 23.247: \"Architectural enhancements for 5G multicast-broadcast services; Stage 2\".\n[85]\t3GPP TS 23.289: \"Mission Critical services over 5G System; Stage 2\".\n[86]\t3GPP TS 24.554: \"Proximity-services (ProSe) in 5G System (5GS) protocol aspects; Stage 3\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tDefinitions",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms and definitions given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].\nAn MCData user is affiliated to an MCData group: The MCData user has expressed interest in an MCData group it is a member of, and both the MCData server serving the MCData user and the MCData server owning the MCData group have authorized the MCData user's interest in the MCData group communication.\nAn MCData user is affiliated to an MCData group at an MCData client: The MCData user is affiliated to the MCData group, the MCData client has a registered IP address for an IMPU related to the MCData ID, and the MCData server serving the MCData user has authorised the MCData user's interest in the MCData group at the MCData client.\nAffiliation status: Applies for an MCData user to an MCData group and has one of the following states:\na)\tthe \"not-affiliated\" state indicating that the MCData user is not interested in the MCData group and the MCData user is not affiliated to the MCData group;\nb)\tthe \"affiliating\" state indicating that the MCData user is interested in the MCData group but the MCData user is not affiliated to the MCData group yet;\nc)\tthe \"affiliated\" state indicating that the MCData user is affiliated to the MCData group and there was no indication that MCData user is no longer interested in the MCData group; and\nd)\tthe \"deaffiliating\" state indicating that the MCData user is no longer interested in the MCData group but the MCData user is still affiliated to the MCData group.\nGroup document: when the group is not a regroup based on a preconfigured regroup, the term \"group document\" used within the present document refers to the group document for that group within the GMS as specified in 3GPP TS 24.481 [11]; when the group is a regroup based on a preconfigured group, the term \"group document\" used within the present document refers to the group document for the preconfigured group as specified in 3GPP TS 24.481 [11] restricted to the users or groups included in the regroup stored by the MCData server at the time of the regroup creation, see clause 23.\nGroup identity: An MCData group identity or a temporary MCData group identity.\nIn-progress emergency private communication state: the state of two participants when an MCData emergency one-to-one communication is in progress.\nIn-progress imminent peril group state: the state of a group when an MCData imminent peril group communication is in progress.\nMCData client ID: is a globally unique identification of a specific MCData client instance. MCData client ID is a UUID URN as specified in IETF RFC 4122 [14].\nMCData emergency alert: A notification from the MCData client to the MCData service that the MCData user has an emergency condition.\nMCData emergency alert state: MCData client internal perspective of the state of an MCData emergency alert.\nMCData emergency group state: MCData client internal perspective of the in-progress emergency state of an MCData group maintained by the controlling MCData function.\nMCData emergency group communication: An urgent MCData group communication that highlights a situation of potential death or serious injury.\nMCData emergency group communication state: MCData client internal perspective of the state of an MCData emergency group communication.\nMCData emergency state: MCData client internal perspective of the state of an MCData emergency associated with an alert, group communication or one-to-one (private) communication.\nMCData emergency private communication state: MCData client internal perspective of the state of an MCData emergency one-to-one communication, initiated with emergency indication, or without emergency indication, when the MCData emergency state is already set.\nMCData emergency private priority state: MCData client internal perspective of the in-progress emergency private communication state of the two participants of an MCData emergency one-to-one communication maintained by the controlling MCData function.\nMCData imminent peril group communication state: MCData client internal perspective of the state of an MCData imminent peril group communication.\nMCData imminent peril group state: MCData client internal perspective of the state of an MCData imminent peril group.\nMCData private emergency alert state: MCData client internal perspective of the state of an MCData private one-to-one emergency alert targeted to an MCData user.\nFunctional alias status: Applies for the status of a functional alias for an MCData user and has one of the following states:\na)\tthe \"not-activated\" state indicating that the MCData user has not activated the functional alias;\nb)\tthe \"activating\" state indicating that the MCData user is interested in using the functional alias but the functional alias is not yet activated for the MCData user;\nc)\tthe \"activated\" state indicating that the MCData user has activated the functional alias;\nd)\tthe \"deactivating\" state indicating that the MCData user is no longer interested in using the functional alias but the functional alias is still activated for the MCData user; and\ne)\tthe \"take-over-possible\" state indicating that the MCData user is interested in using the functional alias but the functional alias is already activated and used by another MCData user.\nUser Requested Application Priority: The requested priority as defined in 3GPP TS 23.280 [3]. How the server determines the priority for the requested communication based on requested priority and in combination with other factors is up to MCData server implementation.\nFor the purpose of the present document, the following terms and definitions given in 3GPP TS 33.180 [26] apply:\nClient Server Key (CSK)\nMulticast Signalling Key (MuSiK)\nMulticast Signalling Key Identifier (MuSiK-ID)\nMBMS subchannel control key (MSCCK)\nMBMS subchannel control key identifier (MSCCK-ID)\nPrivate Call Key (PCK)\nSignalling Protection Key (SPK)\nXML Protection Key (XPK)\nFor the purpose of the present document, the following terms and definitions given in 3GPP TS 22.280 [68] apply:\nFunctional alias\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\nCSK\tClient-Server Key\nIMPU\tP Multimedia Public User identity\nIPEG\tIn-Progress Emergency Group\nIPEPC\tIn-Progress Emergency Private Call\nIPIG\tIn-Progress Imminent peril Group\nMBMS\tMultimedia Broadcast and Multicast Service\nMBS\tMulticast/Broadcast Service\nMC\tMission Critical\nMCS\tMission Critical Service\nMCData\tMission Critical Data\nMCData group ID\tMCData group Identity\nMDEA\tMCData Emergency Alert\nMDEG\tMCData Emergency Group\nMDEGC\tMCData Emergency Group Communication\nMDEPC\tMCData Emergency Private (one-to-one) Communication\nMDEPP\tMCData Emergency Private (one-to-one) Priority\nMDES\tMCData Emergency State\nMDIG\tMCData Imminent peril Group\nMDIGC\tMCData Imminent peril Group Communication\nMDPEA\tMCData Private (one-to-one) Emergency Alert\nMIME\tMultipurpose Internet Mail Extensions\nMONP\tMCPTT Off-Network Protocol\nQCI\tQoS Class Identifier\nRTP\tReal-time Transport Protocol\nSAI\tService Area Identifier\nSDP\tSession Description Protocol\nSIP\tSession Initiation Protocol\nSPK\tSignalling Protection Key\nURI\tUniform Resource Identifier\nURN\tUniform Resource Name\nUUID\tUniversally Unique IDentifier\nXPK\tXML Protection Key\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tGeneral",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tMCData overview",
                    "description": "",
                    "summary": "",
                    "text_content": "The MCData service supports communication between a pair of users (i.e. one-to-one communication) and several users (i.e. group communication), where each user has the ability to:\n-\tshare data using Short Data Service (SDS);\n-\tshare files using File Distribution (FD) service; and\n-\texchange Data using IP Connectivity service.\nSDS is provided in both, on-network and off-network while FD and IP Connectivity is provided only in on-network in this release of the present document.\nThe present document provides the signalling control protocol enhancements to support the MCData architectural procedures specified in 3GPP TS 23.282 [2].\nFor on-network communications, the present document makes use of the existing IMS procedures specified in 3GPP TS 24.229 [5].\nThe on-network procedures in this document allow an MCData user to:\n-\tsend a standalone SDS using signalling control plane;\n-\tsend a standalone SDS using media plane;\n-\tinitiate a SDS session;\n-\tsend a file using HTTP;\n-\tsend a file using media plane;\n-\testablish an IP Connectivity session to exchange Data;\n-\taccess the MCData message store; and\n-\tuse a functional alias to identify the MCData user.\nFor off-network communications in EPS, the present document utilises the procedures for ProSe direct discovery for Public Safety and the procedures for one-to-one ProSe direct communication for Public Safety and one-to-many ProSe direct communication for Public Safety, as specified in 3GPP TS 24.334 [25], and allows an MCData user to:\n-\tsend a standalone SDS using signalling control plane.\nThe MCData procedures provided by the present document refer to:\n-\tthe media plane procedures defined in 3GPP TS 24.582 [15];\n-\tthe group management procedures defined in 3GPP TS 24.481 [11];\n-\tthe identity management procedures defined in 3GPP TS 24.482 [24]; and\n-\tthe security procedures defined in 3GPP TS 33.180 [26].\nThe MCData procedures provided by the present document access the configuration parameters provided by 3GPP TS 24.483 [42] and 3GPP TS 24.484 [12].\nThe following procedures are provided within this document:\n-\tcommon procedures are specified in clause 6;\n-\tprocedures for registration in the IM CN subsystem and service authorisation are specified in clause 7;\n-\tprocedures for affiliation are specified in clause 8;\n-\tprocedures for on-network and off-network SDS are specified in clause 9;\n-\tprocedures for on-network FD are specified in clause 10;\n-\tprocedures for transmission and reception control are specified in clause 11;\n-\tprocedures for dispositions and notifications are specified in clause 12;\n-\tprocedures for communication release are specified in clause 13;\n-\tprocedures for location reporting are specified in clause 17;\n-\tprocedure for using MBMS transmission are specified in clause 19;\n-\tprocedure for using MBS transmission are specified in clause 19A;\n-\tprocedures for establishing an IP Connectivity session are specified in clause 20;\n-\tprocedures for the MCData message store are specified in clause 21; and\n-\tprocedures for the use of functional alias are specified in clause 22.\nThe MCData UE primarily obtains access to the MCData service via E-UTRAN or NG-RAN, using the procedures defined in 3GPP TS 24.301 [43] and 3GPP TS 24.501 [81].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tIdentity, URI and address assignments",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.2.1\tPublic Service identities",
                            "text_content": "In order to support MCData, the following URI and address assignments are assumed:\n1)\tthe participating MCData function is configured to be reachable using:\na)\tthe public service identity of the participating MCData function serving the MCData user.\nThe MCData client should use the <Server-URI> element of the <MCData-Service-Details> element of the <anyExt> element of the <on-network> element in the MCS UE initial configuration document, as defined in reference 3GPP TS 24.484 [12] as public service identity of the participating function of the MCData client.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.2\tMCData session identity",
                            "text_content": "The MCData session identity is a SIP URI, which identifies the MCData session between:\n-\tthe MCData client and the participating MCData function; and\n-\tthe participating MCData function and the controlling MCData function.\nThe MCData session identity shall be a GRUU as defined in IETF RFC 5627 [44] assigned by the MCData server as per 3GPP TS 24.229 [5].\nThe MCData session identity identifies the MCData session in such a way that e.g.:\n-\tthe IM CN subsystem is able to route an initial SIP request to the controlling MCData function.\nThe controlling MCData function allocates a unique MCData session identity hosted at the controlling MCData function for the MCData session at the time of session establishment.\nWhen protection of sensitive application data is required by the MCData operator, the MCData session identity cannot contain identity information that is classified as sensitive such as the MCData ID or the MCData Group ID, as specified in clause 4.6.\nThe controlling MCData function sends the MCData session identity towards the MCData client during MCData session establishment by including it in the Contact header field of the final SIP response to a session initiation request.\nThe participating MCData function allocates a unique MCData session identity hosted at the participating MCData function for the MCData session when it receives a MCData session identity in the Contact header field of a SIP request or a SIP response from the controlling MCData function and includes it in the Contact header field of the SIP request or SIP response sent towards the MCData client. The participating MCData function maintains a mapping of the MCData session identities it sends to the MCData client to the corresponding MCData session identities received from the controlling MCData function.\nThe MCData client can cache the MCData session identity until a time when it is no longer needed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.3\tMCData client ID",
                            "text_content": "MCData client ID is described in clause 4.8 of the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.3\tPre-established sessions",
                    "description": "",
                    "summary": "",
                    "text_content": "When establishing a pre-established session, the MCData client negotiates the media parameters, including establishing IP addresses and ports using interactive connectivity establishment (ICE) as specified in IETF RFC 8445 [77] and IETF RFC 8839 [78] with the participating MCData function, prior to using the pre-established session for establishing MCData communication with other MCData users. The procedures for establishing, modifying and releasing a pre-established session are defined in clause 18.\nThe pre-established session can later be used in MCData communication. This avoids the need to negotiate media parameters (including evaluating ICE candidates) and reserving bearer resources during the MCData communication establishment that results in delayed MCData communication establishment.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.4\tEmergency Alerts",
                    "description": "",
                    "summary": "",
                    "text_content": "MCData emergency alerts can be initiated or cancelled as described in the procedures of clause 16 which include:\n-\tMCData emergency alert initiation, on-network;\n-\tMCData emergency alert cancellation, on-network;\n-\tMCData emergency alert initiation, off-network; and\n-\tMCData emergency alert cancellation, off-network.\nMCData emergency alerts are initiated to a target MCData group, and, if successful and not already affiliated to that group, will result in the initiator being implicitly affiliated to that MCData group.\nKey aspects of MCData emergency alerts include:\n-\tMCData emergency alert (MDEA) state: the MCData client maintains the internal MCData emergency alert state (MDEA, see clause G.4.1). The initial setting is \"MDEA 1: no-alert\".\n-\tMCData private emergency alert (MDPEA) state: the MCData client maintains the internal MCData private emergency alert state (MDPEA, see clause G.4.12). The initial setting is \"MDPEA 1: no-alert\".\n-\tAuthorisations for emergency alerts: MCData users need to be authorised to initiate MCData emergency alerts and additionally need to be authorised to cancel MCData emergency alerts initiated by them or by others. The parameters related to these authorisations are specified in 3GPP TS 24.483 [42] and 3GPP TS 24.484 [12].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.5\tMCData Protocol",
                    "description": "",
                    "summary": "",
                    "text_content": "Clauses 15 describes the TLV based message formats used in MCData communications. Each message consist of a series of information elements. Annex I of 3GPP TS 24.379 [10] describes the standard format of the messages and the encoding rules for each type of information element.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.6\tProtection of sensitive XML application data",
                    "description": "",
                    "summary": "",
                    "text_content": "In certain deployments, for example, in the case that the MCData operator uses the underlying SIP core infrastructure from the carrier operator, the MCData operator can prevent certain sensitive application data from being visible in the clear to the SIP layer. The following data are classed as sensitive application data:\n-\tMCData ID;\n-\tMCData group ID;\n-\tuser location information;\n-\talert indicator;\n-\taccess token (containing the MCData ID);\n-\tMCData client ID; and\n-\tfunctional alias.\nThe above data is transported as XML content in SIP messages. in XML elements or XML attributes.\nData is transported in attributes in the following circumstances in the procedures in the present document:\n-\tan MCData ID, an MCData Group ID, and an MCData client ID in an XML document published in SIP PUBLISH request for affiliation according to IETF RFC 3856 [39];\n-\tan MCData ID or an MCData Group ID in XML document notified in a SIP NOTIFY request for affiliation according to IETF RFC 3856 [39];\n-\tan MCData ID in application/resource-lists+xml document included in a SIP MESSAGE or SIP INVITE request for one-to-one SDS or one-to-one FD, according to IETF RFC 5366 [18];\n-\tan MCData ID and functional alias in an XML document published in SIP PUBLISH request for functional alias management according to IETF RFC 3856 [39]; and\n-\tan MCData ID and functional alias in an XML document notified in a SIP NOTIFY request for functional alias management according to IETF RFC 3856 [39].\n3GPP TS 33.180 [26] describes a method to provide confidentiality protection of sensitive application data in elements by using XML encryption (i.e. xmlenc) and in attributes by using an attribute confidentiality protection scheme described in clause 6.6.2.3 of the present document. Integrity protection can also be provided by using XML signatures (i.e. xmlsig).\nProtection of the data relies on a shared XML protection key (XPK) used to encrypt and sign data:\n-\tbetween the MCData client and the MCData server, the XPK is a client-server key (CSK); and\n-\tbetween MCData servers, the XPK is a signalling protection key (SPK).\nThe CSK (XPK) and a key-id CSK-ID (XPK-ID) are generated from keying material provided by the key management server. Identity based public key encryption based on MIKEY-SAKKE is used to transport the CSK between SIP end-points. The encrypted CSK is transported from the MCData client to the MCData server when the MCData client performs service authorisation as described in clause 7 and is also used during service authorisation to protect the access token.\nThe SPK (XPK) and a key-id SPK-ID (XPK-ID) are directly provisioned in the MCData servers.\nConfiguration in the MCData client and MCData server is used to determine whether one or both of confidentiality protection and integrity protection are required.\nThe following four examples give a brief overview of the how confidentiality and integrity protection is applied to application data in this specification.\nEXAMPLE 1:\tPseudo code showing how confidentiality protection is represented in the procedures in the document for sensitive data sent by the originating client.\nIF configuration is set for confidentiality protection of sensitive data\nTHEN\nEncrypt data element using the CSK (XPK;\nInclude in an <EncryptedData> element of the XML MIME body:\n(1) the encryption method;\n(2) the key-id (XPK-ID);\n(3) the cipher data;\nEncrypt URIs in attribute using the CSK (XPK) by following clause 6.6.2.3;\nELSE\ninclude application data into XML MIME body in clear text;\nENDIF;\n\nEXAMPLE 2:\tPseudo code showing how integrity protection is represented in the procedures in the present document for data sent by the originating client.\nIF configuration is set for integrity protection of application data\nTHEN\nUse a method to hash the content;\nGenerate a signature for the hashed content using the CSK (XPK;\nInclude within a <Signature> XML element of the XML MIME body:\n(1) a cannonicalisation method to be applied to the signed information;\n(2) the signature method used for generating the signature;\n(3) a reference to the content to be signed;\n(4) the hashing method used;\n(5) the hashed content;\n(6) the key-id (XPK-ID);\n(7) the signature value;\nENDIF;\n\nEXAMPLE 3:\tPseudo code showing how confidentiality protection is represented in the procedures in the present document at the server side when receiving encrypted content.\nIF configuration is set for confidentiality protection of sensitive data\nTHEN\nCheck that the XML content contains the <EncryptedData> element;\nCheck that the XML document contains a URI with the domain name for MC Services confidentiality protection;\nReturn an error if the <EncryptedData> element or domain name for MC Services confidentiality protection are not found;\nOtherwise:\n(1) obtain the CSK (XPK) using the CSK-ID (XPK-ID) in the received XML body;\n(2) for encrypted data in elements, decrypt the data elements using the CSK;\n(3) for encrypted URIs in attributes, decrypt the URIs using the CSK;\nENDIF;\n\nEXAMPLE 4:\tPseudo code showing how integrity protection is represented in the procedures in the present document at the server side when receiving signed content.\nIF configuration is set for integrity protection of application data\nTHEN\nCheck that the XML content contains the <Signature> element;\nReturn an error if the <Signature> element is not found;\nOtherwise:\n(1) obtain the CSK (XPK) using the CSK-ID (XPK-ID) in the received XML body;\n(2) verify the signature of the content using the CSK;\nReturn an error if the validation of the signature fails;\nIF validation of the signature passes\nTHEN\ndecrypt any data found in <EncryptedData> elements;\ndecrypt any encrypted URIs found in attributes;\nENDIF;\nENDIF;\n\nThe content can be re-encrypted and signed again using the SPK between MCData servers.\nThe following examples show the difference between normal and encrypted data content. In this example consider the MCData client initiating a group standalone SDS message using the signalling control plane.\nEXAMPLE 5:\t<mcdata-info> MIME body represented with data elements in the clear:\nContent-Type: application/vnd.3gpp.mcdata-info+xml\n<?xml version=\"1.0\"?>\n<mcdata-info>\n<mcdata-Params>\n<request-type>group-sds</request-type>\n<mcdata-request-uri type=\"Normal\">\n<mcdataURI>sip:group123@mcdataoperator1.com></mcdataURI>\n</mcdata-request-uri>\n</mcdata-Params>\n</mcdata-info>\n\nEXAMPLE 6:\t<mcdata-info> MIME body represented with the <mcdata-request-uri> encrypted:\nContent-Type: application/vnd.3gpp.mcdata-info+xml\n<?xml version=\"1.0\"?>\n<mcdata-info>\n<mcdata-Params>\n<request-type>group-sds</request-type>\n<mcdata-request-uri type=\"Encrypted\">\n<EncryptedData xmlns='http://www.w3.org/2001/04/xmlenc#'\nType='http://www.w3.org/2001/04/xmlenc#Content'>\n<EncryptionMethod Algorithm=\"\"/>\n<ds:KeyInfo>\n<ds:KeyName>base64XpkId</KeyName>\n</ds:KeyInfo>\n<CipherData>\n<CipherValue>A23B45C5657689090</CipherValue>\n</CipherData>\n</EncryptedData>\n</mcdata-request-uri>\n</mcdata-Params>\n</mcdata-info>\n\nEXAMPLE 7:\tpidf+xml MIME body represented with clear URIs in attributes:\nContent-Type: application/pidf+xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<presence entity=\"sip:somebody@mcdata.org\">\n<tuple id=\"acD4rhU87bK\">\n<status>\n<affiliation group=\"sip:thegroup@mcdata.org\"/>\n</status>\n</tuple>\n</presence>\n\nEXAMPLE 8:\tpidf+xml MIME body represented with encrypted URIs in attributes:\nContent-Type: application/pidf+xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<presence entity=\"sip:c4Hrt45XG8IohRFT67vfdr3V;iv=45RtfVgHY23k8Ihy;xpk-id=b7UJv9;alg=128-aes-gcm@mc1-encryption.3gppnetwork.org\">\n<tuple id=\"acD4rhU87bK\">\n<status>\n<affiliation group=\"sip:98yudFG45tx_89TYGedb4ujF ;iv=FGD567kjhfH7d4-D;key-id=eV9kl7;alg=128-aes-gcm@mc1-encryption.3gppnetwork.org\"/>\n</status>\n</tuple>\n</presence>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.7\tProtection of TLV signalling and media content",
                    "description": "",
                    "summary": "",
                    "text_content": "The protection of TLV signalling and media content is based on 3GPP MCData security solution as defined in 3GPP TS 33.180 [26].\nFor different security requirements of different information elements of a MCData message, the information elements of MCData messages are bifurcated in the following components:\n-\tMCData Data signalling payload: information elements necessary for identification and management of the MCData messages e.g. conversation identifiers, session identifiers, transaction identifiers, disposition requests, etc. This payload is confidentiality and integrity protected between the MCData Client and the MCData server.\n-\tMCData Data payload: the actual user payload for MCData user or application consumption. This payload is end-to-end confidentiality and integrity protected.\nAn SDS message can be sent over both, signalling plane and media plane. When an SDS message is sent using signalling plane, the body included in the SIP MESSAGE request, which carries MCData Data signalling payload, is protected between each entity separately if protection is applied. On the other hand the body included in the SIP MESSAGE request which carries the MCData Data payload is end-to-end protected. The procedures for the protection of the SDS messages over the signalling plane are specified in this document. Protection of SDS message over media control plane is specified in 3GPP TS 24.582 [15].\nFor FD using HTTP and FD using media plane, the MCData Data signalling payload sent over the signalling plane is protected between each entity separately if protection is applied. The procedure for the protection of the file is specified in 3GPP TS 24.582 [15].\nThe ciphering algorithm indicated in the Key Download procedure by the MCData server shall be used to protect the MCData signalling fields (i.e. MCData signaling parameters, Data signaling payload and end-to-end security parameters).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.7A\tSignalling security when using MBMS",
                    "description": "",
                    "summary": "",
                    "text_content": "Signalling security is established between the participating MCData function and the MCData client.\nThe protection of MBMS subchannel control messages on the general purpose MBMS subchannels can be done with MSCCKs (each identified by a corresponding MSCCK-ID), distributed during MBMS bearer announcement (see clause 19.2.2). Each general purpose MBMS subchannel is associated with an MSCCK and a corresponding MSCCK-ID. There can be multiple general purpose MBMS subchannels deployed, each associated with its own MSCCK and corresponding MSCCK-ID. The (MSCCK-ID, MSCCK) pair is provided for each general purpose MBMS subchannel separately.\nAccording to 3GPP TS 33.180 [26] clause 8.2, the MCData Payload Protection Key (DPPK) referenced in clause 6.6 is a Multicast Signalling Keys (MuSiK), (identified by a corresponding (MuSiK-ID)), distributed via MuSiK download messages. The MSCCK and MuSiKs can be distributed independently of each other and in any order and can also be used independently. Signalling supports initial keying, as well as repeated re-keying and un-keying for both MSCCK and MuSiKs.\nThe MuSiK download message contains an embedded MIME payload which is the MIKEY payload containing the MuSiK and MuSiK-ID, as well as an embedded XML payload potentially containing an explicit list of MCData group ids to which the key applies. Both payloads are protected as described in 3GPP TS 33.180 [26], as they are transferred between the participating MCData function and the MCData client. Within the XML payload, the list of MCData group ids is protected as application sensitive data (see clause 4.8). Within the MIKEY payload, the MuSiK is encrypted using the MCData ID of the served MCData client. The payload is signed using a key associated to the identity of the participating MCData function.\nTo distribute MuSiK, the participating MCData function uses the I_MESSAGE format from clause 5.2.4 of 3GPP TS 33.180 [26], which includes associated parameters. The participating function sets the Status associated parameter to values defined in clause E.6.9 of 3GPP TS 33.180 [26], namely \"Not-revoked\" when keying or rekeying and \"Revoked\" when unkeying, respectively. Upon receipt, the MCData client validates the signature and, if valid, the MCData client first examines the Status attribute and either marks the associated security functions as \"not in use\" or stores the MuSiK and the MuSiK-ID, and then replies with a success code; otherwise, the MCData client can reply with a failure code. If a success code is not received from the MCData client in response to the MuSiK download message, the participating MCData function starts using only unicast towards the respective MCData client for the listed groups.\nThe security context is initiated when the MBMS bearer is announced to the MCData clients. The procedure involves the participating MCData function creating an MBMS subchannel control key (MSCCK) and a  corresponding key identifier (MSCCK-ID) associated with the MBMS bearer when the MBMS bearer is activated, and then transferring the MSCCK and the MSCCK-ID associated with the MBMS bearer to served MCData clients using SIP signalling. The MSCCK is encrypted using the MCData ID of the served MCData client and domain-specific material provided from the KMS.\nThe MSCCK and the MSCCK-ID associated with the MBMS bearer are distributed within a MIKEY payload within the SDP describing the general purpose MBMS subchannel of the MBMS bearer. This payload is called a MIKEY-SAKKE I_MESSAGE, as defined in IETF RFC 6509 [55], which ensures the confidentiality, integrity and authenticity of the payload. The encoding of the MIKEY payload in the SDP is described in IETF RFC 4567 [45] using an \"a=key-mgmt\" attribute. The payload is signed using a key associated to the identity of the participating MCData function. To distribute MSCCK, the participating MCData function uses the I_MESSAGE format from clause 5.2.4 of 3GPP TS 33.180 [26], which includes associated parameters.\nThe participating function sets the Status associated parameter to values defined in clause E.6.9 of 3GPP TS 33.180 [26], namely \"Not-revoked\" when keying or rekeying and \"Revoked\" when unkeying, respectively. Upon receipt, the MCData client validates the signature and, if the signature is found valid and the I_MESSAGE contains a Status attribute, the MCData client first examines the Status attribute and either marks the associated security functions as \"not in use\" or extracts and stores the encapsulated MSCCK and the corresponding MSCCK-ID.  The decrypted key is used as described in 3GPP TS 33.180 [26]. With the MSCCK successfully shared between the participating MCData function and the served UEs, the participating MCData function is able to securely send MBMS subchannel control messages to the MCData clients.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.8\tMCData client ID",
                    "description": "",
                    "summary": "",
                    "text_content": "The MCData client assigns the MCData client ID when the MCData client is used for the first time. The MCData client generates the MCData client ID as specified in clause 4.2 of IETF RFC 4122 [14].\nThe MCData client preserves the MCData client ID:\n-\twhile the MCData client is SIP registered as specified in 3GPP TS 24.229 [5];\n-\twhile the MCData client is not SIP registered as specified in 3GPP TS 24.229 [5] and the UE serving the MCData client is switched on;\n-\twhile the UE serving the MCData client is switched off; and\n-\twhile the UE serving the MCData client is power-cycled.\nNOTE:\tMCData client ID is not preserved when the UE is reset to factory settings.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.9\tWarning Header Field",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.9.1\tGeneral",
                            "text_content": "The MCData server can include a free text string in a SIP response to a SIP request. When the MCData server includes a text string in a response to a SIP MESSAGE or SIP INVITE request the text string is included in a Warning header field as specified in IETF RFC 3261 [4]. The MCData server includes the Warning code set to 399 (miscellaneous warning) and includes the host name set to the host name of the MCData server.\nEXAMPLE: Warning: 399 \"200 user not authorised to transmit data\"\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.9.2\tWarning texts",
                            "text_content": "The text string included in a Warning header field consists of an explanatory text preceded by a 3-digit text code, according to the following format in Table 4.9.2-1.\nTable 4.9.2-1 ABNF for the Warning text\n\nwarn-text      =/  DQUOTE mcdata-warn-code SP mcdata-warn-text DQUOTE\nmcdata-warn-code = DIGIT DIGIT DIGIT\nmcdata-warn-text = *( qdtext | quoted-pair )\n\n\nTable 4.9.2-2 defines the warning texts that are defined for the Warning header field when a Warning header field is included in a response to a SIP request as specified in clause 4.9.1.\nTable 4.9.2-2: Warning texts defined for the Warning header field\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 4.9.2-2: Warning texts defined for the Warning header field",
                                    "table number": 3,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "4.10\tMCData emergency groups and emergency group communications",
                    "description": "",
                    "summary": "",
                    "text_content": "MCData emergency groups and emergency group communications as defined by 3GPP TS 23.282 [2] are supported by the procedures in this specification. There are a number of state variables used to manage MCData emergencies, including:\n-\tMCData emergency (MED) state: in accordance with 3GPP TS 23.282 [2], indicates (see clause G.4.2) that the MCData user is in a life-threatening situation. This MCData client state variable is changed via action by the MCData user of the device or by an authorised MCData user. While the MCData emergency state is set on the client, all communications originated by the client will be MCData emergency communications, assuming the MCData user is authorised for MCData emergency communications.\n-\tin-progress emergency group (IPEG) state: in accordance with 3GPP TS 23.282 [2], this state variable (see clause G.4.3) indicates whether or not there is an MCData emergency group communication ongoing on the specified group. This state is managed by the controlling MCData function. All group communications originated on this MCData group when in an in-progress emergency state are MCData emergency group communications until this state is cancelled, regardless of the originator being (or not) in an MCData emergency state.\n-\tMCData emergency group (MDEG) state: this is an internal state (see clause G.4.4) managed by the MCData client which tracks the in-progress emergency state of the group (see 3GPP TS 23.282 [2]) managed by the controlling MCData function. Ideally, the MCData client would not need to track the in-progress emergency group state, but doing so enables the MCData client to request MCData emergency-level priority earlier than otherwise possible. For example, if the MCData user wishes to join an MCData emergency group communication and is not in MCData emergency state itself, the MCData client should have emergency level priority. If it has knowledge of the in-progress emergency state of the group, it can request priority by including a Resource-Priority header field set to the MCPTT namespace specified in IETF RFC 8101 [67], and appropriate priority level in the SIP INVITE request (or SIP re-INVITE request).\n-\tMCData emergency group communication (MDEGC) state: this is an internal state (see clause G.4.5) corresponding to an ongoing group communication. The state is managed by the MCData client, which in conjunction with the MCData emergency alert state (see clause 4.4), aids in managing the MCData emergency state and related actions.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.11\tMCData imminent peril group communications",
                    "description": "",
                    "summary": "",
                    "text_content": "MCData imminent peril group communications as defined by 3GPP TS 23.282 [2] are supported by the procedures in this specification. The following MCData imminent peril group communications functionalities are specified in the present document:\n-\tMCData imminent peril group communications origination;\n-\tupgrade of an MCData group communication to an MCData imminent peril group communication;\n-\tupgrade from an MCData imminent peril group communication to an MCData emergency group communication; and\n-\tcancellation of the in-progress imminent peril state of the group.\nKey aspects of MCData imminent peril include:\n-\tadjusted EPS bearer priority for all participants when the in-progress imminent peril state of the group is set whether or not they themselves initiated an imminent peril group communication. For unicast bearers this is achieved by using the Resource-Priority header field as specified in IETF RFC 4412 [74] with namespaces defined for use by MCPTT specified in IETF RFC 8101 [67], and for MBMS bearers this is achieved by having the participating MCData function adjust the ARP (priority, PVI, PCI) and executing the Modify MBMS Bearer Procedure per 3GPP TS 29.468 [57];\n-\trestoration of normal EPS bearer priority to the communication when the in-progress imminent peril group state is cancelled; and\n-\trequires the MCData user to be authorised to either originate or cancel an MCData imminent peril group communication.\nRelationship to other MCData priority group communication types:\n-\tA normal MCData group communication can be upgraded to an MCData imminent peril group communication;\n-\tAn MCData imminent peril group communication can be upgraded to an MCData emergency group communication;\n-\tAn MCData imminent peril group communication or an MCData emergency group communication (i.e., their respective \"in-progress\" states) can be downgraded to a normal MCData group communication, but it is not possible to directly downgrade an MCData emergency group communication to an MCData imminent peril group communication;\n-\tMCData imminent peril functionality is only applicable to MCData group communications, not MCData private communications; and\n-\tMCData imminent peril group communications have no associated alert capabilities such as the MCData emergency alert capability which is associated with MCData emergency group communications.\nThere are a number of states that are key in managing these aspects of MCData imminent peril group communications, which include:\n-\tMCData imminent peril group (MDIG) state: this is an internal state of the MCData client which in conjunction with the MCData imminent peril group communication state aids the client in managing the use of the Resource-Priority header field and related actions.\n-\tMCData imminent peril group communication (MIGC) state: this is an internal state managed by the MCData client which in conjunction with the MCData imminent peril group state aids the client in managing the use of the Resource-Priority header field and related actions.\n-\tIn-progress imminent peril group (IPIG) state: this a state of the MCData group which is managed by the controlling MCData function. While an MCData group is in an in-progress imminent peril group state, all participants in group communications using this group will receive elevated priority.\nThe above states and their transitions are described in Annex G.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.12\tMCData emergency private communications",
                    "description": "",
                    "summary": "",
                    "text_content": "MCData emergency private communications refer to emergency one-to-one communications. The following MCData emergency private communication functionalities are specified in the present document:\n-\tMCData emergency private communication origination with optional MCData emergency alert initiation;\n-\tupgrade of an MCData private communication to an MCData emergency private; and\n-\tcancellation of the MCData emergency private communication priority.\nKey aspects of MCData emergency private communications include:\n-\tadjusted EPS bearer priority for both participants whether or not they are both in an emergency condition (i.e. both have their MCData emergency state set). This is achieved by using the Resource-Priority header field as specified in IETF RFC 4412 [74] with namespaces defined for use by MCPTT specified in IETF RFC 8101 [67];\n-\tthe initiator of the MCData emergency private communication can override the other MCData user in the MCData emergency private communication unless that user also has their MCData emergency state set;\n-\trestoration of normal EPS bearer priority to the communication according to system policy (e.g., configured time limit for the emergency priority of an MCData emergency private communication or cancellation of the emergency condition of the private communication);\n-\trequires the MCData user to be authorised to either originate or cancel an MCData emergency private communication;\n-\trequires the targeted MCData user to be authorised to receive an MCData emergency private communication;\n-\trequests to originate MCData emergency private communications may also include an indication of an MCData emergency alert; and\nThere are a number of states that are key in managing these aspects of MCData emergency private communications, which include:\n-\tMCData private emergency alert (MDPEA) state: this is an internal state of the MCData client which in conjunction with the MCData emergency private communication state aids in managing the MCData emergency state and related actions.\n-\tMCData emergency private communication (MDEPC) state: this is an internal state managed by the MCData client which in conjunction with the MCData emergency alert state aids in managing the MCData emergency state and related actions.\n-\tIn-progress emergency private communication (IPEPC) state: indicates whether or not there is an MCData emergency private communication in-progress for the two participants. This state is managed by the controlling MCData function. All private communications originated between these two participants when in an in-progress emergency private communication state are MCData emergency private communications until this state is cancelled, whether or not the originator is in an MCData emergency state.\n-\tMCData emergency private priority (MDEPP) state: this is an internal state managed by the MCData client which tracks the in-progress emergency private communication state of the private communication managed by the controlling MCData function. Ideally, the MCData client would not need to track the in-progress emergency private priority state, but doing so enables the MCData client to request MCData emergency-level priority earlier than otherwise possible. For example, if the MCData user wishes to join an MCData emergency private communication and is not in the MCData emergency state, the MCData client should have emergency level priority. If it has knowledge of the in-progress emergency private priority state of the private communication (i.e., the two participants), it can request priority by including a Resource-Priority header field set to the MCPTT namespace specified in IETF RFC 8101 [67], and appropriate priority level in the SIP INVITE request (or SIP re-INVITE request).\nNOTE:\tThe above states and their transitions are described in Annex G.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5\tFunctional entities",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause associates the functional entities with the MCData roles described in the stage 2 architecture document (see 3GPP TS 23.282 [2]).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.2\tMCData client",
                    "description": "",
                    "summary": "",
                    "text_content": "To be compliant with the procedures in the present document, an MCData client shall:\n-\tact as the user agent for all MCData application transactions (e.g. initiation of a group standalone SDS message); and\n-\tsupport handling of the MCData client ID as described in clause 4.8.\nTo be compliant with the on-network procedures in the present document, an MCData client shall:\n-\tsupport the MCData client on-network procedures defined in 3GPP TS 23.282 [2];\n-\tsupport the GCS UE procedures defined in 3GPP TS 23.468 [56] for unicast delivery, MBMS delivery and service continuity;\n-\tsupport 5G multicast-broadcast services defined in 3GPP TS 23.247 [84];\n-\tsupport the on-network MCData message formats specified in clause 15 for the short data service (SDS) and the file distribution service (FD);\n-\tact as a SIP UA as defined in 3GPP TS 24.229 [5];\n-\tgenerate SDP offer and SDP answer in accordance with 3GPP TS 24.229 [5] and:\na)\tclause 9.2.3 and clause 9.2.4 for short data service; and\nb)\tclause 10.2.5 for file distribution.\n-\tfor registration and service authorisation, implement the procedures specified in clause 7.2;\n-\tfor affiliation, implement the procedures specified in clause 9.2;\n-\tfor short data service (SDS) functionality implement the MCData client procedures specified in:\na)\tclause 9.2; and\nb)\tclause 6 of 3GPP TS 24.582 [15];\n-\tfor file distribution (FD) functionality implement the MCData client procedures specified in:\na)\tclause 10.2; and\nb)\tclause 7 of 3GPP TS 24.582 [15];\n-\tfor transmission and reception control functionality implement the MCData client procedures specified in clause 11;\n-\tfor disposition notification functionality implement the MCData client procedures specified in clause 12.2;\n-\tfor communication release functionality implement the MCData client procedures specified in clause 13.2;\n-\tfor MBMS transmission usage, implement the procedures in clause 19;\n-\tfor MBS transmission usage, implement the procedures in clause 19A; and\n-\tfor functional alias management, implement the procedures specified in clause 22.2.1.\nTo be compliant with the off-network procedures in the present document, an MCData client shall:\n-\tsupport the off-network procedures defined in 3GPP TS 23.282 [2];\n-\tsupport the off-network MONP MCData message formats specified in clause 15;\n-\timplement the procedures for ProSe direct discovery for public safety use as specified in 3GPP TS 24.334 [25];\n-\timplement the procedures for one-to-one ProSe direct communication for Public Safety use as specified in 3GPP TS 24.334 [25]; and\n-\tfor short data service (SDS) functionality implement the MCData client procedures specified in clause 9.3.\nTo be compliant with the on-network and off-network procedures in the present document requiring end-to-end security key distribution, an MCData client shall support the procedures specified in 3GPP TS 33.180 [26].\nTo be compliant with the procedures for confidentiality protection of XML elements in the present document, the MCData client shall implement the procedures specified in clause 6.5.2.\nTo be compliant with the procedures for integrity protection of XML MIME bodies in the present document, the MCData client shall implement the procedures specified in clause 6.5.3.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.3\tMCData server",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.0\tGeneral",
                            "text_content": "An MCData server can perform the controlling role for short data service and file distribution as defined in 3GPP TS 23.282 [2].\nAn MCData server can perform the participating role for short data service and file distribution as defined in 3GPP TS 23.282 [2].\nAn MCData server performing the participating role can serve an originating MCData user.\nAn MCData server performing the participating role can serve a terminating MCData user.\nThe same MCData server can perform the participating role and controlling role for the same group short data service transaction or group file distribution transaction.\nWhen referring to the procedures in the present document for the MCData server acting in a participating role for the served user, the term, \"participating MCData function\" is used.\nWhen referring to the procedures in the present document for the MCData server acting in a controlling role for the served user, the term \"controlling MCData function\" is used.\nTo be compliant with the procedures in the present document, an MCData server shall:\n-\tsupport the MCData server procedures defined in 3GPP TS 23.282 [2];\n-\tsupport the GCS AS procedures defined in 3GPP TS 23.468 [56] for unicast delivery, MBMS delivery and service continuity;\n-\tsupport 5G multicast-broadcast services defined in 3GPP TS 23.247 [84];\n-\timplement the role of an AS performing 3rd party call control acting as a routing B2BUA as defined in 3GPP TS 24.229 [5];\n-\tgenerate SDP offer and SDP answer in accordance with 3GPP TS 24.229 [5] and:\na)\tclause 9.2.3 and clause 9.2.4 for short data service; and\nb)\tclause 10.2.5 for file distribution.\n-\tfor registration and service authorisation, implement the procedures specified in clause 7.3;\n-\tfor affiliation, implement the procedures specified in clause 9.2.2;\n-\tfor short data service (SDS) functionality implement the MCData server procedures specified in:\na)\tclause 9.2; and\nb)\tclause 6 of 3GPP TS 24.582 [15];\n-\tfor file distribution (FD) functionality implement the MCData server procedures specified in:\na)\tclause 10.2; and\nb)\tclause 7 of 3GPP TS 24.582 [15];\n-\tfor transmission and reception control functionality implement the MCData server procedures specified in clause 11;\n-\tfor disposition notification functionality implement the MCData server procedures specified in clause 12.2;\n-\tfor communication release functionality implement the MCData server procedures specified in clause 13.2;\n-\tfor MBMS transmission usage, implement the procedures in clause 19;\n-\tfor MBS transmission usage, implement the procedures in clause 19A; and\n-\tfor functional alias management, implement the procedures specified in clause 22.2.2.\nTo be compliant with the procedures in the present document requiring the distribution of keying material between MCData clients as specified in 3GPP TS 33.180 [26], an MCData server shall ensure that the keying material is copied from the incoming MCData messages into the outgoing MCData messages.\nTo be compliant with the procedures for confidentiality protection of XML elements in the present document, the MCData server shall implement the procedures specified in clause 6.5.2.\nTo be compliant with the procedures for integrity protection of XML MIME bodies in the present document, the MCData server shall implement the procedures specified in clause 6.5.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.1\tSIP failure case",
                            "text_content": "When initiating a SIP failure response to any received SIP request, depending on operator policy, the MCData server may insert a SIP Response-Source header field in accordance with the procedures in clause 5.7.1.0 of 3GPP TS 24.229 [5], where the \"role\" header field parameter is set to \"pf-mcdata-server\" or \"cf-mcdata-server\" depending on the current role endorsed by the MCData server.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.1A\tSIP provisional response",
                            "text_content": "When sending SIP provisional responses, with the exception of the SIP 100 (Trying) response to the SIP INVITE request, the MCData server acting in the controlling MCData function role:\n1)\tshall generate the SIP provisional response;\n2)\tshall include a P-Asserted-Identity header field with the public service identity of the controlling MCData function;\n3)\tshall include an MCData session identity in the Contact header field; and\n4)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\"; and\nc)\tthe isfocus media feature tag.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.2\tManagement of MBMS bearers",
                            "text_content": "When providing services over MBMS, an MCData server acting in the participating MCData function role shall:\n-\tallocate TMGIs and activate MBMS bearers in MBMS service areas to be used for MCData media plane transmissions via multicast, per 3GPP TS 23.468 [56] and 3GPP TS 29.468 [57];\n-\tdeactivate MBMS bearers and deallocate TMGIs when no longer necessary, per 3GPP TS 23.468 [56] and 3GPP TS 29.468 [57];\n-\thandle MBMS bearers related notifications per 3GPP TS 23.468 [56] and 3GPP TS 29.468 [57]; and\n-\tadjust the priority / pre-emption characteristics of MBMS bearers, as appropriate, in response to relevant events, using procedures specified in per 3GPP TS 23.468 [56] and 3GPP TS 29.468 [57].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.3\tManagement of MBS sessions",
                            "text_content": "When providing services over MBS, an MCData server acting in the participating MCData function role shall:\n-\tcreate MBS sessions in MBS service areas to be used for MCData media plane transmissions via multicast and broadcast, per 3GPP TS 23.247 [84];\n-\tdelete the MBS sessions when no longer necessary, per 3GPP TS 23.247 [84];\n-\tupdate the MBS sessions to be used for updating the MBS service areas and/or MBS Service Information, per 3GPP TS 23.247 [84].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.4\tMCData gateway server",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.4.1\tGeneral",
                            "text_content": "To allow interconnection between MCData system in different trust domains, MC Gateway Servers can be optionally added on the path between controlling and participating MCData functions and between controlling and non-controlling MCData functions.\nAn MCData gateway server acts as a SIP and HTTP proxy for signalling with an interconnected MCData system in a different trust domain.\nAn MCData gateway server acts as an application and security gateway with an interconnected MCData system in a different trust domain.\nAn MCData gateway server provides topology hiding to the interconnected MCData system in a different trust domain.\nAn MCData gateway server enforces local policies and local security.\nAn MCData gateway server can be an exit point from its MCData system to an interconnected MCData system in a different trust domain, an entry point to its MCData system from an interconnected MCData system in a different trust domain, or both.\nAn MCData gateway server is transparent to controlling and participating MCData functions and to controlling and non-controlling MCData functions. When required for interconnection, MC gateway servers URIs are known and used by MCData servers in place of the PSIs of the interconnected MCData server. The MCData server does not need to know if it finally addresses directly a controlling MCData function or an intermediate MCData gateway server.\nTo be compliant with the procedures in the present document, an MCData gateway server shall:\n-\tsupport the MC gateway server procedures defined in 3GPP TS 23.280 [3] and 3GPP TS 23.282 [2]; and\n-\tsupport the MC gateway server procedures defined in 3GPP TS 33.180 [26];\n-\timplement the procedures specified in clause 6.8.\nTo be compliant with the procedures for confidentiality protection in the present document, the MCData gateway server shall implement the procedures specified in clause 6.5.2, acting on behalf of the MCData server when sending or receiving confidentiality protected content to or from an MCData server in another trust domain.\nTo be compliant with the procedures for integrity protection of XML MIME bodies in the present document, the MCData gateway server shall implement the procedures specified in clause 6.5.3, acting on behalf of the MCData server when sending or receiving integrity protected content to or from an MCData server in another trust domain.\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tCommon procedures",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes the common procedures for each functional entity.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.2\tMCData client procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tDistinction of requests at the MCData client",
                            "text_content": "The MCData client needs to distinguish between the following SIP MESSAGE request for originations and terminations:\n-\tSIP MESSAGE request routed to the MCData client containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-location-info+xml\" and includes an XML body containing a Location root element containing a Configuration element. Such requests are known as \"SIP MESSAGE request for location report configuration\";\n-\tSIP MESSAGE request routed to the MCData client containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-location-info+xml\" and includes an XML body containing a Location root element containing a Request element. Such requests are known as \"SIP MESSAGE request for location report request\";\n-\tSIP MESSAGE request routed to the MCData client containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-info+xml\" and including an <alert-ind> element set to a value of \"true\" or \"false\" and/or an <emergency-ind> element set to a value of \"true\" or \"false\". Such requests are known as \"SIP MESSAGE request for emergency notification\";\n-\tSIP MESSAGE request routed to the MCData client with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field. Such requests are known as \"SIP MESSAGE request for standalone SDS for terminating MCData client\";\n-\tSIP MESSAGE request routed to the MCData client with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field. Such requests are known as \"SIP MESSAGE request for FD using HTTP for terminating MCData client\";\n-\tSIP MESSAGE request routed to the MCData client with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field, and with an application/vnd.3gpp.mcdata-signalling MIME body containing an SDS NOTIFICATION message Such requests are known as \"SIP MESSAGE request for SDS disposition notification for terminating MCData client\"; and\n-\tSIP MESSAGE request routed to the MCData client with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field, and with an application/vnd.3gpp.mcdata-signalling MIME body containing an FD NOTIFICATION message Such requests are known as \"SIP MESSAGE request for FD disposition notification for terminating MCData client\";\n-\tSIP MESSAGE request routed to the MCData client with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field, and with an application/vnd.3gpp.mcdata-info+xml MIME body containing a <request-type> element in of the SIP MESSAGE request contains the value \"msf-disc-res\". Such requests are known as \"SIP MESSAGE request for absolute URI discovery response\";\n-\tSIP MESSAGE request routed to the MCData client with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field, and with an application/vnd.3gpp.mcdata-signalling MIME body containing an DEFERRED DATA RESPONSE message. Such requests are known as \"SIP MESSAGE response for the list of deferred group communications request\"\n-\tSIP MESSAGE requests routed to the MCData client with the Request-URI set to a public user identity of the MCData user that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup+xml MIME body and a <regroup-action> element set to \"create\". Such requests are known as \"SIP MESSAGE request to the MCData client to request creation of a regroup using preconfigured group\" in the procedures in the present document;\n-\tSIP MESSAGE requests routed to the MCData client with the Request-URI set to a public user identity of the MCData user that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup+xml MIME body and a <regroup-action> element set to \"remove\". Such requests are known as \"SIP MESSAGE request to the MCData client to request removal of a regroup using preconfigured group\" in the procedures in the present document.\n-\tSIP MESSAGE requests routed to the MCData client containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-info+xml\" and including an XML body containing a <mcdata-info> root element containing the <mcdata-Params> element and an <emergency-alert-area-ind> element. Such requests are known as \"SIP MESSAGE request for notification of entry into or exit from an emergency alert area\"; and\n-\tSIP MESSAGE requests routed to the MCData client containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-info+xml\" and including an XML body containing a <mcdata-info> root element containing the <mcdata-Params> element and a <group-geo-area-ind> element. Such requests are known as \"SIP MESSAGE request for notification of entry into or exit from a group geographic area\".\nThe MCData client needs to distinguish between the following initial SIP INVITE requests for terminations:\n-\tSIP INVITE request routed to the terminating MCData client with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-sds\" or \"group-sds\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for standalone SDS over media plane for terminating MCData client\";\n-\tSIP INVITE request routed to the terminating MCData client with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-sds-session\" or \"group-sds-session\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for SDS session for terminating MCData client\";\n-\tSIP INVITE request routed to the terminating MCData client with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-fd\" or \"group-fd\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for file distribution for terminating MCData client\"; and\n-\tSIP INVITE request routed to the terminating MCData client with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-ipconn\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for IP Connectivity session for terminating MCData client\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tMCData conversation items",
                            "text_content": "In order to generate an SDS message, the MCData client:\n1)\tshall generate an SDS SIGNALLING PAYLOAD message as specified in clause 15.1.2;\n2)\tshall generate a DATA PAYLOAD message as specified in clause 15.1.4;\n3)\tshall include in the SIP request, the SDS SIGNALLING PAYLOAD message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1; and\n4)\tshall include in the SIP request, the DATA PAYLOAD message in an application/vnd.3gpp.mcdata-payload MIME body as specified in clause E.2.\nWhen generating an SDS SIGNALLING PAYLOAD message as specified in clause 15.1.2, the MCData client:\n1)\tshall set the Date and time IE to the current time as specified in clause 15.2.8;\n2)\tif the SDS message starts a new conversation, shall set the Conversation ID IE to a newly generated Conversation ID value as specified in clause 15.2.9;\n3)\tif the SDS message continues an existing unfinished conversation, shall set the Conversation ID IE to the Conversation ID value of the existing conversation as specified in clause 15.2.9;\n4)\tshall set the Message ID IE to a newly generated Message ID value as specified in clause 15.2.10;\n5)\tif the SDS message is in reply to a previously received SDS message, shall include the InReplyTo message ID IE with the Message ID value in the previously received SDS message;\n6)\tif the SDS message is for user consumption, shall not include an Application ID IE as specified in clause 15.2.7and shall not include an Extended application ID IE as specified in clause 15.2.24;\n7)\tif the SDS message is intended for an application on the terminating MCData client, shall include:\na)\tan Application ID IE with a Application ID value representing the intended application as specified in clause 15.2.7; or\nb)\tan Extended application ID IE with an Extended application ID value representing the intended application as specified in clause 15.2.24;\nNOTE:\tThe value chosen for the Application ID value is decided by the mission critical organisation.\n8)\tif only a delivery disposition notification is required shall include a SDS disposition request type IE set to \"DELIVERY\" as specified in clause 15.2.3;\n9)\tif only a read disposition notification is required shall include a SDS disposition request type IE set to \"READ\" as specified in clause 15.2.3;\n10)\tif both a delivery and read disposition notification is required shall include a SDS disposition request type IE set to \"DELIVERY AND READ\" as specified in clause 15.2.3;\n11)\tmay set the User location IE to the current location of the UE as specified in clause 15.2.25; and\n12)\tmay include an Application metadata container IE as specified in clause 15.2.28.\nWhen generating an DATA PAYLOAD message for SDS as specified in clause 15.1.4, the MCData client:\n1)\tshall set the Number of payloads IE to the number of Payload IEs that needs to be encoded, as specified in clause 15.2.12;\n2)\tif end-to-end security is required for a one-to-one communication, shall include the Security parameters and Payload IE with security parameters as described in 3GPP TS 33.180 [26]. Otherwise, if end-to-end security is not required for a one-to-one communication, shall include the Payload IE as specified in clause 15.1.4; and\n3)\tfor each Payload IE included:\na)\tif the payload is text, shall set the Payload content type as \"TEXT\" as specified in clause 15.2.13;\nb)\tif the payload is binary data, shall set the Payload content type as \"BINARY\" as specified in clause 15.2.13;\nc)\tif the payload is hyperlinks, shall set the Payload content type as \"HYPERLINKS\" as specified in clause 15.2.13;\nd)\tif the payload is location, shall set the Payload content type as \"LOCATION\" as specified in clause 15.2.13;\ne)\tif payload is enhanced status for a group, shall set the Payload content type as \"ENHANCED STATUS\" as specified in subclase 15.2.13; and\nf)\tshall include the data to be sent in the Payload data.\nIn order to generate an FD message, the MCData client:\n1)\tshall generate an FD SIGNALLING PAYLOAD message as specified in clause 15.1.3; and\n2)\tshall include in the SIP request, the FD SIGNALLING PAYLOAD message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1.\nWhen generating an FD SIGNALLING PAYLOAD message as specified in clause 15.1.3, the MCData client:\n1)\tshall set the Date and time IE to the current time as specified in clause 15.2.8;\n2)\tif the FD message starts a new conversation, shall set the Conversation ID IE to a newly generated Conversation ID value as specified in clause 15.2.9;\n3)\tif the FD message continues an existing unfinished conversation, shall set the Conversation ID IE to the Conversation ID value of the existing conversation as specified in clause 15.2.9;\n4)\tshall set the Message ID IE to a newly generated Message ID value as specified in clause 15.2.10;\n5)\tif the FD message is in reply to a previously received MCData message, shall include the InReplyTo message ID IE with the Message ID value in the previously received MCData message;\n6)\tif the FD message is for user consumption, shall not include an Application ID IE as specified in clause 15.2.7 and shall not include an Extended application ID IE as specified in clause 15.2.24;\n7)\tif the FD message is intended for an application on the terminating MCData client, shall include:\na)\tan Application ID IE with a Application ID value representing the intended application as specified in clause 15.2.7; or\nb)\tan Extended application ID IE with an Extended application ID value representing the intended application as specified in clause 15.2.24;\nNOTE:\tThe value and field chosen for coding the identity of the application are coordinated by the mission critical organisation.\n8)\tmay include an FD disposition request type IE set to \"FILE DOWNLOAD COMPLETE UPDATE\" as specified in clause 15.2.4;\n9)\tif requiring mandatory download at the recipient side, shall include a Mandatory download IE as specified in clause 15.2.16 set to the value of \"MANDATORY DOWNLOAD\";\n10)\tshall include a Payload IE with:\na)\tthe Payload content type set to \"FILEURL\" as specified in clause 15.2.13; and\nb)\tthe URL of the file in the Payload data as as specified in clause 15.2.13;\n11)\tmay include a Metadata IE with the required file description information and file availability information, as specified in clause 15.2.17; and\n12)\tmay include an Application metadata container IE as specified in clause 15.2.28.\nIn order to generate an FD message, the MCData client:\n1)\tshall generate an FD SIGNALLING PAYLOAD message as specified in clause 15.1.3; and\n2)\tshall include in the SIP request, the FD SIGNALLING PAYLOAD message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1.\nWhen generating an FD SIGNALLING PAYLOAD message as specified in clause 15.1.3, the MCData client:\n1)\tshall set the Date and time IE to the current time as specified in clause 15.2.8;\n2)\tif the file starts a new conversation, shall set the Conversation ID IE to a newly generated Conversation ID value as specified in clause 15.2.9;\n3)\tif the file continues an existing conversation, shall set the Conversation ID IE to the Conversation ID value of the existing conversation as specified in clause 15.2.9;\n4)\tshall set the Message ID IE to a newly generated Message ID value as specified in clause 15.2.10;\n5)\tif the file is in reply to a previously received SDS message or file, shall include the InReplyTo message ID IE with the Message ID value in the previously received SDS message or file;\n6)\tif the file is for user consumption, shall not include an Application ID IE as specified in clause 15.2.7 and shall not include an Extended application ID IE as specified in clause 15.2.24;\n7)\tif the file is intended for an application on the terminating MCData client, shall include:\na)\tan Application ID IE with a Application ID value representing the intended application as specified in clause 15.2.7; or\nb)\tan Extended application ID IE with an Extended application ID value representing the intended application as specified in clause 15.2.24;\nNOTE:\tThe value and field chosen for coding the identity of the application are coordinated by the mission critical organisation.\n8)\tif a file download complete notification is required shall include a FD disposition request type IE set to \"FILE DOWNLOAD COMPLETED UPDATE\" as specified in clause 15.2.4;\n9)\tif mandatory download of a file is required, shall include and set the Mandatory download IE to \"MANDATORY DOWNLOAD\" as described in clause 15.2.16; and\n10)\tmay include an Application metadata container IE as specified in clause 15.2.28.\nIn order to generate an message to terminate FD using HTTP, the MCData client:\n1)\tshall generate an FD HTTP TERMINATION message as specified in clause 15.1.13; and\n2)\tshall include in the SIP request, the FD HTTP TERMINATION message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1.\nWhen generating an FD HTTP TERMINATION message as specified in clause 15.1.13, the MCData client:\n1)\tshall set the Conversation ID IE to a value identifying the conversation, as specified in clause 15.2.9;\n2)\tshall set the Message ID IE to a value identifying the message as specified in clause 15.2.10;\n3)\tmay set:\na)\tthe Application ID IE to the stored value if applicable; or\nb)\tthe Extended Application ID IE to the stored value if applicable;\n4)\tshall include a Payload IE with:\na)\tshall set the Payload content type set to \"FILEURL\" as specified in clause 15.2.13; and\nb)\tshall set the URL of the file same as of FD transmission; and\n5)\tShall set the Termination information type IE set to \"TERMINATION REQUEST\" as specified in clause 15.2.22.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tDisposition Notifications",
                            "text_content": "In order to generate an SDS notification, the MCData client:\n1)\tshall generate an SDS NOTIFICATION message as specified in clause 15.1.5; and\n2)\tshall include in the SIP request, the SDS NOTIFICATION message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1.\nWhen generating an SDS NOTIFICATION message as specified in clause 15.1.5, the MCData client:\n1)\tif sending a delivered notification, shall set the SDS disposition notification type IE as \"DELIVERED\" as specified in clause 15.2.5;\n2)\tif sending a read notification, shall set the SDS disposition notification type IE as \"READ\" as specified in clause 15.2.5;\n3)\tif sending a delivered and read notification, shall set the SDS disposition notification type IE as \"DELIVERED AND READ\" as specified in clause 15.2.5;\n4)\tif the SDS message could not be delivered to the user or application (e.g. due to lack of storage), shall set the SDS disposition notification type IE as \"UNDELIVERED\" as specified in clause 15.2.5;\n5)\tshall set the Date and time IE to the current time to as specified in clause 15.2.8;\n6)\tshall set the Conversation ID to the value of the Conversation ID that was received in the SDS message as specified in clause 15.2.9;\n7)\tshall set the Message ID to the value of the Message ID that was received in the SDS message as specified in clause 15.2.10;\n8)\tif the SDS message was destined for the user, shall not include an Application ID IE (as specified in clause 15.2.7) and shall not include an Extended application ID IE (as specified in clause 15.2.24); and\n9)\tif the SDS message was destined for an application, shall include:\na)\tan Application ID IE set to the value of the Application ID that was included in the SDS message as specified in clause 15.2.3; or\nb)\tan Extended application ID IE set to the value of the Extended application ID that was included in the SDS message as specified in clause 15.2.24.\nIn order to generate an FD notification, the MCData client:\n1)\tshall generate an FD NOTIFICATION message as specified in clause 15.1.6; and\n2)\tshall include in the SIP request, the FD NOTIFICATION message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1.\nWhen generating an FD NOTIFICATION message as specified in clause 15.1.6, the MCData client:\n1)\tif sending a file download accept notification, shall set the FD disposition notification type IE as \"FILE DOWNLOAD REQUEST ACCEPTED\" as specified in clause 15.2.6;\n2)\tif sending a file download reject notification, shall set the FD disposition notification type IE as \"FILE DOWNLOAD REQUEST REJECTED\" as specified in clause 15.2.6;\n3)\tif sending a file download deferred notification, shall set the FD disposition notification type IE as \"FILE DOWNLOAD REQUEST DEFERRED\" as specified in clause 15.2.6;\n4)\tshall set the Conversation ID to the value of the Conversation ID that was received in the FD message as specified in clause 15.2.9;\n5)\tshall set the Date and time IE to the current time as specified in clause 15.2.8; and\n6)\tif sending a file download completed notification:\na)\tshall set the FD disposition notification type IE as \"FILE DOWNLOAD COMPLETED\" as specified in clause 15.2.6;\nb)\tshall set the Message ID to the value of the Message ID that was received in the FD message as specified in clause 15.2.10;\nc)\tif the FD message was destined for the user, shall not include an Application ID IE as specified in clause 15.2.7 and shall not include a Extended application ID IE as specified in clause 15.2.24; and\nd)\tif the FD message was destined for an application, shall include:\ni)\tan Application ID IE set to the value of the Application ID that was included in the FD message as specified in clause 15.2.3; or\nii)\tan Extended application ID IE set to the value of the Extended application ID that was included in the FD message as specified in clause 15.2.24.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.4\tSending SIP requests and receiving SIP responses",
                            "text_content": "This clause is referenced from other procedures.\nIn a SIP MESSAGE request, the MCData client:\n1)\twhen sending SDS messages or SDS disposition notifications:\na)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\nb)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8]; and\nc)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP MESSAGE request;\n2)\twhen sending FD messages, FD disposition notifications, FD media storage function discovery or access a list of deferred group communications messages:\na)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.fd media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\nb)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8]; and\nc)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP MESSAGE request;\n3)\tmay include a P-Preferred-Identity header field in the SIP MESSAGE request containing a public user identity as specified in 3GPP TS 24.229 [5]; and\n4)\tshall set the Request-URI to the public service identity identifying the participating MCData function serving the MCData user.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.5\tLocation information",
                            "text_content": "This procedure is initiated by the MCData client when it is including location report information:\n1)\tas part of a SIP request for a specified location trigger;\n2)\tas part of a SIP request containing an MCData emergency alert ; or\n3)\tas part of a SIP request unrelated to location triggers or emergency situations (for example, responding to a location information request).\nEditor's Note: [eMCData3, CR 0291R1, C1-221908] Text in this spec where location information is included for reporting may need to be reviewed/revised/updated to functionally harmonize with text in this procedure or, possibly, to reference this procedure directly.\nThe MCData client:\n1)\tshall include, unless already present, an application/vnd.3gpp.location-info+xml MIME body as specified in clause D.4, with a <Report> element included in the <location-info> root element;\n2)\tif the location information is being included because of the firing of a trigger configured in a <TriggeringCriteria> element or in an <EmergencyTriggeringCriteria> element of a <Configuration> element contained in an application/vnd.3gpp.mcdata-location-info+xml MIME body, as specified in clause D.4:\na)\tshall set the <ReportType> attribute to the \"Emergency\" value if the activated trigger was configured in the <EmergencyTriggeringCriteria>, otherwise shall set the <ReportType> attribute to the \"NonEmergency\" value;\nb)\tshall include the <TriggerId> child elements, where each element is set to the value of the <Trigger-Id> attribute associated with the trigger that has fired;\nc)\tshall include the location reporting elements corresponding to the triggers that have fired;\nd)\tshall set the minimumReportInterval timer to the minimumReportInterval time and start the timer;\ne)\tshall reset all triggers; and\nf)\tshall skip the rest of the steps of this procedure;\n3)\tif the location information is being included to enable processing for an emergency related situation (such as an emergency alert, emergency group communication or emergency one-to-one communication):\na)\thall set the <ReportType> attribute to the \"Emergency\" value;\nb)\tshall populate the <CurrentLocation> element of the <Report> element to contain values for the <longitude>, <latitude>, <CurrentServingEcgi> and <locTimestamp> elements, as well as other not already included elements indicated by the <EmergencyLocationInformation> element, if present in the <Configuration> element contained in an application/vnd.3gpp.mcdata-location-info+xml MIME body, per clause D.4; and\nc)\tshall skip the rest of the steps of this procedure; and\n4)\tif the location information is being included as a result of a location information request:\na)\tshall set the <ReportType> attribute to the \"NonEmergency\" value;\nb)\tshall include the <ReportID> attribute set to the value of the <RequestID> attribute in the received location request; and\nc)\tshall populate the <CurrentLocation> element of the <Report> element containing at least a <CurrentCoordinate> element.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.6\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.7\tHandling of in-progress emergency and imminent peril conditions",
                            "text_content": "This clause covers both on-demand session and pre-established sessions.\nUpon receiving a request from an MCData user to upgrade the MCData group session to either an emergency condition or an imminent peril condition on an MCData prearranged group, the MCData client shall generate a SIP re-INVITE request as specified in 3GPP TS 24.229 [5], with the clarifications given below:\n1)\tif the MCData user is requesting to upgrade the MCData group session to an in-progress emergency group state and this is an unauthorised request for an MCData emergency communication as determined by the procedures of clause 6.2.8.1.8, the MCData client:\na)\tshould indicate to the MCData user that they are not authorised to upgrade the MCData group session to an in-progress emergency group state; and\nb)\tshall skip the remaining steps of the current clause;\n2)\tif the MCData user is requesting to upgrade the MCData group session to an in-progress imminent peril state and this is an unauthorised request for an MCData imminent peril group communication as determined by the procedures of clause 6.2.8.1.8, the MCData client:\na)\tshould indicate to the MCData user that they are not authorised to upgrade the MCData group session to an in-progress imminent peril group state; and\nb)\tshall skip the remaining steps of the current clause;\n3)\tif the MCData user has requested to upgrade the MCData group session to an MCData emergency communication, the MCData client:\na)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body by following the procedures in clause 6.2.8.1.1; and\nb)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.2.8.1.2;\n4)\tif the MCData user has requested to upgrade the MCData group session to an MCData imminent peril communication, the MCData client:\na)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body by following the procedures in clause 6.2.8.1.9; and\nb)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.2.8.1.12;\n5)\tif the SIP re-INVITE request is to be sent within an on-demand session, shall include in the SIP re-INVITE request an SDP offer according to 3GPP TS 24.229 [5] with the clarifications specified in clause 9.2.4.2.1 (for SDS session), or 10.2.5.2.1 (for FD using media plane), as appropriate;\n6)\tif the SIP re-INVITE request is to be sent within a pre-established session, shall include an SDP offer in the SIP re-INVITE request according to 3GPP TS 24.229 [5], based upon the parameters already negotiated for the pre-established session;\nNOTE:\tThe SIP re-INVITE request can be sent within an on-demand session or a pre-established session. If the SIP re-INVITE request is sent within a pre-established session, the SDP offer for the media parameters is expected to be the same as was negotiated in the existing pre-established session.\n7)\tshall include an application/vnd.3gpp.mcdata-location-info+xml MIME body with a <Report> element included in the <location-info> root element (see clause D.4) and include in the <Report> element the specific location information configured for the MCData emergency alert location trigger; and\n8)\tshall send the SIP re-INVITE request according to 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP re-INVITE request, the MCData client:\n1)\tshall interact with the user plane as specified in 3GPP TS 24.582 [15]; and\n2)\tshall perform the actions specified in clause 6.2.8.1.4.\nOn receiving a SIP INFO request where the Request-URI contains an MCData session ID identifying an ongoing group session, the MCData client shall follow the actions specified in clause 6.2.8.1.13.\nOn receiving a SIP 4xx response, SIP 5xx response or a SIP 6xx response to the SIP re-INVITE request the MCData client shall perform the actions specified in clause 6.2.8.1.5.\nThis clause covers both on-demand session and pre-established sessions.\nUpon receiving a request from an MCData user to cancel the in-progress emergency condition on a prearranged MCData group, the MCData client shall generate a SIP re-INVITE request while in an ongoing prearranged group communication by following the UE originating session procedures specified in 3GPP TS 24.229 [5], with the clarifications given below, otherwise generate a SIP MESSAGE request by following client procedure of clause 16.2.1.4 of present document.\nThe MCData client:\n1)\tif the MCData user is not authorised to cancel the in-progress emergency group state of the MCData group as determined by the procedures of clause 6.2.8.1.7, the MCData client:\na)\tshould indicate to the MCData user that they are not authorised to cancel the in-progress emergency group state of the MCData group; and\nb)\tshall skip the remaining steps of the current clause;\n2)\tshall, if the MCData user is cancelling an in-progress emergency condition and optionally an MCData emergency alert originated by the MCData user, include an application/vnd.3gpp.mcdata-info+xml MIME body populated as specified in clause 6.2.8.1.3;\n3)\tshall, if the MCData user is cancelling an in-progress emergency condition and an MCData emergency alert originated by another MCData user, include an application/vnd.3gpp.mcdata-info+xml MIME body populated as specified in clause 6.2.8.1.14;\n4)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element:\na)\tthe <session-type> element set to a value of \"prearranged\"; and\nb)\tthe <mcdata-request-uri> element set to the group identity;\nNOTE 1:\tThe MCData ID of the originating MCData user is not included in the body, as this will be inserted into the body of the SIP INVITE request that is sent by the originating participating MCData function.\n5)\tshall include the g.3gpp.mcdata media feature tag in the Contact header field of the SIP re-INVITE request according to IETF RFC 3840 [16];\n6)\tif the SIP re-INVITE request is to be sent within an on-demand session, shall include in the SIP re-INVITE request an SDP offer according to 3GPP TS 24.229 [5] with the clarifications specified in clause  9.2.4.2.1 (for SDS session), or 10.2.5.2.1 (for FD using media plane), as appropriate;\n7)\tif the SIP re-INVITE request is to be sent within a pre-established session, shall include an SDP offer in the SIP re-INVITE request according to 3GPP TS 24.229 [5], based upon the parameters already negotiated for the pre-established session;\nNOTE 2:\tThe SIP re-INVITE request can be sent within an on-demand session or a pre-established session. If the SIP re-INVITE request is sent within a pre-established session, the SDP offer for the media parameters is expected to be the same as was negotiated in the existing pre-established session.\n8)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.2.8.1.2; and\n9)\tshall send the SIP re-INVITE request according to 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP re-INVITE request, the MCData client:\n1)\tshall interact with the user plane as specified in 3GPP TS 24.582 [15];\n2)\tshall set the MCData emergency group state of the group to \"MDEG 1: no-emergency\";\n3)\tshall set the MCData emergency group communication state of the group to \"MDEGC 1: emergency-gc-capable\"; and\n4)\tif the MCData emergency alert state is set to \"MDEA 4: Emergency-alert-cancel-pending\", the sent SIP re-INVITE request did not contain an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body and the SIP 2xx response to the SIP request for a priority group communication does not contain a Warning header field as specified in clause 4.9 with the warning text containing the mcdata-warn-code set to \"149\", shall set the MCData emergency alert state to \"MDEA 1: no-alert\".\nOn receiving a SIP INFO request where the Request-URI contains an MCData session ID identifying an ongoing group session, the MCData client shall follow the actions specified in clause 6.2.8.1.13.\nOn receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to the SIP re-INVITE request:\n1)\tshall set the MCData emergency group state as \"MDEG 2: in-progress\";\n2)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response contains an application/vnd.3gpp.mcdata-info+xml MIME body with an <alert-ind> element set to a value of \"true\" and the sent SIP re-INVITE request did not contain an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData client shall set the MCData emergency alert state to \"MDEA 3: emergency-alert-initiated\"; and\n3)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response did not contain an application/vnd.3gpp.mcdata-info+xml MIME body with an <alert-ind> element and did not contain an <originated-by> element, the MCData emergency alert (MDEA) state shall revert to its value prior to entering the current procedure.\nNOTE 3:\tIf the in-progress emergency group state cancel request is rejected, the state of the session does not change, i.e. continues with MCData emergency group communication level priority.\nThis clause covers both on-demand session and pre-established sessions.\nUpon receiving a request from an MCData user to cancel the in-progress imminent peril condition on a prearranged MCData group, the MCData client shall generate a SIP re-INVITE request by following the procedures specified in 3GPP TS 24.229 [5], with the clarifications given below:\nThe MCData client:\n1)\tif the MCData user is not authorised to cancel the in-progress imminent peril group state of the MCData group as determined by the procedures of clause 6.2.8.1.10, the MCData client:\na)\tshould indicate to the MCData user that they are not authorised to cancel the in-progress imminent peril group state of the MCData group; and\nb)\tshall skip the remaining steps of the current clause;\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body populated as specified in clause 6.2.8.1.11;\n3)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.2.8.1.12;\n4)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element:\na)\tthe <session-type> element set to a value of \"prearranged\"; and\nb)\tthe <mcdata-request-uri> element set to the group identity;\nNOTE 1:\tThe MCData ID of the originating MCData user is not included in the body, as this will be inserted into the body of the SIP re-INVITE request that is sent by the originating participating MCData function.\n5)\tshall include the g.3gpp.mcdata media feature tag in the Contact header field of the SIP re-INVITE request according to IETF RFC 3840 [16];\n6)\tif the SIP re-INVITE request is to be sent within an on-demand session, shall include in the SIP re-INVITE request an SDP offer according to 3GPP TS 24.229 [5] with the clarifications specified in clause 9.2.4.2.1 (for SDS session), or 10.2.5.2.1 (for FD using media plane), as appropriate;\n7)\tif the SIP re-INVITE request is to be sent within a pre-established session, shall include an SDP offer in the SIP re-INVITE request according to 3GPP TS 24.229 [5], based upon the parameters already negotiated for the pre-established session; and\nNOTE 2:\tThe SIP re-INVITE request can be sent within an on-demand session or a pre-established session. If the SIP re-INVITE request is sent within a pre-established session, the SDP offer for the media parameters is expected to be the same as was negotiated in the existing pre-established session.\n8)\tshall send the SIP re-INVITE request according to 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP re-INVITE request, the MCData client:\n1)\tshall interact with the user plane as specified in 3GPP TS 24.582 [15];\n2)\tshall set the MCData imminent peril group state of the group to \"MDIG 1: no-imminent-peril\"; and\n3)\tshall set the MCData imminent peril group communication state of the group to \"MDIGC 1: imminent-peril-gc-capable\".\nOn receiving a SIP 4xx, SIP 5xx response or SIP 6xx response to the SIP re-INVITE request:\n1)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response:\na)\tcontains an application/vnd.3gpp.mcdata-info+xml MIME body with an <imminentperil-ind> element set to a value of \"true\"; or\nb)\tdoes not contain an application/vnd.3gpp.mcdata-info+xml MIME body with an <imminentperil-ind> element;\nthen the MCData client shall set the MCData imminent peril group state as \"MDIG 2: in-progress\".\nNOTE 3:\tThis is the case where the MCData client requested the cancellation of the MCData imminent peril in-progress state and was rejected.\nThis clause covers both on-demand session and pre-established sessions.\nUpon receipt of a SIP re-INVITE request, the MCData client:\n1)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <emergency-ind> element set to a value of \"true\":\na)\tshould display to the MCData user the MCData ID of the originator of the MCData emergency group communication and an indication that this is an MCData emergency group communication;\nb)\tif the <mcdatainfo> element containing the <mcdata-Params> element contains an <alert-ind> element set to \"true\", should display to the MCData user an indication of the MCData emergency alert and associated information;\nc)\tshall set the MCData emergency group state to \"MDEG 2: in-progress\";\nd)\tshall set the MCData imminent peril group state to \"MDIG 1: no-imminent-peril\"; and\ne)\tshall set the MCData imminent peril group communication state to \"MDIGC 1: imminent-peril-gc-capable\";\n2)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <imminentperil-ind> element set to a value of \"true\":\na)\tshould display to the MCData user the MCData ID of the originator of the MCData imminent peril group communication and an indication that this is an MCData imminent peril group communication; and\nb)\tshall set the MCData imminent peril group state to \"MDIG 2: in-progress\";\n3)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <emergency-ind> element set to a value of \"false\":\na)\tshould display to the MCData user the MCData ID of the MCData user cancelling the MCData emergency group communication;\nb)\tif the <mcdatainfo> element containing the <mcdata-Params> element contains an <alert-ind> element set to \"false\":\ni)\tshould display to the MCData user an indication of the MCData emergency alert cancellation and the MCData ID of the MCData user cancelling the MCData emergency alert; and\nii)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body including an <originated-by> element:\nA)\tshould display to the MCData user the MCData ID contained in the <originated-by> element of the MCData user that originated the MCData emergency alert; and\nB)\tif the MCData ID contained in the <originated-by> element is the MCData ID of the receiving MCData user shall set the MCData emergency alert state to \"MDEA 1: no-alert\";\nc)\tshall set the MCData emergency group state to \"MDEG 1: no-emergency\"; and\nd)\tif the MCData emergency group communication state of the group is set to \"MDEGC 3: emergency-communication-granted\", shall set the MCData emergency group communication state of the group to \"MDEGC 1: emergency-gc-capable\";\n4)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <imminentperil-ind> element set to a value of \"false\":\na)\tshould display to the MCData user the MCData ID of the MCData user cancelling the MCData imminent peril group communication and an indication that this is an MCData imminent peril group communication;\nb)\tshall set the MCData imminent peril group state to \"MDIG 1: no-imminent-peril\"; and\nc)\tshall set the MCData imminent peril group communication state to \"MDIGC 1: imminent-peril-gc-capable\";\n5)\tshall check if a Resource-Priority header field is included in the incoming SIP re-INVITE request and may perform further actions outside the scope of this specification to act upon an included Resource-Priority header field as specified in 3GPP TS 24.229 [5];\n6)\tshall accept the SIP re-INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\n7)\tshall include the g.3gpp.mcdata media feature tag in the Contact header field of the SIP 200 (OK) response;\n8)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" in the Contact header field of the SIP 200 (OK) response;\n9)\tif the SIP re-INVITE request was received within an on-demand session, shall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP re-INVITE request according to 3GPP TS 24.229 [5] with the clarifications given in clause 9.2.4.2.2 (for SDS session), or 10.2.5.2.2 (for FD using media plane), as appropriate;\n10)\tif the SIP re-INVITE request was received within a pre-established session, shall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP re-INVITE request according to 3GPP TS 24.229 [5], based upon the parameters already negotiated for the pre-established session;\nNOTE:\tThe SIP re-INVITE request can be received within an on-demand session or a pre-established session. If the SIP re-INVITE request is sent within a pre-established session, the SDP offer for the media parameters is expected to be the same as was negotiated in the existing pre-established session.\n11)\tshall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5]; and\n12)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15].\nUpon receiving a request from an MCData user to cancel the in-progress emergency condition on a MCData group on which there is no communication ongoing, the MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] with the clarifications given below.\nNOTE 1:\tThis SIP MESSAGE request is assumed to be sent out-of-dialog.\nThe MCData client:\n1)\tif the MCData user is not authorised to cancel the in-progress emergency group state of the MCData group as determined by the procedures of clause 6.2.8.1.7, the MCData client:\na)\tshould indicate to the MCData user that they are not authorised to cancel the in-progress emergency group state of the MCData group; and\nb)\tshall skip the remaining steps of the current clause;\n2)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP MESSAGE request;\n3)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n4)\tmay include a P-Preferred-Identity header field in the SIP MESSAGE request containing the public user identity of the originator as specified in 3GPP TS 24.229 [5];\n5)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body as specified in clause D.1 with the <mcdatainfo> element containing the <mcdata-Params> element with:\na)\tthe <mcdata-request-uri> element set to the MCData group identity; and\nb)\tthe <emergency-ind> element set to a value of \"false\";\n6)\tif the MCData user has additionally requested the cancellation of an MCData emergency alert originated by MCData user, shall include an <alert-ind> element set to a value of \"false\" in the <mcdatainfo> element containing the <mcdata-Params> element;\n7)\tshall set the Request-URI to the public service identity identifying the participating MCData function serving the group identity;\n8)\tif the generated SIP MESSAGE request contains an <alert -ind> element in the application/vnd.3gpp.mcdata-info+xml MIME body, shall set the MCData emergency alert state to \"MDEA 4: Emergency-alert-cancel-pending\"; and\n9)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5].\nOn receipt of a SIP MESSAGE request containing an application/vnd.3gpp.mcdata-info+xml MIME body with an <emergency-ind-rcvd> element set to a value of \"true\" and an <mcdata-client-id> matching the MCData client ID included in the sent SIP MESSAGE request:\n1)\tif an <emergency-ind> element is present in the application/vnd.3gpp.mcdata-info+xml MIME body of received SIP MESSAGE request and is set to a value of \"false\":\na)\tshall set the MCData emergency group state of the group to \"MDEG 1: no-emergency\".\nNOTE 3:\tThe case where an <emergency-ind> element is set to true is possible but not handled specifically above as it results in no state changes.\n2)\tif the <alert-ind> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the received SIP MESSAGE request is set to a value of \"true\" and if the MCData emergency alert state is set to \"MDEA 4: emergency-alert-cancel-pending\" and the sent SIP MESSAGE request contained an <alert-ind> element set to value \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body, shall set the MCData emergency alert state to \"MDEA 3: emergency-alert-initiated\"; and\nNOTE 4:\tIt would appear to be an unusual situation for the initiator of an MCData emergency alert to not be able to clear their own alert. Nevertheless, an MCData user can be configured to be authorised to initiate MCData emergency alerts but not have the authority to clear them. Hence, the case is covered here.\n3)\tif the <alert-ind> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the received SIP MESSAGE request is set to a value of \"false\" and if the MCData emergency alert state is set to \"MDEA 4: emergency-alert-cancel-pending\" and the sent SIP MESSAGE request contained an <alert-ind> element set to value \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body, shall:\na)\tset the MCData emergency alert state to \"MDEA 1: no-alert\"; and\nb)\tclear the MCData emergency state if not already cleared.\nOn receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to the sent SIP MESSAGE request, the MCData client:\n1)\tif the received SIP 4xx response, SIP 5xx response or SIP 6xx response contains an application/vnd.3gpp.mcdata-info+xml MIME body as specified in clause D.1 with the <mcdatainfo> element containing the <mcdata-Params> element with the <alert-ind> element set to a value of \"true\" and the sent SIP MESSAGE request contained an <alert-ind> element set to value \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body and the MCData emergency alert state is set to \"MDEA 4: emergency-alert-cancel-pending\", shall set the MCData emergency alert state to \"MDEA 3: emergency-alert-initiated\".\nNOTE 5:\tIn this case, <emergency-ind> element is set to true is possible but not handled specifically above as it results in no state changes.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.8\tPriority communication conditions",
                            "text_content": "This clause is referenced from other procedures.\nWhen the MCData emergency state is set and the MCData user is authorised to initiate an MCData emergency group communication on the targeted MCData group as determined by the procedures of clause 6.2.8.1.8, the MCData client:\n1)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP INVITE request or SIP REFER request, an <emergency-ind> element set to \"true\";\n2)\tif the MCData emergency group communication state is set to \"MDEGC 1: emergency-gc-capable\", shall set the MCData emergency group communication state to \"MDEGC 2: emergency-communication-requested\";\n3)\tif the MCData user has also requested an MCData emergency alert to be sent and this is an authorised request for MCData emergency alert as determined by the procedures of clause 6.2.8.1.6, and the MCData emergency alert state is set to \"MDEA 1: no-alert\", shall:\na)\tset the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body to \"true\" and set the MCData emergency alert state to \"MDEA 2: emergency-alert-confirm-pending\"; and\nb)\tinclude in the SIP INVITE request the specific location information for MCData emergency alert as specified in clause 6.2.5.1;\n4)\tif the MCData user has not requested an MCData emergency alert to be sent and the MCData emergency alert state is set to \"MDEA 1: no-alert\", shall set the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body to \"false\"; and\n5)\tif the MCData client emergency group state of the group is set to a value other than \"MDEG 2: in-progress\", set the MCData client emergency group state of the MCData group to \"MDEG 4: confirm-pending\".\nNOTE 1:\tThis is the case of an MCData user already being in the MCData emergency state it initiated previously while originating an MCData emergency group communication or MCData emergency alert. All group communications the MCData user originates while in MCData emergency state will be MCData emergency group communications.\nWhen the MCData emergency state is clear and the MCData emergency group communication state is set to \"MDEGC 1: emergency-gc-capable\" and the the MCData user is authorised to initiate an MCData emergency group communication on the targetted MCData group as determined by the procedures of clause 6.2.8.1.8, the MCData client:\n1)\tshall set the MCData emergency state;\n2)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP INVITE request or SIP REFER request an <emergency-ind> element set to \"true\" and set the MCData emergency group communication state to \"MDEGC 2: emergency-communication-requested\" state;\n3)\tif the MCData user has also requested an MCData emergency alert to be sent and this is an authorised request for MCData emergency alert as determined by the procedures of clause 6.2.8.1.6, shall:\na)\tinclude in the application/vnd.3gpp.mcdata-info+xml MIME body the <alert-ind> element set to \"true\" and set the MCData emergency alert state to \"MDEA 2: emergency-alert-confirm-pending\"; and\nb)\tinclude in the SIP INVITE request the specific location information for MCData emergency alert as specified in clause 6.2.5.1;\n4)\tif the MCData user has not requested an MCData emergency alert to be sent, shall set the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body to \"false\"; and\n5)\tif the MCData client emergency group state of the group is set to a value other than \"MDEG 2: in-progress\", shall set the MCData client emergency group state of the MCData group to \"MDEG 4: confirm-pending\".\nNOTE 2:\tThis is the case of an initial MCData emergency group communication and optionally an MCData emergency alert being sent. As the MCData emergency state is not sent, there is no MCData emergency alert outstanding.\nNOTE 3:\tAn MCData group communication originated by an affiliated member of an MCData group which is in an in-progress emergency state (as tracked on the MCData client by the MCData client emergency group state), but is not in an MCData emergency state of their own, will also be an MCData emergency group communication. The <emergency-ind> and <alert-ind> elements of the application/vnd.3gpp.mcdata-info+xml MIME body do not need to be included in this case and hence, no action needs to be taken in this clause.\nThis clause is referenced from other procedures.\nIf the MCData emergency group communication state is set to either \"MDEGC 2: emergency-communication-requested\" or \"MDEGC 3: emergency-communication-granted\" and this is an authorised request for an MCData emergency group communication as determined by the procedures of clause 6.2.8.1.8, or the MCData client emergency group state of the group is set to \"MDEG 2: in-progress\", the MCData client shall include in the SIP INVITE request or SIP REFER request a Resource-Priority header field populated with the values for an MCData emergency group communication as specified in clause 6.2.8.1.15.\nNOTE:\tThe MCData client ideally would not need to maintain knowledge of the in-progress emergency state of the group (as tracked on the MCData client by the MCData client emergency group state) but can use this knowledge to provide a Resource-Priority header field set to emergency level priority, which starts the infrastructure priority adjustment process sooner than otherwise would be the case.\nIf this is an authorised request to cancel the MCData emergency group communication as determined by the procedures of clause 6.2.8.1.7, and the MCData client emergency group state of the group is \"no-emergency\" or \"cancel-pending\", the MCData client shall include in the SIP INVITE request or SIP REFER request a Resource-Priority header field populated with the values for a normal MCData group communication as specified in clause 6.2.8.1.15.\nThis clause is referenced from other procedures.\nIf the MCData emergency group communication state is set to \"MDEGC 3: emergency-communication-granted\" and the MCData emergency alert state is set to \"MDEA 1: no-alert\", the MCData client shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5] with the clarifications given below.\nNOTE 1:\tThis procedure assumes that the calling procedure has verified that the MCData user has made an authorised request for cancelling MCData in-progress emergency group state of the group.\nThe MCData client:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcdata-info+xml MIME body as defined in clause D.1 with the <emergency-ind> element set to \"false\";\n2)\tshall clear the MCData emergency state; and\n3)\tshall set MCData emergency group state of the MCData group to \"MDEG 3: cancel-pending\"\nNOTE 2:\tThis is the case of an MCData user who has initiated an MCData emergency group communication and wants to cancel it.\nIf the MCData emergency group communication state is set to \"MDEGC 3: emergency-communication-granted\" and the MCData emergency alert state is set to a value other than \"MDEA 1: no-alert\" and the MCData user has indicated only the MCData emergency group communication should be cancelled, the MCData client:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcdata-info+xml MIME body as defined in clause D.1 with the <emergency-ind> element set to \"false\"; and\n2)\tshall set the MCData emergency group state of the MCData group to \"MDEG 3: cancel-pending\".\nNOTE 3:\tThis is the case of an MCData user has initiated both an MCData emergency group communication and an MCData emergency alert and wishes to only cancel the MCData emergency group communication. This leaves the MCData emergency state set.\nIf the MCData emergency group communication state is set to \"MDEGC 3: emergency-communication-granted\" and the MCData emergency alert state is set to a value other than \"MDEA 1: no-alert\" and the MCData user has indicated that the MCData emergency alert on the MCData group should be cancelled in addition to the MCData emergency group communication, the MCData client:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcdata-info+xml MIME body as defined in clause D.1 with the <emergency-ind> element set to \"false\";\n2)\tif this is an authorised request to cancel an MCData emergency alert as determined by the procedures of clause 6.2.8.1.6, shall:\na)\tinclude in the application/vnd.3gpp.mcdata-info+xml MIME body an <alert-ind> element set to \"false\";\nb)\tset the MCData emergency alert state to \"MDEA 4: Emergency-alert-cancel-pending\"; and\nc)\tclear the MCData emergency state;\n3)\tshould, if this is not an authorised request to cancel an MCData emergency alert as determined by the procedures of clause 6.2.8.1.6, indicate to the MCData user that they are not authorised to cancel the MCData emergency alert; and\n4)\tshall set the MCData emergency group state of the MCData group to \"MDEG 3: cancel-pending\".\nNOTE 4:\tThis is the case of an MCData user that has initiated both an MCData emergency group communication and an MCData emergency alert and wishes to cancel both.\nIn the procedures in this clause, a priority group communication refers to an MCData emergency group communication or an MCData imminent peril group communication.\nOn receiving a SIP 2xx response to a SIP request for a priority group communication, the MCData client:\n1)\tif the MCData emergency group communication state is set to \"MDEGC 2: emergency-communication-requested\" or \"MDEGC 3: emergency-communication-granted\":\na)\tshall set the MCData client emergency group state of the group to \"MDEG 2: in-progress\";\nb)\tif the MCData emergency alert state is set to \"MDEA 2: emergency-alert-confirm-pending\" and the SIP 2xx response to the SIP request for a priority group communication does not contain a Warning header field as specified in clause 4.9 with the warning text containing the mcdata-warn-code set to \"149\", shall set the MCData emergency alert state to \"MDEA 3: emergency-alert-initiated\";\nc)\tshall set the MCData emergency group communication state to \"MDEGC 3: emergency-communication-granted\"; and\nd)\tshall set the MCData imminent peril group communication state to \"MDIGC 1: imminent-peril-capable\" and the MCData imminent peril group state to \"MDIG 1: no-imminent-peril\"; or\n2)\tif the MCData imminent peril group communication state is set to \"MDIGC 2: imminent-peril-communication-requested\" or \"MDIGC 3: imminent-peril-communication-granted\" and the SIP 2xx response to the SIP request for an imminent peril group communication does not contain a Warning header field as specified in clause 4.9, with the warning text containing the mcdata-warn-code set to \"149\":\na)\tset the MCData imminent peril group communication state to \"MDIGC 3: imminent-peril-communication-granted\"; and\nb)\tset the MCData imminent peril group state to \"MDIG 2: in-progress\".\nIn the procedures in this clause, a priority group communication refers to an MCData emergency group communication or an MCData imminent peril group communication.\nUpon receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to a SIP request for a priority group communication the MCData client:\n1)\tif the MCData emergency group communication state is set to \"MDEGC 2: emergency-communication-requested\" or \"MDEGC 3: emergency-communication-granted\":\na)\tshall set the MCData emergency group communication state to \"MDEGC 1: emergency-gc-capable\";\nb)\tif the MCData client emergency group state of the group is \"MDEG 4: confirm-pending\", shall set the MCData client emergency group state of the group to \"MDEG 1: no-emergency\"; and\nc)\tif the sent SIP request for a priority group communication contained an application/vnd.3gpp.mcdata-info+xml MIME body with an <alert-ind> element set to a value of \"true\", shall set the MCData emergency alert state to \"MDEA 1: \"no-alert\"; and\n2)\tif the MCData imminent peril group communication state is set to \"MDIGC 2: imminent-peril-communication-requested\" or \"MDIGC 3: imminent-peril-communication-granted\":\na)\tshall set the MCData imminent peril group state to \"MDIG 1: no-imminent-peril\"; and\nb)\tshall set the MCData imminent peril group communication state to \"MDIGC 1: imminent-peril-gc-capable\".\nIf the MCData client receives a request from the MCData user to send an MCData emergency alert and:\n1)\tif the <allow-activate-emergency-alert> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling MCData user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\" and the group document (see 3GPP TS 24.481 [11]) of the MCData group indicated by the MCData user does not contain a <list-service> element that contains a <preconfigured-group-use-only> element set to the value \"true\"; and\n2)\tif the \"entry-info\" attribute of the <entry> element of the <GroupEmergencyAlert> element contained within the <Common> element of the <mcdata-user-profile> element within MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of:\na)\t\"DedicatedGroup\", and if the <uri-entry> element of the <entry> element of the <GroupEmergencyAlert> element of the <Common> element of the <mcdata-user-profile> element within MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) contains the MCData group identity of the MCData group targeted by the calling MCData user; or\nb)\t\"UseCurrentlySelectedGroup\" and the <mcdata-allow-emergency-alert> element of the <actions> element of a <rule> element of the <ruleset> element of the <list-service> element of the group document identified by the MCData group identity targeted for the emergency alert is set to a value of \"true\" as specified in 3GPP TS 24.481 [11];\nthen the MCData emergency alert request shall be considered to be an authorised request for an MCData emergency alert. In all other cases, it shall be considered to be an unauthorised request for originating an MCData emergency alert.\nIf the MCData client receives a request from the MCData user to cancel an MCData emergency alert to an MCData group, and if the <allow-cancel-emergency-alert> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling MCData user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\", then the MCData emergency alert cancellation request shall be considered to be an authorised request to cancel an MCData emergency alert. In all other cases, it shall be considered to be an unauthorised request to cancel an MCData emergency alert.\nWhen the MCData client receives a request from the MCData user to cancel the in-progress emergency state of a group, the MCData client determines, based on local policy (e.g., if the requester is dispatcher or initiator of the MCData emergency group communication, etc.), whether to send the emergency group state cancel request or not.\nWhen the MCData client receives a request from the MCData user to originate an MCData emergency group communication the MCData client shall check the following:\n1)\tif the <allow-emergency-group-call> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\" and\na)\tif the \"entry-info\" attribute of the <entry> element of the <MCDataGroupInitiation> element of the <EmergencyCall> element contained within the <MCData-group-call> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"DedicatedGroup\" and if the <uri-entry> element of the <entry> element of the <MCDataGroupInitiation> element contains the identity of the MCData group targeted by the calling MCData user; or\nb)\tif the \"entry-info\" attribute of the <entry> element of the <MCDataGroupInitiation> element of the <EmergencyCall> element contained within the <MCData-group-call> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"UseCurrentlySelectedGroup\";\nthen the MCData emergency group communication request shall be considered to be an authorised request for an MCData emergency group communication only for SDS session, SDS pre-established session or FD using media plane.\nEditor's note: The restriction stated above, to limit the authorization for emergency group communications and/or imminent peril group communication only to certain types of MCData services is FFS.\nIn all other cases, the request to originate an MCData emergency group communication shall be considered to be an unauthorised request to originate an MCData emergency group communication.\nWhen the MCData client receives a request from the MCData user to originate an MCData imminent peril group communication the MCData client shall check the following:\n1)\tif the <allow-imminent-peril-call> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\" and:\na)\tif the \"entry-info\" attribute of the <entry> element of the <MCDataGroupInitiation> element contained within the <ImminentPerilCall> element contained within the <MCData-group-call> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"DedicatedGroup\" and if the <MCDataGroupInitiation> element contains the identity of the MCData group targeted by the calling MCData user; or\nb)\tif the \"entry-info\" attribute of the <entry> element of the <MCDataGroupInitiation> element contained within the <ImminentPerilCall> element contained within the <MCData-group-call> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"UseCurrentlySelectedGroup\";\nthen the MCData imminent peril group communication request shall be considered to be an authorised request for an MCData imminent peril group communication only for SDS session, SDS pre-established session or FD using media plane.\nEditor's note: The restriction stated above, to limit the authorization for emergency group communications and/or imminent peril group communication only to certain types of MCData services is FFS.\nIn all other cases, the request to originate an MCData imminent peril group communication shall be considered to be an unauthorised request to originate an MCData imminent peril group communication.\nThis clause is referenced from other procedures.\nWhen the MCData client receives a request from the MCData user to originate an MCData imminent peril group communication, and this is an authorised request for an MCData imminent peril group communication as determined by the procedures of clause 6.2.8.1.8, the MCData client:\n1)\tif the MCData client imminent peril group state is set to \"MDIGC 1: imminent-peril-gc-capable\" and the in-progress emergency state of the group is set to a value of \"false\":\na)\tshall include in the SIP request an application/vnd.3gpp.mcdata-info+xml MIME body as defined in Annex D.1 with the <imminentperil-ind> element set to \"true\" and set the MCData emergency group communication state to \"MDIGC 2: imminent-peril-call-requested\" state; and\nb)\tif the MCData client imminent peril group state of the group is set to a value other than \"MDIG 2: in-progress\" shall set the MCData client emergency group state of the MCData group to \"MDIG 4: confirm-pending\".\nNOTE:\tAn MCData group communication originated by an affiliated member of an MCData group which is in an in-progress imminent peril state (as tracked on the MCData client by the MCData client imminent peril group state) will also have the priority associated with MCData imminent peril group communications. The <imminentperil-ind> element of the application/vnd.3gpp.mcdata-info MIME body does not need to be included in this case, nor do any state changes result, and hence no action needs to be taken in this clause.\nWhen the MCData client receives a request from the MCData user to cancel an MCData imminent peril group communication the MCData client shall:\n1)\tif the <allow-cancel-imminent-peril> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\" the MCData imminent peril communication cancellation request shall be considered to be an authorised request to cancel the MCData imminent peril group communication; or\n2)\tif the <allow-cancel-imminent-peril> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"false\" the MCData imminent peril communication cancellation request shall be considered to be an unauthorised request to cancel the MCData imminent peril group communication.\nThis clause is referenced from other procedures.\nIf the MCData imminent peril group communication state is set to \"MDIGC 3: imminent-peril-call-granted\" or the MCData imminent peril group state of the MCData group is set to \"MDIG 2: in-progress\", the MCData client shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5] with the clarifications given below.\nNOTE 1:\tThis procedure assumes that the calling procedure has verified that the MCData user has made an authorised request for cancelling the in-progress imminent peril group state of the group.\nThe MCData client:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcdata-info+xml MIME body as defined in clause D.1 with the <imminentperil-ind> element set to \"false\"; and\n2)\tshall set MCData imminent peril group state of the MCData group to \"MDIG 3: cancel-pending\".\nNOTE 2:\tThis is the case of an MCData user who has initiated an MCData imminent peril group communication and wants to cancel it, or another authorised member of the group who wishes to cancel the in-progress imminent peril state of the group.\nThis clause is referenced from other procedures.\nWhen the MCData imminent peril group communication state is set to \"MDIGC 2: imminent-peril-call-requested\" or \"MDIGC 3: imminent-peril-call-granted\" and the MCData user is authorised to initiate an MCData imminent peril group communication on the targeted MCData group as determined by the procedures of clause 6.2.8.1.8, or the MCData client imminent peril state of the group is set to \"MDIG 2: in-progress\", the MCData client:\n1)\tshall include in the SIP INVITE request or SIP REFER request a Resource-Priority header field populated with the values for an MCData imminent peril group communication as specified in clause 6.2.8.1.15.\nNOTE:\tThe MCData client ideally would not need to maintain knowledge of the in-progress imminent peril state of the group (as tracked on the MCData client by the MCData client imminent peril group state) but can use this knowledge to provide a Resource-Priority header field set to imminent peril level priority, which starts the infrastructure priority adjustment process sooner than otherwise would be the case.\nWhen the MCData imminent peril group communication state is set to \"MDIGC 1: imminent-peril-gc-capable\" and the MCData user is authorised to cancel MCData imminent peril group communications as determined by the procedures of clause 6.2.8.1.10, or the MCData client imminent peril group state of the group is \"MDIG 1: no-imminent-peril\" or \"MDIG 3: cancel-pending\", the MCData client:\n1)\tshall include in the SIP INVITE request or SIP REFER request a Resource-Priority header field populated with the values for a normal MCData group communication as specified in clause 6.2.8.1.15.\nThis clause is referenced from other procedures.\nUpon receiving a SIP INFO request within the dialog of the SIP request for a priority group communication:\n-\twith the Info-Package header field containing the g.3gpp.mcdata-info package name;\n-\twith the application/vnd.3gpp.mcdata-info+xml MIME body associated with the info package according to IETF RFC 6086 [21]; and\n-\twith one or more of the <alert-ind>, <imminentperil-ind> and <emergency-ind> elements set in the application/vnd.3gpp.mcdata-info+xml MIME body;\nthe MCData client:\n1)\tshall send a SIP 200 (OK) response to the SIP INFO request as specified in 3GPP TS 24.229 [5];\n2)\tif the MCData emergency group communication state is set to \"MDEGC 3: emergency-call-granted\":\na)\tif the MCData emergency alert state is set to \"MDEA 2: emergency-alert-confirm-pending\":\ni)\tif the <alert-ind> element is set to a value of \"false\", shall set the MCData emergency alert state to \"MDEA 1: no-alert\"; and\nii)\tif the <alert-ind> element is set to a value of \"true\", shall set the MCData emergency alert state to \"MDEA 3: emergency-alert-initiated\";\n3)\tif the MCData imminent peril group communication state is set to \"MDIGC 2: imminent-peril-call-requested\" or \"MDIGC 3: imminent-peril-call-granted\":\na)\tif the <imminentperil-ind> element is set to a value of \"false\" and an <emergency-ind> element is set to a value of \"true\", shall:\ni)\tset the MCData imminent peril group state to \"MDIG 1: no-imminent-peril\";\nii)\tset the MCData imminent peril group communication state to \"MDIGC 1: imminent-peril-capable\"; and\niii)\tset the MCData client emergency group state of the group to \"MDEG 2: in-progress\"; and\nNOTE 1:\tThis is the case of an MCData client attempting to make an imminent peril group communication when the group is in an in-progress emergency group state. The MCData client will then receive a notification that the imminent peril communication request was denied, however they will be participating at the emergency level priority of the group. This could occur for example when an MCData client requests an imminent peril communication to a group that they are not currently affiliated with.\nNOTE 2:\tthe MCData client emergency group state above is the MCData client's view of the in-progress emergency state of the group.\n4)\tif the SIP request for a priority group communication sent by the MCData client did not contain an <originated-by> element and if the MCData emergency alert state is set to \"MDEA 4: Emergency-alert-cancel-pending\":\na)\tif the <alert-ind> element contained in the SIP INFO request is set to a value of \"true\", shall set the MCData emergency alert state to \"MDEA 3: emergency-alert-initiated\"; and\nb)\tif the <alert-ind> element contained in the SIP INFO request is set to a value of \"false\", shall set the MCData emergency alert state to \"MDEA 1: no-alert\".\nThis clause is referenced from other procedures.\nUpon receiving an authorised request to cancel an in-progress emergency group state of a group as determined by the procedures of clause 6.2.8.1.7 from an MCData user, the MCData client shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5] with the clarifications given below.\nThe MCData client:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcdata-info+xml MIME body as defined in clause D.1 with the <emergency-ind> element set to \"false\";\n2)\tshall set MCData emergency group state of the MCData group to \"MDEG 3: cancel-pending\"; and\n3)\tif the MCData user has indicated that an MCData emergency alert on the MCData group originated by another MCData user should be cancelled and this is an authorised request for an MCData emergency alert cancellation as determined by the procedures of clause 6.2.8.1.6:\na)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <alert-ind> element set a value of \"false\"; and\nb)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <originated-by> element set to the MCData ID of the MCData user who originated the MCData emergency alert.\nNOTE:\tWhen an MCData emergency alert is cancelled by a MCData user other than its originator, the <originated-by> element is needed to identify which MCData emergency alert is being cancelled, as more than one MCData user could have originated emergency alerts to the same group.\nThis clause is referenced from other procedures.\nWhen determining the Resource-Priority header field MCPTT namespace and priority values as specified in IETF RFC 8101 [67] to be applied to an MCData emergency group communication or an MCData emergency private (one-to-one) communication, the MCData client:\n1)\tshall retrieve the value of the <resource-priority-namespace> element contained in the <emergency-resource-priority> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]); and\n2)\tshall retrieve the value of the <resource-priority-priority> element contained in the <emergency-resource-priority> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]).\nWhen determining the Resource-Priority header field MCPTT namespace and priority values as specified in IETF RFC 8101 [67] to be applied to an MCData imminent peril group communication, the MCData client:\n1)\tshall retrieve the value of the <resource-priority-namespace> element contained in the <imminent-peril-resource-priority> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]); and\n2)\tshall retrieve the value of the <resource-priority-priority> element contained in the <imminent-peril-resource-priority> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]).\nWhen determining the Resource-Priority header field MCPTT namespace and priority values as specified in IETF RFC 8101 [67] to be applied to a normal MCData group or private (one-to-one) communication, the MCData client:\n1)\tshall retrieve the value of the <resource-priority-namespace> element contained in the <normal-resource-priority> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]); and\n2)\tshall retrieve the value of the <resource-priority-priority> element contained in the <normal-resource-priority> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]).\nNOTE:\tThe \"normal\" Resource-Priority header field value is needed to return to a normal priority value from a priority value adjusted for an MCData emergency group or private (one-to-one) communication or an MCData imminent peril group communication. The \"normal\" priority received from the EPS by use of the \"normal\" Resource-Priority header field value is expected to be the same as the \"normal\" priority received from the EPS when initiating a communication with no Resource-Priority header field included.\nThis clause is referenced from other procedures.\nUpon receipt of a SIP re-INVITE request within the pre-established session targeted by the sent SIP REFER request, and if the sent SIP REFER request was a request for an MCData emergency group communication or an MCData imminent peril group communication, the MCData client:\n1)\tif the MCData emergency group communication state is set to \"MDEGC 2: emergency-call-requested\":\na) if there is no <emergency-ind> element or an <emergency-ind> element set to a value of \"true\" contained in the application/vnd.3gpp.mcdata-info+xml MIME body received in the SIP re-INVITE request, and if no <imminentperil-ind> element is included:\ni)\tshall set the MCData client emergency group state of the group to \"MDEG 2: in-progress\" if it was not already set; and\nii)\tshall set the MCData emergency group communication state to \"MDEGC 3: emergency-call-granted\"; and\nb)\tif the MCData emergency alert state is set to \"MDEA 2: emergency-alert-confirm-pending\":\ni)\tif the SIP re-INVITE request contains an <alert-ind> element set to a value of \"true\" or does not contain an <alert-ind> element, shall set the MCData emergency alert state to \"MDEA 3: emergency-alert-initiated\"; or\nii)\tif the SIP re-INVITE request contains an <alert-ind> element set to a value of \"false\", shall set the MCData emergency alert state to \"MDEA 1: no-alert\"; and\n2)\tif the MCData imminent peril group communication state is set to \"MDIGC 2: imminent-peril-call-requested:\na)\tif the sip re-INVITE request contains an <imminentperil-ind> element set to a value of \"true\" or does not contain an <imminentperil-ind> element, shall:\ni)\tset the MCData imminent peril group communication state to \"MDIGC 3: imminent-peril-call-granted\"; and\nii)\tset the MCData imminent peril group state to \"MDIG 2: in-progress\"; or\nb)\tif the SIP re-INVITE request contains <imminentperil-ind> element set to a value of \"false\" and an <emergency-ind> element set to a value of \"true\", shall set the MCData client emergency group state of the group to \"MDEG 2: in-progress\".\nNOTE:\tThis is the case of an MCData client attempting to make an imminent peril group communication when the group is in an in-progress emergency group state. The MCData client will then receive a notification that the imminent peril communication request was denied, however they will be participating at the emergency level priority of the group. This could occur, for example, when an MCData client requests an imminent peril communication to a group that they are not currently affiliated with.\nThis clause is referenced from other procedures.\nUpon receiving a request to release the MCData emergency group communication or an MCData imminent peril group communication in an MCData group session is in-progress or is in the process of being established:\n1)\tif the MCData emergency group communication state is set to \"MDEGC 2: emergency-call-requested\":\na)\tshall set the MCData emergency group communication state to \"MDEGC 1: emergency-gc-capable\";\nb)\tif the MCData client emergency group state of the group is \"MDEG 3: confirm-pending\" shall set the MCData client emergency group state of the group to \"MDEG 1: no-emergency\"; and\nc)\tif the MCData emergency alert state is set to \"MDEA 2: emergency-alert-confirm-pending\" shall set the MCData emergency alert state to \"MDEA 1: \"no-alert\"; and\n2)\tif the MCData imminent peril group communication state is set to \"MDIGC 2: imminent-peril-call-requested\":\na)\tif the MCData imminent peril group communication state of the group is \"MDIG 4: confirm-pending\", shall set the MCData imminent peril group state to \"MDIG 1: no-imminent-peril\"; and\nb)\tshall set the MCData imminent peril group communication state to \"MDIGC 1: imminent-peril-capable\".\nThis clause is referenced from other procedures.\nUpon receiving a request to release the MCData session when an MCData emergency private communication is in-progress or is in the process of being established:\n1)\tif the MCData emergency private communication state is set to \"MDEPC 2: emergency-call-requested\":\na)\tshall set the MCData emergency private communication state to \"MDEPC 1: emergency-pc-capable\";\nb)\tif the MCData emergency private priority state of the private communication is \"MDEPP 3: confirm-pending\" shall set the MCData emergency private priority state of the private communication to \"MDEPP 1: no-emergency\"; and\nc)\tif the MCData private emergency alert state is set to \"MDPEA 2: emergency-alert-confirm-pending shall set the MCData private emergency alert state to \"MDPEA 1: no-alert\".\nIf the MCData client receives a request from the MCData user to originate an MCData emergency private communication and:\n1)\tif the <allow-emergency-private-call> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\"; and\na)\tif the \"entry-info\" attribute of the <entry> element of the <MCDataPrivateRecipient> element of the <EmergencyCall> element contained within the <One-to-One-Communication> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"UsePreConfigured\" and if the <uri-entry> element of the <entry> element of the <MCDataPrivateRecipient> element contains the MCData ID of the MCData user targeted by the calling MCData user; or\nb)\tif the \"entry-info\" attribute of the <entry> element of the <MCDataPrivateRecipient> element of the <EmergencyCall> element contained within the <One-to-One-Communication> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"LocallyDetermined\";\nthen the MCData client shall consider the MCData emergency private communication request to be an authorised request for an MCData emergency private communication. In all other cases the MCData client shall consider the MCData emergency private communication request to be an unauthorised request for an MCData emergency private communication.\nIf the MCData client receives a request from the MCData user to cancel an MCData emergency private communication and if the <allow-cancel-private-emergency-call> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\", then the MCData emergency private communication cancellation request shall be considered to be an authorised request for an MCData emergency private communication cancellation.\nIn all other cases, the MCData emergency private communication cancellation request shall be considered to be an unauthorised request for an MCData emergency private communication cancellation.\nIf the MCData client receives a request from the MCData user to send an MCData emergency alert to an MCData user and:\n1)\tif the <allow-activate-emergency-alert> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling MCData user as specified in 3GPP TS 24.484 [12] is set to a value of \"true\"; and\n2)\tif the \"entry-info\" attribute of the <entry> element of the <One-to-One-EmergencyAlert> element contained within the <OnNetwork> element of the <mcdata-user-profile> element within the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of:\na)\t\"UsePreConfigured\", and if the <uri-entry> element of the <entry> element of the <One-to-One-EmergencyAlert> element of the <OnNetwork> element of the <mcdata-user-profile> element within the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) contains the MCData ID of the targeted MCData user; or\nb)\t\"LocallyDetermined\";\nthen the MCData emergency alert request shall be considered to be an authorised request for an MCData emergency alert. In all other cases, it shall be considered to be an unauthorised request for an MCData emergency alert.\nIf the MCData client receives a request from the MCData user to cancel an MCData emergency alert to an MCData user, and if the <allow-cancel-emergency-alert> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling MCData user, as specified in 3GPP TS 24.484 [12], is set to a value of \"true\", then the MCData emergency alert cancellation request shall be considered to be an authorised request to cancel an MCData emergency alert. In all other cases, it shall be considered to be an unauthorised request to cancel an MCData emergency alert.\nThis clause is referenced from other procedures.\nWhen the MCData emergency private communication state is set to \"MDEPC 1: emergency-pc-capable\" and this is an authorised request for an MCData emergency private communication, as determined by the procedures of clause 6.2.8.3.1.1, the MCData client:\n1)\tshall set the MCData emergency state if not already set;\n2)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP request an <emergency-ind> element set to \"true\" and set the MCData emergency private communication state to \"MDEPC 2: emergency-pc-requested\";\n3)\tif the MCData user has also requested an MCData emergency alert to be sent and this is an authorised request for MCData emergency alert, as determined by the procedures of clause 6.2.8.3.1.3, shall:\na)\tinclude in the application/vnd.3gpp.mcdata-info+xml MIME body the <alert-ind> element set to \"true\" and set the MCData private emergency alert state to \"MDPEA 2: emergency-alert-confirm-pending\"; and\nb)\tinclude in the SIP request the specific location information for MCData emergency alert as specified in clause 6.2.5.1;\n4)\tif the MCData user has not requested an MCData emergency alert to be sent, shall set the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body to \"false\"; and\n5)\tif the MCData emergency private priority state of this private communication is set to a value other than \"MDEPP 2: in-progress\" shall set the MCData emergency private priority state to \"MDEPP 3: confirm-pending\".\nThis clause is referenced from other procedures.\nIf the MCData emergency private communication state is set to either \"MDEPC 2: emergency-pc-requested\" or \"MDEPC 3: emergency-pc-granted\" and this is an authorised request for an MCData emergency private communication as determined by the procedures of clause 6.2.8.3.1.1, or the MCData emergency private priority state of the communication is set to \"MDEPP 2: in-progress\", the MCData client shall include in the SIP request a Resource-Priority header field populated with the values for an MCData emergency private communication as specified in clause 6.2.8.1.15.\nNOTE:\tThe MCData client ideally would not need to maintain knowledge of the in-progress emergency state of the communication (as tracked on the MCData client by the MCData client emergency private state) but can use this knowledge to provide a Resource-Priority header field set to emergency level priority, which starts the infrastructure priority adjustment process sooner than otherwise would be the case.\nIf this is an authorised request to cancel the MCData emergency private communication as determined by the procedures of clause 6.2.8.3.1.2, or the MCData emergency private priority state of the private communication is \"MDEPP 1: no-emergency\" or \"MDEPP 3: cancel-pending\", the MCData client shall include in the SIP request a Resource-Priority header field populated with the values for a normal MCData private communication as specified in clause 6.2.8.1.15.\nThis clause is referenced from other procedures.\nOn receiving a SIP 2xx response to a SIP request for an MCData emergency private communication, and, if the MCData emergency private communication state is set to \"MDEPC 2: emergency-pc-requested\" or \"MDEPC 3: emergency-pc-granted\", the MCData client:\n1)\tshall set the MCData emergency private priority state of the communication to \"MDEPP 2: in-progress\" if it was not already set;\n2)\tshall set the MCData emergency private communication state to \"MDEPC 3: emergency-pc-granted\"; and\n3)\tif the MCData private emergency alert state is set to \"MDPEA 2: emergency-alert-confirm-pending\" and the SIP 2xx response to the SIP request for a priority private communication does not contain a Warning header field as specified in clause 4.9 with the warning text containing the mcdata-warn-code set to \"149\", shall set the MCData private emergency alert state to \"MDPEA 3: emergency-alert-initiated\".\nUpon receiving a SIP 4xx response, SIP 5xx response or a SIP 6xx response to a SIP request for an MCData emergency private communication, and, if the MCData emergency private communication state is set to \"MDEPC 2: emergency-pc-requested\" or \"MDEPC 3: emergency-pc-granted\", the MCData client:\n1)\tshall set the MCData emergency private communication state to \"MDEPC 1: emergency-pc-capable\";\n2)\tif the MCData emergency private priority state of the private communication is \"MDEPP 3: confirm-pending\" shall set the MCData emergency private priority state of the private communication to \"MDEPP 1: no-emergency\"; and\n3)\tif the sent SIP request for an MCData emergency private communication contained an application/vnd.3gpp.mcdata-info+xml MIME body with an <alert-ind> element set to a value of \"true\", shall set the MCData private emergency alert state to \"MDPEA 1: no-alert\".\nThis clause is referenced from other procedures.\nWhen the MCData emergency private communication state is set to \"MDEPC 3: emergency-pc-granted\" and the MCData emergency alert state is set to \"MDPEA 1: no-alert\", the MCData client shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5] with the clarifications given below.\nNOTE 1:\tThis procedure assumes that the MCData client in the calling procedure has verified that the MCData user has made an authorised request for cancelling MCData the in-progress emergency private communication state of the communication.\nThe MCData client:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcdata-info+xml MIME body, as defined in clause D.1, with the <emergency-ind> element set to \"false\";\n2)\tshall clear the MCData emergency state; and\n3)\tshall set MCData emergency private priority state of the MCData emergency private communication to \"MDEPP 3: cancel-pending\".\nNOTE 2:\tThis is the case of an MCData user who has initiated an MCData emergency private communication and wants to cancel it.\nWhen the MCData emergency private communication state is set to \"MDEPPC 3: emergency-pc-granted\" and the MCData emergency alert state is set to a value other than \"MDPEA 1: no-alert\" and the MCData user has indicated only the MCData emergency private communication should be cancelled, the MCData client:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcdata-info+xml MIME body, as defined in clause D.1, with the <emergency-ind> element set to \"false\"; and\n2)\tshall set the MCData emergency private priority state of the MCData emergency private communication to \"MDEPP 3: cancel-pending\";\nNOTE 3:\tThis is the case of an MCData user has initiated both an MCData emergency private communication and an MCData emergency alert and wishes to only cancel the MCData emergency private communication. This leaves the MCData emergency state set.\nWhen the MCData emergency private communication state is set to \"MDEPC 3: emergency-pc-granted\" and the MCData emergency alert state is set to a value other than \"MDPEA 1: no-alert\" and the MCData user has indicated that the MCData emergency alert on the MCData private communication should be cancelled in addition to the MCData emergency private communication, the MCData client:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcdata-info+xml MIME body as defined in annex D.1 with the <emergency-ind> element set to \"false\";\n2)\tshall, if this is an authorised request to cancel an MCData emergency alert as determined by the procedures of clause 6.2.8.3.1.3:\na)\tinclude in the application/vnd.3gpp.mcdata-info+xml MIME body an <alert-ind> element set to \"false\"; and\nb)\tset the MCData private emergency alert state to \"MDPEA 4: emergency-alert-cancel-pending\";\n3)\tif this is not an authorised request to cancel an MCData emergency alert as determined by the procedures of clause 6.2.8.3.1.3, should indicate to the MCData user they are not authorised to cancel the MCData emergency alert;\n4)\tshall set the MCData emergency private priority state of the MCData to \"MDEPP 3: cancel-pending\"; and\n5)\tshall clear the MCData emergency state.\nNOTE 4:\tThis is the case of an MCData user that has initiated both an MCData emergency private communication and an MCData emergency alert and wishes to cancel both.\nThis clause is referenced from other procedures.\nUpon receiving a SIP INFO request within the dialog of the SIP request for a priority private communication:\n-\twith the Info-Package header field containing the g.3gpp.mcdatainfo package name;\n-\twith the application/vnd.3gpp.mcdata-info+xml MIME body associated with the info package according to IETF RFC 6086 [21]; and\n-\twith one or more of the <alert-ind>, <imminentperil-ind> and <emergency-ind> elements set in the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body;\nthe MCData client:\n1)\tif the MCData private emergency alert state is set to \"MDPEA 2: emergency-alert-confirm-pending\":\na)\tif the <alert-ind> element is set to a value of \"false\", shall set the MCData private emergency alert state to \"MDPEA 1: no-alert\"; and\nb)\tif the <alert-ind> element set to a value of \"true\", shall set the MCData private emergency alert state to \"MDPEA 3: emergency-alert-initiated\"; and\n2)\tif the MCData private emergency alert state is set to \"MDPEA 4: Emergency-alert-cancel-pending\":\na)\tif the <alert-ind> element is set to a value of \"true\", shall set the MCData private emergency alert state to \"MDPEA 3: emergency-alert-initiated\"; and\nb)\tif the <alert-ind> element is set to a value of \"false\", shall set the MCData private emergency alert state to \"MDPEA 1: no-alert\".\nThis clause is referenced from other procedures.\nUpon receiving a request to cancel the MCData emergency private communication state from an MCData user other than the originator of the MCData emergency private communication, the MCData client shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5], with the clarifications given below.\nThe MCData client:\nNOTE 1: This procedure assumes that the calling procedure has verified that the MCData user has made an authorised request for cancelling the MCData emergency private communication state of the communication.\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcdata-info+xml MIME body, as defined in clause D.1, with the <emergency-ind> element set to \"false\";\n2)\tshall set the MCData emergency private priority state of the MCData emergency private communication to \"MDEPP 3: cancel-pending\"; and\n3)\tif the MCData user has indicated that an MCData emergency alert associated with the MCData emergency private communication originated by another MCData user should be cancelled and this is an authorised request for an MCData emergency alert cancellation, as determined by the procedures of clause 6.2.8.3.1.3:\na)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <alert-ind> element set to a value of \"false\"; and\nb)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <originated-by> element set to the MCData ID of the MCData user who originated the MCData emergency alert.\nNOTE 2:\tWhen an MCData emergency alert is cancelled by a MCData user other than its originator, the <originated-by> element is needed to identify which MCData emergency alert is being cancelled, as conceivably each participant in the MCData emergency private communication could have originated an MCData emergency alert.\nIf the MCData client needs to retrieve a KMS URI associated to an identified MCData ID for on network operation, the MCData client:\n1)\tshall search for the <One-to-One-CommunicationListEntry> entry of the <One-to-One-Communication> element of the <Common> element of the <mcdata-user-profile> element within the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) where the <One-to-One-CommunicationListEntry> entry includes a <MCData-ID> element with the <uri-entry> element containing the identified MCData ID;\na)\tif the <One-to-One-CommunicationListEntry> entry identified by MCData ID is found and contains in the <anyExt> element a non-empty <MCData-ID-KMSURI> element, shall retrieve the KMS URI contained therein; or\nb)\tif the <One-to-One-CommunicationListEntry> entry identified by MCData ID is not found or the <MCData-ID-KMSURI> element is empty, shall retrieve the <kms> element of the <App-Server-Info> element of the <on-network> element of the UE initial configuration document (see the UE initial configuration document in 3GPP TS 24.484 [12]) and consider that to be the KMS URI associated with the MCData ID.\nIf the MCData client needs to retrieve a KMS URI associated to an identified MCData ID for off network operation, the MCData client:\n1)\tshall search for /<x>/<x>/Common/OneToOne/UserList/<x>/Entry/MCDataID leaf node containing the identified MCData ID (see the MCData user profile MO in 3GPP TS 24.483 [42]);\na)\tif the identified MCData ID is found:\ni)\tshall retrieve the /<x>/<x>/Common/OneToOne/UserList/<x>/Entry/MCDataIDKMSURI leaf node (see the MCData user profile MO in 3GPP TS 24.483 [42]); and\nii)\tif the MCDataIDKMSURI leaf node in the same /<x>/<x>/Common/OneToOne/UserList/<x>/Entry/ interior node as the MCDataID leaf node containing the identified MCData ID is not empty, shall consider its value to be the KMS URI associated with the MCData ID; and\nb)\tif the identified MCData ID is not found or if the /<x>/<x>/Common/OneToOne/UserList/<x>/Entry/MCDataIDKMSURI leaf node is empty:\ni)\tshall retrieve /<x>/OnNetwork/AppServerInfo/KMS leaf node (see the MCS UE initial configuration document in 3GPP TS 24.483 [42]); and\nii)\tshall consider the value of the /<x>/OnNetwork/AppServerInfo/KMS leaf node to be the KMS URI associated with the MCData ID.\nUpon receiving a SIP CANCEL request cancelling a received SIP INVITE request for which a dialog exists at the MCData client and if a SIP 200 (OK) response has not yet been sent to the received SIP INVITE request, then the MCData client:\n1)\tshall send a SIP 200 (OK) response to the SIP CANCEL request according to 3GPP TS 24.229 [5];\n2)\tif the values of the MDEG, MDIG or MDEPP were changed due to the processing of the received  SIP INVITE, shall restore those variable to the values they held prior to the processing of the received SIP INVITE; and\n3)\tshall send a SIP 487 (Request Terminated) response to the received SIP INVITE request according to 3GPP TS 24.229 [5].\nUpon receiving a SIP BYE request for an established dialog, the MCData client:\n1)\tshall release the associated allocated resources; and\n2)\tshall send SIP 200 (OK) response towards the received SIP BYE request according to 3GPP TS 24.229 [5].\nThis clause covers both on-demand session and pre-established sessions.\nUpon receipt of a SIP re-INVITE request for an existing one-to-one communication session, the MCData client shall:\n1)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <emergency-ind> element set to a value of \"true\":\na)\tshould display to the MCData user an indication that this is a SIP re-INVITE request to upgrade this MCData one-to-one communication to an MCData emergency one-to-one communication, and:\ni)\tshould display the MCData ID of the originator of the MCData emergency one-to-one communication contained in the <mcdata-calling-user-id> element of the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tif the <alert-ind> element of the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body is set to \"true\", should display to the MCData user an indication of the MCData emergency alert and associated information; and\nb)\tshall set the MCData emergency private priority state to \"MDEPP 2: in-progress\" for this one-to-one communication;\n2)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <emergency-ind> element set to a value of \"false\":\na)\tshould display to the MCData user an indication that this is a SIP re-INVITE request to downgrade this emergency one-to-one communication to a normal priority one-to-one communication, and:\ni)\tshould display the MCData ID of the sender of the SIP re-INVITE request contained in the <mcdata-calling-user-id> element of the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tif the <alert-ind> element of the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body is set to \"false\", should display to the MCData user an indication that the MCData emergency alert is cancelled;\niii)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body including an <originated-by> element:\nA)\tshould display to the MCData user the MCData ID of the originator of the MCData emergency alert, as indicated by the <originated-by> element; and\nB)\tif the MCData ID contained in the <originated-by> element is the MCData ID of the receiving MCData user, shall set the MCData emergency alert state to \"MDPEA 1: no-alert\";\nb)\tshall set the MCData emergency private priority state to \"MDEPP 1: no-emergency\" for this one-to-one communication; and\nc)\tif the MCData emergency private communication state of the communication is set to \"MDEPC 3: emergency-pc-granted\", shall set the MCData emergency private communication state of the communication to \"MDEPC 1: emergency-pc-capable\";\n3)\tmay display to the MCData user the MCData ID of the inviting MCData user, if not already done so in the preceding steps;\n4)\tmay display to the MCData user the functional alias of the inviting MCData user, if provided;\n5)\tshall accept the SIP re-INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\n6)\tif the SIP re-INVITE request was received within an on-demand session, shall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5], with the clarifications given in clauses 9.2.4.2.2 (for SDS) or 10.2.5.2.2 (for FD);\n7)\tif the SIP re-INVITE request was received within a pre-established session, shall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP re-INVITE request according to 3GPP TS 24.229 [5], based upon the parameters already negotiated for the pre-established session;\nNOTE:\tThe SIP re-INVITE request can be received within an on-demand session or a pre-established session. If the SIP re-INVITE request is received within a pre-established session, the value settings for the media are expected to be the same as was negotiated in the existing pre-established session.\n8)\tshall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5]; and\n9)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15].\nThis clause covers both on-demand session and pre-established sessions.\nUpon receiving a request from an MCData user to cancel the in-progress emergency condition on an MCData emergency one-to-one communication, the MCData client shall generate a SIP re-INVITE request by following the UE session procedures specified in 3GPP TS 24.229 [5], with the clarifications given below.\nThe MCData client:\n1)\tif the MCData user is not authorised to cancel the in-progress emergency condition on an MCData emergency one-to-one communication as determined by the procedures of clause 6.2.8.3.1.2:\na)\tshould indicate to the MCData user that they are not authorised to cancel the in-progress emergency condition on an MCData emergency one-to-one communication; and\nb)\tshall skip the remaining steps of the current clause;\n2)\tshall, if the MCData user is cancelling an in-progress emergency condition and optionally an MCData emergency alert originated by the MCData user, include an application/vnd.3gpp.mcdata-info+xml MIME body by executing the procedure in clause 6.2.8.3.6;\n3)\tshall, if the MCData user is cancelling an in-progress emergency condition and optionally an MCData emergency alert originated by another MCData user, include an application/vnd.3gpp.mcdata-info+xml MIME body by executing the procedure in clause 6.2.8.3.8;\n4)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.2.8.3.3;\n5)\tshall include in the SIP re-INVITE request an SDP offer with the media parameters set as currently established;\nNOTE 1:\tThe SIP re-INVITE request can be sent within an on-demand session or a pre-established session associated with an MCData communication. If the SIP re-INVITE request is sent within a pre-established session, the settings of the media parmeters are expected to be the same as it was negotiated in the existing pre-established session.\n6)\tshall send the SIP re-INVITE request according to 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP re-INVITE request, the MCData client:\n1)\tshall interact with the user plane as specified in 3GPP TS 24.582 [15];\n2)\tshall set the MCData emergency private priority state of the MCData private call to \"MDEPP 1: no-emergency\";\n3)\tshall set the MCData emergency private communication state of the call to \"MDEPC 1: emergency-pc-capable\"; and\n4)\tif the MCData emergency alert state is set to \"MDPEA 4: emergency-alert-cancel-pending\", the sent SIP re-INVITE request did not contain an <originated-by> element of the <mcdata-Params> element in the application/vnd.3gpp.mcdata-info+xml MIME body and the SIP 2xx response to the SIP request for a priority communication does not contain a Warning header field as specified in clause 4.9 with the warning text containing the <mcdata-warn-code> element set to \"149\", shall set the MCData emergency alert state to \"MDPEA 1: no-alert\".\nOn receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to the SIP re-INVITE request:\n1)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response contains an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-Params> element containing an <emergency-ind> element set to a value of \"true\", the MCData client shall set the MCData emergency private priority state as \"MDEPP 2: in-progress\";\n2)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response contains an application/vnd.3gpp.mcdata-info+xml MIME body with an with an <mcdata-Params> element containing an <alert-ind> element set to a value of \"true\" and the sent SIP re-INVITE request did not contain an <originated-by> element in the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData client shall set the MCData emergency alert state to \"MDPEA 3: emergency-alert-initiated\"; and\n3)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response did not contain an application/vnd.3gpp.mcdata-info+xml MIME body, shall set the MCData emergency private priority state as \"MDEPP 2: in-progress\" and the MCData emergency alert (MDPEA) state shall revert to its value prior to entering the current procedure.\nNOTE 2:\tIf the in-progress emergency private priority state cancel request is rejected, the state of the session does not change, i.e., continues with MCData emergency private communication level priority.\nOn receiving a SIP INFO request where the Request-URI contains an MCData session ID identifying an ongoing session, the MCData client shall follow the actions specified in clause 6.2.8.3.7.\nThis clause covers both on-demand sessions and pre-established sessions.\nUpon receiving a request from an MCData user to upgrade the ongoing MCData one-to-one communication to an MCData emergency one-to-one communication, if this is an unauthorised request for an MCData emergency one-to-one communication as determined by the procedures of clause 6.2.8.3.1.1, the MCData client  should indicate to the MCData user that the upgrade request is not authorised and shall exit the procedure. Otherwise, the MCData client:\n1)\tshall generate a SIP re-INVITE request as specified in 3GPP TS 24.229 [5];\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body populated as specified in clause 6.2.8.3.2;\n3)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.2.8.3.3;\n4)\tshall include an SDP offer with the media parameters as currently established according to 3GPP TS 24.229 [5];\nNOTE:\tThe SIP re-INVITE request can be sent within an on-demand session or a pre-established session associated with an MCData private call. If the SIP re-INVITE request is sent within a pre-established session, the settings of the media parmeters are expected to be the same as it was negotiated in the existing pre-established session.\n5)\tshall perform the actions specified in clause 6.2.5.1, to include the specific location information for the emergency communication; and\n6)\tshall send the SIP re-INVITE request according to 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP re-INVITE request the MCData client:\n1)\tshall interact with the user plane as specified in 3GPP TS 24.582 [15]; and\n2)\tshall perform the actions specified in clause 6.2.8.3.4.\nOn receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to the SIP re-INVITE request, the MCData client shall perform the actions specified in clause 6.2.8.3.5.\nOn receiving a SIP INFO request where the Request-URI contains an MCData session ID identifying an ongoing session, the MCData client shall follow the actions specified in clause 6.2.8.3.7.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tMCData server procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tDistinction of requests at the MCData server",
                            "text_content": "Editor's note: In the current release, support for emergency groups and emergency group communications (in particular the use of the <emergency-ind> element) may be absent, partial or limited, namely only provided to the extent of facilitating emergency alert functionality.\nThe MCData server needs to distinguish between the following SIP MESSAGE request for originations and terminations:\n-\tSIP MESSAGE requests routed to the participating MCData function with the Request-URI set to the MBMS public service identity of the participating MCData function. Such requests are known as \"SIP MESSAGE request for an MBMS listening status update\";\n-\tSIP MESSAGE request routed to the participating MCData function containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-location-info+xml\" and includes an XML body containing a Location root element containing a Report element. Such requests are known as \"SIP MESSAGE request for location reporting\";\n-\tSIP MESSAGE request routed to the MCData client containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-location-info+xml\" and includes an XML body containing a Location root element containing a Configuration element. Such requests are known as \"SIP MESSAGE request for location report configuration\";\n-\tSIP MESSAGE request routed to the MCData client containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-location-info+xml\" and includes an XML body containing a Location root element containing a Request element. Such requests are known as \"SIP MESSAGE request for location report request\";\n-\tSIP MESSAGE request routed to the originating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field. Such requests are known as \"SIP MESSAGE request for standalone SDS for originating participating MCData function\";\n-\tSIP MESSAGE request routed to the originating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field, and with an application/vnd.3gpp.mcdata-info+xml MIME body containing a <request-type> element containing the value \"msf-disc-req\". Such requests are known as \"SIP MESSAGE request for absolute URI discovery request for participating MCData function\";\n-\tSIP MESSAGE request routed to the terminating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field, and with an application/vnd.3gpp.mcdata-info+xml MIME body containing a <request-type> element containing the value \"msf-disc-res\". Such requests are known as \"SIP MESSAGE request for absolute URI discovery response for participating MCData function\";\n-\tSIP MESSAGE request routed to the controlling MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field, and with an application/vnd.3gpp.mcdata-info+xml MIME body containing a <request-type> element containing the value \"msf-disc-req\". Such requests are known as \"SIP MESSAGE request for absolute URI discovery request for controlling MCData function\";\n-\tSIP MESSAGE request routed to the originating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field. Such requests are known as \"SIP MESSAGE request for FD using HTTP for originating participating MCData function\";\n-\tSIP MESSAGE request routed to the terminating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field, and with an application/vnd.3gpp.mcdata-signalling MIME body containing an FD NETWORK NOTIFICATION message. Such requests are known as \"SIP MESSAGE network notification for FD using HTTP for terminating participating MCData function\";\n-\tSIP MESSAGE request routed to the terminating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field. Such requests are known as \"SIP MESSAGE request for standalone SDS for terminating participating MCData function\";\n-\tSIP MESSAGE request routed to the terminating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field. Such requests are known as \"SIP MESSAGE request for FD using HTTP for terminating participating MCData function\";\n-\tSIP MESSAGE request routed to an MCData server with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field, and with an application/vnd.3gpp.mcdata-signalling MIME body containing an SDS NOTIFICATION message Such requests are known as \"SIP MESSAGE request for SDS disposition notification for MCData server\";\n-\tSIP MESSAGE request routed to an MCData server with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field, and with an application/vnd.3gpp.mcdata-signalling MIME body containing an FD NOTIFICATION message. Such requests are known as \"SIP MESSAGE request for FD disposition notification for MCData server\";\n-\tSIP MESSAGE request routed to the controlling MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field. Such requests are known as \"SIP MESSAGE request for standalone SDS for controlling MCData function\";\n-\tSIP MESSAGE request routed to the controlling MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field. Such requests are known as \"SIP MESSAGE request for FD using HTTP for controlling MCData function\";\n-\tSIP MESSAGE requests routed to the controlling MCData function with the Request-URI set to the public service identity of the controlling MCData function and containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-info+xml\" and including an XML body containing a <mcdatainfo> root element containing a <mcdata-Params> element containing an <emergency-ind> element or an <alert-ind> element. Such requests are known as \"SIP MESSAGE requests for emergency notification for controlling MCData function\";\n-\tSIP MESSAGE requests routed to the originating participating MCData function with the Request-URI set to the public service identity of the participating MCData function and containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-info+xml\" and including an XML body containing a <mcdatainfo> root element containing a <mcdata-Params> element containing an <emergency-ind> element or an <alert-ind> element. Such requests are known as \"SIP MESSAGE requests for emergency notification for originating participating MCData function\";\n-\tSIP MESSAGE requests routed to the terminating participating MCData function with the Request-URI set to the public service identity of the terminating participating MCData function and containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-info+xml\" and including an XML body containing a <mcdatainfo> root element containing a <mcdata-Params> element containing an <emergency-ind> element or an <alert-ind> element. Such requests are known as \"SIP MESSAGE requests for emergency notification for terminating participating MCData function\";\n-\tSIP MESSAGE requests routed to the terminating participating MCData function with the Request-URI set to the public service identity of the terminating participating MCData function and containing an \"application/vnd.3gpp.mcdata-info+xml\" MIME body with an <alert-ind-rcvd> element present. Such requests are known as \"SIP MESSAGE requests indicating delivery of emergency notification\";\n-\tSIP MESSAGE request routed to the terminating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field, and with an application/vnd.3gpp.mcdata-signalling MIME body containing an DEFERRED DATA REQUEST message. Such requests are known as \"SIP MESSAGE request for list of deferred group communications\"\n-\tSIP MESSAGE requests routed to the originating participating MCData function and the Request-URI is set to a public service identity of the originating participating MCData function that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup+xml MIME body, a <regroup-action> element set to \"create\", and a non-empty <groups-for-regroup> element. Such requests are known as \"SIP MESSAGE request to the originating participating MCData function to request creation of a group regroup using preconfigured group\" in the procedures in the present document;\n-\tSIP MESSAGE requests routed to the originating participating MCData function and the Request-URI is set to a public service identity of the originating participating MCData function that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup+xml MIME body, a <regroup-action> element set to \"create\", and a non-empty <users-for-regroup> element. Such requests are known as \"SIP MESSAGE request to the originating participating MCData function to request creation of a user regroup using preconfigured group\" in the procedures in the present document;\n-\tSIP MESSAGE requests routed to the originating participating MCData function and the Request-URI is set to a public service identity of the originating participating MCData function that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup+xml MIME body and a <regroup-action> element set to \"remove\". Such requests are known as \"SIP MESSAGE request to the originating participating MCData function to remove a regroup using preconfigured group\" in the procedures in the present document;\n-\tSIP MESSAGE requests routed to the terminating participating MCData function and the Request-URI is set to a public service identity of the participating MCData function that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup+xml MIME body, a <regroup-action> element set to \"create\", and a non-empty <groups-for-regroup> element. Such requests are known as \"SIP MESSAGE request to the terminating participating MCData function to create a group regroup using preconfigured group\" in the procedures in the present document;\n-\tSIP MESSAGE requests routed to the terminating participating MCData function and the Request-URI is set to a public service identity of the terminating participating MCData function that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup+xml MIME body, a <regroup-action> element set to \"create\"and a non-empty <users-for-regroup> element. Such requests are known as \"SIP MESSAGE request to the terminating participating MCData function to create a user regroup using preconfigured group\" in the procedures in the present document;\n-\tSIP MESSAGE requests routed to the terminating participating MCData function and the Request-URI is set to a public service identity of the terminating participating MCData function that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-info+xml MIME body and a <regroup-action> element set to \"remove\". Such requests are known as \"SIP MESSAGE request to the terminating participating MCData function to remove a regroup using preconfigured group\" in the procedures in the present document;\n-\tSIP MESSAGE requests routed to the controlling MCData function and the Request-URI is set to a public service identity of the controlling MCData function that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup+xml MIME body, a <regroup-action> element set to \"create\", and a non-empty <groups-for-regroup> element. Such requests are known as \"SIP MESSAGE request to the controlling MCData function to request creation of a group regroup using preconfigured group\" in the procedures in the present document;\n-\tSIP MESSAGE requests routed to the controlling MCData function and the Request-URI is set to a public service identity of the controlling MCData function that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup+xml MIME body, a <regroup-action> element set to \"create\", and a non-empty <users-for-regroup> element. Such requests are known as \"SIP MESSAGE request to the controlling MCData function to request creation of a user regroup using preconfigured group\" in the procedures in the present document;\n-\tSIP MESSAGE requests routed to the controlling MCData function and the Request-URI is set to a public service identity of the controlling MCData function that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup +xml MIME body and a <regroup-action> element set to \"remove\". Such requests are known as \"SIP MESSAGE request to the controlling MCData function to remove a regroup using preconfigured group\" in the procedures in the present document;\n-\tSIP MESSAGE requests routed to a non-controlling MCData function and the Request-URI is set to a public service identity of the non-controlling MCData function that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup+xml MIME body, a <regroup-action> element set to \"create\", and a non-empty <groups-for-regroup> element. Such requests are known as \"SIP MESSAGE request to a non-controlling MCData function to request creation of a group regroup using preconfigured group\" in the procedures in the present document;\n-\tSIP MESSAGE requests routed to the non-controlling MCData function and the Request-URI is set to a public service identity of the non-controlling MCData function that contains a <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup+xml MIME body and a <regroup-action> element set to \"remove\". Such requests are known as \"SIP MESSAGE request to the non-controlling MCData function to remove a group regroup using preconfigured group\" in the procedures in the present document;\nSIP MESSAGE requests routed to the originating participating MCData function with the Request-URI set to the public service identity of the participating MCData function and containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-info+xml\" and including an XML body containing a <mcdatainfo> root element containing a <mcdata-Params> element containing an <anyExt> element with the <request-type> element set to a value of \"fa-group-binding-req\". Such requests are known as \"SIP MESSAGE request for binding of a functional alias with the MCData group(s) for the MCData user for originating participating MCData function\" in the procedures in the present document;\n-\tSIP MESSAGE requests routed to the controlling participating MCData function with the Request-URI set to the public service identity of the participating MCData function and containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-info+xml\" and including an XML body containing a <mcdatainfo> root element containing a <mcdata-Params> element containing an <anyExt> element with the <request-type> element set to a value of \"fa-group-binding-req\". Such requests are known as \"SIP MESSAGE request for binding of a functional alias with the MCData group(s) for the MCData user for controlling MCData function\" in the procedures in the present document; and\n-\tSIP MESSAGE requests routed to the participating MCData function with the Request-URI set to the public service identity of the participating MCData function and containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-info+xml\" and including an XML body containing a <mcdatainfo> root element containing a <mcdata-Params> element containing an <anyExt> element with the <request-type> element set to a value of \"store-comms-in-msgstore-ctrl-req\". Such requests are known as \"SIP MESSAGE request for controlling the storage of the MCData communications into MCData message store\".\nIf a SIP MESSAGE request is received at an MCData server that is not in accordance with the SIP MESSAGE requests listed above, then the MCData server shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response.\nThe MCData server needs to distinguish between the following SIP INVITE requests for originations and terminations:\n-\tSIP INVITE requests routed to the participating MCData function with the Request-URI set to a public service identity of the participating MCData function and contain in an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdataInfo> element containing the <mcdata-Params> element with the <anyExt> element an <pre-established-session-ind> element set to a value of \"true\". Such requests are known as \"SIP INVITE request for establishing a pre-established session\" in the procedures in the present document;\n-\tSIP INVITE request routed to the originating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-sds\" or \"group-sds\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for standalone SDS over media plane for originating participating MCData function\";\n-\tSIP INVITE request routed to the terminating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-sds\" or \"group-sds\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for standalone SDS over media plane for terminating participating MCData function\";\n-\tSIP INVITE request routed to the controlling MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-sds\" or \"group-sds\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for controlling MCData function for standalone SDS over media plane\";\n-\tSIP INVITE request routed to the originating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-sds-session\" or \"group-sds-session\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for SDS session for originating participating MCData function\";\n-\tSIP INVITE request routed to the terminating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-sds-session\" or \"group-sds-session\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for SDS session for terminating participating MCData function\";\n-\tSIP INVITE request routed to the controlling MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-sds-session\" or \"group-sds-session\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for controlling MCData function for SDS session\";\n-\tSIP INVITE request routed to the originating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-fd\" or \"group-fd\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for file distribution for originating participating MCData function\";\n-\tSIP INVITE request routed to the terminating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-fd\" or \"group-fd\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for file distribution for terminating participating MCData function\"; and\n-\tSIP INVITE request routed to the controlling MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-fd\" or \"group-fd\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for controlling MCData function for file distribution\";\n-\tSIP INVITE request routed to the originating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-ipconn\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for IP Connectivity session for originating participating MCData function;.\n-\tSIP INVITE request routed to the terminating participating MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-ipconn\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for IP Connectivity session for terminating participating MCData function\"; and\n-\tSIP INVITE request routed to the controlling MCData function with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-ipconn\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for controlling MCData function for IP Connectivity session\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tSending SIP requests and receiving SIP responses",
                            "text_content": "This clause is referenced from other procedures.\nThe participating MCData function shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] and:\n1)\tshall include in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\n2)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public user identity associated to the MCData ID of the terminating MCData user;\n3)\tshall populate the outgoing SIP MESSAGE request MIME bodies as specified in clause 6.4 and\n4)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function.\nThis clause is referenced from other procedures.\nWhen generating a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6], the partcipating MCData function:\n1)\tshall set the Request-URI of the SIP MESSAGE request to the public service identity of the controlling MCData function;\nNOTE 1:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n2)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the SIP MESSAGE request; and\n3)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.3\tRetrieving a group document",
                            "text_content": "This clause describes how an MCData server accesses a group document from a group management server.\nNOTE 1:\tThe group document for a user or group regroup based on a preconfigured group is the group document for the preconfigured group restricted to the users or groups included in the regroup stored by the MCData server at the time of the regroup creation and does not include a <preconfigured-group-use-only> element.\nUpon receipt of a SIP request:\n1)\tif the MCData server is not yet subscribed to the group document for the group identity in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP request, the MCData server shall subscribe to the \"xcap-diff\" event-package for the group document of this group identity as specified in 3GPP TS 24.481 [11];\nNOTE 2:\tAs a group document can potentially have a large content, the MCData server can subscribe to the group document indicating support of content-indirection as defined in IETF RFC 4483 [13], by following the procedures in 3GPP TS 24.481 [11].\n2)\tupon receipt of a SIP 404 (Not Found) response as a result of attempting to subscribe to the \"xcap-diff\" event-package for the group document of the group identity in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP request as specified in 3GPP TS 24.481 [11], the MCData server shall send the SIP 404 (Not Found) response with the warning text set to \"113 group document does not exist\" in a Warning header field as specified in clause 4.9. Otherwise, continue with the rest of the steps; and\n3)\tupon receipt of any other SIP 4xx, SIP 5xx or SIP 6xx response as a result of attempting to subscribe to the \"xcap-diff\" event-package for the group document of the group identity in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request as specified in 3GPP TS 24.481 [11], the MCData server shall send the SIP final response with the warning text set to \"114 unable to retrieve group document\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.4\tDetermining targeted group members for MCData communications",
                            "text_content": "The MCData server shall only send MCData messages to affiliated group members.\nThe MCData server determines whether a user is affiliated to a group by following the procedures in clause 6.3.5.\nIf the group is not a regroup based on a preconfigured group, the MCData server determines the affiliated members from the entries contained in the <list> element of the group document by following the procedures specified in clause 6.3.5.\nIf the group is a regroup based on a preconfigured group, the MCData server determines the affiliated members from the list of users that was stored during successful processing of the creation of the regroup per clause 23 by following the procedures specified in clause 6.3.5.\nNOTE 1:\tThe term \"affiliated group members\" used above also includes those members that are implicitly affiliated by the controlling MCData function.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.5\tAffiliation check",
                            "text_content": "The MCData server shall determine that the MCData user, with MCData User ID, is affiliated to the MCData group, with MCData Group ID, at the MCData client, with MCData client ID, if the elements, as described in clause 8.3.3.2, exist with their expected values, as below:\n1.\tan MCData group information entry with MCData group ID same as the MCData group ID under consideration;\n2.\tin the MCData group information entry found in 1, an MCData user information entry with the MCData ID same as the MCData ID under consideration;\n3.\tin the MCData user information entry found in 2, an MCData client information entry with MCData Client ID same as the MCData client ID under consideration; and\n4.\tin the MCData user information entry found in 2, an expiration time, which has not expired.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.6\tMCData conversation items",
                            "text_content": "In order to generate an terminating response message for FD over HTTP, the MCData server:\n1)\tshall generate an FD HTTP TERMINATION message as specified in clause 15.1.13; and\n2)\tshall include in the SIP request, the FD HTTP TERMINATION message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1.\nWhen generating an FD HTTP TERMINATION message as specified in clause 15.1.13, the MCData server:\n1)\tshall set the Conversation ID IE to a value identifying the conversation, as specified in clause 15.2.9;\n2)\tshall set the Message ID IE to a value identifying the message as specified in clause 15.2.10;\n3)\tmay set the Application ID IE ID to the stored value if applicable;\n4)\tshall include a Payload IE with:\na)\tShall set the Payload content type set to \"FILEURL\" as specified in clause 15.2.13; and\nb)\tShall set the URL of the file same as payload of FD transmission; and\n5)\tShall set the Termination information type IE set to \"TERMINATION RESPONSE\" as specified in clause 15.2.22.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.7\tProcedures referenceable from other procedures",
                            "text_content": "This clause is referenced from other procedures.\nThe controlling MCData function shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5].\nThe controlling MCData function:\n1)\tshall include an SDP offer with the media parameters as currently established with the terminating MCData client according to 3GPP TS 24.229 [5];\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdata-calling-user-id> element set to the MCData ID of the initiating MCData user;\n3)\tif the in-progress emergency group state of the group is set to a value of \"true\" the controlling MCData function:\na)\tshall include a Resource-Priority header field with the namespace populated with the values for an MCData emergency group communication as specified in clause 6.3.7.1.4;\nb)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body the <emergency-ind> element set to a value of \"true\";\nc)\tif the <alert-ind> element is set to \"true\" in the received SIP re-INVITE request and MCData emergency alerts are authorised for this group and MCData user as determined by the procedures of clause 6.3.7.2.1, shall populate the application/vnd.3gpp.mcdata-info+xml MIME body and application/vnd.3gpp.mcdata-location-info+xml MIME body as specified in clause 6.3.7.1.3. Otherwise, shall set the <alert-ind> element to a value of \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body; and\nd)\tif the in-progress imminent peril state of the group is set to a value of \"true\", shall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <imminentperil-ind> element set to a value of \"false\"; and\nNOTE:\tIf the imminent peril state of the group is \"true\" at this point, the controlling function will be setting it to \"false\" as part of the calling procedure. This is, in effect, an upgrade of an MCData imminent peril group communication to an MCData emergency group communication.\n4)\tif the in-progress emergency group state of the group is set to a value of \"false\":\na)\tshall include a Resource-Priority header field populated with the values for a normal MCData group communication as specified in clause 6.3.7.1.4; and\nb)\tif the received SIP re-INVITE request contained an application/vnd.3gpp.mcdata-info+xml MIME body with the <emergency-ind> element set to a value of \"false\" and this is an authorised request to cancel an MCData emergency group communication as determined by the procedures of clause 6.3.7.2.3:\ni)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <emergency-ind> element set to a value of \"false\"; and\nii)\tif the received SIP re-INVITE request contained an application/vnd.3gpp.mcdata-info+xml MIME body with the <alert-ind> element set to a value of \"false\" and this is an authorised request to cancel an MCData emergency alert as determined by the procedures of clause 6.3.7.2.2, shall:\nA)\tinclude in the application/vnd.3gpp.mcdata-info+xml MIME body an <alert-ind> element set to a value of \"false\"; and\nB)\tif the received SIP request contains an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, copy the contents of the received <originated-by> element to an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP re-INVITE request.\nThis clause is referenced from other procedures.\nThis clause describes the procedures for generating a SIP MESSAGE request to notify affiliated but not participating members of an MCData group of the change of status of the in-progress emergency state or emergency alert status of an MCData group. The procedure is initiated by the controlling MCData function when there has been a change of in-progress emergency or the emergency alert status of an MCData group.\nThe controlling MCData function:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n3)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n4)\tshall set the Request-URI to the public service identity of the terminating participating function associated with the MCData ID of the targeted MCData user;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n5)\tshall include a P-Asserted-Identity header field set to the public service identity of controlling MCData function;\n6)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7];\n7)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <mcdata-request-uri> element set to the value of the MCData ID of the targeted MCData user; and\n8)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <mcdata-calling-group-id> element set to the MCData group ID of the MCData group on which the MCData emergency communication or the emergency alert state has changed.\nThis clause is referenced from other procedures.\nThis clause describes the procedures for populating the application/vnd.3gpp.mcdata-info+xml and application/vnd.3gpp.mcdata-location-info+xml MIME bodies for an MCData emergency alert. The procedure is initiated by the controlling MCData function when it has received a SIP request initiating an MCData emergency alert and generates a message containing the MCData emergency alert information required by 3GPP TS 23.282 [2].\nThe controlling MCData function:\n1)\tshall include, if not already present, an application/vnd.3gpp.mcdata-info+xml MIME body as specified in Annex D.1, and set the <alert-ind> element to a value of \"true\";\n2)\tshall determine the value of the MCData user's Mission Critical Organization from the <MissionCriticalOrganization> element, of the MCData user profile document identified by the MCData ID and profile index associated with MCData user (see the MCData user profile document in 3GPP TS 24.484 [12]);\n3)\tshall include in the <mcdatainfo> element containing the <mcdata-Params> element an <mc-org> element set to the value of the MCData user's Mission Critical Organization; and\n4)\tshall copy the contents of the application/vnd.3gpp.mcdata-location-info+xml MIME body in the received SIP request into an application/vnd.3gpp.mcdata-location-info+xml MIME body included in the outgoing SIP request.\nThis clause is referenced from other procedures.\nWhen determining the Resource-Priority header field namespace and priority values as specified in IETF RFC 8101 [67] for an MCData emergency (group or one-to-one) communication, the controlling MCData function:\n1)\tshall retrieve the value of the <resource-priority-namespace> element contained in the <emergency-resource-priority> element contained in the <on-network> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]); and\n2)\tshall retrieve the value of the <resource-priority-priority> element contained in the <emergency-resource-priority> element contained in the <on-network> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]).\nWhen determining the Resource-Priority header field namespace and priority values as specified in IETF RFC 8101 [67] for an MCData imminent peril group communication, the controlling MCData function:\n1)\tshall retrieve the value of the <resource-priority-namespace> element contained in the <imminent-peril-resource-priority> element contained in the <on-network> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12] and\n2)\tshall retrieve the value of the <resource-priority-priority> element contained in the <imminent-peril-resource-priority> element contained in the <on-network> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12])\nWhen determining the Resource-Priority header field namespace and priority values as specified in IETF RFC 8101 [67] for a normal MCData (group or one-to-one) communication, the controlling MCData function:\n1)\tshall retrieve the value of the <resource-priority-namespace> element contained in the <normal-resource-priority> element contained in the <on-network> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]); and\n2)\tshall retrieve the value of the <resource-priority-priority> element contained in the <normal-resource-priority> element contained in the <on-network> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]).\nNOTE:\tThe \"normal\" Resource-Priority header field value is needed to return to a normal priority value from a priority value adjusted for an MCData emergency communication (group or one-to-one). The \"normal\" priority received from the EPS by use of the \"normal\" Resource-Priority header field value is expected to be the same as the \"normal\" priority received from the EPS when initiating a communication with no Resource-Priority header field included.\nThis clause is referenced from other procedures.\nThis clause describes the procedures for generating a SIP MESSAGE request to notify the originator of an emergency alert or emergency cancellation that the request was successfully received.\nThe controlling MCData function:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n3)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n4)\tshall set the Request-URI to the public service identity of the terminating participating function associated with the MCData ID of the targeted MCData user;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n5)\tshall include a P-Asserted-Identity header field set to the public service identity of controlling MCData function; and\n6)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <mcdata-request-uri> element set to the value of the MCData ID of the targeted MCData user.\nThis clause describes the procedures for generating a SIP MESSAGE request to notify an MCData client that it has entered a pre-defined emergency alert area or exited from a pre-defined emergency alert area. The procedure is initiated by the participating MCData function when the participating MCData function determines that the MCData client has entered a pre-defined emergency alert area or exited from a pre-defined emergency alert area.\nNOTE:\tThe participating MCData function can use additional implementation-specific selection criteria to decide the recipients of the notification, i.e., whether and when an entry/exit notification is sent. The additional criteria can be the activated functional alias, ongoing emergency or conditions related to position such as speed, heading etc. The determination of the specific region is left to implementation.\nThe participating MCData function:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n3)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n4)\tshall set the Request-URI to the public user identity associated to the MCData ID of the targeted MCData user;\n5)\tshall include a P-Asserted-Identity header field set to the public service identity of the participating MCData function;\n6)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7];\n7)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <mcdata-request-uri> element set to the value of the MCData ID of the targeted MCData user;\n8)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <emergency-alert-area-ind> element:\na)\tset to a value of \"true\", if the MCData client has entered a pre-defined emergency alert area; or\nb)\tset to a value of \"false\", if the MCData client has exited from a pre-defined emergency alert area; and\n9)\tshall send the SIP MESSAGE request towards the MCData client according to the rules and procedures of 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response to the SIP MESSAGE request, if the <emergency-alert-area-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request was:\n1)\tset to a value of \"true\", shall record that the MCData client has received the notification that it has entered the pre-defined emergency alert area; and\n2)\tset to a value of \"false\", shall record that the MCData client has received the notification that it has exited the pre-defined emergency alert area.\nThis clause describes the procedures for generating a SIP MESSAGE request to notify an MCData client that it has entered a pre-defined group geographic area or exited from a pre-defined group geographic area requiring affiliation to or de-affiliation from a group. The procedure is initiated by the participating MCData function when the participating MCData function determines that the MCData client has entered a pre-defined group geographic area or exited from a pre-defined group geographic area.\nNOTE:\tThe participating MCData function can use additional implementation-specific selection criteria to decide the recipients of the notification, i.e., whether and when an entry/exit notification is sent. The additional criteria can be the activated functional alias, ongoing emergency or conditions related to position such as speed, heading etc. The determination of the specific region is left to implementation.\nThe participating MCData function:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n3)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n4)\tshall set the Request-URI to the public user identity associated to the MCData ID of the targeted MCData user;\n5)\tshall include a P-Asserted-Identity header field set to the public service identity of the participating MCData function;\n6)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7];\n7)\tvoid;\n8)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdatainfo> element containing the <mcdata-Params> element with\na)\tan <mcdata-request-uri> element set to the value of the MCData ID of the targeted MCData user;\nb)\tan <associated-group-id> element set to the MCData group ID of the group for which a pre-defined group geographic area has been entered or exited; and\nc)\ta <group-geo-area-ind> element:\ni)\tset to a value of \"true\", if the MCData client has entered a pre-defined group geographic area; or\nii)\tset to a value of \"false\", if the MCData client has exited from a pre-defined group geographic area; and\n9)\tshall send the SIP MESSAGE request towards the MCData client according to the rules and procedures of 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response to the SIP MESSAGE request, if the <group-geo-area-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request was:\n1)\tset to a value of \"true\", shall record that the MCData client has received the notification that it has entered the pre-defined group geographic area; and\n2)\tset to a value of \"false\", shall record that the MCData client has received the notification that it has exited the pre-defined group geographic area.\nThis clause is referenced from other procedures.\nThe controlling MCData function shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5].\nThe controlling MCData function:\n1)\tshall include in the Contact header field an MCData session identity for the MCData session with the g.3gpp.mcdata media feature tag and the isfocus media feature tag according to IETF RFC 3840 [16];\n2)\tshall include an SDP offer with the media parameters as currently established with the terminating MCData client according to 3GPP TS 24.229 [5];\n3)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdata-calling-user-id> element set to the MCData ID of the initiating MCData user;\n4)\tif the in-progress imminent peril state of the group is set to a value of \"true\":\na)\tshall include a Resource-Priority header field populated with the values for an MCData imminent peril group communication as specified in clause 6.3.7.1.4; and\nb)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <imminentperil-ind> element set to a value of \"true\"; and\n5)\tif the in-progress imminent peril state of the group is set to a value of \"false\":\na)\tshall include a Resource-Priority header field populated with the values for a normal MCData group communication as specified in clause 6.3.7.1.4; and\nb)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <emergency-ind> element set to a value of \"false\" and the <imminentperil-ind> element set to a value of \"false\".\nThis clause is referenced from other procedures.\nThis procedure validates the combinations of <emergency-ind>, <imminentperil-ind> and <alert-ind> in the application/vnd.3gpp.mcdata-info+xml MIME body included in:\n1)\ta SIP INVITE request or SIP re-INVITE request; or\n2)\tthe body \"URI\" header field of the SIP URI included in the application/resource-lists+xml MIME body which is pointed to by a \"cid\" URL located in the Refer-To header of a SIP REFER request;\nUpon receiving a SIP request as specified above with the <emergency-ind> element set to a value of \"true\", the controlling MCData function shall only consider the following as valid combinations:\n1)\t<imminentperil-ind> not included and <alert-ind> included.\nUpon receiving a SIP request as specified above with the <emergency-ind> element set to a value of \"false\", the controlling MCData function shall only consider the following as valid combinations:\n1)\t<imminentperil-ind> not included and <alert-ind> not included; or\n2)\t<imminentperil-ind> not included and <alert-ind> included.\nUpon receiving a SIP request as specified above with the <imminentperil-ind> element included the controlling MCData function shall only consider the request as valid if both the <emergency-ind> and <alert-ind> are not included.\nIf the combination of the <emergency-ind>, <imminentperil-ind> or <alert-ind> indicators is invalid, the controlling MCData function shall send a SIP 403 (Forbidden) response with the warning text set to \"150 invalid combinations of data received in MIME body\" in a Warning header field as specified in clause 4.9.\nThis clause is referenced from other procedures.\nThis procedure describes how the controlling MCData function generates a SIP INFO request due to the receipt of a SIP request for a priority communication.\nThe controlling MCData function:\n1)\tshall generate a SIP INFO request according to rules and procedures of 3GPP TS 24.229 [5] and IETF RFC 6086 [21];\n2)\tshall include the Info-Package header field set to g.3gpp.mcdata-info in the SIP INFO request;\n3)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body in the SIP INFO request and:\na)\tif the received SIP request contained application/vnd.3gpp.mcdata-info+xml MIME body with the <alert-ind> element set to a value of \"true\" and this is an unauthorised request for an MCData emergency alert as specified in clause 6.3.7.2.1, shall set the <emergency-ind> element to a value of \"true\" and the <alert-ind> element to a value of \"false\";\nb)\tif the received SIP request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <alert-ind> element set to a value of \"false\" and if this is an unauthorised request for an MCData emergency alert cancellation, shall set <alert-ind> element to a value of \"true\"; and\nc)\tif the received SIP request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\", this is an authorised request for an MCData imminent peril group communication and the in-progress emergency state of the group is set to a value of \"true\", shall set the <imminentperil-ind> element to a value of \"false\" and the <emergency-ind> element set to a value of \"true\"; and\n4)\tshall send the SIP INFO request towards the inviting MCData client in the dialog created by the SIP request from the inviting MCData client, as specified in 3GPP TS 24.229 [5].\nThis clause is referenced from other procedures.\nThis clause describes the procedures for inviting an MCData user to an MCData session associated with an MCData emergency group communication or MCData imminent peril group communication.\nThe controlling MCData function:\n1)\tshall generate a SIP INVITE request as specified in 3GPP TS 24.229 [5];\n2)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated with the MCData ID of the targeted MCData user;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n3)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element populated as follows:\na)\tthe <mcdata-request-uri> element set to the value of the MCData ID of the targeted MCData user;\nb)\tthe <mcdata-calling-user-id> element set to the value of the MCData ID of the calling MCData user; and\nc)\tthe <mcdata-calling-group-id> element set to the value of the MCData group ID of the emergency group communication.\n4)\tshall include in the P-Asserted-Identity header field the public service identity of the controlling MCData function;\n5)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received SIP INVITE request from the originating network according to the procedures specified in clause 9.2.4.4.1 (SDS communication) or 10.2.5.4.1 (FD communication);\n6)\tif the in-progress emergency group state of the group is set to a value of \"true\" the controlling MCData function:\na)\tshall include a Resource-Priority header field populated with the values for an MCData emergency group communication as specified in clause 6.3.7.1.4;\nb)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <emergency-ind> element set to a value of \"true\";\nc)\tif the <alert-ind> element is set to \"true\" in the received SIP INVITE request and the requesting MCData user and MCData group are authorised for the initiation of MCData emergency alerts as determined by the procedures of clause 6.3.7.2.1, shall populate the application/vnd.3gpp.mcdata-info+xml MIME body and the application/vnd.3gpp.mcdata-location-info+xml MIME body as specified in clause 6.3.7.1.3. Otherwise, shall set the <alert-ind> element to a value of \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body; and\nd)\tif the in-progress imminent peril state of the group is set to a value of \"true\" shall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <imminentperil-ind> element set to a value of \"false\"; and\nNOTE 6:\tIf the imminent peril state of the group is true at this point, the controlling function will set it to false as part of the calling procedure.\n7)\tif the in-progress emergency state of the group is set to a value of \"false\" and the in-progress imminent peril state of the group is set to a value of \"true\", the controlling MCData function:\na)\tshall include a Resource-Priority header field populated with the values for an MCData imminent peril group communication as specified in clause 6.3.7.1.4; and\nb)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\".\nThis clause is referenced from other procedures.\nThis clause describes the procedures for updating an MCData session associated with an MCData emergency group communication or MCData imminent peril group communication when the received SIP INVITE request did not include a correctly populated Resource-Priority header field. The procedure is initiated by the controlling MCData function for the purpose of providing the correct Resource-Priority header field.\n1)\tshall generate a SIP 183 (Session Progress) response according to 3GPP TS 24.229 [5] with the clarifications provided specified in clause 5.3.1A;\n2)\tshall include the option tag \"100rel\" in a Require header field in the SIP 183 (Session Progress) response;\n3)\tshall include in the SIP 183 (Session Progress) response an SDP answer to the SDP offer in the incoming SIP INVITE request as specified in the clause 9.2.4.4.2 (SDS communication) or 10.2.5.4.2 (FD communication); and\n4)\tshall send the SIP 183 (Session Progress) response towards the MCData client according to 3GPP TS 24.229 [5].\nUpon receiving a SIP PRACK request to the SIP 183 (Session Progress) response the controlling MCData function:\n1)\tshall send the SIP 200 (OK) response to the SIP PRACK request according to 3GPP TS 24.229 [5].\n2)\tshall generate a SIP UPDATE request according to 3GPP TS 24.229 [5] with the following clarifications:\n3)\tshall include in the SIP UPDATE request an SDP offer based on the SDP offer in the received SIP INVITE request from the originating network according to the procedures specified in clause 9.2.4.4.1 (SDS communication) or 10.2.5.4.1 (FD communication);\n4)\tif the in-progress emergency group state of the group is set to a value of \"true\" the controlling MCData function shall include a Resource-Priority header field populated for an MCData emergency group communication as specified in clause 6.3.7.1.4; and\nNOTE 1:\tThis is the case when the sending MCData client did not send a Resource-Priority header field populated appropriately to receive emergency-level priority. In this case, the Resource-Priority header field is populated appropriately to provide emergency-level priority.\n5)\tif the in-progress emergency group state of the group is set to a value of \"false\" the controlling MCData function:\na)\tif the in-progress imminent peril state of the group is set to a value of \"false\", shall include a Resource-Priority header field populated for a normal priority MCData group communication as specified in clause 6.3.7.1.4; and\nb)\tif the in-progress imminent peril state of the group is set to a value of \"true\", shall include a Resource-Priority header field populated for an MCData imminent peril group communication as specified in clause 6.3.7.1.4.\nNOTE 2:\tThis is the case when the sending MCData client incorrectly populated a Resource-Priority header field for emergency-level or imminent peril-level priority and the controlling MCData function re-populates it as appropriate to an imminent peril level priority or normal priority level.\nThis clause is referenced from other procedures.\nThis clause describes the procedures for generating a SIP re-INVITE request to be sent by the controlling MCData function.\nThe controlling MCData function:\n1)\tshall generate an SIP re-INVITE request according to 3GPP TS 24.229 [5]; and\n2)\tshall include an SDP offer with the media parameters as currently established with the terminating MCData client according to 3GPP TS 24.229 [5] with the clarifications specified in clause 9.2.4.4.1 (SDS communication) or 10.2.5.4.1 (FD communication).\nThis clause is referenced from other procedures.\nThis clause describes the procedures for generating a SIP re-INVITE request to cancel the in-progress emergency state of an MCData group. The procedure is initiated by the controlling MCData function when it determines the cancellation of the in-progress emergency state of an MCData group is required.\nThe controlling MCData function:\n1)\tshall execute the procedure in clause 6.3.7.1.13;\n2)\tin the generated SIP re-INVITE, shall include a Resource-Priority header field populated with the values for a normal MCData group communication as specified in clause 6.3.7.1.4; and\n3)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <emergency-ind> element set to a value of \"false\".\nThis clause covers the on-demand session case only.\nUpon receipt of a SIP re-INVITE request for an existing MCData one-to-one communication session, the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or if a risk of congestion exists, may reject the SIP re-INVITE with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\nNOTE:\tIf the SIP re-INVITE request contains an emergency indication, the participating MCData function can choose to accept the request.\n2)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP re-INVITE request to retrieve the binding between the MCData ID and public user identity;\n3)\tif the binding between the MCData ID and public user identity does not exist, then the participating MCData function shall reject the SIP re-INVITE request with a SIP 404 (Not Found) response and skip the rest of the steps;\n4)\tshall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5];\n5)\tshall include in the SIP re-INVITE request an SDP offer containing the current media parameters used by the existing session; and\n6)\tshall send the SIP re-INVITE request towards the MCData client according to 3GPP TS 24.229 [5].\nUpon receiving the SIP 200 (OK) response to the SIP re-INVITE request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response and include an SDP answer consistent with the SDP answer in the received SIP 200 (OK) response;\n2)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function;\n3)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15]; and\n4)\tshall forward the SIP 200 (OK) response according to 3GPP TS 24.229 [5].\nThe participating MCData function shall forward any other SIP response that does not contain SDP along the signalling path towards the originating side according to 3GPP TS 24.229 [5].\nThis clause is referenced from other procedures.\nUpon receipt by the participating MCData function of a SIP 2xx response from the controlling MCData function which:\n1)\tdoes not contain a Warning header field as specified in clause 4.9 with the warning text containing the mcdata-warn-code set to \"149\"; and\n2)\tis in response to a SIP INVITE request previously sent by the participating MCData function to the controlling MCData function, containing a Resource-Priority header field populated for an MCData emergency private communication;\nthe participating MCData function shall:\n1)\texecute the procedures in clause 6.3.7.1.4, where references to the controlling MCData function are replaced with references to the participating MCData function;\n2)\tgenerate a SIP re-INVITE request according to 3GPP TS 24.229 [5] to be sent within the SIP dialog of the pre-established session;\n3)\tinclude in the SIP re-INVITE request an SDP offer consistent with the previously negotiated SDP for the pre-established session;\n4)\tinclude in the SIP re-INVITE request a Resource-Priority header field with the contents set as in the Resource-Priority header field included in the SIP INVITE request sent to the controlling MCData function;\n5)\tsend the SIP re-INVITE request to the controlling MCData function; and\n6)\tskip the remaining steps in this procedure;\nNOTE 1:\tThis is the case where the MCData client's previously sent SIP REFER request was either a request for an MCData emergency private communication or the MCData emergency private priority state was already set to \"in-progress\". In either case no SIP INFO pending warning was expected or received.\nUpon receipt by the participating MCData function of a SIP 2xx response from the controlling MCData function which:\n1)\tcontains a Warning header field as specified in clause 4.9 with the warning text containing the mcdata-warn-code set to \"149\"; and\n2)\tis in response to a SIP INVITE request previously sent by the participating MCData function to the controlling MCData function;\nthe participating MCData function shall wait for the receipt of a SIP INFO request from the controlling MCData function.\nUpon receipt of a SIP INFO request from the controlling MCData function within the dialog of the SIP INVITE request for an MCData emergency one-to-one communication, the participating MCData function:\n1)\tshall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5] to be sent within the SIP dialog of the pre-established session;\n2)\tshall include in the SIP re-INVITE request an SDP offer consistent with the previously negotiated SDP for the pre-established session;\n3)\tshall include in the SIP re-INVITE request a Resource-Priority header field with the contents set as in the Resource-Priority header field included in the SIP INVITE request sent to the controlling MCData function;\n4)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcdata-info+xml MIME body containing:\na)\tan <alert-ind> element, if included in the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body contained in the received SIP INFO request, set to the value of the <alert-ind> in the SIP INFO request; and\n5)\tsend the SIP re-INVITE request to the controlling MCData function.\nNOTE 2:\tThis is the case where the MCData client's previously sent SIP REFER request was a request for an MCData emergency private communication and a SIP INFO request was received in the dialog with the controlling MCData function for the MCData emergency private communication.\nThis clause applies to the terminating participating function and is part of processing of an in-progress emergency communication cancellation or an upgrade of an ongoing communication. The incoming SIP re-INVITE request is sent by the controlling MCData function, and the outgoing SIP re-INVITE is sent towards the MCData client.\nOn receipt of a SIP re-INVITE request, the terminating participating MCData function shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5] and further:\n1)\tif the incoming SIP re-INVITE request contained an application/sdp MIME body, shall copy the application/sdp MIME body;\n2)\tif the incoming SIP re-INVITE request contained an application/resource-lists+xml MIME body, shall copy the application/resource-lists+xml MIME body;\n3)\tif the incoming SIP re-INVITE request contained a Resource-Priority header field, shall include in the outgoing SIP re-INVITE request a Resource-Priority header field according to rules and procedures of 3GPP TS 24.229 [5], set to the value indicated in the Resource-Priority header field of the received SIP re-INVITE request;\n4)\tif the incoming SIP re-INVITE request contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body;\n5)\tif the incoming SIP re-INVITE request contained an application/vnd.3gpp.mcdata-location-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-location-info+xml MIME body; and\n6)\tshall send the SIP re-INVITE request according to 3GPP TS 24.229 [5].\nThis clause covers both on-demand sessions and pre-established sessions.\nUpon receipt of a SIP re-INVITE request for an existing MCData one-to-one communication session, the originating participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion, may reject the SIP request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error);\nNOTE:\tIf the SIP re-INVITE request contains an emergency indication, the participating MCData function can choose to accept the request.\n2)\tshall determine the MCData ID of the calling user from the public user identity in the P-Asserted-Identity header field of the SIP re-INVITE request;\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, shall reject the SIP re-INVITE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tshall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5], and proceed as follows:\na)\tif the incoming SIP re-INVITE request contained an application/resource-lists+xml MIME body with the MCData ID of the invited MCData user, shall copy the MIME application/resource-lists+xml body into the generated SIP re-INVITE;\nb)\tif the incoming SIP re-INVITE request contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body into the generated SIP re-INVITE; and\nc)\tif the incoming SIP re-INVITE request contained an application/vnd.3gpp.mcdata-location-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-location-info+xml MIME body into the generated SIP re-INVITE;\n5)\tshall set the <mcdata-calling-user-id> element in an application/vnd.3gpp.mcdata-info+xml MIME body of the SIP re-INVITE request to the MCData ID of the calling user;\n6)\tif the received SIP re-INVITE request contains a <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body, then shall check if the status of the functional alias is activated for the MCData ID. If the functional alias status is activated, then the participating MCData function shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the generated SIP re-INVITE request to the received value, otherwise shall not include a <functional-alias-URI> element;\n7)\tshall include in the SIP re-INVITE request an SDP containing the SDP currently used by the existing session;\n8)\tshall include a Resource-Priority header field according to rules and procedures of 3GPP TS 24.229 [5] set to the value indicated in the Resource-Priority header field, if included in the SIP re-INVITE request from the MCData client; and\n9)\tshall forward the SIP re-INVITE request, according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5];\n2)\tif the received SIP 200 (OK) response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body into the generated SIP 200 (OK) response;\n3)\tif the received SIP 200 (OK) included Warning header field(s), shall copy the Warning header field(s) into the generated SIP 200 (OK) response;\n4)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function;\n5)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5]; and\n6)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15].\nIn the procedures in this clause:\n1)\temergency indication in an incoming SIP re-INVITE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\n2)\talert indication in an incoming SIP re-INVITE request refers to the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body.\nUpon receiving a SIP re-INVITE request with an emergency indication set to a value of \"true\", the controlling MCData function:\n1)\tshall validate that the received SDP is acceptable by the controlling MCData function and if not, reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n2)\tshall validate the request as described in clause 6.3.7.1.9, and if invalid, shall skip the rest of the steps;\n3)\tif the SIP re-INVITE request contains an unauthorised request for an MCData emergency one-to-one communication as determined by clause 6.3.7.2.6:\na)\tshall reject the SIP re-INVITE request by generating a SIP 403 (Forbidden) response and applying the procedure in clause 6.3.7.2.7; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [5] and skip the rest of the steps;\n4)\tif a Resource-Priority header field is included in the received SIP re-INVITE request and if the Resource-Priority header field is set to the value indicated for emergency communications, shall reject the SIP re-INVITE request with a SIP 403 (Forbidden) response and skip the remaining steps if neither of the following conditions are true:\na)\tthe SIP re-INVITE request contains an authorised request for an MCData emergency communication as determined in step 2 above; or\nb)\tthe originating MCData user is in an in-progress emergency private communication state with the targeted MCData user;\n5)\tif the SIP re-INVITE request contains an emergency indication set to a value of \"true\" and the originating MCData user is not in an in-progress emergency private communication state with the targeted MCData user:\na)\tshall cache the information that the MCData user is in an in-progress emergency private communication state with the targeted MCData user; and\nb)\tif the SIP re-INVITE request contains an alert indication set to \"true\" and this is an authorised request for an MCData emergency alert as specified in clause 6.3.7.2.1, shall cache the information that the MCData user has sent an MCData emergency alert to the targeted user; and\n6)\tshall execute the procedure in clause 6.3.7.1.21 in order to send a SIP re-INVITE request towards the MCData user listed in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the received SIP re-INVITE request .\nUpon receiving a SIP 200 (OK) response for the sent SIP re-INVITE request and if a SIP response has not yet been sent to the inviting MCData client, the controlling MCData function:\n1)\tshall invoke the procedure in clause 6.3.7.1.23 with the received indication of the applicable MCData subservice, in order to generate a SIP 200 (OK) response to the received SIP re-INVITE request;\n2)\tif the received SIP re-INVITE request contains an alert indication set to a value of \"true\" and this is an unauthorised request for an MCData emergency alert as specified in clause 6.3.7.2.1, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in clause 4.9; and\nNOTE:\tWhen a SIP 200 (OK) response sent to the originator as a response to a SIP INVITE or a SIP re-INVITE request that contained authorised request(s) for an MCData emergency one-to-one communication and optionally an MCData emergency alert, the originator will consider a SIP 200 (OK) response populated in this manner as confirmation that its request(s) for an upgrade to an MCData emergency one-to-one communication and optionally an MCData emergency alert were accepted by the controlling function.\n3)\tshall send the generated SIP 200 (OK) response towards the inviting MCData client according to 3GPP TS 24.229 [5].\nUpon receiving a SIP ACK to the SIP 200 (OK) response sent towards the inviting MCData client, and the SIP 200 (OK) response was sent with the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in clause 4.9, the controlling MCData function shall follow the procedures in clause 6.3.7.1.10.\nIn the procedures in this clause:\n1)\temergency indication in an incoming SIP re-INVITE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\n2)\talert indication in an incoming SIP re-INVITE request refers to the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body.\nUpon receiving a SIP re-INVITE request with an emergency indication set to a value of \"false\", the controlling MCData  function:\n1)\tshall validate the request as described in clause 6.3.7.1.9, and if invalid, shall skip the rest of the steps;\n2)\tif the SIP re-INVITE request contains an unauthorised request for an MCData emergency private (one-to-one) communication cancellation, as determined by clause 6.3.7.2.3:\na)\tshall generate a SIP 403 (Forbidden) response to reject the SIP re-INVITE request;\nb)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcdata-info+xml MIME body as specified in annex D.1, with an <emergency-ind> element set to a value of \"true\";\nc)\tif the SIP re-INVITE request contains an alert indication set to \"false\" and this is an unauthorised request for an MCData emergency alert cancellation as specified in clause 6.3.7.2.2, shall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcdata-info+xml MIME body with an <alert-ind> element set to \"true; and\nd)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [5] and skip the rest of the steps;\n4)\tshall reject the SIP re-INVITE request with a SIP 403 (Forbidden) response if a Resource-Priority header field is included in the received SIP re-INVITE request set to the value configured for emergency communications, and skip the remaining steps;\n5)\tif the SIP re-INVITE request contains an authorised request for an MCData emergency private communication cancellation as determined by clause 6.3.7.2.3:\na)\tshall clear the cache of the MCData ID of the originator of the MCData emergency private communication that is no longer in an in-progress emergency private communication state with the targeted MCData user; and\nb)\tif the SIP re-INVITE request contains an alert indication set to \"false\" and this is an authorised request for an MCData emergency alert cancellation meeting the conditions specified in clause 6.3.7.2.2:\ni)\tif the received SIP re-INVITE request contains an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, shall clear the cache of the MCData ID of MCData user identified by the <originated-by> element as having an outstanding MCData emergency alert; and\nii)\tif the received SIP re-INVITE request does not contain an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, clear the cache of the MCData ID of the sender of the SIP re-INVITE request, as having an outstanding MCData emergency alert; and\n6)\tshall execute the procedure in clause 6.3.7.1.22 in order to generate a SIP re-INVITE request and send it towards the MCData user listed in the \"uri\" attribute of an <entry> element of a <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the received SIP re-INVITE request.\nUpon receiving a SIP 200 (OK) response for the sent SIP re-INVITE request and if a SIP response has not yet been sent to the inviting MCData client, the controlling MCData function:\n1)\tshall invoke the procedure in clause 6.3.7.1.23 with the received indication of the applicable MCData subsservice, in order to generate a SIP 200 (OK) response to the received SIP re-INVITE request;\n2)\tif the received SIP re-INVITE request contains an alert indication set to a value of \"false\" and this is an unauthorised request for an MCData emergency alert cancellation as specified in clause 6.3.7.2.2, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in clause 4.9; and\nNOTE:\tWhen a SIP 200 (OK) response sent to the originator as a response to a SIP re-INVITE request that contained authorised request(s) for an MCData emergency private communication cancellation and optionally an MCData emergency alert cancellation, the originator will consider a SIP 200 (OK) response populated in this manner as confirmation that its request(s) for cancellation of an MCData emergency private communication and optionally an MCData emergency alert were accepted by the controlling function.\n3)\tshall send the generated SIP 200 (OK) response towards the inviting MCData client according to 3GPP TS 24.229 [5].\nUpon receiving a SIP ACK to the SIP 200 (OK) response sent towards the inviting MCData client, and the SIP 200 (OK) response was sent with the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in clause 4.9, the controlling MCData function shall follow the procedures in clause 6.3.7.1.10.\nThis clause describes the procedures for the controlling MCData function sending a re-INVITE request to an MCData user in an MCData private (one-to-one) communication for the purpose of upgrading the session to an emergency private communication session. The procedure is initiated by the controlling MCData function as the result of receiving a SIP re-INVITE request, as described in clause 6.3.7.1.19.\nThe controlling MCData function:\n1)\tshall generate a SIP re-INVITE request as specified in clause 6.3.7.1.13;\n2)\tif the received SIP re-INVITE request contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP re-INVITE request;\n3)\tif the received SIP re-INVITE request contains an authorised request for an MCData emergency one-to-one communication, as determined by clause 6.3.7.2.6:\na)\tshall set the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP re-INVITE request to a value of \"true\";\nb)\tif the received SIP re-INVITE request contains an alert indication set to a value of \"true\" and this is an authorised request for an MCData emergency alert meeting the conditions specified in clause 6.3.7.2.1, perform the procedures specified in clause 6.3.7.1.3; and\nc)\tif the received SIP re-INVITE request did not contain an alert indication or contains an alert indication set to a value of \"true\" and is not an authorised request for an MCData emergency alert meeting the conditions specified in clause 6.3.7.2.1, shall set the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body to a value of \"false\";\n4)\tshall include a Resource-Priority header field populated with the values for an MCData emergency communication as specified in clause 6.3.7.1.4, if the received SIP re-INVITE request contains an authorised request for an MCData emergency private communication as determined in clause 6.3.7.2.6; and\n5)\tshall send the SIP re-INVITE request towards the core network according to 3GPP TS 24.229 [5].\nUpon receiving SIP 200 (OK) response for the SIP re-INVITE request, the controlling MCData function:\n1)\tshall cache the contact received in the Contact header field.\nThis clause describes the procedures for the controlling MCData function sending a re-INVITE request to an MCData user in an MCData emergency private (one-to-one) communication for the purpose of downgrading the session to a normal priority private communication session. The procedure is initiated by the controlling MCData function as the result of receiving a SIP re-INVITE request, as described in clause 6.3.7.1.20.\nThe controlling MCData function:\n1)\tshall generate a SIP re-INVITE request as specified in clause 6.3.7.1.13;\n2)\tif the received SIP re-INVITE request contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP re-INVITE request;\n3)\tif the received SIP re-INVITE request contains an authorised request for an MCData emergency private communication cancellation as determined by clause 6.3.7.2.3:\na)\tshall set the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body to a value of \"false\";\nb)\tif the received SIP re-INVITE request contains an alert indication set to a value of \"false\" and this is an authorised request for an MCData emergency alert cancellation, meeting the conditions specified in clause 6.3.7.2.2:\ni)\tshall set the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body to a value of \"false\"; and\nii)\tif the received SIP request contains an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, copy the contents of the received <originated-by> element to an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP re-INVITE request; and\nc)\tif the received SIP INVITE request contains an alert indication set to a value of \"false\" and is not an authorised request for an MCData emergency alert cancellation meeting the conditions specified in clause 6.3.7.2.3, shall set the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body to a value of \"true\";\n4)\tshall include a Resource-Priority header field populated with the values for a normal MCData private communication as specified in clause 6.3.7.1.4, if the received SIP re-INVITE request contains an authorised request for an MCData emergency private communication cancellation as determined in clause 6.3.7.2.3; and\n5)\tshall send the SIP re-INVITE request towards the core network according to 3GPP TS 24.229 [5].\nUpon receiving SIP 200 (OK) response for the SIP re-INVITE request, the controlling MCData function:\n1)\tshall cache the contact received in the Contact header field.\nThis procedure is invoked by other procedures in the controlling MCData function with an indication of the MCData subservice for which it is to be applied (Short Data Service using media plane or using session, File Distribution or IP Connectivity). The procedure is initiated by the controlling MCData function as the result of receiving a SIP INVITE or a SIP re-INVITE request.\nThe controlling MCData function:\n1)\tshall generate a SIP 200 (OK) response to the SIP INVITE or SIP re-INVITE request according to 3GPP TS 24.229 [5];\n2)\tshall include the option tag \"timer\" in a Require header field;\n3)\tshall include the Session-Expires header field and start supervising the SIP session according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". The \"refresher\" parameter in the Session-Expires header field shall be set to \"uac\";\n4)\tshall include a P-Asserted-Identity header field set to the public service identity of the controlling MCData function;\n5)\tshall include a SIP URI for the MCData session identity in the Contact header field identifying the MCData session at the controlling MCData function;\n6)\tshall include one of the the following in the Contact header field:\na)\tif the indicated MCData subservice is Short Data Service using media plane or using session:\ni)\tthe g.3gpp.mcdata.sds media feature tag;\nii)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\niii)\tthe isfocus media feature tag;\nb)\tif the indicated MCData subservice is File Distribution:\ni)\tthe g.3gpp.mcdata.fd media feature tag;\nii)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\"; and\niii)\tthe isfocus media feature tag; or\nc)\tif the indicated MCData subservice is IP Connectivity:\ni)\tthe g.3gpp.mcdata.ipconn media feature tag;\nii)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\"; and\niii)\tthe isfocus media feature tag;\n7)\tin response to the SDP offer in the incoming SIP INVITE or SIP re-INVITE request, shall include in the SIP 200 (OK) response an SDP answer specified as follows:\na)\tas in clause 9.2.3.4.2, if the MCData subservice is Short Data Service using media plane; or\nb)\tas in clause 9.2.4.4.2, if the indicated MCData subservice is Short Data Service using session; or\nc)\tas in clause 10.2.5.4.2, if the indicated MCData subservice is File Distribution; or\nd)\tas in clause 20.4.0b, if the indicated MCData subservice is IP Connectivity;\n8)\tshall include Warning header field(s) received in incoming responses to the SIP INVITE or SIP re-INVITE request;\n9.)\tif the incoming SIP 200 (OK) response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response; and\n10)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.3.1.\nIf the controlling MCData function has received a SIP request targeted to an MCData group and if the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element that is set to the value \"true\", shall reject the SIP request with a SIP 403 (Forbidden) response with the warning text set to \"168 alert is not allowed on the preconfigured group\" as specified in clause 4.9 \"Warning header field\" and shall skip the rest of this procedure.\nIf the controlling MCData function has received a SIP request targeted to an MCData group with the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body set to a value of \"true\", the controlling MCData function shall check the following conditions:\n1)\tif the <allow-activate-emergency-alert> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID and profile index of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\":\na)\tif the \"entry-info\" attribute of the <entry> element of the <EmergencyAlert> element contained within the <MCData-group-call> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"DedicatedGroup\" and:\ni)\tif the MCData group identity targeted for the emergency alert is contained in the <uri-entry> element of the <entry> element of the <EmergencyAlert> element contained within the <MCData-group-call> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]); and\nii)\tif the <mcdata-allow-emergency-alert> element of the <actions> element of a <rule> element of the <ruleset> element of the <list-service> element of the group document identified by the MCData group identity is set to a value of \"true\" as specified in 3GPP TS 24.481 [11]; or\nb)\tif the \"entry-info\" attribute of the <entry> element of the <EmergencyAlert> element contained within the <MCData-group-call> element of the MCData user profile (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"UseCurrentlySelectedGroup\" and the <mcdata-allow-emergency-alert> element of the <actions> element of a <rule> element of the <ruleset> element of the <list-service> element of the group document identified by the MCData group identity targeted for the emergency alert is set to a value of \"true\" as specified in 3GPP TS 24.481 [11];\nthen the MCData emergency alert request shall be considered to be an authorised request for an MCData emergency alert targeted to a MCData group. In all other cases, the MCData emergency alert request shall be considered to be an unauthorised request for an MCData emergency alert targeted to an MCData group.\nIf the controlling MCData function has received a SIP request targeted to an MCData user with the <alert-ind> element of the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body set to a value of \"true\", the controlling MCData function shall check the following conditions:\n1)\tif the <allow-activate-emergency-alert> element of the <actions> element of the <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID and profile index of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\"; and\na)\tif the \"entry-info\" attribute of the <entry> element of the <One-to-One-EmergencyAlert> element contained within the <OnNetwork> element of the <mcdata-user-profile> element within MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"UsePreConfigured\" and the MCData ID of the MCData user targeted for the communication is contained in the <uri-entry> element of the <entry> element of the <One-to-One-EmergencyAlert> element contained within the <OnNetwork> element (see the MCData user profile document in 3GPP TS 24.484 [12]); or\nb)\tif the \"entry-info\" attribute of the <entry> element of the <One-to-One-EmergencyAlert> element contained within the <OnNetwork> element of the <mcdata-user-profile> element within MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"LocallyDetermined\";\nthen the MCData emergency alert request shall be considered to be an authorised request for an MCData emergency alert targeted to an MCData user. In all other cases, it shall be considered to be an unauthorised request for an MCData emergency alert targeted to an MCData user.\nIf the controlling MCData function has received a SIP request with the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body set to a value of \"false\" and:\n1)\tif the <allow-cancel-emergency-alert> element of the <ruleset> element of the MCData user profile document identified by the MCData ID and profile index of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\", then the MCData emergency alert cancellation request shall be considered to be an authorised request for an MCData emergency alert cancellation; and\n2)\tif the <allow-cancel-emergency-alert> element of the <ruleset> element of the MCData user profile document identified by the MCData ID and profile index of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"false\", then the MCData emergency alert cancellation request shall be considered to be an unauthorised request for an MCData emergency alert cancellation.\nIf the controlling MCData function has received a SIP request for an MCData group communication with the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body set to a value of \"false\" and:\n1)\tif the <allow-cancel-group-emergency> element of the <ruleset> element of the MCData user profile document identified by the MCData ID and profile index of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\", then the MCData emergency communication cancellation request shall be considered to be an authorised request for an MCData emergency group communication cancellation; and\n2)\tIf the <allow-cancel-group-emergency> element of the <ruleset> element of the MCData user profile document identified by the MCData ID and profile index of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"false\", then the MCData emergency group communication cancellation request shall be considered to be an unauthorised request for an MCData emergency group communication cancellation.\nIf the controlling MCData function has received a SIP request for an MCData private communication with the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body set to a value of \"false\" and:\n1)\tif the <allow-cancel-private-emergency-call> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID and profile index of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\", then the MCData emergency private communication cancellation request shall be considered to be an authorised request for an MCData emergency private communication cancellation; and\n2)\tif the <allow-cancel-private-emergency-call> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID and profile index of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"false\" or is not present, then the MCData emergency private communication cancellation request shall be considered to be an unauthorised request for an MCData emergency private communication cancellation.\nEditor's Note:  Whether the controlling MCData function examines the <allow-cancel-private-emergency-call> element or uses local policy to determine whether the calling user is authorised to cancel a private emergency communication is FFS.\nWhen the participating MCData function receives a request from the MCData client to initiate an imminent peril MCData group communication or if the controlling MCData function has received a SIP request with the <imminentperil-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body set to a value of \"true\" and:\n1)\tif the <allow-imminent-peril-call> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value other than \"true\" the request for initiating an MCData imminent peril communication shall be considered to be an unauthorised request for an MCData imminent peril communication and skip the remaining steps;\n2)\tif the <allow-imminent-peril-call> element of the <list-service> element of the group document identified by the targeted MCData group identity is set to a value other than \"true\" as specified in 3GPP TS 24.481 [11], the request for initiating an MCData imminent peril communication shall be considered to be an unauthorised request for an MCData imminent peril communication and skip the remaining steps;\n3)\tif the \"entry-info\" attribute of the <entry> element of the <MCDataGroupInitiation> element contained within the <ImminentPerilCall> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"DedicatedGroup\" and if the MCData group identity targeted for the communication is contained in the <uri-entry> element of the <entry> element of the <MCDataGroupInitiation> element contained within the <ImminentPerilCall> element (see the MCData user profile document in 3GPP TS 24.484 [12]); or\n4)\tif the \"entry-info\" attribute of the <entry> element of the <MCDataGroupInitiation> element contained within the <ImminentPerilCall> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"UseCurrentlySelectedGroup\";\nthen the MCData imminent peril communication request shall be considered to be an authorised request for an MCData imminent peril communication. In all other cases, it shall be considered to be an unauthorised request for an MCData imminent peril communication.\nIf the controlling MCData function has received a SIP request with the <imminentperil-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body set to a value of \"false\" and:\n1)\tif the <allow-cancel-imminent-peril> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\", then the MCData emergency communication cancellation request shall be considered to be an authorised request for an MCData imminent peril communication cancellation; and\n2)\tif the <allow-cancel-imminent-peril> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"false\" or not present, then the MCData emergency communication cancellation request shall be considered to be an unauthorised request for an MCData imminent peril communication cancellation.\nWhen the participating MCData function receives a request from the MCData client to originate an MCData emergency group communication or if the controlling MCData function receives a SIP request for an MCData group communication with the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body set to a value of \"true\":\n1)\tif the <allow-emergency-group-call> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\" and:\na)\tif the \"entry-info\" attribute of the <entry> element of the <MCDataGroupInitiation> element of the <EmergencyCall> element contained within the <MCData-group-call> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"DedicatedGroup\" and:\ni)\tif the <uri-entry> element of the <entry> element of the <MCDataGroupInitiation> element of the <EmergencyCall> contained within the <MCData-group-call> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) contains the identity of the MCData group targeted by the calling MCData user and\tif the <allow-MCData-emergency-call> element of the <list-service> element of the group document identified by the targeted MCData group identity is set to a value of \"true\" as specified in 3GPP TS 24.481 [11], then the participating MCData function or the controlling MCData function shall consider the MCData emergency group communication request to be an authorised request for an MCData emergency group communication and skip the remaining steps;\nor\nb)\tif the \"entry-info\" attribute of the <entry> element of the <MCDataGroupInitiation> element of the <EmergencyCall> element contained within the <MCData-group-call> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"UseCurrentlySelectedGroup\" and if the <allow-MCData-emergency-call> element of the <list-service> element of the group document identified by the targeted MCData group identity is set to a value of \"true\" as specified in 3GPP TS 24.481 [11], then the participating MCData function or the controlling MCData function shall consider the MCData emergency group communication request to be an authorised request for an MCData emergency group communication and skip the remaining steps; or\n2)\tif the participating MCData function or the controlling MCData function does not consider the MCData emergency group communication request to be an authorised request for an MCData emergency group communication by step 1) above, then the participating MCData function or the controlling MCData function shall consider the MCData emergency group communication request to be an unauthorised request for an MCData emergency group communication.\nWhen the participating MCData function receives a request from the MCData client to originate an MCData emergency one-to-one communication or if the controlling MCData function receives a SIP request for an MCData private call with the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body set to a value of \"true\":\n1)\tif the <allow-emergency-private-call> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the calling user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"true\"; and\na)\tif the \"entry-info\" attribute of the <entry> element of the <MCDataPrivateRecipient> element of the <EmergencyCall> element contained within the <One-to-One-Communication> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"UsePreConfigured\" and if the MCData ID targeted for the communication is contained in the <uri-entry> element of the <entry> element of the <MCDataPrivateRecipient> element (see the MCData user profile document in 3GPP TS 24.484 [12]); or\nb)\tif the \"entry-info\" attribute of the <entry> element of the <MCDataPrivateRecipient> element of the <EmergencyCall> element contained within the <One-to-One-Communication> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"LocallyDetermined\";\nthen the participating MCData function or the controlling MCData function shall consider the MCData emergency private communication request to be an authorised request for an MCData emergency private communication and skip step 2) below; or\n2)\tif the participating MCData function or the controlling MCData function does not consider the MCData emergency private communication request to be an authorised request for an MCData emergency private communication by step 1) above, then the participating MCData function or the controlling MCData function shall consider the MCData emergency private communication request to be an unauthorised request for an MCData emergency private communication.\nIf the controlling MCData function has received a SIP request with the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body is set to \"true\" and this is an unauthorised request for an MCData emergency communication as determined by the procedures of clause 6.3.7.2.6, the controlling MCData function shall:\n1)\tinclude in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcdata-info+xml MIME body as specified in Annex D.1 with the <mcdatainfo> element containing the <mcdata-Params> element with the <emergency-ind> element set to a value of \"false\" and the <alert-ind> element set to a value of \"false\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.8\tDisposition Notifications",
                            "text_content": "In order to generate an FD notification, the participating MCData function:\n1)\tshall generate an FD NOTIFICATION message as specified in clause 15.1.6; and\n2)\tshall include in the SIP request, the FD NOTIFICATION message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1.\nWhen generating an FD NOTIFICATION message as specified in clause 15.1.6, the participating MCData function:\n1)\tif sending a file download accept notification, shall set the FD disposition notification type IE as \"FILE DOWNLOAD REQUEST ACCEPTED\" as specified in clause 15.2.6;\n2)\tif sending a file download reject notification, shall set the FD disposition notification type IE as \"FILE DOWNLOAD REQUEST REJECTED\" as specified in clause 15.2.6;\n3)\tif sending a file download deferred notification, shall set the FD disposition notification type IE as \"FILE DOWNLOAD REQUEST DEFERRED\" as specified in clause 15.2.6;\n4)\tshall set the Conversation ID to the value of the Conversation ID that was received in the FD message as specified in clause 15.2.9;\n5)\tshall set the Date and time IE to the current time as specified in clause 15.2.8; and\n6)\tif sending a file download completed notification:\na)\tshall set the FD disposition notification type IE as \"FILE DOWNLOAD COMPLETED\" as specified in clause 15.2.6;\nb)\tshall set the Message ID to the value of the Message ID that was received in the FD message as specified in clause 15.2.10;\nc)\tif the FD message was destined for the user, shall not include an Application ID IE as specified in clause 15.2.7 and shall not include a Extended application ID IE as specified in clause 15.2.24; and\nd)\tif the FD message was destined for an application, shall include:\ni)\tan Application ID IE set to the value of the Application ID that was included in the FD message as specified in clause 15.2.3; or\nii)\tan Extended application ID IE set to the value of the Extended application ID that was included in the FD message as specified in clause 15.2.24.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tHandling of MIME bodies in a SIP message",
                    "description": "",
                    "summary": "",
                    "text_content": "The MCData client and the MCData server shall support several MIME bodies in SIP requests and SIP responses.\nWhen the MCData client or the MCData server sends a SIP message and the SIP message contains more than one MIME body, the MCData client or the MCData server:\n1)\tshall, as specified in IETF RFC 2046 [82], include one Content-Type header field with the value set to multipart/mixed and with a boundary delimiter parameter set to any chosen value;\n2)\tfor each MIME body:\na)\tshall insert the boundary delimiter;\nb)\tshall insert the Content-Type header field with the MIME type of the MIME body; and\nc)\tshall insert the content of the MIME body;\n3)\tshall insert a final boundary delimiter; and\n4)\tif an SDP offer or an SDP answer is one of the MIME bodies, shall insert the application/sdp MIME body as the first MIME body.\nNOTE:\tThe reason for inserting the application/sdp MIME body as the first body is that if a functional entity in the underlying SIP core does not understand multiple MIME bodies, the functional entity will ignore all MIME bodies with the exception of the first MIME body. The order of multiple MCData application MIME bodies in a SIP message is irrelevant.\nWhen the MCData client or the MCData server sends a SIP message and the SIP message contains only one MIME body, the MCData client or the MCData server:\n1)\tshall include a Content-Type header field set to the MIME type of the MIME body; and\n2)\tshall insert the content of the MIME body.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.5\tConfidentiality and Integrity Protection of sensitive XML content",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tGeneral",
                            "text_content": "The procedures in clauses 6.5 apply in general to all procedures described in clause 9, clause 10, clause 12 and clause 13 with the exception that the confidentiality and integrity protection procedures for the registration and service authorisation procedures are described in clause 7.\nWhenever the MCData UE includes XML elements or attributes pertaining to the data specified in clause 4.6 in SIP requests or SIP responses, the MCData UE shall perform the procedures in clause 6.5.2.3.1.\nWhenever the MCData server includes XML elements or attributes pertaining to the data specified in clause 4.6 in SIP requests or SIP responses, the MCData server shall perform the procedures in clause 6.5.2.3.2, with the exception that when the MCData server receives a SIP request with XML elements or attributes in an MIME body that need to be copied from the incoming SIP request to an outgoing SIP request without modification, the MCData server shall perform the procedures specified in clause 6.5.2.5.\nNOTE:\tThe procedures in clause 6.5.2.3.1 and clause 6.5.2.3.2 first determine (by referring to configuration) if confidentiality protection is enabled and then call the necessary procedures to encrypt the contents of the XML elements if confidentiality protection is enabled.\nThe functional entity shall perform the procedures in this clause just prior to sending a SIP request or SIP response.\n1)\tThe MCData UE shall perform the procedures in clause 6.5.3.3.1; and\n2)\tThe MCData server shall perform the procedures in clause 6.5.3.3.2.\nNOTE:\tThe procedures in clause 6.5.3.3.1 and clause 6.5.3.3.2 first determine if integrity protection of XML MIME bodies is required and then calls the necessary procedures to integrity protect each XML MIME body if integrity protection is required. Each XML MIME body has its own signature.\nWhenever the functional entity (i.e. MCData UE or MCData server) receives a SIP request or a SIP response, the functional entity shall perform the following procedures before performing any other procedures.\n1)\tThe functional entity shall determine if integrity protection has been applied to an XML MIME body by following the procedures in clause 6.5.3.4.1 and if integrity protection has been applied:\na)\tshall use the keying information described in clause 6.5.3.2 and the procedures described in clause 6.5.3.4.2 to verify the integrity of the XML MIME body; and\nb)\tif the integrity protection checks fail shall not perform any further procedures in this clause;\n2)\tThe functional entity shall determine whether confidentiality protection has been applied to XML elements in XML MIME bodies in a SIP request or SIP response, pertaining to the data specified in clause 4.6, by following the procedures in clause 6.5.2.4.1, and if confidentiality protection has been applied:\na)\tshall use the keying information described in clause 6.5.2.2 along with the procedures described in clause 6.5.2.4.2 to decrypt the received values; and\nb)\tif any decryption procedures fail, shall not perform any further procedures in this clause.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tConfidentiality Protection",
                            "text_content": "In general, confidentiality protection is applied to specific XML elements and attributes in XML MIME bodies in SIP requests and responses as specified in clause 4.6.\nConfiguration for applying confidentiality protection is not selective to a specific XML element or attribute of the data described in clause 4.6. If configuration for confidentiality protection is turned on, then all XML elements and attributes described in clause 4.6 are confidentiality protected. If configuration for confidentiality protection is turned off, then no XML content in SIP requests and SIP responses are confidentiality protected.\nConfidentiality protection uses an XPK to encrypt the data which (depending on who is the sender and who is the receiver of the encrypted information) can be a CSK or an SPK as specified in clause 4.6. An XPK-ID (CSK-ID/SPK-ID) is used to key the XPK (CSK/SPK). It is assumed that before the procedures in this clause are called, the CSK/CSK-ID and/or SPK/SPK-ID are available on the sender and recipient of the encrypted content as described in clause 4.6.\nThe procedures in clause 6.5.2.3 and clause 6.5.2.4 are used with a XPK equal to the CSK and a XPK-ID equal to the CSK-ID in the following circumstances as described in 3GPP TS 33.180 [26]:\n1)\tMCData client sends confidentiality protected content to an MCData server; and\n2)\tMCData server sends confidentiality protected content to an MCData client.\nThe procedure in clause 6.5.2.3 and clause 6.5.2.4 are used with a XPK equal to the SPK and a XPK-ID equal to the SPK-ID when the MCData server sends confidentiality protected content to an MCData server.\nIf the <confidentiality-protection> element in the MCData Service Configuration document as specified in 3GPP TS 24.484 [12] is set to \"true\" or no <confidentiality-protection> element is present in the MCData Service Configuration document, then sending confidentiality protected content from the MCData client to the MCData server is enabled, and the MCData client:\n1)\tshall use the appropriate keying information specified in clause 6.5.2.2;\n2)\tshall perform the procedures in clause 6.5.2.3.3 to confidentiality protect XML elements containing the content described in clause 4.6; and\n3)\tshall perform the procedures in clause 6.5.2.3.4 to confidentiality protect URIs in XML attributes for URIs described in clause 4.6.\nIf the <confidentiality-protection> element in the MCData Service Configuration document as specified in 3GPP TS 24.484 [12] is set to \"false\", then sending confidentiality protected content from the MCData client to the MCData server is disabled, and content is included in XML elements and attributes without encryption.\nIf the <confidentiality-protection> element in the MCData Service Configuration document as specified in 3GPP TS 24.484 [12] is set to \"true\" or no <confidentiality-protection> element is present in the MCData Service Configuration document, then sending confidentiality protected content from the MCData server to the MCData client is enabled. If the <allow-signalling-protection> element of the <protection-between-mcdata-servers> element is set to \"true\" in the MCData Service Configuration document as specified in 3GPP TS 24.484 [12] or no <allow-signalling-protection> element is present in the MCData Service Configuration document, then sending confidentiality protected content between MCData servers is enabled.\nWhen sending confidentiality protected content, the MCData server:\n1)\tshall use the appropriate keying information specified in clause 6.5.2.2;\n2)\tshall perform the procedures in clause 6.5.2.3.3 to confidentiality protect XML elements containing the content described in clause 4.6, and\n3)\tshall perform the procedures in clause 6.5.2.3.4 to confidentiality protect URIs in XML attributes for URIs described in clause 4.6.\nIf the <confidentiality-protection> element in the MCData Service Configuration document as specified in 3GPP TS 24.484 [12] is set to \"false\", then sending confidentiality protected content from the MCData server to the MCData client is disabled, and then content is included in XML elements and attributes without encryption.\nIf the <allow-signalling-protection> element of the <protection-between-mcdata-servers> element in the MCData Service Configuration document as specified in 3GPP TS 24.484 [12] is set to \"false\", then sending confidentiality protected content between MCData servers is disabled, and content is included in XML elements and attributes without encryption.\nThe following procedures shall be performed by an MCData client or an MCData server:\n1)\tperform encryption as specified in W3C: \"XML Encryption Syntax and Processing Version 1.1\", https://www.w3.org/TR/xmlenc-core1/ [28] clause 4.3, using the \"AES-128-GCM algorithm HMAC\" as the encryption algorithm and the XPK as the key; and\n2)\tfollow the semantic for the element of the MIME body as described in Annex F of the present document, to include the encrypted content in the MIME body ensuring that the necessary XML elements required for confidentiality protection are included as specified in 3GPP TS 33.180 [26].\nThe following procedures shall be performed by an MCData client or an MCData server:\n1)\tperform encryption as specified in [aes-gcm], using the \"AES-128-GCM algorithm HMAC\" as the encryption algorithm and the XPK as the key, with a 96 bit randomly selected IV; and\n2)\treplace the URI to be protected in the attribute by a URI constructed as follows:\na)\tthe URI schema is \"\";\nb) the first part of the userinfo part is the base64 encoded result of the encryption of the original attribute value;\nc)\tthe string \";iv=\" is appended to the result of step b);\nd)\tthe base64 encoding of the IV (section 5 of IETF RFC 4648 [30]) is appended to the result of step c);\ne)\tthe string \";key-id=\" is appended to the result of step d);\nf)\tthe base64 encoding of the XPK-ID according to 3GPP 33.180 [26] is appended to the result of step e);\ng)\tthe string \";alg=128-aes-gcm\" is appended to the result of step f); and\nh)\tthe string \"@\" followed by the domain name for MC Services confidentiality protection as specified in 3GPP TS 23.003 [31] is appended to the result of step g).\nThe following procedure is used by the MCData client or MCData server to determine if an XML element is confidentiality protected.\n1)\tif an XML element contains the <EncryptedData> XML element, then the content of the XML element is confidentiality protected; and\n2)\tif an XML element does not contain the <EncryptedData> XML element, then the content of the XML element is.not confidentiality protected.\nThe following procedure is used by the MCData client or MCData server to determine if a URI in the XML attribute is confidentiality protected.\n1)\tif an XML attribute is a URI with the domain name for MC Services confidentiality protection as specified in the 3GPP TS 23.003 [31], then the URI is confidentiality protected; and\n2)\tif an XML attribute is a URI without the domain name for MC Services confidentiality protection as specified in the 3GPP TS 23.003 [31], then the URI is not confidentiality protected.\nThe following procedure shall be performed by an MCData client or an MCData server to decrypt an individual XML element that has a type of \"encrypted\" within an XML MIME body:\n1)\tif the <EncryptedData> XML element or any of its sub-elements as described in 3GPP TS 33.180 [26] are not present in the MIME body then send a SIP 403 (Forbidden) response with the warning text set to \"140 unable to decrypt XML content\" in a Warning header field as specified in clause 4.9, and exit this procedure. Otherwise continue with the rest of the steps;\n2)\tperform decryption on the <EncryptedData> element as specified in W3C: \"XML Encryption Syntax and Processing Version 1.1\", https://www.w3.org/TR/xmlenc-core1/ [28] clause 4.4 to decrypt the contents of the <CipherValue> element contained within the <CipherData> element;\n3)\tif the decryption procedure fails, then send a SIP 403 (Forbidden) response with the warning text set to \"140 unable to decrypt XML content\" in a Warning header field as specified in clause 4.9. Otherwise continue with the rest of the steps; and\n4)\treturn success of this procedure together with the decrypted XML element.\nThe following procedure shall be performed by an MCData client or an MCData server to decrypt a URI in an attribute in a XML document:\n1)\tthe value between \";iv=\" and the next \";\" provides the base64 encoded value of the 96 bit IV and the value between \";=key-id\" and the next \";\" defines the key which has been used for encryption, i.e. \"CSK\" or \"SPK\"; and\n2)\tthe original URI is obtained by decrypting the base64 encoded string between the \"\" URI prefix and the next \";\" using the \"AES-128-GCM algorithm HMAC\" as the decryption algorithm with IV and key as determined in step 1). This value replaces the encrypted URI as the value of the XML attribute.\nThe following procedure is executed when an MCData server receives a SIP request containing XML MIME bodies, where the content needs to be copied from the incoming SIP request to the outgoing SIP request.\nThe MCData server:\n1)\tshall copy the XML elements from the XML MIME body of the incoming SIP request that do not contain a <EncryptedData> XML element, to the same XML body in the outgoing SIP request;\n2)\tfor each encrypted XML element in the XML MIME body of the incoming SIP request as determined by clause 6.5.2.4.1:\na)\tshall use the keying information described in clause 6.5.2.2 to decrypt the content within the XML element by following the procedures specified in clause 6.5.2.4.2, and shall continue with the steps below if the encrypted XML element was successfully decrypted;\nb)\tif confidentiality protection is enabled as specified in clause 6.5.2.3.2, then for each decrypted XML element:\ni)\tshall re-encrypt the content within the XML element using the keying information described in clause 6.5.2.2 and by following the procedures specified in clause 6.5.2.3.3; and\nii)\tshall include the re-encrypted content into the same XML MIME body of the outgoing SIP request; and\nc)\tif confidentiality protection is disabled as specified in clause 6.5.2.3.2, shall include the decrypted content in the same XML MIME body of the outgoing SIP request.\n3)\tfor each encrypted XML URI attribute in the XML MIME body of the incoming SIP request as determined by clause 6.5.2.4.1:\na)\tshall use the keying information described in clause 6.5.2.2 to decrypt the URI value of the XML attribute by following the procedures specified in clause 6.5.2.4.3, and shall continue with the steps below if the encrypted XML attribute value was successfully decrypted;\nb)\tif confidentiality protection is enabled as specified in clause 6.5.2.3.2, then for each decrypted XML element:\ni)\tshall re-encrypt the URI value of the XML attribute using the keying information described in clause 6.5.2.2 and by following the procedures specified in clause 6.5.2.3.4; and\nii)\tshall include the re-encrypted attribute value into the same XML MIME body of the outgoing SIP request; and\nc)\tif confidentiality protection is disabled as specified in clause 6.5.2.3.2, shall include the decrypted value in the same XML MIME body of the outgoing SIP request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tIntegrity Protection of XML documents",
                            "text_content": "Integrity protection can be applied to a whole XML MIME body. When integrity protection is enabled, all XML MIME bodies transported in SIP requests and responses are integrity protected. The following XML MIME bodies used in the present specification in SIP signalling can be integrity protected:\n-\tapplication/vnd.3gpp.mcdata-info+xml;\n-\tapplication/vnd.3gpp.mcdata-mbms-usage-info+xml;\n-\tapplication/vnd.3gpp.mcdata-mbs-usage-info+xml;\n-\tapplication/vnd.3gpp.mcdata-location-info+xml;\n-\tapplication/poc-settings+xml;\n-\tapplication/resources-list+xml;\n-\tapplication/vnd.3gpp.mcdata-affiliation-command+xml;\n-\tapplication/pidf+xml; and\n-\tapplication/xcap-diff+xml.\nIf integrity protection is enabled, and one or more of the XML MIME bodies complying to the types listed above are included in a SIP request or SIP response, then a MIME body of type application/vnd.3gpp.mcptt-signed+xml specified in 3GPP TS 24.379 [10] is included in the SIP request or SIP response containing one or more signatures pointing to those XML MIME bodies as illustrated in Figure 6.5.3.1-1.\nIn order to integrity protect the XML MIME bodies listed above in this clause in SIP requests and SIP responses, the MCData client and MCData server shall, for each MIME body, include the Content-ID header field as specified in IETF RFC 2045 [32] containing a Content-ID (\"cid\") Uniform Resource Locator (URL) as specified in IETF RFC 2392 [33].\nFigure 6.5.3.1-1 illustrates the integrity protection of XML MIME bodies in SIP requests and responses, showcasing the use of Message Digest 6 (MD6) and Secure Hash Algorithm 256 (SHA-256) algorithms to ensure data authenticity. The figure highlights the role of the Session Initiation Protocol (SIP) server in validating the integrity of the XML bodies, with the use of digital signatures to prevent tampering. The diagram emphasizes the importance of secure communication in telecommunication systems, particularly in the context of XML-based messages.\nFigure 6.5.3.1-1: Integrity Protection of XML MIME bodies in SIP requests and SIP responses\nEach MIME body that is integrity protected is assigned a unique signature.\nConfiguration for applying integrity protection is not selective to a specific MIME body. If configuration for integrity protection is turned on, then all XML MIME bodies in SIP requests and responses are integrity protected. If configuration for integrity protection is turned off, then no XML MIME bodies in SIP requests and SIP responses are integrity protected.\nIntegrity protection uses an XPK to sign the data which (depending on who is the sender and who is the receiver of the signed information) can be a CSK or an SPK as specified in clause 4.6. An XPK-ID (CSK-ID/SPK-ID) is used to key the XPK (CSK/SPK). It is assumed that before the procedures in clause 6.5.3.3 and clause 6.5.3.4 are called, the CSK/CSK-ID and/or SPK/SPK-ID are available on the sender and recipient of the integrity protected content, as described in clause 4.6.\nThe procedures in clause 6.5.3.3 and clause 6.5.3.4 shall be used with a XPK equal to the CSK and a XPK-ID equal to the CSK-ID in the following circumstances as described in 3GPP TS 33.180 [26]:\n1)\tMCData client sends integrity protected content to an MCData server; and\n2)\tMCData server sends integrity protected content to an MCData client.\nThe procedure in clause 6.5.3.3 and clause 6.5.3.4 shall be used with a XPK equal to the SPK and a XPK-ID equal to the SPK-ID when the MCData server sends integrity protected content to an MCData server\nIf the <integrity-protection> element in the MCData Service Configuration document as specified in 3GPP TS 24.484 [12] is set to \"true\" or no <integrity-protection> element is present in the MCData Service Configuration document, then sending integrity protected content from the MCData client to the MCData server is enabled, and the MCData client shall use the appropriate keying information specified in clause 6.5.3.2 and shall perform the procedures in clause 6.5.3.3.3 to integrity protect XML MIME bodies.\nNOTE:\tEach XML MIME body is integrity protected separately.\nIf the <integrity-protection> element in the MCData Service Configuration document as specified in 3GPP TS 24.484 [12] is set to \"false\", then sending integrity protected content from the MCData client to the MCData server is disabled, and all XML MIME bodies are sent without integrity protection.\nIf the <integrity-protection> element in the MCData Service Configuration document as specified in 3GPP TS 24.484 [12] is set to \"true\", or no <integrity-protection> element is present in the MCData Service Configuration document, then sending integrity protected content from the MCData server to the MCData client is enabled. If the <allow-signalling-protection> element of the <protection-between-mcdata-servers> element is set to \"true\" in the MCData Service Configuration document as specified in 3GPP TS 24.484 [12] or no <allow-signalling-protection> element is present in the MCData Service Configuration document, then sending integrity protected content between MCData servers is enabled.\nWhen sending integrity protected content, the MCData server shall use the appropriate keying information specified in clause 6.5.3.2 and shall perform the procedures in clause 6.5.3.3.3 to integrity protect XML MIME bodies.\nNOTE:\tEach XML MIME body is integrity protected separately.\nIf the <integrity-protection> element in the MCData Service Configuration document as specified in 3GPP TS 24.484 [12] is set to \"false\", then sending integrity protected content from the MCData server to the MCData client is disabled, and all XML MIME bodies are sent without integrity protection.\nIf the <allow-signalling-protection> element of the <protection-between-mcdata-servers> element in the MCData Service Configuration document as specified in 3GPP TS 24.484 [12] is set to \"false\", then sending integrity protected content between MCData servers is disabled, and content is included in XML elements without encryption.\nThe following procedure shall be performed by the MCData client and MCData server to integrity protect the XML bodies defined by the MIME types listed in clause 6.5.3.1:\n1)\tinclude a Content-Type header field set to \"application/vnd.3gpp.mcptt-signed+xml\" defined in 3GPP TS 24.379 [10];\n2)\tfor each of the MIME types defined in clause 6.5.3.1 where the content defined by these MIME types is to be integrity protected:\na)\tperform reference generation as specified in W3C: \"XML Signature Syntax and Processing (Second Edition)\",  [29] clause 3.1.1 using the SHA256 algorithm to produce a hash of the MIME body and continue with the procedures below if reference generation is successful;\nb)\tperform signature generation as specified in W3C: \"XML Signature Syntax and Processing (Second Edition)\",  [29] clause 3.1.2 using the HMAC-SHA256 signature method and the XPK as the key and continue with the procedures below if signature generation is successful; and\n3)\tfollow the schema defined in Annex F.6.2 and the semantic described in Annex F.6.3 to create the application/vnd.3gpp.mcptt-signed+xml MIME body, defined in 3GPP TS 24.379 [10], containing signatures referring to the XML MIME bodies included in the SIP request or SIP response.\nThe following procedure is used by the MCData client or MCData server to determine if an XML MIME body is integrity protected.\n1)\tif the <Signature> XML element is not present in the XML MIME body, then the content is not integrity protected; and\n2)\tif the <Signature> XML element is present in the XML MIME body, then the content is integrity protected.\nThe following procedure is used by the MCData client or MCData server to verify the integrity of an XML MIME body:\n1)\tif the required sub-elements of the <Signature> as described in 3GPP TS 33.180 [26] are not present in the MIME body and if not present, are not known to the sender and recipient by other means, then the integrity protection procedure fails and exit this procedure. Otherwise continue with the rest of the steps;\n2)\tperform reference validation on the <Reference> element as specified in W3C: \"XML Signature Syntax and Processing (Second Edition)\",  [29] clause 3.2.1;\n3)\tif reference validation fails, then send a SIP 403 (Forbidden) response towards the functional entity with the warning text set to: \"139 integrity protection check failed\" in a Warning header field as specified in clause 4.9, and do not continue with the rest of the steps in this clause;\n4)\tobtain the XPK using the XPK-ID in the received XML body and use it to perform signature validation of the value of the <SignatureValue> element as specified in W3C: \"XML Signature Syntax and Processing (Second Edition)\",  [29] clause 3.2.2;\n5)\tif signature validation fails, then send a SIP 403 (Forbidden) response towards the functional entity with the warning text set to: \"139 integrity protection check failed\" in a Warning header field as specified in clause 4.9, and do not continue with the rest of the steps in this clause; and\n6)\treturn success of the integrity protection of the XML document passes the integrity protection procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.6\tConfidentiality and Integrity Protection of TLV messages",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tGeneral",
                            "text_content": "Signalling plane provides confidentiality and integrity protection for the MCData Data signalling and MCData Data messages sent over the signalling plane. Signalling plane security also provides the authentication of MCData Data messages.\nThe signalling plane security is based on 3GPP MCData security solution including key management and end-to-end protection as defined in 3GPP TS 33.180 [26].\nVarious keys and associated key identifiers protect the MCData Data signalling and MCData Data messages carried on the signalling plane.\nThe MCData Data signalling messages may be:\n1.\tSDS SIGNALLING PAYLOAD;\n2.\tFD SIGNALLING PAYLOAD;\n3.\tSDS NOTIFICATION;\n4.\tFD NOTIFICATION;\n5.\tFD NETWORK NOTIFICATION;\n6.\tCOMMUNICATION RELEASE;\n7.\tSDS OFF-NETWORK MESSAGE; or\n8.\tSDS OFF-NETWORK NOTIFICATION.\nThe MCData Data messages may be:\n1.\tDATA PAYLOAD.\nIn an on-network MCData communication for an MCData group, if protection of MCData Data messages is negotiated, the GMK and the GMK-ID of the MCData group protect the MCData Data messages sent and received by MCData clients;\nIn an on-network one-to-one MCData communications, if protection of MCData Data messages is negotiated, the PCK and the PCK-ID protect the MCData Data messages sent and received by MCData clients;\nIf protection of MCData Data signalling messages sent using unicast between the MCData client and the participating MCData function serving the the MCData client is negotiated, the CSK and the CSK-ID protect the MCData Data signalling messages sent and received using unicast by the MCData client and by a participating MCData function;\nIf protection of MCData Data signalling messages between the participating MCData function and the controlling MCData function is configured, the SPK and the SPK-ID protect the MCData Data signalling messages sent and received between the participating MCData function and the controlling MCData function; and\nIf protection of MCData is configured for an on-network MBMS MCData communication, a MuSiK and the corresponding MuSiK-ID may be used to protect transmissions on an MBMS bearer to and from MCData clients.\nThe GMK and the GMK-ID are distributed to the MCData clients using the group document subscription and notification procedure specified in 3GPP TS 24.481 [11].\nThe PCK and the PCK-ID are generated by the MCData client initiating the standalone SDS using signalling control plane or standalone one-to-one SDS using media plane or one-to-one SDS session or one-to-one FD using media plane and provided to the MCData client receiving the SIP signalling.\nThe CSK and the CSK-ID are generated by the MCData client and provided to the participating MCData function serving the MCData client using SIP signalling.\nThe SPK and the SPK-ID are configured in the participating MCData function and the controlling MCData function.\nThe MuSiK and the MuSiK-ID are distributed to the MCData clients as described in clause 19.\nThe key material for creating and verifying the authentication signature (SSK, PVT and KPAK) is provisioned to the MCData clients by the KMS as specified in 3GPP TS 33.180 [26].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.2\tDerivation of master keys for media and media control",
                            "text_content": "Each MCData Payload Protection Key (DPPK) (i.e. GMK, PCK, CSK, SPK) and its associated key identifier DPPK-ID (i.e. GMK-ID, PCK-ID, CSK-ID, SPK -ID) described in clause 6.6.1 are used to derive a MCData Payload Cipher Key (DPCK) and its associated DPCK-ID as specified in 3GPP TS 33.180 [26].\nDPCK and DPCK-ID are used in the protection of MCData Data signalling and MCData Data messages as specified in 3GPP TS 33.180 [26].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.3\tProtection of MCData Data signalling and MCData Data messages",
                            "text_content": "The MCData Data messages may be encrypted and integrity protected. When encryption is applied to the entire message, the MCData Data message shall be encrypted as specified in clause 8.5.4 in 3GPP TS 33.180 [26]. When encryption is applied to the Payload IEs of the MCData Data message the Payload IEs shall be encrypted as specified in clause 8.5.4 in 3GPP TS 33.180 [26].\nThe MCData Data signalling messages may be encrypted and integrity protected . When encryption is applied the MCData Data signalling shall be encrypted as specified in clause 8.5.4 in 3GPP TS 33.180 [26].\nThe MCData Data messages and the protected MCData Data messages may also be end-to-end authenticated as specified in clause 8.5.5 in 3GPP TS 33.180 [26].\nThe MCData Protected Payload message as specified in 3GPP TS 33.180 [26] inherits the message type from the MCData Data signalling messages and the MCData Data messages with bits 7, 8 set according to clause 8.5.1 of 3GPP TS 33.180 [26] when entire MCData Data signalling messages and the MCData Data messages protected.\nA MCData client transmitting MCData Data messages shall protect the MCData Data messages using the related DPPK and DPPK-ID according to the negotiatd protection method. For one-to-one communications PCK and PCK-ID shall be used as DPPK and DPPK-ID. For group communications GMK and GMK-ID shall be used as DPPK and DPPK-ID.\nA MCData client transmitting MCData Data messages shall use the key material provisioned by the KMS when generating the authentication signature.\nA MCData client which receives protected MCData Data messages shall decrypt and authenticate the protected MCData Data messages using the related DPPK and DPPK-ID according to the negotiated protection method.\nA MCData client which receives signed MCData Data messages shall verify the signature using the signature, the identity of the originating MCData client and the KPAK provisioned by the KMS.\nA MCData client transmitting MCData Data signalling messages shall encrypt the MCData Data signalling messages using CPK and CPK-ID if MCData Data signalling messages protection is negotiated.\nA MCData client which receives encrypted MCData Data signalling messages shall decrypt the media control using CPK and CPK-ID.\nA participating MCData function which receives protected MCData Data messages shall forward it to the next entity without any additional action related to the security framework.\nA participating MCData function, when receiving an encrypted MCData Data signalling messages from a MCData client shall decrypt the encrypted MCData Data signalling messages using the CSK and CSK-ID negotiated with the MCData client which has sent the MCData Data signalling message. Then, the participating MCData function shall forward the MCData Data signalling messages to the controlling MCData function by encrypting the MCData Data signalling messages using SPK and SPK-ID, if protection is configured between the participating MCData function and the controlling MCData function.\nA participating MCData function, when receiving an encrypted MCData Data signalling messages from the controlling MCData function shall decrypt the encrypted MCData Data signalling messages using the SPK and SPK-ID configured between the participating MCData function and the controlling MCData function. Then, the participating MCData function shall forward the MCData Data signalling messages to the destination MCData client using the CSK and CSK-ID if protection is negotiated between the participating MCData function and the MCData client.\nA controlling MCData function which receives protected MCData Data messages shall forward it to the next entity without any additional action related to the security framework.\nA controlling MCData function, when receiving an encrypted MCData Data signalling messages from a participating MCData function shall decrypt the encrypted MCData Data signalling messages using the SPK and SPK-ID configured between the participating MCData function and the controlling MCData function. Then, the controlling MCData function shall forward the MCData Data signalling messages to the participating MCData function serving the destination MCData client by encrypting the MCData Data signalling messages using SPK and SPK-ID, if protection is configured between the participating MCData function and the controlling MCData function.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tStored files operational procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.7.1\tGeneral",
                            "text_content": "This clause describes the various operational procedures (e.g. retrieval of a file, retrieval of a file's metadata, checking the availability of a file) of the stored files for the general clients. The following procedures are common for the functional entities which are required to fulfil the operational requirements using the HTTP interface and support the role of both HTTP Client and HTTP Server as defined in annex A of 3GPP TS 24.482 [24].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.2\tRetrieve the stored file procedure",
                            "text_content": "In order to retrieve a file from the functional entity acting as an HTTP server, the functional entity in the network, acting as an HTTP client:\n1)\tshall generate an HTTP GET request as specified in IETF RFC 7230 [22] and IETF RFC 7231 [23] with the following clarifications:\na)\ta Request-URI set to an absolute URI identifying the URL of the file being requested to download;\nb)\tthe Host header field shall be set to a URI identifying the functional entity acting as an HTTP server; and\nc)\tshall include a valid access token in the Authorization header; and\n2)\tshall send the HTTP GET request as specified for the HTTP client in the network entity in annex A of 3GPP TS 24.482 [24].\nOn receipt of an HTTP 200 OK response containing the requested file, the HTTP client shall store the file for further processing.\nOn receipt of an HTTP GET request with a Request-URI identifying a file, the functional entity acting as an HTTP server:\n1)\tshall handle the HTTP request as specified for the HTTP server in annex A of 3GPP TS 24.482 [24] with the following clarifications:\na)\tshall validate the access token received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\nb)\tif the HTTP client is not allowed to download files due to operator policy, shall return an HTTP 403 Forbidden response; and\nc)\tif the requested file is not available to download, shall return an HTTP 404 Not Found; and\n2)\tshall process the HTTP GET request by following the procedures in IETF RFC 7230 [22] and IETF RFC 7231 [23], and shall return a HTTP 200 OK response containing the requested file.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.3\tVerify the stored file availability procedure",
                            "text_content": "In order to verify whether the corresponding file is available in the functional entity acting as an HTTP server, the functional entity in the network, acting as an HTTP client:\n1)\tshall generate an HTTP HEAD request as specified in IETF RFC 7230 [22] and IETF RFC 7231 [23] with the following clarifications:\na)\ta Request-URI set to an absolute URI identifying the URL of the file being requested to verification of its availability;\nb)\tthe Host header field shall be set to the functional entity acting as an HTTP server; and\nc)\tshall include a valid access token in the Authorization header; and\n2)\tshall send the HTTP HEAD request as specified for the HTTP client in the network entity in annex A of 3GPP TS 24.482 [24].\nOn receipt of an HTTP 404 Not Found response, the HTTP client shall invoke further corresponding procedure when the stored file is not available in the functional entity acting as an HTTP server.\nOn receipt of an HTTP 200 OK response, the HTTP client shall invoke further corresponding procedure when the stored file is available in the functional entity acting as an HTTP server.\nOn receipt of an HTTP HEAD request with a Request-URI identifying a file, the functional entity acting as an HTTP server:\n1)\tshall handle the HTTP request as specified for the HTTP server in annex A of 3GPP TS 24.482 [24] with the following clarifications:\na)\tshall validate the access token received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\nb)\tif the HTTP client is not allowed to request to verify the file availability due to operator policy, shall return an HTTP 403 Forbidden response; and\nc)\tif the requested file is not available in the server, shall return an HTTP 404 Not Found; and\n2)\tshall process the HTTP HEAD request by following the procedures in IETF RFC 7230 [22] and IETF RFC 7231 [23], and shall return a HTTP 200 OK response or any other appropriate response based on the result of the requested operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.8\tProcedures at the MCData gateway",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tGeneral",
                            "text_content": "As described in clause 5.4, the MCData gateway servers are inserted in the path between MCData functions that reside in MCData systems from different trust domains.\nThis clause specifies the behavior of an MCData gateway server that acts as an exit point from an MCData system or as an entry point in an MCData system.\nLocal policies enforcement covers a wide variety of actions that are left to implementation. An example of local policies enforcement is given in clause 6.8.4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tMCData gateway server acting as an exit point from an MCData system",
                            "text_content": "When acting as an exit point from a local MCData system to an interconnected MCData system, the MCData gateway server receives SIP requests and SIP responses intended for the controlling, non-controlling or participating function in the interconnected MCData system.\nWhen receiving an outgoing SIP message, the MCData gateway server acting as an exit point:\n1)\tshall identify the MCData system identity of the interconnected MCData system from information elements in the outgoing SIP message, e.g., the Request-URI;\n2)\tmay enforce local policy, and if local policy enforcement results in rejecting a SIP request (e.g., not having a mutual aid relationship), the MCData gateway shall reject the request by sending back a SIP 403 (Forbidden) response including a warning text \"1xx service not authorized with the interconnected system\", and the MCData gateway server shall not continue with the rest of the steps;\n3)\tmay replace in the outgoing SIP message any addressing information linked to the local MCData system topology with its own addressing information; this includes:\na)\tthe P-Asserted-Identity header field may be set to the MCData gateway server's own URI; and\nb)\tthe Request-URI may be set to the public service identity of the targeted function in the interconnected MCData system, or to the URI of the MCData gateway server that acts as an entry point in the interconnected MCData system; and\nNOTE:\tHow the MCData gateway server determines the public service identity of the targeted MCData function in the interconnected MCData system or the URI of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\n4)\tshall forward the outgoing SIP message according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.3\tMCData gateway server acting as an entry point in an MCData system",
                            "text_content": "When acting as an entry point in an MCData system from an interconnected MCData system, the MCData gateway receives SIP requests and SIP responses intended for the controlling, non-controlling or participating function in the local MCData system.\nWhen receiving an incoming SIP message, the MCData gateway server acting as an entry point:\n1)\tshall identify the MCData system identity of the interconnected MCData system from the P-Asserted-Identity header field of the incoming SIP messages;\n2)\tmay enforce local policy and. if local policy enforcement results in rejecting a SIP request (e.g., not having a mutual aid relationship), the MCData gateway shall reject the request by sending back a SIP 403 (Forbidden) response including a warning text \"180 service not authorized by the interconnected system\", and the MCData gateway server shall not continue with the rest of the steps;\n3)\tshould replace in the incoming SIP message its own addressing information with the addressing information of the targeted MCData function in the local MCData system:\na)\tthe Request-URI should be set to the public service identity of the targeted MCData function in the local MCData system; and\nNOTE:\tHow the MCData gateway server determines the public service identity of the targeted MCData function in the local MCData system is out of the scope of the present document.\n4)\tshall forward the incoming SIP message according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.4\tLocal policies enforcement",
                            "text_content": "Below is one example of local policy enforcement that can be handled by an MCData gateway server.\nIf an MCData gateway server acting as an exit point receives a SIP request or a SIP response that contains sensitive information that cannot be exposed to the targeted interconnected system based on local policies but does not prevent the service from being delivered (e.g. a functional alias), the MCData gateway server can remove that information from the outgoing SIP message before forwarding it.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tRegistration and service authorisation",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes the procedures for SIP registration and MCData service authorization for the MCData client and the MCData service. The MCData UE can use SIP REGISTER or SIP PUBLISH for MCData service settings to perform service authorization for MCData. The decision which method to use is based on implementation and on availability of an access-token received as outcome of the user authentication procedure as described in 3GPP TS 24.482 [24].\nIf another MC service client (e.g. MCPTT, MCVideo) is operating at the same time on the same MC UE as the MCData client, then the MCData client shares the same SIP registration as the other MC service clients. The SIP REGISTER procedures in this clause are combined with the SIP REGISTER procedures for the other operating MC service clients to create a single SIP REGISTER request. If other MC service clients are already operating when the MCData client registers then a re-registration is performed containing the parameters for the other operating MC services.\nAlthough the access-token can be the same for the MCData service as for other MC services when performing service authorization for MCData along with other MC services using SIP REGISTER multipart MIME bodies for each MC service are included in the SIP REGISTER request. The MCData server can therefore receive multipart MIME bodies in the SIP REGISTER request. Multiple contact addresses (one per MC service client) can be included in a SIP REGISTER request provided they all contain the same IP address and port number (see 3GPP TS 24.229 [5] for further details of including multiple contact addresses in a single SIP REGISTER request).\nIf the MCData client logs off from the MCData service but other MC service clients are to remain registered the MC UE performs a re-registration as specified in 3GPP TS 24.229 [5] without the supported g.3gpp.mcdata media feature tags and the g.3gpp.icsi-ref media feature tags containing the values of the supported MCData service ICSIs in the Contact header field of the SIP REGISTER request but with the parameters for the remaining operating MC service clients.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tMCData client procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.2.1\tSIP REGISTER request for service authorisation",
                            "text_content": "When the MCData client performs SIP registration for service authorisation the MCData client shall perform the registration procedures as specified in 3GPP TS 24.229 [5].\nThe MCData client shall include the following media feature tags in the Contact header field of the SIP REGISTER request:\n1)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\";\n2)\tif SDS is supported then:\na)\tthe g.3gpp.mcdata.sds media feature tag; and\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\n3)\tif FD service is supported then:\na)\tthe g.3gpp.mcdata.fd media feature tag; and\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\".\nNOTE 1:\tIf the MCData client logs off from the MCData service but the MCData UE remains registered the MCData UE performs a re-registration as specified in 3GPP TS 24.229 [5] without the supported g.3gpp.mcdata media feature tags and the g.3gpp.icsi-ref media feature tag containing the supported MCData service ICSIs in the Contact header field of the SIP REGISTER request.\nIf the MCData client, upon performing SIP registration:\n1)\thas successfully finished the user authentication procedure as described in 3GPP TS 24.482 [24];\n2)\thas available an access-token;\n3)\tbased on implementation decides to use SIP REGISTER for service authorization;\n4)\tconfidentiality protection is disabled as specified in clause 6.5.2.3.1; and\n5)\tintegrity protection is disabled as specified in clause 6.5.3.3.1;\nthen the MCData client shall include in the SIP REGISTER request an application/vnd.3gpp.mcdata-info+xml MIME body as defined in Annex D.1 with:\n1)\tthe <mcdata-access-token> element set to the value of the access token received during the user authentication procedures; and\n2)\tthe <mcdata-client-id> element set to the value of the MCData client ID of the originating MCData client.\nNOTE 2:\tthe access-token contains the MCData ID of the user.\nIf the MCData client, upon performing SIP registration:\n1)\thas successfully finished the user authentication procedure as described in 3GPP TS 24.482 [24];\n2)\thas an available access-token;\n3)\tbased on implementation decides to use SIP REGISTER for service authorization; and\n4)\teither confidentiality protection is enabled as specified in clause 6.5.2.3.1 or integrity protection is enabled as specified in clause 6.5.3.3.1;\nthen the MCData client:\n1)\tshall include an application/mikey MIME body with the CSK as MIKEY-SAKKE I_MESSAGE as specified in 3GPP TS 33.180 [26] in the body of the SIP REGISTER request;\n2)\tif confidentiality protection is enabled as specified in clause 6.5.2.3.1, shall include in the body of the SIP REGISTER request an application/vnd.3gpp.mcdata-info+xml MIME body with the following clarifications:\na)\tshall encrypt the received access-token using the CSK and include the <mcdata-access-token> element set to the encrypted access-token, as specified in clause 6.5.2.3.1; and\nb)\tshall encrypt the MCData client ID of the originating MCData client using the CSK and include the <mcdata-client-id> element set to the encrypted MCData client ID;\n3)\tif confidentiality protection is disabled as specified in clause 6.5.2.3.1, shall include an application/vnd.3gpp.mcdata-info+xml MIME body as defined in Annex D.1 with:\na)\tthe <mcdata-access-token> element set to the value of the access token received during the user authentication procedures; and\nb)\tthe <mcdata-client-id> element set to the value of the MCData client ID of the originating MCData client; and\n4)\tif integrity protection is enabled as specified in clause 6.5.3.3.1, shall use the CSK to integrity protect the application/vnd.3gpp.mcdata-info+xml MIME body by following the procedures in clause 6.6.3.3.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.1AA\tSIP REGISTER request without service authorisation",
                            "text_content": "When the MCData client performs SIP registration without service authorisation the MCData client shall perform the registration procedures as specified in 3GPP TS 24.229 [5].\nThe MCData client shall include the following media feature tags in the Contact header field of the SIP REGISTER request:\n1)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\";\n2)\tif SDS is supported then:\na)\tthe g.3gpp.mcdata.sds media feature tag; and\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\n3)\tif FD service is supported then:\na)\tthe g.3gpp.mcdata.fd media feature tag; and\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\".\nNOTE:\tIf the MCData client logs off from the MCData service but the MCData UE remains registered the MCData UE performs a re-registration as specified in 3GPP TS 24.229 [5], without the supported g.3gpp.mcdata media feature tags and the g.3gpp.icsi-ref media feature tag containing the supported MCData service ICSIs in the Contact header field of the SIP REGISTER request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.1A\tCommon SIP PUBLISH procedure",
                            "text_content": "This procedure is only referenced from other procedures.\nWhen populating the SIP PUBLISH request, the MCData client shall:\n1)\tshall set the Request-URI to the public service identity identifying the participating MCData function serving the MCData user;\n2)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7];\n3)\tshall set the Event header field to the \"poc-settings\" value; and\n4)\tshall set the Expires header field according to IETF RFC 3903 [34], to 4294967295, if the MCData user is not removing the MCData service settings, otherwise to remove the MCData service settings the MCData client shall set the Expires header field to zero.\nNOTE 1:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\nNOTE 2:\tThe expiration timer of the MCData client service settings is only applicable for the MCData client service settings from the MCData client that matches the Instance Identifier URN. The expiration timer of MCData user service settings is also updated in the MCData server if expiration timer of MCData client service settings is updated in the MCData server.\nNOTE 3:\tRemoving the MCData service settings by setting the Expires header field to zero, logs off the MCData client from the MCData service.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.2\tSIP PUBLISH request for service authorisation and MCData service settings",
                            "text_content": "If based on implementation the MCData client decides to use SIP PUBLISH for MCData server settings to also perform service authorization and\n1)\thas successfully finished the user authentication procedure as described in 3GPP TS 24.482 [24]; and\n2)\thas available an access-token;\nthen the MCData client:\n1)\tshall perform the procedures in clause 7.2.1A;\n2)\tif confidentiality protection is disabled as specified in clause 6.5.2.3.1 and integrity protection is disabled, shall include in the body of the SIP PUBLISH request, an application/vnd.3gpp.mcdata-info+xml MIME body as specified in Annex D.1 with the <mcdata-access-token> element set to the value of the access token received during the user authentication procedures;\n3)\tif either confidentiality protection is enabled as specified in clause 6.5.2.3.1 or integrity protection is enabled as specified in clause 6.5.3.3.1 shall include an application/mikey MIME body with the CSK as MIKEY-SAKKE I_MESSAGE as specified in 3GPP TS 33.180 [26] in the body of the SIP PUBLISH request;\n4)\tif confidentiality protection is enabled as specified in clause 6.5.2.3.1, shall include in the body of the SIP PUBLISH request an application/vnd.3gpp.mcdata-info+xml MIME body with:\na)\tthe <mcdata-access-token> element set to the received access-token encrypted using the CSK, as specified in clause 6.5.2.3.3; and\nb)\tthe <mcdata-client-id> element set to the encrypted MCData client ID of the originating MCData client, as specified in clause 6.5.2.3.3;\n5)\tif confidentiality protection is disabled as specified in clause 6.5.2.3.1, shall include in the body of the SIP PUBLISH request, an application/vnd.3gpp.mcdata-info+xml MIME body as specified in Annex D.1 with:\na)\tthe <mcdata-access-token> element set to the value of the access token received during the user authentication procedures in the body of the SIP PUBLISH request; and\nb)\tthe <mcdata-client-id> element set to the value of the MCData client ID of the originating MCData client;\n6)\tshall include an application/poc-settings+xml MIME body as defined in 3GPP TS 24.379 [10] containing:\na)\tthe <selected-user-profile-index> element set to the value contained in the \"user-profile-index\" attribute of the selected MCData user profile as defined in 3GPP TS 24.484 [12]; and\n7)\tif integrity protection is enabled as specified in clause 6.5.3.3.1, shall use the CSK to integrity protect the application/vnd.3gpp.mcdata-info+xml MIME body and application/poc-settings+xml MIME body by following the procedures in clause 6.5.3.3.3.\nThe MCData client shall send the SIP PUBLISH request according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.3\tSending SIP PUBLISH for MCData service settings only",
                            "text_content": "To set, update, remove or refresh the MCData service settings, the MCData client shall generate a SIP PUBLISH request according 3GPP TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 4354 [35]. In the SIP PUBLISH request, the MCData client:\n1)\tshall perform the procedures in clause 7.2.1A;\n2)\tif confidentiality protection is enabled as specified in clause 6.5.2.3.1, shall include in the body of the SIP PUBLISH request, an application/vnd.3gpp.mcdata-info+xml MIME body with:\na)\tthe <mcdata-request-uri> element set to the targeted MCData ID encrypted using the CSK, as specified in clause 6.5.2.3.3; and\nb)\tthe <mcdata-client-id> element set to the encrypted MCData client ID of the originating MCData client, as specified in clause 6.5.2.3.3;\n3)\tif confidentiality protection is disabled as specified in clause 6.5.2.3.1, shall include an application/vnd.3gpp.mcdata-info+xml MIME body as specified in Annex D.1 with:\na)\tthe <mcdata-request-uri> set to the cleartext targeted MCData ID; and\nb)\tthe <mcdata-client-id> element set to the value of the MCData client ID of the originating MCData client;\n4)\tshall include an application/poc-settings+xml MIME body as defined in 3GPP TS 24.379 [10] containing:\na)\tthe <selected-user-profile-index> element set to the value contained in the \"user-profile-index\" attribute of the selected MCData user profile as defined in 3GPP TS 24.484 [12]; and\n5)\tif integrity protection is enabled as specified in clause 6.5.3.3.1, shall use the CSK to integrity protect the application/vnd.3gpp.mcdata-info+xml MIME body and application/poc-settings+xml MIME body by following the procedures in clause 6.5.3.3.3.\nThe MCData client shall send the SIP PUBLISH request according to 3GPP TS 24.229 [5].\nOn receiving the SIP 200 (OK) response to the SIP PUBLISH request the MCData client may indicate to the MCData User the successful communication of the MCData service settings to the MCData server.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.4\tDetermination of MCData service settings",
                            "text_content": "In order to discover MCData service settings of another MCData client of the same MCData user or to verify the currently active MCData service settings of this MCData client, the MCData client shall generate an initial SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 6665 [36], and IETF RFC 4354 [35].\nIn the SIP SUBSCRIBE request, the MCData client:\n1)\tshall set the Request-URI to the public service identity identifying the originating participating MCData function serving the MCData user;\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData client shall include the <mcdata-request-uri> element set to the MCData ID of the MCData user;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7];\n4)\tshall set the Event header field to the 'poc-settings' value;\n5)\tshall include an Accept header field containing the \"application/poc-settings+xml\" MIME type;\n6)\tif the MCData client wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [36], to 4294967295; and\nNOTE 1:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n7)\tif the MCData client wants to fetch the current state only, shall set the Expires header field according to IETF RFC 6665 [36], to zero.\nIn order to re-subscribe or de-subscribe, the MCData client shall generate an in-dialog SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 6665 [36], IETF RFC 4354 [35]. In the SIP SUBSCRIBE request, the MCData client:\n1)\tshall set the Event header field to the 'poc-settings' value;\n2)\tshall include an Accept header field containing the \"application/poc-settings+xml\" MIME type;\n3)\tif the MCData client wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [36], to 4294967295; and\nNOTE 2:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n4)\tif the MCData client wants to de-subscribe, shall set the Expires header field according to IETF RFC 6665 [36], to zero.\nUpon receiving a SIP NOTIFY request according to 3GPP TS 24.229 [5], IETF RFC 6665 [36] and IETF RFC 4354 [35], that contains an application/poc-settings+xml MIME body the MCData client shall cache:\n1)\tthe <am-settings> element of the poc-settings+xml MIME body for each MCData client identified by the \"id\" attribute according to IETF RFC 4354 [35] as the current Answer-mode indication of that MCData client; and\n2)\tthe <selected-user-profile-index> element of the poc-settings+xml MIME body for each MCData client identified by the \"id\" attribute according to IETF RFC 4354 [35] as the active MCData user profile of that MCData client.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.5\tReceiving a CSK key download message",
                            "text_content": "When the MCData client receives a SIP MESSAGE request containing:\n1)\ta P-Asserted-Service header field containing the \"urn:urn-7:3gpp-service.ims.icsi.mcdata\"; and\n2)\tan application/mikey MIME body;\nThen, if the key identifier within the CSB-ID of the MIKEY payload is a CSK-ID (4 most-significant bits have the value '2'), the MCData client:\n1)\tshall follow the security procedures in clause 9.2.1 of 3GPP TS 33.180 [26] to extract the CSK. The client:\na)\tif the initiator field (IDRi) has type 'URI' (identity hiding is not used), the client:\ni)\tshall extract the initiator URI from the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26]. If the initiator URI deviates from the public service identity of the participating MCData function serving the MCData user, shall reject the SIP MESSAGE request with a SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [45], and include warning text set to \"136 authentication of the MIKEY-SAKKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps; and\nii)\tshall convert the initiator URI to a UID as described in 3GPP TS 33.180 [26];\nb)\tif the initiator field (IDRi) has type 'UID' (identity hiding in use), the client:\ni)\tshall convert the public service identity of participating MCData function serving the MCData user to a UID as described in 3GPP TS 33.180 [26]; and\nii)\tshall compare the generated UID with the UID in the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26]. If the two initiator UIDs deviate from each other, shall reject the SIP MESSAGE request with a SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [45], and include warning text set to \"136 authentication of the MIKEY-SAKKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nc)\tshall use the UID to validate the signature of the I_MESSAGE as described in 3GPP TS 33.180 [26];\nd)\tif authentication verification of the I_MESSAGE fails, shall reject the SIP MESSAGE request with a SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [45], and include warning text set to \"136 authentication of the MIKEY-SAKKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\ne)\tshall extract and decrypt the encapsulated CSK using the participating MCData function's (KMS provisioned) UID key as described in 3GPP TS 33.180 [26];\nf)\tshall extract and store the algorithm to be used to protect the MCData signalling fields; and\ng)\tshall extract the CSK-ID, from the payload as specified in 3GPP TS 33.180 [26]; and\n2)\tUpon successful extraction, the client shall replace the existing CSK and CSK-ID associated with the participating MCData function, with the extracted CSK and CSK-ID in the 'key download' message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.3\tMCData server procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.3.1\tGeneral",
                            "text_content": "The MCData server obtains information that it needs to implement service authorization specific requirements from:\na)\tany received third-party SIP REGISTER request (e.g. including information contained in the body of the third-party SIP REGISTER request) as specified in 3GPP TS 24.229 [5]. The body will carry the SIP REGISTER request as sent by the MCData client and may contain information needed for service authorization; or\nb)\tany received SIP PUBLISH request for MCData server settings containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters. The body of the SIP PUBLISH request will contain information needed for service authorization.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.1A\tConfidentiality and Integrity Protection",
                            "text_content": "When the MCData server receives a SIP REGISTER request sent from the MCData client contained within a message/sip MIME body of a received third-party SIP REGISTER request or a SIP PUBLISH request, it first determines whether XML MIME bodies included in the request are integrity protected. If XML MIME bodies are integrity protected the MCData server validates the signature of each of the XML MIME bodies. If the integrity protection check(s) pass or the XML MIME bodies are not integrity protected, the MCData server then determines whether the content in specific XML elements is confidentiality protected. If XML content is confidentiality protected, the MCData server decrypts the protected content.\nUpon receiving:\n-\ta SIP REGISTER request containing an application/vnd.3gpp.mcdata-info+xml MIME body within a message/sip MIME body of the SIP REGISTER request sent from the MCData client; or\n-\ta SIP PUBLISH request containing an application/vnd.3gpp.mcdata-info+xml MIME body and an application/poc-settings+xml MIME body;\nthe MCData server:\n1)\tshall determine if integrity protection has been applied to XML MIME bodies in the SIP request by following the procedures in clause 6.5.3.4.1 for each XML MIME body;\n2)\tif integrity protection has been applied, shall use the keying data described in clause 6.5.3.2 and the procedures described in clause 6.5.3.4.2 to verify the integrity of each of the XML MIME bodies; and\n3)\tif all integrity protection checks succeed, shall continue with the remaining steps of this clause.\nUpon receiving:\n-\ta SIP REGISTER request containing an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-access-token> element and an <mcdata-client-id> element within a message/sip MIME body of the SIP REGISTER request sent from the MCData client; or\n-\ta SIP PUBLISH request containing an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-access-token> element and an <mcdata-client-id> element, and an application/poc-settings+xml MIME body;\nthe MCData server:\n1)\tshall determine if confidentiality protection has been applied to the <mcdata-access-token> element and the <mcdata-client-id> element in the application/vnd.3gpp.mcdata-info+xml MIME body, by following the procedures in clause 6.5.2.4.1;\n2)\tif confidentiality protection has been applied to the <mcdata-access-token> element and <mcdata-client-id> element:\na)\tshall use the keying information received in the MIKEY-SAKKE I_MESSAGE as specified in 3GPP TS 33.180 [26], along with the procedures described in clause 6.5.2.4.2 to:\ni)\tdecrypt the received access token in the <mcdata-access-token> element in the application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tdecrypt the received MCData client ID in the <mcdata-client-id> element in the application/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tif the decryption procedure succeeds, shall identify the MCData ID and the MCData client ID from the decrypted values; and\nc)\tif the decryption procedure fails, shall determine that confidentiality protection has not been successful;\n3)\tif confidentiality protection has been applied to only one of the <mcdata-access-token> element or the <mcdata-client-id> element:\na)\tshall determine that confidentiality protection has not been successful;\n4)\tif confidentiality protection has not been applied:\na)\tshall identify the MCData ID from <mcdata-access-token> element received in the application/vnd.3gpp.mcdata-info+xml MIME body; and\nb)\tshall identify the MCData client ID from the <mcdata-client-id> element received in the application/vnd.3gpp.mcdata-info+xml MIME body.\nUpon receiving a SIP PUBLISH request containing an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-request-uri> element, an <mcdata-client-id> element, and an application/poc-settings+xml MIME body, the MCData server:\n1)\tshall determine if confidentiality protection has been applied to the <mcdata-request-uri> element and the <mcdata-client-id> element in the application/vnd.3gpp.mcdata-info+xml MIME body by following the procedures in clause 6.5.2.4.1;\n2)\tif confidentiality protection has been applied to the <mcdata-request-uri> element and the <mcdata-client-id> element:\na)\tshall use the keying information described in clause 6.5.2.2 along with the procedures described in clause 6.5.2.4.2 to:\ni)\tdecrypt the received encrypted MCData ID in the <mcdata-request-uri> element in the application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tdecrypt the received encrypted MCData client ID in the <mcdata-client-id> element in the application/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tif all decryption procedures succeed, shall identify the MCData ID and MCData client ID from the decrypted values; and\nc)\tif the decryption procedure fails, shall determine that confidentiality protection has not been successful;\n3)\tif confidentiality protection has been applied to only one of the <mcdata-request-uri> element or <mcdata-client-id> element:\na)\tshall determine that confidentiality protection has not been successful;\n4)\tif confidentiality protection has not been applied:\na)\tshall identify the MCData ID from the contents of the <mcdata-request-uri> element in the application/vnd.3gpp.mcdata-info+xml MIME body; and\nb)\tshall identify the MCData client ID from the <mcdata-client-id> element received in the application/vnd.3gpp.mcdata-info+xml MIME body.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.2\tSIP REGISTER request for service authorisation",
                            "text_content": "The MCData server shall support obtaining service authorization specific information from the SIP REGISTER request sent from the MCData client and included in the body of a third-party SIP REGISTER request.\nNOTE 1:\t3GPP TS 24.229 [5] defines how based on initial filter criteria the SIP REGISTER request sent from the UE is included in the body of the third-party SIP REGISTER request.\nUpon receiving a third party SIP REGISTER request with a message/sip MIME body containing the SIP REGISTER request sent from the MCData client containing an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-access-token> element and an <mcdata-client-id> element within a message/sip MIME body of the SIP REGISTER request sent from the MCData client, the MCData server:\n1)\tshall identify the IMS public user identity from the third-party SIP REGISTER request;\n2)\tshall identify the MCData ID from the SIP REGISTER request sent from the MCData client and included in the message/sip MIME body of the third-party SIP REGISTER request by following the procedures in clause 7.3.1A;\n2A)\tshall check if the number of maximum simultaneous authorizations supported for the MCData user is specified in the <user-max-simultaneous-authorizations> element of the <anyExt> element contained in the <OnNetwork> element of the MCData user profile (see the user profile configuration document in 3GPP TS 24.484 [12]) and if present shall check whether it has been reached. If reached, the MCData server shall not continue with the rest of the steps in this clause;\n2B)\tif the <user-max-simultaneous-authorizations> element of the <anyExt> element is not present in the <OnNetwork> element of the MCData user profile (see the user profile configuration document in 3GPP TS 24.484 [12]), shall check if the number of maximum simultaneous authorizations supported for any MCData user as specified in the <max-simultaneous-authorizations> element of the <anyExt> element contained in the <OnNetwork> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]) has been reached. If reached, the MCData server shall not continue with the rest of the steps in this clause;\n3)\tshall perform service authorization for the identified MCData ID as described in 3GPP TS 33.180 [26];\n4)\tif service authorization was successful, shall bind the MCData ID and the MCData client ID to the IMS public user identity;\n4a)\tif service authorization was successful and if the service authorization request was from an MCData user who is previously MCData service authorized on another MCData client (as determined by a comparison of the received MCData client ID with the MCData client ID of existing bindings), keep the current bindings and create a new binding between the MCData ID, the MCData client ID and the IMS public user identity;\nNOTE 2:\tThe MCData server will store the binding MCData ID, MCData client ID, IMS public user identity and an identifier addressing the MCData server in an external database.\n5)\tif a Resource-Share header field with the value \"supported\" is contained in the \"message/sip\" MIME body of the third-party REGISTER request, shall bind the MCData ID and the MCData client ID to the identity of the MCData UE identified by the \"+g.3gpp.registration-token\" header field parameter in the Contact header field of the incoming third-party REGISTER request; and\n6)\tif more than one binding exists for the MCData ID, shall include in the SIP 200 (OK) response an application/vnd.3gpp.mcdata-info+xml MIME body as specified in annex D.1 with a <multiple-devices-ind> element set to the value \"true\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.3\tSIP PUBLISH request for service authorisation and service settings",
                            "text_content": "The MCData server shall support obtaining service authorization specific information from a SIP PUBLISH request for MCData server settings.\nUpon receiving a SIP PUBLISH request containing:\n1)\tan Event header field set to the \"poc-settings\" value;\n2)\tan application/poc-settings+xml MIME body; and\n3)\tan application/vnd.3gpp.mcdata-info+xml MIME body containing an <mcdata-access-token> element and an <mcdata-client-id> element;\nthe MCData server:\n1)\tshall identify the IMS public user identity from the P-Asserted-Identity header field;\n2)\tshall perform the procedures in clause 7.3.1A;\n3)\tif the procedures in clause 7.3.1A were not successful shall send a SIP 403 (Forbidden) response towards the MCData client with the warning text set to: \"140 unable to decrypt XML content \" in a Warning header field as specified in clause 4.9, and not continue with the rest of the steps in this clause;\n3A)\tshall check if the number of maximum simultaneous authorizations supported for the MCData user as specified in the <user-max-simultaneous-authorizations> element of the <anyExt> element contained in the <OnNetwork> element of the MCData user profile (see the MCData user profile service configuration document in 3GPP TS 24.484 [12]) has been reached. If reached, the MCData server shall send a SIP 486 (Busy Here) response towards the MCData client with the warning text set to: \"228 maximum number of service authorizations reached\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps in this clause;\n3B)\tif the <user-max-simultaneous-authorizations> element of the <anyExt> element is not present in the <OnNetwork> element of the MCData user profile (see the user profile configuration document in 3GPP TS 24.484 [12]), shall check if the number of maximum simultaneous authorizations supported for any MCData user as specified in the <max-simultaneous-authorizations> element of the <anyExt> element contained in the <OnNetwork> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]) has been reached. If reached, the MCData server shall send a SIP 486 (Busy Here) response towards the MCData client with the warning text set to: \"228 maximum number of service authorizations reached\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps in this clause;\n4)\tshall perform service authorization for the identified MCData ID as described in 3GPP TS 33.180 [26];\n5)\tif service authorization was successful:\na)\tshall bind the MCData ID and MCData client ID to the IMS public user identity;\nb)\tif the service authorization request was from an MCData user who is previously MCData service authorized on another MCData client (as determined by a comparison of the received MCData client ID with the MCData client ID of existing bindings), keep the current bindings and create a new binding between the MCData ID, MCData client ID and the IMS public user identity; and\nc)\tif a Resource-Share header field with the value \"supported\" was included in the \"message/sip\" MIME body of the third-party REGISTER request, shall bind the MCData ID and MCData client ID to the identity of the MCData UE identified by the \"+g.3gpp.registration-token\" header field parameter in the Contact header field of the third-party REGISTER request that contained this IMS public user identity;\nNOTE 1:\tThe MCData server will store the binding MCData ID, MCData client ID, IMS public user identity and an identifier addressing the MCData server in an external database.\n6)\tif service authorization was not successful, shall send a SIP 403 (Forbidden) response towards the MCData client with the warning text set to: \"101 service authorisation failed\" in a Warning header field as specified in clause 4.9, and not continue with the rest of the steps in this clause;\n7)\tshall process the SIP PUBLISH request according to rules and procedures of IETF RFC 3903 [34] and if processing of the SIP request was not successful, do not continue with the rest of the steps;\n8)\tshall cache the received MCData service settings until the MCData service settings expiration timer expires;\n9)\tshall send a SIP 200 (OK) response according 3GPP TS 24.229 [5] with:\na)\tif more than one binding exists for the MCData ID, an application/vnd.3gpp.mcdata-info+xml MIME body as specified in annex D.1 with a <multiple-devices-ind> element set to the value \"true\";\n10)\tshall download the MCData user profile from the MCData user database as defined in 3GPP TS 29.283 [37] if not already stored at the MCData server and use the <selected-user-profile-index> element of the poc-settings event package if included to identify the active MCData user profile for the MCData client;\nNOTE 2:\tIf the <selected-user-profile-index> element of the poc-settings event package is included then only that MCData user profile is needed to be downloaded from the MCData user database.\n11)\tif there is no <selected-user-profile-index> element included in the poc-settings event package then if multiple MCData user profiles are stored at the MCData server or downloaded for the MCData user from the MCData user database, shall determine the pre-selected MCData user profile to be used as the active MCData user profile by identifying the MCData user profile (see the MCData user profile document in 3GPP TS 24.484 [12]) in the collection of MCData user profiles that contains a <Pre-selected-indication> element; and\nNOTE 3:\tIf only one MCData user profile is stored at the MCData server or only one MCData user profile is downloaded from the MCData user database, then by default this MCData user profile is the pre-selected MCData user profile.\n12)\tif an <ImplicitAffiliations> element is contained in the <OnNetwork> element of the MCData user profile document with one or more <entry> elements containing an MCData group ID (see the MCData user profile document in 3GPP TS 24.484 [12]) for the served MCData ID, shall perform implicit affiliation as specified in clause 8.3.2.15.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.4\tReceiving SIP PUBLISH request for MCData service settings only",
                            "text_content": "Upon receiving a SIP PUBLISH request containing:\n1)\tan Event header field set to the \"poc-settings\" value;\n2)\tan application/poc-settings+xml MIME body; and\n3)\tan application/vnd.3gpp.mcdata-info+xml MIME body containing an <mcdata-request-uri> element and an <mcdata-client-id> element;\nThe MCData server:\n1)\tshall identify the IMS public user identity from the P-Asserted-Identity header field;\n2)\tshall perform the procedures in clause 7.3.1A;\n3)\tif the procedures in clause 7.3.1A were not successful, shall send a SIP 403 (Forbidden) response towards the MCData client with the warning text set to: \"140 unable to decrypt XML content\" in a Warning header field as specified in clause 4.9, and not continue with the rest of the steps in this clause;\n4)\tshall verify that a binding between the IMS public user identity in the Request-URI and the MCData ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml exists at the MCData server;\n5)\tif a binding exists between the IMS public user identity and the MCData ID in the request and the validity period of the binding has not expired shall download the MCData user profile from the MCData user database as defined in 3GPP TS 29.283 [37] if not already stored at the MCData server;\n6)\tif a binding does not exist between the IMS public user identity and the MCData ID in the request or the binding exists, but the validity period of the binding has expired, shall reject the SIP PUBLISH request with a SIP 404 (Not Found) response and not continue with any of the remaining steps;\n7)\tshall process the SIP PUBLISH request according to rules and procedures of IETF RFC 3903 [34] and if processing of the SIP request was not successful, do not continue with the rest of the steps;\n8)\tshall cache the received MCData service settings until the MCData service settings expiration timer expires;\n9)\tshall send a SIP 200 (OK) response according 3GPP TS 24.229 [5];\n10)\tshall download the MCData user profile from the MCData user database as defined in 3GPP TS 29.283 [37] if not already stored at the MCData server and use the <selected-user-profile-index> element of the poc-settings event package if included to identify the active MCData user profile for the MCData client;\nNOTE 1:\tIf the <selected-user-profile-index> element of the poc-settings event package is included then only that MCData user profile is needed to be downloaded from the MCData user database.\n11)\tif there is no <selected-user-profile-index> element included in the poc-settings event package then if multiple MCData user profiles are stored at the MCData server or downloaded for the MCData user from the MCData user database, shall determine the pre-selected MCData user profile to be used as the active MCData user profile by identifying the MCData user profile (see the MCData user profile document in 3GPP TS 24.484 [12]) in the collection of MCData user profiles that contains a <Pre-selected-indication> element; and\nNOTE 2:\tIf only one MCData user profile is stored at the MCData server or only one MCData user profile is downloaded from the MCData user database, then by default this MCData user profile is the pre-selected MCData user profile.\n12)\tif an <ImplicitAffiliations> element is contained in the <OnNetwork> element of the MCData user profile document with one or more <entry> elements containing an MCData group ID (see the MCData user profile document in 3GPP TS 24.484 [12]) for the served MCData ID, shall perform implicit affiliation as specified in clause 8.3.2.15.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.5\tReceiving SIP PUBLISH request with \"Expires=0\"",
                            "text_content": "Upon receiving a SIP PUBLISH request containing:\n1)\tan Event header field set to the \"poc-settings\" value; and\n2)\tan Expires header field set to 0;\nthe MCData server:\n1)\tshall identify the IMS public user identity from the P-Asserted-Identity header field;\n2)\tshall process the SIP PUBLISH request according to rules and procedures of IETF RFC 3903 [34] and if processing of the SIP request was successful, continue with the rest of the steps;\n3)\tshall remove the MCData service settings;\nNOTE:\tRemoval of MCData service settings includes removal of all group affiliations.\n4)\tshall remove the binding between the MCData ID and public user identity; and\n5)\tshall send a SIP 200 (OK) response according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.6\tSubscription to and notification of MCData service settings",
                            "text_content": "Upon receiving a SIP SUBSCRIBE request such that:\n1)\tRequest-URI of the SIP SUBSCRIBE request contains the public service identity identifying the participating MCData function of the served MCData user;\n2)\tthe SIP SUBSCRIBE request contains an application/vnd.3gpp.mcdata-info+xml MIME body containing the<mcdata-request-uri> element which identifies an MCData ID served by the MCData server;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata,sds\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7]; and\n3)\tthe Event header field of the SIP SUBSCRIBE request contains the 'poc-settings' event type.\nthe MCData server:\n1)\tshall identify the served MCData ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\n2)\tif the Request-URI of the SIP SUBSCRIBE request contains the public service identity identifying the participating MCData function serving the MCData user, shall identify the originating MCData ID from public user identity in the P-Asserted-Identity header field of the SIP SUBSCRIBE request;\n3)\tif the originating MCData ID is different than the served MCData ID, shall send a 403 (Forbidden) response and shall not continue with the rest of the steps; and\n4)\tshall generate a 200 (OK) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 6665 [36] and IETF RFC 4354 [35].\nFor the duration of the subscription, the MCData server shall notify subscriber about changes of the MCData service settings of the subscribed MCData user, as described in clause 7.3.6.2.\nIn order to notify the subscriber about changes of the MCData service settings of the subscribed MCData client of the subscribed MCData user, the MCData server:\n1)\tshall generate an application/poc-settings+xml MIME body as defined in 3GPP TS 24.379 [10] containing:\na)\tthe <selected-user-profile-index> element identifying the active MCData user profile; and\n2)\tsend a SIP NOTIFY request according to 3GPP TS 24.229 [5], IETF RFC 6665 [36] and IETF RFC 4354 [35] with the constructed application/poc-settings+xml MIME body.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.7\tSending a CSK key download message",
                            "text_content": "If confidentiality protection is enabled as specified in clause 6.5.2.3.1, and if the participating MCData function received a Client Server Key (CSK) within a SIP REGISTER request for service authorisation or SIP PUBLISH request for service authorisation, the participating MCData function may decide to update the CSK. In this case, the participating MCData function shall perform a key download procedure for the CSK. The participating MCData function:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall set the Request-URI to the URI received in the To header field in the third-party SIP REGISTER request;\n3)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media-feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n4)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\";\n5)\tshall include an application/mikey MIME body containing the algorithm to be used to protect the MCData signalling fields, the CSK-ID and the CSK encrypted within a MIKEY message to the MC client as specified in clause 9.2.1 of 3GPP TS 33.180 [26] in the body of the SIP MESSAGE request; and\n6)\tshall send the SIP MESSAGE request towards the MCData client according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7A\tMigration service authorization",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7A.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes the migration service authorization procedure for the MCData client. The MCData client uses SIP REGISTER to perform authorization for migration.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7A.2\tMCData client procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7A.2.1\tSIP REGISTER request for migration service authorization",
                            "text_content": "When the MCData client performs SIP registration for migration service authorization, the MCData client shall perform the registration procedures as specified in 3GPP TS 24.229 [5].\nThe MCData client shall include the following media feature tags in the Contact header field of the SIP REGISTER request:\n1)\tthe g.3gpp.mcdata media feature tag; and\n2)\tif SDS is supported then:\na)\tthe g.3gpp.mcdata.sds media feature tag; and\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\";\n3)\tif FD service is supported then:\na)\tthe g.3gpp.mcdata.fd media feature tag; and\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\"; and\n4)\tif IPCONN service is supported then:\na)\tthe g.3gpp.mcdata.ipconn media feature tag; and\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\".\nNOTE 1:\tIf the MCData client logs off from the MCData service but the MCData UE remains registered, the MCData UE performs a re-registration as specified in 3GPP TS 24.229 [5] without the supported g.3gpp.mcdata media feature tags and the g.3gpp.icsi-ref media feature tag containing the supported MCData service ICSIs in the Contact header field of the SIP REGISTER request.\nIf the MCData client, upon performing SIP registration:\n1)\thas successfully finished the user authentication procedure with the partner IdM server as described in 3GPP TS 24.482 [24];\n2)\thas available an access token from the partner IdM server;\n4)\tconfidentiality protection is disabled as specified in clause 6.5.2.3.1; and\n5)\tintegrity protection is disabled as specified in clause 6.5.3.3.1;\nthen the MCData client shall include in the SIP REGISTER request an application/vnd.3gpp.mcdata-info+xml MIME body as defined in annex D.1 with:\n1)\tthe <mcdata-access-token> element set to the value of the access token received from the partner IdM server;\nNOTE 2:\tThe access token contains the MCData ID of the user in the partner MCData system.\n2)\tthe <mcdata-request-uri> element set to the value of the MCData ID of the user in the primary MCData system; and\n3)\tthe <selected-user-profile-index> element set to the value contained in the \"user-profile-index\" attribute of the MCData user profile selected according to clause 4.2.2.1.2.3 of 3GPP TS 24.484 [12].\nIf the MCData client, upon performing SIP registration:\n1)\thas successfully finished the user authentication procedure as described in 3GPP TS 24.482 [24];\n2)\thas an available access token; and\n3)\teither confidentiality protection is enabled as specified in clause 6.5.2.3.1 or integrity protection is enabled as specified in clause 6.5.3.3.1;\nthen the MCData client:\n1)\tshall include an application/mikey MIME body with the CSK as MIKEY-SAKKE I_MESSAGE as specified in 3GPP TS 33.180 [26] in the body of the SIP REGISTER request;\n2)\tif confidentiality protection is enabled as specified in clause 6.5.2.3.1, shall include in the body of the SIP REGISTER request, an application/vnd.3gpp.mcdata-info+xml MIME body with the following clarifications:\na)\tshall encrypt the received access-token using the client server key (CSK) and include the <mcdata-access-token> element set to the encrypted access-token, as specified in clause 6.5.2.3.3;\nb)\tshall encrypt the MCData ID of the user in the primary MCData system and include the <mcdata-request-uri> element set to the encrypted MCData ID; and\nc)\tshall encrypt the value contained in the \"user-profile-index\" attribute of the MCData user profile selected according to clause 4.2.2.1.2.3 of 3GPP TS 24.484 [12] and include the <selected-user-profile-index> element set to the encrypted value;\n3)\tif confidentiality protection is disabled as specified in clause 6.5.2.3.1, shall include an application/vnd.3gpp.mcdata-info+xml MIME body as defined in Annex D.1 with:\na)\tthe <mcdata-access-token> element set to the access token received from the partner IdM server;\nb)\tthe <mcdata-request-uri> element set to the MCData ID of the user in the primary MCData system; and\nc)\tthe <selected-user-profile-index> element set to the value contained in the \"user-profile-index\" attribute of the MCData user profile selected according to clause 4.2.2.1.2.3 of 3GPP TS 24.484 [12]; and\n4)\tif integrity protection is enabled as specified in clause 6.5.3.3.1, shall use the CSK to integrity protect the application/vnd.3gpp.mcdata-info+xml MIME body by following the procedures in clause 6.6.3.3.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7A.2.2\tReceiving a CSK key download message",
                            "text_content": "The MCData client server shall operate as specified in clause 7.2.5.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7A.3\tPartner MCData server procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7A.3.1\tGeneral",
                            "text_content": "In order to perform initial authorization to verify whether the MCData user is permitted to migrate to the partner MCData system, the partner MCData server obtains information from any received third-party SIP REGISTER request (e.g., including information contained in the body of the third-party SIP REGISTER request) as specified in 3GPP TS 24.229 [5]. The body will carry the SIP REGISTER request as sent by the MCData client and may contain information needed for initial authorization.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7A.3.2\tConfidentiality and integrity protection",
                            "text_content": "When the partner MCData server receives a SIP REGISTER request sent from the MCData client contained within a message/sip MIME body of a received third-party SIP REGISTER request, it first determines whether XML MIME bodies included in the request are integrity protected. If XML MIME bodies are integrity protected the MCData server validates the signature of each of the XML MIME bodies. If the integrity protection check(s) pass or the XML MIME bodies are not integrity protected, the partner MCData server then determines whether the content in specific XML elements is confidentiality protected. If XML content is confidentiality protected, the partner MCData server decrypts the protected content.\nUpon receiving a SIP REGISTER request containing an application/vnd.3gpp.mcdata-info+xml MIME body within a message/sip MIME body of the SIP REGISTER request sent from the MCData client, the MCData server:\n1)\tshall determine if integrity protection has been applied to XML MIME bodies in the SIP request by following the procedures in clause 6.5.3.4.1 for each XML MIME body;\n2)\tif integrity protection has been applied, shall use the keying data described in clause 6.5.3.2 and the procedures described in clause 6.5.3.4.2 to verify the integrity of each of the XML MIME bodies; and\n3)\tif all integrity protection checks succeed, shall continue with the remaining steps of this clause.\nUpon receiving a SIP REGISTER request containing an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-access-token> element, an <mcdata-request-uri> element, and a <selected-user-profile-index> element  within a message/sip MIME body of the SIP REGISTER request sent from the MCData client, the MCData server:\n1)\tshall determine if confidentiality protection has been applied to the <mcdata-access-token> element, the <mcdata-request-uri> element, and the <selected-user-profile-index> element in the application/vnd.3gpp.mcdata-info+xml MIME body, by following the procedures in clause 6.5.2.4.1;\n2)\tif confidentiality protection has been applied to the <mcdata-access-token> element, the <mcdata-request-uri> element, and the <selected-user-profile-index> element:\na)\tshall use the keying information received in the MIKEY-SAKKE I_MESSAGE as specified in 3GPP TS 33.180 [26], along with the procedures described in clause 6.5.2.4.2 to:\ni)\tdecrypt the received access token in the <mcdata-access-token> element in the application/vnd.3gpp.mcdata-info+xml MIME body;\nii)\tdecrypt the received MCData ID of the user in the primary MCData system in the <mcdata-request-uri> element in the application/vnd.3gpp.mcdata-info+xml MIME body; and\niii)\tdecrypt the received selected user profile index in the <selected-user-profile-index> element in the application/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tif the decryption procedure succeeds, shall identify:\ni)\tthe MCData ID of the user in the partner MCData system from the decrypted access token;\nii)\tthe MCData ID of the user in the primary MCData system from the decrypted MCData ID of the user in the primary MCData system; and\niii)\tthe selected user profile index from the decrypted selected user profile index; and\nc)\tif the decryption procedure fails, shall determine that confidentiality protection has not been successful;\n3)\tif confidentiality protection has been applied to only one or two of the <mcdata-access-token> element, the <mcdata-request-uri> element, and the <selected-user-profile-index> element:\na)\tshall determine that confidentiality protection has not been successful; and\n4)\tif confidentiality protection has not been applied:\na)\tshall identify the MCData ID of the user in the partner MCData system from <mcdata-access-token> element received in the application/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tshall identify the MCData ID of the user in the primary MCData system from the <mcdata-request-uri> element received in the application/vnd.3gpp.mcdata-info+xml MIME body; and\nc)\tshall identify the selected user profile index from the <selected-user-profile-index> element received in the application/vnd.3gpp.mcdata-info+xml MIME body.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7A.3.3\tSIP REGISTER request for initial authorization",
                            "text_content": "The partner MCData server shall support obtaining migration service authorization specific information from the SIP REGISTER request sent from the MCData client and included in the body of a third-party SIP REGISTER request.\nNOTE 1:\t3GPP TS 24.229 [5] defines how based on initial filter criteria the SIP REGISTER request sent from the UE is included in the body of the third-party SIP REGISTER request.\nUpon receiving a third party SIP REGISTER request with a message/sip MIME body containing the SIP REGISTER request sent from the MCData client containing an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-access-token> element, an <mcdata-request-uri> element, and a <selected-user-profile-index> within a message/sip MIME body of the SIP REGISTER request sent from the MCData client, the MCData server:\n1)\tshall perform initial authorization to verify whether the MCData user is permitted to migrate to the partner MCData system; and\nNOTE 2:\tThe criteria for the initial authorization is outside the scope of the present document.\n2)\tif the initial authorization was successful:\na)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\nb)\tshall set the Request-URI to the public service identity identifying the participating MCData function serving the MCData user in the primary MCData system;\nc)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdata-Params> element containing:\ni)\tthe <mcdata-request-uri> element set to the MCData ID of the user in the primary MCData system identified in clause 7A.3.2;\nii)\tthe <partner-mcdata-id> element set to the MCData ID of the user in the partner MCData system identified in clause 7A.3.2; and\niii)\tthe <selected-user-profile-index> element set to the selected user profile index identified in clause 7A.3.2; and\nd)\tshall send the SIP MESSAGE request towards the partner MCData gateway according to the rules and procedures of 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7A.3.4\tSending a CSK key download message",
                            "text_content": "The partner MCData server shall operate as specified in clause 7.3.7.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7A.4\tPartner MCData gateway server procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7A.4.1\tSIP MESSAGE from the partner MCData server",
                            "text_content": "The partner MCData gateway server shall operate as specified in clause 6.8.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7A.5\tPrimary MCData gateway server procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7A.5.1\tSIP MESSAGE from the partner MCData gateway",
                            "text_content": "The primary MCData gateway server shall operate as specified in clause 6.8.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "8\tAffiliation",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "8.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Clause 8.2 contains the procedures for explicit affiliation at the MCData client.\nClause 8.3 contains the procedures for explicit affiliation at the MCData server serving the MCData user and the MCData server owning the MCData group.\nClause 8.3 contains the procedures for implicit affiliation at the MCData server serving the MCData user and the MCData server owning the MCData group.\nClause 8.4 describes the coding used for explicit affiliation.\nThe procedures for implicit affiliation in this clause are triggered at the MCData server serving the MCData user in the following circumstances:\n-\ton receipt of a SIP MESSAGE request from an MCData client when initiating an MCData emergency alert targeted to an MCData group and the MCData client is not already affiliated to the MCData group; and\n-\ton receipt of a SIP REGISTER request for service authorisation (as described in clause 7.3.2) or SIP PUBLISH request for service authorisation and service settings (as described in clause 7.3.3), as determined by configuration in the MCData user profile document as specified in 3GPP TS 24.484 [12].\nThe procedures for implicit affiliation in this clause are triggered at the MCData server owning the MCData group in the following circumstances:\n-\ton receipt of a SIP MESSAGE request from the MCData server serving the MCData user when the MCData user initiates an MCData emergency alert targeted to an MCData group and the MCData client is not already affiliated to the MCData group.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.2\tMCData client procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.2.1\tGeneral",
                            "text_content": "The MCData client procedures consist of:\n-\tan affiliation status change procedure;\n-\tan affiliation status determination procedure;\n-\ta procedure for sending affiliation status change request in negotiated mode to target MCData user;\n-\ta procedure for receiving affiliation status change request in negotiated mode from authorized MCData user; and\n-\ta rules based affiliation status change procedure.\nIn order to obtain information about success or rejection of changes triggered by the affiliation status change procedure for an MCData user, the MCData client needs to initiate the affiliation status determination procedure for the MCData user before starting the affiliation status change procedure for the MCData user.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.2.2\tAffiliation status change procedure",
                            "text_content": "In order:\n-\tto indicate that an MCData user is interested in one or more MCData group(s) at an MCData client;\n-\tto indicate that the MCData user is no longer interested in one or more MCData group(s) at the MCData client;\n-\tto refresh indication of an MCData user interest in one or more MCData group(s) at an MCData client due to near expiration of the expiration time of an MCData group with the affiliation status set to the \"affiliated\" state received in a SIP NOTIFY request in clause 8.2.3;\n-\tto send an affiliation status change request in mandatory mode to another MCData user;\n-\tto indicate that an MCData user is interested in one or more MCData group(s) at an MCData client triggered by a location or functional alias activation criteria;\n-\tto indicate that the MCData user is no longer interested in one or more MCData group(s) at the MCData client client triggered by location or functional alias deactivation criteria; or\n-\tany combination of the above;\nthe MCData client shall generate a SIP PUBLISH request according to 3GPP TS 24.229 [5], IETF RFC 3903 [34], and IETF RFC 3856 [39].\nWhen the MCData user indicates that he is no longer interested in one or more MCData group(s) at the MCData client, the MCData client shall first check value of the <manual-deaffiliation-not-allowed-if-affiliation-rules-are-met> element if present within the MCData user profile document (see the MCData user profile document specified in 3GPP TS 24.484 [12]). If the affiliation to the group has been activated due to a rule being fulfilled and the <manual-deaffiliation-not-allowed-if-affiliation-rules-are-met> element is present and is set to a value of \"true\", the MCData client shall suppress the MCData user's request.\nNOTE 0:\tIf the request is suppressed, a notification message can be displayed to the user.\nIn the SIP PUBLISH request, the MCData client:\n1)\tshall set the Request-URI to the public service identity identifying the originating participating MCData function serving the MCData user;\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData client shall include the <mcdata-request-uri> element set to the MCData ID of the MCData user;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7];\n4)\tif the targeted MCData user is interested in at least one MCData group at the targeted MCData client, shall set the Expires header field according to IETF RFC 3903 [34], to 4294967295;\nNOTE 1:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n5)\tif the targeted MCData user is no longer interested in any MCData group at the targeted MCData client, shall set the Expires header field according to IETF RFC 3903 [34], to zero; and\n6)\tshall include an application/pidf+xml MIME body indicating per-user affiliation information according to clause 8.4.1. In the MIME body, the MCData client:\na)\tshall include all MCData groups where the targeted MCData user indicates its interest at the targeted MCData client;\nb)\tshall include the MCData client ID of the targeted MCData client;\nc)\tshall not include the \"status\" attribute and the \"expires\" attribute in the <affiliation> element; and\nd)\tshall set the <p-id> child element of the <presence> root element to a globally unique value.\nThe MCData client shall send the SIP PUBLISH request according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.2.3\tAffiliation status determination procedure",
                            "text_content": "NOTE 1:\tThe MCData UE also uses this procedure to determine which MCData groups the MCData user successfully affiliated to.\nIn order to discover MCData groups:\n1)\twhich the MCData user at an MCData client is affiliated to; or\n2)\twhich another MCData user is affiliated to;\nthe MCData client shall generate an initial SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36].\nIn the SIP SUBSCRIBE request, the MCData client:\n1)\tshall set the Request-URI to the public service identity identifying the originating participating MCData function serving the MCData user;\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData client shall include the <mcdata-request-uri> element set to the MCData ID of the targeted MCData user;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7];\n4)\tif the MCData client wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [36], to 4294967295;\nNOTE 2:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n5)\tif the MCData client wants to fetch the current state only, shall set the Expires header field according to IETF RFC 6665 [36], to zero; and\n6)\tshall include an Accept header field containing the application/pidf+xml MIME type; and\n7)\tif requesting MCData groups where the MCData user is affiliated to at the MCData client, shall include an application/simple-filter+xml MIME body indicating per-client restrictions of presence event package notification information according to clause 8.4.2, indicating the MCData client ID of the MCData client.\nIn order to re-subscribe or de-subscribe, the MCData client shall generate an in-dialog SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36]. In the SIP SUBSCRIBE request, the MCData client:\n1)\tif the MCData client wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [36], to 4294967295;\nNOTE 3:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n2)\tif the MCData client wants to de-subscribe, shall set the Expires header field according to IETF RFC 6665 [36], to zero; and\n3)\tshall include an Accept header field containing the application/pidf+xml MIME type.\nUpon receiving a SIP NOTIFY request according to 3GPP TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36], if SIP NOTIFY request contains an application/pidf+xml MIME body indicating per-user affiliation information constructed according to clause 8.4.1, then the MCData client shall determine affiliation status of the MCData user for each MCData group at the MCData client(s) in the MIME body. If the <p-id> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP NOTIFY request is included, the <p-id> element value indicates the SIP PUBLISH request which triggered sending of the SIP NOTIFY request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.2.4\tProcedure for sending affiliation status change request in negotiated mode to target MCData user",
                            "text_content": "NOTE:\tProcedure for sending affiliation status change request in negotiated mode to several target MCData users is not supported in this version of the specification.\nUpon receiving a request from the MCData user to send an affiliation status change request in negotiated mode to a target MCData user, the MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]. In the SIP MESSAGE request, the MCData client:\n1)\tshall set the Request-URI to the public service identity identifying the originating participating MCData function serving the MCData user;\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData client shall include the <mcdata-request-uri> element set to the MCData ID of the target MCData user;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP MESSAGE request;\n4)\tshall include an application/vnd.3gpp.mcdata-affiliation-command+xml MIME body as specified in Annex D.3; and\n5)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP MESSAGE request, the MCData client shall indicate to the user that the request has been delivered to an MCData client of the target MCData user.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.2.5\tProcedure for receiving affiliation status change request in negotiated mode from authorized MCData user",
                            "text_content": "Upon receiving a SIP MESSAGE request containing:\n1)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7]; and\n2)\tan application/vnd.3gpp.mcdata-affiliation-command+xml MIME body with a list of MCData groups for affiliation under the <affiliate> element and a list of MCData groups for de-affiliation under the <de-affiliate> element;\nthen the MCData client:\n1)\tshall send a 200 (OK) response to the SIP MESSAGE request;\n2)\tshall seek confirmation of the list of MCData groups for affiliation and the list of MCData groups for de-affiliation, resulting in an accepted list of MCData groups for affiliation and an accepted list of MCData groups for de-affiliation; and\n3)\tif the user accepts the request:\na)\tshall perform affiliation for each entry in the accepted list of MCData groups for affiliation for which the MCData client is not affiliated, as specified in clause 8.2.2; and\nb)\tshall perform de-affiliation for each entry in the accepted list of MCData groups for de-affiliation for which the MCData client is affiliated, as specified in clause 8.2.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.2.6\tRules based affiliation status change procedure",
                            "text_content": "The MCData client can based on configuration decide to affiliate or de-affiliate to a group.\nUser profile based affiliation rules are controlled by the elements <RulesForAffiliation> or <RulesForDeaffiliation> of the MCData user profile document identified by the MCData ID of the MCData user (see the MCData user profile document specified in 3GPP TS 24.484 [12]). The rules can be composed of location criteria (including heading and speed) or functional alias based criteria. A rule is fulfilled if  any of the location criteria and any of the functional alias based criteria are met. These rules are evaluated whenever a change of location occurs and whenever a functional alias is activated or deactivated. If any defined rule is fulfilled, the MCData client shall initiate the affiliation status change procedure as specified in clause 8.2.2.\nNOTE:\tHysteresis can be applied to location changes to avoid too frequent affiliation changes. In addition, the definition of area entry and exit criteria can be specified to provide a buffer space to minimize ping-ponging into and out of an area.\nIf the <permitted-geographic-area> element of the <list-service> element of an MCS group document is present and the MCData client is within the area specified in the <permitted-geographic-area> element, the MCData client is allowed to affiliate to the group.\nIf the <mandatory-geographic-area> element of the <list-service> element of an MCS group document is present and the MCData client is not within the area specified in the <mandatory-geographic-area> element the MCData client shall de-affiliate from the group.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "8.3\tMCData server procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.3.1\tGeneral",
                            "text_content": "The MCData server procedures consist of:\n-\tprocedures of MCData server serving the MCData user; and\n-\tprocedures of MCData server owning the MCData group.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.3.2\tProcedures of MCData server serving the MCData user",
                            "text_content": "The procedures of MCData server serving the MCData user consist of:\n-\ta receiving affiliation status change from MCData client procedure;\n-\ta receiving subscription to affiliation status procedure;\n-\ta sending notification of change of affiliation status procedure;\n-\ta sending affiliation status change towards MCData server owning MCData group procedure;\n-\tan affiliation status determination from MCData server owning MCData group procedure;\n-\ta procedure for authorizing affiliation status change request in negotiated mode sent to served MCData user;\n-\ta forwarding affiliation status change towards another MCData user procedure;\n-\ta forwarding subscription to affiliation status towards another MCData user procedure\n-\tan affiliation status determination procedure;\n-\tan affiliation status change by implicit affiliation procedure;\n-\tan implicit affiliation status change completion procedure;\n-\tan implicit affiliation status change cancellation procedure; and\n-\tan implicit affiliation to configured groups procedure.\nThe MCData server shall maintain a list of MCData user information entries. The list of the MCData user information entries contains one MCData user information entry for each served MCData ID.\nIn each MCData user information entry, the MCData server shall maintain:\n1)\tan MCData ID. This field uniquely identifies the MCData user information entry in the list of the MCData user information entries; and\n2)\ta list of MCData client information entries.\nIn each MCData client information entry, the MCData server shall maintain:\n1)\tan MCData client ID. This field uniquely identifies the MCData client information entry in the list of the MCData client information entries; and\n2)\ta list of MCData group information entries.\nIn each MCData group information, the MCData server shall maintain:\n1)\tan MCData group ID. This field uniquely identifies the MCData group information entry in the list of the MCData group information entries;\n2)\tan affiliation status;\n3)\tan expiration time;\n4)\tan affiliating p-id; and\n5)\ta next publishing time.\nUpon receiving a SIP PUBLISH request such that:\n1)\tRequest-URI of the SIP PUBLISH request contains either the public service identity identifying the originating participating MCData function serving the MCData user, or the public service identity identifying the terminating participating MCData function serving the MCData user;\n2)\tthe SIP PUBLISH request contains an application/vnd.3gpp.mcdata-info+xml MIME body containing the<mcdata-request-uri> element which identifies an MCData ID served by the MCData server;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tthe Event header field of the SIP PUBLISH request contains the \"presence\" event type; and\n5)\tSIP PUBLISH request contains an application/pidf+xml MIME body indicating per-user affiliation information according to clause 8.4.1;\nthen the MCData server:\n1)\tshall identify the served MCData ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP PUBLISH request;\n2)\tif the Request-URI of the SIP PUBLISH request contains the public service identity identifying the originating participating MCData function serving the MCData user, shall identify the originating MCData ID from public user identity in the P-Asserted-Identity header field of the SIP PUBLISH request;\n3)\tif the Request-URI of the SIP PUBLISH request contains the public service identity identifying the terminating participating MCData function serving the MCData user, shall identify the originating MCData ID in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP PUBLISH request;\n4)\tif the originating MCData ID is different than the served MCData ID and the originating MCData ID is not authorized to modify affiliation status of the served MCData ID, shall send a 403 (Forbidden) response and shall not continue with the rest of the steps;\n5)\tif the Expires header field of the SIP PUBLISH request is not included or has nonzero value lower than 4294967295, shall send a SIP 423 (Interval Too Brief) response to the SIP PUBLISH request, where the SIP 423 (Interval Too Brief) response contains a Min-Expires header field set to 4294967295, and shall not continue with the rest of the steps;\n6)\tif the Expires header field of the SIP PUBLISH request has nonzero value, shall determine the candidate expiration interval to according to IETF RFC 3903 [34];\n7)\tif the Expires header field of the SIP PUBLISH request has zero value, shall set the candidate expiration interval to zero;\n8)\tshall respond with SIP 200 (OK) response to the SIP PUBLISH request according to 3GPP TS 24.229 [5], IETF RFC 3903 [34]. In the SIP 200 (OK) response, the MCData server:\na)\tshall set the Expires header field according to IETF RFC 3903 [34], to the candidate expiration time;\n9)\tif the \"entity\" attribute of the <presence> element of the application/pidf+xml MIME body of the SIP PUBLISH request is different than the served MCData ID, shall not continue with the rest of the steps;\n10)\tshall identify the served MCData client ID in the \"id\" attribute of the <tuple> element of the <presence> element of the application/pidf+xml MIME body of the SIP PUBLISH request;\n11)\tshall consider an MCData user information entry such that:\na)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2; and\nb)\tthe MCData ID of the MCData user information entry is equal to the served MCData ID;\nas the served MCData user information entry;\n12)\tshall consider an MCData client information entry such that:\na)\tthe MCData client information entry is in the list of MCData client information entries of the served MCData user information entry; and\nb)\tthe MCData client ID of the MCData client information entry is equal to the served MCData client ID;\nas the served MCData client information entry;\n13)\tshall consider a copy of the list of the MCData group information entries of the served MCData client information entry as the served list of the MCData group information entries;\n14)\tif the candidate expiration interval is nonzero:\na)\tshall construct the candidate list of the MCData group information entries as follows:\ni)\tfor each MCData group ID which has an MCData group information entry in the served list of the MCData group information entries, such that the expiration time of the MCData group information entry has not expired yet, and which is indicated in a \"group\" attribute of an <affiliation> element of the <status> element of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request:\nA)\tshall copy the MCData group information entry into a new MCData group information entry of the candidate list of the MCData group information entries;\nB)\tif the affiliation status of the MCData group information entry is \"deaffiliating\" or \"deaffiliated\", shall set the affiliation status of the new MCData group information entry to the \"affiliating\" state and shall set the affiliating p-id of the new MCData group information entry to the value of the <p-id> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request; and\nC)\tshall set the expiration time of the new MCData group information entry to the current time increased with the candidate expiration interval;\nii)\tfor each MCData group ID which has an MCData group information entry in the served list of the MCData group information entries, such that the expiration time of the MCData group information entry has not expired yet, and which is not indicated in any \"group\" attribute of the <affiliation> element of the <status> element of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request:\nA)\tshall copy the MCData group information entry into a new MCData group information entry of the candidate list of the MCData group information entries; and\nB)\tif the affiliation status of the MCData group information entry is \"affiliated\" or \"affiliating\":\n-\tshall set the affiliation status of the new MCData group information entry to the \"de-affiliating\" state; and\n-\tshall set the expiration time of the new MCData group information entry to the current time increased with twice the value of timer F; and\niii)\tfor each MCData group ID:\nA)\twhich does not have an MCData group information entry in the served list of the MCData group information entries; or\nB)\twhich has an MCData group information entry in the served list of the MCData group information entries, such that the expiration time of the MCData group information entry has already expired;\nand which is indicated in a \"group\" element of the <affiliation> element of the <status> element of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request:\nA)\tshall add a new MCData group information entry in the candidate list of the MCData group information list for the MCData group ID;\nB)\tshall set the affiliation status of the new MCData group information entry to the \"affiliating\" state;\nC)\tshall set the expiration time of the new MCData group information entry to the current time increased with the candidate expiration interval; and\nD)\tshall set the affiliating p-id of the new MCData group information entry to the value of the <p-id> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request;\nb)\tdetermine the candidate number of MCData group IDs as number of different MCData group IDs which have an MCData group information entry:\ni)\tin the candidate list of the MCData group information entries; or\nii)\tin the list of the MCData group information entries of an MCData client information entry such that:\nA)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry; and\nB)\tthe MCData client ID of the MCData client information entry is not equal to the served MCData client ID;\nwith the affiliation status set to the \"affiliating\" state or the \"affiliated\" state and with the expiration time which has not expired yet; and\nc)\tif the candidate number of MCData group IDs is bigger than N2 value of the served MCData ID, shall based on MCData service provider policy reduce the candidate MCData group IDs to that equal to N2;\nNOTE:\tThe MCData service provider policy can determine to remove an MCData group ID based on the order it appeared in the PUBLISH request or based on the importance or priority of the MCData group or some other policy to determine which MCData groups are preferred.\n15)\tif the candidate expiration interval is zero, constructs the candidate list of the MCData group information entries as follows:\na)\tfor each MCData group ID which has an entry in the served list of the MCData group information entries:\ni)\tshall copy the MCData group entry of the served list of the MCData group information into a new MCData group information entry of the candidate list of the MCData group information entries;\nii)\tshall set the affiliation status of the new MCData group information entry to the \"de-affiliating\" state; and\niii)\tshall set the expiration time of the new MCData group information entry to the current time increased with twice the value of timer F;\n16)\tshall replace the list of the MCData group information entries stored in the served MCData client information entry with the candidate list of the MCData group information entries;\n17)\tshall perform the procedures specified in clause 8.3.2.6 for the served MCData ID and each MCData group ID:\na)\twhich does not have an MCData group information entry in the served list of the MCData group information entries and which has an MCData group information entry in the candidate list of the MCData group information entries with the affiliation status set to the \"affiliating\" state;\nb)\twhich has an MCData group information entry in the served list of the MCData group information entries with the expiration time already expired, and which has an MCData group information entry in the candidate list of the MCData group information entries with the affiliation status set to the \"affiliating\" state;\nc)\twhich has an MCData group information entry in the served list of the MCData group information entries with the affiliation status set to the \"deaffiliating\" state or the \"deaffiliated\" state and with the expiration time not expired yet, and which has an MCData group information entry in the candidate list of the MCData group information entries with the affiliation status set to the \"affiliating\" state; or\nd)\twhich has an MCData group information entry in the served list of the MCData group information entries with the affiliation status set to the \"affiliated\" state and with the expiration time not expired yet, and which has an MCData group information entry in the candidate list of the MCData group information entries with the affiliation status set to the \"de-affiliating\" state;\n18)\tshall identify the handled p-id in the <p-id> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request; and\n19)\tshall perform the procedures specified in clause 8.3.2.5 for the served MCData ID.\nUpon receiving a SIP SUBSCRIBE request such that:\n1)\tRequest-URI of the SIP SUBSCRIBE request contains either the public service identity identifying the originating participating MCData function serving the MCData user, or the public service identity identifying the terminating participating MCData function serving the MCData user;\n2)\tthe SIP SUBSCRIBE request contains an application/vnd.3gpp.mcdata-info+xml MIME body containing the<mcdata-request-uri> element which identifies an MCData ID served by the MCData server;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7]; and\n4)\tthe Event header field of the SIP SUBSCRIBE request contains the \"presence\" event type;\nthe MCData server:\n1)\tshall identify the served MCData ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\n2)\tif the Request-URI of the SIP SUBSCRIBE request contains the public service identity identifying the originating participating MCData function serving the MCData user, shall identify the originating MCData ID from public user identity in the P-Asserted-Identity header field of the SIP SUBSCRIBE request;\n3)\tif the Request-URI of the SIP SUBSCRIBE request contains the public service identity identifying the terminating participating MCData function serving the MCData user, shall identify the originating MCData ID in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\n4)\tif the originating MCData ID is different than the served MCData ID and the originating MCData ID is not authorized to modify affiliation status of the served MCData ID, shall send a 403 (Forbidden) response and shall not continue with the rest of the steps; and\n5)\tshall generate a 200 (OK) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 6665 [36].\nFor the duration of the subscription, the MCData server shall notify the subscriber about changes of the information of the served MCData ID, as described in clause 8.3.2.5.\nIn order to notify the subscriber about changes of the served MCData ID, the MCData server:\n1)\tshall consider an MCData user information entry such that:\na)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2; and\nb)\tthe MCData ID of the MCData user information entry is equal to the served MCData ID;\nas the served MCData user information entry;\n2)\tshall consider the list of the MCData client information entries of the served MCData user information entry as the served list of the MCData client information entries;\n3)\tshall generate an application/pidf+xml MIME body indicating per-user affiliation information according to clause 8.4.1 and the served list of the MCData client information entries with the following clarifications:\na)\tthe MCData server shall not include information from an MCData group information entry with the expiration time already expired;\nb)\tthe MCData server shall not include information from an MCData group information entry with the affiliation status set to the \"deaffiliated\" state;\nc)\tif the SIP SUBSCRIBE request creating the subscription of this notification contains an application/simple-filter+xml MIME body indicating per-client restrictions of presence event package notification information according to clause 8.4.2, the MCData server shall restrict the application/pidf+xml MIME body according to the application/simple-filter+xml MIME body; and\nd)\tif this procedures is invoked by procedure in clause 8.3.2.3 where the handled p-id value was identified, the MCData server shall set the <p-id> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP NOTIFY request to the handled p-id value; and\n4)\tsend a SIP NOTIFY request according to 3GPP TS 24.229 [5], and IETF RFC 6665 [36] for the subscription created in clause 8.3.2.4. In the SIP NOTIFY request, the MCData server shall include the generated application/pidf+xml MIME body indicating per-user affiliation information.\nNOTE 1:\tUsage of one SIP PUBLISH request to carry information about change of affiliation state of several MCData users served by the same MCData server is not supported in this version of the specification.\nIn order:\n-\tto send an affiliation request of a served MCData ID to a handled MCData group ID;\n-\tto send an de-affiliation request of a served MCData ID from a handled MCData group ID; or\n-\tto send an affiliation request of a served MCData ID to a handled MCData group ID due to near expiration of the previously published information;\nthe MCData server shall generate a SIP PUBLISH request according to 3GPP TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39]. In the SIP PUBLISH request, the MCData server:\n1)\tshall set the Request-URI to the public service identity of the controlling MCData function associated with the handled MCData group ID;\nNOTE 2:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 5:\tHow the MCData server determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 6:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData server:\na)\tshall include the <mcdata-request-uri> element set to the handled MCData group ID; and\nb)\tshall include the <mcdata-calling-user-id> element set to the served MCData ID;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tif sending an affiliation request, shall set the Expires header field according to IETF RFC 3903 [34], to 4294967295;\nNOTE 7:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n5)\tif sending an de-affiliation request, shall set the Expires header field according to IETF RFC 3903 [34], to zero;\n6)\tshall include an P-Asserted-Identity header field set to the public service identity of the MCData server according to 3GPP TS 24.229 [5];\n7)\tshall set the current p-id to a globally unique value;\n8)\tshall consider an MCData user information entry such that:\na)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2; and\nb)\tthe MCData ID of the MCData user information entry is equal to the served MCData ID;\nas the served MCData user information entry;\n9)\tfor each MCData group information entry such that:\na)\tthe MCData group information entry has the \"affiliating\" affiliation status, the MCData group ID set to the handled MCData group ID, the expiration time has not expired yet and the affiliating p-id is not set;\nb)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry; and\nc)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry;\nshall set the affiliating p-id of the MCData group information entry to the current p-id; and\n10)\tshall include an application/pidf+xml MIME body indicating per-group affiliation information constructed according to clause 8.4.1. The MCData server shall indicate all served MCData client IDs, such that:\na)\tthe affiliation status is set to \"affiliating\" or \"affiliated\", and the expiration time has not expired yet in an MCData group information entry with the MCData group ID set to the handled MCData group;\nb)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry;\nc)\tthe MCData client information entry has the MCData client ID set to the served MCData client ID; and\nd)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry.\nThe MCData server shall set the <p-id> child element of the <presence> root element to the current p-id.\nThe MCData server shall not include the \"expires\" attribute in the <affiliation> element.\nThe MCData server shall send the SIP PUBLISH request according to 3GPP TS 24.229 [5].\nIf timer F expires for the SIP PUBLISH request sent for a (de)affiliation request of served MCData ID to the MCData group ID or upon receiving a SIP 3xx, 4xx, 5xx or 6xx response to the SIP PUBLISH request, the MCData server:\n1)\tshall remove each MCData group ID entry such that:\na)\tthe MCData group information entry has the MCData group ID set to the handled MCData group ID;\nb)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry; and\nc)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry.\nNOTE 1:\tUsage of one SIP SUBSCRIBE request to subscribe for notification about change of affiliation state of several MCData users served by the same MCData server is not supported in this version of the specification.\nIn order to discover whether a served MCData user was successfully affiliated to a handled MCData group in the MCData server owning the handled MCData group, the MCData server shall generate an initial SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36].\nIn the SIP SUBSCRIBE request, the MCData server:\n1)\tshall set the Request-URI to the public service identity of the controlling MCData function associated with the handled MCData group ID;\nNOTE 2:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 5:\tHow the MCData server determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 6:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData server:\na)\tshall include the <mcdata-request-uri> element set to the handled MCData group ID; and\nb)\tshall include the <mcdata-calling-user-id> element set to the served MCData ID;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tif the MCData server wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [36], to 4294967295;\nNOTE 7:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n5)\tif the MCData server wants to fetch the current state only, shall set the Expires header field according to IETF RFC 6665 [36], to zero;\n6)\tshall include an Accept header field containing the application/pidf+xml MIME type; and\n7)\tshall include an application/simple-filter+xml MIME body indicating per-user restrictions of presence event package notification information according to clause 8.4.2, indicating the served MCData ID.\nIn order to re-subscribe or de-subscribe, the MCData server shall generate an in-dialog SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36]. In the SIP SUBSCRIBE request, the MCData server:\n1)\tif the MCData server wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [36], to 4294967295;\nNOTE 8:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n2)\tif the MCData server wants to de-subscribe, shall set the Expires header field according to IETF RFC 6665 [36], to zero; and\n3)\tshall include an Accept header field containing the application/pidf+xml MIME type.\nUpon receiving a SIP NOTIFY request according to 3GPP TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36], if SIP NOTIFY request contains an application/pidf+xml MIME body indicating per-group affiliation information constructed according to clause 8.4.1, then the MCData server:\n1)\tfor each served MCData ID and served MCData client ID such that the application/pidf+xml MIME body of SIP NOTIFY request contains:\na)\ta <tuple> element of the root <presence> element;\nb)\tthe \"id\" attribute of the <tuple> element indicating the served MCData ID;\nc)\tan <affiliation> child element of the <status> element of the <tuple> element;\nd)\tthe \"client\" attribute of the <affiliation> element indicating the served MCData client ID; and\nd)\tthe \"expires\" attribute of the <affiliation> element indicating expiration of affiliation;\nperform the following:\na)\tif an MCData group information entry exists such that:\ni)\tthe MCData group information entry has the \"affiliating\" affiliation status, the MCData group ID set to the handled MCData group ID, and the expiration time has not expired yet;\nii)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry with the MCData client ID set to the served MCData client ID;\niii)\tthe MCData client information entry is in the list of the MCData client information entries of a served MCData user information entry with the MCData ID set to the served MCData ID; and\niv)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2; and\nshall set the affiliation status of the MCData group information entry to \"affiliated\"; and\nshall set the next publishing time of the MCData group information entry to the current time and half of the time between the current time and the expiration of affiliation; and\n2) for each MCData group information entry such that:\na)\tthe MCData group information entry has the \"affiliated\" affiliation status or the \"deaffiliating\" affiliation status, the MCData group ID set to the handled MCData group ID, and the expiration time has not expired yet;\nb)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry with the MCData client ID set to a served MCData client ID;\nc)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry with the MCData ID set to a served MCData ID; and\nd)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2; and\nfor which the application/pidf+xml MIME body of SIP NOTIFY request does not contain:\na)\ta <tuple> element of the root <presence> element;\nb)\tthe \"id\" attribute of the <tuple> element indicating the served MCData ID;\nc)\tan <affiliation> child element of the <status> child element of the <tuple> element; and\nd)\tthe \"client\" attribute of the <affiliation> element indicating the served MCData client ID.\nperform the following:\na)\tshall set the affiliation status of the MCData group information entry to \"deaffiliated\"; and\nb)\tshall set the expiration time of the MCData group information entry to the current time; and\n3)\tif a <p-id> element is included in the <presence> root element of the application/pidf+xml MIME body of the SIP NOTIFY request, then for each MCData group information entry such that:\na)\tthe MCData group information entry has the \"affiliating\" affiliation status, the MCData group ID set to the handled MCData group ID, the expiration time has not expired yet and with the affiliating p-id set to the value of the <p-id> element;\nb)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry with the MCData client ID set to a served MCData client ID;\nc)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry with the MCData ID set to a served MCData ID; and\nd)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2; and\nfor which the application/pidf+xml MIME body of SIP NOTIFY request does not contain:\na)\ta <tuple> element of the root <presence> element;\nb)\tthe \"id\" attribute of the <tuple> element indicating the served MCData ID;\nc)\tan <affiliation> child element of the <status> child element of the <tuple> element; and\nd)\tthe \"client\" attribute of the <affiliation> element indicating the served MCData client ID;\nperform the following:\na)\tshall set the affiliation status of the MCData group information entry to \"deaffiliated\"; and\nb)\tshall set the expiration time of the MCData group information entry to the current time.\nUpon receiving a SIP MESSAGE request such that:\n1)\tRequest-URI of the SIP MESSAGE request contains the public service identity identifying the terminating participating MCData function serving the MCData user;\n2)\tthe SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body containing the<mcdata-request-uri> element and the <mcdata-calling-user-id> element;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7]; and\n4)\tthe SIP MESSAGE request contains an application/vnd.3gpp.mcdata-affiliation-command+xml MIME body;\nthen the MCData server:\n1)\tshall identify the served MCData ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request;\n2)\tshall identify the originating MCData ID in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request;\n3)\tif the originating MCData ID is not authorized to send an affiliation status change request in negotiated mode to the served MCData ID, shall send a 403 (Forbidden) response and shall not continue with the rest of the steps;\n4)\tshall set the Request-URI of the SIP MESSAGE request to the public user identity bound to the served MCData ID in the MCData server; and\n5)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\nbefore forwarding the SIP MESSAGE request further.\nUpon receiving a SIP PUBLISH request such that:\n1)\tRequest-URI of the SIP PUBLISH request contains the public service identity identifying the originating participating MCData function serving the MCData user;\n2)\tthe SIP PUBLISH request contains an application/vnd.3gpp.mcdata-info MIME body containing the<mcdata-request-uri> element which identifies an MCData ID not served by the MCData server;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tthe Event header field of the SIP PUBLISH request contains the \"presence\" event type; and\n5)\tSIP PUBLISH request contains an application/pidf+xml MIME body indicating per-user affiliation information according to clause 8.4.1;\nthen the MCData server:\n1)\tshall identify the target MCData ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info MIME body of the SIP PUBLISH request;\n2)\tshall identify the originating MCData ID from public user identity in the P-Asserted-Identity header field of the SIP PUBLISH request;\n3)\tshall generate a SIP PUBLISH request from the received SIP PUBLISH request. In the generated SIP PUBLISH request, the MCData server:\na)\tshall set the Request-URI to the public service identity identifying the terminating participating MCData function serving the target MCData ID;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the MCData server determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\nb)\tshall include a P-Asserted-Identity header field containing the public service identity identifying the originating participating MCData function serving the MCData user;\nc)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData server:\nA)\tshall include the <mcdata-request-uri> element set to the target MCData ID; and\nB)\tshall include the <mcdata-calling-user-id> element set to the originating MCData ID; and\nd)\tshall include other signalling elements from the received SIP PUBLISH request; and\n4)\tshall send the generated SIP PUBLISH request according to 3GPP TS 24.229 [5].\nThe MCData server shall forward received SIP responses to the SIP PUBLISH request.\nUpon receiving a SIP SUBSCRIBE request such that:\n1)\tRequest-URI of the SIP SUBSCRIBE request contains the public service identity identifying the originating participating MCData function serving the MCData user;\n2)\tthe SIP SUBCRIBE request contains an application/vnd.3gpp.mcdata-info MIME body containing the<mcdata-request-uri> element which identifies an MCData ID not served by MCData server;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7]; and\n4)\tthe Event header field of the SIP SUBSCRIBE request contains the \"presence\" event type;\nthen the MCData server:\n1)\tshall identify the target MCData ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info MIME body of the SIP SUBSCRIBE request;\n2)\tshall identify the originating MCData ID from public user identity in the P-Asserted-Identity header field of the SIP SUBSCRIBE request;\n3)\tshall generate a SIP SUBSCRIBE request from the received SIP SUBSCRIBE request. In the generated SIP SUBSCRIBE request, the MCData server:\na)\tshall set the Request-URI to the public service identity identifying the terminating participating MCData function serving the target MCData ID;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the MCData server determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\nb)\tshall include a P-Asserted-Identity header field containing the public service identity identifying the originating participating MCData function serving the MCData user;\nc)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData server:\nA)\tshall include the <mcdata-request-uri> element set to the target MCData ID; and\nB)\tshall include the <mcdata-calling-user-id> element set to the originating MCData ID; and\nd)\tshall include other signalling elements from the received SIP SUBSCRIBE request; and\n4)\tshall send the generated SIP SUBSCRIBE request according to 3GPP TS 24.229 [5].\nThe MCData server shall forward any received SIP responses to the SIP SUBSCRIBE request, any received SIP NOTIFY request and any received SIP responses to the SIP NOTIFY request.\nThis clause is referenced from other procedures.\nIf the participating MCData function needs to determine the affiliation status of an MCData user to an MCData group, the participating function:\n1)\tshall find the user information entry in the list of MCData user information entries described in clause 8.3.2.2 such that the MCData ID of the MCData user information entry is equal to the MCData ID of the originator of the received SIP request;\na)\tif the applicable MCData group information entry cannot be found, then the participating MCData function shall determine that the MCData user is not affiliated to the MCData group at the MCData client and the skip the rest of the steps;\n2)\tshall find the MCData client information entry in the list of MCData client information entries of MCData user information entry found in step 1) in which the MCData client id matches the value of the <mcdata-client-id> element contained in the application/vnd.3gpp.mcdata-info+xml MIME body in the received SIP request;\na)\tif the applicable MCData client information entry cannot be found, then the participating MCData function shall determine that the MCData user is not affiliated to the MCData group at the MCData client and the skip the rest of the steps;\n3)\tshall find the MCData group information entry in the list of MCData group information entries of MCData client information entry found in step 2 such that the MCData group identity matches the value of the identity of the targeted MCData group;\na)\tif the applicable MCData group information entry was found in step 3) and the affiliation status of the MCData group information entry is \"affiliating\" or \"affiliated\", shall determine that the MCData user at the MCData client to be affiliated to the targeted MCData group and skip the rest of the steps;\nb)\tif the applicable MCData group information entry was found in step 3) and the affiliation status of the MCData group information entry is \"deaffiliating\" or \"deaffiliated\", shall determine that the MCData user at the MCData client to not be affiliated to the targeted MCData group and skip the rest of the steps; or\nc)\tif the applicable MCData group information entry was not found in step 3), shall determine that the MCData user at the MCData client is not affiliated to the targeted MCData group.\nThis clause is referenced from other procedures.\nUpon receiving a SIP request that requires implicit affiliation of the sending MCData client to an MCData group, the participating MCData function:\n1)\tshall determine the served MCData client ID from the <mcdata-client-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the received SIP request;\n2)\tshall determine the MCData group ID from the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the received SIP request;\n3)\tshall determine the served MCData ID by using the public user identity in the P-Asserted-Identity header field of the SIP request;\nNOTE 1:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n4)\tshall consider an MCData user information entry such that:\na)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2; and\nb)\tthe MCData ID of the MCData user information entry is equal to the served MCData ID;\nas the served MCData user information entry;\n5)\tshall consider an MCData client information entry such that:\na)\tthe MCData client information entry is in the list of MCData client information entries of the served MCData user information entry; and\nb)\tthe MCData client ID of the MCData client information entry is equal to the served MCData client ID;\nas the served MCData client information entry;\n6)\tshall consider a copy of the list of the MCData group information entries of the served MCData client information entry as the served list of the MCData group information entries;\n7)\tshall construct the candidate list of the MCData group information entries as follows:\na)\tfor each MCData group ID which has an MCData group information entry in the served list of the MCData group information entries shall copy the MCData group information entry into a new MCData group information entry of the candidate list of the MCData group information entries; and\nb)\tif the determined MCData group ID does not have an MCData group information entry in the served list of the MCData group information entries or has an MCData group information entry in the served list of the MCData group information entries, such that the expiration time of the MCData group information entry has already expired:\ni)\tshall add a new MCData group information entry in the candidate list of the MCData group information list for the determined MCData group ID;\nii)\tshall set the affiliation status of the new MCData group information entry to the \"affiliating\" state; and\niii)\tshall set the expiration time of the new MCData group information entry to the current time increased with the candidate expiration interval;\n8)\tdetermine the candidate number of MCData group IDs as the number of different MCData group IDs which have an MCData group information entry:\na)\tin the candidate list of the MCData group information entries; or\nb)\tin the list of the MCData group information entries of an MCData client information entry such that:\ni)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry; and\nii)\tthe MCData client ID of the MCData client information entry is not equal to the served MCData client ID;\nwith the affiliation status set to the \"affiliating\" state or the \"affiliated\" state and with the expiration time which has not expired yet; and\n9)\tif the candidate number of MCData group IDs is bigger than the N2 value of the served MCData ID, shall based on MCData service provider policy reduce the candidate MCData group IDs to that equal to N2;\n10)\tif the determined MCData group ID cannot be added to the the candidate list of the MCData group information entries due to exceeding the MCData user's N2 limit, shall discard the candidate list of the MCData group information entries and skip the remaining steps of the current procedure; and\n11)\tshall replace the list of the MCData group information entries stored in the served MCData client information entry with the candidate list of the MCData group information entries.\nThis clause is referenced from other procedures.\nIf the participating MCData function has received a SIP 2xx response from the controlling MCData function to a SIP request that had triggered performing the procedures of clause 8.3.2.12, the participating MCData function:\n1)\tshall set the affiliation status of the MCData group information entry added to the candidate list of the MCData group information entries by the procedures of clause 8.3.2.12 to \"affiliated\"; and\n2)\tshall perform the procedures specified in clause 8.3.2.5 for the served MCData ID.\nThis clause is referenced from other procedures.\nIf the participating MCData function determines that a received SIP request that had triggered performing the procedures of clause 8.3.2.12 needs to be rejected or if the participating MCData function receives a SIP 4xx, 5xx or 6xx response from the controlling MCData function for the received SIP request, the participating MCData function:\n1)\tshall remove the MCData group ID entry added by the procedures of clause 8.3.2.12 such that:\na)\tthe MCData group information entry has the MCData group ID set to the MCData group ID of the MCData group targeted by the received SIP request;\nb)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry containing the MCData client ID included in the received SIP request; and\nc)\tthe MCData client information entry is in the list of the MCData client information entries of the MCData user information entry containing the MCData ID of the sender of the received SIP request.\nThis clause is referenced from other procedures.\nIf the participating MCData function has successfully performed service authorization for the MCData ID identified in the service authorisation procedure as described in 3GPP TS 33.180 [26], the participating MCData function:\n1)\tshall identify the MCData ID included in the SIP request received for service authorisation procedure as the served MCData ID;\n2)\tshall identify the MCData client ID from the <mcdata-client-id> element contained in the application/vnd.3gpp.mcdata-info+xml MIME body included in the SIP request received for service authorisation as the served MCData client ID;\n3)\tshall download the MCData user profile from the MCData user database as defined in 3GPP TS 29.283 [37] if not already stored at the participating MCData function;\n4)\tif no <ImplicitAffiliations> element is contained in the <OnNetwork> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) for the served MCData ID or the <ImplicitAffiliations> element contains no <entry> elements containing an MCData group ID, shall skip the remaining steps;\n5)\tshall consider an MCData user information entry such that:\na)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2; and\nb)\tthe MCData ID of the MCData user information entry is equal to the served MCData ID;\nas the served MCData user information entry;\n6)\tshall consider an MCData client information entry such that:\na)\tthe MCData client information entry is in the list of MCData client information entries of the served MCData user information entry; and\nb)\tthe MCData client ID of the MCData client information entry is equal to the served MCData client ID;\nas the served MCData client information entry;\n7)\tshall consider a copy of the list of the MCData group information entries of the served MCData client information entry as the served list of the MCData group information entries;\n8)\tshall construct the candidate list of the MCData group information entries as follows:\na)\tfor each MCData group ID which has an MCData group information entry in the served list of the MCData group information entries shall copy the MCData group information entry into a new MCData group information entry of the candidate list of the MCData group information entries;\nb)\tfor each MCData group ID contained in an <entry> element of the <ImplicitAffiliations> element in the <OnNetwork> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) for the served MCData ID that does not have an MCData group information entry in the served list of the MCData group information entries or has an MCData group information entry in the served list of the MCData group information entries such that the expiration time of the MCData group information entry has already expired:\ni)\tshall add a new MCData group information entry in the candidate list of the MCData group information list for the MCData group ID;\nii)\tshall set the affiliation status of the new MCData group information entry to the \"affiliating\" state; and\niii)\tshall set the expiration time of the new MCData group information entry to the current time increased with the candidate expiration interval;\nc)\tif in step b) above, no new MCData group information entries were added to the candidate list of the MCData group information list for the MCData group ID:\ni)\tshall discard the candidate list; and\nii)\tshall skip the remaining steps;\n9)\tdetermine the candidate number of MCData group IDs as the number of different MCData group IDs which have an MCData group information entry:\na)\tin the candidate list of the MCData group information entries; or\nb)\tin the list of the MCData group information entries of an MCData client information entry such that:\ni)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry; and\nii)\tthe MCData client ID of the MCData client information entry is not equal to the served MCData client ID;\nwith the affiliation status set to the \"affiliating\" state or the \"affiliated\" state and with the expiration time which has not expired yet; and\nc)\tif the candidate number of MCData group IDs is bigger than the N2 value of the served MCData ID, shall based on MCData service provider policy reduce the candidate MCData group IDs to that equal to N2;\n10)\tshall replace the list of the MCData group information entries stored in the served MCData client information entry with the candidate list of the MCData group information entries; and\n11)\tfor each MCData group ID contained in an <entry> element of the <ImplicitAffiliations> element in the <OnNetwork> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) for the served MCData ID and which has an MCData group information entry in the candidate list of the MCData group information entries with an affiliation status of \"affiliating\", shall perform the procedures specified in clause 8.3.2.6 for the served MCData ID and each MCData group ID.\nNOTE 2:\tTo learn of the MCData groups successfully affiliated to, the MCData client can subscribe to that information by the procedures specified in clause 8.2.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.3.3\tProcedures of MCData server owning the MCData group",
                            "text_content": "The procedures of MCData server owning the MCData group consist of:\n-\treceiving group affiliation status change procedure;\n-\treceiving subscription to affiliation status procedure;\n-\tsending notification of change of affiliation status procedure;\n-\timplicit affiliation eligibilty check procedure; and\n-\taffiliation status change by implicit affiliation procedure.\nNOTE:\tUsage of CSC-3 part of MCData group affiliation procedure and of CSC-3 part of MCData group de-affiliation procedure is not specified in this version of the specification.\nThe MCData server shall maintain a list of MCData group information entries.\nIn each MCData group information entry, the MCData server shall maintain:\n1)\tan MCData group ID. This field uniquely identifies the MCData group information entry in the list of the MCData group information entries; and\n2)\ta list of MCData user information entries.\nIn each MCData user information entry, the MCData server shall maintain:\n1)\tan MCData ID. This field uniquely identifies the MCData user information entry in the list of the MCData user information entries;\n2)\ta list of MCData client information entries; and\n3)\tan expiration time.\nIn each MCData client information entry, the MCData server shall maintain:\n1)\tan MCData client ID. This field uniquely identifies the MCData client information entry in the list of the MCData client information entries.\nUpon receiving a SIP PUBLISH request such that:\n1)\tRequest-URI of the SIP PUBLISH request contains the public service identity of the controlling MCData function associated with the served MCData group;\n2)\tthe SIP PUBLISH request contains an application/vnd.3gpp.mcdata-info+xml MIME body containing the <mcdata-request-uri> element and the <mcdata-calling-user-id> element;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tthe Event header field of the SIP PUBLISH request contains the \"presence\" event type; and\n5)\tSIP PUBLISH request contains an application/pidf+xml MIME body indicating per-group affiliation information constructed according to clause 8.4.1;\nthen the MCData server:\n1)\tshall identify the served MCData group ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP PUBLISH request;\n2)\tshall identify the handled MCData ID in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP PUBLISH request;\n3)\tif the Expires header field of the SIP PUBLISH request is not included or has nonzero value lower than 4294967295, shall send a SIP 423 (Interval Too Brief) response to the SIP PUBLISH request, where the SIP 423 (Interval Too Brief) response contains a Min-Expires header field set to 4294967295, and shall not continue with the rest of the steps;\n4)\tif an MCData group for the served MCData group ID does not exist in the group management server according to 3GPP TS 24.481 [11], shall reject the SIP PUBLISH request with SIP 403 (Forbidden) response to the SIP PUBLISH request according to 3GPP TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39] and skip the rest of the steps;\n5)\tif the handled MCData ID is not a member of the MCData group identified by the served MCData group ID, shall reject the SIP PUBLISH request with SIP 403 (Forbidden) response to the SIP PUBLISH request according to 3GPP TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39] and skip the rest of the steps;\n6)\tshall respond with SIP 200 (OK) response to the SIP PUBLISH request according to 3GPP TS 24.229 [5], IETF RFC 3903 [34]. In the SIP 200 (OK) response, the MCData server:\na)\tshall set the Expires header field according to IETF RFC 3903 [34], to the selected expiration time;\n7)\tif the \"entity\" attribute of the <presence> element of the application/pidf+xml MIME body of the SIP PUBLISH request is different than the served MCData group ID, shall not continue with the rest of the steps;\n8)\tif the handled MCData ID is different from the MCData ID in the \"id\" attribute of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request, shall not continue with the rest of the steps;\n9)\tshall consider an MCData group information entry such that:\na)\tthe MCData group information entry is in the list of MCData group information entries described in clause 8.3.3.2; and\nb)\tthe MCData group ID of the MCData group information entry is equal to the served MCData group ID;\nas the served MCData group information entry;\n10)\tif the selected expiration time is zero:\na)\tshall remove the MCData user information entry such that:\ni)\tthe MCData user information entry is in the list of the MCData user information entries of the served MCData group information entry; and\nii)\tthe MCData user information entry has the MCData ID set to the served MCData ID;\n11)\tif the selected expiration time is not zero:\na)\tshall consider an MCData user information entry such that:\ni)\tthe MCData user information entry is in the list of the MCData user information entries of the served MCData group information entry; and\nii)\tthe MCData ID of the MCData user information entry is equal to the handled MCData ID;\nas the served MCData user information entry;\nb)\tif the MCData user information entry does not exist:\ni)\tshall insert an MCData user information entry with the MCData ID set to the handled MCData ID into the list of the MCData user information entries of the served MCData group information entry; and\nii)\tshall consider the inserted MCData user information entry as the served MCData user information entry; and\nc)\tshall set the following information in the served MCData user information entry:\ni)\tset the MCData client ID list according to the \"client\" attributes of the <affiliation> elements of the <status> element of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request; and\nii)\tset the expiration time according to the selected expiration time;\n12)\tshall identify the handled p-id in the <p-id> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request; and\n13)\tshall perform the procedures specified in clause 8.3.3.5 for the served MCData group ID.\nNOTE:\tUsage of one SIP SUBSCRIBE request to subscribe for notification about change of affiliation state of several MCData users served by the same MCData server is not supported in this version of the specification.\nUpon receiving a SIP SUBSCRIBE request such that:\n1)\tRequest-URI of the SIP SUBSCRIBE request contains the public service identity of the controlling MCData function associated with the served MCData group;\n2)\tthe SIP SUBSCRIBE request contains an application/vnd.3gpp.mcdata-info+xml MIME body containing the<mcdata-request-uri> element and the <mcdata-calling-user-id> element;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tthe Event header field of the SIP SUBSCRIBE request contains the \"presence\" event type; and\n5) the SIP SUBSCRIBE request contains an application/simple-filter+xml MIME body indicating per-user restrictions of presence event package notification information according to clause 8.4.2 indicating the same MCData ID as in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\nthen the MCData server:\n1)\tshall identify the served MCData group ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\n2)\tshall identify the handled MCData ID in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\n3)\tif the Expires header field of the SIP SUBSCRIBE request is not included or has nonzero value lower than 4294967295, shall send a SIP 423 (Interval Too Brief) response to the SIP SUBSCRIBE request, where the SIP 423 (Interval Too Brief) response contains a Min-Expires header field set to 4294967295, and shall not continue with the rest of the steps;\n4)\tif an MCData group for the served MCData group ID does not exist in the group management server according to 3GPP TS 24.481 [11], shall reject the SIP SUBSCRIBE request with SIP 403 (Forbidden) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39] and skip the rest of the steps;\n5)\tif the handled MCData ID is not a member of the MCData group identified by the served MCData group ID, shall reject the SIP SUBSCRIBE request with SIP 403 (Forbidden) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39] and skip the rest of the steps; and\n6)\tshall generate a SIP 200 (OK) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 6665 [36].\nFor the duration of the subscription, the MCData server shall notify subscriber about changes of the information of the served MCData ID, as described in clause 8.3.3.5.\nIn order to notify the subscriber identified by the handled MCData ID about changes of the affiliation status of the served MCData group ID, the MCData server:\n1)\tshall consider an MCData group information entry such that:\na)\tthe MCData group information entry is in the list of MCData group information entries described in clause 8.3.3.2; and\nb)\tthe MCData group ID of the MCData group information entry is equal to the served MCData group ID;\n2)\tshall consider an MCData user information entry such:\na)\tthe MCData user information entry is in the list of the MCData user information entries of the served MCData group information entry; and\nb)\tthe MCData ID of the MCData user information entry is equal to the handled MCData ID;\nas the served MCData user information entry;\n3)\tshall generate an application/pidf+xml MIME body indicating per-group affiliation information according to clause 8.4.1 and the served list of the served MCData user information entry of the MCData group information entry with following clarifications:\na)\tthe MCData server shall include the \"expires\" attribute in the <affiliation> element; and\nb)\tif this procedures is invoked by procedure in clause 8.3.3.3 where the handled p-id was identified, the MCData server shall set the <p-id> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP NOTIFY request to the handled p-id value; and\n4)\tsend a SIP NOTIFY request according to 3GPP TS 24.229 [5], and IETF RFC 6665 [36] for the subscription created in clause 8.3.3.4. In the SIP NOTIFY request, the MCData server shall include the generated application/pidf+xml MIME body indicating per-group affiliation information.\nThis clause is referenced from other procedures.\nUpon receiving a SIP request for an MCData group that the MCData user is not currently affiliated to and that requires the controlling MCData function to check on the eligibility of the MCData user to be implicitly affiliated to the MCData group, the controlling MCData function:\n1)\tshall identify the served MCData group ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP request;\n2)\tshall identify the handled MCData ID in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP request;\n3)\tif an MCData group for the served MCData group ID does not exist in the group management server according to 3GPP TS 24.481 [11], shall consider the MCData user to be ineligible for implicit affiliation and skip the rest of the steps;\n4)\tif the handled MCData ID is not a member of the MCData group identified by the served MCData group ID, shall consider the MCData user to be ineligible for implicit affiliation and skip the rest of the steps;\n5)\tif there is no MCData group information entry in the list of MCData group information entries described in clause 8.3.3.2 with an MCData group identity matching the served MCData group ID, then shall consider the MCData user to be ineligible for implicit affiliation and skip the rest of the steps; or\n6)\tshall consider the MCData user to be eligible for implicit affiliation.\nThis clause is referenced from other procedures.\nUpon receiving a SIP request for an MCData group that the MCData user is not currently affiliated to and that requires the controlling MCData function to perform an implicit affiliation to, the controlling MCData function:\n1)\tshall identify the served MCData group ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP request;\n2)\tshall identify the handled MCData ID in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP request;\n3)\tshall consider an MCData group information entry such that:\na)\tthe MCData group information entry is in the list of MCData group information entries described in clause 8.3.3.2; and\nb)\tthe MCData group ID of the MCData group information entry is equal to the served MCData group ID;\nas the served MCData group information entry;\n4)\tshall consider an MCData user information entry such that:\na)\tthe MCData user information entry is in the list of the MCData user information entries of the served MCData group information entry; and\nb)\tthe MCData ID of the MCData user information entry is equal to the handled MCData ID;\nas the served MCData user information entry;\nc)\tif the MCData user information entry does not exist:\ni)\tshall insert an MCData user information entry with the MCData ID set to the handled MCData ID into the list of the MCData user information entries of the served MCData group information entry; and\nii)\tshall consider the inserted MCData user information entry as the served MCData user information entry; and\nd)\tshall make the following modifications in the served MCData user information entry:\ni)\tadd the MCData client ID derived from the received SIP request to the MCData client ID list if not already present; and\nii)\tset the expiration time as determined by local policy;\n5)\tshall perform the procedures specified in clause 8.3.3.5 for the served MCData group ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "8.4\tCoding",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.4.1\tExtension of application/pidf+xml MIME type",
                            "text_content": "The clauses of the parent clause describe an extension of the application/pidf+xml MIME body specified in IETF RFC 3863 [40]. The extension is used to indicate:\n-\tper-user affiliation information; and\n-\tper-group affiliation information.\nThe application/pidf+xml MIME body indicating per-user affiliation information is constructed according to IETF RFC 3863 [40] and:\n1)\tcontains a <presence> root element according to IETF RFC 3863 [40];\n2)\tcontains an \"entity\" attribute of the <presence> element set to the MCData ID of the MCData user;\n3)\tcontains one <tuple> child element according to IETF RFC 3863 [40] per each MCData client of the <presence> element;\n4)\tcan contain a <p-id> child element defined in the XML schema defined in table 8.4.1.2-1, of the <presence> element set to an identifier of a SIP PUBLISH request;\n5)\tcontains an \"id\" attribute of the <tuple> element set to the MCData client ID;\n6)\tcontains one <status> child element of each <tuple> element;\n7)\tcontains one <affiliation> child element defined in the XML schema defined in table 8.4.1.2-1, of the <status> element, for each MCData group in which the MCData user is interested at the MCData client;\n8)\tcontains a \"group\" attribute of each <affiliation> element set to the MCData group ID of the MCData group in which the MCData user is interested at the MCData client;\n9)\tcan contain a \"status\" attribute of each <affiliation> element indicating the affiliation status of the MCData user to MCData group at the MCData client; and\n10)\tcan contain an \"expires\" attribute of each <affiliation> element indicating expiration of affiliation of the MCData user to MCData group at the MCData client.\nThe application/pidf+xml MIME body indicating per-group affiliation information is constructed according to IETF RFC 3856 [39] and:\n1)\tcontains the <presence> root element according to IETF RFC 3863 [40];\n2)\tcontains an \"entity\" attribute of the <presence> element set to the MCData group ID of the MCData group;\n3)\tcontains one <tuple> child element according to IETF RFC 3863 [40] of the <presence> element;\n4)\tcan contain a <p-id> child element defined in the XML schema defined in table 8.4.1.2-1, of the <presence> element set to an identifier of a SIP PUBLISH request;\n5)\tcontains an \"id\" attribute of the <tuple> element set to the MCData ID of the MCData user;\n6)\tcontains one <status> child element of each <tuple> element;\n7)\tcontains one <affiliation> child element defined in the XML schema defined in table 8.4.1.2-1, of the <status> element, for each MCData client at which the MCData user is interested in the MCData group;\n8)\tcontains one \"client\" attribute defined in the XML schema defined in table 8.4.1.2-2, of the <affiliation> element set to the MCData client ID;\n9)\tcan contain an \"expires\" attribute defined in the XML schema defined in table 8.4.1.2-2, of the <affiliation> element indicating expiration of affiliation of the MCData user to MCData group at the MCData client. and\n10)\tcan contain one <functionalAlias> child element defined in the XML schema defined in table 8.4.1.2-1, of the <status> element, for each functional alias that the group member identified by the \"id\" attribute of the <tuple> element has activated with the \"functionalAliasID\" attribute set to the corresponding functional alias ID.\nTable 8.4.1.2-1: XML schema with elements and attributes extending the application/pidf+xml MIME body\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema\ntargetNamespace=\"urn:3gpp:ns:mcdataPresInfo:1.0\"\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:mcdataPI10=\"urn:3gpp:ns:mcdataPresInfo:1.0\"\nelementFormDefault=\"qualified\" attributeFormDefault=\"unqualified\">\n\n<!-- MCData specific child elements of tuple element -->\n<xs:element name=\"affiliation\" type=\"mcdataPI10:affiliationType\"/>\n<xs:complexType name=\"affiliationType\">\n<xs:sequence>\n<xs:any namespace=\"##any\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"group\" type=\"xs:anyURI\" use=\"optional\"/>\n<xs:attribute name=\"client\" type=\"xs:anyURI\" use=\"optional\"/>\n<xs:attribute name=\"status\" type=\"mcdataPI10:statusType\" use=\"optional\"/>\n<xs:attribute name=\"expires\" type=\"xs:dateTime\" use=\"optional\"/>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:simpleType name=\"statusType\">\n<xs:restriction base=\"xs:string\">\n<xs:enumeration value=\"affiliating\"/>\n<xs:enumeration value=\"affiliated\"/>\n<xs:enumeration value=\"deaffiliating\"/>\n</xs:restriction>\n</xs:simpleType>\n\n<xs:element name=\"p-id\" type=\"xs:string\"/>\n\n<!-- MCData specific child elements of status element -->\n<xs:element name=\"functionalAlias\" type=\"mcdataPI10:functionalAliasType\"/>\n<xs:complexType name=\"functionalAliasType\">\n<xs:sequence>\n<xs:any namespace=\"##any\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"functionalAliasID\" type=\"xs:anyURI\" use=\"optional\"/>\n<xs:attribute name=\"expires\" type=\"xs:dateTime\" use=\"optional\"/>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n\n</xs:schema>\nThe application/pidf+xml MIME body refers to namespaces using prefixes specified in table 8.4.1.2-2.\nTable 8.4.1.2-2: Assignment of prefixes to namespace names in the application/pidf+xml MIME body\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.4.1.2-2: Assignment of prefixes to namespace names in the application/pidf+xml MIME body",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.2\tExtension of application/simple-filter+xml MIME type",
                            "text_content": "The clauses of the parent clause describe an extension of the application/simple-filter+xml MIME body specified in IETF RFC 4661 [41].\nThe extension is used to indicate per-client restrictions of presence event package notification information and per-user restrictions of presence event package notification information.\nThe application/simple-filter+xml MIME body indicating per-client restrictions of presence event package notification information is constructed according to IETF RFC 4661 [41] and:\n1)\tcontains a <filter-set> root element according to IETF RFC 4661 [41];\n2)\tcontains a <ns-bindings> child element according to IETF RFC 4661 [41], of the <filter-set> element;\n3)\tcontains a <ns-binding> child element according to IETF RFC 4661 [41], of the <ns-bindings> element where the <ns-binding> element:\nA)\tcontains a \"prefix\" attribute according to IETF RFC 4661 [41] set to \"pidf\"; and\nB) contains a \"urn\" attribute set to the \"urn:ietf:params:xml:ns:pidf\" value;\n4)\tcontains a <ns-binding> child element according to IETF RFC 4661 [41], of the <ns-bindings> element where the <ns-binding> element:\nA)\tcontains a \"prefix\" attribute according to IETF RFC 4661 [41], set to \"mcdataPI10\"; and\nB)\tcontains an \"urn\" attribute according to IETF RFC 4661 [41], set to the \"urn:3gpp:ns:mcdataPresInfo:1.0\" value;\n5)\tcontains a <filter> child element according to IETF RFC 4661 [41], of the <filter-set> element where the <filter> element;\nA)\tcontains an \"id\" attribute set to a value constructed according to IETF RFC 4661 [41];\nB)\tdoes not contain an \"uri\" attribute of the <filter> child element according to IETF RFC 4661 [41]; and\nC)\tdoes not contain an \"domain\" attribute according to IETF RFC 4661 [41];\n6)\tcontains a <what> child element according to IETF RFC 4661 [41], of the <filter> element; and\n7)\tcontains an <include> child element according to IETF RFC 4661 [41], of the <what> element where the <include> element;\nA)\tdoes not contain a \"type\" attribute according to IETF RFC 4661 [41]; and\nB)\tcontains the value, according to IETF RFC 4661 [41], set to concatenation of the '//pidf:presence/pidf:tuple[@id=\"' string, the MCData client ID, and the '\"]' string.\nThe application/simple-filter+xml MIME body indicating per-user restrictions of presence event package notification information is constructed according to IETF RFC 4661 [41] and:\n1)\tcontains a <filter-set> root element according to IETF RFC 4661 [41];\n2)\tcontains a <ns-bindings> child element according to IETF RFC 4661 [41], of the <filter-set> element;\n3)\tcontains a <ns-binding> child element according to IETF RFC 4661 [41], of the <ns-bindings> element where the <ns-binding> element:\nA)\tcontains a \"prefix\" attribute according to IETF RFC 4661 [41] set to \"pidf\"; and\nB) contains a \"urn\" attribute set to the \"urn:ietf:params:xml:ns:pidf\" value;\n4)\tcontains a <ns-binding> child element according to IETF RFC 4661 [41], of the <ns-bindings> element where the <ns-binding> element:\nA)\tcontains a \"prefix\" attribute according to IETF RFC 4661 [41], set to \"mcdataPI10\"; and\nB)\tcontains an \"urn\" attribute according to IETF RFC 4661 [41], set to the \"urn:3gpp:ns:mcdataPresInfo:1.0\" value;\n5)\tcontains a <filter> child element according to IETF RFC 4661 [41], of the <filter-set> element where the <filter> element;\nA)\tcontains an \"id\" attribute set to a value constructed according to IETF RFC 4661 [41];\nB)\tdoes not contain an \"uri\" attribute of the <filter> child element according to IETF RFC 4661 [41]; and\nC)\tdoes not contain an \"domain\" attribute according to IETF RFC 4661 [41];\n6)\tcontains a <what> child element according to IETF RFC 4661 [41], of the <filter> element; and\n7)\tcontains an <include> child element according to IETF RFC 4661 [41], of the <what> element where the <include> element;\nA)\tdoes not contain a \"type\" attribute according to IETF RFC 4661 [41]; and\nB)\tcontains the value, according to IETF RFC 4661 [41], set to concatenation of the '//pidf:presence/pidf:tuple[@id=\"' string, the MCData ID, and the '\"]' string.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "9\tShort Data Service (SDS)",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "9.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The group administrator can disable the SDS service on a MCData group by setting the <mcdata-allow-short-data-service> element under the <list-service> element, in the group document, to \"false\".\nIf the <mcdata-allow-short-data-service> element under the <list-service> element, in the group document, is set to \"false\" for a MCData group:\n-\tan MCData client should not use the procedures in the clauses of the parent clause to send SDS to the said MCData group.\n-\ta terminating MCData controlling function should reject the request to send SDS to the said MCData group.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "9.2\tOn-network SDS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "9.2.1\tGeneral",
                            "text_content": "When the MCData user wishes to send:\n-\ta one-to-one standalone Short Data Service (SDS) message to another MCData user; or\n-\ta group standalone Short Data Service (SDS) message to a pre-arranged group ;\nthe MCData client:\n1)\tshall follow the procedures in clause 11.1 for transmission control; and\n2)\tif the procedures in clause 11.1 are successful and the size of the payload the MCData user wishes to send:\na)\tis less than or equal to the value contained in the <max-payload-size-sds-cplane-bytes> element in the MCData service configuration document as specified in 3GPP TS 24.484 [12], shall follow the procedures specified in clause 9.2.2.2.1:\nb)\tis greater than the value contained in the <max-payload-size-sds-cplane-bytes> element in the MCData service configuration document as specified in 3GPP TS 24.484 [12], shall follow the procedures specified in clause 9.2.3.2.3.\nWhen the MCData user wishes to:\n-\tinitiate a Short Data Service (SDS) session with another MCData user; or\n-\tinitiate a group Short Data Service (SDS) session to a pre-configured group or to particular members of the pre-configured group;\nthe MCData client:\n1)\tshall follow the procedures in clause 11.1 for transmission control; and\n2)\tif the procedures in clause 11.1 are successful, shall follow the procedures specified in clause 9.2.4.2.3.\nWhen a MCData client has received a SIP request containing:\n-\tan application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1; and\n-\tan application/vnd.3gpp.mcdata-payload MIME body as specified in clause E.2;\nthe MCData Client:\n1)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body;\n2)\tshall decode the contents of the application/vnd.3gpp.mcdata-payload MIME body;\n3)\tif the SDS SIGNALLING PAYLOAD message contains a new Conversation ID, shall instantiate a new conversation with the Message ID in the SDS SIGNALLING PAYLOAD identifying the first message in the conversation thread;\n4)\tif the SDS SIGNALLING PAYLOAD message contains an existing Conversation ID and:\na)\tif the SDS SIGNALLING PAYLOAD message does not contain an InReplyTo message ID, shall use the Message ID in the SDS SIGNALLING PAYLOAD to identify a new message in the existing conversation thread; and\nb)\tif the SDS SIGNALLING PAYLOAD message contains an InReplyTo message ID, shall associate the message to an existing message in the conversation thread as identified by the InReplyTo message ID in the SDS SIGNALLING PAYLOAD, and use the Message ID in the SDS SIGNALLING PAYLOAD to identify the new message;\n5)\tshall identify the number of Payload IEs in the DATA PAYLOAD message from the Number of payloads IE in the DATA PAYLOAD message;\n6)\tif the SDS SIGNALLING PAYLOAD message does not contain an Application ID IE and does not contain an Extended application ID IE:\na)\tshall determine that the payload contained in the DATA PAYLOAD message is for user consumption\nb)\tmay notify the MCData user;\nc)\tmay display to the MCData user the functional alias of the originating MCData user, if provided; and\nd)\tshall render the contents of the Payload IE(s) to the MCData user.\n7)\tif the SDS SIGNALLING PAYLOAD message contains an Application ID IE:\na)\tshall determine that the payload contained in the DATA PAYLOAD message is not for user consumption,\nb)\tshall not notify the MCData user;\nc)\tif the Application ID value is unknown, shall discard the SDS message; and\nd)\tif the Application ID value is known, shall deliver the contents of the Payload IE(s) to the identified application;\nNOTE 1:\tIf required, the MCData client decrypts the Payload IEs before rendering the SDS message to the user or delivering the SDS message to the application.\nNOTE 2:\tThe actions taken when the payload contains application data not meant for user consumption or command instructions are based upon the contents of the payload. If the payload content is addressed to a non-MCData application that is not running, the MCData client starts the local non-MCData application and delivers the payload to that application.\nNOTE 3:\tUser consent is not required before accepting the data.\n8)\tif the SDS SIGNALLING PAYLOAD message contains an Extended application ID IE:\na)\tshall determine that the payload contained in the DATA PAYLOAD message is not for user consumption;\nb)\tshall not notify the MCData user;\nc)\tif the Extended application ID value is unknown, shall discard the SDS message; and\nd)\tif the Extended application ID value is known, shall deliver the contents of the Payload IE(s) to the identified application;\nNOTE 4:\tIf required, the MCData client decrypts the Payload IEs before rendering the SDS message to the user or delivering the SDS message to the application.\nNOTE 5:\tThe actions taken when the payload contains application data not meant for user consumption or command instructions are based upon the contents of the payload. If the payload content is addressed to a non-MCData application that is not running, the MCData client starts the local non-MCData application and delivers the payload to that application.\nNOTE 6:\tUser consent is not required before accepting the data.\n9)\tmay store the message payload in local storage along with the Conversation ID, Message ID, InReplyTo message ID and Date and time;\n10)\tif the received SDS SIGNALLING PAYLOAD message contains an SDS disposition request type IE shall follow the procedures in clause 9.2.1.3; and\n11)\tif the received SDS SIGNALLING PAYLOAD message contains an Application metadata container IE, may process the content of that IE per local policy.\nTo handle the disposition requests, the MCData client:\n1)\tIf the SDS disposition request type IE is set to:\na)\t\"DELIVERY\" then, shall send a delivered notification as described in clause 12.2.1.1;\nb)\t\"READ\", shall send a read notification as described in clause 12.2.1.1, when a display indication is received; or\nc)\t\"DELIVERY AND READ\" then, shall start timer TDU1 (delivery and read).\nUpon receiving a display indication before timer TDU1 (delivery and read) expires, the MCData client:\n1)\tshall stop timer TDU1 (delivery and read); and\n2)\tshall send a delivered and read notification as described in clause 12.2.1.1.\nUpon expiry of timer TDU1 (delivery and read), the MCData client:\n1)\tshall send a delivered notification as described in clause 12.2.1.1; and\n2)\tupon receiving a display indication, send a read notification as described in clause 12.2.1.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.2.2\tStandalone SDS using signalling control plane",
                            "text_content": "The procedures in the clauses of the parent clause are used by a MCData functional entity to send or receive:\n-\ta one-to-one standalone SDS message using the signalling control plane; or\n-\ta group standalone SDS message using the signalling control plane.\nThe MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] with the clarifications given below.\nThe MCData client:\n1)\tshall build the SIP MESSAGE request as specified in clause 6.2.4.1;\n2)\tif a one-to-one standalone SDS message is to be sent, shall insert in the SIP MESSAGE request:\na)\tan application/resource-lists+xml MIME body with the MCData ID of the target MCData user or the functional alias to be called in the \"uri\" attribute of an <entry> element of a <list> element of the <resource-lists> element, according to rules and procedures of IETF RFC 4826 [9];\nb)\tan application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\ta <request-type> element set to a value of \"one-to-one-sds\"; and\nii)\tan <anyExt> element containing:\nA)\tthe <call-to-functional-alias-ind> element set to \"true\" if the functional alias is used as a target of the call request;\nB)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP MESSAGE request, the <functional-alias-URI> element set to the URI of the used functional alias; and\nC)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value; and\nc)\tif end-to-end security is required and the security context does not exist or if the existing security context has expired, an application/mikey MIME body with the MIKEY-SAKKE I_MESSAGE as specified in 3GPP TS 33.180 [26]. The MCData client:\ni)\tif necessary, shall instruct the key management client to request keying material from the key management server as described in 3GPP TS 33.180 [26];\nii)\tshall use the keying material to generate a PCK as described in 3GPP TS 33.180 [26];\niii)\tshall use the PCK to generate a PCK-ID with the four most significant bits set to \"0001\" to indicate that the purpose of the PCK is to protect one-to-one communications and with the remaining twenty-eight bits being randomly generated as described in 3GPP TS 33.180 [26];\niv)\tshall encrypt the PCK to a UID associated to the MCData client using the MCData ID of the invited user and a time related parameter as described in 3GPP TS 33.180 [26];\nv)\tshall generate a MIKEY-SAKKE I_MESSAGE using the encapsulated PCK and PCK-ID as specified in 3GPP TS 33.180 [26]; and\nvi)\tshall add the MCData ID of the originating MCData to the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26];\nvii)\tshall sign the MIKEY-SAKKE I_MESSAGE using the originating MCData user's signing key provided in the keying material together with a time related parameter; and\nviii)\tshall include the MIKEY-SAKKE I_MESSAGE in an application/mikey MIME body as specified in 3GPP TS 33.180 [26];\n3)\tif a group standalone SDS message is to be sent:\na)\tif the <AllowedSDS> element present in the group document of the requested MCData group as specified in 3GPP TS 24.484 [12] is set to \"false\", shall reject the request to send SDS and not continue with the rest of the steps in this clause; and\nNOTE 1:\tThe group document can either be known by the group management client in case of a normal group or of a temporary, or be known by the MCData client from the group regroup based on a preconfigured group procedures in case of a group regroup based on a preconfigured group.\nb)\tshall insert in the SIP MESSAGE request an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <request-type> element set to a value of \"group-sds\";\nii)\tthe <mcdata-request-uri> element set to the MCData group identity;\niii)\tif the group identity identifies a temporary group or a group regroup based on a preconfigured group, the <anyExt> element with the <associated-group-id> element set to the MCData group ID of a constituent group the MCData client is member of;\nNOTE 2:\tThe MCData client is informed about temporary groups regrouping MCdata groups that the user is a member of as specified in 3GPP TS 24.481 [11]. The MCData client is informed about regroups based on a preconfigured group of MCData groups that the user is member of and affiliated to as specified in clause 23.\nNOTE 3:\tIf the MCData user selected a TGI or the identity of a group regroup based on a preconfigured group where there are several constituent MCData groups where the MCData user is a member, the MCData client selects one of those MCData groups.\niv)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client;\nv)\tan <anyExt> element containing:\nA)\tif the MCData client is aware of active functional aliases, and an active functional alias is to be included in the SIP MESSAGE request, the <functional-alias-URI> element set to the URI of the used functional alias; and\nB)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value.\n4)\tshall generate a standalone SDS message as specified in clause 6.2.2.1; and\n5)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5].\nUpon receiving a SIP 300 (Multiple Choices) response to the SIP MESSAGE request the MCData client shall use the MCData ID contained in the <mcdata-request-uri> element of the received application/vnd.3gpp.mcdata-info MIME body as the MCData ID of the invited MCData user and shall generate a new SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6], with the clarifications given in this clause and with the following additional clarifications:\n1)\tshall insert in the newly generated SIP MESSAGE request an application/resource-lists+xml MIME body with the MCData ID of the invited MCData user in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body where the MCData ID is found in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info MIME body in the received SIP 300 (Multiple Choices) response;\n2)\tshall not include a <call-to-functional-alias-ind> element into the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\n3)\tshall include a <called-functional-alias-URI> element into the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body with the target functional alias used in the initial SIP MESSAGE request for for sending one-to-one standalone SDS message.\nUpon receipt of a \"SIP MESSAGE request for standalone SDS for terminating MCData client\", the MCData client:\n1)\tmay reject the SIP MESSAGE request if there are not enough resources to handle the SIP MESSAGE request;\n2)\tif the SIP MESSAGE request is rejected in step 1), shall respond toward participating MCData function with a SIP 480 (Temporarily unavailable) response and skip the rest of the steps of this clause;\n3)\tif the SIP MESSAGE request contains an application/mikey MIME body containing a MIKEY-SAKKE I_MESSAGE:\na)\tshall extract the MCData ID of the originating MCData user from the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26];\nb)\tshall convert the MCData ID to a UID as described in 3GPP TS 33.180 [26];\nc)\tshall use the UID to validate the signature of the MIKEY-SAKKE I_MESSAGE as described in 3GPP TS 33.180 [26];\nd)\tif authentication verification of the MIKEY-SAKKE I_MESSAGE fails, shall reject the SIP MESSAGE request with a SIP 606 (Not Acceptable) response, and include warning text set to \"136 authentication of the MIKEY-SAKKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and not continue with rest of the steps in this clause; and\ne)\tif the signature of the MIKEY-SAKKE I_MESSAGE was successfully validated:\ni)\tshall extract and decrypt the encapsulated PCK using the terminating user's (KMS provisioned) UID key as described in 3GPP TS 33.180 [26]; and\nii)\tshall extract the PCK-ID, from the payload as specified in 3GPP TS 33.180 [26];\nNOTE:\tWith the PCK successfully shared between the originating MCData client and the terminating MCData client, both clients are able to exchange end-to-end secure message.\n4)\tshall generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\n5)\tshall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5]; and\n6)\tshall handle the received message as specified in clause 9.2.1.2.\nUpon receipt of a \"SIP MESSAGE request for standalone SDS for originating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall determine the MCData ID of the originating user from the public user identity in the P-Asserted-Identity header field of the SIP MESSAGE request, and shall authorise the calling user;\nNOTE 1:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request is:\na)\tset to a value of \"group-sds\", shall determine the public service identity of the controlling MCData function associated with:\ni)\tif present, the MCData group indentity contained in the <associated-group-is> element in an <anyExt> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request; or\nNOTE 2:\tIf the incoming SIP MESSAGE request contains an <associated-group-id> element in an <anyExt> element of the application/vnd.3gpp.mcdata-info+xml MIME body, then the group identity contained in the <mcdata-request-uri> element is expected to be a TGI or the identity of a group regroup based on a preconfigured group and the participating MCData function forwards the request to the non-controlling function serving the constituent MCData group identity contained in the <associated-group-id> element.\nii)\tthe MCData group identity contained in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request; or\nb)\tset to a value of \"one-to-one-sds\", shall determine the public service identity of the controlling MCData function hosting the one-to-one standalone SDS service for the calling user;\n5)\tif unable to identify the controlling MCData function for standalone SDS, it shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response with the warning text \"142 unable to determine the controlling function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n6)\tshall determine whether the MCData user identified by the MCData ID is authorised for MCData communications by following the procedures in clause 11.1;\n7)\tif the procedures in clause 11.1 indicate that the user identified by the MCData ID:\na)\tis not allowed to send MCData communications as determined by step 1) of clause 11.1, shall reject the \"SIP MESSAGE request for standalone SDS for originating participating MCData function\" with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"200 user not authorised to transmit data\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\nb)\tis not allowed to initiate one-to-one MCData communications due to exceeding the maximum amount of data that can be sent in a single request as determined by step 7) of clause 11.1, shall reject the \"SIP MESSAGE request for standalone SDS for originating participating MCData function\" with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"202 user not authorised for one-to-one MCData communications due to exceeding the maximum amount of data that can be sent in a single request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\nc)\tis not allowed to initiate one-to-one MCData communications to the targeted user as determined by step 1a) of clause 11.1, shall reject the \"SIP MESSAGE request for standalone SDS for originating participating MCData function\" with a SIP 403 (Forbidden) response including warning text set to \"229 one-to-one MCData communication not authorised to the targeted user\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n8)\tif the payload size of the message is larger than the value contained in the <max-payload-size-sds-cplane-bytes> element in the MCData service configuration document as specified in 3GPP TS 24.484 [12], shall reject the \"SIP MESSAGE request for standalone SDS for originating participating MCData function\" with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"203 message too large to send over signalling control plane\" in a Warning header field as specified in clause 4.9;\nNOTE 3:\tThe term \"payload size\" refers to the \"Length of Payload contents\" of the payload IE of the DATA PAYLOAD message transported in the SIP MESSAGE request, minus 1 (to account for the added \"Payload content type\" field).\n9)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n10)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the controlling MCData function as determined by step 4) in this clause;\nNOTE 4:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 5:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 6:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 7:\tHow the participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 8:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n11)\tshall copy all MIME bodies included in the incoming SIP MESSAGE request to the outgoing SIP MESSAGE request;\n12)\tshall include the MCData ID of the originating user in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP MESSAGE request;\n12A)\tif the incoming SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body that contains a <functional-alias-URI> element, shall check if the status of the functional alias is activated for the MCData ID. If the functional alias status is activated, then the participating MCData function shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request to the received value, otherwise shall not include a <functional-alias-URI> element;\n13)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP MESSAGE request;\n14) shall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function; and\n15)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 202 (Accepted) response in response to the SIP MESSAGE request in step 15):\n1)\tshall generate a SIP 202 (Accepted) response as specified in 3GPP TS 24.229 [5]; and\n2)\tshall send the SIP 202 (Accepted) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the SIP MESSAGE request in step 15):\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5]; and\n2)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the SIP MESSAGE request in step 15) the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a \"SIP MESSAGE request for standalone SDS for terminating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request to retrieve the binding between the MCData ID and public user identity of the terminating MCData user;\n3)\tif the binding between the MCData ID and public user identity of the terminating MCData user does not exist, then the participating MCData function shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response, and shall not continue with the rest of the steps;\n3a)\tif the <IncomingOne-to-OneCommunicationList> element exists in the MCData user profile document with one or more <One-to-One-CommunicationListEntry> elements (see the MCData user profile document in 3GPP TS 24.484 [12]) and:\ni)\tif the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request does not match with the <entry> element of any of the <One-to-One-CommunicationListEntry> elements in the <IncomingOne-to-OneCommunicationList> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]); and\nii)\tif configuration is not set in the MCData user profile document that allows the MCData user to receive one-to-one MCData communication from any user (see <allow-one-to-one-communication-from-any-user> element in MCData user profile document in 3GPP TS 24.484 [12]);\nthen:\ni)\tshall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"230 one-to-one MCData communication not authorised from this originating user\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n4)\tshall generate an outgoing SIP MESSAGE request as specified in clause 6.3.2.1;\n5)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP MESSAGE request; and\n6)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the above SIP MESSAGE request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5]; and\n2)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP MESSAGE request, the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the controlling MCData function according to 3GPP TS 24.229 [5].\n9.2.2.4.1.1\tSIP MESSAGE targeted to an MCData clients\nThis clause describes the procedures for sending a SIP MESSAGE from the controlling MCData function and is initiated by the controlling MCData function as a result of an action in clause 9.2.2.4.2.\nThe controlling MCData function:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\n3)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\n4)\tshall copy the following MIME bodies in the received SIP MESSAGE request into the outgoing SIP MESSAGE request by following the guidelines in clause 6.4:\na)\tapplication/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tapplication/vnd.3gpp.mcdata-signalling MIME body; and\nc)\tapplication/vnd.3gpp.mcdata-payload MIME body\n5)\tin the application/vnd.3gpp.mcdata-info+xml MIME body:\na)\tshall set the <mcdata-request-uri> element to the MCData ID of the terminating user; and\nb)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request was set to a value of \"group-sds\", shall set the <mcdata-calling-group-id> element to the group identity;\n6)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated to the MCData user to be invited;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n7)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the controlling MCData function;\n8)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\n9)\tshall send the SIP MESSAGE request according to according to rules and procedures of 3GPP TS 24.229 [5].\n9.2.2.4.1.2\tSIP MESSAGE targeted to a non-controlling MCData function\nThis clause describes the procedures for sending a SIP MESSAGE from the controlling MCData function to a non-controlling MCData function and is initiated by the controlling MCData function as a result of an action in clause 9.2.2.4.2.\nThe controlling MCData function:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters in accordance with IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\n3)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" in accordance with IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\n4)\tshall copy the following MIME bodies in the received SIP MESSAGE request into the outgoing SIP MESSAGE request by following the guidelines in clause 6.4:\na)\tapplication/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tapplication/vnd.3gpp.mcdata-signalling MIME body; and\nc)\tapplication/vnd.3gpp.mcdata-payload MIME body\n5)\tin the application/vnd.3gpp.mcdata-info+xml MIME body:\na)\tshall set the <mcdata-request-uri> element to the group identity of the constituent group served by the non-controlling MCData function; and\nb)\tshall set the <mcdata-calling-group-id> element to the group identity of the group served by the controlling MCData function;\n6)\tshall set the Request-URI to the public service identity of the non-controlling MCData function associated with the constituent group;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n7)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\n8)\tshall send the SIP MESSAGE request in accordance with rules and procedures of 3GPP TS 24.229 [5].\nUpon receipt of a \"SIP MESSAGE request for standalone SDS for controlling MCData function\", the controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. Otherwise, continue with the rest of the steps;\n2)\tif the SIP MESSAGE does not contain:\na)\tan application/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tan application/vnd.3gpp.mcdata-signalling MIME body; and\nc)\tan application/vnd.3gpp.mcdata-payload MIME body;\nshall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"199 expected MIME bodies not in the request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\n3)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body contained in the SIP MESSAGE;\n4)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains a SDS SIGNALLING PAYLOAD message with a SDS disposition request type IE, shall store the value of the Conversation ID IE and the value of the Message ID IE in the SDS SIGNALLING PAYLOAD message;\nNOTE 1:\tThe controlling MCData function uses the Conversation ID and Message ID for correlation with disposition notifications.\n5)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request is set to a value of \"one-to-one-sds\" and:\na)\tthe conditions in clause 11.1 indicate that the MCData user is not allowed to SDS communications due to message size as determined by step 3) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"218 user not authorised for one-to-one SDS communications due to message size\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\nb)\tthe SIP MESSAGE request:\ni)\tdoes not contain an application/resource-lists+xml MIME body or contains an application/resource-lists MIME body with more than one <entry> element in the set of <list> elements in the <resource-lists> element, shall return a SIP 403 (Forbidden) response with the warning text set to \"204 unable to determine targeted user for one-to-one SDS\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\nii)\tif the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body contains a <call-to-functional-alias-ind> element set to a value of \"true\":\nA)\tshall identify the MCData ID(s) of the MCData user(s) that have activated the called functional alias received in the \"uri\" attribute of an <entry> element of a <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the SIP MESSAGE request by performing the actions specified in clause 22.2.2.2.8;\nI)\tif unable to determine any MCData ID that has activated the called functional alias received in the \"uri\" attribute of an <entry> element of a <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the SIP MESSAGE, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including a warning text set to \"145 unable to determine called party\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps; and\nII)\tselects one of the identified MCData IDs, and shall send a SIP 300 (Multiple Choices) response to the SIP MESSAGE request with an application/vnd.3gpp.mcdata-info MIME body containing an <mcdata-request-uri> element set to the selected MCData ID and shall not continue with the rest of the steps in this clause; and\nNOTE 2:\tHow the controlling MCData function selects the  MCData ID is implementation-specific.\niii)\tcontains an application/resource-lists+xml MIME body with exactly one <entry> element in the set of <list> elements of the <resource-lists> element, shall send a SIP MESSAGE request to the MCData user identified in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, as specified in clause 9.2.2.4.1.1;\n6)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request is set to a value of \"group-sds\":\na)\tif the group identity is associated with a group document maintained by the GMS:\nNOTE 3:\tHow the MCData server determines that a group identity represents a group for which a group document is stored in the GMS is an implementation detail.\ni)\tshall retrieve the group document associated with the group identity in the SIP MESSAGE request by following the procedures in clause 6.3.3, and shall continue with the remaining steps if the procedures in clause 6.3.3 were successful; or\nb)\tif the group identity is associated with a user or group regroup based on a preconfigured group:\ni)\tshall retrieve the stored information for the group identity; and\nii)\tif there is no stored information for the group identity, the controlling MCData function:\nA)\tshall return a SIP 404 (Not Found) response with the warning text set to \"163 the group identity indicated in the request does not exist\" as specified in clause 4.4 \"Warning header field\" and shall not continue with the rest of the steps;\nNOTE 4:\tThe user or group regroup can have been removed very recently and the client has sent the group call request prior to receiving the removal notification.\nc)\tif the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element that is set to the value \"true\", shall reject the SIP request with a SIP 403 (Forbidden) response with the warning text set to \"167 call is not allowed on the preconfigured group\" as specified in clause 4.9 \"Warning header field\" and shall skip the rest of this procedure;\nd)\tif the <on-network-disabled> element is present in the group document, shall send a SIP 403 (Forbidden) response with the warning text set to \"115 group is disabled\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\ne)\tif the <entry> element of the <list> element of the <list-service> element in the group document does not contain an <mcdata-mcdata-id> element with a \"uri\" attribute matching the MCData ID of the originating user contained in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request, shall send a SIP 403 (Forbidden) response with the warning text set to \"116 user is not part of the MCData group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nf)\tif the <list-service> element contains a <mcdata-allow-short-data-service> element in the group document set to a value of \"false\", shall send a SIP 403 (Forbidden) response with the warning text set to \"206 short data service not allowed for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\ng)\tif the <supported-services> element is not present in the group document or is present and contains a <service> element containing an \"enabler\" attribute which is not set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", shall send a SIP 488 (Not Acceptable) response with the warning text set to \"207 SDS services not supported for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nh)\tif the group referred to by the group identity has been regrouped:\ni)\tsend a SIP 403 (Forbidden) response with the warning text set to \"148 group is regrouped \" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nii)\tif the group referred to by the group identity has been regrouped based on a preconfigured group, shall send a copy of the notifying SIP MESSAGE that was generated and sent per clause 23.2.4.1 to the participating function for the MCData ID of the incoming SIP MESSAGE request; and\niii)\tskip the rest of the steps;\ni)\tif the MCData server group SDS procedures in clause 11.1 indicate that the user identified by the MCData ID:\ni)\tis not allowed to send group MCData communications on this group identity as determined by step 2) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"201 user not authorised to transmit data on this group identity\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\nii)\tis not allowed to send group MCData communications on this group identity due to exceeding the maximum amount of data that can be sent in a single request as determined by step 8) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"208 user not authorised for MCData communications on this group identity due to exceeding the maximum amount of data that can be sent in a single request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\niii)\tis not allowed to send SDS communications on this group identity due to message size as determined by step 5) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"217 user not authorised for SDS communications on this group identity due to message size\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\nj)\tif:\ni)\tthe originating user identified by the MCData ID is not affiliated to the group identity contained in the SIP MESSAGE request, as specified in clause 6.3.5;\nii)\tthe group identity contained in the SIP MESSAGE resquest refers to a user regroup based on a preconfigured group and the originating user is not a member of that user regroup; or\nii)\tthe group identity contained in an <mcdata-calling-group-id> element of the SIP MESSAGE request is not a constituent group of the group identity contained in the SIP MESSAGE request;\nNOTE 5:\tIf the SIP MESSAGE is for a temporary group or a group regroup based on preconfigured group, the affiliation of the calling user to the constituent group has been assured by the non-controlling MCData function of the constituent group before forwarding this SIP MESSAGE to the controlling function of the regroup.\nshall return a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\nk)\tif the group identity in the SIP MESSAGE request for standalone SDS for controlling MCData function is not a TGI nor the identity of a group regroup based on a preconfigured group:\ni)\tshall determine the targeted group members for the MCData standalone SDS by following the procedures in clause 6.3.4;\nii)\tif the procedures in clause 6.3.4 result in no affiliated members found in the selected MCData group, shall return a SIP 403 (Forbidden) response with the warning text set to \"198 no users are affiliated to this group\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below; and\niii)\tshall send SIP MESSAGE requests to the targeted group members identified in step h) above by following the procedure in clause 9.2.2.4.1.1; and\nl)\tif the group identity in the SIP MESSAGE request for standalone SDS for controlling MCData function is a TGI or the identity of a group regroup based on a preconfigured group:\ni)\tshall, for each of the constituent MCData groups except for the calling MCData group identified in the <mcdata-calling-group-id> element of the incoming SIP MESSAGE, generate a SIP INVITE request towards the MCData server that owns the constituent MCData group identity by following the procedures in clause 9.2.2.4.1.2; and\nNOTE 6:\tThe MCData server that the SIP MESSAGE request is sent to acts as a non-controlling MCData function;\n7)\tshall generate a SIP 202 (Accepted) response in response to the \"SIP MESSAGE request for standalone SDS for controlling MCData function\"; and\n8)\tshall send the SIP 202 (Accepted) response towards the originating participating or non-controlling MCData function according to 3GPP TS 24.229 [5].\nUpon receiving a SIP MESSAGE for standalone SDS from the controlling MCData function, the non-controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response, may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4], and shall skip the rest of the steps;\n2)\tshall retrieve the group document associated with the group identified in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body in the incoming SIP MESSAGE request by following the procedures in clause 6.3.3, and shall continue with the remaining steps if the procedures in clause 6.3.3 were successful;\n3)\tshall send a SIP 200 (OK) response in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]:\n4)\tshall determine the targeted group members of the constituent group for the MCData standalone SDS by following the procedures in clause 6.3.4; and\n5)\tfor each of  the targeted group members:\na)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\nb)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters in accordance with IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\nc)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" in accordance with IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\nd)\tshall copy the following MIME bodies in the received SIP MESSAGE request into the outgoing SIP MESSAGE request by following the guidelines in clause 6.4:\ni)\tapplication/vnd.3gpp.mcdata-info+xml MIME body;\nii)\tapplication/vnd.3gpp.mcdata-signalling MIME body; and\niii)\tapplication/vnd.3gpp.mcdata-payload MIME body\ne)\tin the application/vnd.3gpp.mcdata-info+xml MIME body:\ni)\tshall set the <mcdata-request-uri> element set to the MCData ID of the targeted terminating MCData user;\nii)\tshall set the <associated-group-id> element to the group identity of the constituent group received in the <mcdata-request-uri> element of the incoming SIP MESSAGE reqsuest; and\niii)\tshall set the <mcdata-calling-group-id> element to the group identity of the group regroup received in the <mcdata-calling-group-id> element of the incoming SIP MESSAGE reqsuest;\nf)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated to the targeted terminating MCData user;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\ng)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\nh)\tshall send the SIP MESSAGE request according rules and procedures of 3GPP TS 24.229 [5].\nUpon receiving a SIP MESSAGE for group standalone SDS from the participating MCData function, the non-controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. Otherwise, continue with the rest of the steps;\n2)\tif the SIP MESSAGE does not contain:\na)\tan application/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tan application/vnd.3gpp.mcdata-signalling MIME body; and\nc)\tan application/vnd.3gpp.mcdata-payload MIME body;\nshall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"199 expected MIME bodies not in the request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\n3)\tshall retrieve the group document associated with the group identified in the <associated-group-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request by following the procedures in clause 6.3.3, and shall continue with the remaining steps if the procedures in clause 6.3.3 were successful;\na)\tif the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element that is set to the value \"true\", shall reject the SIP request with a SIP 403 (Forbidden) response with the warning text set to \"167 call is not allowed on the preconfigured group\" as specified in clause 4.9 \"Warning header field\" and shall skip the rest of this procedure;\nb)\tif the <on-network-disabled> element is present in the group document, shall send a SIP 403 (Forbidden) response with the warning text set to \"115 group is disabled\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nc)\tif the <entry> element of the <list> element of the <list-service> element in the group document does not contain an <mcdata-mcdata-id> element with a \"uri\" attribute matching the MCData ID of the originating user contained in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request, shall send a SIP 403 (Forbidden) response with the warning text set to \"116 user is not part of the MCData group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nd)\tif the <list-service> element contains a <mcdata-allow-short-data-service> element in the group document set to a value of \"false\", shall send a SIP 403 (Forbidden) response with the warning text set to \"206 short data service not allowed for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\ne)\tif the <supported-services> element is not present in the group document or is present and contains a <service> element containing an \"enabler\" attribute which is not set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", shall send a SIP 488 (Not Acceptable) response with the warning text set to \"207 SDS services not supported for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nf)\tif the MCData server group SDS procedures in clause 11.1 indicate that the user identified by the MCData ID:\ni)\tis not allowed to send group MCData communications on this group identity as determined by step 2) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"201 user not authorised to transmit data on this group identity\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\nii)\tis not allowed to send group MCData communications on this group identity due to exceeding the maximum amount of data that can be sent in a single request as determined by step 8) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"208 user not authorised for MCData communications on this group identity due to exceeding the maximum amount of data that can be sent in a single request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\niii)\tis not allowed to send SDS communications on this group identity due to message size as determined by step 5) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"217 user not authorised for SDS communications on this group identity due to message size\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\ng)\tif the originating user identified by the MCData ID is not affiliated to the group identity contained in the <associated-group-id> element of the  application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request, as specified in clause 6.3.5, shall return a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps;\n4)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n5)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the controlling MCData function associated with the MCData group identity in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request\nNOTE 1:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n6)\tshall copy all MIME bodies included in the incoming SIP MESSAGE request to the outgoing SIP MESSAGE request;\n7)\tshall set the <mcdata-calling-group-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP MESSAGE request to the identity of the group identified in the <associated-group-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request;\n8)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP MESSAGE request;\n9)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the controlling MCData function; and\n10)\tshall send the SIP MESSAGE request to the controlling MCData function as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the SIP MESSAGE request sent to the controlling MCData function in step 10) the non-controlling MCData function:\n1)\tshall forward the SIP response to the originating participating MCData function in accordance with 3GPP TS 24.229 [5].\nUpon receipt of a SIP 202 (Accepted) response to the SIP MESSAGE request sent to the controlling MCData function in step 10) the non-controlling MCData function:\n1)\tshall generate a SIP 202 (Accepted) response to the received SIP MESSAGE for group standalone SDS from the participating MCData function as specified in 3GPP TS 24.229 [5];\n2)\tshall determine the targeted group members of the constituent group for the MCData standalone SDS by following the procedures in clause 6.3.4; and\n3)\tfor each of the targeted group members:\na)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\nb)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters in accordance with IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\nc)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" in accordance with IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\nd)\tshall copy the following MIME bodies in the received SIP MESSAGE request into the outgoing SIP MESSAGE request by following the guidelines in clause 6.4:\ni)\tapplication/vnd.3gpp.mcdata-info+xml MIME body;\nii)\tapplication/vnd.3gpp.mcdata-signalling MIME body; and\niii)\tapplication/vnd.3gpp.mcdata-payload MIME body\ne)\tin the application/vnd.3gpp.mcdata-info+xml MIME body:\ni)\tshall set the <mcdata-request-uri> element set to the MCData ID of the targeted terminating MCData user;\nii)\tshall set the <associated-group-id> element to the group identity of the constituent group received in the <associated-group-id> element of the incoming SIP MESSAGE reqsuest; and\niii)\tshall set the <mcdata-calling-group-id> element to the group identity of the group regroup received in the <mcdata-request-uri> element of the incoming SIP MESSAGE reqsuest;\nf)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated with the targeted terminating MCData user;\nNOTE 6:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 7:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 8:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 9:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 10:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\ng)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\nh)\tshall send the SIP MESSAGE request in accordance with rules and procedures of 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.2.3\tStandalone SDS using media plane",
                            "text_content": "The procedures in the clauses of the parent clause are used by a MCData functional entity to send or receive:\n-\ta one-to-one standalone SDS message using the media control plane; or\n-\ta group standalone SDS message using the media control plane.\nThe procedures in the clauses of the parent clause are applicable to establish an on-demand standalone SDS using media plane.\nWhen composing an SDP offer according to 3GPP TS 24.229 [5], IETF RFC 4975 [17], IETF RFC 6135 [19] and IETF RFC 6714 [20] the MCData client:\n1)\tshall include an \"m=message\" media-level section for the MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\", or \"TCP/TLS/MSRP\" for TLS;\nc)\ta format list field set to '*';\nd)\tan \"a=sendonly\" attribute;\ne)\tan \"a=path\" attribute containing its own MSRP URI;\nf)\tset the content type as \"a=accept-types:application/vnd.3gpp.mcdata-signalling application/vnd.3gpp.mcdata-payload\"; and\ng)\tset the a=setup attribute as \"actpass\"; and\n2)\tif end-to-end security is required for a one-to-one communication and the security context does not exist or if the existing security context has expired, shall include the MIKEY-SAKKE I_MESSAGE in an \"a=key-mgmt\" attribute as a \"mikey\" attribute value in the SDP offer as specified in IETF RFC 4567 [45].\nWhen the MCData client receives an initial SDP offer for an MCData standalone SDS, the MCData client shall process the SDP offer and shall compose an SDP answer according to 3GPP TS 24.229 [5] and IETF RFC 4975 [17].\nWhen composing an SDP answer, the MCData client:\n1)\tshall include an \"m=message\" media-level section for the accepted MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\", or \"TCP/TLS/MSRP\" for TLS according to the received SDP offer;\nc)\ta format list field set to '*';\nd)\tan \"a=recvonly\" attribute;\ne)\tan \"a=path\" attribute containing its own MSRP URI;\nf)\tset the content type as a=accept-types: application/vnd.3gpp.mcdata-signalling application/vnd.3gpp.mcdata-payload; and\ng)\tset the a=setup attribute according to IETF RFC 6135 [19].\nIf a group standalone SDS message is to be sent, the MCData client shall determine whether the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element. If a <preconfigured-group-use-only> element exists and is set to the value \"true\", then the MCData client:\n1)\tshould indicate to the MCData user that a group standalone SDS message is not allowed on the indicated group; and\n2)\tshall skip the remainder of this procedure.\nThe MCData client shall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [5] with the clarifications given below.\nThe MCData client:\n1)\tshall include the g.3gpp.mcdata.sds media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in the Contact header field of the SIP INVITE request according to IETF RFC 3840 [16];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n3)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n4)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n5)\tshould include the \"timer\" option tag in the Supported header field;\n6)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n7)\tif a one-to-one standalone SDS message is to be sent:\na)\tshall insert in the SIP INVITE request an application/resource-lists+xml MIME body with the MCData ID of the invited MCData user or the functional alias to be called in the \"uri\" attribute of an <entry> element of a <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, according to rules and procedures of IETF RFC 5366 [18];\nNOTE 1:\tThe MCData client indicates whether an MCData ID or a functional alias is to be called as specified in step 7) b) below.\nb)\tshall contain an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <request-type> element set to a value of \"one-to-one-sds\"; and\nii)\tan <anyExt> element containing:\nA)\tthe <call-to-functional-alias-ind> element set to \"true\" if the functional alias is used as a target of the call request;\nB)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP INVITE request, the <functional-alias-URI> element set to the URI of the used functional alias; and\nC)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value; and\nNOTE 2:\tThe MCData client learns the functional aliases that are activated for an MCData ID from procedures specified in clause 22.2.1.3.\nc)\tif an end-to-end security context needs to be established and the security context does not exist or if the existing security context has expired, then:\ni)\tif necessary, shall instruct the key management client to request keying material from the key management server as described in 3GPP TS 33.180 [26];\nii)\tshall use the keying material to generate a PCK as described in 3GPP TS 33.180 [26];\niii)\tshall use the PCK to generate a PCK-ID with the four most significant bits set to \"0001\" to indicate that the purpose of the PCK is to protect one-to-one communications and with the remaining twenty eight bits being randomly generated as described in 3GPP TS 33.180 [26];\niv)\tshall encrypt the PCK to a UID associated to the MCData client using the MCData ID of the invited user and a time related parameter as described in 3GPP TS 33.180 [26];\nv)\tshall generate a MIKEY-SAKKE I_MESSAGE using the encapsulated PCK and PCK-ID as specified in 3GPP TS 33.180 [26];\nvi)\tshall add the MCData ID of the originating MCData to the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26]; and\nvii)\tshall sign the MIKEY-SAKKE I_MESSAGE using the originating MCData user's signing key provided in the keying material together with a time related parameter, and add this to the MIKEY-SAKKE payload, as described in 3GPP TS 33.180 [26];\n8)\tif a group standalone SDS message is to be sent:\na)\tif the \"/<x>/<x>/Common/MCData/AllowedSDS\" leaf node present in the group document of the requested MCData group as specified in 3GPP TS 24.483 [42] is set to \"false\", shall reject the request to send SDS and not continue with the rest of the steps in this clause; and\nb)\tshall contain in an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <request-type> element set to a value of \"group-sds\";\nii)\tthe <mcdata-request-uri> element set to the MCData group identity;\niii)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client;\nNOTE 3:\tThe MCData client does not include the MCData ID of the originating MCData user in the body, as this will be inserted into the body of the SIP INVITE request that is sent from the originating participating MCData function.\niv)\tan <anyExt> element containing:\nA)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP INVITE request, may include the <functional-alias-URI> element set to the URI of the used functional alias; and\nB)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value;\n9)\tshall set the Request-URI of the SIP INVITE request to the public service identity identifying the participating MCData function serving the MCData user;\nNOTE 4:\tThe MCData client is configured with public service identity identifying the participating MCData function serving the MCData user.\n10)\tmay include a P-Preferred-Identity header field in the SIP INVITE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n11)\tshall include an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 9.2.3.2.1; and\n12)\tshall send the SIP INVITE request towards the MCData server according to 3GPP TS 24.229 [5].\nOn receipt of a SIP 2xx response to the SIP INVITE request, the MCData client:\n1)\tshall send a SIP ACK request as specified in 3GPP TS 24.229 [5];\n2)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38]; and\n3)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.1.1.2.\nUpon receiving a SIP 300 (Multiple Choices) response to the SIP INVITE request the MCData client shall use the MCData ID of MCData user contained in the <mcdata-request-uri> element of the received application/vnd.3gpp.mcdata-info MIME body as the MCData ID of the invited MCData user and shall generate an initial SIP INVITE request by following the UE originating session procedures specified in 3GPP TS 24.229 [5], with the clarifications given in this clause and with the following additional clarifications:\n1)\tshall insert in the newly generated SIP INVITE request an application/resource-lists+xml MIME body with the MCData ID of the invited MCData user in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body where the MCData ID is found in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info MIME body  in the received SIP 300 (Multiple Choices) response;\n2)\tshall not include a <call-to-functional-alias-ind> element into the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\n3)\tshall include a <called-functional-alias-URI> element into the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body with the target functional alias used in the initial SIP INVITE request for establishing a session for sending one-to-one standalone SDS message.\nOn receipt of a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request:\n1)\tshall indicate to the MCData user that the SDS message could not be sent; and\n2)\tshall send a SIP ACK request as specified in 3GPP TS 24.229 [5].\nOn receipt of an indication from the media plane indicating that the standalone SDS message was not sent successfully, the MCData client shall:\n1)\tshall generate a SIP BYE request according to 3GPP TS 24.229 [5] with:\na)\tReason code set to \"SIP\";\nb)\tcause set to \"480\"; and\nc)\ttext set to \"transmission failed\";\n2)\tshall set the Request-URI to the MCData session identity to release; and\n3)\tshall send a SIP BYE request towards MCData server according to 3GPP TS 24.229 [5].\nOn receipt of an indication from the media plane indicating that the standalone SDS message has been successfully transferred, the MCData client shall:\n1)\tshall generate a SIP BYE request according to 3GPP TS 24.229 [5] with:\na)\tReason code set to \"SIP\";\nb)\tcause set to \"200\"; and\nc)\ttext set to \"transmission succeeded\";\n2)\tshall set the Request-URI to the MCData session identity to release; and\n3)\tshall send a SIP BYE request towards MCData server according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response to the SIP BYE request, the MCData client shall interact with the media plane and indicate to terminate the session, as specified in 3GPP TS 24.582 [15].\nUpon receipt of a \"SIP INVITE request for standalone SDS over media plane for terminating MCData client\" request, the MCData client shall follow the procedures for termination of multimedia sessions in the IM CN subsystem as specified in 3GPP TS 24.229 [5] with the clarifications below.\nThe MCData client:\n1)\tmay reject the SIP INVITE request if either of the following conditions are met:\na)\tMCData client does not have enough resources to handle the call; or\nb)\tany other reason outside the scope of this specification;\nand skip the rest of the steps after step 2;\n2)\tif the SIP INVITE request is rejected in step 1), shall respond toward participating MCData function either with appropriate reject code as specified in 3GPP TS 24.229 [5] and warning texts as specified in clause 4.9 or with SIP 480 (Temporarily unavailable) response not including warning texts if the user is authorised to restrict the reason for failure and skip the rest of the steps of this clause;\n3)\tif the SDP offer of the SIP INVITE request contains an \"a=key-mgmt\" attribute field with a \"mikey\" attribute value containing a MIKEY-SAKKE I_MESSAGE:\na)\tshall extract the MCData ID of the originating MCData user from the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26];\nb)\tshall convert the MCData ID to a UID as described in 3GPP TS 33.180 [26];\nc)\tshall use the UID to validate the signature of the MIKEY-SAKKE I_MESSAGE as described in 3GPP TS 33.180 [26];\nd)\tif authentication verification of the MIKEY-SAKKE I_MESSAGE fails, shall reject the SIP INVITE request with a SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [45], and include warning text set to \"136 authentication of the MIKEY-SAKKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and not continue with rest of the steps in this clause; and\ne)\tif the signature of the MIKEY-SAKKE I_MESSAGE was successfully validated:\ni)\tshall extract and decrypt the encapsulated PCK using the terminating user's (KMS provisioned) UID key as described in 3GPP TS 33.180 [26]; and\nii)\tshall extract the PCK-ID, from the payload as specified in 3GPP TS 33.180 [26];\nNOTE:\tWith the PCK successfully shared between the originating MCData client and the terminating MCData client, both clients are able to create an end-to-end secure session.\n3A)\tmay display to the MCData user the MCData ID of the inviting MCData user and the type of SDS request;\n4)\tshall accept the SIP INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\n5)\tshall include the option tag \"timer\" in a Require header field of the SIP 200 (OK) response;\n6)\tshall include the Session-Expires header field in the SIP 200 (OK) response and start the SIP session timer according to IETF RFC 4028 [38]. The \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\n7)\tshall include the g.3gpp.mcdata.sds media feature tag in the Contact header field of the SIP 200 (OK) response;\n8)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in the Contact header field of the SIP 200 (OK) response;\n9)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5] with the clarifications given in clause 9.2.3.2.2; and\n10)\tshall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5].\nOn receipt of an SIP ACK message to the sent SIP 200 (OK) message, the MCData client shall:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.1.1.3.\nThe SDP offer is generated based on the received SDP offer. The SDP offer generated by the participating MCData function:\n1)\tshall contain only one SDP media-level section for SDS message as contained in the received SDP offer; and\n2)\tshall contain an \"a=key-mgmt\" attribute field with a \"mikey\" attribute value, if present in the received SDP offer.\nWhen composing the SDP offer according to 3GPP TS 24.229 [5], the participating MCData function:\n1)\tshall replace the IP address and port number for the offered media stream in the received SDP offer with the IP address and port number of the participating MCData function, if required; and\nNOTE 1:\tRequirements can exist for the participating MCData function to be always included in the path of the offered media stream, for example: for the support of features such as MBMS, lawful interception and recording. Other examples can exist.\nNOTE 2:\tIf the participating MCData function and the controlling MCData function are in the same MCData server, and the participating MCData function does not have a dedicated IP address or a dedicated port number for media stream, the replacement of the IP address or the port number is omitted.\n2)\tif the IP address is replaced, shall insert its MSRP URI before the MSRP URI in the \"a=path\" attribute in the SDP offer.\nWhen composing the SDP answer according to 3GPP TS 24.229 [5], the participating MCData function:\n1)\tshall replace the IP address and port number in the received SDP answer with the IP address and port number of the participating MCData function, for the accepted media stream in the received SDP offer, if required; and\nNOTE 1:\tRequirements can exist for the participating MCData function to be always included in the path of the offered media stream, for example: for the support of features such as MBMS, lawful interception and recording. Other examples can exist.\nNOTE 2:\tIf the participating MCData function and the controlling MCData function are in the same MCData server, and the participating MCData function does not have a dedicated IP address or a dedicated port number for media stream, the replacement of the IP address or the port number is omitted.\n2)\tif the IP address is replaced shall insert its MSRP URI before the MSRP URI in the \"a=path\" attribute in the SDP answer.\nUpon receipt of a \"SIP INVITE request for standalone SDS over media plane for originating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\nNOTE 1:\tif the SIP INVITE request contains an emergency indication or an imminent peril indication set to a value of \"true\" and this is an authorised request for originating a priority communication as determined by clause 6.3.7.2.6, the participating MCData function can, according to local policy, choose to accept the request.\n2)\tshall determine the MCData ID of the calling user from the public user identity in the P-Asserted-Identity header field of the SIP INVITE request, and shall authorise the calling user;\nNOTE 2:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP INVITE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is:\na)\tset to a value of \"group-sds\", shall determine the public service identity of the controlling MCData function associated with the MCData group identity in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP INVITE request; or\nb)\tset to a value of \"one-to-one-sds\", shall determine the public service identity of the controlling MCData function hosting the one-to-one standalone SDS over media plane service for the calling user;\n5)\tif unable to identify the controlling MCData function for standalone SDS over media plane, it shall reject the SIP INVITE request with a SIP 404 (Not Found) response with the warning text \"142 unable to determine the controlling function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n6)\tshall determine whether the MCData user identified by the MCData ID\na)\tis authorised for MCData communications by following the procedures in clause 11.1; and\nb)\tis not allowed to initiate one-to-one MCData communications to the targeted user as determined by step 1a) of clause 11.1, shall reject the \"SIP INVITE request for standalone SDS over media plane for originating participating MCData function\" with a SIP 403 (Forbidden) response including warning text set to \"229 one-to-one MCData communication not authorised to the targeted user\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n7)\tif the procedures in clause 11.1 indicate that the user identified by the MCData ID is not allowed to initiate MCData communications, shall reject the \"SIP INVITE request for standalone SDS over media plane for originating participating MCData function\" with a SIP 403 (Forbidden) response to the SIP INVITE request, with warning text set to \"200 user not authorised to transmit data\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\n8)\tshall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [5];\n9)\tshall include the option tag \"timer\" in the Supported header field;\n10)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n11)\tshall set the Request-URI of the outgoing SIP INVITE request to the public service identity of the controlling MCData function as determined by step 4) in this clause;\nNOTE 3:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 5:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 6:\tHow the participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 7:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n12)\tshall include the MCData ID of the originating user in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP INVITE request;\n12A)\tif the incoming SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body that contains a <functional-alias-URI> element, shall check if the status of the functional alias is activated for the MCData ID. If the functional alias status is activated, then the participating MCData function shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request to the received value, otherwise shall not include a <functional-alias-URI> element;\n13)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP INVITE request;\n14)\tshall include a P-Asserted-Identity header field in the outgoing SIP INVITE request set to the public service identity of the participating MCData function;\n15)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received SIP INVITE request from the MCData client as specified in clause 9.2.3.3.1; and\n16)\tshall send the SIP INVITE request as specified to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the SIP INVITE request in step 16):\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n2)\tshall include in the SIP 200 (OK) response an SDP answer as specified in the clause 9.2.3.3.2;\n3)\tshall include the option tag \"timer\" in a Require header field;\n4)\tshall include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If the \"refresher\" parameter is not included in the received request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uac\";\n5)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\nc)\tthe isfocus media feature tag;\n6)\tshall include Warning header field(s) that were received in the incoming SIP 200 (OK) response;\n7)\tshall include an MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP 200 (OK) response;\n8)\tif the incoming SIP 200 (OK) response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response.\n9)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function; and\n10)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.2.1.4\n11)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5]; and\n12)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the SIP INVITE request in step 16) the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a \"SIP INVITE request for standalone SDS over media plane for terminating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\nNOTE:\tIf the SIP INVITE request contains an emergency indication or an imminent peril indication set to a value of \"true\" and this is an authorised request for originating a priority communication as determined by clause 6.3.7.2.6, the participating MCData function can, according to local policy, choose to accept the request.\n2)\tshall check the presence of the isfocus media feature tag in the URI of the Contact header field and if it is not present then the participating MCData function shall reject the request with a SIP 403 (Forbidden) response with the warning text set to \"104 isfocus not assigned\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\n3)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request to retrieve the binding between the MCData ID and public user identity of the terminating MCData user;\n4)\tif the binding between the MCData ID and public user identity of the terminating MCData user does not exist, then the participating MCData function shall reject the SIP INVITE request with a SIP 404 (Not Found) response, and shall not continue with the rest of the steps;\n4A)\tif the <IncomingOne-to-OneCommunicationList> element exists in the MCData user profile document with one or more <One-to-One-CommunicationListEntry> elements (see the MCData user profile document in 3GPP TS 24.484 [12]) and:\ni)\tif the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request does not match with the <entry> element of any of the <One-to-One-CommunicationListEntry> elements in the <IncomingOne-to-OneCommunicationList> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]); and\nii)\tif configuration is not set in the MCData user profile document that allows the MCData user to receive one-to-one MCData communication from any user (see <allow-one-to-one-communication-from-any-user> element in MCData user profile document in 3GPP TS 24.484 [12]);\nthen:\ni)\tshall reject the SIP INVITE request with a SIP 403 (Forbidden) response including warning text set to \"230 one-to-one MCData communication not authorised from this originating user\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n5)\tshall generate a SIP INVITE request accordance with 3GPP TS 24.229 [5];\n6)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n7)\tshall include the option tag \"timer\" in the Supported header field;\n8)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\";\nc)\tthe isfocus media feature tag;\nd)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the incoming SIP INVITE request; and\ne)\tany other uri-parameter provided in the Contact header field of the incoming SIP INVITE request;\n9)\tshall include in the SIP INVITE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP INVITE request;\n10)\tshall set the Request-URI of the outgoing SIP INVITE request to the public user identity associated to the MCData ID of the terminating MCData user;\n11)\tshall populate the outgoing SIP INVITE request with the MIME bodies that were present in the incoming SIP INVITE request;\n12)\tshall include a P-Asserted-Identity header field in the outgoing SIP INVITE request set to the public service identity of the participating MCData function;\n13)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received \"SIP INVITE request for standalone SDS over media plane for terminating participating MCData function\" as specified in clause 9.2.3.3.1; and\n14)\tshall send the SIP INVITE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n2)\tshall include in the SIP 200 (OK) response an SDP answer based on the SDP answer in the received SIP 200 (OK) response as specified in clause 9.2.3.3.2;\n3)\tshall include the option tag \"timer\" in a Require header field;\n4)\tshall include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If no \"refresher\" parameter was included in the SIP INVITE request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\n5)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\nc)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP INVITE request from the controlling MCData function;\n6)\tif the incoming SIP response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response.\n7)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function;\n8)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\n9)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.2.1.5; and\n10)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the controlling MCData function according to 3GPP TS 24.229 [5].\nWhen composing an SDP offer according to 3GPP TS 24.229 [5], IETF RFC 4975 [17], IETF RFC 6135 [19] and IETF RFC 6714 [20] the controlling MCData function:\n1)\tshall include an \"m=message\" media-level section for the MCData media stream received from the originating MCData client consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS;\nc)\ta format list field set to '*';\nd)\tan \"a=sendonly\" attribute;\ne)\tan \"a=path\" attribute containing its own MSRP URI;\nf)\tset the content type as \"a=accept-types:application/vnd.3gpp.mcdata-signalling application/vnd.3gpp.mcdata-payload\"; and\ng)\tset the a=setup attribute as \"actpass\".\nWhen composing the SDP answer according to 3GPP TS 24.229 [5], the controlling MCData function:\n1)\tshall include an \"m=message\" media-level section for the accepted MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS according to the received SDP offer;\nc)\ta format list field set to '*';\nd)\tan \"a=recvonly\" attribute;\ne)\tan \"a=path\" attribute containing its own MSRP URI;\nf)\tset the content type as a=accept-types: application/vnd.3gpp.mcdata-signalling application/vnd.3gpp.mcdata-payload; and\ng)\tset the a=setup attribute set to \"passive\" according to IETF RFC 6135 [19].\nThis clause describes the procedures for inviting an MCData user to an MCData session. The procedure is initiated by the controlling MCData function as the result of an action in clause 9.2.3.4.4.\nThe controlling MCData function:\n1)\tshall generate a SIP INVITE request according to 3GPP TS 24.229 [5];\n2)\tshall include the Supported header field set to \"timer\";\n3)\tshould include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38]. The refresher parameter shall be omitted;\n4)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n5)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n6)\tshall include a Referred-By header field with the public user identity of the inviting MCData client;\n7)\tshall include in the Contact header field an MCData session identity for the MCData session with the g.3gpp.mcdata.sds media feature tag, the isfocus media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" according to IETF RFC 3840 [16];\n8)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request:\na)\tthe <mcdata-request-uri> element set to the MCData ID of the terminating user; and\nb)\tthe <mcdata-calling-group-id> element set to the group identity;\n9)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated to the MCData user to be invited;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n10)\tshall set the P-Asserted-Identity header field to the public service identity of the controlling MCData function;\n11)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n12)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received SIP INVITE request from the originating client according to the procedures specified in clause 9.2.3.4.1; and\n13)\tshall send the SIP INVITE request towards the terminating client in accordance with 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response for the SIP INVITE request the controlling MCData function:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.3.1.\nNOTE 6:\tThe procedures executed by the controlling MCData function prior to sending a response to the inviting MCData client are specified in clause 9.2.3.4.4.\nIn the procedures in this clause:\n1)\tMCData ID in an incoming SIP INVITE request refers to the MCData ID of the originating user from the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request;\n2)\tgroup identity in an incoming SIP INVITE request refers to the group identity from the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request; and\n3)\tMCData ID in an outgoing SIP INVITE request refers to the MCData ID of the called user in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP INVITE request;\nUpon receipt of a \"SIP INVITE request for controlling MCData function for standalone SDS over media plane\", the controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n1A)\tif the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element that is set to the value \"true\", shall reject the SIP INVITE request with a SIP 403 (Forbidden) response with the warning text set to \"167 call is not allowed on the preconfigured group\" as specified in clause 4.9 \"Warning header field\" and shall skip the rest of this procedure;\n2)\tshall determine if the media parameters are acceptable and the MSRP URI is offered in the SDP offer and if not reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n3)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if:\na)\tan Accept-Contact header field does not include the g.3gpp.mcdata.sds media feature tag; or\nb)\tan Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\";\n4)\tshall cache SIP feature tags, if received in the Contact header field and if the specific feature tags are supported;\n5)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\n6)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"one-to-one-sds\" and the SIP INVITE request:\na)\tdoes not contain an application/resource-lists+xml MIME body or contains an application/resource-lists+xml MIME body with more than one <entry> element in the set of <list> elements in the <resource-lists> element, shall return a SIP 403 (Forbidden) response with the warning text set to \"204 unable to determine targeted user for one-to-one SDS\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\na1)\tif the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of an application/vnd.3gpp.mcdata-info+xml MIME body contains an <call-to-functional-alias-ind> element set to a value of \"true\":\ni)\tshall identify the MCData ID(s) of the MCData user(s) that have activated the called functional alias received in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the SIP INVITE request by performing the actions specified in clause 22.2.2.2.8, and:\nA)\tif unable to determine any MCData ID that has activated the called functional alias received in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the SIP INVITE, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response including warning text set to \"145 unable to determine called party\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps; and\nB)\tselects one of the identified MCData IDs, and shall send a SIP 300 (Multiple Choices) response to the SIP INVITE request populated according to 3GPP TS 24.229 [5], IETF RFC 3261 [4] with:\nI)\ta Contact header field containing a SIP URI for the MCData session identity; and\nII)\tan application/vnd.3gpp.mcdata-info MIME body with a <mcdata-request-uri> element set to the selected MCData ID  and shall not continue with the rest of the steps in this clause;\nNOTE 1:\tHow the controlling MCData function selects the appropriate MCData ID is implementation-specific.\nb)\tcontains an application/resource-lists+xml MIME body with exactly one <entry> element in the set of <list> elements in the <resource-lists> element, shall invite the MCData user identified by the \"uri\" attribute of the <entry> element in the <resource-lists> element of the application/resource-lists+xml MIME body, as specified in clause 9.2.3.4.3; and\nc)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.3.1;\n7)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"group-sds\":\na)\tshall retrieve the necessary group document(s) from the group management server for the group identity contained in the SIP INVITE request and carry out initial processing as specified in clause 6.3.3, and shall continue with the remaining steps if the procedures in clause 6.3.3 were successful;\nb)\tif the <on-network-disabled> element is present in the group document, shall send a SIP 403 (Forbidden) response with the warning text set to \"115 group is disabled\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nc)\tif the <entry> element of the <list> element of the <list-service> element in the group document does not contain an <mcdata-mcdata-id> element with a \"uri\" attribute matching the MCData ID of the originating user contained in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP INVITE request, shall send a SIP 403 (Forbidden) response with the warning text set to \"116 user is not part of the MCData group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nd)\tif the <list-service> element contains a <mcdata-allow-short-data-service> element in the group document set to a value of \"false\", shall send a SIP 403 (Forbidden) response with the warning text set to \"206 short data service not allowed for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\ne)\tif the <supported-services> element is not present in the group document or is present and contains a <service> element containing an \"enabler\" attribute which is not set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", shall send a SIP 488 (Not Acceptable) response with the warning text set to \"207 SDS services not supported for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nf)\tif the MCData server group SDS procedures in clause 11.1 indicate that the user identified by the MCData ID is not allowed to send group MCData communications on this group identity as determined by step 2) of clause 11.1, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response, with warning text set to \"201 user not authorised to transmit data on this group identity\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\ng)\tthe originating user identified by the MCData ID is not affiliated to the group identity contained in the SIP INVITE request, as specified in clause 6.3.5, shall return a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\nh)\tshall determine targeted group members for MCData communications by following the procedures in clause 6.3.4;\ni)\tif the procedures in clause 6.3.4 result in no affiliated members found in the selected MCData group, shall return a SIP 403 (Forbidden) response with the warning text set to \"198 no users are affiliated to this group\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\nj)\tshall invite each group member determined in step h) above, to the group session, as specified in clause 9.2.3.4.3; and\nk)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.3.1.\nUpon receiving a SIP 200 (OK) response for a SIP INVITE request as specified in clause 9.2.3.4.3 and if the MCData ID in the SIP 200 (OK) response matches to the MCData ID in the corresponding SIP INVITE request. the controlling MCData function:\n1)\tshall invoke the procedure in clause 6.3.7.1.23 with an indication that the applicable MCData subservice is Short Data Service using media, in order to generate a SIP 200 (OK) response to the received SIP INVITE request; and\n2)\tshall send the generated SIP 200 (OK) response to the inviting MCData client according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.2.4\tSDS session",
                            "text_content": "The procedures in the clauses of the parent clause are used by a MCData functional entity to establish:\n-\ta one-to-one SDS session; or\n-\ta group SDS session.\nThe procedures in the clauses of the parent clause are applicable to establish an on-demand SDS session.\nWhen composing an SDP offer according to 3GPP TS 24.229 [5], IETF RFC 4975 [17], IETF RFC 6135 [19] and IETF RFC 6714 [20] the MCData client:\n1)\tshall include an \"m=message\" media-level section for the MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS;\nc)\tan \"a=sendrecv\" attribute;\nd)\tan \"a=path\" attribute containing its own MSRP URI;\ne)\tset the content type as \"a=accept-types:application/vnd.3gpp.mcdata-signalling application/vnd.3gpp.mcdata-payload\"; and\nf)\tset the a=setup attribute as \"actpass\"; and\n2)\tif end-to-end security is required for a one-to-one communication and the security context does not exist or if the existing security context has expired, shall include the MIKEY-SAKKE I_MESSAGE in an \"a=key-mgmt\" attribute as a \"mikey\" attribute value in the SDP offer as specified in IETF RFC 4567 [45].\nWhen the MCData client receives an initial SDP offer for an MCData SDS session, the MCData client shall process the SDP offer and shall compose an SDP answer according to 3GPP TS 24.229 [5] and IETF RFC 4975 [17].\nWhen composing an SDP answer, the MCData client:\n1)\tshall include an \"m=message\" media-level section for the accepted MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS according to the received SDP offer;\nc)\tan \"a=sendrecv\" attribute;\nd)\tan \"a=path\" attribute containing its own MSRP URI;\ne)\tset the content type as a=accept-types: application/vnd.3gpp.mcdata-signalling application/vnd.3gpp.mcdata-payload; and\nf)\tset the a=setup attribute according to IETF RFC 6135 [19].\nThe MCData client shall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [5] with the clarifications given below.\nThe MCData client:\n1)\tshall include the g.3gpp.mcdata.sds media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in the Contact header field of the SIP INVITE request according to IETF RFC 3840 [16];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n3)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n4)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n5)\tshould include the \"timer\" option tag in the Supported header field;\n6)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n7)\tif a one-to-one SDS session is requested:\na0)\tif the MCData user has requested the origination of an MCData emergency one-to-one communication or is originating an MCData one-to-one communication and the MCData emergency state is already set, then:\ni)\tif this is an authorised request for an MCData emergency one-to-one communication as determined by the procedures of clause 6.2.8.3.1.1, shall comply with the procedures in clause 6.2.8.3.2; or\nii)\tif this is an unauthorised request for an MCData emergency one-to-one communication as determined in step i) above, should indicate to the MCData user that initiation of an MCData emergency one-to-one communication is not authorized and shall release the generated SIP INVITE request and end the procedure;\na)\tshall insert in the SIP INVITE request an application/resource-lists+xml MIME body with the MCData ID of the invited MCData user or the functional alias to be called in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, according to rules and procedures of IETF RFC 5366 [18];\nNOTE 0:\tThe MCData client indicates whether an MCData ID or a functional alias is to be called as specified in step 7) b) below.\nb)\tshall contain an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <request-type> element set to a value of \"one-to-one-sds-session\"; and\nii)\tan <anyExt> element containing:\nA)\tthe <call-to-functional-alias-ind> element set to \"true\" if the functional alias is used as a target of the call request;\nB)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP INVITE request, the <functional-alias-URI> element set to the URI of the used functional alias; and\nNOTE 0A:\tThe MCData client learns the functional aliases that are activated for an MCData ID from procedures specified in clause 22.2.1.3.\nC)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value;\nc)\tif an end-to-end security context needs to be established and the security context does not exist or if the existing security context has expired, then:\ni)\tif necessary, shall instruct the key management client to request keying material from the key management server as described in 3GPP TS 33.180 [26];\nii)\tshall use the keying material to generate a PCK as described in 3GPP TS 33.180 [26];\niii)\tshall use the PCK to generate a PCK-ID with the four most significant bits set to \"0001\" to indicate that the purpose of the PCK is to protect one-to-one communications and with the remaining twenty eight bits being randomly generated as described in 3GPP TS 33.180 [26];\niv)\tshall encrypt the PCK to a UID associated to the MCData client using the MCData ID of the invited user and a time related parameter as described in 3GPP TS 33.180 [26];\nv)\tshall generate a MIKEY-SAKKE I_MESSAGE using the encapsulated PCK and PCK-ID as specified in 3GPP TS 33.180 [26];\nvi)\tshall add the MCData ID of the originating MCData user to the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26]; and\nvii)\tshall sign the MIKEY-SAKKE I_MESSAGE using the originating MCData user's signing key provided in the keying material together with a time related parameter, and add this to the MIKEY-SAKKE payload, as described in 3GPP TS 33.180 [26]; and\nd)\tif the MCData emergency private communication state is set to either \"MDEPC 2: emergency-pc-requested\" or \"MDEPC 3: emergency-pc-granted\" or if the MCData emergency private priority state of this one-to-one communication is set to a value other than \"MDEPP 2: in-progress\" or \"MDEPP 3: confirm-pending\", shall execute the procedures in clause 6.2.8.3.3 to include the Resource-Priority header field;\n8)\tif a group SDS session is requested:\na)\tif the \"/<x>/<x>/Common/MCData/AllowedSDS\" leaf node present in the group document of the requested MCData group as specified in 3GPP TS 24.483 [42] is set to \"false\", shall reject the request to send SDS and not continue with the rest of the steps in this clause;\na1)\tif the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element that is set to the value \"true\":\ni)\tshould notify the MCData user that an SDS session is not allowed on this preconfigured group; and\nii)\tshall skip the rest of this procedure;\nb)\tshall contain in an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <request-type> element set to a value of \"group-sds-session\";\nii)\tthe <mcdata-request-uri> element set to the MCData group identity;\niii)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\nNOTE 1:\tThe MCData client does not include the MCData ID of the originating MCData user in the body, as this will be inserted into the body of the SIP INVITE request that is sent from the originating participating MCData function.\niv)\tif the MCData client is aware of active functional aliases, and an active functional alias is to be included in the SIP INVITE request, the <anyExt> element with the <functional-alias-URI> element set to the URI of the used functional alias;\nc)\tif the MCData user has requested the origination of an MCData emergency group communication or is originating an MCData pre-arranged group communication and the MCData emergency state is already set, the MCData client shall execute the procedures in clause 6.2.8.1.1;\nd)\tif the MCData user has requested the origination of an MCData imminent peril group communication, the MCData client shall execute the procedures in clause 6.2.8.1.9;\ne)\tif the MCData client emergency group state for this group is set to \"MDEG 2: in-progress\" or \"MDEG 4: confirm-pending\", the MCData client shall execute the procedures in clause 6.2.8.1.2 to include the Resource-Priority header field; and\nf)\tif the MCData client imminent peril group state for this group is set to \"MDIG 2: in-progress\" or \"MDIG 4: confirm-pending\", shall execute the procedures in clause 6.2.8.1.12 to include the Resource-Priority header field;\n9)\tshall set the Request-URI of the SIP INVITE request to the public service identity identifying the participating MCData function serving the MCData user;\nNOTE 2:\tThe MCData client is configured with public service identity identifying the participating MCData function serving the MCData user.\n10)\tmay include a P-Preferred-Identity header field in the SIP INVITE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n11)\tshall include an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 9.2.4.2.1; and\n12)\tshall send the SIP INVITE request towards the MCData server according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 183 (Session Progress) response to the SIP INVITE request, the MCData client:\n1)\tmay indicate the progress of the session establishment to the inviting MCData user.\nOn receipt of a SIP 2xx response to the SIP INVITE request, the MCData client:\n0)\tif the response is to a SIP INVITE request for an MCData emergency group communication or if an MCData imminent peril group communication shall perform the actions specified in clause 6.2.8.1.4;\n1)\tif the response is to a SIP INVITE request for an MCData emergency one-to-one communication, shall perform the actions specified in clause 6.2.8.3.4;\n2)\tshall send a SIP ACK request as specified in 3GPP TS 24.229 [5];\n3)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38]; and\n4)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.1.2.2.\nUpon receiving a SIP 300 (Multiple Choices) response to the SIP INVITE request the MCData client shall use the MCData ID contained in the <mcdata-request-uri> element of the received application/vnd.3gpp.mcdata-info MIME body as the MCData ID of the invited MCData user and shall generate an initial SIP INVITE request by following the UE originating session procedures specified in 3GPP TS 24.229 [5], with the clarifications given in this clause and with the following additional clarifications:\n1)\tshall insert in the newly generated SIP INVITE request an application/resource-lists+xml MIME body with the MCData ID of the invited MCData user in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body set to the value found in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info MIME body  in the received SIP 300 (Multiple Choices) response;\n2)\tshall not include a <call-to-functional-alias-ind> element into the <anyExt> element with the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\n3)\tshall include a <called-functional-alias-URI> element into the <anyExt> element with the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body with the target functional alias used in the initial SIP INVITE request for establishing a session for sending one-to-one standalone SDS message.\nOn receipt of a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request, the MCData client:\n0)\tif the response is to a SIP INVITE request for an MCData emergency group communication or an MCData imminent peril group communication, shall perform the actions specified in clause 6.2.8.1.5;\n1)\tif the response is to a SIP INVITE request for an MCData emergency one-to-one communication, shall perform the actions specified in clause 6.2.8.3.5;\n2)\tshall indicate to the MCData user that the SDS message could not be sent; and\n3)\tshall send a SIP ACK request as specified in 3GPP TS 24.229 [5].\nOn receipt of a SIP INFO request where the Request-URI contains an MCData session ID identifying an ongoing group session, the MCData client shall follow the actions specified in clause 6.2.8.1.13.\nOn receipt of a SIP INFO request where the Request-URI contains an MCData session ID identifying an ongoing one-to-one session, the MCData client shall follow the actions specified in clause 6.2.8.3.7.\nOn receipt of an indication from the media plane indicating that the SDS message was not sent successfully, the MCData client:\n1)\tshall generate a SIP BYE request according to 3GPP TS 24.229 [5] with:\na)\tReason code set to \"SIP\";\nb)\tcause set to \"480\"; and\nc)\ttext set to \"transmission failed\";\n2)\tshall set the Request-URI to the MCData session identity to release; and\n3)\tshall send a SIP BYE request towards MCData server according to 3GPP TS 24.229 [5].\nUpon receipt of a \"SIP INVITE request for SDS session for terminating MCData client\" request, the MCData client shall follow the procedures for termination of multimedia sessions in the IM CN subsystem as specified in 3GPP TS 24.229 [5] with the clarifications below.\nThe MCData client:\n1)\tmay reject the SIP INVITE request if any of the following conditions are met:\na)\tMCData client does not have enough resources to handle the communication;\nb)\tit is an emergency group SDS session request and the number of maximum simultaneous emergency group calls supported for the specific calling functional alias as specified in the <MaxSimultaneousEmergencyGroupCalls> element within the <FunctionalAliasList> list element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) has been reached; or\nc)\tany other reason outside the scope of this specification;\n2)\tif the SIP INVITE request is rejected in step 1), shall respond toward the participating MCData function either with an appropriate reject code as specified in 3GPP TS 24.229 [5] and warning texts as specified in clause 4.9 or with SIP 480 (Temporarily unavailable) response not including warning texts if the user is authorised to restrict the reason for failure and skip the rest of the steps of this clause;\n3)\tif the SDP offer of the SIP INVITE request contains an \"a=key-mgmt\" attribute field with a \"mikey\" attribute value containing a MIKEY-SAKKE I_MESSAGE:\na)\tshall extract the MCData ID of the originating MCData user from the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26];\nb)\tshall convert the MCData ID to a UID as described in 3GPP TS 33.180 [26];\nc)\tshall use the UID to validate the signature of the MIKEY-SAKKE I_MESSAGE as described in 3GPP TS 33.180 [26];\nd)\tif authentication verification of the MIKEY-SAKKE I_MESSAGE fails, shall reject the SIP INVITE request with a SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [45], and include warning text set to \"136 authentication of the MIKEY-SAKKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and not continue with rest of the steps in this clause; and\ne)\tif the signature of the MIKEY-SAKKE I_MESSAGE was successfully validated:\ni)\tshall extract and decrypt the encapsulated PCK using the terminating user's (KMS provisioned) UID key as described in 3GPP TS 33.180 [26]; and\nii)\tshall extract the PCK-ID, from the payload as specified in 3GPP TS 33.180 [26];\nNOTE:\tWith the PCK successfully shared between the originating MCData client and the terminating MCData client, both clients are able to create an end-to-end secure session.\n4)\tmay display to the MCData user one or more of the MCData ID of the inviting MCData user, the type of SDS request and the functional alias of the inviting MCData user, if provided;\n4A)\tif the SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing an <mcdata-Params> element containing an <mcdata-calling-group-id> element and containing a <request-type> element set to a value of \"group-sds-session\" and also containing an <emergency-ind> element set to a value of \"true\":\na)\tshould display to the MCData user an indication that this is a SIP INVITE request for an MCData emergency group communication and:\ni)\tshould display the MCData ID of the originator of the MCData emergency group communication contained in the <mcdata-calling-user-id> element of the <mcdata-Params> of the application/vnd.3gpp.mcdata-info+xml MIME body;\nii)\tshould display the MCData group identity of the group with the emergency condition contained in the <mcdata-calling-group-id> element of the <mcdata-Params> of the application/vnd.3gpp.mcdata-info+xml MIME body; and\niii)\tif the <alert-ind> element within the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body is set to \"true\", should display to the MCData user an indication of the MCData emergency alert and associated information;\nb)\tshall set the MCData emergency group state to \"MDEG 2: in-progress\";\nc)\tshall set the MCData imminent peril group state to \"MDIG 1: no-imminent-peril\"; and\nd)\tshall set the MCData imminent peril group communication state to \"MDIGC 1: imminent-peril-gc-capable\"; otherwise\n4B)\tif the SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing an <mcdata-Params> element containing an <mcdata-calling-group-id> element and containing a <request-type> element set to a value of \"group-sds-session\" and also containing an <imminentperil-ind> element set to a value of \"true\":\na)\tshould display to the MCData user an indication that this is a SIP INVITE request for an MCData imminent peril group communication and:\ni)\tshould display the MCData ID of the originator of the MCData imminent peril group communication contained in the <mcdata-calling-user-id> element of the <mcdata-Params> of the application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tshould display the MCData group identity of the group with the imminent peril condition contained in the <mcdata-calling-group-id> element of the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\nb)\tshall set the MCData imminent peril group state to \"MDIG 2: in-progress\";\n4C)\tif the SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element containing a <request-type> element set to a value of \"one-to-one-sds-session\" and also containing an <emergency-ind> element set to a value of \"true\":\na)\tshould display to the MCData user an indication that this is a SIP INVITE request for an MCData emergency private communication and:\ni)\tshould display the MCData ID of the originator of the MCData emergency private communication contained in the <mcdata-calling-user-id> element of the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tif the <alert-ind> element within the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body is set to \"true\", should display to the MCData user an indication of the MCData emergency alert and associated information; and\nb)\tshall set the MCData emergency private priority state to \"MDEPP 2: in-progress\" for this private communication;\n5)\tshall accept the SIP INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\n6)\tshall include the option tag \"timer\" in a Require header field of the SIP 200 (OK) response;\n7)\tshall include the Session-Expires header field in the SIP 200 (OK) response and start the SIP session timer according to IETF RFC 4028 [38]. The \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\n8)\tshall include the g.3gpp.mcdata.sds media feature tag in the Contact header field of the SIP 200 (OK) response;\n9)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in the Contact header field of the SIP 200 (OK) response;\n10)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5] with the clarifications given in clause 9.2.4.2.2; and\n11)if a SIP CANCEL request associated with the SIP INVITE request was received, shall execute the procedure in clause 6.2.8.4.1, otherwise shall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5].\nIf the SIP 200 (OK) response to the received SIP INVITE request was sent, on receipt of an SIP ACK message to the sent SIP 200 (OK) message, the MCData client:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.1.2.3.\nTo send a disposition notification after the media plane is released, the MCData client:\n1)\tshall follow the procedures described in clause 12.2.1.1.\nThe MCData client shall execute the procedure in clause 6.2.8.4.3.\nThe MCData client shall execute the procedure in clause 6.2.8.4.4.\nThe MCData client shall execute the procedure in clause 6.2.8.4.2.\nThe SDP offer is generated based on the received SDP offer. The SDP offer generated by the participating MCData function:\n1)\tshall contain only one SDP media-level section for SDS message as contained in the received SDP offer;and\n2)\tshall contain an \"a=key-mgmt\" attribute field with a \"mikey\" attribute value, if present in the received SDP offer.\nWhen composing the SDP offer according to 3GPP TS 24.229 [5], the participating MCData function:\n1)\tshall replace the IP address and port number for the offered media stream in the received SDP offer with the IP address and port number of the participating MCData function, if required; and\nNOTE 1:\tRequirements can exist for the participating MCData function to be always included in the path of the offered media stream, for example: for the support of features such as MBMS, lawful interception and recording. Other examples can exist.\nNOTE 2:\tIf the participating MCData function and the controlling MCData function are in the same MCData server, and the participating MCData function does not have a dedicated IP address or a dedicated port number for media stream, the replacement of the IP address or the port number is omitted.\n2)\tif the IP address is replaced, shall insert its MSRP URI before the MSRP URI in the \"a=path\" attribute in the SDP offer.\nWhen composing the SDP answer according to 3GPP TS 24.229 [5], the participating MCData function:\n1)\tshall replace the IP address and port number in the received SDP answer with the IP address and port number of the participating MCData function, for the accepted media stream in the received SDP offer, if required; and\nNOTE 1:\tRequirements can exist for the participating MCData function to be always included in the path of the offered media stream, for example: for the support of features such as MBMS, lawful interception and recording. Other examples can exist.\nNOTE 2:\tIf the participating MCData function and the controlling MCData function are in the same MCData server, and the participating MCData function does not have a dedicated IP address or a dedicated port number for media stream, the replacement of the IP address or the port number is omitted.\n2)\tif the IP address is replaced shall insert its MSRP URI before the MSRP URI in the \"a=path\" attribute in the SDP answer.\nUpon receipt of a \"SIP INVITE request for SDS session for originating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\nNOTE 1:\tif the SIP INVITE request contains an emergency indication set to a value of \"true\" and this is an authorised request for originating a priority communication as determined by clause “6.3.7.2.6; or” if the SIP INVITE request contains an imminent peril indication set to a value of \"true\" and this is an authorised request for initiating an imminent peril communication as determined by clause 6.3.7.2.4; then the participating MCData function can, according to local policy, choose to accept the request.\n2)\tshall determine the MCData ID of the calling user from the public user identity in the P-Asserted-Identity header field of the SIP INVITE request, and shall authorise the calling user;\nNOTE 2:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP INVITE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is:\na)\tset to a value of \"group-sds-session\", shall determine the public service identity of the controlling MCData function associated with the MCData group identity in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP INVITE request; or\nb)\tset to a value of \"one-to-one-sds-session\", shall determine the public service identity of the controlling MCData function hosting the one-to-one SDS session service for the calling user;\nNOTE 3:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 5:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 6:\tHow the participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 7:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n5)\tif unable to identify the controlling MCData function for SDS session, it shall reject the SIP INVITE request with a SIP 404 (Not Found) response with the warning text \"142 unable to determine the controlling function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n6)\tshall determine whether the MCData user identified by the MCData ID is authorised for MCData communications by following the procedures in clause 11.1;\n7)\tif the procedures in clause 11.1 indicate that the user identified by the MCData ID\na)\tis not allowed to send MCData communications as determined by step 1) of clause 11.1, shall reject the \"SIP INVITE request for SDS session for originating participating MCData function\" with a SIP 403 (Forbidden) response to the SIP INVITE request, with warning text set to \"221 user not authorised to initiate one-to-one SDS session\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\nb)\tis not allowed to initiate one-to-one MCData communications to the targeted user as determined by step 1a) of clause 11.1, shall reject the \"SIP INVITE request for SDS session for originating participating MCData function\" with a SIP 403 (Forbidden) response including warning text set to \"229 one-to-one MCData communication not authorised to the targeted user\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n7A)\tif the user identified by the MCData ID requests to initiate an emergency communication, but is not allowed to do so, as determined by executing the procedures in clause 6.3.7.2.6, shall reject the \"SIP INVITE request for SDS session for originating participating MCData function\" with a SIP 403 (Forbidden) response including warning text set to \"233 user not authorised to initiate emergency communication\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n7B)\tif the user identified by the MCData ID requests to initiate an imminent peril communication, but is not allowed to do so, as determined by executing the procedures in clause 6.3.7.2.4, shall reject the \"SIP INVITE request for SDS session for originating participating MCData function\" with a SIP 403 (Forbidden) response including warning text set to \"236 user not authorised to initiate imminent peril communication\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n8)\tshall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [5];\n9)\tshall include the option tag \"timer\" in the Supported header field;\n10)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n11)\tshall set the Request-URI of the outgoing SIP INVITE request to the public service identity of the controlling MCData function as determined by step 4) in this clause;\n11a)\tshall copy the application/vnd.3gpp.mcdata-info+xml MIME body from the incoming SIP INVITE request to the outgoing SIP INVITE request;\n12)\tshall include the MCData ID of the originating user in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP INVITE request;\n12A)\tif the incoming SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body that contains a <functional-alias-URI> element, shall check if the status of the functional alias is activated for the MCData ID. If the functional alias status is activated, then the participating MCData function shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request to the received value, otherwise shall not include a <functional-alias-URI> element;\n13)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP INVITE request;\n14)\tshall include a P-Asserted-Identity header field in the outgoing SIP INVITE request set to the public service identity of the participating MCData function;\n15)\tshall include a Resource-Priority header field according to rules and procedures of 3GPP TS 24.229 [5] set to the value indicated in the Resource-Priority header field, if included in the SIP INVITE request from the MCData client;\n16)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received SIP INVITE request from the MCData client as specified in clause 9.2.4.3.1; and\n17)\tshall send the SIP INVITE request as specified to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the SIP INVITE request in step 16):\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n2)\tshall include in the SIP 200 (OK) response an SDP answer as specified in the clause 9.2.4.3.2;\n3)\tshall include the option tag \"timer\" in a Require header field;\n4)\tshall include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If the \"refresher\" parameter is not included in the received request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uac\";\n5)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\nc)\tthe isfocus media feature tag;\n6)\tshall include Warning header field(s) that were received in the incoming SIP 200 (OK) response;\n7)\tshall include an MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP 200 (OK) response;\n8)\tif the incoming SIP 200 (OK) response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response.\n9)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function; and\n10)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.2.2.4;\n11)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5]; and\n12)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the SIP INVITE request in step 16) the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a \"SIP INVITE request for SDS session for terminating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\nNOTE:\tIf the SIP INVITE request contains an emergency indication or an imminent peril indication set to a value of \"true\", the participating MCData function can, according to local policy, choose to accept the request even if the maximum number of acceptable communications is exceeded.\n2)\tshall check the presence of the isfocus media feature tag in the URI of the Contact header field and if it is not present then the participating MCData function shall reject the request with a SIP 403 (Forbidden) response with the warning text set to \"104 isfocus not assigned\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\n3)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request to retrieve the binding between the MCData ID and public user identity of the terminating MCData user;\n4)\tif the binding between the MCData ID and public user identity of the terminating MCData user does not exist, then the participating MCData function shall reject the SIP INVITE request with a SIP 404 (Not Found) response, and shall not continue with the rest of the steps;\n4A)\tif the <IncomingOne-to-OneCommunicationList> element exists in the MCData user profile document with one or more <One-to-One-CommunicationListEntry> elements (see the MCData user profile document in 3GPP TS 24.484 [12]) and:\ni)\tif the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request does not match with the <entry> element of any of the <One-to-One-CommunicationListEntry> elements in the <IncomingOne-to-OneCommunicationList> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]); and\nii)\tif configuration is not set in the MCData user profile document that allows the MCData user to receive one-to-one MCData communication from any user (see <allow-one-to-one-communication-from-any-user> element in MCData user profile document in 3GPP TS 24.484 [12]);\nthen:\ni)\tshall reject the SIP INVITE request with a SIP 403 (Forbidden) response including warning text set to \"230 one-to-one MCData communication not authorised from this originating user\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n5)\tshall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [5];\n6)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n7)\tshall include the option tag \"timer\" in the Supported header field;\n8)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\";\nc)\tthe isfocus media feature tag;\nd)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the incoming SIP INVITE request; and\ne)\tany other uri-parameter provided in the Contact header field of the incoming SIP INVITE request;\n9)\tshall include in the SIP INVITE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP INVITE request;\n10)\tshall set the Request-URI of the outgoing SIP INVITE request to the public user identity associated to the MCData ID of the terminating MCData user;\n11)\tshall populate the outgoing SIP INVITE request with the MIME bodies that were present in the incoming SIP INVITE request;\n12)\tshall include a P-Asserted-Identity header field in the outgoing SIP INVITE request set to the public service identity of the participating MCData function;\n13)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received \"SIP INVITE request for SDS session for terminating participating MCData function\" as specified in clause 9.2.4.3.1; and\n14)\tshall send the SIP INVITE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n2)\tshall include in the SIP 200 (OK) response an SDP answer based on the SDP answer in the received SIP 200 (OK) response as specified in clause 9.2.4.3.2;\n3)\tshall include the option tag \"timer\" in a Require header field;\n4)\tshall include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If no \"refresher\" parameter was included in the SIP INVITE request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\n5)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\nc)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP INVITE request from the controlling MCData function;\n6)\tif the incoming SIP response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response.\n7)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function;\n8)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38].\n9)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.2.2.5; and\n10)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the controlling MCData function according to 3GPP TS 24.229 [5].\nThe participating MCData function shall execute the procedure in clause 6.3.7.1.18.\nThe participating MCData function shall execute the procedure in clause 6.3.7.1.17.\nWhen composing an SDP offer according to 3GPP TS 24.229 [5], IETF RFC 4975 [17], IETF RFC 6135 [19] and IETF RFC 6714 [20] the controlling MCData function:\n1)\tshall include an \"m=message\" media-level section for the MCData media stream received from the originating MCData client consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS;\nc)\tan \"a=sendrecv\" attribute;\nd)\tan \"a=path\" attribute containing its own MSRP URI;\ne)\tset the content type as \"a=accept-types:application/vnd.3gpp.mcdata-signalling application/vnd.3gpp.mcdata-payload\"; and\nf)\tset the a=setup attribute as \"actpass\".\nWhen composing the SDP answer according to 3GPP TS 24.229 [5], the controlling MCData function:\n1)\tshall include an \"m=message\" media-level section for the accepted MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS according to the received SDP offer;\nc)\tan \"a=sendrecv\" attribute;\nd)\tan \"a=path\" attribute containing its own MSRP URI;\ne)\tset the content type as a=accept-types: application/vnd.3gpp.mcdata-signalling application/vnd.3gpp.mcdata-payload; and\nf)\tset the a=setup attribute set to \"passive\" according to IETF RFC 6135 [19].\nThis clause describes the procedures for inviting an MCData user to an MCData session. The procedure is initiated by the controlling MCData function as the result of:\n-\tan action in clause 9.2.4.4.4; or\n-\tfor group SDS session, when an MCData client successfully affiliates the MCData group after the SDS session has been established.\nThe controlling MCData function:\n1)\tshall generate a SIP INVITE request as specified in 3GPP TS 24.229 [5] with an application/vnd.3gpp.mcdata-info+xml MIME body included;\n1A)\tif the received SIP INVITE request contains an authorised request for an MCData emergency communication as determined by clause 6.3.7.2.6, shall, in the generated SIP INVITE request:\na)\tset the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body to a value of \"true\";\nb)\tinclude a Resource-Priority header field populated with the values for an MCData emergency communication as specified in clause 6.3.7.1.4;\nc)\tif the <alert-ind> element is set to \"true\" in the received SIP INVITE request and the initiation of MCData emergency alerts is authorized, as determined by the procedures of clause 6.3.7.2.1, populate the application/vnd.3gpp.mcdata-info+xml MIME body and the application/vnd.3gpp.mcdata-location-info+xml MIME body as specified in clause 6.3.7.1.3. Otherwise, set the <alert-ind> element to a value of \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body;\nd)\tfor a group communication, if the in-progress imminent peril state of the group is set to a value of \"true\", include in the application/vnd.3gpp.mcdata-info+xml MIME body an <imminentperil-ind> element set to a value of \"false\"; and\nNOTE 1:\tIf the imminent peril state of the group is true at this point, the controlling function will set it to false as part of the calling procedure.\ne)\tset the <request-type> element of the application/vnd.3gpp.mcdata-info+xml MIME body to the value of the <request-type> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the received SIP INVITE request;\n1B)\tfor a group communication, if the in-progress emergency state of the group is set to a value of \"false\" and the in-progress imminent peril state of the group is set to a value of \"true\", the controlling MCData function:\na)\tshall include a Resource-Priority header field populated with the values for an MCData imminent peril group communication as specified in clause 6.3.7.1.4; and\nb)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <imminentperil-ind> element set to a value of \"true\".\n2)\tshall include the Supported header field set to \"timer\";\n3)\tshould include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38]. The refresher parameter shall be omitted;\n4)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n5)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n6)\tshall include a Referred-By header field with the public user identity of the inviting MCData client;\n7)\tshall include in the Contact header field an MCData session identity for the MCData session with the g.3gpp.mcdata.sds media feature tag, the isfocus media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" according to IETF RFC 3840 [16];\n8)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request:\na)\tthe <mcdata-request-uri> element set to the MCData ID of the terminating user;\nb)\tthe <mcdata-calling-group-id> element set to the group identity if the request is for group sds; and\nc)\tthe <mcdata-calling-user-id> element set to the calling user MCData ID;\n9)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated to the MCData user to be invited;\nNOTE 2:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 4:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 5:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 6:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n10)\tshall set the P-Asserted-Identity header field to the public service identity of the controlling MCData function;\n11)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n12)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received SIP INVITE request from the originating client according to the procedures specified in clause 9.2.4.4.1; and\n13)\tshall send the SIP INVITE request towards the terminating client in accordance with 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response for the SIP INVITE request the controlling MCData function:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.3.2.\nNOTE 7:\tThe procedures executed by the controlling MCData function prior to sending a response to the inviting MCData client are specified in clause 9.2.4.4.4.\nIn the procedures in this clause:\n1)\tMCData ID in an incoming SIP INVITE request refers to the MCData ID of the originating user from the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request;\n2)\tgroup identity in an incoming SIP INVITE request refers to the group identity from the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request; and\n3)\tMCData ID in an outgoing SIP INVITE request refers to the MCData ID of the called user in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP INVITE request;\nUpon receipt of a \"SIP INVITE request for controlling MCData function for SDS session\", the controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\nNOTE:\tIf the SIP INVITE request contains an emergency indication or an imminent peril indication set to a value of \"true\" and this is an authorised request originating an MCData emergency group communication as determined by clause 6.3.7.2.6, or for originating an MCData imminent peril group communication as determined by clause 6.3.7.2.4, the controlling MCData function can, according to local policy, choose to accept the request.\n2)\tshall determine if the media parameters are acceptable and the MSRP URI is offered in the SDP offer and if not reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n3)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if:\na)\tan Accept-Contact header field does not include the g.3gpp.mcdata.sds media feature tag; or\nb)\tan Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\";\n3A)\tif the received SIP INVITE request includes an application/vnd.3gpp.mcdata-info+xml MIME body with an <emergency-ind> element included or an <imminentperil-ind> element included, shall validate the request as described in clause 6.3.7.1.9;\n3B)\tif the SIP INVITE request contains an unauthorised request for an MCData emergency communication as determined by clause 6.3.7.2.6:\na)\tshall reject the SIP INVITE request with a SIP 403 (Forbidden) response as specified in clause 6.3.7.2.7; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [5] and skip the rest of the steps;\n3C)\tif the SIP INVITE request contains an unauthorised request for an MCData imminent peril group communication as determined by clause 6.3.7.2.4, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response with the following clarifications:\na)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcdata-info+xml MIME body as specified in clause D.1 with the <mcdatainfo> element containing the <mcdata-Params> element with the <imminentperil-ind> element set to a value of \"false\"; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [5] and skip the rest of the steps;\n3D)\tif a Resource-Priority header field is included in the SIP INVITE request:\na)\tif the Resource-Priority header field is set to the value indicated for emergency communications and the SIP INVITE request does not contain an emergency indication and the in-progress emergency state of the group is set to a value of \"false\", shall reject the SIP INVITE request with a SIP 403 (Forbidden) response and skip the rest of the steps; or\nb)\tif the Resource-Priority header field is set to the value indicated for imminent peril communications and the SIP INVITE request does not contain an imminent peril indication and the in-progress imminent peril state of the group is set to a value of \"false\", shall reject the SIP INVITE request with a SIP 403 (Forbidden) response and skip the rest of the steps;\n4)\tshall cache SIP feature tags, if received in the Contact header field and if the specific feature tags are supported;\n5)\tvoid;\n6)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\n7)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"one-to-one-sds-session\" and the SIP INVITE request:\na)\tdoes not contain an application/resource-lists+xml MIME body or contains an application/resource-lists+xml MIME body with more than one <entry> element in the set of <list> elements in the <resource-lists> element, shall return a SIP 403 (Forbidden) response with the warning text set to \"204 unable to determine targeted user for one-to-one SDS\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\na1)\tif the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of an application/vnd.3gpp.mcdata-info+xml MIME body contains an <call-to-functional-alias-ind> element set to a value of \"true\":\ni)\tshall identify the MCData ID(s) of the MCData user(s) that have activated the received called functional alias in the MIME resource-lists body of the SIP INVITE request by performing the actions specified in clause 22.2.2.2.8, and:\nA)\tif unable to determine any MCData IDthat hasactivated the called functional alias received in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the SIP INVITE request, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response including warning text set to \"145 unable to determine called party\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps; and\nB)\tselects one of the identified MCData IDs, and shall send a SIP 300 (Multiple Choices) response to the SIP INVITE request populated according to 3GPP TS 24.229 [5], IETF RFC 3261 [4] with:\nI)\ta Contact header field containing a SIP URI for the MCData session identity; and\nII)\tan application/vnd.3gpp.mcdata-info MIME body with a <mcdata-request-uri> element set to the selected MCData ID and shall not continue with the rest of the steps in this clause;\nNOTE 1:\tHow the controlling MCData function selects the appropriate MCData ID is implementation-specific.\nb)\tcontains an application/resource-lists+xml MIME body with exactly one <entry> element in the set of <list> elements in the <resource-lists> element, shall invite the MCData user identified by the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, as specified in clause 9.2.4.4.3; and\nc)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.3.2;\n8)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"group-sds-session\":\na)\tshall retrieve the necessary group document(s) from the group management server for the group identity contained in the SIP INVITE request and carry out initial processing as specified in clause 6.3.3, and shall continue with the remaining steps if the procedures in clause 6.3.3 were successful;\nb)\tif the <on-network-disabled> element is present in the group document, shall send a SIP 403 (Forbidden) response with the warning text set to \"115 group is disabled\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nb1)\tif the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element that is set to the value \"true\", shall reject the SIP INVITE request with a SIP 403 (Forbidden) response with the warning text set to \"167 call is not allowed on the preconfigured group\" as specified in clause 4.9 \"Warning header field\" and shall skip the rest of this procedure;\nc)\tif the <entry> element of the <list> element of the <list-service> element in the group document does not contain an <mcdata-mcdata-id> element with a \"uri\" attribute matching the MCData ID of the originating user contained in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP INVITE request, shall send a SIP 403 (Forbidden) response with the warning text set to \"116 user is not part of the MCData group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nd)\tif the <list-service> element contains a <mcdata-allow-short-data-service> element in the group document set to a value of \"false\", shall send a SIP 403 (Forbidden) response with the warning text set to \"206 short data service not allowed for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\ne)\tif the <supported-services> element is not present in the group document or is present and contains a <service> element containing an \"enabler\" attribute which is not set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", shall send a SIP 488 (Not Acceptable) response with the warning text set to \"207 SDS services not supported for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nf)\tif the MCData server group SDS procedures in clause 11.1 indicate that the user identified by the MCData ID is not allowed to send group MCData communications on this group identity as determined by step 2) of clause 11.1, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response, with warning text set to \"222 user not authorised to initiate group SDS session on this group identity\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\ng)\tif the originating user identified by the MCData ID is not affiliated to the group identity contained in the SIP INVITE request, as specified in clause 6.3.5, shall return a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\nh)\tshall determine targeted group members for MCData communications by following the procedures in clause 6.3.4;\ni)\tif the procedures in clause 6.3.4 result in no affiliated members found in the selected MCData group, shall return a SIP 403 (Forbidden) response with the warning text set to \"198 no users are affiliated to this group\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\nj)\tshall invite each group member determined in step g) above, to the group session, as specified in clause 9.2.4.4.3; and\nk)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.3.2.\nUpon receiving a SIP 200 (OK) response for a SIP INVITE request as specified in clause 9.2.4.4.3 and, if the MCData ID in the SIP 200 (OK) response matches to the MCData ID in the corresponding SIP INVITE request, the controlling MCData function:\n1)\tshall invoke the procedure in clause 6.3.7.1.23 with an indication that the applicable MCData subservice is Short Data Service using session, in order to generate a SIP 200 (OK) response to the received SIP INVITE request according to 3GPP TS 24.229 [5];\n2)\tif the received SIP INVITE request contains an alert indication set to a value of \"true\" and this is an unauthorised request for an MCData emergency alert as specified in clause 6.3.7.2.1, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in clause 4.9;\n3)\tif the received SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\" and if the in-progress emergency state of the group is set to a value of \"true\", shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in clause 4.9; and\n4)\tshall send the generated SIP 200 (OK) response to the inviting MCData client according to 3GPP TS 24.229 [5].\nThe controlling MCData function shall execute the procedure in clause 6.3.7.1.19, with an indication that the applicable MCData subservice is Short Data Service using session.\nThe controlling MCData function shall execute the procedure in clause 6.3.7.1.20, with an indication that the applicable MCData subservice is Short Data Service using session.\nThe controlling MCData function shall execute the procedure in clause 6.3.7.1.21.\nThe controlling MCData function shall execute the procedure in clause 6.3.7.1.22.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.2.5\tSDS communication using pre-established session",
                            "text_content": "This clause is referenced from other procedures.\nWhen generating an initial SIP INVITE request according to 3GPP TS 24.229 [5], on receipt of an incoming SIP REFER request, the participating MCData function:\n1)\tshall include in the SIP INVITE request all header fields included in the headers portion of the SIP URI contained in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists MIME+xml body, referenced by the \"cid\" URL in the Refer-To header field in the incoming SIP REFER request;\n2)\tshould include the Session-Expires header field according to IETF RFC 4028 [38].\n3)\tshall include the option tag \"timer\" in the Supported header field;\n4)\tshall include a P-Asserted-Identity header field in the outgoing SIP INVITE request set to the public service identity of the participating MCData function;\n5)\tshall include the g.3gpp.mcdata.sds media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" into the Contact header field of the outgoing SIP INVITE request;\n6)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP INVITE request;\n7)\tshall include in the SIP INVITE request the option tag \"tdialog\" in a Supported header field according to the rules and procedures of IETF RFC 4538 [54];\n8)\tshall include in the SIP INVITE request an SDP offer as specified in clause 9.2.3.3.1 based upon:\na)\tthe SDP negotiated during the pre-established session establishment and any subsequent pre-established session modification; and\nb)\tthe SDP offer (if any) included in the\"body\" URI parameter of the SIP URI contained in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, referenced by the \"cid\" URL in the Refer-To header field in the incoming SIP REFER request for a pre-established session;\n9)\tshall copy the application/vnd.3gpp.mcdata-info+xml MIME body from the \"body\" URI parameter of the SIP URI in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element in the application/resource-lists+xml MIME body, referenced by the \"cid\" URL in the Refer-To header field of the SIP REFER request, to the outgoing SIP INVITE request;\n9A)\tif the incoming SIP REFER request contained a <functional-alias-URI> element in an application/vnd.3gpp.mcdata-info+xml MIME body in the hname \"body\" parameter in the headers portion of the SIP URI in the Refer-To header field, shall check if the status of the functional alias is activated for the MCData ID. If the functional alias status is activated, then the participating MCData function shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request to the received value, otherwise shall not include a <functional-alias-URI> element; and\n10)\tif the incoming SIP REFER request contained an application/resource-lists+xml MIME body in the \"body\" URI parameter of the SIP URI contained in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of an application/resource-lists MIME+xml body, referenced by the \"cid\" URL in the Refer-To header field, shall copy the application/resources-lists MIME+xml body in the \"body\" URI parameter to the SIP INVITE request.\nThis clause is referenced from other procedures.\nThe participating MCData function:\n1)\tshall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5] to be sent within the SIP dialog of the pre-established session;\n2)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing Re-INVITE request:\na)\tthe <mcdata-communication-state> element with a value set to \"establish-success\", if a SIP 2xx response is received to a SIP INVITE request sent to the controlling MCData function; or\nb)\tthe <mcdata-communication-state> element with a value set to \"establish-fail\", if an error response is received to a SIP INVITE request sent to the controlling MCData function;\nThis clause is referenced from other procedures.\nThe participating MCData function:\n1)\tshall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5] to be sent within the SIP dialog of the pre-established session;\n2)\tshould include the Session-Expires header field according to IETF RFC 4028 [38].\n3)\tshall include the option tag \"timer\" in the Supported header field;\n4)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n5)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n6)\tshall include in the Contact header field an MCData session identity for the MCData session with the g.3gpp.mcdata.sds media feature tag, the isfocus media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" according to IETF RFC 3840 [16];\nThe procedures in this clause are used to initiate one-to-one standalone SDS using media plane or one-to-one SDS session within the pre-established session.\n9.2.5.2.1.1\tClient originating procedures\nUpon receiving a request from an MCData user to initiate one-to-one standalone SDS using media plane or one-to-one SDS session within the pre-established session:\nIf the MCData user has requested the origination of an MCData emergency one-to-one communication or the MCData emergency state is already set, but this is an unauthorised request for an MCData emergency one-to-one communication as determined by the procedures of clause 6.2.8.3.1.1, the MCData client should indicate to the MCData user that they are not authorised to initiate an MCData emergency one-to-one communication and shall exit the procedure.\nThe MCData client shall generate a SIP REFER request outside a dialog as specified in IETF RFC 3515 [51] as updated by IETF RFC 6665 [36] and IETF RFC 7647 [52], and in accordance with the UE procedures specified in 3GPP TS 24.229 [5].\nThe MCData client:\n1)\tshall set the Request URI of the SIP REFER request to the session identity of the pre-established session;\n1a)\tIf the MCData user has requested the origination of an MCData emergency one-to-one communication or the MCData emergency state is already set:\na)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body in the SIP REFER request; and\nb)\tshall execute the procedures in clause 6.2.8.3.2;\n2)\tshall set the Refer-To header field of the SIP REFER request as specified in IETF RFC 3515 [51] with a Content-ID (\"cid\") Uniform Resource Locator (URL) as specified in IETF RFC 2392 [33] that points to an application/resource-lists+xml MIME body as specified in IETF RFC 5366 [18], and with the Content-ID header field set to this \"cid\" URL;\n3)\tif an end-to-end security context needs to be established and the security context does not exist or if the existing security context has expired, then:\ni)\tif necessary, shall instruct the key management client to request keying material from the key management server as described in 3GPP TS 33.180 [26];\nii)\tshall use the keying material to generate a PCK as described in 3GPP TS 33.180 [26];\niii)\tshall use the PCK to generate a PCK-ID with the four most significant bits set to \"0001\" to indicate that the purpose of the PCK is to protect one-to-one communications and with the remaining twenty eight bits being randomly generated as described in 3GPP TS 33.180 [26];\niv)\tshall encrypt the PCK to a UID associated to the MCData client using the MCData ID of the invited user and a time related parameter as described in 3GPP TS 33.180 [26];\nv)\tshall generate a MIKEY-SAKKE I_MESSAGE using the encapsulated PCK and PCK-ID as specified in 3GPP TS 33.180 [26];\nvi)\tshall add the MCData ID of the originating MCData user to the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26]; and\nvii)\tshall sign the MIKEY-SAKKE I_MESSAGE using the originating MCData user's signing key provided in the keying material together with a time related parameter, and add this to the MIKEY-SAKKE payload, as described in 3GPP TS 33.180 [26];\n4)\tshall include in the application/resource-lists MIME+xml body a single <entry> element in a <list> element in the <resource-lists> element where the <entry> element contains a \"uri\" attribute set to MCData ID of the called user or the functional alias to be called, extended with the following parameters in the headers portion of the SIP URI:\nNOTE 1:\tCharacters that are not formatted as ASCII characters are escaped in the following parameters in the headers portion of the SIP URI.\nNOTE 2:\tThe MCData client indicates whether an MCData ID or a functional alias is to be called as specified in step 4) a) ii) D).\na)\tan hname \"body\" parameter populated with:\ni)\tan application/sdp MIME body containing an SDP offer with media attributes specified in clause 9.2.3.2.1 if a one-to-one standalone SDS message is requested or clause 9.2.4.2.1 if a one-to-one SDS session is requested; and\nii)\tan application/vnd.3gpp.mcdata-info MIME body with:\nA)\tif a one-to-one standalone SDS message is requested, the <request-type> element set to a value of \"one-to-one-sds\". If a one-to-one SDS session is requested, the <request-type> element set to a value of \"one-to-one-sds-session\";\nB)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\nC)\tan <anyExt> element containing:\nI)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP REFER request, the <functional-alias-URI> element set to the URI of the used functional alias;\nII)\twith the <call-to-functional-alias-ind> element set to \"true\" if the  functional alias is used as a target of the call request; and\nIII)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value;\n5)\tshall include a P-Preferred-Service header field set to the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), according to IETF RFC 6050 [7];\n6)\tmay include a P-Preferred-Identity header field in the SIP REFER request containing a public user identity as specified in 3GPP TS 24.229 [5];\n7)\tshall include the following according to IETF RFC 4488 [53]:\na)\tthe option tag \"norefersub\" in the Supported header field; and\nb)\tthe value \"false\" in the Refer-Sub header field;\n8)\tshall include a Target-Dialog header field as specified in IETF RFC 4538 [54] identifying the pre-established session;\n9)\tshall include the g.3gpp.mcdata.sds media feature tag in the Contact header field of the SIP REFER request according to IETF RFC 3840 [16]; and\n10)\tshall send the SIP REFER request according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 300 (Multiple Choices) response to the SIP REFER request the MCData client shall use the MCData ID of MCData user contained in the <mcdata-request-uri> element of the received  application/vnd.3gpp.mcdata-info MIME body as the MCData ID of the invited MCData user and shall generate a SIP REFER request outside a dialog in accordance with the procedures specified in 3GPP TS 24.229 [5], IETF RFC 4488 [53] and IETF RFC 3515 [51] as updated by IETF RFC 6665 [36] and IETF RFC 7647 [52], with the clarifications given below in this clause with following additional clarifications:\n1)\tshall insert in the newly generated SIP REFER request an application/resource-lists+xml MIME body with the MCData ID of the invited MCData user in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body where the MCData ID is found in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info MIME body in the received SIP 300 (Multiple Choices) response to the initial SIP REFER request;\n2)\tshall not include an <call-to-functional-alias-ind> element into the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\n3)\tshall include a <called-functional-alias-URI> element into the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body with the target functional alias URI used in the initial SIP REFER request for establishing a private call.\nOn receiving a final SIP 2xx response to the SIP REFER request, the MCData client:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15].\nOn receiving a SIP 4xx response, SIP 5xx response or a SIP 6xx response to the SIP REFER request for an MCData emergency one-to-one communication:\n1)\tif the MCData emergency private communication state is set to \"MDEPC 2: emergency-pc-requested\", the MCData client shall perform the actions specified in clause 6.2.8.3.5; and\n2)\tshall skip the remaining steps.\nOn receiving a SIP re-INVITE request within the pre-established session targeted by the sent SIP REFER request, the MCData client:\n1)\tif the <mcdata-communication-state> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP re-INVITE request is set to a value of \"establish-success\":\ni)\tshall notify the MCData user about the successful MCData communication establishment;\n2)\tif the <mcdata-communication-state> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP re-INVITE request is set to a value of \"establish-fail\":\ni)\tshall notify the MCData user about the MCData communication establishment failure, restore the state variables to the values they held prior to the processing of the origination attempt and exit the procedure;\n3)\tif the sent SIP REFER request was a request for an MCData emergency one-to-one communication:\na)\tif the MCData emergency private communication state is set to \"MDEPC 2: emergency-pc-requested\" or \"MDEPC 3: emergency-pc-granted\":\ni)\tshall set the MCData emergency private priority state of the communication to \"MDEPP 2: in-progress\" if it was not already set;\nii)\tshall set the MCData emergency private communication state to \"MDEPC 3: emergency-pc-granted\"; and\niii)\tif the MCData private emergency alert state is set to \"MDPEA 2: emergency-alert-confirm-pending\":\nA)\tif the received SIP re-INVITE request contains an <alert-ind> element set to a value of \"true\" or does not contain an <alert-ind> element, shall set the MCData private emergency alert state to \"MDPEA 3: emergency-alert-initiated\"; and\nB)\tif the received SIP re-INVITE request contains an <alert-ind> element set to a value of \"false\", shall set the MCData private emergency alert state to \"MDPEA 1: no-alert \"; and\n4)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15].\nOn communication release, if the sent SIP REFER request was a request for an MCData emergency one-to-one communication, the MCData client shall perform the procedures specified in clause 6.2.8.1.18.\n9.2.5.2.1.2\tClient terminating procedures\nUpon receiving a SIP re-INVITE request within a pre-established session, the MCData client:\nEditor's note: The ability of the terminating client to determine if there is an associated session or not needs to be verified.\n1)\tif the pre-established session has an associated MCData one-to-one communication session, shall execute the procedure in clause 6.2.8.4.2; or\n2)\tif the pre-established session does not have an associated MCData session and the <mcdata-communication-state> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP re-INVITE request is set to a value of \"establish-request\":\ni)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP re-INVITE request is set to a value of \"one-to-one-sds\", shall follow the procedures in clause 9.2.3.2.4; and\nii)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP re-INVITE request is set to a value of \"one-to-one-sds-session\", shall follow the procedures in clause 9.2.4.2.4.\n9.2.5.2.1.3\tMCData client initiates cancellation for an in-progress emergency SDS communication using pre-established session\nThe MCData client shall execute the procedure in clause 6.2.8.4.3.\n9.2.5.2.1.4\tMCData client initiates upgrade for an ongoing SDS communication using pre-estalished session\nThe MCData client shall execute the procedure in clause 6.2.8.4.4.\n9.2.5.2.1.5\tTerminating procedures for MCData client using pre-established session to upgrade or cancel an existing emergency one-to-one SDS communication\nThe MCData client shall execute the procedure in clause 6.2.8.4.2.\n9.2.5.2.2.1\tOriginating procedures\nEditor's note:\tClarifications on the identity of the pre-established session may be necessary.\nUpon receiving a SIP REFER request, with:\n1)\tthe Request-URI set to a public service identity identifying the pre-established session on the participating MCData function;\n2)\tthe Refer-To header field containing a Content-ID (\"cid\") URL as specified in IETF RFC 2392 [33] that points to an application/resource-lists+xml MIME body as specified in IETF RFC 5366 [18] containing one or more <entry> elements in one or more <list> elements in the <resource-lists> element where each <entry> element contains a \"uri\" attribute containing a SIP URI set to the MCData ID of the called user(s);\n3)\tan hname \"body\" parameter in the headers portion of the SIP URI specified above containing an application/vnd.3gpp.mcdata-info MIME body with the <request-type> element set to \"one-to-one-sds\" or \"one-to-one-sds-session\"; and\n4)\ta Content-ID header field set to the \"cid\" URL;\nthe participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP REFER request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\nNOTE 1:\tIf the application/vnd.3gpp.mcdata-info MIME body included in the SIP REFER request contains an <emergency-ind> element or <imminentperil-ind> element set to a value of \"true\", and this is an authorised request for originating a priority communication, as determined by clause 6.3.7.2.6 or by clause 6.3.7.2.4, the participating MCData function can, according to local policy, choose to accept the request.\n2)\tshall determine the MCData ID of the calling user from public user identity in the P-Asserted-Identity header field of the SIP REFER request;\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP REFER request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps;\n4)\tshall determine whether the MCData user identified by the MCData ID is authorised for MCData communications, as follows:\ni)\tif the procedures in clause 11.1 indicate that the user identified by the MCData ID is not allowed to initiate MCData communications, shall reject the SIP REFER request with a SIP 403 (Forbidden) response with warning text set to \"200 user not authorised to transmit data\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\nii)\tif the MCData user is not allowed to initiate emergency MCData communications, as determined in clause 6.3.7.2.6, shall reject the SIP request with a SIP 403 (Forbidden) response including warning text set to \"233 user not authorised to initiate emergency communication\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps; and\niii)\tif the MCData user is not allowed to initiate imminent preil MCData communications, as determined in clause 6.3.7.2.4, shall reject the SIP request with a SIP 403 (Forbidden) response including warning text set to \"236 user not authorised to initiate imminent peril communication\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n5)\tif the received SIP REFER request does not contain an application/resource-lists+xml MIME body referenced by a \"cid\" URL in the Refer-To header field, shall reject the SIP REFER request with a SIP 403 (Forbidden) response including warning text set to \"145 unable to determine called party\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps;\n6)\tif the received SIP REFER request contains an application/resource-lists+xml MIME body referenced by a \"cid\" URL in the Refer-To header field with more than one <entry> element in one or more <list> elements in the <resource-lists> element where each <entry> element contains an application/vnd.3gpp.mcdata-info MIME body with the <request-type> element set to \"one-to-one-sds\" or \"one-to-one-sds-session\", determine that the communication type is one-to-one standalone SDS or one-to-one SDS session;\n7)\tshall determine the public service identity of the controlling MCData function associated with the originating user's MCData ID;\ni)\tif the participating MCData function is unable to identify the controlling MCData function, it shall reject the REFER request with a SIP 404 (Not Found) response with the warning text \"142 unable to determine the controlling function\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps;\nNOTE 2:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 5:\tHow the participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 6:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n8)\tif the SIP REFER request contained a Refer-Sub header field containing \"false\" value and a Supported header field containing \"norefersub\" value, shall handle the SIP REFER request as specified in 3GPP TS 24.229 [5], IETF RFC 3515 [51] as updated by IETF RFC 6665 [36], and IETF RFC 4488 [53] without establishing an implicit subscription;\n9)\tshall generate a final SIP 200 (OK) response to the SIP REFER request according to 3GPP TS 24.229 [5];\nNOTE 7:\tIn accordance with IETF RFC 4488 [53], the participating MCData function inserts the Refer-Sub header field containing the value \"false\" in the SIP 200 (OK) response to the SIP REFER request to indicate that it has not created an implicit subscription.\n10)\tshall send the response to the SIP REFER request towards the MCData client according to 3GPP TS 24.229 [5];\n11)\tshall generate SIP INVITE request as described in clause 9.2.5.1.1;\n12)\tif the communication is a one-to-one communication and if the received SIP REFER request contains a <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body, then shall check if the status of the functional alias is activated for the MCData ID. If the functional alias status is activated, then the participating MCData function shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request to the received value, otherwise shall not include a <functional-alias-URI> element;\n13)\tshall set the Request-URI of the SIP INVITE request to the public service identity of the controlling MCData function serving the calling MCData user as determined above in step 7); and\n14)\tshall forward the SIP INVITE request according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response for the SIP INVITE request, the participating MCData function:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15];\n2)\tif the received SIP 2xx response does not contain a Warning header field as specified in clause 4.9 with the warning text containing the mcdata-warn-code set to \"149\":\na)\tshall generate a SIP re-INVITE request as specified in clause 9.2.5.1.2 and set the Request-URI to a public service identity identifying the pre-established session;\nb)\tshall send the SIP re-INVITE request towards the originating MCData client according to 3GPP TS 24.229 [5];\nc)\tupon receipt of a SIP 2xx response to the SIP re-INVITE, shall interact with the media plane as specified in 3GPP TS 24.582 [15]; and\nd) shall skip the remaining steps of the procedure; and\n3)\tif the received SIP 2xx response contains a Warning header field as specified in clause 4.9 with the warning text containing the mcdata-warn-code set to \"149\", shall wait for the receipt of a SIP INFO request from the controlling MCData function, and\na)\tUpon receipt of a SIP INFO request from the controlling MCData function within the dialog of the SIP INVITE request for an MCData emergency one-to-one communication, the participating MCData function:\ni)\tshall generate a SIP re-INVITE request according to 3GPP TS 24.229 [5] to be sent within the SIP dialog of the pre-established session;\nii)\tshall include in the SIP re-INVITE request an SDP offer based upon the previously negotiated SDP for the pre-established session;\niii)\tshall include in the SIP re-INVITE request a Resource-Priority header field with the contents set as in the Resource-Priority header field included in the SIP INVITE request sent to the controlling MCData function;\niv)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcdata-info+xml MIME body containing an <alert-ind> element, if also included in the application/vnd.3gpp.mcdata-info+xml MIME body contained in the received SIP INFO request, set to the value of the <alert-ind> in the SIP INFO request; and\nv)\tsend the SIP re-INVITE request towards the originating MCData client according to 3GPP TS 24.229 [5] and wait for the response; and\nb)\tUpon receiving a SIP 200 (OK) response from the originating MCData client for the SIP re-INVITE request, the participating MCData function:\ni)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15].\n9.2.5.2.2.2\tTerminating procedures\nUpon receipt of a \"SIP INVITE request for standalone SDS over media plane for terminating participating MCData function\" or \"SIP INVITE request for SDS session for terminating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the \"SIP INVITE request for terminating participating MCData function\" with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4], and skip the rest of the steps;\n2)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request to retrieve the binding between the MCData ID and public user identity;\ni)\tif the binding between the MCData ID and public user identity does not exist, then the participating MCData function shall reject the SIP INVITE request with a SIP 404 (Not Found) response, and skip the rest of the steps;\n3)\tshall generate a SIP re-INVITE request as specified in clause 9.2.5.1.3 with following clarifications:\ni)\tshall set the Request-URI to a public service identity identifying the pre-established session;\nii)\tif the incoming SIP INVITE request contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP INVITE request with following clarification:\na) shall include <mcdata-communication-state> element with a value set to \"establish-request\"; and\niii)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\";\nc)\tthe isfocus media feature tag;\nd)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the incoming SIP INVITE request; and\ne)\tany other uri-parameter provided in the Contact header field of the incoming SIP INVITE request;\n4)\tshall send the SIP re-INVITE request towards the terminating MCData client according to 3GPP TS 24.229 [5]; and\n5)\tupon receipt of a SIP 2xx response to the SIP re-INVITE, shall interact with the media plane as specified in 3GPP TS 24.582 [15].\n9.2.5.2.2.3\tProcessing of request from the served user to upgrade or cancel emergency one-to-one SDS communication\nThe participating MCData function shall execute the procedure in clause 6.3.7.1.18.\n9.2.5.2.2.4\tProcessing of request from controlling MCData function to upgrade or cancel emergency one-to-one SDS communication\nThe participating MCData function shall execute the procedure in clause 6.3.7.1.17.\n9.2.5.2.3.1\tOriginating controlling MCData function procedures\nThe controlling MCData function shall execute the procedure in clause 9.2.4.4.3.\n9.2.5.2.3.2\tTerminating controlling MCData function procedures\nThe controlling MCData function shall execute the procedure in clause 9.2.4.4.4.\n9.2.5.2.3.3\tControlling MCData function receiving a request for upgrade to emergency one-to-one SDS communication\nThe controlling MCData function shall execute the procedure in clause 6.3.7.1.19, with an indication that the applicable MCData subservice is Short Data Service using session.\n9.2.5.2.3.4\tControlling MCData function receiving a request for cancellation of emergency one-to-one SDS communication\nThe controlling MCData function shall execute the procedure in clause 6.3.7.1.20, with an indication that the applicable MCData subservice is Short Data Service using session.\n9.2.5.2.3.5\tControlling MCData function sending a request for upgrade to emergency one-to-one SDS communication\nThe controlling MCData function shall execute the procedure in clause 6.7.3.1.21.\n9.2.5.2.3.6\tControlling MCData function sending a request for cancellation of emergency one-to-one SDS communication\nThe controlling MCData function shall execute the procedure in clause 6.7.3.1.22.\nThe procedures in this clause are used to initiate group standalone SDS using media plane or group SDS session within the pre-established session.\n9.2.5.3.1.1\tClient originating procedures\nUpon receiving a request from an MCData user to initiate group SDS session within the pre-established session, the MCData client shall determine whether the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element. If a <preconfigured-group-use-only> element exists and is set to the value \"true\", then the MCData client:\n1)\tshould indicate to the MCData user that SDS sessions are not allowed on the indicated group; and\n2)\tshall skip the remainder of this procedure.\nUpon receiving a request from an MCData user to initiate group SDS session within the pre-established session, the MCData client shall generate a SIP REFER request outside a dialog as specified in IETF RFC 3515 [51] as updated by IETF RFC 6665 [36] and IETF RFC 7647 [52], and in accordance with the UE procedures specified in 3GPP TS 24.229 [5], with the clarifications given below.\nThe MCData client:\n1)\tshall set the Request URI of the SIP REFER request to the session identity of the pre-established session;\n2)\tshall set the Refer-To header field of the SIP REFER request as specified in IETF RFC 3515 [51] with a Content-ID (\"cid\") Uniform Resource Locator (URL) as specified in IETF RFC 2392 [33] that points to an application/resource-lists+xml MIME body as specified in IETF RFC 5366 [18], and with the Content-ID header field set to this \"cid\" URL;\n3)\tshall include in the application/resource-lists+xml MIME body a single <entry> element in a <list> element in the <resource-lists> element where the <entry> element contains a \"uri\" attribute set to the MCData group identity, extended with the following parameters in the headers portion of the SIP URI:\nNOTE:\tCharacters that are not formatted as ASCII characters are escaped in the following parameters in the headers portion of the SIP URI.\na)\tan hname \"body\" parameter populated with:\ni)\tan application/sdp MIME body containing an SDP offer with media attributes specified in clause 9.2.3.2.1 if a group standalone SDS message is requested or clause 9.2.4.2.1 if a group SDS session is requested;\nii)\tan application/vnd.3gpp.mcdata-info MIME body with:\nA)\tif a group standalone SDS message is requested, the <request-type> element set to a value of \"group-sds\". If a group SDS session is requested, the <request-type> element set to a value of \"group-sds-session\";\nB)\tthe <mcdata-request-uri> element set to the MCData group identity;\nC)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client;\nD)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP REFER request, the <anyExt> element of the <functional-alias-URI> element set to the URI of the used functional alias; and\nE)\tif the MCData user has requested an application priority, the <anyExt> element with the <user-requested-priority> element set to the user provided value;\n3A)\tif the MCData user has requested the origination of an MCData emergency group communication or is originating an MCData group communication and the MCData emergency state is already set:\na)\tif this is an authorised request for an MCData emergency group communication as determined by the procedures of clause 6.2.8.1.8, shall execute the procedures in clause 6.2.8.1.1; and\nb)\tif this is an unauthorised request for an MCData emergency group communication as determined in step a) above, should indicate to the MCData user that they are not authorised to initiate an MCData emergency group communication;\n3B)\tif the MCData client emergency group state for this group is set to \"MDEG 2: in-progress\" or \"MDEG 4: confirm-pending\", shall include the Resource-Priority header field and execute the procedures in clause 6.2.8.1.2;\n3C)\tif the MCData user has requested the origination of an MCData imminent peril group communication:\na)\tif this is an authorised request for an MCData imminent peril group communication as determined by the procedures of clause 6.2.8.1.8, shall execute the procedures in clause 6.2.8.1.9; and\nb)\tif this is an unauthorised request for an MCData imminent peril group communication as determined in step a) above, should indicate to the MCData user that they are not authorised to initiate an MCData imminent peril group communication;\n3D)\tif the MCData client imminent peril group state for this group is set to \"MDIG 2: in-progress\" or \"MDIG 4: confirm-pending\", shall include the Resource-Priority header field and execute the procedures in clause 6.2.8.1.12;\n4)\tshall include a P-Preferred-Service header field set to the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), according to IETF RFC 6050 [7];\n5)\tmay include a P-Preferred-Identity header field in the SIP INVITE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n6)\tshall include the following according to IETF RFC 4488 [53]:\na)\tthe option tag \"norefersub\" in the Supported header field; and\nb)\tthe value \"false\" in the Refer-Sub header field;\n7)\tshall include a Target-Dialog header field as specified in IETF RFC 4538 [54] identifying the pre-established session;\n8)\tshall include the g.3gpp.mcdata.sds media feature tag in the Contact header field of the SIP REFER request according to IETF RFC 3840 [16]; and\n9)\tshall send the SIP REFER request according to 3GPP TS 24.229 [5].\nOn receiving a final SIP 2xx response to the SIP REFER request, the MCData client:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15].\nOn receiving a SIP 4xx response, SIP 5xx response or a SIP 6xx response to the SIP REFER request:\n1)\tif the MCData emergency group communication state is set to \"MDEGC 2: emergency-communication-requested\" or \"MDEGC 3: emergency-communication-granted\" or\tif the MCData imminent peril group communication state is set to \"MDIGC 2: imminent-peril-communication-requested\" or \"MDIGC 3: imminent-peril-communication-granted\", the MCData client shall perform the actions specified in clause 6.2.8.1.5 and shall skip the remaining steps.\nOn receiving a SIP re-INVITE request within the pre-established session targeted by the sent SIP REFER request, the MCData client:\n0)\tif the sent SIP REFER request was a request for an MCData emergency group communication or an MCData imminent peril group communication, the MCData client:\na)\tshall perform the actions specified in clause 6.2.8.1.16;\nb)\tshall check if a Resource-Priority header field is included in the incoming SIP re-INVITE request and may perform further actions outside the scope of this specification to act upon an included Resource-Priority header field as specified in 3GPP TS 24.229 [5];\nc)\tshall accept the SIP re-INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\nd)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP re-INVITE request according to 3GPP TS 24.229 [5], based upon the parameters already negotiated for the pre-established session; and\ne)\tshall send the SIP 200 (OK) response towards the participating MCData function according to rules and procedures of 3GPP TS 24.229 [5];\n1)\tif the <mcdata-communication-state> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"establish-success\":\ni)\tshall notify MCData user about successful the MCData communication establishment;\n2)\tif the <mcdata-communication-state> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"establish-fail\":\ni)\tshall notify MCData user about the MCData communication establishment failure; and\n3)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15].\nOn communication release by interaction with the media, if the sent SIP REFER request was a request for an MCData emergency group communication or an MCData imminent peril group communication, the MCData client shall perform the procedures specified in clause 6.2.8.1.17.\nOn receiving a SIP INFO request where the Request-URI contains an MCData session ID identifying an ongoing group session, the MCData client shall perform the procedures specified in clause 6.2.8.1.13.\n9.2.5.3.1.2\tClient terminating procedrues\nUpon receiving a SIP re-INVITE request within a pre-established Session without an associated MCData session the MCData client:\n1)\tif the <mcdata-communication-state> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"establish-request\":\ni)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"group-sds\", shall follow the procedures in clause 9.2.3.2.4;\nii)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"group-sds-session\", shall follow the procedures in clause 9.2.4.2.4;\n9.2.5.3.2.1\tOriginating procedures\nUpon receiving a SIP REFER request, with:\n1)\tthe Request-URI set to a public service identity identifying the pre-established session on the participating MCData function;\n2)\tthe Refer-To header field containing a Content-ID (\"cid\") Uniform Resource Locator (URL) as specified in IETF RFC 2392 [33] that points to an application/resource-lists+xml MIME body as specified in IETF RFC 5366 [18] containing one or more <entry> elements in one or more <list> elements in the <resource-lists> element where each <entry> element contains a \"uri\" attribute containing a SIP URI set to the MCData group identity;\n3)\tan hname \"body\" parameter in the headers portion of the SIP URI specified above containing an application/vnd.3gpp.mcdata-info MIME body with the <request-type> element set to \"group-sds\" or \"group-sds-session\"; and\n4)\ta Content-ID header field set to the \"cid\" URL;\nthe participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP REFER request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\nNOTE 1:\tIf the application/vnd.3gpp.mcdata-info MIME body included in the SIP REFER request contains an <emergency-ind> element or <imminentperil-ind> element set to a value of \"true\" and this is an authorised request for originating a priority communication as determined by clause 6.3.7.2.6, the participating MCData function can, according to local policy, choose to accept the request.\n2)\tshall determine the MCData ID of the calling user from public user identity in the P-Asserted-Identity header field of the SIP REFER request;\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP REFER request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps;\n4)\tshall determine whether the MCData user identified by the MCData ID is authorised for MCData communications by following the procedures in clause 11.1;\ni)\tif the procedures in clause 11.1 indicate that the user identified by the MCData ID is not allowed to initiate MCData communications, shall reject the SIP REFER request with a SIP 403 (Forbidden) response with warning text set to \"200 user not authorised to transmit data\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\n5)\tif the received SIP REFER request does not contain an application/resource-lists+xml MIME body referenced by a \"cid\" URL in the Refer-To header field, shall reject the SIP REFER request with a SIP 403 (Forbidden) response including warning text set to \"145 unable to determine called party\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps;\n6)\tif the received SIP REFER request contains an application/resource-lists MIME+xml body referenced by a \"cid\" URL in the Refer-To header field with more than one <entry> element in one or more <list> elements in the <resource-lists> element where each <entry> element contains an application/vnd.3gpp.mcdata-info MIME body with the <request-type> element set to \"group-sds\", determine that the communication type is group SDS session;\n6A)\tif the received SIP REFER request includes an application/vnd.3gpp.mcdata-info+xml MIME body with an <emergency-ind> element included or an <imminentperil-ind> element included, shall validate the request as described in clause 6.3.7.1.9;\n6B)\tif the SIP REFER request contains in the application/vnd.3gpp.mcdata-info+xml MIME body:\na)\tan <emergency-ind> element set to a value of \"true\" and this is an unauthorised request for an MCData emergency group communication as determined by clause 6.3.7.2.6;\nb)\tan <alert-ind> element set to a value of \"true\" and this is an unauthorised request for an MCData emergency alert as determined by clause 6.3.7.2.1; or\nc)\tan <imminentperil-ind> element set to a value of \"true\" and this is an unauthorised request for an MCData imminent peril group communication as determined by clause 6.3.7.2.4;\nthen shall reject the SIP REFER request with a SIP 403 (Forbidden) response and skip the rest of the steps;\n7)\tshall determine the public service identity of the controlling MCData function associated with the originating user's MCData ID;\ni)\tif the participating MCData function is unable to identify the controlling MCData function, it shall reject the REFER request with a SIP 404 (Not Found) response with the warning text \"142 unable to determine the controlling function\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps;\nNOTE 2:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 5:\tHow the participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 6:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n8)\tif the SIP REFER request contained a Refer-Sub header field containing \"false\" value and a Supported header field containing \"norefersub\" value, shall handle the SIP REFER request as specified in 3GPP TS 24.229 [5], IETF RFC 3515 [51] as updated by IETF RFC 6665 [36], and IETF RFC 4488 [53] without establishing an implicit subscription;\n9)\tshall generate a final SIP 200 (OK) response to the SIP REFER request according to 3GPP TS 24.229 [5];\nNOTE 7:\tIn accordance with IETF RFC 4488 [53], the participating MCData function inserts the Refer-Sub header field containing the value \"false\" in the SIP 200 (OK) response to the SIP REFER request to indicate that it has not created an implicit subscription.\n10)\tshall send the response to the SIP REFER request towards the MCData client according to 3GPP TS 24.229 [5];\n11)\tshall generate SIP INVITE request as described in clause 9.2.5.1.1;\n12)\tshall set the Request-URI of the SIP INVITE request to the public service identity of the controlling MCData function servicing for the calling MCData user as determined above in step 7); and\n13)\tshall forward the SIP INVITE request according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response for the SIP INVITE request the participating MCData function:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15];\n2)\tshall generate a SIP re-INVITE request as specified in clause 9.2.5.1.2 with following clarifications:\ni)\tshall set the Request-URI to a public service identity identifying the pre-established session;\n3)\tshall send the SIP re-INVITE request towards the originating MCData client according to 3GPP TS 24.229 [5]; and\n4)\tupon receipt of a SIP 2xx response to the SIP re-INVITE, shall interact with the media plane as specified in 3GPP TS 24.582 [15].\n9.2.5.3.2.2\tTerminating procedures\nUpon receipt of a \"SIP INVITE request for standalone SDS over media plane for terminating participating MCData function\" or \"SIP INVITE request for SDS session for terminating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the \"SIP INVITE request for terminating participating MCData function\" with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4], and skip the rest of the steps;\nNOTE:\tIf the SIP INVITE request contains an emergency indication or an imminent peril indication set to a value of \"true\" and this is an authorised request for originating a priority communication as determined by clause 6.3.7.2.6, the participating MCData function can, according to local policy, choose to accept the request.\n2)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request to retrieve the binding between the MCData ID and public user identity;\ni)\tif the binding between the MCData ID and public user identity does not exist, then the participating MCData function shall reject the SIP INVITE request with a SIP 404 (Not Found) response, and skip the rest of the steps;\n3)\tshall generate a SIP re-INVITE request as specified in clause 9.2.5.1.3 with following clarifications:\ni)\tshall set the Request-URI to a public service identity identifying the pre-established session;\nii)\tif the incoming SIP INVITE request contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP INVITE request with following clarification:\na) shall include <mcdata-communication-state> element with a value set to \"establish-request\"; and\niii)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\";\nc)\tthe isfocus media feature tag;\nd)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the incoming SIP INVITE request; and\ne)\tany other uri-parameter provided in the Contact header field of the incoming SIP INVITE request;\n4)\tshall send the SIP re-INVITE request towards the terminating MCData client according to 3GPP TS 24.229 [5]; and\n5)\tupon receipt of a SIP 2xx response to the SIP re-INVITE, shall interact with the media plane as specified in 3GPP TS 24.582 [15].\n9.2.5.4.1.1\tClient originating procedures\nUpon receiving a request from an MCData user to leave an MCData session within a pre-established session, the MCData client:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15];\n2)\tshall generate an initial SIP REFER request outside a dialog in accordance with the procedures specified in 3GPP TS 24.229 [5], IETF RFC 4488 [53] and IETF RFC 3515 [51] as updated by IETF RFC 6665 [36] and IETF RFC 7647 [52];\n3)\tshall set the Request-URI of the SIP REFER request to the public service identity identifying the pre-established session on the MCData server serving the MCData user;\n4)\tshall include the Refer-Sub header field with value \"false\" according to rules and procedures of IETF RFC 4488 [53];\n5)\tshall include the Supported header field with value \"norefersub\" according to rules and procedures of IETF RFC 4488 [53];\n6)\tshall set the Refer-To header field of the SIP REFER request to the MCData session identity to leave;\n7)\tshall include the \"method\" SIP URI parameter with the value \"BYE\" in the URI in the Refer-To header field;\n8)\tshall include a Target-Dialog header field as specified in IETF RFC 4538 [54] identifying the pre-established session; and\n9)\tshall send the SIP REFER request according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 2xx response to the SIP REFER request, the MCData client shall interact with media plane as specified in 3GPP TS 24.582 [15].\nOn receiving a SIP re-INVITE request within the pre-established session targeted by the sent SIP REFER request, the MCData client:\n1)\tif the <mcdata-communication-state> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"terminated\":\ni)\tshall notify MCData user about successful the MCData communication termination.\n9.2.5.4.1.2\tClient terminating procedures\nUpon receiving a SIP re-INVITE request within a pre-established Session without an associated MCData session, the MCData client:\n1)\tif the <mcdata-communication-state> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"terminate-request\":\ni)\tshall send SIP 200 (OK) response towards MCData server according to 3GPP TS 24.229 [5]; and\nii)\tshall release all media plane resources corresponding to the MCData communication being released.\n9.2.5.4.2.1\tOriginating procedures\nUpon receiving a SIP REFER request with the \"method\" SIP URI parameter set to value \"BYE\" in the URI in the Refer-To header field from the MCData client, the participating MCData function:\n1)\tshall determine the MCData ID of the calling user from public user identity in the P-Asserted-Identity header field of the SIP REFER request;\n2)\tif the participating MCData function cannot find a binding between the public user identity, then the participating MCData function shall reject the SIP REFER request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps;\n3)\tif the SIP REFER request contained a Refer-Sub header field containing \"false\" value and a Supported header field containing \"norefersub\" value, shall handle the SIP REFER request as specified in 3GPP TS 24.229 [5], IETF RFC 3515 [51] as updated by IETF RFC 6665 [36], and IETF RFC 4488 [53] without establishing an implicit subscription;\n4)\tshall generate a SIP 200 (OK) response to the SIP REFER request, and in the SIP 200 (OK) response:\na)\tshall include the Supported header field with value \"norefersub\" according to rules and procedures of IETF RFC 4488 [53]; and\nb)\tshall check the presence of the Refer-Sub header field of the SIP REFER request and if it is present and set to the value \"false\" shall include the Refer-Sub header field with value \"false\" according to rules and procedures of IETF RFC 4488 [53];\n5)\tshall send the SIP 200 (OK) response to the SIP REFER request towards MCData client according to 3GPP TS 24.229 [5];\n6)\tshall generate a SIP BYE request, and in the SIP BYE request:\na)\tshall set the Request-URI to the MCData session identity which was included at the Refer-To header field of the received REFER request; and\nb)\tshall include a P-Asserted-Identity header field in the outgoing SIP BYE request set to the public service identity of the participating MCData function; and\n7)\tshall send the SIP BYE request toward the controlling MCData function according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response to the SIP BYE request the participating MCData function shall interact with the media plane as specified in 3GPP TS 24.582 [15] for releasing media plane resources associated with the SIP session with the controlling MCData function. The participating MCData function shall generate a SIP re-INVITE request as specified in clause 9.2.5.1.2 with following clarifications and send the request towards the originating MCData client according to 3GPP TS 24.229 [5]:\n1)\tshall set the Request-URI to a public service identity identifying the pre-established session; and\n2)\tshall set the <mcdata-communication-state> element with a value of \"terminated\".\n9.2.5.4.2.2\tTerminating procedures\nUpon receiving a SIP BYE request from the controlling MCData function, the participating MCData function:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15];\n2)\tshall send a SIP 200 (OK) response to the controlling MCData function;\n3)\tshall generate a SIP re-INVITE request as specified in clause 9.2.5.1.2 with following clarifications:\ni)\tshall set the Request-URI to a public service identity identifying the pre-established session; and\nii)\tshall set the <mcdata-communication-state> element with a value of \"terminate-request\";\n4)\tshall send the SIP re-INVITE request towards the originating MCData client according to 3GPP TS 24.229 [5]; and\n5)\tupon receipt of a SIP 2xx response to the SIP re-INVITE, shall interact with the media plane as specified in 3GPP TS 24.582 [15].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.2.6\tSDS session using MBMS delivery in the media plane",
                            "text_content": "The procedures for group SDS delivery using MBMS can be seen as extensions of group SDS delivery using unicast session via the media plane.\nGroup SDS delivery using MBMS enables dynamic toggling between unicast and MBMS delivery at any time during a session, assuming the proper bearers are available. Only the terminating MCData clients and the respective associated MCData terminating participating functions become aware of and involved in the potential MBMS delivery.\nThe terminating participating function can signal the start/stop/resume MBMS transmissions to the MCData client by using the media control plane Map Group To Bearer and Unmap Group To Bearer messages, described in 3GPP TS 24.582 [15]. The media control plane signaling associates the TMGI of an announced MBMS bearer with the MCData group ID of the communication and with the MBMS transmission parameters (IP address and UDP port).\nGuaranteed delivery for SDS when using MBMS can be achieved by the SDS originator through use of dispositions (i.e. \"DELIVERED\") and SDS NOTIFICATION mechanisms. It is up to the terminating participating function to decide whether or not to use MBMS for a session, and it is possible that the terminating participating function will not use MBMS delivery for SDS messages without the \"DELIVERED\" disposition.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.2.7\tSDS session using MBS delivery in the media plane",
                            "text_content": "All steps of clause 9.2.6 apply also for MBS, with the clarification that terminology mapping specified in clause I.3.4 applies.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "9.3\tOff-network SDS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "9.3.1\tGeneral",
                            "text_content": "In order to transmit an off-network SDS message or SDS notification to an MCData user, the MCData client:\n1)\tshall send the MONP MCData message transported in a MONP MCDATA MESSAGE CARRIER message, specified in 3GPP TS 24.379 [10], as a UDP message to the local IP address of the MCData user, on UDP port 8809 (as specified in TS 24.379 [10]), with an IP time-to-live set to 255; and\n2)\tshall treat UDP messages received on the port 8809 as received MONP MCDATA MESSAGE CARRIER messages.\nNOTE:\tAn MCData client that supports IPv6 shall listen to the IPv6 addresses.\nIn order to transmit an off-network SDS message, an SDS notification or any one of the emergency alert messages mentioned in clause 16.3 to an MCData group, the MCData client:\n1)\tshall send the MONP MCData message transported in a MONP MCDATA MESSAGE CARRIER message, specified in 3GPP TS 24.379 [10], as a UDP message to the multicast IP address of the MCData group, on UDP port 8809, with an IP time-to-live set to 255; and\n2)\tshall treat UDP messages received on the multicast IP address of the MCData group and on port 8809 as received MONP MCDATA MESSAGE CARRIER messages, with the IP address treated as mentioned in \"/<x>/<x>/OffNetwork/MCPTTGroupParameter/<x>/IPMulticastAddress\" leaf node within the group configuration specified in 3GPP TS 24.483 [42].\nThe MONP MCDATA MESSAGE CARRIER message is the entire payload of the UDP message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.3.2\tStandalone SDS using signalling control plane",
                            "text_content": "Upon receiving an indication to send an SDS message, the MCData client:\n1)\tif the request to send the SDS message is for a MCData group, shall check if the value of \"/<x>/<x>/Common/MCData/AllowedSDS\" leaf node, present in the group configuration as specified in 3GPP TS 24.483 [42], is set to \"false\". It the value is set to \"false\", shall reject the request to send the SDS message and not continue with the remaining procedures in this clause;\n2)\tif:\na)\ta one-to-one SDS message is to be sent then, shall store the MCData user ID of the intended recipient as the target MCData user ID; or\nb)\ta group SDS message is to be sent then, shall store the MCData group ID as the target MCData group ID;\n3)\tmay set the stored SDS disposition request type as:\na)\t\"DELIVERY\", if only delivery disposition is requested;\nb)\t\"READ\", if only read disposition is requested; or\nc)\t\"DELIVERY AND READ\", if both delivery and read dispositions are requested;\n4)\tif an existing conversation is indicated then, shall store the conversation identifier of the indicated conversation as SDS conversation ID. Otherwise, shall generate an UUID as described in IETF RFC 4122 [14] and store SDS conversation ID;\n5)\tshall generate an UUID as described in IETF RFC 4122 [14] and store as the SDS message ID;\n6)\tif indicated that the SDS message is in reply to another SDS message then, shall store the message identifier of the indicated message as SDS reply ID;\n7)\tif indicated that the target recipient of the SDS message is an application then, shall store the application ID of the indicated application as the SDS application ID or as the SDS extended application ID;\n8)\tshall store the received payload as the SDS payload;\n9)\tshall store the received payload type as the SDS payload type;\n10)\tshall store the current UTC time as the SDS transmission time;\n11)\tshall generate a SDS OFF-NETWORK MESSAGE message as specified in clause 15.1.7. In the SDS OFF-NETWORK MESSAGE message, the MCData client:\na)\tshall set the Sender MCData user ID IE to its own MCData user ID;\nb)\tif:\ni)\ta one-to-one SDS message is to be sent then shall set the Recipient MCData user ID IE to the stored target MCData user ID as specified in clause 15.2.15; or\nii)\ta group SDS message is to be sent then, shall set the MCData group ID IE to the stored target MCData group ID as specified in clause 15.2.14;\nc)\tmay set the SDS disposition request type IE to the stored the SDS disposition request type as specified in clause 15.2.3;\nd)\tshall set the Conversation ID IE to the stored conversation ID as specified in clause 15.2.9;\ne)\tshall set the Message ID IE to the stored SDS message ID as specified in clause 15.2.10;\nf)\tshall set the Date and time IE to the stored SDS transmission time as specified in clause 15.2.8;\ng)\tmay include the InReplyTo message ID IE set to the stored SDS reply ID as specified in clause 15.2.11;\nh)\tmay include:\ni)\tthe Application ID IE set to the stored SDS application ID as specified in clause 15.2.7; or\nii)\tthe Extended application ID IE set to the stored SDS extended application ID as specified in clause 15.2.24;\ni)\tif end-to-end security is required for a one-to-one communication and the security context does not exist or if the existing security context has expired, shall include the Security parameters and Payload IE with security parameters as described in 3GPP TS 33.180 [26];\nj)\tif\ni)\tend-to-end security is not required for a one-to-one communication, or\nii)\tsending the SDS OFF-NETWORK MESSAGE message to a MCData group;\nmay include the Payload IE as specified in clause 15.2.13 with:\ni)\tthe Payload content type to the stored SDS payload type; and\nii)\tthe Payload data set to the stored SDS payload;\n12)\tif:\na)\ta one-to-one SDS message is to be sent then, shall send the SDS OFF-NETWORK MESSAGE message as specified in clause 9.3.1.1; or\nb)\ta group SDS message is to be sent then, shall send the SDS OFF-NETWORK MESSAGE message as specified in clause 9.3.1.2;\n13)\tshall initialise the counter CFS1 (SDS retransmission) with the value set to 1; and\n14)\tshall start timer TFS1 (SDS retransmission).\nUpon expiry of timer TFS1 (SDS retransmission), the MCData client:\n1)\tshall generate a SDS OFF-NETWORK MESSAGE message as specified in clause 15.1.7. In the SDS OFF-NETWORK MESSAGE message, the MCData client:\na)\tshall set the Sender MCData user ID IE to its own MCData user ID;\nb)\tif:\ni)\ta one-to-one SDS message is to be sent then, shall set the Recipient MCData user ID IE to the stored target MCData user ID; or\nii)\ta group SDS message is to be sent then, shall set the MCData group ID IE to the stored target MCData group ID;\nc)\tmay set the SDS disposition request type IE to the stored the SDS disposition request type as specified in clause 15.2.3;\nd)\tshall set the Conversation ID IE to the stored conversation ID as specified in clause 15.2.9;\ne)\tshall set the Message ID IE to the stored SDS message ID as specified in clause 15.2.10;\nf)\tshall set the Date and time IE to the stored the SDS transmission time as specified in clause 15.2.8;\ng)\tmay include the InReplyTo message ID IE set to the stored SDS reply ID as specified in clause 15.2.11;\nh)\tmay include:\ni)\tthe Application ID IE set to the stored SDS application ID as specified in clause 15.2.7; or\nii)\tthe Extended application ID IE set to the stored SDS extended application ID as specified in clause 15.2.24;\ni)\tif end-to-end security is required for a one-to-one communication and the security context does not exist or if the existing security context has expired, shall include the Security parameters IE with security parameters as described in 3GPP TS 33.180 [26]; and\nj)\tif:\ni)\tend-to-end security is not required for a one-to-one communication, or\nii)\tsending the SDS OFF-NETWORK MESSAGE message to a MCData group;\nmay include the Payload IE as specified in clause 15.2.13 with:\ni)\tthe Payload content type to the stored SDS payload type; and\nii)\tthe Payload data set to the stored SDS payload;\n2)\tif:\na)\ta one-to-one SDS message was sent then, shall send the SDS OFF-NETWORK MESSAGE message as specified in clause 9.3.1.1; or\nb)\ta group SDS message was sent then, shall send the SDS OFF-NETWORK MESSAGE message as specified in clause 9.3.1.2;\n3)\tshall increment the counter CFS1(SDS retransmission) by 1; and\n4)\tshall start timer TFS1 (SDS retransmission) if the associated counter CFS1 (SDS retransmission) has not reached its upper limit.\nUpon receiving an SDS OFF-NETWORK MESSAGE message with a SDS disposition request type IE, the MCData client:\n1)\tshall store the value of Sender MCData user ID IE as the stored notification target MCData user ID;\n2)\tshall store the value of Conversation ID IE as the stored conversation ID;\n3)\tshall store the value of Message ID IE as the stored SDS message ID;\n4)\tshall store the current UTC time as the stored SDS notification time;\n5)\tif present, shall store the value of Application ID IE as the stored SDS application ID;\n6)\tif present, shall store the value of the Extended application ID IE as the stored SDS extended application ID;\n7)\tif present, shall store the value of MCData group ID IE to the stored target MCData group ID; and\n8)\tif the SDS disposition request type IE is set to:\na)\t\"DELIVERY\" then, shall send a SDS OFF-NETWORK NOTIFICATION message as described in clause 12.3.2;\nb)\t\"READ\" then, shall send a SDS OFF-NETWORK NOTIFICATION message as described in clause 12.3.3; or\nc)\t\"DELIVERY AND READ\" then, shall start timer TFS3 (delivery and read).\nNOTE: Duplicate messages (re-transmissions) that are received by the MCData client should not be processed again.\nUpon receiving a display indication before timer TFS3 (delivery and read) expires, the MCData client:\n1)\tshall generate and send a SDS OFF-NETWORK NOTIFICATION message as described in clause 12.3.4.\nUpon expiry of timer TFS3 (delivery and read), the MCData client:\n1)\tshall generate and send a SDS OFF-NETWORK NOTIFICATION message as described in clause 12.3.2; and\n2)\tupon receiving a display indication, shall generate and send a SDS OFF-NETWORK NOTIFICATION message as described in clause 12.3.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "10\tFile Distribution (FD)",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "10.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The group administrator can disable the FD service on a MCData group by setting the <mcdata-allow-file-distribution> element under the <list-service> element, in the group document, to \"false\".\nIf the <mcdata-allow-file-distribution> element under the <list-service> element, in the group document, is set to \"false\" for a MCData group:\n--\tan MCData client should not use the procedures in the clauses of the parent clause for FD to the said MCData group.\n-\ta terminating MCData controlling function should reject the request for FD to the said MCData group.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "10.2\tOn-network FD",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "10.2.1\tGeneral",
                            "text_content": "When the MCData user wishes to send:\n-\ta one-to-one standalone File Distribution (FD) message to another MCData user; or\n-\ta group standalone File Distribution (FD) message to a pre-configured group;\nthe MCData client:\n1)\tshall follow the procedures in clause 11.1 for transmission control; and\n2)\tif the procedures in clause 11.1 are successful:\na)\tif the MCData client decides to use HTTP, shall follow the procedures in clause 10.2.4; and\nb)\tif the MCData client decides to use the media plane, shall follow the the procedures in clause 10.2.5.\nWhen a MCData client has received a SIP request containing an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1, the MCData Client:\n1)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body;\n2)\tif the application/vnd.3gpp.mcdata-signalling MIME body does not contain an FD SIGNALLING PAYLOAD message as specified in clause 15.1.3, shall exit this clause;\n3)\tif more than one Payload IE is included in the FD SIGNALLING PAYLOAD message, shall exit this clause;\n4)\tif the Payload content type in the Payload IE in the FD SIGNALLING PAYLOAD message is not set to \"FILEURL\", shall exit this clause;\n5)\tif the FD SIGNALLING PAYLOAD message contains a Mandatory download IE set to the value of \"MANDATORY DOWNLOAD\" shall follow the procedures in clause 10.2.1.2.2;\n6)\tif the FD SIGNALLING PAYLOAD message does not contain a Mandatory download IE, shall follow the procedures in clause 10.2.1.2.3; and\n7)\tif the received FD SIGNALLING PAYLOAD message contains an Application metadata container IE, may process the content of that IE per local policy.\nThe MCData client:\n1)\tif the FD SIGNALLING PAYLOAD message contains a new Conversation ID, shall instantiate a new conversation with the Message ID in the FD SIGNALLING PAYLOAD identifying the first message in the conversation thread;\n2)\tif the FD SIGNALLING PAYLOAD message contains an existing Conversation ID and:\na)\tif the FD SIGNALLING PAYLOAD message does not contain an InReplyTo message ID, shall use the Message ID in the FD SIGNALLING PAYLOAD to identify a new message in the existing conversation thread; and\nb)\tif the FD SIGNALLING PAYLOAD message contains an InReplyTo message ID, shall associate the message to an existing message in the conversation thread as identified by the InReplyTo message ID in the FD SIGNALLING PAYLOAD, and use the Message ID in the FD SIGNALLING PAYLOAD to identify the new message;\n3)\tmay store the Conversation ID, Message ID, InReplyTo message ID and Date and time in local storage;\n4)\tif the FD SIGNALLING PAYLOAD message does not contain an Application ID IE and does not contain an Extended application ID IE:\na)\tshall determine that the payload contained in the Payload IE in the FD SIGNALLING PAYLOAD message is for user consumption;\nb)\tshall notify the user or application that the file identified by file URL in the Payload data in the Payload IE will be downloaded automatically; and\nc)\tif the FD SIGNALLING PAYLOAD message contains a Metadata IE, shall deliver the contents of the Metadata IE to the user or application;\n5)\tif the FD SIGNALLING PAYLOAD message contains an Application ID IE:\na)\tshall determine that the payload contained in the Payload IE in the FD SIGNALLING PAYLOAD message is not for user consumption;\nb)\tif the Application ID value is unknown, shall discard the FD message and exit this clause;\nc)\tif the Application ID value is known, shall notify the application that the file identified by file URL in the Payload data in the Payload IE will be downloaded automatically; and\nNOTE 1:\tIf the FD request is addressed to a non-MCData application that is not running, the MCData client starts the local non-MCData application. Subsequent automatic download of the file is then started and the file is delivered to that application.\nd)\tif the FD SIGNALLING PAYLOAD message contains a Metadata IE, shall deliver the contents of the Metadata IE to the application;\n6)\tif the FD SIGNALLING PAYLOAD message contains an Extended application ID IE:\na)\tshall determine that the payload contained in the Payload IE in the FD SIGNALLING PAYLOAD message is not for user consumption;\nb)\tif the Extended application ID value is unknown, shall discard the FD message and exit this clause;\nc)\tif the Extended application ID value is known, shall notify the application that the file identified by file URL in the Payload data in the Payload IE will be downloaded automatically; and\nNOTE 2:\tIf the FD request is addressed to a non-MCData application that is not running, the MCData client starts the local non-MCData application. Subsequent automatic download of the file is then started and the file is delivered to that application.\nd)\tif the FD SIGNALLING PAYLOAD message contains a Metadata IE, shall deliver the contents of the Metadata IE to the application;\n7)\tshall generate an FD NOTIFICATION indicating acceptance of the FD request as specified in clause 12.2.1.1;\n8)\tshall attempt to download the file as identified by the file URL in the Payload IE in the FD SIGNALLING PAYLOAD message, as specified in clause 10.2.3.1;\n9)\tif the received FD SIGNALLING PAYLOAD message contains an FD disposition request type IE requesting a file download completed update indication, then after the file has been successfully downloaded, shall generate an FD NOTIFICATION indicating file download completed, by following the procedures in clause 12.2.1.1 with following clarifications:\na)\tif the received FD SIGNALLING PAYLOAD message is not requested for a file download completed update indication in an FD disposition request type IE, shall not include the target MCData user by skipping the step 3) of clause 12.2.1.1; and\nNOTE 3:\tThe FD disposition request will be sent irrespective of whether the received FD SIGNALLING PAYLOAD message contains an FD disposition request type IE requesting a file download completed update indication or not.\n10)\tif the received FD SIGNALLING PAYLOAD message contains an Application metadata container IE, may process the content of that IE per local policy.\nThe MCData client:\n1)\tif the FD SIGNALLING PAYLOAD message does not contain an Application ID IE and does not contain an Extended application ID IE:\na)\tshall determine that the payload contained in the Payload IE in the FD SIGNALLING PAYLOAD message is for user consumption;\nb)\tshall notify the user about the incoming FD request; and\nc)\tif the FD SIGNALLING PAYLOAD message contains a Metadata IE, shall deliver the contents of the Metadata IE to the user;\n2)\tif the FD SIGNALLING PAYLOAD message contains an Application ID IE:\na)\tshall determine that the payload contained in the Payload IE in the FD SIGNALLING PAYLOAD message is not for user consumption;\nb)\tif the Application ID value is unknown, shall discard the FD message and exit this clause;\nc)\tif the Application ID value is known, shall notify the application of the incoming FD request; and\nNOTE 1:\tIf FD request is addressed to a non-MCData application that is not running, the MCData client starts the local non-MCData application.\nd)\tif the FD SIGNALLING PAYLOAD message contains a Metadata IE, shall deliver the contents of the Metadata IE to the application;\n2A)\tif the FD SIGNALLING PAYLOAD message contains an Extended application ID IE:\na)\tshall determine that the payload contained in the Payload IE in the FD SIGNALLING PAYLOAD message is not for user consumption;\nb)\tif the Extended application ID value is unknown, shall discard the FD message and exit this clause;\nc)\tif the Extended application ID value is known, shall notify the application of the incoming FD request; and\nNOTE 2:\tIf the FD request is addressed to a non-MCData application that is not running, the MCData client starts the local non-MCData application.\nd)\tif the FD SIGNALLING PAYLOAD message contains a Metadata IE, shall deliver the contents of the Metadata IE to the application;\n3)\tshall start a timer TDU2 (FD non-mandatory download timer) with the timer value as specified in clause F.2.3;\n4)\tshall wait for the user or application to request to download the file indicated by file URL in the Payload data in the Payload IE in the FD SIGNALLING PAYLOAD message;\n5)\tif the user or application accepts or rejects or decides to defer the FD request, shall stop timer TDU2 (FD non-mandatory download timer);\n6)\tif the user defered the FD request while the timer TDU2 (FD non-mandatory download timer) was running, shall generate an FD NOTIFICATION indicating deferral of the FD request as specified in clause 12.2.1.1;\nNOTE 3:\tOnce the timer TDU2 (FD non-mandatory download timer) has expired the FD request can only be accepted or rejected with an appropriate action by the MCData client.\nNOTE 4:\tOnce the timer TDU2 (FD non-mandatory download timer) has expired, no action is taken by the MCData client if the FD request is deferred.\n7)\tif the user or application rejects the FD request, shall generate an FD NOTIFICATION indicating rejection of the FD request as specified in clause 12.2.1.1 and shall exit this clause; and\n8)\tif the user accepts the FD request:\na)\tshall generate an FD NOTIFICATION indicating acceptance of the FD request as specified in clause 12.2.1.1;\nb)\tif the FD SIGNALLING PAYLOAD message contains a new Conversation ID, shall instantiate a new conversation with the Message ID in the FD SIGNALLING PAYLOAD identifying the first message in the conversation thread;\nc)\tif the FD SIGNALLING PAYLOAD message contains an existing Conversation ID and:\ni)\tif the FD SIGNALLING PAYLOAD message does not contain an InReplyTo message ID, shall use the Message ID in the FD SIGNALLING PAYLOAD to identify a new message in the existing conversation thread; and\nii)\tif the FD SIGNALLING PAYLOAD message contains an InReplyTo message ID, shall associate the message to an existing message in the conversation thread as identified by the InReplyTo message ID in the FD SIGNALLING PAYLOAD, and use the Message ID in the FD SIGNALLING PAYLOAD to identify the new message;\nd)\tmay store the Conversation ID, Message ID, InReplyTo message ID and Date and time in local storage;\ne)\tshall attempt to download the file as identified by the file URL in the Payload IE in the FD SIGNALLING PAYLOAD message, as specified in clause 10.2.3.1;\nf)\tif the received FD SIGNALLING PAYLOAD message contains an FD disposition request type IE requesting a file download completed update, then after the file download has been successfully downloaded, shall generate an FD NOTIFICATION by following the procedures in clause 12.2.1.1 with following clarifications:\ni)\tif the received FD SIGNALLING PAYLOAD message is not requested for a file download completed update indication in an FD disposition request type IE, shall not include the target MCData user by skipping the step 3) of clause 12.2.1.1; and\nNOTE 5:\tThe FD disposition request will be sent irrespective of whether the received FD SIGNALLING PAYLOAD message contains an FD disposition request type IE requesting a file download completed update indication or not.\ng)\tif the received FD SIGNALLING PAYLOAD message contains an Application metadata container IE, may process the content of that IE per local policy.\nIn order to upload a file to the media storage function on the controlling MCData function, the MCData UE if not aware of the absolute URI of the media storage function, discovers the absolute URI of the media storage function.\nOn receipt of a \"SIP MESSAGE request for absolute URI discovery request for participating MCData function\", the originating participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall determine the MCData ID of the calling user from the public user identity in the P-Asserted-Identity header field of the SIP MESSAGE request;\nNOTE 1:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request is \"msf-disc-req\":\na)\tif the application/vnd.3gpp.mcdata-info+xml MIME body does not contain a MCData group ID, shall determine the public service identity of the controlling MCData function hosting the one-to-one FD using HTTP service for the calling user; and\nb)\tif the application/vnd.3gpp.mcdata-info+xml MIME body contains a MCData group ID, shall determine the public service identity of the controlling MCData function hosting the group standalone FD using HTTP service, associated with the MCData group identity in the <mcdata-calling-group-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request;\nNOTE 2:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 5:\tHow the originating participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 6:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n5)\tif unable to identify the controlling MCData function, it shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response with the warning text \"142 unable to determine the controlling function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n6)\tshall determine whether the MCData user identified by the MCData ID is authorised for MCData communications by following the procedures in clause 11.1;\n7)\tif the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request does not contain a <mcdata-calling-group-id> element or the procedures in clause 11.1 indicate that the user identified by the MCData ID is not allowed to send MCData communications as determined by step 1) of clause 11.1, shall reject the \"SIP MESSAGE request for and absolute URI discovery request for participating MCData function\" with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"200 user not authorised to transmit data\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\n8)\tshall generate a SIP MESSAGE request accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n9)\tshall copy all MIME bodies included in the incoming SIP MESSAGE request to the outgoing SIP MESSAGE request;\n10)\tshall include the MCData ID of the originating user in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP MESSAGE request;\n11)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP MESSAGE request;\n12)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public user identity of the controlling MCData function as determined by step 4) in this clause;\n13)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function; and\n14)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the SIP MESSAGE request in step 14):\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5]; and\n2)\tshall send the SIP 200 (OK) response to the originating MCData client according to 3GPP TS 24.229 [5].\nOn receipt of a \"SIP MESSAGE request for absolute URI discovery response for the participating function\", the participating MCData function shall: forward the SIP MESSAGE request to the originating MCData client.\nUpon receipt of a SIP 200 (OK) response in response to the forwarded SIP MESSAGE request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5]; and\n2)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [5].\nUpon receiving a \"SIP MESSAGE request for absolute URI discovery request\" message, the controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. Otherwise, continue with the rest of the steps;\n2)\tif the SIP MESSAGE does not contain\tan application/vnd.3gpp.mcdata-info+xml MIME body, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"199 expected MIME bodies not in the request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\n3)\tshall decode the contents of the application/vnd.3gpp.mcdata-info+xml MIME body contained in the SIP MESSAGE;\n4)\tif the <mcdata-calling-group-id> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request is present:\na)\tshall retrieve the group document associated with the group identity in the SIP MESSAGE request by following the procedures in clause 6.3.3, and shall continue with the remaining steps if the procedures in clause 6.3.3 were successful;\nb)\tif the <on-network-disabled> element is present in the group document, shall send a SIP 403 (Forbidden) response with the warning text set to \"115 group is disabled\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nb1)\tif the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element that is set to the value \"true\", shall reject the SIP INVITE request with a SIP 403 (Forbidden) response with the warning text set to \"167 call is not allowed on the preconfigured group\" as specified in clause 4.9 \"Warning header field\" and shall skip the rest of this procedure;\nc)\tif the <list> element of the <list-service> element in the group document does not contain an <entry> element with a \"uri\" attribute matching the MCData ID of the originating user contained in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request, shall send a SIP 403 (Forbidden) response with the warning text set to \"116 user is not part of the MCData group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nd)\tif the <list-service> element contains a<mcdata-allow-file-distribution> element in the group document set to a value of \"false\", shall send a SIP 403 (Forbidden) response with the warning text set to \"213 file distribution not allowed for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\ne)\tif the <supported-services> element is not present in the group document or is present and contains a <service> element containing an \"enabler\" attribute which is not set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", shall send a SIP 488 (Not Acceptable) response with the warning text set to \"214 FD services not supported for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nf)\tif the MCData server group FD procedures in clause 11.1 indicate that the user identified by the MCData ID:\ni)\tis not allowed to send group MCData communications on this group identity as determined by step 1) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"201 user not authorised to transmit data on this group identity\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\nii)\tthe originating user identified by the MCData ID is not affiliated to the group identity contained in the SIP MESSAGE request, as specified in clause 6.x.x, shall return a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\n5)\tshall generate a SIP 200 (OK) response in response to the \"SIP MESSAGE request for absolute URI discovery request for controlling MCData function\";\n6)\tshall send the SIP 200 (OK) response towards the originating participating MCData function according to 3GPP TS 24.229 [5]; and\n7)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]. In the generation of the SIP MESSAGE request, the controlling MCData function:\na)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\nb)\tshall identify the absolute URI of the media storage function associated with the controlling function:\nc)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\";\nd)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request, following the rules specified in clause 6.4 for the handling of MIME bodies in a SIP message, with:\ni)\ta <request-type> element containing the value \"msf-disc-res\"; and\nii)\tan <mcdata-controller-psi> element set to the absolute URI of the media storage function if in step b) above;\ne)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the participating MCData function associated to the MCData ID of the originating user mentioned in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP MESSAGE request; and\nNOTE 1:\tThe public service identity can identify the participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\nf)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the controlling MCData function; and\n8)\tshall send the SIP MESSAGE request towards the participating MCData function as specified in 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.2\tFile upload using HTTP",
                            "text_content": "If the file upload is intended for group file distribution, the media storage client shall determine whether the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element. If a <preconfigured-group-use-only> element exists and is set to the value \"true\", then the media storage client:\n1)\tshould indicate to the MCData user that group file distribution is not allowed on the indicated group; and\n2)\tshall skip the remainder of this procedure.\nThe media storage client shall determine the value of the absolute URI associated with the media storage function of the MCData content server from the <MCDataContentServerURI> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]).\nThe media storage client shall send HTTP requests over a TLS connection as specified for the HTTP client in the UE in annex A of 3GPP TS 24.482 [24].\nNOTE 1:\tThe HTTP client encodes the MCData ID in the bearer access token of the Authorization header field of an HTTP request as specified in 3GPP TS 24.482 [24].\nNOTE 2:\tThe HTTP client always sends the HTTP requests to an HTTP proxy. Annex A of 3GPP TS 24.482 [24] indicates how the HTTP proxy forwards the HTTP request to the HTTP server.\nTo upload a UE-stored file to media storage function on the MCData content server, the media storage client:\n1)\tshall generate an HTTP POST request as specified in IETF RFC 7230 [22] and IETF RFC 7231 [23];\n2)\tshall set the Request-URI to the absolute URI identifying the resource on a media storage function;\n3)\tshall set the Host header field to a hostname identifying the media storage function;\n4)\tshall set the Content-Type header field to multipart/mixed and with a boundary delimiter parameter set to any chosen value;\n5)\tif the file upload is for one-to-one file distribution, shall insert an application/vnd.3gpp.mcdata-info+xml MIME body with:\na)\tthe <request-type> element set to a value of \"one-to-one-fd\"; and\nb)\tthe <mcdata-calling-user-id> element set to the originating MCData ID;\n6)\tif the file upload is for group file distribution, shall insert an application/vnd.3gpp.mcdata-info+xml MIME body with:\na)\tthe <request-type> element set to a value of \"group-fd\";\nb)\tthe <mcdata-request-uri> element set to the MCData group identity; and\nc)\tthe <mcdata-calling-user-id> element set to the originating MCData ID;\n7)\tif end-to-end security is required for a one-to-one communication, the MCData client protects the binary data representing the file and prefixes the protected binary data with security parameters as described in 3GPP TS 33.180 [26];\n8)\tif\na)\tend-to-end security is not required for a one-to-one communication, or\nb)\tthe file upload is for group file distribution;\nshall include the binary data representing the file with Content-Type field set to application/octet-stream and Content-Length field set to the file size; and\n9)\tshall send the HTTP POST request towards the media storage function.\nTo upload a network-stored file to media storage function on the MCData content server, the media storage client:\n1)\tshall generate an HTTP POST request as specified in IETF RFC 7230 [22] and IETF RFC 7231 [23];\n2)\tshall set the Request-URI to the absolute URI identifying the resource on a media storage function;\n3)\tshall set the Host header field to a hostname identifying the media storage function;\n4)\tshall set the Content-Type header field to multipart/mixed and with a boundary delimiter parameter set to any chosen value;\n5)\tif the file upload is for one-to-one file distribution, shall insert an application/vnd.3gpp.mcdata-info+xml MIME body with:\na)\tthe <request-type> element set to a value of \"one-to-one-fd\"; and\nb)\tthe <mcdata-calling-user-id> element set to the originating MCData ID;\n6)\tif the file upload is for group file distribution, shall insert an application/vnd.3gpp.mcdata-info+xml MIME body with:\na)\tthe <request-type> element set to a value of \"group-fd\";\nb)\tthe <mcdata-request-uri> element set to the MCData group identity; and\nc)\tthe <mcdata-calling-user-id> element set to the originating MCData ID;\n7)\tshall insert a message/external-body MIME according to rules and procedures of IETF RFC 2017 [80] with:\na)\tthe Content-Type header field set to message/external-body with:\ni)\tthe access-type parameter set to a value of \"URL\";\nii)\tthe URL parameter set to an absolute URI identifying the URL of the network-stored file being requested to download; and\nNOTE 3:\tFor the network-stored file available in the MCData message store the above URL set as //{serverRoot}/nms/{apiVersion}/{storeName}/{boxId}/objects/{objectId}/payload as indicated by the object's payLoadURL as described in the \"Object\" data structure in clause 5.3.2.1 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\niii)\tthe phantom body area of the message/external-body is not used and should be left blank; and\n8)\tshall send the HTTP POST request towards the media storage function.\nOn receipt of a HTTP 201 Created containing a Location header field with a URL identifying the location of the resource where the file has been stored on the media storage function, the media storage client shall store this information.\nThe media storage function on the MCData content server shall act as an HTTP server as defined in annex A of 3GPP TS 24.482 [24].\nNOTE 1:\tThe HTTP server validates the MCData ID in the bearer access token of the Authorization header field of an HTTP request as specified in 3GPP TS 24.482 [24].\nOn receipt of an HTTP POST request with a Request-URI identifying a resource on the media storage function and message/external-body MIME is not included, the media storage function:\n1)\tshall decode the contents of application/vnd.3gpp.mcdata-info+xml MIME body:\na)\tif the user indicated by <mcdata-calling-user-id> element is not allowed to upload files due to transmission control policy, shall return a HTTP 403 Forbidden response and not continue with the remaining steps in this clause;\nb)\tIf the <request-type> element is set to:\na)\t\"one-to-one-fd\" and the Content-Length header under application/octet-stream MIME is greater than <max-data-size-fd-bytes> element present in the service configuration document as specified in 3GPP TS 24.484 [12], shall generate and send a HTTP 413 Payload Too Large response and not continue with the remaing steps in this clause;\nb)\t\"group-fd\":\ni)\tshall retrieve the group document associated with the group identity indicated in the <mcdata-request-uri> element by following the procedures in clause 6.3.3, and shall continue with the remaining steps if the procedures in clause 6.3.3 were successful;\nii)\tif the Content-Length header under application/octet-stream MIME is greater than <mcdata-on-network-max-data-size-for-FD> element present in the group document retrieved in step i), shall generate and send a HTTP 413 Payload Too Large response and not continue with the remaing steps in this clause;\nEditor's Note: [CR 0133, WI eMCData2] it is FFS to determine how the MCData content server will apply transmission control policy by accessing the configuration documents (e.g service configuration and group configuration) from the MCData server.\n2)\tshall process the HTTP POST request by following the procedures in IETF RFC 7230 [22] and IETF RFC 7231 [23] with the following clarifications:\na)\tshall store the file in the resource location as identified by the Request-URI; and\nb)\tshall generate and send a HTTP 201 Created response containing a Location header field with a URL identifying the location of the stored file.\nOn receipt of an HTTP POST request with a Request-URI identifying a resource on the media storage function and message/external-body MIME is included, the media storage function:\n1)\tshall decode the contents of application/vnd.3gpp.mcdata-info+xml MIME body:\na)\tif the user indicated by <mcdata-calling-user-id> element is not allowed to upload files due to transmission control policy, shall return a HTTP 403 Forbidden response and not continue with the remaining steps in this clause; and\n2)\tshall process the HTTP POST request by following the procedures in IETF RFC 7230 [22] and IETF RFC 7231 [23] with the following clarifications:\na)\tshall determine the resource location as identified by the Request-URI to store the file;\nb)\tshall use the URL parameter value of the Content-Type header field set with message/external-body and fetch the file from the MCData message store as described in clause 6.7, provided that the URL is pointing to a file in the MCData message store account of the user; and\nNOTE 2:\tFor more information on fethcing a file from the MCData message store see clause 6.6 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nc)\tshall generate and send a HTTP 201 Created response containing a Location header field with a URL identifying the location of the stored file in the media storage function of the MCData content server.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.3\tFile download using HTTP",
                            "text_content": "The media storage client shall send HTTP requests over a TLS connection as specified for the HTTP client in the UE, in annex A of 3GPP TS 24.482 [24].\nNOTE 1:\tThe HTTP client encodes the MCData ID in the bearer access token of the Authorization header field of an HTTP request as specified in 3GPP TS 24.482 [24].\nNOTE 2:\tThe HTTP client always sends the HTTP requests to an HTTP proxy. Annex A of 3GPP TS 24.482 [24] indicates how the HTTP proxy forwards the HTTP request to the HTTP server.\nTo download a file from the media storage function on the MCData content server, the media storage client:\n1)\tshall generate an HTTP GET request as specified in IETF RFC 7230 [22] and IETF RFC 7231 [23] with a Request-URI set to an absolute URI identifying the URL of the file being requested from the media storage function on the MCData content server; and\n2)\tshall send the HTTP GET request towards the media storage function on the MCData content server.\nOn receipt of a HTTP 200 OK response containing the requested file, the MCData client shall notify the user or application that the file has been successfully downloaded.\nThe media storage function on the MCData content server shall act as an HTTP server as defined in annex A of 3GPP TS 24.482 [24].\nNOTE 1:\tThe HTTP server validates the MCData ID in the bearer access token of the Authorization header field of an HTTP request as specified in 3GPP TS 24.482 [24].\nOn receipt of an HTTP GET request with a Request-URI identifying a file, the media storage function on the MCData content server:\n1)\tif the MCData user is not allowed to download files due to reception control policy, shall return an HTTP 403 Forbidden response;\n2)\tshall process the HTTP GET request by following the procedures in IETF RFC 7230 [22] and IETF RFC 7231 [23], and shall return a HTTP 200 OK response containing the requested file.\nEditor's Note: [CR 0133, WI eMCData2] it is FFS to determine how the MCData content server will apply reception control policy by accessing the configuration documents (e.g service configuration and group configuration) from the MCData server.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.4\tFD using HTTP",
                            "text_content": "The procedures in the clauses of the parent clause describe the SIP signalling procedures for:\n-\tone-to-one file distribution using HTTP; and\n-\tgroup standalone file distribution using HTTP.\nWhen the MCData user wishes to perform file distribution via HTTP, the MCData client:\n1)\tshall check that the file size is less than or equal to the:\na)\t<mcdata-on-network-max-data-size-for-FD> element present in the group document retrieved by the group management client as specified in 3GPP TS 24.481 [11], if the file upload is for a group file distribution; or\nb)\t<max-data-size-fd-bytes> element present in the service configuration document as specified in 3GPP TS 24.484 [12], if the file upload is for a one-to-one file distribution;\n2)\tif the size of the file:\na)\tis acceptable for upload as determined by step 1), shall determine the value of the absolute URI associated with the media storage function of the MCData content server from the <MCDataContentServerURI> element of the MCPTT user profile document (see the MCPTT user profile document in 3GPP TS 24.484 [12]);\nb)\tis not acceptable for upload, shall not continue with the remaining steps in this clause;\n3)\tshall request the media storage client to upload the file to the media storage function by following the procedures in clause 10.2.2.1; and\n4)\tshall initiate an FD request containing a file URL as specified in clause 10.2.4.2.1.\nIf a group standalone FD message is to be sent, the MCData client shall determine whether the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element. If a <preconfigured-group-use-only> element exists and is set to the value \"true\", then the MCData client:\n1)\tshould indicate to the MCData user that group standalone FD is not allowed on the indicated group; and\n2)\tshall skip the remainder of this procedure.\nThe MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] with the clarifications given below.\nThe MCData client:\n1)\tshall build the SIP MESSAGE request as specified in clause 6.2.4.1;\n2)\tif a one-to-one standalone FD message is to be sent shall insert in the SIP MESSAGE request:\na)\tan application/resource-lists+xml MIME body with the MCData ID of the target MCData user or the functional alias to be called in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, according to rules and procedures of IETF RFC 4826 [9]; and\nb)\tan application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\ta <request-type> element set to a value of \"one-to-one-fd\"; and\nii)\tan <anyExt> element containing:\nA)\ta <call-to-functional-alias-ind> element set to \"true\" if the functional alias is used in the step a) above;\nB)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP MESSAGE request, the <functional-alias-URI> element set to the URI of the used functional alias; and\nC)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value;\n3)\tif a group standalone FD message is to be sent:\na)\tif the \"/<x>/<x>/Common/MCData/AllowedFD\" leaf node present in the group document of the requested MCData group as specified in 3GPP TS 24.483 [42] is set to \"false\", shall reject the request for FD and not continue with the rest of the steps in this clause; and\nb)\tshall insert in the SIP MESSAGE request an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <request-type> element set to a value of \"group-fd\";\nii)\tthe <mcdata-request-uri> element set to the MCData group identity;\niii)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\niv)\tan <anyExt> element containing:\nA)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP MESSAGE request, the <functional-alias-URI> element set to the URI of the used functional alias; and\nB)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value;\n4)\tshall generate a standalone FD message as specified in clause 6.2.2.2; and\n5)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5].\nUpon receiving a SIP 300 (Multiple Choices) response to the SIP MESSAGE request the MCData client shall use the MCData ID contained in the <mcdata-request-uri> element of the received application/vnd.3gpp.mcdata-info MIME body as the MCData ID of the invited MCData user and shall generate a new SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6], with the clarifications given in this clause and with the following additional clarifications:\n1)\tshall insert in the newly generated SIP MESSAGE request an application/resource-lists+xml MIME body with the MCData ID of the invited MCData user in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body where the MCData ID is found in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info MIME body in the received SIP 300 (Multiple Choices) response;\n2)\tshall not include a <call-to-functional-alias-ind> element into the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\n3)\tshall include a <called-functional-alias-URI> element into the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body with the target functional alias used in the initial SIP MESSAGE request for for sending one-to-one standalone FD message.\nUpon receipt of a \"SIP MESSAGE request for FD using HTTP for terminating MCData client\", the MCData client:\n1)\tmay reject the SIP MESSAGE request if there are not enough resources to handle the SIP MESSAGE request;\n2)\tif the SIP MESSAGE request is rejected in step 1), shall respond towards the participating MCData function with a SIP 480 (Temporarily unavailable) response and skip the rest of the steps of this clause;\n3)\tshall generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\n4)\tshall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5]; and\n5)\tshall handle the received message as specified in clause 10.2.1.2.\nUpon receipt of a \"SIP MESSAGE request for FD using HTTP for originating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall determine the MCData ID of the originating user from the public user identity in the P-Asserted-Identity header field of the SIP MESSAGE request, and shall authorise the calling user;\nNOTE 1:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tif <mcdata-controller-psi> element is present in the application/vnd.3gpp.mcdata-info+xml, shall use its value as public service identity of the controlling MCData function. Otherwise, if the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request is:\na)\tset to a value of \"group-fd\", shall determine the public service identity of the controlling MCData function hosting the group standalone FD using HTTP service, associated with the MCData group identity in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request; or\nb)\tset to a value of \"one-to-one-fd\", shall determine the public service identity of the controlling MCData function hosting the one-to-one FD using HTTP service for the calling user;\nNOTE 2:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 5:\tHow the participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 6:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n5)\tif unable to identify the controlling MCData function, it shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response with the warning text \"142 unable to determine the controlling function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n6)\tshall determine whether the MCData user identified by the MCData ID is authorised for MCData communications by following the procedures in clause 11.1;\n7)\tif <mcdata-controller-psi> in not present in the application/vnd.3gpp.mcdata-info+xml and if the procedures in clause 11.1 indicate that the user identified by the MCData ID:\na)\tis not allowed to initiate MCData communications as determined by step 1) of clause 11.1, shall reject the \"SIP MESSAGE request for FD using HTTP for originating participating MCData function\" with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"200 user not authorised to transmit data\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\nb)\tis not allowed to initiate one-to-one MCData communications due to exceeding the maximum amount of data that can be sent in a single request as determined by step 7) of clause 11.1, shall reject the \"SIP MESSAGE request for FD using HTTP for originating participating MCData function\" with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"202 user not authorised for one-to-one MCData communications due to exceeding the maximum amount of data that can be sent in a single request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\nc)\tis not allowed to initiate one-to-one MCData communications to the targeted user as determined by step 1a) of clause 11.1, shall reject the \"SIP MESSAGE request for FD using HTTP for originating participating MCData function\" with a SIP 403 (Forbidden) response including warning text set to \"229 one-to-one MCData communication not authorised to the targeted user\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n8)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n9)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the controlling MCData function as determined by step 4) in this clause;\n10)\tshall copy all MIME bodies included in the incoming SIP MESSAGE request to the outgoing SIP MESSAGE request;\n10A)\tif the incoming SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body that contains a <functional-alias-URI> element, shall check if the status of the functional alias is activated for the MCData ID. If the functional alias status is activated, then the participating MCData function shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request to the received value, otherwise shall not include a <functional-alias-URI> element;\n11)\tshall include the MCData ID of the originating user in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP MESSAGE request;\n12)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP MESSAGE request;\n13)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function; and\n14)\tshall send the SIP MESSAGE request as specified to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 202 (Accepted) response in response to the SIP MESSAGE request in step 14):\n1)\tshall generate a SIP 202 (Accepted) response as specified in 3GPP TS 24.229 [5]; and\n2)\tshall send the SIP 202 (Accepted) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the SIP MESSAGE request in step 14):\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5]; and\n2)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the SIP MESSAGE request in step 14) the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a:\n-\t\"SIP MESSAGE request for FD using HTTP for terminating participating MCData function\"; or\n-\t\"SIP MESSAGE network notification for FD using HTTP for terminating participating MCData function\";\nthe participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request to retrieve the binding between the MCData ID and public user identity of the terminating MCData user;\n3)\tif the binding between the MCData ID and public user identity of the terminating MCData user does not exist, then the participating MCData function shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response, and shall not continue with the rest of the steps;\n4)\tif the SIP MESSAGE is a \"SIP MESSAGE request for FD using HTTP for terminating participating MCData function\", and if the application/vnd.3gpp.mcdata-signalling MIME body contains an FD SIGNALLING PAYLOAD message with a FD disposition request type IE, shall store the value of the Conversation ID IE, the value of the Message ID IE and the payload IE in the FD SIGNALLING PAYLOAD message;\n5)\tif the SIP MESSAGE is a \"SIP MESSAGE network notification for FD using HTTP for terminating participating MCData function\", and if FD NETWORK NOTIFICATION message within the application/vnd.3gpp.mcdata-signalling MIME body contains an FD notification type IE with value set as \"FILE EXPIRED UNAVAILABLE TO DOWNLOAD\" as specified in clause 15.2.6, the file identified using Conversation ID IE shall be removed from the stored file list;\n5)\tshall generate an outgoing SIP MESSAGE request as specified in clause 6.3.2.1;\n5A)\tif the <IncomingOne-to-OneCommunicationList> element exists in the MCData user profile document with one or more <One-to-One-CommunicationListEntry> elements (see the MCData user profile document in 3GPP TS 24.484 [12]) and:\ni)\tif the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP message does not match with the <entry> element of any of the <One-to-One-CommunicationListEntry> elements in the <IncomingOne-to-OneCommunicationList> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]); and\nii)\tif configuration is not set in the MCData user profile document that allows the MCData user to receive one-to-one MCData communication from any user (see <allow-one-to-one-communication-from-any-user> element in MCData user profile document in 3GPP TS 24.484 [12]);\nthen:\ni)\tshall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"230 one-to-one MCData communication not authorised from this originating user\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n6)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP MESSAGE request; and\n7)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the above SIP MESSAGE request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5]; and\n2)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP MESSAGE request, the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the controlling MCData function according to 3GPP TS 24.229 [5].\nThis clause describes the procedures for sending a SIP MESSAGE from the controlling MCData function and is initiated by the controlling MCData function as a result of an action in clause 10.2.4.4.2.\nThe controlling MCData function:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.fd media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\n3)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\n4)\tshall copy the following MIME bodies in the received SIP MESSAGE request into the outgoing SIP MESSAGE request by following the guidelines in clause 6.4:\na)\tapplication/vnd.3gpp.mcdata-info+xml MIME body; and\nb)\tapplication/vnd.3gpp.mcdata-signalling MIME body;\n5)\tif the application/vnd.3gpp.mcdata-signalling MIME body in the received SIP MESSAGE request contained a FD SIGNALLING PAYLOAD message without the Mandatory download IE included, then:\na)\tshall execute the procedures in clause 11.2;\nb)\tif the procedures in clause 11.2 indicate that the mandatory download indication needs to be included, shall include the Mandatory download IE set to a value of \"MANDATORY DOWNLOAD\" in the FD SIGNALLING PAYLOAD message of the outgoing SIP MESSAGE request;\n6)\tin the application/vnd.3gpp.mcdata-info+xml MIME body:\na)\tshall set the <mcdata-request-uri> element set to the MCData ID of the terminating user; and\nb)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request was set to a value of \"group-fd\", shall set the <mcdata-calling-group-id> element to the group identity;\n7)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated to the MCData user to be invited;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n8)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the controlling MCData function;\n9)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\"; and\n10)\tshall send the SIP MESSAGE request according to according to rules and procedures of 3GPP TS 24.229 [5].\nThe procedures in this clause are executed upon:\n-\treceipt of a \"SIP MESSAGE request for FD using HTTP for controlling MCData function\", the controlling MCData function; or\n-\ta decision to now process a previously received \"SIP MESSAGE request for FD using HTTP for controlling MCData function\" that had been queued for later transmission.\nNOTE 1:\tThe controlling MCData function may postpone the continuation of an FD using HTTP procedure by queuing the received \"SIP MESSAGE request for FD using HTTP for controlling MCData function\". The management of the queue is specified in Annex B of 3GPP TS 23.282 [2].\nThe controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response or queue the received SIP MESSAGE. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4];\n2)\tif the received SIP MESSAGE request has been queued for later transmission, shall include warning text set to \"215 request to transmit is queued by the server\" in a Warning header field as specified in clause 4.9, in the SIP 202 (Accepted) response and not continue with the remaining steps in this clause. Otherwise, continue with the rest of the steps;\n3)\tif the SIP MESSAGE does not contain:\na)\tan application/vnd.3gpp.mcdata-info+xml MIME body; and\nb)\tan application/vnd.3gpp.mcdata-signalling MIME body;\nshall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"199 expected MIME bodies not in the request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\n4)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body contained in the SIP MESSAGE;\n5)\tif the application/vnd.3gpp.mcdata-signalling MIME body does not contain only one FD SIGNALLING PAYLOAD message or FD HTTP TERMINATION message, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"209 one FD SIGNALLING PAYLOAD message or FD HTTP TERMINATION message only must be present in FD request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\n6)\tif the FD SIGNALLING PAYLOAD message or FD HTTP TERMINATION message does not contain only one Payload IE, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"210 Only one File URL must be present in the FD request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\n7)\tif the Payload IE has Payload contents:\na)\twith a Payload content type set to a value other than \"FILEURL\" shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"211 payload for an FD request is not FILEURL\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\nb)\twith Payload data containing a file URL identifying a file that does not exist on the media storage function as determined by the procedures of clause 6.7.3, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"212 file referenced by file URL does not exist\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\n8)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains an FD SIGNALLING PAYLOAD message with a FD disposition request type IE, shall store the value of the Conversation ID IE and the value of the Message ID IE in the FD SIGNALLING PAYLOAD message;\nNOTE 2:\tThe controlling MCData function uses the Conversation ID and Message ID for correlation with disposition notifications.\n9)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains an FD SIGNALLING PAYLOAD message:\na)\twith a Metadata IE, shall derive a timer value for the file availability timer as the minimum of the file availability information in the metadata and the value contained in the <max-file-availability> element in the MCData service configuration document as specified in 3GPP TS 24.484 [12];\nb)\twithout a Metadata IE, shall derive a timer value for the file availability timer as the value contained in the <default-file-availability> element in the MCData service configuration document as specified in 3GPP TS 24.484 [12]; and\nc)\tif the FD SIGNALLING PAYLOAD message contains an Application metadata container IE, shall keep the Application metadata container IE with the file, both in storage and in any subsequent transmissions;\n10)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request is set to a value of \"one-to-one-fd\" and the SIP MESSAGE request:\na)\tdoes not contain an application/resource-lists+xml MIME body or contains an application/resource-lists+xml MIME body with more than one <entry> element in the set of <list> elements in the <resource-lists> element, shall return a SIP 403 (Forbidden) response with the warning text set to \"205 unable to determine targeted user for one-to-one FD\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below; and\nb)\tif the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body contains a <call-to-functional-alias-ind> element set to a value of \"true\":\ni)\tshall identify the MCData ID(s) of the MCData user(s) that have activated the called functional alias received in the uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the SIP MESSAGE request by performing the actions specified in clause 22.2.2.2.8;\nii)\tif unable to determine any MCData ID that has activated the called functional alias received in the uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the SIP MESSAGE, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including a warning text set to \"145 unable to determine called party\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps; and\niii)\tselects one of the identified MCData IDs, and shall send a SIP 300 (Multiple Choices) response to the SIP MESSAGE request with:\nA)\tan application/vnd.3gpp.mcdata-info MIME body with an <mcdata-request-uri> element set to the selected MCData ID and shall not continue with the rest of the steps in this clause;\nNOTE 3:\tHow the controlling MCData function selects the MCData ID is implementation specific.\nc)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains an FD SIGNALLING PAYLOAD message contains an application/resource-lists+xml MIME body with exactly one <entry> element in the set of <list> elements in the <resource-lists> element, shall send a SIP MESSAGE request to the MCData user identified in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, as specified in clause 10.2.4.4.1;\n11)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains an FD HTTP TERMINATION message:\na)\tif the FD HTTP TERMINATION message doesn't contain Conversation Id or Message Id, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"223 No Conversation ID or Message ID present\" and shall not continue with rest of the steps; and\nb) if not identified any transmission with given Conversation ID, Message ID shall send 404 with reason with waring text set to \"224 No transmission available\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\n12)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains an FD SIGNALLING PAYLOAD message and if the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request is set to a value of \"group-fd\":\na)\tshall retrieve the group document associated with the group identity in the SIP MESSAGE request by following the procedures in clause 6.3.3, and shall continue with the remaining steps if the procedures in clause 6.3.3 were successful;\nb)\tif the <on-network-disabled> element is present in the group document, shall send a SIP 403 (Forbidden) response with the warning text set to \"115 group is disabled\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nb1)\tif the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element that is set to the value \"true\", shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response with the warning text set to \"167 call is not allowed on the preconfigured group\" as specified in clause 4.9 \"Warning header field\" and shall skip the rest of this procedure;\nc)\tif the <entry> element of the <list> element of the <list-service> element in the group document does not contain an <mcdata-mcdata-id> element with a \"uri\" attribute matching the MCData ID of the originating user contained in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request, shall send a SIP 403 (Forbidden) response with the warning text set to \"116 user is not part of the MCData group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nd)\tif the <list-service> element contains a <mcdata-allow-file-distribution> element in the group document set to a value of \"false\", shall send a SIP 403 (Forbidden) response with the warning text set to \"213 file distribution not allowed for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\ne)\tif the <supported-services> element is not present in the group document or is present and contains a <service> element containing an \"enabler\" attribute which is not set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", shall send a SIP 488 (Not Acceptable) response with the warning text set to \"214 FD services not supported for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nf)\tif the MCData server group FD procedures in clause 11.1 indicate that the user identified by the MCData ID:\ni)\tis not allowed to initiate group MCData communications on this group identity as determined by step 2) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"201 user not authorised to transmit data on this group identity\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\nii)\tis not allowed to initiate group MCData communications on this group identity due to exceeding the maximum amount of data that can be sent in a single request as determined by step 8) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"208 user not authorised for MCData communications on this group identity due to exceeding the maximum amount of data that can be sent in a single request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\niii)\tis not allowed to initiate group MCData communications on this group identity due to exceeding the maximum allowed file size as determined by step 6) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"208 user not authorised for MCData communications on this group identity due to exceeding the maximum amount of data that can be sent in a single request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\ng)\tif the originating user identified by the MCData ID is not affiliated to the group identity contained in the SIP MESSAGE request, as specified in clause 6.3.5, shall return a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\nh)\tshall determine targeted group members for MCData communications by following the procedures in clause 6.3.4;\ni)\tif the procedures in clause 6.3.4 result in no affiliated members found in the selected MCData group, shall return a SIP 403 (Forbidden) response with the warning text set to \"198 no users are affiliated to this group\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below; and\nj)\tshall send SIP MESSAGE requests to the targeted group members identified in step j) above by following the procedure in clause 10.2.4.4.1;\n13)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains an FD SIGNALLING PAYLOAD message, shall start TDC2 (file availability timer) with the value derived in step 9 of this clause;\n14)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains an FD SIGNALLING PAYLOAD message, shall associate the running timer TDC2 (file availability timer) to the Conversation ID, Message ID, Application ID (if included), and Extended application ID (if included) contained in the FD SIGNALLING PAYLOAD message;\nNOTE 4:\tMultiple file availability timers can be running for a file. Each file availability timer is uniquely associated to a Conversation ID and Message ID.\n15)\tshall generate a SIP 202 (Accepted) response in response to the \"SIP MESSAGE request for FD using HTTP for controlling MCData function\";\n16)\tshall send the SIP 202 (Accepted) response towards the originating participating MCData function according to 3GPP TS 24.229 [5].\n17)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains an FD HTTP TERMINATION message and Termination information type IE set to \"TERMINATION REQUEST\" then:\na)\tshall identify the FILE transmission with Conversation ID and Message ID and \"FILE URL\". If any ongoing transmission exist then execute the procedure described in clause 12.4.2.1 with the following clarifications:\ni)\tshall set the FD notification type IE as \"FILE DELETED UNAVAILABLE TO DOWNLOAD\" as specified in clause 15.2.18;\nb)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]. In the generation of the SIP MESSAGE request, the controlling MCData function:\ni)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\nii)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\";\niii)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the participating MCData function associated to the MCData ID of the originating user mentioned in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request;\nNOTE 5:\tThe public service identity can identify the participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 6:\tIf the participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 7:\tIf the participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 8:\tHow the controlling MCData function determines the public service identity of the participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 9:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\niv)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the controlling MCData function;\nv)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request, following the rules specified in clause 6.4 for the handling of MIME bodies in a SIP message:\nA)\tfill <mcdata-request-uri> element from <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml in received SIP MESSAGE;\nvi)\tshall generate FD HTTP TERMINATION message as described in clause 6.3.6.1;\nvii)\tshall set the Termination information type IE set to \"TERMINATION RESPONSE\" as specified in clause 15.2.22.\nviii)\tif clause is successful shall set Release response type IE of FD HTTP TERMINATION MESSAGE to \"RELEASE SUCCESS\" else set to \"RELEASE FAILED\" as described in clause 15.2.23; and\nix)\tshall include in the SIP request, the FD HTTP TERMINATION message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1; and\nc)\tshall send the SIP MESSAGE request towards the originating participating MCData function as specified in 3GPP TS 24.229 [5]; and\n18)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains an FD HTTP TERMINATION message and Termination information type IE set to other than \"TERMINATION REQUEST\" then follow procedures described on clause 13.2.5 and clause 13.2.6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.5\tFD using media plane",
                            "text_content": "The procedures in the clauses of the parent clause describe the SIP signalling procedures for:\n-\tone-to-one file distribution using media plane; and\n-\tgroup standalone file distribution using media plane.\nWhen composing an SDP offer according to 3GPP TS 24.229 [5], IETF RFC 5547 [69], IETF RFC 6135 [19], and IETF RFC 6714 [20], the MCData client:\n1)\tshall include an \"m=message\" media-level section for the MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS;\nc)\tan \"a=sendonly\" attribute;\nd)\tan \"a=path\" attribute containing its own MSRP URI;\ne)\tset the content type as \"a=accept-types:application/vnd.3gpp.mcdata-signalling\";\nf)\tset the a=setup attribute as \"actpass\";\ng)\ta file-selector attribute containing:\ni)\ta 'name' selector;\nii)\ta 'type' selector;\niii)\ta 'size' selector; and\niv)\ta 'hash' selector;\nh)\ta file-date attribute; and\ni)\ta file-description attribute; and\n2)\tif end-to-end security is required for a one-to-one communication and the security context does not exist or if the existing security context has expired, shall include the MIKEY-SAKKE I_MESSAGE in an \"a=key-mgmt\" attribute as a \"mikey\" attribute value in the SDP offer as specified in IETF RFC 4567 [45].\nWhen the MCData client receives an initial SDP offer for file distribution, the MCData client shall process the SDP offer and shall compose an SDP answer according to 3GPP TS 24.229 [5] and IETF RFC 5547 [69].\nWhen composing an SDP answer, the MCData client:\n1)\tshall include an \"m=message\" media-level section for the accepted MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS according to the received SDP offer;\nc)\tan \"a=recvonly\" attribute;\nd)\tan \"a=path\" attribute containing its own MSRP URI;\ne)\tset the content type as a=accept-types:application/vnd.3gpp.mcdata-signalling;\nf)\tset the a=setup attribute according to IETF RFC 6135 [19]; and\ng)\ta file-selector attribute containing:\ni)\ta 'name' selector;\nii)\ta 'type' selector;\niii)\ta 'size' selector; and\niv)\ta 'hash' selector.\nThe MCData client shall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [5] with the clarifications given below.\nThe MCData client:\n1)\tshall include the g.3gpp.mcdata.fd media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in the Contact header field of the SIP INVITE request according to IETF RFC 3840 [16];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.fd media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n3)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n4)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n5)\tshould include the \"timer\" option tag in the Supported header field;\n6)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n7)\tshall generate and contain an application/vnd.3gpp.mcdata-signalling MIME body with the FD SIGNALLING PAYLOAD as described in clause 6.2.2.3;\n8)\tif a one-to-one file distribution is requested:\na0)\tif the MCData user has requested the origination of an MCData emergency one-to-one communication or is originating an MCData one-to-one communication and the MCData emergency state is already set, then:\ni)\tif this is an authorised request for an MCData emergency one-to-one communication as determined by the procedures of clause 6.2.8.3.1.1, shall comply with the procedures in clause 6.2.8.3.2; or\nii)\tif this is an unauthorised request for an MCData emergency one-to-one communication as determined in step i) above, should indicate to the MCData user that initiation of an MCData emergency one-to-one communication is not authorized and shall release the generated SIP INVITE request and end the procedure;\na)\tshall insert in the SIP INVITE request an application/resource-lists+xml MIME body with the MCData ID of the invited MCData user or the functional alias to be called in the \"uri\" attribute of an <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, according to rules and procedures of IETF RFC 5366 [18];\nNOTE 0:\tThe MCData client indicates whether an MCData ID or a functional alias is to be called as specified in step 8) b) below.\nb)\tshall contain an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <request-type> element set to a value of \"one-to-one-fd\"; and\nii)\tan <anyExt> element containing:\nA)\tthe <call-to-functional-alias-ind> element set to \"true\" if the functional alias is used as a target of the call request;\nB)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP INVITE request, the <functional-alias-URI> element set to the URI of the used functional alias; and\nC)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value;\nc)\tif an end-to-end security context needs to be established and the security context does not exist or if the existing security context has expired, then:\ni)\tif necessary, shall instruct the key management client to request keying material from the key management server as described in 3GPP TS 33.180 [26];\nii)\tshall use the keying material to generate a PCK as described in 3GPP TS 33.180 [26];\niii)\tshall use the PCK to generate a PCK-ID with the four most significant bits set to \"0001\" to indicate that the purpose of the PCK is to protect one-to-one communications and with the remaining twenty eight bits being randomly generated as described in 3GPP TS 33.180 [26];\niv)\tshall encrypt the PCK to a UID associated to the MCData client using the MCData ID of the invited user and a time related parameter as described in 3GPP TS 33.180 [26];\nv)\tshall generate a MIKEY-SAKKE I_MESSAGE using the encapsulated PCK and PCK-ID as specified in 3GPP TS 33.180 [26];\nvi)\tshall add the MCData ID of the originating MCData user to the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26]; and\nvii)\tshall sign the MIKEY-SAKKE I_MESSAGE using the originating MCData user's signing key provided in the keying material together with a time related parameter, and add this to the MIKEY-SAKKE payload, as described in 3GPP TS 33.180 [26]; and\nd)\tif the MCData emergency private communication state is set to either \"MDEPC 2: emergency-pc-requested\" or \"MDEPC 3: emergency-pc-granted\" or if the MCData emergency private priority state of this one-to-one communication is set to a value other than \"MDEPP 2: in-progress\" or \"MDEPP 3: confirm-pending\", shall execute the procedures in clause 6.2.8.3.3 to include the Resource-Priority header field;\n9)\tif a group file distribution is requested:\na)\tif the \"/<x>/<x>/Common/MCData/AllowedFD\" leaf node present in the group document of the requested MCData group as specified in 3GPP TS 24.483 [42] is set to \"false\", shall reject the request for FD and not continue with the rest of the steps in this clause;\na1)\tif the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element. If a <preconfigured-group-use-only> element exists and is set to the value \"true\", then the MCData client:\ni)\tshould indicate to the MCData user that group file distribution is not allowed on the indicated group; and\nii)\tshall skip the remainder of this procedure; and\nb)\tshall contain in an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <request-type> element set to a value of \"group-fd\";\nii)\tthe <mcdata-request-uri> element set to the MCData group identity;\niii)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\nNOTE 1:\tThe MCData client does not include the MCData ID of the originating MCData user in the body, as this will be inserted into the body of the SIP INVITE request that is sent from the originating participating MCData function.\niv)\tan <anyExt> element containing:\nA)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP INVITE request, the <functional-alias-URI> element set to the URI of the used functional alias; and\nB)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value;\nc)\tif the MCData user has requested the origination of an MCData emergency group communication or is originating an MCData pre-arranged group communication and the MCData emergency state is already set, the MCData client shall execute the procedures in clause 6.2.8.1.1;\nd)\tif the MCData user has requested the origination of an MCData imminent peril group communication, the MCData client shall execute the procedures in clause 6.2.8.1.9;\ne)\tif the MCData client emergency group state for this group is set to \"MDEG 2: in-progress\" or \"MDEG 4: confirm-pending\", the MCData client shall execute the procedures in clause 6.2.8.1.2 to include the Resource-Priority header field; and\nf)\tif the MCData client imminent peril group state for this group is set to \"MDIG 2: in-progress\" or \"MDIG 4: confirm-pending\", shall execute the procedures in clause 6.2.8.1.12 to include the Resource-Priority header field;\n10)\tshall set the Request-URI of the SIP INVITE request to the public service identity identifying the participating MCData function serving the MCData user;\nNOTE 2:\tThe MCData client is configured with public service identity identifying the participating MCData function serving the MCData user.\n11)\tmay include a P-Preferred-Identity header field in the SIP INVITE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n12)\tshall include an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 10.2.5.2.1; and\n13)\tshall send the SIP INVITE request towards the MCData server according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 300 (Multiple Choices) response to the SIP INVITE request the MCData client shall use the MCData ID of MCData user contained in the <mcdata-request-uri> element of the received application/vnd.3gpp.mcdata-info MIME body as the MCData ID of the invited MCData user and shall generate an initial SIP MCData request by following the UE originating session procedures specified in 3GPP TS 24.229 [5], with the clarifications given in this clause and with the following additional clarifications:\n1)\tshall insert in the newly generated SIP INVITE request an application/resource-lists+xml MIME body with the MCData ID of the invited MCData user in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body where the MCData ID is found in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info MIME body in the received SIP 300 (Multiple Choices) response;\n2)\tshall not include a <call-to-functional-alias-ind> element into the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\n3)\tshall include a <called-functional-alias-URI> element into the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body with the target functional alias used in the initial SIP INVITE request for establishing a session for one-to-one file distribution.\nOn receipt of a SIP 2xx response to the SIP INVITE request, the MCData client:\n0)\tif the response is to a SIP INVITE request for an MCData emergency group an MCData imminent peril group communication, shall perform the actions specified in clause 6.2.8.1.4;\n1)\tif the response is to a SIP INVITE request for an MCData emergency one-to-one communication, shall perform the actions specified in clause 6.2.8.3.4;\n2)\tshall send a SIP ACK request as specified in 3GPP TS 24.229 [5];\n3)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38]; and\n4)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 7.1.2.\nOn receipt of a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request, the MCData client:\n0)\tif the response is to a SIP INVITE request for an MCData emergency group communication an MCData imminent peril group communication, shall perform the actions specified in clause 6.2.8.1.5;\n1)\tif the response is to a SIP INVITE request for an MCData emergency one-to-one communication, shall perform the actions specified in clause 6.2.8.3.5;\n2)\tshall indicate to the MCData user that the file could not be sent; and\n3)\tshall send a SIP ACK request as specified in 3GPP TS 24.229 [5].\nOn receipt of a SIP INFO request where the Request-URI contains an MCData session ID identifying an ongoing group session, the MCData client shall follow the actions specified in clause 6.2.8.1.13.\nOn receipt of a SIP INFO request where the Request-URI contains an MCData session ID identifying an ongoing one to-one session, the MCData client shall follow the actions specified in clause 6.2.8.3.7.\nOn receipt of an indication from the media plane indicating that the file was not sent successfully, the MCData client shall:\n1)\tshall generate a SIP BYE request according to 3GPP TS 24.229 [5] with:\na)\tReason code set to \"SIP\";\nb)\tcause set to \"480\"; and\nc)\ttext set to \"transmission failed\";\n2)\tshall set the Request-URI to the MCData session identity to release; and\n3)\tshall send a SIP BYE request towards MCData server according to 3GPP TS 24.229 [5].\nUpon receipt of a \"SIP INVITE request for file distribution for terminating MCData client\" request, the MCData client shall follow the procedures for termination of multimedia sessions in the IM CN subsystem as specified in 3GPP TS 24.229 [5] with the clarifications below.\nThe MCData client:\n1)\tmay reject the SIP INVITE request if any of the following conditions are met:\na)\tMCData client does not have enough resources to handle the communication;\nb)\tit is an emergency group file distribution request and the number of maximum simultaneous emergency group calls supported for the specific calling functional alias as specified in the <MaxSimultaneousEmergencyGroupCalls> element within the <FunctionalAliasList> list element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) has been reached; or\nc)\tany other reason outside the scope of this specification;\n2)\tif the SIP INVITE request is rejected in step 1), shall respond toward the participating MCData function either with an appropriate reject code as specified in 3GPP TS 24.229 [5] and warning texts as specified in clause 4.9 or with SIP 480 (Temporarily unavailable) response not including warning texts if the user is authorised to restrict the reason for failure and skip the rest of the steps of this clause;\n3)\tif the SDP offer of the SIP INVITE request contains an \"a=key-mgmt\" attribute field with a \"mikey\" attribute value containing a MIKEY-SAKKE I_MESSAGE:\na)\tshall extract the MCData ID of the originating MCData user from the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26];\nb)\tshall convert the MCData ID to a UID as described in 3GPP TS 33.180 [26];\nc)\tshall use the UID to validate the signature of the MIKEY-SAKKE I_MESSAGE as described in 3GPP TS 33.180 [26];\nd)\tif authentication verification of the MIKEY-SAKKE I_MESSAGE fails, shall reject the SIP INVITE request with a SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [45], and include warning text set to \"136 authentication of the MIKEY-SAKKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and not continue with rest of the steps in this clause; and\ne)\tif the signature of the MIKEY-SAKKE I_MESSAGE was successfully validated:\ni)\tshall extract and decrypt the encapsulated PCK using the terminating user's (KMS provisioned) UID key as described in 3GPP TS 33.180 [26]; and\nii)\tshall extract the PCK-ID, from the payload as specified in 3GPP TS 33.180 [26];\nNOTE 1:\tWith the PCK successfully shared between the originating MCData client and the terminating MCData client, both clients are able to create an end-to-end secure session.\n4)\tmay display to the MCData user the MCData ID of the inviting MCData user;\n4A)\tmay display to the MCData user the functional alias of the inviting MCData user, if provided;\n5)\tmay display to the MCData user the file meta-data of the incoming file as described by the SDP included in the received SIP INVITE request;\n5A)\tif the SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing an <mcdata-Params> element containing an <mcdata-calling-group-id> element and containing a <request-type> element set to a value of \"group-fd\" and also containing the an the <emergency-ind> element set to a value of \"true\":\na)\tshould display to the MCData user an indication that this is a SIP INVITE request for an MCData emergency group communication and:\ni)\tshould display the MCData ID of the originator of the MCData emergency group communication contained in the <mcdata-calling-user-id> element of the <mcdata-Params> of the application/vnd.3gpp.mcdata-info+xml MIME body;\nii)\tshould display the MCData group identity of the group with the emergency condition contained in the <mcdata-calling-group-id> element of the <mcdata-Params> of the application/vnd.3gpp.mcdata-info+xml MIME body; and\niii)\tif the <alert-ind> element within the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body is set to \"true\", should display to the MCData user an indication of the MCData emergency alert and associated information;\nb)\tshall set the MCData emergency group state to \"MDEG 2: in-progress\";\nc)\tshall set the MCData imminent peril group state to \"MDIG 1: no-imminent-peril\"; and\nd)\tshall set the MCData imminent peril group communication state to \"MDIGC 1: imminent-peril-gc-capable\"; otherwise\n5B)\tif the SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing an <mcdata-Params> element containing an <mcdata-calling-group-id> element and containing a <request-type> element set to a value of \"group-fd\" and also containing an <imminentperil-ind> element set to a value of \"true\":\na)\tshould display to the MCData user an indication that this is a SIP INVITE request for an MCData imminent peril group communication and:\ni)\tshould display the MCData ID of the originator of the MCData imminent peril group communication contained in the <mcdata-calling-user-id> element of the <mcdata-Params of the application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tshould display the MCData group identity of the group with the imminent peril condition contained in the <mcdata-calling-group-id> element of the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tshall set the MCData imminent peril group state to \"MDIG 2: in-progress\";\n5C)\tif the SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element containing a <request-type> element set to a value of \"one-to-one-fd\" and also containing an <emergency-ind> element set to a value of \"true\":\na)\tshould display to the MCData user an indication that this is a SIP INVITE request for an MCData emergency private communication and:\ni)\tshould display the MCData ID of the originator of the MCData emergency private communication contained in the <mcdata-calling-user-id> element of the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tif the <alert-ind> element within the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body is set to \"true\", should display to the MCData user an indication of the MCData emergency alert and associated information; and\nb)\tshall set the MCData emergency private priority state to \"MDEPP 2: in-progress\" for this private communication;\n6)\tif the Mandatory download IE of the FD SIGNALLING PAYLOAD contained in the application/vnd.3gpp.mcdata-signalling MIME body received in the SIP INVITE request is set to \"MANDATORY DOWNLOAD\" or if the user has accepted the file download request, then:\na)\tshall accept the SIP INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\nb)\tshall include the option tag \"timer\" in a Require header field of the SIP 200 (OK) response;\nc)\tshall include the Session-Expires header field in the SIP 200 (OK) response and start the SIP session timer according to IETF RFC 4028 [38]. The \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\nd)\tshall include the g.3gpp.mcdata.fd media feature tag in the Contact header field of the SIP 200 (OK) response;\ne)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in the Contact header field of the SIP 200 (OK) response;\nf)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5] with the clarifications given in clause 10.2.5.2.2;\ng)\tif a SIP CANCEL request associated with the SIP INVITE request was received, shall execute the procedure in clause 6.2.8.4.1, otherwise, shall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5]; and\nh)\tIf the SIP 200 (OK) response to the received SIP INVITE request was sent, on receipt of an SIP ACK message to the sent SIP 200 (OK) message, the MCData client shall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.1.2.3;\notherwise, if the user has not accepted or has rejected the file download request:\na)\tshall send a SIP 403 (Forbidden) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5]; and\nNOTE 2:\tIt is possible that the file download does not proceed, but state variables (e.g., group or private emergency, imminent peril, etc.) are modified as result of the processing of the received SIP INVITE request. In this case, it is the responsibility of the implementation and of the user to set the state variables appropriately.\n7)\tif the application/vnd.3gpp.mcdata-signalling MIME body in the received SIP INVITE request contained an FD SIGNALLING PAYLOAD message without the Mandatory download IE included, then:\na)\tshall notify the MCData user about the incoming FD request and wait for the MCData user to accept or reject or defer the FD request;\nb)\tif the MCData user declines the FD session invitation:\ni)\tshall send a SIP 480 (Temporarily Unavailable) response towards the MCData server with the warning text set to \"110 user declined the call invitation\" in a Warning header field as specified in clause 4.9;\nand skip the rest of the steps in this clause;\nc)\tif the MCData user defers the FD session invitation:\ni)\tshall send a SIP 480 (Temporarily Unavailable) response towards the MCData server with the warning text set to \"231 user deferred the call invitation\" in a Warning header field as specified in clause 4.9;\nand skip the rest of the steps in this clause; and\nd)\tif the MCData user accepts the FD session invitation:\ni)\tshall accept the SIP INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\nii)\tshall include the option tag \"timer\" in a Require header field of the SIP 200 (OK) response;\niii)\tshall include the Session-Expires header field in the SIP 200 (OK) response and start the SIP session timer according to IETF RFC 4028 [38]. The \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\niv)\tshall include the g.3gpp.mcdata.fd media feature tag in the Contact header field of the SIP 200 (OK) response;\nv)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in the Contact header field of the SIP 200 (OK) response;\nvi)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5] with the clarifications given in clause 10.2.5.2.2;\nvii)\tif a SIP CANCEL request associated with the SIP INVITE request was received, shall execute the procedure in clause 6.2.8.4.1, otherwise shall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5];\nviii)\tmay store the Conversation ID, Message ID, InReplyTo message ID and Date and time in local storage;and\nix)\tif the SIP 200 (OK) response to the received SIP INVITE request was sent, on receipt of an SIP ACK message to the sent SIP 200 (OK) message, the MCData client shall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.1.2.3;\notherwise, if the user has not accepted or has rejected the session invitation:\ni)\tshall send a SIP 403 (Forbidden) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5].\nOn receipt of an indication from the media plane of the successful download of the file:\n1)\tif the received FD SIGNALLING PAYLOAD message contained an Application metadata container IE, then the MCData client may process the content of that IE per local policy.\nThe MCData client shall execute the procedure in clause 6.2.8.4.3.\nThe MCData client shall execute the procedure in clause 6.2.8.4.4.\nThe MCData client shall execute the procedure in clause 6.2.8.4.2.\n\nThe SDP offer is generated based on the received SDP offer. The SDP offer generated by the participating MCData function:\n1)\tshall contain only one SDP media-level section for file distribution as contained in the received SDP offer; and\n2)\tshall contain an \"a=key-mgmt\" attribute field with a \"mikey\" attribute value, if present in the received SDP offer.\nWhen composing the SDP offer according to 3GPP TS 24.229 [5], the participating MCData function:\n1)\tshall replace the IP address and port number for the offered media stream in the received SDP offer with the IP address and port number of the participating MCData function, if required; and\nNOTE 1:\tRequirements can exist for the participating MCData function to be always included in the path of the offered media stream, for example: for the support of features such as MBMS, lawful interception and recording. Other examples can exist.\nNOTE 2:\tIf the participating MCData function and the controlling MCData function are in the same MCData server, and the participating MCData function does not have a dedicated IP address or a dedicated port number for media stream, the replacement of the IP address or the port number is omitted.\n2)\tif the IP address is replaced shall insert its MSRP URI before the MSRP URI in the \"a=path\" attribute in the SDP answer.\nWhen composing the SDP answer according to 3GPP TS 24.229 [5], the participating MCData function:\n1)\tshall replace the IP address and port number in the received SDP answer with the IP address and port number of the participating MCData function, for the accepted media stream in the received SDP offer, if required; and\nNOTE 1:\tRequirements can exist for the participating MCData function to be always included in the path of the offered media stream, for example: for the support of features such as MBMS, lawful interception and recording. Other examples can exist.\nNOTE 2:\tIf the participating MCData function and the controlling MCData function are in the same MCData server, and the participating MCData function does not have a dedicated IP address or a dedicated port number for media stream, the replacement of the IP address or the port number is omitted.\n2)\tif the IP address is replaced shall insert its MSRP URI before the MSRP URI in the \"a=path\" attribute in the SDP answer.\nUpon receipt of a \"SIP INVITE request for file distribution for originating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\nNOTE 1:\tIf the SIP INVITE request contains an emergency indication or an imminent peril indication set to a value of \"true\" and this is an authorised request for originating a priority communication as determined by clause 6.3.7.2.6 or clause 6.3.7.2.4, the participating MCData function can, according to local policy, choose to accept the request.\n2)\tshall determine the MCData ID of the calling user from the public user identity in the P-Asserted-Identity header field of the SIP INVITE request, and shall authorise the calling user;\nNOTE 2:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP INVITE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is:\na)\tset to a value of \"group-fd\", shall determine the public service identity of the controlling MCData function associated with the MCData group identity in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP INVITE request; or\nb)\tset to a value of \"one-to-one-fd\", shall determine the public service identity of the controlling MCData function hosting the file distribution service for the calling user;\nNOTE 3:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 5:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 6:\tHow the participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 7:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n5)\tif unable to identify the controlling MCData function for file distribution, it shall reject the SIP INVITE request with a SIP 404 (Not Found) response with the warning text \"142 unable to determine the controlling function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n6)\tshall determine whether the MCData user identified by the MCData ID is authorised for MCData communications by following the procedures in clause 11.1;\n7)\tif the procedures in clause 11.1 indicate that the user identified by the MCData ID:\na)\tis not allowed to initiate MCData communications as determined by step 1) of clause 11.1, shall reject the \"SIP INVITE request for file distribution for originating participating MCData function\" with a SIP 403 (Forbidden) response to the SIP INVITE request, with warning text set to \"200 user not authorised to transmit data\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\nb)\tis not allowed to initiate one-to-one MCData communications due to exceeding the maximum amount of data that can be sent in a single request as determined by step 7) of clause 11.1, shall reject the \"SIP INVITE request for file distribution for originating participating MCData function\" with a SIP 403 (Forbidden) response to the SIP INVITE request, with warning text set to \"202 user not authorised for one-to-one MCData communications due to exceeding the maximum amount of data that can be sent in a single request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\nc)\tis not allowed to initiate one-to-one MCData communications to the targeted user as determined by step 1a) of clause 11.1, shall reject the \"SIP INVITE request for file distribution for originating participating MCData function\" with a SIP 403 (Forbidden) response including warning text set to \"229 one-to-one MCData communication not authorised to the targeted user\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n7A)\tif the user identified by the MCData ID requests to initiate an emergency communication, but is not allowed to do so, as determined by executing the procedures in clause 6.3.7.2.6, shall reject the \"SIP INVITE request for file distribution for originating participating MCData function\" with a SIP 403 (Forbidden) response including warning text set to \"233 user not authorised to initiate emergency communication\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n7B)\tif the user identified by the MCData ID requests to initiate an imminent peril communication, but is not allowed to do so, as determined by executing the procedures in clause 6.3.7.2.4, shall reject the \"SIP INVITE request for file distribution for originating participating MCData function\" with a SIP 403 (Forbidden) response including warning text set to \"236 user not authorised to initiate imminent peril communication\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n8)\tshall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [5];\n9)\tshall include the option tag \"timer\" in the Supported header field;\n10)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n11)\tshall set the Request-URI of the outgoing SIP INVITE request to the public service identity of the controlling MCData function as determined by step 4) in this clause;\n11A)\tshall copy the application/vnd.3gpp.mcdata-info+xml MIME body from the incoming SIP INVITE request to the outgoing SIP INVITE request;\n12)\tshall include the MCData ID of the originating user in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP INVITE request;\n12A)\tif the incoming SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body that contains a <functional-alias-URI> element, shall check if the status of the functional alias is activated for the MCData ID. If the functional alias status is activated, then the participating MCData function shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request to the received value, otherwise shall not include a <functional-alias-URI> element;\n13)\tshall include in the outgoing SIP INVITE request, the application/vnd.3gpp.mcdata-signalling MIME body that was present in the incoming SIP INVITE request;\n14)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP INVITE request;\n15)\tshall include a P-Asserted-Identity header field in the outgoing SIP INVITE request set to the public service identity of the participating MCData function;\n15A)\tshall include a Resource-Priority header field according to rules and procedures of 3GPP TS 24.229 [5] set to the value indicated in the Resource-Priority header field, if included in the SIP INVITE request from the MCData client;\n16)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received SIP INVITE request from the MCData client as specified in clause 10.2.5.3.1; and\n17)\tshall send the SIP INVITE request as specified to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the SIP INVITE request in step 16):\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n2)\tshall include in the SIP 200 (OK) response an SDP answer as specified in the clause 10.2.5.3.2;\n3)\tshall include the option tag \"timer\" in a Require header field;\n4)\tshall include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If the \"refresher\" parameter is not included in the received request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uac\";\n5)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.fd media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\"; and\nc)\tthe isfocus media feature tag;\n6)\tshall include Warning header field(s) that were received in the incoming SIP 200 (OK) response;\n7)\tshall include an MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP 200 (OK) response;\n8)\tif the incoming SIP 200 (OK) response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response.\n9)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function; and\n10)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 7.2.1;\n11)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5]; and\n12)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the SIP INVITE request in step 16) the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a \"SIP INVITE request for file distribution for terminating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\nNOTE 1:\tIf the SIP INVITE request contains an emergency indication or an imminent peril indication set to a value of \"true\", the participating MCData function can, according to local policy, choose to accept the request even if the maximum number of acceptable communications is exceeded.\n2)\tshall check the presence of the isfocus media feature tag in the URI of the Contact header field and if it is not present then the participating MCData function shall reject the request with a SIP 403 (Forbidden) response with the warning text set to \"104 isfocus not assigned\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\n3)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request to retrieve the binding between the MCData ID and public user identity of the terminating MCData user;\n3A)\tif the binding between the MCData ID and public user identity of the terminating MCData user does not exist (i.e. MCData user is not available) or network congestion exists, and if later delivery is required, then the participating MCData function shall store the communication for later delivery with following additional informations included:\na)\tshall include a Payload IE with:\ni)\tthe Payload content type set to \"FILEURL\" as specified in clause 15.2.13; and\nii)\tthe URL of the file to be stored for later delivery in the Payload data as as specified in clause 15.2.13; and\nNOTE 2:\tThe file can be stored in the temporary storage of the MCData server or in the MCData content server. The URL of the stored file for later delivery is updated accordingly.\nb)\tmay include a Metadata IE with the required file description information and file availability information;\n3B)\tif the communication is stored in step 3A) above and to store the file content in the temporary storage, then the participating MCData function:\na)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5] with the following clarifications:\ni)\tinclude an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5] with the following clarifications:\nA)\tif included in the SDP offer, shall include an \"m=message\" media-level section for the offered MCData media stream consisting of:\nI) the IP address and port number of the participating MCData function;\nII)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS;\nIII)\ta format list field set to '*';\nIV)\tan \"a=recvonly\" attribute;\nV)\tan \"a=path\" attribute containing its own MSRP URI;\nVI)\tset the content type as a=accept-types:application/vnd.3gpp.mcdata-signalling; and\nVII)\tset the a=setup attribute to \"passive\", according to IETF RFC 6135 [19];\nii)\tinclude the option tag \"timer\" in a Require header field;\niii)\tinclude the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If no \"refresher\" parameter was included in the SIP INVITE request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\niv)\tinclude the following in the Contact header field:\ni)\tthe g.3gpp.mcdata.fd media feature tag;\nii)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\"; and\niii)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP INVITE request from the controlling MCData function;\nv)\tstart the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\nvi)\tinclude the warning text set to \"232 communication is stored for later delivery\" in a Warning header field as specified in clause 4.9;\nvii)\tinteract with the media plane as specified in 3GPP TS 24.582 [15] clause 7.2.5.1 to receive the file from controlling MCData function and clause 7.1.3.2 to receive the file content; and\nviii)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [5]; and\nb)\tshall generate and send an FD NOTIFICATION indicating deferral of the FD request as specified in clause 12.2.2.3 with including the warning text set to \"232 communication is stored for later delivery\" in a Warning header field as specified in clause 4.9;\nand skip the rest of the steps of this clause;\n4)\tif the binding between the MCData ID and public user identity of the terminating MCData user does not exist, then the participating MCData function shall reject the SIP INVITE request with a SIP 404 (Not Found) response, and shall not continue with the rest of the steps;\n4A)\tif the <IncomingOne-to-OneCommunicationList> element exists in the MCData user profile document with one or more <One-to-One-CommunicationListEntry> elements (see the MCData user profile document in 3GPP TS 24.484 [12]) and:\ni)\tif the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request does not match with the <entry> element of any of the <One-to-One-CommunicationListEntry> elements in the <IncomingOne-to-OneCommunicationList> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]); and\nii)\tif configuration is not set in the MCData user profile document that allows the MCData user to receive one-to-one MCData communication from any user (see <allow-one-to-one-communication-from-any-user> element in MCData user profile document in 3GPP TS 24.484 [12]);\nthen:\ni)\tshall reject the SIP INVITE request with a SIP 403 (Forbidden) response including warning text set to \"230 one-to-one MCData communication not authorised from this originating user\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\n5)\tshall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [5];\n6)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n7)\tshall include the option tag \"timer\" in the Supported header field;\n8)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.fd media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\";\nc)\tthe isfocus media feature tag;\nd)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the incoming SIP INVITE request; and\ne)\tany other uri-parameter provided in the Contact header field of the incoming SIP INVITE request;\n9)\tshall include in the SIP INVITE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP INVITE request;\n10)\tshall set the Request-URI of the outgoing SIP INVITE request to the public user identity associated to the MCData ID of the terminating MCData user;\n11)\tshall populate the outgoing SIP INVITE request with the MIME bodies that were present in the incoming SIP INVITE request;\n12)\tshall include a P-Asserted-Identity header field in the outgoing SIP INVITE request set to the public service identity of the participating MCData function;\n13)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received \"SIP INVITE request for file distribution for terminating participating MCData function\" as specified in clause 10.2.5.3.1; and\n14)\tshall send the SIP INVITE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n2)\tshall include in the SIP 200 (OK) response an SDP answer based on the SDP answer in the received SIP 200 (OK) response as specified in clause 10.2.5.3.2;\n3)\tshall include the option tag \"timer\" in a Require header field;\n4)\tshall include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If no \"refresher\" parameter was included in the SIP INVITE request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\n5)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.fd media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\"; and\nc)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP INVITE request from the controlling MCData function;\n6)\tif the incoming SIP response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response.\n7)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function;\n8)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\n9)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 7.2.2;\n10)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [5]; and\n11)\tshall generate and send an FD NOTIFICATION indicating acceptance of the FD request as specified in clause 12.2.2.3.\nUpon receiving a SIP 480 (Temporarily Unavailable) response with the warning text set to: \"231 user deferred the call invitation\" in a Warning header field as specified in clause 4.9 to the above SIP INVITE request and if later delivery is required, the participating MCData function:\n1)\tshall store the communication for later delivery with following additional information included:\na)\tshall include a Payload IE with:\ni)\tthe Payload content type set to \"FILEURL\" as specified in clause 15.2.13; and\nii)\tthe URL of the file to be stored for later delivery is included in the Payload data as specified in clause 15.2.13; and\nNOTE 3:\tThe file can be stored in the temporary storage of the MCData server or MCData content server. The URL of stored file for later delivery is updated accordingly.\nb)\tmay include a Metadata IE with the required file description information and file availability information;\n2)\tif the communication is stored in step 1) above and to store the file content in the temporary storage, shall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5] with the following clarifications:\na)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5] with the following clarifications:\ni)\tshall include an \"m=message\" media-level section for the accepted MCData media stream consisting of:\nA)\tshall include the IP address and port number of the participating MCData function, for the accepted media stream in the received SDP offer;\nB)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS according to the received SDP offer;\nC)\ta format list field set to '*';\nD)\tan \"a=recvonly\" attribute;\nE)\tan \"a=path\" attribute containing its own MSRP URI;\nF)\tset the content type as a=accept-types:application/vnd.3gpp.mcdata-signalling; and\nG)\tset the a=setup attribute set to \"passive\", according to IETF RFC 6135 [19];\nb)\tshall include the option tag \"timer\" in a Require header field;\nc)\tshall include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If no \"refresher\" parameter was included in the SIP INVITE request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\nd)\tshall include the following in the Contact header field:\ni)\tthe g.3gpp.mcdata.fd media feature tag;\nii)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\"; and\niii)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP INVITE request from the controlling MCData function;\ne)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\nf)\tshall include the warning text set to \"232 communication is stored for later delivery\" in a Warning header field as specified in clause 4.9;\ng)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 7.2.5.1 to receive the file from controlling MCData function and clause 7.1.3.2 to receive the file content; and\nh)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [5]; and\n3)\tshall generate and send an FD NOTIFICATION indicating deferral of the FD request as specified in clause 12.2.2.3.\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response;\n3)\tshall forward the SIP response to the controlling MCData function according to 3GPP TS 24.229 [5]; and\n4)\tshall generate and send an FD NOTIFICATION indicating rejection of the FD request as specified in clause 12.2.2.3.\nOn receipt of an indication from the media plane of the successful download of the file or on successful download of the file after retrival of deferred FD request by the receiving MCData client and if the received FD SIGNALLING PAYLOAD message contained an FD disposition request type IE requesting a file download completed update indication in the sent SIP INVITE request, then, the participating MCData function:\n1)\tshall follow the procedures described in clause 12.2.2.3.\nOn receipt of an indication from the media plane of the successful download of the file for later delivery, the participating MCData function:\n1)\tshall update the URL of the stored file for later delivery in the Payload data.\nThe participating MCData function shall execute the procedure in clause 6.3.7.1.18.\nThe participating MCData function shall execute the procedure in clause 6.3.7.1.17.\nWhen composing an SDP offer according to 3GPP TS 24.229 [5], IETF RFC 5547 [69], IETF RFC 6135 [19], and IETF RFC 6714 [20], the MCData client:\n1)\tshall include an \"m=message\" media-level section for the MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS;\nc)\tan \"a=sendonly\" attribute;\nd)\tan \"a=path\" attribute containing its own MSRP URI;\ne)\tset the content type as \"a=accept-types:application/vnd.3gpp.mcdata-signalling\";\nf)\tset the a=setup attribute as \"actpass\";\ng)\ta file-selector attribute containing:\ni)\ta 'name' selector;\nii)\ta 'type' selector;\niii)\ta 'size' selector; and\niv)\ta 'hash' selector;\nh)\ta file-date attribute; and\ni)\ta file-description attribute.\nWhen composing the SDP answer according to 3GPP TS 24.229 [5], the controlling MCData function:\n1)\tshall include an \"m=message\" media-level section for the accepted MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS according to the received SDP offer;\nc)\ta format list field set to '*';\nd)\tan \"a=recvonly\" attribute;\ne)\tan \"a=path\" attribute containing its own MSRP URI;\nf)\tset the content type as a=accept-types:application/vnd.3gpp.mcdata-signalling; and\ng)\tset the a=setup attribute set to \"passive\", according to IETF RFC 6135 [19]; and\nh)\ta file-selector attribute containing:\ni)\ta 'name' selector;\nii)\ta 'type' selector;\niii)\ta 'size' selector; and\niv)\ta 'hash' selector.\nThis clause describes the procedures for inviting an MCData user to an MCData session. The procedure is initiated by the controlling MCData function as the result of an action in clause 10.2.5.4.4.\nThe controlling MCData function:\n1)\tshall generate a SIP INVITE request as specified in 3GPP TS 24.229 [5] with an application/vnd.3gpp.mcdata-info+xml MIME body included;\n1A)\tif the received SIP INVITE request contains an authorised request for an MCData emergency communication as determined by clause 6.3.7.2.6, shall, in the generated SIP INVITE request:\na)\tset the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body to a value of \"true\";\nb)\tinclude a Resource-Priority header field populated with the values for an MCData emergency communication as specified in clause 6.3.7.1.4;\nc)\tif the <alert-ind> element is set to \"true\" in the received SIP INVITE request and the initiation of MCData emergency alerts is authorized, as determined by the procedures of clause 6.3.7.2.1, populate the application/vnd.3gpp.mcdata-info+xml MIME body and the application/vnd.3gpp.mcdata-location-info+xml MIME body as specified in clause 6.3.7.1.3. Otherwise, set the <alert-ind> element to a value of \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body; and\nd)\tfor a group communication, if the in-progress imminent peril state of the group is set to a value of \"true\", include in the application/vnd.3gpp.mcdata-info+xml MIME body an <imminentperil-ind> element set to a value of \"false\";\nNOTE 1:\tIf the imminent peril state of the group is true at this point, the controlling function will set it to false as part of the calling procedure.\ne)\tset the <request-type> element of the application/vnd.3gpp.mcdata-info+xml MIME body to the value of the <request-type> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the received SIP INVITE request;\n1B)\tfor a group communication, if the in-progress emergency state of the group is set to a value of \"false\" and the in-progress imminent peril state of the group is set to a value of \"true\", the controlling MCData function:\na)\tshall include a Resource-Priority header field populated with the values for an MCData imminent peril group communication as specified in clause 6.3.7.1.4; and\nb)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body an <imminentperil-ind> element set to a value of \"true\".\n2)\tshall include the Supported header field set to \"timer\";\n3)\tshould include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38]. The refresher parameter shall be omitted;\n4)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.fd media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n5)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n6)\tshall include a Referred-By header field with the public user identity of the inviting MCData client;\n7)\tshall include in the Contact header field an MCData session identity for the MCData session with the g.3gpp.mcdata.fd media feature tag, the isfocus media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" according to IETF RFC 3840 [16];\n8)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request:\na)\tthe <mcdata-request-uri> element set to the MCData ID of the terminating user;\nb)\tthe <mcdata-calling-group-id> element set to the group identity if the request is for group file distribution; and\nc)\tthe <mcdata-calling-user-id> element set to the calling user MCData ID;\n9)\tshall include in the outgoing SIP INVITE request, the application/vnd.3gpp.mcdata-signalling MIME body that was present in the incoming SIP INVITE request;\n9A)\tif the application/vnd.3gpp.mcdata-signalling MIME body in the received SIP INVITE request contained a FD SIGNALLING PAYLOAD message without the Mandatory download IE included, then:\na)\tshall execute the procedures in clause 11.2; and\nb)\tif the procedures in clause 11.2 indicate that the mandatory download indication needs to be included, shall include the Mandatory download IE set to a value of \"MANDATORY DOWNLOAD\" in the FD SIGNALLING PAYLOAD message of the outgoing SIP INVITE request;\n10)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated to the MCData user to be invited;\nNOTE 2:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 4:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 5:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 6:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n11)\tshall set the P-Asserted-Identity header field to the public service identity of the controlling MCData function;\n12)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n13)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received SIP INVITE request from the originating client according to the procedures specified in clause 10.2.5.4.1; and\n14)\tshall send the SIP INVITE request towards the terminating client in accordance with 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response for the SIP INVITE request the controlling MCData function:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 7.3.\nNOTE 7:\tThe procedures executed by the controlling MCData function prior to sending a response to the inviting MCData client are specified in clause 10.2.5.4.4.\nIn the procedures in this clause:\n1)\tMCData ID in an incoming SIP INVITE request refers to the MCData ID of the originating user from the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request;\n2)\tgroup identity in an incoming SIP INVITE request refers to the group identity from the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request; and\n3)\tMCData ID in an outgoing SIP INVITE request refers to the MCData ID of the called user in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP INVITE request.\nThe procedures in this clause are executed upon:\n-\treceipt of a \"SIP INVITE request for controlling MCData function for file distribution\"; or\n-\ta decision to now process a previously received \"SIP INVITE request for controlling MCData function for file distribution\" that had been queued for later transmission.\nNOTE 1:\tThe controlling MCData function may postpone the continuation of an FD using media plane procedure by queuing the received \"SIP INVITE request for controlling MCData function for file distribution\". The management of the queue is specified in Annex B of 3GPP TS 23.282 [2].\nThe controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response or queue the received SIP INVITE. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4];\nNOTE 1A:\tIf the SIP INVITE request contains an emergency indication or an imminent peril indication set to a value of \"true\" and this is an authorised request originating an MCData emergency group communication as determined by clause 6.3.7.2.6, or for originating an MCData imminent peril group communication as determined by clause 6.3.7.2.4, the controlling MCData function can, according to local policy, choose to accept the request.\n2)\tif the received SIP INVITE request has been queued for later transmission, shall include warning text set to \"215 request to transmit is queued by the server\" in a Warning header field as specified in clause 4.9, in the SIP 100 (Trying) response, and shall send the SIP 100 (TRYING) response towards the originating participating MCData function according to 3GPP TS 24.229 [5] and not continue with the remaining steps in this clause. Otherwise, continue with the rest of the steps;\n3)\tshall determine if the media parameters are acceptable and the MSRP URI is offered in the SDP offer and if not reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n3A)\tif the received SIP INVITE request includes an application/vnd.3gpp.mcdata-info+xml MIME body with an <emergency-ind> element included or an <imminentperil-ind> element included, shall validate the request as described in clause 6.3.7.1.9;\n3B)\tif the SIP INVITE request contains an unauthorised request for an MCData emergency communication as determined by clause 6.3.7.2.6:\na)\tshall reject the SIP INVITE request with a SIP 403 (Forbidden) response as specified in clause 6.3.7.2.7; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [5] and skip the rest of the steps;\n3C)\tif the SIP INVITE request contains an unauthorised request for an MCData imminent peril group communication as determined by clause 6.3.7.2.4, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response with the following clarifications:\na)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcdata-info+xml MIME body as specified in clause D.1 with the <mcdatainfo> element containing the <mcdata-Params> element with the <imminentperil-ind> element set to a value of \"false\"; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [5] and skip the rest of the steps;\n3D)\tif a Resource-Priority header field is included in the SIP INVITE request:\na)\tif the Resource-Priority header field is set to the value indicated for emergency communications and the SIP INVITE request does not contain an emergency indication and the in-progress emergency state of the group is set to a value of \"false\", shall reject the SIP INVITE request with a SIP 403 (Forbidden) response and skip the rest of the steps; or\nb)\tif the Resource-Priority header field is set to the value indicated for imminent peril communications and the SIP INVITE request does not contain an imminent peril indication and the in-progress imminent peril state of the group is set to a value of \"false\", shall reject the SIP INVITE request with a SIP 403 (Forbidden) response and skip the rest of the steps;\n4)\tif the incoming SIP INVITE request does not contain an application/vnd.3gpp.mcdata-signalling MIME body with the FD SIGNALLING PAYLOAD as described in clause 6.2.2.3, shall reject the SIP INVITE request with appropriate reject code;\n5)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if:\na)\tan Accept-Contact header field does not include the g.3gpp.mcdata.fd media feature tag; or\nb)\tan Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\";\n6)\tshall cache SIP feature tags, if received in the Contact header field and if the specific feature tags are supported;\n7)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\n8)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"one-to-one-fd\" and:\na)\tthe conditions in clause 11.1 indicate that the MCData user is not allowed to initiate FD communications due to file size exceeding allowed limits as determined by step 4) of clause 11.1, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response to the SIP INVITE request, with warning text set to \"220 user not authorised for FD communications due to file size\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\nNOTE 2:\tThe size of the file intended for transfer over the media plane is obtained from the 'size' selector of the file-selector attribute in the received SDP offer.\na1)\tif the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of an application/vnd.3gpp.mcdata-info+xml MIME body contains an <call-to-functional-alias-ind> element set to a value of \"true\":\ni)\tshall identify the MCData ID(s) of the MCData user(s) that have activated the called functional alias received in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the SIP INVITE request by performing the actions specified in clause 22.2.2.2.8, and:\nA)\tif unable to determine any MCData ID that has activated the called functional alias received in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the SIP INVITE request, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response including a warning text set to \"145 unable to determine called party\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps; and\nB)\tselects one of the identified MCData IDs, and shall send a SIP 300 (Multiple Choices) response to the SIP INVITE request populated according to 3GPP TS 24.229 [5], IETF RFC 3261 [4] with:\nI)\ta Contact header field containing a SIP URI for the MCData session identity; and\nII)\tan application/vnd.3gpp.mcdata-info MIME body with a <mcdata-request-uri> element set to the selected MCData ID and shall not continue with the rest of the steps in this clause;\nNOTE 2A:\tHow the controlling MCData function determines the appropriate MCData ID is implementation-specific.\nb)\tthe SIP INVITE request:\ni)\tdoes not contain an application/resource-lists+xml MIME body or contains an application/resource-lists+xml MIME body with more than one <entry> element in the set of <list> elements in the <resource-lists> element, shall return a SIP 403 (Forbidden) response with the warning text set to \"205 unable to determine targeted user for one-to-one FD\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below; and\nii)\tcontains an application/resource-lists+xml MIME body with exactly one <entry> element in a <list> element in the <resource-lists> element, shall invite the MCData user identified by the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, as specified in clause 10.2.5.4.3; and\nshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 7.3; and\n9)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"group-fd\":\na)\tshall retrieve the necessary group document(s) from the group management server for the group identity contained in the SIP INVITE request and carry out initial processing as specified in clause 6.3.3, and shall continue with the remaining steps if the procedures in clause 6.3.3 were successful;\nb)\tif the <on-network-disabled> element is present in the group document, shall send a SIP 403 (Forbidden) response with the warning text set to \"115 group is disabled\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nb1)\tif the group document contains a <list-service> element that contains a <preconfigured-group-use-only> element that is set to the value \"true\", shall reject the SIP INVITE request with a SIP 403 (Forbidden) response with the warning text set to \"167 call is not allowed on the preconfigured group\" as specified in clause 4.9 \"Warning header field\" and shall skip the rest of this procedure;\nc)\tif the <entry> element of the <list> element of the <list-service> element in the group document does not contain an <mcdata-mcdata-id> element with a \"uri\" attribute matching the MCData ID of the originating user contained in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP INVITE request, shall send a SIP 403 (Forbidden) response with the warning text set to \"116 user is not part of the MCData group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nd)\tif the <list-service> element contains a <mcdata-allow-file-distribution> element in the group document set to a value of \"false\", shall send a SIP 403 (Forbidden) response with the warning text set to \"213 file distribution not allowed for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\ne)\tif the <supported-services> element is not present in the group document or is present and contains a <service> element containing an \"enabler\" attribute which is not set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\", shall send a SIP 488 (Not Acceptable) response with the warning text set to \"214 FD services not supported for this group\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nf)\tif the user identified by the MCData ID:\ni)\tis not allowed to initiate group MCData communications on this group identity as determined by step 2) of clause 11.1, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response, with warning text set to \"201 user not authorised to transmit data on this group identity\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\nii)\tis not allowed to initiate group MCData communications on this group identity due to exceeding the maximum amount of data that can be sent in a single request as determined by step 8) of clause 11.1, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response to the SIP INVITE request, with warning text set to \"208 user not authorised for MCData communications on this group identity due exceeding the maximum amount of data that can be sent in a single request\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause; and\niii)\tis not allowed to initiate FD communications on this group identity due to file size exceeding the allowed limits as determined by step 6) of clause 11.1, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response to the SIP INVITE request, with warning text set to \"219 user not authorised for FD communications on this group identity due to file size\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\nNOTE 3:\tThe size of the file intended for transfer over the media plane is obtained from the 'size' selector of the file-selector attribute in the received SDP offer.\ng)\tif the originating user identified by the MCData ID is not affiliated to the group identity contained in the SIP INVITE request, as specified in clause 6.3.5, shall return a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\nh)\tshall determine targeted group members for MCData communications by following the procedures in clause 6.3.4;\ni)\tif the procedures in clause 6.3.4 result in no affiliated members found in the selected MCData group, shall return a SIP 403 (Forbidden) response with the warning text set to \"198 no users are affiliated to this group\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\nj)\tshall invite each group member determined in step h) above, to the group session, as specified in clause 10.2.5.4.3; and\nk)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 7.3.\nUpon receiving a SIP 200 (OK) response for a SIP INVITE request as specified in clause 10.2.5.4.3 and, if the MCData ID in the SIP 200 (OK) response matches to the MCData ID in the corresponding SIP INVITE request, the controlling MCData function:\n1)\tshall invoke the procedure in clause 6.3.7.1.23 with an indication that the applicable MCData subservice is File Distribution, in order to generate a SIP 200 (OK) response to the received SIP INVITE request according to 3GPP TS 24.229 [5];\n2A)\tif the received SIP INVITE request contains an alert indication set to a value of \"true\" and this is an unauthorised request for an MCData emergency alert as specified in clause 6.3.7.2.1, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in clause 4.9;\n2B)\tif the received SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\" and if the in-progress emergency state of the group is set to a value of \"true\", shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in clause 4.9;\nand\n3)\tshall send the generated SIP 200 (OK) response to the inviting MCData client according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response for a SIP INVITE request as specified in clause 10.2.5.4.3 and if the warning text set to \"232 communication is stored for later delivery\" is received in a Warning header field as specified in clause 4.9, the controlling MCData function:\n1)\tshall invoke the procedure in clause 6.3.7.1.23 with an indication that the applicable MCData subservice is File Distribution, in order to generate a SIP 200 (OK) response to the receivedSIP INVITE request according to 3GPP TS 24.229 [5];\n2A)\tif the SIP INVITE request contains an alert indication set to a value of \"true\" and this is an unauthorised request for an MCData emergency alert as specified in clause 6.3.7.2.1, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in clause 4.9;\n2B)\tif the received SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\" and if the in-progress emergency state of the group is set to a value of \"true\", shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in clause 4.9; and\n3)\tshall send the generated SIP 200 (OK) response to the inviting MCData client according to 3GPP TS 24.229 [5].\nNOTE 4:\tWhen requested to release the associated media plane resources and to tear down the MCData session, the controlling MCData function stores the INVITE session information that is established between the participating function and the controlling function for later delivery.\nThe controlling MCData function shall execute the procedure in clause 6.3.7.1.19, with an indication that the applicable MCData subservice is File Distribution.\nThe controlling MCData function shall execute the procedure in clause 6.3.7.1.20, with an indication that the applicable MCData subservice is File Distribution.\nThe controlling MCData function shall execute the procedure in clause 6.3.7.1.21.\nThe controlling MCData function shall execute the procedure in clause 6.3.7.1.22.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.6\tFD using MBMS delivery via MB2 interface",
                            "text_content": "The procedures for group FD using MBMS delivery via MB2 interface can be seen as extensions of group FD using unicast session for delivery via the media plane.\nGroup FD using MBMS enables dynamic toggling between unicast and MBMS delivery at any time during a session, assuming the proper bearers are available. Only the terminating MCData clients and the respective associated MCData terminating participating functions become aware of and involved in the potential MBMS delivery.\nThe terminating participating function can signal the start/stop/resume MBMS transmissions to the MCData client by using the media control plane Map Group To Bearer and Unmap Group To Bearer messages, described in 3GPP TS 24.582 [15]. The media control plane signaling associates the TMGI of an announced MBMS bearer with the MCData group ID of the communication and with the MBMS transmission parameters (IP address and UDP port).\nFile download completed notifications can be requested to assess if the file transfer was successful. It is up to the terminating participating function to decide whether or not to use MBMS for a session, and it is possible that the terminating participating function will not use MBMS delivery for FD unless a file repair or retransmission capability is available.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.7\tFD using MBS delivery via MB2 interface",
                            "text_content": "All steps of clause 10.2.6 apply also for MBS, with the clarification that terminology mapping specified in clause I.3.4 applies.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "11\tTransmission and Reception Control",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "11.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The MCData functional entities (as specified in clause 5.2 and clause 5.3) check if the MCData user is allowed to initiate MCData communications by following the procedures specified below:\n1)\tif the MCData user wishes to send one-to-one MCData communications and the <allow-transmit-data> element of an <actions> element is not present in the MCData user profile document or is present with the value \"false\" (see the MCData user profile document in 3GPP TS 24.484 [12]), , the MCData client and participating MCData function shall determine that the MCData user is not allowed to send MCData communications and shall not continue with the rest of the steps;\n1A)\tif the MCData user wishes to initiate one-to-one MCData communications, the <One-to-One-Communication> element exists in the MCData user profile document with one more <entry> elements, and the \"uri\" attribute of the <entry> element in a <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body does not match with one of the <entry> elements of the <One-to-One-Communication> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]), the MCData client and participating MCData function shall determine that the MCData user is not allowed to initiate MCData communication to the targeted user and shall not continue with the rest of the steps;\n2)\tif the MCData user wishes to send group MCData communications on an MCData group identity and the <mcdata-allow-transmit-data-in-this-group> element of an <actions> element is not present in the MCData group document or is present with the value \"false\" as specified in 3GPP TS 24.481 [11], the MCData client and controlling MCData function shall determine that the MCData user is not allowed to send group MCData communications on this group identity, and shall not continue with the rest of the steps;\n3)\tif the MCData user wishes to send one-to-one SDS communications and the size of the payload is greater than the value contained in the <max-data-size-sds-bytes> element in the MCData service configuration document as specified in 3GPP TS 24.484 [12], the MCData client and controlling MCData function shall determine that the MCData user is not allowed to send SDS communications due to message size and shall not continue with the rest of the steps;\n4)\tif the MCData user wishes to send one-to-one FD communications and the size of the data that the MCData user wishes to send is greater than the value contained in the <max-data-size-fd-bytes> element in the MCData service configuration document as specified in 3GPP TS 24.484 [12], the MCData client and controlling MCData function shall determine that the MCData user is not allowed to send FD communications due to file size and shall not continue with the rest of the steps;\n5)\tif the MCData user wishes to send group SDS communications on an MCData group identity and the size of the data that the MCData user wishes to send is greater than the value contained in the <mcdata-on-network-max-data-size-for-SDS> element in the MCData group document for the MCData group ID as specified in 3GPP TS 24.481 [11], then the MCData client and the controlling MCData function shall determine that the MCData user is not allowed to send SDS communications on this group identity due to message size and shall not continue with the rest of the steps;\n6)\tif the MCData user wishes to send group FD communications on an MCData group identity and the size of the data that the MCData user wishes to send is greater than the value contained in the <mcdata-on-network-max-data-size-for-FD> element in the MCData group document for the MCData group ID as specified in 3GPP TS 24.481 [11], then the MCData client and the controlling MCData function shall determine that the MCData user is not allowed to send FD communications on this group identity due to file size and shall not continue with the rest of the steps;\n7)\tif the MCData user wishes to send one-to-one MCData communications to another MCData user and the size of the payload is greater than the maximum amount of data that the MCData user can transmit in a single request during one-to-one communications contained in the <MaxData1To1> element of the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]), the MCData client and participating MCData function shall determine that the MCData user is not allowed to send one-to-one MCData communications due to exceeding the maximum amount of data that can be sent in a single request and shall not continue with the rest of the steps;\n8)\tif the MCData user wishes to send group MCData communications on an MCData group identity and the size of the payload is greater than the maximum amount of data that the MCData user can transmit in a single request during group communications in the group identified by the MCData group identity in the request contained in the <mcdata-max-data-in-single-request> element of the <entry> element of the MCData group document as specified in 3GPP TS 24.481 [11], the MCData client and the controlling MCData function shall determine that the MCData user is not allowed to send group MCData communications on this group identity due to exceeding the maximum amount of data that can be sent in a single request and shall not continue with the rest of the steps;\n9)\tif the MCData user wishes to initiate a SDS session for later use with one-to-one MCData communications there are no further checks for the MCData client which shall continue at step 11). If, for either the originating user or the terminating user, the <allow-transmit-data> element of an <actions> element is not present in the MCData user profile document or is present with the value \"false\" (see the MCData user profile document in 3GPP TS 24.484 [12]), the participating MCData function shall determine that the MCData user is not allowed to initiate a SDS session and shall not continue with the rest of the steps;\n10)\tif the MCData user wishes to initiate a SDS session on an MCData group identity and the <mcdata-allow- short-data-service> element of a <list-service> element is not present in the MCData group document or is present with the value \"false\" as specified in 3GPP TS 24.481 [11], the MCData client and controlling MCData function shall determine that the MCData user is not allowed to initiate a SDS session on this group identity and shall not continue with the rest of the steps;\n11)\tif the MCData user wishes to initiate an IP Connectivity session with one-to-one MCData communications and the <allow-transmit-data> element of an <actions> element is not present in the MCData user profile document or is present with the value \"false\" as specified in 3GPP TS 24.484 [12], the MCData client and controlling MCData function shall determine that the MCData user is not allowed to initiate an IP Connectivity session and shall not continue with the rest of the steps; and\n12)\tthe MCData functional entity shall determine that the MCData user is allowed to initiate MCData communications.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "11.2\tAuto-receive for File Distribution",
                    "description": "",
                    "summary": "",
                    "text_content": "If the controlling MCData function receives a one-to-one file distribution using HTTP or a group standalone file distribution using HTTP without the mandatory download indication the controlling MCData function:\n1)\tif the file distribution request contained metadata, shall retrieve the filesize contained in the fileselector of the Metadata IE in the FD request;\n2)\tif the file distribution request did not contain metadata, shall determine the size of the file referenced by the file URL contained in FD request;\n3)\tfor one-to-one file distribution using HTTP, shall determine if the filesize is less than or equal to the value contained in the <max-data-size-auto-recv-bytes> element of the MCData service configuration document as specified in 3GPP TS 24.484 [12];\n4)\tfor group standalone file distribution using HTTP, shall determine if the filesize is less than or equal to the value contained in the <mcdata-on-network-max-data-size-auto-recv> element of the MCData group document associated with the MCData group identity in the request, as specified in 3GPP TS 24.481 [11]; and\n5)\tifcondition 3) or 4) is true, shall determine that the mandatory download indication needs to be included in the file distribution request sent to the terminating MCData client.\nIf the controlling MCData function receives a one-to-one file distribution using media plane or a group standalone file distribution using media plane without the mandatory download indication the controlling MCData function:\n1)\tif the file distribution request contained metadata, shall retrieve the filesize contained in the fileselector attribute contained in the \"m=message\" media-level section for the MCData media stream of SDP offer in the FD request;\n2)\tfor one-to-one file distribution using media plane, shall determine if the filesize is less than or equal to the value contained in the <max-data-size-auto-recv-bytes> element of the MCData service configuration document as specified in 3GPP TS 24.484 [12];\n3)\tfor group standalone file distribution using media plane, shall determine if the filesize is less than or equal to the value contained in the <mcdata-on-network-max-data-size-auto-recv> element of the MCData group document associated with the MCData group identity in the request, as specified in 3GPP TS 24.481 [11]; and\n4)\tif condition 1) is true and 2) or 3) is true, shall determine that the mandatory download indication needs to be included in the file distribution request sent to the terminating MCData client.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "11.3\tAccessing list of deferred data group communications",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "11.3.1\tGeneral",
                            "text_content": "Accessing list of deferred data group communication allows a MCData user to request for the list of files that have been deferred for future download. The procedures are applicable for FD using HTTP and FD using media plane.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "11.3.2\tMCData client procedures",
                            "text_content": "Upon receiving a request from the MCData user to access the list of deferred data group communications, the MCData client:\n1)\tshall build the SIP MESSAGE request as specified in clause 6.2.4.1;\n2)\tshall generate DEFERRED DATA REQUEST message as specified in clause 15.1.11.1;\n3)\tshall include in the SIP request, the DEFERRED DATA GROUP COMM message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1; and\n4)\tshall send the SIP MESSAGE request towards the participating MCData function according to rules and procedures of 3GPP TS 24.229 [5].\nUpon receipt of a \"SIP MESSAGE response for the list of deferred group communications request\", the MCData client:\n1)\tshall generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\n2)\tshall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5];\n3)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body:\na)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains DEFERRED DATA RESPONSE message as specified in clause 15.1.12:\ni)\tfor each deferred FD signalling payload, if payload type is set to \"FILEURL\", shall store the required data or entire FD signalling payload and the Group ID information; and\n4)\tshall present to MCData user, the list of file URLs which were deferred with other information optional such as Originator, Group ID, Conversation ID, Message ID, InReplyTo message ID and Date and time etc.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "11.3.3\tParticipating MCData function procedures",
                            "text_content": "Upon receipt of a \"SIP MESSAGE request for the list of deferred group communications\", the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5];\n2)\tshall send SIP 200 (OK) response towards MCData client according to 3GPP TS 24.229 [5]; and\n3)\tshall follow the procedure described in clause 11.3.3.2 to send response.\nTo send the list of deferred group communications, the participating MCData function:\n1)\tshall build the SIP MESSAGE request as specified in clause 6.3.2.1;\n2)\tshall generate DEFERRED DATA RESPONSE message as specified in clause 15.1.12.1;\n3)\tshall include in the SIP request, the DEFERRED DATA RESPONSE message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1; and\n4)\tshall send the SIP MESSAGE request towards the MCData client according to rules and procedures of 3GPP TS 24.229 [5].\nWhen generating a DEFERRED DATA RESPONSE message as specified in clause 15.1.12, the participating MCData function:\n1)\tshall set the number of payloads IE to the number of FD using HTTP or FD using media plane communication which are deferred as per the stored file list:\na)\tfor each deferred file from the list, shall copy the payload IE value from the stored list to the payload IE value of the outgoing message being generated; or\n2)\tshall set the number of payloads IE to the number of FD using HTTP or FD using media plane communication which are deferred as per the stored deferred group communications:\na)\tfor each deferred group communication, shall copy the deferred FD signalling payload IE value(s) from the stored list to the deferred FD signalling payload IE value(s) of the outgoing message being generated; and\nb)\tshall copy the MCData group ID(s) from the stored list to the MCData group ID IE value(s) of the outgoing message.\nNOTE:\tOnly the 'payload' IE and its value population from the stored list of 'payload' IE and its value as described in step 1) applicability were specified in early versions of the present document from release 13 to release 16. The continued support for Payload element and its value is for backwards compatibility.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "12\tDispositions and Notifications",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "12.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The procedures in clause 12 describe:\n-\tthe on-network procedures for generating out-of-band dispositions for on-network SDS and on-network FD;\n-\tthe on-network procedures for generating network notifications for file distribution; and\n-\tthe off-network procedures for generating SDS dispositions.\nThe MCData client can send a disposition notification as a direct result of receiving an MCData message (e.g. delivery notification) or can send a disposition notification at a later time (e.g. read notification). In certain circumstances the delivery and read notification can be delivered in one notification message.\nIn-band dispositions are sent in the media plane as specified in 3GPP TS 24.582 [15].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "12.2\tOn-network disposition notifications",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "12.2.1\tMCData client procedures",
                            "text_content": "The MCData client shall follow the procedures in this clause to:\n-\tindicate to an MCData client that an SDS message was delivered, read or delivered and read when the originating client requested a delivery, read or delivery and read report;\n-\tindicate to the participating MCData function serving the MCData user that an SDS message was undelivered. The participating MCData function can store the message for later re-delivery;\n-\tindicate to an MCData client that a request for FD was accepted, deferred or rejected; or\n-\tindicate to an MCData client that a file download has been completed;\nBefore sending a disposition notification the MCData client needs to determine:\n-\tthe group identity related to an SDS or FD message request received as part of a group communication. The MCData client determines the group identity from the contents of the <mcdata-calling-group-id> element contained in the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SDS or FD message request; and\n-\tthe MCData user targeted for the disposition notification. The MCData client determines the targetted MCData user from the contents of the <mcdata-calling-user-id> element contained in the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SDS or FD message request.\nThe MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] with the clarifications given below.\nThe MCData client:\n1)\tshall build the SIP MESSAGE request as specified in clause 6.2.4.1;\n2)\tshall follow the rules specified in clause 6.4 for the handling of MIME bodies in a SIP message when processing the remaining steps in this clause;\n3)\tshall insert in the SIP MESSAGE request an application/resource-lists+xml MIME body containing the MCData ID of the targeted MCData user in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, according to rules and procedures of IETF RFC 5366 [18];\n4)\tvoid;\n5)\tif sending a disposition notification in response to an MCData group data request, shall include an <mcdata-calling-group-id> element set to the MCData group identity in the application/vnd.3gpp.mcdata-info+xml MIME body;\n6)\tif requiring to send an SDS notification, shall generate an SDS NOTIFICATION message and include it in the SIP MESSAGE request as specified in clause 6.2.3.1;\n7)\tif requiring to send an FD notification, shall generate an FD NOTIFICATION message and include it in the SIP MESSAGE request as specified in clause 6.2.3.2; and\n8)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5].\nUpon receipt of a:\n\"SIP MESSAGE request for SDS disposition notification for terminating MCData client\"; or\n\"SIP MESSAGE request for FD disposition notification for terminating MCData client\";\nthe MCData client:\n1)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body; and\n2)\tshall deliver the notification to the user or application.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "12.2.2\tParticipating MCData function procedures",
                            "text_content": "Upon receipt of a:\n-\t\"SIP MESSAGE request for SDS disposition notification for MCData server\"; or\n-\t\"SIP MESSAGE request for FD disposition notification for MCData server\";\nthe participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall determine the MCData ID of the calling user from the public user identity in the P-Asserted-Identity header field of the SIP MESSAGE request;\nNOTE 1:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tvoid;\n5)\tif the SIP MESSAGE is a \"SIP MESSAGE request for SDS disposition notification for MCData server\" containing an SDS disposition notification type set to a value of \"UNDELIVERED\", shall temporarily store the message for re-delivery, shall start timer TD1 (SDS re-delivery timer) with the timer value as specified in clause F.2.1, and shall not continue with the remaining steps;\nNOTE 2:\tThe participating MCData function attempts re-delivery of the SDS message after timer TD1 (SDS re-delivery timer) expiry.\n6)\tif the SIP MESSAGE is a \"SIP MESSAGE request for SDS disposition notification for MCData server \" containing an SDS disposition notification type set to a value of \"DELIVERED\", \"READ\" or \"DELIVERED AND READ\" and the message was temporarily stored for re-delivery, shall delete the message from temporary store and shall stop TD1 (SDS re-delivery timer);\n6a)\tif the SIP MESSAGE is a \"SIP MESSAGE request for FD disposition notification for MCData server\", and the FD disposition notification type IE is set as \"FILE DOWNLOAD COMPLETED\" as specified in clause 15.2.6 and target MCData user ID is not included as specified in the step 3) of clause 12.2.1.1, shall skip the rest of the steps of this clause after sending the response as follows:\na)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\nb)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5]; and\nc)\tshall clear the corresponding stored deferred group comunication;\n7)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n8)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the controlling MCData function;\nNOTE 3:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 5:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 6:\tHow the participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 7:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n9)\tshall copy all MIME bodies included in the incoming SIP MESSAGE request to the outgoing SIP MESSAGE request;\n10)\tif not already included as part of step 8) above, shall include an application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request, containing an <mcdata-calling-user-id> element set to the MCData ID of the originating user;\n11)\tif the SIP MESSAGE is a \"SIP MESSAGE request for SDS disposition notification for MCData server \", shall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP MESSAGE request;\n12)\tif the SIP MESSAGE is a \"SIP MESSAGE request for FD disposition notification for MCData server \", shall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP MESSAGE request;\n13)\tif the SIP MESSAGE is a \"SIP MESSAGE request for FD disposition notification for MCData server\", and the FD disposition notification type IE is set as \"FILE DOWNLOAD REQUEST ACCEPTED\" or \"FILE DOWNLOAD REQUEST REJECTED\"as specified in clause 15.2.6, shall remove the file from the stored file list;\n14)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function; and\n15)\tshall send the SIP MESSAGE request as specified to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 202 (Accepted) response in response to the above SIP MESSAGE request, the participating MCData function:\n1)\tshall generate a SIP 202 (Accepted) response as specified in 3GPP TS 24.229 [5]; and\n2)\tshall send the SIP 202 (Accepted) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the above SIP MESSAGE request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5]; and\n2)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP MESSAGE request, the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a:\n-\t\"SIP MESSAGE request for SDS disposition notification for terminating MCData client\"; or\n-\t\"SIP MESSAGE request for FD disposition notification for terminating MCData client\";\nthe participating MCData function:\n1)\tif unable to process the request due to a lack of resources or if a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response , optionally containing a Retry-After header field as specified in IETF RFC 3261 [4] . In this case, the participati ng MCData function shall skip the rest of the steps;\n2)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request to retrieve the binding between the MCData ID and the public user identity;\n3)\tif the binding between the MCData ID and the public user identity does not exist, then the participating MCData function shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response and shall skip the rest of the steps;\n4)\tshall generate an outgoing SIP MESSAGE request as specified in clause 6.3.2.1;\n5)\tif sending an SDS disposition notification, shall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP MESSAGE request;\n5)\tif sending an FD disposition notification, shall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP MESSAGE request;\n6)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 2xx, 4xx, 5xx or 6xx response to the outgoing SIP MESSAGE request, the participating MCData function shall forward the SIP response to the controlling MCData function.\nThe participating MCData function shall follow the procedures in this clause to:\n-\tindicate to an MCData client that a request for FD was accepted, deferred or rejected; or\n-\tindicate to an MCData client that a file download has been completed.\nBefore sending a disposition notification the participating MCData function needs to determine:\n-\tthe group identity related to an FD message request received as part of a group communication. The participating MCData function determines the group identity from the contents of the <mcdata-calling-group-id> element contained in the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming FD message request; and\n-\tthe MCData user targeted for the disposition notification. The participating MCData function determines the targetted MCData user from the contents of the <mcdata-calling-user-id> element contained in the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming FD message request.\nThe participating MCData function shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] with the clarifications given below.\nThe participating MCData function:\n1)\tshall build the SIP MESSAGE request as specified in clause 6.3.2.2;\n2)\tshall follow the rules specified in clause 6.4 for the handling of MIME bodies in a SIP message when processing the remaining steps in this clause;\n3)\tshall insert in the SIP MESSAGE request an application/resource-lists+xml MIME body containing the MCData ID of the targeted MCData user in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, according to rules and procedures of IETF RFC 5366 [18];\n4)\tif sending a disposition notification in response to an MCData group data request, shall include an <mcdata-calling-group-id> element set to the MCData group identity in the application/vnd.3gpp.mcdata-info+xml MIME body;\n5)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request, containing an <mcdata-calling-user-id> element set to the MCData ID of the associated disposition notification of the MCData user;\n6)\tif requiring to send an FD notification, shall generate an FD NOTIFICATION message and include it in the SIP MESSAGE request as specified in clause 6.3.8.1; and\n7)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "12.2.3\tControlling MCData function procedures",
                            "text_content": "Upon receipt of a:\n-\t\"SIP MESSAGE request for SDS disposition notification for MCData server\"; or\n-\t\"SIP MESSAGE request for FD disposition notification for MCData server\";\nthe controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. Otherwise, continue with the rest of the steps;\n2)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if an Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" or \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\";\n3)\tif the incoming SIP MESSAGE request does not contain an application/resource-lists+xml MIME body or contains an application/resource-lists+xml MIME body with more than one <entry> element in the set of <list> elements in the <resource-lists> element, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"145 unable to determine called party\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\n4)\tshall attempt to correlate the disposition notification to the original SDS or FD request using the values contained in the Conversation ID and Message ID of the SDS NOTIFICATION message or FD NOTIFICATION message contained in the application/vnd.3gpp.mcdata-signalling MIME body of the SIP MESSAGE;\n5)\tif unable to correlate the disposition notification as determined by step 4), shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"216 unable to correlate the disposition notification\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\n6)\tif:\na)\ta \"SIP MESSAGE request for FD disposition notification for MCData server\" has been received;\nb)\tthe FD disposition notification type IE in the FD NOTIFICATION message is set to \"FILE DOWNLOAD REQUEST REJECTED\"; and\nc)\tthe SIP MESSAGE does not contain an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-calling-group-id> element, or the SIP MESSAGE contains an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-calling-group-id> element and all other FD disposition notifications have been received from the invited group members and were all set to \"FILE DOWNLOAD REQUEST REJECTED\";\nthen:\na)\tshall delete the file stored in the media storage function that is associated with the Conversation ID and Message ID that was included in the FD NOTIFICATION message if no other file availability timers are running for a file; and\nb)\tshall stop the running timer TDC2 (file availability timer), which is associated to the Conversation ID, Message ID, Application ID (if associated), and Extended application ID (if associated) that is included in the FD NOTIFICATION message;\n7)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n8)\tif sending an SDS disposition notification:\na)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8] in the outgoing SIP MESSAGE request; and\nb)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] ] in the outgoing SIP MESSAGE request;\n9)\tif sending an FD disposition notification:\na)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.fd media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8]; and\nb)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n10)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated to the MCData user to be invited;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n11)\tif sending an SDS disposition notification, shall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\";\n12)\tif sending an FD disposition notification, shall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\";\n13)\t shall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the controlling MCData function;\n14)\tshall copy the MCData ID of the MCData user listed in the MIME resources body of the incoming SIP MESSAGE request, into the <mcdata-request-uri> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP MESSAGE request;\n15)\tif the incoming SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-calling-group-id> element:\na)\tshall retrieve the group document for the MCData group id contained in the <mcdata-calling-group-id> element from the group management server, if not already cached, and identify the group members;\nb)\tshall verify that the MCData ID contained in the <mcdata-calling-user-id> element matches to a group member. If there is no match, the controlling MCData function shall reject the SIP request with a SIP 403 (Forbidden) response including warning text set to \"116 user is not part of the MCData group\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\nc)\tif MCData disposition notifications need to be aggregated and an aggregated disposition notification has not yet been sent:\ni)\tif timer TDC1 (disposition aggregation timer) is not running, shall start timer TDC1 (disposition aggregation timer) with the timer value as specified in clause F.2.2;\nii)\tshall copy the application/vnd.3gpp.mcdata-signalling MIME body in the received SIP MESSAGE request to the outgoing SIP MESSAGE request;\nNOTE 6:\tIf the aggregated MCData disposition notifications do not fit into one SIP MESSAGE request, then the controlling MCData function needs to generate a new SIP MESSAGE request for the remaining disposition notifications.\niii)\ton expiry of timer TDC1 (disposition aggregation timer) shall continue with step 16; and\niv)\tif all MCData disposition notifications have been received from all group members shall continue with step 16; and\nd)\tif MCData disposition notifications do not need to be aggregated, shall copy the application/vnd.3gpp.mcdata-signalling MIME body in the received SIP MESSAGE request to the outgoing SIP MESSAGE request and shall continue with step 16;\n16)\tif the incoming SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body without an <mcdata-calling-group-id> element shall copy the application/vnd.3gpp.mcdata-signalling MIME body in the received SIP MESSAGE request to the outgoing SIP MESSAGE request;\n17)\tshall send the SIP MESSAGE request according to according to rules and procedures of 3GPP TS 24.229 [5];\n18)\tshall generate a SIP 202 (Accepted) response in response to the\n-\t\"SIP MESSAGE request for SDS disposition notification for MCData server\"; or\n-\t\"SIP MESSAGE request for FD disposition notification for MCData server\"; and\n19)\tshall send the SIP 202 (Accepted) response towards the originating participating MCData function according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "12.3\tOff-network dispositions",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "12.3.1\tGeneral",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "12.3.2\tSending off-network SDS delivery notification",
                            "text_content": "To send an off-network SDS delivery notification, the MCData client:\n1)\tshall store \"DELIVERED\" as the disposition type;\n2)\tshall generate a SDS OFF-NETWORK NOTIFICATION message as specified in clause 15.1.8. In the SDS OFF-NETWORK NOTIFICATION message, the MCData client:\na)\tshall set the Sender MCData user ID IE to its own MCData user ID as specified in clause 15.2.15;\nb)\tshall set the Conversation ID IE as the stored conversation ID as specified in clause 15.2.9;\nc)\tshall set the Message ID IE as the stored SDS message ID as specified in clause 15.2.10;\nd)\tshall set the Date and time IE as the stored SDS notification time as specified in clause 15.2.8;\ne)\tshall set the SDS disposition notification type IE to the stored disposition type as specified in clause 15.2.5; and\nf)\tmay set:\ni)\tthe Application ID IE to the stored SDS application ID as specified in clause 15.2.7; or\nii)\tthe Extended application ID IE to the stored extended SDS application ID as specified in clause 15.2.24;\n3)\tshall send the SDS OFF-NETWORK NOTIFICATION message to the stored notification target MCData user ID as specified in clause 9.3.1.1;\n4)\tshall initialise the counter CFS2 (SDS notification retransmission) with the value set to 1; and\n5)\tshall start timer TFS2 (SDS notification retransmission).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "12.3.3\tSending off-network SDS read notification",
                            "text_content": "Upon receiving a display indication for the payload to the user or processing of the payload by the target application, the MCData client:\n1)\tshall store \"READ\" as the disposition type;\n2)\tshall store the current UTC time as the stored SDS notification time;\n3)\tshall generate SDS OFF-NETWORK NOTIFICATION message as specified in clause 15.1.8. In the SDS OFF-NETWORK NOTIFICATION message, the MCData client:\na)\tshall set the Sender MCData user ID IE to its own MCData user ID as specified in clause 15.2.15;\nb)\tshall set the Conversation ID IE as the stored conversation ID as specified in clause 15.2.9;\nc)\tshall set the Message ID IE as the stored SDS message ID as specified in clause 15.2.10;\nd)\tshall set the Data and time IE as the SDS notification time as specified in clause 15.2.8;\ne)\tshall set the SDS disposition notification type IE to the stored disposition type as specified in clause 15.2.5; and\nf)\tmay set:\ni)\tthe Application ID IE set to the stored SDS application ID as specified in clause 15.2.7; or\nii)\tthe Extended application ID IE to the stored extended SDS application ID as specified in clause 15.2.24;\n4)\tshall send the SDS OFF-NETWORK NOTIFICATION message to the stored sender MCData user ID as specified in clause 9.3.1.1;\n5)\tshall initialise the counter CFS2 (SDS notification retransmission) with the value set to 1; and\n6)\tshall start timer TFS2 (SDS notification retransmission).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "12.3.4\tSending off-network SDS delivered and read notification",
                            "text_content": "Upon receiving a display indication for the payload to the user or processing of the payload by the target application, the MCData client:\n1)\tshall store \"DELIVERED AND READ\" as the disposition type and stop the timer TFS3 (display and read);\n2)\tshall store the current UTC time as the stored SDS notification time;\n3)\tshall generate SDS OFF-NETWORK NOTIFICATION message. In the SDS OFF-NETWORK NOTIFICATION message, the MCData client:\na)\tshall set the Sender MCData user ID IE to its own MCData user ID as specified in clause 15.2.15;\nb)\tshall set the Conversation ID IE as the stored conversation ID as specified in clause 15.2.9;\nc)\tshall set the Message ID IE as the stored SDS message ID as specified in clause 15.2.10;\nd)\tshall set the Date and time IE as the SDS notification time as specified in clause 15.2.8;\ne)\tshall set the SDS disposition notification type IE to the stored disposition type as specified in clause 15.2.5; and\nf)\tmay set:\ni)\tthe Application ID IE to the stored SDS application ID as specified in clause 15.2.7; or\nii)\tthe Extended application ID IE to the stored extended SDS application ID as specified in clause 15.2.24;\n4)\tshall send the SDS OFF-NETWORK NOTIFICATION message to the stored sender MCData user ID as specified in clause 9.3.1.1;\n5)\tshall initialise the counter CFS2 (SDS notification retransmission) with the value set to 1; and\n6)\tshall start timer TFS2 (SDS notification retransmission).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "12.3.5\tOff-network SDS notification retransmission",
                            "text_content": "Upon expiry of timer TFS2 (SDS notification retransmission), the MCData client:\n1)\tshall generate a SDS OFF-NETWORK NOTIFICATION message as specified in clause 15.1.8. In the SDS OFF-NETWORK NOTIFICATION message, the MCData client:\na)\tshall set the Sender MCData user ID IE to its own MCData user ID as specified in clause 15.2.15;\nb)\tshall set the Conversation ID IE as the stored conversation ID as specified in clause 15.2.9;\nc)\tshall set the Message ID IE as the stored SDS message ID as specified in clause 15.2.10;\nd)\tshall set the Date and time IE as the stored SDS notification time as specified in clause 15.2.8;\ne)\tshall set the SDS disposition type IE to the stored disposition type as specified in clause 15.2.5; and\nf)\tmay set:\ni)\tthe Application ID IE to the stored SDS application ID as specified in clause 15.2.7; or\nii)\tthe Extended application ID IE to the stored extended SDS application ID as specified in clause 15.2.24;\n2)\tshall send the SDS OFF-NETWORK NOTIFICATION message to the stored sender MCData user ID as specified in clause 9.3.1.1;\n3)\tshall increment the counter CFS2 (SDS notification retransmission) by 1; and\n4)\tshall start timer TFS2 (SDS notification retransmission) if the associated counter CFS2 (SDS notification retransmission) has not reached its upper limit.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "12.4\tNetwork-triggered notifications for FD",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "12.4.1\tGeneral",
                            "text_content": "When the controlling MCData function receives a \"SIP MESSAGE request for FD using HTTP for controlling MCData function\" (referred to as FD request), it starts a timer TDC2 (file availability timer). The timer value is derived from the \"file availability\" information contained in metadata in the FD request (if included) or by local policy. The timer running for the file is uniquely associated to the Conversation ID and Message ID in the FD request.\nThe controlling MCData function tracks which MCData client(s) have downloaded the file referenced by the file URL received in an FD request which is associated to a Conversation ID and Message ID. On expiry of timer TDC2 (file availability timer), the controlling MCData function sends a FD NETWORK NOTIFICATION message with a notification type set to \"FILE EXPIRED UNAVAILABLE TO DOWNLOAD\". The MCData client is notified that the file associated with the Conversation ID and Message ID is no longer available to download.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "12.4.2\tControlling MCData function procedures",
                            "text_content": "This clause is referenced from other procedures and is not run standalone.\nThe controlling MCData function\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.fd media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\n3)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\n4)\tshall follow the rules specified in clause 6.4 for the handling of MIME bodies in a SIP message when processing the remaining steps in this clause;\n5)\tshall include in an application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP MESSAGE request:\n-\tthe <mcdata-request-uri> element set to the MCData ID of the MCData user; and\n-\tthe <request-type> element set to a value of \"notify\";\n6)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated to the MCData user to be invited;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n7)\tshall include the public service identity of the controlling MCData function in the P-Asserted-Identity header field; and\n8)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\".\nWhen timer TDC2 (file availability timer) associated to a specific Conversation ID and Message ID expires, the controlling MCData function shall identify a target set of MCData client(s) as being:\n-\tthe MCData client that received a one-to-one file distribution using HTTP for the associated Conversation ID and Message ID, but has not yet downloaded the file; or\n-\teach MCData client that received a group standalone file distribution using HTTP for the associated Conversation ID and Message ID, but have not yet downloaded the file;\nOn expiry of timer TDC2 (file availability timer), for each identified MCData client, the controlling MCData function:\nNOTE:\tThe file availability timer is associated to the Conversation ID and Message ID that was present in the initial FD request.\n1)\tshall generate a SIP MESSAGE request as specified in clause 12.4.2.1;\n2)\tshall include an FD NETWORK NOTIFICATION message in an application/vnd.3gpp.mcdata-signalling MIME body of the SIP MESSAGE request with:\na)\tthe FD notification type IE as \"FILE EXPIRED UNAVAILABLE TO DOWNLOAD\" as specified in clause 15.2.6;\nb)\tshall set the Date and time IE to the current time as specified in clause 15.2.8;\nc)\tthe Conversation ID IE set to a value identifying the conversation, as specified in clause 15.2.9;\nd)\tthe Message ID IE set to a value identifying the message as specified in clause 15.2.10;\ne)\tif an Application ID was stored against the expired timer TDC2 (file availability timer), shall set the Application ID to the stored value as specified in clause 15.2.7;\nf)\tif an Extended application ID was stored against the expired timer TDC2 (file availability timer), shall set the Extended application ID to the stored value as specified in clause 15.2.7; and\n3)\tshall send the SIP MESSAGE request according to according to rules and procedures of 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "12.4.3\tParticipating MCData function procedures",
                            "text_content": "The participating MCData function shall follow the procedures in clause 10.2.4.3.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "12.4.4\tMCData client terminating procedures",
                            "text_content": "On receipt of a SIP MESSAGE request containing an application/vnd.3gpp.mcdata-signalling MIME body with a FD NETWORK NOTIFICATION message, the MCData client:\n1)\tmay reject the SIP MESSAGE request if there are not enough resources to handle the SIP MESSAGE request;\n2)\tif the SIP MESSAGE request is rejected in step 1), shall respond towards the participating MCData function with a SIP 480 (Temporarily unavailable) response and skip the rest of the steps of this clause;\n3)\tshall generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\n4)\tshall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5];\n5)\tshall decode the contents of the FD NETWORK NOTIFICATION message contained in the application/vnd.3gpp.mcdata-signalling MIME body;\n6)\tif the FD NETWORK NOTIFICATION message contains an Application ID or contains an Extended application ID, shall deliver the FD NETWORK NOTIFICATION message to the application; and\n7)\tif the FD NETWORK NOTIFICATION message does not contain an Application ID and does not contain an Extended application ID, shall deliver the FD NETWORK NOTIFICATION message to the user.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "13\tCommunication Release",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "13.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Communication Release allows MCData user or MCData server to release MCData communications on-demand or based on policies. These procedures are applicable for SDS and FD and can be initiated by communication originator or MCData server.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "13.2\tOn-network",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "13.2.1\tGeneral",
                            "text_content": "This procedure is only referenced from other procedures. In order to generate a SIP MESSAGE towards the participating MCData function, the MCData server:\n1)\tshall generate SIP MESSAGE accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\n3)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\";\n4)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the participating MCData function associated to the originating MCData ID user; and\n5)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request, following the rules specified in clause 6.4 for the handling of MIME bodies in a SIP message:\na)\tfill <mcdata-request-uri> element with the MCData ID of the target user.\n6)\tshall include FD HTTP TERMINATION in application/vnd.3gpp.mcdata-signalling.\nWhile generating an FD HTTP TERMINATION message as specified in clause 15.1.3.1, the MCData server:\n1)\tshall set the Conversation ID IE to a value identifying the conversation, as specified in clause 15.2.9;\n2)\tshall set the Message ID IE to a value identifying the message as specified in clause 15.2.10;\n3)\tmay set:\ni)\tthe Application ID IE to the stored value if applicable; or\nii)\tthe Extended application ID IE to the stored value if applicable; and\n4)\tshall include a Payload IE with:\na)\tthe Payload content type set to \"FILEURL\" as specified in clause 15.2.13; and\nb)\tShall set the URL of the file same as of FD transmission.\nThis clause is referred from other clause only. In order to generate a SIP MESSAGE towards participating MCData function:\n1)\tShall generate SIP MESSAGE accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] in the outgoing SIP MESSAGE request;\n3)\tshall include a P-preferred-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\";\n4)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the participating MCData function associated to the MCData ID user; and\n5)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request, following the rules specified in clause 6.4 for the handling of MIME bodies in a SIP message:\na)\tset <mcdata-request-uri> element to the MCData ID of the target user; and\nb)\tshall include FD HTTP TERMINATION application/vnd.3gpp.mcdata-signalling. While including FD HTTP TERMINATION message according to clause E.1.\nWhen generating an FD HTTP TERMINATION message as specified in clause 15.1.11, the MCData client:\n1)\tshall set the Conversation ID IE to a value identifying the conversation, as specified in clause 15.2.9;\n2)\tshall set the Message ID IE to a value identifying the message as specified in clause 15.2.10;\n3)\tmay set:\ni)\tthe Application ID IE ID to the stored value if applicable; or\nii)\tthe Extended Application ID IE to the stored value if applicable; and\n4)\tshall include a Payload IE with:\na)\tthe Payload content type set to \"FILEURL\" as specified in clause 15.2.13; and\nb)\tthe URL of the file same as of FD transmission.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "13.2.2\tMCData originating user initiated communication release",
                            "text_content": "The MCData client can release the communication to indicate MCData service that the user no longer wants to transmit.\nThe procedures described in this clause are applicable to MCData SDS and MCData FD using media plane where originating MCData user initiates the communication release.\nWhen the MCData client wants to release a MCData communication established over the media plane, the MCData client:\n1)\tshall generate a SIP BYE request according to 3GPP TS 24.229 [5];\n2)\tshall set the Request-URI to the MCData session identity to be released; and\n3)\tshall send the SIP BYE request towards MCData server according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response to the SIP BYE request, the MCData client shall release all media plane resources corresponding to the MCData communication being released.\nUpon receiving a SIP BYE request, the MCData client:\n1)\tshall send SIP 200 (OK) response towards MCData server according to 3GPP TS 24.229 [5]; and\n2)\tshall release all media plane resources corresponding to the MCData communication being released.\nNOTE:\tPartially received data can be stored and processed.\nUpon receiving a SIP BYE request from the MCData client, the originating participating MCData function:\n1)\tshall generate a SIP BYE request as specified in 3GPP TS 24.229 [5];\n2)\tshall set the Request-URI to the MCData session identity mentioned in the received SIP BYE request;\n3)\tshall include a P-Asserted-Identity header field in the outgoing SIP BYE request set to the public service identity of the participating MCData function; and\n4)\tshall send the SIP BYE request toward the controlling MCData function, according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response to the SIP BYE request the participating MCData function;\n1)\tshall forward the SIP 200 (OK) response to the originating MCData client and release all media plane resources corresponding to the MCData communication with the originating MCData client; and\n2)\tshall release all media plane resources corresponding to the MCData communication with the controlling MCData function.\nUpon receiving a SIP BYE request from the controlling MCData function, the participating MCData function:\n1)\tshall generate a SIP BYE request according to 3GPP TS 24.229 [5];\n2)\tshall include a P-Asserted-Identity header field in the outgoing SIP BYE request set to the public service identity of the participating MCData function; and\n3)\tshall send the SIP BYE request to the MCData client according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response to the SIP BYE request the participating MCData function:\n1)\tshall send the SIP 200 (OK) response to the SIP BYE request received from the controlling MCData function according to 3GPP TS 24.229 [5] and release all media plane resources corresponding to the MCData communication with the controlling MCData function; and\n2)\tshall release all media plane resources corresponding to the MCData communication with the terminating MCData client.\nThe controlling MCData function shall release the group MCData communication, if:\n1)\tthe controlling MCData function receives an indication from the media plane that the transmission time limit has reached;\n2)\tthe controlling MCData function receives an indication from the media plane that the transmission data limit per request has reached;\n3)\tthere are only one or no participants in the MCData communication;\n4)\taccording to a local policy, the initiator of the group call leaves the MCData communication; or\n5)\tthe minimum number of affiliated MCData group members is not present;\nThe controlling MCData function shall release the one-to-one MCData communication if:\n1)\tthe controlling MCData function receives an indication from the media plane that the transmission time limit has reached;\n2)\tthe controlling MCData function receives an indication from the media plane that the transmission data limit per request has reached; or\n3)\tthere are only one or no participants in the MCData communication.\nUpon receiving a SIP BYE request the controlling MCData function:\n1)\tshall release all media plane resources corresponding to the MCData communication with the originating participating MCData function;\n2)\tshall generate a SIP 200 (OK) response and send the SIP response towards the originating MCData client according to 3GPP TS 24.229 [5];\n3)\tshall check the communication release policy as specified in clause 13.2.2.2.4.1 and clause 13.2.2.2.4.2 whether the MCData communication needs to be released for each participant of the MCData communication; and\n4)\tif release of the MCData communication is required, perform the procedures as specified in the clause 13.2.2.2.4.4.\nWhen a participant needs to be removed from the MCData communication, the controlling MCData function:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] for the MCData communication release;\n2)\tshall generate a SIP BYE request according to 3GPP TS 24.229 [5]; and\n3)\tshall send the SIP BYE request to the MCData client according to 3GPP TS 24.229 [5].\nIf group MCData communication needs to be released, the controlling MCData function shall send SIP BYE requests as described in this clause to all the participants of the communication.\nUpon receiving a SIP 200 (OK) response to a SIP BYE request, the controlling MCData function shall release all media plane resources corresponding to the MCData communication with the terminating participating MCData function.\nThe procedures described in this clause are applicable to MCData FD using HTTP where originating MCData user initiates the communication release. This procedure applicable after file upload happened successfully and originating client sends SDS message towards server.\nWhen MCData client wants to release MCData communication either one-to-one FD or group-FD established over HTTP, the MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] with the clarifications given below.\nThe MCData client:\n1)\tshall build the SIP MESSAGE request as specified in clause 6.2.4.1;\n2)\tif terminating one-to-one FD transmission, shall insert in the SIP MESSAGE request:\na)\tan application/resource-lists+xml MIME body with the MCData ID of the recipient of FD transmission in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, according to rules and procedures of IETF RFC 4826 [9]; and\nb)\tan application/vnd.3gpp.mcdata-info+xml MIME body with a <request-type> element set to a value of \"one-to-one-fd\";\n3)\tif terminating group FD transmission:\na)\tshall insert in the SIP MESSAGE request an application/vnd.3gpp.mcdata-info+xml MIME body with:\ni)\tthe <request-type> element set to a value of \"group-fd\";\nii)\tthe <mcdata-request-uri> element set to the MCData group identity for which FD transmission happening; and\niii)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client;\n4)\tshall generate a standalone FD message as specified in clause 6.2.2.4; and\n5)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5] towards originating particiapting function.\nUpon receiving SIP MESSAGE from server containing application/vnd.3gpp.mcdata-signalling MIME body with HTTP TERMINATION MESSAGE and FD signalling payload message identity value set as FD HTTP TERMINATION as described in clause 15.2.2 then\n1)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5];\n2)\tshall send SIP 200 (OK) response towards participating MCData function according to 3GPP TS 24.229 [5];\n3)\tif FD HTTP TERMINATION message contains an Application ID or contains an Extended Application ID, shall deliver the FD HTTP TERMINATION message to the application; and\n4)\tif Termination information type IE in HTTP TERMINATION MESSAGE is set to \"TERMINATION RESPONSE\" as specified in clause 15.2.22 and If Release Response Type IE present then:\na)\tset to \"RELEASE SUCCESS\" as described in clause 15.2.23 the notify user that termination request is successful; or\nb)\tset to \"RELEASE FAILED\" as described in clause 15.2.23 then notify user that termination request failed.\nOn receipt of a SIP MESSAGE request containing an application/vnd.3gpp.mcdata-signalling MIME body with a FD NETWORK NOTIFICATION message, the MCData client shall follow the procedure as described in clause 12.4.4.\nUpon receipt of a \"SIP MESSAGE request for FD using HTTP for originating participating MCData function\", the participating MCData function should follow the procedure as describe in clause 10.2.4.3.1.\nUpon receipt of a \"SIP MESSAGE request for FD using HTTP for terminating participating MCData function\", the participating MCData function should follow the procedure as describe in clause 10.2.4.3.2.\nUpon receipt of a \"SIP MESSAGE request for FD using HTTP for controlling MCData function\", the controlling MCData function should follow the procedure as describe in clause 10.2.4.4.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "13.2.3\tMCData server initiated communication release without prior indication",
                            "text_content": "Based on local policies and conditions explained in clause 13.2.2.2.4.1 and clause 13.2.2.2.4.2, MCData server can release an ongoing MCData communication. Based on the configuration, MCData server can decide to release the communication without prior notification to MCData client.\nThe procedures described in this clause are applicable to MCData SDS and MCData FD using media plane where MCData server initiates communication release.\nUpon receiving a SIP BYE request from the MCData server, the MCData client should follow the procedure described in clause 13.2.2.2.2.2 with following clarification:\n1)\tshall notify the MCData user with reason for release of communication if SIP BYE request contains reason header.\nUpon receiving SIP BYE request from controlling MCData function, the participating MCData function should follow the procedure described in clause 13.2.2.2.3.2 with following clarification:\n1)\tif reason header is present in the incoming SIP BYE request, shall copy the contents of the reason header field of the incoming SIP BYE request to the reason header field of the outgoing SIP BYE request.\nBased on communication release policies and configuration, when controlling MCData function wants to release communication, the controlling MCData function should follow the procedure as described in clause 13.2.2.2.4.4 with following clarification:\n1)\tshall add reason header with reason-text value as appropriate (e.g. data volume limit, time limit expiry).\nThis procedure described in this clause are applicable to MCData FD using HTTP where MCData server initiates communication release.\nUpon receiving SIP MESSAGE from MCData server containing an application/vnd.3gpp.mcdata-signalling MIME body, the MCData client:\n1)\tshall decode the contents of application/vnd.3gpp.mcdata-signalling MIME body;\n2)\tif application/vnd.3gpp.mcdata-signalling MIME body contains a FD HTTP TERMINATION message as specified in clause 15.1.11 and if the Termination Information Type IE is set to \"TRANSMISSION STOPPED\", then:\na)\tshall generate a SIP 200 OK response according to 3GPP TS 24.229 [5]; and\nb)\tshall send the SIP 200 (OK) response towards MCData server according to 3GPP TS 24.229 [5]; and\n3)\tshall notify MCData user about file transmission being stopped by identifying the corresponding file transmission local database based on conversation id, message id and FILE URL received in FD HTTP TERMINATION message, along with reason.\nOn receipt of a SIP MESSAGE request containing an application/vnd.3gpp.mcdata-signalling MIME body with a FD NETWORK NOTIFICATION message, the MCData client shall follow the procedures as described in clause 12.4.4.\nUpon receipt of a \"SIP MESSAGE request for FD using HTTP for terminating participating MCData function\", the participating MCData function shall follow the procedure as described in clause 10.2.4.3.2.\nBase on communication release policies and configuration, when controlling MCData function wants to release communication, the controlling MCData function:\n1)\tshall execute procedure as described in clause 12.4.2.1 to delete the file and notify to participants with following clarification:\na)\tshall set FD notification type IE as \"FILE DELETED UNAVAILABLE TO DOWNLOAD\" as specified in clause 15.2.18; and\n2)\tshall generate SIP MESSAGE as described in clause 13.2.1.1 and\na)\tshall add reason header with reason-text value as appropriate (e.g. data volume limit, time limit expiry);\nb)\tshall set Termination information type IE of FD HTTP TERMINATION MESSAGE to \"TRANSMISSION STOPPED\" as described in clause 15.2.22; and\nc)\tshall send the SIP MESSAGE to MCData user who initiated the communication according to according to rules and procedures of 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "13.2.4\tMCData server initiated communication release with prior indication",
                            "text_content": "Based on local policies and conditions as mentioned in clause 13.2.2.2.4.1 and clause 13.2.2.2.4.2, the MCData server can release an ongoing MCData communication.\nIf configured to, the MCData server can notify the originating MCData user about the intent to release communication and may request for more data about the communication it intends to release. The procedures described in this clause are applicable to MCData SDS and MCData FD using media plane where the MCData server initiates the communication release.\nUpon receiving a SIP INFO request within the SIP dialog of a MCData communication, with the Info-Package header field set to g.3gpp.mcdata-com-release package and containing an application/vnd.3gpp.mcdata-signalling MIME body associated with the Info-Package, the MCData client:\n1)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body;\n2)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains a COMMUNICATION RELEASE message as specified in clause 15.1.10, with the Comm release information type IE set to \"INTENT TO RELEASE\", then:\na)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5];\nb)\tshall send SIP 200 (OK) response towards MCData server according to 3GPP TS 24.229 [5]; and\nc)\tif an Data query type IE is present and set to \"REMAINING AMOUNT OF DATA\", then:\ni)\tshall generate a DATA PAYLOAD message as described in clause 15.1.4;\nii)\tshall generate a SIP INFO request according to 3GPP TS 24.229 [5] and IETF RFC 6086 [21];\niii)\tshall include in the SIP INFO request, the DATA PAYLOAD message in an application/vnd.3gpp.mcdata-payload MIME body as specified in clause E.2; and\nA)\tshall set a Content-Disposition header field to \"Info-Package\" value; and\niv)\tshall send the SIP INFO request within the SIP dialog of the MCData communication, towards the participating MCData function according to 3GPP TS 24.229 [5]; and\n3)\tshall notify MCData user and present the reason, if the reason header is present in incoming SIP INFO message.\nWhen generating an DATA PAYLOAD message as specified in clause 15.1.4, the MCData client:\n1)\tshall set the Number of payloads IE to 1:\na)\tshall set the Payload content type as \"TEXT\" as specified in clause 15.2.13; and\nb)\tshall include the remaining amount of data in bytes to be sent in the Payload data.\nOnce the MCData user is notified about the MCData server's intent to release the communication, the MCData user may request for extension of communication as described in clause 13.2.4.2.2.\nUpon receiving a request from MCData user for extension of the communication as a result of MCData server's intent to release the communication, the MCData client:\n1)\tshall generate a SIP INFO request according to 3GPP TS 24.229 [5] and IETF RFC 6086 [21];\n2)\tshall include a Info-Package with header field set to g.3gpp.mcdata-com-release;\n3)\tshall include in the SIP INFO request, a COMMUNICATION RELEASE message as specified in clause 15.1.10, in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1; and\na)\tshall set a Content-Disposition header field to \"Info-Package\" value; and\n4)\tshall send the SIP INFO request within the SIP dialog of the MCData communication, towards the participating MCData function according to 3GPP TS 24.229 [5].\nWhen generating an COMMUNICATION RELEASE message as specified in clause 15.1.10, the MCData client:\n1)\tshall set the Comm release information type to \"EXTENSION REQUEST\".\nUpon receiving a SIP INFO request within the SIP dialog of a MCData communication, with the Info-Package header field set to g.3gpp.mcdata-com-release package and containing an application/vnd.3gpp.mcdata-signalling MIME body associated with the Info-Package, the MCData client:\n1)\tshall decode the contents of application/vnd.3gpp.mcdata-signalling MIME body; and\n2)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains a COMMUNICATION RELEASE message as specified in clause 15.1.10, with the Comm release information type IE set to \"EXTENSION RESPONSE\", then:\na)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5];\nb)\tshall send SIP 200 (OK) response towards MCData server according to 3GPP TS 24.229 [5]; and\nc)\tshall notify user about extension response based on Extension Response Type IE.\nUpon receiving a SIP INFO request with the Info-Package header field set to g.3gpp.mcdata-com-release package, from controlling MCData function within the SIP dialog of the MCData communication, the participating MCData function:\n1)\tshall generate a SIP INFO request according to 3GPP TS 24.229 [5] and IETF RFC 6086 [21];\n2)\tshall copy the contents of the Info-Package header field of the incoming SIP INFO request to the Info-Package header field of the outgoing SIP INFO request;\n3)\tshall copy the MIME bodies present in the incoming SIP INFO request to the outgoing SIP INFO request; and\n4)\tshall send the SIP INFO request to the MCData client within the SIP dialog of the MCData communication according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response from MCData client to the SIP INFO request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5]; and\n2)\tshall send a SIP 200 (OK) response to the SIP INFO request received from the controlling MCData function according to 3GPP TS 24.229 [5].\nUpon receiving a SIP INFO request with the Info-Package header field set to g.3gpp.mcdata-com-release package, from MCData client within the SIP dialog of the MCData communication, the participating MCData function:\n1)\tshall generate a SIP INFO request according to rules and procedures of 3GPP TS 24.229 [5] and IETF RFC 6086 [21];\n2)\tshall copy the contents of the Info-Package header field of the incoming SIP INFO request to the Info-Package header field of the outgoing SIP INFO request;\n3)\tshall copy the MIME bodies present in the incoming SIP INFO request to the outgoing SIP INFO request; and\n4)\tshall send the SIP INFO request to the controlling MCData function, within the SIP dialog of the MCData communication, according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response from controlling MCData function to the SIP INFO request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5]; and\n2)\tshall send a SIP 200 (OK) response to the SIP INFO request received from the MCData client according to 3GPP TS 24.229 [5].\nTo send an intent to release a MCData communication, the controlling MCData function:\n1)\tshall generate a SIP INFO request according to rules and procedures of 3GPP TS 24.229 [5] and IETF RFC 6086 [21];\n2)\tshall include the Info-Package header field set to g.3gpp.mcdata-com-release;\n3)\tshall include in the SIP INFO request, a COMMUNICATION RELEASE message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1:\na)\tshall set a Content-Disposition header field to \"Info-Package\" value;\n4)\tmay add reason header with reason-text value as appropriate (e.g. data volume limit, time limit expiry); and\n5)\tshall send a SIP request towards participating MCData function within the SIP dialog of the MCData communication, according to 3GPP TS 24.229 [5].\nWhen generating a COMMUNICATION RELEASE message, the controlling MCData function:\n1)\tshall generate a COMMUNICATION RELEASE message as defined in clause 15.1.10. In the COMMUNICATION RELEASE message, the controlling MCData function:\na)\tshall set Comm Release Information type IE to \"INTENT TO RELEASE\"; and\nb)\tif requesting for more information, shall include and set Data query type IE to the \"REMAINING AMOUNT OF DATA\".\nUpon receiving SIP 200 OK, the controlling MCData function:\n1)\tshall start Timer TDC3 (request for extension).\nIf timer TDC3 (request for extension) expires before controlling MCData function receives a request for extension of communication from the MCData client, the controlling MCData function shall release MCData communication as described in clause 13.2.2.2.4.4.\nUpon receiving a SIP INFO request within the SIP dialog of a MCData communication, with the Info-Package header field set to g.3gpp.mcdata-com-release package and containing an application/vnd.3gpp.mcdata-payload MIME body associated with the Info-Package, the controlling MCData function:\n1)\tshall decode the contents of the application/vnd.3gpp.mcdata-payload MIME body; and\n2)\tshall identify the number of Payload IEs in the DATA PAYLOAD message from the Number of payloads IE in the DATA PAYLOAD message:\na)\tFor each Payload IE:\ni)\tshall store the contents of the Payload IE as remaining data information associated with ongoing MCData communication;\nUpon receiving a SIP INFO request within the SIP dialog of a MCData communication, with the Info-Package header field set to g.3gpp.mcdata-com-release package and containing an application/vnd.3gpp.mcdata-signalling MIME body associated with the Info-Package, the controlling MCData function:\n1)\tshall decode the contents of application/vnd.3gpp.mcdata-signalling MIME body; and\n2)\tif application/vnd.3gpp.mcdata-signalling MIME body contains COMMUNICATION RELEASE message with the comm release information type IE set to \"EXTENSION REQUEST\", the controlling MCData function:\na)\tshall stop the timer TDC3 (request for extension);\nb)\tshall generate SIP 200 (OK) response and send it towards participating MCData function according to 3GPP TS 24.229 [5]; and\nc)\tshall send response to communication extension request as described in clause 13.2.4.4.4.\nTo send a response to communication extension request from MCData client, the controlling MCData function:\n1)\tshall generate a SIP INFO request according to rules and procedures of 3GPP TS 24.229 [5] and IETF RFC 6086 [21];\n2)\tshall include the Info-Package header field set to g.3gpp.mcdata-com-release;\n3)\tshall include in the SIP INFO request, a COMMUNICATION RELEASE message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1; and\na)\tShall set a Content-Disposition header field to \"Info-Package\" value; and\n4)\tshall send a SIP request towards participating MCData function within the SIP dialog of the MCData communication, according to 3GPP TS 24.229 [5].\nWhen generating a COMMUNICATION RELEASE message, the controlling MCData function:\n1)\tShall generate a COMMUNICATION RELEASE message as defined in clause 15.1.10. In the COMMUNICATION RELEASE message, the controlling MCData function:\na)\tShall set Comm Release Information type IE to \"EXTENSION RESPONSE\"; and\nb)\tshall assert the local policy along with already stored remaining data information associated with the MCData communication:\ni)\tIf controlling MCData function decides to accept the request for extension, shall set extension request type information element to \"ACCEPTED\"; or\nii)\tIf controlling MCData function, decides to reject the request for extension, shall set extension request type information element to \"REJECTED\";\nUpon receiving a SIP 200 (OK) response,\n1)\tshall release the MCData communication as described in clause 13.2.2.2.4.4, if controlling MCData function, decides to reject the request for extension.\nBased on communication release policies and configuration, the MCData server can release an ongoing MCData communication.\nIf configured, the MCData server can notify the originating MCData user about the intent to release communication and may request for more data about the communication it intends to release. The procedures described in this clause are applicable to MCData FD using HTTP where the MCData server initiates the communication release.\nUpon receiving a SIP MESSAGE request containing an application/vnd.3gpp.mcdata-signalling MIME body; the MCData client:\n1)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body;\n2)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains a FD HTTP TERMINATION message as specified in clause 15.1.11, with the Termination information type IE set to \"INTENT TO RELEASE COMM OVER HTTP\" then:\na)\tshall identify file transmission request with Conversation ID, Message ID, and FILE URL in FD HTTP TERMINATION message, if identified any transmission:\ni)\tshall generate SIP 200 (OK) according to 3GPP TS 24.229 [5];\nii)\tshall send SIP 200 (OK) response towards MCData server according to 3GPP TS 24.229 [5];\niii)\tshall store the public service identity of the controlling MCData function from <mcdata-controller-psi> element of application/vnd.3gpp.mcdata-signalling MIME body; and\niv)\tshall notify MCData user and present the reason; if the reason header is present in SIP MESSAGE.\nOnce the MCData user is notified about the MCData server's intent to release the communication, the MCData user may request for extension of communication as described in clause 13.2.4.5.2.2\nUpon receiving a request from MCData user for extension of the communication as a result of MCData server's intent to release the communication, the MCData client:\n1)\tshall generate SIP MESSAGE request according to 3GPP TS 24.229 [5];\n2)\tshall generated a standalone FD message as specified in clause 6.2.2.4 with following clarifications:\na)\tshall set Termination information type IE to \"EXTENSION REQUEST FOR COMM OVER HTTP\";\n3)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body:\na)\tshall set <mcdata-controller-psi> element to the store public service identity of controlling MCData function; and\n4)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5] towards originating participating function.\nUpon receiving a SIP MESSAGE request from MCData server containing application/vnd.3gpp.mcdata-signalling MIME body, the MCData client:\n1)\tshall decode the contents of application/vnd.3gpp.mcdata-signalling MIME body; and\n2)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains a FD HTTP TERMINATION message as specified in clause 15.1.11, with the Termination information type IE set to \"EXTENSION RESPONSE FOR COMM OVER HTTP\", then:\na)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5];\nb)\tshall send SIP 200 (OK) response towards MCData server according to 3GPP TS 24.229 [5]; and\n3)\tshall notify user about extension response based on Extension response type IE.\nUpon receipt of a \"SIP MESSAGE request for FD using HTTP for originating participating MCData function\", the participating MCData function shall follow the procedure described in clause 10.2.4.3.1.\nUpon receipt of a \"SIP MESSAGE network notification for FD using HTTP for terminating participating MCData function\", the participating MCData function shall follow the procedure described in clause 10.2.4.3.2\nTo send an intent to release a MCData communication, the controlling MCData function:\n1)\tshall generate a SIP MESSAGE as described in clause 13.2.1.1;\n2)\tshall include <mcdata-controller-psi> element in application/vnd.3gpp.mcdata-info+xml MIME body with public service identity of controlling function;\n3)\tshall set Termination information type IE in FD HTTP TERMINATION of application/vnd.3gpp.mcdata-signalling MIME body to \"INTENT TO RELEASE COMM OVER HTTP\";\n4)\tmay add reason header with reason-text value as appropriate (e.g. data volume limit, time limit expiry); and\n5)\tshall send a SIP request towards participating MCData function according to 3GPP TS 24.229 [5].\nUpon receiving SIP 200 OK, the controlling MCData function:\n1)\tshall start Timer TDC3 (request for extension).\nIf timer TDC3 (request for extension) expires before controlling MCData function receives a request for extension of communication from the MCData client, the controlling MCData function shall release MCData communication as described in clause 13.2.3.3.4.\nUpon receiving a SIP MESSAGE request, the controlling MCData function:\n1)\tshall decode the contents of application/vnd.3gpp.mcdata-signalling MIME body; and\n2)\tif application/vnd.3gpp.mcdata-signalling MIME body contains FD HTTP TERMINATION message with the Termination information type IE set to \"EXTENSION REQUEST FOR COMM OVER HTTP\", the controlling MCData function:\na)\tshall stop the timer TDC3 (request for extension) for file transmission identified by Conversation ID and Message ID and FILE URL;\nb)\tshall generate SIP 200 (OK) response and send it towards participating MCData function according to 3GPP TS 24.229 [5]; and\n3)\tshall send response to communication extension request as described in clause 13.2.4.5.4.3.\nTo send a response to communication extension request from MCData client, the controlling MCData function:\n1)\tshall generate a SIP MESSAGE as described in clause 13.2.1.1;\n2)\tshall set Termination information type IE in FD HTTP TERMINATION of application/vnd.3gpp.mcdata-signalling MIME body to \"EXTENSION RESPONSE FOR COMM OVER HTTP\";\n3)\tshall assert the local policy associated with the MCData communication:\na)\tIf controlling MCData function decides to accept the request for extension, shall set Extension response type IE to \"ACCEPTED\"; or\nb)\tIf controlling MCData function, decides to reject the request for extension, shall set Extension response type IE to \"REJECTED\"; and\n4)\tshall send SIP MESSAGE towards participating MCData function according 3GPP TS 24.229 [5];\nUpon receiving 200 OK response:\n1)\tshall release the MCData communication as described in clause 13.2.3.3.4; if controlling MCData function decides to reject the request for extension.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "13.2.5\tAuthorized MCData user initiated communication release without prior indication",
                            "text_content": "An authorized MCData user at any point of time during an ongoing MCData communication decides to release communication. An authorized MCData user should be part of the ongoing MCData communication. The procedure in this clause describes the case where an authorized MCData user decides to release the communication without providing prior indication to originator MCData user.\nThe procedures described in this clause are applicable to MCData SDS and MCData FD established using media plane.\nUpon receiving request from an authorized MCData user to release the communication without prior indication to originating MCData user, the MCData client:\n1)\tshall generate a SIP INFO request according to rules and procedures of 3GPP TS 24.229 [5] and IETF RFC 6086 [21];\n2)\tshall include the Info-Package header field set to g.3gpp.mcdata-com-release;\n3)\tshall include in the SIP INFO request, a COMMUNICATION RELEASE message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1:\na)\tshall set a Content-Disposition header field to \"Info-Package\" value;\n4)\tshall insert in the SIP INFO request an application/vnd.3gpp.mcdata-info+xml MIME body with\na)\tthe <mcdata-client-id> element set to the MCData client ID of the authorized MCData client;\n5)\tmay add reason header with reason-text value as appropriate; and\n6)\tshall send a SIP request towards participating MCData function within the SIP dialog of the MCData communication, according to 3GPP TS 24.229 [5].\nWhen generating a COMMUNICATION RELEASE message, the MCData client:\n1)\tshall generate a COMMUNICATION RELEASE message as defined in clause 15.1.10. In the COMMUNICATION RELEASE message, the MCData client:\na)\tshall set Comm Release Information type IE to \"AUTH USER RELEASE REQ\".\nUpon receiving a SIP 200 (OK) response from participating MCData function to the SIP INFO request, the MCData client should inform the authorized MCData user about acceptance of communication release request by MCData server.\nUpon receiving a SIP 403 (Forbidden) response from participating MCData function to the SIP INFO request, the MCData client should inform the authorized MCData user about rejection of communication release request by MCData server.\nUpon receiving a SIP INFO request with the Info-Package header field set to g.3gpp.mcdata-com-release package, from MCData client within the SIP dialog of the MCData communication, the participating MCData function should follow the procedure described in clause 13.2.4.3.2.\nUpon receiving a SIP 403 (Forbidden) response from controlling MCData function to the SIP INFO request, the participating MCData function:\n1)\tshall generate a SIP 403 (Forbidden) response according to 3GPP TS 24.229 [5]; and\n2)\tshall send a SIP 403 (Forbidden) response to the SIP INFO request received from the MCData client according to 3GPP TS 24.229 [5].\nUpon receiving a SIP INFO request within the SIP dialog of a MCData communication, with the Info-Package header field set to g.3gpp.mcdata-com-release package and containing an application/vnd.3gpp.mcdata-signalling MIME body associated with the Info-Package, the controlling MCData function:\n1)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body;\n2)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains a COMMUNICATION RELEASE message as specified in clause 15.1.10, with the Comm release information type IE set to \"AUTH USER RELEASE REQ\", then:\na)\tshall validate whether MCData user from which communication release request is received is authorized or not based on configuration;\n3)\tif MCData user validation is not successful,\na)\tshall generate a SIP 403 (Forbidden) response according to 3GPP TS 24.229 [5];\nb)\tshall send SIP 403 (Forbidden) response towards participating MCData function according to 3GPP TS 24.229 [5];\nc)\tshall skip further steps;\n4)\tif MCData user validation is successful,\na)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5];\nb)\tshall send SIP 200 (OK) response towards MCData server according to 3GPP TS 24.229 [5];\n5)\tshall follow the procedure as described in clause 13.2.3.2.4 to terminate the ongoing communication;\nThe procedures described in this clause are applicable to MCData FD over HTTP.\nUpon receiving request from an authorized MCData user to release the communication without prior indication to originating MCData user, the MCData client\n1)\tshall generate a SIP MESSAGE as specified in clause 13.2.1.2, then:\na)\tshall set the Termination information type IE if FD HTTP TERMINATION message to \"AUTH USER TERMINATION REQUEST FOR COMM OVER HTTP\" as specified in clause 15.2.22;\n2)\tshall add application/vnd.3gpp.mcdata-info+xml MIME body in SIP MESSAGE with:\na)\tshall set <mcdata-controller-psi> element to the value received in incoming SIP MESSAGE; and\nb)\tshall add <mcdata-client-id> element set to the MCData client ID of the authorized MCData client;\n3)\tmay add reason header with reason-text value as appropriate; and\n4)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5] towards originating participating function.\nUpon receiving a SIP 200 (OK) response from participating MCData function to the SIP MESSAGE request, the MCData client should inform the authorized MCData user about acceptance of communication release request by MCData server.\nUpon receiving a SIP 403 (Forbidden) or SIP 404 (Not found) response from participating MCData function to the SIP MESSAGE request, the MCData client should inform the authorized MCData user about rejection of communication release request by MCData server.\nUpon receiving SIP MESSAGE from server containing application/vnd.3gpp.mcdata-signalling MIME body with HTTP TERMINATION MESSAGE and FD signalling payload message identity value set as FD HTTP TERMINATION as described in clause 15.2.2, the authorized MCData client shall follow the procedure as described in clause 13.2.2.3.2.1.2.\nUpon receipt of a \"SIP MESSAGE request for FD using HTTP for originating participating MCData function\", the participating MCData function shall follow the procedure as described in clause 10.2.4.3.1.\nUpon receipt of a \"SIP MESSAGE network notification for FD using HTTP for terminating participating MCData function\", the participating MCData function shall follow the procedure as described in clause 10.2.4.3.2.\nUpon receiving a SIP MESSAGE request and containing an application/vnd.3gpp.mcdata-signalling MIME body, the controlling MCData function:\n1)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body;\n2)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains FD HTTP TERMINATION message as specified in clause 15.1.11 then:\na)\tif Termination information type IE set to \"AUTH USER TERMINATION REQUEST FOR COMM OVER HTTP\", then:\ni)\tshall validate whether MCData user identified in <mcdata-calling-userid> element of application/vnd.3gpp.mcdata-info+xml, is authorized or not based on configuration;\nb)\tif MCData user validation is not successful:\ni)\tshall generate a SIP 403 (Forbidden) response according to 3GPP TS 24.229 [5];\nii)\tshall send SIP 403 (Forbidden) response towards participating MCData function according to 3GPP TS 24.229 [5]; and\niii)\tshall skip further steps;\nc)\tif MCData user validation is successful:\ni)\tif not able to identify file transmission using the Conversation ID, Message ID and file URL, shall send SIP 404 (Not Found) with reason with waring text set to \"224 No transmission available\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\nii)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5]; and\nii)\tshall send SIP 200 (OK) response towards MCData server according to 3GPP TS 24.229 [5]; and\nd)\tshall follow the procedure as described in clause 13.2.3.3.4 to terminate the ongoing communication.\nThe controlling MCData function should follow procedure as described in clause 6.3.6.1 to generate response to the authorized user initiated request for release of MCData communication with following clarifications:\n1)\tshall set Release response type IE to:\na)\t\"RELEASE SUCCESS\" if communication release request is successful; or\nb)\t\"RELEASE FAILED\" if communication release request is not successful; and\n2)\tshall send the SIP MESSAGE request towards the authorized MCData client as specified in 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "13.2.6\tAuthorized MCData user initiated communication release with prior indication",
                            "text_content": "An authorized MCData user at any point of time during an ongoing MCData communication decides to release communication. An authorized MCData user should be part of the ongoing MCData communication. The procedure in this clause describes the case where an authorized MCData user decides to release the communication with providing prior indication to originator MCData user.\nThe procedures described in this clause are applicable to MCData SDS and MCData FD established using media plane.\nUpon receiving request from an authorized MCData user to release the communication without prior indication to originating MCData user, the MCData client:\n1)\tshall generate a SIP INFO request according to rules and procedures of 3GPP TS 24.229 [5] and IETF RFC 6086 [21];\n2)\tshall include the Info-Package header field set to g.3gpp.mcdata-com-release;\n3)\tshall include in the SIP INFO request, a COMMUNICATION RELEASE message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1:\na)\tshall set a Content-Disposition header field to \"Info-Package\" value;\n4)\tshall insert in the SIP INFO request an application/vnd.3gpp.mcdata-info+xml MIME body with:\na)\tthe <mcdata-client-id> element set to the MCData client ID of the authorized MCData client;\n5)\tmay add reason header with reason-text value as appropriate; and\n6)\tshall send a SIP request towards participating MCData function within the SIP dialog of the MCData communication, according to 3GPP TS 24.229 [5].\nWhen generating a COMMUNICATION RELEASE message, the MCData client:\n1)\tshall generate a COMMUNICATION RELEASE message as defined in clause 15.1.10. In the COMMUNICATION RELEASE message, the MCData client:\na)\tshall set Comm Release Information type IE to \"INTENT TO RELEASE\"; and\nb)\tif requesting for more information, shall include and set Data query type IE to the \"REMAINING AMOUNT OF DATA\".\nUpon receiving a SIP 200 (OK) response from participating MCData function to the SIP INFO request, the MCData client should inform the authorized MCData user about acceptance of communication release request by MCData server.\nUpon receiving a SIP 403 (Forbidden) response from participating MCData function to the SIP INFO request, the MCData client should inform the authorized MCData user about rejection of communication release request by MCData server.\nUpon receiving a SIP INFO request within the SIP dialog of a MCData communication, with the Info-Package header field set to g.3gpp.mcdata-com-release package and containing an application/vnd.3gpp.mcdata-payload MIME body associated with the Info-Package, the authorized MCData client:\n1)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5];\n2)\tshall send SIP 200 (OK) response towards participating MCData function according to 3GPP TS 24.229 [5];\n3)\tshall decode the contents of the application/vnd.3gpp.mcdata-payload MIME body; and\n4)\tshall identify the number of Payload IEs in the DATA PAYLOAD message:\na)\tfor each Payload IE:\ni)\tshall store the contents of the Payload IE as remaining data information associated with ongoing MCData communication.\nUpon receiving a SIP INFO request within the SIP dialog of a MCData communication, with the Info-Package header field set to g.3gpp.mcdata-com-release package and containing an application/vnd.3gpp.mcdata-signalling MIME body associated with the Info-Package, the authorized MCData client:\n1)\tshall decode the contents of application/vnd.3gpp.mcdata-signalling MIME body; and\n2)\tif application/vnd.3gpp.mcdata-signalling MIME body contains COMMUNICATION RELEASE message with the comm release information type IE set to \"EXTENSION REQUEST\", the MCData client:\na)\tshall generate SIP 200 (OK) response and send it towards participating MCData function according to 3GPP TS 24.229 [5]; and\nb)\tshall notify authorized MCData user about extension request and also present more information received previously to authorized MCData user; and\n3)\tbased on authorized MCData user's response, shall send response to communication extension request as described in clause 13.2.6.2.4.\nTo send a response to communication extension request from originator MCData client, the authorized MCData client:\n1)\tshall generate a SIP INFO request according to rules and procedures of 3GPP TS 24.229 [5] and IETF RFC 6086 [21];\n2)\tshall include the Info-Package header field set to g.3gpp.mcdata-com-release;\n3)\tshall include in the SIP INFO request, a COMMUNICATION RELEASE message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1;\na)\tShall set a Content-Disposition header field to \"Info-Package\" value; and\n4)\tshall send a SIP request towards participating MCData function within the SIP dialog of the MCData communication, according to 3GPP TS 24.229 [5].\nWhen generating a COMMUNICATION RELEASE message, the MCData client:\n1)\tshall generate a COMMUNICATION RELEASE message as defined in clause 15.1.10. In the COMMUNICATION RELEASE message, the MCData client:\na)\tshall set Comm Release Information type IE to \"EXTENSION RESPONSE\"; and\nb)\tshall set extension request type information element as follows:\ni)\tif authorized MCData user decides to accept the request for extension, shall set extension request type information element to \"ACCEPTED\"; or\nii)\tif authorized MCData user decides to reject the request for extension, shall set extension request type information element to \"REJECTED\".\nUpon receiving a SIP INFO request with the Info-Package header field set to g.3gpp.mcdata-com-release package, from MCData client within the SIP dialog of the MCData communication, the participating MCData function should follow the procedure described in clause 13.2.4.3.2.\nUpon receiving a SIP 403 (Forbidden) response from controlling MCData function to the SIP INFO request, the participating MCData function:\n1)\tshall generate a SIP 403 (Forbidden) response according to 3GPP TS 24.229 [5]; and\n2)\tshall send a SIP 403 (Forbidden) response to the SIP INFO request received from the MCData client according to 3GPP TS 24.229 [5].\nUpon receiving a SIP INFO request with the Info-Package header field set to g.3gpp.mcdata-com-release package, from controlling MCData function within the SIP dialog of the MCData communication, the participating MCData function shall follow the procedure described in clause 13.2.4.3.1.\nUpon receiving a SIP INFO request within the SIP dialog of a MCData communication, with the Info-Package header field set to g.3gpp.mcdata-com-release package and containing an application/vnd.3gpp.mcdata-signalling MIME body associated with the Info-Package, the controlling MCData function:\n1)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body;\n2)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains a COMMUNICATION RELEASE message as specified in clause 15.1.10, with the Comm release information type IE set to AUTH USER RELEASE REQ, then:\na)\tshall validate whether MCData user, from which communication release request is received, is authorized or not based on configuration;\n3)\tif MCData user is not authorized to release the MCData communication,\na)\tshall generate a SIP 403 (Forbidden) response according to 3GPP TS 24.229 [5];\nb)\tshall send SIP 403 (Forbidden) response towards participating MCData function according to 3GPP TS 24.229 [5]; and\nc)\tshall skip further steps;\n4)\tif MCData user is authorized to release the MCData communication,\na)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5]; and\nb)\tshall send SIP 200 (OK) response towards participating MCData function according to 3GPP TS 24.229 [5]; and\n5)\tshall follow the procedure as described in clause 13.2.4.4.1 with following clarifications;\na)\tshall copy reason header from SIP INFO message received from participant MCData function.\nThe controlling MCData function should store the information related to initiator of MCData communication release process.\nUpon receiving a SIP INFO request within the SIP dialog of a MCData communication, with the Info-Package header field set to g.3gpp.mcdata-com-release package and containing an application/vnd.3gpp.mcdata-payload MIME body associated with the Info-Package, the controlling MCData function:\n1)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5];\n2)\tshall send SIP 200 (OK) response towards participating MCData server according to 3GPP TS 24.229 [5].\nIf controlling MCDta function is not the initiator of the MCData communication release process, the controlling MCData function should send more information received in SIP INFO message to authorized MCData user who is the initiator of the MCData communication release process. The controlling MCData function:\n1)\tshall generate a SIP INFO request according to 3GPP TS 24.229 [5] and IETF RFC 6086 [21];\n2)\tshall generate a DATA PAYLOAD message as described in clause 15.1.4;\n3)\tshall include in the SIP INFO request, the DATA PAYLOAD message in an application/vnd.3gpp.mcdata-payload MIME body as specified in clause E.2;\na)\tshall set a Content-Disposition header field to \"Info-Package\" value;\n4)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request:\na)\tthe <mcdata-request-uri> element set to the MCData ID of the authorized MCData user; and\n5)\tshall send the SIP INFO request within the SIP dialog of the MCData communication, towards the participating MCData function according to 3GPP TS 24.229 [5].\nWhen generating an DATA PAYLOAD message as specified in clause 15.1.4, the MCData client:\n1)\tshall set the Number of payloads IE to the same number which it received in SIP INFO message from participating function:\na)\tshall copy every payload IE from SIP INFO message received from participating function.\nUpon receiving a SIP INFO request within the SIP dialog of a MCData communication, with the Info-Package header field set to g.3gpp.mcdata-com-release package and containing an application/vnd.3gpp.mcdata-signalling MIME body associated with the Info-Package, the controlling MCData function:\n1)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5]; and\n2)\tshall send SIP 200 (OK) response towards participating MCData function according to 3GPP TS 24.229 [5].\nIf controlling MCDta function is not the initiator of the MCData communication release process, the controlling MCData function should send request for extension of communication received in SIP INFO message to authorized MCData user who is the initiator of the MCData communication release process. The controlling MCData function:\n1)\tshall generate a SIP INFO request according to 3GPP TS 24.229 [5] and IETF RFC 6086 [21];\n2)\tshall include a Info-Package with header field set to g.3gpp.mcdata-com-release;\n3)\tshall include in the SIP INFO request, a COMMUNICATION RELEASE message as specified in clause 15.1.10, in an application/vnd.3gpp.mcdata-signalling MIME body as specified in clause E.1; and\na)\tshall set a Content-Disposition header field to \"Info-Package\" value;\n4)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request:\na)\tthe <mcdata-request-uri> element set to the MCData ID of the authorized MCData user;\n5)\tshall send the SIP INFO request within the SIP dialog of the MCData communication, towards the participating MCData function according to 3GPP TS 24.229 [5].\nWhen generating an COMMUNICATION RELEASE message as specified in clause 15.1.10, the MCData client:\n1)\tshall set the Comm release information type to \"EXTENSION REQUEST\".\nUpon receiving a SIP INFO request within the SIP dialog of a MCData communication, with the Info-Package header field set to g.3gpp.mcdata-com-release package and containing an application/vnd.3gpp.mcdata-signalling MIME body associated with the Info-Package, the controlling MCData function:\n1)\tshall decode the contents of application/vnd.3gpp.mcdata-signalling MIME body; and\n2)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains a COMMUNICATION RELEASE message as specified in clause 15.1.10, with the Comm release information type IE set to \"EXTENSION RESPONSE\", then:\na)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5]; and\nb)\tshall send SIP 200 (OK) response towards participating MCData function according to 3GPP TS 24.229 [5].\nIf controlling MCDta function is not the initiator of the MCData communication release process, the controlling MCData function should send response to request for extension of communication received in SIP INFO message to originator MCData user. The controlling MCData function should follow procedure described in clause 13.2.4.4.4 with following clarification:\n1)\twhile generating a COMMUNICATION RELEASE message;\na)\tshall copy the extension request type information element from SIP INFO message received from authorized MCData client.\nAfter sending response to originator MCData user, the controlling MCData function:\n1)\tshall release the MCData communication as described in clause 13.2.2.2.4.4, if authorized MCData user has rejected the request for extension.\nThe procedures described in this clause are applicable to MCData FD over HTTP.\nUpon receiving request from an authorized MCData user to release the communication without prior indication to originating MCData user, the MCData client:\n1)\tshall generate a SIP MESSAGE as specified in clause 13.2.1.2, then:\na)\tshall set the Termination information type IE of FD HTTP TERMINATION message to \"INTENT TO RELEASE COMM OVER HTTP\";\n2)\tshall add application/vnd.3gpp.mcdata-info+xml MIME body in SIP MESSAGE with:\na)\tshall set <mcdata-controller-psi> element to the value received in incoming SIP MESSAGE; and\nb)\tshall add <mcdata-client-id> element set to the MCData client ID of the authorized MCData client;\n3)\tmay add reason header with reason-text value as appropriate; and\n4)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5] towards originating participating function.\nUpon receiving a SIP 200 (OK) response from participating MCData function to the SIP MESSAGE request, the MCData client should inform the authorized MCData user about acceptance of communication release request by MCData server.\nUpon receiving a SIP 403 (Forbidden) or SIP 404 (Not found) response from participating MCData function to the SIP MESSAGE request, the MCData client should inform the authorized MCData user about rejection of communication release request by MCData server.\nUpon receiving a SIP MESSAGE containing application/vnd.3gpp.mcdata-signalling MIME body then MCData client:\n1)\tshall decode contents of application/vnd.3gpp.mcdata-signalling;\n2)\tif application/vnd.3gpp.mcdata-signalling MIME body contains FD HTTP TERMINATION message with the Termination information type IE set to \"EXTENSION REQUEST FOR COMM OVER HTTP\", the authorized MCData client:\na)\tshall generate SIP 200 (OK) response and send it towards participating MCData function according to 3GPP TS 24.229 [5]; and\nb)\tshall notify authorized MCData user about extension request to authorized MCData user; and\n3)\tbased on authorized MCData user's response, shall send response to communication extension request as described in clause 13.2.6.3.2.3.\nTo send a response to communication extension request from originator MCData client, the authorized MCData client:\n1)\tshall generate a SIP MESSAGE as specified in clause 13.2.1.2, then:\na)\tshall set the Termination information type IE if FD HTTP TERMINATION message to \"EXTENSION RESPONSE FOR COMM OVER HTTP\";\nb)\tshall set Extension response type IE as follows:\ni)\tif authorized MCData user decides to accept the request for extension, shall set to \"ACCEPTED\"; or\nii)\tif authorized MCData user decides to reject the request for extension, shall set to \"REJECTED\";\n2)\tshall add application/vnd.3gpp.mcdata-info+xml MIME body in SIP MESSAGE with:\na)\tshall set <mcdata-controller-psi> element to the value received in incoming SIP MESSAGE of FD transmission message; and\nb)\tshall add <mcdata-client-id> element set to the MCData client ID of the authorized MCData client;\n3)\tmay add reason header with reason-text value as appropriate; and\n4)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5] towards originating participating function.\nUpon receiving SIP MESSAGE from server containing application/vnd.3gpp.mcdata-signalling MIME body with HTTP TERMINATION MESSAGE and FD signalling payload message identity value set as FD HTTP TERMINATION as described in clause 15.2.2, the authorized MCData client shall follow the procedure as described in clause 13.2.2.3.2.1.2.\nUpon receipt of a \"SIP MESSAGE request for FD using HTTP for originating participating MCData function\", the originating participating MCData function shall follow the procedure as described in clause 10.2.4.3.1.\nUpon receipt of a \"SIP MESSAGE network notification for FD using HTTP for terminating participating MCData function\", the terminating participating MCData function shall follow the procedure as described in clause 10.2.4.3.2.\nUpon receiving SIP MESSAGE from authorized MCData client containing an application/vnd.3gpp.mcdata-signalling MIME body; the controlling MCData function:\n1)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body;\n2)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains a FD HTTP TERMINATION message as specified in clause 15.1.11, with the Termination information type IE set to \"INTENT TO RELEASE FOR COMM OVER HTTP\", then:\na)\tshall get authorized MCData user identity from <mcdata-calling-userid> element of application/vnd.3gpp.mcdata-info+xml MIME body and validate whether authorized MCData user, from which communication release request is received, is authorized or not based on configuration;\n3)\tif MCData user is not authorized to release the MCData communication,\na)\tshall generate a SIP 403 (Forbidden) response according to 3GPP TS 24.229 [5];\nb)\tshall send SIP 403 (Forbidden) response towards participating MCData function according to 3GPP TS 24.229 [5]; and\nc)\tshall skip further steps;\n4)\tif MCData user is authorized to release the MCData communication:\na)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5]; and\nb)\tshall send SIP 200 (OK) response towards participating MCData function according to 3GPP TS 24.229 [5]; and\n5)\tshall follow the procedure as described in clause 13.2.4.5.3.1 with following clarifications;\na)\tshall copy reason header from SIP MESSAGE received from participant MCData function.\nThe controlling MCData function should store the information related to initiator of MCData communication release process.\nUpon receiving SIP MESSAGE containing an application/vnd.3gpp.mcdata-signalling MIME body, the Controlling MCData function:\n1)\tshall decode the contents of application/vnd.3gpp.mcdata-signalling MIME body; and\n2)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains a COMMUNICATION RELEASE message as specified in clause 15.1.10, with the Comm release information type IE set to \"EXTENSION REQUEST FOR COMM OVER HTTP\", then:\na)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5]; and\nb)\tshall send SIP 200 (OK) response towards participating MCData function according to 3GPP TS 24.229 [5].\nIf controlling MCData function is not the initiator of the MCData communication release process, the controlling MCData function should send request for extension of communication received in SIP MESSAGE to authorized MCData user who is the initiator of the MCData communication release process. The controlling MCData function:\n1)\tshall generate SIP MESSAGE as described in clause 13.2.1.1;\n2)\tshall include application/vnd.3gpp.mcdata-info+xml MIME body, then:\na)\tshall set <mcdata-request-uri> element to authorized user MCData id;\n3) shall set Termination information type IE of FD HTTP TERMINATION message to \"EXTENSION REQUEST FOR COMM OVER HTTP\" as specified in clause 15.2.22; and\n4)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5] towards participating function.\nUpon receiving a SIP MESSAGE containing an application/vnd.3gpp.mcdata-signalling MIME body, the controlling MCData function:\n1)\tshall decode the contents of application/vnd.3gpp.mcdata-signalling MIME body; and\n2)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains a FD HTTP TERMINATION message as specified in clause 15.1.11, with the Termination information type IE set to \"EXTENSION RESPONSE FOR COMM OVER HTTP\", then:\na)\tshall generate a SIP 200 (OK) response according to 3GPP TS 24.229 [5]; and\nb)\tshall send SIP 200 (OK) response towards participating MCData function according to 3GPP TS 24.229 [5].\nIf controlling MCData function is not the initiator of the MCData communication release process, the controlling MCData function should send response to request for extension of communication received in SIP MESSAGE to originator MCData user. The controlling MCData function should follow procedure described in clause 13.2.4.2.3.2 with following clarification:\n1)\twhile generating a FD HTTP TERMINATION message;\na)\tshall copy the Extension response type information element from SIP MESSAGE received from authorized MCData client.\nAfter sending response to originator MCData user, the controlling MCData function:\n1)\tshall release the MCData communication as described in clause 13.2.3.3.4, if authorized MCData user has rejected the request for extension.\nThe controlling MCData function should follow procedure as described in clause 6.3.6.1 to generate response to the authorized user initiated request for release of MCData communication with following clarifications:\n1)\tshall set Release response type IE to:\na)\t\"RELEASE SUCCESS\" if communication release request is successful; or\nb)\t\"RELEASE FAILED\" if communication release request is not successful.\n2)\tshall send the SIP MESSAGE request towards the authorized MCData client as specified in 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "14\tEnhanced Status (ES)",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "14.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "14.2\tOn-network ES",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "14.2.1\tMCData client procedures",
                            "text_content": "Upon receiving a request from the MCData user to send an enhanced status to an MCData group and the <mcdata-allow-enhanced-status> element under the <list-service> element as defined in 3GPP TS 24.481 [11] is set to \"true\", the MCData client:\n1)\tshall use the \"id\" attribute of the MCData user selected operation value from <mcdata-enhanced-status-operational-values> element under <list-service> element as defined in 3GPP TS 24.481 [11], to generate a group standalone SDS message by following the procedure described in clause 9.2.2.2.1.\nUpon receiving a \"SIP MESSAGE request for standalone SDS for terminating MCData client\", the MCData client:\n1)\tshall follow the procedure defined in clause 9.2.2.2.2;\n2)\tshall match the received value with an \"id\" attribute of the operational values from the <mcdata-enhanced-status-operational-values> element of the MCData group document as defined in 3GPP TS 24.481 [11]; and\n3)\tif a match is found, shall render the operational value as enhanced status to the MCData user. Otherwise shall discard the received message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "14.2.2\tParticipating MCData function procedures",
                            "text_content": "Upon receipt of a \"SIP MESSAGE request for standalone SDS for originating participating MCData function\", the participating MCData function should follow the procedure described in clause 9.2.2.3.1.\nUpon receipt of a \"SIP MESSAGE request for standalone SDS for terminating participating MCData function\", the participating MCData function should follow the procedure described in clause 9.2.2.3.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "14.2.3\tControlling MCData function procedures",
                            "text_content": "Upon receipt of a \"SIP MESSAGE request for standalone SDS for controlling MCData function\", the controlling MCData function should follow the procedure described in clause 9.2.2.4.1.1.\nUpon receipt of a \"SIP MESSAGE request for standalone SDS for controlling MCData function\", the controlling MCData function should follow the procedure described in clause 9.2.2.4.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "14.3\tOff-network ES",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "14.3.1\tSending enhanced status message",
                            "text_content": "Upon receiving request from MCData user to share enhanced for selected group:\n1)\tif the value of \"/<x>/<x>/Common/MCData/AllowedEnhSvc\" leaf node present in the group configuration as specified in 3GPP TS 24.483 [4] is set to \"true\" for the MCData group, the MCData client:\na)\tshall use \"/<x>/<x>/Common/MCData/EnhSvcOpValues/<x>/EnhSvcOpID\" leaf node associated with user selected enhanced status operation value present in the group configuration as specified in 3GPP TS 24.483 [2] to generate a group standalone SDS message by following the procedure described in clause 9.3.2.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "14.3.2\tReceiving enhanced status message",
                            "text_content": "Upon receipt of a SDS OFF-NETWORK MESSAGE message, the MCData client:\n1)\tshall follow the procedure defined in clause 9.3.2.4;\n2)\tshall attempt to match the received value with a \"/<x>/<x>/Common/MCData/EnhSvcOpValues/<x>/EnhSvcOpID\" leaf node present in the group configuration as specified in 3GPP TS 24.483 [2]; and\n3)\tif a match is found, shall render the associated operational value from \"/<x>/<x>/Common/MCData/EnhSvcOpValues/<x>/EnhSvcOpValue\" leaf node as enhanced status to the MCData user.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "15\tMessage Formats",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "15.1\tMCData message functional definitions and contents",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "15.1.1\tGeneral",
                            "text_content": "The following clauses describe the MCData message functional definitions and contents. Each message consist of a series of information elements. The standard format of an MCData message and the encoding rules for each type of information element follow that defined for the MCPTT Off-Network Protocol (MONP) as documented in Annex I of 3GPP TS 24.379 [10]. The associated MIME types and related considerations are documented in Annex E of the present document.\nFor off-network transport, the MONP MCData messages are transported in a MONP MCDATA CARRIER message defined in TS 24.379 [10].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "15.1.2\tSDS SIGNALLING PAYLOAD message",
                            "text_content": "This message is sent by the UE to other UEs when sending an SDS data payload. This message provides the signalling content related to the SDS data payload. For the contents of the message see Table 15.1.2.1-1.\nMessage type:\tSDS SIGNALLING PAYLOAD\nDirection:\tUE to other UEs (can be via network)\nTable 15.1.2.1-1: SDS SIGNALLING PAYLOAD message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.2.1-1: SDS SIGNALLING PAYLOAD message content",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.3\tFD SIGNALLING PAYLOAD message",
                            "text_content": "This message is sent by the UE to other UEs when sending an FD data payload. This message provides the signalling content related to the FD data payload. For the contents of the message see Table 15.1.3.1-1.\nMessage type:\tFD SIGNALLING PAYLOAD\nDirection:\tUE to other UEs (via the network)\nTable 15.1.3.1-1: FD SIGNALLING PAYLOAD message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.3.1-1: FD SIGNALLING PAYLOAD message content",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.4\tDATA PAYLOAD message",
                            "text_content": "This message is sent by the UE to other UEs when sending an SDS data payload or an FD data payload. This message provides the data to be delivered to the user or application. For the contents of the message see Table 15.1.4.1-1.\nMessage type:\tDATA PAYLOAD\nDirection:\tUE to other UEs (can be via the network for SDS and always via the network for FD)\nTable 15.1.4.1-1: DATA PAYLOAD message content\n\nNOTE 1:\tThe Number of payloads IE dictates the number of Payload IEs and Security parameters and Payload IEs that are included in the message by the sender. Multiple Payload IEs can be part of Security parameters and Payload IE if end-to-end security is required, i.e. if there are multiple protected user payloads, each one should be a separate Security parameters and Payload IE containing a \"MCData Protected Payload message content\" with the message type of \"MCData Protected Payload message content\" set according to 3GPP TS 33.180 [26].\nNOTE 2:\tIf end-to-end security is required for a one-to-one communication, Security parameters and Payload IE is included. Otherwise, if end-to-end security is not required for a one-to-one communication, Payload IE is included. For group communication, Payload IE is included.\nNOTE 3:\tFormatting of user payloads as part of the Security parameters and Payload IE is specified in clause 15.2.13. The user payloads formatted as specified in the clause 15.2.13 and protected as specified in the clause 8.5.4.1 of 3GPP TS 33.180 [26]. The Protected Payload (Ciphertext) encapsulated in \"MCData Protected Payload message content\". Finally, the entire \"MCData Protected Payload message content\" is encoded in the \"DATA PAYLOAD message content\" as a \"Security parameters and Payload\" IE value.\nNOTE 4:\tAn entire \"DATA PAYLOAD message content\" can be protected for all the user payloads. Otherwise, each user payloads are protected and encapsulated in a separate \"Security parameters and Payload\" IEs of the \"DATA PAYLOAD message content\".\nNOTE 5:\tThe MCData Protected Payload message do not inherits the message type from the DATA PAYLOAD message when each user payloads are protected and encapsulated in a separate \"Security parameters and Payload\" IEs of the \"DATA PAYLOAD message content\". The bits 7, 8 set according to clause 8.5.1 of 3GPP TS 33.180 [26].\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.4.1-1: DATA PAYLOAD message content",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.5\tSDS NOTIFICATION message",
                            "text_content": "This message is sent by the UE to another other UE to share SDS disposition information. For the contents of the message see Table 15.1.5.1-1.\nMessage type:\tSDS NOTIFICATION\nDirection:\tUE to other UEs (can be via network)\nTable 15.1.5.1-1: SDS NOTIFICATION message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.5.1-1: SDS NOTIFICATION message content",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.6\tFD NOTIFICATION message",
                            "text_content": "This message is sent by the UE to another other UE to share FD disposition information. For the contents of the message see Table 15.1.6.1-1.\nMessage type:\tFD NOTIFICATION\nDirection:\tUE to other UEs (via the network)\nTable 15.1.6.1-1: FD NOTIFICATION message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.6.1-1: FD NOTIFICATION message content",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.7\tSDS OFF-NETWORK MESSAGE message",
                            "text_content": "This message is sent by the UE to other UEs to share application or user payload in a SDS message. For contents of the message see Table 15.1.7.1-1.\nMessage type:\tSDS OFF-NETWORK MESSAGE\nDirection:\tUE to other UEs\nTable 15.1.7.1-1: SDS OFF-NETWORK MESSAGE message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.7.1-1: SDS OFF-NETWORK MESSAGE message content",
                                    "table number": 10,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.8\tSDS OFF-NETWORK NOTIFICATION message",
                            "text_content": "This message is sent by the UE to other UEs to share disposition status of a SDS message. For contents of the message see Table 15.1.8.1-1.\nMessage type:\tSDS OFF-NETWORK NOTIFICATION\nDirection:\tUE to other UEs\nTable 15.1.8.1-1: SDS OFF-NETWORK NOTIFICATION message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.8.1-1: SDS OFF-NETWORK NOTIFICATION message content",
                                    "table number": 11,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.9\tFD NETWORK NOTIFICATION message",
                            "text_content": "This message is sent from the network to the UE to provide the UE a file availability indication. For the contents of the message see Table 15.1.9.1-1.\nMessage type:\tFD NETWORK NOTIFICATION\nDirection:\tnetwork to UE\nTable 15.1.9.1-1: FD NETWORK NOTIFICATION message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.9.1-1: FD NETWORK NOTIFICATION message content",
                                    "table number": 12,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.10\tCOMMUNICATION RELEASE message",
                            "text_content": "This message is sent by the MCData server to MCData UE to indicate about intension to release the MCData communication. This message is also sent by the MCData UE to MCData server to request extension for the MCData communication. The MCData server response back about the request using this message. For the contents of the message see Table 15.10.1-1.\nMessage type:\tCOMMUNICATION RELEASE\nDirection:\tServer to UE, UE to server\nTable 15.1.10.1-1: COMMUNICATION RELEASE message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.10.1-1: COMMUNICATION RELEASE message content",
                                    "table number": 13,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.11\tDEFERRED DATA REQUEST message",
                            "text_content": "This message is sent by the MCData UE to MCData server to request the list of group communications which was deferred by the MCData user.\nMessage type:\tDEFERRED DATA REQUEST\nDirection:\tUE to server\nTable 15.1.11.1-1: DEFERRED DATA REQUEST message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.11.1-1: DEFERRED DATA REQUEST message content",
                                    "table number": 14,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.12\tDEFERRED DATA RESPONSE message",
                            "text_content": "This message is sent by the MCData server to the MCData UE as response to the list of deferred group communications request from the MCData UE.\nMessage type:\tDEFERRED DATA RESPONSE\nDirection:\tServer to UE\nTable 15.1.12.1-1: DEFERRED DATA RESPONSE message content\n\nThe number of 'Deferred FD signalling payload' element depends on the 'Number of payloads' information element value (i.e as many entries as that of 'Number of payloads' element value).\nNOTE:\tOnly the 'payload' IE and its value applicability were specified in early versions of the present document from release 13 to release 16. The continued support for Payload element and its value is for backwards compatibility.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.12.1-1: DEFERRED DATA RESPONSE message content",
                                    "table number": 15,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.13\tFD HTTP TERMINATION",
                            "text_content": "This message is sent by the UE to server or server to UE when trying to release FD communication over HTTP. This message provides the signalling content to identify the MESSAGE where FILE URL is shared. For the contents of the message see table 15.1.13.1-1.\nMessage type:\tFD HTTP TERMINATION\nDirection:\tUE to server or server to UE\nTable 15.1.13.1-1: FD HTTP TERMINATION content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.13.1-1: FD HTTP TERMINATION content",
                                    "table number": 16,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.14\tGROUP EMERGENCY ALERT message",
                            "text_content": "This message is sent by the UE to other UEs to indicate an emergency situation. For contents of the message see table 15.1.14.1-1.\nMessage type:\tGROUP EMERGENCY ALERT\nDirection:\tUE to other UEs\nTable 15.1.14.1-1: GROUP EMERGENCY ALERT message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.14.1-1: GROUP EMERGENCY ALERT message content",
                                    "table number": 17,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.15\tGROUP EMERGENCY ALERT ACK message",
                            "text_content": "This message is sent by the UE to other UEs to indicate receipt of emergency alert. For contents of the message see table 15.1.15.1-1.\nMessage type:\tGROUP EMERGENCY ALERT ACK\nDirection:\tUE to other UEs\nTable 15.1.15.1-1: GROUP EMERGENCY ALERT ACK message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.15.1-1: GROUP EMERGENCY ALERT ACK message content",
                                    "table number": 18,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.16\tGROUP EMERGENCY ALERT CANCEL message",
                            "text_content": "This message is sent by the UE to other UEs to indicate end of emergency situation. For contents of the message see table 15.1.16.1-1.\nMessage type:\tGROUP EMERGENCY ALERT CANCEL\nDirection:\tUE to other UEs\nTable 15.1.16.1-1: GROUP EMERGENCY ALERT CANCEL message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.16.1-1: GROUP EMERGENCY ALERT CANCEL message content",
                                    "table number": 19,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.1.17\tGROUP EMERGENCY ALERT CANCEL ACK message",
                            "text_content": "This message is sent by the UE to other UEs to indicate receipt of emergency alert cancel. For contents of the message see table 15.1.17.1-1.\nMessage type:\tGROUP EMERGENCY ALERT CANCEL ACK\nDirection:\tUE to other UEs\nTable 15.1.17.1-1: GROUP EMERGENCY ALERT CANCEL ACK message content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.1.17.1-1: GROUP EMERGENCY ALERT CANCEL ACK message content",
                                    "table number": 20,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "15.2\tGeneral message format and information elements coding",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "15.2.1\tGeneral",
                            "text_content": "The least significant bit of a field is represented by the lowest numbered bit of the highest numbered octet of the field. When the field extends over more than one octet, the order of bit values progressively decreases as the octet number increases.\nFigure 15.2.1-1 shows an example of a field where the most significant bit of the field is marked MSB and the least significant bit of the field is marked LSB.\nFigure 15.2.1-1: Example of bit ordering of a field\nWithin the protocols defined in the present document, the message consists of the following parts:\na)\tmessage type information element; and\nb)\tother information elements, as required.\nThe organization of a message is illustrated in the example shown in Figure 15.2.1-2.\nFigure 15.2.1-2: General message organization example\nUnless specified otherwise in the message descriptions of clause 15.1, a particular information element shall not be present more than once in a given message.\nThe sending entity shall set value of a spare bit to zero. The receiving entity shall ignore value of a spare bit\nThe sending entity shall not set a value of an information element to a reserved value. The receiving entity shall discard message containing an information element set to a reserved value.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Figure 15.2.1-1 shows an example of a field where the most significant bit of the field is marked MSB and the least significant bit of the field is marked LSB.",
                                    "table number": 21,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "The organization of a message is illustrated in the example shown in Figure 15.2.1-2.",
                                    "table number": 22,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.2\tMessage type",
                            "text_content": "The purpose of the Message type information element is to identify the type of the message.\nThe value part of the Message type information element is coded as shown in Table 15.2.2-1.\nThe Message type information element is a type 3 information element with a length of 1 octet.\nTable 15.2.2-1: Message types\n\nBit 7 of the above defined messages is set as follows:\n-\t'0' – if the message is not protected as defined in 3GPP TS 33.180 [26]; or\n-\t'1' – if the message is protected as defined in 3GPP TS 33.180 [26].\nBit 8 of the above defined messages is set as follows:\n-\t'0' – if the message is not authenticated as defined in 3GPP TS 33.180 [26]; or\n-\t'1' – if the message is authenticated as defined in 3GPP TS 33.180 [26].\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.2.2-1: Message types",
                                    "table number": 23,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.3\tSDS disposition request type",
                            "text_content": "The purpose of the SDS disposition request type information element is to identify the type of SDS disposition notification that the sender requires from the receiver.\nThe value part of the SDS disposition request type information element is coded as shown in Table 15.2.3-1.\nThe SDS disposition request type information element is a type 1 information element.\n\nFigure 15.2.3-1: SDS disposition request type\nTable 15.2.3-1: SDS disposition request type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The SDS disposition request type information element is a type 1 information element.",
                                    "table number": 24,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.3-1: SDS disposition request type",
                                    "table number": 25,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.4\tFD disposition request type",
                            "text_content": "The purpose of the FD disposition request type information element is to identify the type of FD disposition notification that the sender requires from the receiver.\nThe value part of the FD disposition request type information element is coded as shown in Table 15.2.4-1.\nThe FD disposition request type information element is a type 1 information element.\n\nFigure 15.2.4-1: FD disposition request type\nTable 15.2.4-1: FD disposition request type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The FD disposition request type information element is a type 1 information element.",
                                    "table number": 26,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.4-1: FD disposition request type",
                                    "table number": 27,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.5\tSDS disposition notification type",
                            "text_content": "The purpose of the SDS disposition notification type information element is to identify the type of SDS disposition notification sent from receiver to the sender.\nThe value part of the SDS disposition notification type information element is coded as shown in Table 15.2.5-1.\nThe SDS disposition notification type information element is a type 3 information element with a length of 1 octet.\nTable 15.2.5-1: SDS disposition notification type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.2.5-1: SDS disposition notification type",
                                    "table number": 28,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.6\tFD disposition notification type",
                            "text_content": "The purpose of the FD disposition notification type information element is to identify the type of FD disposition notification sent from receiver to the sender.\nThe value part of the FD disposition notification type information element is coded as shown in Table 15.2.6-1.\nThe FD disposition notification type information element is a type 3 information element with a length of 1 octet.\nTable 15.2.6-1: FD disposition notification type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.2.6-1: FD disposition notification type",
                                    "table number": 29,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.7\tApplication ID",
                            "text_content": "The purpose of the Application ID information element is to uniquely identify the application for which the payload is intended.\nThe Application ID information element is coded as shown in figure 15.2.7-1 and table 15.2.7-1\nThe Application ID information element is a type 3 information element with a length of 2 octets.\nFigure 15.2.7-1: Application ID value\nTable 15.2.7-1: Application ID value\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Application ID information element is a type 3 information element with a length of 2 octets.",
                                    "table number": 30,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.7-1: Application ID value",
                                    "table number": 31,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.8\tDate and time",
                            "text_content": "The Date and time information element is used to indicate the UTC time when a message or file was sent.\nThe Date and time information element is coded as shown in Figure 15.2.8-1 and Table 15.2.8-1.\nThe Date and time information element is a type 3 information element with a length of 5 octets.\nFigure 15.2.8-1: Date and time value\nTable 15.2.8-1: Date and time value\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Date and time information element is a type 3 information element with a length of 5 octets.",
                                    "table number": 32,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.8-1: Date and time value",
                                    "table number": 33,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.9\tConversation ID",
                            "text_content": "The Conversation ID information element uniquely identifies the conversation.\nThe Conversation ID information element is coded as shown in Figure 15.2.9-1 and Table 15.2.9-1.\nThe Conversation ID information element is a type 3 information element with a length of 16 octets.\nFigure 15.2.9-1: Conversation ID value\nTable 15.2.9-1: Conversation ID value\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Conversation ID information element is a type 3 information element with a length of 16 octets.",
                                    "table number": 34,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.9-1: Conversation ID value",
                                    "table number": 35,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.10\tMessage ID",
                            "text_content": "The Message ID information element uniquely identifies a message within a conversation.\nThe Message ID information element is coded as shown in Figure 15.2.10-1 and Table 15.2.10-1.\nThe Message ID information element is a type 3 information element with a length of 16 octets.\nFigure 15.2.10-1: Message ID value\nTable 15.2.10-1: Message ID value\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Message ID information element is a type 3 information element with a length of 16 octets.",
                                    "table number": 36,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.10-1: Message ID value",
                                    "table number": 37,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.11\tInReplyTo message ID",
                            "text_content": "The InReplyTo message ID information element is used to associate a message within a conversation that is a reply to an existing message in a conversation.\nThe InReplyTo message ID information element is coded as shown in Figure 15.2.11-1 and Table 15.2.11-1.\nThe InReplyTo message ID information element is a type 3 information element with a length of 17 octets.\nFigure 15.2.11-1: InReplyTo message ID value\nTable 15.2.11-1: InReplyTo Message ID value\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The InReplyTo message ID information element is a type 3 information element with a length of 17 octets.",
                                    "table number": 38,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.11-1: InReplyTo Message ID value",
                                    "table number": 39,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.12\tNumber of payloads",
                            "text_content": "The Number of payloads information element identifies the number of payloads contained in the message.\nThe Number of payloads information element is coded as shown in Figure 15.2.12-1, Table 15.2.12-1.\nThe Number of payloads information element is a type 3 information element with a length of 1 octet.\nFigure 15.2.12-1: Number of payloads information element\nTable 15.2.12-1: Number of payloads information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Number of payloads information element is a type 3 information element with a length of 1 octet.",
                                    "table number": 40,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.12-1: Number of payloads information element",
                                    "table number": 41,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.13\tPayload",
                            "text_content": "The Payload information element contains the payload intended for the recipient user or application;\nThe Payload information element is coded as shown in Figure 15.2.13-1, Table 15.2.13-1, Table 15.2.13-2 and Table 15.2.13-3.\nThe Payload information element is a type 6 information element.\nFigure 15.2.13-1: Payload information element\nTable 15.2.13-1: Payload contents\n\nTable 15.2.13-2: Payload content type\n\nTable 15.2.13-3: Payload data\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Payload information element is a type 6 information element.",
                                    "table number": 42,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.13-1: Payload contents",
                                    "table number": 43,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.13-2: Payload content type",
                                    "table number": 44,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.13-3: Payload data",
                                    "table number": 45,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.14\tMCData group ID",
                            "text_content": "The MCData group ID information element is used to indicate the destination MCData group identifier;\nThe MCData group ID information element is coded as shown in Figure 15.2.14-1 and Table 15.2.14-1.\nThe MCData group ID information element is a type 6 information element.\n\nFigure 15.2.14-1: MCData group ID information element\nTable 15.2.14-1: MCData group ID information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 46,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.14-1: MCData group ID information element",
                                    "table number": 47,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.15\tMCData user ID",
                            "text_content": "The MCData user ID information element is used to indicate an MCData user ID.\nThe MCData user ID information element is coded as shown in Figure 15.2.15-1 and Table 15.2.15-1.\nThe MCData user ID information element is a type 6 information element.\nFigure 15.2.15-1: MCData user ID information element\nTable 15.2.15-1: MCData user ID information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The MCData user ID information element is a type 6 information element.",
                                    "table number": 48,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.15-1: MCData user ID information element",
                                    "table number": 49,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.16\tMandatory download",
                            "text_content": "The purpose of the Mandatory download information element is for the originating client to inform the terminating client that a file must be downloaded immediately.\nThe value part of the Mandatory download information element is coded as shown in Figure 15.2.16-1 and Table 15.2.16-1.\nThe Mandatory download information element is a type 1 information element.\n\nFigure 15.2.16-1: Mandatory download\nTable 15.2.16-1: Mandatory download\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Mandatory download information element is a type 1 information element.",
                                    "table number": 50,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.16-1: Mandatory download",
                                    "table number": 51,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.17\tMetadata",
                            "text_content": "The Metadata information element is data that is used to describe a file.\nThe Metadata information element is coded as shown in Figure 15.2.17-1 and Table 15.2.17-1.\nThe Metadata information element is a type 6 information element.\n\nFigure 15.2.17-1: Metadata information element\nTable 15.2.17-1: Metadata information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 52,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.17-1: Metadata information element",
                                    "table number": 53,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.18\tNotification type",
                            "text_content": "The purpose of the Notification type information element is to identify the type of notification sent from receiver to the sender.\nThe value part of the Notification type information element is coded as shown in Table 15.2.18-1.\nThe notification type information element is a type 3 information element with a length of 1 octet.\nTable 15.2.18-1: Notification type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.2.18-1: Notification type",
                                    "table number": 54,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.19\tData query type",
                            "text_content": "The purpose of the data query type information element is to identify the type of data information that the sender requires from the receiver.\nThe value part of the data query request type information element is coded as shown in Figure 15.2.19-1 and Table 15.2.19-1.\nThe data query request type information element is a type 1 information element with a length of 1 octet\n\nFigure 15.2.19-1: Data query type\nTable 15.2.19-1: Data query type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The data query request type information element is a type 1 information element with a length of 1 octet",
                                    "table number": 55,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.19-1: Data query type",
                                    "table number": 56,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.20\tComm release Information type",
                            "text_content": "The purpose of the comm release information type information element is to identify the type of communication release information that the sender wants to inform to the receiver.\nThe value part of the comm release information type information element is coded as shown in Table 15.2.20-1.\nThe comm release information type information element is a type 3 information element with a length of 1 octet\nTable 15.2.20-1: Comm release Information type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.2.20-1: Comm release Information type",
                                    "table number": 57,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.21\tExtension response type",
                            "text_content": "The purpose of the extension request type information element is to inform MCData server's response towards MCData client's request for extension of the MCData communication. This information element is used only when comm release information type IE takes \"EXTENSION RESPONSE\" value. The receiver can ignore Extension response type information element value if comm release information type IE takes any other value.\nThe value part of the Extension response type information element is coded as shown in Figure 15.2.21.1 and Table 15.2.21-1.\nThe Extension response type information element is a type 1 information element.\n\nFigure 15.2.21-1: Extension response type\nTable 15.2.21-1: Extension response type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Extension response type information element is a type 1 information element.",
                                    "table number": 58,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.21-1: Extension response type",
                                    "table number": 59,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.22\tTermination Information type",
                            "text_content": "The purpose of the Termination information type is to identify the type of termination request that the sender wants to inform to the receiver.\nThe value part of the Termination information type element is coded as shown in table 15.2.22-1.\nThe Termination information type is a type 3 information element with a length of 1 octet.\nTable 15.2.22-1: Termination Information type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 15.2.22-1: Termination Information type",
                                    "table number": 60,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.23\tRelease Response Type",
                            "text_content": "The purpose of the Release Response Type information element is to inform MCData server's response towards MCData client's request for termination of the MCData communication. This information element is used only when Termination information type IE takes \"TERMINATION RESPONSE\" value. The receiver can ignore Release response type information element value if Termination information type IE takes any other value\nThe value part of the Release response type information element is coded as shown in figure 15.2.23-1 and table 15.2.23-1.\nThe Release Response Type information element is a type 1 information element.\nFigure 15.2.23-1: Release Response Type\nTable 15.2.23-1: Release Response Type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Release Response Type information element is a type 1 information element.",
                                    "table number": 61,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.23-1: Release Response Type",
                                    "table number": 62,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.24\tExtended application ID",
                            "text_content": "The purpose of the Extended application ID information element is to uniquely identify the application for which the payload is intended when the format of the identifier used is not the format available in the Application ID.\nThe Extended application ID information element is coded as shown in figure 15.2.24-1, table 15.2.24-1, table 15.2.24-2 and table 15.2.24-3.\nThe Extended application ID information element is a type 6 information element.\nFigure 15.2.24-1: Extended application ID value\nTable 15.2.24-1: Extended application ID contents\n\nTable 15.2.24-2: Extended application ID content type\n\nTable 15.2.24-3: Extended application ID data\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Extended application ID information element is a type 6 information element.",
                                    "table number": 63,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.24-1: Extended application ID contents",
                                    "table number": 64,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.24-2: Extended application ID content type",
                                    "table number": 65,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.24-3: Extended application ID data",
                                    "table number": 66,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.25\tUser location",
                            "text_content": "The User location information element is used to indicate the current location of the MCData client;\nThe User location information element is coded as shown in figure 15.2.25-1 and table 15.2.25-1.\nThe User location information element is a type 6 information element.\nFigure 15.2.25-1: User location information element\nTable 15.2.25-1: User location information element\n\nThe User location information element contains the LocationInfo structure defined in clause 7.4 of 3GPP TS 29.199-09 [65].\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The User location information element is a type 6 information element.",
                                    "table number": 67,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.25-1: User location information element",
                                    "table number": 68,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.26\tOrganization name",
                            "text_content": "The Organization name information element is used to indicate the name of the organization to which the user belongs.\nThe Organization name information element is coded as shown in figure 15.2.26-1 and table 15.2.26-1.\nThe Organization name information element is a type 6 information element.\nFigure 15.2.26-1: Organization name information element\nTable 15.2.26-1: Organization name information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Organization name information element is a type 6 information element.",
                                    "table number": 69,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.26-1: Organization name information element",
                                    "table number": 70,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.27\tDeferred FD signalling payload",
                            "text_content": "The Deferred FD signaling payload information element contains the signaling data payload of the FD request of the MCData client;\nThe Deferred FD signalling payload information element is coded as shown in figure 15.2.27-1 and table 15.2.27-1.\nThe Deferred FD signalling payload information element is a type 6 information element.\nFigure 15.2.27-1: Deferred FD signalling payload information element\nTable 15.2.27-1: Deferred FD signalling payload contents\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The Deferred FD signalling payload information element is a type 6 information element.",
                                    "table number": 71,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.27-1: Deferred FD signalling payload contents",
                                    "table number": 72,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "15.2.28\tApplication metadata container",
                            "text_content": "The Application metadata container information element is used to carry metadata specific to the application.\nThe Application metadata container information element is coded as shown in figure 15.2.28-1 and table 15.2.28-1.\nThe Application metadata container contents are coded per the ABNF syntax defined in table 15.2.28-2.\nThe Application metadata container information element is a type 6 information element.\nThe Application metadata container information element provides a means for the sender of the SDS or file to attach application-specific information to the SDS or file.\nNOTE:\tFor example, a police officer could send a data file with attached Application metadata container content: {value-end-delimiter='#'}agency-ID=county-police-dept#incident-ID=N5Q432X1#injuries=3#\nFigure 15.2.28-1: Application metadata container information element\nTable 15.2.28-1: Application metadata container information element\n\nTable 15.2.28-2: Syntax of Application metadata content\nAppl-metadata-content   = \"{\" *delimiter-definition \"}\" 1*organization-attribute\ndelimiter-definition    = *1tag-end-delimiter *1value-end-delimiter *1escape-character\ntag-end-delimiter       = \"tag-delimiter\" 1*VCHAR-restricted\nvalue-end-delimiter     = \"value-delimiter\" 1*VCHAR-restricted\nescape-character        = \"escape\" 1*VCHAR-restricted\norganization-attribute  = tag tag-end-delimiter attribute-value value-end-delimiter\ntag                     = 1*VCHAR-restricted 0*(1*WSP 1*VCHAR-restricted)\nattribute-value         = 1*VCHAR-restricted 0*(1*WSP 1*VCHAR-restricted)\nVCHAR                   = %x21-7E\n; visible (printing) 7-bit US-ASCII characters per RFC5234 [75]\nVCHAR-restricted        = %x21-7A / %x7C / %x7E  ;all visible characters except space, \"{\", and \"}\"\nWSP                     = %x20  ; space character\n\nIf a delimiter is not defined, the default value shall be used.\nThe default tag-end-delimiter shall be '='.\nThe default value-end-delimiter shall be ';'.\nThe default escape-character shall be '\\'.\nThe values chosen for the tag-end-delimiter, the value-end-delimiter, and the escape-character shall all be unique.\nAn escape-character plus the next following character shall be treated as the value of the following character.\nThe following character shall not be treated as a tag-value-delimiter, a value-end-delimiter or an escape-character.\nEditor's Note:\tThe definitions of tag and attribute-value should be enhanced to show the possible inclusion of an escape-character.\nThe tag can contain any visible (printing) 7-bit US-ASCII character except the tag-value-delimiter unless the character defined as the tag-value-delimiter is escaped using the escape-character.\nThe attribute-value can contain any visible (printing) 7-bit US-ASCII except the value-end-delimiter and the escape-character unless the character defined as the value-end-delimiter is escaped using the escape-character or the character defined as the escape-character is escaped using the escape-character. For example, if the escape-character is '\\', then the '\\' character can be included in the attribute-value by using '\\\\'.\nExamples:\n{}officer-name=John Smith;incident=123abc;\n{tag-delimiter#}name#John Smith;incident#123abc;\n{tag-delimitere}nam\\eeJohn Smith;incid\\ente123abcd\\ef;\n{value-delimiter%}name=John Smith%incident=123abc%\n{tag-delimiter:value-delimiter|}FirstName:John|LastName:Smith|\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "NOTE:\tFor example, a police officer could send a data file with attached Application metadata container content: {value-end-delimiter='#'}agency-ID=county-police-dept#incident-ID=N5Q432X1#injuries=3#",
                                    "table number": 73,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 15.2.28-1: Application metadata container information element",
                                    "table number": 74,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "title": "16\tEmergency Alert",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "16.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes the emergency alert procedures for on-network.\nFor on-network emergency alert, the procedures for originating and terminating MCData clients, participating MCData function and controlling MCData function are specified in clause 16.2.\nFor off-network emergency alert, the procedures for each functional entity is specified in clause 16.3.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "16.2\tOn-network emergency alert",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "16.2.1\tClient procedures",
                            "text_content": "Upon receiving a request from the MCData user to send an MCData emergency alert, the MCData client shall determine whether or not it is authorised to originate an emergency alert, by following the procedures in clause 6.2.8.1.6.\nIf the MCData emergency alert origination request is considered an unauthorised request for an MCData emergency alert, the MCData client shall indicate to the MCData user that an MCData emergency alert is not allowed on this group and shall terminate this procedure.\nIf the request was authorised, but the MCData user has not indicated the identity of the MCData group to receive the emergency alert, the MCData client shall use, in descending order of preference, one of the following: the value of the <uri-entry> element of the <entry> element of the <GroupEmergencyAlert> element of the <Common> element in the MCData user profile, if present; if not, the identity of the MCData group to which the most recent communication or affiliation request was made by the MCData client since last acquiring the MCData service. If an MCData group identity cannot be determined, the MCData client shall indicate the fact to the MCData user and shall terminate this procedure.\nThe MCData client shall generate a SIP MESSAGE as an out-of-dialog request, in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6], and:\n1)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP MESSAGE request;\n2)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n3)\tmay include a P-Preferred-Identity header field in the SIP MESSAGE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n4)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element (see clause D.1) with:\na)\tthe <mcdata-request-uri> element set to the MCData group identity;\nb)\tthe <alert-ind> element set to a value of \"true\";\nc)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\nd)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP MESSAGE request, the <anyExt> element of the <functional-alias-URI> element set to the URI of the used functional alias; and\ne)\tif the MCData user has requested an application priority, the <anyExt> element with the <user-requested-priority> element set to the user provided value;\n5)\tshall include an application/vnd.3gpp.mcdata-location-info+xml MIME body with a <Report> element included in the <location-info> root element (see clause D.4);\n6)\tshall include in the <Report> element the specific location information configured for the MCData emergency alert location trigger;\n7)\tshall set the MCData emergency state if not already set;\n8)\tshall set the MCData emergency alert state to \"MDEA 2: emergency-alert-confirm-pending\";\n9)\tshall set the Request-URI to the public service identity identifying the participating MCData function serving the group identity; and\n10)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP 24.229 [5];\nOn receiving a SIP 2xx response to the SIP MESSAGE request, the MCData client shall set the MCData emergency alert state to \"MDEA 3: emergency-alert-initiated\" and shall give the MCData user an indication of success.\nOn receiving a SIP 4xx response a SIP 5xx response or a SIP 6xx response to the SIP MESSAGE request, the MCData client shall set the MCData emergency alert state to \"MDEA 1: no-alert\" and shall indicate the failure to the MCData user.\nNOTE:\tIf no response is received after an implementation dependent amount of time or if there is an indication of communication failure, the MCData client can inform the user, and can clear the MCData emergency alert state or can retry sending the emergency alert to the MCData participating server. The MCData emergency state is left unchanged, as the MCData user presumably is in the best position to determine whether or not there still is an emergency situation and can use manual clearing, as necessary.\nUpon receiving a request from the MCData user to send an MCData emergency alert cancellation, the MCData client shall determine whether or not it is authorised to cancel an emergency alert, as follows:\n1)\tif the MCData emergency cancellation request is for an MCData emergency alert originated by this MCData user, then the request shall be considered authorised if <allow-cancel-emergency-alert> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID and profile index associated with MCData user (see 3GPP TS 24.484 [12]) is present and is set to a value of \"true\"; or\n2)\tif the MCData emergency cancellation request is for an MCData emergency alert originated by a different MCData user, then the request shall be considered authorised if <allow-cancel-emergency-alert-any-user> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID and profile index associated with MCData user (see 3GPP TS 24.484 [12]) is present and is set to a value of \"true\".\nIf the MCData emergency cancellation request is not considered authorised, the MCData client shall indicate this fact to the requesting MCData user and shall terminate this procedure.\nIf the authorised MCData emergency cancellation request is for an MCData emergency alert originated by this MCData user and if there are more than one outstanding emergency alerts from this MCData user and the MCData user has not indicated which one to cancel, the MCData client shall terminate this procedure after giving an indication of the condition to the MCData user.\nThe MCData client shall generate a SIP MESSAGE out-of dialog request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] and:\n1)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7];\n2)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n3)\tmay include a P-Preferred-Identity header field containing a public user identity as specified in 3GPP TS 24.229 [5];\n4)\tif the MCData emergency alert was originated by this MCData user, shall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element (see clause D.1) with:\na)\tthe <mcdata-request-uri> element set to the MCData group identity;\nb)\tthe <alert-ind> element set to a value of \"false\";\nc)\tthe <mcdata-client-id> element set to the MCData client ID of this MCData client; amd\nd)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP MESSAGE request, the <anyExt> element of the <functional-alias-URI> element set to the URI of the used functional alias;\n5)\tif the MCData emergency alert was originated by a different MCData user, shall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element (see clause D.1) with:\na)\tthe <mcdata-request-uri> element set to the MCData group identity;\nb)\tthe <alert-ind> element set to a value of \"false\";\nc)\tthe <originated-by> element set to the MCData ID of the MCData user who originated the MCData emergency alert; and\nd)\tif the MCData client is aware of active functional aliases, and an active functional alias is to be included in the SIP MESSAGE request, the <anyExt> element of the <functional-alias-URI> set to the URI of the used functional alias;\n5A)\tif the MCData user has additionally requested the cancellation of the in-progress emergency state of the MCData group and this is an authorised request for an in-progress emergency group state cancellation as determined by clause 6.2.8.1.7, shall include an <emergency-ind> element set to a value of \"false\" in the <mcdatainfo> element containing the <mcdata-Params> element;\n6)\tshall set the Request-URI to the public service identity identifying the participating MCData function serving the group identity;\n7)\tif the generated SIP MESSAGE request does not contain an <originated-by> element in the application/vnd.3gpp.MCData-info+xml MIME body, shall set the MCData emergency alert state to \"MDEA 4: emergency-alert-cancel-pending\"; and\n8)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5].\nOn receipt of a SIP MESSAGE request containing an application/vnd.3gpp.mcdata-info+xml MIME body with an <alert-ind-rcvd> element set to \"true\" and an <mcdata-client-id> matching the MCData client ID included in the sent SIP MESSAGE request and if the sent SIP MESSAGE request did not contain an <originated-by> element in its application/vnd.3gpp.mcdata-info+xml MIME body, the MCData client shall:\n1)\tif the <alert-ind> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the received SIP MESSAGE request is set to a value of \"false\":\na)\tset the MCData emergency alert state to \"MDEA 1: no-alert\"; and\nb)\tclear the MCData emergency state if not already cleared; and\n2)\tif the <alert-ind> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the received SIP MESSAGE request is set to a value of \"true\" and if the MCData emergency alert state is set to \"MDEA 4: emergency-alert-cancel-pending\":\na)\tset the MCData emergency alert state to \"MDEA 3: emergency-alert-initiated\".\nNOTE 1:\tIt would appear to be an unusual situation for the initiator of an MCData emergency alert to not be able to clear their own alert. Nevertheless, an MCData user can be configured to be authorised to initiate MCData emergency alerts but not have the authority to clear them. Hence, the case is covered here.\n3)\tif an <emergency-ind> element is present in the application/vnd.3gpp.mcdata-info+xml MIME body of received SIP MESSAGE request is set to a value of \"false\" and the sent SIP MESSAGE request contains an <emergency-ind> element set to a value of \"false\":\na)\tshall set the MCData emergency group communication state of the group to \"MDEGC 1: emergency-gc-capable\"; and\nb)\tshall set the MCData emergency group state of the group to \"MDEG 1: no-emergency\".\nNOTE 2:\tThe case where an <emergency-ind> element is set to true is possible but not handled specifically above as it results in no state changes.\nOn receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to the sent SIP MESSAGE emergency alert cancellation request, if the sent SIP MESSAGE request did not contain an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body and the MCData emergency alert state is set to \"MDEA 4: emergency-alert-cancel-pending\":\n1)\tif the received SIP 4xx response, SIP 5xx response or SIP 6xx response does not contain an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element containing the  <alert-ind> element OR if it contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <alert-ind> element set to a value of \"true\" (see clause D.1), the MCData client shall set the MCData emergency alert state to \"MDEA 3: emergency-alert-initiated\".\nUpon receipt of a \"SIP MESSAGE request for emergency notification\", the MCData client:\n1)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <alert-ind> element set to a value of \"true\", may display to the MCData user the functional alias of the originating MCData user, if provided, and should display to the MCData user an indication of the MCData emergency alert and associated information, including:\na)\tthe MCData group identity contained in <mcdata-calling-group-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tthe originator of the MCData emergency alert contained in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\nc)\tthe mission critical organization of the MCData emergency alert originator contained in the <mc-org> element of the application/vnd.3gpp.mcdata-info+xml MIME body;\nNOTE 1:\tThis is the case of the MCData client receiving the notification of another MCData user's emergency alert.\n2)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <alert-ind> element set to a value of \"false\":\na)\tshould display to the MCData user an indication of the MCData emergency alert cancellation and associated information, including:\ni)\tthe MCData group identity contained in the <mcdata-calling-group-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tthe originator of the MCData emergency alert contained in:\nA)\tif present, the <originated-by> element of the application/vnd.3gpp.mcdata-info+xml MIME body; or\nB)\tthe <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tif the MCData ID contained in the <originated-by> element is the MCData ID of the receiving MCData user, shall set the MCData emergency alert state to \"MDEA 1: no-alert\"; and\nc)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <emergency-ind> element is set to a value of \"false\":\ni)\tshall set the MCData emergency group state to \"MDEG 1: no-emergency\"; and\nii)\tshall set the MCData emergency group communication state to \"MDEGC 1: emergency-gc-capable\";\nNOTE 2:\tThis is the case of the MCData client receiving the notification of the cancellation by a third party of an MCData emergency alert. This can be the MCData emergency alert of another MCData user or the MCData emergency alert of the recipient, as determined by the contents of the <originated-by> element. Optionally, notification of the cancellation of the in-progress emergency state of the MCData group can be included.\n3)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <emergency-ind> element set to a value of \"true\":\na)\tshould display to the MCData user an indication of the additional emergency MCData user participating in the MCData emergency group communication including the following, if not already displayed as part of step 1):\ni)\tthe MCData group identity contained in the <mcdata-calling-group-id> element application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tthe <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\nb)\tshall set the MCData emergency group state to \"MDEG 2: in-progress\" if not already set to that value;\nNOTE 3:\tThis is the case of the MCData client receiving notification of an additional MCData user in an MCData emergency state (i.e., not the MCData user that originally triggered the in-progress emergency state of the group) joining the in-progress emergency group communication. An emergency alert indication, if included, is handled in step 1).\n4)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <emergency-ind> element set to a value of \"false\":\na)\tshould display to the MCData user an indication of the cancellation of the in-progress emergency state of the MCData group communication including the following if not already displayed as part of step 2):\ni)\tthe MCData group identity contained in the <mcdata-calling-group-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tthe <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tshall set the MCData emergency group state to \"MDEG 1: no-emergency\"; and\nc)\tshall set the MCData emergency group communication state to \"MDEGC 1: emergency-gc-capable\";\nNOTE 4:\tThis is the case of the MCData client receiving the notification of the cancellation of the in-progress emergency state of the MCData group. In this case, the receiving MCData client is affiliated with the MCData group but not participating in the session. An emergency alert cancellation, if included, is handled in step 2).\n4A)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\":\na)\tshould display to the MCData user an indication of the MCData user participating in the MCData imminent peril group communication including the following if not already displayed as part of step 1):\ni)\tthe MCData group identity contained in the <mcdata-calling-group-id> element application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tthe <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\nb)\tshall set the MCData imminent peril group state to \"MDIG 2: in-progress\" if not already set to that value;\nNOTE 5:\tThis is the case of the MCData client receiving notification of an additional MCData user initiating an imminent peril group communication when there is already an in-progress imminent peril state in effect on the group.\n4B)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <imminentperil-ind> element set to a value of \"false\":\na)\tshould display to the MCData user an indication of the cancellation of the in-progress imminent peril state of the MCData group including the following if not already displayed as part of step 2):\ni)\tthe MCData group identity contained in the <mcdata-calling-group-id> element application/vnd.3gpp.mcdata-info+xml MIME body; and\nii)\tthe <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tshall set the MCData imminent peril group state to \"MDIG 1: no-imminent-peril\"; and\nc)\tshall set the MCData imminent peril group communication state to \"MDIGC 1: imminent-peril-gc-capable\";\nNOTE 6:\tThis is the case of the MCData client receiving notification of the cancellation of the in-progress imminent peril state of the group.\n5)\tshall generate a SIP 200 (OK) response according to rules and procedures of TS 24.229 [5]; and\n6)\tshall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of TS 24.229 [5].\nUpon receipt of a \"SIP MESSAGE request for notification of entry into or exit from a group geographic area\", the MCData client:\n1)\tshall send a SIP 200 (OK) to the participating MCData function that sent the SIP MESSAGE request; and\n2)\tif the <group-geo-area-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body is:\na)\tset to \"true\":\ni)\tmay display to the MCData user an indication that a group geographic area has been entered; and\nii)\tshall execute the procedure in clause 8.2.2 to affiliate to the group indicated by the participating MCData function; and\nb)\tset to \"false\":\ni)\tmay display to the MCData user an indication that a group geographic area has been exited; and\nii)\tshall execute the procedure in clause 8.2.2 to de-affiliate from the group indicated by the participating MCData function.\nUpon receipt of a \"SIP MESSAGE request for notification of entry into or exit from an emergency alert area\", the MCData client:\n1)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <emergency-alert-area-ind> element of the value:\na)\tset to \"true\":\ni)\tmay display to the MCData user an indication that MCData client has entered a pre-defined emergency alert area; and\nii)\tif the MCData user is not in emergency state, shall initiate the emergency alert origination procedure as specified in clause 12.1.1.1; or\nb)\tset to \"false\":\ni)\tmay display to the MCData user an indication that MCData client has exited a pre-defined emergency alert area.\nNOTE:\tIn this case, the MCData emergency state remains set, as the MCData user is in the best position to determine whether or not they are in a life-threatening condition. The MCData user can clear the MCData emergency state manually, if needed.\n2)\tshall generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5]; and\n3)\tshall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16.2.2\tParticipating MCData function procedures",
                            "text_content": "Editor's note: In the current release, support for emergency groups and emergency group communications may be absent, partial or limited, namely only provided to the extent of facilitating emergency alert functionality.\nUpon receipt of a \"SIP MESSAGE request for emergency notification for originating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field in the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\nNOTE 1:\tif the SIP MESSAGE request contains an emergency indication set to a value of \"true\" or an alert indication set to a value of \"true\", the participating MCData function can, according to local policy, choose to accept the request.\n2)\tshall determine the MCData ID of the calling user from the public user identity in the P-Asserted-Identity header field of the SIP MESSAGE request, and shall authorise the calling user;\nNOTE 2:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the MCData user is not affiliated with the MCData group as determined by clause 8.3.2.11, shall perform the actions specified in clause 8.3.2.12 for implicit affiliation;\n4)\tif the actions for implicit affiliation specified in step 3) above were performed but not successful in affiliating the MCData user due to the MCData user already having N2 simultaneous affiliations, shall reject the \"SIP MESSAGE request for emergency notification for originating participating MCData function\" with a SIP 486 (Busy Here) response with the warning text set to \"102 too many simultaneous affiliations\" in a Warning header field as specified in clause 4.9 and skip the rest of the steps;\nNOTE 3:\tN2 is the total number of MCData groups that an MCData user can be affiliated to simultaneously as specified in 3GPP TS 23.282 [2].\nNOTE 4:\tAs this is a request for MCData emergency services, the participating MCData function can choose to accept the request.\n5)\tshall determine the public service identity of the controlling MCData function associated with the group identity in the received SIP MESSAGE request;\n6)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n7)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the controlling MCData function associated with the group identified by the <mcdata-request-uri> element contained in the <mcdatainfo> element containing the <mcdata-Params> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the incoming SIP MESSAGE request;\nNOTE 5:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 6:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 7:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 8:\tHow the participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 9:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n8)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body in the received SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body as specified in clause D.1 included in the outgoing SIP MESSAGE request;\n9)\tshall set the <mcdata-calling-user-id> element of the <mcdatainfo> element containing the <mcdata-Params> element to the MCData ID determined in step 2) above;\n10)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-location-info+xml MIME body as specified in clause D.4, shall copy the contents of the application/vnd.3gpp.mcdata-location-info+xml MIME body in the received SIP MESSAGE request into an application/vnd.3gpp.mcdata-location-info+xml MIME body included in the outgoing SIP MESSAGE request;\n11) shall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function;\n12)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body that contains a <functional-alias-URI> element, shall check if the status of the functional alias is activated for the MCData ID. If the functional alias status is activated, then the participating MCData function shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request to the received value, otherwise shall not include a <functional-alias-URI> element; and\n13)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 2xx response in response to the SIP MESSAGE request sent in step 12):\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5] with the follow clarifications:\na)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function;\n2)\tif the procedures of clause 8.3.2.12 for implicit affiliation were performed in the present clause, shall complete the implicit affiliation by performing the procedures of clause 8.3.2.13; and\n3)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the sent SIP MESSAGE request and if the implicit affiliation procedures of clause 8.3.2.12 were invoked in the present clause, the participating MCData function shall perform the procedures of clause 8.3.2.14.\nEditor's note: In the current release, support for emergency groups and emergency group communications (in particular the use of the <emergency-ind> element) may be absent, partial or limited, namely only provided to the extent of facilitating emergency alert functionality.\nIn the procedures in this clause:\n1)\temergency indication in an incoming SIP MESSAGE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\n2)\talert indication in an incoming SIP MESSAGE request refers to the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body.\nUpon receipt of a \"SIP MESSAGE requests for emergency notification for terminating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field in the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\nNOTE 1:\tif the SIP MESSAGE request contains an emergency indication set to a value of \"true\" or an alert indication set to a value of \"true\", the participating MCData function can, by means beyond the scope of this specification, choose to accept the request.\n2)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request to retrieve the binding between the MCData ID and public user identity;\n3)\tif the binding between the MCData ID and public user identity does not exist, then the participating MCData function shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response and skip the rest of the steps. Otherwise, continue with the rest of the steps;\n4)\tshall generate an outgoing SIP MESSAGE request as specified in clause 6.3.2.1; and\n5)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of SIP 2xx responses to the outgoing SIP MESSAGE requests, the participating MCData function shall follow the procedures specified in TS 24.229 [5].\nUpon receipt of a SIP MESSAGE request routed to the terminating participating MCData function with the Request-URI set to the public service identity of the terminating participating MCData function and the SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with an <alert-ind-rcvd> element present, the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field in the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request to retrieve the binding between the MCData ID and public user identity;\n3)\tif the binding between the MCData ID and public user identity does not exist, then the participating MCData function shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response and skip the rest of the steps. Otherwise, continue with the rest of the steps;\n4)\tshall generate an outgoing SIP MESSAGE request in accordance with TS 24.229 [5] and IETF RFC 3428 [6] and:\na)\tshall include in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\nb)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public user identity associated to the MCData ID of the MCData user that was in the Request-URI of the incoming SIP MESSAGE request;\nc)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request; and\nd)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function; and\n5)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of SIP 2xx responses to the outgoing SIP MESSAGE requests, the participating MCData function shall follow the procedures specified in 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16.2.3\tControlling MCData function procedures",
                            "text_content": "Upon receipt of a \"SIP MESSAGE request for emergency notification for controlling MCData function\", the controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field in the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps. Otherwise, continue with the rest of the steps;\nNOTE:\tIf the SIP MESSAGE request contains an alert indication set to a value of \"true\", the controlling MCData function can, according to local policy, choose to accept the request.\n2)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if an Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\", \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" or \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\";\n3)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <alert-ind> element set to a value of \"false\", shall perform the procedures specified in clause 16.2.3.2 and skip the rest of the steps; and\n4)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <alert-ind> element set to a value of \"true\":\na)\tif the received SIP MESSAGE request is an unauthorised request for an MCData emergency alert as specified in clause 6.3.7.2.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request as specified in 3GPP TS 24.229 [5] with the following clarifications:\ni)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcdata-info+xml MIME body as specified in clause D.1 with the <mcdatainfo> element containing the <mcdata-Params> element with the <alert-ind> element set to a value of \"false\"; and\nii)\tshall send the SIP 403 (Forbidden) response as specified in TS 24.229 [5] and skip the rest of the steps; and\nb)\tif the received SIP MESSAGE request is an authorised request for an MCData emergency alert as specified in clause 6.3.7.2.1:\ni)\tif the sending MCData user identified by the <mcdata-calling-user-id> element included in the application/vnd.3gpp.mcdata-info+xml MIME body is not affiliated with the MCData group identified by the <mcdata-request-uri> element of the MIME body as determined by the procedures of clause 6.3.5:\nI)\tshall check if the MCData user is eligible to be implicitly affiliated with the MCData group as determined by clause 8.3.3.6;\nII)\tif the MCData user is determined not to be eligible to be implicitly affiliated to the MCData group shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in clause 4.9 and skip the rest of the steps below; or\nIII)\tif the procedures of clause 8.3.3.6 determined the MCData user to be eligible to be implicitly affiliated to the MCData group, shall perform the implicit affiliation as specified in clause 8.3.3.7;\nii)\tfor each of the other affiliated members of the group:\nA)\tgenerate an outgoing SIP MESSAGE request notification of the MCData user's emergency alert indication as specified in clause 6.3.7.1.2 with the clarifications of clause 6.3.7.1.3;\nB)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <mcdata-calling-user-id> element set to the value of the <mcdata-calling-user-id> element in the received SIP MESSAGE request;\nC)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body that contains a <functional-alias-URI> element shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request to the received value, otherwise shall not include a <functional-alias-URI> element; and\nD)\tsend the SIP MESSAGE request according to according to rules and procedures of 3GPP TS 24.229 [5];\niii)\tshall generate a SIP 200 (OK) response to the received SIP MESSAGE request as specified in 3GPP TS 24.229 [5] with the following clarifications:\nA)\tshall cache the information that the MCData user has initiated an MCData emergency alert;\niv)\tshall send the SIP 200 (OK) response to the received SIP MESSAGE according to rules and procedures of 3GPP TS 24.229 [5];\nv)\tshall generate a SIP MESSAGE request as described in clause 6.3.7.1.5 to indicate successful receipt of an emergency alert, and shall include in the application/vnd.3gpp.mcdata-info+xml MIME body:\nA)\tthe <alert-ind> element set to a value of \"true\";\nB)\tthe <alert-ind-rcvd> element set to a value of \"true\"; and\nC)\tthe <mcdata-client-id> element with the MCData client ID that was included in the incoming SIP MESSAGE request; and\nvi)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5].\nUpon receipt of SIP 2xx responses to the outgoing SIP MESSAGE requests, the controlling MCData function shall follow the procedures specified in 3GPP TS 24.229 [5].\nEditor's note: In the current release, support for emergency groups and emergency group communications (in particular the use of the <emergency-ind> element) may be absent, partial or limited, namely only provided to the extent of facilitating emergency alert functionality.\nUpon receipt of a \"SIP MESSAGE request for emergency notification for controlling MCData function\" containing an application/vnd.3gpp.mcdata-info+xml MIME body with the <alert-ind> element set to a value of \"false\", the controlling MCData function:\n1)\tif the received SIP MESSAGE request is an unauthorised request for an MCData emergency alert cancellation as specified in clause 6.3.7.2.1:\na)\tand if the received SIP MESSAGE request does not contain an <emergency-ind> element or is an unauthorised request for an MCData emergency communication cancellation as specified in clause 6.3.7.2.3, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request as specified in 3GPP TS 24.229 [5] with the following clarifications:\ni)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcdata-info+xml MIME body as specified in clause D.1 with the <mcdatainfo> element containing the <mcdata-Params> element with the <alert-ind> element set to a value of \"true\";\nii)\tif the received SIP MESSAGE request contains an <emergency-ind> element of the <mcdatainfo> element set to a value of \"false\" and if the in-progress emergency state of the group is set to a value of \"true\" and this is an unauthorised request for an MCData emergency communication cancellation as determined in step i) above, shall include an <emergency-ind> element set to a value of \"true\" in the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP 403 (Forbidden) response; and\niii)\tshall send the SIP 403 (Forbidden) response according to rules and procedures of 3GPP TS 24.229 [5] and skip the rest of the steps; and\nb)\tand if the received SIP MESSAGE request contains an <emergency-ind> element and is an authorised request for an MCData emergency communication cancellation as specified in clause 6.3.7.2.3 and the in-progress emergency state of the MCData group is set to a value of \"true\":\ni)\tshall set the in-progress emergency state of the group to a value of \"false\";\nii)\tshall clear the cache of the MCData ID of the MCData user that triggered the setting of the in-progress emergency state of the MCData group;\niii)\tshall generate SIP re-INVITE requests to the other affiliated and joined members of the MCData group as specified in clause 6.3.7.1.1, and\nA)\tfor each affiliated and joined member shall send the SIP re-INVITE request towards the MCData client as specified in 3GPP TS 24.229 [5];\niv)\tfor each of the affiliated but not joined members of the group, shall:\nA)\tgenerate a SIP MESSAGE request notification of the cancellation of the MCData user's emergency communication as specified in clause 6.3.7.1.2;\nB)\tinclude in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <mcdata-calling-user-id> element set to the value of the <mcdata-calling-user-id> element in the received SIP MESSAGE request;\nC)\tinclude an <emergency-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request; and\nD)\tsend the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5];\nv)\tshall generate a SIP 200 (OK) response to the received SIP MESSAGE request as specified in TS 24.229 [5];\nvi)\tshall send the SIP 200 (OK) response to the received SIP MESSAGE as specified in 3GPP TS 24.229 [5];\nvii)\tshall generate a SIP MESSAGE request as described in clause 6.3.7.1.5 to indicate successful emergency communication cancellation;\nviii)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request:\nA)\tthe <alert-ind> element set to a value of \"true\";\nB)\tthe <alert-ind-rcvd> element set to a value of \"true\";\nC)\tthe <emergency-ind> element set to a value of \"false\"; and\nD)\tthe <mcdata-client-id> element with the MCData client ID that was included in the incoming SIP MESSAGE request; and\nix)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5]; and\n2)\tif the received SIP MESSAGE request is an authorised request for an MCData emergency alert cancellation as specified in clause 6.3.7.2.2:\na)\tif the received SIP MESSAGE request contains an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, shall clear the cache of the MCData ID of the MCData user identified by the <originated-by> element as having an outstanding MCData emergency alert;\nb)\tif the received SIP MESSAGE request does not contain an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, clear the cache of the MCData ID of the sender of the SIP MESSAGE request as having an outstanding MCData emergency alert;\nc)\tif the received SIP MESSAGE request does not contain an <emergency-ind> element or is an unauthorised request for an MCData emergency communication cancellation as specified in slause 6.3.7.2.3, for each of the affiliated but not joined members of the group shall:\ni)\tgenerate a \"SIP MESSAGE request for emergency notification for terminating participating MCData function\" to cancel the MCData user's emergency alert as specified in clause 6.3.7.1.2;\nii)\tinclude in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <mcdata-calling-user-id> element set to the value of the <mcdata-calling-user-id> element in the received SIP MESSAGE request;\niii)\tif the received SIP MESSAGE request contains an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, copy the contents of the received <originated-by> element to an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request;\niv)\tinclude an <alert-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request; and\nv)\tsend the SIP MESSAGE request as specified in 3GPP TS 24.229 [5];\nd)\tif the received SIP MESSAGE request contains an <emergency-ind> element and is an authorised request for an MCData emergency communication cancellation as specified in clause 6.3.7.2.3 and the in-progress emergency state of the MCData group is set to a value of \"true\":\ni)\tshall set the in-progress emergency state of the group to a value of \"false\";\nii)\tshall cache the information that the MCData user has cancelled the outstanding in-progress emergency state of the group;\niii)\tshall generate SIP re-INVITE requests to the other affiliated and joined members of the MCData group as specified in clause 6.3.7.1.1, and\nA)\tfor each affiliated and joined member shall send the SIP re-INVITE request towards the MCData client as specified in 3GPP TS 24.229 [5]; and\niv)\tfor each of the affiliated but not joined members of the group, shall:\nA)\tgenerate a SIP MESSAGE request notification of the cancellation of the MCData user's emergency communication as specified in clause 6.3.7.1.2;\nB)\tinclude in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <mcdata-calling-user-id> element set to the value of the <mcdata-calling-user-id> element in the received SIP MESSAGE request;\nC)\tif the received SIP MESSAGE request contains an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, copy the contents of the received <originated-by> element to an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request;\nD)\tinclude in the application/vnd.3gpp.mcdata-info+xml MIME body an <alert-ind> element set to a value of \"false\";\nE)\tinclude an <emergency-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request; and\nF)\tsend the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5];\ne)\tshall generate a SIP 200 (OK) response to the received SIP MESSAGE request as specified in 3GPP TS 24.229 [5];\nf)\tshall send the SIP 200 (OK) response to the received SIP MESSAGE as specified in 3GPP TS 24.229 [5];\ng)\tshall generate a SIP MESSAGE request as described in clause 6.3.7.1.5 to indicate successful receipt of the request for emergency alert cancellation;\nh)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body, the <alert-ind> element set to a value of \"false\" and the <alert-ind-rcvd> set to \"true\";\ni)\tshall populate the <mcdata-client-id> element with the MCData client ID that was included in the incoming SIP MESSAGE request;\nj)\tif the received SIP MESSAGE request contains an <emergency-ind> element of the <mcdatainfo> element set to a value of \"false\":\ni)\tif this is an authorised request for an MCData emergency communication cancellation as specified in clause 6.3.7.2.3, shall include an <emergency-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request; and\nii)\totherwise, if this is an unauthorised request for an MCData emergency communication cancellation as specified in clause 6.3.7.2.3, and the in-progress emergency state of the group is set to a value of \"true\", shall include an <emergency-ind> element set to a value of \"true\" in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request; and\nk)\tshall send the SIP MESSAGE request according to according to the rules and procedures of TS 24.229 [5].\nUpon receipt of SIP 2xx responses to the outgoing SIP MESSAGE requests, the controlling MCData function shall follow the procedures specified in 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "16.3\tOff-network emergency alert",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "16.3.1\tGeneral",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16.3.2\tBasic state machine",
                            "text_content": "The figure 16.3.2.2-1 gives an overview of the main states and transitions on the UE for emergency alert.\nEach emergency alert state machine is per MCData group.\nFigure 16.3.2.2-1 illustrates the emergency alert state machine, which outlines the sequence of events and transitions during an emergency alert system. The figure depicts various states, such as Alert, Warning, and Emergency, along with the associated conditions and actions. It also includes input sources like the National Oceanic and Atmospheric Administration (NOAA) and the Emergency Alert System (EAS). The state transitions are represented by arrows, indicating the flow of alerts from one state to another. The figure emphasizes the importance of a well-structured and responsive emergency alert system in ensuring public safety and effective communication during critical situations.\nFigure 16.3.2.2-1: Emergency alert state machine\nThe following piece of information is associated with the emergency alert state machine:\na)\tthe stored emergency state of the MCData group.\nNOTE:\tThe emergency alert state machine is referred by the MCData off-network group call and MCData off-network private call procedures.\nThis state is the start state of this state machine.\nThe UE stays in this state while not in emergency state.\nThis state exists for UE, when the UE has sent a GROUP EMERGENCY ALERT message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16.3.3\tProcedures",
                            "text_content": "When in state \"E1: Not in emergency state\", upon receiving an indication from the MCData user to transmit an emergency alert for an MCData group ID and the value of \"/<x>/<x>/Common/AllowedActivateAlert\" leaf node present in the user profile as specified in 3GPP TS 24.483 [42] is set to \"true\", the MCData client:\n1)\tshall set the stored emergency state as \"true\";\n2)\tshall set the stored MCData group ID to the indicated MCData group ID;\n3)\tshall generate a GROUP EMERGENCY ALERT message as specified in clause 15.1.14. In the GROUP EMERGENCY ALERT message, the MCData client:\na)\tshall set the MCData group ID IE to the stored MCData group ID;\nb)\tshall set the Originating MCData user ID IE to own MCData user ID;\nc)\tmay set the Organization name IE to own organization name; and\nd)\tmay set the User location IE with client's current location, if requested;\n4)\tshall send the GROUP EMERGENCY ALERT message as specified in clause 9.3.1.2;\n5)\tshall start timer TFE2 (emergency alert retransmission); and\n6)\tshall enter \"E2: Emergency state\" state.\nWhen in state \"E2: Emergency state\", upon expiry of timer TFE2 (emergency alert retransmission), the MCData client:\n1)\tshall generate a GROUP EMERGENCY ALERT message as specified in clause 15.1.14. In the GROUP EMERGENCY ALERT message, the MCData client:\na)\tshall set the MCData group ID IE to the stored MCData group ID;\nb)\tshall set the originating MCData user ID IE to own MCData user ID;\nc)\tmay set the Organization name IE to own organization name; and\nd)\tmay set the Location IE with client's current location, if requested;\n2)\tshall send the GROUP EMERGENCY ALERT message as specified in clause 9.3.1.2;\n3)\tshall start the timer TFE2 (emergency alert retransmission); and\n4)\tshall remain in the current state.\nWhen in state \"E1: Not in emergency state\" or in \"E2: Emergency state\", upon receiving a GROUP EMERGENCY ALERT message with the Originating MCData user ID IE not stored in the list of users in emergency, the MCData client:\n1)\tshall store the Originating MCData user ID IE and location IE in the list of users in emergency;\n2)\tshall generate a GROUP EMERGENCY ALERT ACK message as specified in clause 15.1.15. In the GROUP EMERGENCY ALERT ACK message, the MCData client:\na)\tshall set the MCData group ID IE to the MCData group ID IE of the received GROUP EMERGENCY ALERT message;\nb)\tshall set the Sending MCData user ID IE to own MCData user ID;\nc)\tshall set the Originating MCData user ID IE to the Originating MCData user ID IE of the received GROUP EMERGENCY ALERT message; and\n3)\tshall send the GROUP EMERGENCY ALERT ACK message as specified in clause 9.3.1.2;\n4)\tshall start timer TFE1 (Emergency Alert); and\n5)\tshall remain in the current state.\nNOTE:\tEach instance of timer TFE1 is per MCData user ID.\nEditor's Note: [CR 0095, WI eMCData2] Use of timer TFE1 in case of several emergency alerts from multiple users is FFS.\nWhen in state \"E1: Not in emergency state\" or in \"E2: Emergency state\", upon receiving a GROUP EMERGENCY ALERT message with the Originating MCData user ID IE stored in the list of users in emergency and Location IE different than the stored location of the user, the MCData client:\n1)\tmay update the stored location of the user with the received Location IE;\n2)\tshall restart the associated timer TFE1 (Emergency Alert); and\n3)\tshall remain in the current state.\nWhen in \"E2: Emergency state\", upon receiving an indication from the MCData user to cancel an emergency alert and the value of \"/<x>/<x>/Common/AllowedCancelAlert\" leaf node present in the user profile as specified in 3GPP TS 24.483 [42] is set to \"true\", the MCData client:\n1)\tshall set the stored emergency state as \"false\";\n2)\tshall generate a GROUP EMERGENCY ALERT CANCEL message as specified in clause 15.1.16. In the GROUP EMERGENCY ALERT CANCEL message, the MCData client:\na)\tshall set the MCData group ID IE to the stored MCData group ID; and\nb)\tshall set the Originating MCData user ID IE to own MCData user ID;\n3)\tshall send the GROUP EMERGENCY ALERT CANCEL message as specified in clause 9.3.1.2;\n4)\tshall stop timer TFE2 (emergency alert retransmission); and\n5)\tshall enter \"E1: Not in emergency state\" state.\nWhen in state \"E1: Not in emergency state\" or in \"E2: Emergency state\", upon receiving a GROUP EMERGENCY ALERT CANCEL message with the Originating MCData user ID IE stored in the list of users in emergency, the MCData client:\n1)\tshall remove the MCData user ID and associated location information from the stored list of users in emergency;\n2)\tshall generate a GROUP EMERGENCY ALERT CANCEL ACK message as specified in clause 15.1.17. In the GROUP EMERGENCY ALERT CANCEL ACK message, the MCData client:\na)\tshall set the MCData group ID IE to the MCData group ID IE of the received GROUP EMERGENCY ALERT CANCEL message;\nb)\tshall set the Sending MCData user ID IE to own MCData user ID; and\nc)\tshall set the Originating MCData user ID IE to the Originating MCData user ID IE of the received GROUP EMERGENCY ALERT message;\n3)\tshall send the GROUP EMERGENCY ALERT CANCEL ACK message as specified in clause 9.3.1.2;\n4)\tshall stop the associated timer TFE1 (Emergency Alert); and\n5)\tshall remain in the current state.\nWhen in state \"E1: Not in emergency state\" or in \"E2: Emergency state\", upon expiry of timer TFE1 (Emergency Alert) associated with a stored MCData user ID, the MCData client:\n1)\tshall remove the MCData user ID and associated location information from the stored list of users in emergency; and\n2)\tshall remain in the current state.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "17\tLocation procedures",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "17.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "If the participating MCData function needs to obtain location information, the participating MCData function configures the MCData client upon successful MCData service authorization. The configuration contains information the MCData client uses to set up filter criteria for when the MCData client shall send location reports to the participating MCData function.\nThe participating MCData function can also explicitly request the MCData client to send a location report.\nThe MCData client will, based on the received configuration or when explicitly requested, send location reports.\nThe location information can be used by the participating MCData function to determine whether to use MBMS bearers or not.\nIn case of LTE MBMS and 5G MBS co-existence, the inter-RAT information contained in the location information is used by the participating MCData function to determine how to receive MCData services after inter-RAT change.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "17.2\tParticipating MCData function location procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "17.2.1\tGeneral",
                            "text_content": "The participating MCData function has procedures to:\n-\tconfigure the location reporting at the UE;\n-\trequest the UE to report the location of the UE; and\n-\treceive a location information report from the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.2.2\tLocation reporting configuration",
                            "text_content": "The participating MCData function may configure the location reporting in the MCData client by generating a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]. The participating MCData function:\n1)\tshall include a Request-URI set to the URI from MCData service authorization corresponding to the MCData ID of the MCData user;\n2)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" in accordance with IETF RFC 3841 [8];\n3)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-request-uri> element containing the MCData ID of the MCData user to receive the configuration;\n4)\tshall include an application/vnd.3gpp.mcdata-location-info+xml MIME body with the <Configuration> element contained in the <location-info> root element set to the desired configuration;\n5)\tshall include the TriggerId attribute where defined for the sub-elements defining the trigger criterion;\n6)\tshall include the public service identity of the participating MCData function in the P-Asserted-Identity header field;\n7)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\"; and\n8)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.2.3\tLocation information request",
                            "text_content": "If the participating MCData function needs to request the MCData client to report its location, the participating MCData functions shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]. The participating MCData function:\n1)\tshall include a Request-URI set to the URI from MCData service authorization corresponding to the MCData ID of the MCData user;\n2)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" in accordance with IETF RFC 3841 [8];\n3)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-request-uri> element containing the MCData ID of the MCData user;\n4)\tshall include an application/vnd.3gpp.mcdata-location-info+xml MIME body with a <Request> element contained in the <location-info> root element;\n5)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\"; and\n6)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.2.4\tLocation information report",
                            "text_content": "If the participating MCData function receives a SIP request containing:\n1)\ta Content-Type header field set to \"application/vnd.3gpp.mcdata-location-info+xml\"; and\n2)\tan application/vnd.3gpp.mcdata-location-info+xml MIME body with a <Report> element included in the <location-info> root element;\nthen the participating MCData function shall authorise the location report based on the MCData ID received. If the MCData user is authorised to send a location report the participating MCData function:\n1)\tshall use the location information as needed;\n2)\tshall follow the procedure of clause 6.3.7.1.7, if the MCData client has entered into or exited from a group geographic area; and\n3)\tshall follow the procedure of clause 6.3.7.1.6, if the MCData client has entered into or exited from an emergency alert area.\nNOTE:\tThe <Report> element contains the event triggering identity in the location information report from the UE, and can contain location information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.2.5\tAbnormal cases",
                            "text_content": "Upon receipt of a SIP request:\n1)\twhere the P-Asserted-Identity identifies a public user identity not associated with an MCData user served by the participating MCData function; or\n2)\twith a MIME body with Content-Type header field set to \"application/vnd.3gpp.mcdata-info+xml\" and with a <mcdata-request-URI> element containing an MCData ID that identifies an MCData user served by the participating MCData function;\nthen, when the SIP request contains:\n1)\tan Accept-Contact header field with the g.3gpp.mcdata media feature tag;\n2)\tan Accept-Contact header field with the g.3gpp.icsi-ref media-feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\"; and\n3)\tan application/vnd.3gpp.mcdata-location-info+xml MIME body containing a <Request> element or a <Configuration> element;\nthe participating MCData function shall remove the application/vnd.3gpp.mcdata-location-info+xml MIME body when sending a SIP request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "17.3\tMCData client location procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "17.3.1\tGeneral",
                            "text_content": "The MCData client sends a location report when one of the trigger criteria is fulfilled or when it receives a request from the participating MCData function to send a location report. To send the location report the MCData client can use an appropriate SIP message that it needs to send for other reasons, or it can include the location report in a SIP MESSAGE request.\nTo send a location report, the MCData client includes in the SIP MESSAGE request an application/vnd.3gpp.mcdata-location-info+xml MIME body as specified in clause D.4. The MCData client populates the elements in accordance with its reporting configuration. Further location information may also be included in the P-Access-Network-Info header field.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.3.2\tLocation reporting configuration",
                            "text_content": "Upon receiving a SIP MESSAGE request containing:\n1)\tan Accept-Contact header field with the media feature tag g.3gpp.icsi-ref set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\";\n2)\ta Content-Type header field set to \"application/vnd.3gpp.mcdata-location-info+xml\"; and\n3)\tan application/vnd.3gpp.mcdata-location-info+xml MIME body with a <Configuration> root element included in the <location-info> root element;\nthe MCData client:\n1)\tshall store the contents of the <Configuration> elements;\n2)\tshall set the location reporting triggers accordingly; and\n3)\tshall start the minimumReportInterval timer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.3.3\tLocation information request",
                            "text_content": "Upon receiving a SIP MESSAGE request containing:\n1)\tan Accept-Contact header field with the media feature tag g.3gpp.icsi-ref set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\";\n2)\ta Content-Type header field set to \"application/vnd.3gpp.mcdata-location-info+xml\"; and\n3)\tan application/vnd.3gpp.mcdata-location-info+xml MIME body with a <Request> element included in the <location-info> root element;\nthe MCData client:\n1)\tshall send a location report as specified in clause 17.3.4; and\n2)\tshall reset the minimumReportInterval timer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.3.4\tLocation information report",
                            "text_content": "If a location reporting trigger fires, the MCData client checks if the minimumReportInterval timer is running. If the timer is running the MCData client waits until the timer expires. When the minimumReportInterval timer expires, the MCData client:\n1)\tshall, if any of the reporting triggers are still true, send a location information report as specified in clause 17.3.4.2.\nIf the MCData client receives a location information request as specified in clause 17.3.3, the MCData client shall send a location report as specified in clause 17.3.4.2.\nIf the MCData client needs to send a SIP request anyway (i.e. for reasons other than explicit location reporting request or the firing of a configured location trigger), the MCData client:\n1)\tshall include an application/vnd.3gpp.mcdata-location-info+xml MIME body and in the <location-info> root element the MCData client shall include:\na)\ta <Report> element and, if the Report was triggered by a location request, include the <ReportID> attribute set to the value of the <RequestID> attribute in the received Request;\nb)\t<TriggerId> child elements, if triggers have fired, where each element is set to the value of the <Trigger-Id> attribute associated with the triggers that have fired; and\nc)\tthe location reporting elements corresponding to the triggers that have fired, if at least one trigger has fired;\n2)\tshall set the minimumReportInterval timer to the minimumReportInterval time and start the timer; and\n3)\tshall reset all triggers.\nIf the MCData client does not need to send a SIP request for reasons other than explicit location reporting request or the firing of a configured location trigger, the MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]. The MCData client;\n1)\tshall include in the Request-URI, the SIP URI received in the P-Asserted-Identity header field in the received SIP MESSAGE request for location report configuration;\n2)\tshall include a Content-Type header field set to \"application/vnd.3gpp.mcdata-location-info+xml\";\n3)\tshall include an application/vnd.3gpp.mcdata-location-info+xml MIME body and in the <location-info> root element include:\na)\ta <Report> element and if the Report was triggered by a location request include the <ReportID> attribute set to the value of the <RequestID> attribute in the received Request;\nb)\t<TriggerId> child elements, if triggers have fired, where each element is set to the value of the <Trigger-Id> attribute associated with the triggers that have fired; and\nc)\tthe location reporting elements corresponding to the triggers that have fired, if at least one trigger has fired;\n4)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.mcdata along with parameters \"require\" and \"explicit\" in accordance with IETF RFC 3841 [8];\n5)\tshall set the minimumReportInterval timer to the minimumReportInterval time and start the timer;\n6)\tshall reset all triggers; and\n7)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "18\tPre-established session",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "18.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The MCData client may establish one or more pre-established sessions to the participating MCData function at any time after SIP registration and setting the service settings as defined in clause 7.2.2 or clause 7.2.3.\nThe MCData client may use the pre-established session for originating standalone SDS using media plane or SDS session after pre-established session establishment.\nThe participating MCData function may use the pre-established session for terminating standalone SDS using media plane or SDS session after pre-established session establishment.\nThe use of a pre-established session requires the use of resource sharing as specified in 3GPP TS 29.214 [49] and 3GPP TS 24.229 [5] by the participating MCData function. The participating MCData function use of resource sharing is defined in clause 18.2.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "18.2\tParticipating MCData function use of resource sharing",
                    "description": "",
                    "summary": "",
                    "text_content": "The participating MCData function utilizes resource sharing either:\n1)\tvia the SIP core as specified in 3GPP TS 24.229 [5]; or\n2)\tby directly interfacing to PCC to control resource sharing via the Rx reference point as specified in 3GPP TS 29.214 [49].\nIf resource sharing is supported then the participating MCData function may allow the use of pre-established sessions by the MCData client.\nThe participating MCData function can determine that the SIP core supports resource sharing from the received third-party SIP REGISTER request if the Resource-Share header field with the value \"supported\" is contained in the \"message/sip\" MIME body of the third-party SIP REGISTER request as specified in 3GPP TS 24.229 [5].\nWhen using resource sharing the participating MCData function uses the \"+g.3gpp.registration-token\" header field parameter in the Contact header field of the third-party REGISTER request to identify the MCData UE that is registering and to identify whether resource sharing and pre-established sessions can be used with a specific MCData UE.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "18.3\tPre-established session for MCData SDS communication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "18.3.1\tGeneral",
                            "text_content": "This clause describes the procedures to establish pre-established MCData session which may be used for originating standalone SDS using media plane or SDS session. The MCData client or the participating MCData function may initiate the release of a pre-established session as defined in clause 18.3.3.\nWhen composing an SDP offer according to 3GPP TS 24.229 [5], IETF RFC 4975 [17], IETF RFC 6135 [19] and IETF RFC 6714 [20] the MCData client:\n1)\tshall include an \"m=message\" media-level section for the MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS;\nc)\tan \"a=sendrecv\" attribute;\nd)\tan \"a=path\" attribute containing its own MSRP URI;\ne)\tset the content type as \"a=accept-types:application/vnd.3gpp.mcdata-signalling application/vnd.3gpp.mcdata-payload\"; and\nf)\tset the a=setup attribute as \"actpass\".\nWhen composing the SDP answer according to 3GPP TS 24.229 [5], the participating MCData function:\n1)\tshall replace the IP address and port number in the received SDP answer with the IP address and port number of the participating MCData function, for the accepted media stream in the received SDP offer, if required; and\n2)\tif the IP address is replaced shall insert its MSRP URI before the MSRP URI in the \"a=path\" attribute in the SDP answer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "18.3.2\tSession establishment",
                            "text_content": "When the MCData client initiates a pre-established session the MCData client shall:\n1)\tgather ICE candidates according to IETF RFC 8445 [77]; and\nNOTE:\tICE candidates are only gathered on interfaces that the MCData UE uses to obtain MCData service.\n2)\tgenerate an initial SIP INVITE request by following the UE originating session procedures specified in 3GPP TS 24.229 [5], with the clarifications given below.\nThe MCData client:\n1)\tshall set the Request-URI of the SIP INVITE request to the public service identity of the participating MCData function serving the MCData user;\n2)\tmay include a P-Preferred-Identity header field in the SIP INVITE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n3)\tshall include the g.3gpp.mcdata.sds media feature tag in the Contact header field of the SIP INVITE request according to IETF RFC 3840 [16];\n4)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.mcdata.sds along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n5)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n6)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n7)\tshall include the \"timer\" option tag in the Supported header field;\n8)\tshould include the Session-Expires header field according to IETF RFC 4028 [38] and should not include the \"refresher\" header field. The \"refresher\" header field parameter shall be set to \"uac\" if included;\n9)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdataInfo> element containing the <mcdata-Params> element with the <anyExt> element an <pre-established-session-ind> element set to a value of \"true\";\n10)\tshall include an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 18.3.1.1, and include ICE candidates in the SDP offer as per IETF RFC 8839 [78]; and\n11)\tshall send the SIP INVITE request according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 2xx response to the SIP INVITE request the MCData client:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15].\nUpon receipt of a \"SIP INVITE request for establishing a pre-established session\" the participating MCData function:\n1)\tshall check whether the public service identity is allocated and if it is not allocated, shall return a SIP 404 (Not Found) response and skip the rest of the steps;\n2)\tshall determine the MCData ID of the MCData user establishing the pre-established session and perform actions to verify the MCData ID of the MCData client and authorise the request according to local policy, and if not authorised, the participating MCData function shall return a SIP 403 (Forbidden) response with the warning text set to \"225 User not authorized to initiate pre-established session\" as specified in clause 4.9 and skip the rest of the steps;\n3)\tshall determine whether resource sharing is supported (see clause 18.2);\n4)\tif resource sharing is supported by the SIP core, determine that there is a binding between the MCData ID of the MCData user establishing the pre-established session and the MCData UE identified by the \"+g.3gpp.registration-token\" header field parameter in the Contact header field of the third-party REGISTER request (see clause 18.2) and that this UE identity matches the identity in the \"+g.3gpp.registration-token\" header field parameter in the Feature-Caps header field in the \"SIP INVITE request for establishing a pre-established session\";\n5)\tif resource sharing is not supported or if there is no binding between the MCData ID of the MCData user and the identity of the MCData UE identified by the \"+g.3gpp.registration-token\" header field parameter in the Feature-Caps header field or the participating MCData function does not support the pre-established session, then the participating MCData function shall return a SIP 403 (Forbidden) response with the warning text set to \"226 function not allowed due to pre-established session not supported\" as specified in clause 4.9 and skip the rest of the steps;\n6)\tshall determine if the media parameters are acceptable and the MSRP URI is offered in the SDP offer and if not reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n7)\tshall verify that the media resources are available to support the media parameters and if not shall reject the request with a SIP 500 (Server Internal Error) response, and skip the rest of the steps;\n8)\tshall allocate a URI to be used to identify the pre-established session;\n9)\tshall generate a SIP 200 (OK) response to the SIP INVITE request according to 3GPP TS 24.229 [5]; and\na)\tshall include a Contact header field containing the URI that identifies the pre-established session;\nb)\tshall include a P-Asserted-Identity header field set to the public service identity of the participating MCData function;\nc)\tshall include a Supported header field containing the \"norefersub\" option tag;\nd)\tshall if the SIP core supports resource sharing, include a Resource-Share header field answer as specified in 3GPP TS 24.229 [5] with:\nA)\tthe value \"media-sharing\";\nB)\tan \"origin\" header field parameter set to \"session-initiator\";\nC)\ta \"timestamp\" header field parameter; and\nD)\ta \"rules\" header field parameter with one resource sharing rule per media stream in the same order the corresponding m-line appears in the SDP. Each resource sharing rule is constructed as follows:\n-\ta \"new-sharing-key\" part; and\n-\ta \"directionality\" part indicating the direction of the pre-established media stream; and\ne)\tshall include an SDP answer as specified in 3GPP TS 24.229 [5] with the clarifications in clause 18.3.1.2 and include ICE candidates in the SDP answer as per IETF RFC 8839 [78];\n10)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15];\n11)\tshall send the SIP 200 (OK) response towards the MCData client according to the rules and procedures of the 3GPP TS 24.229 [5]; and\n12)\tshall evaluate the ICE candidates according to IETF RFC 8445 [77].\nNOTE:\tIf ICE candidate evaluation results in candidate pairs other than the default candidate pair being selected a further offer answer exchange using the procedures in clause 18.3.4 will be needed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "18.3.3\tSession release",
                            "text_content": "NOTE:\tThe MCData client needs to be prepared to release the pre-established session when receiving a SIP BYE request generated by the SIP core (e.g. due to network release of media plane resources).\nWhen a MCData client needs to release a pre-established session as created in clause 18.3.2, the MCData client shall perform the procedure as described in clause 13.2.2.2.2.1.\nUpon receiving a SIP BYE request from the participating MCData function within a pre-established session the MCData client shall check whether there are any MCData sessions using the pre-established session, and:\n1)\tif there is an established MCData session then the MCData client shall remove the MCData client from the MCData session by performing the procedures for session release for each MCData session as specified in 3GPP TS 24.582 [15]; and\n2)\tif there is no MCData session using the pre-established session, then the MCData client shall follow the procedure described in clause 13.2.3.2.2.\nUpon receiving a SIP BYE request from the MCData client within a pre-established session the participating MCData function:\n1)\tshall check whether there is a MCData session using the pre-established session, and:\na)\tif there is an established MCData session then the participating MCData function shall remove the MCData client from the MCData session by performing the procedures as specified in clause 13.2.2.2.3.1;\nb)\tif there is a MCData session in the process of being established, then the participating MCData function:\ni)\tshall send a SIP CANCEL request to cancel the MCData session in the process of being established as specified in 3GPP TS 24.229 [5]; and\nii)\tshall release the MCData session as specified in the clause 13.2.2.2.3.1, if a SIP 200 (OK) response for the SIP INVITE request is received from the remote side; and\nc)\tif there is no MCData session using the pre-established session, then the participating MCData function shall:\ni)_\tinteract with the media plane as specified in 3GPP TS 24.582 [15] for disconnecting the media plane resources towards the MCData client; and\nii)\tshall generate and send a SIP 200 (OK) response to the SIP BYE request according to rules and procedures of 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response to the SIP BYE request from the remote side, the participating MCData function:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] for releasing media plane resources towards the remote side;\n2)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] for releasing media plane resources towards the MCData client; and\n3)\tshall send a SIP 200 (OK) response to the SIP BYE request to the MCData client.\nWhen a participating MCData function needs to release a pre-established session as created in clause 8.2.2, the participating MCData function:\n1)\tshall first release any participants of all MCData calls that are using the pre-established session. The participating MCData function shall remove the MCData client from the MCData session by performing the procedures as specified in clause 13.2.2.2.3.1;\n2)\tshall generate a SIP BYE request according to rules and procedures of 3GPP TS 24.229 [5];\n3)\tshall set the Request-URI of the SIP BYE request to the URI that identifies the pre-established session;\n4)\tshall send the SIP BYE request towards the MCData client within the SIP dialog of the pre-established session according to rules and procedures of the 3GPP TS 24.229 [5]; and\n5)\tshall, upon receiving a SIP 200 (OK) response to the SIP BYE request interact with the media plane as specified in 3GPP TS 24.582 [15].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "18.3.4\tSession modification",
                            "text_content": "When the MCData client needs to modify the pre-established session outside of an MCData session, the MCData client:\n1)\tshall generate a SIP UPDATE request or a SIP re-INVITE request according to 3GPP TS 24.229 [5];\n2)\tshall include an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 18.3.1.1, and include ICE candidates in the SDP offer as per IETF RFC 8839 [78], if required; and\n3)\tshall send the SIP request towards the MCData server according to the rules and procedures of 3GPP TS 24.229 [5].\nOn receipt of the SIP 200 (OK) response the MCData client:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15], if there is a change in media parameters in the received SDP answer, compared to those in the previously agreed SDP; and\n2)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15], if there is a media stream, that is currently used in the pre-established session and is removed in the received SDP answer.\nNOTE:\tThe MCData client keeps resources for previously agreed media stream and media parameters until it receives a SIP 200 (OK) response.\nUpon receiving a SIP UPDATE request or a SIP re-INVITE request to modify an existing pre-established session without associated MCData session, the MCData client:\n1)\tshall validate that the received SDP offer includes at least one media stream for which the media parameters and the MSRP URI is acceptable by the MCData client and if not, reject the request with a SIP 488 (Not Acceptable Here) response. Otherwise, continue with the rest of the steps;\n2)\tshall generate a SIP 200 (OK) response as follows:\na)\tshall include an SDP answer according to 3GPP TS 24.229 [5] with the clarifications given in clause 18.3.1.2, and include ICE candidates in the SDP answer as per IETF RFC 8839 [78], if required; and\n3)\tshall send the SIP 200 (OK) response towards the MCData server according to the rules and procedures of 3GPP TS 24.229 [5].\nUpon receiving a SIP UPDATE request or a SIP re-INVITE request to modify an existing pre-established session without associated MCData session, the participating MCData function:\n1)\tshall validate that the received SDP offer includes at least one media stream for which the media parameters and the MSRP URI is acceptable by the participating MCData function and if not reject the request with a SIP 488 (Not Acceptable Here) response. Otherwise, continue with the rest of the steps; and\n2)\tshall generate a SIP 200 (OK) response as follows:\na)\tinclude an SDP answer according to 3GPP TS 24.229 [5] based on the received SDP offer with the clarifications given in the clause 18.3.1.2, and include ICE candidates in the SDP answer as per IETF RFC 8839 [78], if required; and\nb)\tinclude a Contact header field containing the URI that identifies the pre-established session and send a SIP 200 (OK) response according to the rules and procedures of 3GPP TS 24.229 [5].\nWhen the participating MCData function needs to modify the pre-established session outside of an MCData session, the participating MCData function:\n1)\tshall generate a SIP UPDATE request or a SIP re-INVITE request according to 3GPP TS 24.229 [5];\n2)\tshall include an SDP offer according to 3GPP TS 24.229 [5], and include ICE candidates in the SDP offer as per IETF RFC 8839 [78], if required; and\n3)\tshall send the SIP request towards the MCData client according to the rules and procedures of 3GPP TS 24.229 [5].\nOn receipt of the SIP 200 (OK) response, the participating MCData function:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15], if there is change in media parameters or the MSRP URI in the received SDP answer, compared to those in the previously agreed SDP;\n2)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15], if there is a media stream, that is currently used in the pre-established session, is removed in the received SDP answer; and\n3)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15], if there is a media stream accepted in the received SDP answer, that is not currently used by the participant in the pre-established session.\nNOTE:\tThe participating MCData function keeps resources for previously agreed media stream, media parameters and the MSRP URI until it receives a SIP 200 (OK) response.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "19\tMBMS transmission usage procedure",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "19.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes the participating MCData function and the MCData client procedure for:\n1)\tMBMS bearer announcements;\n2)\tMBMS bearer listening status; and\n3)\tMBMS bearer suspension status.\nThis clause contains references to the MBMS Subchannel control messages Map Group To Bearer and Unmap Group To Bearer defined in 3GPP TS 24.582 [15].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "19.2\tParticipating MCData function MBMS usage procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "19.2.1\tGeneral",
                            "text_content": "This clause describes the procedures in the participating MCData function for:\n1)\tsending an MBMS bearer announcements to the MCData client;\n2)\treceiving an MBMS bearer listening status from the MCData client; and\n3)\treceiving an MBMS bearer suspension status from the MCData client.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19.2.2\tSending MBMS bearer announcement procedures",
                            "text_content": "The availability of a MBMS bearer is announced to MCData clients by means of an MBMS bearer announcement message. One or more MBMS bearer announcement elements are included in an application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body.\nAn MBMS bearer announcement message can contain new MBMS bearer announcements, updated MBMS bearer announcements or cancelled MBMS bearer announcements or a mix of all of them at the same time in an application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body. Each initial MBMS bearer announcement message announces one MBMS bearer intended to carry a general purpose MBMS subchannel used for application level multicast signalling in a specified MBMS service area and additionally, the message could also announce zero or more extra MBMS bearers intended to carry additional media plane traffic.\nNOTE:\tA new MBMS bearer announcement does not implicitly remove previously sent MBMS bearer announcements if the previously sent MBMS bearer announcement is not included in an MBMS bearer announcement message. However, the application/sdp MIME body, if included in the new MBMS bearer announcement message, fully replaces the existing application/sdp MIME body (which includes the MSCCK security key used to protect the general purpose MBMS subchannel).\nWhen and to whom the participating MCData function sends the MBMS bearer announcement is based on local policy in the participating MCData function.\nThe following clauses describe how the participating MCData function:\n1.\tsends an initial MBMS bearer announcement message;\n2.\tupdates a previously sent announcement of MBMS bearer(s);\n3.\tcancels a previously sent announcement of MBMS bearer(s); and\n4.\tkeys, re-keys or un-keys MCData groups using Multicast Signalling Key (MuSiK) via a key download procedure.\nPrior to the participating MCData function transmitting on an MBMS bearer, the participating MCData function:\n1.\tif necessary, shall instruct the local key management client to request keying material from the key management server as described in 3GPP TS 33.180 [26];\n2.\tshall generate MSCCK(s) with the corresponding MSCCK-ID(s) and MuSiK(s) with the corresponding MuSiK-ID(s) as necessary; and\n3.\tshall distribute MSCCKs, MSCCK-IDs, MuSiKs and MuSiK-IDs to the MCData clients, as needed, using the keying material received from the key management server for security protection, as described in 3GPP TS 33.180 [26].\nFor each MCData client that the participating MCData function is sending an MBMS bearer announcement to, the participating MCData function:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall set the Request-URI to the URI received in the To header field in a third-party SIP REGISTER request;\n3)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media-feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n4)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\";\n5)\tshall include one application/sdp MIME body conforming to 3GPP TS 24.229 [5] where the application/sdp MIME body:\na)\tshall include the Content-Disposition header field with the value \"render\";\nb)\tshould include one or more \"m=message\" media lines and media line attributes conforming to IETF RFC 4566 [71] and IETF RFC 5888 [72], to be used as the MBMS subchannel for media only. Additionally, the participating MCData function:\nNOTE 0:\tUnciphered packets (i.e. using RTP/UDP/IP encapsulation) and ciphered packets (i.e. using SRTP/UDP/IP encapsulation) need separate media lines, with different transport protocols.\ni)\tshall set the c-line to the unspecified address (0.0.0.0), if IPv4, or to a domain name within the \".invalid\" DNS top-level domain, if IPv6; and\nii)\tshall set the port number of the media line to 9; and\niii)\tshall set the <proto> sub-field of the media line to RTP/AVP for unciphered traffic or to RTP/SAVP for ciphered traffic, to be used for the MBMS subchannel associated to the media line; and\nc)\tshall include one \"m=application\" media line to be used for the general purpose MBMS subchannel. The media line shall include a valid multicast IP address and a valid port number. If the protection of MBMS subchannel control messages sent over this MBMS subchannel of the MBMS bearer is required, the participating MCData function also includes an \"a=key-mgmt\" media-level attribute. The participating MCData function:\ni)\tshall encrypt the MSCCK to a UID associated to the targeted MCData ID and a time related parameter as described in 3GPP TS 33.180 [26];\nii)\tshall generate a MIKEY-SAKKE I_MESSAGE using the encapsulated MSCCK and MSCCK-ID as specified in 3GPP TS 33.180 [26];\niii)\tshall add the public service identity of the participating MCData function to the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26];\niv)\tshall sign the MIKEY-SAKKE I_MESSAGE using the public service identity of the participating MCData function signing key provided in the keying material together with a time related parameter, and add this to the MIKEY-SAKKE payload, as described in 3GPP TS 33.180 [26]; and\nv)\tshall include the \"mikey\" key management and protocol identifier and the signed MIKEY-SAKKE I_MESSAGE in the value of the a=key-mgmt\" media-level attribute according to IETF RFC 4567 [45]; and\n6)\tshall include an application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body defined in clause D.5 with the <version> element set to \"1\" and one or more <announcement> elements associated with the pre-activated MBMS bearers. Each set of an <announcement> element:\na)\tshall include a TMGI value in the <TMGI> element;\nNOTE 2:\tThe same TMGI value can only appear in one <announcement> element. The TMGI value is also used to identify the <announcement> when updating or cancelling the <announcement> element.\nNOTE 3:\tThe security key active for the general purpose MBMS subchannel on which the mapping (i.e. the Map Group To Bearer message) of media to this MBMS bearer was indicated, is used for MBMS subchannels on this MBMS bearer, unless a different key or an indication of not using encryption is in place.\nb)\tshall include the QCI value in the <QCI> element;\nc)\tif multiple carriers are supported, shall include the frequency to be used in the <frequency> element;\nNOTE 4:\tIn the current release, if the <frequency> element is included, the frequency in the <frequency> element is the same as the frequency used for unicast.\nd)\tshall include one or more MBMS service area IDs in <mbms-service-area-id> elements in the <mbms-service-areas> element;\nNOTE 5:\tInitial mappings of groups to MBMS subchannels on an MBMS bearer for the purpose of carrying media can occur only where the MBMS service area for this bearer and the MBMS service area for the bearer carrying the general purpose MBMS subchannel on which the Map Group To Bearer message is sent intersect. However, once the mapping to this bearer was successful, the reception by the MCData client can continue (until Unmap Group To Bearer is received or until timeout) throughout the entire MBMS service area of this bearer.\ne)\tmay include the <report-suspension> element and set it to \"true\" value or the \"false\" value;\nNOTE 6:\tThe participating function can choose to direct some clients not to send an MBMS bearer suspension report when notified by RAN, by including the <report-suspension> element set to \"false\". The purpose is to prevent an avalanche of identical reports sent by clients roughly at the same time, to report the suspension of the same MBMS bearer. The way the participation function determines which clients are to send or not to send the report is outside the scope of the present document.\nf)\tif the MBMS bearer is carrying the general purpose MBMS subchannel, shall include one <GPMS>element, giving the number of the \"m=application\" media line in the application/sdp MIME body generated in step 5 above to be used for the general purpose MBMS subchannel; and\ng)\tif the packet headers are compressed with ROHC specified in RFC 5795 [60] in this MBMS bearer, the <anyExt> element in the <announcement> element in the <mcdata-mbms-usage-info> element shall include the <mcdata-mbms-rohc> element defined in clause D.5.3.\n7)\tshall include the MBMS public service identity of the participating MCData function in the P-Asserted-Identity header field;\n8)\tshall include in a MIME body with Content-Type header field set to \"application/vnd.3gpp.mcdata-info+xml\", the <mcdata-request-uri> element set to the MCData ID of the user; and\n9)\tshall send the SIP MESSAGE request towards the MCData client according to 3GPP TS 24.229 [5].\nWhen the participating MCData function wants to update a previously sent announcement, the participating MCData function sends an MBMS bearer announcement in an SIP MESSAGE request as specified in clause 19.2.2.2 where the participating MCData function in the <announcement> element to be updated:\n1)\tshall include the same TMGI value as in the MBMS bearer announcement to be updated in the <TMGI> element;\nNOTE 1:\tTMGI value is used to identify the <announcement> when updating or cancelling the <announcement> element and can't be changed.\n2)\tshall include the same or an updated value of the QCI in the <QCI> element;\n3)\tif a frequency was included in the previously sent announcement, shall include the same value in the <frequency> element;\nNOTE 2:\tIn the current release if the <frequency> element is included, the frequency in the <frequency> element is the same as the frequency used for unicast.\n4)\tshall include the same list of MBMS service area IDs or an updated list of MBMS service area IDs in <mbms-service-area-id> elements in the <mbms-service-areas> element;\n5)\tmay include the same or an updated value in the <report-suspension> element;\n6)\tshall include the <GPMS> element with the same value as in the initial <announcement> element; and\n7)\tshall include the same application/sdp MIME body as included in the initial MBMS announcement.\nWhen the participating MCData function wants to cancel an MBMS bearer announcement associated with an <announcement> element, the participating MCData function sends an MBMS bearer announcement as specified in clause 19.2.2.2 where the participating MCData function in the <announcement> element to be cancelled:\n1)\tshall include the same TMGI value as in the <announcement> element to be cancelled in the <TMGI> element;\n2)\tshall not include an <mbms-service-areas> element;\n3)\tif the application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body only contains <announcement> elements that are to be cancelled, shall not include an <GPMS> element; and\n4)\tif the application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body only contains <announcement> elements that are to be cancelled, shall not include an application/sdp MIME body.\nFor each MCData client that the participating MCData function is intending to use a Multicast Signalling Key (MuSiK), the participating MCData function shall perform a key download procedure for a MuSiK and its corresponding MuSiK-ID. Two kinds of MuSiK download are possible: default MuSiK download and explicit MuSiK download. The default MuSiK download is used to set, reset or unset a MuSiK and its corresponding MuSiK-ID and is applicable to all groups supported by the MCData client, except for certain identified groups for which MuSiKs and MUSiK-IDs are assigned, reassigned or unassigned separately via explicit MuSiK download. The default MuSiK and MUSiK-ID can apply to all the MCData clients supported by the participating MCData function and can be overridden by the explicit MuSiK download which is selectively applied only to the MCData clients using the explicitly identified groups. A group subject to explicit MuSiK download, can be switched to the default MuSiK protection via a default MuSiK download identifying that group. The participating MCData function:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n2)\tshall set the Request-URI to the URI received in the To header field in a third-party SIP REGISTER request;\n3)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media-feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n4)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\";\n5)\tshall include an application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body defined in clause D.5 with the <version> element set to \"1\", and either\na)\tcontaining an <mbms-explicitMuSiK-download> element with at least one <group> element associated with the MuSiK being downloaded; or\nb)\tcontaining an <mbms-defaultMuSiK-download> element with zero or more <group> elements associated with the MuSiK being downloaded;\n6)\tif protection for the group(s) in the specified list is to be provided using the MuSiK, shall include an application/mikey MIME body with the MIKEY message containing the encrypted MuSiK and the corresponding MuSiK-ID, constructed as described in clauses 5.8.1 and 5.2.2 of 3GPP TS 33.180 [26];\nNOTE:\tClause 9.2.1.3 of 3GPP TS 33.180 [26] shows an example on how to include an application/mikey MIME body in a SIP message.\n7)\tshall send the SIP MESSAGE request towards the MCData client according to 3GPP TS 24.229 [5].\nThe participating MCData function shall consider the key download successful on receipt of a 200 OK message in response to the SIP MESSAGE request sent in step 7).\nA participating MCData function that does not receive a 200 OK message from a specific MCData client shall use unicast with that MCData client, for the groups for which the MuSiK was intended.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19.2.3\tReceiving an MBMS bearer listening status from an MCData client",
                            "text_content": "Upon receiving a \"SIP MESSAGE request for an MBMS listening status update\", the participating MCData function shall handle the request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6].\nIf the SIP MESSAGE request contains:\n1)\tan application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body with an <mbms-listening-status> element; and\n2)\tan application/vnd.3gpp.mcdata-info+xml MIME body containing an MCData ID in the <mcdata-request-uri> served by the participating MCData function;\nthen the participating MCData function:\n1)\tshall verify that the public user identity in the P-Asserted-Identity header field is bound to the MCData ID in the <mcdata-request-uri> element in the application/vnd.3gpp.mcdata-info+xml MIME body, and if that is the case:\na)\tif the <mbms-listening-status> element is set to \"listening\":\ni)\tif a <session-id> element is included, shall indicate to the media plane that the MCData client in the session identified by the <session-id> element is now listening to the MBMS subchannel; and\nii)\tif <general-purpose> element is included with the value \"true\", shall indicate to the media plane that the MCData client is now listening to the general purpose MBMS subchannel; and\nb)\tif the <mbms-listening-status> element is set to \"not-listening\":\ni)\tif a <session-id> element is included, shall indicate to the media plane that the MCData client in the sessions identified by the <session-id> elements is not listening to the MBMS subchannel;\nii)\tif <general-purpose> element is included with the value \"false\", shall indicate to the media plane that the MCData client is no longer listening to the general purpose MBMS bearer; and\niii)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15].\nNOTE 1:\tIf the MCData client reports that the MCData client is no longer listening to the general purpose MBMS subchannel it is implicitly understood that the MCData client no longer listens to any MBMS subchannel in ongoing conversations that the MCData client previously reported status \"listening\".\nIf the SIP MESSAGE request contains:\n1)\tan application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body with an <mbms-suspension-status> element; and\n2)\tan application/vnd.3gpp.mcdata-info+xml MIME body containing an MCData ID in the <mcdata-request-uri> served by the participating MCData function;\nthen the participating MCData function:\n1)\tshall verify that the public user identity in the P-Asserted-Identity header field is bound to the MCData ID in the <mcdata-request-uri> element in the application/vnd.3gpp.mcdata-info+xml MIME body, and if that is the case:\na)\tif the <mbms-suspension-status> element is set to \"suspending\":\ni)\tshall consider that the bearer identified by the <suspended-TMGI> element is about to be suspended and that the reduction or elimination of traffic on that bearer and/or on some of the bearers indicated in the <other-TMGI> elements can potentially avoid the suspension; and\nNOTE 2:\tAn MBMS bearer is about to be suspended when RAN has notified the clients of the decision to suspend the bearer, but the actual suspension, which would occur at the end of the MCCH modification period, has not taken place yet because the MCCH modification period has not yet expired.\nii)\tmay take implementation/configuration specific immediate action for the MCData client that reports the suspension as well as other MCData clients that listen to the same bearer (e.g. moving traffic to unicast bearer(s)), reducing transmission rate, eliminating traffic, modifying pre-emption priority); or\nb)\tif the <mbms-suspension-status> element is set to \"not-suspending\":\ni)\tshall consider that the bearer identified by the <suspended-TMGI> element is no longer about to be suspended; and\nNOTE 3:\tAn MBMS bearer is no longer about to be suspended when RAN has notified the clients of the decision to no longer suspend the bearer after having previously notified the clients that the bearer would be suspended at the end of the MCCH modification period. The RAN notifications to first suspend and subsequently not to suspend the same MBMS bearer would have to come within the same MCCH modification period.\nii)\tmay take implementation/configuration specific immediate action for the MCData client that reports the suspension as well as other MCData clients that listen to the same bearer (e.g. restoring traffic previously reduced or eliminated from MBMS bearers upon reception of suspension information).\nNOTE 4:\tIf the MCData client reports that the MCData client is no longer listening to MBMS subchannels associated with the MBMS bearer indicated in the suspension information, it is implicitly understood that the suspension of that MBMS bearer has actually occurred.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19.2.4\tAbnormal cases",
                            "text_content": "Upon receipt of a SIP MESSAGE request with an application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body:\n1)\twhere the P-Asserted-Identity identifies a public user identity not associated with MCData user served by the participating MCData function; or\n2)\twith an application/vnd.3gpp.mcdata-info+xml MIME body and with a <mcdata-request-uri> element containing an MCData ID that identifies an MCData user served by the participating MCData function and an application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body containing one or more <announcement> elements;\nthen the participating MCData function shall send a SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "19.3\tMCData client MBMS usage procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "19.3.1\tGeneral",
                            "text_content": "This clause describes the procedures in the MCData client for:\n1)\treceiving an MBMS bearer announcement from the participating MCData function;\n2)\tsending an MBMS bearer listening status report to the participating MCData function; and\n3)\tsending an MBMS bearer suspension status report to the participating MCData function.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19.3.2\tReceiving an MBMS bearer announcement",
                            "text_content": "The MCData client associates each received application/sdp MIME body and each received security key with a general purpose MBMS subchannel announced in the same MBMS Bearer Announcement message. When receiving a Map Group To Bearer message, the MCData client interprets its content (e.g. the m= line number) in the context of the application/sdp MIME body associated with the general purpose MBMS subchannel on which the Map Group To Bearer message was received.\nWhen the MCData client receives a SIP MESSAGE request containing:\n1)\ta P-Asserted-Service header field containing the \"urn:urn-7:3gpp-service.ims.icsi.mcdata\"; and\n2)\tan application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body containing one or more an <announcement> element(s);\nthen the MCData client for each <announcement> element in the application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body:\n1)\tif the <mbms-service-areas> element is present:\na)\tif an <announcement> element with the same value of the <TMGI> element is already stored:\ni)\tshall replace the old <announcement> element with the <announcement> element received in the application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body;\nb)\tif there is no <announcement> element with the same value of the <TMGI> element stored:\ni)\tshall store the received <announcement> element;\nc)\tshall associate the received announcement with the received application/sdp MIME body;\nd)\tshall associate the received announcement with the received <GPMS> element;\ne)\tshall store the MBMS public service identity of the participating MCData function received in the P-Asserted-Identity header field and associate the MBMS public service identity with the new <announcement> element;\nf)\tif a \"a=key-mgmt\" media-level attribute with the \"mikey\" key management and protocol identifier and a MIKEY-SAKKE I_MESSAGE is included for the general purpose MBMS subchannel defined in the \"m=application\" media line in the application/sdp MIME body in the received SIP MESSAGE request,\ni)\tshall extract the initiator URI from the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26]. If the initiator URI deviates from the public service identity of the participating MCData function serving the MCData user, shall reject the SIP MESSAGE request with a SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [45], and include warning text set to \"136 authentication of the MIKEY-SAKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nii)\tshall convert the initiator URI to a UID as described in 3GPP TS 33.180 [26];\niii)\tshall use the UID to validate the signature of the MIKEY-SAKKE I_MESSAGE as described in 3GPP TS 33.180 [26];\niv)\tif authentication verification of the MIKEY-SAKKE I_MESSAGE fails, shall reject the SIP MESSAGE request with a SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [45], and include warning text set to \"136 authentication of the MIKEY-SAKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nv)\tshall extract and decrypt the encapsulated MSCCK using the participating MCData function's (KMS provisioned) UID key as described in 3GPP TS 33.180 [26]; and\nvi)\tshall extract the MSCCK-ID, from the payload as specified in 3GPP TS 33.180 [26];\nNOTE:\tWith the MSCCK successfully shared between the participating MCData function and the served UEs, the participating MCData function is able to securely send MBMS subchannel control messages to the MCData clients.\ng)\tshall listen to the general purpose MBMS subchannel defined in the \"m=application\" media line in the application/sdp MIME body in the received SIP MESSAGE request when entering an MBMS service area where the announced MBMS bearer is available; and\nh)\tshall check the condition for sending a listening status report as specified in the clause 19.3.3; and\n2)\tif no <mbms-service-areas> element is present:\na)\tshall discard a previously stored <announcement> element identified by the value of the <TMGI>;\nb)\tshall remove the association with the stored application/sdp MIME body and stop listening to the general purpose MBMS subchannel;\nc)\tif no more <announcement> elements associated with the stored application/sdp MIME body are stored in the MCData client, shall remove the stored application/sdp MIME body; and\nd)\tcheck the condition for sending a listening status report as specified in the clause 19.3.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19.3.3\tThe MBMS bearer listening status and suspension report procedures",
                            "text_content": "If one of the following conditions is fulfilled:\n1)\tif the MCData client:\na)\treceives a Map Group To Bearer message over the general purpose MBMS channel;\nb)\tparticipates in a group session identified by the Map Group To Bearer message; and\nc)\tthe status \"listening\" is not already reported; or\n2)\tif the MCData client:\na)\treceives an announcement as described in clause 19.3.2;\nb)\tenters an MBMS service area where a general purpose MBMS is available; and\nc)\texperiences good MBMS bearer radio condition;\nthen the MCData client shall report that the MCData client is listening to the MBMS bearer as specified in clause 19.3.3.2.\nIf one of the following conditions is fulfilled:\n1)\tif the MCData client:\na)\treceives an MBMS bearer announcement as described in the clause 19.3.2;\nb)\tthe MBMS bearer announcement contains a cancellation of an <announcement> element identified by the same TGMI value as received in a Map Group To Bearer message in an ongoing conversation; and\nc)\tthe status \"not-listening\" is not already reported;\n2)\tif the MCData client:\na)\treceives an MBMS bearer announcement as described in the clause 19.3.2;\nb)\tthe MBMS bearer announcement contains a cancellation of an <announcement> element;\nc)\tdoes not participate in an ongoing conversation;\nd)\tthe MCData client has reported the \"listening\" status due to the availability of the general purpose MBMS subchannel in the <announcement> element; and\ne)\tthe status \"not-listening\" is not already reported; or\n3.\tif the MCData client:\na)\tsuffers from bad MBMS bearer radio condition,\nthen the MCData client shall report that the MCData client is not listening to the MBMS subchannels as specified in clause 19.3.3.2.\nIf all the following conditions are fulfilled:\n1)\tthe MCData client has reported \"listening\" as the most recent listening status relative to an MBMS bearer;\n2)\tthe MCData client is notified that the MBMS bearer is about to be suspended by the RAN; and\n3)\tthe MCData client has not received a MBMS bearer announcement containing a <report-suspension> element set to \"false\",\nthen the MCData client shall report that the MBMS bearer is about to be suspended, as specified in clause 19.3.3.2.\nIf all the following conditions are fulfilled:\n1)\tthe MCData client has reported \"listening\" as the most recent listening status relative to an MBMS bearer;\n2)\tthe MCData client has reported that the MBMS bearer is about to be suspended, but the suspension of the bearer has not been detected yet by the MCData client;\n3)\tthe MCData client is notified that the MBMS bearer is no longer to be suspended by the RAN; and\n4)\tthe MCData client has not received a MBMS bearer announcement containing a <report-suspension> element set to \"false\",\nthen the MCData client shall report that the MBMS bearer is no longer to be suspended, as specified in clause 19.3.3.2.\nWhen the MCData client wants to report the MBMS bearer listening status, the MCData client:\nNOTE 1:\tThe application/vnd.3gpp.mcdata-mbms-usage-info+xml can contain both the listening status \"listening\" and \"not listening\" at the same time.\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] and\na)\tshall include in the Request-URI the MBMS public service identity of the participating MCData function received in the P-Asserted-Identity header field of the announcement message;\nb)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media-feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\nc)\tshould include a public user identity in the P-Preferred-Identity header field as specified in 3GPP TS 24.229 [5];\nd)\tshall include a P-Preferred-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\";\ne)\tshall include an application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body with the <version> element set to \"1\";\nf)\tif the MCData client is listening to the MBMS bearer, the application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body:\ni)\tshall include an <mbms-listening-status> element set to \"listening\";\nii)\tif the intention is to report that the MCData client is listening to the MBMS subchannel for an ongoing conversation in a session (e.g. as the response to the Map Group To Bearer message), shall include the MCData session identity of the ongoing conversation in a <session-id> element;\niii)\tshall include one or more <TGMI> elements for which the listening status applies; and\niv)\tif the intention is to report that the MCData client is listening to the general purpose MBMS subchannel, shall include the <general-purpose> element set to \"true\";\ng)\tif the MCData client is not listening, the application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body:\ni)\tshall include an <mbms-listening-status> element set to \"not-listening\";\niii)\tshall include one or more <TGMI> elements for which the listening status applies;\niii)\tif the intention is to report that the MCData client is no longer listening to the MBMS subchannel in an ongoing session (e.g. as the response to Unmap Group to Bearer message), shall include the MCData session identity in a <session-id> element; and\niv)\tif the intention is to report that the MCData client is no longer listening to general purpose MBMS subchannel, shall include the <general-purpose> element set to \"false\"; and\nNOTE 2:\tIf the MCData client reports that the MCData client is no longer listening to the general purpose MBMS subchannel, it is implicitly understood that the MCData client no longer listens to any MBMS subchannel in ongoing conversations that the MCData client previously reported status \"listening\".\nh)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdata-request-uri> set to the MCData ID; and\n2)\tshall send the SIP MESSAGE request according to 3GPP TS 24.229 [5].\nWhen the MCData client meets all the conditions specified in clause 19.3.3.1 for reporting a change in an MBMS bearer suspension status, the MCData client:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] and\na)\tshall include in the Request-URI the MBMS public service identity of the participating MCData function received in the P-Asserted-Identity header field of the announcement message;\nb)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media-feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\nc)\tshould include a public user identity in the P-Preferred-Identity header field as specified in 3GPP TS 24.229 [5];\nd)\tshall include a P-Preferred-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\";\ne)\tshall include an application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body with the <version> element set to \"1\";\nf)\tif at least one MBMS bearer is about to be suspended, the application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body:\ni)\tshall include an <mbms-suspension-status> element set to \"suspending\";\nii)\tshall set the <number-of-reported-bearers> element to the total number of the included <suspended-TMGI> elements and <other-TMGI> elements;\niii)\tshall include <suspended-TMGI> element(s) set to the TMGI value for each of the MTCHs on the same MCH corresponding to the MBMS bearers about to be suspended; and\niv)\tmay include <other-TMGI> elements, if available, corresponding to the TMGI values for other MTCHs on the same MCH as the MBMS bearers to be suspended\nNOTE 3:\tTo report the suspension of MTCHs on different MCHs, the MCData client sends a separate message for each of the involved MCHs.\ng)\tif the MBMS bearer is no longer about to be suspended, the application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body:\ni)\tshall include an <mbms-suspension-status> element set to \"not-suspending\";\nii)\tshall set the <number-of-reported-bearers> element to the number of included <suspended-TMGI> elements; and\niii)\tshall include a <suspended-TMGI> element set to the corresponding TMGI value for each of the MTCHs of the MBMS bearers that are no longer about to be suspended; and\nh)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdata-request-uri> set to the MCData ID; and\n2)\tshall send the SIP MESSAGE request according to 3GPP TS 24.229 [5].\nNOTE 4:\tThe MCData client reports in separate messages the MBMS bearers that are about to be suspended and the MBMS bearers that are no longer about to be suspended.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19.3.4\tReceiving a MuSiK download message",
                            "text_content": "When the MCData client receives a SIP MESSAGE request containing:\n1)\ta P-Asserted-Service header field containing the \"urn:urn-7:3gpp-service.ims.icsi.mcdata\"; and\n2)\twith one of the following:\na)\tan application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body containing an <mbms-explicitMuSiK-download> element with at least one <group> subelement; or\nb)\tan application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body containing an <mbms-defaultMuSiK-download> element with zero or more <group> subelements;\nthe MCData client shall:\n1)\tif the received message contains an <mbms-explicitMuSiK-download> element, set the impacted groups to be those groups identified by the <group> subelements;\n2)\tif the received message contains an <mbms-defaultMuSiK-download> element without <group> subelements, set the impacted groups to be all groups not associated with currently valid explicit MuSiK downloads; and\n3)\tif the received message contains an <mbms-defaultMuSiK-download> element with <group> subelements, first dissociate those groups identified by the <group> subelements from currently valid associations with explicit MuSiK downloads and then set the impacted groups to be all groups not associated with currently valid explicit MuSiK downloads.\nIf the key identifier within the CSB-ID of the MIKEY payload is a MuSiK-ID (4 most-significant bits have the value '6'), the MCData client:\n1)\tshall process the MIKEY payload according to 3GPP TS 33.180 [26], as follows:\na)\tif the initiator field (IDRi) has type 'URI' (identity hiding is not used), the client:\ni)\tshall extract the initiator URI from the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26]. If the initiator URI deviates from the public service identity of the participating MCData function serving the MCData client, shall reject the SIP MESSAGE request by sending a SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [45], and including warning text set to \"136 authentication of the MIKEY-SAKKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps; and\nii)\tshall convert the initiator URI to a UID as described in 3GPP TS 33.180 [26];\nb)\totherwise, if the initiator field (IDRi) has type 'UID' (identity hiding in use), the client:\ni)\tshall convert the public service identity of participating MCData function serving the MCData user to a UID as described in 3GPP TS 33.180 [26]; and\nii)\tshall compare the generated UID with the UID in the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [26]. If the two initiator UIDs deviate from each other, shall reject the SIP MESSAGE request by sending a SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [45], and including warning text set to \"136 authentication of the MIKEY-SAKKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nc)\totherwise, shall reject the SIP MESSAGE request by sending a SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [45], and including warning text set to \"136 authentication of the MIKEY-SAKKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nd)\tshall use the UID to validate the signature of the I_MESSAGE as described in 3GPP TS 33.180 [26];\ne)\tif authentication verification of the I_MESSAGE fails or the I_MESSAGE does not contain a Status attribute, shall reject the SIP MESSAGE request by sending SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [45], and including warning text set to \"136 authentication of the MIKEY-SAKKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps; and\nf)\tshall examine the Status attribute and shall either mark the associated security functions as \"not in use\" or shall extract and store the encapsulated MuSiK and the corresponding MuSiK-ID from the payload as specified in 3GPP TS 33.180 [26]; and\n2)\tfor each of the impacted groups, shall either associate the status 'security not in use' or shall add/replace in the storage associated with the group the MuSiK-ID and the MuSiK, for use (decrypted) as security key.\nNOTE:\tIt is expected that the MCData client is capable of storing a different MuSiK for each MCData group of interest.\nThe MCData client shall respond with SIP 200 OK only if it finds the message syntactically correct and recognizes it as a valid and error-free MuSiK download (default or explicit) message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "19A\tUse of 5G MBS transmission (on-network)",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "19A.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes the participating MCData function and the MCData client procedure for:\n1)\tMBS session announcement;\n2)\tMBS listening status report;\n3)\tUE session join notification; and\n4)\tMBS session de-announcement.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "19A.2\tMCData client procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "19A.2.1\tGeneral",
                            "text_content": "This clause describes the procedures in the MCData client for:\n1)\treceiving an MBS session announcement from the participating MCData function;\n2)\tsending a UE session join notification to the participating MCData function;\n3)\tsending an MBS listening status report to the participating MCData function; and\n4)\tsending an MBS session de-announcement acknowledgement to the participating MCData function.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19A.2.2\tReceiving an MBS session announcement",
                            "text_content": "The participating MCData client follows the procedure in clause 19.3.2 with the terminology mapping specified in clause I.3.4.\nWhen the MCData client for each <announcement> element in the application/vnd.3gpp.mvdata-mbs-usage-info+xml MIME body:\n1)\tif the <mbs-service-areas> element is present:\na)\tif an <announcement> element with the same value of the <mbs-session-id> element is already stored:\ni)\tshall replace the old <announcement> element with the <announcement> element received in the application/vnd.3gpp.mvdata-mbs-usage-info+xml MIME body;\nb)\tif there is no <announcement> element with the same value of the <mbs-session-id> element stored:\ni)\tshall store the received <announcement> element;\nc)\tthe remaining parts in step 1) of clause 19.3.2 applies also for MBS, with the clarification that terminology mapping specified in clause I.3.4 applies.\n2)\tif no <mbs-service-areas> element is present:\na)\tshall discard a previously stored <announcement> element identified by the value of the <mbs-session-id>; and\nb)\tthe remaining parts in step 2) of clause 19.3.2 applies also for MBS,with the clarification that terminology mapping specified in clause I.3.4 applies;\n3)\tfor 5G MBS and 4G MBMS co-existence, the <eMBMS-bearer-infoType> is performed as specified in clause 19.3.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19A.2.3\tSending an MBS listening status report",
                            "text_content": "If one of the following conditions is fulfilled:\n1)\tif the MCData client:\na)\treceives an announcement as described in clause 19.3.2;\nb)\tfor multicast MBS session, sends a UE session join notification as described in clause 19.3.4;\n2.\tif the MCData client:\na)\tenters an MBS service area where a specific MBS session stream is available; and\nb)\texperiences good MBS session radio condition;,\n3.\tif the MCData client:\na)\tsuffers from bad MBS session radio condition,\nthen the MCData client shall report that the MCData client is listening to the MBS session as specified in clause 19A.2.3.2.\nWhen the MCData client wants to report the MBS listening status, the MCData client shall generate a SIP MESSAGE request as specified \"MBMS bearer listening status\" in clause 19.2.3.2 with the terminology mapping specified in clause I.3.4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19A.2.4\tReceiving a MuSiK download message",
                            "text_content": "The MCData client follows the procedure in clause 19.2.4 with the terminology mapping specified in clause I.3.4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19A.2.5\tSending a UE session join notification",
                            "text_content": "For multicast MBS sessions, if one of the following conditions is fulfilled:\n1)\tif the MCData client:\na)\treceives a Map Group To Session Stream message over the general purpose MBS channel;\nb)\tparticipates in a group session identified by the Map Group To Session Stream message; and\nc)\tthe status \"ue-session-join\" is not already reported; or\n2)\tif the MCData client:\na)\treceives an announcement as described in clause 19A.2.2;\nb)\tenters an MBS service area where a specific MBS session stream is available; and\nc)\texperiences good MBS session radio condition;\nthen the MCData client shall report that the MCData client indicates to MCData server that such MCData client wants to receive multicast data identified by a specific MBS session ID, as specified in clause 19A.2.5.2.\nFor multicast MBS sessions, if one of the following conditions is fulfilled:\n1)\tif the MCData client:\na)\treceives an MBS session announcement as described in the clause 19A.2.2;\nb)\tthe MBS session announcement contains a deletion of an <announcement> element identified by the same MBS session ID value as received in a Map Group To Session Stream message in an ongoing conversation; and\nc)\tthe status \"ue-session-leave\" is not already reported;\n2)\tif the MCData client:\na)\treceives an MBS session announcement as described in the clause 19A.2.2;\nb)\tthe MBS session announcement contains a deletion of an <announcement> element;\nc)\tdoes not participate in an ongoing conversation;\nd)\tthe MCData client has reported the \"ue-session-join\" status due to the availability of the general purpose MBS subchannel in the <announcement> element; and\ne)\tthe status \"ue-session-leave\" is not already reported; or\n3)\tif the MCData client:\na)\tsuffers from bad MBS session radio condition,\nthen the MCData client shall report that the MCData client no longer wants to receive multicast data identified by a specific MBS session ID, as specified in clause 19A.2.5.2.\nWhen the MCData client wants to send the UE session join notification, the MCData client:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [4] and IETF RFC 3428 [33] and\na)\tshall include in the Request-URI the MBS public service identity of the participating MCData function received in the P-Asserted-Identity header field of the announcement message;\nb)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media-feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mvdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [6];\nc)\tshould include a public user identity in the P-Preferred-Identity header field as specified in 3GPP TS 24.229 [4];\nd)\tshall include a P-Preferred-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mvdata\";\ne)\tshall include an application/vnd.3gpp.mvdata-mbs-usage-info+xml MIME body with the <version> element set to \"1\";\nf)\tif the MCData client is successfully joining a certain multicast MBS session procedure, the application/vnd.3gpp.mvdata-mbs-usage-info+xml MIME body:\ni)\tshall include an <mbs-multicast-joining-status> element set to \"ue-session-join\";\nii)\tif the intention is to report that the MCData client is joining a certain multicast MBS session procedure, shall include the MCData session identity of the ongoing conversation in a <session-id> element; and\niii)\tshall include one or more <mbs-session-id> elements for which the listening status applies;\ng)\tif the MCData client is not joining a certain multicast MBS session procedure, the application/vnd.3gpp.mvdata-mbs-usage-info+xml MIME body:\ni)\tshall include an <mbs-multicast-joining-status> element set to \"ue-session-leave\";\nii)\tif the intention is to report that the MCData client is not joining a certain multicast MBS session procedure, shall include the MCData session identity in a <session-id> element; and\niii)\tshall include one or more <mbs-session-id> elements for which the listening status applies;\nh)\tshall include an application/vnd.3gpp.mvdata-info+xml MIME body with the <mvdata-request-uri> set to the MCData ID; and\n2)\tshall send the SIP MESSAGE request according to 3GPP TS 24.229 [4].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19A.2.6\tSending an MBS session de-announcement acknowledgement",
                            "text_content": "When the participating MCData function indicates an acknowledgement to the MBS session de-announcement messge, the MCData client:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [11] and IETF RFC 3428 [17]; and\na)\tshall include in the Request-URI the MBS public service identity of the participating MCData function received in the P-Asserted-Identity header field of the announcement message;\nb)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media-feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mvdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [20];\nc)\tshould include a public user identity in the P-Preferred-Identity header field as specified in 3GPP TS 24.229 [11];\nd)\tshall include a P-Preferred-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mvdata\";\ne)\tshall include an application/vnd.3gpp.mvdata-mbs-usage-info+xml MIME body with the <version> element set to \"1\";\nf)\tif at least one MBS session is about to be deleted, the application/vnd.3gpp.mvdata-mbs-usage-info+xml MIME body:\ni)\tshall include an <mbs-session-de-announcement-status> element set to \"deleting\";\nii)\tshall set the <number-of-reported-sessions> element to the total number of the included <deleted-mbs-session-id> elements and <other-mbs-session-id> elements;\niii)\tshall include <deleted-mbs-session-id> element(s) set to the MBS session ID value for each of the MBS sessions about to be deleted; and\niv)\tmay include <other-mbs-session-id> elements, if available, corresponding to the MBS session ID values for other MBS sessions to be deleted;\ng)\tshall include an application/vnd.3gpp.mvdata-info+xml MIME body with the <mvdata-request-uri> set to the MCData ID of the user; and\n2)\tshall send the SIP MESSAGE request according to 3GPP TS 24.229 [11].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "19A.3\tParticipating MCData server procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "19A.3.1\tGeneral",
                            "text_content": "This clause describes the procedures in the participating MCData function for:\n1)\tsending an MBS session announcement to the MCData client;\n2)\treceiving an MBS listening status report from the MCData client;\n3)\treceiving a UE session join notification from the MCData client; and\n5)\treceiving an MBS session de-announcement acknowledgement from the MCData client.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19A.3.2\tSending an MBS session announcement to the MCData client",
                            "text_content": "The participating MCData function follows the procedure in clause 19.2.2.1 with the terminology mapping specified in clause I.3.4.\nShall generate a SIP MESSAGE request as specified in clause 19.3.2.2 with the following clarifications/exceptions.\nAll steps of clause 19.3.2.2 apply also for MBS except step 6), with the clarification that terminology mapping specified in clause I.3.4 applies.\nIn place of step 6) of clause 19.2.2.2, the following step 6) shall be used:\n6)\tshall include an application/vnd.3gpp.mcdata-mbs-usage-info+xml MIME body defined in clause D.5 with the <version> element set to \"1\" and one or more <announcement> elements associated with the pre-activated MBS sesssions. Each set of an <announcement> element:\na) in case of the MCData server is able to provide the MC services to the client over 5G MBS sessions (either broadcast or multicast), shall include <mbs-session-infoType> providing the MBS session related information:\ni)\t\tshall include an MBS session ID value in the <mbs-session-id> element;\nNOTE 1:\tThe identity of the MBS session used to deliver MC service group communication data. It is either TMGI for broadcast MBS and multicast MBS sessions, or source specific IP multicast address for multicast MBS session.\nii)\t\tshall include the <mbs-session-mode> element and set it to \"multicast\" value or the \"broadcast\" value;\niii)\tshall include a MC service group ID value in the <mc-service-group-id> element;\niv)\tif the MBS sessions is carrying the general purpose MBS subchannel, shall include one <GPMS>element, giving the number of the \"m=application\" media line in the application/sdp MIME body generated in above to be used for the general purpose MBS subchannel;\nv)\tmay include one or more MBS service area IDs in <mbs-service-area-id> elements in the <mbs-service-areas> element;\nvi)\tfor multicast MBS session, may include the <report-ue-session-join-notification> element and set it to \"true\" value or the \"false\" value;\nvii)\tmay include <multicast-mbs-session-related-info>, additional information to be used by the MC service client to join the multicast MBS session such as PLMN ID of the default PLMN service provider in case of source specific IP multicast address, DNN, and SNSSAI of the PDU session associated with the multicast MBS session;\nNOTE 2:\tSuch information may be pre-configured in the MC service UE, or provided in any other implementation specific way.\nviii)\tfor broadcast MBS session, shall include an MBS Frequency Selection Area ID value in the <mbs-fsa-id> element;\nix)\tif multiple carriers are supported, shall include the frequency to be used in the <frequency> element; and\nNOTE 3:\tIn the current release if the <frequency> element is included, the frequency in the <frequency> element is the same as the frequency used for unicast.\nx)\tmay include the <mbs-session-de-announcement-acknowledgement> element and set it to \"true\" value or the \"false\" value;\nb) in case of LTE eMBMS and 5G MBS co-existence, shall include <eMBMS-bearer-infoType> providing the 4G eMBMS bearer related information:\ni)\tmay include a list of additional alternative TMGI which may be used in roaming scenarios in the <Alternative-TMGI> element; and\nii)\tthe remaining elements are generated as specified in the clause 19.2.2.2 step 6;\nWhen the participating MCData function wants to update a previously sent announcement, the participating MCData function sends an MBS session announcement in a SIP MESSAGE request as specified in clause 19A.3.2.2 where the participating MCData function in the <announcement> element to be updated:\n1)\t<mbs-session-infoType> to be updated as specified in clause 19.2.2.3 with the terminology mapping specified in clause I.3.4; and\n2)\t<eMBMS-bearer-infoType> to be updated as specified in clause 19.2.2.3.\nWhen the participating MCData function wants to delete an MBS session announcement associated with an <announcement> element, the participating MCData function sends an MBS session announcement as specified in clause 19A.3.2.2 where the participating MCData function in the <announcement> element to be deleted:\n1)\t<mbs-session-infoType> to be deleted as specified in clause 19.2.2.4 with the terminology mapping specified in clause I.3.4; and\n2)\t<eMBMS-bearer-infoType> to be deleted as specified in clause 19.2.2.4.\nThe participating MCData function follows the procedure in clause 19.2.2.5 with the terminology mapping specified in clause I.3.4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19A.3.3\tReceiving an MBS listening status report from the MCData client",
                            "text_content": "If the SIP MESSAGE request contains:\n1)\tan application/vnd.3gpp.mvdata-mbs-usage-info+xml MIME body with an <mbs-listening-status> element; and\n2)\tan application/vnd.3gpp.mvdata-info+xml MIME body containing an MCData ID in the <mvdata-request-uri> served by the participating MCData function;\nthen the participating MCData function follows the procedure \"MBMS bearer listening status\" in clause 19.3.3 with the terminology mapping specified in clause I.3.4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19A.3.4\tReceiving a UE session join notification from the MCData client",
                            "text_content": "Upon receiving a \"SIP MESSAGE request for a UE session join notification\", the participating MCData function shall handle the request in accordance with 3GPP TS 24.229 [4] and IETF RFC 3428 [33].\nIf the SIP MESSAGE request contains:\n1)\tan application/vnd.3gpp.mvdata-mbs-usage-info+xml MIME body with an <mbs-multicast-joining-status> element; and\n2)\tan application/vnd.3gpp.mvdata-info+xml MIME body containing an MCData ID in the <mvdata-request-uri> served by the participating MCData function;\nthen the participating MCData function:\n1)\tshall verify that the public user identity in the P-Asserted-Identity header field is bound to the MCDataT ID in the <mvdata-request-uri> element in the application/vnd.3gpp.mvdata-info+xml MIME body, and if that is the case:\na)\tif the <mbs-multicast-joining-status> element is set to \"ue-session-join\":\ni)\tif a <session-id> element is included, shall indicate to the media plane that the MCData client in the session identified by the <session-id> element wants to receive multicast data identified by a specific MBS session ID; and\nb)\tif the <mbs-multicast-joining-status> element is set to \"ue-session-leave\":\ni)\tif a <session-id> element is included, shall indicate to the media plane that the MCVifdeo client in the sessions identified by the <session-id> elements no longer wants to receive multicast data identified by a specific MBS session ID;\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19A.3.5\tReceiving an MBS session de-announcement from the MCData client",
                            "text_content": "If the SIP MESSAGE request contains:\n1)\tan application/vnd.3gpp.mvdata-mbs-usage-info+xml MIME body with an <mbs-session-de-announcement-status> element; and\n2)\tan application/vnd.3gpp.mvdata-info+xml MIME body containing an MCData ID in the <mvdata-request-uri> served by the participating MCData function;\nthen the participating MCData function:\n1)\tshall verify that the public user identity in the P-Asserted-Identity header field is bound to the MCData ID in the <mvdata-request-uri> element in the application/vnd.3gpp.mvdata-info+xml MIME body, and if that is the case:\na)\tif the <mbs-session-de-announcement-status> element is set to \"deleting\":\ni)\tshall consider that the MBS session identified by the <de-announcement-mbs-session-id> element is about to be deleted and that the reduction or elimination of traffic on that MBS session and/or on some of the MBS sessions indicated in the <other-mbs-session-id> elements can potentially avoid the deletion; and\nii)\tmay take implementation/configuration specific immediate action for the MCData client that reports the deletion as well as other MCData clients that listen to the same MBS session(e.g. moving traffic to unicast delivery), reducing transmission rate, eliminating traffic, modifying pre-emption priority); or\nb)\tif the <mbs-session-de-announcement-status> element is set to \"not-deleting\":\ni)\tshall consider that the MBS session identified by the <de-announcement-mbs-session-id> element is no longer about to be deleted; and\nii)\tmay take implementation/configuration specific immediate action for the MCData client that reports the deletion as well as other MCData clients that listen to the same MBS session(e.g. restoring traffic previously reduced or eliminated from MBS session upon reception of deletion information).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "20\tIP Connectivity",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "20.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes the IP Connectivity procedures between two MCData clients for on-network. Included are the procedures for MCData client procedures, participating MCData function procedures and controlling MCData function procedures.\nNOTE:\tIP Connectivity specified in the current document is not compatible with release 16.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "20.1.1\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.1.2\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.1.3\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "20.2\tMCData Client Procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "20.2.0a\tSDP offer generation",
                            "text_content": "The SDP offer shall contain one SDP media-level section for MCData including an attribute for IP Connectivity according to 3GPP TS 24.582 [15]. When composing an SDP offer the MCData client shall:\n1)\tset the IP address of the MCData client for the offered MCData IP Connectivity session; and\nNOTE:\tThe MC service operator policy determines if the MCData client can use an already assigned IP address or can request a new IP address following the procedures defined in 3GPP TS 24.301 [43].\n2)\tshall include an \"m=application\" media-level section as specified in 3GPP TS 24.582 [15] consisting of:\na)\tthe port number selected for the media plane as specified in 3GPP TS 24.582 [15] clause 13.5; and\nb)\tthe 'fmtp' attribute as specified in 3GPP TS 24.582 [15] clause 13.6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.2.0b\tSDP answer generation",
                            "text_content": "When the MCData client receives an initial SDP offer for a MCData including an attribute for IP Connectivity, the MCData client shall process the SDP offer and shall compose an SDP answer.\nWhen composing an SDP answer, the MCData client:\n1)\tshall accept the MCData media stream in the SDP offer;\n2)\tshall set the IP address of the MCData client for the accepted MCData media stream; and\nNOTE:\tThe MC service operator policy determines if the MCData client can use an already assigned IP address or can request a new IP address following the procedures defined in 3GPP TS 24.301 [43].\n3)\tshall include an \"m=application\" media-level section for the accepted MCData media stream consisting of:\na)\tthe port number selected for the media plane as specified in 3GPP TS 24.582 [15] clause 13.5; and\nb)\tthe 'fmtp' attribute as specified in 3GPP TS 24.582 [15] clause 13.6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.2.1\tMCData client originating procedures",
                            "text_content": "When a MCData client receives the request by a user or user application to establish a IP Connectivity session with another MCData client the MCData client shall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [5] with the clarifications given below. The MCData ID or the functional alias of the target MCData client may be explicitly included in the request from the user or user application. If the target MCData ID or functional alias is not included in the request, the MCData client may implicitly determine the target MCData ID by using the target IP Information included in the request to find a match in the One-to-One communication list of the MCData user profile document as specified in 3GPP TS 24.484 [12]. If the MCData ID of the target MCData client is determined implicitly by the target IP Information included in the request, the client searches in leaves below /<x>/<x>/Common/OnetoOne/UserList/<x>/Entry/IPInformation/<x>/Entry/ for a match in the IP Information. The MCData ID is given by matching the user entry.\nThe MCData client:\n1)\tshall include the g.3gpp.mcdata.ipconn  media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn \" in the Contact header field of the SIP INVITE request according to IETF RFC 3840 [16];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.ipconn media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n3)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n4)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n5)\tshould include the \"timer\" option tag in the Supported header field;\n6)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n7)\tshall insert in the SIP INVITE request an application/resource-lists+xml MIME body with the MCData ID of the invited MCData user or the functional alias in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, according to rules and procedures of IETF RFC 5366 [18];\n8)\tshall contain an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\na)\tthe <request-type> element set to a value of \"one-to-one-ipconn\"; and\nb)\tan <anyExt> element containing:\ni)\tthe <call-to-functional-alias-ind> element set to \"true\" if the functional alias is used as a target of the communication request;\nii)\tif the MCData client is aware of active functional aliases and if an active functional alias is to be included in the SIP INVITE request, the <functional-alias-URI> element set to the URI of the used functional alias; and\niii)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value;\n9)\tshall set the Request-URI of the SIP INVITE request to the public service identity identifying the participating MCData function serving the MCData user;\nNOTE 1:\tThe MCData client is configured with public service identity identifying the participating MCData function serving the MCData user.\n10)\tmay include a P-Preferred-Identity header field in the SIP INVITE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n11)\tshall include an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 20.2.0a; and\n12)\tshall send the SIP INVITE request towards the MCData server according to 3GPP TS 24.229 [5].\nOn receipt of a SIP 2xx response to the SIP INVITE request, the MCData client:\n1)\tshall send a SIP ACK request as specified in 3GPP TS 24.229 [5];\n2)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38]; and\n3)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 13.1.2.\nUpon receiving a SIP 300 (Multiple Choices) response to the SIP INVITE request the MCData client shall use the MCData ID of MCData user contained in the <mcdata-request-uri> element of the received application/vnd.3gpp.mcdata-info MIME body as the MCData ID of the invited MCData user and shall generate an initial SIP INVITE request by following the UE originating session procedures specified in 3GPP TS 24.229 [5], with the clarifications given in this clause and with the following additional clarifications:\n1)\tshall insert in the newly generated SIP INVITE request an application/resource-lists+xml MIME body with the MCData ID of the invited MCData user in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body where the MCData ID is found in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info MIME body  in the received SIP 300 (Multiple Choices) response;\n2)\tshall not include a <call-to-functional-alias-ind> element into the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\n3)\tshall include a <called-functional-alias-URI> element into the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body with the target functional alias used in the initial SIP INVITE request for the IP connectivity session establishment.\nOn receipt of a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request, the MCData client:\n1)\tshall indicate to the MCData user or user application that the IP Connectivity session could not be established; and\n2)\tshall send a SIP ACK request as specified in 3GPP TS 24.229 [5].\nOn receipt of an indication from the media plane indicating that the IP Connectivity session could not be established, the MCData client:\n1)\tshall generate a SIP BYE request according to 3GPP TS 24.229 [5] with:\na)\tReason code set to \"FAILURE_CAUSE\";\nb)\tcause set to \"1\"; and\nc)\ttext set to \"Media bearer or QoS lost\";\n2)\tshall set the Request-URI to the MCData session identity to release; and\n3)\tshall send a SIP BYE request towards MCData server according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.2.2\tMCData client terminating procedures",
                            "text_content": "Upon receipt of a SIP INVITE request for IP Connectivity session for terminating MCData client\"request, the MCData client shall follow the procedures for termination of multimedia sessions in the IM CN subsystem as specified in 3GPP TS 24.229 [5] with the clarifications below.\nThe MCData client:\n1)\tmay reject the SIP INVITE request if either of the following conditions are met:\na)\tMCData client does not have enough resources to handle the IP Connectivity session; or\nb)\tany other reason outside the scope of this specification;\n2)\tif the SIP INVITE request is rejected in step 1), shall respond toward participating MCData function either with appropriate reject code as specified in 3GPP TS 24.229 [5] and warning texts as specified in clause 4.9 or with SIP 480 (Temporarily unavailable) response not including warning texts if the user is authorised to restrict the reason for failure and skip the rest of the steps of this clause;\n3)\tmay provide to the MCData user or user application the MCData ID of the inviting MCData user;\n3A)\tmay display to the MCData user the functional alias of the inviting MCData user, if provided;\n3B)\tmay display to the MCData user the functional alias used in the initial communication request, if provided;\n4)\tshall accept the SIP INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\n5)\tshall include the option tag \"timer\" in a Require header field of the SIP 200 (OK) response;\n6)\tshall include the Session-Expires header field in the SIP 200 (OK) response and start the SIP session timer according to IETF RFC 4028 [38]. The \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\n7)\tshall include the g.3gpp.mcdata.ipconn media feature tag in the Contact header field of the SIP 200 (OK) response;\n8)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\" in the Contact header field of the SIP 200 (OK) response;\n9)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5] with the clarifications given in clause 20.2.0b; and\n10)\tshall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5].\nOn receipt of an SIP ACK message to the sent SIP 200 (OK) message, the MCData client:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 13.1.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "20.3\tParticipating MCData function procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "20.3.0a\tSDP offer generation",
                            "text_content": "The SDP offer is generated based on the received SDP offer. The SDP offer generated by the participating MCData function:\n1)\tshall contain only one SDP media-level section including an attribute for IP Connectivity as contained in the received SDP offer.\nWhen composing the SDP offer the participating MCData function:\n1)\tshall replace the IP address and port number for the offered media stream in the received SDP offer with the IP address and port number of the participating MCData function, if required.\nNOTE:\tRequirements can exist for the participating MCData function to be always included in the path of the offered media stream, for example: for the support of features such as lawful interception and recording, considering routability of IP addresses. Other examples can exist.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.3.0b\tSDP answer generation",
                            "text_content": "The SDP answer is generated based on the received SDP answer. When composing the SDP answer the participating MCData function:\n1)\tshall replace the IP address and port number in the received SDP answer with the IP address and port number of the participating MCData function, if required; and\nNOTE:\tRequirements can exist for the participating MCData function to be always included in the path of the offered media stream, for example: for the support of features such as lawful interception and recording, considering routability of IP addresses. Other examples can exist.\n2)\tshall include an ‘fmtp’ attribute as specified in 3GPP TS 24.582 [15] clause 13.6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.3.1\tOriginating participating MCData function procedures",
                            "text_content": "Upon receipt of a \"SIP INVITE request for IP Connectivity session for originating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall determine the MCData ID of the calling user from the public user identity in the P-Asserted-Identity header field of the SIP INVITE request, and shall authorise the calling user;\nNOTE 1:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP INVITE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is:\na)\tset to a value of \"one-to-one-ipconn\", shall determine the public service identity of the controlling MCData function hosting the one-to-one IP Connectivity service for the calling user.\n5)\tif unable to identify the controlling MCData function for IP Connectivity session, shall reject the SIP INVITE request with a SIP 404 (Not Found) response with the warning text \"142 unable to determine the controlling function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n6)\tshall determine whether the MCData user identified by the MCData ID is authorised for MCData communications by following the procedures in clause 11.1;\n7)\tif the procedures in clause 11.1 indicate that the user identified by the MCData ID is not allowed to initiate MCData communications, shall reject the \"SIP INVITE request for IP Connectivity session for originating participating MCData function\" with a SIP 403 (Forbidden) response to the SIP INVITE request, with warning text set to \"200 user not authorised to transmit data\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps in this clause;\n8)\tshall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [5];\n9)\tshall include the option tag \"timer\" in the Supported header field;\n10)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n11)\tshall set the Request-URI of the outgoing SIP INVITE request to the public service identity of the controlling MCData function as determined by step 4) in this clause;\nNOTE 2:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 5:\tHow the participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 6:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.12)\tshall include the MCData ID of the originating user in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP INVITE request;\n13)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP INVITE request;\n14)\tshall include a P-Asserted-Identity header field in the outgoing SIP INVITE request set to the public service identity of the participating MCData function;\n15)\tshall include an SDP offer according to 3GPP TS 24.229 [5] based on the clause  20.3.0a;\n16)\tif the received SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body that contains a <functional-alias-URI> element, shall check if the status of the functional alias is activated for the MCData ID. If the functional alias status is activated, then the participating MCData function shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request to the received value, otherwise shall not include a <functional-alias-URI> element; and\n17)\tshall send the SIP INVITE request as specified to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the SIP INVITE request in step 16):\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n2)\tshall include the option tag \"timer\" in a Require header field;\n3)\tshall include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If the \"refresher\" parameter is not included in the received request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uac\";\n4)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.ipconn media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\"; and\nc)\tthe isfocus media feature tag;\n5)\tshall include Warning header field(s) that were received in the incoming SIP 200 (OK) response;\n6)\tshall include an MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP 200 (OK) response;\n7)\tif the incoming SIP 200 (OK) response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response.\n8)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function; and\n9)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15];\n10)\tshall include in the SIP 200 (OK) response an SDP answer as specified in the clause 20.3.0b;\n11)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5]; and\n12)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the SIP INVITE request in step 15) the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.3.2\tTerminating participating MCData function procedures",
                            "text_content": "Upon receipt of a \"SIP INVITE request for IP Connectivity session for terminating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall check the presence of the isfocus media feature tag in the URI of the Contact header field and if it is not present then the participating MCData function shall reject the request with a SIP 403 (Forbidden) response with the warning text set to \"104 isfocus not assigned\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\n3)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request to retrieve the binding between the MCData ID and public user identity of the terminating MCData user;\n4)\tif the binding between the MCData ID and public user identity of the terminating MCData user does not exist, then the participating MCData function shall reject the SIP INVITE request with a SIP 404 (Not Found) response, and shall not continue with the rest of the steps;\n5)\tshall generate a SIP INVITE request accordance with 3GPP TS 24.229 [5];\n6)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n7)\tshall include the option tag \"timer\" in the Supported header field;\n8)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.ipconn media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\";\nc)\tthe isfocus media feature tag;\nd)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the incoming SIP INVITE request; and\ne)\tany other uri-parameter provided in the Contact header field of the incoming SIP INVITE request;\n9)\tshall include in the SIP INVITE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP INVITE request;\n10)\tshall set the Request-URI of the outgoing SIP INVITE request to the public user identity associated to the MCData ID of the terminating MCData user;\n11)\tshall populate the outgoing SIP INVITE request with the MIME bodies that were present in the incoming SIP INVITE request;\n12)\tshall include a P-Asserted-Identity header field in the outgoing SIP INVITE request set to the public service identity of the participating MCData function;\n13)\tshall include in the SIP INVITE request an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 20.3.0a; and\n14)\tshall send the SIP INVITE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n2)\tshall include the option tag \"timer\" in a Require header field;\n3)\tshall include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If no \"refresher\" parameter was included in the SIP INVITE request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\n4)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.ipconn media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\"; and\nc)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP INVITE request from the controlling MCData function;\n5)\tif the incoming SIP response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response.\n6)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function;\n7)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\n8)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15];\n9)\tshall include in the SIP 200 (OK) response an SDP answer based on the SDP answer in the received SIP 200 (OK) response as specified in clause 20.3.0b; and\n10)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the controlling MCData function according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "20.4\tControlling MCData function procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "20.4.0a\tSDP offer generation",
                            "text_content": "The SDP offer is generated based on the received SDP offer. The SDP offer generated by the controlling MCData function:\n1)\tthe SDP offer shall contain only one SDP media-level section including an attribute for MCData IP Connectivity media stream as contained in the received SDP offer.\nWhen composing the SDP offer the controlling MCData function:\n1)\tshall replace the IP address and port number for the offered media stream in the received SDP offer with the IP address and port number of the controlling MCData function., if required\nNOTE:\tRequirements can exist for the controlling MCData function to be always included in the path of the offered media stream, for example: for the support of features such as lawful interception and recording, to consider routability of IP addresses, inclusion of the media distribution function in the media stream, for group communication. Other examples can exist.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.4.0b\tSDP answer generation",
                            "text_content": "The SDP answer is generated based on the received SDP answer. When composing the SDP answer the controlling MCData function:\n1)\tfor the accepted media stream in the received SDP offer:\na)\tshall replace the IP address and port number in the received SDP offer with the IP address and port number of  the IP address and port number of the controlling MCData function, if required; and\nNOTE:\tRequirements can exist for the controlling MCData function to be always included in the path of the offered media stream, for example: for the support of features such as lawful interception and recording, to consider routability of IP addresses, inclusion of the media distribution function in the media stream, for group communication. Other examples can exist.\nb)\tshall include an 'fmtp' attribute as specified in 3GPP TS 24.582 [15] clause 13.6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.4.1\tOriginating procedures",
                            "text_content": "This clause describes the procedures for inviting an MCData client to an MCData session. The procedure is initiated by the controlling MCData function as the result of an action in clause 20.4.2.\nThe controlling MCData function:\n1)\tshall generate a SIP INVITE request according to 3GPP TS 24.229 [5];\n2)\tshall include the Supported header field set to \"timer\";\n3)\tshould include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38]. The refresher parameter shall be omitted;\n4)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.ipconn media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n5)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n6)\tshall include a Referred-By header field with the public user identity of the inviting MCData client;\n7)\tshall include in the Contact header field an MCData session identity for the MCData session with the g.3gpp.mcdata.ipconn media feature tag, the isfocus media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\" according to IETF RFC 3840 [16];\n8)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request:\na)\tthe <mcdata-request-uri> element set to the MCData ID of the terminating user; and\n9)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated to the MCData user to be invited;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n10)\tshall set the P-Asserted-Identity header field to the public service identity of the controlling MCData function;\n11)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n12)\tshall include in the SIP INVITE request an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 20.4.0a; and\n13)\tshall send the SIP INVITE request towards the terminating client in accordance with 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response for the SIP INVITE request the controlling MCData function:\n1)\tshall interact with the media plane as specified in 3GPP  TS  24.582  [15].\nNOTE 6:\tThe procedures executed by the controlling MCData function prior to sending a response to the inviting MCData client are specified in clause 20.4.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.4.2\tTerminating procedures",
                            "text_content": "In the procedures in this clause:\n1)\tMCData ID in an incoming SIP INVITE request refers to the MCData ID of the originating user from the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request;\n2)\tMCData ID in an outgoing SIP INVITE request refers to the MCData ID of the called user in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP INVITE request.\nUpon receipt of a \"SIP INVITE request for controlling MCData function for IP Connectivity session\", the controlling MCData function:\n1)\tif unable to process the request may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if:\na)\tan Accept-Contact header field does not include the g.3gpp.mcdata.ipconn media feature tag; or\nb)\tan Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\";\n3)\tshall cache SIP feature tags, if received in the Contact header field and if the specific feature tags are supported;\n4)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\n5)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP INVITE request is set to a value of \"one-to-one-ipconn\" and the SIP INVITE request:\na)\tdoes not contain an application/resource-lists+xml MIME body or contains an application/resource-lists+xml MIME body with more than one <entry> element in the set of <list> elements in the <resource-lists> element, shall return a SIP 403 (Forbidden) response with the warning text set to \"227 unable to determine targeted user for one-to-one IP Connectivity\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps below;\na1)\tcontains an <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element of an application/vnd.3gpp.mcdata-info+xml MIME body with a <call-to-functional-alias-ind> element set to a value of \"true\":\ni)\tshall identify the MCData ID(s) of the MCData user(s) that have activated the called functional alias received in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the SIP INVITE request by performing the actions specified in clause 22.2.2.2.8, and:\nA)\tif unable to determine any MCData ID that has activated the called functional alias received in the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the SIP INVITE, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response including warning text set to \"145 unable to determine called party\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps; and\nB)\tshall select one of the identified MCData IDs, and shall send a SIP 300 (Multiple Choices) response to the SIP INVITE request populated according to 3GPP TS 24.229 [5], IETF RFC 3261 [4] with:\nI)\ta Contact header field containing a SIP URI for the MCData session identity; and\nII)\tan application/vnd.3gpp.mcdata-info MIME body with a <mcdata-request-uri> element set to the selected MCData ID  and shall not continue with the rest of the steps in this clause;\nNOTE:\tHow the controlling MCData function selects the appropriate MCData ID is implementation-specific.\nb)\tcontains an application/resource-lists+xml MIME body with exactly one <entry> element in the set of <list> elements in the <resource-lists> element, shall invite the MCData user identified by the \"uri\" attribute of the <entry> element of the <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body, as specified in clause 20.4.1; and\nc)\tcan interact with the media plane, in case routing or transmission control is necessary.\nUpon receiving a SIP 200 (OK) response for a SIP INVITE request as specified in clause 20.4.1 and if the MCData ID in the SIP 200 (OK) response matches to the MCData ID in the corresponding SIP INVITE request, the controlling MCData function:\n1)\tshall invoke the procedure in clause 6.3.7.1.23 with an indication that the applicable MCData subservice is IP Connectivity, in order to generate a SIP 200 (OK) response to the received SIP INVITE request according to 3GPP TS 24.229 [5]; and\n2)\tshall send the generated SIP 200 (OK) response to the inviting MCData client according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "21\tMCData Message Store",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "21.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause defines procedures for communication between the MCData message store client and the MCData message store function as well as the MCData server and the MCData message store function as specified in clause 7.13.3 of 3GPP TS 23.282 [2].\nAdditionally, this clause defines procedures for communication between the Message notification client and the MCData notification server as well as the MCData message store function and the MCData notification server as specified in clause 7.13.3 of 3GPP TS 23.282[2].\nThe communication between the MCData message store client and the MCData message store function as well as between the Message notification client and the MCData notification server shall use HTTP over TLS as specified in annex A of 3GPP TS 24.482 [24].\nThe hostname of the MCData message store is configured in the MCData user profile configuration document as specified in clause 10.3 of 3GPP TS 24.484 [12].\nThe hostname of the MCData notification server is configured in the MCData service configuration document as specified in clause 10.4 of 3GPP TS 24.484 [12].\nThe MCData message store function shall act as an HTTP server as defined in annex A of 3GPP TS 24.482 [24].\nThe MCData message store client and the Message notification client in the role of an HTTP client shall include the MCData access token (with the \"Bearer\" authentication scheme) in the Authorization header field of an HTTP request as specified in 3GPP TS 24.482 [24].\nThe HTTP server (i.e. the MCData message store and the MCData notification server) shall validate the MCData access token as specified in 3GPP TS 24.482 [24].\nNOTE 1:\tIn procedures for communication between the MCData message store client and the MCData message store function as well as communication between the Message notification client and the MCData notification server, the MCData ID which is the identity of the MCData user is part of MCData access token as specified in 3GPP TS 24.482 [24]. Additionally, the MCData ID can be used as the value for userId variable while generating the HTTP request URL.\nNOTE 1A:\tIn procedures for communication between MCData server and MCData message store function, the MCData ID which is the identity of the MCData user is used as the value of the resource URL variable, \"boxId\" as specified in clause 5.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nThe interface between the MCData message store client and the MCData message store function (i.e. MCData-7) as well as the interface between the MCData server and the MCData message store function (i.e. MCData-8) shall be based on the RESTful API as specified in OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nThe interface between the Message notification client and the MCData notification server (i.e. MCData-10) shall be based on the RESTful API as specified in OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76].\nthe MCData message store function uses HTTP POST method to push notifications to the MCData notification server (i.e. MCData-11) at a CallBack URL provided by the MCData message store client during notification subscription creation procedure (as defined in the following clauses).\nThe HTTP communications (i.e. RESTful API invocations) between the MCData server and the MCData message store function (i.e. MCData-8) as well as between the MCData message store function and the MCData notification server (i.e. MCData-11) are authenticated/authorizated as per security mechanisms described in 3GPP TS 33.180 [26].\nNOTE 2:\tProcedures defined for communication between the MCData message store client and the MCData message store function as well as the MCData server and the MCData message store function in the following sections reference clause 6 \"Detailed specification of the resources\" of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]. Additional information related to RESTful resources, data types and sequence diagrams are found in clause 5 and JSON examples in appendix D of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nNOTE 3:\tProcedures defined for communication between the Message notification client and the MCData notification server in the following sections reference clause 6 \"Detailed specification of the resources\" of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76]. Additional information related to RESTful resources, data types and sequence diagrams are found in clause 5 and JSON examples in appendix D of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "21.2\tMCData message store functions and client procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "21.2.1\tObject retrieval procedure",
                            "text_content": "To retrieve the object from MCData message store, the message store client, acting as an HTTP client shall follow the procedure described in clause 6.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP GET request as specified in clause 6.2.3 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\na)\tshall set the Host header field to a hostname identifying the message store function\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\nc)\tshall send the HTTP GET request towards the message store function.\nUpon receipt of an HTTP response, the message store client shall follow the procedure as described in clause 6.2.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP GET request from the client, as per clause 21.2.1.1, with the Request-URI identifying a resource in the MCData message store, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP GET request by following the procedures described in clause 6.2.3 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]; and\n3)\tshall generate and send an HTTP response towards the message store client indicating the result of the operation (e.g. if the object identified by the Request URI was successfully found, it is returned in the HTTP response).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.2\tObject search procedure",
                            "text_content": "To search for information about a selected set of objects in the MCData message store, the message store client, acting as an HTTP client shall follow the procedure described in clause 6.8 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP POST request as specified in clause 6.8.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\nc)\tshall send the HTTP POST request, which includes a \"SelectionCriteria\" data structure, towards the message store function.\nUpon receipt of an HTTP response, the message store client shall follow the procedure as describe in clause 6.8.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP POST request from the client, as per clause 21.2.2.1, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request by following the procedures described in clause 6.8.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]; and\n3)\tshall generate and send an HTTP response, containing the objects matching the SelectionCriteria, towards the message store client.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.3\tUpdate object(s) procedure",
                            "text_content": "To update object(s) in the MCData message store, the message store client, acting as an HTTP client, shall either follow the procedure described in clause 6.3 or 6.4, for individual object update, or 6.11 for bulk update of objects, of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall either generate an HTTP PUT request as specified in clause 6.3.4, 6.4.4, for individual object update, or an HTTP POST request, as specified in clause 6.11.5, for bulk update of objects, of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66], as follows:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\nc)\tshall send the HTTP PUT request, for individual object update, or the HTTP POST request, for bulk update of objects, towards the message store function.\nUpon receipt of an HTTP response, the message store client shall either follow the procedure as described in clause 6.3.2, 6.4.2 for individual object update response, or clause 6.11.2 for bulk update of objects response, of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP PUT or the HTTP POST request from the client, as per clause 21.2.3.1, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tif the received request is an HTTP PUT, shall process the HTTP PUT request for individual object update by following the procedure described in clauses 6.3.2 or 6.4.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]; and\nb)\tif the received request is an HTTP POST, shall process the HTTP POST request by following the procedure described in clause 6.11.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] for bulk update of objects; and\n3)\tshall generate and send an HTTP response towards the message store client indicating the result of the update operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.4\tDelete stored object(s) procedure",
                            "text_content": "To delete object(s) in the MCData message store, the message store client, acting as an HTTP client, shall either follow the procedure described in clause 6.2, for individual object delete, or clause 6.12 for bulk delete of objects, of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall either generate an HTTP DELETE request as specified in clause 6.2.6, for individual object delete, or an HTTP POST request as specified in clause 6.12.6, for bulk delete of objects, of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66], as follows:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\nc)\tshall send the HTTP DELETE request, for individual object delete, or the HTTP POST request, for bulk delete of objects, towards the message store function.\nUpon receipt of an HTTP response, the message store client shall either follow the procedure as described in clause 6.2.2, for individual object delete response, or clause 6.12.2, for bulk delete of objects response, of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP DELETE or the HTTP POST request from the client, as per clause 21.2.4.1, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tif the received request is an HTTP DELETE, shall process the HTTP DELETE request for individual object delete by following the procedure described in clause 6.2.6 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]; and\nb)\tif the received request is an HTTP POST, shall process the HTTP POST request by following the procedure specified in clause 6.12.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] for bulk delete of objects; and\n3)\tshall generate and send an HTTP response towards the message store client indicating the result of the delete procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.5\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.5A\tDeposit an object procedure",
                            "text_content": "To deposit an object of an MCData user in the MCData message store, the MCData server acting as an HTTP client shall follow the procedure described in clause 6.1 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP POST request as specified in clause 6.1.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall set the boxId of the resource URL as specified in clause 6.1.1 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] to MCData ID which is the identity of the MCData user;\nc)\tshall include a valid access token in the HTTP Authorization header as described in 3GPP TS 33.180 [26]; and\nd)\tmay include the query parameter \"retrieveFile\" in the Request URI with its value set to:\ni)\t\"No\" if the MCData store is not required to retrieve the file from MCData content server; or\nii)\t\"Yes\" if the MCData store is required to retrieve the file from MCData content server and to store it locally in the MCData message store; and\nNOTE:\tIncluding the retrieveFile query parameter with the value \"Yes\" is the same as if the retrieveFile query parameter is absent.\n2)\tshall send the HTTP POST request towards the message store function.\nUpon receipt of an HTTP response, the MCData server shall follow the procedure described in clause 6.1.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP POST request from MCData server, as per clause 21.2.5A.1, with a Request-URI identifying a resource on the MCData message store, the message store function acting as an HTTP server:\n1)\tshall validate the access token received in the Authorization header of the request as specified in 3GPP TS 33.180 [26];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request by following the procedures described in clause 6.1.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]; with the following clarification:\ni)\tif the query parameter \"retrieveFile\" is set to \"Yes\" or if it is absent from the request URI, the message store function shall retrieve the file pointed to by the object's payloadPart URL(carried within the HTTP POST request body), store the file in the user's message storage area and update the object's payloadPart URL accordingly; and\n3)\tshall generate and send the HTTP response towards the MCData server indicating the result of the deposit an object operation as per clause 6.1.2 of the OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.6\tObject and folder copy procedure",
                            "text_content": "To copy object(s) and/or folder(s) to a destination folder in the MCData message store, the message store client, acting as an HTTP client, shall follow the procedure described in clause 6.18 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP POST request as specified in clause 6.18.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] with following clarifications:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\nc)\tshall send the HTTP POST request identifying the target folder and the source objects(s) and/or folder(s) for copying operation towards the message store function.\nUpon receipt of an HTTP response, the message store client should follow the procedure as described in clause 6.18.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP POST from the client, as per clause 21.2.6.1, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request by following the procedures described in clause 6.18.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] and copy to the target folder the requested source object(s) and/or folders(s); and\n3)\tshall generate and send a HTTP response towards the message store client indicating the result of the operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.7\tDeleting a folder procedure",
                            "text_content": "To delete a folder in the MCData message store using the message store function, the message store client, acting as an HTTP client shall follow the procedure described in clause 6.14 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP DELETE request as specified in clause 6.14.6 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\nc)\tshall send the HTTP DELETE request identifying the folder to be deleted towards the message store function.\nUpon receipt of an HTTP response, the message store client should follow the procedure as described in clause 6.14.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP DELETE request from the client, as per clause 21.2.7.1, with the Request-URI identifying the folder in the message store to be deleted, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP DELETE request by following the procedures described in clause 6.14.6 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]; and\n3)\tshall generate and send an HTTP response towards the message store client indicating the result of the operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.8\tCreate a folder procedure",
                            "text_content": "To create a folder in the MCData message store using the message store function, the message store client, acting as an HTTP client shall follow the procedure described in clause 6.13 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP POST request as specified in clause 6.13.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\nc)\tshall send towards the message store function the HTTP POST request identifying the target folder where the new folder is to be created.\nUpon receipt of a HTTP response, the message store client should follow the procedure as described in clause 6.13.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP POST request from the client, as per clause 21.2.8.1, identifying the new folder to be created, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request by following the procedures described in clause 6.13.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] and create the requested folder; and\n3)\tshall generate and send an HTTP response towards the message store client indicating the result of the operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.9\tvoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.10\tMoving object(s) and folder(s) procedure",
                            "text_content": "To move object(s) and/or folder(s) to a destination folder in the MCData message store, the message store client, acting as an HTTP client shall follow the procedure described in clause 6.19 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP POST request as specified in clause 6.19.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\nc)\tshall send the HTTP POST request, identifying source objects and/or folder(s) to be moved to the designated destination folder, towards the message store function.\nUpon receipt of a HTTP response, the message store client shall follow the procedure as described in clause 6.19.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP POST request from the client, as per clause 21.2.10.1, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request by following the procedures described in clause 6.19.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] and perform the move operation; and\n3)\tshall generate and send an HTTP response towards the message store client indicating the result of the operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.11\tFolder search procedure",
                            "text_content": "To search for information about a selected set of folder(s) in the MCData message store, the message store client, acting as an HTTP client shall follow the procedure described in clause 6.16 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP POST request as specified in clause 6.16.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\nc)\tshall send the HTTP POST request, which includes a \"SelectionCriteria\" data structure, towards the message store function.\nUpon receipt of a HTTP response, the message store client should follow the procedure as described in clause 6.16.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP POST request from the client, as per clause 21.2.11.1, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request by following the procedures described in clause 6.16.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]; and\n3)\tshall generate and send an HTTP response, containing the folders matching the SelectionCriteria, towards the message store client.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.12\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.12A\tCreate a subscription to notifications procedure",
                            "text_content": "In order for the message store client to keep its local store in sync with the MCData message store, it needs to receive notifications about changes in the message store. For this purpose, the message store client would need to subscribe to notification from the message store. Synchronization using subscriptions and notifications is described in clause 5.1.5.1 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nTo create a subscription to notifications about changes in the message store using the message store function, the message store client, acting as an HTTP client shall follow the procedure described in clause 6.20 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP POST request as specified in clause 6.20.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\na)\tshall set the Host header field to a hostname identifying the message store function; and\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\n2)\tshall send the HTTP POST request towards the message store function.\nUpon receipt of an HTTP response, the message store client should follow the procedure as described in clause 6.20.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP POST request from the client, as per clause 21.2.12.1, with a Request-URI identifying a resource on the message store, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request by following the procedures described in clause 6.20.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] and create the requested subscription; and\n3)\tshall generate and send an HTTP response towards the message store client indicating the result of the operation as per clause 6.20.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.13\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.13A\tDelete a subscription to notifications procedure",
                            "text_content": "To delete / cancel a subscription and stop corresponding notifications about changes in the MCData message store using the message store function, the message store client, acting as an HTTP client shall follow the procedure described in clause 6.21 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP DELETE request as specified in clause 6.21.6 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\na)\tshall set the Host header field to a hostname identifying the message store function; and\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\n2)\tshall send the HTTP DELETE request identifying the subscription to be deleted towards the message store function.\nUpon receipt of an HTTP response, the message store client should follow the procedure as described in clause 6.21.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP DELETE request from the client, as per clause 21.2.13.1, with a Request-URI identifying the subscription resource on the message store, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP DELETE request by following the procedures described in clause 6.21.6 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] and delete the requested subscription; and\n3)\tshall generate and send an HTTP response towards the message store client indicating the result of the operation as per clause 6.21.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.14\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.14A\tUpdate a subscription to notifications procedure",
                            "text_content": "A client may update its subscription to notification in order to:\n1)\textend the life of the subscription;\n2)\trestart the notification stream from where it left off.\nSynchronization using subscriptions and notifications is described in clause 5.1.5.1 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]\nTo update a subscription to notifications about changes in the MCData message store using the message store function, the message store client, acting as an HTTP client shall follow the procedure described in clause 6.21 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP POST request as specified in clause 6.21.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\n2)\tshall send the HTTP POST request towards the message store function.\nUpon receipt of an HTTP response, the message store client should follow the procedure described in clause 6.21.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP POST request from the client, as per bclause 21.2.14A.1, with a Request-URI identifying a subscription resource on the message store, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request by following the procedures described in clause 6.21.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] and update the requested subscription; and\n3)\tshall generate and send an HTTP response towards the message store client indicating the result of the operation as per clause 6.21.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.15\tObject(s) upload procedure",
                            "text_content": "To upload the object(s) to the MCData message store, the message store client acting as an HTTP client, shall either follow the procedure described in clause 6.1 for single upload or clause 6.10 for bulk upload of objects as specified in the OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP POST request as specified in either clause 6.1.5 or 6.10.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] depending on a single object upload or bulk upload of objects as follows:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\nc)\tshall send the HTTP POST request towards the message store function.\nUpon receipt of an HTTP response, the message store client shall follow the procedure as described in clause 6.1.2 for single upload or 6.10.2 for bulk upload as specified in the OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP POST request from the client, as per clause 21.2.15.1, with a Request-URI identifying a resource on the MCData message store, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request by following the procedures described in either clause 6.1.5 or 6.10.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] depending on a single object upload or bulk upload of objects; and\n3)\tshall generate and send an HTTP response towards the message store client indicating the result of the upload operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.16\tSynchronization notifications procedure",
                            "text_content": "To send notifications about changes in the MCData message store using the message store function, the MCData message store, acting as an HTTP client shall follow the procedure described in clause 6.22 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP POST request as specified in clause 6.22.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\na)\tshall set the Host header field using the callback URL which was previously provided by the message store client in its corresponding subscription creation request as specified in clause 21.2.12A; and\nb)\tshall send the HTTP POST request towards the callback URL provided by the client.\nUpon receipt of an HTTP response, the message store function should follow the procedure as described in clause 6.22.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nIf the callback URL in the HTTP POST request (clause 21.2.16.1) points to the message store client then upon receipt of the HTTP POST request from the MCData message store, as per clause 21.2.16.1, the message store client acting as an HTTP server (for such an in-band connection as described in clause 7.13.3.17.2 of 3GPP TS 23.282[2]):\n1)\tshall process the HTTP POST request by following the procedures described in clause 6.22.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]; and\na)\teither use the notification content and the reported \"restartToken\" and \"index\" as specified in clause 5.1.5.1 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] to have the client's local message store updated accordingly; or\nb)\tuse the notification as a trigger to subsequently search the MCData message store for the list of changes as specified in clause 21.2.17; and\n2)\tshall generate and send an HTTP response towards the message store function indicating the result of the operation as per clause 6.22.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nNOTE:\tThe notifications about changes in the MCData message store can be used by the message store client to synchronize its local message store with the MCData message store in two distinguished ways which are listed in sub-bullets \"a\" and \"b\" above.\nIf however, the Message store client is not using an in-band connection with the MCData message store to receive notifications and has instead created a notification channel with the MCData notification server (see clause 7.13.3.17.3 of 3GPP TS 23.282[2]) as described in clause 21.2.19, then the message store client shall not follow the procedure in this clause and instead follow the procedure described in clause 21.2.22 \"Open notification channel\" in order to start receiving the notifications (about changes in the message store).\nIf the callback URL in the HTTP POST request, as described in clause 21.2.16.1, points to the MCData Notification server then upon receipt of the request from the MCData message store, the MCData notification server acting as an HTTP server as per clause 7.13.3.17.3 of 3GPP TS 23.282[2]:\n1)\tshall process the HTTP POST request; and\n2)\tshall make the notifications available to the message notification client (and hence the message store client) through the associated channel which was previously created and as need be opened (see clause 21.2.19 and clause 21.2.22).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.17\tSearch-based synchronization procedure",
                            "text_content": "To search for changes (e.g. newly created objects, recently deleted objects, etc) in the MCData message store using the message store function, the message store client, acting as an HTTP client shall follow the procedure described in clause 21.2.2.1 with the following clarification:\n1)\tshall use the search criterion of \"CreatedObjects\", \"VanishedObjects\" or \"Flag\" in the HTTP POST request as specified in clause 5.1.5.2 and 5.4.2.2  of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] in order to retrieve from the MCData message store the list of the newly created object, recently deleted object and/or changes to flags respectively.\nUpon receipt of the HTTP POST request from the client, as per clause 21.2.17.1, the message store function acting as an HTTP server shall follow the procedure described in clause 21.2.2.2 with the following clarification:\n1)\tif search criterion in the HTTP POST request is set to \"CreatedObjects\", then the HTTP POST, response shall include a \"creationCursor\" as specified in clause 5.3.2.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.18\tRetrieve content of a given folder procedure",
                            "text_content": "To retrieve the content of a given folder identified by its folder ID in the MCData message store using the message store function, the message store client, acting as an HTTP client shall follow the procedure described in clause 6.14 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\n1)\tshall generate an HTTP GET request as specified in clause 6.14.3 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] as follows:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\nc)\tmay include URI query parameter(s) necessary to control the extent of the folder's information returned in the response; and\n2)\tshall send the HTTP GET request towards the message store function.\nNOTE:\tin order for the message store client to retrieve the content of the root folder, it first needs to discover its folder ID as described in clause 5.1.6 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] using Folder search procedure specified in clause 21.2.11 of the present document.\nUpon receipt of an HTTP response, the message store client should follow the procedure as described in clause 6.14.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP GET request from the client, as per clause 21.2.18.1, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP GET request by following the procedures described in clause 6.14.3 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]; and\n3)\tshall generate and send an HTTP response towards the message store client indicating the result of the operation as per clause 6.14.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.19\tCreate notification channel procedure",
                            "text_content": "To create a notification channel, the Message notification client, acting as an HTTP client shall follow the procedure described in clause 6.1 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76] as follows:\n1)\tshall generate an HTTP POST request as specified in clause 6.1.5 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76] as follows:\na)\tshall set the Host header field to a hostname identifying the MCData Notification server;\nb)\tshall include a valid MCData access token in the Authorization header; and\nc)\tshall send the HTTP POST request towards the MCData Notification server.\nUpon receipt of an HTTP response, the Message notification client should follow the procedure as described in clause 6.1.2 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76].\nUpon receipt of the HTTP POST request from the client, as per clause 21.2.19.1, with the Request-URI identifying a resource in the MCData Notification server, the MCData Notification server acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request by following the procedures described in clause 6.1.5 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76]; and\n3)\tshall generate and send an HTTP response towards the Message notification client indicating the result of the operation.\nNOTE 1:\tA successful HTTP response includes a Callback URL and can also include a Channel URL depending on the \"channelType\" requested (see clause 5 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76]).\nNOTE 2:\tThe Callback URL is used by the message store client in its request for creation of subscription to notifications sent towards the Message store function as described in clause 21.2.12A.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.20\tDelete notification channel procedure",
                            "text_content": "To delete a notification channel, the Message notification client, acting as an HTTP client shall follow the procedure described in clause 6.2 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76] as follows:\n1)\tshall generate an HTTP DELETE request as specified in clause 6.2.6 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76] with following the clarifications:\na)\tshall set the Host header field to a hostname identifying the MCData Notification server;\nb)\tshall include a valid MCData access token in the Authorization header; and\nc)\tshall send the HTTP DELETE request towards the MCData Notification server.\nUpon receipt of a HTTP response, the Message notification client should follow the procedure as described in clause 6.2.2 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76].\nNOTE:\tWhen the notification channel is deleted, the Message store client normally removes the notification subscription in the MCData Message store function as described in clause 21.2.13A.\nUpon receipt of the HTTP DELETE request from the client, as per clause 21.2.20.1, with the Request-URI identifying a resource in the MCData Notification server, the MCData Notification server acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP DELETE request by following the procedures described in clause 6.2.6 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76]; and\n3)\tshall generate and send an HTTP response towards the Message notification client indicating the result of the operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.21\tUpdate notification channel procedure",
                            "text_content": "To update a notification channel's lifetime, the Message notification client, acting as an HTTP client shall follow the procedure described in clause 6.4 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76] as follows:\n1)\tshall generate an HTTP PUT request as specified in clause 6.4.4 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76] as follows:\na)\tshall set the Host header field to a hostname identifying the MCData Notification server;\nb)\tshall include a valid MCData access token in the Authorization header; and\nc)\tshall send the HTTP PUT request towards the MCData Notification server.\nUpon receipt of an HTTP response, the Message notification client should follow the procedure as described in clause 6.4.2 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76].\nNOTE:\tA successful HTTP response includes the new Channel's lifetime duration which can be used by the Message store client to update the lifetime of the notification subscription in the MCData message store function as described in clause 21.2.14A.\nUpon receipt of the HTTP PUT request from the client, as per clause 21.2.21.1, with the Request-URI identifying a resource in the MCData Notification server, the MCData Notification server acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP PUT request by following the procedures described in clause 6.4.4 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76]; and\n3)\tshall generate and send an HTTP response towards the Message notification client indicating the result of the operation;\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.22\tOpen notification channel procedure",
                            "text_content": "Based on the channel type created as part of the notification channel creation procedure (see clause 21.2.19. \"Create notification channel\"), the Message notification client would determine if and how it needs to open (interact with) the created channel for notification flow (i.e. using PULL or PUSH).\nTo open the notification channel for a PULL notification delivery method (i.e. created channel is of type LongPolling), the Message notification client, acting as an HTTP client shall follow the procedure described in clauses 6.3 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76] as follows:\n1)\tshall generate an HTTP POST request as specified in clause 6.3.5 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76] as follows:\na)\tshall set the Host header field to a hostname identifying the Notification server extracted from the channelURL received from the Notification server during channel creation (see clause 21.2.19. \"Create notification channel\");\nb)\tshall include a valid MCData access token in the Authorization header; and\nc)\tshall send the HTTP POST request towards the MCData Notification server using the channelURL received from the MCData Notification server during channel creation procedure (see clause 21.2.19. \"Create notification channel\").\nUpon receipt of a HTTP response, the Message notification client should follow the procedure as described in clause 6.3.2 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76]; and\n1)\teither use the notification content and the reported \"restartToken\" and \"index\" as specified in clause 5.1.5.1 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] to have the client's local message store updated accordingly; or\n2)\tuse the notification as a trigger to subsequently search the MCData message store for the list of changes as specified in clause 21.2.17;\nNOTE:\tThe notifications about changes in the MCData message store can be used by the message store client to synchronize its local message store with the MCData message store in two distinguished ways which are listed in bullets \"1\" and \"2\" above.\nTo open the notification channel for a PUSH notification delivery method over WebSocket (i.e. created channel is of type WebSocket), the Message notification client shall follow the procedure described in Appendix I of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76] and use the channelURL received from the MCData Notification server during the channel creation procedure (see clauses 21.2.19 ) to create a WebSocket connection with the MCData Notification server. The process of creating a WebSokect connection between the Message notification client and the MCData Notification server through which the MCData Notification server can send notifications to the Message notification client is not RESTful.\nIf the created channel is of type NativeChannel, the Message notification client, is not required to invoke the \"Open notification channel\" procedure as defined in this clause. See clauses 5, 5.3.13, 5.3.14 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76] for description on receiving notification over a NativeChannel.\nUpon receipt of the HTTP POST request (i.e. PULL notification delivery method) from the client, as per clause 21.2.22.1, with the Request-URI (i.e. channelURL) identifying a resource in the MCData Notification server, the MCData Notification server acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request by following the procedures described in clause 6.3.5 of OMA-TS-REST_NetAPI_NotificationChannel-V1_0-20200319-C [76]; and\n3)\tshall generate and send an HTTP response towards the Message notification client indicating the result of the operation. If the response is successful, it shall contain the notifications (i.e. MCData message store change events).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.23\tList folder hierarchy procedure",
                            "text_content": "To list an existing folder's hierarchy structure in the MCData message store, the message store client, acting as an HTTP client shall follow the procedure described in clause 6.16 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] with the following clarification(s):\n1)\tshall generate an HTTP POST request as specified in clause 6.16.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] with the following clarifications:\na)\tshall set the Host header field to a hostname identifying the message store function;\nb)\tshall include a valid MCData access token in the HTTP Authorization header; and\nc)\tshall send the HTTP POST request towards the message store function with \"SelectionCriteria\" parameters \"searchCriteria\" and \"nonRecursiveScope\" absent and \"searchScope\" parameter either absent or containing a folder ID (for further information on \"SelectionCriteria\" data structure see clause 5.3.2.17 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]).\ni)\tif \"searchScope\" parameter is absent, the request is to list all the subfolders recursively starting from the root folder. However, if \"searchScope\" parameter contains a folder ID, the request is to list all the subfolders recursively starting from the the given folder.\nUpon receipt of a HTTP response, the message store client should follow the procedure as described in clause 6.16.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP POST request from the client, as per clause 21.2.23.1, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request by following the procedures described in clause 6.16.5 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]; and\n3)\tshall generate and send an HTTP response, towards the message store client indicating the result of the operation. A successful \"200 OK\" HTTP response shall contain the \"FolderReferenceList\" data structure listing subfolders starting at the root folder or at the requested folder.\nNOTE:\tFor further information on \"FolderReferenceList\" data structure see clause 5.3.2.10 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.2.24\tRetrieve file to store locally procedure",
                            "text_content": "To request the MCData message store to retrieve a file associated with a given object Id from the MCData content server and store locally, the message store client, acting as an HTTP client:\n1)\tshall generate an HTTP POST request as a custom operation associated with a stored object resource as described in clause 6.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] where:\na)\tthe request URI shall be set to: //{serverRoot}/nms/{apiVersion}/{storeName}/{boxId}/objects/{objectId}/retrieve\nNOTE:\tThe above request URI states, the custom operation \"retrieve\" is performed on an object resource identified by the {objectId}. For further details on custom operations see clauses 4.4.2, 4.6.1.2 and C.4 in 3GPP TS 29.501 [79]).\nb)\tthe Host header field shall be set to a hostname identifying the message store function; and\nc)\ta valid MCData access token shall be included in the HTTP Authorization header; and\n2)\tshall send the HTTP POST request towards the message store function with the request containing an \"Empty\" data structure as described in clause 5.3.2.35 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of an HTTP response, the message store client should follow the procedure as described in clause 6.2.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66].\nUpon receipt of the HTTP POST request from the client, as per clause 21.2.24.1, the message store function acting as an HTTP server:\n1)\tshall validate the MCData access token (with \"Bearer\" authentication scheme) received in the Authorization header of the request as specified in 3GPP TS 24.482 [24];\n2)\tif validation is successful then\na)\tshall process the HTTP POST request as follows:\ni)\tshall locate the object as identified by the {objectId} in the request URI\nii)\tshall use the URL value of the \"href\" attribute within the \"payloadPart\" IE of the object (see clause 5.3.2.1 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66]) and fetch the file from the MCData content server as described in clause 6.7, provided that the URL is pointing to a file in the MCData content server; and\niii)\tshall store the file locally and update the \"href\" attribute value of the \"payloadPart\" IE accordingly (i.e. to point to the locally stored file) provided the file was fetched from the MCData content server; and\n3)\tshall generate and send an HTTP response, towards the message store client indicating the result of the operation as described in clause 6.2.2 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] with the following clarifications:\na)\tif the URL value of the \"href\" attribute within the \"payloadPart\" IE of the object was already pointing to a file stored locally in the MCData message store (i.e. the MCData message store did not need to fetch the file from the MCData content server), an HTTP 200 OK response containing the \"Object\" data structure as defined in clause 5.3.2.1 of OMA-TS-REST_NetAPI_NMS-V1_0-20190528-C [66] shall be returned; and\nb)\tif the object is updated (i.e. \"href\" value of the \"payloadPart\" IE changed), a \"changedObject\" event notification (see clause 21.2.16) shall be emitted if there exists a subscription (see clause  21.2.12A) to such an event from a client.\nNOTE:\tReturning an HTTP 200 OK response when the request is for fetching a file which has already been fetched and stored locally in the MCData message store allows proper processing of retried/duplicated requests (e.g. client retrying the same request if the response to its previous request has not arrived due to communication failure).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "21.3\tControl of communications storage procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "21.3.1\tGeneral",
                            "text_content": "This clause describes the MCData user control of communications storage into message store procedures for on-network.\nThe control of communications storage procedures provides an option for the MCData user to store the MCData communications in the MCData message store. The MCData user(s) is configured with two levels of configurations to control the storage.\n1)\tThe user profile is configured with two levels of configuration parameters to control the storage of MCData communications in the message store:\na)\tThe user profile allows control of storage of MCData communications in the message store or not.\nb)\tIf the storage of MCData communication is allowed, the user profile allow control of storage of private communication and group communication separately.\n2)\tDuring the communication, if the communication is enabled to be stored in the message store (as stated in 1 above) the user will have the choice to decide if the communication will be stored in the message store. So the user has the total control if a communication will be stored or not.\nThe procedures for originating MCData clients and participating MCData functions are specified in clause 21.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.3.2\tMCData Client procedures",
                            "text_content": "On request from MCData user at MCData client, a request to control (i.e. to enable or disable) the storage of MCData communication into the MCData message store is initiated to the participating MCData function.\nUpon receiving a request from the MCData user to send a request to control (i.e., enable) the storage of MCData communications request, if the <allow-store-comms-in-msgstore> element of the <ruleset> element is not present in the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) or is set to a value of \"false\", the MCData client shall inform the MCData user and shall exit this procedure.\nUpon receiving a request from the MCData user to send a request to enable the storage of MCData communications for private and/or group, the MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] with the clarifications given below.\nThe MCData client:\n1)\tshall include a Request-URI set to the public service identity identifying the originating participating MCData function serving the MCData user;\n2)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7];\n3)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n4)\tmay include a P-Preferred-Identity header field in the SIP MESSAGE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n5)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body as specified in clause D.1 with the <mcdatainfo> element containing the <mcdata-Params> element with:\na)\tthe <request-type> element set to a value of \"store-comms-in-msgstore-ctrl-req\";\nb)\tif user want to store all the authorized MCData private communications, and if requested to store the communications, shall include <store-all-private-comms-in-msgstore> element set to a value of \"true\". Otherwise, if user want to store the list of MCData private communications, and if requested to store the communications, shall include <store-specific-private-comms-in-msgstore> element set to a value of \"enable\";\nc)\tif user want to store all the authorized MCData group communications, and if requested to store the communications, shall include <store-all-group-comms-in-msgstore> element set to a value of \"true\". Otherwise, if user want to store the list of MCData group communications, and if requested to store the communications, shall include <store-specific-group-comms-in-msgstore> element set to a value of \"enable\";\nd)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\ne)\tif the MCData client needs to include an active functional alias in the SIP MESSAGE request, the <anyExt> element of the <functional-alias-URI> element set to the URI of the used functional alias;\n6)\tif the <store-specific-private-comms-in-msgstore> or the <store-specific-group-comms-in-msgstore> element is included in an application/vnd.3gpp.mcdata-info+xml MIME body, shall include an application/vnd.3gpp.mcdata-msgstore-ctrl-request+xml MIME body as specified in clause D.7 with the <msgstore-ctrl-command-list> element containing:\na)\tif the <store-specific-private-comms-in-msgstore> element set to a value of \"enable\", may include zero or more <private> elements of <enable> element containing a MCData ID of the MCData user; and\nb)\tif the <store-specific-group-comms-in-msgstore> element set to a value of \"enable\", may include zero or more <group> elements of <enable> element containing a MCData Group ID; and\n7)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5].\nUpon receiving a request from the MCData user to send a request to control (i.e., disable) the storage of MCData communications request, if the <allow-store-comms-in-msgstore> element of the <ruleset> element is not present in the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) or is set to a value of \"false\", the MCData client shall inform the MCData user and shall exit this procedure.\nUpon receiving a request from the MCData user to send a request to disable the storage of MCData communications for private and/or group, the MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] with the clarifications given below.\nThe MCData client:\n1)\tshall include a Request-URI set to the public service identity identifying the originating participating MCData function serving the MCData user;\n2)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7];\n3)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n4)\tmay include a P-Preferred-Identity header field in the SIP MESSAGE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n5)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body as specified in clause D.1 with the <mcdatainfo> element containing the <mcdata-Params> element with:\na)\tthe <request-type> element set to a value of \"store-comms-in-msgstore-ctrl-req\";\nb)\tif user do not want to store all the authorized MCData private communications, and if requested not to store the communications, shall include <store-all-private-comms-in-msgstore> element set to a value of \"false\". Otherwise, if user do not want to store the list of MCData private communications, and if requested not to store the communications, shall include <store-specific-private-comms-in-msgstore> element set to a value of \"disable\";\nc)\tif user do not want to store all the authorized MCData group communications, and if requested not to store the communications, shall include <store-all-group-comms-in-msgstore> element set to a value of \"false\". Otherwise, if user do not want to store the list of MCData group communications, and if requested not to store the communications, shall include <store-specific-group-comms-in-msgstore> element set to a value of \"disable\";\nd)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\ne)\tif the MCData client needs to include an active functional alias in the SIP MESSAGE request, the <anyExt> element of the <functional-alias-URI> element set to the URI of the used functional alias;\n6)\tif the <store-specific-private-comms-in-msgstore> or the <store-specific-group-comms-in-msgstore> element is included in an application/vnd.3gpp.mcdata-info+xml MIME body, shall include an application/vnd.3gpp.mcdata-msgstore-ctrl-request+xml MIME body as specified in clause D.7 with the <msgstore-ctrl-command-list> element containing:\na)\tif the <store-specific-private-comms-in-msgstore> element set to a value of \"disable\", may include zero or more <private> elements of <disable> element containing a MCData ID of the MCData user; and\nb)\tif the <store-specific-group-comms-in-msgstore> element set to a value of \"disable\", may include zero or more <group> elements of <disable> element containing a MCData Group ID; and\n7)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "21.3.3\tParticipating MCData function procedures",
                            "text_content": "The participating MCData function has procedures to:\n-\treceive a MCData communications storage control request from the MCData Client.\nUpon receipt of a \"SIP MESSAGE request for controlling the storage of the MCData communications into MCData message store\", the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall determine the MCData ID of the calling user from the public user identity in the P-Asserted-Identity header field of the SIP MESSAGE request;\nNOTE:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field and shall not continue with any of the remaining steps;\n4)\tif the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request containing <request-type> element set to a value of \"store-comms-in-msgstore-ctrl-req\" and:\na)\tthe <allow-store-comms-in-msgstore> element of the <ruleset> element is not present in the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) or is set to a value of \"false\", shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"234 user authorized to enable or disable the storage of MCData communications into the MCData message store\" in a Warning header field, and shall not continue with the rest of the steps in this clause;\nb)\tif the <store-all-private-comms-in-msgstore> element is present in the incoming request and the <allow-store-private-comms-in-msgstore> element of the <ruleset> element is not present in the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) or is set to a value of \"false\", shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"234 user authorized to enable or disable the storage of MCData communications into the MCData message store\" in a Warning header field, and shall not continue with the rest of the steps in this clause;\nc)\tif the <store-all-group-comms-in-msgstore> element is present in the incoming request and the <allow-store-group-comm-in-msgstore> element of the each <MCDataGroupInfo> element is not present in the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) or is set to a value of \"false\", shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"234 user authorized to enable or disable the storage of MCData communications into the MCData message store\" in a Warning header field, and shall not continue with the rest of the steps in this clause;\nd)\tthe SIP MESSAGE request does not contain an application/vnd.3gpp.mcdata-msgstore-ctrl-request+xml MIME body, the <store-all-private-comms-in-msgstore> element, and the <store-all-group-comms-in-msgstore> elements, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"235 unable to determine target user or group for enabling or disabling the storage of MCData communications into the MCData message store\" in a Warning header field, and shall not continue with the rest of the steps in this clause;\ne)\tif the <store-all-group-comms-in-msgstore> element is not present and an application/vnd.3gpp.mcdata-msgstore-ctrl-request+xml MIME body with zero or more <group> elements of <enable> or <disable>  element are included, and each specified MCData group ID matching with the corresponding entry in the  <MCDataGroupInfo> does not contain the <allow-store-group-comm-in-msgstore> element in the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) or is set to a value of \"false\", shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"234 user authorized to enable or disable the storage of MCData communications into the MCData message store\" in a Warning header field, and shall not continue with the rest of the steps in this clause; and\nf)\tif the <store-specific-private-comms-in-msgstore> or <store-specific-group-comms-in-msgstore> is present and the request does not contain an application/resource-lists+xml MIME body, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"235 unable to determine target user or group for enabling or disabling the storage of MCData communications into the MCData message store\" in a Warning header field, and shall not continue with the rest of the steps in this clause;\n5)\tif the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request contains:\na)\tif the <store-all-private-comms-in-msgstore> element set to a value of \"true\", shall update or store the record for the MCData client and enable the storage of all the MCData private communications for which user is authorized to store the communication into the MCData message store;\nb)\tif the <store-all-private-comms-in-msgstore> element set to a value of \"false\", shall update or store the record for the MCData client and disable the storage of all the MCData private communications for which user is authorized to store the communication into the MCData message store;\nc)\tif the <store-specific-private-comms-in-msgstore> element set to a value of \"enable\", the <store-all-private-comms-in-msgstore> element is not present and an application/vnd.3gpp.mcdata-msgstore-ctrl-request+xml MIME body with one or more <private> elements of <enable> element are included, shall update or store the record for the MCData client and enable the storage of MCData private communications of the requesting user with specified list of users for which user is authorized to store the communication into the MCData message store;\nd)\tif the <store-specific-private-comms-in-msgstore> element set to a value of \"disable\", the <store-all-private-comms-in-msgstore> element is not present and an application/vnd.3gpp.mcdata-msgstore-ctrl-request+xml MIME body with one or more <private> elements of <disable> element are included, shall update or store the record for the MCData client and disable the storage of MCData private communications of the requesting user with the specified list of users for which user is authorized to store the communication into the MCData message store;\ne)\tif the <store-all-group-comms-in-msgstore> element set to a value of \"true\", shall update or store the record for the MCData client and enable the storage of all the MCData group communications for which user is authorized to store the communication into the MCData message store;\nf)\tif the <store-all-group-comms-in-msgstore> element set to a value of \"false\", shall update or store the record for the MCData client and disable the storage of all the MCData group communications for which user is authorized to store the communication into the MCData message store;\ng)\tif the <store-specific-group-comms-in-msgstore> element set to a value of \"enable\", the <store-all-group-comms-in-msgstore> element is not present and an application/vnd.3gpp.mcdata-msgstore-ctrl-request+xml MIME body with one or more <group> elements of <enable> element are included, shall update or store the record for the MCData client and enable the storage for the specified MCData group communications for which user is authorized to store the communication into the MCData message store; and\nh)\tif the <store-specific-group-comms-in-msgstore> element set to a value of \"disable\", the <store-all-group-comms-in-msgstore> element is not present and an application/vnd.3gpp.mcdata-msgstore-ctrl-request+xml MIME body with one or more <group> elements of <disable> element are included, shall update or store the record for the MCData client and disable the storage for the specified MCData group communications for which user is authorized to store the communication into the MCData message store;\n6)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5] with the following clarifications:\na)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function; and\n7)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "22\tFunctional alias",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "22.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Clause 22.2 contains the procedures for management of functional alias at the MCData client, the MCData server serving the MCData user and the MCData server owning the functional alias.\nClause 22.3 describes the coding used for management of functional aliases.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "22.2\tProcedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "22.2.1\tMCData client procedures",
                            "text_content": "The MCData client procedures consist of:\n-\ta functional alias status change procedure;\n-\ta functional alias status determination procedure; and\n-\ta location based functional alias status change procedure.\nIn order to obtain information about success or rejection of changes triggered by the functional alias status change procedure for an MCData user, the MCData client needs to initiate the functional alias status determination procedure for the MCData user before starting the functional alias status change procedure for the MCData user.\nIn order:\n-\tto indicate that an MCData user requests to activate one or more functional aliases;\n-\tto indicate that the MCData user requests to deactivate one or more functional aliases;\n-\tto refresh indication of an MCData user interest in one or more functional aliases due to near expiration of the expiration time of a functional alias with the status set to the \"activated\" state received in a SIP NOTIFY request in clause 22.2.1.3;\n-\tto indicate that the MCData client entering into or exiting from a location area triggers one or more functional aliases to be activated;\n-\tto indicate that the MCData client entering into or exiting from a location area triggers one or more functional aliases to be deactivated; or\n-\tany combination of the above;\nthe MCData client shall generate a SIP PUBLISH request according to TS 24.229 [5], IETF RFC 3903 [34], and IETF RFC 3856 [39].\nWhen the MCData user requests to deactivate a functional alias, the MCData client shall first check the <manual-deactivation-not-allowed-if-location-criteria-met> element within the <anyExt> element of the <entry> element corresponding to the functional alias within the <FunctionalAliasList> list element of the <anyExt> element of the <OnNetwork> element of the MCData user profile document (see the MCData user profile document in TS 24.484 [12]). If the functional alias has been activated due to a location area trigger and the <manual-deactivation-not-allowed-if-location-criteria-met> element is set to a value of \"true\", the MCData client shall suppress the MCData user's request.\nNOTE 1:\tIf the request is suppressed, a notification message can be displayed to the user.\nIn the SIP PUBLISH request, the MCData client:\n1)\tshall set the Request-URI to the public service identity identifying the originating participating MCData function serving the MCData user;\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData client shall include the <mcdata-request-uri> element set to the MCData ID of the MCData user;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7];\n4)\tif the MCData client requests to activate one or more functional aliases, shall set the Expires header field according to IETF RFC 3903 [34], to 4294967295;\nNOTE 2:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n5)\tif the MCData client requests to deactivate one or more functional aliases, shall set the Expires header field according to IETF RFC 3903 [34], to zero; and\nNOTE 3:\tActivation and deactivation of functional alias cannot be performed with the same PUBLISH request.\n6)\tshall include an application/pidf+xml MIME body indicating per-user functional alias information according to clause 22.3.1. In the MIME body, the MCData client:\na)\tshall include all functional aliases where the MCData user requests activation for the MCData ID;\nb)\tshall include the MCData client ID of the targeted MCData client;\nc)\tshall not include the \"status\" attribute and the \"expires\" attribute in the <functionalalias> element;\nd)\tif the MCData client has received an indication that take over of a functional alias is possible and intends to take over a functional alias, shall include a <take-over> child element set to \"true\"; and\ne)\tshall set the <p-id-fa> child element of the <presence> root element to a globally unique value.\nThe MCData client shall send the SIP PUBLISH request according to TS 24.229 [5].\nNOTE 1:\tThe MCData UE also uses this procedure to determine which functional alias have been successfully activated for the MCData ID.\nIn order to discover functional aliases:\n1)\twhich which are activated for the MCData user; or\n2)\twhich another MCData user has activated;\nthe MCData client shall generate an initial SIP SUBSCRIBE request according to TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36].\nIn the SIP SUBSCRIBE request, the MCData client:\n1)\tshall set the Request-URI to the public service identity identifying the originating participating MCData function serving the MCData user;\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData client shall include:\na)\tthe <mcdata-request-uri> element set to the MCData ID of the targeted MCData user; and\nb)\tthe <request-type> element in the <mcdata-Params> element of the <mcdatainfo> element set to the value \"functional-alias-status-determination\";\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7];\n4)\tif the MCData client wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [36], to 4294967295;\nNOTE 2:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n5)\tif the MCData client wants to fetch the current state only, shall set the Expires header field according to IETF RFC 6665 [36], to zero;\n6)\tshall include an Events header field set to \"presence\"; and\n7)\tshall include an Accept header field containing the application/pidf+xml MIME type.\nIn order to re-subscribe or de-subscribe, the MCData client shall generate an in-dialog SIP SUBSCRIBE request according to TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36]. In the SIP SUBSCRIBE request, the MCData client:\n1)\tif the MCData client wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [36], to 4294967295;\nNOTE 3:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n2)\tif the MCData client wants to de-subscribe, shall set the Expires header field according to IETF RFC 6665 [36], to zero;\n3)\tshall include an Events header field set to \"presence\"; and\n4)\tshall include an Accept header field containing the application/pidf+xml MIME type.\nUpon receiving a SIP NOTIFY request according to TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36], if SIP NOTIFY request contains an application/pidf+xml MIME body indicating per-user functional alias information  constructed according to clause 22.3.1, then the MCData client shall determine the status of the MCData user for each functional alias in the MIME body. If the <p-id-fa> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP NOTIFY request is included, the <p-id-fa> element value indicates the SIP PUBLISH request which triggered sending of the SIP NOTIFY request.\nIf the MCData client detected a functional alias activation or deactivation, it shall perform the procedure specified in clause 8.2.6.\nIf a location criterion for functional alias activation or de-activation is met, the MCData client shall initiate the functional alias status change procedure as specified in clause 22.2.1.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "22.2.2\tMCData server procedures",
                            "text_content": "The MCData server procedures consist of:\n-\tprocedures of MCData server serving the MCData user; and\n-\tprocedures of MCData server owning the functional alias.\nThe procedures of MCData server serving the MCData user consist of:\n-\ta receiving functional alias status change from MCData client procedure;\n-\ta receiving subscription to functional alias status procedure;\n-\ta sending notification of change of functional alias status procedure;\n-\ta sending functional alias  status change towards MCData server owning the functional procedure; and\n-\ta functional alias status determination from MCData server owning the functional alias procedure.\nThe MCData server shall maintain a list of MCData user information entries. The list of the MCData user information entries contains one MCData user information entry for each served MCData ID.\nIn each MCData user information entry, the MCData server shall maintain:\n1)\tan MCData ID. This field uniquely identifies the MCData user information entry in the list of the MCData user information entries; and\n2)\ta list of functional alias information entries.\nIn each functional alias information, the MCData server shall maintain:\n1)\ta functional alias ID. This field uniquely identifies the functional alias information entry in the list of the functional alias information entries;\n2)\ta functional alias status;\n3)\tan expiration time;\n4)\ta functional alias p-id-fa; and\n5)\ta next publishing time.\nUpon receiving a SIP PUBLISH request such that:\n1)\tRequest-URI of the SIP PUBLISH request contains either the public service identity identifying the originating participating MCData function serving the MCData user, or the public service identity identifying the terminating participating MCData function serving the MCData user;\n2)\tthe SIP PUBLISH request contains an application/vnd.3gpp.mcdata-info+xml MIME body containing the<mcdata-request-uri> element which identifies an MCData ID served by the MCData server;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tthe Event header field of the SIP PUBLISH request contains the \"presence\" event type; and\n5)\tSIP PUBLISH request contains an application/pidf+xml MIME body indicating per-user functional alias information according to clause 22.3.1;\nthen the MCData server:\n1)\tshall identify the served MCData ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP PUBLISH request;\n2)\tif the Request-URI of the SIP PUBLISH request contains the public service identity identifying the originating participating MCData function serving the MCData user, shall identify the originating MCData ID from public user identity in the P-Asserted-Identity header field of the SIP PUBLISH request;\n3)\tif the Request-URI of the SIP PUBLISH request contains the public service identity identifying the terminating participating MCData function serving the MCData user, shall identify the originating MCData ID in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP PUBLISH request;\n4)\tif the originating MCData ID is different than the served MCData ID or the originating MCData ID is not authorized to modify functional alias status of the served MCData ID, shall send a SIP 403 (Forbidden) response and shall not continue with the rest of the steps;\n5)\tif the Expires header field of the SIP PUBLISH request is not included or has nonzero value lower than 4294967295, shall send a SIP 423 (Interval Too Brief) response to the SIP PUBLISH request, where the SIP 423 (Interval Too Brief) response contains a Min-Expires header field set to 4294967295, and shall not continue with the rest of the steps;\n6)\tif the Expires header field of the SIP PUBLISH request has nonzero value, shall determine the candidate expiration interval to according to IETF RFC 3903 [34];\n7)\tif the Expires header field of the SIP PUBLISH request has zero value, shall set the candidate expiration interval to zero;\n8)\tshall respond with SIP 200 (OK) response to the SIP PUBLISH request according to TS 24.229 [5], IETF RFC 3903 [34]. In the SIP 200 (OK) response, the MCData server:\na)\tshall set the Expires header field according to IETF RFC 3903 [34], to the candidate expiration time;\n9)\tif the \"entity\" attribute of the <presence> element of the application/pidf+xml MIME body of the SIP PUBLISH request is different than the served MCData ID, shall not continue with the rest of the steps;\n10)\tshall consider an MCData user information entry such that:\na)\tthe MCData user information entry is in the list of MCData user information entries described in clause 22.2.2.2.2; and\nb)\tthe MCData ID of the MCData user information entry is equal to the served MCData ID;\nas the served MCData user information entry;\n11)\tshall consider a copy of the list of the MCData functional alias entries of the served MCData user information entry as the served list of the MCData functional alias information entries;\n12)\tif the candidate expiration interval is nonzero, shall construct the candidate list of the MCData functional alias entries as follows:\na)\tfor each functional alias ID which has a functional alias information entry in the served list of the functional alias information entries, such that the expiration time of the functional alias information entry has not expired yet, and which is indicated in a \"functionalAliasID\" attribute of a <functionalAlias> element of the <status> element of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request:\ni)\tshall copy the functional alias information entry into a new functional alias information entry of the candidate list of the functional alias information entries;\nii)\tif the functional alias status of the functional alias information entry is \"deactivating\" or \"deactivated\", shall set the functional alias status of the new functional alias information entry to the \"activated\" state and shall set the activating p-id-fa of the new functional alias information entry to the value of the <p-id-fa> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request; and\niii)\tshall set the expiration time of the new functional alias information entry to the current time increased with the candidate expiration interval;\nb)\tfor each functional alias ID which has a functional alias information entry in the served list of the functional alias information entries, such that the expiration time of the functional alias information entry has not expired yet, and which is not indicated in any \"functionalAliasID\" attribute of the <functionalAlias> element of the <status> element of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request:\ni)\tshall copy the functional alias information entry into a new functional alias information entry of the candidate list of the functional alias information entries; and\nii)\tif the functional alias status of the functional alias information entry is \"activated\" or \"activating\":\n-\tshall set the functional alias status of the new functional alias entry to the \"deactivating\" state; and\n-\tshall set the expiration time of the new functional alias information entry to the current time increased with twice the value of timer F; and\nc)\tfor each functional alias ID:\ni)\twhich does not have a functional alias information entry in the served list of the functional alias entries; or\nii)\twhich has a functional alias information entry in the served list of the functional alias information entries, such that the expiration time of the functional alias information entry has already expired;\nand which is indicated in a \"functionalAliasID\" element of the <functionalAlias> element of the <status> element of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request:\ni)\tshall add a new functional alias information entry in the candidate list of the functional alias information list for the functional alias ID;\nii)\tshall set the functional alias status of the new functional alias information entry to the \"activating\" state;\niii)\tshall set the expiration time of the new functional alias information entry to the current time increased with the candidate expiration interval; and\niv)\tshall set the activating p-id-fa of the new functional alias information entry to the value of the <p-id-fa> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request;\n13)\tif the candidate expiration interval is zero, constructs the candidate list of the functional alias information entries as follows:\na)\tfor each functional alias ID which has an entry in the served list of the functional alias information entries:\ni)\tshall copy the functional alias entry of the served list of the functional alias information into a new functional alias information entry of the candidate list of the functional alias information entries;\nii)\tshall set the functional alias status of the new functional alias information entry to the \"de-activating\" state; and\niii)\tshall set the expiration time of the new functional alias information entry to the current time increased with twice the value of timer F;\n14)\tshall replace the list of the functional alias information entries stored in the served MCData user information entry with the candidate list of the functional alias information entries;\n15)\tshall perform the procedures specified in clause 22.2.2.2.6 for the served MCData ID and each functional alias:\na)\twhich does not have a functional alias information entry in the served list of the functional alias information entries and which has a functional alias information entry in the candidate list of the functional alias information entries with the functional alias status set to the \"activating\" state;\nb)\twhich has a functional alias information entry in the served list of the functional alias information entries with the expiration time already expired, and which has a functional alias information entry in the candidate list of the functional alias information entries with the functional alias status set to the \"activating\" state;\nc)\twhich has a functional alias information entry in the served list of the functional alias information entries with the functional alias status set to the \"deactivating\" state or the \"deactivated\" state and with the expiration time not expired yet, and which has an functional alias information entry in the candidate list of the functional alias information entries with the functional alias status set to the \"activating\" state; or\nd)\twhich has a functional alias information entry in the served list of the functional alias information entries with the functional alias status set to the \"activated\" state and with the expiration time not expired yet, and which has an functional alias information entry in the candidate list of the functional alias information entries with the functional alias status set to the \"deactivating\" state;\n16)\tshall identify the handled p-id-fa in the <p-id-fa> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request; and\n17)\tshall perform the procedures specified in clause 22.2.2.2.5 for the served MCData ID.\nUpon receiving a SIP SUBSCRIBE request such that:\n1)\tRequest-URI of the SIP SUBSCRIBE request contains either the public service identity identifying the originating participating MCData function serving the MCData user, or the public service identity identifying the terminating participating MCData function serving the MCData user;\n2)\tthe SIP SUBSCRIBE request contains an application/vnd.3gpp.mcdata-info+xml MIME body containing:\na)\tthe<mcdata-request-uri> element which identifies an MCData ID served by the MCData server; and\nb)\tthe <mcdatainfo> element with the <mcdata-Params> element with the <request-type> element set to a value of \"functional-alias-status-determination\";\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7]; and\n4)\tthe Event header field of the SIP SUBSCRIBE request contains the \"presence\" event type;\nthe MCData server:\n1)\tshall identify the served MCData ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\n2)\tif the Request-URI of the SIP SUBSCRIBE request contains the public service identity identifying the originating participating MCData function serving the MCData user, shall identify the originating MCData ID from public user identity in the P-Asserted-Identity header field of the SIP SUBSCRIBE request;\n3)\tif the Request-URI of the SIP SUBSCRIBE request contains the public service identity identifying the terminating participating MCData function serving the MCData user, shall identify the originating MCData ID in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\n4)\tif the originating MCData ID is different than the served MCData ID and the originating MCData ID is not authorized to modify functional alias status of the served MCData ID, shall send a SIP 403 (Forbidden) response and shall not continue with the rest of the steps; and\n5)\tshall generate a SIP 200 (OK) response to the SIP SUBSCRIBE request according to TS 24.229 [5], IETF RFC 6665 [36].\nFor the duration of the subscription, the MCData server shall notify the subscriber about changes of the information of the served MCData ID, as described in clause 22.2.2.2.5.\nIn order to notify the subscriber about changes of functional aliases of the served MCData ID, the MCData server:\n1)\tshall consider an MCData user information entry such that:\na)\tthe MCData user information entry is in the list of MCData user information entries described in clause 22.2.2.2.2; and\nb)\tthe MCData ID of the MCData user information entry is equal to the served MCData ID;\nas the served MCData user information entry;\n2)\tshall generate an application/pidf+xml MIME body indicating per-user functional alias information according to clause 22.3.1 and the served list of the MCData user information entries with the following clarifications:\na)\tthe MCData server shall not include information from functional alias information entry with the expiration time already expired;\nb)\tthe MCData server shall not include information from a functional alias information entry with the functional alias status set to the \"deactivated\" state;\nc)\tif this procedures is invoked by procedure in clause 22.2.2.2.3 where the handled p-id-fa value was identified, the MCData server shall set the <p-id-fa> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP NOTIFY request to the handled p-id-fa value; and\n3)\tsend a SIP NOTIFY request according to 3GPP TS 24.229 [5], and IETF RFC 6665 [36] for the subscription created in clause 22.2.2.2.4. In the SIP NOTIFY request, the MCData server shall include the generated application/pidf+xml MIME body indicating per-user functional alias information.\nNOTE 1:\tUsage of one SIP PUBLISH request to carry information about change of functional alias state of several MCData users served by the same MCData server is not supported in this version of the specification.\nIn order:\n-\tto send an activation request of a served MCData ID for a handled functional alias ID;\n-\tto send a deactivation request of a served MCData ID for a handled functional alias ID;\n-\tto send a take over request of a served MCData ID for a handled functional alias ID due to take over; or\n-\tto send an activation request of a served MCData ID for a handled functional alias ID due to near expiration of the previously published information;\nthe MCData server shall generate a SIP PUBLISH request according to TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39]. In the SIP PUBLISH request, the MCData server:\n1)\tshall set the Request-URI to the public service identity of the controlling MCData function associated with the handled functional alias ID;\nNOTE 2:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 5:\tHow the MCData server determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 6:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData server:\na)\tshall include the <mcdata-request-uri> element set to the handled functional alias ID; and\nb)\tshall include the <mcdata-calling-user-id> element set to the served MCData ID;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tif sending an activation request, shall set the Expires header field according to IETF RFC 3903 [34], to 4294967295;\nNOTE 7:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n5)\tif sending a deactivation request, shall set the Expires header field according to IETF RFC 3903 [34], to zero;\n6)\tshall include a P-Asserted-Identity header field set to the public service identity of the MCData server according to 3GPP TS 24.229 [5];\n7)\tshall set the current p-id-fa to a globally unique value;\n8)\tshall consider an MCData user information entry such that:\na)\tthe MCData user information entry is in the list of MCData user information entries described in clause 22.2.2.2.2; and\nb)\tthe MCData ID of the MCData user information entry is equal to the served MCData ID;\nas the served MCData user information entry;\n9)\tfor each functional alias information entry such that:\na)\tthe functional alias information entry has the \"activating\" functional alias status, the functional alias ID set to the handled functional alias ID, the expiration time has not expired yet and the activating p-id-fa is not set; and\nb)\tthe functional alias information entry is in the list of the functional alias information entries of the served MCData user information entry;\nshall set the activating p-id-fa of the functional alias information entry to the current p-id-fa; and\n10)\tshall include an application/pidf+xml MIME body indicating per-functional alias status information constructed according to clause 22.3.1.2. The MCData server shall indicate all served MCData user IDs, such that:\na)\tthe functional alias status is set to \"activating\" with or without \"take-over\" element or \"activated\", and the expiration time has not expired yet in a functional alias information entry with the functional alias ID set to the handled functional alias;\nb)\tthe functional alias information entry is in the list of the functional alias information entries of an MCData user information entry; and\nc)\tthe MCData user information entry is a served MCData user information entry.\nThe MCData server shall set the <p-id-fa> child element of the <presence> root element to the current p-id-fa.\nThe MCData server shall not include the \"expires\" attribute in the <functionalAlias> element.\nNOTE 8:\tThe MCData server sets the \"status\" attribute in the <functionalAlias> element to indicate whether the request is for functional alias take over.\nThe MCData server shall send the SIP PUBLISH request according to 3GPP TS 24.229 [5].\nIf timer F expires for the SIP PUBLISH request sent for a (de)activation request of served MCData ID for the functional alias ID or upon receiving a SIP 3xx, 4xx, 5xx or 6xx response to the SIP PUBLISH request, the MCData server:\n1)\tshall remove each functional alias ID entry such that:\na)\tthe functional alias information entry has the functional alias ID set to the handled functional alias ID; and\nb)\tthe functional alias information entry is in the list of the functional alias information entries of the served MCData user information entry.\nNOTE 1:\tUsage of one SIP SUBSCRIBE request to subscribe for notification about change of functional alias state of several MCData users served by the same MCData server is not supported in this version of the specification.\nIn order to discover whether a served MCData user successfully activated a handled functional alias in the MCData server owning the functional alias, the MCData server shall generate an initial SIP SUBSCRIBE request according to TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36].\nIn the SIP SUBSCRIBE request, the MCData server:\n1)\tshall set the Request-URI to the public service identity of the controlling MCData function associated with the handled functional alias;\nNOTE 2:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 4:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 5:\tHow the MCData server determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 6:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData server:\na)\tshall include the <mcdata-request-uri> element set to the handled functional alias ID; and\nb)\tshall include the <mcdata-calling-user-id> element set to the served MCData ID;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tif the MCData server wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [36], to 4294967295;\nNOTE 7:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n5)\tif the MCData server wants to fetch the current state only, shall set the Expires header field according to IETF RFC 6665 [36], to zero;\n6)\tshall include an Accept header field containing the application/pidf+xml MIME type;\n7)\tshall include an Events header field set to \"presence\"; and\n8)\tshall include an application/simple-filter+xml MIME body indicating per-user restrictions of presence event package notification information according to clause 22.3.2, indicating the served MCData ID.\nIn order to re-subscribe or de-subscribe, the MCData server shall generate an in-dialog SIP SUBSCRIBE request according to TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36]. In the SIP SUBSCRIBE request, the MCData server:\n1)\tif the MCData server wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [36], to 4294967295;\nNOTE 8:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [4].\n2)\tif the MCData server wants to de-subscribe, shall set the Expires header field according to IETF RFC 6665 [36], to zero;\n3)\tshall include an Events header field set to \"presence\"; and\n4)\tshall include an Accept header field containing the application/pidf+xml MIME type.\nUpon receiving a SIP NOTIFY request according to TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36], if SIP NOTIFY request contains an application/pidf+xml MIME body indicating per-functional alias information constructed according to clause 22.3.1, then the MCData server:\n1)\tfor each served MCData ID such that the application/pidf+xml MIME body of SIP NOTIFY request contains:\na)\ta <tuple> element of the root <presence> element;\nb)\tthe \"id\" attribute of the <tuple> element indicating the served MCData ID;\nc)\tan <functionalAlias> child element of the <status> element of the <tuple> element; and\nd)\tthe \"expires\" attribute of the <functionalAlias> element indicating expiration of activation of functional alias;\nperform the following:\na)\tif a functional alias information entry exists such that:\ni)\tthe functional alias information entry has the \"activating\" functional alias status, the functional alias ID set to the handled functional alias ID, and the expiration time has not expired yet;\nii)\tthe functional alias information entry is in the list of the functional alias information entries of an MCData user information entry with the MCData ID set to the served MCData ID; and\niii)\tthe MCData user information entry is in the list of MCData user information entries described in clause 22.2.2.2.2;\nshall set the functional alias status of the functional alias information entry to \"activated\"; and\nshall set the next publishing time of the functional alias information entry to the current time and half of the time between the current time and the expiration of the functional alias; and\n2) for each functional alias information entry such that:\na)\tthe functional alias information entry has the \"activated\" functional alias status or the \"deactivating\" functional alias status, the functional alias ID set to the handled functional alias ID, and the expiration time has not expired yet;\nb)\tthe functional alias information entry is in the list of the functional alias information entries of an MCData user information entry with the MCData ID set to a served MCData ID; and\nc)\tthe MCData user information entry is in the list of MCData user information entries described in clause 22.2.2.2.2; and\nfor which the application/pidf+xml MIME body of SIP NOTIFY request does not contain:\na)\ta <tuple> element of the root <presence> element;\nb)\tthe \"id\" attribute of the <tuple> element indicating the served MCData ID; and\nc)\tan <functionalAlias> child element of the <status> child element of the <tuple> element.\nperform the following:\na)\tshall set the functional alias status of the functional alias information entry to \"deactivated\"; and\nb)\tshall set the expiration time of the functional alias information entry to the current time; and\n3)\tif a <p-id-fa> element is included in the <presence> root element of the application/pidf+xml MIME body of the SIP NOTIFY request, then for each functional alias information entry such that:\na)\tthe functional alias information entry has the \"activating\" functional alias status, the functional alias ID set to the handled functional alias ID, the expiration time has not expired yet and with the activating p-id-fa set to the value of the <p-id-fa> element;\nb)\tthe functional alias information entry is in the list of the functional alias information entries of an MCData user information entry with the MCData ID set to a served MCData ID; and\nd)\tthe MCData user information entry is in the list of MCData user information entries described in clause 22.2.2.2.2; and\nfor which the application/pidf+xml MIME body of SIP NOTIFY request does not contain:\na)\ta <tuple> element of the root <presence> element;\nb)\tthe \"id\" attribute of the <tuple> element indicating the served MCData ID; and\nc)\tan <functionalAlias> child element of the <status> child element of the <tuple> element;\nperform the following:\na)\tshall set the functional alias status of the functional alias information entry to \"deactivated\"; and\nb)\tshall set the expiration time of the functional alias information entry to the current time.\nIn order to discover the MCData users that have successfully activated a handled functional alias in the MCData server owning the functional alias, the MCData server shall generate an initial SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36].\nIn the SIP SUBSCRIBE request, the MCData server:\n1)\tshall set the Request-URI to the public service identity of the controlling MCData function associated with the handled functional alias;\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata -info+xml MIME body, the MCData server shall include the <mcdata-request-uri> element set to the handled functional alias ID;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tshall set the Expires header field according to IETF RFC 6665 [36] to zero;\nNOTE:\tif the MCData server wants to receive the current status and later notification, can set the Expires header field according to IETF RFC 6665 [36], to 4294967295, which is the highest value defined for Expires header field in IETF RFC 3261 [4].\n5)\tshall include an Accept header field containing the application/pidf+xml MIME type;\n6)\tshall include an Events header field set to \"presence\"; and\n7)\tshall include an application/simple-filter+xml MIME body indicating per-functional alias restrictions of presence event package notification information indicating the served functional alias.\nUpon receiving a SIP NOTIFY request according to 3GPP TS 24.229 [5], IETF RFC 3856 [39], and IETF RFC 6665 [36], if SIP NOTIFY request contains an application/pidf+xml MIME body indicating per-functional alias status information constructed according to clause 22.3.1, then the MCData client shall determine activation status for the MCData ID(s) of the MCData user(s) that have activated the functional alias in the received MIME body.\nUpon receiving a SIP SUBSCRIBE request such that:\n1)\tRequest-URI of the SIP SUBSCRIBE request contains the public service identity identifying the originating participating MCData function serving the MCData user;\n2)\tthe SIP SUBCRIBE request contains an application/vnd.3gpp.mcdata-info MIME body containing the<mcdata-request-uri> element which identifies an MCData ID not served by MCData server;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7]; and\n4)\tthe Event header field of the SIP SUBSCRIBE request contains the \"presence\" event type;\nthen the MCData server:\n1)\tshall identify the target MCData ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info MIME body of the SIP SUBSCRIBE request;\n2)\tshall identify the originating MCData ID from public user identity in the P-Asserted-Identity header field of the SIP SUBSCRIBE request;\n3)\tshall generate a SIP SUBSCRIBE request from the received SIP SUBSCRIBE request. In the generated SIP SUBSCRIBE request, the MCData server:\na)\tshall set the Request-URI to the public service identity identifying the terminating participating MCData function serving the target MCData ID;\nb)\tshall include a P-Asserted-Identity header field containing the public service identity identifying the originating participating MCData function serving the MCData user;\nc)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData server:\nA)\tshall include the <mcdata-request-uri> element set to the target MCData ID; and\nB)\tshall include the <mcdata-calling-user-id> element set to the originating MCData ID; and\nd)\tshall include other signalling elements from the received SIP SUBSCRIBE request; and\n4)\tshall send the generated SIP SUBSCRIBE request according to 3GPP TS 24.229 [5].\nThe MCData server shall forward to the originating MCData ID any received SIP responses to the SIP SUBSCRIBE request, and for the duration of the subscription any received SIP NOTIFY requests and any received SIP responses to the SIP NOTIFY request according to 3GPP TS 24.229 [5].\nThe procedures of MCData server owning the functional alias consist of:\n-\treceiving functional alias status change procedure;\n-\treceiving subscription to functional alias status procedure;\n-\tsending notification of change of functional alias status procedure; and\n-\tmodification of functional alias eligibility check procedure.\nThe MCData server shall maintain a list of functional alias information entries.\nIn each functional alias information entry, the MCData server shall maintain:\n1)\ta functional alias ID. This field uniquely identifies the functional alias information entry in the list of the functional alias information entries; and\n2)\ta list of MCData user information entries.\nIn each MCData user information entry, the MCData server shall maintain:\n1)\tan MCData ID. This field uniquely identifies the MCData user information entry in the list of the MCData user information entries;\n2)\ta take-over possible indication; and\n3)\tan expiration time.\nUpon receiving a SIP PUBLISH request such that:\n1)\tRequest-URI of the SIP PUBLISH request contains the public service identity of the controlling MCData function associated with the served functional alias;\n2)\tthe SIP PUBLISH request contains an application/vnd.3gpp.mcdata-info+xml MIME body containing the <mcdata-request-uri> element and the <mcdata-calling-user-id> element;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tthe Event header field of the SIP PUBLISH request contains the \"presence\" event type; and\n5)\tSIP PUBLISH request contains an application/pidf+xml MIME body indicating per-functional alias information constructed according to clause 22.3.1.2;\nthen the MCData server:\n1)\tshall identify the served functional alias in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP PUBLISH request;\n2)\tshall identify the handled MCData ID in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP PUBLISH request;\n3)\tif the Expires header field of the SIP PUBLISH request is not included or has nonzero value lower than 4294967295, shall send a SIP 423 (Interval Too Brief) response to the SIP PUBLISH request, where the SIP 423 (Interval Too Brief) response contains a Min-Expires header field set to 4294967295, and shall not continue with the rest of the steps;\n4)\tif the functional alias does not exist in the MCData server, shall reject the SIP PUBLISH request with SIP 403 (Forbidden) response to the SIP PUBLISH request according to 3GPP TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39] and skip the rest of the steps;\n4a)\tif SIP PUBLISH request is for activation of a functional alias then:\na)\tif handled MCData ID does not match with any of the entries in the <mcdata-user-list> which contains the MCData IDs of MCData users which are allowed to activate the functional alias; or\nb)\tif no local policy exists that authorizes the request by the handled MCData ID;\nshall reject the SIP PUBLISH request with SIP 403 (Forbidden) response according to 3GPP TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39] and skip the rest of the steps;\n5)\tif SIP PUBLISH request is for activation of a functional alias and the number of activations for the handled functional alias is equal <max-simultaneous-activations>, shall reject the SIP PUBLISH request with SIP 403 (Forbidden) response to the SIP PUBLISH request according to 3GPP TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39] and skip the rest of the steps;\n6)\tif SIP PUBLISH request is for take over of a functional alias, the MCData server shall use the <allow-takeover> and <allow-takeover-functional-alias-other-user> elements to determine if take over is possible. If take over is not possible, the MCData server shall reject the SIP PUBLISH request with SIP 403 (Forbidden) response to the SIP PUBLISH request according to TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39] and skip the rest of the steps;\n7)\tshall respond with SIP 200 (OK) response to the SIP PUBLISH request according to TS 24.229 [5], IETF RFC 3903 [34]. In the SIP 200 (OK) response, the MCData server:\na)\tshall set the Expires header field according to IETF RFC 3903 [34], to the selected expiration time;\n8)\tif the \"entity\" attribute of the <presence> element of the application/pidf+xml MIME body of the SIP PUBLISH request is different than the served functional alias ID, shall not continue with the rest of the steps;\n9)\tif the handled MCData ID is different from the MCData ID in the \"id\" attribute of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request, shall not continue with the rest of the steps;\n10)\tshall consider a functional alias information entry such that:\na)\tthe functional alias information entry is in the list of functional alias information entries described in clause 22.2.2.3.2; and\nb)\tthe functional alias ID of the functional alias information entry is equal to the served functional alias ID;\nas the served functional alias information entry;\n11)\tif the selected expiration time is zero:\na)\tshall remove the MCData user information entry such that:\ni)\tthe MCData user information entry is in the list of the MCData user information entries of the served functional alias information entry; and\nii)\tthe MCData user information entry has the MCData ID set to the served MCData ID;\n12)\tif the selected expiration time is not zero:\na)\tshall consider an MCData user information entry such that:\ni)\tthe MCData user information entry is in the list of the MCData user information entries of the served functional alias information entry; and\nii)\tthe MCData ID of the MCData user information entry is equal to the handled MCData ID;\nas the served MCData user information entry;\nb)\tif the MCData user information entry does not exist:\ni)\tshall insert an MCData user information entry with the MCData ID set to the handled MCData ID into the list of the MCData user information entries of the served functional alias information entry; and\nii)\tshall consider the inserted MCData user information entry as the served MCData user information entry; and\nc)\tshall set the expiration time in the served MCData user information entry according to the selected expiration time;\n13)\tshall identify the handled p-id-fa in the <p-id-fa> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request; and\n14)\tshall perform the procedures specified in clause 22.2.2.3.5 for the served functional alias ID.\nNOTE:\tUsage of one SIP SUBSCRIBE request to subscribe for notification about change of functional alias state of several MCData users served by the same MCData server is not supported in this version of the specification.\nUpon receiving a SIP SUBSCRIBE request such that:\n1)\tRequest-URI of the SIP SUBSCRIBE request contains the public service identity of the controlling MCData function associated with the served functional alias;\n2)\tthe SIP SUBSCRIBE request contains an application/vnd.3gpp.mcdata-info+xml MIME body containing the<mcdata-request-uri> element and the <mcdata-calling-user-id> element;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tthe Event header field of the SIP SUBSCRIBE request contains the \"presence\" event type; and\n5)\tthe SIP SUBSCRIBE request contains an application/simple-filter+xml MIME body indicating per-user restrictions of presence event package notification information according to clause 22.3.2 indicating the same MCData ID as in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\nthen the MCData server:\n1)\tshall identify the served functional alias ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\n2)\tshall identify the handled MCData ID in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\n3)\tif the Expires header field of the SIP SUBSCRIBE request is not included or has nonzero value lower than 4294967295, shall send a SIP 423 (Interval Too Brief) response to the SIP SUBSCRIBE request, where the SIP 423 (Interval Too Brief) response contains a Min-Expires header field set to 4294967295, and shall not continue with the rest of the steps;\n4)\tif a functional alias does not exist in the MCData server, shall reject the SIP PUBLISH request with SIP 403 (Forbidden) response to the SIP PUBLISH request according to TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39] and skip the rest of the steps;\n5)\tif the handled MCData ID based on local policy is not authorized for notifications of the functional alias identified by the served functional alias ID, shall reject the SIP SUBSCRIBE request with SIP 403 (Forbidden) response to the SIP SUBSCRIBE request according to TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39] and skip the rest of the steps; and\n6)\tshall generate a SIP 200 (OK) response to the SIP SUBSCRIBE request according to TS 24.229 [5], IETF RFC 6665 [36].\nFor the duration of the subscription, the MCData server shall notify subscriber about changes of the information of the served MCData ID, as described in clause 22.2.2.3.5.\nIn order to notify the subscriber identified by the handled MCData ID about changes of the functional alias status of the served functional alias ID, the MCData server:\n1)\tshall consider a functional alias information entry such that:\na)\tthe functional alias information entry is in the list of functional alias information entries described in clause 22.2.2.3.2; and\nb)\tthe functional alias ID of the functional alias information entry is equal to the served functional alias ID;\n2)\tshall consider an MCData user information entry such:\na)\tthe MCData user information entry is in the list of the MCData user information entries of the served functional alias information entry; and\nb)\tthe MCData ID of the MCData user information entry is equal to the handled MCData ID;\nas the served MCData user information entry;\n3)\tshall generate an application/pidf+xml MIME body indicating per-functional alias information according to clause 22.3.1 and the served list of the served MCData user information entry of the functional alias information entry with following clarifications:\na)\tthe MCData server shall include the \"expires\" attribute in the <functionalAlias> element; and\nb)\tif this procedures is invoked by procedure in clause 22.2.2.3.3 where the handled p-id-fa was identified, the MCData server shall set the <p-id-fa> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP NOTIFY request to the handled p-id-fa value; and\n4)\tsend a SIP NOTIFY request according to 3GPP TS 24.229 [5], and IETF RFC 6665 [36] for the subscription created in clause 22.2.2.3.4. In the SIP NOTIFY request, the MCData server shall include the generated application/pidf+xml MIME body indicating per-functional alias information.\nIn order to deactivate a functional alias associated with a target MCData ID:\n1)\texternally triggered by an MCData administrator by a mechanism outside of the scope of the standard; or\n2)\tdirectly by the MCData function owning the functional alias as a result of an internal trigger like the expiration of the functional alias association;\nthe MCData server\n1)\tshall consider a functional alias information entry such that:\na)\tthe functional alias information entry is in the list of functional alias information entries described in clause 22.2.2.3.2; and\nb)\tthe functional alias ID of the functional alias information entry is equal to the served functional alias ID;\nas the served functional alias information entry;\n2)\tshall remove the MCData user information entry such that:\na)\tthe MCData user information entry is in the list of the MCData user information entries of the served functional alias information entry; and\nb)\tthe MCData user information entry has the MCData ID set to the target MCData ID; and\n3)\tshall perform the procedures specified in clause 22.2.2.3.5 for the served functional alias ID.\nUpon receiving a SIP SUBSCRIBE request such that:\n1)\tRequest-URI of the SIP SUBSCRIBE request contains the public service identity of the controlling MCData function associated with the requested functional alias;\n2)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n3)\tthe Event header field of the SIP SUBSCRIBE request contains the \"presence\" event type; and\n4)\tthe SIP SUBSCRIBE request contains an application/simple-filter+xml MIME body indicating per-functional alias restrictions of presence event package notification information according to clause 22.3.2;\nthen the MCData server:\n1)\tshall identify the requested functional alias ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\n2)\tif the Expires header field of the SIP SUBSCRIBE request is not included or has nonzero value lower than 4294967295, shall send a SIP 423 (Interval Too Brief) response to the SIP SUBSCRIBE request, where the SIP 423 (Interval Too Brief) response contains a Min-Expires header field set to 4294967295, and shall not continue with the rest of the steps;\n3)\tif the requested functional alias does not exist in the MCData server, shall reject the SIP SUBSCRIBE request with SIP 403 (Forbidden) response to the SIP PUBLISH request according to 3GPP TS 24.229 [5], IETF RFC 3903 [34] and IETF RFC 3856 [39] and skip the rest of the steps; and\n4)\tshall generate a SIP 200 (OK) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [5], IETF RFC 6665 [36].\nFor the duration of the subscription, the MCData server shall notify subscriber about changes of the information of the requested functional alias, as described in clause 22.2.2.3.8.\nIn order to notify the subscriber about the MCData users that have successfully activated the functional alias corresponding to the requested functional alias ID, the MCData server:\n1)\tshall consider a functional alias information entry such that:\na)\tthe functional alias information entry is in the list of functional alias information entries described in clause 22.2.2.3.2; and\nb)\tthe functional alias ID of the functional alias information entry is equal to the requested functional alias ID;\n2)\tshall consider any MCData user information entry such that the MCData user information entry is in the list of the MCData user information entries of the served functional alias information entry, as the served MCData user information entry;\n3)\tshall generate an application/pidf+xml MIME body indicating per-functional alias information according to clause 22.3.1 and the served list of the served MCData user information entry of the functional alias information entry\n4)\tsend a SIP NOTIFY request according to 3GPP TS 24.229 [5], and IETF RFC 6665 [36] for the subscription created in clause 22.2.2.3.7. In the SIP NOTIFY request, the MCData server shall include the generated application/pidf+xml MIME body indicating per-functional alias information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "22.3\tCoding",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "22.3.1\tExtension of application/pidf+xml MIME type",
                            "text_content": "The clauses of the parent clause describe an extension of the application/pidf+xml MIME body specified in IETF RFC 3863 [40]. The extension is used to indicate:\n-\tper-user functional alias information; and\n-\tper-functional alias status information.\nThe application/pidf+xml MIME body indicating per-user functional alias information is constructed according to IETF RFC 3863 [40] and:\n1)\tcontains a <presence> root element according to IETF RFC 3863 [40];\n2)\tcontains an \"entity\" attribute of the <presence> element set to the MCData ID of the MCData user;\n3)\tcontains one <tuple> child element according to IETF RFC 3863 [40] per <presence> element;\n4)\tcan contain a <p-id-fa> child element defined in the XML schema defined in table 22.3.1.2-1, of the <presence> element set to an identifier of a SIP PUBLISH request;\n5)\tcontains an \"id\" attribute of the <tuple> element set to the MCData client ID;\n6)\tcontains one <status> child element of each <tuple> element;\n7)\tcontains one <functionalAlias> child element defined in the XML schema defined in table 22.3.1.2-1, of the <status> element, for each functional alias in which the MCData user is interested;\n8)\tcontains a \"functionalAliasID\" attribute of each <fucntionalAlias> element set to the functional alias ID of the functional alias in which the MCData user is interested;;\n9)\tcan contain a \"status\" attribute of each <functionalAliasID> element indicating the activation status of functional alias for the MCData user; and\n10)\tcan contain an \"expires\" attribute of each <functionalAlias> element indicating expiration of activation of the functional alias for the MCData user.\nThe application/pidf+xml MIME body indicating per-functional alias status information is constructed according to IETF RFC 3856 [39] and:\n1)\tcontains the <presence> root element according to IETF RFC 3863 [40];\n2)\tcontains an \"entity\" attribute of the <presence> element set to the functional alias ID of the functional alias;\n3)\tcontains one <tuple> child element according to IETF RFC 3863 [40] of the <presence> element;\n4)\tcan contain a <p-id-fa> child element defined in the XML schema defined in table 22.3.1.2-1, of the <presence> element set to an identifier of a SIP PUBLISH request;\n5)\tcontains an \"id\" attribute of the <tuple> element set to the MCData ID;\n6)\tcontains one <status> child element of each <tuple> element;\n7)\tcontains one <functionalAlias> child element defined in the XML schema defined in table 22.3.1.2-1, of the <status> element, for each MCData ID for which functional alias information is provided;\n8)\tcontains one \"user\" attribute defined in the XML schema defined in table 22.3.1.2-2, of the <functionalAlias> element set to the MCData client ID; and\n9)\tcan contain an \"expires\" attribute defined in the XML schema defined in table 22.3.1.2-2, of the <functionalAlias> element indicating expiration of activation of the functional alias for the MCData user.\nTable 22.3.1.2-1: XML schema with elements and attributes extending the application/pidf+xml MIME body\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema\ntargetNamespace=\"urn:3gpp:ns:mcdataPresInfoFA:1.0\"\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:mcdataPIFA10=\"urn:3gpp:ns:mcdataPresInfoFA:1.0\"\nelementFormDefault=\"qualified\" attributeFormDefault=\"unqualified\">\n\n<!-- MCData functional alias specific child elements of tuple element -->\n<xs:element name=\"functionalAlias\" type=\"mcdataPIFA10:functionalAliasType\"/>\n<xs:complexType name=\"functionalAliasType\">\n<xs:sequence>\n<xs:any namespace=\"##any\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"functionalAliasID\" type=\"xs:anyURI\" use=\"optional\"/>\n<xs:attribute name=\"user\" type=\"xs:anyURI\" use=\"optional\"/>\n<xs:attribute name=\"status\" type=\"mcdataPIFA10:statusType\" use=\"optional\"/>\n<xs:attribute name=\"expires\" type=\"xs:dateTime\" use=\"optional\"/>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:simpleType name=\"statusType\">\n<xs:restriction base=\"xs:string\">\n<xs:enumeration value=\"activating\"/>\n<xs:enumeration value=\"activated\"/>\n<xs:enumeration value=\"deactivating\"/>\n<xs:enumeration value=\"take-over-possible\"/>\n</xs:restriction>\n</xs:simpleType>\n\n<xs:element name=\"p-id-fa\" type=\"xs:string\"/>\n\n<xs:element name=\"take-over\" type=\"xs:boolean\"/>\n\n</xs:schema>\nThe application/pidf+xml MIME body refers to namespaces using prefixes specified in table 22.3.1.2-2.\nTable 22.3.1.2-2: Assignment of prefixes to namespace names in the application/pidf+xml MIME body\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 22.3.1.2-2: Assignment of prefixes to namespace names in the application/pidf+xml MIME body",
                                    "table number": 75,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "22.3.2\tExtension of application/simple-filter+xml MIME type",
                            "text_content": "The clauses of the parent clause describe an extension of the application/simple-filter+xml MIME body specified in IETF RFC 4661 [41].\nThe extension is used to indicate per-user restrictions of presence event package notification information for functional alias information.\nThe application/simple-filter+xml MIME body indicating per-user restrictions of presence event package notification information is constructed according to IETF RFC 4661 [41] and:\n1)\tcontains a <filter-set> root element according to IETF RFC 4661 [41];\n2)\tcontains an <ns-bindings> child element according to IETF RFC 4661 [41], of the <filter-set> element;\n3)\tcontains an <ns-binding> child element according to IETF RFC 4661 [41], of the <ns-bindings> element where the <ns-binding> element:\nA)\tcontains a \"prefix\" attribute according to IETF RFC 4661 [41] set to \"pidf\"; and\nB)\tcontains a \"urn\" attribute set to the \"urn:ietf:params:xml:ns:pidf\" value;\n4)\tcontains a <ns-binding> child element according to IETF RFC 4661 [41], of the <ns-bindings> element where the <ns-binding> element:\nA)\tcontains a \"prefix\" attribute according to IETF RFC 4661 [41], set to \"mcdataPIFA10\"; and\nB)\tcontains an \"urn\" attribute according to IETF RFC 4661 [41], set to the \"urn:3gpp:ns:mcdataPresInfoFA:1.0\" value;\n5)\tcontains a <filter> child element according to IETF RFC 4661 [41], of the <filter-set> element where the <filter> element;\nA)\tcontains an \"id\" attribute set to a value constructed according to IETF RFC 4661 [41];\nB)\tdoes not contain a \"uri\" attribute of the <filter> child element according to IETF RFC 4661 [41]; and\nC)\tdoes not contain a \"domain\" attribute according to IETF RFC 4661 [41];\n6)\tcontains a <what> child element according to IETF RFC 4661 [41], of the <filter> element; and\n7)\tcontains an <include> child element according to IETF RFC 4661 [41], of the <what> element where the <include> element;\nA)\tdoes not contain a \"type\" attribute according to IETF RFC 4661 [41]; and\nB)\tcontains the value, according to IETF RFC 4661 [41], set to concatenation of the '//pidf:presence/pidf:tuple[@id=\"' string, the MCData ID, and the '\"]' string.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "22.4\tFunctional alias to group binding for the MCData user procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "22.4.1\tGeneral",
                            "text_content": "This clause describes the functional alias to group binding for the MCData user procedures for on-network.\nFor on-network functional alias to group binding for the MCData user, the procedures for originating MCData clients, participating MCData functions and controlling MCData function are specified in clause X.2.\nAn MCData user can bind the same functional alias with multiple MCData groups but an MCData user cannot bind multiple functional aliases to the same MCData group.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "22.4.2\tOn-network functional alias to group binding",
                            "text_content": "On request from an MCData user at MCData client, a request to create binding of a functional alias with group for the MCData user is initiated by the MCData client towards the participating MCData function.\nUpon receiving a request from an MCData user to bind a functional alias with an MCData group or a list of MCData groups for the MCData user, if the <allow-functional-alias-binding-with-group> element of the <ruleset> element is not present in the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) or is set to a value of \"false\", the MCData client shall inform the MCData user and shall exit this procedure.\nUpon receiving a request from an MCData user to bind a functional alias with an MCData group or a list of MCData groups for the MCData user, if the requested functional alias is not activated by MCData user at MCData client, the MCData client shall inform the MCData user and shall exit this procedure.\nUpon receiving a request from an MCData user to bind a functional alias with an MCData group for the MCData user, the MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] with the clarifications given below.\nThe MCData client:\n1)\tshall set the Request-URI to the public service identity identifying the participating MCData function serving the MCData user;\n2)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7];\n3)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n4)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according IETF RFC 3841 [8];\n5)\tmay include a P-Preferred-Identity header field in the SIP MESSAGE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n6)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body as specified in clause D.1 with the <mcdatainfo> element containing the <mcdata-Params> element with:\na) the <request-type> element set to a value of \"fa-group-binding-req\";\nb) the <binding-ind> element set to a value of \"true\";\nc) the <binding-fa-uri> element set to the URI of an activated functional alias that shall be bound with the specified list of MCData groups found in the \"uri\" attributes of the <entry> element of the <list> elements of the <resource-lists> element in an application/resource-lists+xml MIME body;\nd) the <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\ne) if the MCData client needs to include an active functional alias in the SIP MESSAGE request, the <anyExt> element of the <functional-alias-URI> element set to the URI of the used functional alias;\n7)\tshall include an application/resource-lists+xml MIME body with one or more <entry> elements of the <list> elements of the <resource-lists> element where each <entry> element contains a \"uri\" attribute set to an MCData group ID; and\n8)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP MESSAGE request, the MCData client shall inform the MCData user of success in binding of a functional alias with the MCData group or list of MCData groups for the MCData user.\nOn receiving a SIP 4xx response a SIP 5xx response or a SIP 6xx response to the SIP MESSAGE request, the MCData client shall inform the MCData user of unsuccess in binding of a functional alias with the MCData group or list of MCData groups for the MCData user, possibly taking into account Warning header information for the failure reason.\nUpon receiving a request from an MCData user to unbind a functional alias with an MCData group or a list of MCData groups for the MCData user, if the <allow-functional-alias-binding-with-group> element of the <ruleset> element is not present in the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) or is set to a value of \"false\", the MCData client shall inform the MCData user and shall exit this procedure.\nUpon receiving a request from an MCData user to unbind a functional alias with an MCData group for the MCData user, the MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] with the clarifications given below.\nThe MCData client:\n1)\tshall set the Request-URI to the public service identity identifying the participating MCData function serving the MCData user;\n2)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7];\n3)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n4)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according IETF RFC 3841 [8];\n5)\tmay include a P-Preferred-Identity header field in the SIP MESSAGE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n6)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body as specified in clause D.1 with the <mcdatainfo> element containing the <mcdata-Params> element with:\na) the <request-type> element set to a value of \"fa-group-binding-req\";\nb) the <binding-ind> element set to a value of \"false\";\nc) the <unbinding-fa-uri> element set to the URI of a functional alias that shall be unbound from the specified list of MCData groups found in the \"uri\" attributes of the <entry> elements of the <list> elements of the <resource-lists> element in an application/resource-lists+xml MIME body;\nd) the <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\ne) if the MCData client needs to include an active functional alias in the SIP MESSAGE request, the <anyExt> element of the <functional-alias-URI> element set to the URI of the used functional alias;\n7)\tshall include an application/resource-lists+xml MIME body with one or more <entry> elements in one or more <list> elements in the <resource-lists> element where each <entry> element contains a \"uri\" attribute set to an MCData group ID; and\n8)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP MESSAGE request, the MCData client shall inform the MCData user of success in unbinding the functional alias with the MCData group or list of MCData groups for the MCData user.\nOn receiving a SIP 4xx response a SIP 5xx response or a SIP 6xx response to the SIP MESSAGE request, the MCData client shall inform the MCData user of unsuccess in unbinding of a functional alias with the MCData group or list of MCData groups for the MCData user, possibly taking into account Warning header information for the failure reason.\nThe participating MCData function has procedures to:\n-\treceive a request for binding/unbinding of a functional alias with the MCData group(s) for the MCData user from the MCData client.\nUpon receipt of a \"SIP MESSAGE request for binding of a functional alias with the MCData group(s) for the MCData user for originating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall determine the MCData ID of the calling user from the public user identity in the P-Asserted-Identity header field of the SIP MESSAGE request;\nNOTE 1:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request is set to a value of \"fa-group-binding-req\" and:\na)\tthe <allow-functional-alias-binding-with-group> element of the <ruleset> element is not present in the MCData user profile document (see the MCData user profile document in 3GPP TS 24.484 [12]) or is set to a value of \"false\", shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"176 user not authorized to request for binding/unbinding of a functional alias with the MCData group(s) for the MCData user\" in a Warning header field, and shall not continue with the rest of the steps in this clause;\nb)\tthe SIP MESSAGE request does not contain an application/resource-lists+xml MIME body or the <binding-ind> element and the <binding-fa-uri> element in the application/vnd.3gpp.mcdata-info+xml MIME body, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"177 unable to determine target functional alias or group for creating/removing a binding information for the MCData user\" in a Warning header field, and shall not continue with the rest of the steps in this clause; and\nc)\tthe SIP MESSAGE request does not contain an application/resource-lists+xml MIME body or the <binding-ind> element and the <unbinding-fa-uri> element in the application/vnd.3gpp.mcdata-info+xml MIME body, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"177 unable to determine target functional alias or group for creating/removing a binding information for the MCData user\" in a Warning header field, and shall not continue with the rest of the steps in this clause;\n5)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n6)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the controlling MCData function for the binding of a functional alias with the MCData group(s) for the MCData user service associated with the originating user's MCData ID identity;\n7)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body in the received SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body as specified in clause D.1 included in the outgoing SIP MESSAGE request;\n8)\tif the received SIP MESSAGE request contains a <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body, shall check the status of the functional alias for the MCData ID. If the functional alias status is activated, then the participating MCData function shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request to the received value, otherwise it shall not include a <functional-alias-URI> element;\n9)\tshall set the <mcdata-calling-user-id> element of the <mcdatainfo> element containing the <mcdata-Params> element to the MCData ID determined in step 2) above;\n10)\tshall copy the contents of the application/resource-lists+xml MIME body in the received SIP MESSAGE request into an application/resource-lists+xml MIME body in the outgoing SIP MESSAGE request;\n11)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function;\n12)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n13)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n14)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), into the P-Asserted-Service header field of the outgoing SIP MESSAGE request; and\n15)\tshall send the SIP MESSAGE request as specified to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 2xx response in response to the SIP MESSAGE request sent in step 15), the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5] with the following clarifications:\na)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function; and\n2)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the SIP MESSAGE request, the participating MCData function shall forward the error response to the MCData client.\nThe participating MCData function has procedures to:\n-\treceive a request for binding/unbinding of a functional alias with the MCData group(s) for the MCData user from the MCData client.\nUpon receiving a:\n-\t\"SIP MESSAGE request for binding of a functional alias with the MCData group(s) for the MCData user for controlling MCData function\";\nthe controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if an Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\";\n3)\tthe SIP MESSAGE request does not contain an application/resource-lists+xml MIME body or the <binding-ind> element and the <binding-fa-uri> element in the application/vnd.3gpp.mcdata-info+xml MIME body, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"177 unable to determine target functional alias or group for creating/removing a binding information for the MCData user\" in a Warning header field, and shall not continue with the rest of the steps in this clause;\n4)\tthe SIP MESSAGE request does not contain an application/resource-lists+xml MIME body or the <binding-ind> element and the <unbinding-fa-uri> element in the application/vnd.3gpp.mcdata-info+xml MIME body, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"177 unable to determine target functional alias or group for creating/removing a binding information for the MCData user\" in a Warning header field, and shall not continue with the rest of the steps in this clause;\n5)\tif any of the <entry> elements of a <list> element of the <resource-lists> element in the application/resource-lists+xml MIME body of the incoming SIP MESSAGE request contains a \"uri\" attribute set to an MCData group ID where the indicated MCData group has an existing binding with any other functional alias from same MCData user, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"178 MCData group binding already exists with other functional alias\" in a Warning header field as specified in clause 4.9, and shall skip the rest of the steps;\n6)\tif the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request contains the <request-type> element set to a value of \"fa-group-binding-req\" and:\na)\tif the <binding-ind> element is set to a value of \"true\", shall update or store the record for the MCData client, and create a binding information for the functional alias specified in the <binding-fa-uri> element with the list of the MCData group(s) included in the \"uri\" attributes of the <entry> elements of the set of <list> elements of the <resource-lists> element in an application/resource-lists+xml MIME body; or\nb)\tif the <binding-ind> element is set to a value of \"false\", shall update or store the record for the MCData client, and remove a binding information of the functional alias specified in the <unbinding-fa-uri> element from the list of the MCData group(s) included in the \"uri\" attributes of the <entry> elements of the set of <list> elements of the <resource-lists> element in an application/resource-lists+xml MIME body;\n7)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5] with the following clarifications:\na)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the controlling MCData function; and\n8)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "23\tRegroup using a preconfigured group",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "23.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "In the procedures in this clause:\n1)\ttemporary group identity in an incoming SIP MESSAGE request refers to the temporary group identity from the <mcdata-regroup-uri> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body of the incoming SIP MESSAGE request; and\n2)\tpreconfigured group identity in an incoming SIP MESSAGE request refers to the the group identity from the <preconfigured-group> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body of the incoming SIP MESSAGE request.\nRegroup using a preconfigured group refers to the creation of a user/group regroup based on the configuration information associated with an existing group that is referred to as the preconfigured group. A regroup takes its entire configuration from the preconfigured group, including security keys. If the preconfigured group document contains a <listserv> element that contains a <preconfigured-group-use-only> element, that <preconfigured-group-use-only> element is not included in the configuration of the regroup.\nAll MCData servers and all MCData clients are configured with the preconfigured group to allow immediate use of the regroup for a call upon creation of the regroup.\nA regroup using a preconfigured group is initiated by the MCData client referencing a preconfigured group document in the GMS. The advantage of regroup using a preconfigured group is speed of setup of the group, especially when large numbers of users (e.g., thousands) are involved. Control of the regroup using a preconfigured group is focused in the controlling MCData function. Creation and removal of a regoup is normally initiated by an MCData client. Removal can also be initiated by the controlling MCData function.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "23.2\tGroup regroup using a preconfigured group",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "23.2.1\tClient procedures",
                            "text_content": "Upon receiving a request from an MCData user to establish an MCData group regroup using a preconfigured group, the MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] and:\n1)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n2)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n3)\tshall set the Request-URI to the public service identity identifying the originating participating MCData function serving the MCData user;\n4)\tmay include a P-Preferred-Identity header field in the SIP MESSAGE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n5)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7];\n6)\tshall contain an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\na)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\nb)\tif the MCData client is aware of active functional aliases, and an active functional alias is to be included in the SIP MESSAGE request, the <anyExt> element of the <functional-alias-URI> element set to the URI of the used functional alias;\n7)\tshall contain an application/vnd.3gpp.mcdata-regroup+xml MIME body with:\na)\tthe <regroup-action> element set to the value \"create\";\nb)\tthe <mcdata-regroup-uri> element set to a unique temporary group identity URI;\nNOTE:\tHow the unique temporary group identity URI is formed is an implementation decision.\nc)\tthe <preconfigured-group> element set to the group identity of the preconfigured group; and\nd)\tthe <groups-for-regroup> element set to the list of MCData group identities of groups that are to be included in the regroup; and\n8)\tshall send the SIP MESSAGE request according to 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP MESSAGE request, the MCData client:\n1)\tshould notify the MCData user of the successful creation of the group regroup using preconfigured group.\nOn receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request:\n1)\tshould notify the MCData user of the failure to create the group regroup using preconfigured group.\nUpon receiving a request from an MCData user to remove a user or group regroup using a preconfigured group, the MCData client:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]:\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n3)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n4)\tshall set the Request-URI to the public service identity identifying the originating participating MCData function serving the MCData user;\n5)\tmay include a P-Preferred-Identity header field in the SIP INVITE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n6)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7];\n7)\tshall contain an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\na)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\nb)\tif the MCData client is aware of active functional aliases, and an active functional alias is to be included in the SIP MESSAGE request, the <anyExt> element of the <functional-alias-URI> element set to the URI of the used functional alias;\n8)\tshall contain an application/vnd.3gpp.mcdata-regroup+xml MIME body with:\na)\tthe <mcdata-regroup-uri> element set to the unique temporary group identity URI representing the regroup to be removed; and\nb)\tthe <regroup-action> element set to \"remove\"; and\n9)\tshall send the SIP MESSAGE request according to 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP MESSAGE request, the MCData client:\n1)\tshould notify the MCData user of the successful removal of the regroup using preconfigured group.\nOn receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request:\n1)\tshould notify the MCData user of the failure to remove the regroup using preconfigured group.\nUpon receiving a \"SIP MESSAGE request to the MCData client to request creation of a regroup using preconfigured group\", the MCData client:\n1)\tshould notify the MCData user of the creation of the regroup using preconfigured group;\n2)\tshall send a 200 (OK) response to the MCData server according to 3GPP TS 24.229 [5];\n3)\tin the application/vnd.3gpp.mcdata-regroup+xml MIME body contained in the incoming SIP MESSAGE request:\na)\tshall store the value of the <mcdata-regroup-uri> element as the temporary group identity and associate that with the group identity received in the <mcdata-regroup-uri> element;\nb)\tif a <users-for-regroup> element is included in that MIME body, should store the contents of the <users-for-regroup> element as the list of the users that are part of that regroup and shall consider the regroup as a user regroup; and\nNOTE 1:\tThe MCData client can choose to display the list of users in the user regroup to the MCData user.\nc)\tif a <groups-for-regroup> element is included in that MIME body, should store the contents of the <groups-for-regroup> element as the list of groups that are part of that regroup and shall consider the regroup as a group regroup;\nNOTE 2:\tThe MCData client can choose to display the list of groups in the group regroup to the MCData user.\na)\tif a <users-for-regroup> element is included in that MIME body, shall store the value of the <mcdata-regroup-uri> element as the temporary group identity and associate that with the group identity received in the <mcdata-regroup-uri> element, along with the information that the created regroup is a user regroup and should store the contents of the <users-for-regroup> element as the list of the users that are part of that user regroup: or\nb)\tif a <groups-for-regroup> element is included in that MIME body, shall store the value of the <mcdata-regroup-uri> element as the temporary group identity and associate that with the group identity received in the <mcdata-regroup-uri> element, along with the information that the created regroup is a group regroup and should store the contents of the <groups-for-regroup> element as the list of groups that are part of that group regroup:\n4)\tshall consider that the MCData Client is affiliated with the regroup;\n5)\tshould not initiate calls targeting any of the constituent groups but instead target the regroup for the duration of a group regroup; and\n6)\tif the regroup is a chat group, the MCData client should join the regroup when this notification of creation is received.\nUpon receiving a \"SIP MESSAGE request to the MCData client to request removal of a regroup using preconfigured group\", the MCData client:\n1)\tshould notify the MCData user of the removal of the regroup using preconfigured group;\n2)\tshall send a 200 (OK) response to the MCData server according to 3GPP TS 24.229 [5]; and\n3)\tshall consider that the MCData client is de-affiliated from the regroup.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "23.2.2\tParticipating MCData function procedures",
                            "text_content": "In the procedures in this clause:\n1)\ttemporary group identity in an incoming SIP MESSAGE request refers to the temporary group identity from the <mcdata-regroup-uri> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body of the incoming SIP MESSAGE request; and\n2)\tpreconfigured group identity in an incoming SIP MESSAGE request refers to the the group identity from the <preconfigured-group> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body of the incoming SIP MESSAGE request.\nUpon receipt of a \"SIP MESSAGE request to the originating participating MCData function to request creation of a group regroup using preconfigured group\", the originating participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The originating participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. The originating participating MCData function shall skip the rest of the steps;\n2)\tshall determine the MCData ID of the user from the public user identity in the P-Asserted-Identity header field of the SIP MESSAGE request;\n3)\tshall authorise the user. If the user profile identified by the MCData ID does not contain an <allow-regroup> element set to \"true\", the originating participating MCData function shall reject the \"SIP MESSAGE request to the originating participating MCData function to request creation of a group regroup using preconfigured group\" with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"160 user not authorised to request creation of a group regroup\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of these steps;\n4)\tshall select a controlling MCData function to manage the regroup and determine the public service identity of that controlling MCData function;\nNOTE 1:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the origination participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n5)\tshall generate an outgoing SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] and:\na)\tshall include in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\nb)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the controlling MCData function selected in step 4);\nc)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request;\nd)\tshall copy the contents of the application/vnd.3gpp.mcdata-regroup+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-regroup+xml MIME body included in the outgoing SIP MESSAGE request; and\ne)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function; and\n6)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 480 (Temporarily Unavailable) response to the above SIP MESSAGE request, the originating participating MCData function:\n1)\tshall select a different controlling MCData function to manage the regroup and determine the public service identity of that controlling MCData function;\nNOTE 6:\tHow the originating participating MCData function whether it decides to retry is a deployment decision.\n2)\tshall generate a SIP MESSAGE request as specified in this clause with the Request-URI of the outgoing SIP MESSAGE request set to the public service identity of the controlling MCData function selected in step 1); and\n3)\tshall forward the SIP MESSAGE request according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 2xx response to the above SIP MESSAGE request, the originating participating MCData function shall send a SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of any SIP 4xx response other than a 480 response, or a SIP 5xx or 6xx response to the above SIP MESSAGE request, the originating participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a \"SIP MESSAGE request to the originating participating MCData function to remove a regroup using preconfigured group\" for a temporary group identity, the originating participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The originating participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. The originating participating MCData function shall skip the rest of the steps;\n2)\tshall determine the MCData ID of the user from the public user identity in the P-Asserted-Identity header field of the SIP MESSAGE request;\n3)\tshall authorise the user. If the user profile identified by the MCData ID does not contain an <allow-regroup> element set to \"true\", the originating participating MCData function shall reject the \"SIP MESSAGE request to remove a regroup using preconfigured group\" with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"161 user not authorised to request removal of a regroup \" in a Warning header field as specified in clause 4.9, and shall skip the rest of these steps;\n4)\tshall determine the public service identity of the controlling MCData function associated with the regroup identity in the SIP MESSAGE request;\nNOTE 1:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the origination participating MCData function determines the public service identity of the controlling MCData function serving the target MCData ID or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\n5)\tshall generate an outgoing SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] and:\na)\tshall include in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\nb)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the controlling MCData function determined in step 4;\nc)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request;\nd)\tshall copy the contents of the application/vnd.3gpp.mcdata-regroup+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-regroup+xml MIME body included in the outgoing SIP MESSAGE request; and\ne)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function; and\n6)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 2xx response to the above SIP MESSAGE request, the originating participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in the clause 6.3.2.1.5.2;\n2)\tshall include Warning header field(s) that were received in the incoming SIP 200 (OK) response;\n3)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function; and\n4)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP MESSAGE request, the originating participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\nWhen receiving a \"SIP MESSAGE request to the terminating participating MCData function to create a group regroup using preconfigured group\", the terminating participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The terminating participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. The terminating participating MCData function shall skip the rest of the steps;\n2)\tshall send a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n3)\tfor each MCData ID contained in the <users-for-regroup> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body, the terminating participating MCData function:\na)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]:\nb)\tshall include in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\nc)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public user identity associated with the MCData ID;\nd)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request;\ne)\tshall copy the contents of the application/vnd.3gpp.mcdata-regroup+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-regroup+xml MIME body included in the outgoing SIP MESSAGE request with the exception that any <users-for-regroup> elements shall not be copied;\nf)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function;\ng)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5]; and\nh)\tshall consider the MCData ID as affiliated with the temporary group identity representing the regroup identified in the <mcdata-regroup-uri> element in the incoming SIP MESSAGE request; and\n4)\tshall store:\na)\tthe value of the <mcdata-regroup-uri> element as the identity of the regroup based on a preconfigured group;\nb)\tthe value of the <preconfigured-group> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body as the identity of the preconfigured group; and\nc)\tthe set of MCData IDs contained in the <users-for-regroup> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body as the list of the users that are members of the group regroup;\nuntil the regroup is removed.\nWhen receiving a \"SIP MESSAGE request to the terminating participating MCData function to remove a regroup using preconfigured group\", the terminating participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The terminating participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. The terminating participating MCData function shall skip the rest of the steps;\n2)\tshall generate a SIP 200 (OK) response in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] and shall send the SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n3)\tfor each served MCData ID affiliated with the temporary group identity in the incoming SIP MESSAGE, the terminating participating MCData function:\na)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]:\nb)\tinclude in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\nc)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public user identity associated with the MCData ID;\nd)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request;\ne)\tshall copy the contents of the application/vnd.3gpp.mcdata-regroup+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-regroup+xml MIME body included in the outgoing SIP MESSAGE request, with the exceptions that any <users-for-regroup> or <groups-for-regroup> elements shall not be copied;\nf)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function;\ng)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5];and\nh)\tshall consider the MCData ID as deaffiliated from the regroup.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "23.2.3\tControlling MCData function procedures",
                            "text_content": "When receiving a \"SIP MESSAGE request to the controlling MCData function to request creation of a group regroup using preconfigured group\" the controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response,may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4], and shall skip the rest of the steps;\n2)\tif the controlling MCData function is not able to handle the regroup based on the MCData group indicated in the <preconfigured-group> element in an application/vnd.3gpp.mcdata-regroup+xml MIME body:\na)\tshall generate a SIP 480 (Temporarily Unavailable) response to the incoming SIP MESSAGE request; and\nb)\tshall send the SIP 480 (Temporarily Unavailable) response as specified in 3GPP TS 24.229 [5] and skip the rest of the steps;\n3)\tif the controlling MCData function determines that the proposed group ID for the regroup is already in use, shall reject the \"SIP MESSAGE request to the controlling MCData function to request creation of a group regroup using preconfigured group\" with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"165 group ID for regroup already in use\" in a Warning header field as specified in clause 4.9, and shall skip the rest of the steps;\n4)\tfor each group identified in the <groups-for-regroup> element:\na)\tshall determine the controlling MCData function serving that group;\nNOTE 1:\tThe public service identity can identify the controlling MCData function serving that group in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the controlling MCData function serving that group is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the controlling MCData function serving that group is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the controlling MCData function serving that group or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\nNOTE 6\tThe controlling MCData function serving a consitituent group assumes the role of a non-controlling MCData function for the regroup.\nb)\tshall generate an outgoing SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\nc)\tshall include in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\nd)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the non-controlling MCData function;\ne)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request;\nf)\tshall copy the contents of the application/vnd.3gpp.mcdata-regroup+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-regroup+xml MIME body included in the outgoing SIP MESSAGE request;\ng)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the controlling MCData function; and\nh)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5];\n5)\tshall wait to receive SIP responses from all of the non-controlling MCData functions that were sent a SIP MESSAGE request above;\n6)\tif all of the SIP responses received above are SIP 200 (OK) responses:\na)\tshall send a SIP 200 (OK) response in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\nb)\tshall store the list of group identities contained in the <groups-for-regroup> element;\nc)\tshall store the value of the <mcdata-regroup-uri> element as the identity of the group regroup based on a preconfigured group; and\nd)\tshall store the value of the preconfigured-group> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body as the identity of the preconfigured group; and\n7)\tif at least one of the SIP responses received above is not a SIP 2xx response:\na)\tshall send a SIP 480 (Temporarily Unavailable) response in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\nb)\tfor each non-controlling MCData function that returned a SIP 200 (OK) response in step 4:\ni)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\nii)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the non-controlling MCData function;\niii)\tshall include an application/vnd.3gpp.mcdata-regroup+xml MIME body in the outgoing SIP MESSAGE request with;\nA)\tan <mcdata-regroup-uri> element set to the identity of the regroup; and\nB)\ta <regroup-action> element set to \"remove\"; and\niv)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nWhen receiving a \"SIP MESSAGE request to the controlling MCData function to remove a regroup using preconfigured group\" the controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. The controlling MCData function shall skip the rest of the steps;\n2)\tif the controlling MCData function determines that the requested group ID for the regroup removal does not exist, shall reject the \"SIP MESSAGE request to the controlling MCData function to remove a regroup using preconfigured group\" with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"163 the group identity indicated in the request does not exist\" in a Warning header field as specified in clause 4.9, and shall skip the rest of the steps;\n3)\tshall send a SIP 200 (OK) response in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n4)\tif the regroup is a group regroup based on preconfigured group, then:\na)\tfor each constituent group belonging to the regroup:\ni)\tshall determine the non-controlling MCData function serving that group;\nii)\tshall generate an outgoing SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\niii)\tshall include in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\niv)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the non-controlling MCData function;\nNOTE 1:\tThe public service identity can identify the non-controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the non-controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the non-controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the non-controlling MCData function or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\nv)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request;\nvi)\tshall copy the contents of the application/vnd.3gpp.mcdata-regroup+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-regroup+xml MIME body included in the outgoing SIP MESSAGE request;\nvii)\t\t shall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the controlling MCData function; and\nviii)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5]; and\n5)\tif the regroup is a user regroup based on preconfigured group, then for each user belonging to the regroup, the controlling MCData function shall create a separate list of MCData IDs for users belonging to and affiliated with the regroup who are served by the same terminating participating MCData function and for each terminating participating MCData function;\na)\tshall generate an outgoing SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\nb)\tshall include in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\nc)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the terminating participating MCData function;\nNOTE 6:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 7:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 8:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 9:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 10:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\nd)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request;\ne)\tshall copy the contents of the application/vnd.3gpp.mcdata-regroup+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-regroup+xml MIME body included in the outgoing SIP MESSAGE request;\nf)\tshall use the list of affiliated MCData IDs for this terminating participating MCData function to create and include a <users-for-regroup> element contained in the application/vnd.3gpp.mcdata-regroup+xml MIME body;\ng)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the controlling MCData function; and\nh)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nWhen the controlling MCData function decides to remove a regroup using preconfigured group, the controlling MCData function:\n1)\tif the regroup is a group regroup based on preconfigured group, then:\na)\tfor each constituent group belonging to the regroup:\ni)\tshall determine the non-controlling MCData function serving that group;\nNOTE 1:\tThe public service identity can identify the non-controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the non-controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the non-controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the non-controlling MCData function or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\nii)\tshall generate an outgoing SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\niii)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the non-controlling MCData function determined in step i);\niv)\tshall create an application/vnd.3gpp.mcdata-regroup+xml MIME body and include it in the outgoing SIP MESSAGE request with:\nA)\tan <mcdata-regroup-uri> element set to the identity of the regroup;\nB)\ta <regroup-action> element set to \"remove\"; and\nv)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5]; and\n2)\tif the regroup is a user regroup based on preconfigured group, then the controlling MCData function shall create a list of terminating participating MCData functions serving users belonging to and affiliated with the regroup and shall create a list of MCData IDs that are affiliated to the regroup and served by the same terminating partificpating MCData function for each of the members of the list of terminating participating MCData functions, and for each terminating participating MCData function in the list:\na)\tshall generate an outgoing SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\nb)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the terminating participating MCData function;\nNOTE 6:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 7:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 8:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 9:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 10:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\nc)\tshall create an application/vnd.3gpp.mcdata-regroup+xml MIME body and include it in the outgoing SIP MESSAGE request with:\ni)\tan <mcdata-regroup-uri> element set to the identity of the regroup;\nii)\ta <regroup-action> element set to \"remove\"; and\niii)\ta <users-for-regroup> element set to the list of MCData IDs served by this terminating participating MCData function that are affiliated to the regroup; and\nd)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "23.2.4\tNon-controlling MCData function procedures",
                            "text_content": "When receiving a \"SIP MESSAGE request to a non-controlling MCData function to request creation of a group regroup using preconfigured group\" the non-controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response, may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4], and shall skip the rest of the steps;\n2)\tor each group identified in the <groups-for-regroup> element of an application/vnd.3gpp.mcdata-regroup+xml MIME body in the incoming SIP MESSAGE request for which the MCData function is the non-controlling MCData function:\na)\tshall determine if the group is already regrouped, and if the group is already regrouped:\ni)\tshall reject the SIP request with a SIP 403 (Forbidden) response including warning text set to \"148 group is regrouped\" in a Warning header field as specified in clause 4.9; and\nii)\tshall not process the remaining steps;\n3)\tshall store:\na)\tthe list of group identities contained in the <groups-for-regroup> element;\nb)\tthe value of the <mcdata-regroup-uri> element as the identity of the group regroup;\nc)\tthe value of the <preconfigured-group> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body as the identity of the preconfigured group; and\nd)\tinformation that each of the groups identified in the <groups-for-regroup> element has been regrouped using a preconfigured group;\n4)\tshall send a SIP 200 (OK) response in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]:\n5)\tfor each group identified in the <groups-for-regroup> element of an application/vnd.3gpp.mcdata-regroup+xml MIME body in the incoming SIP MESSAGE request for which the MCData function is the non-controlling MCData function shall create a separate list of MCData IDs for users belonging to and affiliated with the identified group who are served by the same terminating participating MCData function;\n6)\tshall merge the lists of MCData IDs associated with each terminating participating MCData function such that the resulting list associated with a terminating participating MCData function contains the MCData IDs of all users served by the participating MCData function that belong to and are affiliated with any of the groups identified in the <groups-for-regroup> element; and\n7)\tfor each terminating participating MCData function identified above:\na)\tshall generate an outgoing SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\nb)\tshall include in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\nc)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the terminating participating MCData function;\nd)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request;\ne)\tshall copy the contents of the application/vnd.3gpp.mcdata-regroup+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-regroup+xml MIME body included in the outgoing SIP MESSAGE request;\nf)\tshall use the list of MCData IDs for this terminating participating MCData function as generated in step 6) to create and include the <users-for-regroup> element in the application/vnd.3gpp.mcdata-regroup+xml MIME body;\ng)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the non-controlling MCData function; and\nh)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nWhen receiving a \"SIP MESSAGE request to the non-controlling MCData function to remove a group regroup using preconfigured group\" the non-controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The non-controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. The non-controlling MCData function shall skip the rest of the steps;\n2)\tshall send a SIP 200 (OK) response in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]:\n3)\tshall identify the constituent groups belonging to the regroup identified in the <mcdata-regroup-uri> in the application/vnd.3gpp.mcdata-regroup+xml MIME body contained in the incoming SIP MESSAGE for which this MCData function is the non-controlling MCData function  and shall create a list of terminating participating MCData functions serving MCData IDs belonging to the identified constituent groups and for each member of the list of terminating participating MCData functions in the list shall create a list of MCData IDs affiuliated to the regroup and served by that terminating participating MCData function;\n4)\tfor each terminating participating MCData function identified in step 3):\na)\tshall generate an outgoing SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\nb)\tshall include in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\nc)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the terminating participating MCData function;\nd)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request;\ne)\tshall copy the contents of the application/vnd.3gpp.mcdata-regroup+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-regroup+xml MIME body included in the outgoing SIP MESSAGE request;\ni) shall create and include a <users-for-regroup> element containing the list of MCData IDs affiliated to the regroup that are served by this terminating participating MCData function as determined in step 3); and\nf)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the non-controlling MCData function; and\ng)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nWhen a non-controlling MCData function becomes aware of an MCData client affiliating with a group that it controls, where that group is a constituent group of a group regroup using preconfigured group, the non-controlling MCData function:\n1)\tshall create a list of MCData IDs for users belonging to and affiliated with the identified constituent group who are served by the same terminating participating MCData function as the MCData client affiliating with the constituent group;\n2)\tshall generate an outgoing SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n3)\tshall create in the SIP MESSAGE request copies of all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the SIP MESSAGE request received from the controlling MCData function for the group regroup to notify creation of the group regroup using preconfigured group;\n4)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the terminating participating MCData function;\n5)\tshall create an application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request using the information from the application/vnd.3gpp.mcdata-info+xml MIME body originally included in the SIP MESSAGE request received from the controlling MCData function for the group regroup to notify creation of the group regroup using preconfigured group;\n6)\tshall create an application/vnd.3gpp.mcdata-regroup+xml MIME body in the outgoing SIP MESSAGE request using the information from the application/vnd.3gpp.mcdata-regroup+xml MIME body originally included in the SIP MESSAGE request received from the controlling MCData function for the group regroup to notify creation of the group regroup using preconfigured group;\n7)\tshall use the list of MCData IDs as generated in step 1) to create and include the <users-for-regroup> element in the application/vnd.3gpp.mcdata-regroup+xml MIME body;\n8)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the non-controlling MCData function; and\n9)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "23.3\tUser regroup using a preconfigured group",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "23.3.1\tClient procedures",
                            "text_content": "Upon receiving a request from an MCData user to establish an MCData user regroup using a preconfigured group, the MCData client shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] and:\n1)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\n2)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\n3)\tshall set the Request-URI to the public service identity identifying the originating participating MCData function serving the MCData user;\n4)\tmay include a P-Preferred-Identity header field in the SIP MESSAGE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n5)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7];\n6)\tshall contain an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\na)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\nb)\tif the MCData client is aware of active functional aliases, and an active functional alias is to be included in the SIP MESSAGE request, the <anyExt> element of the <functional-alias-URI> element set to the URI of the used functional alias;\n7)\tshall contain an application/vnd.3gpp.mcdata-regroup+xml MIME body with:\na)\tthe <mcdata-regroup-uri> element set to a unique temporary group identity URI;\nNOTE:\tHow the unique temporary group identity URI is formed is an implementation decision.\nb)\tthe <preconfigured-group> element set to the group identity of the preconfigured group;\nc)\tthe <regroup-action> element set to \"create\"; and\nd)\tthe <users-for-regroup> element set to the list of MCData IDs of users that are to be included in the regroup; and\n8)\tshall send the SIP MESSAGE request according to 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP MESSAGE request, the MCData client:\n1)\tshould notify the MCData user of the successful creation of the user regroup using preconfigured group.\nOn receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request:\n1)\tshould notify the MCData user of the failure to create the user regroup using preconfigured group.\nWhen the user requests the MCData client to remove a user regroup, the MCData client uses the procedure in clause 23.2.1.2.\nThe procedure in clause 23.2.1.3 is used by the MCData client when the MCData server notifies the MCData client of the creation of a user regroup using preconfigured group.\nThe procedure in clause 23.2.1.4 is used by the MCData client when the MCData server notifies the MCData client of the removal of a user regroup using preconfigured group.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "23.3.2\tParticipating MCData function procedures",
                            "text_content": "In the procedures in this clause:\n1)\ttemporary group identity in an incoming SIP MESSAGE request refers to the temporary group identity from the <mcdata-regroup-uri> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body of the incoming SIP MESSAGE request; and\n2)\tpreconfigured group identity in an incoming SIP MESSAGE request refers to the the group identity from the <preconfigured-group> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body of the incoming SIP MESSAGE request.\nUpon receipt of a \"SIP MESSAGE request to the originating participating MCData function to request creation of a user regroup using preconfigured group\", the originating participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The originating participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. The originating participating MCData function shall skip the rest of the steps;\n2)\tshall determine the MCData ID of the user from the public user identity in the P-Asserted-Identity header field of the SIP MESSAGE request;\n3)\tshall authorise the user. If the user profile identified by the MCData ID does not contain an <allow-regroup> element set to \"true\", the originating participating MCData function shall reject the \"SIP MESSAGE request to the originating participating MCData function to request creation of a user regroup using preconfigured group\" with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"160 user not authorised to request creation of a regroup\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of these steps;\n4)\tshall select a controlling MCData function to manage the regroup and determine the public service identity of the controlling MCData function;\nNOTE 1:\tThe public service identity can identify the controlling MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the controlling MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the originating participating MCData function determines the public service identity of the controlling MCData function or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\nNOTE 6:\tHow the originating participating MCData function selects a controlling MCData function to manage the regroup is a deployment decision.\n5)\tshall generate an outgoing SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6] and:\na)\tshall include in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\nb)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the controlling MCData function determined in step 4);\nc)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request; and\nd)\tshall copy the contents of the application/vnd.3gpp.mcdata-regroup+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-regroup+xml MIME body included in the outgoing SIP MESSAGE request; and\ne)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function; and\n6)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 480 (Temporarily Unavailable) response to the above SIP MESSAGE request, the originating participating MCData function:\n1)\tshall select a different controlling MCData function to manage the regroup and determine the public service identity of that controlling MCData function;\n2)\tshall generate a SIP MESSAGE request as specified in this clause with the Request-URI of the outgoing SIP MESSAGE request set to the public service identity of the controlling MCData function selected in step 1); and\n3)\tshall forward the SIP MESSAGE request according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 2xx response to the above SIP MESSAGE request, the originating participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in the clause 6.3.2.1.5.2;\n2)\tshall include Warning header field(s) that were received in the incoming SIP 200 (OK) response;\n3)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function; and\n4)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx response that is not a 480 response, or a SIP 5xx or 6xx response to the above SIP MESSAGE request, the originating participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\nWhen the originating participating MCData function needs to remove a user regroup, the originating participating MCData function uses the procedure in clause 23.2.2.3.\nWhen receiving a \"SIP MESSAGE request to the terminating participating MCData function to create a user regroup using preconfigured group\", the terminating participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. The terminating participating MCData function shall skip the rest of the steps;\n2)\tshall send a SIP 200 (OK) response in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\n3)\tfor each MCData ID contained in the <users-for-regroup> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body, the terminating participating MCData function is aware from stored information that the MCData client has not previously been notified of the creation of the user regroup:\na)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6]:\nb)\tinclude in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\nc)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public user identity associated with the MCData ID;\nd)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request;\ne)\tshall copy the contents of the application/vnd.3gpp.mcdata-regroup+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-regroup+xml MIME body included in the outgoing SIP MESSAGE request, with the exception that any <groups-for-regroup> elements shall not be copied;\nf)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the participating MCData function;\ng)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5]; and\nh)\tshall consider the MCData ID as affiliated with the temporary group identity representing the regroup identified in the <mcdata-regroup-uri> element in the incoming SIP MESSAGE request; and\n4)\tshall store:\na)\tthe value of the <mcdata-regroup-uri> element as the identity of the regroup based on a preconfigured group;\nb)\tthe value of the preconfigured-group> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body as the identity of the preconfigured group; and\nc)\tthe list of the users that are members of the user regroup;\nuntil the regroup is removed.\nWhen the terminating participating MCData function receives a request to remove a user regroup it uses the procedure in clause 23.2.2.5.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "23.3.3\tControlling MCData function procedures",
                            "text_content": "When receiving a \"SIP MESSAGE request to the controlling MCData function to request creation of a user regroup using preconfigured group\" the controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. The controlling MCData function shall skip the rest of the steps;\n2)\tif the controlling MCData function is unable to handle the user regroup it shall send a SIP 480 (Temporarily Unavailable) response to the incoming SIP MESSAGE request and shall skip the rest of the steps;\n3)\tif the controlling MCData function determines that the proposed group ID for the regroup is already in use, shall reject the \"SIP MESSAGE request to the controlling MCData function to request creation of a user regroup using preconfigured group\" with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"165 group ID for regroup already in use\" in a Warning header field as specified in clause 4.9, and shall skip the rest of the steps;\n4)\tshall create a separate list of MCData IDs containing all users identified in the <users-for-regroup> element in the application/vnd.3gpp.mcdata-regroup+xml MIME body who are served by the same terminating participating MCData function;\n5)\tfor each terminating participating MCData function identified in step 4):\na)\tshall generate an outgoing SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6];\nb)\tshall include in the SIP MESSAGE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [8] that were received (if any) in the incoming SIP MESSAGE request;\nc)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the terminating participating MCData function;\nNOTE 1:\tThe public service identity can identify the terminating participating MCData function in the local MCData system or in an interconnected MCData system.\nNOTE 2:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the public service identity can identify the MCData gateway server that acts as an entry point in the interconnected MCData system from the local MCData system.\nNOTE 3:\tIf the terminating participating MCData function is in an interconnected MCData system in a different trust domain, then the local MCData system can route the SIP request through an MCData gateway server that acts as an exit point from the local MCData system to the interconnected MCData system.\nNOTE 4:\tHow the controlling MCData function determines the public service identity of the terminating participating MCData function or of the MCData gateway server in the interconnected MCData system is out of the scope of the present document.\nNOTE 5:\tHow the local MCData system routes the SIP request through an exit MCData gateway server is out of the scope of the present document.\nd)\tshall copy the contents of the application/vnd.3gpp.mcdata-info+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-info+xml MIME body included in the outgoing SIP MESSAGE request;\ne)\tshall copy the contents of the application/vnd.3gpp.mcdata-regroup+xml MIME body received in the incoming SIP MESSAGE request into an application/vnd.3gpp.mcdata-regroup+xml MIME body included in the outgoing SIP MESSAGE request;\nf)\tshall use the list of MCData IDs for this participating MCData function as generated in step 3) to create and include a <users-for-regroup> element contained in the application/vnd.3gpp.mcdata-regroup+xml MIME body;\ng)\tshall include a P-Asserted-Identity header field in the outgoing SIP MESSAGE request set to the public service identity of the controlling MCData function; and\nh)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [5];\n6)\twhen the controlling MCData function receives a SIP 200 (OK) response from any of the terminating participating MCData functions that were sent a SIP MESSAGE request in step 4) the controlling MCData function shall:\na)\tsend a SIP 200 (OK) response to the incoming SIP MESSAGE request; and\nb)\tstore the the value of the <mcdata-regroup-uri> element as the identity of the user regroup based on a preconfigured group;\nc)\tthe value of the preconfigured-group> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body as the identity of the preconfigured group; and\nd)\tstore the set of MCData IDs contained in the <users-for-regroup> element of the application/vnd.3gpp.mcdata-regroup+xml MIME body as the the list of the users that are members of the user regroup; and\n7)\tif no SIP 200 (OK) response is received for a SIP MESSAGE sent in step 4), the controlling MCData function shall send a SIP 480 (Temporarily Unavailable) response to the incoming SIP MESSAGE request in accordance with 3GPP TS 24.229 [5] and IETF RFC 3428 [6].\nWhen the controlling MCData function receives a request to remove a user regroup it uses the procedure in clause 23.2.3.2.\nWhen the controlling MCData function decides to remove a user regroup it uses the procedure in clause 23.2.3.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "24\tAdhoc group data communication",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "24.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes the adhoc group data communication procedures for on-network across single or multiple MCData systems using media plane procedures, and associated functions such as emergency data communications, imminent peril data communications, broadcast data communications and others.\nThe adhoc group data communications can use the participant list provided by either an initiator of the data communication or the MCData server. The MCData server can use the criteria provided by the initiator of the data communication to determine the participant list along with local criteria or local policies. The resulting adhoc group uses the configuration of a separate preconfigured MCData group.\nNOTE:\tA preconfigured group that is intended only to provide configuration for the adhoc group is identified by a parameter in the group configuration described in 3GPP TS 23.280 [3].\nThe preconfigured MCData group that provides the configuration is not used for the MCData group data communication, it only provides configuration for one or more adhoc group data communications. The MCData group ID of the adhoc group data communication is provided by the MCData server when the adhoc group data communication originated. To establish a security context for the end-to-end secured adhoc group data communication, the security related information is used from this preconfigured group.\nThe procedures defined in this clause are applicable for standalone SDS, SDS session and FD using media plane procedures for data communication.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "24.2\tMCData client procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "24.2.1\tGeneral",
                            "text_content": "This clause describes the adhoc group data communication procedures using on-demand and pre-established sessions to setup adhoc group data communications, release the ongoing adhoc group data communications, and modify the ongoing adhoc group data communications participants.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.2.2\tAdhoc group data communication setup",
                            "text_content": "This clause describes the originating, and terminating data communication setup procedures.\nUpon receiving a request from an MCData user to establish an MCData adhoc group session, the MCData client shall determine whether the service configuration document contains an <on-network> element that contains an <anyExt> element that contains an <adhoc-group-data-comn> element that contains an <allow-adhoc-group-data-comn-support> element and if an <allow-adhoc-group-data-comn-support> element does not exist, or is set to a value of \"false, then the MCData client:\n1)\tshould indicate to the MCData user that adhoc group data communications are not allowed; and\n2)\tshall skip the remainder of this procedure.\nThe MCData client shall generate an initial SIP INVITE request by following the UE originating session procedures specified in 3GPP TS 24.229 [5], with the clarifications given below:\n1)\tshall set the Request-URI of the SIP INVITE request to a public service identity identifying the participating MCData function serving the MCData user;\n2)\tshould include the \"timer\" option tag in the Supported header field;\n3)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n4)\tmay include a P-Preferred-Identity header field in the SIP INVITE request containing a public user identity as specified in 3GPP TS 24.229 [5];\n5)\tif a standalone SDS message is to be sent or SDS session is requested:\na)\tshall include the g.3gpp.mcdata.sds media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in the Contact header field of the SIP INVITE request according to IETF RFC 3840 [16];\nb)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\nc)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\nd)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP INVITE request;\ne)\tshall contain in an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <request-type> element set to a value of \"adhoc-group-sds-session\";\nii)\tif the MCData client needs to include an identity of adhoc group, the <mcdata-request-uri> element set to the identity of the adhoc group;\nNOTE 1:\tIf the data communication setup request follows an emergency alert for an adhoc group then this element is included and the identity of adhoc group learned during an adhoc group emergency alert procedures is used.\nNOTE 2:\tThe MCData client can optionally include an identity of adhoc group if it learns by any other means or generated by the MCData client using required parameters.\niii)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\nNOTE 3:\tThe MCData client does not include the MCData ID of the originating MCData user in the body, as this will be inserted into the body of the SIP INVITE request that is sent from the originating participating MCData function.\niv)\tan <anyExt> element containing:\nA)\tif the MCData client needs to include an active functional alias in the initial SIP INVITE request, may include the <functional-alias-URI> element set to the URI of the used functional alias;\nNOTE 4:\tThe MCData client learns the functional aliases that are activated for an MCData ID from procedures specified in clause 22.2.1.3.\nB)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value; and\nC)\tif end-to-end security needs to be established for the MCData adhoc group session, the <end-to-end-security> element set to \"true\"; and\nf)\tshall include an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 9.2.3.2.1 if a standalone SDS message is to be sent or in clause 9.2.4.2.1 if SDS session is requested;\n6)\tif a FD is requested:\na)\tshall generate and contain an application/vnd.3gpp.mcdata-signalling MIME body with the FD SIGNALLING PAYLOAD as described in clause 6.2.2.3;\nb)\tshall include the g.3gpp.mcdata.fd media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in the Contact header field of the SIP INVITE request according to IETF RFC 3840 [16];\nc)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.fd media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\nd)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\ne)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP INVITE request;\nf)\tshall contain in an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <request-type> element set to a value of \"adhoc-group-fd-session\";\nii)\tif the MCData client needs to include an identity of adhoc group, the <mcdata-request-uri> element set to the identity of the adhoc group;\nNOTE 5:\tIf the data communication setup request follows an emergency alert for an adhoc group then this element is included and the identity of adhoc group learned during an adhoc group emergency alert procedures is used.\nNOTE 6:\tThe MCData client can optionally include an identity of adhoc group if it learns by any other means or generated by the MCData client using required parameters.\niii)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\nNOTE 7:\tThe MCData client does not include the MCData ID of the originating MCData user in the body, as this will be inserted into the body of the SIP INVITE request that is sent from the originating participating MCData function.\niv)\tan <anyExt> element containing:\nA)\tif the MCData client needs to include an active functional alias in the initial SIP INVITE request, may include the <functional-alias-URI> element set to the URI of the used functional alias;\nNOTE 8:\tThe MCData client learns the functional aliases that are activated for an MCData ID from procedures specified in clause 22.2.1.3.\nB)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value; and\nC)\tif end-to-end security needs to be established for the MCData adhoc group session, the <end-to-end-security> element set to \"true\"; and\ng)\tshall include an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 10.2.5.2.1;\n7)\tif the MCData user has requested to include the list of MCData users to be invited for data communication and the data communication setup request does not follow an adhoc group for emergency alert, shall insert in the SIP INVITE request an application/resource-lists+xml MIME body with the MCData ID of the invited MCData users to be called, according to rules and procedures of IETF RFC 5366 [18];\n8)\tif the MCData user has requested to include the criteria for determining the list of MCData users to be invited for data communication and the data communication setup request does not follow an adhoc group for emergency alert, shall insert a <comn-participants-criteria> with one or more criteria as a comma separated list into <anyExt> element of <mcdata-Params> element of <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP INVITE request; and\nNOTE 9:\tThe MCData client can include either a list of MCData users or the criteria for determining the list of MCData users to be invited. These two information elements are not included if the data communication setup request follows an adhoc group for emergency alerts.\n9)\tshall send the SIP INVITE request towards the MCData server according to 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP INVITE request, the MCData client:\n1)\tshall send a SIP ACK request as specified in 3GPP TS 24.229 [5];\n2)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\n3)\tif the <preconfigured-group-id> element received in the application/vnd.3gpp.mcdata-info+xml MIME body, shall use the security related information from the group configuration associated with the received preconfigured group identity;\n4)\tmay notify the user with the adhoc group identity received in the <mcdata-calling-group-id> element contained in the application/vnd.3gpp.mcdata-info+xml MIME body; and\n5)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.1.1.2.\nOn receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request:\n1)\tmay notify the user about data communication setup failure with an appropriate response along with the description; and\n2)\tshall send a SIP ACK request as specified in 3GPP TS 24.229 [5].\nOn receipt of an indication from the media plane indicating that the file was not sent successfully or the standalone SDS message was not sent successfully or the standalone SDS message has been successfully transferred, the MCData client shall:\n1)\tshall generate a SIP BYE request according to 3GPP TS 24.229 [5] with:\na)\tReason code set to \"SIP\";\nb)\tcause set to \"480\"; and\nc)\ttext set to \"transmission failed\";\n2)\tshall set the Request-URI to the MCData session identity to release; and\n3)\tshall send a SIP BYE request towards MCData server according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response to the SIP BYE request, the MCData client shall interact with the media plane and indicate to terminate the MCData adhoc group session, as specified in 3GPP TS 24.582 [15].\nUpon receipt of an initial SIP INVITE request, the MCData client shall follow the procedures for the termination of multimedia sessions in the IM CN subsystem as specified in 3GPP TS 24.229 [5] with the clarifications below.\nThe MCData client:\n1)\tmay reject the SIP INVITE request if any of the following conditions are met:\na)\tMCData client does not have enough resources to handle the data communication; or\nb)\tany other reason outside the scope of this specification;\n2)\tif the SIP INVITE request is rejected in step 1), shall respond toward participating MCData function either with an appropriate reject code as specified in 3GPP TS 24.229 [5] and warning texts as specified in clause 4.9 or with SIP 480 (Temporarily unavailable) response not including warning texts if the user is authorised to restrict the reason for failure and skip the rest of the steps of this clause;\n3)\tmay display to the MCData user the MCData ID of the inviting MCData user and the type of SDS request, if present;\n4)\tmay display to the MCData user the functional alias of the inviting MCData user, if present;\n5)\tmay display to the MCData user the file meta-data of the incoming file as described by the SDP included in the received SIP INVITE request;\n6)\tif the <preconfigured-group-id> element received in the application/vnd.3gpp.mcdata-info+xml MIME body, shall use the security related information from the group configuration associated with the received preconfigured group identity;\n7)\tmay notify the user with the adhoc group identity received in the <mcdata-calling-group-id> element contained in the application/vnd.3gpp.mcdata-info+xml MIME body;\n8)\tif a standalone SDS message is to be recieved or SDS session is requested:\na)\tshall accept the SIP INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\nb)\tshall include the option tag \"timer\" in a Require header field of the SIP 200 (OK) response;\nc)\tshall include the Session-Expires header field in the SIP 200 (OK) response and start the SIP session timer according to IETF RFC 4028 [38]. The \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\nd)\tshall include the g.3gpp.mcdata.sds media feature tag in the Contact header field of the SIP 200 (OK) response;\ne)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in the Contact header field of the SIP 200 (OK) response;\nf)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5] with the clarifications given in clause 9.2.3.2.2 if a standalone SDS message is to be recieved or in clause 9.2.4.2.2 if SDS session is requested;\ng)\tif a SIP CANCEL request associated with the SIP INVITE request was received, shall execute the procedure in clause 6.2.8.4.1, otherwise shall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5]; and\nh)\tif the SIP 200 (OK) response to the received SIP INVITE request was sent, on receipt of an SIP ACK message to the sent SIP 200 (OK) message, the MCData client shall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.1.1.3 if a standalone SDS message is to be received or clause 6.1.2.3 if SDS session is requested; and\n9)\tif a FD is requested:\na)\tif the Mandatory download IE of the FD SIGNALLING PAYLOAD contained in the application/vnd.3gpp.mcdata-signalling MIME body received in the SIP INVITE request is set to \"MANDATORY DOWNLOAD\" or if the user has accepted the file download request, then:\ni)\tshall accept the SIP INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\nii)\tshall include the option tag \"timer\" in a Require header field of the SIP 200 (OK) response;\niii)\tshall include the Session-Expires header field in the SIP 200 (OK) response and start the SIP session timer according to IETF RFC 4028 [38]. The \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\niv)\tshall include the g.3gpp.mcdata.fd media feature tag in the Contact header field of the SIP 200 (OK) response;\nv)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in the Contact header field of the SIP 200 (OK) response;\nvi)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5] with the clarifications given in clause 10.2.5.2.2;\nvii)\tif a SIP CANCEL request associated with the SIP INVITE request was received, shall execute the procedure in clause 6.2.8.4.1, otherwise, shall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5]; and\nviii)\tif the SIP 200 (OK) response to the received SIP INVITE request was sent, on receipt of an SIP ACK message to the sent SIP 200 (OK) message, the MCData client shall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.1.2.3;\notherwise, if the user has not accepted or has rejected the file download request:\ni)\tshall send a SIP 403 (Forbidden) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5]; and\nb)\tif the application/vnd.3gpp.mcdata-signalling MIME body in the received SIP INVITE request contained an FD SIGNALLING PAYLOAD message without the Mandatory download IE included, then:\ni)\tshall notify the MCData user about the incoming FD request and wait for the MCData user to accept or reject or defer the FD request;\nii)\tif the MCData user declines the FD session invitation:\nA)\tshall send a SIP 480 (Temporarily Unavailable) response towards the MCData server with the warning text set to \"110 user declined the call invitation\" in a Warning header field as specified in clause 4.9 and skip the rest of the steps in this clause;\niii)\tif the MCData user defers the FD session invitation:\nA)\tshall send a SIP 480 (Temporarily Unavailable) response towards the MCData server with the warning text set to \"231 user deferred the call invitation\" in a Warning header field as specified in clause 4.9 and skip the rest of the steps in this clause; and\niv)\tif the MCData user accepts the FD session invitation:\nA)\tshall accept the SIP INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\nB)\tshall include the option tag \"timer\" in a Require header field of the SIP 200 (OK) response;\nC)\tshall include the Session-Expires header field in the SIP 200 (OK) response and start the SIP session timer according to IETF RFC 4028 [38]. The \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\nD)\tshall include the g.3gpp.mcdata.fd media feature tag in the Contact header field of the SIP 200 (OK) response;\nE)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in the Contact header field of the SIP 200 (OK) response;\nF)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5] with the clarifications given in clause 10.2.5.2.2;\nG)\tif a SIP CANCEL request associated with the SIP INVITE request was received, shall execute the procedure in clause 6.2.8.4.1, otherwise shall send the SIP 200 (OK) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5];\nH)\tmay store the Conversation ID, Message ID, InReplyTo message ID and Date and time in local storage; and\nI)\tif the SIP 200 (OK) response to the received SIP INVITE request was sent, on receipt of an SIP ACK message to the sent SIP 200 (OK) message, the MCData client shall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.1.2.3;\notherwise, if the user has not accepted or has rejected the MCData adhoc group session invitation:\nA)\tshall send a SIP 403 (Forbidden) response towards the MCData server according to rules and procedures of 3GPP TS 24.229 [5].\nTo send a disposition notification after the media plane is released, the MCData client:\n1)\tshall follow the procedures described in clause 12.2.1.1.\nOn receipt of an indication from the media plane of the successful download of the file:\n1) if the received FD SIGNALLING PAYLOAD message contained an Application metadata container IE, then the MCData client may process the content of that IE per local policy.\nUpon receiving a request from an MCData user to establish an MCData adhoc group session within the pre-established session, the MCData client shall determine whether the service configuration document contains an <on-network> element that contains an <anyExt> element that contains an <adhoc-group-call> element that contains an <allow-adhoc-group-call-support> element and if an <allow-adhoc-group-call-support> element does not exist, or is set to a value of \"false\", then the MCData client:\n1)\tshould indicate to the MCData user that adhoc group data communications are not allowed; and\n2)\tshall skip the remainder of this procedure.\nThe MCData client shall generate a SIP REFER request outside a dialog in accordance with the procedures specified in 3GPP TS 24.229 [5], IETF RFC 4488 [53] and IETF RFC 3515 [51] as updated by IETF RFC 6665 [36] and IETF RFC 7647 [52], with the clarifications given below.\nThe MCData client:\n1)\tshall include the Request-URI set to the public service identity identifying the pre-established session on the MCData server serving the MCData user;\n2)\tshall include the Refer-Sub header field with value \"false\" according to rules and procedures of IETF RFC 4488 [53];\n3)\tshall include the Supported header field with value \"norefersub\" according to rules and procedures of IETF RFC 4488 [53];\n4)\tshall include the option tag \"multiple-refer\" in the Require header field;\n5)\tmay include a P-Preferred-Identity header field in the SIP REFER request containing a public user identity as specified in 3GPP TS 24.229 [5];\n6)\tif a standalone SDS message is to be sent or SDS session is requested:\na)\tshall include the g.3gpp.mcdata.sds media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in the Contact header field of the SIP REFER request according to IETF RFC 3840 [16]; and\nb)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP REFER request;\n7)\tif a FD is requested:\na)\tshall include the g.3gpp.mcdata.fd media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" in the Contact header field of the SIP REFER request according to IETF RFC 3840 [16]; and\nb)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP REFER request;\n8)\tif the MCData user has requested to include the list of MCData users to be called and the data communication setup request does not follow an adhoc group for emergency alert:\na)\tshall set the Refer-To header field of the SIP REFER request as specified in IETF RFC 3515 [51] with a Content-ID (\"cid\") Uniform Resource Locator (URL) as specified in IETF RFC 2392 [33] that points to an application/resource-lists+xml MIME body as specified in IETF RFC 5366 [18], and with the Content-ID header field set to this \"cid\" URL and Content-Type header filed set to \"application/resource-lists+xml\"; and\nb)\tshall include in the application/resource-lists MIME body an <entry> element for each of the targeted MCData users, with each <entry> element containing a \"uri\" attribute set to the MCData ID of the targeted user, extended with hname \"body\" parameter in the headers portion of the SIP URI containing:\nNOTE 1:\tCharacters that are not formatted as ASCII characters are escaped in the following parameters in the headers portion of the SIP URI.\ni)\tthe Accept-Contact header field containing:\nA)\tthe g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8] for standalone SDS and SDS session;\nB)\tthe media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] for standalone SDS and SDS session;\nC)\tthe media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] for FD; and\nD)\tthe g.3gpp.mcdata.fd media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8] for FD; and\nii)\tan hname \"body\" parameter populated with:\nA)\tan application/sdp MIME body containing an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 9.2.3.2.1 if a standalone SDS message is to be sent or in clause 9.2.4.2.1 if SDS session is requested or in clause 10.2.5.2.1 if FD session requested;\nB)\tan application/vnd.3gpp.mcdata-info MIME body with:\nI)\tthe <session-type> element set to a value of \"adhoc-group-sds-session\" for standalone SDS message and SDS session or \"adhoc-group-fd-session\" for FD session;\nII)\tthe MCData client may include the identity of adhoc group with the <mcdata-request-uri> element set to the identity of the adhoc group;\nNOTE 2:\tThe MCData client can optionally include an identity of adhoc group if it learns by any other means or generated by the MCData client using required parameters.\nIII)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\nIV)\tan <anyExt> element containing:\nAA)\tif the MCData client needs to include an active functional alias in the SIP REFER request, the <functional-alias-URI> element set to the URI of the used functional alias;\nNOTE 3:\tThe MCData client learns the functional aliases that are activated for an MCData ID from procedures specified in clause 22.2.1.3.\nBB)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value; and\nCC)\tif end-to-end security needs to be established for the MCData adhoc group session, the <end-to-end-security> element set to \"true\";\nC)\tshall generate and include an application/vnd.3gpp.mcdata-signalling MIME body with the FD SIGNALLING PAYLOAD as described in clause 6.2.2.3 if FD session requested; and\nD)\tif several MIME bodies to be included in the hname \"body\" parameter, shall include the MIME bodies according to the procedures specified in clause 6.4;\n9)\tif the MCData user has requested to include the criteria for determining the list of MCData users to be called and the call setup request does not follow an adhoc group for emergency alert:\na)\tshall set the Refer-To header field of the SIP REFER request as specified in IETF RFC 3515 [51] with a Content-ID (\"cid\") Uniform Resource Locator (URL) as specified in IETF RFC 2392 [33] that points to an MIME body section which conatins one or more MIME bodies, and with the Content-ID header field set to this \"cid\" URL and Content-Type header filed set to \"application/vnd.3gpp.mcdata-info+xml\" or according to the procedures specified in clause 6.4 if several MIME bodies needs to be included;\nb)\tshall include the Accept-Contact header field containing:\ni)\tthe g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8] for standalone SDS and SDS session;\nii)\tthe media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] for standalone SDS and SDS session;\niii)\tthe media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] for FD; and\niv)\tthe g.3gpp.mcdata.fd media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8] for FD;\nc)\tshall include an application/sdp MIME body containing an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 9.2.3.2.1 if a standalone SDS message is to be sent or in clause 9.2.4.2.1 if SDS session is requested or in clause 10.2.5.2.1 if FD session requested;\nd)\tshall include an application/vnd.3gpp.mcdata-info MIME body with:\ni)\tthe <session-type> element set to a value of \"adhoc-group-sds-session\" for standalone SDS message and SDS session or \"adhoc-group-fd-session\" for FD session;\nii)\tthe MCData client may include an identity of adhoc group with the <mcdata-request-uri> element set to the identity of the adhoc group;\nNOTE 4:\tThe MCData client can optionally include an identity of adhoc group if it learns by any other means or generated by the MCData client using required parameters.\niii)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\niv)\tan <anyExt> element containing:\nA)\tif the MCData client needs to include an active functional alias in the SIP REFER request, the <functional-alias-URI> element set to the URI of the used functional alias;\nNOTE 5:\tThe MCData client learns the functional aliases that are activated for an MCData ID from procedures specified in clause 22.2.1.3.\nB)\tthe <call-participants-criterias> element set to one or more criteria as a comma separated list;\nC)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value; and\nD)\tif end-to-end security needs to be established for the MCData adhoc group session, the <end-to-end-security> element set to \"true\"; and\ne)\tshall generate and include an application/vnd.3gpp.mcdata-signalling MIME body with the FD SIGNALLING PAYLOAD as described in clause 6.2.2.3 if FD session requested;\n10)\tif the call setup request follows an emergency alert for an adhoc group:\na)\tshall set the Refer-To header field of the SIP REFER request as specified in IETF RFC 3515 [51] with a Content-ID (\"cid\") Uniform Resource Locator (URL) as specified in IETF RFC 2392 [33] that points to an application/resource-lists+xml MIME body as specified in IETF RFC 5366 [18], and with the Content-ID header field set to this \"cid\" URL and Content-Type header filed set to \"application/resource-lists+xml\"; and\nb)\tshall include in the application/resource-lists+xml MIME body a single <entry> element in a <list> element in the <resource-lists> element where the <entry> elment contains a \"uri\" attribute set to the identity of the adhoc group learned during an adhoc group emergency alert procedure, extended with hname \"body\" parameter in the headers portion of the SIP URI containing:\nNOTE 6:\tCharacters that are not formatted as ASCII characters are escaped in the following parameters in the headers portion of the SIP URI.\ni)\tthe Accept-Contact header field containing:\nA)\tthe g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8] for standalone SDS and SDS session;\nB)\tthe media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] for standalone SDS and SDS session;\nC)\tthe media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8] for FD; and\nD)\tthe g.3gpp.mcdata.fd media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8] for FD; and\nii)\tan hname \"body\" parameter populated with:\nA)\tan application/sdp MIME body containing an SDP offer according to 3GPP TS 24.229 [5] with the clarifications given in clause 9.2.3.2.1 if a standalone SDS message is to be sent or in clause 9.2.4.2.1 if SDS session is requested or in clause 10.2.5.2.1 if FD session requested;\nB)\tan application/vnd.3gpp.mcdata-info MIME body with:\nI)\tthe <session-type> element set to a value of \"adhoc-group-sds-session\" for standalone SDS message and SDS session or \"adhoc-group-fd-session\" for FD session;\nII)\tthe <mcdata-client-id> element set to the MCData client ID of the originating MCData client; and\nIII)\tan <anyExt> element containing:\naa)\tif the MCData client needs to include an active functional alias in the SIP REFER request, the <functional-alias-URI> element set to the URI of the used functional alias;\nNOTE 7:\tThe MCData client learns the functional aliases that are activated for an MCData ID from procedures specified in clause 22.2.1.3.\nbb)\tif the MCData user has requested an application priority, the <user-requested-priority> element set to the user provided value;\ncc)\tthe <adhoc-grp-emg-alert-grp-ind> element set to \"true\"; and\ndd)\tif end-to-end security needs to be established for the MCData adhoc group session, the <end-to-end-security> element set to \"true\";\nC)\tshall generate and include an application/vnd.3gpp.mcdata-signalling MIME body with the FD SIGNALLING PAYLOAD as described in clause 6.2.2.3 if FD session requested; and\nD)\tif several MIME bodies to be included in the hname \"body\" parameter, shall include the MIME bodies according to the procedures specified in clause 6.4;\nNOTE 8:\tThe MCData client can include either a list of MCData users or the criteria for determining the list of MCData users to be called. These two information elements are not included if the call setup request follows an adhoc group for emergency alerts.\n11)\tshall include a Target-Dialog header field as specified in IETF RFC 4538 [32] identifying the pre-established session;\n12)\tshall include the g.3gpp.mcdata media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" in the Contact header field of the SIP REFER request according to IETF RFC 3840 [16]; and\n13)\tshall send the SIP REFER request according to 3GPP TS 24.229 [5].\nOn receiving a final SIP 2xx response to the SIP REFER request, the MCData client:\n1)\tshall interact with the user plane as specified in 3GPP TS 24.582 [15];\n2)\tif the <preconfigured-group-id> element received in the application/vnd.3gpp.mcdata-info+xml MIME body, shall use the security related information from the group configuration associated with the received preconfigured group identity; and\n3)\tmay notify the user with the adhoc group identity received in the <mcdata-calling-group-id> element contained in the application/vnd.3gpp.mcdata-info+xml MIME body.\nOn receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP REFER request:\n1)\tmay notify the user about call setup failure with an appropriate response along with the description.\nEditor's Note:\tThe terminating procedures will be defined in future.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.2.3\tAdhoc group data communication release",
                            "text_content": "This clause describes the originating, and terminating data communication release procedures.\nUpon receiving a request from an MCData user to release an MCData adhoc group session established using on-demand session, the MCData client:\n1)\tif the session is in the process of being established, shall send a SIP CANCEL request according to 3GPP TS 24.229 [5] and skip the rest of the steps;\n2)\tshall generate a SIP BYE request according to 3GPP TS 24.229 [5];\n3)\tshall set the Request-URI to the MCData session identity to release; and\n4)\tshall send a SIP BYE request towards MCData server according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response to the SIP BYE request, the MCData client shall interact with the media plane as specified in 3GPP TS 24.582 [15] to release all media plane resources corresponding to the MCData adhoc group session being released.\nUpon receiving a SIP BYE request for releasing the MCData adhoc group session, the MCData client:\n1)\tshall send SIP 200 (OK) response towards MCData server according to 3GPP TS 24.229 [5];\n2)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] to release all media plane resources corresponding to the MCData adhoc group session being released; and\n3)\tshall notify the MCData user with reason for release of communication if SIP BYE request contains reason header.\nNOTE:\tPartially received data can be stored and processed.\nUpon receiving a request from an MCData user to release an MCData adhoc group session established using pre-established session, the MCData client:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15];\n2)\tshall generate an initial SIP REFER request outside a dialog in accordance with the procedures specified in 3GPP TS 24.229 [5], IETF RFC 4488 [53] and IETF RFC 3515 [51] as updated by IETF RFC 6665 [36] and IETF RFC 7647 [52];\n3)\tshall set the Request-URI of the SIP REFER request to the public service identity identifying the pre-established session on the MCData server serving the MCData user;\n4)\tshall include the Refer-Sub header field with value \"false\" according to rules and procedures of IETF RFC 4488 [53];\n5)\tshall include the Supported header field with value \"norefersub\" according to rules and procedures of IETF RFC 4488 [53];\n6)\tshall set the Refer-To header field of the SIP REFER request to the MCData session identity to release;\n7)\tshall include the \"method\" SIP URI parameter with the value \"BYE\" in the URI in the Refer-To header field;\n8)\tshall include a Target-Dialog header field as specified in IETF RFC 4538 [54] identifying the pre-established session; and\n9)\tshall send the SIP REFER request according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 2xx response to the SIP REFER request, the MCData client shall interact with media plane as specified in 3GPP TS 24.582 [15].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.2.4\tAdhoc group data communication leave",
                            "text_content": "This clause describes the originating, and terminating data communication leave procedures.\nUpon receiving a request from an MCData user to leave an MCData adhoc group session established using on-demand session, the MCData client:\n1)\tshall generate a SIP BYE request according to 3GPP TS 24.229 [5];\n2)\tshall set the Request-URI to the MCData session identity to leave; and\n3)\tshall send a SIP BYE request towards MCData server according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response to the SIP BYE request, the MCData client shall interact with the media plane as specified in 3GPP TS 24.582 [15] to release all media plane resources corresponding to the MCData adhoc group session being left.\nUpon receiving a SIP BYE request for leave the MCData adhoc group session, the MCData client:\n1)\tshall send SIP 200 (OK) response towards MCData server according to 3GPP TS 24.229 [5];\n2)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] to release all media plane resources corresponding to the MCData adhoc group session being left; and\n3)\tshall notify the MCData user with reason for removing from the communication if SIP BYE request contains reason header.\nNOTE:\tPartially received data can be stored and processed.\nUpon receiving a request from an MCData user to leave an MCData adhoc group session established using pre-established session, the MCData client:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15];\n2)\tshall generate an initial SIP REFER request outside a dialog in accordance with the procedures specified in 3GPP TS 24.229 [5], IETF RFC 4488 [53] and IETF RFC 3515 [51] as updated by IETF RFC 6665 [36] and IETF RFC 7647 [52];\n3)\tshall set the Request-URI of the SIP REFER request to the public service identity identifying the pre-established session on the MCData server serving the MCData user;\n4)\tshall include the Refer-Sub header field with value \"false\" according to rules and procedures of IETF RFC 4488 [53];\n5)\tshall include the Supported header field with value \"norefersub\" according to rules and procedures of IETF RFC 4488 [53];\n6)\tshall set the Refer-To header field of the SIP REFER request to the MCData session identity to leave;\n7)\tshall include the \"method\" SIP URI parameter with the value \"BYE\" in the URI in the Refer-To header field;\n8)\tshall include a Target-Dialog header field as specified in IETF RFC 4538 [54] identifying the pre-established session; and\n9)\tshall send the SIP REFER request according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 2xx response to the SIP REFER request, the MCData client shall interact with media plane as specified in 3GPP TS 24.582 [15].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.2.5\tAdhoc group data communication rejoin",
                            "text_content": "This clause describes the originating, and terminating data communication rejoin procedures.\nUpon receiving a request from an MCData user to rejoin an ongoing MCData adhoc group session or triggered by coming back from out of coverage, the MCData client shall generate an initial SIP INVITE request by following the UE originating session procedures specified in 3GPP TS 24.229 [5], with the clarifications given below.\nNOTE:\tHow an MCData client is informed whether it comes back from out of coverage is out of scope of present document.\nThe MCData client shall follow the procedures specified in clause 24.2.2.1.1 with the clarification in step 1) of clause 24.2.2.1.1 that the Request-URI of the SIP INVITE request shall contain a URI of the MCData session identity to rejoin.\nUpon receiving a request from an MCData user to rejoin an ongoing MCData call within the pre-established session or triggered by coming back from out of coverage, the MCData client shall generate a SIP REFER request as specified in IETF RFC 3515 [51] as updated by IETF RFC 6665 [36] and IETF RFC 7647 [52], and in accordance with the UE procedures specified in 3GPP TS 24.229 [5], with the clarifications given below.\nThe MCData client shall follow the procedures specified in clause 24.2.2.2.1 with the clarification in step 8, step 9 and step 10 of clause 24.2.2.2.1 that the Refer-To header field of the SIP REFER request:\n1)\tshall contain a URI of the MCData session identity to rejoin; and\n2)\tshall contain a Content-Type header field in the headers portion of the SIP URI containing an application/vnd.3gpp.mcdata-info+xml MIME type of the hname \"body\" parameter in the headers portion of the SIP URI and the hname \"body\" parameter in the headers portion of the SIP URI containing the <mcdatainfo> element with the <mcdata-Params> element and with the <session-type> element set to a value of \"adhoc-group-sds-session\" for standalone SDS message and SDS session or \"adhoc-group-fd-session\" for FD session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.2.6\tAdhoc group data communication participants modify",
                            "text_content": "This clause describes the originating adhoc group data communication participants modify procedures.\nUpon receiving a request from an authorized MCData user to modify an ongoing MCData adhoc group session to update the participants list, the MCData client shall generate a SIP re-INVITE request as specified in 3GPP TS 24.229 [5], with the clarifications given below.\n1)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body populated as currently established session;\n2)\tif the currently established session is based on the MCData user requested to include the list of MCData users to be invited, shall insert in the SIP re-INVITE request an application/resource-lists+xml MIME body with:\na)\tif MCData users to be invited to a data communication, the MCData ID of the MCData users to be invited with the \"method\" SIP URI parameter set to the value \"INVITE\" in the \"uri\" attribute of the each <entry> element of a <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body; and\nb)\tif MCData users to be removed from a data communication, the MCData ID of the MCData users to be removed with the \"method\" SIP URI parameter with the value \"BYE\" in the \"uri\" attribute of the each <entry> element of a <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body;\n3)\tshall include an SDP offer with the media parameters as currently established according to 3GPP TS 24.229 [5]; and\n4)\tshall send the SIP re-INVITE request according to 3GPP TS 24.229 [5].\nOn receiving a SIP 2xx response to the SIP re-INVITE request, the MCData client:\n1)\tmay notify the user about successful data communication modification request.\nOn receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the re-SIP INVITE request, the MCData client:\n1)  may notify the user about data communication participants modify request failure with an appropriate response along with the description.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "24.3\tParticipating MCData function procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "24.3.1\tGeneral",
                            "text_content": "This clause describes the adhoc group data communication participating MCData function procedures using on-demand and pre-established sessions to setup adhoc group data communications, release the ongoing adhoc group data communications, and modify the ongoing adhoc group data communications participants.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.3.2\tAdhoc group data communication setup",
                            "text_content": "This clause describes the originating, and terminating data communication setup participating MCData function procedures.\nUpon receipt of a \"SIP INVITE request for MCData adhoc group session for originating participating MCData function\" containing an application/vnd.3gpp.mcdata-info+xml MIME body with the <request-type> element set to a value of \"adhoc-group-sds-session\" or a value of \"adhoc-group-fd-session\", the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. Otherwise, continue with the rest of the steps;\n2)\tshall determine the MCData ID of the calling user from public user identity in the P-Asserted-Identity header field of the SIP INVITE request;\nNOTE 1:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP INVITE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tif through local policy in the participating MCData function, the user identified by the MCData ID is not authorised to initiate adhoc group data communications, shall reject the \"SIP INVITE request for MCData adhoc group session for originating participating MCData function\" with a SIP 403 (Forbidden) response to the SIP INVITE request, with warning text set to \"237 user not authorised to make adhoc group data communications\" in a Warning header field as specified in clause 4.9;\n5)\tshall determine the public service identity of the controlling MCData function for the adhoc group data communication service of SDS if SDS is requested or FD if FD is requested associated with the originating user's identity i.e. MCData ID;\nNOTE 2:\tThe public service identity can identify the controlling MCData function in the primary MCData system.\nNOTE 3:\tHow the participating MCData function determines the public service identity of the controlling MCData function for the adhoc group data communication service associated with the originating user is out of the scope of the present document.\n6)\tif the participating MCData function is unable to identify the controlling MCData function for the adhoc group data communication service for SDS if standalone SDS and SDS session is requested or FD if FD is requested associated with the originating user's MCData ID identity, it shall reject the SIP INVITE request with a SIP 404 (Not Found) response with the warning text \"142 unable to determine the controlling function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n7)\tif the <allow-adhoc-group-data-comn> element of the <ruleset> element is not present in the MCData user profile document on the participating MCData function or is present with the value \"false\" (see the MCData user profile document in 3GPP TS 24.484 [12]), indicating that the user identified by the MCData ID is not authorised to initiate adhoc group data communications, shall reject the \"SIP INVITE request for MCData adhoc group session for originating participating MCData function\" with a SIP 403 (Forbidden) response, with warning text set to \"238 user not authorised to initiate the adhoc group data communication\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\n8)\tshall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [5];\n9)\tshall set the Request-URI to the public service identity of the controlling MCData function as determined in step 5;\n10)\tshall include the option tag \"timer\" in the Supported header field;\n11)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n12)\tshall copy the application/vnd.3gpp.mcdata-info+xml MIME body from the incoming SIP INVITE request to the outgoing SIP INVITE request;\n13)\tshall include the MCData ID of the originating user in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP INVITE request;\n14)\tif the incoming SIP INVITE request contains an application/vnd.3gpp.mcdata-info+xml MIME body that contains a <functional-alias-URI> element, shall check if the status of the functional alias is activated for the MCData ID. If the functional alias status is activated, then the participating MCData function shall set the <functional-alias-URI> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request to the received value, otherwise shall not include a <functional-alias-URI> element;\nNOTE 4:\tThe participating MCData server learns the functional alias state for an MCData ID from procedures specified in clause 22.2.2.2.7.\n15)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]) if SDS requested or value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]) if FD requested, into the P-Asserted-Service header field of the outgoing SIP INVITE request;\n16)\tshall include a P-Asserted-Identity header field in the outgoing SIP INVITE request set to the public service identity of the participating MCData function;\n17)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received SIP INVITE request from the MCData client as specified in clause 9.2.3.3.1 for standalone SDS or clause 9.2.4.3.1 for SDS session or clause 10.2.5.3.1 for FD;\n18)\tshall include a Resource-Priority header field according to rules and procedures of 3GPP TS 24.229 [5] set to the value indicated in the Resource-Priority header field, if included in the SIP INVITE request from the MCData client; and\nNOTE 5:\tThe participating MCData function will leave the verification of the Resource-Priority header field to the controlling MCData function.\n19)\tshall send the SIP INVITE request as specified to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 2xx response in response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n2)\tshall include in the SIP 200 (OK) response an SDP answer as specified in the clause 9.2.3.3.2 for standalone SDS or clause 9.2.4.3.2 for SDS session or clause 10.2.5.3.2 for FD;\n3)\tshall include Warning header field(s) that were received in the incoming SIP 200 (OK) response;\n4)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag for standalone SDS and SDS session;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" for standalone SDS and SDS session;\nc)\tthe g.3gpp.mcdata.fd media feature tag for FD;\nd)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" for FD; and\ne)\tthe isfocus media feature tag;\n5)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function;\n6)\tshall include an MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP 200 (OK) response;\n7)\tif the incoming SIP 200 (OK) response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response;\n8)\tshall send the SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5];\n9)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.2.1.4 for standalone SDS or clause 6.2.2.4 for SDS session or clause 7.2.1 for FD; and\n10)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a \"SIP INVITE request for MCData adhoc group session for terminating participating MCData function\", the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4], and shall not continue with the rest of the steps;\n2)\tshall check the presence of the isfocus media feature tag in the URI of the Contact header field and if it is not present then the participating MCData function shall reject the request with a SIP 403 (Forbidden) response with the warning text set to \"104 isfocus not assigned\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\n3)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request to retrieve the binding between the MCData ID and public user identity of the terminating MCData user;\n4)\tif the binding between the MCData ID and public user identity of the terminating MCData user does not exist and request is for standalone SDS or SDS session, then the participating MCData function shall reject the SIP INVITE request with a SIP 404 (Not Found) response, and shall not continue with the rest of the steps;\nNOTE 1:\tIf an <MKFC-GKTPs> element is received in a SIP INVITE request, the participating MCData function essentially ignores it and does not forward it, resulting in unicast media plane transmission being used for the terminating client.\n5)\tif the <allow-adhoc-group-data-comn-participation> element of the <ruleset> element is not present in the MCData user profile document on the participating MCData function or is present with the value \"false\" (see the MCData user profile document in 3GPP TS 24.484 [12]), indicating that the user identified by the MCData ID is not authorised to participate in adhoc group data communications, shall reject the \"SIP INVITE request for terminating participating MCData function\" with a SIP 403 (Forbidden) response, with warning text set to \"188 user is not allowed to participate in adhoc group data communication\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\n6)\tif the binding between the MCData ID and public user identity of the terminating MCData user does not exist (i.e. MCData user is not available) or network congestion exists and request is for FD, and if later delivery is required, then the participating MCData function shall store the communication for later delivery with following additional informations included:\na)\tshall include a Payload IE with:\ni)\tthe Payload content type set to \"FILEURL\" as specified in clause 15.2.13; and\nii)\tthe URL of the file to be stored for later delivery in the Payload data as as specified in clause 15.2.13; and\nNOTE 2:\tThe file can be stored in the temporary storage of the MCData server or in the MCData content server. The URL of the stored file for later delivery is updated accordingly.\nb)\tmay include a Metadata IE with the required file description information and file availability information;\n7)\tif the communication is stored in step 6) above and to store the file content in the temporary storage, then the participating MCData function:\na)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5] with the following clarifications:\ni)\tinclude an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5] with the following clarifications:\nA)\tif included in the SDP offer, shall include an \"m=message\" media-level section for the offered MCData media stream consisting of:\nI) the IP address and port number of the participating MCData function;\nII)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS;\nIII)\ta format list field set to '*';\nIV)\tan \"a=recvonly\" attribute;\nV)\tan \"a=path\" attribute containing its own MSRP URI;\nVI)\tset the content type as a=accept-types:application/vnd.3gpp.mcdata-signalling; and\nVII)\tset the a=setup attribute to \"passive\", according to IETF RFC 6135 [19];\nii)\tinclude the option tag \"timer\" in a Require header field;\niii)\tinclude the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If no \"refresher\" parameter was included in the SIP INVITE request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\niv)\tinclude the following in the Contact header field:\nA)\tthe g.3gpp.mcdata.fd media feature tag;\nB)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\"; and\nC)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP INVITE request from the controlling MCData function;\nv)\tstart the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\nvi)\tinclude the warning text set to \"232 communication is stored for later delivery\" in a Warning header field as specified in clause 4.9;\nvii)\tinteract with the media plane as specified in 3GPP TS 24.582 [15] clause 7.2.5.1 to receive the file from controlling MCData function and clause 7.1.3.2 to receive the file content; and\nviii)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [5]; and\nb)\tshall generate and send an FD NOTIFICATION indicating deferral of the FD request as specified in clause 12.2.2.3 with including the warning text set to \"232 communication is stored for later delivery\" in a Warning header field as specified in clause 4.9;\nand skip the rest of the steps of this clause;\n8)\tshall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [5];\n9)\tshould include the Session-Expires header field according to IETF RFC 4028 [38]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n10)\tshall include the option tag \"timer\" in the Supported header field;\n11)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag for standalone SDS and SDS session;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" for standalone SDS and SDS session;\nc)\tthe g.3gpp.mcdata.fd media feature tag for FD;\nd)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" for FD;\ne)\tthe isfocus media feature tag;\nf)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the incoming SIP INVITE request; and\ng)\tany other uri-parameter provided in the Contact header field of the incoming SIP INVITE request;\n10)\tshall set the Request-URI of the outgoing SIP INVITE request to the public user identity associated to the MCData ID of the terminating MCData user;\n11)\tshall populate the outgoing SIP INVITE request with the MIME bodies that were present in the incoming SIP INVITE request;\n12)\tshall include a P-Asserted-Identity header field in the outgoing SIP INVITE request set to the public service identity of the participating MCData function;\n13)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received incoming SIP INVITE request as specified in clause 9.2.3.3.1 for standalone SDS or clause 9.2.4.3.1 for SDS session or clause 10.2.5.3.1 for FD; and\n14)\tshall send the SIP INVITE request as specified in 3GPP TS 24.229 [5].\nUpon receipt of a SIP 200 (OK) response in response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n2)\tshall include in the SIP 200 (OK) response an SDP answer based on the SDP answer in the received SIP 200 (OK) response as specified in clause 9.2.3.3.2 for standalone SDS or clause 9.2.4.3.2 for SDS session or clause 10.2.5.3.2 for FD;\n3)\tshall include the option tag \"timer\" in a Require header field;\n4)\tshall include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If no \"refresher\" parameter was included in the SIP INVITE request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\n5)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag for standalone SDS and SDS session;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" for standalone SDS and SDS session;\nc)\tthe g.3gpp.mcdata.fd media feature tag for FD;\nd)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" for FD;\ne)\tthe isfocus media feature tag;\nf)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP INVITE request from the controlling MCData function; and\ng)\tany other uri-parameter provided in the Contact header field of the incoming SIP INVITE request;\n6)\tif the incoming SIP response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response;\n7)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function;\n8)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\n9)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.2.1.5 for standalone SDS or clause 6.2.2.5 for SDS session or clause 7.2.2 for FD;\n10)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [5]; and\n11)\tif FD requested, shall generate and send an FD NOTIFICATION indicating acceptance of the FD request as specified in clause 12.2.2.3.\nUpon receiving a SIP 480 (Temporarily Unavailable) response with the warning text set to: \"231 user deferred the call invitation\" in a Warning header field as specified in clause 4.9 to the above SIP INVITE request and request is for FD and if later delivery is required, the participating MCData function:\n1)\tshall store the communication for later delivery with following additional information included:\na)\tshall include a Payload IE with:\ni)\tthe Payload content type set to \"FILEURL\" as specified in clause 15.2.13; and\nii)\tthe URL of the file to be stored for later delivery is included in the Payload data as specified in clause 15.2.13; and\nNOTE 3:\tThe file can be stored in the temporary storage of the MCData server or MCData content server. The URL of stored file for later delivery is updated accordingly.\nb)\tmay include a Metadata IE with the required file description information and file availability information;\n2)\tif the communication is stored in step 1) above and to store the file content in the temporary storage, shall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5] with the following clarifications:\na)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [5] with the following clarifications:\ni)\tshall include an \"m=message\" media-level section for the accepted MCData media stream consisting of:\nA)\tshall include the IP address and port number of the participating MCData function, for the accepted media stream in the received SDP offer;\nB)\ta protocol field value of \"TCP/MSRP\" or \"TCP/TLS/MSRP\" for TLS according to the received SDP offer;\nC)\ta format list field set to '*';\nD)\tan \"a=recvonly\" attribute;\nE)\tan \"a=path\" attribute containing its own MSRP URI;\nF)\tset the content type as a=accept-types:application/vnd.3gpp.mcdata-signalling; and\nG)\tset the a=setup attribute set to \"passive\", according to IETF RFC 6135 [19];\nb)\tshall include the option tag \"timer\" in a Require header field;\nc)\tshall include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38], \"UAS Behavior\". If no \"refresher\" parameter was included in the SIP INVITE request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\nd)\tshall include the following in the Contact header field:\ni)\tthe g.3gpp.mcdata.fd media feature tag;\nii)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\"; and\niii)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP INVITE request from the controlling MCData function;\ne)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\nf)\tshall include the warning text set to \"232 communication is stored for later delivery\" in a Warning header field as specified in clause 4.9;\ng)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 7.2.5.1 to receive the file from controlling MCData function and clause 7.1.3.2 to receive the file content; and\nh)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [5]; and\n3)\tshall generate and send an FD NOTIFICATION indicating deferral of the FD request as specified in clause 12.2.2.3.\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response;\n3)\tshall forward the SIP response to the controlling MCData function according to 3GPP TS 24.229 [5]; and\n4)\tif FD requested, shall generate and send an FD NOTIFICATION indicating rejection of the FD request as specified in clause 12.2.2.3.\nIf FD requested, on receipt of an indication from the media plane of the successful download of the file or on successful download of the file after retrival of deferred FD request by the receiving MCData client and if the received FD SIGNALLING PAYLOAD message contained an FD disposition request type IE requesting a file download completed update indication in the sent SIP INVITE request, then, the participating MCData function:\n1)\tshall follow the procedures described in clause 12.2.2.3.\nIf FD requested, on receipt of an indication from the media plane of the successful download of the file for later delivery, the participating MCData function:\n1)  shall update the URL of the stored file for later delivery in the Payload data.\nUpon receipt of a \"SIP REFER request for a pre-established session\", with:\n1)\tthe Refer-To header field containing a Content-ID (\"cid\") Uniform Resource Locator (URL) as specified in IETF RFC 2392 [33] that:\na)\tpoints to an application/resource-lists+xml MIME body as specified in IETF RFC 5366 [18] containing one or more <entry> element(s) in the <list> element in the <resource-lists> element, where the <entry> element contains a \"uri\" attribute containing a SIP URI set to the MCData ID of the called user(s) or ;\nb)\tpoints to an MIME body section which conatins one or more MIME bodies and Content-Type header filed set to \"application/vnd.3gpp.mcdata-info+xml\" or set to \"multipart/mixed\";\n2)\tan hname \"body\" parameter in the headers portion of the SIP URI specified above containing an application/vnd.3gpp.mcdata-info MIME body with the <session-type> element set to a value of \"adhoc-group-sds-session\" for standalone SDS message and SDS session or \"adhoc-group-fd-session\" for FD session; and\n3)\ta Content-ID header field set to the \"cid\" URL;\nthe participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP REFER request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and shall not continue with the rest of the steps;\n2)\tshall determine the MCData ID of the calling user from public user identity in the P-Asserted-Identity header field of the SIP REFER request;\nNOTE 1:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP REFER request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tif through local policy in the participating MCData function, the user identified by the MCData ID is not authorised to initiate adhoc group data communications, shall reject the \"SIP REFER request for pre-established session\" with a SIP 403 (Forbidden) response to the SIP REFER request, with warning text set to \"237 user not authorised to make adhoc group data communications\" in a Warning header field as specified in clause 4.9;\n5)\tshall determine the public service identity of the controlling MCData function for the adhoc group data communication service of SDS if SDS is requested or FD if FD is requested associated with the originating user's identity i.e. MCData ID;\nNOTE 2:\tThe public service identity can identify the controlling MCData function in the primary MCData system.\nNOTE 3:\tHow the participating MCData function determines the public service identity of the controlling MCData function for the adhoc group data communication service associated with the originating user is out of the scope of the present document.\n6)\tif the participating MCData function is unable to identify the controlling MCData function for the adhoc group data communication service for SDS if standalone SDS and SDS session is requested or FD if FD is requested associated with the originating user's MCData ID identity, it shall reject the SIP REFER request with a SIP 404 (Not Found) response with the warning text \"142 unable to determine the controlling function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n7)\tif the <allow-adhoc-group-call> element of the <ruleset> element is not present in the MCData user profile document on the participating MCData function or is present with the value \"false\" (see the MCData user profile document in 3GPP TS 24.484 [12]), indicating that the user identified by the MCData ID is not authorised to initiate adhoc group data communications, shall reject the \"SIP REFER request for a pre-established session\" with a SIP 403 (Forbidden) response, with warning text set to \"238 user not authorised to initiate the adhoc group data communication\" in a Warning header field as specified in clause 4.9, and shall not continue with the rest of the steps;\n8)\tif the \"SIP REFER request for a pre-established session\" contained a Refer-Sub header field containing \"false\" value and a Supported header field containing \"norefersub\" value, shall handle the SIP REFER request as specified in 3GPP TS 24.229 [5], IETF RFC 3515 [51] as updated by IETF RFC 6665 [36], and IETF RFC 4488 [53] without establishing an implicit subscription;\n9)\tshall generate a final SIP 200 (OK) response to the \"SIP REFER request for a pre-established session\" according to 3GPP TS 24.229 [5];\nNOTE 4:\tIn accordance with IETF RFC 4488 [53], the participating MCData function inserts the Refer-Sub header field containing the value \"false\" in the SIP 200 (OK) response to the SIP REFER request to indicate that it has not created an implicit subscription.\n10)\tshall wait for the receipt of a SIP response to the SIP INVITE request that will be generated and sent in subsequent steps;\n11)\tshall generate a SIP INVITE request as specified in clause 9.2.5.1.1 with the following clarifications:\na)\tif the <adhoc-grp-emg-alert-grp-ind> element of the <anyExt> element of <mcdata-Params> element of <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP REFER request set to a value of \"true\", shall copy the identity of adhoc group from the \"uri\" attribute of the <entry> element of a <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body pointed to by the \"cid\" URL in the Refer-To header field of the SIP REFER request, to the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP INVITE request and do not include application/resource-lists+xml MIME body;\nEditor's Note:\tThe parameters related to FD will be added in the future.\nNOTE 5:\tThe MCData client can include either a list of MCData users or the criteria for determining the list of MCData users to be called. These two information elements are not included if the call setup request follows an adhoc group for emergency alerts.\n12)\tshall set the Request-URI to the public service identity of the controlling MCData function as determined in step 6;\n13)\tif the received SIP REFER request contained a Resource-Priority header field, shall include in the outgoing SIP INVITE request a Resource-Priority header field according to rules and procedures of 3GPP TS 24.229 [5] set to the value indicated in the Resource-Priority header field of the received SIP REFER request from the MCData client;\nNOTE 6:\tThe participating MCData function will leave verification of the Resource-Priority header field to the controlling MCData function.\n14)\tshall include the <mcdata-calling-user-id> element set to the MCData ID of the calling user in the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP INVITE request; and\n15)\tshall forward the SIP INVITE request according to 3GPP TS 24.229 [5].\nUpon receiving SIP provisional responses for the SIP INVITE request, the participating MCData function:\n1)\tshall discard the received SIP responses without forwarding them.\nUpon receiving a SIP 200 (OK) response for the SIP INVITE request the participating MCData function:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15];\n2)\tshall include the application/vnd.3gpp.mcdata-info+xml MIME body received in the SIP 200 (OK) response into the generated final SIP 200 (OK) response to the \"SIP REFER request for a pre-established session\";\n3)\tshall send the generated final SIP 200 (OK) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP INVITE request, the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5]; and\n2)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\nEditor's Note:\tThe terminating procedures will be defined in future.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.3.3\tAdhoc group data communication release",
                            "text_content": "This clause describes the originating, and terminating data communication release participating MCData function procedures.\nUpon receiving SIP BYE request from controlling MCData function, the participating MCData function should follow the procedure described in clause 13.2.2.2.3.1 with following clarification:\n1)\tif an application/vnd.3gpp.mcdata-info+xml MIME body is present in the incoming SIP BYE request, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body into the outgoing SIP BYE request.\nUpon receiving SIP BYE request from controlling MCData function, the participating MCData function should follow the procedure described in clause 13.2.2.2.3.2 with following clarifications:\n1)\tif reason header is present in the incoming SIP BYE request, shall copy the contents of the reason header field of the incoming SIP BYE request to the reason header field of the outgoing SIP BYE request; and\n2)\tif an application/vnd.3gpp.mcdata-info+xml MIME body is present in the incoming SIP BYE request, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body into the outgoing SIP BYE request.\nUpon receiving a SIP REFER request with the \"method\" SIP URI parameter set to value \"BYE\" in the URI in the Refer-To header field from the MCData client, the participating MCData function:\n1)\tshall determine the MCData ID of the calling user from public user identity in the P-Asserted-Identity header field of the SIP REFER request;\n2)\tif the participating MCData function cannot find a binding between the public user identity, then the participating MCData function shall reject the SIP REFER request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and skip the rest of the steps;\n3)\tif the SIP REFER request contained a Refer-Sub header field containing \"false\" value and a Supported header field containing \"norefersub\" value, shall handle the SIP REFER request as specified in 3GPP TS 24.229 [5], IETF RFC 3515 [51] as updated by IETF RFC 6665 [36], and IETF RFC 4488 [53] without establishing an implicit subscription;\n4)\tshall generate a SIP 200 (OK) response to the SIP REFER request, and in the SIP 200 (OK) response:\na)\tshall include the Supported header field with value \"norefersub\" according to rules and procedures of IETF RFC 4488 [53]; and\nb)\tshall check the presence of the Refer-Sub header field of the SIP REFER request and if it is present and set to the value \"false\" shall include the Refer-Sub header field with value \"false\" according to rules and procedures of IETF RFC 4488 [53];\n5)\tshall send the SIP 200 (OK) response to the SIP REFER request towards MCData client according to 3GPP TS 24.229 [5];\n6)\tshall generate a SIP BYE request, and in the SIP BYE request:\na)\tshall set the Request-URI to the MCData session identity which was included at the Refer-To header field of the received REFER request; and\nb)\tshall include a P-Asserted-Identity header field in the outgoing SIP BYE request set to the public service identity of the participating MCData function; and\n7)\tshall send the SIP BYE request toward the controlling MCData function according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response to the SIP BYE request the participating MCData function shall interact with the media plane as specified in 3GPP TS 24.582 [15] for releasing media plane resources associated with the SIP session with the controlling MCData function.\nEditor's Note:\tThe terminating procedures will be defined in future.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.3.4\tAdhoc group data communication rejoin",
                            "text_content": "This clause describes the originating, and terminating data communication rejoin participating MCData function procedures.\nUpon receipt of a \"SIP INVITE request for MCData adhoc group session for originating participating MCData function\" containing an application/vnd.3gpp.mcdata-info+xml MIME body with the <request-type> element set to a value of \"adhoc-group-sds-session\" or a value of \"adhoc-group-fd-session\", the participating MCData function shall follow the procedures specified in clause 24.3.2.1.1 with the clarification in step 9) of clause 24.3.2.1.1 that the Request-URI of the SIP INVITE request shall contain a URI of the MCData session identity which mapped to the MCData session identity provided in Request-URI of the \"SIP INVITE request for MCData adhoc group session for originating participating MCData function\".\nUpon receipt of a \"SIP REFER request for a pre-established session\", with the Refer-To header containing an application/vnd.3gpp.mcdata-info+xml MIME type content in an hname \"body\" parameter in the headers portion of the SIP URI and with the <session-type> element set to \"adhoc\", the participating MCData function shall follow the procedures specified in clause 24.3.2.2.1 with the clarification in step 13) of clause 24.3.2.2.1 that the Request-URI of the SIP INVITE request shall contain a URI of the MCData session identity which mapped to the MCData session identity provided in the Refer-To header field of the \"SIP REFER request for a pre-established session\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.3.5\tAdhoc group data communication participants modify",
                            "text_content": "This clause describes the originating adhoc group data communication participants modify participating MCData function procedures.\nUpon receipt of a SIP re-INVITE request for an MCData adhoc group session identifying an ongoing on-demand MCData adhoc group session, the participating MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP re-INVITE request with a SIP 500 (Server Internal Error) response. The participating MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. Otherwise, continue with the rest of the steps;\n2)\tshall determine the MCData ID of the calling user from public user identity in the P-Asserted-Identity header field of the SIP re-INVITE request;\nNOTE:\tThe MCData ID of the calling user is bound to the public user identity at the time of service authorisation, as documented in clause 7.3.\n3)\tif the participating MCData function cannot find a binding between the public user identity and an MCData ID or if the validity period of an existing binding has expired, then the participating MCData function shall reject the SIP re-INVITE request with a SIP 404 (Not Found) response with the warning text set to \"141 user unknown to the participating function\" in a Warning header field as specified in clause 4.9, and shall not continue with any of the remaining steps;\n4)\tshall validate the media parameters and if the MSRP URI is not offered in the SIP re-INVITE request shall reject the request with a SIP 488 (Not Acceptable Here) response. Otherwise, continue with the rest of the steps;\n5)\tshall generate an outgoing SIP re-INVITE request according to 3GPP TS 24.229 [5];\n6)\tshall copy the application/vnd.3gpp.mcdata-info+xml MIME body from the received SIP re-INVITE request into the outgoing SIP re-INVITE request;\n7)\tshall include the MCData ID of the originating user in <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP re-INVITE request;\n8)\tshall include in the SIP re-INVITE request an SDP offer containing the current media parameters used by the existing session;\n9)\tshall copy the application/resource-lists+xml MIME body from the received SIP re-INVITE request into the outgoing SIP re-INVITE request; and\n10)\tshall forward the SIP re-INVITE request according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 2xx response in response to the above SIP re-INVITE request, the participating MCData function:\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [5];\n2)\tshall include in the SIP 200 (OK) response an SDP answer containing the current media parameters used by the existing session;\n3)\tshall include Warning header field(s) that were received in the incoming SIP 200 (OK) response;\n4)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag for standalone SDS and SDS session;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" for standalone SDS and SDS session;\nc)\tthe g.3gpp.mcdata.fd media feature tag for FD;\nd)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" for FD; and\ne)\tthe isfocus media feature tag;\n5)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the participating MCData function;\n6)\tshall include the option tag \"tdialog\" in a Supported header field according to rules and procedures of IETF RFC 4538 [54];\n7)\tshall include the option tag \"norefersub\" in a Supported header field according to rules and procedures of IETF RFC 4488 [53];\n8)\tif the incoming SIP 200 (OK) response contained an application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response; and\n9)\tshall send the SIP 200 (OK) response towards the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 403 (Forbidden) response to the above SIP re-INVITE request, the participating MCData function:\n1)\tshall generate a SIP 403 (Forbidden) response according to 3GPP TS 24.229 [5];\n2)\tshall copy, if included in the received SIP 403 (Forbidden) response, the application/vnd.3gpp.mcdata-info+xml MIME body MIME body to the outgoing SIP 403 (Forbidden) response;\n3)\tshall include Warning header field(s) that were received in the incoming SIP 403 (Forbidden) response; and\n4)\tshall forward the SIP 403 (Forbidden) response to the MCData client according to 3GPP TS 24.229 [5].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP re-INVITE request, the participating MCData function:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [5];\n2)\tshall include Warning header field(s) that were received in the incoming SIP response; and\n3)\tshall forward the SIP response to the MCData client according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "24.4\tControlling MCData function procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "24.4.1\tGeneral",
                            "text_content": "This clause describes the adhoc group data communications controlling MCData function procedures using on-demand and pre-established sessions to setup adhoc group data communications, release the ongoing adhoc group data communications, and modify the ongoing adhoc group data communications participants.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.4.2\tAdhoc group data communication setup",
                            "text_content": "This clause describes the originating, and terminating data communication setup controlling MCData function procedures.\nThis clause describes the procedures for inviting an MCData user to an MCData session. The procedure is initiated by the controlling MCData function as the result of an action in clause 24.4.2.2 or as the result of receiving a SIP 403 (Forbidden) response as described in this clause.\nThe controlling MCData function:\n1)\tshall generate a SIP INVITE request as specified in 3GPP TS 24.229 [5] with an application/vnd.3gpp.mcdata-info+xml MIME body included;\n2)\tshall include the Supported header field set to \"timer\";\n3)\tshould include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [38]. The refresher parameter shall be omitted;\n4)\tif a standalone SDS message is to be sent or SDS session is requested:\na)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\nb)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\nc)\tshall include in the Contact header field an MCData session identity for the MCData session with the g.3gpp.mcdata.sds media feature tag, the isfocus media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" according to IETF RFC 3840 [16]; and\nd)\t\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n5)\tif a FD is requested:\na)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [8];\nb)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.fd media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [8];\nc)\tshall include in the Contact header field an MCData session identity for the MCData session with the g.3gpp.mcdata.fd media feature tag, the isfocus media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" according to IETF RFC 3840 [16];\nd)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" (coded as specified in 3GPP TS 24.229 [5]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7] in the SIP INVITE request;\ne)\tshall include in the outgoing SIP INVITE request, the application/vnd.3gpp.mcdata-signalling MIME body that was present in the incoming SIP INVITE request; and\nf)\tif the application/vnd.3gpp.mcdata-signalling MIME body in the received SIP INVITE request contained a FD SIGNALLING PAYLOAD message without the Mandatory download IE included, then:\ni)\tshall execute the procedures in clause 11.2; and\nii)\tif the procedures in clause 11.2 indicate that the mandatory download indication needs to be included, shall include the Mandatory download IE set to a value of \"MANDATORY DOWNLOAD\" in the FD SIGNALLING PAYLOAD message of the outgoing SIP INVITE request;\n6)\tshall include a Referred-By header field with the public user identity of the inviting MCData client;\n7)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP INVITE request:\na)\tthe <mcdata-request-uri> element set to the MCData ID of the terminating user;\nb)\tthe <mcdata-calling-group-id> element set to the group identity of the adhoc group as determined in the clause 24.4.2.2;\nc)\tthe <mcdata-calling-user-id> element set to the calling user MCData ID; and\nd)\tif end-to-end security is requested for the call, the <anyExt> element with the <preconfigured-group-id> element set to the preconfigured group identity as determined in the clause 24.4.2.2;\n8)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated to the MCData user to be invited;\nNOTE 1:\tHow the controlling MCData function finds the address of the terminating MCData participating function is out of the scope of the present document.\n9)\tshall set the P-Asserted-Identity header field to the public service identity of the controlling MCData function;\n10)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received SIP INVITE request from the originating client according to the procedures specified in clause 9.2.3.4.1 for standalone SDS or clause 9.2.4.4.1 for SDS session or clause 10.2.5.4.1 for FD; and\n11)\tshall send the SIP INVITE request towards the terminating client in accordance with 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response for the SIP INVITE request the controlling MCData function:\n1)\tshall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.3.1 for standalone SDS or clause 6.3.2 for SDS session or clause 7.3 for FD; and\n2)\tshall increment the local counter of the number of SIP 200 (OK) responses received from invited members, by 1.\nNOTE 2:\tThe procedures executed by the controlling MCData function prior to sending a response to the inviting MCData client are specified in clause 24.4.2.2.\nIn the procedures in this clause:\n1)\tMCData ID in an incoming SIP INVITE request refers to the MCData ID of the originating user from the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request;\n2)\tadhoc group identity in an incoming SIP INVITE request if included refers to the adhoc group identity from the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request; and\n3)\tMCData ID in an outgoing SIP INVITE request refers to the MCData ID of the called user in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP INVITE request.\nUpon receipt of a \"SIP INVITE request for MCData adhoc group session for controlling MCData function\", the controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tif FD requested and if the received SIP INVITE request has been queued for later transmission, shall include warning text set to \"215 request to transmit is queued by the server\" in a Warning header field as specified in clause 4.9, in the SIP 100 (Trying) response, and shall send the SIP 100 (TRYING) response towards the originating participating MCData function according to 3GPP TS 24.229 [5] and not continue with the remaining steps in this clause. Otherwise, continue with the rest of the steps;\n3)\tshall determine if the media parameters are acceptable and the MSRP URI is offered in the SDP offer and if not reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n4)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if:\na)\tan Accept-Contact header field does not include the g.3gpp.mcdata.sds media feature tag for standalone SDS or SDS session;\nb)\tan Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" for standalone SDS or SDS session;\nc)\tan Accept-Contact header field does not include the g.3gpp.mcdata.fd media feature tag for FD; or\nd)\tan Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" for FD;\n5)\tif FD requested and the incoming SIP INVITE request does not contain an application/vnd.3gpp.mcdata-signalling MIME body with the FD SIGNALLING PAYLOAD as described in clause 6.2.2.3, shall reject the SIP INVITE request with appropriate reject code;\n6)\tif the originating user identified by the MCData ID is not authorised to initiate the adhoc group session if the <allow-adhoc-group-data-comn> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the originating MCData user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"false\", shall send a SIP 403 (Forbidden) response with the warning text set to: \"238 user not authorised to initiate the adhoc group data communication\" in a Warning header field as specified in clause 4.9 and skip the rest of the steps below;\n7)\tif the MCData service does not support the adhoc group data communication, which is indicated by the <allow-adhoc-group-data-comn-support> element of the <adhoc-group-data-comn> element of the <anyExt> element contained in the <OnNetwork> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]) is set to a value of \"false\" or if it does not exists, shall send a SIP 403 (Forbidden) response with the warning text set to: \"239 the MCData system do not support adhoc group data communication\" in a Warning header field as specified in clause 4.9 and skip the rest of the steps below;\n8)\tif the application/resource-lists+xml MIME body with the MCData ID of the invited MCData users to be called exists in the incoming SIP INVITE request, shall check if the number of invited participants is within the configured limit as specified in the <max-no-participants> element of the <adhoc-group-data-comn> element of the <anyExt> element contained in the <OnNetwork> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]). If not within the configured limit, shall send a SIP 403 (Forbidden) response including warning text set to \"242 maximum number of allowed adhoc group participants exceeded\" in a Warning header field as specified in clause 4.9 and shall skip the rest of the steps;\n9)\tif the application/resource-lists+xml MIME body with the MCData ID of the invited MCData users to be called exists in the incoming SIP INVITE request and the <comn-participants-criteria> element with one or more criteria as a comma separated into <anyExt> element of <mcdata-Params> element of <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP INVITE request exists, shall send a SIP 403 (Forbidden) response including warning text set to \"240 can’t determine the adhoc group participants\" in a Warning header field as specified in clause 4.9 and shall skip the rest of the steps;\n10)\tshall cache SIP feature tags, if received in the Contact header field and if the specific feature tags are supported;\n11)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [38];\n12)\tshall maintain a local counter of the number of SIP 200 (OK) responses received from invited members and shall initialise this local counter to zero;\n13)\tshall create the adhoc group and generate the group identity to be associated with the adhoc group if the identity of adhoc group included in the <mcdata-request-uri> element of the <mcdata-Params> element of the <mcdatainfo> element containing in an application/vnd.3gpp.mcdata-info+xml MIME body received in the SIP INVITE request is not acceptable or not included;\n14)\tif originating MCData user has requested for end-to-end security by including the <end-to-end-security> element in the <anyExt> element of the <mcdata-Params> element of the <mcdatainfo> element containing in an application/vnd.3gpp.mcdata-info+xml MIME body received in the SIP INVITE request with the value set to \"true\", shall determine the preconfigured group from which security related materials can be used by the adhoc group data communication participants to communicate securely in the adhoc group session;\n15)\tshall determine the members to invite to the adhoc group session:\na)\tif the application/resource-lists+xml MIME body with the MCData ID of the invited MCData users to be called exists in the incoming SIP INVITE request, shall consider the each entry of the MCData users to be invited to the adhoc group session; or\nb)\tif the application/vnd.3gpp.mcdata-info+xml MIME body with the criteria for determining the list of MCData users to be called exists in the incoming SIP INVITE request included in the <comn-participants-criteria> element of the <anyExt> element of <mcdata-Params> element of <mcdatainfo> element of the application/vnd.3gpp.mcdata-info+xml MIME body, shall consider each of the MCData users meeting the specified criteria and also may be based on the local policy to be invited to the adhoc group session;\n16) shall invite each adhoc group member determined in step 12) above, to the adhoc group session, as specified in clause 24.4.2.1.1;\n17) shall consider all the invited members as implicitly affiliated to the adhoc group; and\n18) shall interact with the media plane as specified in 3GPP TS 24.582 [15] clause 6.3.1 for standalone SDS or clause 6.3.2 for SDS session or clause 7.3 for FD.\nUpon receiving a SIP 200 (OK) response for a SIP INVITE request as specified in clause 24.4.2.2, and if the MCData ID in the SIP 200 (OK) response matches to the MCData ID in the corresponding SIP INVITE request, and the SIP final response is not yet sent to the inviting MCData client, the controlling MCData function:\n1)\tshall invoke the procedure in clause 6.3.7.1.23 with an indication that the applicable MCData subservice is Short Data Service using media (standalone SDS) or Short Data Service using session (SDS session) or File Distribution, in order to generate a SIP 200 (OK) response to the received SIP INVITE request according to 3GPP TS 24.229 [5] with clarification below:\na)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <mcdata-calling-group-id> element set to the adhoc group identity as determined in this clause; and\nii)\tif end-to-end security requested for the data communication, the <anyExt> element with the <preconfigured-group-id> element set to the preconfigured group identity as determined in this clause; and\n2)\tshall send the generated SIP 200 (OK) response to the inviting MCData client according to 3GPP TS 24.229 [5].\nUpon receiving a SIP 200 (OK) response for a SIP INVITE request as specified in clause 24.4.2.2, and if the warning text set to \"232 communication is stored for later delivery\" is received in a Warning header field as specified in clause 4.9, and the SIP final response is not yet sent to the inviting MCData client, the controlling MCData function:\n1)\tshall invoke the procedure in clause 6.3.7.1.23 with an indication that the applicable MCData subservice is Short Data Service using media (standalone SDS) or Short Data Service using session (SDS session) or File Distribution, in order to generate a SIP 200 (OK) response to the received SIP INVITE request according to 3GPP TS 24.229 [5] with clarification below:\na)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <mcdata-calling-group-id> element set to the adhoc group identity as determined in this clause; and\nii)\tif end-to-end security requested for the data communication, the <anyExt> element with the <preconfigured-group-id> element set to the preconfigured group identity as determined in this clause; and\n2)\tshall send the generated SIP 200 (OK) response to the inviting MCData client according to 3GPP TS 24.229 [5].\nNOTE:\tWhen requested to release the associated media plane resources and to tear down the MCData session, the controlling MCData function stores the INVITE session information that is established between the participating function and the controlling function for later delivery.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.4.3\tAdhoc group data communication release",
                            "text_content": "This clause describes the originating, and terminating data communication release controlling MCData function procedures.\nWhen the MCData session for group data communication needs to be released based on local policies and conditions explained in clause 13.2.2.2.4.1, the controlling MCData function shall follow the procedures in clause 13.2.2.2.4.4 with the clarifications given below:\nfor the clause 13.2.2.2.4.1 that:\n1)\tthe condition \"the minimum number of affiliated MCData group members is not present\" is not applicable; and\nfor the clause 13.2.2.2.4.4 that:\n1)\tshall add reason header with reason-text value as appropriate (e.g. data volume limit, time limit expiry).\nWhen an MCData client needs to be removed from the MCData session (e.g. user no longer meeting the criteria), the controlling MCData function shall follow the procedures as specified in clause 13.2.2.2.4.4 with the clarification below:\n1)\tshall add reason header with reason-text value as appropriate (e.g. user no longer meeting the criteria).\nUpon receiving a SIP BYE request the controlling MCData function shall follow the procedures as specified in clause 13.2.2.2.4.3 with the clarifications below:\n1)\tthe condition \"the minimum number of affiliated MCData group members is not present\" of the communication release policy as specified in clause 13.2.2.2.4.1 is not applicable; and\n2)\tshall add reason header with reason-text value as appropriate (e.g. data volume limit, time limit expiry) while following the procedures as specified in the clause 13.2.2.2.4.4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.4.4\tAdhoc group data communication rejoin",
                            "text_content": "This clause describes the originating, and terminating data communication rejoin controlling MCData function procedures.\nUpon receipt of a SIP INVITE request that includes an MCData session identity of an ongoing MCData session in the Request-URI the controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4]. Otherwise, continue with the rest of the steps;\n2)\tshall reject the SIP request with a SIP 404 (Not Found) response if the MCData adhoc group data communication represented by the MCData session identity in Request-URI is not present;\n3)\tshall determine if the media parameters are acceptable and the MSRP URI is offered in the SDP offer and if not reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n4)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if:\na)\tan Accept-Contact header field does not include the g.3gpp.mcdata.sds media feature tag for standalone SDS or SDS session;\nb)\tan Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" for standalone SDS or SDS session;\nc)\tan Accept-Contact header field does not include the g.3gpp.mcdata.fd media feature tag for FD; or\nd)\tan Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" for FD;\n5)\tshall determine the MCData ID of the calling user;\n6)\tshall cache SIP feature tags, if received in the Contact header field and if the specific feature tags are supported;\n7)\tif the user identified by the MCData ID is no longer meeting the criteria if the adhoc group participants are determined using criteria while establishing adhoc group data communication, shall return a SIP 403 (Forbidden) response with the warning text set to \"188 user is not allowed to participate in adhoc group data communication\" in a Warning header field as specified in clause 4.9;\n8)\tshall invoke the procedure in clause 6.3.7.1.23 with an indication that the applicable MCData subservice is Short Data Service using media (standalone SDS) or Short Data Service using session (SDS session) or File Distribution, in order to generate a SIP 200 (OK) response to the received SIP INVITE request according to 3GPP TS 24.229 [5]; and\n9)\tshall send the generated SIP 200 (OK) response to the inviting MCData client according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "24.4.5\tAdhoc group data communication participants modify",
                            "text_content": "This clause describes the terminating adhoc group data communication participants modify controlling MCData function procedures.\nIn the procedures in this clause:\n1)\tMCData ID in an incoming SIP re-INVITE request refers to the MCData ID of the originating user from the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP re-INVITE request;\n2)\tMCData ID in an incoming SIP re-INVITE request refers to the MCData ID of the MCData user to be invited to a data communication from the \"uri\" attribute with the \"method\" SIP URI parameter set to the value \"INVITE\" of the <entry> element of a <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the incoming SIP re-INVITE request; and\n3)\tMCData ID in an incoming SIP re-INVITE request refers to the MCData ID of the MCData user to be removed from a data communication from the \"uri\" attribute with the \"method\" SIP URI parameter set to the value \"BYE\" of the <entry> element of a <list> element of the <resource-lists> element of the application/resource-lists+xml MIME body of the incoming SIP re-INVITE request.\nUpon receipt of a SIP re-INVITE request for an MCData session identifying an on-demand MCData adhoc group session, the controlling MCData function:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP re-INVITE request with a SIP 500 (Server Internal Error) response. The controlling MCData function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall determine if the media parameters are acceptable and the MSRP URI is offered in the SDP offer and if not reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n3)\tif the originating user identified by the MCData ID is not authorised to modify the adhoc group session participants if the <allow-adhoc-group-data-comn-modify> element of the <actions> element of a <rule> element of the <ruleset> element of the MCData user profile document identified by the MCData ID of the originating MCData user (see the MCData user profile document in 3GPP TS 24.484 [12]) is set to a value of \"false\", shall send a SIP 403 (Forbidden) response with the warning text set to: \"243 user is not authorised to initiate modify adhoc group data communication participants\" in a Warning header field as specified in clause 4.9 and skip the rest of the steps below;\n4)\tif the application/resource-lists+xml MIME body with the MCData ID of the MCData users to be invited to a data communication or the MCData ID of the MCData users to be removed from a data communication exists in the incoming SIP re-INVITE request, shall check if the number of existing data communication participants and newly inviting MCData users is within the configured limit as specified in the <max-no-participants> element of the <adhoc-group-data-comn > element of the <anyExt> element contained in the <OnNetwork> element of the MCData service configuration document (see the service configuration document in 3GPP TS 24.484 [12]). If not within the configured limit, shall send a SIP 403 (Forbidden) response including warning text set to \"242 maximum number of allowed adhoc group participants exceeded\" in a Warning header field as specified in clause 4.9 and shall skip the rest of the steps;\n5)\tshall determine the members to invite to the adhoc group session or remove from the adhoc group session based on the local policy and:\na)\tif the application/resource-lists+xml MIME body with the MCData ID of the MCData users to be invited to a data communication exists in the incoming SIP re-INVITE request, shall consider each entry of the MCData users to be invited to the adhoc group session; or\nb)\tif the application/resource-lists+xml MIME body with the MCData ID of the MCData user to be removed from a data communication exists in the incoming SIP re-INVITE request, shall consider the each entry of the MCData users to be removed from the adhoc group session;\n6)\tif the determined members in step 6) above are to be invited to the adhoc group session, shall be invited to the adhoc group session, as specified in clause 24.4.2.1.1;\n7)\tif the determined members in step 6) above are to be removed from the adhoc group session, shall be removed from the adhoc group session, as specified in clause 24.4.3.1;\n8)\tshall consider all the invited members as implicitly affiliated to the adhoc group and remove the affiliation of the user who are removed from the adhoc group session;\n9)\tshall generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [5];\n10)\tshall include in the SIP 200 (OK) response an SDP answer containing the current media parameters used by the existing session;\n11)\tshall include the \"norefersub\" option tag in a Supported header field according to IETF RFC 4488 [53];\n12)\tshall include the \"tdialog\" option tag in a Supported header field according to IETF RFC 4538 [54];\n13)\tshall include a P-Asserted-Identity header field in the outgoing SIP 200 (OK) response set to the public service identity of the controlling MCData function;\n14) shall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag for standalone SDS and SDS session;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" for standalone SDS and SDS session;\nc)\tthe g.3gpp.mcdata.fd media feature tag for FD;\nd)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\" for FD; and\ne)\tthe isfocus media feature tag; and\n15)\tshall send the SIP 200 (OK) response towards the MCData client according to 3GPP TS 24.229 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "B.1\tGeneral",
            "description": "This clause describes the media feature tag definitions that are applicable for the 3GPP IM CN Subsystem for the realisation of the Mission Critical Data (MCData) service.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.2\tDefinition of media feature tag for Mission Critical Data (MCData) communications Short Data Service (SDS)",
            "description": "Media feature tag name: g.3gpp.mcdata.sds\nASN.1 Identifier: 1.3.6.1.8.2.29\nSummary of the media feature indicated by this media feature tag: This media feature tag when used in a SIP request or a SIP response indicates that the function sending the SIP message supports Mission Critical Data (MCData) communications Short Data Service (SDS).\nValues appropriate for use with this media feature tag: Boolean\nThe media feature tag is intended primarily for use in the following applications, protocols, services, or negotiation mechanisms: This media feature tag is most useful in a communications application, for describing the capabilities of a device, such as a phone or PDA.\nExamples of typical use: Indicating that a mobile phone supports the Mission Critical Data (MCData) communications Short Data Service (SDS).\nRelated standards or documents: 3GPP TS 24.282: \"Mission Critical Data (MCData) signalling control Protocol specification\"\nSecurity Considerations: Security considerations for this media feature tag are discussed in clause 11.1 of IETF RFC 3840 [16].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.3\tDefinition of media feature tag for Mission Critical Data (MCData) communications File Distribution (FD)",
            "description": "Media feature tag name: g.3gpp.mcdata.fd\nASN.1 Identifier: 1.3.6.1.8.2.30\nSummary of the media feature indicated by this media feature tag: This media feature tag when used in a SIP request or a SIP response indicates that the function sending the SIP message supports Mission Critical Data (MCData) communications File Distribution (FD).\nValues appropriate for use with this media feature tag: Boolean\nThe media feature tag is intended primarily for use in the following applications, protocols, services, or negotiation mechanisms: This media feature tag is most useful in a communications application, for describing the capabilities of a device, such as a phone or PDA.\nExamples of typical use: Indicating that a mobile phone supports the Mission Critical Data (MCData) communications File Distribution (FD).\nRelated standards or documents: 3GPP TS 24.282: \"Mission Critical Data (MCData) signalling control Protocol specification\"\nSecurity Considerations: Security considerations for this media feature tag are discussed in clause 11.1 of IETF RFC 3840 [16].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.4\tDefinition of media feature tag for Mission Critical Data (MCData) communications IP Connectivity (IPCONN)",
            "description": "Media feature tag name: g.3gpp.mcdata.ipconn\nEditor's Note: [MONASTERY2, CR 0294R1, C1-221903] It is necessary to obtain and register an ASN.1 Identifier for this media feature tag,\nASN.1 Identifier:\nSummary of the media feature indicated by this media feature tag: This media feature tag when used in a SIP request or a SIP response indicates that the function sending the SIP message supports Mission Critical Data (MCData) communications IP Connectivity (IPCONN).\nValues appropriate for use with this media feature tag: Boolean\nThe media feature tag is intended primarily for use in the following applications, protocols, services, or negotiation mechanisms: This media feature tag is most useful in a communications application, for describing the capabilities of a device, such as a phone or PDA.\nExamples of typical use: Indicating that a mobile phone supports the Mission Critical Data (MCData) communications IP Connectivity (IPCONN).\nRelated standards or documents: 3GPP TS 24.282: \"Mission Critical Data (MCData) signalling control Protocol specification\"\nSecurity Considerations: Security considerations for this media feature tag are discussed in clause 11.1 of IETF RFC 3840 [16].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "C.1\tGeneral",
            "description": "This clause describes the IMS Communications Service Identifier (ICSI) definitions that are applicable for the 3GPP IM CN Subsystem for the realisation of the Mission Critical Data (MCData) service.\nNOTE:\tThe template has been created using the headers of the table in http://www.3gpp.org/specifications-groups/34-uniform-resource-name-urn-list\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "C.2\tDefinition of ICSI value for the Mission Critical Data (MCData) service",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "C.2.1\tURN",
                    "description": "",
                    "summary": "",
                    "text_content": "urn:urn-7:3gpp-service.ims.icsi.mcdata\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.2.2\tDescription",
                    "description": "",
                    "summary": "",
                    "text_content": "This URN indicates that the device has the capabilities to support the Mission Critical Data (MCData) service. This URN is also used by the device to associate a SIP request with the Mission Critical Data (MCData) service.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.2.3\tReference",
                    "description": "",
                    "summary": "",
                    "text_content": "3GPP TS 24.282: \"Mission Critical Data (MCData) signalling control Protocol specification\".\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.2.4\tContact",
                    "description": "",
                    "summary": "",
                    "text_content": "Name: Ricky Kaura\nEmail: ricky.kaura@samsung.com\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.2.5\tRegistration of subtype",
                    "description": "",
                    "summary": "",
                    "text_content": "Yes\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.2.6\tRemarks",
                    "description": "",
                    "summary": "",
                    "text_content": "This URN is included in the \"g.3gpp.icsi-ref\" media feature tag in the Contact header field of SIP requests (not SIP MESSAGE) and responses, and the Accept-Contact header fields of non-register SIP requests.\nThis URN can be included by the device in the P-Preferred-Service header field of SIP requests, and is asserted by the network into the P-Asserted-Service header field of SIP Requests.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "C.3\tDefinition of ICSI value for the Mission Critical Data (MCData) communications Short Data Service (SDS)",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "C.3.1\tURN",
                    "description": "",
                    "summary": "",
                    "text_content": "urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.3.2\tDescription",
                    "description": "",
                    "summary": "",
                    "text_content": "This URN indicates that the device has the capabilities to support the Mission Critical Data (MCData) Short Data Service (SDS) IMS communication service. This URN is also used by the device to associate a SIP request with the Mission Critical Data (MCData) Short Data Service (SDS) IMS communication service.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.3.3\tReference",
                    "description": "",
                    "summary": "",
                    "text_content": "3GPP TS 24.282: \"Mission Critical Data (MCData) signalling control Protocol specification\".\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.3.4\tContact",
                    "description": "",
                    "summary": "",
                    "text_content": "Name: Ricky Kaura\nEmail: ricky.kaura@samsung.com\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.3.5\tRegistration of subtype",
                    "description": "",
                    "summary": "",
                    "text_content": "Yes\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.3.6\tRemarks",
                    "description": "",
                    "summary": "",
                    "text_content": "This URN is included in the \"g.3gpp.icsi-ref\" media feature tag in the Contact header field of SIP requests (not SIP MESSAGE) and responses, and the Accept-Contact header fields of non-register SIP requests.\nThis URN can be included by the device in the P-Preferred-Service header field of SIP requests, and is asserted by the network into the P-Asserted-Service header field of SIP Requests.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "C.4\tDefinition of ICSI value for Mission Critical Data (MCData) communications File Distribution (FD)",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "C.4.1\tURN",
                    "description": "",
                    "summary": "",
                    "text_content": "urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.4.2\tDescription",
                    "description": "",
                    "summary": "",
                    "text_content": "This URN indicates that the device has the capabilities to support the Mission Critical Data (MCData) File Distribution (FD) IMS communication service. This URN is also used by the device to associate a SIP request with the Mission Critical Data (MCData) File Distribution (FD) IMS communication service.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.4.3\tReference",
                    "description": "",
                    "summary": "",
                    "text_content": "3GPP TS 24.282: \"Mission Critical Data (MCData) signalling control Protocol specification\".\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.4.4\tContact",
                    "description": "",
                    "summary": "",
                    "text_content": "Name: Ricky Kaura\nEmail: ricky.kaura@samsung.com\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.4.5\tRegistration of subtype",
                    "description": "",
                    "summary": "",
                    "text_content": "Yes\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.4.6\tRemarks",
                    "description": "",
                    "summary": "",
                    "text_content": "This URN is included in the \"g.3gpp.icsi-ref\" media feature tag in the Contact header field of SIP requests (not SIP MESSAGE) and responses, and the Accept-Contact header fields of non-register SIP requests.\nThis URN can be included by the device in the P-Preferred-Service header field of SIP requests, and is asserted by the network into the P-Asserted-Service header field of SIP Requests.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "C.5\tDefinition of ICSI value for Mission Critical Data (MCData) communications IP Connectivity (IPCONN)",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "C.5.1\tURN",
                    "description": "",
                    "summary": "",
                    "text_content": "urn:urn-7:3gpp-service.ims.icsi.mcdata.ipconn\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.5.2\tDescription",
                    "description": "",
                    "summary": "",
                    "text_content": "This URN indicates that the device has the capabilities to support the Mission Critical Data (MCData) IP Connectivity (IPCONN) IMS communication service. This URN is also used by the device to associate a SIP request with the Mission Critical Data (MCData) IP Connectivity (IPCONN) IMS communication service.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.5.3\tReference",
                    "description": "",
                    "summary": "",
                    "text_content": "3GPP TS 24.282: \"Mission Critical Data (MCData) signalling control Protocol specification\".\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.5.4\tContact",
                    "description": "",
                    "summary": "",
                    "text_content": "Name: Kiran Kapale\nEmail: kiran.kapale@samsung.com\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.5.5\tRegistration of subtype",
                    "description": "",
                    "summary": "",
                    "text_content": "Yes\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.5.6\tRemarks",
                    "description": "",
                    "summary": "",
                    "text_content": "This URN is included in the \"g.3gpp.icsi-ref\" media feature tag in the Contact header field of SIP requests (not SIP MESSAGE) and responses, and the Accept-Contact header fields of non-register SIP requests.\nThis URN can be included by the device in the P-Preferred-Service header field of SIP requests, and is asserted by the network into the P-Asserted-Service header field of SIP Requests.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "D.1\tXML schema for transporting MCData identities and general services information",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "D.1.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause defines XML schema and MIME type for transporting MCData identities and general services information.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.1.2\tXML schema",
                    "description": "",
                    "summary": "",
                    "text_content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\ntargetNamespace=\"urn:3gpp:ns:mcdataInfo:1.0\"\nxmlns:mcdatainfo=\"urn:3gpp:ns:mcdataInfo:1.0\"\nelementFormDefault=\"qualified\"\nattributeFormDefault=\"unqualified\"\nxmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\">\n\n<xs:import namespace=\"http://www.w3.org/2001/04/xmlenc#\" schemaLocation=\"http://www.w3.org/TR/xmlenc-core/xenc-schema.xsd\"/>\n\n<!-- root XML element -->\n<xs:element name=\"mcdatainfo\" type=\"mcdatainfo:mcdatainfo-Type\" id=\"info\"/>\n\n<xs:complexType name=\"mcdatainfo-Type\">\n<xs:sequence>\n<xs:element name=\"mcdata-Params\" type=\"mcdatainfo:mcdata-ParamsType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatainfo:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"mcdata-ParamsType\">\n<xs:sequence>\n<xs:element name=\"mcdata-access-token\" type=\"mcdatainfo:contentType\" minOccurs=\"0\"/>\n<xs:element name=\"request-type\" type=\"xs:string\" minOccurs=\"0\"/>\n<xs:element name=\"mcdata-request-uri\" type=\"mcdatainfo:contentType\" minOccurs=\"0\"/>\n<xs:element name=\"mcdata-calling-user-id\" type=\"mcdatainfo:contentType\" minOccurs=\"0\"/>\n<xs:element name=\"mcdata-called-party-id\" type=\"mcdatainfo:contentType\" minOccurs=\"0\"/>\n<xs:element name=\"mcdata-calling-group-id\" type=\"mcdatainfo:contentType\" minOccurs=\"0\"/>\n<xs:element name=\"alert-ind\" type=\"mcdatainfo:contentType\" minOccurs=\"0\"/>\n<xs:element name=\"originated-by\" type=\"mcdatainfo:contentType\" minOccurs=\"0\"/>\n<xs:element name=\"mcdata-client-id\" type=\"mcdatainfo:contentType\" minOccurs=\"0\"/>\n<xs:element name=\"mcdata-controller-psi\" type=\"mcdatainfo:contentType\" minOccurs=\"0\"/>\n<xs:element name=\"partner-mcdata-id\" type=\"mcdatainfo:contentType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatainfo:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<!--    anyExt elements for MCData-Params-->\n<xs:element name=\"emergency-alert-area-ind\" type=\"xs:boolean\"/>\n<xs:element name=\"group-geo-area-ind\" type=\"xs:boolean\"/>\n<xs:element name=\"pre-established-session-ind\" type=\"xs:boolean\"/>\n<xs:element name=\"call-to-functional-alias-ind\" type=\"xs:boolean\"/>\n\n<xs:element name=\"mcdata-communication-state\" type=\"mcdatainfo:mcdataCommunicationStateType\"/>\n<xs:simpleType name=\"mcdataCommunicationStateType\">\n<xs:restriction base=\"xs:string\">\n<xs:enumeration value=\"establish-request\"/>\n<xs:enumeration value=\"establish-success\"/>\n<xs:enumeration value=\"establish-fail\"/>\n<xs:enumeration value=\"terminate-request\"/>\n<xs:enumeration value=\"terminated\"/>\n</xs:restriction>\n</xs:simpleType>\n\n<xs:element name=\"emergency-ind\" type=\"xs:boolean\"/>\n<xs:element name=\"alert-ind-rcvd\" type=\"xs:boolean\"/>\n<xs:element name=\"mc-org\" type=\"xs:string\"/>\n<xs:element name=\"functional-alias-URI\" type=\"mcdatainfo:contentType\"/>\n<xs:element name=\"user-requested-priority\" type=\"xs:nonNegativeInteger\"/>\n<xs:element name=\"multiple-devices-ind\" type=\"mcdatainfo:contentType\"/>\n<xs:element name=\"imminentperil-ind\" type=\"xs:boolean\"/>\n<xs:element name=\"emergency-ind-rcvd\" type=\"xs:boolean\"/>\n<xs:element name=\"binding-ind\" type=\"xs:boolean\"/>\n<xs:element name=\"binding-fa-uri\" type=\"xs:anyURI\"/>\n<xs:element name=\"unbinding-fa-uri\" type=\"xs:anyURI\"/>\n<xs:element name=\"called-functional-alias-URI\" type=\"mcdatainfo:contentType\"/>\n<xs:element name=\"associated-group-id\" type=\"xs:string\"/>\n\n<xs:element name=\"store-all-private-comms-in-msgstore\" type=\"xs:boolean\"/>\n<xs:element name=\"store-all-group-comms-in-msgstore\" type=\"xs:boolean\"/>\n<xs:element name=\"store-specific-private-comms-in-msgstore\" type=\"mcdatainfo:storageCtrlType\"/>\n<xs:element name=\"store-specific-group-comms-in-msgstore\" type=\"mcdatainfo:storageCtrlType\"/>\n<xs:element name=\"end-to-end-security\" type=\"xs:boolean\"/>\n<xs:element name=\"comn-participants-criteria\" type=\"xs:string\"/>\n<xs:element name=\"preconfigured-group-id\" type=\"xs:anyURI\"/>\n<xs:element name=\"adhoc-grp-emg-alert-grp-ind\" type=\"xs:boolean\"/>\n\n<xs:simpleType name=\"storageCtrlType\">\n<xs:restriction base=\"xs:string\">\n<xs:enumeration value=\"enable\"/>\n<xs:enumeration value=\"disable\"/>\n</xs:restriction>\n</xs:simpleType>\n\n\n<xs:simpleType name=\"protectionType\">\n<xs:restriction base=\"xs:string\">\n<xs:enumeration value=\"Normal\"/>\n<xs:enumeration value=\"Encrypted\"/>\n</xs:restriction>\n</xs:simpleType>\n\n<xs:complexType name=\"contentType\">\n<xs:choice>\n<xs:element name=\"mcdataURI\" type=\"xs:anyURI\"/>\n<xs:element name=\"mcdataString\" type=\"xs:string\"/>\n<xs:element name=\"mcdataBoolean\" type=\"xs:boolean\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\"/>\n<xs:element name=\"anyExt\" type=\"mcdatainfo:anyExtType\" minOccurs=\"0\"/>\n</xs:choice>\n<xs:attribute name=\"type\" type=\"mcdatainfo:protectionType\"/>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"anyExtType\">\n<xs:sequence>\n<xs:any namespace=\"##any\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n\n</xs:schema>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.1.3\tSemantic",
                    "description": "",
                    "summary": "",
                    "text_content": "The <mcdatainfo> element is the root element of the XML document. The <mcdatainfo> element can contain subelements.\nNOTE 1:\tThe subelements of the <mcdata-info> are validated by the <xs:any namespace=\"##any\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/> particle of the <mcdata-info> element\nIf the <mcdatainfo> contains the <mcdata-Params> element then:\n1)\tthe <mcdata-access-token>, <mcdata-request-uri>, <mcdata-controller-psi>, <mcdata-calling-user-id>, <mcdata-called-party-id>, <mcdata-calling-group-id>, <alert-ind>, <originated-by>, <mcdata-client-id>, <functional-alias-URI> , <called-functional-alias-URI>, and <partner-mcdata-id> elements can be included with encrypted content;\n2)\tfor each element in 1) that is included with content that is not encrypted:\na)\tthe element has the \"type\" attribute set to \"Normal\";\nb)\tif the element is the <mcdata-request-uri>, <mcdata-calling-user-id>, <mcdata-called-party-id>, <mcdata-calling-group-id>, <originated-by> <functional-alias-URI>, <called-functional-alias-URI> element, or <partner-mcdata-id>, then the <mcdataURI> element is included;\nc)\tif the element is the <mcdata-access-token> or <mcdata-client-id>, then the <mcdataString> element is included; and\nd)\tif the element is <alert-ind>, then the <mcdataBoolean> element is included; and\n3)\tfor each element in 1) that is included with content that is encrypted:\na)\tthe element has the \"type\" attribute set to \"Encrypted\";\nb)\tthe <xenc:EncryptedData> element from the \"\" namespace is included and:\ni)\tcan have a \"Type\" attribute can be included with a value of \"\";\nii)\tcan include an <EncryptionMethod> element with the \"Algorithm\" attribute set to value of \"http://www.w3.org/2009/xmlenc11#aes128-gcm\";\niii)\tcan include a <KeyInfo> element with a <KeyName> element containing the base 64 encoded XPK-ID; and\niv)\tincludes a <CipherData> element with a <CipherValue> element containing the encrypted data.\nNOTE 2:\tWhen the optional attributes and elements are not included within the <xenc:EncryptedData> element, the information they contain is known to sender and the receiver by other means.\nIf the <mcdatainfo> contains the <mcdata-Params> element then:\n1)\tthe <mcdata-access-token> can be included with the access token received during authentication procedure as described in 3GPP TS 24.482 [24];\n2)\tthe <request-type> can be included with:\na)\ta value of \"one-to-one-sds\" to indicate that the MCData client wants to initiate a one-to-one SDS request;\nb)\ta value of \"group-sds\" to indicate the MCData client wants to initiate a group SDS request;\nc)\ta value of \"one-to-one-fd\" to indicate that the MCData client wants to initiate a one-to-one FD request;\nd)\ta value of \"group-fd\" to indicate that the MCData client wants to initiate a group FD request;\ne)\ta value of \"msf-disc-req\" to indicate that the MCData client wishes to discover the absoluteURI of the media storage function for HTTP requests;\nf)\ta value of \"msf-disc-res\" when the participating MCData function sends the absolute URI to the MCData client;\ng)\ta value of \"notify\" when the controlling MCData function needs to send a notification to the MCData client;\nh)\ta value of \"one-to-one-sds-session\" to indicate that the MCData client wants to initiate a one-to-one SDS session;\ni)\ta value of \"group-sds-session\" to indicate the MCData client wants to initiate a group SDS session;\nj)\ta value of \"functional-alias-status-determination\" when a client initiates a subscription request to FA status;\nk)\t\"fa-group-binding-req\" when a client initiates a request for binding of a functional alias with the MCData group(s) for the MCData user;\nl)\ta value of \"store-comms-in-msgstore-ctrl-req\" when an MCData client initiates a request to control the storage of MCData communications (private and group) into MCData message store;\nm)\ta value of \"adhoc-group-sds-session\" to indicate that the MCData client wants to make an adhoc group data communication for SDS; or\nn)\ta value of \"adhoc-group-fd-session\" to indicate that the MCData client wants to make an adhoc group data communication for FD;\n3)\tthe <mcdata-request-uri> can be included with:\na)\ta value set to an MCData group ID when the <request-type> is set to a value of \"group-sds\" or \"group-fd\";\nb)\ta value set to the MCData ID of the called MCData user when the <request-type> is set to a value of \"one-to-one-sds\" or \"one-to-one-fd\"; and\nc)\ta value set to the MCData ID of the called MCData user or MCData group ID of adhoc group when the <request-type> is set to a value of \"adhoc-group-sds-session\" or \"adhoc-group-fd-session\";\n4)\tthe <mcdata-calling-user-id> can be included, set to MCData ID of the originating user;\n5)\tthe <mcdata-called-party-id> can be included, set to the MCData ID of the terminating user;\n6)\tthe <mcdata-calling-group-id> can be included to indicate the MCData group identity or MCData adhoc group identity to the terminating user;\n7)\tthe <alert-ind> can be:\na)\tset to \"true\" to indicate that an alert is to be sent; or\nb)\tset to \"false\" to indicate that an alert is to be cancelled;\n8)\tthe <originated-by> can be included, set to the MCData ID of the originating user of an MCData emergency alert when being cancelled by another authorised MCData user;\n9)\tthe <mcdata-client-id> can be included, set to the MCData client ID of the MCData client that originated a SIP INVITE request, SIP REFER request, SIP REGISTER request, SIP PUBLISH request or SIP MESSAGE request;\n10)\tthe <mcdata-controller-psi> can be included, set to the PSI of the controlling MCData function that handled the one-to-one or group MCData data request;\n10a)\tthe <partner-mcdata-id> can be included and set to the MCData ID of a migrating user in the partner MCData system; and\n11)\tthe <anyExt> can be included with the following elements:\na)\ta <pre-established-session-ind> element :\ni)\tset to the value \"true\" by the MCData client in a pre-established session setup request to indicate to the MCData participating function about initiation of a pre-established session;\nb)\tan <mcdata-communication-state> element can be included to indicate the state of MCData communication within a pre-established session. The <mcdata-communication-state> can be set to:\ni)\tthe value \"establish-request\" by the MCData participating function to indicate to the MCData client about an MCData communication establishment request within a pre-established session;\nii)\tthe value \"establish-success\" by the MCData participating function or the MCData client to indicate that the MCData communication is established successfully;\niii)\tthe value \"establish-fail\" by the MCData participating function or the MCData client to indicate that the MCData communication establishment is failed or rejected;\niv)\tthe value \"terminate-request\" by the MCData participating function to indicate to the MCData client about an MCData communication termination request within a pre-established session; or\nv)\tthe value \"terminated\" by the MCData participating function or the MCData client to indicate that the MCData communication is terminated;\nc)\tan <emergency-ind> element can be included and set to:\ni)\t\"true\" to indicate that the communication that the MCData client is initiating is an emergency MCData communication; or\nii)\t\"false\" to indicate that the MCData client is cancelling an emergency MCData communication (i.e. converting it back to a non-emergency communication);\nd)\tan <alert-ind-rcvd> element:\ni)\tmay be set to \"true\" and included in a SIP MESSAGE to indicate that the emergency alert or cancellation was received successfully;\ne)\tan <mc-org> element may be:\ni)\tset to the MCData user's Mission Critical Organization and included in an emergency alert sent by the MCData server to terminating MCData clients;\nf)\ta <functional-alias-URI> element set to the value of the functional alias that is used together with the \"mcdata-calling-user-id\";\ng)\tan <emergency-alert-area-ind> element:\ni)\tset to the value \"true\" when the MCData client has entered an emergency alert area; or\nii)\tset to the value \"false\" when the MCData client has exited an emergency alert area;\nh)\ta <group-geo-area-ind> element:\ni)\tset to the value \"true\" when the MCData client has entered a group geographic area; or\nii)\tset to the value \"false\" when the MCData client has exited a group geographic area;\ni)\tan <imminentperil-ind> element can be included if the <mcdata-request-uri> is also included and set to an MCData group ID, in which case the <imminentperil-ind> element is to be set to:\ni)\t\"true\" to indicate that the communication that the MCData client is initiating is an imminent peril MCData communication; or\nii)\t\"false\" to indicate that the MCData client requests that the communication should no longer be considered an imminent peril MCData communication;\nj)\tan <emergency-ind-rcvd> element:\ni)\tcan be set to \"true\" and included in a SIP MESSAGE to indicate that the in-progress emergency cancellation request was received successfully;\nk)\ta <multiple-devices-ind> element can be included and set to:\ni)\t\"true\" to indicate to the client that multiple clients are registered for the MCData user; or\nii)\t\"false\" to indicate to the client that no other clients are registered for the MCData user;\nl)\ta <binding-ind> element set to:\ni)\t\"true\" when the user wants to create a binding of a particular functional alias with the specified list of MCData groups for the MCData client; or\nii)\t\"false\" when the user wants to remove a binding of a particular functional alias from the specified list of MCData groups for the MCData client;\nm)\ta <binding-fa-uri> element set to:\ni)\ta URI of a functional alias that shall be bound with the specified list of MCData groups for the MCData client;\nn)\ta <unbinding-fa-uri> element set to:\ni)\ta URI of a functional alias that shall be unbound from the specified list of MCData groups for the MCData client;\no)\ta <store-all-private-comms-in-msgstore> element can be included and set to:\ni)\t\"true\" when the user wants to store his/her MCData private communications into his/her MCData message store account; or\nii)\t\"false\" when the user do not store his/her MCData private communications into his/her MCData message store account;\np)\ta <store-all-group-comms-in-msgstore> element can be included and set to:\ni)\t\"true\" when the user wants to store his/her MCData group communications into his/her MCData message store account; or\nii)\t\"false\" when the user do not store his/her MCData group communications into his/her MCData message store account;\nq)\ta <store-specific-private-comms-in-msgstore> element can be included and set to:\ni)\tset to a value of \"enable\" when the user wants to store the specified MCData private communications for which user is authorized to store the communication into the MCData message store; or\nii)\tset to a value of \"disable\" when the user do not wants to store the specified MCData private communications for which user is authorized to store the communication into the MCData message store;\nr)\ta <store-specific-group-comms-in-msgstore> element can be included and set to:\ni)\t\"enable\" when the user wants to store the specified MCData group communications for which user is authorized to store the communication into the MCData message store; or\nii)\t\"disable\" when the user do not wants to store the specified MCData group communications for which user is authorized to store the communication into the MCData message store;\ns)\tan <call-to-functional-alias-ind> element can be included and set to:\ni)\t\"true\" when the MCData client is using a functional alias to identify the MCData IDs of the potential target MCData users; or\nii)\t\"false\" when the MCData client is using MCData IDs to identify the potential target MCData users;\nt)\ta <called-functional-alias-URI> element set to the value of the functional alias to be called;\nu)\ta <user-requested-priority> element set to the non-negative integer value requested by the user as priority;\nv)\tan <associated-group-id> element set to the identity of a constituent MCData group when the MCData communication targets a temporary group or a group regroup based on a preconfigured group;\nw)\ta<end-to-end-security> element set to:\ni)\t\"true\" to indicate that end to end security is requested by the initiating user, which instructs the controlling function to determine the preconfigured group from which security related informations are used for securing the adhoc group data communication; or\nii)\t\"false\" to indicate that end to end security is not requested by the initiating user, which instructs the controlling function not to determine the preconfigured group from which security related informations are used for secure adhoc group data communication;\nx)\ta <comn-participants-criteria> element set to the criteria for determining the list of MCData users to be called in adhoc group call. The comma (,) is used as a delimiter between criteria;\ny)\ta <preconfigured-group-id> element set to the preconfigured group identity of the preconfigured group from which security related materials can be used by the adhoc group data communication participants to communicate securely in the adhoc group session; and\nz)\ta <adhoc-grp-emg-alert-grp-ind> element set to:\ni)\t\"true\" to indicate that the identity of adhoc group used in the adhoc group data communication setup request is learned during an adhoc group emergency alert procedures.\nAbsence of the <emergency-ind>, <alert-ind> and <imminentperil-ind> in a SIP INVITE request indicates that the MCData client is initiating a non-emergency communication.\nAbsence of the <call-to-functional-alias-ind> in a SIP INVITE or a SIP REFER request indicates the use of the MCData IDs of the potential target MCData users.\nThe recipient of the XML ignores any unknown element and any unknown attribute.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.1.4\tIANA registration template",
                    "description": "",
                    "summary": "",
                    "text_content": "Your Name:\n<MCC name>\nYour Email Address:\n<MCC email address>\nMedia Type Name:\nApplication\nSubtype name:\nvnd.3gpp.mcdata-info+xml\nRequired parameters:\nNone\nOptional parameters:\n\"charset\"\tthe parameter has identical semantics to the charset parameter of the \"application/xml\" media type as specified in section 9.1 of IETF RFC 7303.\nEncoding considerations:\nbinary.\nSecurity considerations:\nSame as general security considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. In addition, this media type provides a format for exchanging information in SIP, so the security considerations from IETF RFC 3261 apply.\nThe information transported in this media type does not include active or executable content.\nMechanisms for privacy and integrity protection of protocol parameters exist. Those mechanisms as well as authentication and further security mechanisms are described in 3GPP TS 24.229.\nThis media type does not include provisions for directives that institute actions on a recipient's files or other resources.\nThis media type does not include provisions for directives that institute actions that, while not directly harmful to the recipient, may result in disclosure of information that either facilitates a subsequent attack or else violates a recipient's privacy in any way.\nThis media type does not employ compression.\nInteroperability considerations:\nSame as general interoperability considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. Any unknown XML elements and any unknown XML attributes are to be ignored by recipient of the MIME body.\nPublished specification:\n3GPP TS 24.282 \"Mission Critical Data (MCData) signalling control;Protocol specification\", available via http://www.3gpp.org/specs/numbering.htm.\nApplications Usage:\nApplications supporting the mission critical data communications procedures as described in the published specification.\nFragment identifier considerations:\nThe handling in section 5 of IETF RFC 7303 applies.\nRestrictions on usage:\nNone\nProvisional registration? (standards tree only):\nN/A\nAdditional information:\n1.\tDeprecated alias names for this type: none\n2.\tMagic number(s): none\n3.\tFile extension(s): none\n4.\tMacintosh File Type Code(s): none\n5.\tObject Identifier(s) or OID(s): none\nIntended usage:\nCommon\nPerson to contact for further information:\n-\tName: <MCC name>\n-\tEmail: <MCC email address>\n-\tAuthor/Change controller:\ni)\tAuthor: 3GPP CT1 Working Group/3GPP_TSG_CT_WG1@LIST.ETSI.ORG\nii)\tChange controller: <MCC name>/<MCC email address>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "D.2\tVoid",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "D.3\tXML schema for MCData (de)-affiliation requests",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "D.3.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause defines XML schema and MIME type for MCData (de)-affiliation requests.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.3.2\tXML schema",
                    "description": "",
                    "summary": "",
                    "text_content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\ntargetNamespace=\"urn:3gpp:ns:affiliationCommand:1.0\"\nxmlns:mcdataaff=\"urn:3gpp:ns:affiliationCommand:1.0\"\nattributeFormDefault=\"unqualified\" elementFormDefault=\"qualified\">\n<xs:complexType name=\"affiliate-command\" id=\"affil\">\n<xs:sequence>\n<xs:element type=\"xs:anyURI\" name=\"group\" minOccurs=\"1\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataaff:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"de-affiliate-command\">\n<xs:sequence>\n<xs:element type=\"xs:anyURI\" name=\"group\" minOccurs=\"1\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataaff:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:element name=\"command-list\">\n<xs:complexType>\n<xs:sequence>\n<xs:element name=\"affiliate\" type=\"mcdataaff:affiliate-command\" minOccurs=\"0\" maxOccurs=\"1\"/>\n<xs:element name=\"de-affiliate\" type=\"mcdataaff:de-affiliate-command\" minOccurs=\"0\" maxOccurs=\"1\"/>\n<xs:element name=\"anyExt\" type=\"mcdataaff:anyExtType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n</xs:element>\n<xs:complexType name=\"anyExtType\">\n<xs:sequence>\n<xs:any namespace=\"##any\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n</xs:schema>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.3.3\tSemantic",
                    "description": "",
                    "summary": "",
                    "text_content": "The <command-list> element is the root element of the XML document. The <command-list> element may contain <affiliate-command>, or <de-affiliate-command> subelements or both.\nIf the <command-list> contains the <affiliate-command> element then:\n1)\tthe <affiliate-command> element contains a list of <group> subelements having at least one subelement. The recipient shall perform an affiliation for all the MCData groups contained in the list for the clients for which the <command-list> applies.\nIf the <command-list> contains the <de-affiliate-command> element then:\n1)\tthe <de-affiliate-command> element contains a list of <group> subelements having at least one subelement. The recipient shall perform a de-affiliation for all the MCData groups contained in the list for the clients for which the <command-list> applies.\nThe recipient of the XML ignores any unknown element and any unknown attribute.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.3.4\tIANA registration template",
                    "description": "",
                    "summary": "",
                    "text_content": "Your Name:\n<MCC name>\nYour Email Address:\n<MCC email address>\nMedia Type Name:\nApplication\nSubtype name:\nvnd.3gpp.mcdata-affiliation-command+xml\nRequired parameters:\nNone\nOptional parameters:\n\"charset\"\tthe parameter has identical semantics to the charset parameter of the \"application/xml\" media type as specified in section 9.1 of IETF RFC 7303.\nEncoding considerations:\nbinary.\nSecurity considerations:\nSame as general security considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. In addition, this media type provides a format for exchanging information in SIP, so the security considerations from IETF RFC 3261 apply.\nThe information transported in this media type does not include active or executable content.\nMechanisms for privacy and integrity protection of protocol parameters exist. Those mechanisms as well as authentication and further security mechanisms are described in 3GPP TS 24.229.\nThis media type does not include provisions for directives that institute actions on a recipient's files or other resources.\nThis media type does not include provisions for directives that institute actions that, while not directly harmful to the recipient, may result in disclosure of information that either facilitates a subsequent attack or else violates a recipient's privacy in any way.\nThis media type does not employ compression.\nInteroperability considerations:\nSame as general interoperability considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. Any unknown XML elements and any unknown XML attributes are to be ignored by recipient of the MIME body.\nPublished specification:\n3GPP TS 24.282 \"Mission Critical Data (MCData) signalling control\" version 14.0.0, available via http://www.3gpp.org/specs/numbering.htm.\nApplications which use this media type:\nApplications supporting the mission critical data functions as described in the published specification.\nFragment identifier considerations:\nThe handling in section 5 of IETF RFC 7303 applies.\nRestrictions on usage:\nNone\nProvisional registration? (standards tree only):\nN/A\nAdditional information:\n1.\tDeprecated alias names for this type: none\n2.\tMagic number(s): none\n3.\tFile extension(s): none\n4.\tMacintosh File Type Code(s): none\n5.\tObject Identifier(s) or OID(s): none\nIntended usage:\nCommon\nPerson to contact for further information:\n-\tName: <MCC name>\n-\tEmail: <MCC email address>\n-\tAuthor/Change controller:\ni)\tAuthor: 3GPP CT1 Working Group/3GPP_TSG_CT_WG1@LIST.ETSI.ORG\nii)\tChange controller: <MCC name>/<MCC email address>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "D.4\tXML schema for MCData location information",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "D.4.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause defines the XML schema and the MIME type for location information.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.4.2\tXML schema",
                    "description": "",
                    "summary": "",
                    "text_content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:mcdataloc=\"urn:3gpp:ns:mcdataLocationInfo:1.0\" targetNamespace=\"urn:3gpp:ns:mcdataLocationInfo:1.0\" elementFormDefault=\"qualified\" attributeFormDefault=\"unqualified\"\nxmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\">\n\n<xs:import namespace=\"http://www.w3.org/2001/04/xmlenc#\"/>\n\n<xs:element name=\"location-info\" id=\"loc\">\n<xs:annotation>\n<xs:documentation>Root element, contains all information related to location configuration, location request and location reporting for the MCData service</xs:documentation>\n</xs:annotation>\n<xs:complexType>\n<xs:choice>\n<xs:element name=\"Configuration\" type=\"mcdataloc:tConfigurationType\"/>\n<xs:element name=\"Request\" type=\"mcdataloc:tRequestType\"/>\n<xs:element name=\"Report\" type=\"mcdataloc:tReportType\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:choice>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n</xs:element>\n<xs:complexType name=\"tConfigurationType\">\n<xs:sequence>\n<xs:element name=\"NonEmergencyLocationInformation\" type=\"mcdataloc:tRequestedLocationType\" minOccurs=\"0\"/>\n<xs:element name=\"EmergencyLocationInformation\" type=\"mcdataloc:tRequestedLocationType\" minOccurs=\"0\"/>\n<xs:element name=\"TriggeringCriteria\" type=\"mcdataloc:TriggeringCriteriaType\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:attribute name=\"ConfigScope\">\n<xs:simpleType>\n<xs:restriction base=\"xs:string\">\n<xs:enumeration value=\"Full\"/>\n<xs:enumeration value=\"Update\"/>\n</xs:restriction>\n</xs:simpleType>\n</xs:attribute>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"tRequestType\">\n<xs:complexContent>\n<xs:extension base=\"mcdataloc:tEmptyType\">\n<xs:attribute name=\"RequestId\" type=\"xs:string\" use=\"required\"/>\n</xs:extension>\n</xs:complexContent>\n</xs:complexType>\n<xs:complexType name=\"tReportType\">\n<xs:sequence>\n<xs:element name=\"TriggerId\" type=\"xs:string\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"CurrentLocation\" type=\"mcdataloc:tCurrentLocationType\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:attribute name=\"ReportID\" type=\"xs:string\" use=\"optional\"/>\n<xs:attribute name=\"ReportType\" use=\"required\">\n<xs:simpleType>\n<xs:restriction base=\"xs:string\">\n<xs:enumeration value=\"Emergency\"/>\n<xs:enumeration value=\"NonEmergency\"/>\n</xs:restriction>\n</xs:simpleType>\n</xs:attribute>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"TriggeringCriteriaType\">\n<xs:sequence>\n<xs:element name=\"CellChange\" type=\"mcdataloc:tCellChange\" minOccurs=\"0\"/>\n<xs:element name=\"TrackingAreaChange\" type=\"mcdataloc:tTrackingAreaChangeType\" minOccurs=\"0\"/>\n<xs:element name=\"PlmnChange\" type=\"mcdataloc:tPlmnChangeType\" minOccurs=\"0\"/>\n<xs:element name=\"MbmsSaChange\" type=\"mcdataloc:tMbmsSaChangeType\" minOccurs=\"0\"/>\n<xs:element name=\"MbsfnAreaChange\" type=\"mcdataloc:tMbsfnAreaChangeType\" minOccurs=\"0\"/>\n<xs:element name=\"PeriodicReport\" type=\"mcdataloc:tIntegerAttributeType\" minOccurs=\"0\"/>\n<xs:element name=\"TravelledDistance\" type=\"mcdataloc:tIntegerAttributeType\" minOccurs=\"0\"/>\n<xs:element name=\"McdataSignallingEvent\" type=\"mcdataloc:tSignallingEventType\" minOccurs=\"0\"/>\n<xs:element name=\"GeographicalAreaChange\" type=\"mcdataloc:tGeographicalAreaChange\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<!-- anyExt elements for \"TriggeringCriteriaType\" -->\n<xs:element name=\"RatTypeChange\" type=\"mcdataloc:tRatTypeChange\"/>\n\n\n<xs:complexType name=\"tCellChange\">\n<xs:sequence>\n<xs:element name=\"AnyCellChange\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:element name=\"EnterSpecificCell\" type=\"mcdataloc:tSpecificCellType\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"ExitSpecificCell\" type=\"mcdataloc:tSpecificCellType\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"tEmptyType\"/>\n<xs:simpleType name=\"tEcgi\">\n<xs:restriction base=\"xs:string\">\n<xs:pattern value=\"\\d{3}\\d{3}[0-1]{28}\"/>\n</xs:restriction>\n</xs:simpleType>\n<xs:complexType name=\"tSpecificCellType\">\n<xs:simpleContent>\n<xs:extension base=\"mcdataloc:tEcgi\">\n<xs:attribute name=\"TriggerId\" type=\"xs:string\" use=\"required\"/>\n</xs:extension>\n</xs:simpleContent>\n</xs:complexType>\n<xs:complexType name=\"tEmptyTypeAttribute\">\n<xs:complexContent>\n<xs:extension base=\"mcdataloc:tEmptyType\">\n<xs:attribute name=\"TriggerId\" type=\"xs:string\" use=\"required\"/>\n</xs:extension>\n</xs:complexContent>\n</xs:complexType>\n<xs:complexType name=\"tTrackingAreaChangeType\">\n<xs:sequence>\n<xs:element name=\"AnyTrackingAreaChange\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:element name=\"EnterSpecificTrackingArea\" type=\"mcdataloc:tTrackingAreaIdentity\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"ExitSpecificTrackingArea\" type=\"mcdataloc:tTrackingAreaIdentity\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:simpleType name=\"tTrackingAreaIdentityFormat\">\n<xs:restriction base=\"xs:string\">\n<xs:pattern value=\"\\d{3}\\d{3}[0-1]{16}\"/>\n</xs:restriction>\n</xs:simpleType>\n<xs:complexType name=\"tTrackingAreaIdentity\">\n<xs:simpleContent>\n<xs:extension base=\"mcdataloc:tTrackingAreaIdentityFormat\">\n<xs:attribute name=\"TriggerId\" type=\"xs:string\" use=\"required\"/>\n</xs:extension>\n</xs:simpleContent>\n</xs:complexType>\n<xs:complexType name=\"tPlmnChangeType\">\n<xs:sequence>\n<xs:element name=\"AnyPlmnChange\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:element name=\"EnterSpecificPlmn\" type=\"mcdataloc:tPlmnIdentity\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"ExitSpecificPlmn\" type=\"mcdataloc:tPlmnIdentity\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:simpleType name=\"tPlmnIdentityFormat\">\n<xs:restriction base=\"xs:string\">\n<xs:pattern value=\"\\d{3}\\d{3}\"/>\n</xs:restriction>\n</xs:simpleType>\n<xs:complexType name=\"tPlmnIdentity\">\n<xs:simpleContent>\n<xs:extension base=\"mcdataloc:tPlmnIdentityFormat\">\n<xs:attribute name=\"TriggerId\" type=\"xs:string\" use=\"required\"/>\n</xs:extension>\n</xs:simpleContent>\n</xs:complexType>\n<xs:complexType name=\"tMbmsSaChangeType\">\n<xs:sequence>\n<xs:element name=\"AnyMbmsSaChange\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:element name=\"EnterSpecificMbmsSa\" type=\"mcdataloc:tMbmsSaIdentity\" minOccurs=\"0\"/>\n<xs:element name=\"ExitSpecificMbmsSa\" type=\"mcdataloc:tMbmsSaIdentity\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:simpleType name=\"tMbmsSaIdentityFormat\">\n<xs:restriction base=\"xs:integer\">\n<xs:minInclusive value=\"0\"/>\n<xs:maxInclusive value=\"65535\"/>\n</xs:restriction>\n</xs:simpleType>\n<xs:complexType name=\"tMbmsSaIdentity\">\n<xs:simpleContent>\n<xs:extension base=\"mcdataloc:tMbmsSaIdentityFormat\">\n<xs:attribute name=\"TriggerId\" type=\"xs:string\" use=\"required\"/>\n</xs:extension>\n</xs:simpleContent>\n</xs:complexType>\n<xs:complexType name=\"tMbsfnAreaChangeType\">\n<xs:sequence>\n<xs:element name=\"EnterSpecificMbsfnArea\" type=\"mcdataloc:tMbsfnAreaIdentity\" minOccurs=\"0\"/>\n<xs:element name=\"ExitSpecificMbsfnArea\" type=\"mcdataloc:tMbsfnAreaIdentity\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:simpleType name=\"tMbsfnAreaIdentityFormat\">\n<xs:restriction base=\"xs:integer\">\n<xs:minInclusive value=\"0\"/>\n<xs:maxInclusive value=\"255\"/>\n</xs:restriction>\n</xs:simpleType>\n<xs:complexType name=\"tMbsfnAreaIdentity\">\n<xs:simpleContent>\n<xs:extension base=\"mcdataloc:tMbsfnAreaIdentityFormat\">\n<xs:attribute name=\"TriggerId\" type=\"xs:string\" use=\"required\"/>\n</xs:extension>\n</xs:simpleContent>\n</xs:complexType>\n<xs:complexType name=\"tIntegerAttributeType\">\n<xs:simpleContent>\n<xs:extension base=\"xs:integer\">\n<xs:attribute name=\"TriggerId\" type=\"xs:string\" use=\"required\"/>\n</xs:extension>\n</xs:simpleContent>\n</xs:complexType>\n<xs:complexType name=\"tTravelledDistanceType\">\n<xs:sequence>\n<xs:element name=\"TravelledDistance\" type=\"xs:positiveInteger\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"tSignallingEventType\">\n<xs:sequence>\n<xs:element name=\"InitialLogOn\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:element name=\"GroupCallNonEmergency\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:element name=\"PrivateCallNonEmergency\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:element name=\"LocationConfigurationReceived\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"tEmergencyEventType\">\n<xs:sequence>\n<xs:element name=\"GroupCallEmergency\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:element name=\"GroupCallImminentPeril\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:element name=\"PrivateCallEmergency\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:element name=\"InitiateEmergencyAlert\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"tRequestedLocationType\">\n<xs:sequence>\n<xs:element name=\"ServingEcgi\" type=\"mcdataloc:tEmptyType\" minOccurs=\"0\"/>\n<xs:element name=\"NeighbouringEcgi\" type=\"mcdataloc:tEmptyType\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"MbmsSaId\" type=\"mcdataloc:tEmptyType\" minOccurs=\"0\"/>\n<xs:element name=\"MbsfnArea\" type=\"mcdataloc:tEmptyType\" minOccurs=\"0\"/>\n<xs:element name=\"GeographicalCoordinate\" type=\"mcdataloc:tEmptyType\" minOccurs=\"0\"/>\n<xs:element name=\"minimumIntervalLength\" type=\"xs:positiveInteger\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"tCurrentLocationType\">\n<xs:sequence>\n<xs:element name=\"CurrentServingEcgi\" type=\"mcdataloc:tLocationType\" minOccurs=\"0\"/>\n<xs:element name=\"NeighbouringEcgi\" type=\"mcdataloc:tLocationType\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"MbmsSaId\" type=\"mcdataloc:tLocationType\" minOccurs=\"0\"/>\n<xs:element name=\"MbsfnArea\" type=\"mcdataloc:tLocationType\" minOccurs=\"0\"/>\n<xs:element name=\"CurrentCoordinate\" type=\"mcdataloc:tPointCoordinate\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<!-- anyExt elements for \"tCurrentLocationType\" -->\n<xs:element name=\"locTimestamp\" type=\"xs:dateTime\"/>\n<xs:element name=\"InterRatType\" type=\"mcdataloc:tInterRatType\"/>\n\n<xs:simpleType name=\"tInterRatType\">\n<xs:restriction base=\"xs:string\">\n<xs:enumeration value=\"5G-MBS-to-LTE-MBMS\"/>\n<xs:enumeration value=\"5G-MBS-to-LTE-unicast\"/>\n<xs:enumeration value=\"LTE-MBMS-to-5G-MBS\"/>\n<xs:enumeration value=\"LTE-MBMS-to-5G-unicast\"/>\t</xs:restriction>\n</xs:simpleType>\n\n<xs:simpleType name=\"protectionType\">\n<xs:restriction base=\"xs:string\">\n<xs:enumeration value=\"Normal\"/>\n<xs:enumeration value=\"Encrypted\"/>\n</xs:restriction>\n</xs:simpleType>\n\n<xs:complexType name=\"tLocationType\">\n<xs:choice minOccurs=\"1\" maxOccurs=\"1\">\n<xs:element name=\"Ecgi\" type=\"mcdataloc:tEcgi\" minOccurs=\"0\"/>\n<xs:element name=\"SaId\" type=\"mcdataloc:tMbmsSaIdentity\" minOccurs=\"0\"/>\n<xs:element name=\"MbsfnAreaId\" type=\"mcdataloc:tMbsfnAreaIdentity\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:choice>\n<xs:attribute name=\"type\" type=\"mcdataloc:protectionType\"/>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"tGeographicalAreaChange\">\n<xs:sequence>\n<xs:element name=\"AnyAreaChange\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:element name=\"EnterSpecificAreaType\" type=\"mcdataloc:tSpecificAreaType\" minOccurs=\"0\"/>\n<xs:element name=\"ExitSpecificAreaType\" type=\"mcdataloc:tSpecificAreaType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"tSpecificAreaType\">\n<xs:sequence>\n<xs:element name=\"GeographicalArea\" type=\"mcdataloc:tGeographicalAreaDef\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:attribute name=\"TriggerId\" type=\"xs:string\" use=\"required\"/>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"tRatTypeChange\">\n<xs:sequence>\n<xs:element name=\"AnyRatTypeChange\" type=\"mcdataloc:tEmptyTypeAttribute\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"tPointCoordinate\">\n<xs:sequence>\n<xs:element name=\"longitude\" type=\"mcdataloc:tCoordinateType\"/>\n<xs:element name=\"latitude\" type=\"mcdataloc:tCoordinateType\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<!-- anyExt elements for \"tPointCoordinate\" -->\n<xs:element name=\"altitude\" type=\"mcdataloc:tCoordinateType2Bytes\"/>\n<xs:element name=\"horizontalaccuracy\" type=\"mcdataloc:tCoordinateType1Byte\"/>\n<xs:element name=\"verticalaccuracy\" type=\"mcdataloc:tCoordinateType1Byte\"/>\n\n<xs:complexType name=\"tCoordinateType\">\n<xs:choice minOccurs=\"1\" maxOccurs=\"1\">\n<xs:element name=\"threebytes\" type=\"mcdataloc:tThreeByteType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:choice>\n<xs:attribute name=\"type\" type=\"mcdataloc:protectionType\"/>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"tCoordinateType2Bytes\">\n<xs:choice minOccurs=\"1\" maxOccurs=\"1\">\n<xs:element name=\"twobytes\" type=\"mcdataloc:tTwoByteType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:choice>\n<xs:attribute name=\"type\" type=\"mcdataloc:protectionType\"/>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"tCoordinateType1Byte\">\n<xs:choice minOccurs=\"1\" maxOccurs=\"1\">\n<xs:element name=\"onebyteunsignedhalfrange\" type=\"mcdataloc:tOneByteUnsignedHalfRangeType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:choice>\n<xs:attribute name=\"type\" type=\"mcdataloc:protectionType\"/>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:simpleType name=\"tThreeByteType\">\n<xs:restriction base=\"xs:integer\">\n<xs:minInclusive value=\"0\"/>\n<xs:maxInclusive value=\"16777215\"/>\n</xs:restriction>\n</xs:simpleType>\n\n<xs:simpleType name=\"tTwoByteType\">\n<xs:restriction base=\"xs:integer\">\n<xs:minInclusive value=\"-32768\"/>\n<xs:maxInclusive value=\"32767\"/>\n</xs:restriction>\n</xs:simpleType>\n\n<xs:simpleType name=\"tOneByteUnsignedHalfRangeType\">\n<xs:restriction base=\"xs:integer\">\n<xs:minInclusive value=\"0\"/>\n<xs:maxInclusive value=\"127\"/>\n</xs:restriction>\n</xs:simpleType>\n\n<xs:complexType name=\"tGeographicalAreaDef\">\n<xs:sequence>\n<xs:element name=\"PolygonArea\" type=\"mcdataloc:tPolygonAreaType\" minOccurs=\"0\"/>\n<xs:element name=\"EllipsoidArcArea\" type=\"mcdataloc:tEllipsoidArcType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"tPolygonAreaType\">\n<xs:sequence>\n<xs:element name=\"Corner\" type=\"mcdataloc:tPointCoordinate\" minOccurs=\"3\" maxOccurs=\"15\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"tEllipsoidArcType\">\n<xs:sequence>\n<xs:element name=\"Center\" type=\"mcdataloc:tPointCoordinate\"/>\n<xs:element name=\"Radius\" type=\"xs:nonNegativeInteger\"/>\n<xs:element name=\"OffsetAngle\" type=\"xs:unsignedByte\"/>\n<xs:element name=\"IncludedAngle\" type=\"xs:unsignedByte\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdataloc:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"anyExtType\">\n<xs:sequence>\n<xs:any namespace=\"##any\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n<!-- anyEXT elements for the Configuration element – begin -->\n<xs:element name=\"EmergencyTriggeringCriteria\" type=\"mcdataloc:TriggeringCriteriaType\"/>\n<!-- anyEXT elements for the Configuration element – end -->\n</xs:schema>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.4.3\tSemantic",
                    "description": "",
                    "summary": "",
                    "text_content": "The <location-info> element is the root element of the XML document. The <location-info> element contains the <Configuration>, <Request> and <Report> subelements, of which only one can be present.\n<Configuration> element has a <ConfigScope> attribute that can assume the values \"Full\" and \"Update\". The value \"Full\" means that the Configuration> element contains the full location configuration which replaces any previous location configuration. The value \"Update\" means that the location configuration is in addition to any previous location configuration. To remove configuration elements a \"Full\" configuration is needed. The <Configuration> element contains the following child elements:\n1)\t<NonEmergencyLocationInformation>, an optional element that specifies the location information requested in non-emergency situations. The <NonEmergencyLocationInformation> has the subelements:\na)\t<ServingEcgi>, an optional element specifying that the serving E-UTRAN Cell Global Identity (ECGI) needs to be reported;\nb)\t<NeighbouringEcgi>, an optional element that can occur multiple times, specifying that neighbouring ECGIs need to be reported;\nc)\t<MbmsSaId>, an optional element specifying that the serving MBMS Service Area Id needs to be reported;\nd)\t<MbsfnArea>, an optional element specifying that the MBSFN area Id needs to be reported;\ne)\t<GeographicalCoordinate>, an optional element specifying that the geographical coordinate specified in clause 6.1 in 3GPP TS 23.032 [47]  needs to be reported; and\nf)\t<minimumIntervalLength>, a mandatory element specifying the minimum time the MCData client needs to wait between sending location reports. The value is given in seconds;\n2)\t<EmergencyLocationInformation>, an optional element that specifies the location information requested in emergency situations. The <EmergencyLocationInformation> has the subelements:\na)\t<ServingEcgi>, an optional element specifying that the serving ECGI needs to be reported;\nb)\t<NeighbouringEcgi>, an optional element that can occur multiple times, specifying that neighbouring ECGIs need to be reported;\nc)\t<MbmsSaId>, an optional element specifying that the serving MBMS Service Area Id needs to be reported;\nd)\t<MbsfnArea>, an optional element specifying that the MBSFN area Id needs to be reported;\ne)\t<GeographicalCoordinate>, an optional element specifying that the geographical coordinate specified in clause 6.1 in 3GPP TS 23.032 [47]  needs to be reported; and\nf)\t<minimumIntervalLength>, a mandatory element specifying the minimum time the MCData client needs to wait between sending location reports. The value is given in seconds;\n3)\t<TriggeringCriteria>, a mandatory element specifying the triggers for the MCData client to perform reporting in non emergency status. The <TriggeringCriteria> element contains the following sub-elements:\na)\t<CellChange>, an optional element specifying what cell changes trigger location reporting. Consists of the following sub-elements:\nI)\t<AnyCellChange>, an optional element. The presence of this element specifies that any cell change is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nII)\t<EnterSpecificCell>, an optional element specifying an ECGI which when entered triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nIII)\t<ExitSpecificCell>, an optional element specifying an ECGI which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nb)\t<TrackingAreaChange>, an optional element specifying what tracking area changes trigger location reporting. Consists of the following sub-elements:\nI)\t<AnyTrackingAreaChange>, an optional element. The presence of this element specifies that any tracking area change is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nII)\t<EnterSpecificTrackingArea>, an optional element specifying a Tracking Area Id which when entered triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nIII)\t<ExitSpecificTrackingArea>, an optional element specifying a Tracking Area Id which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nc)\t<PlmnChange>, an optional element specifying what PLMN changes trigger location reporting. Consists of the following sub-elements:\nI)\t<AnyPlmnChange>, an optional element. The presence of this element specifies that any PLMN change is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nII)\t<EnterSpecificPlmn>, an optional element specifying a PLMN Id which when entered triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nIII)\t<ExitSpecificPlmn>, an optional element specifying a PLMN Id which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nd)\t<MbmsSaChange>, an optional element specifying what MBMS changes trigger location reporting. Consists of the following sub-elements:\nI)\t<AnyMbmsSaChange>, an optional element. The presence of this element specifies that any MBMS SA change is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nII)\t<EnterSpecificMbmsSa>, an optional element specifying an MBMS Service Area Id which when entered triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nIII)\t<ExitSpecificMbmsSa>, an optional element specifying an MBMS Service Area Id which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\ne)\t<MbsfnAreaChange>, an optional element specifying what MBSFN changes trigger location reporting. Consists of the following sub-elements:\nI)\t<AnyMbsfnAreaChange>, an optional element. The presence of this element specifies that any MBSFN area change is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nII)\t<EnterSpecificMbsfnArea>, an optional element specifying an MBSFN area which when entered triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nIII)\t<ExitSpecificMbsfnArea>, an optional element specifying an MBSFN area which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nf)\t<PeriodicReport>, an optional element specifying that periodic location reports shall be sent. The value in seconds specifies the reporting interval. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\ng)\t<TravelledDistance>, an optional element specifying that the travelled distance shall trigger a report. The value in metres specified the travelled distance. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nh)\t<McdataSignallingEvent>, an optional element specifying what signalling events triggers a location report. The <McdataSignallingEvent> element has the following sub-elements:\nI)\t<InitialLogOn>, an optional element specifying that an initial log on triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nII)\t<GroupCallNonEmergency>, an optional element specifying that a non-emergency group call triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nIII)\t<PrivateCallNonEmergency>, an optional element specifying that a non-emergency private call triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nIV)\t<LocationConfigurationReceived>, an optional element specifying that a received location configuration triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\ni)\t<GeographicalAreaChange>, an optional element specifying what geographical area changes trigger location reporting. Consists of the following sub-elements:\nI)\t<AnyAreaChange>, an optional element. The presence of this element specifies that any geographical area change is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nII)\t<EnterSpecificArea>, an optional element specifying a geographical area which when entered triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string. The <EnterSpecificArea> element has the following sub-elements:\nA)\t<GeographicalArea>, an optional element containing a <TriggerId> attribute and the following two subelements:\nx1)\t<PolygonArea>, an optional element specifying the area as a polygon specified in clause 5.2 in 3GPP TS 23.032 [47]; and\nx2)\t<EllipsoidArcArea>, an optional element specifying the area as an Ellipsoid Arc specified in clause 5.7 in 3GPP TS 23.032 [47]; and\nIII)\t<ExitSpecificAreaType>, an optional element specifying a geographical area which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nj)\t<RatTypeChange>, an optional element specifying what inter-RAT changes trigger location reporting. Consists of the following sub-elements:\nI)\t<AnyRatTypeChange>, an optional element. The presence of this element specifies that the inter-system RAT changes is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\n4)\tthe <anyExt> shall be included with the following element not declared in the XML schema:\na)\t<EmergencyTriggeringCriteria>, a mandatory element specifying the triggers for the MCData client to perform reporting in emergency status. The <TriggeringCriteria> element contains the following sub-elements:\nI)\t<CellChange>, an optional element specifying what cell changes trigger location reporting. Consists of the following sub-elements:\nA)\t<AnyCellChange>, an optional element. The presence of this element specifies that any cell change is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nB)\t<EnterSpecificCell>, an optional element specifying an ECGI which when entered triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nC)\t<ExitSpecificCell>, an optional element specifying an ECGI which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nII)\t<TrackingAreaChange>, an optional element specifying what tracking area changes trigger location reporting. Consists of the following sub-elements:\nA)\t<AnyTrackingAreaChange>, an optional element. The presence of this element specifies that any tracking area change is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nB)\t<EnterSpecificTrackingArea>, an optional element specifying a Tracking Area Id which when entered triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nC)\t<ExitSpecificTrackingArea>, an optional element specifying a Tracking Area Id which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nIII)\t<PlmnChange>, an optional element specifying what PLMN changes trigger location reporting. Consists of the following sub-elements:\nA)\t<AnyPlmnChange>, an optional element. The presence of this element specifies that any PLMN change is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nB)\t<EnterSpecificPlmn>, an optional element specifying a PLMN Id which when entered triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nC)\t<ExitSpecificPlmn>, an optional element specifying a PLMN Id which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nIV)\t<MbmsSaChange>, an optional element specifying what MBMS changes trigger location reporting. Consists of the following sub-elements:\nA)\t<AnyMbmsSaChange>, an optional element. The presence of this element specifies that any MBMS SA change is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nB)\t<EnterSpecificMbmsSa>, an optional element specifying an MBMS Service Area Id which when entered triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nC\t<ExitSpecificMbmsSa>, an optional element specifying an MBMS Service Area Id which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nV)\t<MbsfnAreaChange>, an optional element specifying what MBSFN changes trigger location reporting. Consists of the following sub-elements:\nA)\t<AnyMbsfnAreaChange>, an optional element. The presence of this element specifies that any MBSFN area change is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nB)\t<EnterSpecificMbsfnArea>, an optional element specifying an MBSFN area which when entered triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nC)\t<ExitSpecificMbsfnArea>, an optional element specifying an MBSFN area which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nVI)\t<PeriodicReport>, an optional element specifying that periodic location reports shall be sent. The value in seconds specifies the reporting interval. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nVII)\t<TravelledDistance>, an optional element specifying that the travelled distance shall trigger a report. The value in metres specified the travelled distance. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nVIII)\t<McdataSignallingEvent>, an optional element specifying what signalling events triggers a location report. The <McdataSignallingEvent> element has the following sub-elements:\nA)\t<InitialLogOn>, an optional element specifying that an initial log on triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nB)\t<GroupCallNonEmergency>, an optional element specifying that a non-emergency group call triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nC)\t<PrivateCallNonEmergency>, an optional element specifying that a non-emergency private call triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nD)\t<LocationConfigurationReceived>, an optional element specifying that a received location configuration triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string; and\nIX)\t<GeographicalAreaChange>, an optional element specifying what geographical area changes trigger location reporting. Consists of the following sub-elements:\nA)\t<AnyAreaChange>, an optional element. The presence of this element specifies that any geographical area change is a trigger. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\nB)\t<EnterSpecificArea>, an optional element specifying a geographical area which when entered triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string. The <EnterSpecificArea> element has the following sub-elements:\nx1)\t<GeographicalArea>, an optional element containing a <TriggerId> attribute and the following two subelements:\ni1)\t<PolygonArea>, an optional element specifying the area as a polygon specified in clause 5.2 in 3GPP TS 23.032 [47]; and\ni2)\t<EllipsoidArcArea>, an optional element specifying the area as an Ellipsoid Arc specified in clause 5.7 in 3GPP TS 23.032 [47]; and\nC)\t<ExitSpecificAreaType>, an optional element specifying a geographical area which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string.\n<Request> is an element with a <RequestId> attribute. The <Request> element is used to request a location report. The value of the <RequestId> attribute is returned in the corresponding <ReportId> attribute in order to correlate the request and the report.\n<Report> is an element used to include the location report. It contains a <ReportId> attribute and a <ReportType> attribute. The <ReportId> attribute is used to return the value in the <RequestId> attribute in the <Request> element. The <ReportType> attribute has two values \"Emergency\" and \"NonEmergency\" used to inform whether the client is sending the report in an emergency situation or not. The <Report> element contains the following sub-elements:\n1)\t<TriggerId>, an optional element which can occur multiple times that contain the value of the <TriggerId> attribute associated with a trigger that has fired; and\n2)\t<CurrentLocation>, a mandatory element that contains the location information. The <CurrentLocation> element contains the following sub-elements:\na)\t<CurrentServingEcgi>, an optional element containing the ECGI of the serving cell;\nb)\t<NeighbouringEcgi>, an optional element that can occur multiple times. It contains the ECGI of any neighbouring cell the MCData client can detect;\nc)\t<MbmsSaId>, an optional element containing the MBMS Service Area Id the MCData client is using;\nd)\t<MbsfnArea>, an optional element containing the MBSFN area the MCData is located in;\ne)\t<CurrentCoordinate>, an optional element containing:\ni)\tthe longitude and latitude coded as in clause 6.1 in 3GPP TS 23.032 [47]; and\nii)\tan optional <anyExt> element containing:\nA)\tan <altitude> element coded as in clause 6.3 in 3GPP TS 23.032 [47];\nB)\tan optional <horizontalaccuracy> element where the <onebyteunsignedhalfrange> subelement is coded as in clause 6.2 in 3GPP TS 23.032 [47], which describes the uncertainty for latitude and longitude; and\nC)\tan optional <verticalaccuracy> element where the <onebyteunsignedhalfrange> subelement is coded as in clause 6.2 in 3GPP TS 23.032 [47], which describes the uncertainty for altitude; and\nf)\t<anyExt>, an optional element containing:\ni)\tan optional <locTimestamp> element containing the date and time the location measurement was made; and\nii)\tan optional <InterRatType> element containing the inter-RAT change type. The <InterRatType> element set to:\nA)\t\"5G-MBS-to-LTE-MBMS\" when the inter-system switching from 5G MBS session to LTE MBMS bearer;\nB)\t\"5G-MBS-to-LTE-unicast\" when the inter-system switching from 5G MBS session to LTE unicast bearer;\nC)\t\"LTE-MBMS-to-5G-MBS\" when the inter-system switching from LTE MBMS to 5G MBS session; or\nD)\t\"LTE-MBMS-to-5G-unicast\" when the inter-system switching from LTE MBMS to 5G unicast PDU session.\nThe contents of the subelements in the <CurrentLocation> subelement of the <Report> element can be encrypted. The following rules are applied when any of these elements are included:\n1)\tif confidentiality protection is not required, then:\na)\tthe \"type\" attributes associated with the <CurrentServingEcgi>, <NeighbouringEcgi>, <MbmsSaId>, and <MbsfnArea> elements of the <Report> element have the value \"Normal\" and\nii)\tthe <Ecgi> subelement of the <CurrentServingEcgi> element contains the unencrypted value of the ECGI of the serving cell;\niii)\tthe <Ecgi> subelement of the <NeighbouringEcgi> element contains the unencrypted value of the ECGI of any neighbouring cell;\niv)\tthe <SaId> subelement of the <MbmsSaId> element contains the unencrypted value of the MBMS Service Area Id the MCData client is using; and\nv)\tthe <MbsfnAreaId> subelement of the <MbsfnArea>, element contains the unencrypted value of the MBSFN area the MCData is located in; and\nb)\tthe \"type\" attributes associated with the <longitude>, <latitude>, <altitude>, <horizontalaccuracy>, and <verticalaccuracy> subelements of the <CurrentCoordinate> element have the value \"Normal\" and the <three-bytes> subelements of <longitude> and <latitude> subelements, the <twobytes> subelement of the <altitude> subelement, the <onebyteunsignedhalfrange> subelement of the <horizontalaccuracy>, and the <onebyteunsignedhalfrange> subelement of the <verticalaccuracy> subelement contain the unencrypted value of longitude, latitude, altitude, horizontalaccuracy, and verticalaccuracy respectively; and\n2)\tif confidentiality protection is required, then:\na)\tthe \"type\" attributes associated with the <CurrentServingEcgi>, <NeighbouringEcgi>, <MbmsSaId>, and <MbsfnArea> elements have the value \"Encrypted\";\nb)\tthe \"type\" attributes associated with the <longitude>, <latitude>, <altitude>, <horizontalaccuracy>, and <verticalaccuracy> subelements of the <CurrentCoordinate> element have the value \"Encrypted\"; and\nc)\tfor each of the elements described in 2a) and subelements described in 2b) above, the <xenc:EncryptedData> element from the \"\" namespace is included and:\ni)\tcan have a \"Type\" attribute can be included with a value of \"\";\nii)\tcan include an <EncryptionMethod> element with the \"Algorithm\" attribute set to value of \"http://www.w3.org/2009/xmlenc11#aes128-gcm\";\niii)\tcan include a <KeyInfo> element with a <KeyName> element containing the base 64 encoded XPK-ID; and\niv)\tincludes a <CipherData> element with a <CipherValue> element containing the encrypted data.\nNOTE:\tWhen the optional attributes and elements are not included within the <xenc:EncryptedData> element, the information they contain is known to sender and the receiver by other means.\nThe recipient of the XML ignores any unknown element and any unknown attribute.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.4.4\tIANA registration template",
                    "description": "",
                    "summary": "",
                    "text_content": "Your Name:\n<MCC name>\nYour Email Address:\n<MCC email address>\nMedia Type Name:\nApplication\nSubtype name:\nvnd.3gpp.mcdata-location-info+xml\nRequired parameters:\nNone\nOptional parameters:\n\"charset\"\tthe parameter has identical semantics to the charset parameter of the \"application/xml\" media type as specified in section 9.1 of IETF RFC 7303.\nEncoding considerations:\nbinary.\nSecurity considerations:\nSame as general security considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. In addition, this media type provides a format for exchanging information in SIP, so the security considerations from IETF RFC 3261 apply.\nThe information transported in this media type does not include active or executable content.\nMechanisms for privacy and integrity protection of protocol parameters exist. Those mechanisms as well as authentication and further security mechanisms are described in 3GPP TS 24.229.\nThis media type does not include provisions for directives that institute actions on a recipient's files or other resources.\nThis media type does not include provisions for directives that institute actions that, while not directly harmful to the recipient, may result in disclosure of information that either facilitates a subsequent attack or else violates a recipient's privacy in any way.\nThis media type does not employ compression.\nInteroperability considerations:\nSame as general interoperability considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. Any unknown XML elements and any unknown XML attributes are to be ignored by recipient of the MIME body.\nPublished specification:\n3GPP TS 24.282 \"Mission Critical Data (MCData) signalling control; Protocol specification\", available via http://www.3gpp.org/specs/numbering.htm.\nApplications which use this media type:\nApplications supporting the mission critical data as described in the published specification.\nFragment identifier considerations:\nThe handling in section 5 of IETF RFC 7303 applies.\nRestrictions on usage:\nNone\nProvisional registration? (standards tree only):\nN/A\nAdditional information:\n1.\tDeprecated alias names for this type: none\n2.\tMagic number(s): none\n3.\tFile extension(s): none\n4.\tMacintosh File Type Code(s): none\n5.\tObject Identifier(s) or OID(s): none\nIntended usage:\nCommon\nPerson to contact for further information:\n-\tName: <MCC name>\n-\tEmail: <MCC email address>\n-\tAuthor/Change controller:\ni)\tAuthor: 3GPP CT1 Working Group/3GPP_TSG_CT_WG1@LIST.ETSI.ORG\nii)\tChange controller: <MCC name>/<MCC email address>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "D.5\tXML schema for MBMS usage information",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "D.5.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause defines XML schema and MIME type for application/vnd.3gpp.mcdata-mbms-usage-info+xml.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.5.2\tXML schema",
                    "description": "",
                    "summary": "",
                    "text_content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema attributeFormDefault=\"unqualified\" elementFormDefault=\"qualified\"\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\ntargetNamespace=\"urn:3gpp:ns:mcdataMbmsUsage:1.0\"\nxmlns:mcdatambms=\"urn:3gpp:ns:mcdataMbmsUsage:1.0\">\n<!-- the root element -->\n<xs:element name=\"mcdata-mbms-usage-info\" type=\"mcdatambms:mcdata-mbms-usage-info-Type\" id=\"mbms\"/>\n<xs:complexType name=\"mcdata-mbms-usage-info-Type\">\n<xs:sequence>\n<xs:element name=\"mbms-listening-status\" type=\"mcdatambms:mbms-listening-statusType\" \n\tminOccurs=\"0\"/>\n<xs:element name=\"mbms-suspension-status\" type=\"mcdatambms:mbms-suspension-statusType\" \n\tminOccurs=\"0\"/>\n<xs:element name=\"announcement\" type=\"mcdatambms:announcementTypeParams\" minOccurs=\"0\"/>\n<xs:element name=\"version\" type=\"xs:integer\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatambms:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"mbms-listening-statusType\">\n<xs:sequence>\n<xs:element name=\"mbms-listening-status\" type=\"xs:string\"/>\n<xs:element name=\"session-id\" type=\"xs:anyURI\" minOccurs=\"0\"/>\n<xs:element name=\"general-purpose\" type=\"xs:boolean\" minOccurs=\"0\"/>\n<xs:element name=\"TMGI\" type=\"xs:hexBinary\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatambms:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"mbms-suspension-statusType\">\n<xs:sequence>\n<xs:element name=\"mbms-suspension-status\" type=\"xs:string\" minOccurs=\"0\" maxOccurs=\"1\"/>\n<xs:element name=\"number-of-reported-bearers\" type=\"xs:integer\" minOccurs=\"0\" maxOccurs=\"1\"/>\n<xs:element name=\"suspended-TMGI\" type=\"xs:hexBinary\" minOccurs=\"0\"/>\n<xs:element name=\"other-TMGI\" type=\"xs:hexBinary\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatambms:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"announcementTypeParams\">\n<xs:sequence>\n<xs:element name=\"TMGI\" type=\"xs:hexBinary\" minOccurs=\"1\"/>\n<xs:element name=\"QCI\" type=\"xs:integer\" minOccurs=\"0\"/>\n<xs:element name=\"frequency\" type=\"xs:unsignedLong\" minOccurs=\"0\"/>\n<xs:element name=\"mbms-service-areas\" type=\"mcdatambms:mbms-service-areasType\" minOccurs=\"0\"/>\n<xs:element name=\"GPMS\" type=\"xs:positiveInteger\" minOccurs=\"0\"/>\n<xs:element name=\"report-suspension\" type=\"xs:boolean\" minOccurs=\"0\" maxOccurs=\"1\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatambms:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<!-- anyEXT elements for the announcement element – begin -->\n<xs:element name=\"mcdata-mbms-rohc\" type=\"mcdatambms:emptyType\"/>\n<!-- empty complex type -->\n<xs:complexType name=\"emptyType\"/>\n\n<xs:element name=\"max-cid\" type=\"mcdatambms:max-cidType\"/>\n<xs:simpleType name=\"max-cidType\">\n<xs:restriction base=\"xs:integer\">\n<xs:minInclusive value=\"1\"/>\n<xs:maxInclusive value=\"16383\"/>\n</xs:restriction>\n</xs:simpleType>\n<!-- anyEXT elements for the announcement element – end -->\n\n<xs:complexType name=\"mbms-service-areasType\">\n<xs:sequence>\n<xs:element name=\"mbms-service-area-id\" type=\"xs:hexBinary\"\n\tminOccurs=\"1\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatambms:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute/>\n</xs:complexType>\n\n<xs:complexType name=\"anyExtType\">\n<xs:sequence>\n<xs:any namespace=\"##any\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n\n<!-- anyEXT element for the mcdata-mbms-usage-info element – begin -->\n<xs:element name=\"mbms-defaultMuSiK-download\" type=\"mcdatambms:mbms-default-ctrlkey-downloadType\"/>\n<xs:complexType name=\"mbms-default-ctrlkey-downloadType\">\n<xs:sequence>\n<xs:element type=\"xs:anyURI\" name=\"group\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatambms:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:element name=\"mbms-explicitMuSiK-download\" type=\"mcdatambms:mbms-explicit-ctrlkey-downloadType\"/>\n<xs:complexType name=\"mbms-explicit-ctrlkey-downloadType\">\n<xs:sequence>\n<xs:element type=\"xs:anyURI\" name=\"group\" minOccurs=\"1\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatambms:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<!-- anyEXT element for the mcdata-mbms-usage-info element – end -->\n\n</xs:schema>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.5.3\tSemantic",
                    "description": "",
                    "summary": "",
                    "text_content": "The <mcdata-mbms-usage-info> element is the root element of the XML document. The <mcdata-mbms-usage-info> element contains the subelements:\n1)\t<mbms-listening-status> containing the following elements:\na)\t<mbms-listening-status> element contains a string used to indicate the MCData listening status:\n-\tThe value \"listening\" indicates that the MCData client now is receiving RTP media packets and/or RTCP control packets over the MBMS subchannel in the session identified by the <session-id> element or if the <general-purpose> element is set to \"true\", that the MCData client is now listening to the general purpose MBMS subchannel.\n-\tThe value \"not-listening\" indicates that the MCData client has stopped listening to the MBMS subchannel in the session identified by the <session-id> element or, if the <general-purpose> element is set to \"false\", that the MCData client no longer listens to the general purpose MBMS subchannel.\nTable D.5.3-1 shows the ABNF of the <mbms-listening-status> element.\nTable D.5.3-1: ABNF syntax of values of the <mbms-listening-status> element\nmbms-listening-status = listening-value / not-listening-value\nlistening-value = %x6c.69.73.74.65.6e.69.6e.67 ; \"listening\"\nnot-listening-value = %x6e.6f.74.2d.6c.69.73.74.65.6e.69.6e.67 ; \"not-listening\"\n\nb)\t<session-id> element contains the value of the URI received in the Contact header field received from the controlling MCData function when an on-demand session was established, or from the participating MCData function in the Connect message when the session was established over a pre-established session. This element is mandatory if the <general-purpose> element is not present in the application/vnd.3gpp.mcdata-mbms-usage-info+xml MIME body.\nc)\t<general-purpose> element is a boolean with the following meaning:\n-\tTrue indicates that the MCData client is listening to the general purpose MBMS subchannel associated to the TMGI(s) in the <TMGI> element(s) but have not yet received a Map Group To bearer message for any session that the MCData client is involved in.\n-\tFalse indicates that the MCData client is not listening to the general purpose MBMS subchannel any longer.\nAbsence of the <general-purpose> element requires that the <session-id> element is present in the application/vnd.3gpp.mcdata-mbms-usage-info+xml; and\nd)\t<TMGI>: element contains the TMGI. The <TMGI> element is coded as described in 3GPP TS 24.008 [62] clause 10.5.6.13 excluding the Temporary Mobile Group Identity IEI and Length of Temporary Mobile Group Identity contents (octet 1 and octet 2 in 3GPP TS 24.008 [62] clause 10.5.6.13).\n2)\t<mbms-suspension-status>: contains the following subelements:\na)\t<mbms-suspension-status>: element is a string used to indicate the MBMS bearers intended suspension status:\n-\tThe value \"suspending\" indicates that the RAN has decided to suspend the referenced MBMS bearer(s) at the beginning of the next MCCH modification period.\n-\tThe value \"not-suspending\" indicates that the RAN has decided to revoke its decision to suspend the referenced MBMS bearer(s) before the beginning of the next MCCH modification period.\nTable D.5.3-2 shows the ABNF of the <mbms-suspension-status> element.\nTable D.5.3-2: ABNF syntax of values of the <mbms-suspension-status> element\nmbms-suspension-status = suspending-value / not-suspending-value\nsuspending-value = %x73.75.73.70.65.6e.64.69.6e.67 ; \"suspending\"\nnot-suspending-value = %x6e.6f.74.2d.73.75.73.70.65.6e.64.69.6e.67 ; \"not-suspending\"\n\nb)\t<number-of-reported-bearers>: a hex binary number denoting the total number of occurrences of the <suspended-TMGI> and <other-TMGI> elements reported as part of the MBMS bearer suspension status;\nc)\t<suspended-TMGI>: contains a TMGI that is being reported as about to be suspended or as no longer about to be suspended; and\nd)\t<other-TMGI>: contains a TMGI that is not being reported as about to be suspended or as no longer about to be suspended, but which shares the same MCH with MBMS bearers reported in the <suspended-TMGI> elements;\n3)\t<announcement> element containing the following elements:\na)\t<TMGI>: contains the TMGI. The <TMGI> element is coded as described in 3GPP TS 24.008 [62] clause 10.5.6.13 excluding the Temporary Mobile Group Identity IEI and Length of Temporary Mobile Group Identity contents (octet 1 and octet 2 in 3GPP TS 24.008 [62] clause 10.5.6.13);\nb)\t<QCI>: element contains QCI information used by the ProSe UE-Network Relay to determine the ProSe Per-Packet Priority value to be applied for the multicast packets relayed to Remote UE over PC5. QCI values are defined in 3GPP TS 23.203 [63];\nc)\t<frequency>: element containing identification of frequency in case of multi carrier support. The <frequency> element is coded as specified in 3GPP TS 29.468 [57];\nNOTE 1:\tIn the current release the frequency in the <frequency> element is the same as the frequency used for unicast.\nd)\t<mbms-service-areas>: element is a list of MBMS service area IDs for the applicable MBMS broadcast area as specified in 3GPP TS 23.003 [31] for Service Area Identifier (SAI), and with the encoding as specified in 3GPP TS 29.061 [64] for the MBMS-Service-Area AVP;\ne)\t<GPMS>:\telement is a positive integer that gives the number of the media line containing the general purpose MBMS subchannel in the application/sdp MIME body attached to the SIP MESSAGE request containing the MBMS announcements;\nf)\t<report-suspension>: element is a boolean with the following meaning:\n-\tTrue indicates that the MCData client is instructed to notify the MCData server when it becomes aware of an intended change in the suspension status of a listened MBMS bearer.\n-\tFalse indicates that the MCData client is instructed not to notify the MCData server if it becomes aware of an intended change in the suspension status of a listened MBMS bearer ; and\ng)\t<anyExt> element can contain the following elements not shown in the XML schema:\ni)\t<mcdata-mbms-rohc> element: presence of the <mcdata-mbms-rohc> element indicates that the flows delivered by the announced MBMS bearer are header compressed with ROHC as specified in RFC 5795 [60] and RFC 3095 [61]; and\nii)\t<max-cid> element: of type integer restricted to the range 1 to 16383 indicating the maximum CID value that can be used by the header compressor, see clause 5.1.2 in RFC 5795 [60]). If max-cid > 15 then the header compressor uses the large CID representation. Else, the header compressor uses the small CID representation;\n4)\t<version> is an element of type \"xs:integer\" indicating the version of the application/vnd.3gpp.mbms-usage-info MIME body. In this version the <version element> indicates \"1\"; and\n5)\t<anyExt> element can contain the following elements:\na)\t<mbms-defaultMuSiK-download> that can contain:\ni)\ta <group> element containing the identity, in the form of a URI, of a group for which the MuSiK download is performed; and\nb)\t<mbms-explicitMuSiK-download> that can contain:\ni)\ta <group> element containing the identity, in the form of a URI, of a group for which the MuSiK download is performed.\nThe recipient of the XML ignores any unknown element and any unknown attribute.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.5.4\tIANA registration template",
                    "description": "",
                    "summary": "",
                    "text_content": "Your Name:\n<MCC name>\nYour Email Address:\n<MCC email address>\nMedia Type Name:\nApplication\nSubtype name:\nvnd.3gpp.mcdata-mbms-usage-info+xml\nRequired parameters:\nNone\nOptional parameters:\n\"charset\"\tthe parameter has identical semantics to the charset parameter of the \"application/xml\" media type as specified in section 9.1 of IETF RFC 7303.\nEncoding considerations:\nbinary.\nSecurity considerations:\nSame as general security considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. In addition, this media type provides a format for exchanging information in SIP, so the security considerations from IETF RFC 3261 apply.\nThe information transported in this media type does not include active or executable content.\nMechanisms for privacy and integrity protection of protocol parameters exist. Those mechanisms as well as authentication and further security mechanisms are described in 3GPP TS 24.229.\nThis media type does not include provisions for directives that institute actions on a recipient's files or other resources.\nThis media type does not include provisions for directives that institute actions that, while not directly harmful to the recipient, may result in disclosure of information that either facilitates a subsequent attack or else violates a recipient's privacy in any way.\nThis media type does not employ compression.\nInteroperability considerations:\nSame as general interoperability considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. Any unknown XML elements and any unknown XML attributes are to be ignored by recipient of the MIME body.\nPublished specification:\n3GPP TS 24.379 \"Mission Critical Push To Talk (MCData) call control\" version 13.0.0, available via http://www.3gpp.org/specs/numbering.htm.\nApplications which use this media type:\nApplications supporting the mission critical push to talk as described in the published specification.\nFragment identifier considerations:\nThe handling in section 5 of IETF RFC 7303 applies.\nRestrictions on usage:\nNone\nProvisional registration? (standards tree only):\nN/A\nAdditional information:\n1.\tDeprecated alias names for this type: none\n2.\tMagic number(s): none\n3.\tFile extension(s): none\n4.\tMacintosh File Type Code(s): none\n5.\tObject Identifier(s) or OID(s): none\nIntended usage:\nCommon\nPerson to contact for further information:\n-\tName: <MCC name>\n-\tEmail: <MCC email address>\n-\tAuthor/Change controller:\ni)\tAuthor: 3GPP CT1 Working Group/3GPP_TSG_CT_WG1@LIST.ETSI.ORG\nii)\tChange controller: <MCC name>/<MCC email address>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "D.6\tXML schema for regroup using preconfigured group",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "D.6.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause defines the XML schema and MIME type for regroup using preconfigured group.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.6.2\tXML schema",
                    "description": "",
                    "summary": "",
                    "text_content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\ntargetNamespace=\"urn:3gpp:ns:preconfiguredRegroup:1.0\"\nxmlns:mcdatargrp=\"urn:3gpp:ns:preconfiguredRegroup:1.0\"\nattributeFormDefault=\"unqualified\" elementFormDefault=\"qualified\">\n\n<!-- root XML element -->\n<xs:element name=\"mcdataregroup\" type=\"mcdatargrp:mcdataregroup-Type\" id=\"info\"/>\n\n<xs:complexType name=\"mcdataregroup-Type\">\n<xs:sequence>\n<xs:element name=\"mcdataregroup-Params\" type=\"mcdatargrp:mcdataregroup-ParamsType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatargrp:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"mcdataregroup-ParamsType\">\n<xs:sequence>\n<xs:element name=\"preconfig-group-id\" type=\"mcdatargrp:preconfig-group-Type\"/>\n<xs:element name=\"mcdata-regroup-uri\" type=\"mcdatargrp:mcdata-regroup-uri-Type\"/>\n<xs:element name=\"groups-for-regroup\" type=\"mcdatargrp:groups-for-regroup-Type\" minOccurs=\"0\"/>\n<xs:element name=\"users-for-regroup\" type=\"mcdatargrp:users-for-regroup-Type\" minOccurs=\"0\"/>\n<xs:element name=\"regroup-action\" type=\"xs:string\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatargrp:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"preconfig-group-Type\">\n<xs:sequence>\n<xs:element type=\"xs:anyURI\" name=\"preconfigured-group\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatargrp:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"mcdata-regroup-uri-Type\">\n<xs:sequence>\n<xs:element type=\"xs:anyURI\" name=\"mcdata-regroup-uri\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatargrp:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"groups-for-regroup-Type\">\n<xs:sequence>\n<xs:element type=\"xs:anyURI\" name=\"group\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatargrp:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"users-for-regroup-Type\">\n<xs:sequence>\n<xs:element type=\"xs:anyURI\" name=\"user\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcdatargrp:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n\n<xs:complexType name=\"anyExtType\">\n<xs:sequence>\n<xs:any namespace=\"##any\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n\n</xs:schema>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.6.3\tSemantic",
                    "description": "",
                    "summary": "",
                    "text_content": "The <preconfigured-group> element shall contain a URI identifying the preconfigured MCData group.\nThe <mcdata-regroup-uri> element shall contain a URI containing the temporary group identity identifying the regroup.\nThe <groups-for-regroup> element shall contain one or more <group> elements that shall each contain a URI of a group that is to be a constituent group of the regroup.\nThe <users-for-regroup> element shall contain one or more <user> elements that shall each contain an MCData ID of a user that is to be affiliated to the regroup.\nThe XML document shall have either one <groups-for-regroup> element or one <users-for-regroup> element, but not both.\nIf the <regroup-action> element contains the string \"create\" then:\n1)\tif a <groups-for-regroup> element exists in the received XML, then:\na)\tif the recipient is the controlling MCData function for the MCData group identified in the <preconfigured-group> element the recipient shall follow the procedures to create a group regroup with identity equal to the value contained in the <mcdata-regroup-uri> element based on the configuration of the preconfigured MCData group identified in the <preconfigured-group> element;\nb)\tif the recipient is a non-controlling MCData function, the recipient shall follow the procedures to affiliate users belonging to any constituent groups of the group regroup with identity equal to the value contained in the <mcdata-regroup-uri> element based on the configuration of the preconfigured MCData group identified in the <preconfigured-group> element; and\nc)\tif the recipient is the terminating participating MCData function for one or more MCData users affiliated to a constituent group of the group regroup, the recipient shall follow the procedures to notify each MCData user in the list of users in the <users-for-regroup> element that it serves of the group regroup and affiliate those users to the group regroup; and\n2)\tif a <users-for-regroup> element exists in the received XML, then:\na)\tif the recipient is the controlling MCData function for the MCData group identified in the <preconfigured-group> element, the recipient shall follow the procedures to create a user regroup with identity equal to the value contained in the <mcdata-regroup-uri> element based on the configuration of the preconfigured MCData group identified in the <preconfigured-group> element; and\nb)\tif the recipient is the terminating participating MCData function for one or more MCData users identified in the <users-for-regroup> element, the recipient shall follow the procedures to notify each MCData user in the list of users in the <users-for-regroup> element that it serves of the user regroup and affiliate those users to the user regroup.\nIf the <regroup-action> element contains the string \"remove\" then:\n1)\tthe recipient shall follow the procedures to remove the regroup identified in the <mcdata-regroup-uri> element.\nThe recipient of the XML ignores any unknown element and any unknown attribute.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.6.4\tIANA registration template",
                    "description": "",
                    "summary": "",
                    "text_content": "Editor's Note:\t[enh2MCPTT-CT, CR 0529] MCC is requested to submit the IANA registration for this media type.\nYour Name:\n<MCC name>\nYour Email Address:\n<MCC email address>\nMedia Type Name:\nApplication\nSubtype name:\nvnd.3gpp.mcdata-regroup+xml\nRequired parameters:\nNone\nOptional parameters:\n\"charset\"\tthe parameter has identical semantics to the charset parameter of the \"application/xml\" media type as specified in section 9.1 of IETF RFC 7303.\nEncoding considerations:\nbinary.\nSecurity considerations:\nSame as general security considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. In addition, this media type provides a format for exchanging information in SIP, so the security considerations from IETF RFC 3261 apply.\nThe information transported in this media type does not include active or executable content.\nMechanisms for privacy and integrity protection of protocol parameters exist. Those mechanisms as well as authentication and further security mechanisms are described in 3GPP TS 24.229.\nThis media type does not include provisions for directives that institute actions on a recipient's files or other resources.\nThis media type does not include provisions for directives that institute actions that, while not directly harmful to the recipient, may result in disclosure of information that either facilitates a subsequent attack or else violates a recipient's privacy in any way.\nThis media type does not employ compression.\nInteroperability considerations:\nSame as general interoperability considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. Any unknown XML elements and any unknown XML attributes are to be ignored by recipient of the MIME body.\nPublished specification:\n3GPP TS 24.282 \"Mission Critical Data (MCData) signalling control\" version 16.4.1, available via http://www.3gpp.org/specs/numbering.htm.\nApplications which use this media type:\nApplications supporting the mission critical push to talk as described in the published specification.\nFragment identifier considerations:\nThe handling in section 5 of IETF RFC 7303 applies.\nRestrictions on usage:\nNone\nProvisional registration? (standards tree only):\nN/A\nAdditional information:\n1.\tDeprecated alias names for this type: none\n2.\tMagic number(s): none\n3.\tFile extension(s): none\n4.\tMacintosh File Type Code(s): none\n5.\tObject Identifier(s) or OID(s): none\nIntended usage:\nCommon\nPerson to contact for further information:\n-\tName: <MCC name>\n-\tEmail: <MCC email address>\n-\tAuthor/Change controller:\ni)\tAuthor: 3GPP CT1 Working Group/3GPP_TSG_CT_WG1@LIST.ETSI.ORG\nii)\tChange controller: <MCC name>/<MCC email address>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "D.7\tXML schema for control of communications storage",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "D.7.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause defines the XML schema and MIME type for MCData user control of communications storage into message store.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.7.2\tXML schema",
                    "description": "",
                    "summary": "",
                    "text_content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\ntargetNamespace=\"urn:3gpp:ns:msgstoreControlRequest:1.0\"\nxmlns:mcpttmsgstorectrl=\"urn:3gpp:ns:msgstoreControlRequest:1.0\"\nattributeFormDefault=\"unqualified\" elementFormDefault=\"qualified\">\n<xs:complexType name=\"enable-command\">\n<xs:sequence>\n<xs:element type=\"xs:anyURI\" name=\"group\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element type=\"xs:anyURI\" name=\"private\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcpttmsgstorectrl:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"disable-command\">\n<xs:sequence>\n<xs:element type=\"xs:anyURI\" name=\"group\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element type=\"xs:anyURI\" name=\"private\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mcpttmsgstorectrl:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<!-- root XML element when creating a message store XML document -->\n<xs:element name=\"msgstore-ctrl-command-list\">\n<xs:complexType>\n<xs:sequence>\n<xs:element name=\"enable\" type=\"mcpttmsgstorectrl:enable-command\" minOccurs=\"0\" />\n<xs:element name=\"disable\" type=\"mcpttmsgstorectrl:disable-command\" minOccurs=\"0\" />\n<xs:element name=\"anyExt\" type=\"mcpttmsgstorectrl:anyExtType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n</xs:element>\n<xs:complexType name=\"anyExtType\">\n<xs:sequence>\n<xs:any namespace=\"##any\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n</xs:schema>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.7.3\tSemantic",
                    "description": "",
                    "summary": "",
                    "text_content": "The <msgstore-ctrl-command-list> element is the root element of the XML document. The <msgstore-ctrl-command-list > element may contain <enable>, or <disable> subelements or both.\nIf the <msgstore-ctrl-command-list> contains the <enable> element then:\n1)\tthe <enable> element contains a list of <group> subelements having zero or more subelement. The recipient shall enable the storing of the communications into message store of all the MCData groups contained in the list for the clients for which the <msgstore-ctrl-command-list> applies.\n2)\tthe <enable> element contains a list of <private> subelements having zero or more subelement. The recipient shall enable the storing of the communications into message store of all the MCData IDs contained in the list for the clients for which the <msgstore-ctrl-command-list> applies.\nIf the <msgstore-ctrl-command-list> contains the <disable> element then:\n1)\tthe <disable> element contains a list of <group> subelements having zero or more subelement. The recipient shall disable the storing of the communications into message store of all the MCData groups contained in the list for the clients for which the <msgstore-ctrl-command-list> applies.\n2)\tthe <disable> element contains a list of <private> subelements having zero or more subelement. The recipient shall disable the storing of the communications into message store of all the MCData IDs contained in the list for the clients for which the <msgstore-ctrl-command-list> applies.\nThe recipient of the XML ignores any unknown element and any unknown attribute.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.7.4\tIANA registration template",
                    "description": "",
                    "summary": "",
                    "text_content": "Editor's Note:\t[eMCData3, CR 0272] MCC is requested to submit the IANA registration for this media type after the completion of 3GPP release 17.\nYour Name:\n<MCC name>\nYour Email Address:\n<MCC email address>\nMedia Type Name:\nApplication\nSubtype name:\nvnd.3gpp.mcdata-msgstore-ctrl-request+xml\nRequired parameters:\nNone\nOptional parameters:\n\"charset\"\tthe parameter has identical semantics to the charset parameter of the \"application/xml\" media type as specified in section 9.1 of IETF RFC 7303.\nEncoding considerations:\nbinary.\nSecurity considerations:\nSame as general security considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. In addition, this media type provides a format for exchanging information in SIP, so the security considerations from IETF RFC 3261 apply.\nThe information transported in this media type does not include active or executable content.\nMechanisms for privacy and integrity protection of protocol parameters exist. Those mechanisms as well as authentication and further security mechanisms are described in 3GPP TS 24.229.\nThis media type does not include provisions for directives that institute actions on a recipient's files or other resources.\nThis media type does not include provisions for directives that institute actions that, while not directly harmful to the recipient, may result in disclosure of information that either facilitates a subsequent attack or else violates a recipient's privacy in any way.\nThis media type does not employ compression.\nInteroperability considerations:\nSame as general interoperability considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. Any unknown XML elements and any unknown XML attributes are to be ignored by recipient of the MIME body.\nPublished specification:\n3GPP TS 24.282 \"Mission Critical Data (MCData) signalling control\" version 17.4.0, available via http://www.3gpp.org/specs/numbering.htm.\nApplications which use this media type:\nApplications supporting the mission critical push to talk as described in the published specification.\nFragment identifier considerations:\nThe handling in section 5 of IETF RFC 7303 applies.\nRestrictions on usage:\nNone\nProvisional registration? (standards tree only):\nN/A\nAdditional information:\n1.\tDeprecated alias names for this type: none\n2.\tMagic number(s): none\n3.\tFile extension(s): none\n4.\tMacintosh File Type Code(s): none\n5.\tObject Identifier(s) or OID(s): none\nIntended usage:\nCommon\nPerson to contact for further information:\n-\tName: <MCC name>\n-\tEmail: <MCC email address>\n-\tAuthor/Change controller:\ni)\tAuthor: 3GPP CT1 Working Group/3GPP_TSG_CT_WG1@LIST.ETSI.ORG\nii)\tChange controller: <MCC name>/<MCC email address>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "D.8\tXML schema for 5G MBS usage information",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "D.8.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause defines XML schema and MIME type for application/vnd.3gpp.mvdata-mbs-usage-info+xml.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.8.2\tXML schema",
                    "description": "",
                    "summary": "",
                    "text_content": "\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<xs:schema attributeFormDefault=\"unqualified\" elementFormDefault=\"qualified\"\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\ntargetNamespace=\"urn:3gpp:ns:mvdataMbsUsage:1.0\"\nxmlns:mvdatambs=\"urn:3gpp:ns:mvdataMbsUsage:1.0\">\n<!-- the root element -->\n<xs:element name=\"mvdata-mbs-usage-info\" type=\"mvdatambs:mvdata-mbs-usage-info-Type\" id=\"mbs\"/>\n<xs:complexType name=\"mvdata-mbs-usage-info-Type\">\n<xs:sequence>\n<xs:element name=\"mbs-listening-status\" type=\"mvdatambs:mbs-listening-statusType\" minOccurs=\"0\"/>\n<xs:element name=\"mbs-session-de-announcement-status\" type=\"mvdatambs:mbs-session-de-announcement-statusType\" minOccurs=\"0\"/>\n<xs:element name=\"ue-session-join-notification\" type=\"mvdatambs:ue-session-join-notificationType\" minOccurs=\"0\"/>\n<xs:element name=\"announcement\" type=\"mvdatambs:announcementTypeParams\" minOccurs=\"0\"/>\n<xs:element name=\"version\" type=\"xs:integer\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"mbs-listening-statusType\">\n<xs:sequence>\n<xs:element name=\"mbs-listening-status\" type=\"xs:string\"/>\n<xs:element name=\"unicast-listening-status\" type=\"xs:string\"/>\n<xs:element name=\"session-id\" type=\"xs:anyURI\" minOccurs=\"0\"/>\n<xs:element name=\"general-purpose\" type=\"xs:boolean\" minOccurs=\"0\"/>\n<xs:element name=\"mbs-session-id\" type=\"xs:hexBinary\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"mbs-session-de-announcement-statusType\">\n<xs:sequence>\n<xs:element name=\"mbs-session-de-announcement-status\" type=\"xs:string\" minOccurs=\"0\"/>\n<xs:element name=\"number-of-reported-sessions\" type=\"xs:integer\" minOccurs=\"0\"/>\n<xs:element name=\"deleted-mbs-session-id\" type=\"xs:hexBinary\" minOccurs=\"0\"/>\n<xs:element name=\"other-mbs-session-id\" type=\"xs:hexBinary\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"ue-session-join-notificationType\">\n<xs:sequence>\n<xs:element name=\"mbs-multicast-joining-status\" type=\"xs:string\"/>\n<xs:element name=\"mbs-session-id\" type=\"xs:hexBinary\"/>\n<xs:element name=\"session-id\" type=\"xs:anyURI\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"announcementTypeParams\">\n<xs:sequence>\n<xs:element name=\"mbs-session-info\" type=\"mvdatambs:mbs-session-infoType\" minOccurs=\"0\"/>\n<xs:element name=\"eMBMS-bearer-info\" type=\"mvdatambs:eMBMS-bearer-infoType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"mbs-session-infoType\">\n<xs:sequence>\n<xs:element name=\"mbs-session-id\" type=\"xs:hexBinary\"/>\n<xs:element name=\"mbs-session-mode\" type=\"mvdatambs:sessionType\"/>\n<xs:element name=\"mc-service-group-id\" type=\"xs:integer\" minOccurs=\"0\"/>\n<xs:element name=\"frequency\" type=\"xs:unsignedLong\" minOccurs=\"0\"/>\n<xs:element name=\"GPMS\" type=\"xs:positiveInteger\" minOccurs=\"0\"/>\n<xs:element name=\"mbs-service-areas\" type=\"mvdatambs:mbs-service-areasType\" minOccurs=\"0\"/>\n<xs:element name=\"report-ue-session-join-notification\" type=\"xs:boolean\" minOccurs=\"0\"/>\n<xs:element name=\"multicast-mbs-session-related-info\" type=\"mvdatambs:multicast-mbs-session-related-infoType\"/>\n<xs:element name=\"mbs-fsa-id\" type=\"xs:hexBinary\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"mbs-session-de-announcement-acknowledgement\" type=\"xs:boolean\" minOccurs=\"0\" maxOccurs=\"1\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"eMBMS-bearer-infoType\">\n<xs:sequence>\n<xs:element name=\"TMGI\" type=\"xs:hexBinary\"/>\n<xs:element name=\"Alternative-TMGI\" type=\"mvdatambs:Alternative-TMGI-Type\" minOccurs=\"0\"/>\n<xs:element name=\"QCI\" type=\"xs:integer\" minOccurs=\"0\"/>\n<xs:element name=\"frequency\" type=\"xs:unsignedLong\" minOccurs=\"0\"/>\n<xs:element name=\"mbms-service-areas\" type=\"mvdatambs:mbms-service-areasType\" minOccurs=\"0\"/>\n<xs:element name=\"GPMS\" type=\"xs:positiveInteger\" minOccurs=\"0\"/>\n<xs:element name=\"report-suspension\" type=\"xs:boolean\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<!-- anyEXT elements for the eMBMS announcement element – begin -->\n<xs:element name=\"mvdata-mbs-rohc\" type=\"mvdatambs:emptyType\"/>\n<!-- empty complex type -->\n<xs:complexType name=\"emptyType\"/>\n<xs:element name=\"max-cid\" type=\"mvdatambs:max-cidType\"/>\n<xs:simpleType name=\"max-cidType\">\n<xs:restriction base=\"xs:integer\">\n<xs:minInclusive value=\"1\"/>\n<xs:maxInclusive value=\"16383\"/>\n</xs:restriction>\n</xs:simpleType>\n<!-- anyEXT elements for the eMBMS announcement element – end -->\n<xs:simpleType name=\"sessionType\">\n<xs:restriction base=\"xs:string\">\n<xs:enumeration value=\"multicast\"/>\n<xs:enumeration value=\"broadcast\"/>\n</xs:restriction>\n</xs:simpleType>\n<xs:complexType name=\"Alternative-TMGI-Type\">\n<xs:sequence>\n<xs:element name=\"Alternative-TMGI-id\" type=\"xs:hexBinary\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute/>\n</xs:complexType>\n<xs:complexType name=\"mbs-service-areasType\">\n<xs:sequence>\n<xs:element name=\"mbs-service-area-id\" type=\"xs:hexBinary\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute/>\n</xs:complexType>\n<xs:complexType name=\"mbms-service-areasType\">\n<xs:sequence>\n<xs:element name=\"mbms-service-area-id\" type=\"xs:hexBinary\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute/>\n</xs:complexType>\n<xs:complexType name=\"multicast-mbs-session-related-infoType\">\n<xs:sequence>\n<xs:element name=\"PlmnId\" type=\"mvdatambs:tPlmnIdentity\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"DNN\" type=\"xs:string\" minOccurs=\"0\"/>\n<xs:element name=\"IPInformation\" type=\"mvdatambs:IPInformationType\" minOccurs=\"0\"/>\n<xs:element name=\"MC-ID-ref-SNSSAI\" type=\"xs:string\" minOccurs=\"0\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute/>\n</xs:complexType>\n<xs:simpleType name=\"tPlmnIdentityFormat\">\n<xs:restriction base=\"xs:string\">\n<xs:pattern value=\"\\d{3}\\d{3}\"/>\n</xs:restriction>\n</xs:simpleType>\n<xs:complexType name=\"tPlmnIdentity\">\n<xs:simpleContent>\n<xs:extension base=\"mvdatambs:tPlmnIdentityFormat\">\n<xs:attribute name=\"TriggerId\" type=\"xs:string\" use=\"required\"/>\n</xs:extension>\n</xs:simpleContent>\n</xs:complexType>\n<xs:complexType name=\"IPInformationType\">\n<xs:sequence>\n<xs:element name=\"IPInformationListEntry\" type=\"mvdatambs:IPInformationListEntryType\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"IPInformationListEntryType\">\n<xs:choice>\n<xs:element name=\"IPv4Address\" type=\"xs:token\"/>\n<xs:element name=\"IPv6Address\" type=\"xs:token\"/>\n<xs:element name=\"FQDN\" type=\"xs:anyURI\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:choice>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:complexType name=\"anyExtType\">\n<xs:sequence>\n<xs:any namespace=\"##any\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n<!-- anyEXT elements for the mvdata-mbs-usage-info – begin -->\n<xs:element name=\"mbs-defaultMuSiK-download\" type=\"mvdatambs:mbs-default-ctrlkey-downloadType\"/>\n<xs:complexType name=\"mbs-default-ctrlkey-downloadType\">\n<xs:sequence>\n<xs:element name=\"group\" type=\"xs:anyURI\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<xs:element name=\"mbs-explicitMuSiK-download\" type=\"mvdatambs:mbs-explicit-ctrlkey-downloadType\"/>\n<xs:complexType name=\"mbs-explicit-ctrlkey-downloadType\">\n<xs:sequence>\n<xs:element name=\"group\" type=\"xs:anyURI\" maxOccurs=\"unbounded\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xs:element name=\"anyExt\" type=\"mvdatambs:anyExtType\" minOccurs=\"0\"/>\n</xs:sequence>\n<xs:anyAttribute namespace=\"##any\" processContents=\"lax\"/>\n</xs:complexType>\n<!-- anyEXT elements for the mvdata-mbs-usage-info – end -->\n</xs:schema>\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.8.3\tSemantic",
                    "description": "",
                    "summary": "",
                    "text_content": "The <mvdata-mbs-usage-info> element is the root element of the XML document. The <mvdata-mbs-usage-info> element contains the subelements:\n1)\t<mbs-listening-status> contains subelements as specified <mbs-listening-status> in clause D.8.3 with the terminology mapping specified in clause I.3.4;\n2)\t<mbs-session-de-announcement-status>: contains the following subelements:\na)\t<mbs-session-de-announcement-status>: element is a string used to indicate the MBS sessions intended deletion status:\n-\tThe value \"deleteing\" indicates that the MC client UE has decided to stop monitoring the broadcast MBS session or leaves the multicast MBS session.\n-\tThe value \"not-deleteing\" indicates that the MC client UE has decided to revoke its decision to stop monitoring the broadcast MBS session or leaves the multicast MBS session.\nb)\t<number-of-reported-sessions>: a hex binary number denoting the total number of occurrences of the <deleted-mbs-session-id> and <other-mbs-session-id> elements reported as part of the MBS session de-announcement status;\nc)\t<deleted-mbs-session-id>: contains a MBS session ID that is being reported as about to be deleted or as no longer about to be deleted; and\nd)\t<other-mbs-session-id>: contains a MBS session ID that is not being reported as about to be deleted or as no longer about to be deleted;\n3)\t<ue-session-join-notification> containing the following elements:\na)\t<mbs-multicast-joining-status> element contains a string used to indicate the MCData join MBS session status:\n-\tThe value \"ue-session-join\" indicates that a MCData client joins an MBS session, i.e. the MCData client indicates to MCData server that such MCData client wants to receive multicast data identified by a specific MBS session ID.\n-\tThe value \"ue-session-leave\" indicates that a MCData client leaves a MBS session, i.e. the MCData client no longer wants to receive multicast data identified by a specific MBS session ID.\nb)\t<mbs-session-id>: element is coded as described in 3GPP TS 23.247 [84] clause 6.5.1. The MBS session ID is used to identify a Multicast/Broadcast MBS session by the 5G system on external interface towards AF and between AF and UE, and towards the UE;\nc)\t<session-id> element contains the value of the URI received in the Contact header field received from the controlling MCData function when an on-demand session was established, or from the participating MCData function in the Connect message when the session was established over a pre-established session. This element is mandatory if the <mbs-multicast-joining-status> element is not present in the application/vnd.3gpp.mvdata-mms-usage-info+xml MIME body.\n4)\t<announcement> element containing <mbs-session-infoType> and <eMBMS-bearer-infoType>.\na)\t<mbs-session-infoType> element containing the following elements:\ni)\t<mbs-session-id>: element is coded as described in 3GPP TS 23.247 [84] clause 6.5.1. The MBS session ID is used to identify a Multicast/Broadcast MBS Session by the 5G system on external interface towards AF and between AF and UE, and towards the UE;\nii)\t<mbs-session-mode>: element is a string used to indicate the service type of the MBS session, either a multicast MBS session or a broadcast MBS session:\niii)\t<mc-service-group-id>: element is a string used to indicate the MC service group ID associated to the MBS session;\niv)\t<GPMS>\telement is a positive integer that gives the number of the media line containing the general purpose MBS subchannel in the application/sdp MIME body attached to the SIP MESSAGE request containing the MBS announcements;\nv)\t<mbs-service-areas>: element is a list of MBS service area IDs for the applicable MBS multicast area as specified in 3GPP TS 23.247[84] for Service Area Identifier (SAI);\nvi)\t<report-ue-session-join-notification>: element is a boolean with the following meaning:\n-\tTrue indicates that the MC service server requires a notification from the MC service client once it has joined the multicast MBS session.\n-\tFalse indicates that the MC service server not requires a notification from the MC service client once it has joined the multicast MBS session; and\nvii)\t<multicast-mbs-session-related-info> that can contain:\n-\tshall contain an optional element specifying a PLMN Id which when exited triggers a location report. Contains a mandatory <TriggerId> attribute that shall be set to a unique string;\n-\tshall contain an <IPInformation> element containing (see the MCData user profile document in 3GPP TS 24.484 [50]);\n-\tshall contain a <DNN> element (see the MCData user profile document in 3GPP TS 24.484 [50]); and\n-\tshall containan a <MC-ID-ref-SNSSAI> element (see the MCData user profile document in 3GPP TS 24.484 [50]);\nviii)\t<mbs-fsa-id>: contains the MBS Frequency Selection Area ID. The <mbs-fsa-id> element is coded as described in 3GPP TS 23.247 [84] clause 6.5.4. The MBS Frequency Selection Area (FSA) ID is used for broadcast MBS session to guide the frequency selection of the UE.MBS FSA ID identifies a preconfigured area within, and in proximity to, which the cell(s) announces the MBS FSA ID and the associating frequency. MBS FSA ID and their mapping to frequencies are provided to RAN nodes via OAM;\nix)\t<frequency>: element containing identification of frequency in case of multi carrier support. The <frequency> element is coded as specified in 3GPP TS 29.468 [42]; and\nNOTE 1:\tIn the current release the frequency in the <frequency> element is the same as the frequency used for unicast.\nx)\t<mbs-session-de-announcement-acknowledgement>: element is a boolean with the following meaning:\n-\tTrue indicates that the MCData client is instructed to notify the MCData server when it becomes aware of an intended change in the de-announcement status of a listened MBS session.\n-\tFalse indicates that the MCData client is instructed not to notify the MCData server if it becomes aware of an intended change in the de-announcement status of a listened MBS session.\nb)\t<eMBMS-bearer-infoType> element as specified in clause D.8.3 <announcement> elements with the following clarifications/exceptions:\ni)\t<Alternative-TMGI>: contains a list of additional alternative TMGI which may be included and used in roaming scenarios;\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "D.8.4\tIANA registration template",
                    "description": "",
                    "summary": "",
                    "text_content": "Editor’s note: The MIME type \"application/vnd.3gpp.mvdata-mbs-usage-info+xml\" as defined in this subclause is to be registered in the IANA registry for Application Media Types based upon the following template. The registration is to be started after completion of release 18.\nYour Name:\n<MCC name>\nYour Email Address:\n<MCC email address>\nMedia Type Name:\nApplication\nSubtype name:\nvnd.3gpp.mvdata-mbs-usage-info+xml\nRequired parameters:\nNone\nOptional parameters:\n\"charset\"\tthe parameter has identical semantics to the charset parameter of the \"application/xml\" media type as specified in section 9.1 of IETF RFC 7303.\nEncoding considerations:\nbinary.\nSecurity considerations:\nSame as general security considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. In addition, this media type provides a format for exchanging information in SIP, so the security considerations from IETF RFC 3261 apply.\nThe information transported in this media type does not include active or executable content.\nMechanisms for privacy and integrity protection of protocol parameters exist. Those mechanisms as well as authentication and further security mechanisms are described in 3GPP TS 24.229.\nThis media type does not include provisions for directives that institute actions on a recipient's files or other resources.\nThis media type does not include provisions for directives that institute actions that, while not directly harmful to the recipient, may result in disclosure of information that either facilitates a subsequent attack or else violates a recipient's privacy in any way.\nThis media type does not employ compression.\nInteroperability considerations:\nSame as general interoperability considerations for application/xml media type as specified in section 9.1 of IETF RFC 7303. Any unknown XML elements and any unknown XML attributes are to be ignored by recipient of the MIME body.\nPublished specification:\n3GPP TS 24.379 \"Mission Critical Push To Talk (MCData) call control\" version 18.x.x, available via http://www.3gpp.org/specs/numbering.htm.\nApplications which use this media type:\nApplications supporting the mission critical push to talk as described in the published specification.\nFragment identifier considerations:\nThe handling in section 5 of IETF RFC 7303 applies.\nRestrictions on usage:\nNone\nProvisional registration? (standards tree only):\nN/A\nAdditional information:\n1.\tDeprecated alias names for this type: none\n2.\tMagic number(s): none\n3.\tFile extension(s): none\n4.\tMacintosh File Type Code(s): none\n5.\tObject Identifier(s) or OID(s): none\nIntended usage:\nCommon\nPerson to contact for further information:\n-\tName: <MCC name>\n-\tEmail: <MCC email address>\n-\tAuthor/Change controller:\ni)\tAuthor: 3GPP CT1 Working Group/3GPP_TSG_CT_WG1@LIST.ETSI.ORG\nii)\tChange controller: <MCC name>/<MCC email address>\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "E.1\tMIME type for transporting MCData signalling content",
            "description": "Your Name:\n<MCC name>\nYour Email Address:\n<MCC email address>\nMedia Type Name:\nApplication\nSubtype name:\nvnd.3gpp.mcdata-signalling\nRequired parameters:\nNone\nOptional parameters:\nNone\nEncoding considerations:\nbinary.\nSecurity considerations:\nGeneral mechanisms for privacy and integrity protection of protocol parameters exist. Those mechanisms as well as authentication and further security mechanisms are described in 3GPP TS 24.229.\nSecurity mechanisms specific to this MIME type are dependent upon the business and trust relationship between the mission critical data communications (MCData) operator and the SIP carrier operator. MCData operators may wish to encrypt and integrity protect the content transported by this MIME type indepedently of mechanisms provided by the transport layer. Such mechanisms are being specified in Rel-14 by 3GPP SA3. Security mechanisms applied to MCData signalling content is point-to-point (UE to server, server to server, server to UE).\nThe information transported in this media type does not include active or executable content.\nThis media type does not include provisions for directives that institute actions on a recipient's files or other resources.\nThis media type does not include provisions for directives that institute actions that, while not directly harmful to the recipient, may result in disclosure of information that either facilitates a subsequent attack or else violates a recipient's privacy in any way.\nThis media type does not employ compression.\nInteroperability considerations:\nThe content transported within this MIME type needs to be interpreted by a server as specific decisions are made based on the signalling content (e.g. store disposition history). The final destination point of the content is the terminating UE. Each UE and server that handles the content transported using this MIME type shall understand the definition of the messages and protocol elements as defined in 3GPP TS 24.282. Any messages and protocol elements not defined by 3GPP TS 24.282 shall be ignored by the recipient UE or server.\nPublished specification:\n3GPP TS 24.282 \"Mission Critical Data (MCData) signalling control; Protocol specification\", available via http://www.3gpp.org/specs/numbering.htm.\nApplication Usage:\nApplications supporting the mission critical data communications procedures as described in the published specification. This MIME type shall contain signalling content that is related to the payload that is delivered to a terminating user or an application of the terminating user.\nFragment identifier considerations:\nNone.\nRestrictions on usage:\nNone\nProvisional registration? (standards tree only):\nN/A\nAdditional information:\n1.\tDeprecated alias names for this type: none\n2.\tMagic number(s): none\n3.\tFile extension(s): none\n4.\tMacintosh File Type Code(s): none\n5.\tObject Identifier(s) or OID(s): none\nIntended usage:\nCommon\nPerson to contact for further information:\n-\tName: <MCC name>\n-\tEmail: <MCC email address>\n-\tAuthor/Change controller:\ni)\tAuthor: 3GPP CT1 Working Group/3GPP_TSG_CT_WG1@LIST.ETSI.ORG\nii)\tChange controller: <MCC name>/<MCC email address>\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.2\tMIME type for transporting MCData payload content",
            "description": "Your Name:\n<MCC name>\nYour Email Address:\n<MCC email address>\nMedia Type Name:\nApplication\nSubtype name:\nvnd.3gpp.mcdata-payload\nRequired parameters:\nNone\nOptional parameters:\nNone\nEncoding considerations:\nbinary.\nSecurity considerations:\nGeneral mechanisms for privacy and integrity protection of protocol parameters exist. Those mechanisms as well as authentication and further security mechanisms are described in 3GPP TS 24.229.\nSecurity mechanisms specific to this MIME type are dependent upon the business and trust relationship between the mission critical data communications (MCData) operator and the SIP carrier operator. MCData operators may wish to encrypt and integrity protect the content transported by this MIME type indepedently of mechanisms provided by the transport layer. Such mechanisms are being specified in Rel-14 by 3GPP SA3. Security mechanisms applied to MCData payload are end-to-end (UE to UE).\nThe information transported in this media type does not include active or executable content.\nThis media type does not include provisions for directives that institute actions on a recipient's files or other resources.\nThis media type does not include provisions for directives that institute actions that, while not directly harmful to the recipient, may result in disclosure of information that either facilitates a subsequent attack or else violates a recipient's privacy in any way.\nThis media type does not employ compression.\nInteroperability considerations:\nThe content transported within MIME type does not need to be interpreted by a server. It represents the payload that is delivered to the end-user or an application of the end-user. Each UE and server that handles the content transported using this MIME type shall understand the definition of the messages and protocol elements as defined in 3GPP TS 24.282. Any messages and protocol elements not defined by 3GPP TS 24.282 shall be ignored by the recipient UE or server.\nPublished specification:\n3GPP TS 24.282 \"Mission Critical Data (MCData) signalling control; Protocol specification\" available via http://www.3gpp.org/specs/numbering.htm.\nApplication Usage:\nApplications supporting the mission critical data communications procedures as described in the published specification. This MIME type shall contain data that is delivered to a terminating user or an application of the terminating user.\nFragment identifier considerations:\nNone.\nRestrictions on usage:\nNone\nProvisional registration? (standards tree only):\nN/A\nAdditional information:\n1.\tDeprecated alias names for this type: none\n2.\tMagic number(s): none\n3.\tFile extension(s): none\n4.\tMacintosh File Type Code(s): none\n5.\tObject Identifier(s) or OID(s): none\nIntended usage:\nCommon\nPerson to contact for further information:\n-\tName: <MCC name>\n-\tEmail: <MCC email address>\n-\tAuthor/Change controller:\ni)\tAuthor: 3GPP CT1 Working Group/3GPP_TSG_CT_WG1@LIST.ETSI.ORG\nii)\tChange controller: <MCC name>/<MCC email address>\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "F.1\tGeneral",
            "description": "The following tables give a brief description of the timers used in the present document.\nFor the on-network timers described in the present document, the following timer families are used:\n-\tTDPx: Timer Data Participating function x; and\n-\tTDCy: Timer Data Controlling function y.\nFor the off-network timers described in the present document, the following timer families are used:\n-\tTFSz: Timer oFf-network SDS z;\nwhere x, y and z represent numbers.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "F.2\tOn-network timers",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "F.2.1\tTimers in the participating MCData function",
                    "description": "",
                    "summary": "",
                    "text_content": "Table F.2.1-1: Participating MCData function timers\n\n",
                    "tables": [
                        {
                            "description": "Table F.2.1-1: Participating MCData function timers",
                            "table number": 76,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "F.2.2\tTimers in the controlling MCData function",
                    "description": "",
                    "summary": "",
                    "text_content": "Table F.2.2-1: Controlling MCData function timers\n\n",
                    "tables": [
                        {
                            "description": "Table F.2.2-1: Controlling MCData function timers",
                            "table number": 77,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "F.2.3\tTimers in the MCData UE",
                    "description": "",
                    "summary": "",
                    "text_content": "Table F.2.3-1: MCData UE timers\n\n",
                    "tables": [
                        {
                            "description": "Table F.2.3-1: MCData UE timers",
                            "table number": 78,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "F.3\tOff-network timers",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "F.3.1\tTimers in off-network SDS",
                    "description": "",
                    "summary": "",
                    "text_content": "The table F.3.1-1 lists the timers used in off-network SDS, their start values, their limits, describes the cause of the start, and the action to take on normal stop and on expiry.\nTable F.3.1-1: Timers in off-network SDS\n\n",
                    "tables": [
                        {
                            "description": "Table F.3.1-1: Timers in off-network SDS",
                            "table number": 79,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "F.3.2\tTimers in off-network emergency alert",
                    "description": "",
                    "summary": "",
                    "text_content": "The table F.3.2-1 lists the timers used in off-network emergency alert, their start values, their limits, describes the cause of start, and the action to take on normal stop and on expiry.\nTable F.3.2-1: Timers in off-network emergency alert\n\n",
                    "tables": [
                        {
                            "description": "Table F.3.2-1: Timers in off-network emergency alert",
                            "table number": 80,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "G.1\tGeneral",
            "description": "The following tables give a brief description of counters and states used in the present document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "G.2\tOn-network counters",
            "description": "None defined.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "G.3\tOff-network counters",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "G.3.1\tCounters in off-network SDS",
                    "description": "",
                    "summary": "",
                    "text_content": "The table G.3.1-1 lists the counters used in off-network SDS, their default upper limits and the action to take upon reaching the upper limit. The counters start at 1.\nTable G.3.1-1: Counters in off-network SDS\n\n",
                    "tables": [
                        {
                            "description": "Table G.3.1-1: Counters in off-network SDS",
                            "table number": 81,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "G.4\tOn-network emergency related states",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "G.4.1\tMCData emergency alert state",
                    "description": "",
                    "summary": "",
                    "text_content": "Table G.4.1-1 provides the semantics of the MCData emergency alert (MDEA) state values. This is an internal state of the MCData client and is managed by the MCData client. These state values aid in the managing of the information elements of MCData emergency alerts and their cancellations.\nTable G.4.1-1: MCData emergency alert state\n\n",
                    "tables": [
                        {
                            "description": "Table G.4.1-1: MCData emergency alert state",
                            "table number": 82,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.4.2\tMCData emergency state",
                    "description": "",
                    "summary": "",
                    "text_content": "The MCData emergency state is managed by the MCData client and MCData user. High-level characteristics of this state are captured in table G.4.2-1.\nTable G.4.2-1: MCData emergency state\n\n",
                    "tables": [
                        {
                            "description": "Table G.4.2-1: MCData emergency state",
                            "table number": 83,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.4.3\tIn-progress emergency group state",
                    "description": "",
                    "summary": "",
                    "text_content": "This state conforms with TS 23.282 [2]. It is managed by the controlling MCData function. High-level characteristics of this state are captured in table G.4.3-1.\nTable G.4.3-1: in-progress emergency group state\n\n",
                    "tables": [
                        {
                            "description": "Table G.4.3-1: in-progress emergency group state",
                            "table number": 84,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.4.4\tMCData emergency group state",
                    "description": "",
                    "summary": "",
                    "text_content": "The MCData emergency group state is the MCData client's perspective of the in-progress emergency group state which is managed by the controlling MCData function. The MCData emergency group (MDEG) state is managed by the MCData client to enable the requesting of MCData emergency-level priority as early as possible in the origination of an MCData emergency group communication. High-level characteristics of this state are captured in table G.4.4-1.\nTable G.4.4-1: MCData emergency group state\n\n",
                    "tables": [
                        {
                            "description": "Table G.4.4-1: MCData emergency group state",
                            "table number": 85,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.4.5\tMCData emergency group communication state",
                    "description": "",
                    "summary": "",
                    "text_content": "Table G.4.5-1 provides the semantics of the MCData emergency group communication (MDEGC) state values. This is an internal state of the MCData client and is managed by the MCData client. This state variable aids in the managing of the information elements of MCData emergency group communications and MCData emergency alerts and their cancellations.\nTable G.4.5-1: MCData emergency group communication state\n\n",
                    "tables": [
                        {
                            "description": "Table G.4.5-1: MCData emergency group communication state",
                            "table number": 86,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.4.6\tIn-progress imminent peril group state",
                    "description": "",
                    "summary": "",
                    "text_content": "This state is managed by the controlling MCData function. High-level characteristics of this state are captured in table G.4.6-1.\nTable G.4.6-1: in-progress imminent peril group state\n\n",
                    "tables": [
                        {
                            "description": "Table G.4.6-1: in-progress imminent peril group state",
                            "table number": 87,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.4.7\tMCData imminent peril group state",
                    "description": "",
                    "summary": "",
                    "text_content": "The MCData imminent peril group state is the MCData client's perspective of the in-progress imminent peril group state which is managed by the controlling MCData function. The MCData imminent peril group (MDIG) state is managed by the MCData client to enable the requesting of MCData imminent peril-level priority as early as possible in the origination of an MCData imminent peril group communication. High-level characteristics of this state are captured in table G.4.7-1.\nTable G.4.7-1: MCData imminent peril group state\n\n",
                    "tables": [
                        {
                            "description": "Table G.4.7-1: MCData imminent peril group state",
                            "table number": 88,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.4.8\tMCData imminent peril group communication state",
                    "description": "",
                    "summary": "",
                    "text_content": "Table G.4.8-1 provides the semantics of the MCData imminent peril group communication (MDIGC) state values. This internal state of the MCData client and is managed by the MCData client. These states aid in the managing of the information elements of MCData imminent peril group communications and their cancellations.\nTable G.4.8-1: MCData imminent peril group communication state\n\n",
                    "tables": [
                        {
                            "description": "Table G.4.8-1: MCData imminent peril group communication state",
                            "table number": 89,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.4.9\tIn-progress emergency private communication state",
                    "description": "",
                    "summary": "",
                    "text_content": "This state is managed by the controlling MCData function. All private communications originated between an initiator and the target MCData user when they are in an in-progress emergency private communication state are MCData emergency private communications until this state is cancelled, whether or not the originator of the private communication is in an MCData emergency state.\nTable G.4.9-1: in-progress emergency private communication state\n\n",
                    "tables": [
                        {
                            "description": "Table G.4.9-1: in-progress emergency private communication state",
                            "table number": 90,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.4.10\tMCData emergency private priority state",
                    "description": "",
                    "summary": "",
                    "text_content": "The MCData emergency private priority state is the MCData client's perspective of the in-progress emergency private communication state which is managed by the controlling MCData function. The MCData emergency private priority (MDEPP) state is managed by the MCData client to enable the requesting of MCData emergency-level priority as early as possible in the origination of an MCData emergency private communication. High-level characteristics of this state are captured in table G.4.10-1.\nTable G.4.10-1: MCData emergency private priority state\n\n",
                    "tables": [
                        {
                            "description": "Table G.4.10-1: MCData emergency private priority state",
                            "table number": 91,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.4.11\tMCData emergency private communication state",
                    "description": "",
                    "summary": "",
                    "text_content": "Table G.4.11-1 provides the semantics of the MCData emergency private communication (MDEPC) state values. This is an internal state of the MCData client and is managed by the MCData client. This state aids in the managing of the information elements of MCData emergency private communications and MCData emergency alerts and their cancellations.\nTable G.4.11-1: MCData emergency private communication state\n\n",
                    "tables": [
                        {
                            "description": "Table G.4.11-1: MCData emergency private communication state",
                            "table number": 92,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.4.12\tMCData private emergency alert state",
                    "description": "",
                    "summary": "",
                    "text_content": "Table G.4.12-1 provides the semantics of the MCData private emergency alert (MDPEA) state values. This is an internal state of the MCData client and is managed by the MCData client. These states aid in the managing of the information elements of MCData emergency private communications and MCData emergency alerts and their cancellations. MCData private emergency alerts are targeted to an MCData user.\nTable G.4.12-1: MCData private emergency alert state\n\n",
                    "tables": [
                        {
                            "description": "Table G.4.12-1: MCData private emergency alert state",
                            "table number": 93,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "H.1\tInfo package for indication of communication release",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "H.1.1\tScope",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause contains the information required for the IANA registration of info package g.3gpp.mcdata-com-release in accordance with IETF RFC 6086.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "H.1.2\tg.3gpp.mcdata-com-release info package",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "H.1.2.1\tOverall description",
                            "text_content": "When one of the communication release conditions are met e.g. lack of bearer capacity, limit for the maximum amount of data or time that a participant transmits from a single request to transmit exceeded, the MCData server may decide to release communication. Based on local policy and configuration, MCData server can release the communication without prior notification to MCData user; or it may send a notification to MCData user and allow the user to request for extension if the MCData user wants to. With this notification, MCData server may also request for more information related to ongoing communication like amount of data remainnig to be transmitted. If MCData user requests for extension of the MCData communication, MCData server can accept or reject based on local policy.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "H.1.2.2\tApplicability",
                            "text_content": "This package is used to:\n-\tsend MCData server's intent to release the communication to the MCData client\n-\tsend more data from MCData client to MCData server when requested\n-\trequest extension of the MCData communication to MCData server.\n-\tsend response for extension request from MCData server to MCData client.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "H.1.2.3\tAppropriateness of INFO Package Usage",
                            "text_content": "A number of solutions were discussed for sending MCData server's intent to release the communication along with request for more data to MCData user. The solutions were:\n1)\tUse of the session related methods (e.g. SIP RE-INVITE 200 (OK) response.\n2)\tUse of the SIP INFO method as described in IETF RFC 6086, by defining a new info package.\nThe result of the evaluation of the above solutions were:\n1)\tAn SIP INVITE request will have three-way handshake, which may not be optimal to transfer the required data.\n2)\tThe use of SIP INFO request was found as the most appropriate solution since the SIP INFO request could be sent in the existing SIP session and can carry QUERY response in 200 OK.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "H.1.2.4\tInfo package name",
                            "text_content": "g.3gpp.mcdata-com-release\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "H.1.2.5\tInfo package parameters",
                            "text_content": "None defined\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "H.1.2.6\tSIP options tags",
                            "text_content": "None defined\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "H.1.2.7\tINFO message body parts",
                            "text_content": "The MIME type of the message body carrying application/vnd.3gpp.mcdata-signalling and application/vnd.3gpp.mcdata-payload. Both application/vnd.3gpp.mcdata-signalling and application/vnd.3gpp.mcdata-payload MIME type is defined in this specification.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "H.1.2.8\tInfo package usage restrictions",
                            "text_content": "None defined.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "H.1.2.9\tRate of INFO Requests",
                            "text_content": "Single INFO request generated after MCData server decides to release communication with prior notification to MCData client and not requesting for more data.\nTwo INFO requests generated after MCData server decides to release communication with prior notification to MCData client and requesting more data.\nTwo INFO requests generated after MCData client requests for extension of communication.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "H.1.2.10\tInfo package security considerations",
                            "text_content": "The security is based on the generic security mechanism provided for the underlying SIP signalling. No additional security mechanism is defined.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "H.1.2.11\tImplementation details and examples",
                            "text_content": "UAC generation of INFO requests: See 3GPP TS 24.282: \"Mission Critical Data (MCData) signalling control; Protocol specification\".\nUAS processing of INFO requests: See 3GPP TS 24.282: \"Mission Critical Data (MCData) signalling control; Protocol specification\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "I.1\tGeneral",
            "description": "The present document applies to both EPS and 5GS. This annex lists the aspects of MCData session control protocols which are different in 5GS from EPS. Certain aspects that are only applicable to EPS are described in clause I.2. A mapping of EPS-specific terms to their 5GS equivalents is provided in clause I.3.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "I.3\tMapping of EPS-specific terms to 5GS",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "I.3.1\tSession aspects",
                    "description": "",
                    "summary": "",
                    "text_content": "In 5GS, the PDU session is the equivalent of a PDN connection in EPS. The requirements and configurations for a PDN connection throughout this document shall also apply to PDU sessions.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "I.3.2\tBearer aspects",
                    "description": "",
                    "summary": "",
                    "text_content": "When using the 5GS, a bearer is provided by a 5GS QoS flow. The requirements, procedures, and configurations for a bearer throughout this document, including those stating EPS explicitly (e.g., EPS bearer priority), shall also apply to QoS flows.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "I.3.3\tResource sharing",
                    "description": "",
                    "summary": "",
                    "text_content": "In 5GS, the exchange of the QoS characteristics of the required resources takes place by means of direct interaction between SIP core and PCF using N5 reference point or Rx reference point or indirectly utilizing N33 reference point between MC service server and NEF. Thus, the requirements for resource sharing of clause 18 apply with the following clarifications:\n1)\tto control resource sharing, interfacing to PCF is using the N5 reference point or the Rx reference point;\n2)\toptionally, QoS characteristics for resources can be exchanged indirectly utilizing N33 reference point between the MC service server and NEF.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "I.3.4\tMapping of MBMS terms to MBS",
                    "description": "",
                    "summary": "",
                    "text_content": "In the EPS, using the MBMS procedures, in the 5GS or eMBMS and 5G MBS co- existence, using the MBS procedures;\n-\tin the MBS procedures, references to 4G \"MBMS\" is understood to be references to 5G \"MBS\";\n-\tin the MBS procedures, references to 4G \"TMGI\" is understood to be references to 5G \"MBS session ID\";\n-\tin the MBS procedures, references to 4G \"application/vnd.3gpp.mcptt-mbms-usage-info+xml\" is understood to be references to 5G \"application/vnd.3gpp.mcptt-mbs-usage-info+xml\";\n-\tin the MBS procedures, references to 4G \"MBMS suspension\" corresponds to 5G \"MBS session de-announcement\"; and\n-\tin the MBS procedures, \"Map Group To Session Stream\" corresponds to the \"Map Group To Bearer\" in eMBMS, as specified in 3GPP TS 23.289 [85].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "I.3.5\tMapping of ProSe terms to 5G ProSe",
                    "description": "",
                    "summary": "",
                    "text_content": "The procedures defined in this specification are reused for off-network communication and on-network communication (i.e. UE-to-network relay) for MCData service over 5G ProSe with the following differences:\n-\tProSe direct discovery for public safety shall be replaced with 5G ProSe direct discovery, as specified in 3GPP TS 24.554 [86].\n-\tProSe direct communication shall be replaced with 5G ProSe direct communication, as specified in 3GPP TS 24.554 [86].\n-\tProSe UE-to-network relay shall be replaced with 5G ProSe UE-to-network relay, as specified in 3GPP TS 24.554 [86].\n-\tPPPP (ProSe Per-Packet Priority) shall be replaced with PQI, as specified in 3GPP TS 24.554 [86].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "I.2\tAspects not applicable to 5GS",
            "description": "The following aspects of EPS mentioned in the present document are not applicable to 5GS:\n-\tProximity-services (ProSe) and the corresponding procedures are replaced by 5G ProSe and the corresponding procedures in 5GS; and\n-\tMultimedia Broadcast and Multicast Service (MBMS) and the corresponding procedures.\n\n\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "",
                    "table number": 94,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "",
                    "table number": 95,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        }
    ]
}