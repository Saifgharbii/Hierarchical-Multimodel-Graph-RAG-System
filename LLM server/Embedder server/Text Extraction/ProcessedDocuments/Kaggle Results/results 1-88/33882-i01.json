{
    "document_name": "33882-i01.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Report has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\t\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\t\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\t\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\t\tindicates that something is possible\ncannot\t\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\t\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\t\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document studies how 5G security architecture and procedures can be enhanced to support Personal IoT Network. The aim of the present document is to study the security aspects of Personal IoT Networks for any potential enhancements in alignment with the outcome of SA2 study in TR 23.700-88 [2]. The study will look at the following aspects, performing gap analysis where necessary:\n1)\tStudy potential security enhancements for authentications required to secure Personal IoT Networks.\n2)\tStudy the security protection and access control for communications required to secure Personal IoT Networks.\n3)\tStudy the security enhancements for privacy required to secure Personal IoT Networks.\n4)\tOther security aspects for any potential enhancements in alignment with the outcome of SA2 study in TR 23.700-88 [2].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TR 23.700-88: \"Study on Personal IoT Networks\".\n[3]\t3GPP TS 33.501: \"Security architecture and procedures for 5G system\".\n[4]\tConnectivity Security Alliance: \"Matter Specification Version 1.0\".\n[5]\t3GPP TS 23.502:\"Procedures for the 5G System (5GS)\".\n[6]\t3GPP TS 23.503:\" Policy and charging control framework for the 5G System (5GS); Stage 2\".\n[7]\t3GPP TS 33.535: \"Authentication and Key Management for Applications (AKMA) based on 3GPP credentials in the 5G System (5GS)\".\n[8]\t3GPP TS 23.501: \"System architecture for the 5G System (5GS)\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in TR 21.905 [1], TR 23.700-88 [2], and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in TR 21.905 [1].\nFor the purposes of the present document, the following terms and definitions given in TR 23.700-88 [2] apply:\nPersonal IoT Network: A configured and managed group of PIN Element that are able to communicate each other directly or via PIN Elements with Gateway Capability (PEGC), communicate with 5G network via at least one PEGC, and managed by at least one PIN Element with Management Capability (PEMC).\nPIN Element: A UE or non-3GPP device that can communicate within a PIN (via PIN direct connection, via PEGC, or via PEGC and 5GC), or outside the PIN via a PEGC and 5GC.\nPIN Element with Gateway Capability: A PIN Element with the ability to provide connectivity to and from the 5G network for other PIN Elements, or to provide relay for the communication between PIN Elements.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in TR 21.905 [1], TR 23.700-88 [2], and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905 [1].\nEAP\tExtensible Authentication Protocol\nMSK\tMaster Session Key\nPIN\tPersonal IoT Networks\nPINE\tPIN Element\nPEGC\tPIN Elements with Gateway Capability\nPSP\tPIN Service Provider\nAF\t\tApplication Function\nAPI\tApplication Programming Interface\nDN\tData Network\nNEF\tNetwork Exposure Function\nQoS\tQuality of Service\nURSP\tUE Route Selection Policy\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tAssumptions",
            "description": "If sidelink is used for the direct communication between PEMC and PEGC, reuse security procedures defined for 5G ProSe Direct Communication without introducing new features to sidelink.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "5\tKey issues",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tKey Issue #1: Authentication and authorization for PINE",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.1.1\tKey issue details",
                            "text_content": "A key aspect of the planned support of the 5G system for PIN is the ability of a UE (referred to as PEGC) to act as a gateway for PIN elements (PINEs), which are not acting as 5G UEs, to connect to 5GC.\nAccording to TR 23.700-88 [2], a PINE without 3GPP capability cannot directly connect to the 5GC, but through the PEGC. Whether the PINE without 3GPP capability needs to be known by the 5GC and how to identify the PINE needs to be studied, e.g., for controlling access of the PINE to connecting 5G data networks, differentiating the PINE for policy provisioning, authorizing the PINE for traffic relay, etc.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.2\tSecurity threats",
                            "text_content": "5GS supports the policy and QoS differentiation for the traffic between a PINE and 5GS. The network resource may be misused by the malicious, unauthenticated, and unauthorized PINE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.3\tPotential security requirements",
                            "text_content": "The PINE in a Personal IoT network shall be authenticated.\nThe PINE in a Personal IoT network shall be authorized.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.2\tKey Issue #2: Authorization of PIN capabilities",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tKey issue details",
                            "text_content": "Some aspects of a PIN network might be configurable by an Application Function through the 5G NEF, for instance (depending on details defined in the SA3 study on PIN [2]) QoS of a PIN Element or URSP rules related to a PIN Element.\nFrom a security point of view the scope of access granted to an AF needs to be restricted to the level of certain PEGCs or PINs and needs to be subject to permissions and consent granted by resource owners.\nSo far TS 33.501 [3] defines authorization of exposure capabilities on a rather general level in Clause 12. That is, authorization is based on operator policies using the identity of the AF (clause 12.2 in TS 33.501 [3]) as well as the OAuth authorization mechanism (Clause 12.4 in TS 33.501 [3]). No details about handling of permissions or providing consent to a specific application function are defined.\nIn case of PIN the requirements for API security might be especially demanding, since on the one hand a PIN network might consist of several UEs and on the other hand a single UE might contribute to several PINs.\nTherefore, aspects related to ownership and possible operation models of PINs need to be included in the analysis of the key issue.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tSecurity threats",
                            "text_content": "An application function associated with one PIN might use the NEF API to manipulate another PIN.\nAn application function associated with a PIN might use the NEF API to manipulate resources not assigned to the PIN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.3\tPotential security requirements",
                            "text_content": "The 5GS shall be able to restrict resource request from an Application Function associated with a PIN to the resources associated with the PIN.\nApplication functions associated with a PIN shall be able to use APIs for accessing resource only with authorization from the resource owner.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tProposed solutions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.1\tMapping of solutions to key issues",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 6.1-1: Mapping of solutions to key issues\n\n",
                    "tables": [
                        {
                            "description": "Table 6.1-1: Mapping of solutions to key issues",
                            "table number": 3,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.2\tSolution #1: PINE authentication and authorization",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tIntroduction",
                            "text_content": "This solution addresses the requirement in KI#1 on authentication and authorization for PINE.\nThis solution provides a method to ensure that the PINE can be authenticated and authorized by an AF before the connectivity for PINE is enabled. The authentication may be triggered by the SMF during the PDU session modification procedure. The authorization is performed based on authentication results.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tSolution details",
                            "text_content": "Figure 6.2.2-1 illustrates the call flow of authentication and authorization for PINE, detailing the process of verifying user identity and granting access rights within a network. The figure showcases the interaction between the user equipment (UE), the network element (NE), and the authentication and authorization server (A&AS). The UE initiates the process by sending an authentication request to the NE, which then forwards the data to the A&AS for verification. Upon successful authentication, the A&AS sends an authorization message back to the NE, which in turn communicates with the UE. This flow ensures secure and controlled network access, protecting sensitive data and maintaining network integrity.\nFigure 6.2.2-1: call flow of authentication and authorization for PINE\nAs show in the Figure 6.2.2-1, the details of authentication and authorization for PINE is summarized as following:\n1. PEGC registers to the 5GS and joins into the PIN.\n2. A PINE requests to access the PEGC for traffic relay to 5GS.\n3. The PEGC initiates PDU Session modification procedure with the PINE information sent to the SMF via NAS signalling. PINE information includes at least PINE ID. The criteria for triggering PDU Session modification request can be based on existing mechanism or implementation.\n4. The SMF determines whether authentication is required for the PINE with PINE information. Authentication for PINE is only be triggered if the PEGC has provided PINE ID. The SMF triggers the authentication procedure and send a message to AF via NEF. The authentication messages are included in a transparent container and conveyed between the PINE and the AF via 5GC. AF provides authentication result to SMF. In this case, authorization is performed based on authentication results.\nNOTE:\tMultiple round-trip messages may be needed as required by the authentication method used by the AF. The EAP method used to authenticate the UE and the content of Authentication Messages to support that method are out of scope of 3GPP.\n5. The SMF updates the PCF with the PINE information in SM Policy Association Modification if PINE is authorized.\n6. The QoS flow for the PINE communication with 5GS is established via PDU session modification procedure.\n7. The PEGC sends a response to the PINE.\n8. The application traffic of the PINE is relayed to the AF via the PEGC and 5GS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tEvaluation",
                            "text_content": "This solution addresses the requirement in KI#1 on authentication and authorization for PINE.\nIn 5GC, SMF determines to trigger the authentication procedure during the PDU session modification procedure. The authorization is performed based on authentication results. Therefore, the solution has impact on 5GC.\nThe authentication messages are included in a transparent container and conveyed between the PINE and the AF via 5GC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tSolution #2: PINE authentication by AAA over 5G CP",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tIntroduction",
                            "text_content": "This solution addresses the KI#1 \"Authentication and authorization for PINE\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tSolution details",
                            "text_content": "The procedure describes how 5GC supports the PINE authentication and authorization by AAA over control plane.\nFigure 6.3.2-1 illustrates the process of PINE authentication by AAA over 5G Core (CP). The figure depicts the interaction between the Authentication, Authorization, and Accounting (AAA) server and the 5G Core network. The AAA server is responsible for validating user credentials and granting access to the network resources. The 5G Core network, represented by the central box, handles the core functions of the network, including packet data network (PDN) control, user plane function (UPF), and subscriber identity module (SIM) management. The figure highlights the secure and efficient authentication process that ensures only authorized users can access the network.\nFigure 6.3.2-1: PINE authentication by AAA over 5G CP\n1.\tThe PINE initially connects to the PEGC, the PEGC indicates to the PEMC of the connection. The PEMC authorizes the PINE connecting to the PEGC based on local configuration, e.g., whether a device with the MAC address is allowed to connect to the PEGC. If success, the PEMC indicates the PEGC that the PINE needs authentication and authorization based on local configuration, e.g., whether the device is a sensitive property and is able to be authenticated.\n2.\t[Optional] The PINE may disconnect the PEGC and sometime reconnect the PEGC again. In this case, if the PEGC still holds the configuration of the PINE, the PEGC may not indicates to the PEMC for authorization, this can avoid to frequently disturb the PEMC, or the PINE can still access the PIN when PEMC is not reachable.\n3.\tWhen the PINE accessing the PIN requests PINE authentication with external DN-AAA, e.g., the PINE is preconfigured with credential and sends indication to PEGC, the PEGC sends PDU Session Establishment/Modification Request with a flag for PINE authentication to the SMF corresponding to the PDU Session related to the PIN. The PDU Session Establishment/Modification Request may include the PINE ID. If the PDU Session associated with the PIN has been established, PDU Session Modification Request is used, otherwise PDU Session Establishment Request is used.\nThe SMF performs following steps 4-9 based on whether the flag for PINE authentication is received or not.\n4.\tThe SMF may request identity from PINE using EAP messages over NAS same as described in steps 9-10 of clause 11.1.2 in TS 23.501 [8], the PEGC and PINE uses PIN Auth message for encapsulating the EAP messages transferred between the SMF and the PINE.\n5.\tThe SMF determines whether the external DN-AAA (derived from PINE ID) is allowed to perform PINE authentication, which may be per PIN and the configuration of allowed/disallowed external DN-AAA is out of scope. If allowed, the SMF sends the PINE ID to the external DN-AAA via UPF, e.g., using RADIUS protocol or Diameter protocol, then the external DN-AAA and the PINE exchange EAP messages via the SMF, UPF, and the PEGC same as described in steps 11-13 of clause 11.1.2 in TS 33.501 [3] with following difference:\n-\tThe PEGC exchanges the EAP messages with the PINE over PIN Auth message.\n6.\tIf the PINE authentication succeeds, the same as described in steps 14 of clause 11.1.2 in TS 33.501 [3] is performed with the following difference:\n-\tThe DN authorization data described in clause 5.6.6 of TS 23.501 [8] only include a DN Authorization Profile Index.\n7.\tThe SMF sends PDU Session Establishment Ack or PDU Session Modification Ack/Reject to the PEGC based on the result of the PINE authentication. If EAP-failure is received from the external DN-AAA, the SMF sends a cause value to the PEGC to indicate the failure of PINE authentication.\n8.\tIf PINE authentication succeeds, the PEGC allows the PINE connecting to the PEGC for accessing the PIN, and sends PIN message (PIN ID, EAP Success) to the PINE. The PIN ID is determined based on information configured by PEMC, which is out of 3GPP scope.\nIf PINE authentication fails, the PEGC closes the connection with the PINE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.3\tEvaluation",
                            "text_content": "This solution is suitable for the case that PINE is preconfigured with credential that is able to be authenticated by external DN-AAA.\nThis solution does not require that the PEGC acts as authenticator, i.e., the SMF acts as authenticator, and does not require 5G UP resources for PINE authentication.\nThis solution requires SMF to support triggering secondary authentication and authorization during PDU Session Establishment and UE initiated PDU Session Modification procedure.\nThis solution requires SMF to authorize which AAA is allowed or disallowed to authenticate PINE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tSolution #3: Authentication for PIN elements involving SMF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4.1\tIntroduction",
                            "text_content": "This solution addresses the authentication of PIN elements as described in KI#1 by utilizing a procedure similar to Data Network specific secondary authentication.\nIn case of Data Network specific secondary authentication as currently defined in TS 33.501 [3] a UE is authenticating itself towards an external AAA server to obtain access to a specific Data Network.\nThis concept is extended in the proposed solution to the case of PIN networks.\nThe AAA server and the Data Network are typically operated by the same third party referred to as PIN Service Provider (PSP). The PECG is relaying EAP messages to and from a PINE.\nIf several PINs are using the same AAA server, potential attacks result from the circumstance that the PEGC, which is relaying EAP messages between EAP client (PINE), and EAP authenticator (SMF) and PINE might belong to different entities. An attacker might deploy a potentially malicious PEGC with aim to connect a victims' PINEs to this PEGC. Alternatively, an attacker might try to connect potentially malicious PINEs to a victim's PEGC. These attacks are possible, if the AAA server can not verify that PINE and PEGC are both authorized to be part of a PIN.\nTherefore, this solution introduces an authorization code, which is used by the AAA server to authorize PEGCs together with a PINE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.2\tSolution details",
                            "text_content": "Figure 6.4.2-1 shows the procedure for authentication of a PINE.\nFigure 6 illustrates the authentication procedure for PINE (Protocol Independent Sub-Layer Encapsulation) using DN (Device Name) specific secondary authentication. The figure depicts the process flow, starting with the user equipment (UE) sending a PINE message to the network element. The message is then passed through various network nodes, including the authentication server, which verifies the user's identity using DN-specific secondary authentication. This process ensures secure communication and prevents unauthorized access to the network.\nFigure 6.4.2-1: Authentication procedure for PINE using DN specific secondary authentication\nPINE acts as an EAP client, SMF acts as an EAP Authenticator and PSP DN-AAA server acts as an EAP server.\nThe individual steps are described below.\nPINE requesting connectivity via PEGC/UE:\nStep 1a. When a PINE wants to connect to the PSP (PIN application Service Provider) Data Network, PINE request for connection towards PEGC/UE.\nStep 1b. If the PEGC/UE is not yet registered with the 5GS, it performs primary authentication using PEGC/UE USIM credentials.\nStep 1c. The PEGC/UE request for PDU session establishment towards the PSP DN via 5GS.\nStep 1d. The SMF obtains the subscription information from the UDM and verifies if the PEGC/UE request for PSP DN is allowed or not.\nStep 1e. If the PEGC/UE is allowed to connect to the requested PSP DN, then SMF initiates the EAP authentication.\nSecondary Authentication between PINE and PSP DN:\nStep 2a. The SMF request for EAP identity towards PINE and PINE responds with EAP identity response. The PEGC/UE will start relaying the messages to/from PINE and SMF.\nStep 2b. If there is no existing N4 session, SMF selects a UPF and establishes a N4 Session with the selected UPF.\nStep 2c. The SMF forwards the EAP-Response with identity (received from PINE) towards PSP DN-AAA server.\nThe request contains the identity of the PEGC and a PECG specific authorization code. The authorization code is a secret, which is pre-shared between the 5GS and the AAA server in an initial configuration step.\nStep 2d. Further EAP message exchanges between PINE and DN-AAA server of PSP.\nStep 2e. The PSP DN-AAA server verifies if the PINE is authorized or not.\nThe authorization step includes the verification of the PEGC identity and the authorization code. That is, the AAA-server verifies that the authorization code configured for the PECG is identical to the authorization code received in step 2c.\nStep 2f. Depending upon the verification, the EAP-Success / EAP-Failure message is sent to the SMF.\nThe identity of the PINE is provided by the AAA server to the SMF together with the EAP-Success message.\nStep 2g. This completes the EAP authentication procedure for the PINE at the SMF.\nStep 2h. Rest of the procedures for PDU establishment is executed as described in TS 33.501 [3] figure 11.1.2-1 step 16a to step 18.\nStep 2i. The PDU session establishment accept message is sent with EAP-Success towards PEGC/UE.\nStep 2j. The communication between PINE and PSP application server can take place.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.3\tEvaluation",
                            "text_content": "This solution proposes combining PINE authentication and authorization with PDU session management. In this way, the authentication and authorization can happen outside of the 5G core (i.e., executed by a central external AAA server), but the5G system can be aware of each individual authentication and authorization decision and of the identity of the authenticated PINE.\nThe solution also consists of a mechanism based on authorization code, which prevents potential attacks stemming from the fact that a PEGC and PINE might be operated by different entities.\nTR 23.700-88 [2] has concluded not to specify the PINE authentication and authorization.\nWhether PDU Session Establishment or PDU Session Modification messages are used and potential modifications to SMF can be aligned with SA2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tSolution #4: PEGC/PEMC and PINE Authentication and Authorization",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tIntroduction",
                            "text_content": "This solution addresses KI#1 and proposes two procedures:\n-\tThe first procedure aims at authenticating/authorizing a PEGC/PEMC to manage or act as a gateway in a PIN,\n-\tThe second procedure aims at authenticating/authorizing a PINE to make use of the PIN resources.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tSolution details",
                            "text_content": "Figure 6 illustrates the process of authentication and authorization in a network, focusing on the Point of Presence (PoP) elements such as the PE (Provider Edge) Gateway (PEG), P (Provider) Edge Network (PEN) Core (PEC), and the P (Provider) Network Edge (PNE). The diagram highlights the use of PEG and PEC for authentication and authorization, with the PEG being responsible for the initial authentication and the PEC for the final authorization. The PINE (Provider Interconnect Edge Network) is depicted as a crucial component in the process, ensuring secure communication between the network and its users. The figure emphasizes the importance of these elements in maintaining the integrity and security of network communications.\nFigure 6.5.2.1-1: PEGC/PEMC and PINE Authentication and Authorization\nFigure 6.5.2.1-1 depicts the main steps of this solution that can be divided into two main procedures: (1) PEGC/PEMC authentication and/or authorization procedure and (2) PINE authentication and/or authorization procedure\nIn reference to Figure 6.5.2.1-1:\n-\tIn Step 1, primary authentication is performed between UE and CN where the UE aims at becoming a PEGC and/or a PEMC in a PIN;\n-\tIn Step 2, the UE (or an application on it) requests PIN access to the CN or to an AF through the CN. This may be through AKMA (TS 33.535 [7]).\n-\tIn Step 3, the UE and AF perform an authentication and authorization step. This step may be based on the AKMA keys distributed in Step 2.\n-\tIn Step 4a, the AF informs the CN about the outcome of Step 3 and provides the CN with a configuration. This configuration includes information about: PIN, PIN elements, communication requirements such as QoS, allowed interactions between PINE, etc. This is a required configuration to fulfil the PINE authentication and authorization requirement to guarantee, e.g., a certain QoS to a certain PINE. In Step 4b, the CN stores the configuration, e.g., in the UDR.\n-\tIn Step 5a, the CN informs the UE about the outcome of Step 4 and provides the UE with a configuration. This configuration (provisioned information) includes information about: PIN, PIN elements, communication requirements such as QoS, allowed interactions between PINE, etc. This configuration includes rules to enable an authentication and authorization procedure for a PINE (e.g., as required in Step 7c). This configuration may include one or more \"authorization values\" for one or more PINEs. In Step 5b, the UE stores this configuration.\nNOTE:\tWith \"authorization values\" it is meant some type of authorization tokens that can be used to authenticate/authorize the access to the PIN during operation. For instance, the authorization values might be used by PINE/PEGC to protect/verify the traffic. These authorization values may be generated and handled by the AF and provided to the CN/PEGC to ensure that only authorized devices can exchange data.\n-\tIn Step 6, the AF informs the UE about the outcome of Step 4 and provides the UE with a configuration. This configuration received from the AF includes application-related aspects assigned to the PIN by the AF. Parameters such as PIN element identities or allowed interactions between PINEs may also be provided to PEGC/PEMC by the AF, if not supported in Steps 4 and 5. Some parameters may also be entered by the user by means of the UE e.g., password.\nIn reference to Figure 6.4.2.1-1:\n-\tIn Step 7a, the PINE and PEGC/PEMC may setup a secure communication channel, e.g., based on a non 3GPP protocol. In Step 7b, the PINE may send a PIN access request to the PEGC/PEMC. In Step 7c, the PEGC/PEMC may grant either temporary or full access, e.g., based on the provisioned information received in Step 5a. If full access is granted (local authorization), then the PINE communicates as in Step 11. If temporary access is granted, then PINE proceeds to Step 8.\n-\tIn Step 8, PINE and AF perform an end-to-end authentication and authorization step. The details of this procedure are out-of-scope of 3GPP and this procedure is just executed over the 5GS in user plane.\n-\tIn Step 9a, the AF informs the CN about the outcome of Step 8 and provides the CN with a configuration related to the PINE. This configuration may include further information about: PIN, PIN elements, communication requirements such as QoS, allowed interactions, etc. In Step 9b, the CN stores the configuration. In Step 9c, the CN informs the PEGC/PEMC about the outcome of Step 8 and provides the PEGC/PEMC with a configuration for the PINE. In Step 9d, the PEGC/PEMC stores the configuration. This configuration received from the CN may relate to communication parameters assigned to the PINE. Parameters such as PIN element identities or allowed interactions between PINEs may also be provided to PEGC/PEMC by the AF, if not supported in this step. Some parameters may also be entered by the user by means of the UE e.g., password.\n-\tIn Step 10, the PINE and PEGC/PEMC may receive \"authorization values\" from the CN. The PINE may receive it through a secure channel established with the AF. The goal of these \"authorization values\" is to ensure that only authenticated/authorized PINEs can communicate with / through the PEGC/PEMC during operation.\n-\tIn Step 11, data may be exchanged between PINE/PEGC/PEMC authenticated and/or authorized with said \"authorization values\". For instance, the authorization values might be used by PINE to protect the uplink traffic in Step 11a. In Step 11b, the PEGC can verify the incoming traffic from the PINE. If the verification is successful, then the PEGC forwards the traffic further towards the AF in Step 11c. Downlink traffic can be protected in a similar way.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tEvaluation",
                            "text_content": "This solution addresses KI#1 and involves two phases: a first phase to authenticate/authorize the PEGC/PEMC and a second phase to authenticate/authorize a PINE.\nAfter the first phase (authentication/authorization of the PEGC/PEMC), the 5GC and PEGC/PEMC are provided with configuration information to facilitate the second phase.\nThe proposed solution aims at reusing existing procedures and supports performing PINE authentication/authorization either locally or end-to-end (with an AF) at application layer.\n-\tPerforming the end-to-end authentication/authorization over the 5GS has certain impacts such as: Step 7c, providing initial access to perform such end-to-end authentication/authorization.\n-\tStep 9a, informing the 5GS about the result and/or updating provisioned parameters.\n-\tStep 9c, 5GC informing PEGC/PEMC about the result and/or updated provisioned parameters.\nThe provisioning of information, e.g., in Steps 4, 5, and/or 9, are not fully aligned with SA2 conclusions including, e.g.:\n-\tStorage and retrieval of PIN related policy and QoS parameters.\n-\tProvisioning of the policy and parameters to PEGC by 5GC.\nThus, the solution impacts the 5GC\nThis provisioned information is used for local PINE authorization at the PEGC.\nNOTE:\tThe solution may require additional work on security related details. Non-3GPP aspects are outside the scope of the study and normative work.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.6\tSolution #5: EAP-based PINE authentication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tIntroduction",
                            "text_content": "This solution addresses KI #1 in terms of PINE authentication.\nEAP-based authentication mechanisms are employed to enable 5GS to authenticate the PINEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.2\tSolution details",
                            "text_content": "It is also assumed that PIN AS has provisioned the PINE ID, authenticated EAP identity and PINE related policies to the UDR.\nPIN AS can be the AAA server.\nIt is assumed that SMF and PCF are aware of EAP identity of PINE.\nFigure 6.2-1 illustrates the EAP-based PINE authentication process, which involves the use of Extensible Authentication Protocol (EAP) and Protected Internal Network Elements (PINE) for secure access control. The figure showcases the various components involved, including the client, authentication server, and EAP server, as well as the authentication process flow. The visual representation emphasizes the importance of secure and efficient authentication mechanisms in modern network infrastructure.\nFigure 6.6.2-1: EAP-based PINE authentication\n1.\tPDU Session is established for PEGC.\n2.\tApplication layer signalling is exchanged between the PEGC and the PIN AS. A list of PINEs authorized to access the PEGC are provisioned to the PEGC.\n3.\tA PINE requests to access the PEGC for traffic relay to 5GS. The request includes identities of PINE, external AAA server address (optional). The identities of PINE could be EAP identity of PINE or PINE ID of PINE. EAP identity of PINE can contain information about PINE ID, MAC Address, PEI, device ID.\n4.\tThe PEGC authenticates and authorizes the access of the PINE, and allocates IP address for the PINE. This procedure is realized based on non-3GPP access, which is out of scope of 3GPP.\n5.\tPEGC sends PDU Session modification to the SMF. The PEGC sends EAP identity of PINE, address of the external AAA server (optional), PINE ID, IP address and allocated port number of the PINE to SMF via the modification message.\n6-8. The SMF can select the AAA server based on the AAA server address provided by the PINE. The SMF sends the EAP identity of PINE to the external AAA server to trigger EAP-based authentication mechanism. The external AAA server sends the successfully authenticated EAP identity of PINE to the SMF. The SMF terminates the procedure if the authentication is failed.\n9.\tThe SMF updates the PCF with the PINE ID and authenticated EAP identity of PINE in SM Policy Association Modification.\n10.\tThe PCF queries the UDR for PIN Specific Service Parameters PINE ID and authenticated EAP identity, and receives the QoS requirement of the PINE communication.\nThe PCF derives the PCC rules for the PINE according to the QoS requirement received from the UDR and IP address/port number of the PINE from the SMF.\n11.\tThe PDU Session Modification procedures is triggered.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.3\tEvaluation",
                            "text_content": "The SMF can select the AAA server based on the AAA server address provided by the PINE.\nPINE is authenticated by AAA server with EAP-based mechanism.\nThe PCF queries the UDR with authenticated EAP identity, and receives the QoS requirement of the PINE communication.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tSolution #6: Authorization on AF manipulating PIN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.7.1\tIntroduction",
                            "text_content": "This solution addresses the KI#2 \"Authorization of PIN capabilities\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.2\tSolution details",
                            "text_content": "When the AF requests 5GC to setup resources for a PIN via NEF, the NEF assigns a randomized unique ID to the AF, which could be the PIN Session ID, and associates the ID with the AF.\nWhen the AF requests to query, update, or delete the information related to the PIN, the AF provides the NEF assigned ID to the NEF, and the NEF authorizes whether the ID is associated with the AF.\nThe NEF may change the ID and provide the updated ID to the AF when the AF interacts with the NEF.\nThis randomized unique ID is working like a token, which is sent only to the AF which is authorized to manipulate the PIN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.3\tEvaluation",
                            "text_content": "None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.8\tSolution #7: Authentication and Authorization of PINE Elements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tIntroduction",
                            "text_content": "This solution addresses KI#1.\nAs per KI#1, the PIN Elements in a Personal IoT Network need to be authenticated and authorized. According to the conclusions of TR 23.700-88 [2] the PIN Elements are authorized locally by the PEMC, which is a UE belonging to the PIN and having PIN management capability. Furthermore, the PIN Elements are allowed or disallowed to join the network by the PEGC, which is a UE belonging to the PIN and having PIN gateway capability. The PEMC and PEGC are authenticated and authorized as 5G UEs by the 5GC using existing procedures. Application-level authentication and authorization can use existing specifications e.g., CSA Matter [4].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tSolution details",
                            "text_content": "Figure 6.8.2-1 illustrates the PINE (Protocol Independent Sub-Layer Encapsulation) Authentication and Authorization process in a telecommunication network. The figure showcases the interaction between the network elements, including the Authentication Server (AS), Authentication and Authorization Server (AA), and the Network Element (NE). The process involves the NE sending an Authentication Request (AR) to the AS, which then forwards the request to the AA for authentication. Upon successful authentication, the AA sends an Authentication Response (AR) back to the AS, which is then relayed to the NE. This process ensures secure communication and access control within the network.\nFigure 6.8.2-1: PINE Authentication and Authorization\nFigure 6.8.2-1 depicts the main steps of this solution.\nIn reference to Figure 6.8.2-1:\n1)\tAuthentication and authorization are performed between UEs (PEMC and PEGC) and the 5GC using existing 5G UE authentication and authorization procedures.\n2)\tThe AF provisions the policy and other necessary parameters to the 5GC, PEMC and PEGC using application layer provisioning procedures. Step 2 can also be performed prior to step 1.\nNOTE:\tSteps 1 and 2 is not specific to PINE authentication.\n3)\tPIN Element establishes connection to the PEMC and PEGC using the local interface e.g., PC5, WLAN or Bluetooth, and performs authentication with PEMC and PEGC using security mechanisms specific to the local interface. Upon successful authentication with PEMC, PIN Element is authorized by the PEMC to join the PIN. PEMC and PEGC can be either the same or separate UEs.\n4)\tThe actual security mechanism used over the local interface is outside the scope of this solution, as they are defined elsewhere. For example, in case of WLAN, for PINE authentication WPA defined by WFA can be reused, where PINE acts as a supplicant and PEMC or PEGC (depending on with which entity PIN Element establishes the local connection) acts as an authenticator. Depending on the WPA mode (personal/enterprise) an authentication server, local to the PIN, can be used. In particular, the WPA enterprise mode requires an authentication server, while the personal mode does not. The authorization is performed by PEMC or PEGC after successful authentication of PINE based on local authorization policy or configuration. The authentication server can be implemented as a part of the PEMC/PEGC or separately. The choice of authentication method is left to the decision of the PIN owner.\n5)\tAfter being authorized by the PEMC to join the PIN, the PIN Element requests data transfer to the PEGC. This request uses transport and/or application layer messages and is implementation specific.\n6)\t[Optional] The data transfer request from step 4 triggers the establishment of data connection between the PEGC and 5GC. If the data connection already exists and can be reused for PIN traffic, then Step 5 is not needed.\n7)\tThe PEGC accepts/rejects the PIN Element request for data transfer from step 4. Similarly, to step 4, step 6 uses transport and/or application layer messages and is implementation specific.\n8)\tThe PIN Element uses the application layer mechanisms (including security mechanisms) to establish secure communication with other entities in the PIN (such as other PIN Elements, the PEMC, PEGC or AF). Step 7 uses procedures of existing standards such as e.g., CSA Matter [4]. Initial packets of step 7 can be transmitted concurrently with steps 4,5 and 6. However, these initial packets will not be forwarded by PEGC/PEMC to the AF until the acceptance from step 6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.3\tEvaluation",
                            "text_content": "In this solution, the security of PINE authentication and authorization is dependent on the authentication method chosen by the PIN owner.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.9\tSolution #8: AF authorization in PIN scenarios",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.9.1\tIntroduction",
                            "text_content": "This solution addresses part of KI #2 \"Authorization of PIN capabilities\", i.e. the 5GS is able to restrict resource request from an Application Function associated with a PIN to the resources associated with the PIN.\nThis solution reuses the OAuth 2.0 to authorize the AF to manage a specific PIN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.2\tSolution details",
                            "text_content": "This solution reuses the OAuth 2.0, which is already captured in clause 12 and clause 13 of TS 33.501 [3], to authorize the AF to manage a specific PIN. To authorize the AF to manage a specific PIN, the access token sent to the AF includes PIN identity.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.3\tEvaluation",
                            "text_content": "This solution reuses the OAuth 2.0 to authorize the AF to manage a specific PIN. To authorize the AF to manage a specific PIN, the access token sent to the AF includes PIN identity.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.10\tSolution #9: PIN AF authorization for accessing the UDR",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.10.1\tIntroduction",
                            "text_content": "This solution addresses KI#2 by using normal authorization/authentication procedure with CCA and taking into account the PIN ID in the additional scope.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.2\tSolution details",
                            "text_content": "The solution is based on 13.4.1.3 \"Service access authorization in indirect communication scenarios\" of TS 33.501 [3], with the PIN AF taking the role of the NF Service Consumer, the NEF the role as the SCP, the UDR the role as the NF Service Producer. The PIN AF includes the PIN ID in the additional scope which is then taken into account by the NRF for the authorization and access token generation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.3\tEvaluation",
                            "text_content": "The PIN ID should be taken into account when authorizing the PIN AF for accessing the UDR for modifying data related to that specific PIN ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.11\tSolution #10: Local Authentication and Authorization of PINE",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.11.1\tIntroduction",
                            "text_content": "This solution addresses KI#1. Based on architectural proposals and preliminary conclusions in the TR 23.700-88 [2], this solution proposes an authentication and authorization architecture, which involves PEGC and PEMC.\nThe solution proposes to use EAP protocol between a PINE and PEMC, with the PINE acting as EAP client, the PEMC acting as EAP server, and the PEGC as EAP authenticator.\nThat is, authentication and authorization happen locally within the domain of the non 3GPP network of the PIN.\nThis solution requires that PINEs support EAP.\nThis solution does not exclude coexistence with other authentication methods, which are not relying on EAP.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.2\tSolution details",
                            "text_content": "The architecture, which the solution is based on is shown in Figure 6.11.2.1-1. This architecture figure is closely following the architecture proposed in Solution #0D in TR 23.700-88 [2] including the labelling of the reference points.\nP1 and P2 are the reference points, which are based on a non-cellular short-range communication protocol (typically defined outside the scope of 3GPP), and which are used for communicating between the PEGC and the PINEs and PEGC and PEMC, respectively. The part of the network, which is using the non-cellular network for communication, is referred to as PIN domain.\nSince both PEMC and PEGC are UEs, they can use cellular connectivity to connect via the 5G user plane to application in a Data Network. The P3 reference point is used between PEMC and PIN AF to exchange information related to the management of the PIN, whereas P4 is used by the PEGC to provide PINEs with connectivity with the actual PIN application (which can be part of the PIN AF or not).\nFigure 6.11.2.1-1: Architecture assumed by the solution\nIn general, a PIN consists of several PIN domains. Each PIN domain consists of one or several PEGCs and is represented by a PEMC. The PEMCs of all PIN domains constituting the PIN are connected to the same PIN AF. This architecture is visualized in Figure 6.11.2.1-2. The PIN Management Protocol between PEMC and PIN AF as well as the functionality of the PIN AF are out of scope of this solution.\nPINE authentication and authorization is executed locally within a PIN domain. For this purpose, EAP is used between the PINE and the (local) PEMC. The PEGC is acting as EAP authenticator and in this role is relaying EAP messages between PINE and PEMC. The EAP messages are carried on top of the non-cellular communication protocol which is used for communication within a PIN domain.\nEach PEMC is using credential information from a local database for the authentication and authorization of the PINE. The provisioning of this information (e.g., using the PIN Management Protocol) is out of scope of this solution. The type of credential information depends on the used EAP protocol. Definition of the EAP protocol and of the credential information is out of scope of this solution.\nFigure 6 illustrates the PIN Authentication and Authorization Architecture, which outlines the secure process of user authentication and authorization within a telecommunication system. The diagram showcases the various components involved, including the PIN pad, SIM card, and the authentication server. The flow of information is depicted through arrows, emphasizing the secure transmission of data between these components. The use of PINs ensures a higher level of security, preventing unauthorized access to the system. The architecture also highlights the importance of encryption and decryption processes, which are essential for maintaining confidentiality and integrity during data transmission.\nFigure 6.11.2.1-2: PIN Authentication and Authorization Architecture\nFigure 6 illustrates the local authentication and authorization flow in a telecommunication system, detailing the process of user identification and access control. The figure showcases the interaction between the user equipment (UE), the network server, and the authentication server. It highlights the role of the authentication server in validating the user's credentials and granting or denying access to the network resources. The flow also emphasizes the importance of secure communication channels and encryption techniques to protect sensitive data during the authentication process.\nFigure 6.11.2.2-1: Local Authentication and authorization flow\nThe actual procedure used for local authentication and authorization of a PINE is shown in Figure 6.11.2.2.1-1. The PINE is acting as EAP Client, the PEGC as EAP Authenticator and the PEMC as EAP Server.\nAs defined by SA2 [2], the communication between PINE and PEGC as well as the communication between PEGC and PEMC is executed using the non-cellular short range communication protocol.\nThe individual steps are described in more detail below.\nStep 1:\tPINE sends a connection request to PEGC.\nStep 2:\tThe PEGC sends EAP Identity Request to the PINE, if the PINE identity is not included in the message sent in step 1, and fetches the PIN Identity in Identity response message.\nStep 3:\tThe PEGC sends Access Request to the PEMC, which includes the EAP identity of PINE.\nExisting protocol suites, like RADIUS or Diameter can be used to convey the Access Request to the PEMC.\nStep 4:\tThe PEMC and the PINE exchanges several EAP messages, as required by the EAP method.\nStep 5:\tThe PEMC verifies the PINE request based on provisioned information.\nThis step also includes the authorization of the PINE using the provisioned information.\nStep 6:\tAfter successful completion of the authentication procedure, the PEMC sends EAP success message to the PEGC. This message may contain a secret which was derived as part of the execution of the EAP message exchange, e.g., a Master Session Key (MSK). The exact way, how the MSK is calculated on the PINE and on the PEMC, is up to the EAP method.\nThe same protocol as in step 3, e.g., RADIUS or Diameter, can be used to convey this message to the PEMC.\nStep 7:\tThe EAP Success message sent to the PINE completes the authentication procedure.\nStep 8:\tA further PIN specific handshake takes place to establish secure communication within the PIN. As part of this handshake PEGC and PINE can derive further communication keys from the MSK.\nSpecification of the protocol between PEMC and PIN AF is out of scope of the solution.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.3\tEvaluation",
                            "text_content": "This solution proposes a local mechanism for authentication and authorization of PINEs.\nThe solution proposes to use EAP, but the solution might exist with other solutions, which are not relying on EAP.\nThe solution addresses both requirements in KI#1, PINE authentication and authorisation, by reusing existing methods as described in step 5 and 8.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.12\tSolution #11: UDM based AF authorization mechanism for PIN scenarios",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.12.1\tIntroduction",
                            "text_content": "This solution addresses part of KI #2 \"Authorization of PIN capabilities\", i.e. the scope of access granted to an AF needs to be restricted to the level of specific PINs.\nThe following text captured in TS 23.501 [3] indicates that the AF needs to send information to 5GC to generate PIN related URSP rules.\n\"For a UE acting as a PEGC registered in the 5GS, the 5GS supports the provisioning of URSP rules that include a PIN ID as Traffic Descriptor. URSP rules with a PIN ID in the Traffic Descriptor are sent to the UE based on the information provided from an AF for PIN as specified in TS 23.502 [5] and TS 23.503 [6] for policy delivery.\"\nIn clause 4.15.6.7a of TS 23.502 [5], the UDM is utilized to authorize the AF to provide application guidance for URSP determination. The UDM does the authorization based on the subscription information of the UE or the group.\nThis solution reuses the UDM to do the authorization.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.2\tSolution details",
                            "text_content": "To authorize the AF to provide application guidance for URSP related to a specific PIN and a particular PEGC, the procedures defined in clause 4.15.6.7a of TS 23.502 [5] are reused with the following adaptations.\nIn step 2 in TS 23.502 [5] clause 4.15.6.7a, the NEF should also send the PIN ID, which is to be addressed by the AF, to the UDM. The GPSI provided by the NEF is owned by the PEGC.\nIn step 3 in TS 23.502 [5] clause 4.15.6.7a, the UDM needs to authorize the AF to guide URSP rules related to a specific PIN and a particular PEGC.\nIf the subscription information identified by the GPSI received in step 1 in TS 23.502 [5] clause 4.15.6.7a contains the information for authorization, the UDM does the authorization based on the subscription information.\nIf local PIN data (e.g., PIN subscription information) related to PIN ID received in step 1 contains the authorization information, UDM does the authorization based on the local PIN data.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.3\tEvaluation",
                            "text_content": "This solution focuses on addressing authorizing AF to provide application guidance for URSP related to a specific PIN and a particular PEGC.\nThis solution reuses the procedures defined in clause 4.15.6.7a of TS 23.502 [5] to do the AF authorization. Hence has the minimum impact on the existing network.\nThe main impacts are:\nThe NEF needs to send the PIN ID to the UDM.\nThe UDM needs to do the authorization based on the subscription information of the PEGC/PIN data (e.g., PIN subscription information).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tConclusions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tConclusions for KI#1",
                    "description": "",
                    "summary": "",
                    "text_content": "It is concluded that authentication of PINE is performed by the PIN without interaction with the 5GC. PINE authentication can be performed either by the PEGC or optionally by an authentication server that is accessible within the PIN (e.g. enterprise authentication server) as decided by the owner of the PIN.\nNOTE:\tThe PIN includes PINE, PEGC, PEMC and accessible authentication servers.\nIt is further concluded that no normative work is needed for the authentication requirement of this key issue.\n\n\n\n",
                    "tables": [
                        {
                            "description": "",
                            "table number": 4,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        }
    ]
}