{
    "document_name": "24538-i30.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification| has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\tindicates that something is possible\ncannot\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document specifies the protocol aspects for supporting MSGin5G services as specified in 3GPP TS 23.554 [2] for:\n1.\tcommunication between the MSGin5G UE and the MSGin5G Server over the MSGin5G-1 interface;\n2.\tcommunication between the Application Client and the MSGin5G Client over the MSGin5G-5 interfaces; and\n3.\tcommunication between the MSGin5G Client residing on the Constrained UE  and the MSGin5G Gateway Client over the MSGin5G-6 interfaces.\nThe present specification defines the usage and interactions of the MSGin5G Service with SEAL services.\nThe present specification also defines the message format, message contents, error handling and system parameters applied by the protocols for the MSGin5G Service.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.554: \"Application architecture for MSGin5G Service; Stage 2;\".\n[3]\t3GPP TS 23.434: \"Service Enabler Architecture Layer for Verticals\".\n[4]\tIETF RFC 7641: \"Observing Resources in the Constrained Application Protocol (CoAP)\".\n[5]\tIETF RFC 7252: \"The Constrained Application Protocol (CoAP)\".\n[6]\t3GPP TS 24.546: \"Configuration management - Service Enabler Architecture Layer for Verticals (SEAL); Protocol specification\".\n[7]\t3GPP TS 29.538: \"Enabling MSGin5G Service; Application Programming Interfaces (API) specification; Stage 3\".\n[8]\tJSON Schema: \" JSON Schema Draft-07\",\n[9]\t3GPP TS 23.304: \"Proximity based Services (ProSe) in the 5G System (5GS)\".\n[10]\t3GPP TS 24.544: \"Group Management - Service Enabler Architecture Layer for Verticals (SEAL); Protocol specification\".\n[11]\t3GPP TS 24.545: \"Location Management - Service Enabler Architecture Layer for Verticals (SEAL); Protocol specification\".\n[12]\t3GPP TS 24.546: \"Configuration Management - Service Enabler Architecture Layer for Verticals (SEAL); Protocol specification\".\n[13]\t3GPP TS 24.547: \"Identity Management - Service Enabler Architecture Layer for Verticals (SEAL); Protocol specification\".\n[14]\t3GPP TS 24.548: \"Network Resource Management - Service Enabler Architecture Layer for Verticals (SEAL); Protocol specification\".\n[15]\t3GPP TS 24.007: \"Mobile radio interface signalling layer 3; General Aspects\".\n[16]\t3GPP TS 33.501: \"Security architecture and procedures for 5G system\".\n[17]\t3GPP TS 23.502: \" Procedures for the 5G System; Stage 2\"\n[18]\t3GPP TS 23.003: \"Numbering, addressing and identification\".\n[19]\tIETF RFC 4122: \"A Universally Unique IDentifier (UUID) URN Namespace\".\n[20]\t3GPP TS 29.641: \"3GPP registry for Service Names and Port Numbers\".\n[21]\t3GPP TS 23.041: \"Technical realization of Cell Broadcast Service (CBS)\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].\nexample: text used to clarify abstract rules by applying them literally.\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.554 [2] apply:\nApplication Client\nBroadcast Area\nMessaging Topic\nMSGin5G Client\nMSGin5G Gateway Client\nMSGin5G Gateway UE\nMSGin5G Group\nMSGin5G Service\nMSGin5G Server\nMSGin5G UE\nNon-3GPP UE\nNon-MSGin5G UE\nConstrained UE\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tSymbols",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the following symbols apply:\n<symbol>\t<Explanation>\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.3\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\nAF\tApplication Function\nAS\tApplication Server\nCAPIF\tCommon API Framework for northbound APIs\nCoAP\tConstrained Application Protocol\nNIDD\tNon IP Data Delivery\nSCEF\tService Capability Exposure Function\nSCS\tService Capability Server\nSEAL\tService Enabler Architecture Layer for Verticals\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tGeneral description",
            "description": "The MSGin5G Service (message service for MIoT over 5G System) is basically designed and optimized for massive IoT device communication including thing-to-thing communication and person-to-thing communication. The MSGin5G Service provides messaging communication capability in 5GS including the following message communication models:\na)\tPoint-to-Point message;\nb)\tApplication-to-Point message/ Point-to-Application message;\nc)\tGroup message; and\nd)\tBroadcast message.\nThe MSGin5G Service support the message exchanging between the following UE types:\na)\tMSGin5G UE:\n1)\tlight weight Constrained UEs (e.g. sensors, actuators) and\n2)\tUnconstrained UEs with advanced capabilities (e.g. washing machine, micro-ovens);\nb)\tLegacy 3GPP UE; and\nc)\tNon-3GPP UE.\nMSGin5G Service also provides the following capabilities to enhance the message delivery for all message communication models:\n-\tMSGin5G Store and Forward;\n-\tMessage delivery based on Messaging Topic;\n-\tMessage Aggregation;\n-\tMessage Segmentation and Reassembly; and\n-\tUsage of Network Capabilities including UE reachability status monitoring and MSGin5G device triggering.\nThe MSGin5G Client contained in the MSGin5G UE communicates with the MSGin5G Server over the MSGin5G-1 reference point (see 3GPP TS 23.554 [2]). CoAP specified in IETF RFC 7252 [5] is used as the basic transport protocol of MSGin5G service in this reference point and shall be supported by the MSGin5G Client and MSGin5G Server.\nAn MSGin5G Client may reside in a Constrained UE which cannot connect to the 3GPP network directly for message exchange with MSGin5G Server (e.g. the Constrained UE is out of 3GPP RAN coverage, with or without authorization to use UE-to-Network relay). If allowed by configuration, the MSGin5G Client residing in a Constrained UE can use the options listed below to communicate with the MSGin5G Server:\n-\tthe MSGin5G Client residing in a Constrained UE uses an UE-1 as relay. In this scenario, the Constrained UE residing on the Constrained UE communicates with the MSGin5G Server over the MSGin5G-1 reference point (see 3GPP TS 23.554 [2]); or\n-\tthe MSGin5G Client residing in a Constrained UE interacts with an MSGin5G Gateway UE which supports MSGin5G Gateway Client. The MSGin5G Gateway UE provides access to multiple Constrained UEs to connect to the 3GPP network for MSGin5G services. In this scenario, the MSGin5G Client residing in the Constrained UE communicates with the MSGin5G Gateway Client residing on the MSGin5G Gateway UE over the MSGin5G-6 reference point (see 3GPP TS 23.554 [2]). For supporting sending and receiving MSGin5G messages for the MSGin5G Client residing in a Constrained UE in this case, the transport protocols of MSGin5G-6 reference point is also based on CoAP specified in IETF RFC 7252 [5].\nAn Application Client may reside on the same UE with the MSGin5G Client or reside on different UE. The Application Client communicates with the MSGin5G Client over the MSGin5G-5 reference point (see 3GPP TS 23.554 [2]).\nAdditionally, the MSGin5G Client(s) may interact with SEAL Clients over the SEAL-C reference point specified for each SEAL service as specified in 3GPP TS 23.434 [3]. The MSGin5G Server(s) may interact with SEAL Servers over the SEAL-S reference point specified for each SEAL service as specified in 3GPP TS 23.434 [3]. The interaction between a SEAL Client and the corresponding SEAL Server is supported by SEAL-UU reference point specified for each SEAL service as specified in 3GPP TS 23.434 [3].\nBy means of using the MSGin5G-1 reference point, the following aspects can be provided:\na)\tMSGin5G UE registration and de-registration towards the MSGin5G Server;\nb)\tMSGin5G message delivery and MSGin5G message delivery status report; and\nc)\tMessaging Topic Subscription; and\nd)\tMSGin5G UE bulk registration and bulk de-registration towards the MSGin5G Server.\nBy means of using the MSGin5G-5 reference point, the following aspects can be provided:\na)\tApplication Client registration and de-registration towards the MSGin5GClient; and\nb)\tThe exchanging of message and message delivery status report between the Application Client and the MSGin5G Server by using MSGin5GClient.\nBy means of using MSGin5G-6 reference point , the following aspects can be provided:\na)\tConstrained UE registration and de-registration towards the MSGin5G Server by using MSGin5G Gateway UE;\nb)\tThe exchanging of MSGin5G message and MSGin5G message delivery status report between Constrained UE and MSGin5G Server by using MSGin5G Gateway UE; and\nc)\tThe bulk registration and de-registration procedures from multiple Constrained UEs towards the MSGin5G Server by using MSGin5G Gateway UE.\nThe necessary 5GC Network Capabilities, e.g. device triggering, may be used in MSGin5G Service as specified in 3GPP TS 23.554 [2]. The device trigger is delivered to the MSGin5G Client via SCEF/NEF and the Core Network as specified in 3GPP TS 23.502 [17] and is out of scope of this document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "5\tFunctional entities",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tMSGin5G Client",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.1.1\tGeneral functionalities of MSGin5G Client",
                            "text_content": "An MSGin5G Client acts as client-side functionality for MSGin5G UE configuration, registration and message delivery.\nThe functionalities of MSGin5G Client include:\na)\tsupporting registration to an MSGin5G Server;\nb)\tsupporting configuration required to use MSGin5G Service;\nc)\tconstructing MSGin5G message when:\n1)\trequested by an Application Client resides on the same MSGin5G UE or;\n2)\trequested by the Application Client resides on another UE without MSGin5G Client;\nd)\tdelivering MSGin5G message payload to the targeted Application Client;\n1)\tdirectly when the Application Client resides on the same MSGin5G UE or;\n2)\tover MSGin5G-5 reference point when the Application Client resides on another UE without MSGin5G Client by acting as a gateway;\ne)\texchanging MSGin5G messages with an MSGin5G Server; and\nf)\tsupporting MSGin5G message aggregation and segmentation according to service provider's policy.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.2\tMSGin5G Gateway Client",
                            "text_content": "An MSGin5G Gateway Client is an MSGin5G Client which supports MSGin5G Gateway service functionality in additional to the MSGin5G Client functionalities specified in clause 5.1.1. It enables constrained devices to obtain services from the MSGin5G Server when communications via ProSe UE-to-Network Relay are not or cannot be supported.\nThe MSGin5G Gateway service functionality in the MSGin5G Gateway Client supports the bulk configuration and bulk (de-)registration for the MSGin5G Client residing on the Constrained UE, e.g. checking whether bulk configuration/bulk (de-)registration can be used, holding the (de-)registration request from MSGin5G Client residing on the constrained device, construction of the bulk (de-)registration request and splits of the MSGin5G UE bulk (de-)registration response, etc.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.2\tMSGin5G Server",
                    "description": "",
                    "summary": "",
                    "text_content": "An MSGin5G Server functional entity provides server-side functionality for configuration, registration and message delivery.\nThe following functionalities of MSGin5G Server need to be considered in current document:\na)\texchanging MSGin5G messages with MSGin5G Client;\nb)\trouting MSGin5G messages based on UE Service ID;\nc)\tsupporting transport level protocol selection and conversion for exchanging MSGin5G messages with MSGin5G UE;\nd)\tto resolve the MSGin5G Group Service ID to determine the members of the Group specified in 3GPP TS 23.434 [3];\ne)\tsupporting MSGin5G message aggregation and segmentation according to service provider's policy;\nf)\tsupporting MSGin5G UE configuration procedures as specified in 3GPP TS 23.434 [3] and 3GPP TS 24.546 [6] or communicating with the SEAL Configuration Management Server to provide MSGin5G configuration data on a UE to be ready for the MSGin5G Service; and\ng)\tmanaging MSGin5G UE information related to the MSGin5G Service, such as MSGin5G Client availability.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "6\tMSGin5G Procedures",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "In clause 6, the detailed behaviors of the MSGin5G UE, the MSGin5G Server and Constrained UE during the MSGin5G procedures are described.\nDepending on communication over different MSGin5G interfaces, different MSGin5G procedures are supported as:\na)\tFor the communication between the MSGin5G Client on MSGin5G UE and the MSGin5G Server over the MSGin5G-1 interface, the following procedures are involved:\n1)\tConfiguration, including bulk configuration;\n2)\tRegistration and de-registration, including bulk registration and bulk de-registration;\n3)\tMSGin5G message delivery including sending and receiving MSGin5G message, aggregated MSGin5G message, MSGin5G message delivery status report and aggregated MSGin5G message delivery status report.\n4)\tMSGin5G message segment and reassembly; and\n5)\tMessaging topic subscription.\nb)\tFor the communication between the Application Client(may resides on the same UE with the MSGin5G Client or reside on a different UE) and the MSGin5G Client on MSGin5G UE over the MSGin5G-5 interfaces, the following procedures are involved:\n1)\tApplication Registration; and\n2)\tMessage delivery information including construct MSGin5G message information, route information and notifications information.\nc)\tFor the communication between the Constrained UE and the MSGin5G Gateway UE over the MSGin5G-6 interfaces, the following procedures are involved:\n1)\tBulk configuration;\n2)\tBulk registration and de-registration; and\n3)\tRegistration to gateway services.\nThe constrained UE which does not connect to the 3GPP network directly could exchange messages with MSGin5G Server using a Relay UE.\nFor procedures used for bullet a) and bullet c), CoAP specified in IETF RFC 7252 [5] is used as the basic transport protocol. For procedures used for bullet b), guidance on definitions of the message format and information elements are described in Annex A.\nThe authorization of MSGin5G Client by the MSGin5G Server is performed by verifying the UE service ID as specified in Annex Y of TS 33.501 [16].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.2\tConfiguration",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tMSGin5G UE Configuration",
                            "text_content": "MSGin5G UE Configuration is based on the configuration management functionality specified in TS 23.434 [3] and TS 24.546 [6].\nThe MSGin5G UE should support the configuration management client functionality as specified in 3GPP TS 24.546 [6]. The configuration management client functionality may be collocated with MSGin5G Client or it can be separated with MSGin5G Client as per 3GPP TS 23.554 [2].\nIf the configuration management client functionality is not collocated with the MSGin5G Client, the MSGin5G Client should use SEAL-C interface to interact with configuration management client functionality for MSGin5G UE configuration.\nThe MSGin5G UE configuration procedures at the configuration management client functionality are based on the procedures in clause 6.2.3.3 of 3GPP TS 24.546 [6], in the procedures:\na)\tthe configuration management client functionality on the MSGin5G UE acts as SCM-C;\nb)\tthe configuration management server functionality at the server-side acts as SCM-S;\nc)\tshall set the Option header to the CoAP URI identifying the user profile document to be retrieved according to the resource API definition in Annex C.3.1 of 3GPP TS 24.546 [6],\n1)\tthe \"apiRoot\" is set to the URI of the configuration management server functionality at the server-side;\n2)\tthe \"valServiceId\" is set to the unique service identifier of MSGin5G service; and\n3)\tthe configuration management client functionality shall make a GET request for the UE Configurations as described in Annex C.3.1.2.2.3.1 of 3GPP TS 24.546 [6] and shall set applicable query parameters defined in table C.3.1.2.2.3.1-1 of 3GPP TS 24.546 [6] with the clarification listed below.\ni)\tthe ue-uri is set to the MSGin5G UE ID as specified in 3GPP TS 23.554 [2]\nii)\tthe ue-vendor and/or the ue-type parameter are set to the MSGin5G UE information as specified in 3GPP TS 23.554 [2] if included.\nUpon receiving the requested MSGin5G UE configuration data, the configuration management client functionality shall submit the configuration data to MSGin5G Client by SEAL-C interface if it is not collocated with the MSGin5G Client. The MSGin5G Client shall store the configuration data, including MSGin5G UE Service ID, the address of MSGin5G Server and other available MSGin5G Service specific information.\nThe corresponding JSON Schema used in step e) is defined in 7.3.2.1.\nThe configuration management server functionality as specified in 3GPP TS 24.546 [6] may be collocated with MSGin5G Server or it can be separated with MSGin5G Server as per 3GPP TS 23.554 [2].\nThe MSGin5G UE configuration procedures at the configuration management server functionality are based on the procedures in clause 6.2.3.4 of 3GPP TS 24.546 [6]. In the procedures, the configuration management server function acts as SCM-S.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tConstrained UE configuration to use Relay UE",
                            "text_content": "6.2.2.1\tProcedure at Relay UE\nThe Relay UE acts as either 5G ProSe Layer-2 and Layer-3 UE-to-Network Relay entity as specified in 3GPP TS 23.304 [9] and relays the CoAP GET request/response as traffic between the configuration management client functionality and the configuration management server functionality.\nIn order to send an MSGin5G UE Configuration request, the configuration management client functionality on the Constrained UE shall use the procedures specified in clause 6.2.1.2.\nUpon receiving an CoAP 2.05 (Content), 4.03 (Forbidden) or 4.04 (Not found) response and the recipient's address included in the CoAP Option is set to the MSGin5G Client itself, the MSGin5G Client shall handle the CoAP 2.05 (Content), 4.03 (Forbidden) or 4.04 (Not found) response as specified in clause 6.2.1.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tConstrained UE configuration via MSGin5G Gateway UE",
                            "text_content": "If multiple configuration requests from one or more the MSGin5G Clients on the Constrained UEs are received by the MSGin5G Gateway UE, the MSGin5G Gateway UE may constucts a bulk configuration request based on the service policy to the MSGin5G Server and sends a response to each Constrained UE separately. Upon receiving the bulk configuration response from the MSGin5G Server, the MSGin5G Gateway UE splits the bulk configuration response into multiple individual configuration responses and notifies the MSGin5G Clients on the Constrained UEs separately.\n6.2.3.2\tProcedure at Constrained UE\n6.2.3.2.1\tConfiguration intiated by Constrained UE\nIn order to get the MSGin5G Service configuration information, the MSGin5G Client on the Constrain UE which has established a connection for One-to-one ProSe Direct Communication as specified in 3GPP TS 23.304[9] shall send a CoAP GET request to the MSGin5G Gateway Client on MSGin5G Gateway UE. In the CoAP GET request, the MSGin5G Client on the Constrain UE:\na)\tshall set the Option header to the CoAP URI identifying the user profile document to be retrieved according to the resource API definition in clause C.3.1 of 3GPP TS 24.546 [6]:\n1)\tthe \"apiRoot\" is set to the URI of the MSGin5G Gateway side;\n2)\tthe \"valServiceId\" is set to the unique service identifier of MSGin5G service; and\n3)\tthe MSGin5G Client on the Constrain UE shall generate a GET request for the UE Configurations as described in Annex C.3.1.2.2.3.1 of 3GPP TS 24.546 [6] and shall set applicable query parameters defined in table C.3.1.2.2.3.1-1 of 3GPP TS 24.546 [6] with the clarification listed below:\ni)\tthe ue-uri is set to the MSGin5G UE ID as specified in 3GPP TS 23.554 [2]; and\nii)\toptionally, the ue-vendor or the ue-type parameter or both are set to the MSGin5G UE information as specified in 3GPP TS 23.554 [2].\nUpon receiving the requested MSGin5G UE configuration data, the MSGin5G Client on the Constrain UE shall store the configuration data, including MSGin5G UE Service ID, the address of MSGin5G Server and other available MSGin5G Service specific information.\nUpon reception of an CoAP GET request where the CoAP URI of the request identifies the UE Configurations resource as described in clause C.3.1.2.2.3.1 of 3GPP TS 24.546 [6], the MSGin5G Gateway UE shall decide whether to use bulk configuration based on the service policy as:\na)\tif the MSGin5G Gateway UE decides not to use bulk configuration based on the service policy, the MSGin5G Gateway UE shall forward the CoAP GET request to the MSGin5G Server without any change; and\nb)\tif the MSGin5G Gateway UE decides to use bulk configuration based on the service policy, the MSGin5G Gateway Client on MSGin5G Gateway UE:\n1)\tshall store or cache the whole CoAP GET request;\n2)\t\tshall generate a CoAP 2.05 (Content) response including:\ni)\tthe \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\"; and\nii)\tthe \"CoAP payload\" element with \"Maximum configuration time\" to indicate the expected time when the Configuration Response can be received; and\n3)\tmay start a timer associated with the \"MSGin5G UE ID\". the expiration of the timer is set to the value of the \"Maximum configuration time\" element.\nThe MSGin5G Gateway UE may start a timer for periodic bulk configuration based on implementation, e.g. when the first configuration request for which the MSGin5G Gateway UE decided to use bulk configuration received from the constrained UE.\nNOTE:\tHow to decide that bulk configuration is used is implementation specific and outside the scope of the present document.\n6.2.3.3.2\tSending the Bulk Configuration Request to MSGin5G Server\nThe MSGin5G Gateway UE should support the configuration management client functionality as specified in 3GPP TS 23.546 [6]. The configuration management client functionality may be collocated with MSGin5G Gateway Client or it may be separated from MSGin5G Gateway Client as per 3GPP TS 23.554 [2].\nIf the configuration management client functionality is not collocated with the MSGin5G Gateway Client, the MSGin5G Gateway Client should use SEAL-C interface to interact with configuration management client functionality.\nBased on implementation, upon:\na)\texpiry of one or more timers of Maximum configuration time response to Constrain UE;\nb)\texpiry of the timer for periodic bulk configuration; or\nc)\texcess of the maximum number of MSGin5G UE configuration requests from constrained UEs,\nthe configuration management client functionality may initiate a CoAP GET request to the MSGin5G Server including cached or stored configuration requests which need to be bulk handled based on the procedures in clause 6.2.3.3 of 3GPP TS 24.546 [6]. In the procedures:\na)\tthe configuration management client functionality on the MSGin5G UE acts as SCM-C;\nb)\tthe configuration management server functionality at the server-side acts as SCM-S;\nc)\tthe \"Content-Format\" element shall be set to \"50\" to indicate the format of the CoAP payload is \"application/json\"; and\nd)\tthe Option header shall be set to the CoAP URI identifying the user profile document to be retrieved according to the resource API definition in Annex C.3.1 of 3GPP TS 24.546 [6]:\n1)\tthe \"apiRoot\" is set to the URI of the configuration management server functionality at the server-side; and\n2)\tthe \"valServiceId\" is set to the unique service identifier of MSGin5G service; and\ne)\tthe following information elements in the CoAP payload encoded in JSON format shall be included:\n1)\tthe \"Bulk configuration flag\" element to indicate that this CoAP GET request is used for bulk configuration; and\n2)\tthe \"List of MSGin5G UE IDs\" element to include one or more MSGin5G UE ID from the cached/stored configuration requests from the constrained UEs.\nUpon receiving the requested MSGin5G UE configuration data, the configuration management client functionality shall submit the configuration data to MSGin5G Gateway Client by SEAL-C interface if it is not collocated with the MSGin5G Client. The MSGin5G Gateway Client in MSGin5G Gateway UE:\na)\tshall split content of the \"List of MSGin5G UE configuration information\" element into multiple individual configuration information; and\nb)\tshall generate one or more CoAP 2.05 (Content) response as configuration responses to constrained UE(s) separately based on the cached CoAP GET requests associated with the MSGin5G UE ID. Each CoAP 2.05 (Content) response includes:\n1)\tthe CoAP \"Message ID\" element and the \"Token\" element with the same values in the CoAP GET request for configuration from the constrained UE; and\n2)\tthe \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\" and the CoAP payload including the elements as specified in clause 6.2.x.4.\nUpon reception of an CoAP GET request where the CoAP URI of the request identifies the UE Configurations resource as described in clause C.3.1.2.2.3.1 of 3GPP TS 23.546 [6], the configuration management server functionality shall follow the procedures in clause 6.2.3.4 of 3GPP TS 24.546 [6] with the clarification listed below:\na)\tthe configuration management server functionality shall return a 2.05 (Content) response, in addition to the information elements listed in clause 6.2.1.3 of the present document, the response also includes the list of MSGin5G UE configuration information found based on the list of MSGin5G UE IDs received from the CoAP GET request payload, each MSGin5G UE configuration information:\n1)\tshall include the \"UE Service ID\" element assigned to the requesting constrain UE;\n2)\tshall include the \"MSGin5G Server address\" element to indicate the MSGin5G Server which serves this constrain UE; and\n3)\tmay include the \"MSGin5G Service specific information\" element to indicate the specific information of the MSGin5G Service.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tRegistration",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.0\tGeneral",
                            "text_content": "Registration procedure is used to register the MSGin5G Client on the MSGin5G UE to the MSGin5G Server to use MSGin5G Services. Deregistration procedure is used to deregister the MSGin5G Client on the MSGin5G UE to the MSGin5G Server to not use MSGin5G Services.\nFor the MSGin5G Client on the MSGin5G UE deciding to initiate a registration procedure or a deregistration procedure to the MSGin5G Server, the procedures are specified in clause 6.3.1 and clause 6.3.3.\nIn case of the Application Client not residing in the MSGin5G UE with the MSGin5G Client, the Application Client initiates a registration to, or deregistration from, MSGin5G Client on MSGin5G UE as specified in clause 6.3.2.\nFor the MSGin5G Client residing in the constrained UE deciding to initiate a registration procedure or a deregistration procedure to the MSGin5G Server via an MSGin5G Gateway Client, the procedures are specified in clause 6.3.4 and clause 6.3.5. Before the MSGin5G Gateway Client decides to bulk the registration or deregistration from the MSGin5G Client residing in the constrained UE as specified in subclause 6.3.4.3.1, the MSGin5G Client residing in the constrained UE shall register to the gateway service as specified in clause 6.3.5.\nThe MSGin5G Client residing in the constrained UE decides to register to the MSGin5G Server based on the UE policy. Different reference points, i.e. the MSGin5G-1 reference point or the MSGin5G-1 reference point, and different constructurs of the registration request or deregistration request will be invoked.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.1\tMSGin5G UE Registration",
                            "text_content": "After the UE Service ID is configured to the MSGin5G UE, in order to register MSGin5G UE to the MSGin5G Server, the MSGin5G Client shall send a CoAP POST request to the MSGin5G Server according to procedures specified in IETF RFC 7252 [5]. In this CoAP POST request, the MSGin5G Client:\na)\tshall set the \"T\" field in the CoAP header to 0 to indicate acknowledge message required;\nb)\tshall include the MSGin5G Server address in the Option header of the CoAP POST request and set the Option header to a corresponding value, e.g. if the MSGin5G Server address is a URI, the Uri-Path Option is set to the value of such URI;\nc)\tshall set the \"Content-Format\" element to \"50\" to indicate the format of the CoAP payload is \"application/json\"; and\nd)\tshall include the following information elements in the CoAP payload encoded in JSON format as specified in clause 7.3.3.1:\n1)\tthe \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\n2)\tthe \"Message Type\" element with a \"REG\" value to indicate that this CoAP POST request is used for registration;\n3)\tthe \"UE Service ID\" element to indicate the MSGin5G UE initiating registration procedure; and\n4)\toptionally, the \"MSGin5G Client Profile\" element to include a set of parameters describing the MSGin5G Client. This element may include the \"MSGin5G Client Triggering Information\" element and the \"MSGin5G Client Communication Availability\" element:\ni)\tThe \"MSGin5G Client Triggering Information\" element shall include:\n-\tthe \"MSGin5G UE ID\" element to indicate the MSGin5G UE hosting the MSGin5G Client; and\n-\teither:\n-\ta \"MSGin5G Client Port\" element to indicate the port number that the MSGin5G Client listens on for device triggers from the MSGin5G Server; or\n-\ta \"MSGin5G Client Ports\" element to indicate a List of port numbers that the MSGin5G Client listens on for device triggers from the MSGin5G Server and protocol (e.g., SMS, NIDD, etc.) associated with each port number; and\nii)\tthe \"MSGin5G Client Communication Availability\" element informs the MSGin5G Server whether the client has a specific application-level schedule/periodicity to its MSGin5G communications, which may be used in conjunction with UE reachability monitoring to determine whether and when MSGin5G communications are attempted. This element:\n-\tshall include the \"Scheduled communication time\" element to indicate the time when the UE becomes available for communication;\n-\tshall include the \"Communication duration time\" element to indicate the duration time of periodic communication;\n-\tmay include the \"Periodic communication indicator\" element to identify whether the client communicates periodically or not;\n-\tmay include the \"Periodic communication interval\" element to indicate the interval Time of periodic communication if \"Periodic communication indicator\" element is included;\n-\tmay include the \"Data size indication\" element to indicate the expected data size to be exchanged during the communication duration; and\n-\tmay include the \"Store and forward option\" element to indicate the UE does not request store and forward services for incoming MSGin5G requests.\nThe MSGin5G Client initiates a CoAP POST request to de-register from the MSGin5G Server. In this CoAP POST request, the MSGin5G Client:\na)\tshall set the \"T\" field in the CoAP header to 0 to indicate acknowledge message required;\nb)\tshall include the MSGin5G Server address in the Option header of the CoAP POST request and set the Option header to a corresponding value, e.g. if the MSGin5G Server address is a URI, the Uri-Path Option is set to the value of such URI;\nc)\tshall set the \"Content-Format\" element to \"50\" to indicate the format of the CoAP payload is \"application/json\"; and\nd)\tshall include the following information elements encoded in JSON format as specified in clause 7.3.3.2:\n1)\tthe \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\n2)\tthe \"Message Type\" element with a \"DEREG\" value to indicate that the CoAP POST request is used for de-registration; and\n3)\tthe \"UE Service ID\" element to indicate the MSGin5G UE initiating de-registration procedure.\nUpon reception of the CoAP POST request containing MSGin5G service identifier indicating that the received request is for MSGin5G service and Message Type indicating that the received request is for registration, the MSGin5G Server shall verify the UE service ID. After a successful verification, the MSGin5G Server:\na)\tshall store the UE Service ID and the MSGin5G Client Profile information included in the received CoAP POST request; and\nb)\tshall generate a CoAP 2.01 (Created) response or CoAP 2.04 (Change) response including the following parameters:\n1)\tthe CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for registration; and\n2)\tthe \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\" and the CoAP payload encoded in JSON format as specified in clause 7.3.3.1 including:\ni)\tthe \"UE Service ID\" element to indicate the MSGin5G UE initiating registration procedure;\nii)\tthe \"Registration result\" element to indicate whether the registration is success or failure;\niii)\toptionally, the \"Registration expiration time\" element to indicate the expiration time of the registration. This element is present only when the value of the \"Registration result\" element is set to success; and\niv)\tthe \"Failure Cause\" element to indicate reason for failure. This element shall only present if the value of \"Registration result\" shows that the registration is failed.\nUpon reception of the CoAP POST request containing MSGin5G service identifier indicating that the received request is for MSGin5G service and Message Type indicating that the received request is for deregistration from an MSGin5G UE, the MSGin5G Server shall verify the UE service ID. After a successful verification, the MSGin5G Server:\na)\tshall delete the registration information of the MSGin5G UE and any applicable MSGin5G Client Profile information that it has stored; and\nb)\tshall generate a CoAP 2.04 (Change) response including the following parameters:\n1)\tthe CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for deregistration;\n2)\toptionally, the MSGin5G Client address in the Option header of the CoAP response and set the Option header to a corresponding value, if it is provided in the payload of CoAP POST request; and\n3)\tthe \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\" and the CoAP payload encoded in JSON format as specified in clause 7.3.3.2 including:\ni)\tthe \"UE Service ID\" element to indicate the MSGin5G UE initiating de-registration procedure;\nii)\tthe \"De-registration result\" element to indicate whether the registration is success or failure; and\niii)\tthe \"Failure Cause\" element to indicate reason for failure. This element shall only present if the value of \"De-registration result\" shows that the de-registration is failed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tApplication Client registration to MSGin5GClient on MSGin5G UE",
                            "text_content": "Upon reception of registration request from the application client on the non-MSGin5G UE, the MSGin5G Client on the MSGin5G UE decides whether to accept the registration request based on local condition.\nIf the registration is accepted by the MSGin5G Client on the MSGin5G UE, the MSGin5G Client on the MSGin5G UE:\na)\tstores Application ID included in the registration request from the Application Client on the non-MSGin5G  UE and the mapping between the transport identifier and the Application ID;\nNOTE 1:\tBased on the connection mode, e.g. L2 connection or L3 connection, the MSGin5G UE can allocate a specified MAC address or UDP port for exchanging information between the MSGin5G Client on the MSGin5G  UE and the Application Client on the non-MSGin5G UE. The transport mechanism is based on the legacy transport protocol.\nNOTE 2:\tThe MSGin5G Client on the MSGin5G UE retrieves the transport identifier from the transport layer. The transport identifier can be a Layer-2 ID, e.g. a MAC address, or a Layer-3 ID, e.g. an IP address with a specific UDP port.\nb)\tallocates a Registration ID for the Application Client on the non-MSGin5G UE; and\nc)\tconstructs the registration response and sends it to the application client on the non-MSGin5G UE. The registration response shall include:\n1)\tthe Registration Result indicates the registration is accepted by the MSGin5G Client on the MSGin5G UE; and\n2)\tthe Registration ID allocated by the MSGin5G Client on the MSGin5G UE.\nIf the registration is not accepted by the MSGin5G Client on the MSGin5G UE, the MSGin5G Client on the MSGin5G UE constructs the registration response and sends it to the application client on the Constrained UE. The registration response shall include:\na)\tthe Registration Result indicating the registration is not accepted by the MSGin5G Client on the MSGin5G UE; and\nb)\tthe Failure Reason indicating an appropriate reason why the registration request is rejected by the MSGin5G Client on the MSGin5G UE.\nUpon reception of de-registration request from the application client on the Application Client on the non-MSGin5G UE, the MSGin5G Client on the MSGin5G UE:\na)\tremoves the mapping between Application ID and transport identifier of the Application Client on the non-MSGin5G UE based on the Registration ID included in the de-registration request; and\nb)\tconstructs the de-registration response including:\n1)\tthe De-registration Result indicating whether the de-registration is accepted or not;\n2)\tthe Registration ID included in the de-registration request, if the de-registration is accepted by the MSGin5G Client on the MSGin5G UE; and\n3)\tthe Failure Reason indicating an appropriate cause indicating why the de-registration request is rejected by the MSGin5G Client on the MSGin5G UE, if the de-registration is not accepted by the MSGin5G Client on the MSGin5G UE.\nNOTE:\tBased on the connection mode, e.g. L2 connection or L3 connection, the MSGin5G Client on the MSGin5G UE may allocate a specified MAC address or UDP port for exchanging information between the MSGin5G Client on the MSGin5G UE and the Application Client on the non-MSGin5G UE. The transport mechanism is based on the legacy transport protocol.\nIn order to register Application Client on the non-MSGin5G UE to the MSGin5G Client on the MSGin5GGateway UE, the Application Client on the non-MSGin5G UE sends a registration request to the MSGin5G Client on the MSGin5G UE. The registration request shall include the \"Application ID\" to indicate the Application Client on the non-MSGin5G UE initiating registration.\nNOTE:\tIf a specified MAC address or UDP port is configured for exchanging information between the MSGin5G Client on MSGin5G UE and the Application Client on the non-MSGin5G UE, the Application Client on the non-MSGin5G UE shall send the registration request to the specified MAC address or UDP port.\nIn order to de-register Application Client on the non-MSGin5G UE to the MSGin5G Client on MSGin5G UE, the Application Client on the non-MSGin5G UE sends a de-registration request to the MSGin5G Client on the MSGin5 Client on the MSGin5G UE. The de-registration request shall include the \"Registration ID\" which has been allocated by the MSGin5G Client on the MSGin5G UE during the registration procedure.\nNOTE:\tIf a specified MAC address or UDP port is configured for exchanging information between the MSGin5G Client on the MSGin5G UE and the Application Client on the non-MSGin5G UE, the Constrained UE shall send the de-registration request to the specified MAC address or UDP port.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.3\tConstrained UE registration to Relay UE",
                            "text_content": "The Relay UE acts as either 5G ProSe Layer-2 or Layer-3 UE-to-Network Relay entity as specified in 3GPP TS 23.304 [9] and relays the CoAP POST request/response as traffic between the MSGin5G Server and the Constrained UE.\nIn order to register Constrained UE to the MSGin5G Server, the MSGin5G Client on Constrained UE sends a CoAP POST request to the MSGin5G Server via the Relay UE. The CoAP POST request is constructed as specified in clause 6.3.1.1.1.\nIn order to de-register Constrained UE to the MSGin5G Server, the MSGin5G Client on Constrained UE sends a CoAP POST request to the MSGin5G Server via the Relay UE. The CoAP POST request is constructed as specified in clause 6.3.1.1.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.4\tConstrained UE registration via MSGin5G Gateway Client",
                            "text_content": "If multiple registration requests from one or more the MSGin5G Clients on the Constrained UEs are received, the MSGin5G Gateway Client constructs a bulk registration/de-registration request to the MSGin5G Server and sends a response to each Constrained UE separately. Upon receiving the bulk registration response from the MSGin5G Server, the MSGin5G Gateway Client splits the bulk registration response into multiple individual registration responses and notifies the MSGin5G Clients on the Constrained UEs separately.\nAfter the UE Service ID is configured to the MSGin5G UE, in order to register MSGin5G UE to the MSGin5G Server, the MSGin5G Client on the Constrained UE shall send a CoAP POST request to the MSGin5G Server. If the registration request is allowed to delay for bulk registration initiated by the MSGin5G Gateway Client, in the CoAP POST request, the MSGin5G Client on the Constrained UE:\na)\tshall set the \"T\" field in the CoAP header to 0 to indicate acknowledge message required;\nb)\tshall include the MSGin5G Server address in the Option header of the CoAP POST request and set the Option header to a corresponding value, e.g. if the MSGin5G Server address is a URI, the Uri-Path Option is set to the value of such URI;\nc)\tshall set the \"Content-Format\" element to \"50\" to indicate the format of the CoAP payload is \"application/json\"; and\nd)\tshall include the following information elements in the CoAP payload encoded in JSON format:\n1)\tthe \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\n2)\tthe \"Message Type\" element with a \"REG\" value to indicate that this CoAP POST request is used for registration;\n3)\tthe \"Registration urgent degree\" element with a\"false\" value to indicate that this registration is not urgent;\n4)\tthe \"UE Service ID\" element to indicate the MSGin5G UE initiating registration procedure;\n5)\toptionally, the \"MSGin5G Client Profile\" element to include a set of parameters describing the MSGin5G Client. This element may include the \"MSGin5G Client Triggering Information\" element and the \"MSGin5G Client Communication Availability\" element:\ni)\tThe \"MSGin5G Client Triggering Information\" element shall include:\n-\tthe \"MSGin5G UE ID\" element to indicate the MSGin5G UE hosting the MSGin5G Client; and\n-\teither:\n-\ta \"MSGin5G Client Port\" element to indicate the port number that the MSGin5G Client listens on for device triggers from the MSGin5G Server;or\n-\ta \"MSGin5G Client Ports\" element to indicate a List of port numbers that the MSGin5G Client listens on for device triggers from the MSGin5G Server and protocol (e.g., SMS, NIDD, etc.) associated with each port number; and\nii)\tthe \"MSGin5G Client Communication Availability\" element informs the MSGin5G Server whether the client has a specific application-level schedule/periodicity to its MSGin5G communications, which may be used in conjunction with UE reachability monitoring to determine whether and when MSGin5G communications are attempted. This element:\n-\tshall include the \"Scheduled communication time\" element to indicate the time when the UE becomes available for communication;\n-\tshall include the \"Communication duration time\" element to indicate the duration time of periodic communication;\n-\tmay include the \"Periodic communication indicator\" element to identify whether the client communicates periodically or not;\n-\tmay include the \"Periodic communication interval\" element to indicate the interval Time of periodic communication if \"Periodic communication indicator\" element is included;\n-\tmay include the \"Data size indication\" element to indicate the expected data size to be exchanged during the communication duration; and\n-\tmay include the \"Store and forward option\" element to indicate the UE does not request store and forward services for incoming MSGin5G requests;and\n6)\toptionally, the \"Registration request expiration time\" element to indicate the maximum processing time of the registration request allowed.\nUpon reception of the CoAP POST request containing MSGin5G service identifier indicating that the received request is for MSGin5G service and Message Type indicating that received request is for registration response, the MSGin5G Client in the Constrained UE generate a CoAP 2.04 (Change) response including the CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for registration.\nThe MSGin5G Client on the Constrained UE initiates a CoAP POST request to de-register from the MSGin5G Server. If the de-registration request is allowed to delay for bulk de-registration initiated by the MSGin5G Gateway UE, in the CoAP POST request, the MSGin5G Client on the Constrained UE:\na)\tshall set the \"T\" field in the CoAP header to 0 to indicate acknowledge message required;\nb)\tshall include the MSGin5G Server address in the Option header of the CoAP POST request and set the Option header to a corresponding value, e.g. if the MSGin5G Server address is a URI, the Uri-Path Option is set to the value of such URI;\nc)\tshall set the \"Content-Format\" element to \"50\" to indicate the format of the CoAP payload is \"application/json\"; and\nd)\tshall include the following information elements encoded in JSON format as specified in clause 7.3.3.a:\n1)\tthe \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\n2)\tthe \"Message Type\" element with a \"DEREG\" value to indicate that the CoAP POST request is used for de-registration;\n3)\tthe \"UE Service ID\" element to indicate the MSGin5G UE initiating de-registration procedure;\n4)\toptionally, the \"De-registration urgent degree\" element with a\"false\" value to indicate that this registration is not urgent; and\n5)\toptionally, the \"De-registration request expiration time\" element to indicate the maximum processing time of the registration request allowed.\nUpon reception of the CoAP POST request containing MSGin5G service identifier indicating that the received request is for MSGin5G service and Message Type indicating that received request is for de-registration response, the MSGin5G Client in the Constrained UE generate a CoAP 2.04 (Change) response including the CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for registration.\nUpon reception of the CoAP POST request containing the MSGin5G service identifier indicating that the received request is for MSGin5G service and Message Type indicating that the received request is for registration response, the Constrained UE shall generate CoAP 2.04 (Change) response including the CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for registration response.\nUpon reception of the CoAP POST request containing the MSGin5G service identifier indicating that the received request is for MSGin5G service and Message Type indicating that the received request is for de-registration response, the Constrained UE shall generate CoAP 2.04 (Change) response including the CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for de-registration response.\nUpon reception of the CoAP POST request containing MSGin5G service identifier indicating that the received request is for MSGin5G service and Message Type indicating that the received request is for registration, the MSGin5G Gateway Client shall check the value of the \"Registration urgent degree\" element included in the CoAP POST request as:\na)\tif the \"Registration urgent degree\" element with a\"true\" value is included, the MSGin5G Gateway Client shall forwards the CoAP POST request to the MSGin5G Server without any change.\nb)\tif the \"Registration urgent degree\" element with a \"false\" value is included, the MSGin5G Gateway Client:\n1)\tshall store or cache the whole CoAP POST request;\n2)\t\tshall generate a CoAP 2.01 (Created) response or CoAP 2.04 (Change) response including:\ni)\tthe CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for registration;\nii)\tthe \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\" . The CoAP payload shall include the \"UE Service ID\" element to indicate the Constrained UE initiating registration procedure. The CoAP payload may include the \"Expected registration time\" element to indicate the expected time when the Registration Response can be received; and\n3)\tmay start a timer associated with the \"UE Service ID\". If the \"Registration request expiration time\" element is included in the CoAP request from the Constrained UE, the expiration of the timer is set to the value of the \"Registration request expiration time\" element. Else, the MSGin5G Gateway Client determines whether to start a timer and the value of the timer based on implementation.\nThe MSGin5G Gateway Client may start a timer for periodic bulk registration based on implementation, e.g. when the first registration request from the constrained UE the \"false\" value of the \"Registration urgent degree\" element.\n\nBased on implementation, upon:\na)\texpiry of one or more timers started in 2) above;\nb)\texpiry of the timer for periodic bulk registration; or\nc)\texcess of the maximum number of MSGin5G UE registration requests from constrained UEs,\nthe MSGin5G Gateway Client may initiate a CoAP POST request to the MSGin5G Server including all cached/stored MSGin5G UE registration requests from the constrained UEs. In this CoAP POST request, the MSGin5G Client in the MSGin5G Gateway Client:\na)\tshall set the \"T\" field in the CoAP header to 0 to indicate acknowledge message required;\nb)\tshall include the MSGin5G Server address in the Option header of the CoAP POST request and set the Option header to a corresponding value, e.g. if the MSGin5G Server address is a URI, the Uri-Path Option is set to the value of such URI;\nc)\tshall set the \"Content-Format\" element to \"50\" to indicate the format of the CoAP payload is \"application/json\"; and\nd)\tshall include the following information elements in the CoAP payload encoded in JSON format:\n1)\tthe \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\n2)\tthe \"Message Type\" element with a \"BREG\" value to indicate that this CoAP POST request is used for bulk registration;\n3)\tthe \"UE Service ID\" element to indicate the MSGin5G UE initiating bulk registration procedure;\n4)\tthe \"Number of individual MSGin5G UE registration requests\" element to indicate the total number of MSGin5G UE registration requests which are bulked in this CoAP request; and\n5)\tthe \"List of individual MSGin5G UE registration request\" element to include one or more elements as specified in bullet d) of 6.3.1.1.1.\nNOTE:\tThe MSGin5G Gateway Client should consider the value of the \"Registration request expiration time\" element in the individual MSGin5G UE registration request from multiple contrained UEs to avoid failure of registration.\nUpon reception of the CoAP 2.01 (Created) response or CoAP 2.04 (Change) response for the CoAP POST message for bulk registration from the MSGin5G Server , the MSGin5G Gateway Client:\na)\tshall split content of the \"List of individual MSGin5G UE registration response\" element into multiple individual registration responses;\nb)\tshall generate one or more CoAP POST requests as registration responses to constrained UE(s) separately based on the cached the CoAP POST requests associated with the UE Service ID included in the individual registration responses. Each CoAP POST request includes:\n1)\tthe CoAP \"Message ID\" element and the \"Token\" element with the same values in the CoAP POST request for registration from the constrained UE; and\n2)\tthe \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\" and the CoAP payload including:\ni)\tthe \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\nii)\tthe \"Message Type\" element with a \"REGRESP\" value to indicate that this CoAP POST request is used as a registration response;\niii)\tthe \"UE Service ID\" element to indicate the constrained UE initiating registration procedure;\niv)\tthe \"Registration result\" element to indicate whether the registration is success or failure; and\nv)\tthe \"Failure Cause\" element to indicate reason for failure. This element shall be only present if the value of \"Registration result\" shows that the registration is failed.\n\nUpon reception of the CoAP POST request containing MSGin5G service identifier indicating that the received request is for MSGin5G service and Message Type indicating that the received request is for de-registration, the MSGin5G Gateway UE shall check the value of the \"Registration urgent degree\" element included in the CoAP POST request as:\na)\tif the \"de-registration urgent degree\" element with a\"true\" value is included, the MSGin5G Gateway UE shall forwards the CoAP POST request to the MSGin5G Server without any change.\nb)\tif the \"De-registration urgent degree\" element with a \"false\" value is included, the MSGin5G Gateway UE:\n1)\tshall store or cache the whole CoAP POST request;\n2)\t\tshall generate a CoAP 2.04 (Change) response including:\ni)\tthe CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for registration;\nii)\tthe \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\" and the CoAP payload encoded in JSON format as specified in clause 7.3.3.a including the \"UE Service ID\" element to indicate the MSGin5G UE initiating de-registration procedure and optionally the \"Expected registration time\" element to indicate the expected time when the De-registration Response can be received; and\n3)\tmay start a timer associated with the \"UE Service ID\". If the \"De-registration request expiration time\" element is included in the CoAP request from the Constrained UE, the expiration of the timer is set to the value of the \"de-registration request expiration time\" element. Else, the MSGin5G Gateway UE determines whether to start a timer and the value of the timer based on implementation.\nBased on implementation, upon:\na)\texpiry of one or more timers started in subclause 6.3.x.b.4;\nb)\texpiry of the timer for periodic bulk de-registration; or\nc)\texcess of the maximum number of MSGin5G UE de-registration requests from constrained UEs,\nthe MSGin5G Gateway UE may initiate a CoAP POST request to the MSGin5G Server including all cached/stored MSGin5G UE de-registration requests from the constrained UEs. In this CoAP POST request, the MSGin5G Client in the MSGin5G Gateway UE:\na)\tshall set the \"T\" field in the CoAP header to 0 to indicate acknowledge message required;\nb)\tshall include the MSGin5G Server address in the Option header of the CoAP POST request and set the Option header to a corresponding value, e.g. if the MSGin5G Server address is a URI, the Uri-Path Option is set to the value of such URI;\nc)\tshall set the \"Content-Format\" element to \"50\" to indicate the format of the CoAP payload is \"application/json\"; and\nd)\tshall include the following information elements encoded in JSON format as specified in clause 7.3.3.a:\n1)\tthe \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\n2)\tthe \"Message Type\" element with a \"DEREG\" value to indicate that the CoAP POST request is used for de-registration;\n3)\tthe \"UE Service ID\" element to indicate the MSGin5G UE initiating de-registration procedure;\n4)\tthe \"Number of individual MSGin5G UE de-registration requests\" element to indicate the total number of MSGin5G UE de-registration requests which are bulked in this CoAP request; and\n5)\tthe \"List of individual MSGin5G UE de-registration request\" element to include one or more elements as specified in bullet d) of 6.3.1.1.2.\nNOTE:\tThe MSGin5G Gateway UE should consider the value of the \"De-registration request expiration time\" element in the individual MSGin5G UE de-registration request from multiple constrained UEs to avoid failure of de-registration.\nUpon reception of the CoAP 2.04 (Change) response for the CoAP POST message for bulk de-registration from the MSGin5G Server , the MSGin5G Gateway UE:\na)\tshall split content of the \"List of individual MSGin5G UE de-registration response\" element into multiple individual de-registration responses;\nb)\tshall generate one or more CoAP POST requests as de-registration responses to constrained UE(s) separately based on the cached the CoAP POST requests associated with the UE Service ID included in the individual registration responses. Each CoAP POST request includes:\n1)\tthe CoAP \"Message ID\" element and the \"Token\" element with the same values in the CoAP POST request for de-registration from the constrained UE; and\n2)\tthe \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\" and the CoAP payload including:\ni)\tthe \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\nii)\tthe \"Message Type\" element with a \"DEREGRESP\" value to indicate that this CoAP POST request is used as a de-registration response;\niii)\tthe \"UE Service ID\" element to indicate the constrained UE initiating de-registration procedure;\niv)\tthe \"De-registration result\" element to indicate whether the de-registration is success or failure; and\nv)\tthe \"Failure Cause\" element to indicate reason for failure. This element shall be only present if the value of \"De-registration result\" shows that the de-registration is failed.\nUpon reception of the CoAP POST request containing MSGin5G service identifier indicating that the received request is for MSGin5G service and Message Type indicating that the received request is for bulk registration, the MSGin5G Server shall verify each UE service ID in the individual MSGin5G UE registration request included in the \"List of individual MSGin5G UE registration request\" element of the CoAP POST request. For each successful verification, the MSGin5G Server:\na)\tshall store the UE Service ID and the MSGin5G Client Profile information included in the individual MSGin5G UE registration request; and\nb)\tshall generate a CoAP 2.01 (Created) response or CoAP 2.04 (Change) response including the following parameters:\n1)\tthe CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for bulk registration; and\n2)\tthe \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\" and the CoAP payload including:\ni)\tthe \"Number of individual MSGin5G UE registration responses\" element to indicate total number of MSGin5G UE registration responses which are bulked in this response; and\nii)\tthe \"List of individual MSGin5G UE registration response\" element to include one or more elements as specified in bullet 2) of 6.3.1.2.1.\nUpon reception of the CoAP POST request containing MSGin5G service identifier indicating that the received request is for MSGin5G service and Message Type indicating that the received request is for bulk de-registration, the MSGin5G Server shall verify each UE service ID in the individual MSGin5G UE de-registration request included in the \"List of individual MSGin5G UE de-registration request\" element of the CoAP POST request. For each successful verification, the MSGin5G Server:\na)\tshall delete the UE Service ID and the MSGin5G Client Profile information included in the individual MSGin5G UE registration request; and\nb)\tshall generate a CoAP 2.04 (Change) response including the following parameters:\n1)\tthe CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for bulk de-registration; and\n2)\tthe \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\" and the CoAP payload including:\ni)\tthe \"Number of individual MSGin5G UE registration responses\" element to indicate total number of MSGin5G UE de-registration responses which are bulked in this response; and\nii)\tthe \"List of individual MSGin5G UE de-registration response\" element to include one or more elements as specified in bullet 2) of 6.3.1.2.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.5\tConstrained UE Registration to MSGin5G Gateway UE",
                            "text_content": "When the constrained UE with MSGin5G Client selects the MSGin5G Gateway UE, the MSGin5G Client on the MSGin5G UE will initiate the registration procedure to register the gateway service to the MSGin5G Gateway Client on the MSGin5G Gateway UE.\nUpon reception of the CoAP POST request containing MSGin5G service identifier indicating that the received request is for MSGin5G service and Message Type indicating that the received request is use to register to the gateway service, the MSGin5G Gateway Client on the MSGin5G Gateway UE:\na)\tshall check whether the MSGin5G UE identified by the UE service ID and MSGin5G UE ID, if available, is authorized to use the gateway service or not; and\nb)\tshall generate a CoAP 2.01 (Create) response or CoAP 2.04 (Change) response including the following parameters:\n1)\tthe CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for registration; and\n2)\tthe \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\" and the CoAP payload encoded in JSON format as specified in clause 7.3.3.x including:\ni)\tthe \"UE Service ID\" element to indicate the MSGin5G UE initiating registration procedure;\nii)\tthe \"Registration result\" element to indicate whether the registration is success or failure;\niii)\toptionally, the \"Accepted time till\" element to indicate the time when constrained device is allowed to use the gateway service; and\niv)\toptionally, the \"Failure Cause\" element to indicate the reason for failure.\nAfter selecting the MSGin5G Gateway UE, in order to register the gateway service to the MSGin5G Gateway Client on the MSGin5G Gateway UE, the MSGin5G Client on the constrained UE shall send a CoAP POST request to the MSGin5G Server according to procedures specified in IETF RFC 7252 [5]. In this CoAP POST request, the MSGin5G Client in the constrained UE:\na)\tshall set the \"T\" field in the CoAP header to 0 to indicate acknowledge message required;\nb)\tshall include the MSGin5G UE address in the Option header of the CoAP POST request and set the Option header to a corresponding value, e.g. if the MSGin5G UE address is a URI, the Uri-Path Option is set to the value of such URI;\nc)\tshall set the \"Content-Format\" element to \"50\" to indicate the format of the CoAP payload is \"application/json\"; and\nd)\tshall include the following information elements in the CoAP payload encoded in JSON format as specified in clause 7.3.3.1:\n1)\tthe \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\n2)\tthe \"Message Type\" element with a \"GWREG\" value to indicate that this CoAP POST request is used to register to the gateway service;\n3)\tthe \"UE Service ID\" element to indicate the MSGin5G UE initiating registration procedure;\n4)\toptionally, the \"MSGin5G UE ID\" element to represents the constrained UE; and\n5)\toptionally, the \"Time till\" element to indicate the time when constrained UE is intended to use the gateway service.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tMSGin5G Message delivery",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4.1\tProcedures between MSGin5G UE and MSGin5G Server",
                            "text_content": "This clause specifies the procedures for sending and receiving MSGin5G message, aggregated MSGin5G message, MSGin5G message delivery status report and aggregated MSGin5G message delivery status report at MSGin5G Client.\nIn order to send an MSGin5G message, the MSGin5G Client shall compare the size of the received message from the Application Client to the maximum allowed MSGin5G message segmentation size. If the size exceeds, the MSGin5G Client shall segment the MSGin5G message into a set of segmented MSGin5G messages such that each segmented MSGin5G message can fit within the maximum allowed MSGin5G message segmentation size. For each segmented MSGin5G message, the steps listed below shall be processed individually.\nThe MSGin5G Client shall send the MSGin5G message in a CoAP POST request message according to procedures specified in IETF RFC 7252 [5]. In the CoAP POST request message, The MSGin5G Client:\na)\tshall set the \"T\" field in the CoAP header to 0 if delivery status report from the recipient is requested, i.e. indicates that this message is the type of Confirmable, to ensure the application layer delivery status report;\nb)\tshall include the MSGin5G Server address in a CoAP Option, e.g. if the MSGin5G Server address is a URI, includes a Uri-Path Option with the value of the URI;\nc)\tshall set the CoAP Content-Format to \"50\", i.e. application/json;\nd)\tshall include the information elements specified in 3GPP TS 23.554 [2] in the CoAP payload encoded in JSON format as specified in clause 7.3.4:\n1)\tshall include an \"MSGin5G service identifier\" element to indicate that this CoAP POST request message is used for MSGin5G service;\n2)\tshall include a \"Message Type\" element and set it to \"MSG\" to indicate that this CoAP POST request message is used for MSGin5G message;\n3)\tshall include an \"Originating UE Service ID\" element set to the UE which requests the sending of the MSGin5G message;\n4)\tshall include a \"Recipient UE Service ID/AS Service ID\" element if the recipient is an MSGin5G UE/Non-MSGin5G UE or Application Server;\n5)\tshall include a \"Group Service ID\" element if the recipient is an MSGin5G Group;\n6)\tshall include a \"Broadcast Area ID\" element if the message needs to be broadcast;\n7)\tshall include a \"Messaging Topic\" element if this message will be distributed based on message topic. This element shall not present in other message scenarios;\nNOTE:\tIn an MSGin5G Message request, only one of these IEs listed from step 4) to step 6) shall be included.\n8)\tmay include one or more \"Application ID\" elements to indicate the application(s) for which the payload is(are) intended;\n9)\tshall include a \"Message ID\" which is globally unique within the MSGin5G service to identify this specific MSGin5G message;\n10)\tmay include a \"Delivery status required\" element if delivery acknowledgement from the recipient is requested;\n11)\tmay include a \"Priority type\" element to indicate the application priority level requested for this message;\n12)\tmay include a \"Message is segmented\" element with a \"true\" value to indicate that this message is part of a segmented message;\n13)if \"Message is segmented\" element with a \"true\" value is included, shall include a \"Segmentation set identifier\" element to indicate that this segmented message is associated within a set of segmented messages. All segmented messages associated with the same MSGin5G message shall be assigned the same unique identifier;\n14)\tif \"Message is segmented\" element with a \"true\" value is included and this message is the first segment of the set of segmented messages, shall include a \"Total number of message segments\" element to indicate the total number of segments for the MSGin5G message;\n15)\tif \"Message is segmented\" element with a \"true\" value is included, shall include a \"Message segment number\" element to indicate the number of each segmented message within a set of segmented messages;\n16)\tif \"Message is segmented\" element with a \"true\" value is included and this message is the last segment of the set of segmented messages, shall include a \"Last segment flag\" element to indicate that this segmented message is the last segment in the set of segmented messages;\n17)shall include a \"Store and forward flag\" element to indicate whether store and forward services are requested for this message;\n18)\tif store and forward services are requested, may include a \"Store and forward parameters\" element to carry the parameters used by MSGin5G Server for providing store and forward services. The \"Store and forward parameters\":\ni)\tmay include a \"Message expiration time\" element to indicate the message expiration time used for providing store and forward services if the destination is not available for communications; and\nii)\tmay include an \"Application specific store and forward information\" element to carry the information used by MSGin5G Server for handling store and forward, e.g. a delivery time/date; and\n19)\tmay include a \"Payload\" element which carries the application payload that is transferred by the MSGin5G Service in the CoAP payload and located it after the elements listed from step 1) to 19); The content of \"Payload\" element is transparent to the MSGin5G Service; and\ne)\tif needed, i.e. a message segment recovery request is received, acts as Message Sender to perform the procedures in clause 6.5.1.1.\nBefore the sending of an MSGin5G message, the MSGin5G Client shall check if aggregation is allowed for this message, check the message data size, and the priority level to determine if the message can be aggregated. For example, if the MSGin5G Client finds that the messages have small payload size when compared to the maximum segment size that can be transmitted over CoAP and the messages are not high priority messages, which could be sent as per scheduling policy towards a selected target, the MSGin5G Client can decide to aggregate messages until optimal use of segment size before sending message towards MSGin5G Server.\nIf the message can be aggregated, the MSGin5G Client aggregates multiple MSGin5G message requests intended for a selected target and sends the aggregated message in a single CoAP POST request message. The sending of the CoAP POST request message shall follow the procedures specified in clause 6.4.1.1.2 with the clarifications listed below:\na)\tThe MSGin5G Client should not segment the aggregated message, so in step d) of clause 6.4.1.1.2, the \"Message is segmented\", \"Segmentation set identifier\", \"Total number of message segments\", \"Message segment number\" and \"Last segment flag\" elements should not be included.\nb)\tIn addition to the step d) of clause 6.4.1.1.2, the MSGin5G Client should include a \"Number of individual messages\" element in this message to indicate the total number of messages which are aggregated into this single message.\nc)\tIn addition to the step d) of clause 6.4.1.1.2, the MSGin5G Client should include a \"List of individual messages\" element in this message. Each child element of this \"List of individual messages\" element contains information elements listed below:\n1)\t\"Message ID\" of the individual message;\n2)\t\"Payload\" which carries the application payload that is transferred by the individual MSGin5G message;\n3)\tone or more optional \"Application ID\" elements;\n4)\tan optional \"Delivery status required\" element; and\n5)\tan optional \"Priority type\" element.\nd)\tThe MSGin5G Client should not include the \"Payload\" element outside the \"List of individual messages\" element, i.e. the 19) in step e) of clause 6.4.1.1.2 shall not be processed.\nIn order to send a MSGin5G message delivery status report, the MSGin5G Client shall send an CoAP POST request according to procedures specified in IETF RFC 7252 [5]. In the CoAP POST request, the MSGin5G Client:\na)\tshall sets the \"T\" field in the CoAP header to 0, i.e. indicates that this message is the type of Confirmable, to ensure that the MSGin5G message delivery status report can be received by the originator of the receiving MSGin5G message;\nb)\tshall include the MSGin5G Server address in an CoAP Option, e.g. if the MSGin5G Server address is a URI, includes a Uri-Path Option with the value of the URI;\nc)\tshall set the CoAP Content-Format to \"50\", i.e. application/json; and\nd)\tshall include the information elements specified in 3GPP TS 23.554 [2] in the CoAP payload encoded in JSON format as specified in clause 7.3.4.2:\n1)\tshall include an \"MSGin5G service identifier\" element to indicate that this CoAP POST request message is used for MSGin5G service;\n2)\tshall include an \"Message Type\" element and set it to \"IMDN\" to indicate that this CoAP POST request message is used for MSGin5G message delivery status report;\n3)\tshall include an \"Originating UE Service ID\" element set to the UE which requests the sending of the MSGin5G message delivery status report;\n4)\tshall include a \"Recipient UE Service ID/AS Service ID\" element if the recipient is an MSGin5G UE/Non-MSGin5G UE or an Application Server. This element indicates is the sender of the message that this message delivery status report is for;\n5)\tshall include the \"Message ID\" element copied from the MSGin5G message that is being acknowledged;\n6)\tshall include a \"Delivery Status\" element to carry the delivery status description. The delivery status can be success or failure in delivery; and\n7)\tmay include a \"Failure Cause\" element to indicate the failure reason if the delivery status is failure.\nThe MSGin5G Client can aggregate multiple MSGin5G message delivery status reports into one single message. The MSGin5G Client shall check whether the MSGin5G message delivery status reports can be aggregated as specified in clause 6.4.1.1.3.\nIf the MSGin5G message delivery status reports can be aggregated, the MSGin5G Client aggregates MSGin5G message delivery status reports intended for a selected target and sends the aggregated MSGin5G message delivery status reports in a single CoAP POST request message. The sending of the CoAP POST request message shall follow the procedures specified in clause 6.4.1.1.4 with the clarifications listed below:\na)\tIn step d) of clause 6.4.1.1.4, the \"Delivery Status\" element and the \"Failure Cause\" element should not be included.\nb)\tIn addition to the step d) of clause 6.4.1.1.4, the MSGin5G Client should include a \"Number of individual messages\" element in this message to indicate the total number of MSGin5G message delivery status reports which are aggregated into this single message.\nc)\tIn addition to the step d) of clause 6.4.1.1.4, the MSGin5G Client should include a \"\"List of individual messages\" element in this message. Each child element in this \"List of individual messages\" element contains information elements listed below:\n1)\t\"Message ID\" of the individual MSGin5G message delivery status reports which is copied from the MSGin5G message that is being acknowledged;\n2)\t\"Delivery Status\" element; and\n3)\tan optional \"Failure Cause\" element.\nUpon receiving an CoAP POST request containing the MSGin5G Service identifier and the \"Message Type\" with the value \"MSG\", if the \"Number of individual messages\" element and \"List of individual messages\" element are not included, the MSGin5G Client shall handle the CoAP POST request according to procedures specified in IETF RFC 7252 [5] with the clarifications listed below:\na)\tThe MSGin5G Client shall check whether a \"Message is segmented\" element is included in the CoAP POST request. If this element is included, the MSGin5G Client shall wait until all the segmented messages have been received by checking the \"Segmentation set identifier\", \"Total number of message segments\", \"Message segment number\" and \"Last segment flag\" elements. The MSGin5G Client shall reassemble all the segmented messages into a single MSGin5G message.\nb)\tThe MSGin5G Client shall provide the received information in the \"payload\" element to the Application Client(s) if one or more \"Application ID\" elements are included. The Application Client(s) is(are) indicated by the \"Application ID\" element(s):\n1)\tIf the Application Client is on the other MSGin5G UE-2 for which this MSGin5G Client is acting as MSGin5G Relay UE or MSGin5G Gateway UE, the MSGin5G Client shall send the received information to the corresponding MSGin5G UE via MSGin5G-6 (if MSGin5G Client is supported by MSGin5G UE-2) as specified in clause 6.4.2.4 or MSGin5G-5 reference point (if MSGin5G Client is not supported by MSGin5G UE-2) as specified in clause 6.4.2.2.\n2)\tIf the Application Client is on the same MSGin5G UE with the MSGin5G Client, the MSGin5G Client shall deliver the received information to the Application Client via MSGin5G-5 reference point.\nNOTE:\twhen the Application Client and MSGin5G Client are resided on the same MSGin5G UE, the interaction in MSGin5G-5 reference point may implementation specific and is out of scope of the present document.\nc)\tIf a \"Delivery status required\" element is included in the CoAP POST request, the MSGin5G Client shall send an MSGin5G message delivery status report as specified in clause 6.4.1.1.4 or clause 6.4.1.1.5 with the clarifications listed below:\n1)\tif the message delivery status is supported by the Application Client(s), the MSGin5G message delivery status report shall be sent after the delivery status information is received from the Application Client(s), and shall be generated based on this(these) delivery status information; or\n2)\tif the message delivery status is not supported by the Application Client, the MSGin5G message delivery status report shall be sent immediately by the MSGin5G Client on behalf of the Application Client(s).\nUpon receiving an CoAP POST request containing the MSGin5G Service identifier and the \"Message Type\" with the value \"MSG\", if a \"Number of individual messages\" and a \"List of individual messages\" are included, the MSGin5G Client determines that this message is an aggregated MSGin5G message. The MSGin5G Client shall handle the CoAP POST request according to procedures specified in IETF RFC 7252 [5] with the clarifications listed below:\na)\tThe MSGin5G Client shall split the received aggregated message request into multiple new created individual MSGin5G messages:\n1)\tall elements listed in step d) of clause 6.4.1.1.2 included in the received MSGin5G message, except the \"Message ID\", \"Message is segmented\", \"Segmentation set identifier\", \"Total number of message segments\", \"Message segment number\" and \"Last segment flag\" elements, are copied to each new created individual MSGin5G message; and\n2)\teach child element of the \"List of individual messages\" element in the received aggregated MSGin5G message is included in a new created individual MSGin5G message. The \"Message ID\", \"Payload\", \"Application ID\" (if present), \"Delivery status required\" (if present) and \"Priority type\" (if present) in the child element of the \"List of individual messages\" are used as the same elements in the new created individual MSGin5G message; and\nb)\tThe MSGin5G Client shall handle each individual MSGin5G messages according to step b) and c) specified in clause 6.4.1.1.6.\nUpon receiving an CoAP POST request containing the MSGin5G Service identifier and the \"Message Type\" with the value \"IMDN\", if the \"Number of individual messages\" element and \"List of individual messages\" element are not be included and a \"Delivery Status\" element is included, the MSGin5G Client shall handle the CoAP POST request according to procedures specified in IETF RFC 7252 [5] with the clarifications listed below:\na)\tThe MSGin5G Client shall provide the received information in the \"Delivery Status\" element and the \"Failure Cause\" element (if applicable) to the Application Client(s) if one or more \"Application ID\" elements are included. The Application Client(s) is(are) indicated by the \"Application ID\" element(s):\n1)\tIf the Application Client on the other MSGin5G UE for which this MSGin5G Client is acting as MSGin5G Relay UE or MSGin5G Gateway UE, the MSGin5G Client shall send the received information to the corresponding MSGin5G UE via MSGin5G-6 (if MSGin5G Client is supported by MSGin5G UE-2) as specified in clause 6.4.2.4 or MSGin5G-5 reference point (if MSGin5G Client is not supported by MSGin5G UE-2) as specified in clause 6.4.2.2.\n2)\tIf the Application Client is on the same MSGin5G UE with the MSGin5G Client, the MSGin5G Client shall deliver the received information to the Application Client via MSGin5G-5 reference point.\nNOTE:\twhen the Application Client and MSGin5G Client are resided on the same MSGin5G UE, the interaction in MSGin5G-5 reference point may implementation specific and is out of scope of the present document.\nUpon receiving an CoAP POST request containing the MSGin5G Service identifier and the \"Message Type\" with the value \"IMDN\", if a \"Number of individual messages\" and a \"List of individual messages\" are included, the MSGin5G Client determines that this message is an aggregated MSGin5G message. The MSGin5G Client shall handle the CoAP POST request according to procedures specified in IETF RFC 7252 [5] with the clarifications listed below:\na)\tThe MSGin5G Client shall split the received aggregated MSGin5G message request into multiple new created individual MSGin5G messages:\n1)\tall elements listed in step d) of clause 6.4.1.1.4 included in the received MSGin5G message, except the \"Message ID\", \"Delivery Status\" and the \"Failure Cause\" elements, are copied to each new created individual MSGin5G message; and\n2)\teach child element of the \"List of individual messages\" element in the received aggregated MSGin5G message is included in a new created individual MSGin5G message. The\"Message ID\", \"Delivery Status\" and the \"Failure Cause\" (if present) in the child element of the \"List of individual messages\" are used as the same elements in the new created individual MSGin5G message; and\nb)\tIf \"Delivery Status\" element is included in the new created individual MSGin5G message, the MSGin5G Client determines that the new created individual MSGin5G messages are MSGin5G delivery status reports. The MSGin5G Client shall handle each individual MSGin5G delivery status report according to step a) specified in clause 6.4.1.1.8.\nAn MSGin5G Server provides server-side functionality of messages delivery among MSGin5G UE, Application Server and Message Gateway. A messages delivery procedure in the MSGin5G Server can be divided to origination and termination procedures.\nThe origination procedure may consist:\na)\tthe reception of messages at the MSGin5G Server;\nb)\tthe related authentication and authorization of the message on the MSGin5G Server; and\nc)\tthe possible message response to the sender.\nNOTE:\tIf the message is received from the other MSGin5G Server in the same service domain, the step b) above may be skipped.\nWhen the MSGin5G Server receives message from MSGin5G UE, the reception procedures is specified in clause 6.4.1.2.2, 6.4.1.2.3, 6.4.1.2.4 and 6.4.1.2.5. When the MSGin5G Server receives message from Application Server, Message Gateway or another MSGin5G Server, the reception procedure is specified in 3GPP TS 29.538 [7].\nThe termination procedure consists the MSGin5G Server delivery of a message.\nBefore the MSGin5G Server delivers a message, the MSGin5G Server shall analysis the communication model of the message by analysis the Service ID of the recipient in the message, then generates a new message based on the received message and send it to the recipient:\na)\tif a \"Recipient UE Service ID\" element is included, this message is a Point-to-Point message or an Application-to-Point message. The MSGin5G Server analyzes the URI:\n1)\tif the URI points to an MSGin5G Client served by this MSGin5G Server, the MSGin5G Server send the MSGin5G message to the MSGin5G Client via MSGin5G-1 reference point as specified in clause 6.4.1.2.6, 6.4.1.2.7, 6.4.1.2.8 or 6.4.1.2.9; or\n2)\tif the URI points to a Message Gateway served by this MSGin5G Server, the MSGin5G Server sends the message to the Message Gateway via MSGin5G-2 or MSGin5G-4 reference point as specified in 3GPP TS 29.538 [7];\n3)\tif the URI points to a MSGin5G Client or Message Gateway served by another MSGin5G Server, the MSGin5G Server sends the message to the other MSGin5G Server which serves the MSGin5G Client or Message Gateway via MSGin5G-8 reference point as specified in 3GPP TS 29.538 [7];\nNOTE:\tThe analysis procedure is implementation specific, e.g. by querying the DNS or local database, and is out of scope of the present document.\nb)\tif a \"Recipient AS Service ID\" element is included, this message is a Point-to-Application message. The MSGin5G Server analysis the URI:\n1)\t if the URI points to an Application Server served by this MSGin5G Server, the MSGin5G Server sends the message to the Application Server via MSGin5G-3 reference point as specified in 3GPP TS 29.538 [7];\n2)\t if the URI points to an Application Server served by another MSGin5G Server, the MSGin5G Server sends the message to the MSGin5G Server which serves the Application Server via MSGin5G-8 reference point as specified in 3GPP TS 29.538 [7];\nc)\tif a \"Group Service ID\" element is included, this message is a Group message. The MSGin5G Server obtains the group members by checking the group profile with the \"Group Service ID\". For each group member, the MSGin5G Server analyzes its UE Service ID and sends the message to it as specified in step a);\nd)\tif a \"Broadcast Area ID\" element is included, this message is a Broadcast message. The MSGin5G Server forwards the Broadcast message request to the CBCF (as specified in 3GPP TS 23.041 [21]) via the Broadcast Message Gateway and MSGin5G-7 reference point based on the Broadcast Area ID as specified in 3GPP TS 29.538 [7]; and\ne)\tif a \"Messaging Topic\" element is included, this message is needed to be distributed based on message topic. The MSGin5G Server obtains the subscribers of the Messaging Topic by checking the related subscription. The subscriber of the Messaging Topic can be MSGin5G UE, Application Server or Message Gateway (on behalf of non-MSGin5G UE). For each subscriber, the MSGin5G Server analyzes its Service ID and sends the message to it as specified in step a) or b).\nUpon receiving an CoAP POST request from an MSGin5G Client on an MSGin5G UE, containing the MSGin5G Service identifier and the \"Message Type\" with the value \"MSG\", i.e. the request is for sending an MSGin5G message, the MSGin5G Server executes the messages origination procedure. If the \"Number of individual messages\" element and \"List of individual messages\" element are not be included, the MSGin5G Server shall handle the CoAP POST request according to procedures specified in IETF RFC 7252 [5] with the clarifications listed below:\na)\tThe MSGin5G Server shall authenticate the message and shall verify that the sending UE is authorized to send the message by checking the registration status of the MSGin5G Client and the \"Originating UE Service ID\" element in the CoAP payload. If message is needed to be rejected, the MSGin5G Server shall send a message response in a new CoAP POST request to the originating entity as specified in step e) and skips the rest steps in this clause;\nb)\tThe MSGin5G Server executes the message segment related procedures as specified in clause 6.5.3 if needed;\nc)\tVoid;\nd)\tIf the message is stored for deferred delivery as specified in clause 6.4.1.2.6 or 6.4.1.2.7, the MSGin5G Server shall send a message response in a new CoAP POST request to the originating entity as specified in step e); and\ne)\tThe MSGin5G Server shall send a message response in a new CoAP POST request to the originating entity as specified in IETF RFC 7252 [5] with the clarifications listed below:\n1)\tmay set the \"T\" field in the CoAP header to 0 or 1;\n2)\tshall include the originating MSGin5G Client's address in an CoAP Option, e.g. if the originating MSGin5G Client address is a URI, includes a Uri-Path Option with the value of the URI;\n3)\tshall set the CoAP Content-Format to \"50\", i.e. application/json; and\n4)\tshall include the information elements specified in 3GPP TS 23.554 [2] in the CoAP payload encoded in JSON format as specified in clause 7.3.4.3:\ni)\tshall include an \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\nii)\tshall include an \"Originating UE Service ID\" element set to the UE which sends the MSGin5G message this message response is responded to;\niii)\tshall include the \"Message ID\" copied from the received MSGin5G message which this message response is responded to;\niv)\tmay include a \"Delivery Status\" element to indicate that the delivery status of this MSGin5G message is a failure, or is stored for deferred delivery;\nv)\tmay include a \"Failure Cause\" element to indicate the reason for failure; and\nvi)\tin addition to the information elements specified in 3GPP TS 23.554 [2], shall also include a \"Message Type\" element set to \"MSGRESP\" to indicate that this message is a message response.\nUpon receiving an CoAP POST request from an MSGin5G Client on an MSGin5G UE, containing the MSGin5G Service identifier and the \"Message Type\" with the value \"MSG\", if a \"Number of individual messages\" and a \"List of individual messages\" are included, the MSGin5G Server determines that this message is an aggregated MSGin5G message. The MSGin5G Server shall handle the whole aggregated MSGin5G message according to procedures specified in clause 6.4.1.2.2.\nUpon receiving an CoAP POST request from an MSGin5G Client on an MSGin5G UE, containing the MSGin5G Service identifier and the \"Message Type\" with the value \"IMDN\", if the \"Number of individual messages\" element and \"List of individual messages\" element are not be included and a \"Delivery Status\" element is included, the MSGin5G Server shall handle the CoAP POST request according to procedures specified in IETF RFC 7252 [5] with no additional requirement.\nUpon receiving an CoAP POST request from an MSGin5G Client on an MSGin5G UE, containing the MSGin5G Service identifier and the \"Message Type\" with the value \"IMDN\", if a \"Number of individual messages\" and a \"List of individual messages\" are included, the MSGin5G Server determines that this message is an aggregated MSGin5G message. The MSGin5G Server shall handle the whole aggregated MSGin5G delivery status report according to procedures specified in clause 6.4.1.2.4.\nIn order to deliver the MSGin5G message, the MSGin5G Server executes the messages termination procedure. The MSGin5G Server shall determine the communication model of the message as specified in clause 6.4.1.2.1.\nIf the MSGin5G Server determines to deliver the MSGin5G message to an MSGin5G UE served by itself as specified in clause 6.4.1.2.1, the MSGin5G Server shall check the registration information of the recipient MSGin5G Client in MSGin5G UE, if the MSGin5G UE state is \"registered\" for the MSGin5G service the MSGin5G Server will start the delivery procedure.\nIf the MSGin5G UE provides the \"communication availability\" information during the registration, the MSGin5G Server will schedule the message delivery based on this information, e.g. delivers the MSGin5G message in the delivery window based on the specific application-level schedule/periodicity. The MSGin5G Server can also use UE reachability status monitoring specified in 3GPP TS 29.538 [7] to determine whether the recipient is available. If the recipient is available, the MSGin5G Server tries to deliver the MSGin5G message to the MSGin5G UE.\nIn order to deliver the MSGin5G message, the MSGin5G Server shall send the MSGin5G message in an new CoAP message according to procedures specified in IETF RFC 7252 [5] via MSGin5G-1 reference point. The sending of the CoAP message shall follow the procedures below:\na)\tthe MSGin5G Server shall set the \"T\" field in the CoAP header to 0 if delivery status report from the recipient is requested, i.e. indicate that this message is the type of Confirmable, to ensure the application layer delivery status report;\nb)\tthe MSGin5G Server shall set the CoAP Content-Format to \"50\", i.e. application/json;\nc)\tthe MSGin5G Server shall remove any \"Priority type\" element, \"Store and forward flag\" and related \"Store and forward parameters\" elements from the CoAP payload of the received message. If \"Message is segmented\" and related elements is included in the received message, the MSGin5G Server shall handle the message as specified in clause 6.5.3;\nd)\tbased on the communication model, the MSGin5G Server shall generate the new CoAP message as specified below:\n1)\tif the Service ID of the recipient points to an MSGin5G Client, the MSGin5G Server:\ni)\tshall include the recipient MSGin5G Client address in an CoAP Option, e.g. if the MSGin5G Client address is a URI, include a Uri-Path Option with the value of the URI; and\nii)\tshall copy other elements in the CoAP payload of the received message to the new CoAP POST request;\n2)\tif the Service ID of the recipient points to an Application Server or a Message Gateway, the MSGin5G Server shall follow the procedure specified in 3GPP TS 29.538 [7];\n3)\tif the MSGin5G message is a Group message, the MSGin5G Server:\ni)\tshall obtain the group members by checking the group profile with the \"Group Service ID\" element included in the received MSGin5G message; and\nii)\tfor each group member which is an MSGin5G UE, include its CoAP address got from the recipient MSGin5G UE registration specified in clause 6.3.1.2 in an CoAP Option, e.g. if the recipient client's address is a URI, includes a Uri-Path Option with the value of the URI. The MSGin5G Server shall add the \"Recipient UE Service ID\" element and set the value of it to the UE Service ID. The MSGin5G Server shall also copy other elements in the CoAP payload of the received message to the new CoAP POST request;\n4)\tif the MSGin5G message is needed to be distributed based on message topic, the MSGin5G Server:\ni)\tshall obtain the UE Service ID/AS Service ID of the subscribers by checking the subscription with this Messaging Topic; and\nii)\tfor each subscriber which is an MSGin5G UE, include its CoAP address got from the recipient MSGin5G UE registration specified in clause 6.3.1.2 in an CoAP Option, e.g. if the recipient client's address is a URI, includes a Uri-Path Option with the value of the URI. The MSGin5G Server shall add the \"Recipient UE Service ID\" element and set the value of it to the UE Service ID. The MSGin5G Server shall also copy other elements in the payload of the received message to the new CoAP 2.05 response; and\n5)\tif the MSGin5G message is a broadcast message, the MSGin5G Server shall forward the Broadcast message request to the CBCF (as specified in 3GPP TS 23.041 [21]) via the Broadcast Message Gateway as specified in 3GPP TS 29.538 [7]; and\ne)\tbefore sending the new CoAP message generated in step d), the MSGin5G Server shall compare the size of the new CoAP message to the maximum allowed MSGin5G message segmentation size. If the size exceeds, the MSGin5G Server shall segment the MSGin5G message into a set of segmented MSGin5G messages such that each segmented MSGin5G message can fit within the maximum allowed MSGin5G message segmentation size. For each segmented MSGin5G message, the MSGin5G Server:\n1)\tshall include a \"Message is segmented\" element with a \"true\" value to indicate that this message is part of a segmented message;\n2)\tshall include a \"Segmentation set identifier\" element to indicate that this segmented message is associated within a set of segmented messages. The same unique identifier is assigned to all segmented messages associated with the same MSGin5G message;\n3)\tshall include a \"Total number of message segments\" element in the first segment of the MSGin5G message to indicate the total number of segments for the MSGin5G message;\n4) shall include a \"Message segment number\" element to indicate segmented message number of each segmented message within the set of segmented messages; and\n5)\tshall include a \"Last segment flag\" element in the last segment in the set of segmented messages;\nIf the MSGin5G UE state is \"not registered\", based on local implementation, the MSGin5G Server may try to inform the MSGin5G UE via the device triggering procedure as specified in 3GPP TS 29.538 [7] about an incoming message and the MSGin5G UE needs to register and receive the message.\nThe MSGin5G Server checks the availability of recipient by checking the UE registration status. The MSGin5G Server may also use UE reachability status monitoring specified in 3GPP TS 29.538 [7] to determine whether the recipient is available. If the recipient is available, the MSGin5G Server send the new CoAP message generated as above to the recipient. If the recipient is unavailable, the MSGin5G Server checks whether a \"Store and forward flag\" element indicates that \"Store and forward\" service is requested for this MSGin5G message:\na1)\tif the \"Store and forward flag\" element indicates that \"Store and forward\" service is not requested, the MSGin5G Server discards the message or local implementation may apply. The MSGin5G Server may send a message response as specified in clause 6.4.1.2.2 which includes delivery status information in the \"Delivery Status\" element, e.g., that the message was discarded; and\nb1)\tif the \"Store and forward flag\" element indicates that \"Store and forward\" service is requested, the MSGin5G Server stores the message temporarily and waits for the next delivery opportunity until the expiration time of this message which is included in the \"Message expiration time\" element in the \"Store and forward parameters\"  element passed. The delivery opportunity may be known by the MSGin5G Server by the registration of recipient MSGin5G Client or by obtaining the information from the \"Store and forward parameters\" element, e.g.from the \"Application specific store and forward information\" element. The MSGin5G Server may send a message response as specified in clause 6.4.1.2.2 which includes store and forward status information in the \"Delivery Status\" element, e.g., the delivery had been deferred; and\nc1)\twhen the delivery opportunity comes, the MSGin5G Server attempts delivery of the new CoAP message to the recipient. If the UE delivery opportunity does not come until the expiration time of this message which is included in the \"Message expiration time\" element in the \"Store and forward parameters\" element passed, the MSGin5G Server attempts delivery of the new CoAP message at the message expiration time, e.g. try to inform the MSGin5G UE via the device triggering procedure as specified in 3GPP TS 29.538 [7], and if the delivery is still failed, the stored message is discarded. The MSGin5G Server may send a message response as specified in clause 6.4.1.2.2 which includes store and forward status information the \"Delivery Status\" element, e.g., that the message was discarded.\n\nIf the MSGin5G Server receives an aggregated MSGin5G message as specified in clause 6.4.1.2.3, and the received aggregated MSGin5G message is smaller than the supported message segment size of the recipient, it shall send it as specified in clause 6.4.1.2.6 without splitting the received aggregated message request into multiple individual MSGin5G message.\nIf the received aggregated MSGin5G message is larger than the supported message segment size of the recipient, the MSGin5G Server should remove the last individual message in the List of individual messages element from the aggregated message until the aggregated message is smaller than the maximum segmentation size that can be transmitted over available transport, and then send the remaining aggregated MSGin5G message as specified in clause 6.4.1.2.6. The MSGin5G messages removed from the aggregated message may be sent individually or aggregated again by the MSGin5G Server according to service configuration.\nNOTE:\tAggregated MSGin5G message is supported by all MSGin5G Clients and Application Servers. MSGin5G message and MSGin5G delivery status report cannot be aggregated in the same aggregated MSGin5G message.\nIf the MSGin5G Server receives an MSGin5G message as specified in clause 6.4.1.2.2, it may send multiple MSGin5G messages toward the same recipient in an aggregated MSGin5G message. Before the sending of an MSGin5G message, the MSGin5G Server shall check if aggregation is allowed for this message, MSGin5G Server shall also check the message data size, and the priority level to determine if the message can be aggregated. For example, if the MSGin5G Server finds that the received messages have small payload size when compared to the maximum segment size that can be transmitted over CoAP and the messages are not high priority messages, which could be sent as per scheduling policy towards a selected target. The MSGin5G Server can decide to aggregate messages until optimal use of segment size before sending message towards MSGin5G Client.\nIf the message can be aggregated, the MSGin5G Server aggregates multiple MSGin5G messages, and sends the aggregated message in a single CoAP POST request message. The sending of the CoAP POST request message shall follow the procedures specified in clause 6.4.1.2.6 with the clarifications listed below:\na)\tThe MSGin5G Server should not segment the aggregated message, so the MSGin5G Server should ensure that the new aggregated MSGin5G message is smaller than the maximum allowed MSGin5G message segmentation size and skips the step e) in clause 6.4.1.2.6. The \"Message is segmented\", \"Segmentation set identifier\", \"Total number of message segments\", \"Message segment number\" and \"Last segment flag\" elements should not be included in the aggregated MSGin5G message.\nb)\tIn addition to the elements specified in clause 6.4.1.2.6, the MSGin5G Server should include a \"Number of individual messages\" element in this message to indicate the total number of messages which are aggregated into this single message.\nc)\tIn addition to the elements specified in clause 6.4.1.2.6, the MSGin5G Server should include a \"List of individual messages\" element in this message. Each child element of this \"List of individual messages\" element contains information elements listed below:\n1)\tan \"Message ID\" to identify the individual message;\n2)\ta \"Payload\" which carries the application payload that is transferred by the individual MSGin5G message;\n3)\tone or more optional \"Application ID\" element(s);\n4)\tan optional \"Delivery status required\" element; and\n5)\tan optional \"Priority type\" element.\nUpon receiving an MSGin5G delivery status report as specified in clause 6.4.1.2.4, the MSGin5G Server may generate a new CoAP POST request containing the MSGin5G delivery status report if the MSGin5G Server decides not to aggregate the delivery status report. The new CoAP POST request is sent to the recipient obtained from the \"Recipient UE Service ID\" element in the payload of the received CoAP POST request. The MSGin5G Server:\na)\tshall set the \"T\" field in the CoAP header to 0;\nb)\tshall include the recipient address in the Option header of the CoAP message and set the Option header to a corresponding value, e.g. if the MSGin5G Client address is a URI, includes a Uri-Path Option with the value of the URI; and\nc)\tshall copy other elements in the payload of the received message to the new CoAP POST request.\nIf the MSGin5G Server receives an aggregated MSGin5G delivery status report as specified in clause 6.4.1.2.5, it shall generate a new CoAP POST request containing the aggregated MSGin5G delivery status report and sends it to the recipient obtained from the \"Recipient UE Service ID\" element in the payload of the received CoAP POST request. The MSGin5G Server:\na)\tshall set the \"T\" field in the CoAP header to 0;\nb)\tshall include the recipient address in the Option header of the CoAP message and set the Option header to a corresponding value, e.g. if the MSGin5G Client address is a URI, includes a Uri-Path Option with the value of the URI; and\nc)\tshall copy other elements in the payload of the received message to the new CoAP POST request.\nIf the MSGin5G Server receives MSGin5G delivery status report as specified in clause 6.4.1.2.4, it may aggregate multiple MSGin5G message delivery status reports into one single message. The MSGin5G Server shall check whether the MSGin5G message delivery status reports can be aggregated as specified in clause 6.4.1.2.7.\nIf the MSGin5G message delivery status reports can be aggregated, the MSGin5G Server aggregates MSGin5G message delivery status reports intended for a selected target and sends the aggregated MSGin5G message delivery status reports in a single CoAP POST request message. The sending of the CoAP POST request message shall follow the procedures specified in clause 6.4.1.2.6 with the clarifications listed below:\na)\tIn step d) of clause 6.4.1.2.6, the \"Delivery Status\" element and the \"Failure Cause\" element in payload of every individual MSGin5G message should not be copied to the payload of the new CoAP POST request message.\nb)\tIn addition to the step d) of clause 6.4.1.2.6, the MSGin5G Server should include a \"Number of individual messages\" element in this message to indicate the total number of MSGin5G message delivery status reports which are aggregated into this single message.\nc)\tIn addition to the step d) of clause 6.4.1.2.6, the MSGin5G Server should include a \"List of individual messages\" element in this message. Each child element of this \"List of individual messages\" element contains information elements listed below:\n1)\t\"Message ID\" of the individual MSGin5G message delivery status reports which is copied from the MSGin5G message that is being acknowledged;\n2)\t\"Delivery Status\" element copied from the individual MSGin5G message delivery status report; and\n3)\tan optional \"Failure Cause\" element copied from the individual MSGin5G message delivery status report.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.2\tMessage delivery and message delivery status report delivery over MSGin5G-5 reference point",
                            "text_content": "Clauses 6.4.2.2 and 6.4.2.3 define the procedures used for message or message delivery report sending or receiving between a MSGin5G Client and an Application Client residing in different UEs over MSGin5G-5.\nIn these procedures, for delivering messages or message delivery reports to a MSGin5G Client in a MSGin5G UE, the Application Client residing in different a UE may use any message format or protocol supported by the MSGin5G Client.\nNOTE 1:\tHow the Application Client knows the message protocol/format supported by the MSGin5G Client is out of scope of this specification.\nIn the procedures, for delivering messages or message delivery reports to Application Client residing in a different UE, the MSGin5G Client in MSGin5G UE may use any message format or protocol supported by the Application Client.\nNOTE 2:\tHow the MSGin5G Client knows the message protocol/format supported by the Application Client is out of scope of this specification.\nAnnex A lists some message formats/protocols examples (only for implementation reference) which may be used for the interaction between Application Client residing in a different UE and MSGin5G Client in MSGin5G UE over MSGin5G-5.\nUpon successfully receiving a MSGin5G message including an Application ID from MSGin5G Server, if the Application ID is registered by an Application Client residing in a different UE, based on Application Client registration information, the MSGin5G Client in the MSGin5G UE shall send a request to the Application Client residing in the different UE, including the following information elements:\na)\tthe Message Type IE with the value “MESSAGE RECEIVED REQUEST” indicating the request/message is for delivering a message;\nb)\tthe Message ID IE with the unique identity of this message;\nc)\tif the received message is a point-to-point or application-to-point message, the Originator Address IE indicating the originating UE or AS;\nd)\tif the received message is a group message, the Group ID IE indicating the originating group;\nNOTE:\tthe information included in the Originator Address IE is generated based on the received originating UE/AS Service ID, the information included in the Group ID IE is generated based on received Group Service ID. How to generate the value of Originator Address IE and Group ID IE is implementation specific.\ne)\tthe Payload IE indicating the application message content included in the received message;\nf)\tif the delivery status report is required by the originator, the Delivery Status Required IE with “true”; and\ng)\toptionally, the Priority IE indicating the application priority level.\nUpon receiving a request from Application Client  residing in a different UE, and the request is for initiating a MSGin5G message, i.e. with Message Type IE set to “MESSAGE SENDING REQUEST”, the MSGin5G Client in the MSGin5G UE shall construct and send a CoAP POST request to MSGin5G Server as specified in clause 6.4.1.1.2. The MSGin5G Client generates the Recipient UE Service ID/AS Service ID based on Target address IE the included in the request from the Constrained UE.\nIf the Application Client residing in a different UE indicates “UE” in the Target Type IE, the Target Address shall include information of another MSGin5G Client.\nIf an IPv4 or IPv6 address is included in the Target Address, the MSGin5G Client generates the Recipient UE Service ID/AS Service ID based on the mapping between the addresses and UE Service IDs/AS Service IDs stored in the MSGin5G UE.\nIf the Application Client residing in a different UE indicates “UE” in the Target Type IE, in order to route the MSGin5G message to the correct target MSGin5G Client, the Target Address may indicate an FQDN.\nWhen the MSGin5G Client cannot generate the Recipient UE Service ID/AS Service ID based on Target address IE, the MSGin5G Client generates the request message to the Application Client residing in a different UE as specified in clause 6.4.2.2.3 if the Delivery status required IE indicates “DELIVERY REPORT REQUIRED “. Otherwise, the MSGin5G Client discards the request from the Application Client residing in the different UE.\nUpon receiving a MSGin5G message delivery status report request including an Application ID from MSGin5G Server, and the Application ID is registered by the Application Client residing in a different UE, based on the Application Client registration information, the MSGin5G Client in the MSGin5G UE shall send a request/response message to the Application Client residing in the different UE, in the request, including the following information elements:\na)\tthe Message Type IE with the value \"DELIVERY REPORT RECEIVED REQUEST\" indicating the request/message is for delivering a message delivery status;\nb)\tthe Message ID IE with the unique identity of this message delivery report;\nc)\tthe Reply-to Message ID IE indicating the delivery status is for which message; and\nd)\tthe Delivery Status IE indicating the delivery status.\nUpon receiving a request/response from Application Client residing in a different UE, and the request is for delivering a message delivery report, i.e. with Message Type IE set to \"DELIVERY REPORT SENDING REQUEST\", the MSGin5G Client in the MSGin5G UE shall construct and send a CoAP POST request to MSGin5G Server as specified in clause 6.4.1.1.4.\nUpon received the message request from Application Client residing in a different UE, the MSGin5G Client in the MSGin5G UE sends a response to the Application Client residing in the different UE including the following information elements:\na)\tthe Message Type IE with the value \"MESSAGE SENDING RESPONSE\" indicating this is a response to the message sending request.\nb)\tthe Result IE indicating success or failure of the message sending request; and\nc)\toptionally, the Failure Reason IE indicating the reason of failure when the Result IE is set to failure.\nIn order to initiate an MSGin5G message by using the MSGin5G Client in MSGin5G UE, the Application Client  residing in a different UE with the MSGin5G Client shall send a request/message to the MSGin5G Client including the following information elements:\na)\tthe Message Type IE with the value \"MESSAGE SENDING REQUEST\" indicating the request/message is for initiating a MSGin5G message;\nb)\tthe Message ID IE with the unique identity of this message;\nc)\tthe Target Address IE with the information for MSGin5G Client to generate the Recipient UE/AS/Group Service ID in the MSGin5G message request;\nd)\toptionally, the Target Type IE indicating the type of the message recipient, with \"UE\" if the message is sent to a UE, with \"AS\" if the message is sent to an Application Server, or with \"GROUP\" if message is sent to a MSGin5G Group;\ne)\toptionally, the Application ID IE indicating the application(s) for which the payload is intended;\nf)\tthe Payload IE including the application content of the message to send to the recipient; and\ng)\toptionally, the Delivery Status Required IE with the value \"true\" if delivery status report is required.\nIn order to sending an message delivery report by using the MSGin5G Client in MSGin5G UE, the Application Client residing in a different UE with the MSGin5G Client shall send a request/response to the MSGin5G Client including the following information elements:\na)\tthe Message Type IE with the value \"DELIVERY REPORT SENDING REQUEST\" indicating the request/response is for sending a delivery status report;\nb)\tthe Message ID IE with the unique identity of this message delivery report;\nc)\tthe Reply-to Message ID IE copied from the received message, to indicate the delivery status is for which message; and\nd)\tthe Delivery Status IE with delivery status.\nUpon received the message request from MSGin5G Client in MSGin5G UE, the Application Client residing in a different UE with the MSGin5G Client sends a response to the MSGin5G Client, including the following information elements:\na)\tthe Message Type IE with the value \"MESSAGE RECEIVED RESPONSE\" indicating the request/message is for initiating a MSGin5G message.\nb)\tthe Result IE indicating success or failure of the message received request; and\nc)\toptionally, the Failure Reason IE indicating the reason of failure when the Result IE is set to failure.\nWhen the Relay UE receives a CoAP POST request from UDP port 65401 and the recipient's address included in the CoAP Option is set to another MSGin5G Client-2 which has established a connection for ProSe UE-to-Network Relay Communication with it as specified in 3GPP  TS 23.304[9], the Relay UE acts as either 5G ProSe Layer-2 and Layer-3 UE-to-Network Relay entity as specified in 3GPP TS 23.304 [9] and relays the CoAP POST request as a downlink traffic to the MSGin5G Client-2, Otherwise the MSGin5G Client-1 shall discard the CoAP POST request and may send a CoAP 4.04 (Not Found) response to the MSGin5G Server.\nWhen the Relay UE receives a CoAP POST request from UDP port 65401 and the recipient's address included in the CoAP Option is set to the MSGin5G Server, the Relay UE acts as either 5G ProSe Layer-2 and Layer-3 UE-to-Network Relay entity as specified in 3GPP TS 23.304 [9] and relays the CoAP POST request as a uplink traffic to the MSGin5G Server.\nIn order to send an MSGin5G message or MSGin5G message delivery status report, the MSGin5G Client shall use the procedures specified in clause 6.4.1.1.2, 6.4.1.1.3, 6.4.1.1.4 and 6.4.1.1.5.\nUpon receiving an CoAP POST request and the recipient's address included in the CoAP Option is set to the MSGin5G Client itself, the MSGin5G Client shall handle the CoAP Post request as specified in clause 6.4.1.1.6, 6.4.1.1.7, 6.4.1.1.8 and 6.4.1.1.9.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tMSGin5G Message Segmentation and Reassembly",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tSegment recovery and received confirmation procedures",
                            "text_content": "The Message Sender in this clause can only be the MSGin5G Client (when the message is from MSGin5G Client) or MSGin5G Server (when the message is from Application Server).\nThe Message Receiver in this clause can only be the MSGin5G Client (when the message is targeted to an MSGin5G Client) or MSGin5G Server (when the message is targeted to an Application Server).\nUpon receiving a CoAP POST request containing the MSGin5G service identifier and containing the Message Type with a value \"SEGREC\" which indicates the request is for message segment recovery, the MSGin5G Client shall send a CoAP ACK response to the request. Then the MSGin5G Client shall send all requested segmented messages as requested in the received \"List of Segment range\" element to the message receiver (e.g. Application Server, UE) as specified in 6.4.1.1.2.\n\nIf not all segments are received within expected time, the Message Receiver shall send a CoAP POST request to the Message Sender for recovering the segments which are not received. In the CoAP POST request, the Message Receiver:\na)\tshall set the \"T\" field in the CoAP header to 0 to indicate this request is the type of Confirmable;\nb)\tshall include the Message Sender address in a CoAP Option, e.g. if the Message Sender address is a URI, includes a Uri-Path Option with the value of the URI;\nc)\tshall set the CoAP Content-Format to \"50\", i.e. application/json; and\nd)\tshall include the following information elements in the CoAP payload encoded in JSON format:\n1)\tan \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\n2)\ta \"Message Type\" element with a value \"SEGREC\" to indicate that this request is for segments recovery;\n3)\ta \"Segmentation Set Identifier\" element copied from one of the previous received segments; and\n4)\ta \"List of Segment range\" element to indicate the segments range which the client wants to recover, each segment range consist of start and end sequence number of missing segments e.g. (5-7, 10-10, 15-19).\nIf not all segments are received within the expected time (based on configuration), the Message Receiver may consider that the recovery is failed. The Message Receiver may initiate the procedure again with updated list of segment range.\nNOTE:\tThe MSGin5G message segment recovery procedure may repeat based on the configuration.\nThe corresponding JSON Schema used in step d) is defined in clause 7.3.6.2.\nIf the Message Receiver determines that it receives all segments successfully, or the Message Receiver determines that it is failed (including recovery failed) to receive all segments, the Message Receiver sends the message segments received confirmation to the Message Sender by a CoAP POST request. In the CoAP POST request, the Message Receiver:\na)\tshall set the \"T\" field in the CoAP header to 0 to indicate this request is the type of Confirmable;\nb)\tshall include the Message Sender address in a CoAP Option, e.g. if the Message Sender address is a URI, includes a Uri-Path Option with the value of the URI;\nc)\tshall set the CoAP Content-Format to \"50\", i.e. application/json; and\nd)\tshall include the following information elements in the CoAP payload encoded in JSON format:\n1)\tthe \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\n2)\tthe \"Message Type\" element with a value \"SEGCONFIR\" to indicate that this request is for sending message segments received confirmation;\n3)\tthe \"Segmentation Set Identifier\" element copied from one of the previous received segments; and\n4)\tthe \"Result\" element to indicate whether the segments are received successful or failed.\nThe corresponding JSON Schema used in step d) is defined in 7.3.6.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tProcedure at MSGin5G Client",
                            "text_content": "To support MSGin5G Message segmentation and reassembly, the Message Client performs the procedures specified in 6.4.1.1.2, and acts as Message Sender to perform the procedures in clause 6.5.1.1 if needed. When the MSGin5G Client performs the procedures in clause 6.5.1.1, the MSGin5G Server acts as Message Receiver.\nUpon receiving an MSGin5G message, to support MSGin5G Message segmentation and reassembly, the MSGin5G Client performs the procedures in 6.4.1.1.6, and acts as Message Receiver to perform the procedures in clause 6.5.1.2 if needed. When the MSGin5G Client performs the procedures in clause 6.5.1.2, the MSGin5G Server acts as Message Sender.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tProcedure at MSGin5G Server",
                            "text_content": "When the MSGin5G Server receives a message which is not segment message, the MSGin5G Server should follow the procedures in clause 6.4.1.2.6 to perform potential segment if needed (i.e. if the received message size exceeds the maximum allowed MSGin5G message segmentation size of the target UE).\nThis following clauses specify the procedures when the MSGin5G Server receives segmented message delivery request, message segments recovery request or message segments received confirmation request.\nUpon receiving a message segment targeting to MSGin5G UE, the MSGin5G Server checks if the segment size exceeds the configured maximum message segment size of the targeted UE,\na)\tif exceed, upon receiving all segments,\n1)\treassembles them into a single MSGin5G message;\n2)\tsplits the re-assembled message to segments such that each segment is smaller than the maximum allowed message segment size of the targeted UE; and\n3)\tsends each new segment to the target MSGin5G UE as specified in clause  6.4.1.2.6; and\nb)\tif not exceed, upon receiving all segments, sends each segment to the target MSGin5G UE as specified in clause 6.4.1.2.6.\nUpon receiving all message segments from MSGin5G UE to an Application Server, the MSGin5G Server shall reassemble them into a single MSGin5G message and sends it to the Application Server as specified in TS 29.538 [7].\nUpon receiving message segments from MSGin5G UE to an Application Server, the MSGin5G Server acts as a Message Receiver to perform the procedures specified in clause 6.5.1.2.1 and in clause 6.5.1.2.2 if needed. In these procedures, the MSGin5G Client in the MSGin5G UE acts as Message Sender.\nUpon receiving a CoAP POST request containing the MSGin5G service identifier and containing the Message Type with a value \"SEGREC\" indicating the request is for message segment recovery, if the request is targeted to an MSGin5G UE, the MSGin5G Server shall construct a new CoAP POST request to the targeted UE. In the request, the MSGin5G Server:\na)\tshall construct the new CoAP POST request with the corresponding value in the received CoAP POST request message except the Option header; and\nb)\tshall include the MSGin5G Client address in the Option header of the CoAP message and set the Option header to a corresponding value, e.g. if the MSGin5G Server address is a URI, the Uri-Path Option is set to the value of such URI.\n\nUpon receiving a CoAP POST request containing the MSGin5G service identifier and containing the Message Type with a value \"SEGCOFIR\" indicating the request is for message segments received confirmation, if the request is targeted to an MSGin5G UE, the MSGin5G Server shall construct a new CoAP POST request to the targeted UE. In the request, the MSGin5G Server:\na)\tshall construct the new CoAP POST request with the corresponding value in the received CoAP POST request message except the Option header; and\nb)\tshall include the MSGin5G Client address in the Option header of the CoAP message and set the Option header to a corresponding value, e.g. if the MSGin5G Server address is a URI, the Uri-Path Option is set to the value of such URI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.6\tMessaging Topic Subscription and Unsubscription",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tGeneral",
                            "text_content": "As specified in 3GPP TS 23.554 [2], an MSGin5G Client may subscribe one or more Messaging Topics on the MSGin5G Server.\nThe message topic subscription and unsubscription are based on the CoAP Observe method as specified in IETF RFC 7641 [4], the MSGin5G Client acts as an observer, the MSGin5G Server acts as a CoAP Server, the message topic is a resource to observe.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.2\tProcedure at MSGin5G Client",
                            "text_content": "Upon receiving a request to subscribe a message topic from an Application Client, MSGin5G Client shall send a CoAP GET request, as specified in IETF RFC 7641 [4], to the MSGin5G Server. In the CoAP GET request, the MSGin5G Client:\na)\tshall set the \"T\" field in the CoAP header to the value \"0\" to indicate this request is the type of Confirmable;\nb)\tshall include the MSGin5G Server address in the Option header and set the Option header to a corresponding value, e.g. if the MSGin5G Server address is a URI, the Uri-Path Option is set to the value of such URI;\nc)\tshall include the message topic name in the Uri-Path Option (e.g. \"\\top\");\nd)\tshall include the Observe Option with the value \"0\" which indicates the request is for observing a resource, i.e. for subscribing a message topic;\ne)\tshall include the Content-Format Option with the value \"50\" which indicate the format of the CoAP payload is \"application/json\" as specified in RFC 7252 [5]; and\nf)\tshall include the CoAP Payload in JSON format, including the following information elements as specified in clause 8.8.1 of 3GPP TS 23.554 [2]:\n1)\tan \"Originating UE Service ID\" element set to the MSGin5G UE which requests the message topic subscription; and\n2)\toptionally, an \"Expiration time\" element which indicates the expiration time of the message topic subscription.\nThe corresponding JSON Schema used in step g) is defined in clause 7.3.5.1.\n\nIf the MSGin5G Client needs to unsubscribe a message topic, as specified in RFC 7641 [4], the MSGin5G Client shall send a CoAP GET request to MSGin5G Server. In the request, the MSGin5G Client:\na)\tshall set the \"T\" field in the CoAP header to the value \"0\" to indicate this request is the type of Confirmable;\nb)\tshall include the MSGin5G Server address in the Option header and set the Option header to a corresponding value, e.g. if the MSGin5G Server address is a URI, the Uri-Path Option is set to the value of such URI;\nc)\tshall include the message topic name in the Uri-Path Option (e.g. \"\\top\");\nd)\tshall include the Observe Option with the value \"1\" which indicates the observer request to cancel the previous resource observation, i.e. the MSGin5G Client requests to unsubscribe the message topic;\ne)\tshall include the Content-Format Option with the value \"50\" which indicate the format of the CoAP payload is \"application/json\" as specified in RFC 7252 [5]; and\ne)\tshall include the CoAP Payload in JSON format and an \"Originating UE Service ID\" element indicating the MSGin5G UE which requests the message topic unsubscription shall be included in the CoAP Payload.\nThe corresponding JSON Schema used in step g) is defined in 7.3.5.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.3\tProcedures at MSGin5G Server",
                            "text_content": "The MSGin5G Server should support parsing CoAP request as specified in RFC 7252 [5] and RFC 7641 [4].\nUpon receiving a CoAP GET request from MSGin5G Client, the MSGin5G Server shall parse the CoAP headers, Options and Payload in the request to get:\na)\tthe value of Observe Option;\nb)\tthe message topic from the Uri-Path Option;\nc)\tthe Originating UE Service ID from the Payload; and\nd)\tthe Expiration time from the Payload if exists in the Payload.\nIf the Observe Option is included in the CoAP GET request with a value \"0\" as specified in RFC 7641 [4], the MSGin5G Server shall:\na)\tif the message topic does not exist, create the message topic;\nb)\tif the Originating UE Service ID is not in the list of the subscribers of the message topic, add the Originating UE Service ID to the list of the subscribers of the topic, and record its expiration time if exists;\nc)\tif an entry with a matching Originating UE Service ID is already present in the list of the subscribers of the message topic, updates the expiration time of the subscription of this UE; and\nd)\tsend a CoAP Notifications with a 2.05 (Content) response code to the MSGin5G Client and with CoAP Payload in JSON format, including the following information elements as specified in clause 8.8.1 of 3GPP TS 23.554 [2]:\n1)\ta \"subscription status\" element set to indicate whether the subscription was successfully added or deleted on the MSGin5G Server; and\n2)\toptionally, an \"Expiration time\" element set to indicate the expiration time of the message topic subscription.\nThe MSGin5G Server shall remove the Originating UE Service ID from list of the subscribers of the message topic when the expiration time reached.\nIf the Observe Option is included in the received CoAP GET request with a value \"1\" as specified in RFC 7461 [4], the MSGin5G Server shall handle the CoAP GET request according to procedures specified in IETF RFC 7252 [5] with the clarifications listed below:\na)\tif the message topic exists, the MSGin5G Server shall remove the Originating UE Service ID from list of the subscribers of the message topic; and\nb)\tthe MSGin5G Server sends a CoAP Notifications with a 2.05 (Content) response code to the MSGin5G Client, and with CoAP Payload in JSON format. A \"subscription status\" element set to indicate whether the subscription was successfully added or deleted on the MSGin5G Server shall be included in this CoAP Payload as specified in clause 8.8.3 of 3GPP TS 23.554 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tVoid",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.8\tUsage of SEAL",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tGeneral",
                            "text_content": "The MSGin5G Service functional entities, i.e. MSGin5G Client and MSGin5G Server, utilize the SEAL services. All SEAL services specified in 3GPP TS 24.544 [10], 3GPP TS 24.545 [11], 3GPP TS 24.546 [12], 3GPP TS 24.547 [13] and 3GPP TS 24.548 [14] are available to MSGin5G Service. In this clause, the procedures whose utilization by MSGin5G Service are well-known are described.\nNOTE:\tIf SEAL client is co-located with MSGin5G client, then MSGin5G client act as a SEAL client to perform procedures. If SEAL client is not co-located with MSGin5G client, then the interaction between MSGin5G client and SEAL client is implementation specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tConfiguration management service",
                            "text_content": "The MSGin5G Client and MSGin5G Server utilize configuration management service procedures of SEAL to support MSGin5G Service. The procedure to fetch VAL UE configuration data specified in clause 6.2.3 of 3GPP TS 24.546 [12] is applicable for the configuration management services of the MSGin5G Service. The MSGin5G UE configuration data is specified in clause 7.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.3\tGroup management service",
                            "text_content": "The MSGin5G Client and MSGin5G Server utilize group management service procedures of SEAL to support MSGin5G Service. The following procedures of group management service of SEAL as specified in 3GPP TS 24.544 [10] are applicable for the MSGin5G Service:\na)\tGroup creation specified in clause 6.2.2; with following clarification:\n1)\tUpon receiving Group Creation notification as specified in clause of 3GPP TS 24.544 [10], for list of VAL user IDs or VAL UE IDs which does not have group management client on the UE (e.g. Legacy 3GPP UEs or Non-3GPP UEs), the MSGin5G server initiate the group creation notification towards those UEs;\nb)\tGroup configuration management specified in clause 6.2.5; and\nc)\tGroup membership specified in clause 6.2.4.\ne)\tLocation-based group creation specified in clause 6.2.6;\nf)\tGroup announcement and join specified in clause 6.2.7;\ng)\tGroup member leave specified in clause 6.2.9;\nh)\tTemporary groups specified in clause 6.2.11; and\ni)\tGroup deletion specified in clause 6.2.12.\nNOTE:\tIf the UE that is involved the Group management procedures does not have group management client (e.g. Legacy 3GPP UEs, Non-3GPP UEs or Application Server), it is responsibility of the VAL server (MSGin5G Server) to initiate the necessary group management request/response towards SEAL Group Management server on behalf of those UE. And if applicable, send and receive the necessary group management request/response to/from those UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tCoding",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause contains the information elements coding for the messages used in the procedures described in the present document.\nIn order to identify the usage of messages, in addition to the information elements specified in 3GPP TS 23.554 [2], a \"Message Type\" element shall be added to each message. The possible values of \"Message Type\" element are listed below:\na)\t\"REG\" refers to Registration;\nb)\t\"DEREG\" refers to de-registration;\nc)\t\"MSG\" refers to MSGin5G message;\nd)\t\"MSGRESP\" refers to message response; and\ne)\t\"IMDN\" refers to MSGin5G delivery status report\";\nf)\t\"SEGREC\" refers to segments recovery; and\ng)\t\"SEGCONFIR\" refers to message segments received confirmation.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tMSGin5G UE Configuration data",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.2.1\tGeneral",
                            "text_content": "This clause specified the extension of the SEAL UE configuration document as defined in 3GPP TS 24.546 [6].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.2\tApplication unique ID",
                            "text_content": "The AUID shall be set to the unique service identifier of MSGin5G service as specified in 3GPP TS 23.554 [2]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.3\tStructure",
                            "text_content": "The MSGin5G UE configuration document structure is described in clause 7.2 of 3GPP TS 24.546 [6] with the MSGin5G specific clarifications specified in this clause.\nThe <on-network> element of the <seal-UE-configuration> element specified in clause 7.2 of 3GPP TS 24.546 [6]:\na)\tshall include a <MSGin5G-Server-address> element;\nb)\tshall include a <MSGin5G-UE-Service-id> element; and\nc)\tmay include a <Segment-size> element.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.4\tXML schema",
                            "text_content": "The MSGin5G UE configuration document is composed according the XML schema described in the clause 7.2 of 3GPP TS 24.546 [6], and extended with extensions from the XML schema defined in clause 7.2.4.2.\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema\nxmlns=\"urn:3gpp:ns:seal:MSGin5GUEConfig:1.0\"\ntargetNamespace=\"urn:3gpp:ns:seal: MSGin5GUEConfig:1.0\"\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\nxmlns: msgin5guec=\"urn:3gpp:ns:seal: MSGin5GUEConfig:1.0\"\nelementFormDefault=\"qualified\"\nattributeFormDefault=\"unqualified\">\n\n<!—MSGin5G specific \"on-network\" child elements -->\n<xs:element name=\"MSGin5G-Server-address\" type=\"xs:string\"/>\n<xs:element name=\"MSGin5G-UE-Service-id\" type=\"xs:string\"/>\n<xs:element name=\"Segment-size\" type=\"xs:unsignedInt\"/>\n\n</xs:schema>\n\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.5\tData semantics",
                            "text_content": "The <VAL-UE-id> element in <seal-UE-configuration> element is MSGin5G UE ID as specified in TS 23.554 [2].\nThe <VAL-Service-id> element in <seal-UE-configuration> element is MSGin5G service ID.\nThe <MSGin5G-Server-address> element in <on-network> element of <seal-UE-configuration> element is the address information of the initial MSGin5G Server serving the MSGin5G Client.\nThe <MSGin5G-UE-Service-id> element in <on-network> element of <seal-UE-configuration> element is the MSGin5G UE Service ID as specified in TS 23.554 [2].\nThe <Segment-size> element in <on-network> element of <seal-UE-configuration> element is the segment size used for the MSGin5G UE to do message segmentation, the payload size of every segmented message will not exceed the segment size.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.6\tMIME types",
                            "text_content": "The MIME type for the MSGin5G UE configuration document shall use the MIME type as specified in the clause 7.2.6 of 3GPP TS 24.546 [6].\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.3\tMSGin5G message structure",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.3.1\tGeneral",
                            "text_content": "This clause defines the JSON schema of the body of CoAP requests realizing the MSGin5G message. The schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of MSGin5G message, the properties are defined as shorten form and the relationship between the properties and IEs used in clause 6 are described in the description of the properties.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.2\tConfiguration",
                            "text_content": "The schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationship between the properties and IEs used in clause 6.2 are described in the description of the properties, The JSON schema is defined below:\n\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_UE_Configuration_schema\",\n\"title\": \"MSGin5G_UE_Configuration\",\n\"type\": \"object\",\n\"properties\": {\n\"ueId\": {\n\"type\": \"string\",\n\"description\": \"Refer to MSGin5G UE ID\"\n},\n\"addInfos\": {\n\"type\": \"array\",\n\"description\": \"Refer to other related informations\",\n\"items\": {\n\"$ref\": \"#/$defs/AddInfo\"\n}\n}\n},\n\"required\": [\"ueId\"],\n\"$defs\": {\n\"AddInfo\": {\n\"type\": \"object\",\n\"properties\": {\n\"name\": {\n\"type\": \"string\"\n},\n\"value\": {\n\"type\": \"string\"\n}\n},\n\"required\": [\"name\", \"value\"]\n}\n}\n}\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.3\tRegistration",
                            "text_content": "The schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause 6.3.1.1.1 and clause 6.3.4.2.1 are described in the description of the properties. The JSON schema of the CoAP POST request for the MSGin5G registration is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Registration_request_schema\",\n\"title\": \"MSGin5G Registration Request\",\n\"type\": \"object\",\n\"properties\": {\n\"msgIden\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Refer to Service identifier of MSGin5G service\"\n},\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"REG\"\n],\n\"description\": \"Refer to the usage of this message. The value REG refers to MSGin5G Registration\"\n},\n\"urgentTag\": {\n\"type\": \"boolean\",\n\"default\": false,\n\"description\": \"Refer to registration not urgent\"\n},\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\"\n]\n},\n\"addr\": {\n\"type\": \"string\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID\"\n},\n\"cliProfile\": {\n\"type\": \"object\",\n\"properties\": {\n\"triInfo\": {\n\"type\": \"object\",\n\"properties\": {\n\"ueId\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Refer to MSGin5G UE ID\"\n},\n\"cliPort\": {\n\"type\": \"string\",\n\"description\": \"Refer to MSGin5G Client Port\"\n},\n\"cliPorts\": {\n\"type\": \"array\",\n\"description\": \"Refer to MSGin5G Client Ports\",\n\"items\": {\n\"$ref\": \"#/$defs/portInfo\"\n}\n}\n\n},\n\"required\": [\n\"ueId\",\n{\n\"OneOf\":[\"cliPort\", \"cliPorts\"]\n}\n],\n\"description\": \"Refer to MSGin5G Client Triggering Information\"\n},\n\"comAvail\": {\n\"type\": \"object\",\n\"properties\": {\n\"schTime\": {\n\"type\": \"string\",\n\"format\": \"date-time\",\n\"description\": \"Refer to Scheduled Communication Time\"\n},\n\"durTime\": {\n\"type\": \"string\",\n\"format\": \"date-time\",\n\"description\": \"Refer to Communication Duration Time\"\n},\n\"periIndi\": {\n\"type\": \"boolean\",\n\"default\": false,\n\"description\": \"Refer to Periodic Communication Indicator\"\n},\n\"periInterval\": {\n\"type\": \"string\",\n\"format\": \"date-time\",\n\"description\": \"Refer to Periodic Communication Interval\"\n},\n\"dataSize\": {\n\"type\": \"string\",\n\"description\": \"Refer to Data Size Indication\"\n},\n\"storeForward\": {\n\"type\": \"string\",\n\"description\": \"Refer to Store and Forward Option\"\n}\n},\n\"description\": \"Refer to MSGin5G Client Communication Availability\"\n}\n},\n\"description\": \"Refer to MSGin5G Client Profile\"\n},\n\"reqExpTime\": {\n\"type\": \"integer\",\n\"description\": \"Refer to allowed maximum processing time in seconds\"\n}\n},\n\"required\": [\n\"msgIden\",\n\"oriAddr \",\n\"secCred\"\n],\n\"$defs\": {\n\"portInfo\": {\n\"type\": \"object\",\n\"properties\": {\n\"portNum\": {\n\"type\": \"int\",\n\"description\": \"the port number MSGin5G Client listens on for device triggers from the MSGin5G Server\"\n},\n\"Protocol\": {\n\"type\": {\n\"enum\": [\n\"SMS\",\n\"NIDD\",\n\"OTHER\"\n]\n}\n},\n\"required\": [\n\"portNum\",\n\"Protocol\"\n]\n}\n}\n}\n}\nThe schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause 6.3.1.2.1 are described in the description of the properties. The JSON schema of CoAP 2.01 (Created) response or CoAP 2.04 (Change) response for the MSGin5G registration is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Registration_response_schema\",\n\"title\": \"MSGin5G Registration Response\",\n\"type\": \"object\",\n\"properties\": {\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\"\n]\n},\n\"addr\": {\n\"type\": \"string\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID\"\n},\n\"result\": {\n\"type\": \"boolean\",\n\"default\": true,\n\"description\": \"Refer to Registration result. The value true refers to succcess\"\n},\n\"regExpTime\": {\n\"type\": \"integer\",\n\"description\": \"Refer to expiration time of the registration in seconds\"\n}],\n\"cause\": {\n\"type\": \"string\",\n\"description\": \"Failure Cause.\"\n}\n\n},\n\"required\": [\n\"oriAddr\",\n\"result\"\n\n],\n\"dependentRequired\": {\n\"regExpTime \": [{\n\"result\": {\n\"const\": \"true\"\n}\n}],\n\"Cause\": [{\n\"result\": {\n\"const\": \"false\"\n}\n}]\n}\n}\n\nThe schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause 6.3.4.3.1 are described in the description of the properties. The JSON schema of CoAP 2.01 (Created) response or CoAP 2.04 (Change) response for the MSGin5G registration is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Registration_response_schema\",\n\"title\": \"MSGin5G Registration Response\",\n\"type\": \"object\",\n\"properties\": {\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\"\n]\n},\n\"addr\": {\n\"type\": \"string\",\n\"format\": \"uri\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID\"\n},\n\"expectedTime\": {\n\"type\": \"integer\",\n\"description\": \"Refer to the expected time for receiving Registration Response in seconds\"\n}\n},\n\"required\": [\n\"oriAddr\"\n]\n}\n\nThe schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause 6.3.1.1.2 are described in the description of the properties. The JSON schema of the CoAP POST request for the MSGin5G de-registration is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Deregistration_request_schema\",\n\"title\": \"MSGin5G Deregistration Request\",\n\"type\": \"object\",\n\"properties\": {\n\"msgIden\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Refer to Service identifier of MSGin5G service\"\n},\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"DEREG\"\n],\n\"description\": \"Refer to the usage of this message. The value DEREG refers to MSGin5G De-registration\"\n},\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\"\n]\n},\n\"addr\": {\n\"type\": \"string\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID\"\n}\n},\n\"required\": [\n\"msgIden\",\n\"oriAddr \",\n\"secCred\"\n]\n}\nThe schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause 6.3.1.2.2 are described in the description of the properties. The JSON schema of CoAP 2.04 (Change) response for the MSGin5G de-registration is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_ Deregistration_response_schema\",\n\"title\": \"MSGin5G Deregistration Response\",\n\"type\": \"object\",\n\"properties\": {\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\"\n]\n},\n\"addr\": {\n\"type\": \"string\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID\"\n},\n\"result\": {\n\"type\": \"boolean\",\n\"default\": true,\n\"description\": \"Refer to De-registration result. The value true refers to succcess\"\n},\n\"cause\": {\n\"type\": \"string\",\n\"description\": \"Failure Cause.\"\n}\n},\n\"required\": [\n\"oriAddr\",\n\"result\"\n],\n\"dependentRequired\": {\n\"Cause\": [{\n\"result\": {\n\"const\": \"false\"\n}\n}]\n}\n}\n\nThe schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause 6.3.5.3.1 are described in the description of the properties. The JSON schema of the CoAP POST request for the registration to MSGin5G Gateway UE is defined below:\n\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Gateway Registration_request_schema\",\n\"title\": \"MSGin5G Gateway Registration Request\",\n\"type\": \"object\",\n\"properties\": {\n\"msgIden\": {\n\"type\": \"string\",\n\"description\": \"Refer to Service identifier of MSGin5G service\"\n},\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"GWREG\"\n],\n\"description\": \"Refer to the usage of this message. The value GWREG refers to MSGin5G Gateway Registration\"\n},\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\"\n]\n},\n\"addr\": {\n\"type\": \"string\",\n\"format\": \"uri\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID\"\n},\n\"oriUEAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\"\n]\n},\n\"addr\": {\n\"type\": \"string\"\n}\n},\n\"description\": \"Refer to Originating MSGin5G UE ID\"\n},\n\"expiredTime\": {\n\"type\": \"integer\",\n\"description\": \"Refer to Gateway Service expiration time in seconds\"\n}\n},\n\"required\": [\n\"msgIden\",\n\"oriAddr \"\n]\n}\n\nThe schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause 6.3.5.2.1 are described in the description of the properties. The JSON schema of CoAP 2.01 (Created) response or CoAP 2.04 (Change) response for the registration to MSGin5G Gateway UE is defined below:\n\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Gateway Registration_response_schema\",\n\"title\": \"MSGin5G Gateway Registration Response\",\n\"type\": \"object\",\n\"properties\": {\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\"\n]\n},\n\"addr\": {\n\"type\": \"string\",\n\"format\": \"uri\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID\"\n},\n\"result\": {\n\"type\": \"boolean\",\n\"default\": true,\n\"description\": \"Refer to Registration result. The value true refers to succcess\"\n},\n\"acceptedTime\": {\n\"type\": \"integer\",\n\"description\": \"Refer to allowed time for Gateway Service in seconds\"\n},\n\"failure reason\": {\n\"type\": \"string\",\n\"description\": \"Refer to Failure Reason\"\n}\n},\n\"required\": [\n\"oriAddr\",\n\"result\"\n],\n\"dependentRequired\": {\n\"acceptedTime\": [{\n\"result\": {\n\"const\": \"ture\"\n}\n}],\n\"failure reason\": [{\n\"result\": {\n\"const\": \"false\"\n}\n}]\n}\n}\n\nThe schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause 6.3.4.3.3 are described in the description of the properties. The JSON schema of the CoAP POST request for the MSGin5G registration response to Constrained UE is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Registration_Response_to_Constrained_UE_schema\",\n\"title\": \"MSGin5G Registration Response to Contrained UE\",\n\"type\": \"object\",\n\"properties\": {\n\"msgIden\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Refer to Service identifier of MSGin5G service\"\n},\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"REGRESP\"\n],\n\"description\": \"Refer to the usage of this message. The value REGRESP refers to MSGin5G Registration Response to Constained UE\"\n},\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\"\n]\n},\n\"addr\": {\n\"type\": \"string\",\n\"format\": \"uri\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID\"\n},\n\"result\": {\n\"type\": \"boolean\",\n\"default\": true,\n\"description\": \"Refer to Registration result. The value true refers to succcess\"\n},\n\"cause\": {\n\"type\": \"string\",\n\"description\": \"Failure Cause.\"\n}\n},\n\"required\": [\n\"oriAddr\",\n\"result\"\n],\n\"dependentRequired\": {\n\"Cause\": [{\n\"result\": {\n\"const\": \"false\"\n}\n}]\n}\n}\n\n\nThe schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause 6.3.4.3.6 are described in the description of the properties. The JSON schema of the CoAP POST request for the MSGin5G deregistration response to Constrained UE is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Deregistration_response_to_Constrained_UE_schema\",\n\"title\": \"MSGin5G Deregistration Response to Contrained UE\",\n\"type\": \"object\",\n\"properties\": {\n\"msgIden\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Refer to Service identifier of MSGin5G service\"\n},\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"DEREGRESP\"\n],\n\"description\": \"Refer to the usage of this message. The value DEREGRESP refers to MSGin5G Deregistration Response to Constained UE\"\n},\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\"\n]\n},\n\"addr\": {\n\"type\": \"string\",\n\"format\": \"uri\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID\"\n},\n\"result\": {\n\"type\": \"boolean\",\n\"default\": true,\n\"description\": \"Refer to Deregistration result. The value true refers to succcess\"\n},\n\"cause\": {\n\"type\": \"string\",\n\"description\": \"Failure Cause.\"\n}\n},\n\"required\": [\n\"oriAddr\",\n\"result\"\n],\n\"dependentRequired\": {\n\"Cause\": [{\n\"result\": {\n\"const\": \"false\"\n}\n}]\n}\n}\n\n\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.4\tMSGin5G Message",
                            "text_content": "The JSON schema of the MSGin5G message is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Message_schema\",\n\"title\": \"MSGin5G Message\",\n\"type\": \"object\",\n\"properties\": {\n\"msgIden\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Refer to Service identifier of MSGin5G service\"\n},\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"MSG\"\n],\n\"description\": \"the usage of this message. The value MSG refers to MSGin5G message\"\n},\n\"appId\": {\n\"type\": \"string\",\n\"description\": \"Refer to Application ID\"\n},\n\"msgId\": {\n\"type\": \"string\",\n\"format\": \"uuid\",\n\"description\": \"Refer to Message ID\"\n},\n\"isDelivStatReq\": {\n\"type\": \"boolean\",\n\"default\": false,\n\"description\": \"Refer to Delivery status required\"\n},\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\",\n\"AS\"\n]\n},\n\"addr\": {\n\"type\": \"string\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID or Originating AS Service ID\"\n},\n\"destAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"destAddrType\": {\n\"enum\": [\n\"UE\",\n\"AS\",\n\"GROUP\",\n\"BC\",\n\"TOPIC\n]\n},\n\"addr\": {\n\"type\": \"string\"\n}\n},\n\"description\": \"Refer to Recipient UE Service ID or Recipient AS Service ID or Group Service ID or Broadcast Area ID or Messaging Topic\"\n},\n\"sfFlag\": {\n\"type\": \"boolean\",\n\"default\": false,\n\"description\": \"Refer to Store And Forward Flag\"\n},\n\"sfParam\": {\n\"$ref\": \"#/$defs/SfParams\",\n\"description\": \"Refer to Store And Forward Parameters\"\n},\n\"payload\": {\n\"type\": \"string\",\n\"description\": \"Refer to Payload\"\n},\n\"priority\": {\n\"type\": \"string\",\n\"enum\": [\n\"HIGH\",\n\"NORMAL\",\n\"LOW\"\n],\n\"default\": \"NORMAL\",\n\"description\": \"Refer to Priority Type\"\n},\n\"isSegmented\": {\n\"type\": \"boolean\",\n\"default\": false,\n\"description\": \"Refer to Message Is Segmented\"\n},\n\"segParams\": {\n\"$ref\": \"#/$defs/SegParams\"\n}\n},\n\"required\": [\n\"msgIden \",\n\"msgId\",\n\"msgType\",\n\"oriAddr\",\n\"destAddr\"\n],\n\"dependentRequired\": {\n\" sfParams\": [\n\" sfFlag\"\n],\n\" segParams\": [\n\" isSegmented \"\n],\n\"if\": {\n\"properties\": {\n\"oriAddrType\": {\n\"const\": \"AS\"\n}\n}\n},\n\"then\": {\n\"properties\": {\n\"destAddrType\": {\n\"not\":{\n\"const\": \"AS\"\n}\n}\n}\n}\n},\n\"$defs\": {\n\"SfParams\": {\n\"type\": \"object\",\n\"properties\": {\n\"expireTime\": {\n\"type\": \"string\",\n\"format\": \" date-time\",\n\"description\": \"Refer to Message expiration time\"\n},\n\"appSpecSf\": {\n\"type\": \"object\",\n\"description\": \"Refer to Application Specific Store And Forward Information\"\n}\n}\n},\n\"SegParams\": {\n\"type\": \"object\",\n\"properties\": {\n\"segId\": {\n\"type\": \"string\",\n\"description\": \"Refer to Segmentation Set Identifier\"\n},\n\"totalSegCount\": {\n\"type\": \"integer\",\n\"description\": \"Refer to Total Number Of Message Segments\"\n},\n\"segNumb\": {\n\"type\": \"integer\",\n\"description\": \"Refer to Message Segment Number\"\n},\n\"lastSegFlag\": {\n\"type\": \"string\",\n\"description\": \"Refer to Last Segment Flag\"\n},\n\"required\": [\n\"segId\",\n\"totalSegCount\",\n\"segNumb\"\n]\n}\n}\n}\n}\n\nThe JSON schema of the MSGin5G message delivery status report is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Message_schema\",\n\"title\": \"MSGin5G message delivery status report\",\n\"type\": \"object\",\n\"properties\": {\n\"msgIden\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Refer to Service identifier of MSGin5G service\"\n},\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"IMDN\"\n],\n\"description\": \"the usage of this message. The value IMDN refers to MSGin5G message delivery status report\"\n},\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\",\n\"AS\"\n]\n},\n\"addr\": {\n\"type\": \"string\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID or Originating AS Service ID\"\n},\n\"destAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"destAddrType\": {\n\"enum\": [\n\"UE\",\n\"AS\"\n]\n},\n\"addr\": {\n\"type\": \"string\"\n}\n},\n\"description\": \"Refer to Recipient UE Service ID or Recipient AS Service ID\"\n},\n\"msgId\": {\n\"type\": \"string\",\n\"format\": \"uuid\",\n\"description\": \"Refer to Message ID\"\n},\n\"DelSta\": {\n\"type\": \"string\",\n\"enum\": [\n\"success\",\n\"failure\"\n],\n\"description\": \"Refer to Delivery Status\"\n},\n\"Cause\": {\n\"type\": \"string\",\n\"description\": \"Refer to Failure Cause\"\n}\n},\n\"required\": [\n\"msgIden \",\n\"msgType\",\n\"msgId\",\n\"oriAddr\",\n\"destAddr\",\n\"DelSta\"\n],\n\"dependentRequired\": {\n\"Cause\": [{\n\"DelSta\": {\n\"const\": \"failure\"\n}\n}],\n\"if\": {\n\"properties\": {\n\"oriAddrType\": {\n\"const\": \"AS\"\n}\n}\n},\n\"then\": {\n\"properties\": {\n\"destAddrType\": {\n\"not\": {\n\"const\": \"AS\"\n}\n}\n}\n}\n}\n}\nThe JSON schema of the MSGin5G message response is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Message_schema\",\n\"title\": \"MSGin5G message response\",\n\"type\": \"object\",\n\"properties\": {\n\"msgIden\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Refer to Service identifier of MSGin5G service\"\n},\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"MSGRESP\"\n],\n\"description\": \"the usage of this message. The value MSGRESP refers to MSGin5G message response\"\n},\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\",\n\"AS\"\n]\n},\n\"addr\": {\n\"type\": \"string\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID or Originating AS Service ID\"\n},\n\"msgId\": {\n\"type\": \"string\",\n\"format\": \"uuid\",\n\"description\": \"Refer to Message ID\"\n},\n\"DelSta\": {\n\"type\": \"string\",\n\"enum\": [\n\"failure\",\n\"stored for deferred delivery\"\n],\n\"description\": \"Refer to Delivery Status\"\n},\n\"Cause\": {\n\"type\": \"string\",\n\"description\": \"Refer to Failure Cause\"\n}\n},\n\"required\": [\n\"msgIden \",\n\"msgType\",\n\"msgId\",\n\"oriAddr\",\n\"DelSta\"\n]\n}\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.5\tMessaging Topic Subscription and Unsubscription",
                            "text_content": "The schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationship between the properties and IEs used in clause 6.6 are described in the description of the properties, The JSON schema is defined below:\n\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/Message_Topic_Subscription_schema\",\n\"title\": \"Message_Topic_Subscription\",\n\"type\":\"object\",\n\"properties\": {\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\"\n]\n},\n\"addr\": {\n\"type\": \"string\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID\"\n},\n\"expireTime\": {\n\"type\": \"string\",\n\"format\": \"date-time\",\n\"description\": \"Refer to message topic subscripition expiration time\"\n},\n\"required\": [\"oriAddr\"]\n}\n}\n\nThe schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationship between the properties and IEs used in clause 6.6 are described in the description of the properties, The JSON schema is defined below:\n\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/Message_Topic_Unsubscription_schema\",\n\"title\": \"Message_Topic_Unsubscription\",\n\"type\":\"object\",\n\"properties\": {\n\"oriAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"oriAddrType\": {\n\"enum\": [\n\"UE\"\n]\n},\n\"addr\": {\n\"type\": \"string\"\n}\n},\n\"description\": \"Refer to Originating UE Service ID\"\n},\n\"required\": [\"oriAddr\"]\n}\n}\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.6\tStructure about message segment",
                            "text_content": "The schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationship between the properties and IEs used in clause 6.5 are described in the description of the properties, The JSON schema is defined below.\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/Segments_Received_Confirmation_schema\",\n\"title\": \"Message_Received_Confirmation\",\n\"type\":\"object\",\n\"properties\": {\n\"msgIden\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Refer to Service identifier of MSGin5G service\"\n},\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"SEGCONFIR\"\n],\n\"description\": \"the usage of this message. The value SEGCONFIR refers to message segments received confirmation\"\n},\n\"segId\": {\n\"type\": \"string\",\n\"description\": \"Refer to Segmentation Set Identifier\"\n},\n\"result\": {\n\"type\": \"boolean\",\n\"description\": \"Refer to segments received result. The value true refers to succcess\"\n},\n\"required\": [\"msgIden\",\"msgType\",\"segId\",\"result\"]\n}\n}\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/Segments_Recovery_schema\",\n\"title\": \"Segments_Recovery\",\n\"type\":\"object\",\n\"properties\": {\n\"msgIden\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Refer to Service identifier of MSGin5G service\"\n},\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"SEGREC\"\n],\n\"description\": \"the usage of this message. The value SEGREC refers to message segment recovery\"\n},\n\"segId\": {\n\"type\": \"string\",\n\"description\": \"Refer to Segmentation Set Identifier\"\n},\n\"segNoList\": {\n\"type\": \"string\",\n\"description\": \"Refer to List of Segment range, e.g. (5-7, 10-10, 15-19)\"\n},\n\"required\": [\"msgIden\",\"msgType\",\"segId\",\"segNoList\"]\n}\n}\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "A.1\tGeneral",
            "description": "The following clauses provide guidance of message formats/protocols which may be used between the Application Client on the constrained UE and the MSGin5G Client on the MSGin5G Gateway UE.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.2\tBased on standard L3 message",
            "description": "The following clauses describe an example based on standard L3 message as specified in clause 11.2 of 3GPP TS 24.007 [15].\nEach message definition in the clause includes a brief description of the message direction, the use, and the significance indicates whether the message is relevant only on the sender or receiver (local) or the message is relevant on both sender and receiver (dual).\nNOTE:\tMessage format defined in this clause can be used if the communication between the Constrained UE and the MSGin5G GW UE is based on PC5 / NR-PC5.\n\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.2.1\tMessage contents and functions",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "A.2.1.1\tfor sending a message to MSGin5G Client",
                            "text_content": "For sending a message to MSGin5G Client, the Application Client may use the message content specified in Table A.2.1.1-1.\nMessage type:\tMESSAGE SENDING REQUEST\nSignificance:\tdual\nDirection:\tthe Application Client of the Constrained UE to the MSGin5G Client of the MSGin5G Gateway UE\nTable A.2.1.1-1: message content for sending a message to MSGin5G Client\n\nIf using the message content specified in table A.2.1.1-1, the Application Client may generate a message according to 6.4.2.3.1 and send the generated message to the MSGin5G Client.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.1.1-1: message content for sending a message to MSGin5G Client",
                                    "table number": 3,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.1.2\tfor sending a message delivery report to MSGin5G Client",
                            "text_content": "For sending a message delivery status report to MSGin5G Client, the Application Client may use the message content specified in Table A.2.1.2-1.\nMessage type:\tDELIVERY REPORT SENDING REQUEST\nSignificance:\tdual\nDirection:\tthe Application Client of the Constrained UE to the MSGin5G Client of the MSGin5G Gateway UE\nTable A.2.1.2-1: message content for sending a message delivery status report to MSGin5G Client\n\nIf using the message content specified in table A.2.1.2-1, the Application Client may generate a message according to 6.4.2.3.2 and send the generated message to the MSGin5G Client.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.1.2-1: message content for sending a message delivery status report to MSGin5G Client",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.1.3\tfor sending a message to Application Client",
                            "text_content": "For sending a message to Application Client, the MSGin5G Client may use the message content specified in Table A.2.1.3-1.\nMessage type:\tMESSAGE RECEIVED REQUEST\nSignificance:\tdual\nDirection:\tthe MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE\nTable A.2.1.3-1: message content for sending a message to Application Client\nIf using the message content specified in table A.2.1.3-1, the MSGin5G Client may generate a message according to 6.4.2.2.1 and send the generated message to the Application Client.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.1.3-1: message content for sending a message to Application Client",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.1.4\tfor sending a message delivery status report to Application Client",
                            "text_content": "For sending a message delivery status report to Application Client, the MSGin5G Client may use the message content specified in Table A.2.1.4-1.\nMessage type:\tDELIVERY REPORT RECEIVED REQUEST\nSignificance:\tdual\nDirection:\tthe MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE\nTable A.2.1.4-1: message content for sending a message delivery status report to MSGin5G Client\n\nIf using the message content specified in table A.2.1.4-1, the MSGin5G Client may generate a message according to 6.4.2.2.3 and send the generated message to the Application Client.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.1.4-1: message content for sending a message delivery status report to MSGin5G Client",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.1.5\tfor sending a message sending response to Application Client",
                            "text_content": "For sending a message sending response to Application Client, the MSGin5G Client may use the message content specified in Table A.2.1.5-1.\nMessage type:\tMESSAGE SENDING RESPONSE\nSignificance:\tdual\nDirection:\tthe MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE\nTable A.2.1.5-1: message content for message sending response\n\nIf using the message content specified in table A.2.1.5-1, the MSGin5G Client may generate a message according to 6.4.2.2.3 and send the generated message to the Application Client.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.1.5-1: message content for message sending response",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.1.6\tfor sending a message received response to MSGin5G Client",
                            "text_content": "For sending a message sending response to MSGin5G Client, the Application Client of the Constrained UE may use the message content specified in Table A.2.1.6-1.\nMessage type:\tMESSAGE RECEIVED RESPONSE\nSignificance:\tdual\nDirection:\tthe Application Client of the Constrained UE to the MSGin5G Client of the MSGin5G Gateway UE\nTable A.2.1.6-1: message content for message sending response\n\nIf using the message content specified in table A.2.1.6-1, the Application Client may generate a message according to 6.4.2.3.3 and send the generated message to the MSGin5G Client.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.1.6-1: message content for message sending response",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.1.7\tRegistration Request",
                            "text_content": "The Registration Request is sent by the Application Client of the Constrained UE to the MSGin5G Client of the MSGin5G Gateway UE to initiate registration. See table A.2.1.7.\nMessage type:\tREGISTRATION REQUEST\nSignificance:\tdual\nDirection:\tthe Application Client of the Constrained UE to the MSGin5G Client of the MSGin5G Gateway UE\nTable A.2.1.7: REGISTRATION REQUEST content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.1.7: REGISTRATION REQUEST content",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.1.8\tRegistration Accept",
                            "text_content": "The Registration Accept is sent by the MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE to indicate the registration is accepted. See table A.2.1.8.\nMessage type:\tREGISTRATION ACCEPT\nSignificance:\tdual\nDirection:\tthe MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE\nTable A.2.1.8: REGISTRATION ACCEPT content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.1.8: REGISTRATION ACCEPT content",
                                    "table number": 10,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.1.9\tRegistration Reject",
                            "text_content": "The Registration Reject is sent by the MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE to indicate the registration is rejected. See table A.2.1.9.\nMessage type:\tREGISTRATION REJECT\nSignificance:\tdual\nDirection:\tthe MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE\nTable A.2.1.9: REGISTRATION REJECT content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.1.9: REGISTRATION REJECT content",
                                    "table number": 11,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.1.10\tDe-registration Request",
                            "text_content": "The De-registration Request is sent by the Application Client of the Constrained UE to the MSGin5G Client of the MSGin5G Gateway UE to initiate de-registration. See table A.2.1.10.\nMessage type:\tDEREGISTRATION REQUEST\nSignificance:\tdual\nDirection:\tthe Application Client of the Constrained UE to the MSGin5G Client of the MSGin5G Gateway UE\nTable A.2.1.10: DEREGISTRATION REQUEST content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.1.10: DEREGISTRATION REQUEST content",
                                    "table number": 12,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.1.11\tDe-registration Accept",
                            "text_content": "The De-registration Accept is sent by the MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE to indicate the de-registration is accepted. See table A.2.1.11.\nMessage type:\tDEREGISTRATION ACCEPT\nSignificance:\tdual\nDirection:\tthe MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE\nTable A.2.1.11: DEREGISTRATION ACCEPT content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.1.11: DEREGISTRATION ACCEPT content",
                                    "table number": 13,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.1.12\tDe-registration Reject",
                            "text_content": "The De-registration Reject is sent by the MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE to indicate the de-registration is rejected. See table A.2.1.12.\nMessage type:\tDEREGISTRATION REJECT\nSignificance:\tdual\nDirection:\tthe MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE\nTable A.2.1.12: DEREGISTRATION REJECT content\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.1.12: DEREGISTRATION REJECT content",
                                    "table number": 14,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "A.2.2\tinformation elements coding",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "A.2.2.1\tMessage Type",
                            "text_content": "The purpose of the Message type information element is to identify the type of the request or response.\nThe value part of the Message type information element is coded as shown in Table A.2.2.1-1.\nThe Message type information element is a type 3 information element with a length of 1 octet.\nTable A.2.2.1-1: Message types\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.2.2.1-1: Message types",
                                    "table number": 15,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.2\tTarget address",
                            "text_content": "The Target address information element is used to indicate the address of target recipient or the target group while sending message from Constrained UE.\nThe Target address information element is coded as shown in figure A.2.2.2-1 and table A.2.2.2-1.\nThe Target address information element is a type 4 information element.\n\nFigure A.2.2.2-1: Target address information element\nTable A.2.2.2-1: Target address information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 16,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.2-1: Target address information element",
                                    "table number": 17,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.3\tApplication ID",
                            "text_content": "The purpose of the Application ID information element is to uniquely identify the application for which the payload is intended.\nThe Application ID information element is coded as shown in figure A.2.2.3-1 and table A.2.2.3-1\nThe Application ID information element is a type 3 information element with a length of 3 octets.\n\nFigure A.2.2.3-1: Application ID value\nTable A.2.2.3-1: Application ID value\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 18,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.3-1: Application ID value",
                                    "table number": 19,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.4\tMessage ID",
                            "text_content": "The Message ID information element uniquely identifies a message or message delivery report.\nThe Message ID information element is coded as shown in Figure A.2.2.4-1 and Table A.2.2.4-1.\nThe Message ID information element is a type 3 information element with a length of 16 octets.\n\nFigure A.2.2.4-1: Message ID value\nTable A.2.2.4-1: Message ID value\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 20,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.4-1: Message ID value",
                                    "table number": 21,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.5\tPayload",
                            "text_content": "The Payload information element is used to send application specific message;\nThe Payload information element is coded as shown in Figure A.2.2.5-1 and Table A.2.2.5-1.\nThe Payload data information element is a type 6 information element.\n\nFigure A.2.2.5-1: Payload information element\nTable A.2.2.5-1: Payload information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 22,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.5-1: Payload information element",
                                    "table number": 23,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.6\tDelivery Status Required",
                            "text_content": "The purpose of the Delivery Status Required information element is to identify whether delivery status is required from the receiver or not.\nThe value part of the Delivery Status Required information element is coded as shown in Figure A.2.2.6-1 and Table A.2.2.6-1.\nThe Delivery Status Required information element is a type 1 information element.\n\n\nFigure A.2.2.6-1: Delivery Status Required type\nTable A.2.2.6-1: Delivery Status Required type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 24,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.6-1: Delivery Status Required type",
                                    "table number": 25,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.7\tTarget Type",
                            "text_content": "The purpose of the Target Type information element is to indicate the type of the message target.\nThe value part of the Target Type information element is coded as shown in Figure A.2.2.7-1 and Table A.2.2.7-1.\nThe Target Type information element is a type 1 information element.\n\n\nFigure A.2.2.7-1: Target Type type\nTable A.2.2.7-1: Target Type type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 26,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.7-1: Target Type type",
                                    "table number": 27,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.8\tDelivery Status",
                            "text_content": "The Delivery Status information element is used to indicate the delivery status from message recipient.\nThe Delivery Status information element is coded as shown in Figure A.2.2.8-1 and Table A.2.2.8-1.\nThe Delivery Status information element is a type 3 information element.\n\nFigure A.2.2.8-1: Delivery Status type\nTable A.2.2.8-1: Delivery Status type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 28,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.8-1: Delivery Status type",
                                    "table number": 29,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.9\tPriority",
                            "text_content": "The purpose of the priority information element is to identify application level priority of the received message.\nThe value part of the priority information element is coded as shown in Figure 2.2.9-1 and Table 2.2.9-1.\nThe priority type information element is a type 1 information element.\n\n\nFigure 2.2.9-1: Priority type\nTable 2.2.9-1: Priority type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 30,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 2.2.9-1: Priority type",
                                    "table number": 31,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.10\tOriginator Address",
                            "text_content": "The Originator Address information element is used to indicate address of originating UE/AS while sending message to Constrained UE.\nThe Originator Address information element is coded as shown in Figure A.2.2.10-1 and Table A.2.2.10-1.\nThe Originator Address information element is a type 4 information element.\n\nFigure A.2.2.10-1: Originator Address information element\nTable A.2.2.10-1: Originator Address information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 32,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.10-1: Originator Address information element",
                                    "table number": 33,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.11\tGroup ID",
                            "text_content": "The Group ID information element is used to indicate the group which the message is from while sending message to Constrained UE.\nThe Group ID information element is coded as shown in Figure A.2.2.11-1 and Table A.2.2.11-1.\nThe Group ID information element is a type 4 information element.\n\nFigure A.2.2.11-1: Group ID information element\nTable A.2.2.11-1: Group ID information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 34,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.11-1: Group ID information element",
                                    "table number": 35,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.11\tResult",
                            "text_content": "The Result information element is used to indicate the result of handling message sending request as described in A.2.1.1.\nThe Result information element is coded as shown in Figure A.2.2.11-1 and Table A.2.2.11-1.\nThe Result information element is a type 1 information element.\n\n\nFigure A.2.2.11-1: Result type\nTable A.2.2.11-1: Result type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 36,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.11-1: Result type",
                                    "table number": 37,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.12\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.2.2.13\tReply-to Message ID",
                            "text_content": "The Reply-to Message ID information element uniquely identifies the message delivery report and is same with the Message ID included in the message acknowledged.\nThe Reply-to Message ID information element is coded as shown in Figure A.2.2.13-1 and Table A.2.2.13-1.\nThe Reply-to Message ID information element is a type 3 information element with a length of 16 octets.\n\nFigure A.2.2.13-1: Reply-to Message ID value\nTable A.2.2.13-1: Reply-to Message ID value\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 38,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.13-1: Reply-to Message ID value",
                                    "table number": 39,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.14\tVoid",
                            "text_content": "\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.2.2.15\tCredential information",
                            "text_content": "The purpose of the Credential information information element is to carry credentials from a credentials holder(e.g. application server, the MSGin5G Gateway UE).\nThe Credential information information element is coded as shown in Figure A.2.2.15-1 and Table A.2.2.15-1.\nThe Credential information information element is a type 6 information element with a minimum length of 3 octets and a maximum length of 65537  octets.\n\nFigure A.2.2.15-1: Credential information information element\nTable A.2.2.15-1: Credential information information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 40,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.15-1: Credential information information element",
                                    "table number": 41,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.16\tMSCin5G Registration ID",
                            "text_content": "The purpose of the MSCin5G Registration ID information element is to indicate the Registration ID that is allocated by the MSGin5G Client of the MSGin5G Gateway UE.\nThe MSCin5G Registration ID is a type 3 information element with a length of 6 octets.\nThe MSCin5G Registration ID information element is coded as shown in figure A.2.2.16 and table A.2.2.16.\n\nFigure A.2.2.16: MSCin5G Registration ID information element\nTable A.2.2.16: MSCin5G Registration ID information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 42,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.16: MSCin5G Registration ID information element",
                                    "table number": 43,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.17\tMSGin5G cause",
                            "text_content": "The purpose of the MSGin5G cause information element is to indicate the cause used for MSGin5G procedures.\nThe MSGin5G cause is a type 3 information element with a length of 2 octets.\nThe MSGin5G cause information element is coded as shown in figure A.2.2.17 and table A.2.2.17.\n\nFigure A.2.2.17: MSGin5G cause information element\nTable A.2.2.17: MSGin5G cause information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 44,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.2.2.17: MSGin5G cause information element",
                                    "table number": 45,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "A.2.2.18\tSpare half octet",
                            "text_content": "This element is used in the L3 messages as specified in clause A.2.1 when an odd number of half octet type 1 information elements are used. This element is filled with spare bits set to zero and is placed in bits 5 to 8 of the octet unless otherwise specified.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "A.3\tBased on CoAP",
            "description": "The following clauses describe example of the MSGin5G Constrained UE message format based on CoAP.\nNOTE:\tMessage format and protocol defined in this clause can be used if the communication between the Constrained UE and the MSGin5G GW UE is not based on PC5 / NR-PC5.\nNOTE 2:\tRouting CoAP messages between the Constrained UE and the MSGin5G GW UE is not specified in this version of the specification and is implementation specific.\n\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.3.1\tmessage contents and functions",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "A.3.1.1\tfor sending a message to MSGin5G Client",
                            "text_content": "In order to send a message, the Application Client on the constrained UE may generate an CoAP POST request according to procedures specified in IETF RFC 7252 [5] to the MSGin5G Client on a MSGin5G UE. In the CoAP POST request message, the Application Client:\na)\tset the \"T\" field in the CoAP header to 0 if delivery status report from the recipient is requested, i.e. indicates this message is the type of Confirmable, to ensure the application layer delivery status report;\nb)\tinclude the MSGin5G Client address in an CoAP Option, e.g. if the MSGin5G Client address is a URI, include a Uri-Path Option with the value of the URI;\nc)\tset the CoAP Content-Format to \"50\", i.e. application/json; and\nd)\tinclude the information elements specified in clause 6.4.2.3.1 in the CoAP payload encoded in JSON format as specified in clause A.3.2.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.1.2\tfor sending a message delivery status report to MSGin5G Client",
                            "text_content": "In order to send a message delivery status report, the Application Client on the constrained UE may generate an CoAP POST request according to procedures specified in IETF RFC 7252 [5] to the MSGin5G Client on a MSGin5G UE. In the CoAP POST request message, the Application Client:\na)\tset the \"T\" field in the CoAP header to 0 indicating this message is the type of Confirmable;\nb)\tinclude the MSGin5G Client address in an CoAP Option, e.g. if the MSGin5G Client address is a URI, include a Uri-Path Option with the value of the URI;\nc)\tset the CoAP Content-Format to \"50\", i.e. application/json;\nd)\tinclude the information elements specified in clause  6.4.2.3.2 in the CoAP payload encoded in JSON format as specified in clause A.3.2.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.1.3\tfor sending a message to Application Client",
                            "text_content": "In order to send a message, the MSGin5G Client may generate an CoAP POST request according to procedures specified in IETF RFC 7252 [5] to the Application Client. In the CoAP POST request message, the MSGin5G Client:\na)\tset the \"T\" field in the CoAP header to 0 if delivery status report from the recipient is requested, i.e. indicates this message is the type of Confirmable, to ensure the application layer delivery status report;\nb)\tinclude the Application Client address in an CoAP Option, e.g. if the Application Client address is a URI, include a Uri-Path Option with the value of the URI;\nc)\tset the CoAP Content-Format to \"50\", i.e. application/json;\nd)\tinclude the information elements specified in clause  6.4.2.2.1 in the CoAP payload encoded in JSON format as specified in clause A.3.2.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.1.4\tfor sending a message delivery status report to Application Client",
                            "text_content": "In order to send a message delivery status report, the MSGin5G Client may generate an CoAP POST request according to procedures specified in IETF RFC 7252 [5] to the Application Client. In the CoAP POST request message, the MSGin5G Client:\na)\tset the \"T\" field in the CoAP header to 0 indicating this message is the type of Confirmable;\nb)\tinclude the Application Client address in an CoAP Option, e.g. if the Application Client address is a URI, include a Uri-Path Option with the value of the URI;\nc)\tset the CoAP Content-Format to \"50\", i.e. application/json;\nd)\tinclude the information elements specified in clause  6.4.2.2.3 in the CoAP payload encoded in JSON format as specified in clause A.3.2.4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.1.5\tfor sending a message sending response to Application Client",
                            "text_content": "After receiving a CoAP POST request for sending a message from Application Client, the MSGin5G Client may generate an CoAP 2.05 response according to procedures specified in IETF RFC 7252 [5] to the Application Client. In the response, the MSGin5G Client:\na)\tinclude the Application Client address in an CoAP Option, e.g. if the Application Client address is a URI, include a Uri-Path Option with the value of the URI;\nb)\tset the CoAP Content-Format to \"50\", i.e. application/json; and\nc)\tinclude the information elements specified in clause 6.4.2.2.5 in the CoAP payload encoded in JSON format as specified in clause A.3.2.5.\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.1.6\tfor sending a message received response to MSGin5G Client",
                            "text_content": "After receiving a CoAP POST request for sending a message from MSGin5G Client, the Application Client may generate an CoAP 2.05 response according to procedures specified in IETF RFC 7252 [5] to the Application Client. In the response, the MSGin5G Client:\na)\tinclude the MSGin5G Client address in an CoAP Option, e.g. if the MSGin5G Client address is a URI, include a Uri-Path Option with the value of the URI;\nb)\tset the CoAP Content-Format to \"50\", i.e. application/json; and\nc)\tinclude the information elements specified in clause 6.4.2.3.3 in the CoAP payload encoded in JSON format as specified in clause A.3.2.6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.1.7\tRegistration Request",
                            "text_content": "The registration request sent by the Application Client of the Constrained UE to the MSGin5G Client of the MSGin5G Gateway UE is based on the CoAP POST request as specified in IETF RFC 7252 [5]. The Application Client of the Constrained UE:\na)\tshall set the \"T\" field in the CoAP header to 0 to indicate acknowledge message required;\nb)\tshall include the address of the MSGin5G Gateway UE in the Option header of the CoAP POST request and set the Option header to a corresponding value, e.g. if address of the MSGin5G Gateway UE is a URI, the Uri-Path Option is set to the value of such URI;\nc)\tshall set the \"Content-Format\" element to \"50\" to indicate the format of the CoAP payload is \"application/json\"; and\nd)\tshall include the following information elements in the CoAP payload encoded in JSON format:\n1)\tthe \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\n2)\tthe \"Message Type\" element to indicate that the CoAP POST request is used for registration;\n3)\tthe \"Application ID \" element to indicate the application client initiating registration; and\n4)\tthe \"Credential information\" element to indicate the credential information of the Constrained UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.1.8\tRegistration Response",
                            "text_content": "The registration response sent by the MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE is based on the CoAP 2.01 (Created) response or CoAP 2.04 (Change) response as specified in IETF RFC 7252 [5]. The Application Client of the Constrained UE:\na)\tshall include the CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for registration; and\nb)\tshall include the \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\". The CoAP payload:\n1)\tshall include the \"Registration Result\" element to indicate whether the registration is success or failure;\n2)\tshall include the \"Registration ID\" element allocated by the MSGin5G Client of the MSGin5G Gateway UE if the value of \"Registration Result\" element is set to true; and\n3)\tshall include the \"Failure Reason\" element to indicate why the registration request is rejected by the MSGin5G Client of the MSGin5G Gateway UE if the value of \"Registration Result\" element is set to false.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.1.9\tDe-registration Request",
                            "text_content": "The de-registration request sent by the Application Client of the Constrained UE to the MSGin5G Client of the MSGin5G Gateway UE is based on the CoAP POST request as specified in IETF RFC 7252 [5]. The Application Client of the Constrained UE:\na)\tshall set the \"T\" field in the CoAP header to 0 to indicate acknowledge message required;\nb)\tshall include the address of the MSGin5G Gateway UE in the Option header of the CoAP POST request and set the Option header to a corresponding value, e.g. if address of the MSGin5G Gateway UE is a URI, the Uri-Path Option is set to the value of such URI;\nc)\tshall set the \"Content-Format\" element to \"50\" to indicate the format of the CoAP payload is \"application/json\"; and\nd)\tshall include the following information elements in the CoAP payload encoded in JSON format:\n1)\tthe \"MSGin5G service identifier\" element to indicate that this CoAP POST request is used for MSGin5G service;\n2)\tthe \"Message Type\" element to indicate that the CoAP POST request is used for de-registration; and\n3)\tthe \"Registration ID\" element to indicate which has been allocated by the MSGin5G Gateway UE during the registration procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.1.10\tDe-registration Response",
                            "text_content": "The de-registration response sent by the MSGin5G Client of the MSGin5G Gateway UE to the Application Client of the Constrained UE is based on the CoAP 2.01 (Created) response or CoAP 2.04 (Change) response as specified in IETF RFC 7252 [5]. The Application Client of the Constrained UE:\na)\tshall include the CoAP \"Message ID\" element and the \"Token\" element with the same values with those in the CoAP POST request for de-registration; and\nb)\tshall include the \"Content-Format\" element with \"50\" to indicate the format of the CoAP payload is \"application/json\". The CoAP payload:\n1)\tshall include the \"De-registration Result\" element to indicate whether the de-registration is success or failure;\n2)\tshall include the \"Registration ID\" element allocated by the MSGin5G Client of the MSGin5G Gateway UE if the value of \"De-registration Result\" element is set to true; and\n3)\tshall include the \"Failure Reason\" element to indicate why the de-registration request is rejected by the MSGin5G Client of the MSGin5G Gateway UE if the value of \"de-registration Result\" element is set to false.\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "A.3.2\tJSON Schema",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "A.3.2.1\tfor sending a message to MSGin5G Client",
                            "text_content": "The JSON schema for application client sending message is defined below:\n\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_APP_Message_schema\",\n\"title\": \"APP Message\",\n\"type\": \"object\",\n\"properties\": {\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"MESSAGE SENDING REQEUST\"\n],\n\"description\": \" Refer to Message Type, it indicates the usage of this message. The value MESSAGE SENDING REQEUST refers to message sending\"\n},\n\"appId\": {\n\"type\": \"string\",\n\"description\": \"Refer to Application ID\"\n},\n\"msgId\": {\n\"type\": \"string\",\n\"format\": \"uuid\",\n\"description\": \"Refer to Message ID\"\n},\n\"isDelivStatReq\": {\n\"type\": \"boolean\",\n\"default\": false,\n\"description\": \"Refer to Delivery Status Required\"\n},\n\"destAddr\": {\n\"type\": \"object\",\n\"properties\": {\n\"destAddrType\": {\n\"enum\": [\n\"UE\",\n\"AS\",\n\"GROUP\"\n],\n\"description\": \"the target type\"\n},\n\"addr\": {\n\"type\": \"string\",\n\"description\": \"the target address\"\n}\n}\n},\n\"payload\": {\n\"type\": \"string\",\n\"description\": \"Refer to Payload\"\n},\n},\n\"required\": [\n\"msgId\",\n\"destAddr\",\n\"payload\"\n]\n}\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.2.2\tfor sending a message delivery report to MSGin5G Client",
                            "text_content": "The JSON schema for application client sending message delivery status report is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_APP_Delivery REPORT_schema\",\n\"title\": \"APP_Delivery REPORT\",\n\"type\": \"object\",\n\"properties\": {\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"DELIVERY REPORT SENDING REQEUST\"\n],\n\"description\": \" Refer to Message Type, it indicates the usage of this message. The value DELIVERY REPORT SENDING REQEUST refers to message delivery status report sending\"\n},\n\"msgId\": {\n\"type\": \"string\",\n\"format\": \"uuid\",\n\"description\": \"Refer to Message ID indicating unique identity of this message delivery report\"\n},\n\"reply2msgId\": {\n\"type\": \"string\",\n\"format\": \"uuid\",\n\"description\": \"Refer to Reply-to Message ID indicating which message the delivery status report is for\"\n},\n\"deliveryStatus\": {\n\"enum\": [\n\"SUCCESS\",\n\"FAILED\"\n],\n\"description\": \"Refer to delivery status\"\n}\n},\n\"required\": [\n\"msgId\",\n\"deliveryStatus\",\n\"msgType\"\n]\n}\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.2.3\tfor sending a message to Application Client",
                            "text_content": "The JSON schema for MSGin5G client sending message to Application Client is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Messsage-to-APP_schema\",\n\"title\": \"Message to APP\",\n\"type\": \"object\",\n\"properties\": {\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"MESSAGE RECEIVED REQEUST\"\n],\n\"description\": \" Refer to Message Type indicating the usage of this message. The value MESSAGE RECEIVED REQEUST refers to sending message to a application client\"\n},\n\"msgId\": {\n\"type\": \"string\",\n\"format\": \"uuid\",\n\"description\": \"Refer to Message ID indicating which message is for\"\n},\n\"oriAddr\": {\n\"type\": \"string\",\n\"description\": \"Refer to the Originator Address indicating the originating group if the message is a group message\"\n},\n\"groupId\": {\n\"type\": \"string\",\n\"description\": \"Refer to the Group ID indicating the originating UE or AS\"\n},\n\"payload\": {\n\"type\": \"string\",\n\"description\": \"Refer to Payload\"\n},\n\"isDelivStatReq\": {\n\"type\": \"boolean\",\n\"default\": false,\n\"description\": \"Refer to Delivery Status Required\"\n},\n\"priority\": {\n\"type\": \"string\",\n\"enum\": [\n\"HIGH\",\n\"MEDIUM\",\n\"LOW\"\n],\n\"default\": \"NORMAL\",\n\"description\": \"Refer to Priority Type\"\n},\n},\n\"required\": [\n\"msgId\",\n\"msgType\",\n\"payload\"\n]\n}\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.2.4\tfor sending a message delivery report to Application Client",
                            "text_content": "The JSON schema for MSGin5G client sending message delivery status report to Application Client is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Delivery-Report-to-APP schema\",\n\"title\": \"Delivery report to APP\",\n\"type\": \"object\",\n\"properties\": {\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"DELIVERY REPORT RECEIVED REQUEST\"\n],\n\"description\": \" Refer to Message Type indicating the usage of this message. The value DELIVERY REPORT RECEIVED REQUEST refers to sending a message delivery status report to Application Client\"\n},\n\"msgId\": {\n\"type\": \"string\",\n\"format\": \"uuid\",\n\"description\": \"Refer to Message ID indicating unique identity of this message delivery report\"\n},\n\"reply2msgId\": {\n\"type\": \"string\",\n\"format\": \"uuid\",\n\"description\": \"Refer to Reply-to Message ID indicating which message the delivery status report is for\"\n},\n\"deliveryStatus\": {\n\"type\": \"string\",\n\"enum\": [\n\"SUCCESS\",\n\"FAILED\"\n],\n\"description\": \"Refer to delivery status\"\n}\n},\n\"required\": [\n\"msgId\",\n\"deliveryStatus\",\n\"msgType\"\n]\n}\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.2.5\tfor sending a message sending response to Application Client",
                            "text_content": "The JSON schema for MSGin5G client sending message sending response to Application Client is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Message-Sending-Response schema\",\n\"title\": \"Delivery message sending response to APP\",\n\"type\": \"object\",\n\"properties\": {\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"MESSAGE SENDING RESPONSE\"\n],\n\"description\": \" Refer to Message Type indicating the usage of this message. The value MESSAGE SENDING RESPONSE refers to the response for the message sending of a Application Client\"\n},\n\"failReason\": {\n\"type\": \"string\",\n\"description\": \"Refer to the failure reason\"\n},\n\"result\": {\n\"type\": \"string\",\n\"enum\": [\n\"SUCCESS\",\n\"FAILED\"\n],\n\"description\": \"Refer to the result\"\n}\n},\n\"required\": [\n\"result\",\n\"msgType\"\n]\n}\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.2.6\tfor sending a message received response to MSGin5G Client",
                            "text_content": "The JSON schema for Application client sending message received response to MSGin5G Client is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_ Message-Received-Response schema\",\n\"title\": \"Delivery message received response to MSGin5G Client\",\n\"type\": \"object\",\n\"properties\": {\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"MESSAGE RECEIVED RESPONSE\"\n],\n\"description\": \" Refer to Message Type indicating the usage of this message. The value MESSAGE RECEIVED RESOPNSE refers to sending a response for receiving a message from MSGin5G Client\"\n},\n\"failReason\": {\n\"type\": \"string\",\n\"description\": \"Refer to the failure reason\"\n},\n\"result\": {\n\"type\": \"string\",\n\"enum\": [\n\"SUCCESS\",\n\"FAILED\"\n],\n\"description\": \"Refer to the result\"\n}\n},\n\"required\": [\n\"result\",\n\"msgType\"\n]\n}\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.2.7\tRegistration structure",
                            "text_content": "The schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause A.3.1.7 are described in the description of the properties. The JSON schema of the CoAP POST request for the MSGin5G registration is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Registration_request_schema\",\n\"title\": \"MSGin5G Registration Request\",\n\"type\": \"object\",\n\"properties\": {\n\"msgIden\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Refer to Service identifier of MSGin5G service\"\n},\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"REG\"\n],\n\"description\": \"Refer to the usage of this message. The value REG refers to MSGin5G Registration\"\n},\n\n\"appId\": {\n\"type\": \"string\",\n\"description\": \"Refer to Application ID\"\n},\n\"credential\": {\n\"type\": \"string\",\n\"description\": \"Refer to Credential Information\"\n}\n},\n\"required\": [\n\"msgId\",\n\"msgType\",\n\"l2ID\",\n\"appID\",\n\"credential\"\n]\n}\nThe schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause A.3.1.8 are described in the description of the properties. The JSON schema of CoAP 2.01 (Created) response or CoAP 2.04 (Change) response for the MSGin5G registration is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Registration_response_schema\",\n\"title\": \"MSGin5G Registration Response\",\n\"type\": \"object\",\n\"properties\": {\n\"result\": {\n\"type\": \"boolean\",\n\"default\": true,\n\"description\": \"Refer to Registration result. The value true refers to succcess\"\n},\n\"registration ID\": {\n\"type\": \"string\",\n\"description\": \"Refer to Registration ID\"\n},\n\"failure reason\": {\n\"type\": \"string\",\n\"description\": \"Refer to Failure Reason\"\n}\n},\n\"required\": [\n\"result\"\n]\n}\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.2.8\tDe-registration structure",
                            "text_content": "The schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause A.3.1.9 are described in the description of the properties. The JSON schema of the CoAP POST request for the MSGin5G de-registration is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Deregistration_request_schema\",\n\"title\": \"MSGin5G Deregistration Request\",\n\"type\": \"object\",\n\"properties\": {\n\"msgIden\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Refer to Service identifier of MSGin5G service\"\n},\n\"msgType\": {\n\"type\": \"string\",\n\"enum\": [\n\"DEREG\"\n],\n\"description\": \"Refer to the usage of this message. The value DEREG refers to MSGin5G De-registration\"\n},\n\"registrationID\": {\n\"type\": \"string\",\n\"description\": \"Refer to Registration ID\"\n}\n},\n\"required\": [\n\"msgId\",\n\"msgType\",\n\"RegistrationID\"\n]\n}\nThe schema is based on JSON Schema Draft-07 [8]. For reducing the overhead of the message used in MSGin5G service, the properties are defined as shorten form and the relationships between the properties and elements used in clause A.3.1.10 are described in the description of the properties. The JSON schema of CoAP 2.01 (Created) response or CoAP 2.04 (Change) response for the MSGin5G de-registration is defined below:\n{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"http://www.3gpp.org/MSGin5G/MSGin5G_Deregistration_response_schema\",\n\"title\": \"MSGin5G Deregistration Response\",\n\"type\": \"object\",\n\"properties\": {\n\"result\": {\n\"type\": \"boolean\",\n\"default\": true,\n\"description\": \"Refer to Registration result. The value true refers to succcess\"\n},\n\"registration ID\": {\n\"type\": \"string\",\n\"description\": \"Refer to Registration ID\"\n},\n\"failure reason\": {\n\"type\": \"string\",\n\"description\": \"Refer to Failure Reason\"\n}\n},\n\"required\": [\n\"result\"\n]\n}\n\nThis annex contains information to be provided to IANA for exchange of CoAP protocol messages used between MSGin5G clients acting as a realy on UEs UDP port registration or MSGin5G RelayProtocol (MSGin5GRP). The following information is to be used to register CoAPRP user port number and service name in the \"IANA Service Name and Transport Protocol Port Number Registry\" and specifically \"Service Name and Transport Protocol Port Number Registry\". This registration form can be found at: .\nNOTE:\tThe UDP port number of MSGin5G service has been assigned by 3GPP rather than IANA using a 3GPP allocated port number as specfied by 3GPP TS 29.641 [20].\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "This annex contains information to be provided to IANA for exchange of CoAP protocol messages used between MSGin5G clients acting as a realy on UEs UDP port registration or MSGin5G RelayProtocol (MSGin5GRP). The following information is to be used to register CoAPRP user port number and service name in the \"IANA Service Name and Transport Protocol Port Number Registry\" and specifically \"Service Name and Transport Protocol Port Number Registry\". This registration form can be found at: https://www.iana.org/form/ports-services.",
                                    "table number": 46,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "title": "C.1\tMessage delivery flow at MSGin5G Server",
            "description": "Figure C.1-1 illustrates the message delivery flow at the terminating MSGin5G Server (i.e. the hosting MSGin5G Server of the recipient MSGin5G UE).\nFigure C.1-1: The Message delivery flow at MSGin5G Server\n\n\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "",
                    "table number": 47,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        }
    ]
}