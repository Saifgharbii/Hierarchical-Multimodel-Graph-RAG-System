{
    "document_name": "32290-i40.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document specifies service, operations and procedures of 5G charging for service based interface. This charging description includes the charging architecture and scenarios as well as the mapping of the common charging architecture specified in TS 32.240 [1]. The present document is related to other 3GPP charging TSs as follows:\n-\tThe common 3GPP charging architecture is specified in TS 32.240 [1].\n-\tThe protocol that are used for service based interface is specified in TS 32.291 [58].\nThe description is following the same methodology as used in TS 23.501 [201] and TS 23.502 [202] for the 5G system.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TS 32.240: \"Telecommunication management; Charging management; Charging architecture and principles\".\n[2] - [29]\tVoid.\n[30]\t3GPP TS 32.255: \"Telecommunication management; Charging management; 5G Data connectivity domain charging; stage 2\".\n[31]\t3GPP TS 32.260: \"Telecommunication management; Charging management; IP Multimedia Subsystem (IMS) charging\".\n[32]\t3GPP TS 32.254: \"Telecommunication management; Charging management; Exposure function Northbound Application Program Interfaces (APIs) charging\".\n[33]\t3GPP TS 32.256: \"Telecommunication management; Charging management; 5G connection and mobility domain charging; Stage 2\".\n[34]\t3GPP TS 32.274: \"Telecommunication management; Charging management; Short Message Service (SMS) charging\".\n[35]\t3GPP TS 28.201: \"Telecommunication management; Charging management; Network slice performance and analytics charging in the 5G System (5GS); Stage 2\".\n[36]\t3GPP TS 28.202: \"Telecommunication management; Charging management; Network slice management charging in the 5G System (5GS); Stage 2\".\n[37]\t3GPP TS 32.270: \"Telecommunication management; Charging management; Multimedia Messaging Service (MMS) charging\".\n[38]\t3GPP TS 32.257: \"Telecommunication management; Charging management; Edge computing domain charging\".\n[39] - [49]\tVoid.\n[50]\t3GPP TS 32.299: \"Telecommunication management; Charging management; Diameter charging application\".\n[51] - [54] \tVoid.\n[55] - [57]\tVoid.\n[58]\t3GPP TS 32.291: \"Telecommunication management; Charging management; 5G system; Charging service, stage 3.\n[59] - [99]\tVoid.\n[100]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[101] - [200]\tVoid.\n[201]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[202]\t3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".\n[203] - [206]\tVoid.\n[207] - [299] \tVoid.\n[300]\t3GPP TS 29.510: \" \t5G System; Network function repository services; Stage 3\".\n[301] - [370]\tVoid.\n[371] - [399]\tVoid.\n[400] - [499]\tVoid.\n[500] - [599]\tVoid.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tDefinitions",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms and definitions given in 3GPP TR 21.905 [100], TS 32.240 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in either 3GPP TR 21.905 [100] or TS 32.240 [1].\n5G Access Network: An access network comprising a NG-RAN and/or non-3GPP AN connecting to a 5G Core Network.\n5G Core Network: The core network specified in the present document. It connects to a 5G Access Network.\nNF service: a functionality exposed by a NF through a service based interface and consumed by other authorized NFs.\nNF service operation: An elementary unit a NF service is composed of.\nservice based interface: It represents how a set of services is provided/exposed by a given NF.\ncharging session: The association between the CHF (NF Service Producer) that provides the charging service and NF service consumer.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tSymbols",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the following symbols apply:\nNchf\tService-based interface exhibited by Charging Function.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.3\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [100] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [100].\n5GC\t5G Core Network\n5GS\t5G System\nAMF\tAccess and Mobility Management Function\nCCS\tConverged Charging System\nCEF\tCharging Enablement Function\nCHF\tCharging Function\nIEC\tImmediate Event Charging\nMB-SMF\tMulticast/Broadcast Session Management Function\nMMS\tMultimedia Messaging Service\nMnS\tManagement Service\nNF\tNetwork Function\nPCF\tPolicy Control Function\nSBI\tService based Interface\nSMSF\tShort Message Service Function\nSMF\tSession Management Function\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tArchitecture reference model",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The present document describes the service based architecture for 5G Charging.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tReference architecture",
                    "description": "",
                    "summary": "",
                    "text_content": "The NFs with CTF interact with CHF using Nchf interface for converged charging or offline only charging. The PCF interacts with CHF using Nchf interface for Spending Limit Control. Two CHFs can interact using Nchf interface for converged charging. The Nchf is a service based interface for NF and CHF.\nFigure 4.2.1 depicts the reference architecture for the Nchf Interface.\nThe figure depicts a reference architecture for the N-channel interface of the SBI (Single-Bi-Wire) interface, illustrating the various components and their connections.\nFigure 4.2.1: Reference Architecture for the Nchf Interface; SBI representation\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5\tCharging function requirement",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tOffline charging scenario",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.1.1\tBasic principles",
                            "text_content": "Basic principles for offline charging are defined in TS 32.240 [1].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.2\tCharging scenarios",
                            "text_content": "Two basic scenarios are used:\n-\tEvent based charging;\n-\tSession based charging.\nBoth  scenarios may generate CDR files, which may then be transferred to the network operator's BD for the purpose of subscriber billing and/or inter-operator accounting.\nFigure 5.1.2.2.1.1 shows a scenario for Post Event Charging, (PEC) where the NF (CTF) interacts with the CHF after the service delivery.\nThe figure depicts a network scenario where a post-event charging mechanism is in place, with a focus on the 1.2.2.1 and 1.1.1.1 network segments. The diagram illustrates the network topology, including the network elements such as switches, routers, and network devices. The figure also highlights the importance of network redundancy and failover mechanisms to ensure the smooth operation of the network.\nFigure 5.1.2.2.1.1: Post Event Charging\n1)\tRequest for resource usage: A request for session establishment is received in the NF (CTF).\n2)\tContent/Service Delivery: the NF (CTF) delivers the content/service.\n3)\tCharging Data Request [Event]: The NF (CTF) the CTF generates charging data related to the delivered service and sends the request for the CHF to store related charging data for CDR generation purpose.\n4)\t Create CDR: the CHF stores received information and creates a CDR related to the service.\n5)\tCharging Data Response [Event]: The CHF informs the NF (CTF) on the result of the request.\n\nFigure 5.1.2.2.2.1 shows a scenario for Offline session based charging where the NF (CTF) interacts with the CHF.\nFigure 5 illustrates the offline charging process in a 5G network. The diagram shows the various components involved, including the base station (gNB), user equipment (UE), and the charging infrastructure. The offline charging process involves the use of a charging station (SS) to provide power to the UE, which is then used to charge the battery of the UE. The diagram highlights the importance of proper charging infrastructure in ensuring the efficient and reliable operation of 5G networks.\nFigure 5.1.2.2.2.1:  Offline charging\n1)\tRequest for service delivery and start of service delivery: A request for session establishment is received in the NF (CTF).\n2)\tCharging Data Request [Initial]: The NF (CTF) sends the request to inform the CHF about the service to be started.\n3)\t Open CDR: the CHF opens a CDR related to the service.\n4)\tCharging Data Response [Initial]: The CHF informs the NF (CTF) on the result of the request and optionnaly provides the usage reporting triggers applicable to the service.\n5)\tContent/Service Delivery: the NF (CTF) delivers the content/service.\n6)\tUsage Reporting Trigger: the NF (CTF) generates charging data related to service delivered, based on a trigger for usage reporting is met.\n7)\tCharging Data Request [Update]: the NF (CTF) sends the request for reporting the related charging data to the CHF.\n8)\t Update CDR: the CHF updates the CDR with charging data related to the service.\n9)\tCharging Data Response [Update]: The CHF informs the NF (CTF) on the result of the request.\n10)\tContent/Service Delivery: the NF (CTF) delivers the content/service.\n11)\t Service release: the service is released.\n12)\tCharging Data Request [Termination]: the NF (CTF) sends the request to the CHF, for charging data related to the service termination.\n13)\t Close CDR: the CHF closes the CDR with charging data related to the service termination.\n14)\tCharging Data Response [Termination]: The CHF informs the NF (CTF) on the result of the request.\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.2\tOnline charging scenario",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tBasic principles",
                            "text_content": "Basic principles for online charging are defined in TS 32.240 [1].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tCharging scenarios",
                            "text_content": "The following basic scenarios are used:\n1\tImmediate Event Charging\na)\tDecentralized Unit Determination and Centralized Rating\nb)\tCentralized Unit Determination and Centralized Rating\nc)\tDecentralized Unit Determination and Decentralized Rating\n2\tEvent charging with Unit Reservation\na)\tDecentralized Unit Determination and Centralized Rating\nb)\tCentralized Unit Determination and Centralized Rating\nc)\tDecentralized Unit Determination and Decentralized Rating\n3\tSession charging with Unit Reservation\na)\tDecentralized Unit Determination and Centralized Rating\nb)\tCentralized Unit Determination and Centralized Rating\nc)\tDecentralized Unit Determination and Decentralized Rating\nThe combination of Centralized Unit Determination with Decentralized Rating is not possible.\nThe scenarios described in TS 32.299 [50], clauses 5.2.2.1, 5.2.2.2 and 5.2.2.3, apply with the CHF acting as an OCF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.3\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tConverged Charging scenario",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tBasic principles",
                            "text_content": "When offline charging and online charging are  applicable to a service delivery, the charging information of both offline charging (without quota management) and online charging (with quota management) can be provided in a single command. The triggering for reporting the charging information can be any triggers of the offline charging or online charging (deferred or immediate triggers).\nThe invocation of the Charging Data Request for start of service, in case there is no valid quota for the rating group, can be done in either blocking mode or non-blocking mode:\n-\tblocking mode: the service delivery shall not start before its authorization from CHF;\n-\tnon-blocking mode: the service delivery may start before its authorization from CHF.\nFor invoking the ConvergedCharging service with quota management, the ConvergedCharging service will operate in decentralized unit determination with the provided amounts of the Quota Requested information element otherwise if no amount is included in the Quota Requested information element, the ConvergedCharging service will operate in centralized unit determination and rating.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.2\tCharging scenarios",
                            "text_content": "Converged charging for both events and sessions between CTF and the CHF is performed as defined in TS 32.240 [1].\nTwo basic scenarios are used:\n-\tConverged Event based charging;\n-\tConverged Session based charging.\nFor Converged Event based Charging, he following cases are supported:\n-\tImmediate Event Charging (IEC);\n-\tPost Event Charging (PEC).\nThe scenario for Event based charging supported by IEC is shown in figure 5.3.2.2.1 with: Decentralized and Centralized Unit Determination, Centralized Rating configurationand user's account balance deduction before service delivery, where the NF (CTF)\tmay invoke converged charging service towards the CHF, prior to service delivery if needed.\nThe figure depicts a simplified representation of an event-based charging system, with a focus on the centralization of unit determination and central rating. It illustrates the process of charging through a centralized system, where the central unit determines the unit and the central rating. This system is based on the IEC 61850 standard, which defines the event-based charging system. The figure also includes a centralized unit and a centralized rating, which are essential components of this system.\nFigure 5.3.2.2.1: IEC- Event based charging with  Decentralized and Centralized Unit Determination, Centralized Rating\n1)\tRequest for resource usage: A request for session establishment is received in the NF (CTF). The service is configured to be authorized by the CHF to start.\n2)\tUnits Determination: the NF (CTF) determines the number of units depending on the service requested by the UE in \"Decentralized Units determination\" scenario.\n3)\tCharging Data Request [Event, Units]: The NF (CTF) sends the request to the CHF for the service to be granted authorization, and to allow the number of units, if determined in item 2, to be rated and accounted.\n4)\tAccount, Rating Control: The CHF calculates the number of monetary units that represents the price and makes deduction of the calculated amount from user's account balance based on the number of units requested or on internal unit determination, if the user's credit balance is sufficient.\n5)\t Create CDR: based on policies, the CHF creates a CDR related to the service.\n6)\tCharging Data Response [Event, Units]: The CHF grants authorization to NF (CTF) for the service to start, with a number of granted units.\n7)\t Granted Units Supervision: The service starts and the NF (CTF) monitors the consumption of the granted units.\n8)\tContent/Service Delivery: the NF (CTF) delivers the content/service based on the number of units.\nThe scenario for Event based charging supported by PEC is described in figure 5.1.2.2.1.1.\nFor Converged Session based Charging, the following cases are supported:\n-\tSCUR\n-\tECUR\nFigure 5.3.2.3.1 shows a blocking mode scenario for Session based charging (SCUR) with: Unit Reservation, Decentralized and Centralized Unit Determination, Centralized Rating configuration, user’s account deduction, where the NF (CTF) invokes a converged charging service towards the CHF.\nThe figure depicts a session-based charging system with two units: a Decentralized Unit (DU) and a Centralized Unit (CU). The DU is responsible for session-based charging, while the CU is responsible for centralized rating. The system is designed to be decentralized and centralized, with the DU and CU working together to ensure a smooth charging process. The figure also includes a detailed explanation of the system's architecture, including the use of Session-Based Charging (SCUR) and Decentralized Unit Determination (DU-D).\nFigure 5.3.2.3.1: SCUR - Session based charging with Decentralized and Centralized Unit Determination, Centralized Rating\n1)\tRequest for service delivery: A request for session establishment is received in the NF (CTF). The service is configured to be authorized by the CHF to start.\n2)\tUnits Determination: the NF (CTF) determines the number of units depending on the service requested by the UE in \"Decentralized Units determination\" scenario.\n3)\tCharging Data Request [Initial, Quota Requested]: The NF (CTF) sends the request to the CHF for the service to be granted authorization to start, and to reserve the number of units if determined in item 2.\n4)\tAccount, Rating, Reservation Control: the CHF rates the requests either based on the number of units requested or on internal unit determination, checks if corresponding funds can be reserved on the user's account balance. If the account has sufficient funds, the CHF performs the corresponding reservations.\n5)\tOpen CDR: based on policies, the CHF opens a CDR related to the service.\n6)\tCharging Data Response [Initial, Quota Granted]: The CHF grants authorization to NF (CTF) for the service to start, with the reserved number of units.\n7)\tGranted Units Supervision: the NF (CTF) monitors the consumption of the granted units.\n8)\tStart of service delivery: the NF (CTF) starts to deliver the content/service based on the reserved number of units.\n9)\tUsage Reporting Trigger: the NF (CTF) generates charging data related to the service delivered that is not under quota management, based on a trigger for usage reporting is met.\n10)\tCharging Data Request [Update, Unit Used]: the NF (CTF) sends the request for reporting the related charging data, including the used units, to the CHF.\n11)\tAccount, Rating Control: The CHF performs the reported usage process involving rating entity and user's account balance.\n12)\t Update CDR: based on policies, the CHF updates the CDR with charging data related to the service.\n13)\tCharging Data Response [Update]: The CHF informs the NF (CTF) on the result of the request.\n14)\tQuota management Trigger: A Trigger associated to Quota management is met. Units determination is performed when applicable.\n15)\tCharging Data Request [Update, Unit Used, Quota Requested]: the NF (CTF) sends the request to the CHF, for more units to be granted for the service to continue, and reporting the used units.\n16)\tAccount, Rating, Reservation Control: The CHF performs the process related to the reported usage and the requested reservation, involving rating entity and user's account balance.\n17)\t Update CDR: based on policies, the CHF updates the CDR with charging data related to the service.\n18)\tCharging Data Response [Update, Quota Granted]: The CHF grants quota to NF (CTF) for the service to continue, with the reserved number of units.\n19)\tContent/Service Delivery: the NF (CTF) delivers the content/service based on the granted quota.\n20)\tSession released: the session is released.\n21)\tCharging Data Request [Termination, Unit Used]: the NF (CTF) sends the request to the CHF, for charging data related to the service termination with the final consumed units.\n22)\tAccount, Rating Control: The CHF performs the service termination process involving rating entity and user's account balance.\n23)\t Close CDR: based on policies, the CHF closes the CDR with charging data related to the service termination and the last reported units.\n24)\tCharging Data Response [Termination]: The CHF informs the NF (CTF) on the result of the request.\nFigure 5.3.2.3.2 shows a Non-blocking mode scenario for Session based charging (SCUR) with: Unit Reservation, Decentralized and Centralized Unit Determination, Centralized Rating configuration, user’s account deduction, where the NF (CTF) invokes a converged charging service towards the CHF.\nNF (CTF) may use blocking mode instead when risk of quota overdraft is more important than latency.\nThe figure depicts a session-based charging system with decentralized and centralized unit determination, central rating, and immediate start of service delivery. It is non-blocking mode, ensuring efficient service delivery.\nFigure 5.3.2.3.2: SCUR - Session based charging with Decentralized and Centralized Unit Determination, Centralized Rating, immediate start of service delivery (Non-blocking mode)\n1)\tRequest for service delivery and start of service delivery: A request for session establishment is received in the NF (CTF). The NF (CTF) is configured to allow the service to be delivered.\n2)\tUnits Determination: the NF (CTF) determines the number of units depending on the service requested, in \"Decentralized Units determination\" scenario.\n3)\tCharging Data Request [Initial, Unit Used, Quota Requested]: the NF (CTF) sends the request to the CHF to reserve the number of units if determined in step 2, it may also report the used units.\n4)\tAccount, Rating, Reservation Control: the CHF rates the requests either based on the number of units requested or on internal unit determination, checks if corresponding funds can be reserved on the user's account balance. If the account has sufficient funds, the CHF performs the corresponding reservation.\n5)\t Open CDR: based on policies, the CHF opens a CDR related to the service.\n6)\tCharging Data Response [Initial, Quota Granted]: the CHF grants the reserved number of units to NF (CTF).\n7)\tGranted Units Supervision: The NF (CTF) monitors the consumption of the granted units.\n8)\tService delivery ongoing: the NF (CTF) continues to deliver the service.\n9)\tUsage reporting trigger: the NF (CTF) generates charging data related to a service delivered that is not under quota management, based on that a trigger for service usage reporting is met.\n10)\t\tCharging Data Request [Update, Unit Used]: the NF (CTF) reports the charging data related to service delivered, including the used units, to the CHF.\n11)\t\tAccount, Rating Control: the CHF uses the reported charging data to rate the usage and deduct the funds corresponding to the usage on the account balance.\n12)\t\tUpdate CDR: based on policies, the CHF updates the CDR with charging data related to the service.\n13)\t\tCharging Data Response [Update]: The CHF informs the NF (CTF) on the result of the request.\n14\t)\tQuota management Trigger: A Trigger associated to Quota management is met. Units determination is performed when applicable.\n15)\t\tCharging Data Request [Update, Unit Used, Quota Requested]: the NF (CTF) sends the request to the CHF, for more units to be granted for the service to continue, and reporting the used units.\n16)\t\tAccount, Rating, Reservation Control: same as step 4, with the option to also deduct the funds corresponding to the usage on the account balance.\n17)\t\tUpdate CDR: based on policies, the CHF updates the CDR with charging data related to the service.\n18)\t\tCharging Data Response [Update, Quota Granted]: The CHF grants quota to NF (CTF) for the service, with the reserved number of units.\n19)\t\tService delivery ongoing: the NF (CTF) continues to deliver the service.\n20)\t\tService release: the NF (CTF) is requested to end the service delivery and does this.\n21)\t\tCharging Data Request [Termination, Unit Used]: the NF (CTF) sends the request to the CHF, for charging data related to the service termination with the final consumed units.\n22)\t\tAccount, Rating Control: the CHF performs the service termination process which involve using the reported charging data to rate the usage and deduct the funds corresponding to the usage on the account balance.\n23)\tClose CDR: based on policies, the CHF closes the CDR with charging data related to the service termination and the last reported units.\n24)\t\tCharging Data Response [Termination]: The CHF informs the NF (CTF)on the result of the request.\nFigure 5.3.2.3.3 shows a scenario for Session based charging (ECUR) in Decentralized and Centralized Unit Determination, Centralized Rating configuration, where the NF (CTF) invokes a converged charging service towards the CHF, prior to service delivery if needed.\n\nThe figure depicts a session-based charging system with decentralized and centralized unit determination, central rating, and a centralized unit determination system.\nFigure 5.3.2.3.3: ECUR - Session based charging with - Decentralized and Centralized Unit Determination, Centralized Rating.\n\n1)\tRequest for resource usage: A request for session establishment is received in the NF (CTF). The service is configured to be authorized by the CHF to start.\n2)\tUnits Determination: the NF (CTF) determines the number of units depending on the service requested by the UE in \"Decentralized Units determination\" scenario.\n3)\tCharging Data Request [Initial, Quota Requested]: The NF (CTF) sends the request to the CHF for the service to be granted authorization to start, and to reserve the number of units if determined in item 2.\n4)\tAccount, Rating, Reservation Control: the CHF rates the requests either based on the number of units requested or on internal unit determination, checks if corresponding funds can be reserved on the user's account balance. If the account has sufficient funds, the CHF performs the corresponding reservation.\n5)\t Open CDR: based on policies, the CHF opens a CDR related to the service.\n6)\tCharging Data Response [Initial, Quota Granted]: The CHF grants authorization to NF (CTF) for the service to start, with the reserved number of units.\n7)\t Granted Units Supervision: The service starts and the NF (CTF) monitors the consumption of the granted units.\n8)\tContent/Service Delivery: the NF (CTF) delivers the content/service based on the reserved number of units.\n9)\tCharging Data Request [Termination, Unit Used]: the NF (CTF) sends the request to the CHF, for charging data related to the delivered service with the consumed units.\n10)\t\tAccount, Rating Control: The CHF performs the process for the delivered service involving rating entity and user's account balance.\n11)\t\tClose CDR: based on policies, the CHF closes the CDR with charging data related to the delivered service.\n12)\t\tCharging Data Response [Termination]: The CHF informs the NF (CTF) on the result of the request.\n\n5.3.2.4\tCharging notification\nThe CHF can provide notifications to the NF (CTF), the NF (CTF) implicitly subscribes to these when it sends a Charging Data Request [Initial], i.e. there is no separate subscription request from the NF for notification.\nFigure 5.3.2.4-1 shows a scenario for Session based charging with a notification from the CHF triggering a Charging Data Request [Update].\nThe figure depicts a session-based charging system, where a user is notified of a re-authorization request and is required to re-authenticate before continuing with the charging process.\nFigure 5.3.2.x.1: Session based charging – Notification with Re-authorization\n1)\tSession based charging ongoing: there is a session based charging ongoing and there have at least been a Charging Data Request [Initial] sent from the NF (CTF) to the CHF, and the CHF have opened a CDR.\n2)\tEvent triggering notification: an event is detected in the CHF that requires a notification to be sent to the NF (CTF). In this scenario a request for triggering a Charging Data Request [Update, Quota Requested ] is sent, but also requests for Charging Data Request [Update] (without request for quota) is possible.\n3)\tCharging Notify Request [Re-authorization]: the CHF sends the request to the NF (CTF), for a triggering of a Charging Data Request [Update, Quota Requested] i.e. Re-authorization.\n4)\tCharging Notify Response: the NF (CTF) acknowledges the request by sending a response.\n5)\tCharging Data Request [Update, Quota Requested]: the NF (CTF) sends the request to the CHF, to be granted with more unit for the service to continue, and also for reporting the used units.\n6)\tAccount, Rating, Reservation Control: the CHF performs the process related to the reported usage and the requested reservation, involving rating entity and user's account balance.\n7)\t Update CDR: based on policies, the CHF updates the CDR with charging data related to the service.\n8)\tCharging Data Response [Update, Quota Granted]: the CHF grants quota to NF (CTF) for the service to continue, with the reserved number of units.\nFigure 5.3.2.4.2 shows a scenario for Session based charging with a notification from the CHF triggering a Charging Data Request [Termination].\nFigure 5.3.2. 4 : Session based charging – Notification with termination\n\nThis figure illustrates the process of session-based charging in a mobile network, where a user initiates a session and the network notifies the user when the session is terminated. The figure shows the steps involved in the session, including the initiation of the session, the notification of the termination, and the user's response. The figure is important for understanding the session-based charging process in mobile networks and its impact on user experience.\nFigure 5.3.2.4.2: Session based charging – Notification with termination\n1)\tSession based charging ongoing: there is a session based charging ongoing and there have at least been a Charging Data Request [Initial] sent from the NF (CTF) to the CHF, and the CHF have opened a CDR.\n2)\tEvent triggering notification: an event is detected in the CHF that requires a notification to be sent to the NF (CTF). In this scenario a request for triggering a Charging Data Request [Termination] is sent.\n3)\tCharging Notify Request [Termination]: the CHF sends the request to the NF (CTF), for a triggering of a Charging Data Request [Termination] i.e. the termination of the charging session.\n4)\tCharging Notify Response: the NF (CTF) acknowledges the request by sending a response.\n5)\tCharging Data Request [Termination]: the NF (CTF) sends the request to the CHF, for charging data related to the service termination with the final consumed units.\n6)\tAccount, Rating Control: the CHF performs the process related to the reported usage, involving rating entity and user's account balance.\n7)\tClose CDR: based on policies, the CHF closes the CDR with charging data related to the service.\n8)\tCharging Data Response [Termination]: The CHF informs the NF (CTF) on the result of the request.\nWhen converged charging is used for a service delivery it is possible to in online charging to switch from quota management to quota management suspended, and in some cases back again.\nFigure 5.3.2.5.1 shows a scenario for Session based charging (SCUR) with a suspension of quota management and resume of quota management.\n\"Figure 5.3.2 illustrates the SCUR (Session-based Charging with Suspend and Resume of Quota Management) feature in a 5G network, demonstrating how it enables session-based charging and quota management. The figure shows the charging process, including the session initiation, session management, and session termination. The SCUR feature is designed to improve network efficiency and reduce latency.\"\nFigure 5.3.2.5.1: SCUR - Session based charging with suspend and resume of quota management.\n1)\tRequest for resource usage: A request for session establishment is received in the NF (CTF). The service is configured to be authorized by the CHF to start.\n2)\tUnits Determination: the NF (CTF)) determines the number of units depending on the service requested by the UE in \"Decentralized Units determination\" scenario.\n3)\tCharging Data Request [Initial, Quota Requested]: The NF (CTF) sends the request to the CHF for the service to be granted authorization to start, and to reserve the number of units if determined in item 2.\n4)\tAccount, Rating, Reservation Control: the CHF rates the requests and checks need for quota management. If not needed for the service at the moment a switch from online to offline type of charging is to be performed.\n5)\t Open CDR: based on policies, the CHF opens a CDR related to the service.\n6)\tCharging Data Response [Initial, Result Code]: The CHF grants authorization to NF (CTF) for the service to start, with a result code indicating that quota management is suspended.\n7)\tContent/Service Delivery: the NF (CTF) delivers the content/service without quota management.\n8)\tUsage Reporting Trigger: the NF (CTF) generates charging data related to the service delivered that is not under quota management, based on a trigger for usage reporting is met.\n9)\tCharging Data Request [Update, Unit Used, Quota Requested]: the NF (CTF) sends the request to the CHF, for units to be granted making it possible to resume the quota management. It also reports the used units with an indication that these were used with quota management suspended.\n10)\t\tAccount, Rating, Reservation Control: The CHF performs the process related to the reported usage and checks if quota management should continue to be suspended or should be resumed. If needed for the service, CHF checks if corresponding funds can be reserved on the user's account balance.\n11)\t\tUpdate CDR: based on policies, the CHF updates the CDR with charging data related to the service.\n12)\t\tCharging Data Response [Update, Quota Granted]: The CHF grants quota to NF (CTF) for the service to continue and with this indicating that quota management is to be resumed, with the reserved number of units.\n13)\t\tContent/Service Delivery: the NF (CTF) delivers the content/service based on the granted quota.\n14)\t\tSession released: the session is released.\n15)\t\tCharging Data Request [Termination]: the NF (CTF) sends the request to the CHF, for charging data related to the service termination with the final consumed units.\n16)\t\tAccount, Rating Control: The CHF performs the service termination process involving rating entity and user's account balance.\n17)\tClose CDR: based on policies, the CHF closes the CDR with charging data related to the service termination and the last reported units.\n18)\t\tCharging Data Response [Termination]: The CHF informs the NF (CTF) on the result of the request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.4\tOther functionalities",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.4.1\tRe-authorization",
                            "text_content": "The CHF (NF Service Producer) may trigger a re-authorization request and the NF Service Consumer shall report quota usage. The reason for the quota being reported shall be notified to the CHF (NF Service Producer). This is described under charging notification procedure in clause 5.3.2.4.\nThe NF Service Consumer may receive a Charging Notify Request while waiting for a Charging Data Response from the CHF. In this case the NF Service Consumer shall not send a new Charging Data Request.\nThe NF Service Consumer may receive a Charging Notify Request while not waiting for any Charging Data Response from the CHF. In this case the NF Service Consumer shall send a new Charging Data Request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.2\tThreshold based re-authorization triggers",
                            "text_content": "The CHF (NF Service Producer) may optionally include an indication to the NF Service Consumer of the remaining quota threshold that shall trigger a quota re-authorization.\nIf received quota threshold based re-authorization triggers (i.e. timeQuotaThreshold, volumeQuotaThreshold, unitQuotaThreshold), the NF Service Consumer shall seek re-authorization for the quota when the quota contents fall below the supplied threshold. The NF Service Consumer allows the service to continue whilst the re-authorization is progress, until the remaining part had been used up.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.3\tTermination action",
                            "text_content": "The CHF (NF Service Producer) may use the Final Unit Indication to indicate specify to the NF Service Consumer the behaviour on consumption of the final granted units, or zero units granted in the first place; this is known as termination action.\nThe NF Service Consumer should perform the action indicated in the Final Unit Indication, which may be to terminate, redirect or to restrict access, when any final granted units have been used. If the granted units contain no units it means that the action should be performed immediately.\nIf the action is terminate, then the NF Consumer may terminate all the services belonging to the rating group.\nIf the action is redirect, then the NF Consumer may redirect all access to the services belonging to the rating group to the destination indicated, if filter rules are provided it may also restrict the access towards the new destination.\nIf the action is restrict access, then the NF Consumer may restrict access to the services belonging to the rating group based on filter rules.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.4\tService termination",
                            "text_content": "The CHF (NF Service Producer) may determine that a service requires termination. The NF Service Producer may perform this termination synchronously if it has a request pending processing by returning response.\nIf the CHF (NF Service Producer) does not have a pending request (asynchronous), the NF Service Producer may trigger an abort notification to terminate the charging session. On reception of an abort notification, the NF consumer shall terminate the associated charging session by sending a Nchf_ConvergedCharging_Release. If the associated charging session is not currently active or NF consumer does not terminate the charging session for any other reason, the corresponding error response is returned.\nThe CTF (NF Service Consumer) may determine service termination. For session based charging the termination request shall include the used units if any. For event based charging there may be no used unit reported.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.5\tTrigger Mechanism",
                            "text_content": "There are a number of mid-session service events, defined as triggers, which could affect the rating of the current service usage, e.g. QoS changes or end user location updates. The details for this these triggers are defined in the service specific document (middle tier TS). The relationship between service session and charging session is 1:1.\nThere are two levels of triggers: service session and rating group. The service session level triggers are applicable for all rating groups within a charging session, whereas a rating group level trigger is only applicable to that rating group. Any limit or threshold set on the service session level is the total limit for the service session including all the rating groups. The behaviour at trigger detection is specified by the middle tier TS.\nTriggers enabled or disabled by default by the NF consumer, may be enabled or disabled by CHF in response to the NF consumer.\nThe CHF may enable one or more triggers at the NF consumer, by including them in the Triggers element. Each Triggers element can only contain one trigger of each type. The omitted triggers in the Triggers element shall be interpreted by the NF consumer as disabled. The enabled and disabled triggers setting at the NF consumer shall remain in effect until another Triggers element is received from the CHF for the service session or rating group. When the NF consumer receives a Triggers element it shall enable all triggers present in the Triggers element and disable all other triggers at the same level. The presence of the Triggers element without any trigger type in a response message allows CHF to disable all the triggers at the NF Consumer for service session or rating group.\nNOTE:\tThis removes the need for the CHF to send trigger information in every response message when they have not changed.\nTwo categories of chargeable events are identified:\n-\timmediate report: chargeable events for which, when occurring, the current counts are closed and sent together with the charging data generated by the NF consumer towards the CHF in a Charging Data Request message. Counts indicating zero usage may be reported. New counts are started by the NF consumer.\n-\tdeferred report: chargeable events for which, when occurring, the current counts are closed and stored together with the charging data generated by the NF consumer. Counts indicating zero usage may be included. The stored counts will be sent to the CHF in next a Charging Data Request message. New counts are started by the NF consumer.\nCHF may change the category of one or more triggers by using the Triggers element containing category information in the response message.\nFor the rating group: the rating group level triggers and category take precedence over the service session level triggers and category.\nIf there is a request for quota management outstanding for a rating group i.e., the request has not been responded to, any new request for quota management for the same rating group should be postponed until after the response has been received.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.6\tCHF-controlled quota management",
                            "text_content": "CHF can instruct NF consumer (CTF) to suspend quota management for a given Rating Group and then subsequently the CHF can instruct the NF consumer (CTF) to resume quota management for the given Rating Group with suspended quota management within the charging session.\nUpon receiving Charging Data Request [Initial/Update] with usage reporting for a set of rating groups, the CHF may suspend quota management for particular rating groups, by including in Charging Data Response messages for these particular rating groups:\n- explicit setting of without quota management or\n- granted quotas with appropriate content to ensure the service to continue without further quota management related updates.\nCHF may instruct NF consumer (CTF) to resume quota management for a given rating group for which quota management was previously suspended:\n- by using Re-authorization procedure or\n- by granting quotas in the response to any Charging Data Request [Update] generated in situation quota management triggers are not used, by other existing active triggers of the NF consumer (CTF).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.7\tCharging identifier",
                            "text_content": "The charging identifier is assigned by the NF consumer, making it possible to correlate the charging information from different events or sessions. The assignment is NF consumer dependent. The charging identifier may also be used for duplicate detection see clause 5.5.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.8\tQuota management",
                            "text_content": "The quota can be consumed in the network e.g., seconds, bytes. The Quota Management applies for converged online charging per rating group, including requested quota, granted quota and used units.\n-\tNF consumer shall request quota via charging data request.\n-\tThe CHF as NF producer may either grant or deny the request for quota via charging data response.\n-\tNF consumer shall report the used units as the the consumed quota via charging data request.\nFor the communication between consumer CHF and producer CHF, converged charging is supported.\nUpon receiving Charging Data Request [Initial/Update] from the NF Consumer (CTF) with quota management, consumer CHF may:\n-\tsend the Charging Data Request [Initial/Update] to producer CHF with or without the amount of quota, dependent on NF consumer requested, or\n-\tsend the Charging Data Request [Initial/Update] to producer CHF with the amount of quota larger than the amout from NF Consumer (CTF), or\n-\tallocate the quota based on previous granted quota from the producer CHF, dependent on whether the consumer CHF has available quota.\nWhen receiving Charging Data Response [Initial/Update] with granted quota from producer CHF, consumer CHF may send the quota to NF Consumer (CTF) with the same amount or less as granted by producer CHF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.5\tError handling",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.5.1\tFailure handling",
                            "text_content": "The failure handling determines what to do if the sending of charging data request to the CHF without response in a period of time (request times out).\nIn the case of the NF consumer (CTF) towards CHF request times out, NF consumer (CTF) uses application level failure handling (Terminate, Continue, Retry_and_terminate). Failure handling may be received from the CHF previously or may be locally configured. The value received from the CHF in the charging data response will always override any already existing value.  Failover handling indication informs NF Consumer whether alternative CHF is supported.\nThe CTF may store and re-send Charging Data Request(s) if it fails to reach CHF.\nIn case there is an application level error response from the CHF, NF consumer (CTF)  action will depend on the type of Application Error.\nFor protocol level errors, refer to applicable protocol failure handling mechanisms as described in 32.291 [58].\nThe CHF closes a CDR and all the reserved resources are freed for the charging session when it detects that expected charging data request for a particular session have not been received for a period of time. The charging session may be kept or released based on local configuration.\nA Charging Data Request [Initial] received by a CHF, which can be associated to an existing charging session (i.e. , resource in CHF), should be handled as a valid request, with Charging Data Response including the charging session id (i.e. resource id). If there are errors during the handling, corresponding error code is returned.\nA Charging Data Request [Update] received by a CHF, which cannot be associated to any existing charging session (i.e. , resource in CHF), should be handled as a valid request with the associated resource creation, quota usage handling and optional CDR creation. If there are errors during the handling, corresponding error code is returned.\nA Charging Data Request [Termination] received by a CHF, which cannot be associated to any existing charging session (i.e. , resource in CHF), should be handled as a valid request with associated new resource creation and release, and optional corresponding CDR creation and closure. If there are errors during the handling, corresponding error code is returned.\nThe Invocation Sequence Number in Charging Data Request [Initial] with value different from 0 or 1 is faulty and shall be rejected by CHF.\nWhen a Charging Data Request [Initial/Update/Termination] received by the consumer CHF for inter CHFs communication, in the case of the consumer CHF towards producer CHF request times out and without alternative producer CHF, consumer CHF uses application level failure handling, i.e. terminate, continue, retry_and_terminate, which may be received from the producer CHF previously or may be based on operator agreement.\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.2\tRetry handling",
                            "text_content": "In case a NF consumer (CTF) does not receive a Charging Data Response, it may retransmit the Charging Data Request message. The number of retries and delay between retries shall be locally configured in the NF consumer (CTF).\nIf the retried charging data request [Initial] is received by the same CHF, the uniqueness checking may be based on the Charging Identifier included in the charging data request. CHF shall respond to the retried charging data request [Initial] with the original charging session identifier.\nIf the retried request is charging data request [Update] or charging data request [Termination], the uniqueness checking may based on the inspection of the Charging Session Identifier and Invocation Sequence Number pair.\nIf retried message shall have the same Invocation Sequence Number as the original of the retried message i.e. the Invocation Sequence Number shall not be incremented when the message is retried. The NF consumer (CTF) may send the retried message to an alternative CHF if the Session Failover indication is received from the CHF. The alternative CHF can be built as defined in clause 5.23.1 of 3GPP TS 23.501 [201].\nIn the case of a notification request time out the CHF may retry the message. The number of retries and delay between retries shall be locally configured in the CHF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.3\tResponse code handling",
                            "text_content": "The Charging Data Response includes a response code (i.e. Invocation Result Code in Invocation Result) which may indicate an error. The response codes supported by Nchf_ConvergedCharging service operations are specified 3GPP TS 32.291 [58].\nA NF Consumer (CTF) receiving a Charging Data Response [Initial] with a response code indicating the Charging Data Request [Initial] was unsuccessfully processed, shall perform the error handling applicable to the response code and may send a Charging Data Request [Termination] to the CHF.\nA NF Consumer (CTF) receiving a Charging Data Response [Termination] with a response code indicating the Charging Data Request [Termination] was unsuccessfully processed, shall perform the error handling applicable to the response code.\n\nA NF Consumer (CTF) receiving a Charging Data Response [Update] with a response code indicating the Charging Data Request [Update] was unsuccessfully processed, shall perform the error handling applicable to the response code and may send a Charging Data Request [Termination] to the CHF.\nThe Charging Data Response may also include multiple \"Multiple Unit Information\" Information Elements, each one indicated with a Result code (i.e. applicable at Rating group level). The Result code values supported by Nchf_ConvergedCharging service operations are specified 3GPP TS 32.291 [58]. Any Invocation Result Code value different than success takes precedence over the set of \"Multiple Unit Information\" Result Codes.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tService definition",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.1\tNF service framework",
                    "description": "",
                    "summary": "",
                    "text_content": "5G Charging Function supports to interact with NRF, as specified in clause 7.1 of TS 23.501 [201] and clauses 4.17 and 5.2.7 of TS 23.502 [202] to enable following functionalities:\n-\tCHF instance(s) registration, CHF service(s) instance(s) registration in a CHF instance.\n-\tCHF instance(s) update, CHF service(s) instance(s) update in a CHF instance.\n-\tCHF instance(s) deregistration.\n-\tCHF instance(s) and CHF service(s) instance(s) discovery by CHF service consumer.\nThe services specified in clause 7.2.6 TS 23.501 [201] may be used and the interaction is described in TS 29.510 [300]:\n-\tNnrf_NFManagement.\n-\tNnrf_NFDiscovery.\n-\tNnrf_AccessToken.\nThe Nnrf_NFManagement_NFRegister service invoked by CHF for CHF instance(s) and CHF service(s) instance(s) registration described in the TS 29.510 [300] may include in particular:\n-\tRange(s) of SUPIs.\n-\tRange(s) of GPSIs.\n-\tRange(s) of PLMNs.\n-\tCHF Group ID.\n-\tCHF set ID.\n-\tCHF service set ID.\nThese parameters may also be used by CHF service consumer(s) invoking the Nnrf_NFDiscovery service for the CHF instance(s) and CHF service(s) instance(s) discovery.\nA CHF instance is either a part of:\n-\ta primary CHF instance and secondary CHF instance pair, or\n-\ta CHF set.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.2\tNchf_ConvergedCharging service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tGeneral",
                            "text_content": "Service description: The ConvergedCharging service provides charging for session and event based NF services. This ConvergedCharging service offers charging:\n-\tWith quota management (online; this includes support for both blocking mode and non-blocking mode)\n-\tWithout quota management (offline)\n-\tCharging information record generation\nThe following table shows the CHF Services and CHF Service Operations.\nTable 6.2.1-1: NF services provided by the CHF\n\nThe applicability of ConvergedCharging service to:\n-\tSMF, MB-SMF and SMF+PGW-C as consumer is specified in TS 32.255 [30] for 5G data connectivity domain charging;\n-\tIMS-Node as consumer is specified in TS 32.260 [31] for IMS charging;\n-\tNEF as consumer is specified in TS 32.254 [32] for exposure function Northbound Application Program Interfaces charging;\n-\tAMF as consumer is specified in the TS 32.256 [33] for 5G connection and mobility domain charging;\n-\tSMSF as consumer is specified in TS 32.274 [34] for short message service charging;\n-\tCEF as consumer is specified in the TS 28.201 [35] and TS 28.202[36] for Network slice charging and edge computing charging;\n-\tMnS Producer as consumer is specified in the TS 28.201 [35] and TS 28.202 [36] for Network slice charging.\n-\tMMS-Node as consumer is specified in TS 32.270 [37] for multimedia messaging service charging.\n-\tEES as consumer is specified in the TS 32.257 [38] for edge computing charging.\n-\tCHF as consumer is specified in TS 32.255 [30] for LBO roaming 5G data connectivity domain charging and the TS 32.256 [33] for roaming 5G connection and mobility domain charging.\nThe input and output parameters described in the clauses below are common to all NF Consumers. The usage of these common parameters and additional NF Consumer specific parameters are specified in dedicated charging specifications.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.2.1-1: NF services provided by the CHF",
                                    "table number": 2,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.2.2\tNchf_ConvergedCharging_Create service operation",
                            "text_content": "Service operation name: Nchf_ConvergedCharging_Create\nDescription: Provides charging capabilities before service delivery, offers charging with and without quota management, as well as charging information record generation. It is used for both session and event based charging. Provides means for the NF Consumer to create the resource of the charging session. If it is used for session based charging the operation also makes an implicit subscribe to notification of events in CHF that requires re-authorization or abort.\nThe service operation may be used to request quota authorisation for service delivery and may open a CDR in the CHF, based on the information provided by the NF Consumer.\nKnown NF Consumers: SMF, SMSF, AMF, IMS-Node, MMS-Node, SMF+PGW-C, NEF, CEF, MnS Producer, EES, MB-SMF, CHF.\nInputs, Required: Subscriber identifier, either service identification or rating group.\nInputs, Optional: Requested service units, one-time event, destination address, provider, location information, time and date.\nOutputs, Required: Result indication.\nOutputs, Optional: Granted service units, validity time, triggers.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tNchf_ConvergedCharging_Update service operation",
                            "text_content": "Service operation name: Nchf_ConvergedCharging_Update\nDescription: Provides charging capabilities during service delivery, offers usage reporting and quota management, as well as charging information record generation.\nThe service operation is used to report usage and may request further quota authorisation, if the trigger conditions occurs, this operation may cause update of the CDR or production of an interim CDR in the CHF.\nKnown NF Consumers: SMF, IMS-Node, SMF+PGW-C, MB-SMF, CHF.\nInputs, Required: Subscriber identifier (Optional for emergency session), session identifier, reporting reason.\nInputs, Optional: Requested service units, used service units.\nOutputs, Required: Result indication.\nOutputs, Optional: Granted service units, validity time, triggers.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.4\tNchf_ConvergedCharging_Release service operation",
                            "text_content": "Service operation name: Nchf_ConvergedCharging_Release\nDescription: Provides charging capabilities after service delivery, offers usage reporting and charging information record generation. Provides means for the NF Consumer to release the resource of charging session information.\nThe charging delete request is used to report usage and close the CDR in the CHF if it has been opened.\nKnown NF Consumers: SMF, AMF, IMS-Node, MMS-Node, SMF+PGW-C, SMSF, NEF, MB-SMF, CHF.\nInputs, Required: Subscriber identifier, session identifier, release reason.\nInputs, Optional: Used service units.\nOutputs, Required: Result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.5\tNchf_ConvergedCharging_Notify service operation",
                            "text_content": "Service operation name: Nchf_ConvergedCharging_Notify\nDescription: Provides notification to NF consumers.\nCHF provides the re-authorization type notificationthat would lead NF consumers to send an Nchf_ConvergedCharging_Update reporting the current usage.\nCHF provides the abort type notification that would lead NF consumers to send an Nchf_ConvergedCharging_ Release to terminate the charging session.\nKnown NF Consumers: SMF, IMS-Node, SMF+PGW-C, CHF.\nInputs, Required: Subscriber identifier, notification type (re-authorization or abort).\nInputs, Optional: rating group, service id.\nOutputs, Required: Result indication.\nOutputs, Optional: None\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tNchf_SpendingLimitControl service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tOverview",
                            "text_content": "The \"Nchf_SpendingLimitControl\" service is defined in 23.502 [202] clause 5.2.17.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tVoid",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.5\tNchf_OfflineOnlyCharging service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tGeneral",
                            "text_content": "Service description: The OfflineOnlyCharging service provides charging for session based NF services. This OfflineCharging service offers charging information record generation.\nThe following table shows the CHF Services and CHF Service Operations.\nTable 6.5.1-1: NF services provided by the CHF\n\nThe applicability of OfflineOnlyCharging service to SMF as NF consumer is specified in TS 32.255 [30] for 5G data connectivity domain charging. The applicability of OfflineOnlyCharging service to IMS-Node as NF consumer is specified in TS 32.260 [31] for IMS charging.\nThe input and output parameters described in the clauses below are common to all NF Consumers. The usage of these common parameters and additional NF Consumer specific parameters are specified in dedicated charging specifications.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.5.1-1: NF services provided by the CHF",
                                    "table number": 3,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.5.2\tNchf_OfflineOnlyCharging_Create service operation",
                            "text_content": "Service operation name: Nchf_OfflineOnlyCharging_Create\nDescription: Provides charging capabilities before service delivery, offers charging information record generation. Provides means for the NF Consumer to create the resource of the charging session.\nThe service operation shall open a CDR in the CHF, based on the information provided by the NF Consumer.\nKnown NF Consumers: SMF, IMS-Node.\nInputs, Required: Subscriber identifier, either service identification or rating group.\nInputs, Optional: destination address, provider, location information, time and date.\nOutputs, Required: Result indication.\nOutputs, Optional: triggers.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tNchf_OfflineOnlyCharging_Update service operation",
                            "text_content": "Service operation name: Nchf_OfflineOnlyCharging_Update\nDescription: Provides charging capabilities during service delivery, charging information record generation.\nIf the trigger conditions occurs, this operation may cause update of the CDR or production of an interim CDR in the CHF.\nKnown NF Consumers: SMF.\nInputs, Required: Subscriber identifier (exception for emergency session), session identifier, reporting reason.\nInputs, Optional: None.\nOutputs, Required: Result indication.\nOutputs, Optional: triggers.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.4\tNchf_OfflineOnlyCharging_Release service operation",
                            "text_content": "Service operation name: Nchf_OfflineOnlyCharging_Release\nDescription: Provides charging capabilities after service delivery, charging information record generation. Provides means for the NF Consumer to release the resource of charging session information.\nThe charging delete request is used to close the CDR in the CHF if it has been opened.\nKnown NF Consumers: SMF, IMS-Node.\nInputs, Required: Subscriber identifier, session identifier, release reason.\nInputs, Optional: None.\nOutputs, Required: Result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tMessage contents",
            "description": "Converged charging or offline only charging is performed by NF (CTF) consuming service operations exposed by CHF, achieved using Charging Data Request and Charging Data Response.\nThe information structure used for these services operations is composed of two parts:\n-\tCommon structures specified in the present document.\n-\tNF (CTF) consumer specific structures specified in the middle tier TSs.\nTable 7.1 describes the data structure which is common to operations in request semantics.\n\nTable 7.1: Common Data structure of Charging Data Request\n\n\nTable 7.2 describes the data structure which is common to operations in response semantics.\nTable 7.2: Common Data structure of Charging Data Response\n\nThe CTF NF consumer specific structures which are specified in the middle tier TSs, are defined as extensions of:\n-\tcommon part structure of Charging Data Request and Charging Data Response.\n-\tstructure of Multiple Unit Usage.\n-\tstructure of Multiple Unit Information.\nTable 7.3 describes the data structure which is common to Charging Notify Request.\nTable 7.3: Common Data structure of Charging Notify Request\n\nTable 7.4 describes the data structure which is common to Charging Notify Response.\nTable 7.4: Common Data structure of Charging Notify Response\n\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "Table 7.1: Common Data structure of Charging Data Request",
                    "table number": 4,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "Table 7.2: Common Data structure of Charging Data Response",
                    "table number": 5,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "Table 7.3: Common Data structure of Charging Notify Request",
                    "table number": 6,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "Table 7.4: Common Data structure of Charging Notify Response",
                    "table number": 7,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "",
                    "table number": 8,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        }
    ]
}