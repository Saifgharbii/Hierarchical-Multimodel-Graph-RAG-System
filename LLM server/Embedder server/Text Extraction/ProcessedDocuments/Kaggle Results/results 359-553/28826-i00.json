{
    "document_name": "28826-i00.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Report has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\t\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\t\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\t\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\t\tindicates that something is possible\ncannot\t\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\t\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\t\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "Introduction",
            "description": "This report is to study enhancement of the Nchf converged charging service.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document studies the potential use cases, requirements, and solutions for the enhancements of the Nchf converge charging service.\nThe study will cover and identify gaps for:\n-\toptimizations regarding amount of information in the request and number of requests;\n-\tenhancement of input to rating;\n- \tcancelling of chargeable events for unsuccessful scenarios;\n- \tenhancement of non-blocking mechanism;\n-\tenhancements of triggers having more consistent triggers and use of NF specific triggers.\nImprovements on how to maintain the source code presentations (yaml and ASN.1) the document structure for these will be studied,\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2] \t3GPP TS 32.255: \"5G data connectivity domain charging; stage 2\".\n[3]\t3GPP TS 23.503: \"Policy and charging control framework for the 5G System (5GS); Stage 2\".\n[4]\t3GPP TS 29.500: \"5G System; Technical Realization of Service Based Architecture; Stage 3\".\n[5]\t3GPP TS 32.240: \"Telecommunication management; Charging management; Charging architecture and principles\".\n[6]\t3GPP TS 32.291: \"Telecommunication management; Charging management; 5G system; Charging service, stage 3\".\n[7]\t3GPP TS 32.298: \"Telecommunication management; Charging management; Charging Data Record (CDR) parameter description\".\n[8]\t3GPP TS 32.299: \"Telecommunication management; Charging management; Diameter charging application\".\n[9]\t3GPP TS 23.501: \"3GPP TS 23.501:\"System Architecture for the 5G System\".\n[10]\t3GPP TS 23.203: \"Policy and charging control architecture\".\n[11]\t3GPP TS 29.594: \"5G System; Spending Limit Control Service; Stage 3\".\n[12]\t3GPP TS 32.290: \"Telecommunication management; Charging management; 5G system; Services, operations and procedures of charging using Service Based Interface (SBI)\".\n[13]\tIETF RFC 4006 (2005): \"Diameter Credit-Control Application\".\n[14]\tIETF RFC 8506 (2019): \"Diameter Credit-Control Application\".\n[15]\t3GPP TS 29.513: \"5G System; Policy and Charging Control signalling flows and QoS parameter mapping; Stage 3\".\n[16]\t3GPP TS 29.594: \"5G System; Spending Limit Control Service; Stage 3\".\n[17]\t3GPP TS 32.254: \"Telecommunication management; Charging management; Exposure function Northbound Application Program Interfaces (APIs) charging\".\n[18]\t3GPP TS 32.256: \"Telecommunication management; Charging management; 5G Data connectivity domain charging; stage 2\".\n[19]\t3GPP TS 29.244: \"Technical Specification Group Core Network and Terminals; Interface between the Control Plane and the User Plane Nodes; Stage 3”.\n[20]\t3GPP TS 29.591: “5G System; Network Exposure Function Southbound Services; Stage 3”.\n[21]\t3GPP TS 29.541: “5G System; Network Exposure (NE) function services for Non-IP Data Delivery (NIDD) and Short Message Services (SMS); Stage 3”.\n[22]\t3GPP TS 29.542: “5G System; Session management services for Non-IP Data Delivery (NIDD); Stage 3\".\n[23]\t3GPP TS 38.300: “NR; NR and NG-RAN Overall description; Stage-2\".\n[24]\t3GPP TS 32.251: \"Telecommunication management; Charging management; Packet Switched (PS) domain charging\".\n\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in TR 21.905 [1].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tSymbols",
                    "description": "",
                    "summary": "",
                    "text_content": "Void.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.3\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in 3GP  TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905 [1].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tOverview",
            "description": "The Nchf converged charging services was first released in Rel-15. This first iteration was to a large extent, with some minor exceptions, copying and combining its predecessors, Ro and Rf, based on Diameter to a service based interface (SBI) supporting converged charging service. The depiction of the internal architecture of the Converged Charging System (CCS) was to a large extent based on the Online Charging System (OCS).\nThe combination of the Diameter Ro and Rf interfaces into one converged charging service together with the move of the integration point for CDRs have led to that all the information previously reported and transported over two or more interfaces now needs to be transported over a single interface. This makes it essential that the converged charging interface is optimized in regard to the amount of information and number of reports sent, or at least allows for such an optimization if needed.\nThe information that may be used to assist the determine of reservation in the CCS is not defined except for the rating group. This means that for an immediate event or in an initial request the information about the event or session is limited and lacks accuracy.\nLow latency requirements increased by new business cases may need enhancements to the non-blocking mechanism.\nCharging of new service together with converged charging have increased the need for more information in the input to rating.\nThe use of event-based charging has led to a need for cancelling the charging for the chargeable event, e.g. refund, for unsuccessful scenarios or cases not possible to fulfil.\nThe document structure of the actual service, i.e. yaml, followed the handling of Ro and Rf, based on Diameter, which may need improvements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "5\tCharging scenarios and key issues",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tCharging information optimization",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.1.1\tGeneral",
                            "text_content": "When there is no 5G data connectivity usage, which may be quite frequent in the case of always connected, when a trigger is active and the event occurs, sending a lot of information might be unnecessary. For online the need of getting the trigger even if there is no usage depends on if it requires rating and may impact the granted quota. For the offline it will depend on the use case if the trigger event is needs to be reported in the case of no usage.\nThe size of a request is only limited by the maximum size of the request in TS 29.500 [4] and controlled by the NF consumer. The CHF may reject the request if the request is over that limit. There is no other way for the CHF to control the size of the message other than controlling or limit the number of charging conditions changes before reporting, this will not state the size or take compression into consideration.\nThe CDR specification TS 32.298 [7] and the Nchf specification in TS 32.291 [6] may not always be updated to support the same information, this especially applies to attributes that is inherited from other specifications in TS 32.291 [6]. If the attribute or attribute value isn’t supported by the CDR and it is optional the attribute will be discarded. This would mean that even if it is supported in a later stage of the TS 32.298 [7], the value cannot be restored.\nThe reported charging information accuracy directly impact on the charging accuracy in the CHF. The charging information accuracy of location should be taken into consideration.\nWhen there is the tiered charging per bitrate, for 5G converged charging, the volume aggregation based on the range of bitrate as the charging information should be taken into consideration.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.2\tUse cases",
                            "text_content": "The operator has an offer for 5G data connectivity, which is volume based and available for both online and offline (in converged charging this means quota and not quota managed) charged subscribers. The offer has different rates depending on the PLMN accessed i.e., if it is roaming and where it is roaming. The operator would also like to get statics on how much the users are using in different PLMNs, as well as for some IoT devices how many times they change PLMN.\nA user has a UE that has a PDU session ongoing and is on the border between HPLMN and VPLMN and the UE keeps switching between the networks. The user chooses to only use the UE when it is connected to the HPLMN.\nAn enterprise has several IoT devices that each have their PDU sessions ongoing.\nThe operator would like to minimize the number of interrogations and the information sent between the SMF and CHF, this means that this means that for:\n-\tUEs that are online (quota managed) charged and have the offer, a PLMN change should only immediately trigger a CHF when there is usage.\n-\tUEs that are offline (not quota managed) charged and have the offer, a PLMN change should create a container only when there is usage.\n-\tsome IoT devices that are offline (not quota managed) charged, a PLMN change should create a container independent of if there is usage or not.\nThis could be relevant for the following triggers: QoS, GFBR guaranteed status, user location, serving node, Presence Reporting Area(s), 3GPP PS data off status, tariff time, UE time zone, PLMN, RAT type, Session-AMBR, UPF, I-SMF, handover status, access addition/removal and redundant transmission change.\nAn operator has a rating group containing only services charged online and only set immediate for triggers relating to quota management for volume, all other triggers for the rating group are set to deferred. This may in some cases result in a case where a request will be required to be split over several charging data requests e.g., when the payload size of HTTP requests exceeds the recommended values.\nThe operator may alternatively in this case want to optimize their storage and would therefore like to control the size of the converged charging requests based on the available space in each CHF. It should be noted that there is a trade of between size of the requests and the number of requests.\nThere are two parts of to the storage in the CHF one is the CDR storage before sending it to the CGF and the allocation of the resource for the SBI. The resource may be stored uncompressed for fast access, whereas the charging information in the converged charging request may be compressed to limit network utilization. This means that the operator would like to control the size of the message both before and after the compression.\nWhen a converged charging request is sent the amount of information included in the intimal is often limited since not much usage can have been done, so it is more important to be able to control the sizes of the update and termination than the initial.\nThe converged charging request can contain request for units, offline unit reports and online units report for the same rating group.\n\nThe operator has an offer for 5G Data Connectivity, which is volume based, though, this needs to be clearly optimized due to the expected number of IoT devices which an enterprise can have. Each one of the IoT devices may have a PDU session which could lead a major 5GS overload due to burst of Charging Data Requests.\nThe operator would like to minimize the number of interrogations and the information sent between the SMF and CHF, by:\n-\tSimplify charging for loT devices\n- \tProtect 5GS from charging system overload due to many CDRs\nAn End User (subscriber) uses a service with a RAT type has that isn’t supported by the CDR. The SMF reports the usage with the RAT type. The CHF will not be able to store the RAT type in the CDR and since it is optional it may discard the value. The undefined CDR value refers to the value in a CDR attribute reported by an NF consumer, but cannot be recognized by CHF. The reporting of undefined CDR values might happen to all CDR attributes of integer or enumerated type. CHF should be enhanced to support the handling of undefined CDR values.\nThe operator has an offering service for subscribers, e.g., 5G data connectivity service specified in the TS 32.255 [2], which is volume based charging. During the 5G data connectivity service consumption, the charging information is collected by the SMF and reported to the CHF when the triggers is encountered. That means whether the CHF can accurately charge for subscribers depends on the received charging information from SMF is correct or not.\nThe operator has an offer for 5G data connectivity services charged subscribers to provide the tiered charging per bitrate.\nThe end user subscribes the volume/time based tiered charging based on the averaged bitrate per time interval with special range (High speed/middle or low downlink or uplink). In order to make sure the user experience, the 5G system collects the statistics on traffic volume by averaged bitrate per time interval to implement tiered charging per bitrate.\nAccount the volume or time based on the range for the averaged bitrate per time interval.\nWhen received quota threshold based re-authorization triggers (i.e. timeQuotaThreshold, volumeQuotaThreshold, unitQuotaThreshold), the NF consumer shall seek re-authorization for the quota when fall below the supplied threshold. The NF consumer allows the service to continue whilst the re-authorization is progress, until the remaining part had been used up. The description in the TS 32.290 [12] clause 5.4.2 about the Threshold based re-authorization triggers is unclear.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.3\tPotential charging requirements",
                            "text_content": "REQ-CH_INFO-01: Optimization of charging information may be needed when zero units used.\nREQ-CH_INFO-02: Support for control of charging request size.\nREQ-CH_INFO-03: Optimization of charging information for small data delivery cases.\nREQ-CH_INFO-04: Possibility to support undefined attributes and values, for later usage, in the CDR.\nREQ-CH_INFO-05: Support for the optimization of charging information accuracy of location.\nREQ-CH_INFO-06: Support for the tiered charging based on averaged bitrate per time interval.\nREQ-CH_INFO-07: Support for control of remaining grant quotas during the re-authorization.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.4\tKey issues",
                            "text_content": "Key Issue #1a: Identify the charging scenarios and triggers which can be controlled when there is no usage.\nKey Issue #1b: How to control if information is sent when there is no usage.\nKey Issue #1c: How to control if containers are created when these is no usage.\nKey Issue #1d: How to control the size of the information in the converged charging request, dependent or independent of compression.\nKey Issue #1e: How to handle when unit request and report for one rating group are split over several requests\nKey Issue #1f: Identify the charging scenarios for small data delivery\nKey Issue #1g: How to optimize small data delivery charging requests\nKey Issue #1h: Where in CDR structure to store undefined values\nKey Issue #1i: How to determine where the attribute belongs in the CDR structure\nKey Issue #1j: How to ensure the charging information accuracy of location.\nKey Issue #1k: How to handle tiered charging based on averaged bitrate per time interval.\nKey Issue #1l: How to handle the remaining granted quotas during the re-authorization.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.5\tSolutions",
                            "text_content": "A possible solution for key issues #1a, #1b, and #1c covering requirements REQ-CH_INFO-01, charging information optimization.\nThis solution adds a variant of the immediate trigger category.\nFor the current immediate report chargeable events for which, when occurring, charging data generated by the NF consumer and sent to the CHF in a Charging Data Request message. Zero usage may be reported.\nThe figure depicts a message flow for current immediate triggers in a 5G network. It illustrates the flow of data from the source to the destination, including the use of various network layers and technologies. The figure is a visual representation of the complex network architecture and the flow of data, highlighting the importance of network design and management in ensuring reliable and efficient communication.\nFigure 5.1.5.1-1: Message flow for current immediate triggers\n1)\tService delivery ongoing: there is a connection setup for service delivery and a charging session is established between the NF (CTF) and the CHF.\n2)\tTrigger event: the NF (CTF) generates charging information related to the service delivered, due to that an immediate trigger for usage reporting or quota request is met.\n3)\tCharging data request [Update, Unit used, Quota requested]: the NF (CTF) sends the request to the CHF reporting the used units and if the service is under quota management it includes a quota request for the service to continue.\n4)\tAccount, rating, and reservation control: The CHF performs the process related to the reported usage and if the service is under quota management it performs processes related to quota requested, it may involve the rating entity and user's account balance.\n5)\t Update CDR: based on policies, the CHF updates the CDR with charging data related to the service.\n6)\tCharging Data Response [Update, Quota granted]: The CHF responds and if the service is under quota management it includes a quota granted for the service to continue.\n7)\tUplink/downlink transmission: first data or events transmission after the trigger event.\n8)\tService delivery continuing service delivery is continuing and the charging session is continuing between the NF (CTF) and the CHF.\n\nFor the deferred report chargeable events for which, when occurring, charging data generated by the NF consumer and stored. Zero usage may be included. The charging data will be sent to the CHF in next a Charging Data Request message.\nThe figure depicts a message flow for deferred triggers in a 5G network. It illustrates the sequential steps taken by the network to process and respond to a trigger, including the initiation of a delay, the transmission of a message, and the subsequent processing of the message. The figure provides a visual representation of the complex network architecture and the role of each component in the message flow.\nFigure 5.1.5.1-2: Message flow for deferred triggers\n1)\tService delivery ongoing: there is a connection setup for service delivery and a charging session is established between the NF (CTF) and the CHF.\n2)\tTrigger event: the NF (CTF) generates charging information related to the service delivered, deferred trigger for usage reporting is met.\n3)\tClose counts and start new counts: the NF (CTF) close all counts related to the service and starts new, keeping the closed counts for reporting when an immediate trigger occurs.\n4)\tUplink/downlink transmission: first data or events transmission after the trigger event.\n5)\tService delivery continuing service delivery is continuing and the charging session is continuing between the NF (CTF) and the CHF.\n\nFor the new immediate report chargeable events for which, when occurring and there is usage, charging data generated by the NF consumer and sent to the CHF in a Charging Data Request message.\nThe figure depicts a message flow for new immediate triggers in a 5G network. It illustrates the process of how messages are transmitted and received, with key components such as the base station (gNB), user equipment (UE), and scatterers. The diagram highlights the use of beamforming techniques to mitigate interference, ensuring reliable communication.\nFigure 5.1.5.1-3: Message flow for new immediate triggers\n1)\tService delivery ongoing: there is a connection setup for service delivery and a charging session is established between the NF (CTF) and the CHF.\n2)\tTrigger event: the NF (CTF) notices that a new immediate trigger with \"zero data transmission without reporting\" indicator is met. If there is zero usage, NF(CTF) will ignore the reporting for this trigger.\nNOTE: which triggers are applicable for the immediate trigger \"zero data transmission without reporting\" should be specified in the normative work. If the immediate trigger without the \"zero data transmission without reporting\" indicator, the charging data message should be reported even zero usage for the immediate triggers.\n3)\tUplink/downlink transmission: There are data or events transmission start after the immediate trigger \"zero data transmission without reporting \", was met, and the NF (CTF) generates charging information related to the service delivered.\n4) Trigger event: the NF (CTF) notices that new immediate triggers (e.g. Start of service data flow, in case no valid quota for this rating group) are met, the NF(CTF) generates charging data request message with the new immediate trigger and timestamp, the previous immediate trigger \"zero data transmission without reporting\" in step 2 is ignored.\n5)\tCharging data request [Update, Unit used, Quota requested]: the NF (CTF) sends the request to the CHF reporting the used units with the trigger and if the service is under quota management it includes a quota request for the service to continue.\n6)\tAccount, rating, and reservation control: The CHF performs the process related to the reported usage and if the service is under quota management it performs processes related to quota requested, it may involve using the reported charging data to rate the usage and deduct the funds corresponding to the usage on the account balance.\n7)\t Update CDR: based on policies, the CHF updates the CDR with charging data related to the service.\n8)\tCharging Data Response [Update, Quota granted]: The CHF responds and if the service is under quota management it includes a quota granted for the service to continue.\n9)\tService delivery continuing service delivery is continuing and the charging session is continuing between the NF (CTF) and the CHF.\nA possible solution for key issue #1e covering requirements REQ-CH_INFO-01, charging request optimization.\nAccording to the current charging mechanism specified in TS 32.255 [2] and TS 32.290 [12], the trigger per RG does not distinguish with quota management (online) or without quota management (offline). If the rating group have service with quota management (online), then the charging data request will report all used units for that rating group, including the quota management(online) and without quota management(offline) triggered in the rating group. Only the quota management services reported will be used for quota allocation. This is to ensure that the CHF won’t interpret any reporting of used units for the rating group as a release of all granted service units for the rating group.\nA possible solution for key issue #1j covering requirements REQ-CH_INFO-05, charging information accuracy of location.\nAdd a general description in the TS 32.240 [5] in line with the following:\n-\tthe NF (CTF) (e.g., SMF, AMF, NEF) ensures that location reporting in the charging information is accurate for charging purposes.\nA possible solution for key issue #1l covering requirements REQ-CH_INFO-07, control of granted quota during re-authorization.\nThe NF Service Consumer allows the service to continue whilst the re-authorization is progress, using the quota between the threshold and the granted quota. Either until the quota has been consumed or receiving a charging data response from CHF.\nIf the remaining part is used up before receiving the Charging Data Response:\n-\tNF Service Consumer stops the service delivery and discards the recorded used units.\nIf the Charging Data Response with new quota is received before the quota is consumed:\n-\tNF Service consumer continues the service delivery, deducting the used units from the new granted quota.\nIf the Charging Data Response with result code other than success or a final unit action, described in TS 32.290 [12], is received before the quota is consumed:\n-\tthe NF Service consumer stops service delivery, discards the recorded used unit, and performs the actions associated with the result code or final unit action.\nA possible solution for key issue #1l covering requirements REQ-CH_INFO-07, control of granted quota during re-authorization.\nClarify the description in clause 5.4.2 of TS 32.290 [12]. The NF Service Consumer allows the service to continue whilst the re-authorization is progress, until the remaining part had been used up.\nThe NF Service Consumer allows the service to continue whilst the re-authorization is progress, using the quota between the threshold and the granted quota. Either until the quota has been consumed or receiving the charging data response from CHF.\nIf the remaining part is used up before receiving a Charging Data Response:\n-\tNF Service Consumer terminates the service date flow and reports the used unit in the next Charging Data Request.\nIf the Charging Data Response with new quota is received before the quota is consumed:\n-\tNF Service consumer continues the service delivery, deducting the used units from the new granted quota.\nIf the Charging Data Response with result code other than success or a final unit action, described in TS 32.290 [12], is received before the quota is consumed:\n-\tthe NF Service consumer stops service delivery, reports the used unit in a Charging Data Request [Update/Termination], and performs the actions associated with the result code or final unit action.\nA possible solution for key issue #1l covering requirements REQ-CH_INFO-07, control of granted quota during re-authorization.\nThe quota is granted per RG. There may be several RGs in one charging session. The failure of granted quota for one RG will not impact on the quota granted for other RGs. For one special RG, the following mechanism is present.\nWhen received quota threshold based re-authorization triggers (i.e. timeQuotaThreshold, volumeQuotaThreshold, unitQuotaThreshold), the NF consumer shall seek re-authorization for the quota when fall below the supplied threshold.\nWhen the granting new quota is successful from the CHF, the used units during the re-authorization process are treated as the used part of the new granted quota.\nWhen the granting new quota is unsuccessful from the CHF, the CHF may indicate that the remaining quota can be used up, the NF consumer shall allow the service to continue until the remaining part is used up, and then report the usage of remaining quota with the quota management indication. Otherwise, the NF consumer stops the service after receiving failure response if no indication from CHF.\nA possible solution for key issue #1l covering requirements REQ-CH_INFO-07, control of granted quota during re-authorization.\nThe NF Service Consumer allows the service to continue whilst the re-authorization is progress, using the quota between the threshold and the granted quota. Either until the quota has been consumed or receiving a Charging Data Response from CHF.\nIf the remaining part is used up before receiving a Charging Data Response:\n-\tNF Service Consumer stops the service delivery and waits for the Charging Data Response. When the Charging Data Response is received it will follow the same actions as if it was received before the quota was consumed, see next two if-statements.\nIf the Charging Data Response with new quota is received before the quota is consumed:\n-\tNF Service Consumer continues the service delivery, deducting the used units from the new granted quota.\nIf the Charging Data Response with result code other than success or a final unit action, described in TS 32.290 [12], is received before the quota is consumed:\n-\tthe NF Service Consumer stops service delivery and reports the recorded used unit in a Charging Data Request [Update/Termination], and performs the actions associated with the result code or final unit action.\nA possible solution for key issues 1d covering requirements REQ-CH_INFO-02, control of charging request size.\nCHF can provide the max data of charging information collection in the NF(CTF) to limits the charging information data size that NF(CTF) can use in the charging information reporting, if the corresponding supported feature is supported.\nExample of maxzise in the Charging Data Response in the TS 32.291 [6] table 6.1.6.2.1.2:\nTable 6.1.6.2.1.2-1: Definition of type ChargingDataResponse\nA possible solution for key issues #1d covering requirements REQ-CH_INFO-02, control of charging request size.\nThe CHF can today set the following limits for a request to trigger reporting of charging information:\n-\ttime: limits the duration the CTF can wait before reporting.\n-\tvolume: limits the volume measured by the CTF before reporting.\n-\tevent: limits the number of events measured by the CTF before reporting.\n-\tNumber Of CCC: limits the number of charging condition changes performed CTF before reporting.\nThis solution would add two new limits the size of payload (before and after any compression) of the Charging data request:\n-\tcharging data: limits the charging data size that CTF can use in the charging data report before compression is applied, if any.\nThe new attribute e.g., maxChargingData, would be handled in the same way as the current maxNumberOfccc.\nExample of how the definition of trigger could look in the TS 32.291 [6] table 6.1.6.2.1.7-1:\nTable 5.1.5.9-1: Definition of type Trigger\n\nA possible solution for key issue #1k and requirement REQ-CH_INFO-06, Bitrate Charging.\nThe SMF collects the statistics on traffic volume by averaged bitrate per time interval to implement tiered charging per bitrate.\nThe figure depicts a message flow for a 5G Small-Cell Femtocell (SFC) solution, illustrating the various steps and components involved in the communication process. The diagram shows the flow of data from the SFC to the core network, highlighting the importance of network slicing and network slicing functions (NSF) in managing and prioritizing traffic. The figure also includes a visual representation of the network slicing function (NSF) and network slicing functions (NSF) in the network slicing function (NSF) and network slicing functions (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF) in the network slicing function (NSF\nFigure 5.1.5.10-1: Message flow for SMF solution\n1)\tCharging Data Request [Initial/update]: The SMF sends the Charging Data Request [Initial/Update] to CHF.\n2)\tOpen and update CDR:  CHF generates/updates the CDR based on the charging data request.\n3)\tBitrate Charging Determine: CHF decides to start the tiered bitrate charging and determines the threshold for the tiered charging. Optional, the CHF can decide the time interval for the averaged bitrate accounting.\n4)\tCharging Data Response [Initial/Update]: CHF sends Charging Data Response [Initial/Update] to SMF with the threshold, e.g. threshold 1 is the bitrate more than100 M/bps, threshold 2 is bitrate between 100 M/bps and 50 M/bps, threshold 3 is bitrate lesser than 50 M/bps. Optionally, the time interval is 10 seconds if needed.\n5)\tN4 modification Request: If the time interval is provided, SMF sends the N4 request to the UPF with the time interval or SMF sends the threshold for the tiered charging.\n6)\tN4 modification Response: The UPF reports the traffic volume per time interval to SMF or traffic volume for tiered charging per threshold.\n7)\tCounts or collection Operation: SMF starts the new counts for the trigger “tiered charging threshold” and counts the volume based on the corresponding threshold when the deferred trigger “tiered charging threshold” is enable.\n8)\tTrigger event: When the immediate trigger is met for reporting, the SMF close the counts for the traffic data volume, including the volume per threshold.\n9)\tCharging Data Request [Update, Used Units]: The SMF sends the Charging Data Request [Update, Used Units], e.g., the Used Units for threshold 1, the volume is 5 M, for threshold 2, the volume is10M, for threshold 3, the volume is 20 M, to the CHF. CHF processes the related charging data for CDR generation purpose.\n10) Update CDR:\tThe CHF stores received charging information for the CDR.\n11)\t Charging Data Response [Update]: The CHF sends the Charging Data Response [Update] the SMF.\nA possible solution for key issues #1h and #1i covering requirement REQ-CH_INFO-04, support undefined attributes and values in CDR.\nAdding a new attribute for storing undefined attributes and values, to all places in the CDR where an undefined attribute or attribute value could occur. This means that a new attribute would be added to all CDR attributes that is a group of attributes. An example on how this new attribute, undefinedAttribute, could be defined is described in clause 5.1.5.11.1.\nThis field consists of two parts, the attribute name and value.\nThe attributeName would contain the name of the attribute e.g., “rATType”\nThe value would contain the actual the value of the attribute as a string, since all attributes (for openAPI) would be possible to represent as a string e.g., \"NR_GEO\".\nThe figure depicts a 5G network with various elements such as base stations (gNB), user equipment (UE), and scatterers. It illustrates the signal propagation in a 5G network, highlighting the multi-path signal path and beamforming techniques to mitigate interference. The figure also shows the fiber-optic backbone architecture, with core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are shown in dashed lines, ensuring failover reliability. The layered design aligns with SDN principles.\nFigure 5.1.5.11-1: Example of new attribute and usage for solution 1.11\nA possible solution for key issues #1h and #1i covering requirement REQ-CH_INFO-04, support undefined attributes and values in CDR.\nAdding a new attribute or sequence of attributes directly in the ChargingRecord for storing undefined attributes and values. To be able to find in which part of the CDR the attribute belongs both the full resource path as well as a sequence number is needed, the sequence number would refer to which array item the undefined attribute belonged in the case of it being with in an attribute having multiple occurrences e.g., a “SEQUENCE OF”, in the CDR.\nAn example on how this new attribute, undefinedInformation, could be defined is described in clause 5.1.5.12.1.\nThis field would be array of the undefined attribute as defined in clause 5.1.5.11.1 with the addition of a sequence number reference.\nThe reference sequence number would identify the specific occurrence in a sequence that the undefined attribute would belong to e.g., LocalSequenceNumber in the MultipleQFIContainer and UsedUnitContainer. If a sequence number doesn’t exist for a specific attribute that is a sequence of, this would have to be added.\nThe figure depicts a 12-1-1 configuration, which is a new attribute and usage for solution 1. It illustrates the configuration of a 12-1-1 network, where 12 nodes are connected in a line, forming a 1-1-1 network. The figure also includes a usage of 12-1-1 for a specific scenario, demonstrating the effectiveness of this configuration in terms of network performance and scalability.\nFigure 5.1.5.12-1: Example of new attribute and usage for solution 1.12\nA possible solution for key issues #1h and #1i covering requirement REQ-CH_INFO-04, support undefined attributes and values in CDR.\nAdding a new attribute or sequence of attributes directly in in the ChargingRecord for storing undefined attributes and values. To be able to find in which part of the CDR the attribute belongs both the full resource path as well as a hash value for the specific array occurrence, the hash value would be calculated from the attributes and values of a specific array item and thereby uniquely identifying this array item.\nThe ChargingRecord would contain a new field undefinedInformation defined in clause 5.1.5.13.1.\nThis field would be an array of undefined attribute as defined in clause 5.1.5.11.1 with the addition of a reference hash value reference.\nThe reference hash value reference would uniquely identify the specific occurrence in a sequence where the undefined attribute would belong. For example, if an attribute could not be added to one item in the sequence of NGRANSecondaryRATUsageReports then the hash value would be created based on the attributes and values that could be stored in that specific occurrence in the sequence.\nThe figure depicts a 13-1-1 configuration, which is a new attribute and usage for solution 1. This configuration is used to represent a specific scenario in the telecommunication network. The figure illustrates the use of this attribute and its associated usage, providing a clear understanding of the network's configuration.\nFigure 5.1.5.13-1: Example of new attribute and usage for solution 1.13\nA possible solution for key issue #1j covering requirements REQ-CH_INFO-05, charging information accuracy of location.\nAdd a general description in the TS 32.240[5] in line with the following:\n-\tthe NF (CTF) (e.g., SMF, AMF, NEF) includes in the location reporting the accuracy of the location information and time the location was retrieved by the NF (CTF) in the charging information, to be used by the CHF to determine if the accuracy meets current requirements.\nA possible solution for key issues #1f and #1g covering requirements REQ-CH_INFO-03, optimization of charging information.\nCurrently, charging for data transfer is based on volume based measurement of the connections in down and uplink directions which has been enhanced to cover big data transfers.\nThe payload data considered in this is IoT related data (e.g. through Small Data Transmission procedure as referenced in TS 38.300 [22], which can trigger Charging Data Requests messages towards CHF.\nThis solution would bring the following advantages for IoT Charging:\n-\tCharging for loT subscriptions (which can be devices, group of devices, loT applications, external Identifiers) is simplified.\n-\tOverload of charging system due to many CDRs, one CDR per payload, may be avoided, by reducing the number of requests to Charging, limit down the Charging Data to IoT related one.\n-\tA new option to control loT devices and/or their environment, on this case its considered that each IoT device corresponds to a PDU Session (one UE and one subscriber).\nThe solution proposes the availability of a new count for the measurement and calculation of NIDD (Non-IP Data Delivery) of the Charging Data Request, and the availability of new default triggers specific to IoT use cases.\nThe Message Payload is a PFCP session related message (N4 Interface between UPF and SMF) as specified in TS 29.244 [19]. The new attributes Payload-Input-Count and Payload-Output-Count, would be used to indicate the number of times/events each one of an input payload for the subscription and an output payload from the subscription are delivered., it would subsequently generate the respective charging information, once it reaches a threshold leading to a reduction of Charging Requests towards CHF.\nA payload can be defined as trigger. The basic trigger mechanism is specified in TS 32.290 [12]\nAccording to TS 32.255 [2], when a PDU session starts, and the converged charging is activated, the SMF invokes a Charging Data Request [Initial] towards the CHF to get authorization to start based on the default triggers. The SMF is optionally provided in a Charging Data Response [Initial] to override the default triggers, with a set of chargeable event triggers to be enabled, and the associated category (on this case deferred report).\nThe triggers remain active until they are updated or disabled by subsequent Charging Data Response [Update] from the CHF or the PDU session is terminated.\nExample of Payload Triggers in TS 32.255[2] table 5.2.1.4.1\nTable 5.1.5.15-1: Extension to default trigger conditions in SMF\n\nIf the IoT Payload Threshold trigger is enabled then a new count in the CDR is started, it only creates a CDR once it reaches the threshold (TS 32.255 [2], step 16ch-a of Figure 5.1.5.15-1)\nThe triggers remain active until they are updated or disabled by subsequent Charging Data Response [Update] from the CHF or the PDU session is terminated.\nExample of Payload-Input-Count and Payload-Output-Count in the Charging Data Request Message in TS 32.290 [12] table 7.1:\n\nTable 5.1.5.15-2: Extension to Common Data structure of Charging Data Request\n\nA possible solution for key issues #1h and #1i covering requirement REQ-CH_INFO-04, support undefined attributes and values in CDR.\nAll attributes (for openAPI reporting) would be possible to represent in the CDR. If the undefined CDR parameters is reported via the Nchf from the NF consumers, just skip the undefined CDR parameters which is not supported in the supportedfeatures.\nA possible solution for key issues #1h and #1i covering requirement REQ-CH_INFO-04, support undefined attributes and values in CDR.\nAll attributes (for openAPI reporting) would be possible to represent in the CDR. If the undefined CDR parameters is reported via the Nchf from the NF consumers, it is up to the vendor private configuration to handle the undefined CDR parameters.\nA possible solution for key issues 1d covering requirement REQ-CH_INFO-02, control of charging request size.\nIntroduction of the possibility to refer to another container (PDU or QBC) if they contain the same information.\n\nTable 5.1.5.18-1: Additions to definition of type PDUContainerInformation\n\nTable 5.1.5.18-2: Additions to definition of type QFIContainerInformation\n\nA possible solution for key issues #1f and #1g covering requirements REQ-CH_INFO-03, optimization of charging information.\nCurrently, charging for data transfer is based on volume based measurement of the connections in down and uplink directions which has been enhanced to cover big data transfers.\nThis solution would bring the following advantages for IoT Charging:\n-\tCharging for loT subscriptions (which can be devices, group of devices, loT applications, external Identifiers) is simplified.\n-\tOverload of charging system due to many CDRs, one CDR per payload, may be avoided, by reducing the number of requests to Charging, limit down the Charging Data to IoT related one.\n-\tA new option to control loT devices and/or their environment, on this case its considered that each IoT device corresponds to a PDU Session (one UE and one subscriber).\nThe solution proposes the use of the current NIDD (Non-IP Data Delivery) handling as specified in TS 32.254 [17] and adding new trigger for number of API invocations/notifications.\nThe NIDD delivery uses the following, according to TS 29.591 [20]:\n-\tMO NIDD, the interaction between the SMF and the NEF uses Nnef_SMContext service, as specified in TS 29.541 [y];\n-\tMT NIDD, the interaction between the SMF and the NEF uses Nsmf_NIDD service as specified in TS 29.542 [z].\nWhen delivering the message to/from the AF the following can be used:\n-\tNiddDownlinkDataTransfer service, and it can be updated by the NiddDownlinkDataTransferPatch service\n-\tNiddUplinkDataNotification service\nTo have a trigger each time an uplink message is delivered to the AF or received from the AF may cause a lot of interaction and adding a new limit triggering after a number of events to default trigger conditions in NEF, TS 32.254 [17] table 5.4.1.2.1.1\nTable 5.1.5.19-1: Extension to default trigger conditions in NEF\n\nTable 5.1.5.19-2: Charging Data Request message content\n\nTable 5.1.5.19-3: Structure of the NEF API Container Information\n\nExtension of the Triggers information element in the Charging Data Request message contents in TS 32.290 [12] table 6.1.1.2.1:\nTable 5.1.5.19-4: Extension of Triggers information element\n\nA possible solution for key issues #1h and #1i covering requirement REQ-CH_INFO-04, support undefined attributes and values in CDR.\nIf the undefined value(s) in a CDR attribute are reported via the Nchf from an NF consumer, they can be stored in a range of special numbers reserved by the CDR attribute.\nNOTE: Which CDR attributes need to reserve a range of special numbers for undefined values should be defined in the normative work.\nTake the RAT Type as the example:\nRATType\t\t::= INTEGER\n--\n-- This integer is based on the RatType specified in TS 29.571 [249]\n-- with 3GPP RAT Type specified in TS 29.061 [216] added for backwards compatibility.\n--\n{\n-- 0 reserved\nuTRAN\t\t\t(1),\tgERAN\t\t\t(2),\twLAN\t\t\t(3),\n-- 4 reserved for GAN\n-- 5 reserved for HSPA Evolution\neUTRAN\t\t\t(6),\nvirtual\t\t\t(7),\n-- 8 reserved for nBIoT\n-- 9 reserved for lTEM\nnR\t\t\t\t(51),\nwIRELINE\t\t(55),\nwIRELINE-CABLE\t(56),\nwIRELINE-BBF\t(57),\nnR-REDCAP\t(58),\ntRUSTED-N3GA\t(65)\n-- 101 reserved for IEEE 802.16e\n-- 102 reserved for 3GPP2 eHRPD\n-- 103 reserved for 3GPP2 HRPD\n-- 104 reserved for 3GPP2 1xRTT\n-- 105 reserved for 3GPP2 UMB\n-- 90x reserved for undefined CDR parameters\n}\nA possible solution for key issue #1k and requirement REQ-CH_INFO-06, Bitrate Charging.\nThe SMF(CTF) reports the actual duration with the traffic and the volume of used usage during the actual duration for data transmission based on the Quota Consumption Time mechanism.\nThe figure depicts a message flow for bitrate charging in a 21-1.5 system, illustrating the steps involved in charging the bitrate for a channel header (CHF) from the carrier. The flow includes the sender, the carrier, the receiver, and the channel header, with the carrier providing the necessary information to the receiver. The figure also shows the steps for the carrier to charge the bitrate, including the sender's request, the carrier's response, and the receiver's acknowledgment. The figure is important for understanding the communication process in a 21-1.5 system and for implementing bitrate charging.\nFigure 5.1.5.21-1: Message flow for bitrate charging supporting from CHF\n1) \tCharging data request [Initial, Quota Requested]: The SMF sends the request to CHF for the charging session establishment for the PDU session establishment or start of the service date flow.\n2) \tOpen CDR:  CHF generates the CDR based on the charging data request.\n3)\tBitrate Charging Determine: CHF decides to start the tiered bitrate charging per time interval.\n4)\tCharging Data Response [Initial, Quota Granted]: The CHF responds and if the service is under quota management it includes a quota granted for the service start. In the response, the CHF will include the Quota Consumption Time.\n5)\tService delivery start: there is a connection setup for service delivery start and the uplink or downlink data traffics is transferred.\n6)\tTrigger event: the SMF generates charging information related to the service delivered, due to that an immediate trigger for usage reporting,\n7)\tCharging data request [Update, Unit used]: the SMF sends the request to the CHF reporting the used units, including both the time for the actual duration with traffic based on the Quota Consumption Time and the volume of the traffic.\n8)\tCalculate bitrate: The CHF calculates the mean bitrate, between the initial and update, by taking the volume in bytes times 8 (to get bits) and dividing it with the time in seconds.\n9)\tUpdate CDR: based on policies, the CHF updates the CDR with charging data related to the service.\n10)\tCharging Data Response [Update]: The CHF responds the Charging Data request.\nNOTE: The Charging Data Request [Update] message in the step 7 may include the requested quota, and if the service is under quota management, the Response in the step 9 includes a quota granted for the service to continue. In order to simplify the message flow, the Update message with the new requested quota is not described.\n11)\tService delivery is continuing and the charging session is continuing between the SMF and the CHF.\nA possible solution for key issue #1k and requirement REQ-CH_INFO-06, Bitrate Charging.\nThe SMF(CTF) reports the actual duration with the traffic and the volume of used usage during the actual duration for data transmission.\nThe figure depicts a message flow for bitrate charging in a CHF (Channel Hopping Forwarding) system, illustrating the steps involved in charging the bitrate for a specific channel. The flow starts with the sender sending a message to the CHF, which then forwards the message to the next hop. The figure shows the steps of the message flow, including the sender's message, the CHF's forwarding decision, and the next hop's decision. The figure is important for understanding the communication process in CHF systems and for designing and implementing such systems.\nFigure 5.1.5.21-1: Message flow for bitrate charging supporting from CHF\n1) \tCharging data request [Initial, Quota Requested]: The SMF sends the request to CHF for the charging session establishment for the PDU session establishment or start of the service date flow.\n2) \tOpen CDR:  CHF generates the CDR based on the charging data request.\n3)\tBitrate Charging Determine: CHF decides to start the bitrate charging.\n4)\tCharging Data Response [Initial, Quota Granted]: The CHF responds and if the service is under quota management it includes a quota granted for the service start.\n5)\tService delivery start: there is a connection setup for service delivery start and the uplink or downlink data traffics is transferred.\n6)\tTrigger event: the SMF generates charging information related to the service delivered, due to that an immediate trigger for usage reporting,\n7)\tCharging data request [Update, Unit used]: the SMF sends the request to the CHF reporting the used units, including both the time and the volume of the traffic.\n8)\tCalculate bitrate: The CHF calculates the mean bitrate, between the initial and update, by taking the volume in bytes times 8 (to get bits) and dividing it with the time in seconds.\n9)\tUpdate CDR: based on policies, the CHF updates the CDR with charging data related to the service.\n10)\tCharging Data Response [Update]: The CHF responds the Charging Data request.\n11)\tService delivery is continuing, and the charging session is continuing between the SMF and the CHF.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.1.6.2.1.2-1: Definition of type ChargingDataResponse",
                                    "table number": 3,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.1.5.9-1: Definition of type Trigger",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.1.5.15-1: Extension to default trigger conditions in SMF",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.1.5.15-2: Extension to Common Data structure of Charging Data Request",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.1.5.18-1: Additions to definition of type PDUContainerInformation",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.1.5.18-2: Additions to definition of type QFIContainerInformation",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.1.5.19-1: Extension to default trigger conditions in NEF",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.1.5.19-2: Charging Data Request message content",
                                    "table number": 10,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.1.5.19-3: Structure of the NEF API Container Information",
                                    "table number": 11,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.1.5.19-4: Extension of Triggers information element",
                                    "table number": 12,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.1.6\tEvaluation",
                            "text_content": "Solution #1.1 solve key issues #1a, #1b, and #1c.\n-\tSolution #1.1: introduces a new trigger, that will hold the charging data request until there is traffic.\nSolution #1.8, #1.9, #1.18 all solves key issue #1d.\n-\tSolution #1.8: requires CTF to control the size of charging information per ChargingDataRequest based on the maxChargingData specified in the ChargingDataResponse. It is an optional attribute in ChargingDataResponse, up to CHF.\n-\tSolution #1.9: requires CTF to keep monitoring the size of charging information based on the maxChargingData specified in the Trigger.\n-\tSolution #1.18: introduce a new attribute in PDUContainerInformation or QFIContainerInformation that can uniquely identify itself. It limits the amount of data sent by allowing the CTF to reference between containers so that information doesn’t have to be repeated.\nSolution #1.2 solve key issue #1e.\n-\tSolution #1.2: requires all used units reported for a rating group, both online and offline, to be delivered in the same request.\nSolutions #1.15 and #1.19 solve key issues #1f and #1g.\n-\tSolution #1.15: introduces new triggers and information elements for the SMF, that will trigger and report based on payload counts.\n-\tSolution #1.19: introduces new triggers and information elements for the NEF, that will trigger and report based on number of API invocations or notifications.\nSolutions #1.11, #1.12, #1.13, #1.16, #1.17, and #1.20 all solve key issue #1h and #1i.\n-\tSolution #1.11: All the information in the Open API can be stored. All levels of the CDR structure should be changed. CHF should deal with the undefined CDR structure parameters.\n-\tSolution #1.12: All the information in the Open API can be stored. Enhance the sequence number for multiple attributes. CHF should deal with the undefined CDR structure parameter.\n-\tSolution #1.13: All the information in the Open API can be stored. The main level of the CDR structure should be changed. CHF should deal with the undefined CDR structure parameter.\n-\tSolution #1.16: CHF can generate the CDRs based on the supported feature negotiation. Unsupported information in the Open API will not be stored in the CDRs.\n-\tSolution #1.17: Depending on the operator’s selection.\n-\tSolution #1.20: Reuse the existing with a reserved range to store undefined value.\nSolutions #1.3 and #1.14 solve key issue #1j.\n-\tSolution #1.3: requires that the NF (CTF) provides and ensure the level of accuracy required by the CHF e.g., when a location change is reported, NF(CTF) could indicate the changed location information.\n-\tSolution #1.14: requires the CHF determine if the accuracy meets current requirements based on the reported accuracy level and Location change received time.\nSolutions #1.10, #1.21, and #1.22 all solve key issue #1k.\n-\tSolution #1.10: requires that the UPF and SMF enhancement to support mean bitrate reporting.\n-\tSolution #1.20: reuses the mechanism from TS 32.251 [24] to support mean bitrate charging.\n-\tSolution #1.22: reuses existing mechanisms to support mean bitrate charging.\nSolutions #1.4, #1.5, #1.6, and #1.7 all solve key issue #1l.\n-\tSolution #1.4: NF (CTF) stops service delivery if no response is received before all the quotas (between the threshold and the granted quota) have been used and discards used units in the case of termination is received.\n-\tSolution #1.5: NF (CTF) terminates the service if no response is received before all the quotas (between the threshold and the granted quota) have been used and reports the used units in a termination request. This means that it will in some cases terminate the service even though there are funds on the account.\n-\tSolution #1.6: NF (CTF) stops or continues service delivery if no response is received all the quotas (between the threshold and the granted quota) have been used depending on CHF indication and reports used units in the next request. This requires new functionality in both CHF and NF (CTF).\n-\tSolution #1.7: NF (CTF) stops service delivery and waits for response when all the quotas (between the threshold and the granted quota) have been used and reports used units in the next request. This is possible even if it is not specified.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.7\tConclusions",
                            "text_content": "For key issues #1a, #1b, and #1c, solution #1.1 is recommended into normative work based on requirement.\nFor key issue #1d, solution #1.8 is recommended into normative work, controlling the charging information size by specifying the data limit in ChargingDataResponse.\nFor key issues #1e, solution #1.2 doesn’t require any new normative work.\nFor key issues #1f, and #1g, solutions #1.15, covering PDU sessions, and #1.19, covering exposure, could be introduced in the specification dependent on requirements.\nFor key issue #1h and #1i, solution #1.17 and #1.20 are recommended into normative work, using vendor specific and a reserved range to store undefined value.\nFor key issue #1j, solution #1.3, which requires CTF to ensure the accuracy of location, is recommended into normative work.\nFor key issue #1k, solution #1.22 with possible extension of #1.21 is recommended into normative work depending on requirements.\nFor key issue #1l, the solution #1.7 is selected for the normative work.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.2\tCharging request optimization",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tGeneral",
                            "text_content": "The number of requests from the network function to the CHF is controlled by the number events that require immediate triggering. This means that being able to have less immediate triggers will also minimize the number of requests. There is today a possibility to generate management intervention trigger immediately for events from management requiring reporting of unit usage immediately.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tUse cases",
                            "text_content": "An operator has set up some own defined triggers related to events generated by the network or management systems, these events does not require immediate reporting, just that the event is recorded, and the units counted before and after.\nAn operator has set up event based charging for 5G connection and mobility domain charging and wants to be able to control the applicable trigger conditions for each functionality (i.e., Registration, N2 connection, Location Reporting) during the UE registration lifetime in the AMF i.e., activate/deactivate charging for any AMF functionality.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.3\tPotential charging requirements",
                            "text_content": "REQ-CH_REQ-01: Possibility to support other than immediate trigger for own defined management or network triggers.\nREQ-CH_REQ-02: Possibility to support trigger setting for event based charging.\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.4\tKey issues",
                            "text_content": "Key Issue #2a: What trigger to use.\nKey Issue #2b: What information to be included with the trigger, if any.\nKey Issue #2c: Allow the CHF to set triggers for events.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.5\tSolutions",
                            "text_content": "A possible solution for key issues 2a and 2b covering requirements REQ-CH_REQ-01, charging request optimization.\nThere is no definition of the management intervention trigger, the only information is that it relates to a management event, it is always immediate, cannot be changed by the CHF and used to trigger an update.\nChanging the management intervention trigger to allow the CHF to change the category as well as enable/disable the trigger.\nA possible solution for key issues 2a and 2b covering requirements REQ-CH_REQ-01, charging request optimization.\nIntroduce a new trigger e.g., \"trigger extension\", which then the CHF could change the category as well as enable/disable the trigger. This could be seen as a new management intervention trigger, but would allow the operator to associate it with any type of chargeable event, including management interventions.\nA possible solution for key issues 2b and 2c covering requirement REQ-CH_REQ-02, trigger setting for event based charging.\nIntroduction of charging trigger profiles in the CTFs (e.g., AMF, SMSF) that can be changed by the CHF could solve this issue. This means that the CTF would inform the CHF which charging trigger profile was used for a specific chargeable event (it could also include the trigger settings) the CHF could then update the trigger settings it would prefer.\nThe figure depicts a 5G network scenario with a focus on signal propagation and the use of beamforming techniques to mitigate interference. The network consists of a base station (gNB), user equipment (UE), and scatterers, with key components such as base stations, optical line terminals (OLTs), and distributed nodes. The layered architecture aligns with SDN principles, highlighting redundancy paths and failover reliability.\nFigure 5.2.5.3-1: Post Event Charging\n1.\tRequest for resource usage: A request for session establishment is received in the NF (CTF).\n2.\tContent/Service Delivery: the NF (CTF) delivers the content/service, and determines which charging trigger profile to use based on internal configuration.\n3.\tCharging Data Request [Event, Units, Charging Trigger Profile]: The NF (CTF) the CTF generates charging data related to the delivered service with the units used and the charging trigger profile used, and sends the request to the CHF.\n4.\tAccount, rating and trigger control: The CHF may rate the used units and make a deduction of the calculated amount from user's account balance. It checks the used charging trigger profile to determine if any update to the profile is required.\n5.\t Create CDR: the CHF stores received information and creates a CDR related to the service.\n5)\tCharging Data Response [Event, Charging Trigger Profiles]: The CHF informs the NF (CTF) on the result of the request, it may include update to one or more charging trigger profiles.\n\nTable 5.2.5.3-1: Additions to definition of type ChargingDataRequest\n\nTable 5.2.5.3-2: Additions to definition of type ChargingDataResponse\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.2.5.3-1: Additions to definition of type ChargingDataRequest",
                                    "table number": 13,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.2.5.3-2: Additions to definition of type ChargingDataResponse",
                                    "table number": 14,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.2.6\tEvaluation",
                            "text_content": "Solutions #2.1, and #2.2 both solve key issues #2a and #2b.\n-\tSolution #2.1: reuses the current triggers. It has already defined usage for operation management events, the usage of operation management triggers are related to management events and have no more information about why it was triggered therefore it may cause confusion as to why the trigger was considered met.\n-\tSolution #2.2: requires introduction of a new trigger. Separate the trigger from any other types of triggers. It is not necessary to define the extension of private triggers in the standard. No more information about why it was triggered therefore it may cause confusion as to why the trigger was considered met.\nSolution #2.3 solves key issue #2b and #2c.\n-\tSolution #2.3: requires introduction of a new trigger profile, that can also solve issues for event based trigger handling. This requires both CTF and CHF maintain a unique and persistent triggerProfileId as the reference key.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.7\tConclusions",
                            "text_content": "For key issues #2a and #2b, solution #2.1 is recommended into normative work since this has the most flexibility.\nFor key issue #2b and #2c, solution #2.3 is recommended to be combined with the solutions for the AMF charging profile.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tRating input enhancement",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tGeneral",
                            "text_content": "A rating group is not defined in the context of SBI, it is however defined in TS 32.299 [8] as the same as the rating group of RFC 4006 [13] obsoleted by RFC 8506 [14] and linked to the charging key defined in TS 23.203 [10], the corresponding spec for SBI is TS 23.503 [3]. In TS 23.503 [3] the charging key is defined as \"information used by the CHF for rating purposes\".\nThe rating group gathers a set of services that is subject to the same cost and rates. One rating group can contain several rates if all rates are applicable to all services belonging to the rating group and if quota is granted it can be consumed by all services, belonging to the rating group, equally. How a service is identified is dependent on the network function.\nThis means that the cost and rates can be determined by the rating group but not the consumption rate of the quota i.e., how fast quota is used by the services belonging to the same rating group, and in the extension how much quota that should be reserved for a specific request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.2\tUse cases",
                            "text_content": "A End User (subscriber) has subscribed to a service with multiple QoSs. The PCF dynamically decides to authorize a QoS based on the network information. When granting a quota, the CHF may need additional authorized QoS information corresponding to the Rating Group to assist CHF to grant quota per Rating Group.\nAs per the present document, the PDU charging information includes the default QoS information (Authorized QoS Information for PDU session and Subscribed QoS Information), which there is not the QoS information corresponding to the Rating Group.\nThe QoS information is an example as the input to the CHF rating. Any enhancement of input to CHF rating would be introduced case by case.\nAn End User (subscriber) subscribed to a service, once the service consumption is authorized for the End User, CHF can provide the right Rating Group to be used for service charging whilst the End User consumes it. Furthermore, this can be used for a clear improvement on the charging statistics and reporting.\nAs per the present document, the Charging Data Request [initial] message has the RequestedUnit Type which will be used by the CHF on the response, though the ServiceID type is not available. Service ID is only available in the UsedUnitContainer type (after initial Chargind Data Request message).\nA UE has four services on going (A, B, C, and D). The NF providing the services (e.g., SMF) determines that these four services belong to three different rating groups (RGs), where service A belongs to RG 1, services B and C belongs to RG 2, and service D belongs to RG 3. It further determines that service A and B are always offline, while C and D are online, but may be set to quota management suspended.\nFigure 5.3.2. 3 -1: Session based charging with suspend and resume of quota management.\n\nThis figure illustrates the process of session-based charging in a mobile network, where users can pause and resume their billing based on their usage. The figure shows the user's balance, the time remaining, and the status of the session. This allows users to manage their usage and avoid overage charges.\nFigure 5.3.2.3-1: Session based charging with suspend and resume of quota management.\n1\tRequest for resource usage: A request for session establishment is received in the NF (CTF). The service is configured to be authorized by the CHF to start.\n2\tUnits Determination: the NF (CTF)) determines the number of units depending on the service requested by the UE in \"Decentralized Units determination\" scenario.\n3\tCharging Data Request [Initial, Quota request RG2 and RG3]: The NF (CTF) sends the request to the CHF for the services C and D (i.e., RG 2 and 3), to be granted quota.\n4\tAccount, rating, and reservation control, and open CDR: the CHF may open a CDR, rate the request, and check need for quota management. RG 2 will be granted quota while quota management will be suspended for RG 3.\n5\tCharging Data Response [Initial, Quota granted RG2, Result code RG3]: The CHF grants quota for RG 2 and gives a result code for RG 3 to indicating that quota management is suspended.\n6\tService delivery starts and is ongoing: the NF (CTF) delivers the services.\n7\tUsage Reporting Trigger: the NF (CTF) generates charging data related to the services delivered, based on a trigger for usage reporting is met.\n8\tCharging Data Request [Update, Unit used, Quota request RG2 and RG3]: the NF (CTF) sends the request to the CHF, for quota to be granted for RG 2 and 3. It also reports the used units for services A, B, C, and D. In this case the QMI is reported for: A and B as offline, C as online, and D as suspended.\n9\tAccount, rating, and reservation control, and update CDR: the CHF may update the CDR, rate the request, and check need for quota management. RG 3 will be granted quota while quota management will not be applicable for RG 2.\n10\tCharging Data Response [Update, Quota granted RG3, Result code RG2]: The CHF grants quota for RG 3 and gives a result code for RG 2 to indicating that quota management is not applicable.\n11\tService delivery is ongoing: the NF (CTF) delivers the services.\n12\tUsage Reporting Trigger: the NF (CTF) generates charging data related to the services delivered, based on a trigger for usage reporting is met.\n13\tCharging Data Request [Update, Unit used, Quota request RG3]: the NF (CTF) sends the request to the CHF, for quota to be granted for RG 3. It also reports the used units for services A, B, C, and D. In this case the QMI is reported for: A and B as offline, C as offline, and D as online.\n14\tAccount, rating, and reservation control, and update CDR: the CHF may update the CDR, rate the request, and check need for quota management. RG 3.\n15\tCharging Data Response [Update, Quota granted RG3]: The CHF grants quota for RG 3.\n14\tSession released: after some time, the session is released.\n15\tCharging Data Request [Termination, Units used]: the NF (CTF) sends the request to the CHF, for charging data related to the service termination with the final consumed units for services A, B, and D. In this case the QMI is reported for: A and B as offline, C as offline, and D as online.\n9\tAccount, and rating control, and close CDR: the CHF may close the CDR, and rate the request.\n18\tCharging Data Response [Termination]: The CHF informs the NF (CTF) on the result of the request.\nIn this case it is unclear how the quota management indicator (QMI) is influenced by the result code sent by the CHF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.3\tPotential charging requirements",
                            "text_content": "REQ-3GPPCH-ER-01\tThe 5G system should support the enhancement of input to CHF rating based on the QoS information.\nREQ-3GPPCH-ER-02\tThe 5G system should support the enhancement of input to CHF rating based on the Service ID information.\nREQ-3GPPCH_ER-03: The 5G system should support reporting QMI used for used unit.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.4\tKey issues",
                            "text_content": "Key Issue #3a: Identification and classification of information which can be used as the input to CHF rating.\nKey Issue #3b: Identify the Network Functions which can provide the input to support the CHF rating.\nKey Issue #3c: Determine the interaction to support the enhancement of input to CHF rating.\nKey Issue #3d: How QMI is influenced by the result code.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.5\tSolutions",
                            "text_content": "A possible solution for key issues 3a, 3b, and 3c, enhancement of input to CHF rating.\nAny information in the PCC rule could potentially be connected to a specific service identifier, this means that a specific QoS can be identified by the service identifier.\nA solution could be to allow the service identifier in the MultipleUnitUsage as well as the rating group in the request for quota, to be able to allocate the right amount of quota needed at that moment for that rating group. The service identifier would in this case only be included as indicative i.e., which services that may be started. This means that both the service identifier(s) that triggered the request (if any) as well as the already started would be included in the request in the case of an update.\nTable 5.3.5.1-1: Definition of type MultipleUnitUsage\n\nA possible solution for key issues 3a, 3b, and 3c, enhancement of input to CHF rating.\nAny information in the PCC rule could potentially be connected to a specific service identifier, this means that a specific QoS can be identified by the service identifier.\nA solution could be to allow the service identifier in the requested unit, to be able to allocate the right amount of quota needed at that moment for that rating group. The service identifier would in this case only be included as indicative i.e., which services that may be started. This means that both the service identifier(s) that triggered the request (if any) as well as the already started would be included in the request in the case of an update.\nTable 5.3.5.2-1: Definition of type RequestedUnit\n\nA possible solution for key issues 3a, 3b, and 3c, enhancement of input to CHF rating.\nThe possible solution supports the potential requirements REQ-3GPPCH-ER-01 and partial supports Key Issue #3a, #3b and #3c to describe the enhancement of input to CHF rating.\nThe QoS information is the measurement of the overall performance of a service. A solution could be to allow the QoS information in the RequestedUnit as well as the rating group in the request for quota specified in the TS 32.291 [6], as the input for CHF rating consideration, to be able to assist to allocate the right amount of quota needed at that moment for that rating group.\nTable 5.3.5.3-1: Definition of type RequestedUnit\n\nA possible solution for key issues 3a, 3b, and 3c, enhancement of input to CHF rating.\nThe possible solutions support the potential requirements REQ-3GPPCH-ER-01 and REQ-3GPPCH-ER-02 and Key Issue #3a, #3b and #3c to describe the enhancement of input to CHF rating.\nThe QoS information is measurement of the overall performance of a service. The service identifier is the detailed identification of a service data flow. A solution could be to allow the QoS information and service id in the Additional information as well as the rating group in the request for quota specified in the TS 32.291 [6], as the input for CHF rating consideration, to be able to assist to allocate the right amount of quota needed at that moment for that rating group.\nTable 5.3.5.4-1: Definition of type RequestedUnit\n\nTable 5.3.5.4-2: Definition of type AdditionalInfo\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.3.5.1-1: Definition of type MultipleUnitUsage",
                                    "table number": 15,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.5.2-1: Definition of type RequestedUnit",
                                    "table number": 16,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.5.3-1: Definition of type RequestedUnit",
                                    "table number": 17,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.5.4-1: Definition of type RequestedUnit",
                                    "table number": 18,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.5.4-2: Definition of type AdditionalInfo",
                                    "table number": 19,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.3.6\tEvaluation",
                            "text_content": "Solution #3.1, #3.2, #3.3, #3.4, and #3.5 all solve key issues #3a, #3b, and #3c.\n-\tSolution #3.1: the new service id list holds the used service ids which can provide the service level information (e.g. video, email, file transfer, VoIP) which will make it easier for the CHF to allocate quota for the rating group. It reuses the current mechanism for MultipleUnitUsage and is backwards compatible. It may cause confusion as to if this is the service id for the requested units or the reported used units.\n-\tSolution #3.2: the new service id list holds the used service ids which can provide the service level information (e.g. video, email, file transfer, VoIP) and is part of the requested units which will make it easier for the CHF to allocate quota for the rating group and is backwards compatible. It is also possible to connect the service id to the QoS.\n-\tSolution #3.3: the new QoS information which can provide the service quality and service experience requirement information (e.g. the authorized bandwidth, latency) holds the currently applied QoS for the rating group and is part of the requested units which will make it easier for the CHF to allocate quota for different service quality requirement of the same rating group.\n-\tSolution #3.4: the new additional information holds both the QoS information and service ids the currently applied for the rating group and is part of the requested units which will make it easier for the CHF to allocate quota for the rating group.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.7\tConclusions",
                            "text_content": "For key issues #3a, #3b and #3c, solution #3.2 is recommended into normative work, which can on a case by case be extended to also cover solution #3.4 if the service id solution is deemed insufficient.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.4\tChargeable events and sessions cancelling",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.4.1\tGeneral",
                            "text_content": "In the present document for the Nchf service there is a possibility charge before the service has been delivered i.e., IEC. This is similar to the DCCA IEC, however in Diameter there is a possibility to do a refund, something similar is missing in Nchf.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.2\tUse cases",
                            "text_content": "The operator would like to use IEC instead of PEC to catch all service delivery events, even the ones that might be lost or not delivered. When using IEC, the charging request is sent before the service has been deliver, when the service delivery fails, the operator would like to have the possibility to cancel (e.g., by doing a refund) the previous charging request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.3\tPotential charging requirements",
                            "text_content": "REQ-3GPPCH-ESC-01\tThe 5G system should support to cancelling (e.g., ref und) chargeable service delivery events.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.4\tKey issues",
                            "text_content": "The following key issues are identified:\n-\tKey Issue #4a: How to locate the event that should be cancelled (e.g., refund).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.5\tSolutions",
                            "text_content": "A possible solution for key issues 4a, covering requirements REQ-3GPPCH-ESC-01, cancelling of event would be to use the charging session identifier, see TS 32.290 [12], which corresponded to ChargingDataRef, TS 32.291 [6]. When a resource is created in the CHF the NF (CTF) will always receive a ChargingDataRef. This ChargingDataRef can be put in a new attribute (e.g., requestToCancel), and used in a new service operation (e.g., cancel) to cancel any previously created resources. After received the new service operation request, the CHF performs the cancel operation, how this is performed will be operator dependent. If CHF cannot handle the cancel request, it will respond and results to indicate the cancel unsuccessfully.\n\nThe figure depicts the message flow of a new service operation, specifically a cancel operation, in a telecommunications network. It illustrates the steps taken by the network to handle the request, including the routing of the message to the appropriate service provider, the initiation of the service, and the completion of the operation. The figure provides a visual representation of the complex network operations involved in providing new services, highlighting the importance of efficient routing and service provisioning in modern telecommunications networks.\nFigure 5.4.5.1-1 Message flow of new service operation (e.g., cancel)\nA possible solution for key issues 4a, covering requirements REQ-3GPPCH-ESC-01, cancelling of event would be to add a reference identifier (e.g. refundInformation) in Charging Data Response of Nchf_ConvergedCharging_Create operation -> multipleUnitInformation for IEC, which can later be sent back in Charging Data Request of Nchf_ConvergedCharging_Release operation -> multipleUnitUsage, to identify the event to be cancelled or refunded.\nThe figure depicts the message flow of the refund for IEC, illustrating the steps involved in processing a refund request. The flow starts with the customer initiating the refund, followed by the customer service representative (CSR) processing the request, and finally, the CSR sending the refund to the customer. The flow is depicted in a step-by-step manner, with each step clearly labeled and connected by arrows, illustrating the logical progression of the refund process.\nFigure 5.4.5.2-1 Message flow of the Refund for IEC\nA possible solution for key issues 4a, covering requirements REQ-3GPPCH-ESC-01, cancelling of event would be to use the charging session identifier, see TS 32.290 [12], which corresponded to ChargingDataRef, TS 32.291 [6]. When a resource is created in the CHF the NF (CTF) will always receive a ChargingDataRef. This ChargingDataRef can be put in a new attribute (e.g., requestToCancel), and used in a new one-time event type (e.g., CANCEL) to cancel any previously created resources. If the ChargingDataRef uniqueness cannot be guaranteed it can be used together with charging id. After received the new service operation request, the CHF performs the cancel operation, how this is performed will be operator dependent. If CHF cannot handle the cancel request it will respond and indicate the cancel unsuccessfully.\nThe figure depicts a message flow of a new service operation, specifically a cancel operation, in a telecommunications network. It illustrates the steps taken by the network to handle the request, including the initiation of the service, the transmission of the request, and the completion of the service. The figure provides a visual representation of the network's response to the request, highlighting the steps involved in the process.\nFigure 5.4.5.3-1 Message flow of new service operation (e.g., cancel)\nThe table 5.4.5.3-1 contain additional attributes of the type ChargingDataRequest defined in TS 32.291 [6] clause 6.1.6.2.1.1 for cancel.\nTable 5.4.5.3-1: Cancel specified attribute of type ChargingDataRequest\n\nNOTE 1: If the value of EventType is CANCEL, the attribute “requestToCancel” must be included in the ChargingDataRequest.\n\nThe table 5.4.5.3-2 contains additional values to the EventType for cancel.\nTable 5.4.5.3-2: Enumeration EventType\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.4.5.3-1: Cancel specified attribute of type ChargingDataRequest",
                                    "table number": 20,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.4.5.3-2: Enumeration EventType",
                                    "table number": 21,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.4.6\tEvaluation",
                            "text_content": "Solutions #4.1, #4.2 and #4.3 solve key issue #4a.\n-\tSolution #4.1: requires an extension to current service operation with a specific service operation (i.e., Nchf_ConvergedCharging_Cancel) and uses the current Event type and chargingDataRef. The allocation of ChargingDataRef should be unique to void duplication, otherwise, it may cause an error. The ChargingDataRef can not be recycled for until a cancel is no longer allowed for a charging session or event.\n-\tSolution #4.2: reuses the current event with specific information to determine refund, making the refund implicitly defined. Using a Nchf_ConvergedCharging Release service operation for events to support carry the previous refundInformation in the case of a cancel, in essence making the event into a session. The negotiation is completed based on the charging data response, if the refundinformation is included in the Charging Data Response, the CHF support the event cancelling.\n-\tSolution #4.3: requires an extension to current service operation with a specific service operation (i.e., Nchf_ConvergedCharging_Cancel). Requires an extension to current event type with a specific event type (i.e., Cancel). Uses the current chargingDataRef in a new attribute, charging id or both, the use of both makes it easier to find the Charging Data Request that is to be cancelled.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.7\tConclusions",
                            "text_content": "For key issue #4a, solution #4.3 is recommended into normative work.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.5\tNon-blocking mechanism enhancement",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.5.1\tGeneral",
                            "text_content": "The non-blocking mode scenario is introduced for the 5G charging in clause 5.3.2 Charging scenarios of TS 32.290 [12]. The Converged Charging service offers charging with quota management, including the support for both blocking mode and non-blocking mode. The non-blocking charging mode allow the service delivery before sending the request to the CHF for the service to be granted authorization to start. In TS 23.503 [3], the \"Service Data flow handling while requesting credit\" in clause 6.3 Policy and charging control rule is introduced for indicating whether the service data flow is allowed to start while the SMF is waiting for the response to the credit request (Values: blocking or non-blocking).\nIn the TS 23.501 [9], when the PCC Rule attribute Service Data flow handling while requesting credit indicates \"non-blocking\", the SMF requests the report of the relevant usage information for the Charging key and Sponsor Identity (if applicable) and provide a default threshold value to the UPF while waiting for the quota from the CHF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.2\tUse cases",
                            "text_content": "When end user accesses the services and the non-blocking mode is active based on the PCC rule, the quota is not granted from the CHF before the service delivery. The CHF may not grant quota for the service delivery after service delivery have started in e.g., the following cases:\nthe end-user service restrictions or limitations;\nthe end user's account could not cover the requested service delivery;\nCHF denies the service request for other reasons; etc.\nThe service delivery will be started and then stopped because of the service start is beyond the control of the CHF.\nTo avoid the UE frequently initiates service requests and start of service delivery affecting the user's experience, in this case, the non-blocking mode could be disabled temporarily based on the information of CHF and resumed later.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.3\tPotential charging requirements",
                            "text_content": "REQ-3GPPCH-NB-01\tThe 5G system should support to disable temporarily the non-blocking mode.\nREQ-3GPPCH-NB-02\tThe 5G system should support to resume the non-blocking mode.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.4\tThe key issues",
                            "text_content": "The following key issues are identified:\n-\tKey Issue #5a: Non-blocking mode disable/enable affect only specific rating group or all rating groups for a UE.\n-\tKey Issue #5b: Identify the Network Functions to disable/enable non-blocking mode.\n-\tKey Issue #5c: Determine of the interactions required to disable/enable non-blocking mode for the special user/service.\n-\tKey Issue #5d: Determine if non-blocking mode is possible for a rating group.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.5\tSolutions",
                            "text_content": "The possible solution partially supports the potential requirements REQ-3GPPCH-NB-01, REQ-3GPPCH-NB-02 and Key Issue #5d for the non-blocking mode reporting to CHF.\nThe figure depicts a message flow for a dedicated non-blocking indicator in a 5G network. It illustrates the flow of data from the sender to the receiver, with a focus on the non-blocking nature of the indicator. The figure includes key components such as the sender, receiver, and the indicator itself, as well as the signaling protocol used. The diagram highlights the importance of non-blocking indicators in ensuring efficient data transmission in a 5G network.\nFigure 5.5.5.1-1: Message flow for dedicated non-blocking indicator\n1. PCF sends the PCC rules to SMF with the \"Service Data flow handling while requesting credit\" to indicate SMF the Non-Blocking mode is adapted.\n2. The service data flow are allowed to start while the SMF is waiting for the response to the quota request.\n3. SMF sends the Charging Data Request to CHF for the quota request with the non-blocking mode indication when detect the non-blocking mode is usage for the service data flow.\nThe charging reporting from the SMF with the Non-blocking mode is per Rating Group. After the PDU session establishment, when any service date flow delivery with the non-blocking mode in the RG is detected (may be the first service data flow of the PDU session or the subsequent service data flows of the PDU session), the SMF should immediately report to the CHF with the non-blocking mode indication in the Charging Data Request [Initial] for first service data flow or in the Charging Data Request [Update] for the subsequent service data flow when detected with the non-blocking mode.\nThe possible solution supports the potential requirements REQ-3GPPCH-NB-01, REQ-3GPPCH-NB-02 and Key Issue #5a, Key Issue #5b, Key Issue #5c to describe the non-blocking mode change from CHF enhances or extends the Nchf_Convergedcharging defined in TS 32.255 [3] and SMF operation.\nThe figure depicts a message flow for a non-blocking change on a Service Management Function (SMF) in a 5G network. The flow includes the sender, the SMF, the network, and the receiver. The sender sends a message to the SMF, which then forwards it to the network. The network then processes the message and sends it to the receiver. The figure illustrates the non-blocking nature of the change, allowing for efficient message flow in a 5G network.\nFigure 5.5.5.2-1: Message flow for Non-blocking Change on SMF\n1-3.\tThe same steps description with the Figure 5.5.5.1-1.\n4.\tWhen received the Charging Data Request and Non-Blocking mode, CHF determines to change the Non-Blocking mode based on the user information (e.g. Account Balance and account status) in the charging system. CHF sends the Charging Data Response with the Non-Blocking mode change.\nThe CHF can change the Non-blocking mode when received the Charging Data Request with the NB mode indication or change it in the any Charging Data Response spontaneously.\nThe CHF can change the NB mode per UE, per RG or per Service Id.\n5.\tThe CHF sends the non-blocking mode in the Charging Data Response to SMF. SMF has the PCC rule about the \"service data flow handling while requesting credit\" previously and the non-blocking mode change from CHF subsequently, For the subsequent service data flows with the same RG in the PDU session, the SMF will perform the setting from CHF with blocking mode.\nThe CHF can change the NB mode per UE, per RG, per Service Identifier.\nThe non-blocking mode set by CHF is only active during the PDU session, When the PDU session is terminated, the non-blocking mode setting by the CHF is inactive. For next PDU session establishment, the SMF will perform the PCC rules from PCF.\nThe possible solutions to support the potential requirements REQ-3GPPCH-NB-01, REQ-3GPPCH-NB-02 and Key Issue #5a, Key Issue #5b, Key Issue #5c could be the following enhancements or extensions to the Nchf_Convergedcharging defined in TS 32.255 [3] and the interaction between PCF and SMF.\nThe figure depicts a message flow for non-blocking change on PCF via SMF, illustrating the process of data transmission in a 5G network. The figure shows the message flow from the source to the destination, with the sender sending a message to the receiver, and the receiver processing and sending the message back to the sender. The figure also includes a visual representation of the SMF (Switch-Mode Forwarding) process, which is a technique used in 5G networks to improve network performance by reducing the number of hops required for data transmission.\nFigure 5.5.5.3-1: Message flow for Non-blocking Change on PCF via SMF\n1-4.\t The same steps description with the Figure 5.5.5.3-1.\n5.\tThe CHF sends the non-blocking mode in the charging data response to SMF\n6.\tThe SMF transfers the non-blocking mode change to the PCF in the PDU session. The PCF will set the new PCC rules for the \"service data flow handling while requesting credit\" to SMF.\nThe CHF can change the NB mode per UE, per RG, per Service Identifier.\nWhen the PDU session is terminated, the PCF still adapts the updated non-blocking mode considering the feedback from CHF.\nThe possible solutions to support the potential requirements REQ-3GPPCH-NB-01, REQ-3GPPCH-NB-02 and Key Issue #5a, Key Issue #5b, Key Issue #5c about change the non-blocking mode per UE could be the following enhancements or extensions to the Nchf_SpendingLimitControldefined in TS 23.503 [3].\nThe figure depicts a message flow for Non-blocking Mode Change on PCF from CHF, illustrating the steps involved in the process. The message is first sent from the source to the destination, then the destination sends a message to the source, and finally, the source sends a message back to the destination. The figure shows the different stages of the message flow, including the sender, the receiver, and the sender's response.\nFigure 5.5.5.4-1: Message flow for Non-blocking Mode Change on PCF from CHF\n0.\tThe CHF subscribes the policy counter status information relating to subscriber spending limits.\n1-4.\tThe same steps description with the Figure 5.5.5.1-1.\n5.\tThe CHF sent the non-blocking mode change in the spending limit control service to PCF via the Policycounterstatus. According to the TS 23.503 [3] and TS 29.594 [11], The policy counter status is per UE. the policy counter status is a label whose values are not standardized and that is associated with a policy counter's value relative to the spending limit(s) (the number of possible policy counter status values for a policy counter is one greater than the number of thresholds associated with that policy counter, i.e. policy counter status values describe the status around the thresholds). This is used to convey information relating to subscriber spending from CHF to PCF. Specific labels are configured jointly in CHF and PCF.\nThe specific labels is the non-blocking mode. Configure the special policy counter per UE for the Non-blocking mode, if CHF determines to change the Non-blocking mode (i.e. Enable/disable) for any service data flow, the CHF notifies the PCF to change the policy counter status for UE.\nThe CHF can change the NB mode per UE.\nWhen the PDU session is terminated, the PCF still adapts the updated non-blocking mode considering the feedback from CHF.\nThe possible solution partially supports the potential requirements REQ-3GPPCH-NB-01, REQ-3GPPCH-NB-02 and Key Issue #5d for the non-blocking mode reporting to CHF.\nThe figure depicts a message flow for a dedicated non-blocking indicator in a 5G network. It illustrates the flow of data from the sender to the receiver, with a focus on the non-blocking nature of the indicator. The figure shows the message passing through various components such as the sender, the non-blocking indicator, and the receiver, highlighting the importance of non-blocking mechanisms in ensuring efficient communication.\nFigure 5.5.5.5-1: Message flow for dedicated non-blocking indicator\n1.\tPCF sends the PCC rules to SMF with the sdfHandl set to true, indicating that the service data flow is allowed to start while the SMF is waiting for the response to the credit request i.e., non-blocking mode.\n2.\tSMF sends the Charging Data Request to CHF for the quota request with a non-blocking indication for the rating group with the sdfHandl set to true.\n3.\tThe service data flow is allowed to start while the SMF is waiting for the response to the quota request.\nThe non-blocking charging reporting from the SMF is per rating group. After the PDU session establishment, when any service date flow delivery for a rating group with non-blocking (can be the first or the subsequent service data flows of the PDU session), the SMF should immediately report to the CHF with the non-blocking indication in the Charging Data Request [Initial] if it is the first service data flow or in the Charging Data Request [Update] for the subsequent service data flow.\nA possible solution to support the potential requirements REQ-3GPPCH-NB-01, REQ-3GPPCH-NB-02 and Key Issue #5a, Key Issue #5b, Key Issue #5c reuses the policy and charging control framework defined in TS 23.503 [3], TS 29.513 [15], TS 29.594 [16].\nThe PCF is configured with PCC Rules that include information for service data flow detection and charging information. The charging information includes Charging Key, Charging method, and Service Data flow handling while requesting credit (see TS 23.503 [3] table 6.3.1).\nThe CHF is configured with Rating Groups (corresponding to Charging Key) and policy counter information which includes Policy counter identifiers and statuses.\nThe PCF will use the Nchf_SpendingLimitControl_Subscribe for a specific SUPI to retrieve the initial status of the policy counters. Based on these statues, and their configured relationship with the charging keys if any, it may select PCC Rules or even update PCC Rules. It would then provide these to the SMF if requested.\nThe CHF will, based on Nchf_ ConvergedCharging requests and account balance changes, check if the status of the policy counters should be updated, if the statuses is changed it will use the Nchf_SpendingLimitControl_Notify to send the new status to the PCF, if the PCF have a subscription for the counters.\nOne policy counter identifier may be connected to one or more Rating Groups in the CHF, this connection is preferably mirrored in the PCF i.e., the policy counter identifier is relevant for one or more Charging Keys. The Charging Keys/Rating Groups, Policy Counter Identifiers, and Policy Counter Statuses need to be synchronized between the PCF and CHF. Since if any of these have different meanings in the PCF and CHF it will lead to issues e.g., if a Charging Key is defined in PCF but there is no rating for the Rating Group this will lead to faulty charging the same is applicable to the Policy counter identifiers and statuses which may lead to faulty PCC Rules being applied.\nThis means that the PCF can based on the policy counter status set the Service Data flow handling while requesting credit to either blocking or non-blocking in the PCC Rule applicable to a specific Charging Key. The CHF can have policy counter applicable to one or more Rating Groups, and the status can be based on the account balance status e.g., the account balance is near to the limit for a Rating Group.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.6\tEvaluation",
                            "text_content": "Solution #5.2, #5.3, #5.4 and #5.6 all solve key issue #5a, #5b and #5c.\n-\tSolution #5.2: allows the CHF to directly control the non-blocking mode, by introducing an attribute. This means that both PCF and CHF will control the non-blocking mode. The change of non-blocking mode can be per service data flow or per RG. The Validity Period of non-blocking mode change from CHF is per PDU session. When the new PDU session is established, the non-blocking mode will reuse the PCC rule from PCF which is not able to know the change from the CHF.\n-\tSolution #5.3: allows the CHF to indirectly control the non-blocking mode, by using the current policy counters. This means that only PCF will control the non-blocking mode, with input from CHF. The change of non-blocking mode can be per service data flow or per RG. The PCF can be able to know the change of non-blocking mode from the CHF dynamically.\n-\tSolution #5.4: the granularity of the control of non-blocking mode is per UE, not for special service data flow or per RG. The new type of Nchf_ SpendlingLimitControl service for spending limit should be supported. the controlling on the non-blocking mode need to add the new value of currentStatus to present that the non-blocking mode is the changing value (disable or enable) which is not specified in the standard.\n-\tSolution #5.6: reuses the current mechanism and by that the start of the service delivery does not need to wait the Charging Data Response from CHF. Keep alignment with the common service flow about non-blocking specified in the TS 32.290 [12]. No impact on the charging data request. A policy counter for spending limit may be connected to one or more Rating Groups in the CHF to support the control of non-blocking mode per service data flow or per RG. If control of the non-blocking mode from CHF is required a specific value of currentStatus to present the non-blocking mode is required. The currentStatus values is currently not specified. The CHF cannot be aware of the non-blocking mode, CHF provides the notification about the policy counter status for the PCF, which controls the non-blocking policy.\nSolution #5.1and #5.5 both solve key issue #5d.\n-\tSolution #5.1: keeps alignment with the Figure 5.3.2.3.2: SCUR - Session based charging with Decentralized and Centralized Unit Determination, Centralized Rating, immediate start of service delivery (non-blocking mode) specified in TS 32.290 [12], before sent the charging data request, the service delivery starts. A new indication is added in the charging data request. CHF may instruct to stop the service delivery based on the non-blocking mode awareness, not only for the disable/enable the non-blocking mode.\n-\tSolution #5.5: the start of the service delivery does not need to wait the Charging Data Response from CHF. Keep alignment with the common service flow about non-blocking specified in the TS 32.290 [12]. Needs to be combined with solution #5.1. New indication should be added in the charging data request. CHF may instruct to stop the service delivery based on the non-blocking mode awareness, not only for the disable/enable the non-blocking mode.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.7\tConclusions",
                            "text_content": "For key issues #5a, #5b and #5c, solution #5.6 with possible extension of #5.1 solution could be taken into normative work based requirements.\nFor key issue #5d, solution #5.6 doesn’t require any support, and solution #5.4 is outside the current scope of SA5.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tDocumentation improvements",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The charging management documentation is today organized according to TS 32.240 [5] with a set of domain/subsystem/service specific TSs covers the domains (CS, PS, 5GS), subsystem (IMS) and service (SMS, MMTel etc.) levels, respectively, in the TS 32.25x, TS 32.26x and TS 32.27x TS number ranges. Network Slicing is covered under TS 28-series. These TSs describe the mapping of the common architecture specified onto the specific domain/subsystem/service as well as the scenarios and information for converged charging that are specific to the domain/subsystem/service. They are commonly referred to as the middle tier charging TSs.\nA set of TSs in the TS 32.28x range covers common services, such as the Announcement service.\nA set of TSs in the TS 32.29x range covers common aspects, such as CDR parameter and syntax descriptions, converged charging applications, and the charging interactions between the network and the Billing Domain (CDR file transfer).\nThe complete document structure for these TSs is outlined in the following figure 6.1-1:\nThe figure depicts a charging specifications structure, illustrating the various components and their respective functions. It includes a detailed breakdown of the structure, highlighting the different types of specifications and their respective roles in the charging process. This structure is crucial for understanding the charging process and ensuring that all components are functioning correctly.\nFigure 6.1-1: Charging specifications structure\nThis means that all information elements are first specified in the middle tier charging TSs and then converted into the OpenAPI in TS 32.291 [6], ASN.1 in TS 32.298 [7] and Diameter in TS 32.299 [8]. In some case there are mapping between the middle tier charging TSs information element and one or more of the protocols.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.2\tUse cases",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tUse Case # 6a: The binding description",
                            "text_content": "Currently the Information Elements are described in the 5G service charging specifications (e.g., TS 32.254 [17], TS 32.255 [2], and TS 32.256 [18]), the CDR parameters in TS 32.298 [7] (ASN.1), and the resource attributes in the TS 32.291 [6] (OpenAPI). 3GPP The TS 32.291 [6] clause 7 \"Bindings of CDR field, Information Element and Resource Attribute\" contains the binding between the Information Element, Resource Attribute and CDR fields for 5G charging.\nThe Information Elements, CDR Fields and Resource Attributes are specified in the TS 32.291 [6] clause 7.\nThe CDR parameters (ASN.1) are specified in theTS 32.298 [7].\nThe data model and yaml are specified in the TS 32.291 [6].\nThis means that the link between 5G service charging specifications, CDR and OpenAPI is unclear.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tUse Case # 6b: The simplification of CDR records",
                            "text_content": "The TS 32.298 [7] provide the charging data record (CDR) parameters for GPRS charging, EPC charging and 5G charging, this means that it includes generic bearer level, subsystem level and CHF level CDR parameters.\nThe CHF CDR will contain service and the subsystem level CDR parameters in the same record type, and should be considered for optimization.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tUse Case # 6c: Common IEs applied in the service charging specifications",
                            "text_content": "TS 32.290 [12] clause 7 \"Message contents\" specifies the common information element structure specified. The 5G services charging specifications (e.g., TS 32.254 [17], TS 32.255 [2], and TS 32.256 [18]), references to the common information elements and provide the information about how these common information element are used and might extend or limit the use of these. The way these are reference and updated are today handled differently in the different 5G services charging specifications.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tKey issues",
                    "description": "",
                    "summary": "",
                    "text_content": "Key Issue #6a: clarify the binding for the CDR fields, CDR parameter, Information Elements and Resource Attributes\nKey Issue #6b: optimize the CHF CDR representation.\nKey Issue #6c: how to reference to the common information elements in the 5G service charging specifications\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.4\tSolutions",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4.1\tSolution #6.1: Binding in stage2 documents",
                            "text_content": "A possible solution for key issues 6a, clarification of binding.\nCurrently the Information Elements are described in the 5G service charging specifications (e.g., TS 32.254 [17], TS 32.255 [2], and TS 32.256 [18]), the CDR parameters in TS 32.298 [7] (ASN.1), and the Nchf attributes in the TS 32.291 [6] (OpenAPI).\n5G service charging specifications could provide binding between Information Elements, and both CDR parameters (ASN.1) and Nchf attributes and removing the binding from TS 32.291 [6].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.2\tSolution #6.2: Binding in TS 32.298",
                            "text_content": "A possible solution for key issues 6a, clarification of binding.\nThe TS 32.298 [7] provides binding between Information Elements, and CDR parameters (ASN.1).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.3\tSolution #6.3: Binding in TS 32.291 and TS 32.298",
                            "text_content": "A possible solution for key issues 6a, organization of OpenAPI and ASN.1.\nCurrently the Information Elements are described in the 5G service charging specifications (e.g., TS 32.254 [17], TS 32.255 [2], and TS 32.256 [18]) and the CDR parameters in TS 32.298 [7] (ASN.1), the Nchf attributes in the TS 32.291 [6] (OpenAPI).\nThe TS 32.298 [7] could provide binding between Information Elements and the CDR parameters (ASN.1), while the TS 32.291 [6] could provide binding between Information Elements and Nchf attributes (OpenAPI).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.4\tSolution #6.4: Separate the CHF CDR record in new TS",
                            "text_content": "A possible solution for key issues 6c, optimizing CHF CDR representation.\nSeparate the CHF CDR in TS 32.298 [7] into a new TS (e.g., TS 32.298-01 or new 32-series number), with a new top level structure for the ASN.1. The top level will be defined in work item.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.5\tSolution #6.5: Complete the Common IE applied",
                            "text_content": "A possible solution for key issue #6c.\nIn the service charging specifications, it copies all the common IEs specified in TS 32.290 [57] and describes whether to use (Described in TS 32.290 [57]) or not use (This field is not applicable.) in the service charging.\nTable 6.4.5-1: Message content structure\n\nFor example, expands all the sub-IEs in the second Layer and third layer which are used for the service charging.\nAdd the general principle in to the TS 32.290 [57] clause 7.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.4.5-1: Message content structure",
                                    "table number": 22,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.4.6\tSolution #6.6: Partial the Common IE applied",
                            "text_content": "A possible solution for key issue #6c.\nIn the service charging specifications, only expand the required layers of common IEs and describe whether to use (Described in TS 32.290 [57]) or not use (This field is not applicable.) in the service charging.\nTable 6.4.6-1: Message content structure\n\nIf all the sub-IEs compared to the upper level are the same (i.e. This field is not applicable or Described in TS 32.290 [57]) for the service charging, only show and refer to the upper level\n-\tTake the \"Requested Unit\" as the example, the sub-IEs (i.e. time, totalVolume, uplinkVolume, downlinkVolume and serviceSpecificUnits) are not applicable. In the table, only \"Requested Unit\" is described \"This field is not applicable\", without expand and show the sub-IEs, please see Table 6.4.6-1: Message content structure.\nIf partial sub-IEs compared to the upper level is different (even, only one sub-IEs), expand the upper layer, show and refer to the all sub-IEs and upper level.\n-\tTake the \"Requested Unit\" as the example, the sub-IEs (i.e. totalVolume, uplinkVolume, downlinkVolume and serviceSpecificUnits) are not applicable and the sub-IEs (i.e. time) refer to the TS 32.290 [57]. In the table, the\"Requested Unit\" includes all the sub-IEs should be described.\nTable 6.4.6-2: Example of Requested Unit\n\nIf special sub-IEs for the service charging should be added in the upper layer and partial sub-IEs compared to the upper level is different, refer to the upper layer with the need to expand the upper layer.\n-\tTake the \"Requested Unit\" as the example, the new sub-IEs (i.e. New xxx) are added and the all the sub-IEs are showed in the table to present its own description.\nTable 6.4.6-4: Example of Requested Unit for addition\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.4.6-1: Message content structure",
                                    "table number": 23,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.4.6-2: Example of Requested Unit",
                                    "table number": 24,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.4.6-4: Example of Requested Unit for addition",
                                    "table number": 25,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.4.7\tSolution #6.7: Binding in TS 32.291",
                            "text_content": "A possible solution for key issues 6a, clarification of binding.\nThe TS 32.291 [6] provides binding between Information Elements, and both CDR parameters (ASN.1) and Nchf attributes. The use of CDR filed would be discontinued.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.8\tSolution #6.8: Binding in new TS",
                            "text_content": "A possible solution for key issues 6a, clarification of binding.\nIntroduce a new TS only handling binding of the Information Elements to any other parameter, attribute, or field.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.9\tSolution #6.9: Separate the CHF CDR record in TS 32.298",
                            "text_content": "A possible solution for key issues 6c, optimizing CHF CDR representation.\nSeparate the CHF CDR information belonging to different 5G service charging specifications (e.g., TS 32.254 [17], TS 32.255 [2], and TS 32.256 [18]) into their own sections in TS 32.298 [7] e.g., PDU Session Charging Information could be in clause 5.2.5.2.2 in clause 5.2.5.2 “CHF CDRs”.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.10\tSolution #6.10: Only Applicable Common IEs",
                            "text_content": "A possible solution for key issue #6c.\nOnly the common IEs specified in TS 32.290 [57] which are applicable to this particular service charging TS are present the service charging specification table. The full sub-IEs layers are expanded to include the applicable sub-IEs.The table 6.4.10-1 is an example based on Table 6.4.5-1 applied with this solution:\nTable 6.4.10-1: Message content structure\n\nThe table 6.4.10-2 is an example based on Table 6.4.6-2 applied with this solution:\nTable 6.4.10-2: Requested Unit with only \"Time\" applicable\n\nThe table 6.4.10-3 is similar to Table 6.4.6-4 with a new common IE applicable to the service-specific TS, applied with this solution:\nTable 6.4.x-2: Requested Unit with addition\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.4.10-1: Message content structure",
                                    "table number": 26,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.4.10-2: Requested Unit with only \"Time\" applicable",
                                    "table number": 27,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.4.x-2: Requested Unit with addition",
                                    "table number": 28,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "6.5\tEvaluation",
                    "description": "",
                    "summary": "",
                    "text_content": "Solution #6.1, #6.2, #6.3, #6.7, and #6.8 all solve the key issue #6a:\n-\tSolution #6.1: adds the binding of the information to the stage 2 specifications and removing it from TS 32.291.\n-\tSolution #6.2: adds the binding of the CDR information to the TS 32.298.\n-\tSolution #6.3: adds the binding of the CDR information to the TS 32.298 and keeping it in TS 32.291, like solution #6.2.\n-\tSolution #6.7: requires enhancement to TS 32.291, by providing the binding between information elements, and both CDR parameters in ASN.1 and Nchf attributes in OpenAPI and removing the use of CDR field.\n-\tSolution #6.8: introduce a new TS to present the binding of information elements to any other parameter, attribute or field.\nSolution #6.4 and #6.9 solves the key issue #6b:\n-\tSolution #6.4: introduces a new TS for the CHF CDR information.\n-\tSolution #6.9 requires enhancement to TS 32.298, by providing sub-clauses for each 5G service level CDR information under the clause of CHF CDRs.\nSolution #6.5, #6.6 and #6.10 solve the key issue #6c:\n-\tSolution #6.5: propose the complete the common IE which specified in the TS 32.290 is applied in all service specifications. This will allow to clearly describe which IE is used or not used, as well as which IE is added for the special service. Requires that all service TSs must be updated if there is a change to any IEs in TS 32.290\n-\tSolution #6.6: only top-level the common IE, specified in the TS 32.290, is repeated in all service specifications. This requires rules for which IEs to add or not and it cannot clearly describe which IE is used or not used, as well as which IE is added for the special service. Requires that all service TSs must updated only if there is a change on the only top-level IEs TS 32.290 is updated.\n-\tSolution #6.x: in each service TS, only common IEs specified in the TS 32.290 which are applicable are present in the service TS table. Only service TSs impacted by change to IEs in TS 32.290 (i.e., new common IEs or removed common IEs which are applicable to the service) are affected.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.6\tConclusion",
                    "description": "",
                    "summary": "",
                    "text_content": "For key issue #6a, solution #6.3 is recommended into normative work, it has the least impact while still showing the mapping to ASN.1.\nFor key issue #6b, solution #6.4 is recommended into normative work, if there is a requirement to do a major change in the ASN.1 for other reasons then solution #6.9 should be considered.\nFor key issue #6c, solution#6.x is recommended for normative work, with the clarification in TS 32.290 [12] \"only common IEs which are applicable to the service middle tier TSs are present in the definition of Charging Data Request message contents of the middle tier TSs. Common IEs not present in this definition imply they are not applicable to the middle tier TS.\"\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "7\tConclusions and recommendations",
            "description": "At this time it is not recommended to introduce any of the conclusions outside the requirement from charging for a specific service i.e., the conclusions should only be used when action taken for other reason. The conclusions may be re-evaluated based on the specific service requirements.\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "",
                    "table number": 29,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        }
    ]
}