{
    "document_name": "23700-27-i00.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Report has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\tindicates that something is possible\ncannot\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The scope of this Technical Report is to study the following aspects of 5GS with satellite backhaul:\n1:\tArchitecture enhancements for support of a backhaul with changing delay (e.g. brought by ISL in satellite networks or changed satellite backhaul on the UP path), and possibly limited bandwidth in case of a gNB with satellite backhaul only (e.g. restricted by the maximum data rate of a satellite beam):\n-\tPolicy/QoS control enhancements based on the detected packet delivery latency and/or bandwidth of the satellite backhaul on the UP path;\n-\tExposure of backhaul information to AFs.\n2:\tArchitecture enhancements for support of UPF deployed on GEO satellite with gNB on the ground:\n-\tWhether and how to enable satellite edge computing services via UPF on-board e.g. to reduce the latency for data transmission, and minimize the backhaul resources consumption.\n-\tHow to enhance local switch for UEs in a communication when they are served by UPF on-board, e.g. to reduce end to end delay comparing with existing 5G LAN local switch at PSA on the ground.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[3]\t3GPP TS 23.502: \"Procedures for the 5G system, Stage 2\".\n[4]\t3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System\".\n[5]\t3GPP TR 23.737: \"Study on architecture aspects for using satellite access in 5G\".\n[6]\t3GPP TS 23.548: \"5G System Enhancements for Edge Computing; Stage 2\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms, symbols and abbreviations",
            "description": "This clause and its three (sub) clauses are mandatory. The contents shall be shown as \"void\" if the TS/TR does not define any terms, symbols, or abbreviations.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in TR 21.905 [1].\nDefinition format (Normal)\n<defined term>: <definition>.\nexample: text used to clarify abstract rules by applying them literally.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905 [1].\nAbbreviation format (EW)\n<ABBREVIATION>\t<Expansion>\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tArchitecture Assumptions",
            "description": "The 5GS architecture specified in TS 23.501 [2], TS 23.502 [3] and TS 23.503 [4] is used as a baseline.\nThe following architectural assumptions are applied to the study:\n-\tAt least UP backhaul connection of a gNB is over satellite link.\n-\tIf available bandwidth information is needed in dynamic satellite backhaul link cases, the bandwidth detection is performed by the transport network layer.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "5\tKey Issues",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tKey Issue #1: PCC/QoS control enhancement considering dynamic satellite backhaul",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.1.1\tDescription",
                            "text_content": "Satellite based backhaul is important for remote area or mission critical scenarios, in case it is not possible to build terrestrial backhaul connections.\nIn Release 17, a satellite backhaul category indication was defined to indicate the satellite backhaul information in. However, this indication may not enough if the satellite backhaul involves multi-hops of ISL or backhaul connections are over different satellites and terrestrial networks. In such case, the capabilities provided by the satellite backhaul can be changed/adjusted dynamically. For example, if inter-satellite links are used on the backhaul path, the delay and bandwidth of the backhaul may be impacted due to the traffic engineering on the links. Satellite backhaul category is not enough to describe such a dynamic satellite backhaul characteristics.\nTo better serve UEs connecting to 5GC via a gNB with satellite backhaul, the following topics are to be studied:\n-\tDetermination of packet delivery latency or bandwidth or both of the satellite backhaul on the UP path.\n-\tPolicy/QoS control enhancements based on the determined packet delivery latency or bandwidth or both of the satellite backhaul on the UP path.\n-\tWhat kind of backhaul information can be exposed to the AF, and how to perform the exposure?\n-\tWhether and how to solve packet out-of-sequence problems introduced by dynamic satellite backhaul.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.2\tKey Issue #2: Support of Satellite Edge Computing via UPF on board",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tDescription",
                            "text_content": "Whether and how to enable satellite edge computing services via UPF on-board e.g. to reduce the latency for data transmission, and minimize the backhaul resources consumption.\nNOTE:\tCoordination with CT4  may be done on aspects related to N4 association between the UPF on board and 5GC NFs on the ground.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tKey Issue #3: Support of Local Data Switching via UPF on-board",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tDescription",
                            "text_content": "How to support local data switch for UEs in a communication when they are served by UPF on-board, e.g. to reduce end to end delay comparing with existing 5G LAN local switch at PSA on the ground?\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tSolutions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.0\tMapping of Solutions to Key Issues",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 6.0-1: Mapping of Solutions to Key Issues\n\n",
                    "tables": [
                        {
                            "description": "Table 6.0-1: Mapping of Solutions to Key Issues",
                            "table number": 3,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.1\tDynamic delay solution",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1.1\tDescription",
                            "text_content": "In Rel-17 reference architecture specified in TS 23.501 [2] and TS 23.502 [3], the AMF is configured with the awareness of satellite backhaul categories as specified in clause 5.8.2.15 of TS 23.501 [2]. The AMF informs the SMF of satellite backhaul category that is being used when PDU session is established and after change or handover causing different backhaul connection to be used. In roaming case, the V-SMF relays the satellite backhaul category to H-SMF. The PCF is informed of satellite backhaul category as the SMF includes it SM Policy Association establishment. Based on this knowledge, the PCF can set the QoS policies accordingly.\nNOTE 1:\tFor a gNB that only has single type of satellite backhaul, the AMF detection of satellite backhaul is based on local configuration, e.g. based on AMF awareness of Global RAN Node ID.\nA gNB may have multiple candidate satellite backhaul on N2 and N3 interfaces, e.g. GEO satellite backhaul, LEO satellite backhaul, LEO satellite backhaul with ISL. The gNB uses a single satellite backhaul connection from the set of available candidate satellite backhauls for all UEs that the gNB is serving at any point in time. The following figure gives an example scenario:\nThe figure depicts a scenario where a gNB has multiple candidate satellite backhauls, illustrating the potential for redundancy and failover in a 5G network.\nFigure 6.1.1-1: Example scenario that gNB has multiple candidate satellite backhauls\nFor such scenario, the gNB may use different CP Transport Layer Information for different satellite backhaul on N2 interface. The AMF determines the Satellite backhaul category (i.e. GEO, MEO, LEO or OTHERSAT) based on local configuration gNB ID and CP Transport Layer Information used by the gNB on N2 interface.\nNOTE 2:\tIt is assumed that N2 and N3 interfaces of a gNB use the same satellite backhaul at a certain time.\nNOTE 3:\tFor the deployment that gNB use same CP Transport Layer Information for different satellite backhauls, it's assumed that the AMF will be updated by OAM with the latest satellite backhaul type of a gNB when the gNB switches to a different satellite backhaul.\nAwareness of QoS changes is needed to adapt this Rel-17 solution to the dynamic delay requirement in Rel-18. That awareness of variable delay can be obtained by re-using the capability for the SMF to request QoS monitoring from the UPF that is specified in clause 5.33.3.3 of TS 23.501 [2]. The SMF can be configured to request QoS monitoring depending on the satellite backhaul type category signalled from AMF e.g. for GEO but not LEO, the UE location and also be configured to request (again) QoS monitoring based on certain triggers e.g. time related or UE location related.\nIn addition to the already specified use cases where the SMF informs the PCF of the satellite category, the SMF needs to be enhanced to measure the N3 using the echo procedure and to inform the PCF of not only satellite category but also the observed delay.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.2\tHigh level architecture principles",
                            "text_content": "Figure 6.1.2-1 shows the call flow that will say the following:\nThe figure depicts a dynamic delay monitoring and QoS adaptation system, illustrating how it adjusts the delay and quality of service (QoS) based on the network conditions. The system uses a combination of delay-sensitive and delay-insensitive mechanisms to ensure optimal performance.\nFigure 6.1.2-1: Dynamic delay monitoring and QoS adaptation\n1.\tDuring PDU session establishment, PDU session modification or handover that leads to NG-RAN with different backhaul category, the AMF determines the satellite backhaul category based on configuration.\n2.\tThe AMF informs the SMF of satellite backhaul by including the Satellite Backhaul Category in Nsmf_PDUSession_CreateSMContext or in Nsmf_PDUSession_UpdateSMContext message as specified in clause 4.3.2.2 of TS 23.502 [3].\n3.\tSMF responds by Nsmf_PDUSession_CreateSMContext Responsed message or Nsmf_PDUSession_UpdateSMContext Response.\n4.\tSMF informs PCF of the satellite backhaul by including Satellite Backhaul Category in Npcf_SMPolicyControl_Create Request during SM Policy Association Establishment as specified in clause 4.16.4 of TS 23.502 [3] or Npcf_SMPolicyControl_Update Request during SM Policy Association Modification as specified in clause 4.16.5 of TS 23.502 [3].\nThe PCF takes the policy decision based on the information that it has received so far but at this point, the PCF is not yet aware of any dynamic changes in the observed backhaul delay.\nBased on the Satellite Backhaul Category, the PCF may indicate SMF to activate QoS monitoring in the PCC rules.\n5.\tSince SMF knows based on indication received from the AMF in step 2 that satellite backhaul is used, and/or based on the received PCC rules, the SMF initiates GTP-U path monitoring as specified in clause 5.33.3.3 of TS 23.501 [2], no matter whether the GTP-U path is over a satellite backhaul with dynamical delay.\nNOTE 1:\tThe SMF need not request echo procedure for every PDU session of every UE that are served by the same gNB.\n6.\tSMF receives GTP-U path monitoring results indicating the observed delay.\n7.\tUpon receiving the observed delay from the UPF in step 6, the SMF initiates SM Policy Association Modification in order to inform the PCF of the Satellite Backhaul Category and (optionally) the observed delay. The SMF may be configured with margins of the observed delay to determine the actualSatellite Backhaul Category in use to report to PCF.\n8.\t[Conditional] The SMF may inform the CHF of the Satellite Backhaul Category and the observed delay. This information may be used for charging, network statistics and sorting out customer complaints. This step is asynchronous and the SMF can initiate it at any time after having received the delay information at step 6.\nNOTE 2:\tStep 8 can be supported in stage 3 using Charging Data Request / Charging Data Response message.\n9.\tPCF adjusts the QoS policy according to the observed N3 delay. PCF may need to report the delay or Satellite Backhaul category or both to AF for application specific reasons.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.3\tImpacts on services, entities and interfaces",
                            "text_content": "This solution impacts the following system entities.\nSMF:\n-\tCapability to trigger GTP-U path monitoring when satellite backhaul is used.\n-\tCapability to report the observed delay resulting from GTP-U path monitoring to CHF.\nPCF:\n-\tIf observed delay is reported from SMF, PCF needs to have the capability to receive observed delay and to take it into account for policy control decisions.\nIt is assumed that OAM can provide the AMF with the satellite backhaul type used between a gNB and the AMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2\tSolution for KI#1: QoS control enhancements for dynamic satellite backhauling",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tDescription",
                            "text_content": "In Rel-17, only a single satellite backhaul category refers to the type of the satellite (i.e. GEO, MEO, LEO or OTHERSAT) can be indicated.\nIn Rel-18, the multi-hops ISL or multi-types of backhaul will be considered, for example, as shown in the Figure 6.2.1-1, a gNB may have UP connections each of which is over different satellites. Before establishing UP connection of the PDU session, the AMF may not know what kind of satellite backhaul is used to serve the PDU session. In such case, only a single satellite backhaul category is not enough to describe the dynamic satellite backhaul characteristics.\nThe figure depicts a 5G network with a gNB (gNB) having multiple satellite backhaul connections, illustrating the multi-path signal propagation in a 5G network. The diagram highlights beamforming techniques to mitigate interference, with key components including the base station (gNB), user equipment (UE), and scatterers.\nFigure 6.2.1-1: gNB has multiple satellite backhaul UP connections\nMoreover, due to dynamic satellite network topology and distinguished transmission capabilities provided by different type of satellites, statically configured QoS parameters for the PDU session may not always be suitable. Therefore, the QoS control for the case of satellite backhaul needs to be enhanced.\nIn addition, since the backhaul information (e.g. backhaul delay, backhaul category) can be changed/ adjusted dynamically, the AF may request the backhaul information for application layer optimization or adjustment.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tProcedures",
                            "text_content": "Figure 6.2.2-1 shows the procedure of the PDU session establishment when gNB has multiple satellite backhaul UP connections.\nThe figure depicts a PDU session establishment scenario in a 5G network, where multiple satellite backhaul connections are present. The diagram illustrates the process of establishing a PDU session, with the gNB (gNB-1) having multiple satellite backhaul connections (UP connections) to the same satellite (UP-1). This setup allows for efficient data transmission and ensures reliable connectivity for the gNB-1.\nFigure 6.2.2-1: PDU session establishment when gNB has multiple satellite backhaul UP connections\n1.\tThe UE initiates the PDU Session Establishment procedure by invoking the PDU Session Establishment Request as specified in clause 4.3.2.2 of TS 23.502 [3].\n2.\tThe AMF selects the SMF/I-SMF as specified in clause 6.3.2 of TS 23.501 [2] and clause 4.3.2.2.3 of TS 23.502 [3]. The AMF determines the satellite backhaul information based on the RAN ID or the configuration.\nIf the AMF is aware that more than one type of the backhaul networks (e.g. multi-types of satellites or multi-hops of ISL) can be used by the serving gNB, or different backhaul networks can be used in the CP and the UP at the same time or in the UP only, the AMF may invoke Nsmf_PDUSession_CreateSMContext Request to inform the SMF of the satellite backhaul information indicating dynamic satellite backhaul in use.\n3.\tSMF informs the PCF of the satellite backhaul information by including \"dynamic satellite backhaul in use\" indication in Npcf_SMPolicyControl_Create Request during SM Policy Association Establishment as specified in clause 4.16.4 of TS 23.502 [3].\n4.\tBased on the indication, the PCF generates PCC rules suitable for satellite backhaul, where the PCC rules indicate to activate QoS monitoring. In addition, if downgraded QoS requirements are allowed, the PCF may also provide Alternative QoS Profile for downgraded QoS requirements.\n5.\tThe SMF selects the candidate UPF(s) as specified in clause 6.3.3 of TS 23.501 [2]. Based on the received PCC rules, the SMF requests to activate QoS monitoring for the GTP-U path(s) between at least one of the candidates UPF(s) and the (R)AN serving the UE via N4 Association Update Request.\nNOTE:\tthe SMF determine the gNB serving the UE based on the ULI.\nIt is assumed that the SMF is configured with GTP-U IP addresses per gNB ID.\n6.\tThe candidate UPF(s) confirm to perform the GTP-U path monitoring.\n7.\tIf a candidate UPF doesn't activate QoS monitoring for the GTP-U path already, it sends an Echo Request message to the gNB.\n8.\tThe gNB responds an Echo Response message.\n9.\tThe candidate UPF(s) sends the QoS monitoring results to the SMF.\n10.\tUpon receiving the QoS monitoring results from the UPF(s) in step 7, the SMF selects the suitable I-UPF and/or PSA UPF, e.g. a UPF with the minimum backhaul latency.\nBased on the received QoS monitoring results, the SMF may determine to apply the QoS profile for downgraded QoS requirements, or initiate an SM Policy Association Modification procedure.\nThe SMF may also report the QoS monitoring results to the PCF periodically or by event triggered (e.g. the change of latency is over the threshold). In addition, the SMF may indicate the bandwidth on the N3 interface between the gNB and the selected UPF to the PCF, where the bandwidth is obtained from the satellite system using implantation method, i.e. the interaction between SMF and satellite system will not be standardized in this release.\n11.\tComplete the follow-up PDU session establishment process with the existing steps as specified in clause 4.3.2.2 of TS 23.502 [3].\n12.\tThe AF may request to obtain the satellite backhaul information for an AF session using Nnef_AFsessionWithQoS_Create request message (satellite backhaul information) to the NEF, e.g. when the AF would like to adjust data transmission strategy.\n13.\tThe NEF authorizes the AF request and interacts with the PCF to obtain the satellite backhaul information by invoking Npcf_PolicyAuthorization_Create Request.\nIf the AF is considered to be trusted by the operator, the AF uses the Npcf_PolicyAuthorization_Create request message to interact directly with PCF to request satellite backhaul information for an AF session.\n14.\tThe PCF exposes the satellite backhaul information (e.g. backhaul delay and/or bandwidth) to the NEF by reporting QoS Monitoring information.\n15.\tThe NEF exposes the satellite backhaul information to the AF.\nIf the AF is considered to be trusted by the operator, the PCF sends the Npcf_PolicyAuthorization_Create response message (satellite backhaul information) directly to AF.\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tImpacts on services, entities and interfaces",
                            "text_content": "This solution impacts the following system entities.\nAMF:\n-\tCapability to determine dynamical satellite backhaul in use;\n-\tCapability to send the satellite backhaul indication to the SMF.\nSMF:\n-\tCapability to trigger GTP-U path monitoring when satellite backhaul is used.\n-\tCapability to report the QoS monitoring results from GTP-U path monitoring to PCF.\n-\tConfigured with GTP-U IP addresses per gNB ID\nPCF:\n-\tCapability to receive satellite backhaul UP information and to take it into account for policy control decisions.\n-\tCapability to expose dynamical satellite backhaul information to the NEF.\nAF:\n-\tCapability to request dynamical satellite backhaul information\nNEF:\n-\tCapability to expose dynamical satellite backhaul information\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tSolution for Key Issue #1: Information of satellite constellation and change of backhaul delay exposed to PCF/AF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tDescription",
                            "text_content": "If the satellite backhaul involves multi-hops of ISL, in some cases, the propagation delay of backhaul paths may change dramatically with the movement of satellite and such kind of change normally be periodic and can be well predicated based on the operation information of satellite constellation.\nIf a polar-orbit satellite constellation is used and it does not support cross-seam ISLs, the backhaul delay may change dramatically when cross-seam transits or leave. If cross-seam ISLs are supported, there will be frequent ISL handover with the movement of satellites on the different side of the cross-seam, the backhaul delay may not change dramatically, but the delay jitter will be larger due to the frequent handover of ISL.\nAs the cross-seam transit may last for minutes or even hours (dependent on density of the satellites orbits in the constellation and location of gNB and 5GC), it is worthwhile to report such kind of predictable and crucial event and its lasting time to PCF/AF, e.g. to help them understand that the dramatic packet latency/jitter increase is inevitable over a period time, then AF may start to perform application layer coding compensation or PCF may make a firm decision to release the PDU session if the QoS requirement is not satisfied.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tProcedures",
                            "text_content": "The figure depicts a satellite constellation with its information and the change in backhaul delay exposed to the PCF/AF. The constellation is represented by a star-like pattern, with each star representing a satellite. The backhaul delay is shown as a line graph, illustrating the variation in delay between satellites. The figure is significant in understanding the satellite constellation's performance and the impact of the PCF/AF on the backhaul delay.\nFigure 6.3.2-1: Information of satellite constellation and change of backhaul delay exposed to PCF/AF\n1.\tAMF reports the satellite constellation information to PCF/AF during the PDU session establishment procedure. Besides the satellite backhaul category indication, AMF also reports the satellite constellation information including 'LEO or MEO polar-orbit satellite constellation with or without cross-seam ISLs supported', if multi-hops of ISLs are involved by a polar-orbit satellite constellation. AMF determines the Satellite constellation information based on local configuration using the same mechanism as defined in TS 23.501 [2], i.e. based on local configuration, for example based on Global RAN Node IDs associated with satellite backhaul.\n2.\tIf satellite backhaul with LEO or MEO polar-orbit satellite constellation information is received, AF/PCF requests report of backhaul delay change information based on PCRT mechanism as described in clause 6.1.3.18 of TS 23.503 [4].\n3-4.\tBased on satellite operation information which is a timer including the time when cross-seam transit or leave event starts and stops, AMF determines that backhaul delay will change and reports the delay change information (the time of the event is expected to last) to PCF/AF based on PCRT mechanism as described in clause 4.16.5.1 of TS 23.502 [3] AMF utilizes the Nsmf_PDUSession_UpdateSMContext service to report the delay change information to SMF.\nNOTE:\tAMF can obtain the satellite operation information by local configuration or from a satellite operation centre outside the 3GPP domain.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.3\tImpacts on services, entities and interfaces",
                            "text_content": "This solution impacts the following system entities.\nAMF:\n-\tCapability to report polar-orbit satellite constellation information.\n-\tCapability to determine and report of duration time of cross-seam transit or leave event of polar-orbit satellite constellation to PCF and AF via SMF.\nSMF:\n-\tReceive the satellite constellation information and duration time of cross-seam transit or leave event from AMF and report it to PCF/AF.\nPCF/AF:\n-\tCapability to ask report of backhaul delay change information if polar-orbit satellite constellation information received.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tSolution for Key Issue #2 and Key Issue #3: Enable Satellite Edge Computing or local data switching via on-board UPF acting as UL CL/BP and local PSA",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4.1\tDescription",
                            "text_content": "This solution corresponds to KI#2 and KI#3.\nUE establishes a PDU Session with PSA on ground via GEO satellite backhaul. SMF needs to:\n1)\tdetermine whether to insert a UL CL/BP on the GEO UPF; and\n2)\tobtain the target IP of traffic to be local routed to configure the traffic steering rule to the GEO UPF (UL CL/BP/local PSA).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.2\tProcedures",
                            "text_content": "Figure 6.4.2-1 shows the procedure to enable satellite edge computing or local data switching via on-board UPF acting as UL CL/BP and local PSA.\nFigure 6 illustrates the GEO satellite edge computing system, showcasing the integration of on-board uplink and downlink (UPF) processing units. The figure demonstrates the satellite's ability to process data in real-time, enabling efficient and reliable edge computing capabilities.\nFigure 6.4.2-1: Enabling GEO satellite edge computing via on-board UPF\n0.\tDuring PDU Session establishment procedure, the AMF determines the GEO satellite ID serving the UE as backhaul and send the GEO satellite ID to the SMF in Nsmf_PDUSession_CreateSMContext Request.\nIf multiple candidate satellite backhaul co-existed for the RAN, AMF uses mechanisms defined in clause 6.1.1 (e.g. determining whether GEO satellite is used based on CP Transport Layer Information or OAM configuration) to judge whether/which GEO satellite is used.\nThe SMF registers the UE IP/DNN and the DNAI to the UDM when invoking Nudm_UECM_Registration service operation.\nNOTE 1:\tIt is assumed that the AMF can determine the GEO satellite ID for the notification to the SMF based on local configuration, e.g. based on Global RAN Node IDs associated with satellite backhaul.\n1.\tSMF determines to insert GEO UPF as UL CL/BP and local PSA with the following triggers:\n1a.\t(For edge computing case) During the PDU Session establishment procedure, SMF determines the UE traffic can be local routed at a DNAI assigned to the GEO satellite based on the following information:\n1)\tUE location;\n2)\tGEO satellite ID;\n3)\tthe existing policy from PCF based on AF influenced information on what DNAIs the UE can access to;\n4)\tEAS Deployment Information.\n5)\tMapping relationship between DNAI and corresponding GEO satellite ID, as configured on SMF.\nSMF determines the traffic steering rules based on the IP range of the EAS deployed on the GEO UPF.\n1b.\t(For UE-to-UE case) AF initiates UE-to-UE communication for two UEs by providing UE ID/IPs of both UEs to the SMF.\nNOTE 2:\tAF might be triggered by application layer negotiation which is not in the scope of this study.\nThe SMF derives the DNAI corresponding to the GEO satellite based on the SMF configuration and the GEO satellite ID received from AMF. The SMF determines two UEs are under the same DNAI.\nIf the same SMF is used for the two UEs, the SMF determines whether two UEs are under the same DNAI based on stored correlation between the DNAI and UE IP/DNN.\nIf different SMFs are used for two UEs, the SMF checks whether the two UEs are served by the same DNAI via UDM. The SMF retrieves DNAI from UDM based on the IP/DNN of the peer UE and checks whether the two UEs are served by the same DNAI of the GEO UPF.\nNOTE 3:\tNew Nudm_UECM service operation is needed to get DNAI of the peer UE using UE IP/DNN as the input.\nWhen one UE quits the UE-to-UE communication, the SMF is notified by the AF. The SMF initiates PDU Session Modification procedures for both of the UEs to update the traffic steering rules or release the UL CL/BP/local PSA.\nSMF determines traffic steering rules for the two UEs based on the target UE IP.\n1c.\t(For edge computing and UE-to-UE case) UE sends UL packet to PSA UPF on ground. The PSA UPF on ground reports related information, e.g. FQDN in DNS query as described in clause 6.2.3 of TS 23.548 [6] or target IP, to SMF.\nFor edge computing case, the SMF determines UE is accessing local services via the DNAI based on mechanisms described in clause 6.2.3 of TS 23.548 [6].\nFor UE-to-UE case, the SMF determines the two UEs, i.e. the source UE and the target UE, are under the same GEO satellite.\nSMF determines traffic steering rules based on the target IP address detected and reported by the PSA UPF.\nNOTE 4:\tFor step 1a/1b/1c, a DNAI value needs to be assigned by the operator to each GEO satellite. After step 1a/1b/1c, DNAI value will be used instead of GEO Satellite ID, so that existing UPF selection and other EC procedures can be reused to support the local routing on the GEO satellite.\n2.\tSMF selects and inserts the GEO UPF as UL CL/BP and local PSA and sends traffic steering rules to the GEO UPF.\nFor edge computing case, the traffic steering rules indicate the ULCL/BP to perform local routing for the packets targeting the EC services via the DNAI.\nFor UE-to-UE case, the traffic steering rules indicate the ULCL to perform local routing for the packets to the target UE.\nIf the GEO satellite does not server the UE anymore due to e.g. UE mobility, the AMF will trigger PDU Session Modification procedure to update the SMF with new (or none) GEO satellite ID/backhaul category. Then the SMF will reconfigure the user plane based on the updated backhaul information as described in step 1 and 2. This may cause ULCL/BP insertion/relocation or removal.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.3\tImpacts on services, entities and interfaces",
                            "text_content": "AF:\nFor UE-to-UE case:\n-\tProvide/Update UE ID/IP for UE-to-UE communication to the SMF.\nAMF:\n-\tDetermines GEO Satellite ID based on local configuration and RAN ID and provides to SMF during PDU Session Establishment/Modification procedures.\nSMF:\n-\tReceives GEO Satellite ID from AMF during PDU Session Establishment/Modification procedures.\n-\tBe configured by the operator a DNAI value for each GEO satellite.\n-\tDerives the DNAI value based on the configuration and the GEO satellite ID received from AMF.\nFor UE-to-UE case:\n-\tDetermine whether local data switching should be performed for UEs served by same GEO satellite based on AF request or PSA UPF reporting.\n-\tInteract with UDM to store DNAI and UE IP/DNN. Check whether two UEs are served by same DNAI in case of different SMFs serving UEs in communication.\nUDM:\nFor UE-to-UE case, when different SMFs are used:\n-\tReceive and store DNAI and UE IP/DNN from SMF.\n-\tProvide DNAI query service based on UE IP/DNN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tSolution for KI#2: Support of Satellite Edge Computing via UPF on board",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tDescription",
                            "text_content": "As stated in TS 23.548 [6]:\n\"The Edge Computing enables operator and 3rd party services to be hosted close to the UE's access point of attachment, so as to achieve an efficient service delivery through the reduced end-to-end latency and load on the transport network\".\nIn Rel-18, in order to enable GEO satellite edge computing, a UPF can be deployed on the satellite. The following figure shows the high level architecture of the Satellite Edge Computing via UPF on board.\nThe figure depicts a satellite edge computing system utilizing a Universal Platform Function (UPF) on a board, illustrating the integration of satellite communication with edge computing. The system includes a satellite, a satellite edge computing unit (SECU), and a communication interface (CI). The figure highlights the importance of satellite communication in edge computing, emphasizing its role in providing low latency and high bandwidth services.\nFigure 6.5.1-1: Satellite Edge Computing via UPF on-board\nBased on the existing Edge Computing(EC) specification, for providing the application service timely, the Edge Application Servers(EAS) can be deployed on-board and connected to the UPF on-board via a N6 interface. As specified in clause 6.2.3 of TS 23.548 [6], in order to start the EC application service, the UE can initiate the EAS discovery procedure which can discover the IP address(es) of the EAS using Domain Name System (DNS). Therefore, if the EAS can be selected by the UE, the UPF on-board can also be selected to support the Satellite Edge Computing service.\nAs specified in clause 5.2.1 of TS 23.548 [6], the Edge DNS Client (EDC) functionality in UE ensures that DNS requests from applications are sent to the DNS Server's (e.g. EASDF/DNS resolver) IP address received from the SMF and can ensure the usage of the EAS discovery procedure. If a UE without EDC functionality, it can also use the EAS (re-)discovery functionalities provided by EASDF but cannot be ensured. As specified in clause 5.1.1 of TS 23.548 [6], according to the instruction from the SMF, the Edge Application Server Discovery Function (EASDF) can forward the DNS messages to the DNS server which can resolve the IP address(es) of the EAS. Due to the SMF and the DNS server are all deployed on the ground, the EASDF can also be deployed on the ground.\nAs specified in clause 6.2.3.2 of TS 23.548 [6], due to the IP address(es) of the EAS needs to be resolved by the DNS server that is on the ground first, a PDU session with the UPF on the ground needs to be established. Then, based on the UE's subscription data, UE location, the information from Application Function (AF), the EAS information reported from EASDF, the SMF may select the target DNAI and trigger UL CL/BP and L-PSA insertion.\nFor the Satellite Edge Computing case, the SMF has to select a UL CL/BP and a L-PSA on the satellite serving a gNB, e.g. taking the identity of the satellite serving the gNB into account to select a UPF on-board.\nAs specified in clause 5.13 of TS 23.501 [2], the UPF can be selected by the SMF based on the DNAI. The DNAI may correspond to multiple UPFs on-board. However, the satellites that deploying the selected UPF may not be able to provide the satellite backhaul service to the gNB serving the UE.\nThe connectable gNB IDs/IPs are proposed to be included in the UPF profile. Based on the UPF profile and the gNB serving the UE, the SMF can select the UPF on-board that can provide the satellite backhaul service to the gNB serving the UE.\nWhen a GTP-U path is activated (echo request/response) between gNB and UPF on-board, the UPF on-board can know the gNB IP address. If UPF profile includes gNB ID, then the UPF on-board needs to be configured with the mapping between gNB ID and the gNB IP, so that the UPF can report gNB ID to the SMF via N4 node level procedure, e.g. N4 report procedure. The UPFs are assumed to be configured with the possible gNB IP addresses so that UPF can initiate GTP-U path monitoring towards this gNBs using echo request/response.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tProcedures",
                            "text_content": "Figure 6.5.2-1 shows the procedure of EAS(UPF on-board) discovery procedure with EASDF.\nThe figure depicts the EAS(UPF on-board) discovery procedure with EASDF, illustrating the steps involved in identifying and configuring an EAS(UPF) on a device. The figure includes a schematic representation of the EAS(UPF) on-board, with various components such as the EASDF, EAS, and the device's firmware. The figure also includes a flowchart to guide the user through the process, with arrows indicating the sequence of steps. The figure is essential for understanding the EAS(UPF) on-board discovery process and its components, as well as for troubleshooting and configuration.\nFigure 6.5.2-1: EAS(UPF on-board) discovery procedure with EASDF\n0.\tDuring the procedure of NG setup, the gNB may inform the AMF of satellite backhaul information and the gNB ID.\n1.\tThe UE initiates the PDU Session Establishment procedure by invoking the PDU Session Establishment Request as specified in clause 4.3.2.2 of TS 23.502 [3]. If the AMF is aware that the serving gNB uses satellite backhaul UP connections, the AMF invokes Nsmf_PDUSession_CreateSMContext Request to send satellite backhaul UP connections information and the gNB ID. The SMF retrieves the UE subscription information from the UDM (which may optionally include an indication on UE authorization for EAS discovery via EASDF) and checks if the UE is authorized to discover the EAS via EASDF. If not authorized, this procedure is terminated.\n2.\tBased on the UE subscription information, the SMF selects EASDF as described in clause 6.3 of TS 23.501 [2].\n3.\tThe SMF invokes Neasdf_DNSContext_Create/Update Request (UE IP address, SUPI, DNN, notification endpoint, (DNS message handling rules)) to the selected EASDF as specified in clause 6.2.3.2.2 of TS 23.548 [6].\n4.\tThe EASDF invokes Neasdf_DNSContext_Create/Update Response (IP address of the EASDF) to the SMF.\n5.\tThe Application in the UE uses the EDC functionality as described in clause 6.2.4 of TS 23.548 [6] sends the DNS Query to the EASDF.\n6.\tThe EASDF handles the DNS Query message received from the UE as specified in clause 6.2.3.2.2 step 12 of TS 23.548 [6].\n7.\tThe EASDF sends the EAS IP addresses which are determined by the DNS system to the SMF as specified in clause 6.2.3.2.2 of TS 23.548 [6].\n8.\tThe SMF selects a UL CL/BP and Local PSA on-board.\nBased on the EAS information received from the EASDF, UPF selection criteria, and possibly Service Experience or DN performance analytics for an Edge Application, the SMF may determine the DNAI and determine the associated N6 traffic routing information for the DNAI.\nThe SMF may utilize the NRF to obtain the UPF profile(s), or, the SMF may obtain the UPF profile(s) from the UPFs associated with the DNAI via N4 node level procedure, e.g. N4 report, where each UPF profile includes one or more gNB IDs/IPs which is connecting with the UPF on-board. Based on the UPF profile and the gNB ID received from the AMF, the SMF determines the UL CL/BP and Local PSA on-board.\nNOTE:\tThe UL CL/BP and L-PSA on the satellite are combined in this release of the specification.\n9.\tThe SMF inserts UL CL/BP and Local PSA as described in TS 23.502 [3].\n10.\tThe EASDF sends the DNS Response(s) to the UE if it is indicated to send the buffered DNS response(s) to UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tImpacts on services, entities and interfaces",
                            "text_content": "This solution impacts the following system entities.\nSMF:\n-\tCapability to determine UL CL/BP and Local PSA on-board which has connection with the gNB serving the UE.\nUPF:\n-\tConfigure the connectable gNB ID list or gNB IP range in the UPF profile.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.6\tSolution for Key Issue #2 and Key Issue #3: Enable on-board EC or local data switch based on GEO PSA UPF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tDescription",
                            "text_content": "This solution resolves the Key Issue #3 to support local data switch for UEs in a communication when they are served by PSA UPF on-board. This solution also resolves the Key Issue #2 to support satellite edge computing via PSA UPF on board.\nFor the case a UE communicates with another UE directly via 5GC without preconfigured VN Group association, e.g. via point-to-point application and protocols, the existing 5G LAN local switch cannot be reused. In this case, especially for the scenario that UPF is deployed on GEO satellite with gNB on the ground, on-board local data switch would be very beneficial to reduce end-to-end latency. This solution proposes a UPF-level session based approach to support local data switch.\nIn this solution, the on-board UPF is a PSA UPF and it is assumed that a single SMF is used. UE establishes a PDU Session with the GEO UPF acting as PSA.\nUE initiates PDU Session Establishment procedure based on URSP rules and sends DNN/S-NSSAI to AMF as described in clause 4.3.2 of TS 23.502 [3]. SMF selects GEO UPF as the PDU Session anchor based on the DNN/S-NSSAI sent by AMF. PCF determines the URSP rules based on GEO satellite backhaul category from AMF and send it to the UE including DNN/S-NSSAI for services deployed in GEO satellite or UE-to-UE services. The N4 rules of the UPF-level session applies to the DNN/S-NSSAI.\nAfter the PDU Session Establishment, the UE can access to the edge computing services deployed on the satellite via normal N6 routing.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.2\tProcedures",
                            "text_content": "To support UE-UE local data switch via UPF on board, the following procedure is performed:\nThe figure depicts a high-level procedure for a session solution in the UPF-level N4 protocol, illustrating the steps involved in establishing a session between two devices. The figure includes a flowchart, which outlines the sequence of actions and decisions that need to be taken to ensure a successful session. The use of arrows and labels helps to visually represent the flow of information and the decision-making process, making it easier to understand the process. The figure is a valuable tool for understanding the high-level procedure and can be used to guide the development of a similar solution in a real-world scenario.\nFigure 6.6.2-1: High-level procedure for UPF-level N4 session solution\n1.\tThe SMF gets all on-board UPFs' address pools information per DNN and creates address mapping information based on these on-board UPFs' address pools information. The address mapping information is for traffic routing between on-board UPFs. The address mapping information includes UE IP address range and next UPF information corresponding to the address range.\n2.\tThe SMF creates a UPF-level N4 session on the on-board UPFs, i.e. UPF1 and UPF2. During the corresponding UPF-level N4 sessions establishment, the SMF provides N4 rules, which including several PDR and FAR pairs.\nOne PDR and FAR pair includes:\n-\ta PDR detecting that the destination address is in the current UPF address pool; and\n-\ta FAR instructing the UPF to forward the traffic to the UPF internal interface.\nOne PDR and FAR pair per UPF (excluding current UPF) includes:\n-\ta PDR detecting that the destination address is in the another UPF address pool; and\n-\ta FAR instructing the UPF to add an outer header (e.g. address information of next UPF) and forward the traffic to the next UPF.\n3.\tThe UE1, UE2 and UE3 establish PDU sessions. The UE1 and UE2 are served by UPF1. The UE3 is served by UPF2. During corresponding N4 sessions establishment, the SMF provides N4 rules to instruct the UPF forwarding the user plane packet from UPF internal interface to the target UE.\nDuring the PDU Session Establishment procedure, AMF determines the ID of GEO Satellite serving the UE as backhaul and sends the GEO satellite ID to the SMF in Nsmf_PDUSession_CreateSMContext Request. The SMF derives the DNAI corresponding to the GEO satellite based on the SMF configuration and the GEO satellite ID received from AMF. SMF selects on-board UPF corresponding to the DNAI. This is same as solution #4.\nNOTE 1:\tIt is assumed that the AMF can determine the GEO Satellite ID for the notification to the SMF based on Global RAN Node IDs associated with satellite backhaul, same as Solution #4.\n4.\tThe UE1 sends data to the UE2. Upon receipt of a user plane packet, the UPF1 forwards the packet based the UPF1 address pool and the destination address of the packet. The UPF1 handles the packet as follows:\n-\tidentify the UPF-level N4 session is the first N4 session to which the packet corresponds;\n-\tdetermines that the destination address is in the UPF1 address pool and then forward the packet to the UPF internal interface;\n-\tthe packet will match the N4 session corresponding to the UE2's PDU session; and\n-\tthe packet is then forwarded to the UE2.\n5.\tThe UE1 sends data to the UE3. Upon receipt of a user plane packet, the UPF1 forwards the packet based the UPF1 address pool and the destination address of the packet. The packet would be handled as follows:\n-\tthe UPF1 identifies the UPF-level N4 session is the first N4 session to which the packet corresponds;\n-\tthe UPF2 determines that the destination address is out of the UPF1 address pool and then forwards the packet to UPF2 based on the address mapping information in the corresponding FAR, in which case the destination address is in the address range of one term of address mapping information and the corresponding next UPF is the UPF2; and\n-\tthe UPF2 identifies the UPF-level N4 session is the first N4 session to which the packet corresponds;\n-\tthe UPF2 determines that the destination address is in the UPF2 address pool and then forward the packet to the UPF internal interface;\n-\tthe packet will match the N4 session corresponding to the UE3's PDU session; and\n-\tthe packet is then forwarded to the UE3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.3\tImpacts on services, entities and interfaces",
                            "text_content": "This solution impacts the following system entities.\nAMF:\n-\tSend satellite backhaul category to PCF.\n-\tDetermine GEO Satellite ID based on local configuration and RAN ID, and provide it to SMF during PDU Session Establishment/Modification procedures, same as Solution #4.\nPCF:\n-\tDetermine UE policy based on satellite backhaul category.\nThe following impacts are for UE-to-UE local data switch only:\nSMF:\n-\tRequest UPF to establish UPF-level N4 session.\n-\tProvide UPF N4 rules to enable local data switch.\n-\tSelect on-board UPF corresponding to the DNAI mapped from GEO satellite ID, same as Solution #4.\nUPF:\n-\tEstablish a UPF-level N4 session.\n-\tImplement local data switch based on received N4 rules.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tSolution for KI#3: Support of Local Data Switching via UPF on board",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.7.1\tDescription",
                            "text_content": "As specified in TS 23.501 [2], for UEs belong to the same enterprise or organization, and if they belong to the same 5G VN group, 5G LAN-type services can be applied among them.\nFor UEs in a communication that are served by satellite backhaul, if local data switching via UPF on-board can be enabled, then the communication path between two UEs can be significantly shorten by avoiding using ISL and feeder link on the way towards the PSA on the ground. If some UEs are served by satellite backhaul and if they are closing to each other, local data switching via a UPF on-board for system efficiency and QoE improvement can be achieved as shown in the Figure 6.7.1-1. If UEs are served by different satellites, in order to enable the local data switching between them, N19 forwarding between UPFs on-board should be supported as shown in the Figure 6.7.1-2. The UPF on-board can be configured to send usage report for traffic subject to local data switching to the SMF on the ground.\nNOTE:\tIt is assumed that two UEs are served by same SMF while enabling local data switching, and for data subject to local data switching, same QoS treatment is applied on both UE sides.\nThe figure depicts a local data switching scenario on a 7.1-1 UPF (Universal Passive Focal Unit) on-board, illustrating the process of data transmission and switching between different data paths. The figure shows the UPF's role in managing the data flow, with the data path highlighted in red, indicating the path of data transmission. The figure also includes a diagram of the UPF's components, such as the data path, the data switch, and the control unit, which are essential for the efficient operation of the system.\nFigure 6.7.1-1: Local Data Switching via a UPF on-board\nThe figure depicts a local data switching scenario in a 7-12 network, where multiple uplinks (UPFs) are connected to the local data switching unit (LDSU). The LDSU is equipped with a local data switching unit (LDSU) and a local data switching unit (LDSU) for local data switching. The figure illustrates the local data switching unit (LDSU) and the local data switching unit (LDSU) in the 7-12 network.\nFigure 6.7.1-2: Local Data Switching via multiple UPFs on-board\nThe possible interactions via the satellite backhaul between UEs are shown in the Figure 6.7.1-3. The Local Data Switching via a UPF on-board is shown as the blue line. The Local Data Switching via multiple UPFs on-board is shown as the red line. The Local Data Switching via the PSA UPF is shown as the green line.\nThe figure depicts a local data switching scenario in a 5G network, where multiple uplinks (UPFs) are connected to the base station (gNB) through a local data switching mechanism. This mechanism allows for efficient data transmission and reduces the need for long-distance fiber-optic cables. The figure illustrates the various components involved in the local data switching process, such as the gNB, uplinks, and local switching elements. The use of multiple UPFs ensures redundancy and failover reliability, which is essential in a 5G network to ensure high-speed data transmission and minimize latency.\nFigure 6.7.1-3: Local Data Switching via multiple UPFs on-board\nIn order to reduce end to end delay comparing with existing 5G LAN local switch at PSA on the ground, the method of how the UPF on-board can be selected by the SMF to support the 5G LAN-type services needs to be achieved.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.2\tProcedures",
                            "text_content": "Figure 6.7.2-1 shows the procedure of the PDU session establishment between UEs served by the UPF on-board in a communication.\nThe figure depicts a PDU session establishment between UEs served by the UPF on-board, illustrating the process of establishing a point-to-point communication link between two devices. The figure shows the PDU (Point-to-Point Device Unit) interface, which is used to establish the communication link between the two devices. The figure also includes the PDU (Point-to-Point Device Unit) interface, which is used to establish the communication link between the two devices. The figure also includes the PDU (Point-to-Point Device Unit) interface, which is used to establish the communication link between the two devices. The figure also includes the PDU (Point-to-Point Device Unit) interface, which is used to establish the communication link between the two devices. The figure also includes the PDU (Point-to-Point Device Unit) interface, which is used to establish the communication link between the two devices. The figure also includes the PDU (Point-to-Point Device Unit) interface, which is used to establish the communication link between the two devices. The figure also includes the PDU (Point-to-Point Device Unit) interface, which is used to establish the communication link between the two devices. The figure also\nFigure 6.7.2-1: PDU session establishment between UEs served by the UPF on-board.\n0.\tDuring the procedure of NG setup, the gNB may inform the AMF of satellite backhaul information and the gNB ID.\n1.\tUE1 initiates the PDU Session Establishment procedure by invoking the PDU Session Establishment Request (DNN, S-NSSAI, PDU Session Type) as specified in clause 4.3.2.2 of TS 23.502 [3].\n2.\tIf the DNN/S-NSSAI obtained from the AMF is associated with a 5G VN group, a dedicated SMF is to be selected as specified in clause 5.29.3 of TS 23.501 [2]. The SMF retrieves the UE subscription information from the UDM (which may optionally include the VN group ID).\nIf the AMF is aware that the serving gNB uses satellite backhaul UP connections, the AMF may invoke Nsmf_PDUSession_CreateSMContext Request to send satellite backhaul information and the gNB ID.\n3.\tBased on the DNN and backhaul information, the SMF determines whether to insert an UL-CL/BP and an additional PSA on-board to activate local data switching.\nNOTE 1:\tIf there are no other PDU sessions established over satellite backhaul for this VN group, the SMF may decide to not select an UL-CL/BP and an additional PSA on-board to enable local data switching.\n4.\tThe SMF selects the PSA UPF on the ground and possibly a UL-CL/BP and an additional PSA on-board.\n5.\tThe PDU session is established for UE1.\n6.\tUE2 initiates the PDU Session Establishment procedure by invoking the PDU Session Establishment Request (DNN, S-NSSAI, PDU Session Type) as specified in clause 4.3.2.2 of TS 23.502 [3].\n7.\tIf the DNN/S-NSSAI obtained from the AMF is associated with a 5G VN group, a dedicated SMF is to be selected as specified in clause 5.29.3 of TS 23.501 [2]. The SMF retrieves the UE subscription information from the UDM (which may optionally include the VN group ID).\nIf the AMF is aware that the serving gNB uses satellite backhaul UP connections, the AMF may invoke Nsmf_PDUSession_CreateSMContext Request to send satellite backhaul information and the gNB ID.\n8.\tBased on the DNN and backhaul information and existing PDU sessions for the VN group, the SMF determines to insert an UL-CL/BP and an additional PSA on-board to activate local data switching.\n9.\tThe SMF selects the PSA UPF on the ground and an UL-CL/BP and an additional PSA on-board.\nThe SMF may utilize the NRF to obtain the on-board UPF profile(s), or, the SMF may obtain the UPF profile(s) from the UPFs associated with the DNN by via N4 Node Level Procedure, e.g. N4 report procedure, where each UPF profile includes one or more gNB IDs/IPs that the UPF currently connects. Based on the UPF profile and the gNB ID received from AMF, the SMF determines the UL-CL/BP and an additional PSA on-board.\n10.\tThe SMF confirms to initiate the N4 Session Establishment including the PDR and FAR to the UL-CL/BP and an additional PSA on-board serving the PDU session 2 to enable local data switching. If both of UE1 and UE2 are served by satellite backhaul via the same GEO UPF1 on-board, the SMF will enable local switch via UPF1 on board the GEO satellite. If the UE1 and UE2 are served by satellite backhaul via different GEO UPFs on-board, the SMF will establish N19 tunnels between GEO UPFs on-board to enable local data switching.\nThe PDR and FAR in the UL-CL/BP indicates that, all UL traffic towards group members (identified by destination IP addresses or QFI) served by UPF(s) on-board will be forwarded to the additional PSA, and all DL traffic received from the additional PSA will be forwarded to the gNB via N3 tunnel.\nNOTE 2:\tThe precondition of using QFI to identify the UL traffic towards group members is that, all UL traffic in the PDU session is subject to local data switching, the UL traffic subject to local data switching and UL traffic not subject to local data switching in a PDU session for 5G-LAN type service are using different QFIs.\nThe PDR and FAR in the additional PSA indicates that,all UL traffic towards group members (identified by destination IP addresses) served by UPF(s) on-board will be forwarded via the additional PSA to the gNB or other I-UPFs, and all DL traffic towards this UE (identified by the destination IP address) will be forwarded to the UL-CL/BP via N9 tunnel.\nNOTE 3:\tThe detailed PDR and FAR will be specified during normative phase.\nFor any SDF subject to local data switching, the SMF may provide particular reporting rules to the additional PSA on-board for minimization of N4 signalling exchange.\n11.\tThe PDU session is established for UE2.\n12.\tThe SMF triggers to select an UL-CL/BP and an additional PSA on-board for PDU session1 to enable local data switching between UEs served by UPF on-board.\n13.\tThe SMF initiates the N4 Session Modification including PDR and FAR to the UPF on-board serving the PDU session 1 to enable local data switching.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.3\tImpacts on services, entities and interfaces",
                            "text_content": "This solution impacts the following system entities.\nAMF:\n-\tCapability to send the satellite backhaul UP connections to the SMF.\nSMF:\n-\tCapability to determine whether to insert an UL-CL/BP and an additional PSA on-board to activate local data switching based on DNN and backhaul information.\n-\tCapability to generate specific PDR and FAR to enable local data switching between UEs.\nUPF:\n-\tConfigure the connectable gNB ID list or gNB IP range in the UPF profile.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.8\tSolution for Key Issue #1: In-sequence delivery",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tDescription",
                            "text_content": "When backhaul between gNB and UPF involves satellite, the inter satellite link may switch due to the satellite movement. This handover of transmission path may happen without UE mobility, caused by the transport network itself and usually is not perceived by 5GC, which will cause performance decline and user experience degradation, especially for TCP-based applications. In such case the traffic of the service flow of an application may need in-sequence delivery by the network.\nThe following solution is proposed to solve the packet out-of-sequence issue introduced by dynamic satellite backhaul:\nFor a non 5G LAN PDU session:\nThe figure depicts a network topology with various components, including a base station (BTS), a user equipment (UE), and a set of distributed nodes. The network is designed to support high-speed data transmission and is equipped with redundancy paths to ensure reliability. The layered design of the network aligns with the principles of Software-Defined Networking (SDN).\nFigure 6.8.1-1\n1.\tThe backhaul type is indicated to SMF by AMF. The SMF indicates backhaul type to PCF and then to AF(maybe via NEF) if AF has requested to obtain the satellite backhaul information for an AF session. The detailed procedures can be captured in other solutions(e.g. #2 ).\n2.\tIf the AF decides the network perform the in-sequence delivery for the traffic of the service flow, e.g. based on the current hackhaul type(LEO/MEO)for the communication path, the service QoS requirement, the capability of the application and APP .. the AF requests the PCF(maybe via NEF) to ensure in-sequence delivery for a flow.\n3.\tThe PCF generates the corresponding PCC policy demanding in-sequence delivery for a QoS flow and sends to SMF.\n4.\tBased on PCC policy from PCF, the SMF decides to initiate the in-order-delivery for the QoS flow. The SMF can also decides the in-order-delivery by local configuration if backhaul involves satellite(s).\n5.\tThe SMF sends to CHF the indication of in-sequence delivery for the corresponding flow.\n6.\tDuring PDU Session establishment, or during mobility/handover procedure, the SMF indicates the UPF and gNB, which are all located on ground, to enable Sequence number based in order delivery for the QoS flow:\nFor uplink traffic:\n-\tThe gNB adds the GTP-U sequence number for the QoS flow according to the PDCP order of the received packets for this QoS flow.\n-\tThe UPF delivers the packets in order based on GTP-U sequence number. The UPF monitors the sequence and initiates timer to wait out of sequence packets.\nFor downlink traffic:\n-\tThe UPF adds the GTP-U sequence number for the QoS flow according to packet order received from DN.\n-\tThe gNB delivers the packets in order based on GTP-U sequence number. The gNB monitors the sequence and initiates timer to wait out of sequence packets.\nFor a 5G LAN PDU session:\nThe figure depicts a network topology with various components, including a base station (BTS), a user equipment (UE), and a set of distributed nodes. The network is designed to support high-speed data transmission and is equipped with redundancy paths to ensure reliability. The layered design of the network aligns with the principles of Software-Defined Networking (SDN).\nFigure 6.8.1-2\nThe UE1 establishes a 5G LAN PDU session which is anchored at UPF1, and uses this PDU Session to send packets to UE2 and UE3, anchored at UPF2 and UPF3. When the UE1 maps packets sent to UE2 and UE3 into the same QoS flow, the QoS flow level based in order delivery mechanism described above for a non 5G LAN PDU session will not work, since the GTP-U SN received at UPF2 and UPF3 will not be in sequence. For example, if UE1 sends the first packet to UE2, the second packet to UE3, the third packet to UE2 and the forth packet to UE3, then the UPF3 may receive two packets with #N+2 and #N+4 and UPF2 may receive two packets with #N+1 and #N+3. UPF2 cannot determine whether there is a packet with number #N+2 sent to it but lost or still on the path. UPF3 has the same issue.\nIn order to solve this issue, the GTP-U SN is removed over N19 tunnel. Since UPFs are located on ground, the transport links between UPFs are regarded stable. The UE1's gNB and UPF1 guarantees the in-sequence delivery of packets between UE1's gNB and UPF1, and UE2's gNB and UPF2 guarantees the in-sequence delivery of packets between UE2's gNB and UPF2.\nThe in order delivery mechanism described above for a non 5G LAN PDU is thus enhanced:\n-\tThe SMF indicates the UPF to remove the GTP-U SN of the packets of a 5G LAN PDU Session, before deliver it to internal interface.\n-\tThe SMF indicates the UPF to add GTP-U SN to packets received from N19 tunnel before sending to gNB.\nIn summary:\nThe out-of-order problem is introduced by dynamic satellite links, thus SMF needs the satellite backhaul category information to 'active' the sequence number.\nFor 5G-LAN N19 tunnel on ground in this scenario, SMF should not 'active' the sequence number.\nNOTE:\tConsidering that inter-GEO satellite links are static, the out-of-order problem on N19 over inter-GEO satellite links does not exists or is negligible; i.e. how to solve the out-of-order problem on N19 is not in the scope of R18.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tVoid",
                            "text_content": "\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.3\tImpacts on services, entities and interfaces",
                            "text_content": "gNB:\n-\tSupport SN based in-sequence delivery.\nSMF:\n-\tReceive the policy of in-sequence delivery.\n-\tSupport enabling SN based in-sequence delivery. For 5G LAN, SMF indicates UPF to remove SN when transferring packets via N19 tunnel, and add SN before sending via N3 tunnel.\n-\tSend the indication of in-sequence delivery to CHF for corresponding charging.\nUPF:\n-\tSupport SN based in-sequence delivery.\n-\tFor 5G LAN case, remove GTP-U SN when transferring packets over N19.\nPCF:\n-\tSend satellite backhaul type information to AF(or via NEF ).\n-\tReceive indication of in-sequence delivery from AF(or vi NEF) and generate corresponding policy to SMF.\nAF:\n-\tDecide the in-sequence delivery by network or by AF/APP when needed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.9\tSolution for Key Issue #1: QoS Monitoring for dynamic satellite backhaul delay control",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.9.1\tDescription",
                            "text_content": "In Rel-17, the single satellite backhaul network is used and the AMF reports to the SMF the satellite backhaul category and the change of satellite backhaul category, as specified in clause 5.8.2.15 of TS 23.501 [2].\nThe figure depicts a satellite backhaul network with dynamic delay, illustrating various scenarios where the delay can vary. The network is designed to accommodate these variations, ensuring reliable communication.\nFigure 6.9.1-1: Example scenarios of satellite backhaul network with dynamic delay\nAs example scenarios depicted above, the RAN may use one or more type of backhaul networks with the 5GC, and also the RAN may use different type of backhaul networks in CP and UP which is differed with the single satellite backhaul network assumed in Rel-17.\nIn order to adapt Policy/QoS control for dynamic delay in satellite backhaul network used in UP, the QoS monitoring over GTP-U path between RAN and UPF is required. For efficient and precise monitoring, the PCF needs to generate the appropriate QoS Monitoring Policy and needs to adjust the PCC rules based on the monitoring results in time.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.2\tProcedures",
                            "text_content": "Figure 6.9.2-1 below depicts the key steps of the solution, which enables the QoS monitoring for dynamic satellite backhaul delay control.\nThe figure depicts a procedure for enabling QoS monitoring for dynamic satellite backhaul delay control. It illustrates the steps involved in setting up a system to monitor and control the delay of satellite backhaul connections. The figure includes a flowchart, a list of steps, and a table with relevant information. The system is designed to ensure that satellite backhaul connections are not delayed, which can impact the quality of service for users.\nFigure 6.9.2-1: Procedure for enabling QoS monitoring for dynamic satellite backhaul delay control\n1.\tThe UE initiates the PDU Session Establishment procedure as specified in clause 4.3.2.2 of TS 23.502 [3].\n2.\tThe AMF determines the Satellite backhaul category (as specified in clause 4.3.2.2 of TS 23.502 [3]), and the following criteria of the network:\nCriteria #1: whether more than one type of backhaul networks can be used with the NG-RAN.\nCriteria #2: whether different backhaul networks can be used in the CP and the UP at the same time\nIf the AMF determines that the more than one type of backhaul networks can be used with the NG-RAN, or different backhaul networks can be used in the CP and the UP at the same time, or both, the AMF informs to the SMF that the backhaul network delay is dynamically change by providing 'dynamic satellite backhaul delay control request' in Nsmf_PDU_Session_CreateSMContext Request.\nThe AMF provides 'dynamic satellite backhaul delay' even when the satellite backhaul network is not used in the CP, if more than one type of backhaul networks can be used or if different type of backhaul network can be used in the UP.\nThe AMF determines the above criteria based on the RAN ID (e.g. Global RAN Node ID), or its configuration.\n3.\tThe SMF initiates SM Policy Association establishment with the PCF. The SMF provides Satellite backhaul category, and/or dynamic satellite backhaul delay control request to the PCF, if it received from the AMF.\n4.\tThe PCF generates and provides to the SMF, the PCC rules with the Policy Control Request Trigger. In the Policy Control Request Trigger, the PCF includes 'UPF with dynamic satellite backhaul delay is selected' which requests to the SMF to interact again when the SMF selects an UPF for the PDU Session by performing GTP-U path monitoring in the available UPFs.\n5.\tThe SMF initiates GTP-U path monitoring as specified in clause 5.33.3.3 of TS 23.501 [2] with the available UPFs. Based on the measured backhaul delay received from the available UPFs and the PCC rules received from the PCF, the SMF selects an UPF for the PDU Session.\n6.\tAfter UPF selection, the SMF notices the PCRT condition received in step 4 is met. The SMF sends Information on the Policy Control Request Trigger condition that has been met and the measured backhaul delay by the selected UPF in Npcf_SMPolicyControl_Update Request to the PCF.\n7.\tBased on received backhaul network delay measurement information, the PCF evaluates the provided PCC rules and decides whether to adjust the PCC rules. The PCF provides PCC rules (if it needs to be updated), and the Policy Control Request Trigger of 'QoS Monitoring information for dynamic satellite backhaul delay control' information. This 'QoS Monitoring information for dynamic satellite backhaul delay control' information includes the information in 'QoS Monitoring for URLLC' as specified in Table 6.3.1 of TS 23.503 [4], and may provide additionally 'Threshold Values'.\n8.\tSMF performs N4 Session Establishment/Modification as specified in clause 4.3.2.2 of TS 23.502 [3].\n9.\tSMF provides to the RAN, the QoS Monitoring Indication, QoS Monitoring reporting frequency, and QoS Monitoring Threshold value, which are derived from the PCC rule information received in step 7, via AMF by invoking Namf_Communication_N1N2Message Transfer.\n10.\tThe AMF sends N2 PDU Session Request to the RAN as specified in clause 4.3.2.2 of TS 23.502 [3].\n11.\tThe RAN setups AN-specific resources with the UE as specified in clause 4.3.2.2 of TS 23.502 [3].\n12.\tThe RAN indicates its rejection to perform QoS Monitoring, e.g. due to RAN load condition, if any. The SMF is responsible to ensure the QoS Monitoring for satellite backhaul network delay between the RAN and the UPF. If SMF determines that there are no other PDU Sessions that use the same backhaul network on this RAN and UPF, then the SMF concludes that this backhaul network cannot be monitored in the RAN side.\n13.\tThe AMF sends Nsmf_PDUSession_UpdateSMContext Request to the SMF.\n14.\tThe SMF initiates N4 Session Modification with the UPF and provides QoS Monitoring Policy for dynamic satellite backhaul delay control, which are derived from the PCC rule information received in step 7. When the SMF receives the measured backhaul network delay from the UPF after this step and if the measurement result exceeds the Threshold Value, the SMF reports to the PCF the PCRT condition is met.\n15.\tThe SMF sends Nsmf_PDUSession_UpdateSMContext Response as specified in clause 4.3.2.2 of TS 23.502 [3].\n16.\tOptionally, if the SMF concluded that the backhaul network cannot be monitored in the RAN side (as described in step 12), and it is configured that the satellite backhaul network monitoring in both RAN and UPF side is mandatory, then the SMF informs the AMF by invoking Nsmf_PDUSession_SMContextStatusNotify (Release), and related steps are performed as specified in clause 4.3.2.2 of TS 23.502 [3].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.3\tImpacts on services, entities and interfaces",
                            "text_content": "AMF:\n-\tDuring the PDU Session Establishment procedure, determines whether more than one type of backhaul networks can be used with the RAN, and whether the different type of backhaul networks can be used in CP and UP.\n-\tIndicates to the SMF that the satellite backhaul network with dynamic delay can be used with the RAN during the PDU Session Establishment procedure.\nSMF:\n-\tUpon receiving dynamic satellite backhaul delay control request from the AMF, forwards the request to PCF.\n-\tDerives the information of QoS Monitoring for dynamic satellite backhaul delay control for RAN and UPF based on the PCC rule information provided by the PCF.\n-\tInitiates the GTP-U path monitoring upon receiving dynamic satellite backhaul delay control request from the AMF.\n-\tDuring the PDU Session Establishment procedure, selects the UPF based on the GTP-U path minoring results received from the available UPFs.\nPCF:\n-\tUpon receiving dynamic satellite backhaul delay control request from the SMF, generates PCC rule information for QoS Monitoring for the satellite backhaul with dynamic delay, and the Policy Control Request Triggers for the SMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.10\tSolution for Key Issue #2: Enable Satellite EAS re-discovery and re-allocation by means of local DNS on-board satellite",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.10.1\tDescription",
                            "text_content": "This solution corresponds to KI#2.\nUE has established a PDU Session with the local PSA (L-PSA) and with the corresponding EAS on-board a GEO satellite. The procedure described below covers the cases when the EAS on satellite needs to be changed to another EAS on the same satellite or when the EAS on one satellite is substituted with another EAS on another satellite. Such changes among EASs could be caused by the mobility of a UE or temporary unavailability of an EAS due to e.g. maintenance, insertion of new services or failure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.2\tProcedures",
                            "text_content": "Figure 6.10.2-1 shows the procedure to enable changes of EAS by means of local DNS (L-DNS) located on the satellite.\nThe figure depicts a network setup with a local DNS (DNS) server, enabling EAS re-discovery or EAS re-selection. The local DNS server is responsible for re-discovering or re-selecting EAS (Enhanced Airborne Services) based on the local DNS query. This setup ensures that the EAS services are available in the local network, reducing the need for external DNS servers.\nFigure 6.10.2-1: Enabling EAS re-discovery or EAS re-selection by means of a local DNS (L-DNS)\n1.\tA change from one EAS to another EAS can be performed by using local DNS. The local DNS needs to be aware of various EASs located in the satellite or in the neighbouring GEO satellites.\nInformation about L-DNS address is provided to UE (EDC) by the SMF located on the ground during the PDU session establishment or modification procedure. By storing, in L-DNS, information on other EASs (either on board currently serving or neighbouring GEO satellites) a switch from one EAS to another can be performed without SMF intervention and saves the backhauling resources accordingly. After the EAS change the local DNS only reports this change to the SMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.3\tImpacts on services, entities and interfaces",
                            "text_content": "SMF:\n-\tUpdate the procedure such that SMF stores the information on the L-DNS located on a GEO satellite about the EASs that provide the same application services and can be used as alternatives for the currently used EASs.\n-\tL-DNS should be able to receive and store information about the EASs on neighbouring GEO Satellites.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tOverall Evaluation",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tEvaluation of solutions for Key Issue #1: PCC/QoS control enhancement considering dynamic satellite backhaul",
                    "description": "",
                    "summary": "",
                    "text_content": "There are 5 candidate solutions (solutions #1, #2, #3, #8, #9) proposed to solve this KI.\nFor the determination of packet delivery latency or bandwidth or both of the satellite backhaul on the UP path:\nThere are solutions #1, #2, #9. The common part among these solutions is that QoS monitoring mechanism is used to measure the packet delivery latency over satellite backhaul (per GTP-U path). The main differences are:\n-\tSolution#1 may require the SMF to activate QoS monitoring based on the satellite backhaul category defined in rel-17, and the measured delay is mainly used for policy control.\n-\tSolution#2 introduces a new indication named \"dynamic satellite backhaul in use\" determined by the AMF to trigger the PCF to generate QoS monitoring rules, and the measured delay is not only used for policy control, but also used for UPF selection. In addition, the SMF provides the bandwidth of the GTP-U path (identified by a pair of <gNB IP, UPF IP>) to the PCF for policy control, where the bandwidth is detected via implementation methods.\n-\tSolution#9 also relies on a new indicator named \"dynamic satellite backhaul delay control request\" determined by the AMF internally to trigger the PCF to generate QoS monitoring rules, and the QoS monitoring rules include threshold values to avoid frequent reports by SMF to PCF due to dynamic backhaul delay change. The measured delay can be used for policy control and UPF selection.\nAll of these procedures can serve the purpose of reporting dynamic backhaul. Indication of multiple satellite backhaul categories in Solution #1 is only an encoding issue of including multiple instances of the already existing satellite backhaul information. Solution #2 introduces \"dynamic satellite backhaul in use\" indication, which can be encoded either as above in Solution #1 or via new enumerated satellite backhaul category. Solution #9 introduces \"dynamic satellite backhaul delay control request\" from the AMF to achieve the same.\nFrequent measurement of delay is costly, reporting time of duration of high packet delivery delay event help PCF/AF action properly. For example, if PCF/AF received a high delay (based on measurement) and the time of duration representing that there would be a cross-seam transiting in a period of time, they can be aware that the dramatically increased high delay is inevitable and may action properly, e.g. PCF indicates SMF to change the delay measurement interval to wait the cross-seam transiting event over, or AF may start coding compensation (a single high delay report may not trigger the action, as it may be temporary caused by network congestion).\nFor exposure of backhaul information to the AF:\nThere are solutions #1, #2, #3. The common part of these solutions is that the satellite backhaul delay can be exposed to AF. The main differences among them are:\n-\tSolution#1 allows the PCF to report the measured backhaul delay or satellite backhaul category or both to AF for application specific reasons.\n-\tSolution#2 proposes to expose not only satellite backhaul delay but also bandwidth of the GTP-U path over satellite backhaul. The satellite backhaul delay is observed via QoS monitoring, and the bandwidth is obtained by SMF via implementation method. In addition, the AF can request to obtain the satellite backhaul information if it is aware of satellite backhaul is in use.\n-\tSolution #3 deals with dramatic change of delay/jitter caused by cross-seam transiting event in polar orbit satellite constellation scenarios. The AMF reports satellite constellation information to the PCF/AF. The PCF/AF requests a backhaul delay change event report. When determining that the backhaul delay is about to change due to cross-seam transiting event, the AMF notifies the PCF/AF the duration time of the event. This solution enables networks and applications to be aware of the duration time of dramatic change of backhaul delay/jitter and perform proper actions timely in polar orbit satellite constellation scenarios.\nFor reporting of the satellite backhaul to CHF:\nSatellite backhaul category and the observed backhaul delay need to be stored for charging and statistics reasons. Solution #1 is the only solution that supports the reporting of the satellite backhaul category and the observed backhaul delay to CHF.\nFor packet order related topics:\nDynamic satellite backhaul introduces one new case in addition to the existing ones where out-of-order packets can occur e.g. due to backhaul routing changes.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tEvaluation of solutions for Key Issue #2 - Support of Satellite Edge Computing via UPF on board",
                    "description": "",
                    "summary": "",
                    "text_content": "Solutions #4 (Edge computing part of this solution), #5, #6(Edge computing part of this solution) and #10 describe supporting Satellite Edge Computing via UPF on board.\nSession Breakout connectivity model (solutions #4, #5)\nIn solutions #4 and #5, the on-board UPF acts as UL CL/BP and local PSA. The Session Breakout connectivity model defined in TS 23.548 [6] is supported.\nIn solution#4 the on-board UPF can be inserted statically (i.e. during PDU Session Establishment procedure) or dynamically (i.e. during the DNS Query process), while in solution#5 the on-board UPF is inserted dynamically based on DNS Query initiated by UE.\nFor GEO UPF selection, in Solution#4, SMF selects on-board UPF based on DNAI as described in TS 23.548 [6]. The DNAI is derived by SMF based on the GEO satellite ID provided by AMF. Solution#5 requires the UPF onboard to report the gNB ID it connects to the SMF via N4 association, then the SMF can select a UPF connecting with the gNB serving the UE after determining the candidate UPFs using existing mechanism.\nDistributed Anchor Point and multiple PDU Sessions connectivity models (solution #6)\nIn solution#6, the on-board UPF acts as PSA. The Distributed Anchor Point and multiple PDU Sessions connectivity model defined in TS 23.548 [6] are supported.\nEAS rediscovery (solution #10)\nIn solution#10, EAS rediscovery is described. SMF stores EAS located in a GEO satellite or neighbouring GEO satellites on on-board local DNS. In case of EAS change, the local DNS reports this change to SMF. An interface between SMF and local DNS is needed for such reporting.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.3\tEvaluation of solutions for Key Issue #3: Support of Local Data Switching via UPF on-board",
                    "description": "",
                    "summary": "",
                    "text_content": "There are 3 candidate solutions (solutions #4, #6, #7) proposed to solve how to enable local data switching via UPF on-board:\n-\tSolution #4 requires the UPF onboard to act as a UL-CL/BP and an additional PSA, so that UE to UE traffic can be routed to the additional PSA on the satellite, and then forwarded to the target UE. The SMF determines whether the two UEs which requests UE-UE communication are severed by same DNAI mapped from the GEO satellite ID provided by AMF without creating group. If the two UEs are severed by same DNAI, the SMF inserts the on-board UPF as UL CL/BP and local PSA for the two UEs according to the DNAI. When different SMFs are used for the two UEs, the UDR is involved in above procedure to judge whether two UEs are under same DNAI.\n-\tSolution #6 requires the UPF onboard to act as a PSA which is pre-configured with IP address pool per DNN, and the UPFs onboard are configured with particular PDR and FAR pairs, so that the UE to UE traffic can be local routed automatically without creating group. It's assumed that the same SMF is used and inter-GEO UE-UE communication is supported.\n-\tSolution #7 also proposes the UPF onboard to act as a UL-CL/BP and an additional PSA, but requires to support QoS flow level traffic switching at the UL-CL/BP, and establish N19 tunnel between two additional PSAs, so that the UE to UE traffic will be routed to target UE belonging to same 5GLAN VN group according to the PDR and FAR. The same SMF is assumed in this solution.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "8\tConclusions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "8.1\tConclusions on PCC/QoS control enhancement considering dynamic satellite backhaul",
                    "description": "",
                    "summary": "",
                    "text_content": "For the determination of packet delivery latency of the satellite backhaul on the UP path, following conclusions are proposed:\n-\tThe PCF may determine the packet delivery latency on N3 interface, if it detects dynamic satellite backhaul is used to serve the PDU session. The PCF can determine the N3 latency based on configuration or by using QoS monitoring triggered by PCF or estimate the N3 latency based on the received satellite backhaul category (LEO, GEO, etc.);\n-\tThe SMF activates the QoS monitoring to measure the packet delivery latency on N3 interface according to the PCC rule;\n-\tThe measured delay can be used by PCF for policy control, and can be considered for UPF selection (e.g. when the different types of backhaul network can be used in CP and UP).\nFor exposure of backhaul information to the AF, there are solutions #1, #2, #3, following conclusions are proposed:\n-\tThe PCF can report packet delivery latency to the AF using existing QoS monitoring solution;\n-\tThe AF can request the PCF to report the packet delivery latency using existing QoS monitoring solution.\nThe reporting of the satellite backhaul category and the observed backhaul delay to CHF as proposed in Solution #1 can be supported but this is to be determined by SA WG5.\nFor handling of out-of-sequence packets that can occur at N3, it is concluded that no action needs to be taken.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.2\tConclusion on solutions for Key Issue #2",
                    "description": "",
                    "summary": "",
                    "text_content": "On-board PSA UPF or ULCL/BP/local PSA UPF selection is performed as following:\n-\tThe SMF determines DNAI based on local configuration and GEO satellite ID received from AMF. SMF performs UPF selection considering the DNAI.\nNOTE 1:\tIt is assumed that a DNAI value is assigned for each GEO satellite ID by the operator. SMF is local configured with mapping relationship between DNAI and GEO satellite ID.\nNOTE 2:\tThe selected On-board UPF can be inserted as ULCL/BP/L-PSA reusing existing ULCL/BP insertion procedures defined in TS 23.502 [3] or TS 23.548 [6].\nFor Distributed Anchor Point and multiple PDU Sessions connectivity models:\n-\tBased on GEO satellite backhaul category from AMF, UE PCF may determine and update URSP rule including a appropriate DNN/S-NSSAI for services that allowed to access the services on GEO satellite.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.3\tConclusions on Support of Local Data Switching via UPF on-board",
                    "description": "",
                    "summary": "",
                    "text_content": "1.\tAssumption:\n-\tOnly a single SMF is supported for Local Data Switching and N19 via UPF on-board, i.e. both UEs are served by the same SMF.\n-\tLocal Data Switching via UPF on board applies on GEO satellite backhaul only. Conclusions in this clause consider only DNNs and slices for 5G VN.\n-\tThe UE to UE traffic may be locally routed by UPF on-board to the target UE without traversing back to the satellite gateway on the ground;\n-\tN19 tunnel may be established between two UPFs on-board different satellites to locally switch UE to UE traffic.\n2.\tOn-board PSA UPF or ULCL/BP/local UPF selection is performed as following (Same mechanism can be reused to KI#2):\n-\tFor each GEO satellite ID, a DNAI value is assigned by the operator. SMF is configured with DNAI corresponding to each GEO satellite ID. The SMF determines DNAI based on the configuration and GEO satellite ID received from AMF.\n-\tOn-board UPF selection is done based on the DNAI as current UPF selection defined in TS 23.501 [2] and TS 23.502 [3].\nNOTE:\tThe latency optimisation that can be gained by inter-satellite N19 between UPFs on different GEO satellites depends on the distance between the satellites that can be substantial, depending on the number of deployed satellites.\n3.\tURSP configuration:\nFor on-board UPF acting as PSA case:\n-\tA combination of DNN/S-NSSAI is assigned by the operator to the services deployed on GEO satellite. Based on GEO satellite backhaul category from AMF, PCF determines URSP rule including the DNN/S-NSSAI for such services. PCF sends the URSP rules to UEs allowed to access the services on GEO satellite. (Same mechanism can be reused to KI#2).\n4.\tUser plane configuration:\n-\tFor the on-board UPF acting as a PSA case, SMF creates N4 rules on the on-board UPF to enable local data switching as following:\n-\tBased on pre-configuration, the SMF establishes the N19 tunnel between the two UPFs and corresponding UPF-level N4 rules to support local data switch. The IP address(es) in UPF address pools are utilized in the UPF-level N4 session to detect UE-to-UE communication packets which are sent to pre-configured N19 for local data switch.\n-\tFor on-board UPF acting as ULCL/BP/local PSA case:\n-\tSMF determines to activate local data switching for UEs based on:\n1)\tAF request including IPs/DNNs of UEs which require UE-to-UE communications, which will re-uses an existing NEF API and no impacts are foreseen; or\n2)\tTarget IP reported by on-ground PSA UPF as current reporting mechanism defined in TS 23.501 [2].\n-\tSMF configures Local PSA(s) based on the IP address(es) of target UEs, then UE-to-UE communication packets are detected and sent to the internal interface and optional N19 for local data switch. The local data forwarding rules on L-PSA can be configured based on 5GVN user plane handing mechanism.\n-\tSMF configures UL-CL/BP to route data traffic toward the L-PSA.\n\n",
                    "tables": [
                        {
                            "description": "",
                            "table number": 4,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        }
    ]
}