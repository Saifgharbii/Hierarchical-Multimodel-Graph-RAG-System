{
    "document_name": "23700-88-i00.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Report has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\tindicates that something is possible\ncannot\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The scope of this Technical Report is to study the enhancement of 5G System to support Personal IoT Network (PIN). The study addresses the service requirements documented in TS 22.261 [5] for the Personal IoT Networks. The following aspects needs to be studied:\n-\tArchitecture enhancement:\n-\tTo study the potential architectural enhancements for supporting management of PIN, access of PIN via PIN Element with Gateway Capability (PEGC), and communication of PIN (e.g. PIN Element communicates with other PIN Elements directly or via PEGC or via PEGC and 5GS).\n-\tTo study the potential architecture enhancements for supporting identifying PIN and the PIN Elements.\n-\tSecurity related:\nNOTE:\tThe study may need cooperation with SA3. If solutions are related to security impact, they will be studied in SA WG3.\n-\tTo study how to identify PIN and the PIN Elements in the PIN at 5GC level to serve for authentication/authorization.\n-\tManagement as well as policy and routing control enforcement:\n-\tTo study the management of a PIN.\n-\tTo study the procedures for PIN discovery, PIN Element discovery.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[3]\t3GPP TS 23.502: \"Procedures for the 5G system, Stage 2\".\n[4]\t3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System\".\n[5]\t3GPP TS 22.261: \"Service requirements for the 5G system; Stage 1\".\n[6]\t3GPP TS 23.304: \"Proximity based Services (ProSe) in the 5G System (5GS)\".\n[7]\t3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS); Stage 3\".\n[8]\t3GPP TS 23.316: \"Wireless and wireline convergence access support for the 5G System (5GS)\".\n[9]\t3GPP TS 24.502: \" Access to the 3GPP 5G Core Network (5GCN) via Non-3GPP Access Networks (N3AN); Stage 3\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in TR 21.905 [1], in TS 23.501 [2] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in TR 21.905 [1] or in TS 23.501 [2].\nPersonal IoT Network: A configured and managed group of PIN Element that are able to communicate each other directly or via PIN Elements with Gateway Capability (PEGC), communicate with 5G network via at least one PEGC, and managed by at least one PIN Element with Management Capability (PEMC).\nPIN Element: A UE or non-3GPP device that can communicate within a PIN (via PIN direct connection, via PEGC, or via PEGC and 5GC), or outside the PIN via a PEGC and 5GC.\nPIN Element with Gateway Capability: A PIN Element with the ability to provide connectivity to and from the 5G network for other PIN Elements, or to provide relay for the communication between PIN Elements.\nPIN Element with Management Capability: A PIN Element with capability to manage the PIN.\nNOTE:\tA PIN Element can have both PIN Management Capability and Gateway Capability.\nPINE-to-PINE communication: communication between two PINEs which may use PINE-to-PINE direct communication or PINE-to-PINE indirect connection.\nPINE-to-PINE direct connection: the connection between two PIN Elements without PEGC, any 3GPP RAN or core network entity in the middle.\nPINE-to-PINE indirect connection: the connection between two PIN Elements via PEGC or via UPF.\nPINE-to-PINE routing: the traffic is routed by a PEGC between two PINEs, the two PINEs direct connect with the PEGC via non-3GPP access.\nPINE-to-Network routing: the traffic is routed by a PEGC between PINE and 5GS, the PINE direct connects with the PEGC via non-3GPP access separately.\nNetwork local switch for PIN: the traffic is routed by UPF(s) between two PINEs, the two PINEs direct connect with two PEGCs via non-3GPP access separately.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in TR 21.905 [1], in TS 23.501 [2] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905 [1] or in TS 23.501 [2].\nPIN\tPersonal IoT Networks\nPINE\tPIN Element\nPEGC\tPIN Elements with Gateway Capability\nPEMC\tPIN Elements with Management Capability\nP2P\tPINE-to-PINE\nP2N\tPINE-to-Network\nNLSP\tNetwork local switch for PIN\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tArchitectural requirements and assumptions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tArchitectural Requirements",
                    "description": "",
                    "summary": "",
                    "text_content": "This study has following architectural requirements:\n-\tIf sidelink is used for the direct communication between PEMC and PEGC, reuse procedures defined for 5G ProSe Direct Communication without introducing new features to sidelink.\n-\tThere shall be no change to underlying non-3GPP access (e.g. WIFI, Bluetooth) standards.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tArchitectural Assumptions",
                    "description": "",
                    "summary": "",
                    "text_content": "This study has following architectural assumptions:\n-\tOnly a 3GPP UE can act as PEGC and/or PEMC.\n-\tThere are one or more PEGCs in a PIN.\n-\tThere are one or more PEMCs in a PIN, at any point of time one of which is able to control the PIN.\n-\tThe PIN Elements assumes to use non-3GPP access (e.g. WIFI, Bluetooth) for direct communication, the PEMC can use 5G ProSe Direct Communication for direct communication with PEGC.\n-\tIn this release, the PEGC and PEMC belongs to same PLMN or (S)NPN.\n-\tThe scenario when a PEGC or PEMC or both are in roaming is out of the scope of this release.\n-\tA single PEGC may support more than one PIN at a time.\n-\tMulti-hop P2P (i.e. communication between a chain of PINEs) and P2N relay (i.e. communication from a PINE to another PINE or to the network via an intermediate PINE) are not studied in this release.\nEditor's note:\tWhether PINE can connect to multiple PEGCs is FFS.\nNOTE:\tIn this Release the 5G-RG is considered outside the scope of the study and consequently not part of PIN.\nEditor's note:\tIt is FFS whether data traffic of PINE over control plane is in scope of this study.\nEditor's note:\tWhether PINE UE is restricted to be in the same PLMN/(S)NPN as PEGC/PEMC or not is FFS.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5\tKey issues",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tKey Issue #1: 5GC architecture enhancements to support PIN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.1.1\tDescription",
                            "text_content": "It is required that at least one PEGC is in a PIN. A PINE may be a non-3GPP device, or can be a UE. There are one or more PEMCs for a PIN, at any point of time one of which is able to control the PIN, e.g. create/delete a PIN, add/remove a PINE for the PIN, etc.\nThe following aspects will be studied:\n-\tWhether additional 5GC function(s) and/or interface(s) are needed for supporting identification of PIN and PIN Elements, management of PIN, access of PIN via PEGC and communication of PIN.\n-\tDefine the architecture of the PIN.\nNOTE:\tIf new function(s) or new interface(s) are introduced in solution proposals addressed to other key issues, the architecture proposal needs to be addressed in this key issue, and those solutions needs to indicate the architecture proposal addressed to this key issue.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.2\tKey Issue #2: PIN and PIN Element discovery and selection",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tDescription",
                            "text_content": "The PIN discovery is used for a UE or non-3GPP device to discover a PIN. PINE discovery is used for a UE or non-3GPP device to discover the PIN Elements (i.e. PINE, PEGC, and PEMC).\nFollowing issues need to be addressed in this key issue:\n-\tHow to discover and select a PIN.\n-\tHow to discover and select PEGC and PEMC.\n-\tHow to discover PINEs in a PIN based on criteria, for example, the capability, availability, reachability and services (e.g. printer).\n-\tHow to enable and manage the discovery for all possible case, for example, whether a PINE is discoverable by UEs or non-3GPP devices that have not joined the PIN yet or by other PINEs of the same PIN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tKey Issue #3: Management of PIN and PIN Elements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tDescription",
                            "text_content": "This key issue intends to support the management of the PIN, including the management of different types of PINEs and the configuration of the PIN. Both the network operator and authorized 3rd party, i.e. PEMC could create and configure the PIN and its elements.\nAfter a PIN has been created, PEMC can add a PEGC into the PIN, or remove a PEGC from the PIN, as well as add a PINE into the PIN and associate it to some PEGCs that have already been added into the PIN, or remove a PINE from the PIN.\nThe Key Issue is to study the following aspects in the 5GS:\n-\tHow to support mechanisms for network operator or authorized 3rd party (e.g. a PEMC) for PIN management, e.g. create/modify/delete/activate/deactivate a PIN, etc.\n-\tHow to support for the management of PINEs, including to add/remove the PINEs, as well as the association between PEGC and other PINEs.\n-\tHow to support establishing and enforcing the validity duration and the time validity of a PIN (e.g. the PIN is valid for 30 minutes, the PIN is valid from 15:00 UTC to 23:00 UTC) and of the PINEs in a PIN (e.g. the PINE will be member of PIN for 1 hour, the PINE will be member of PIN from 16:00 UTC to 17:00 UTC).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.4\tKey Issue #4: Communication of PIN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.4.1\tDescription",
                            "text_content": "The PIN connectivity supports communications between PINEs directly, communications between PINEs via PEGC, communications between PINEs via PEGC and 5GS, and communications between PINE and services outside of the PIN via PEGC and 5GS.\nThe PINE behind the PEGC may run an application with different QoS requirement, which may need the PEGC to have a corresponding QoS flow for relaying the traffic.\nFollowing issues need to be addressed in this key issue:\n-\tHow to support communications between PINEs within a PIN.\n-\tHow to enable a PINE to use a PEGC to communicate via 5GS.\n-\tWhether and how 5GS supports relay path management for a PINE when a PEGC is used for the relay, e.g. including setup and release.\n-\tHow to select communication path for communication between PINEs, e.g. direct communication, via PEGC, via 5GS.\n-\tWhether and how 5GS supports the policy and QoS differentiation for the traffic relayed between a PINE and 5GS when a PEGC is used for the relay.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.5\tKey Issue #5: Authorization for PIN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.5.1\tDescription",
                            "text_content": "The owner of a PIN may configure authorization information for the PIN, e.g. whether a PINE can communicate with other PINEs or with a specific data network, whether a UE is allowed to act as a PEMC and/or a PEGC, etc.\nThe following aspects will be studied:\n-\tHow to support authorization in a PIN, including following aspects:\n-\tHow to authorize/deauthorize a PINE to access 5GS service.\n-\tHow to authorize/de-authorize PEMC to manage the PIN.\n-\tHow to authorize/de-authorize PEGC to provide connectivity to and from the 5G network for other PINEs that is not capable to access the 5G network, considering the case when there are multiple PEGC capable UEs present in a specific PIN.\n-\tHow to enforce the authorization result for a PIN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.6\tKey Issue #6: Policy and parameters provisioning for PIN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.6.1\tDescription",
                            "text_content": "In order to support the necessary procedures regarding to PIN, e.g. communication between PINEs, PINE/PEGC/PEMC discovery, authorization for PINE/PEGC/PEMC, necessary policy/parameters configuration are needed.\nThe following aspects will be studied:\n-\tWhether and how the PIN related policy and parameter(s) identified in the other KIs for PIN discovery, PINE discovery, authentication/authorization for PINE and PIN communication are configured to the PEMC, PEGC and PINE.\n-\tWhether and how 5GC supports provisioning of configuration information to PEGC for access control.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.7\tKey Issue #7: Identification of PIN and PIN Elements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.7.1\tDescription",
                            "text_content": "The key issue focuses on potential enhancements needed to support identification of PIN and PINEs. The following aspects will be studied as part of the key issue:\n-\tHow to identify a PIN and who manages the PIN identity. Whether and what characteristics of a PIN shall be known to the 3GPP network (e.g. type of PIN (wearable, home automation, factory etc.), max of PIN elements in the PIN, etc.).\n-\tHow to support identifying PINE, PEGC and PEMC, and whether and how the 5GS manages the identifier.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tSolutions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.0\tMapping of Solutions to Key Issues",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 6.0-1: Mapping of Solutions to Key Issues\n\n",
                    "tables": [
                        {
                            "description": "Table 6.0-1: Mapping of Solutions to Key Issues",
                            "table number": 3,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.0A\tSolution #0A: 5GC architecture enhancements to support PIN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.0A.1\tDescription",
                            "text_content": "The solution describes the following 5G Core architecture enhancements to support PIN:\n1.\tAdditional 5GC functions and interface needed for supporting identification of PIN and PIN Elements, management of PIN and PIN access via PEGC.\n2.\tArchitecture of the Personal IoT Network.\nMore than 500 billion IoT devices are expected to be on the internet by 2030, to organize and manage these Personal IoT Network (PIN) from the 5G core, this solution proposes to add a new network function, which can push the operator and 3rd party policies such as add/remove PIN, add/delete PIN element from the PIN etc. For the network to control the PIN and the PIN elements, PEMC of the PIN should register itself to the 5GC and indicate that it is capable of organizing PIN networks. Based on the policies the new Network function (PINCTRL) on the 5GC will acknowledge the PEMC duly. PINE can access the 5G network through PEGC, which is registered as PIN capable with the 5G network. This solution proposes an architecture and protocol enhancement so that the operator and 3rd party can fine grain control the PINE and PIN management features. This solution also proposes a way to address PIN elements of PIN from 5GC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.0A.2\tProcedures",
                            "text_content": "This solution addresses KI#1 and describes the 5GC architecture enhancements to support PIN.\nThis solution proposes to add PINCTRL (PIN Ctrl Function) - a new Network Function- and new interfaces P1 and NPINCTF  to manage and organize PIN network as shown in Figure 6.0A.1.2-1. PEMC/PEGC communicates with the PINCTRL of 5GCore network using P1 reference points for Authorization, 3rd party/Operator policies etc. This solution proposes PINCTRL to be part of SBI bus of the 5G core architecture and communicates with the other NF(s) using NPINCTRL interface. PEMC forms the PIN Network and PEMC/PEGC communicates to the 5Gcore on behalf of PIN elements.\nThe 0 A and 2.1-1.1 PIN architecture enhancements in Figure 6 of the 5G Core Specification (5GC) aim to enhance the performance of the 5G Core network by providing improved performance and reliability for point-to-point (P2P) communication. These enhancements include the use of 5G Core's Enhanced Packet Classification (EPC) and Enhanced Packet Detection (EPD) features, which help to improve the detection and classification of packets in the network. Additionally, the use of 5G Core's Enhanced Packet Forwarding (ePFR) feature allows for more efficient and reliable communication between the core and the edge network. These enhancements are designed to support the increasing number of point-to-point (P2P) communication requirements in the 5G Core network.\nFigure 6.0A.2.1-1: 5GC architecture enhancements to support PIN\nThis solution proposes to add the following new reference points to the 5G Architecture:\nP1: Reference point between PEMC/PEGC to PIN CTRL Func.\nNPINCTF: Reference point between PIN CTRL Func and SBA bus.\nThis solution proposes to add the following new Network Functions and Entities to the 5G System:\nPINCTRL: PIN Control Function, a Network Function that is dedicated for following PIN functions:\n1)\tAuthorizes PEMC/PEGC to form the PIN.\n2)\tMaintains and Updates PIN Information and List of PIN elements with PIN Capabilities such as Name, Address, assigned PEGC, 5G system accessible, Type of PINE such as printer, headset, Thermostat, etc.\n3)\tAcknowledges PIN_List from/to PEMC.\n4)\tAccepts Operator or 3rd party PIN Rules.\n5)\tPushes Operator's policy to the PIN network.\nPINE (Personal IoT Network Element): A PIN Element that can communicate within the PIN network or to the 5G network via PEGC.\nPEGC (PIN Element with Gateway Capability): A PIN Element with the ability to provide connectivity to and from the 5G network for the other PIN Elements or provide relay for the communication between PIN Elements.\nPEMC (PIN Element with Management Capability): A PIN Element with capability to manage the PIN.\nThe figure depicts a simplified architecture of a Personal IoT Network (PITN) with a focus on the Software-Defined Networking (SDN) approach. It illustrates the network's structure, including the use of Software-Defined Networking (SDN) controllers, which are responsible for managing the network's traffic and resources. The figure also highlights the use of Software-Defined Networking (SDN) controllers, which are responsible for managing the network's traffic and resources. The figure also highlights the use of Software-Defined Networking (SDN) controllers, which are responsible for managing the network's traffic and resources. The figure also highlights the use of Software-Defined Networking (SDN) controllers, which are responsible for managing the network's traffic and resources. The figure also highlights the use of Software-Defined Networking (SDN) controllers, which are responsible for managing the network's traffic and resources. The figure also highlights the use of Software-Defined Networking (SDN) controllers, which are responsible for managing the network's traffic and resources. The figure also highlights the use of Software-Defined Networking (SDN) controllers, which are responsible for managing the network's traffic and resources. The figure also highlights the use of Software-Defined\nFigure 6.0A.2.4-1: SBA Architecture for Personal IoT Network\nThis solution proposes Service Based Architecture (SBA) for PIN discovery, selection and communication in the Personal IoT Network. In this SBA, this solution uses consumer, producer and broker model for the PINE to register and provide its services to other PINE and discover services of other PINE in the PIN as shown in Figure 6.0A.1.5-1. The PINE in the PIN, communicates among each other using Request-Response and subscribe-notify mechanism.\nThis solution assumes that the PIN Elements in a PIN network are reachable via a wireless link such as Wi-Fi, Bluetooth, WiGi etc. and the procedure to form a reachable PIN network at wireless link is out of scope of this document. PEMC acts as a broker in the service and producer model with PINE/PEGC service repository function. Higher layer protocol such as http is used for internal PIN communication and 5G NAS signalling is used to communicate with 5G systems such as PIN registration. A device will discover a PEMC using Request-Response broadcast message and register its services with the PEMC of the appropriate PIN network. PINE with PEGC capability will register itself with the DNN and then discover PEMC to register its gateway and other services.\nSecurity and authentication of the PINE with the PEMC is described in the solution for KI#5. PEMC will maintain a repository of the PIN elements services and its FQDN or IP address. A PINE in the PIN will discovery other PINE services and reachability from the PEMC for e.g. A PINE such as printer or a UE with gateway functionality will register its FQDN and its services with the PEMC. The PINE would query the PEMC for the printer or gateway functionality and based on the management policies the appropriate FQDN and its services of the printer and gateway is sent to the PINE. Management and configuring policies are described in the solution for KI#3 and KI#6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.0A.3\tImpacts on services, entities and interfaces",
                            "text_content": "The solution largely re-uses existing functionality.\nThe solution has the following impacts:\nImpact to the 5GCore:\n-\tAdd New Network Function, PIN control function (PINCTRL), to the 5GCore.\n-\tAdd New Interfaces P1 and NPINCTRL to the 5G system.\nImpact to the UE (PEMC):\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\n-\tAbility to maintain a list of all the PINE and its supported services.\n-\tAbility to respond to PINE and its service discovery queries from the PINE.\nImpact to the PINE:\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\n-\tAbility to request QoS using http request to the PEGC.\nImpact to the UE (PEGC):\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\n-\tAbility to register its gateway functionality to PEMC.\n-\tAbility to accept http QoS request from the PINE and setup multiple PDU session with the 5G System.\n-\tAbility to map PDU session ID to the IP address of the PINE and forward packets to/from the corresponding PDU session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.0B\tSolution #0B: Architecture alternative B",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.0B.1\tDescription",
                            "text_content": "This solution addresses Key Issue #1 \"5GC architecture enhancements to support PIN\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.0B.2\tProcedures",
                            "text_content": "Figure 6.0B.2-1 depicts the reference architecture for the solution. The PIN functions are defined in architecture assumption clause 4.\nThe figure depicts a reference architecture for a 0-B-2-1 solution, which is a network design for a 5G network. It illustrates the various components and their interconnections, including base stations (gNB), user equipment (UE), and scatterers. The figure highlights the use of beamforming techniques to mitigate interference and the importance of redundancy paths to ensure reliable communication.\nFigure 6.0B.2-1: Solution reference architecture\nThe solution defines the following PIN functionalities:\n-\tPIN Element Function (PEF) which represents the functionalities providing the communication within the PIN (via PIN direct connection or via PEGC), or outside the PIN via a PEGC. The PEF is able also to communicate with the PEMC for been configured, for discovery and for authentication and authorisation.\n-\tPIN Element Gateway Capability Function (PEGCF) which represents the functionality providing the connectivity to and from the 5G network for other PIN Elements, or provide relay for the communication between PIN Elements.\n-\tPIN Element Management Capability Function (PEMCF) which represents the functionality providing the capability to manage the PIN.\n-\tPIN Network Function(P-NF) is a 5GC NF and represents the functionality providing the capability to manage the PIN in 5GC, e.g. processing the request of creating PIN, choosing a UE to be a PEMC and distribute a PIN ID to identify a PIN, etc.\nEditor's note:\tSecurity and privacy aspects of PIN identifier is FFS and is left to SA WG3.\nThe following definitions also apply:\n-\tThe PINE is a device supporting the PEF.\n-\tThe PEGC is an UE supporting the PEGCF\n-\tThe PEMC is an UE supporting the PEMCF\nA UE can support both PEGCF and PEMCF, furthermore a UE can support the PEF function in order to exchange data information and/or provide PIN services to other PINE in the PIN.\nThe PINE per assumption can use the non-3GPP access (e.g. WIFI, Bluetooth) for direct communication to other PINE, PEGC and PEMC so the following type of device that contain the PEF are considered:\n1)\tA Non-3GPP device, i.e. a device that does not support 3GPP Access or N3GPP Access to 5GC, but supports PEF. e.g. a device that uses Bluetooth or Wi-Fi communication.\n2)\tA UE that supports N3GPP Access to 5GC (i.e. N3IWF). The UE is restricted to only use the N3GPP interface for PIN direct communication.\nEditor's note:\tWhether the device not supporting PIN Element Function (PEF) can participate to PIN network, e.g. as today when the UE share the 5G connection via WiFi, is FFS.\nThe following reference points are defined:\n-\tP1 reference point between the PINE device(s).\n-\tP2 reference point between the PEGC and PEMC device(s).\nThe P1 and P2 reference points are supported over Peer-to-Peer (P2P) transports, e.g. Bluetooth, Wi-Fi, The P2 reference point also supports 5G Prose Direct Communication (i.e. UE-to-UE communication).\nThe following Service-based interfaces are defined:\nNpinf:\tService-based provided by the P-NF.\nNpaf:\tService-based provided by AF dedicated to PIN network.\nFigure 6.0B.2-2 shows the typical implementation layers involved in a PIN network, the P2P transport and physical layer (e.g. Bluetooth, wifi, 54G ProSe..) the PIN layer which includes the PIN functionalities (i.e. the PEF, PEGC, PMEC) and the application layer which is out side the scope of 3GPP.\nThe device capable of participating in the PIN the PEF, PECGF, PEMCF and the Peer-to-peer transport layer.\nThe figure 6.0B.2-3 shows the user plane protocol stack for PINE for the scenario of transport of user application data to DNN via PEGC, e.g. web browsing to the internet DNN, for the user application can be also the PIN application which communicates transparently via user plane with the PIN AF. The figure 6.0B.2-4 shows the control plane communication between the PINEs and between the PINE and the PEGC. Figure 6.0B.2-5 and Figure 6.0B.2-6 show the user plane and control plane between PEMC and PEGC respectively.\nEditor's note:\tThe definition of the PIN layer protocol is left to stage 3.\nThe figure depicts a functional layer of a 0 B 2 -2 system, illustrating the various components and their interconnections. The functional layer is crucial for the system's operation, as it handles the processing of data and ensures the smooth functioning of the system.\nFigure 6.0B.2-2: Solution 6 Functional layer\nThe figure depicts a user plane protocol stack for communication towards PIN AF in DNN via PEGC via 5GC user plane, illustrating the various components and their interactions.\nFigure 6.0B.2-3: PINE user plane protocol stacks for communication towards PIN AF in DNN via PEGC via 5GC user plane\nThe figure depicts the PINE control plane protocol stacks, which are essential components of the 5G network. The PINE protocol is designed to efficiently manage the control plane, ensuring smooth and reliable communication between the network's various components. The figure illustrates the layered architecture of the control plane, with each component highlighted in different colors, representing different layers of the protocol stack. This visual representation helps to understand the complexity and interdependencies of the PINE protocol, which is crucial for the efficient operation of a 5G network.\nFigure 6.0B.2-4: PINE control plane protocol stacks\nThe figure depicts the user plane protocol stacks for PEGC and PEMC in a 5G network, showcasing the various layers and components involved in the communication process.\nFigure 6.0B.2-5: PEGC and PEMC user plane protocol stacks\nThe figure depicts the control plane protocol stacks for 0 B and 2-6, which are part of the PEGC and PEMC control plane protocols. The figure illustrates the architecture of these protocols, showing the components and their connections.\nFigure 6.0B.2-6: PEGC and PEMC control plane protocol stacks\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.0B.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "Editor's note:\tThis clause captures impacts on existing 3GPP nodes and functional elements.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.0C\tSolution #0C: Architecture alternative C",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.0C.1\tDescription",
                            "text_content": "This solution addresses Key Issue #1 \"5GC architecture enhancements to support PIN\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.0C.2\tProcedures",
                            "text_content": "The following figure 6.0C.2.1.1-1 depicts the overview of architecture for PIN.\nThe preceding context and figure name suggest that the content of the telecommunication figure is related to a PEMC (Point-to-Multipoint Communication System) and its use in a 5G network. The figure shows a PEMC relaying a signal to a PEGC (Point-to-Multipoint Gateway Communication System) for visiting 5GS (5G Service). The figure provides a visual representation of the communication process, highlighting the use of PEMC and PEGC to facilitate communication between different network components.\nNOTE 1:\tThe PEMC can be a PINE when relayed by PEGC for visiting 5GS.\nNOTE 2:\tThe PEMC can also be a PEGC.\nNOTE 3:\tThe Pin1 interface can over direct connection, via PEGC, or via PEGC and 5GC. The Pin2 interface is over direct connection. The Pin5 interface can over direct connection, or via 5GC.\n\nFigure 6.0C.2.1.1-1: Overview of architecture\nThe figure 6.0C.2.1.2-1 depicts the signalling path of different interfaces of PIN, the figure 6.0C.2.1.2-2 depicts the traffic path within PIN or between PIN and outside services.\nThe figure depicts the signalling path of a PIN, illustrating the various components involved in the communication process. The diagram includes the base station (gNB), user equipment (UE), and scatterers, highlighting the importance of beamforming techniques to mitigate interference.\nFigure 6.0C.2.1.2-1: Signalling path of PIN\nThe figure depicts the traffic path of a PIN (Point-to-Point Interface) in a 5G network, illustrating the various paths through which data can be transmitted. The diagram highlights the importance of signal reflection and interference mitigation techniques, such as beamforming, to ensure reliable communication.\nFigure 6.0C.2.1.2-2: Traffic path of PIN\nFrom above figure, the 5G-LAN for PIN is needed only when traffic within PIN is required.\nThe following figure 6.0C.2.2-1 depicts an example of current smart home environment.\nThe figure depicts a typical smart home environment, showing a connected home with various devices and appliances. The smart home system is connected to a central hub, which is powered by a battery and has a display screen for monitoring and controlling the home's various devices. The home automation system is integrated with a smart thermostat, which can be controlled remotely through a smartphone app. The smart home system also includes a security camera system, which can be accessed through a smart TV. The home automation system is connected to a smart lighting system, which can be controlled through a smart speaker. The smart home system is also connected to a smart refrigerator, which can be controlled through a smart speaker. The smart home system is connected to a smart garage door, which can be controlled through a smart speaker. The smart home system is connected to a smart laundry system, which can be controlled through a smart speaker. The smart home system is connected to a smart security system, which can be controlled through a smart speaker. The smart home system is connected to a smart irrigation system, which can be controlled through a smart speaker. The smart home system is connected to a smart water heater, which can be controlled through a smart speaker. The smart home system is connected to a smart pool, which can be controlled through\nFigure 6.0C.2.2-1: Example of current smart home environment\nThe IoT device1 is initially discovered by a Smartphone using the 3rd party APP1 installed in the Smartphone, and then the Smartphone is able to connect with the IoT device1 assisted by the 3rd party APP1. The 3rd party APP1 is developed by the vendor of the IoT device1. The IoT device1 is able to visit the 3rd party Server1 over internet via the Smart Gateway, and the 3rd party APP1 also can visit the 3rd party Server1 over internet, so that the Smartphone is able to control the IoT device1 via internet assisted by the 3rd party Server1. The IoT device2 is manufactured by a different vendor from that of the IoT device1, and is not able to be controlled by a Smartphone via internet.\nThe following figure 6.0C.2.2-2 depicts a deployment example of the PIN that the PINMF can be a NF, trust AF, or 3rd party AF.\nThe PEMC Function is a crucial component in the 5G network, responsible for managing and controlling the power and energy consumption of the network. It is designed to be flexible and adaptable, allowing it to be integrated with various third-party applications and middleware. The PEMC Function interface is determined by the CT WG 1, which ensures that the interface is consistent and standardized across different applications.\nNOTE 1:\tThe PEMC Function instance can be a function in a 3rd party APP, a standalone APP, or middleware, the interface of the PEMC Function exposed to other APPs is determined by CT WG1.\n\nFigure 6.0C.2.2-2: Deployment example of PIN Functions\nFor the case of NF/trust AF, one operator only has one PINMF, the PEMC can use pre-configured information for PIN service operations, e.g. FQDN of the operator's PINMF. For the case of 3rd party AF, there may be multiple PINMFs, which one is used determines by the user, and the serving PINMF should register itself for the user to handle the PIN service operations. If both PINMF as NF/trust AF and PINMF as 3rd party AF are deployed, which one is used is determined by PEMC implementation.\nIn the deployment example, the 3rd party APP and 3rd party Function can assist the initial discovery and initial direct connection setup between PINE/PEGC and PEMC without user input information.\nAn example of the use case with the deployment example is as following:\n1)\tThe PINE/PEGC establishes direct connection with the PEMC assisted by the 3rd party APP1/APP2 and 3rd party Function1/Function2, which is the same as currently widely used, or by user input.\nNOTE:\tThe interface exposed by PEMC Function to 3rd party APPs needs coordination with CT WG1.\n2)\tIf the PEMC Function instance obtains the device metadata via the direct connection, e.g. MAC address, vendor name, PINE Function Address, etc. from PINE Function (Pin1) over direct connection, or device metadata, e.g. MAC address, GPSI, vendor name, PEGC Function Address, etc. from PEGC Function (Pin5) over direct connection. The PEMC Function instance registers the device metadata to the PINMF (Pin3). The <vendor name> helps the PEMC to run the APP developed by the vendor to control the PINE, e.g. turn on/off a light, tune the temperature of an air conditioner, etc. The PINE/PEGC Function Address makes it possible for any PEMC Function instance (e.g. when user changes cell phone) to interact with the PINE/PEGC Function over direct connection (Pin1/Pin5), via PEGC (Pin1), via 5GS (Pin5), or via PEGC and 5GS (Pin1).\n3)\tAny PEMC Function instance requests the PINMF to create a PIN and obtains device information, which includes the address of PINE/PEGC Function, from PINMF (Pin3), the device may already be added into another PIN. The PEMC Function instance requests the PINMF to add any device into the PIN (Pin3).\n4)\tWhen adding a UE into the PIN to act as PEGC, if the UE identified by the GPSI is pre-configured in the subscription data to be a PEGC, the PINMF configuring <allowed list>/<block list> to the PEGC (N1) for the PIN, if not, the PINMF returns <registration URI> to the PEMC Function instance (Pin3), and the PEMC Function instance sends the URI to the PEGC Function (Pin5), the PEGC Function sends registration request to the PINMF (Pin4) to request the PINMF configuring <allowed list>/<block list> to the PEGC (N1) for the PIN;\n5)\tThe PEMC Function instance obtains the SSID/BT ID and password of PEGCs from PINMF for the PIN (Pin3) and sends them to the PINE (Pin1) for configuring the PINE for discovery (PINE is listener), or obtains the SSID/BT ID and password of PINEs from PINEs (Pin1) and sends them to the PINMF (Pin3) to request the PINMF configuring the PEGC (N1) for discovery (PINE is announcer);\n6)\tAfter a PINE has been configured by the PEMC Function instance (Pin1) to associated with PEGCs, the PINE connects to a PEGC to activate association with the PEGC in the PIN. If the PINE has active association in another PIN, the PINE will be automatically removed from that PIN.\n7)\tWhen the 3rd party APP on PEMC needs to communicate with PINEs, the PEMC Function sends the packet filters and necessary information to the PINMF (Pin3), the PINMF determines that the PINE has connected to a PEGC and instructs the 5GS to configure the PEGC for the relay, as well as instructs 5GS to establish a 5G-LAN that includes the PEMC and the PEGC, or add the PEMC and PEGC into the existed 5G-LAN, so that the communication does not need any Application Server for routing, which resolves the user concern related to privacy issues.\n8)\tWhen the PINE needs to communicates with other PINEs, the PINE Function sends the packet filters and necessary information to the PEMC Function instance (Pin1), if the PEMC Function instance allows the communication, it requests the PINMF (Pin3) to configure PEGC(s) for the relay, and if multiple PEGCs involved, the PINMF instructs 5GS to establish a 5G-LAN that includes the PEGCs, or add the PEGCs into the existed 5G-LAN, so that the communication does not need any AS for routing, which resolves the user concern related to privacy issues.\nThe following figure 6.0C.2.3.1-1 depicts an implementation example of the PEMC, PEGC, and PINE, where the PEGC Function is above OS layer.\nThe figure depicts a 5G network with a focus on signal propagation, illustrating the multi-path signal path and highlighting the importance of beamforming techniques to mitigate interference.\nNOTE:\tInterface Pin2 is not shown.\n\nFigure 6.0C.2.3.1-1: Implementation example - PEGC Function above OS layer\nIn this implementation example, the PEGC Function (1) above OS layer is like a system APP in the UE, the UE does not need to customize OS to support PEGC, but the PEGC Function (1) above OS layer is not able to interact with the PEGC Function (2) in the Communication module when OS is not customized.\nThe following figure 6.0C.2.3.2-1 depicts another implementation example of the PEMC, PEGC, and PINE, where the PEGC Function is in OS layer.\nThe figure depicts a 5G network with a focus on signal propagation, illustrating the multi-path signal path and highlighting the importance of beamforming techniques to mitigate interference.\nNOTE:\tInterface Pin2 is not shown.\n\nFigure 6.0C.2.3.2-1: Implementation example - PEGC Function in OS layer\nIn this implementation example, the UE needs to customize OS to support PEGC, which may not be proper for wearable scenarios, where smartphone that uses common OS core acts as a PEGC, but this implementation example enables the PEGC Function (1) in OS layer to interact with the PEGC Function (2) in Communication module.\nThe following figure 6.0C.2.4.1-1 depicts the control plane between PINE and PEMC over direct connection.\nThe figure depicts the control plane of PINE (Pilotless Network Infrastructure for Enhanced Communication) - PEMC (Pilotless Enhanced Mobile Communication), showcasing its architecture and components. The control plane is a crucial component of PINE, responsible for managing the network's operations and ensuring efficient communication. The figure includes various components such as the PEMC, PEMC-B, and PEMC-C, each playing a specific role in the network's operation. The figure also highlights the use of SDN (Software-Defined Networking) principles in the design of the control plane, allowing for more efficient and flexible network management.\nFigure 6.0C.2.4.1-1: Control plane of PINE - PEMC (over direct connection)\nThe following figure 6.0C.2.4.1-2 depicts the control plane between PINE and PEMC, wherein PINMF is involved in the path of the control plane.\nThe figure depicts the control plane of PINE (Pilot-In-the-Loop) and PEMC (Performance Evaluation and Monitoring Center) systems, which are essential components of the PINE framework. The control plane is responsible for managing the network's operations, including traffic management, resource allocation, and fault detection. The figure shows the various components of the control plane, such as the PINE and PEMC servers, as well as the communication interfaces between them. The presence of the PINMF (Performance Evaluation and Monitoring Center) in the figure indicates that the system is designed to provide real-time performance monitoring and optimization of the network.\nFigure 6.0C.2.4.1-2: Control plane of PINE - PEMC (with PINMF)\nThe following figure 6.0C.2.4.1-3 depicts the control plane between PINE and PEMC, wherein PINE and PEMC is in a LAN.\nThe figure depicts the control plane of PINE (Pilotless Network Enabler) within the LAN (Local Area Network) option, showcasing the various components and their interconnections.\nFigure 6.0C.2.4.1-3: Control plane of PINE - PEMC (within LAN option)\nThe following figure 6.0C.2.4.2-1 depicts the control plane between PINE and PEGC, which is over direct connection.\nThe figure depicts the control plane of PINE (Platform for Internet of Things and Edge Computing) - PEGC, which is a distributed edge computing platform. It illustrates the network architecture, including the control plane, data plane, and network functions virtualization (NFV). The figure shows the interconnection of various components, such as the control plane, data plane, and network functions, to enable efficient and scalable edge computing.\nFigure 6.0C.2.4.2-1: Control plane of PINE - PEGC\nThe following figure 6.0C.2.4.3-1 depicts the control plane between PEMC and PINMF without PEGC involved.\nThe control plane of PEMC, depicted in Figure 6.0C.2.4.3-1, is a crucial component of the PEMC (Platform for Enhanced Management and Control) architecture. It is responsible for managing and controlling the network's operations, ensuring efficient and secure communication. The figure illustrates the control plane's structure, including the various nodes and their respective roles, such as the PEMC (Platform for Enhanced Management and Control) and the PEMC-PEGC (Platform for Enhanced Management and Control-PEM). The control plane is designed to facilitate seamless communication between the various components of the network, ensuring that the overall system operates efficiently and securely.\nFigure 6.0C.2.4.3-1: Control plane of PEMC - PINMF (without PEGC)\nThe following figure 6.0C.2.4.3-2 depicts the control plane between PEMC and PINMF with PEGC involved.\nThe control plane of PEMC, depicted in Figure 6.0C.2.4.3-2, is a crucial component of the PEMC (Power Electronics Management Control) system. It is responsible for managing the power electronics (PE) and managing the power management control (PEMC) functions. The control plane is designed to ensure efficient and reliable power management, with a focus on minimizing power consumption and maximizing system performance. The diagram shows the various components and their connections, including the power electronics, power management control, and the control plane itself. This system is designed to be modular and scalable, allowing for easy expansion and modification as needed.\nFigure 6.0C.2.4.3-2: Control plane of PEMC - PINMF (with PEGC)\nThe following figure 6.0C.2.4.4-1 depicts the control plane between PEGC and PINMF.\nThe figure depicts the control plane of PEGC (Physical Ethernet Control Plane) in the 6.0C.2.4.4-1 network, which is a part of the PEGC (Physical Ethernet Control Plane) architecture. The control plane is responsible for managing the network's physical layer, including the transmission of Ethernet frames, and ensuring the proper functioning of the network. The figure shows the various components of the control plane, such as the physical layer, control plane, and network management functions. The diagram includes a detailed representation of the network's physical layer, including the Ethernet frame, the physical layer interface, and the network management functions. The control plane is shown in a layered structure, with the physical layer at the bottom and the network management functions at the top. The diagram also includes a representation of the network's physical layer interface, which is a crucial component of the PEGC architecture.\nFigure 6.0C.2.4.4-1: Control plane of PEGC - PINMF\nThe following figure 6.0C.2.4.5-1 depicts the control plane between PEGC and PEMC, wherein the PEMC and PEGC is connected over direct connection (non-3GPP access or PC5) or via 5GC.\nThe figure depicts the control plane of PEMC, which includes the P EGC (Physical Edge Gateway Controller) and the P EGC (Physical Edge Gateway Controller). The P EGC is responsible for managing the physical edge network and ensuring the proper functioning of the PEMC. The P EGC is connected to the P EGC (Physical Edge Gateway Controller) through the P EGC (Physical Edge Gateway Controller) and the P EGC (Physical Edge Gateway Controller). The P EGC (Physical Edge Gateway Controller) is responsible for managing the physical edge network and ensuring the proper functioning of the PEMC. The P EGC (Physical Edge Gateway Controller) is connected to the P EGC (Physical Edge Gateway Controller) through the P EGC (Physical Edge Gateway Controller) and the P EGC (Physical Edge Gateway Controller). The P EGC (Physical Edge Gateway Controller) is responsible for managing the physical edge network and ensuring the proper functioning of the PEMC. The P EGC (Physical Edge Gateway Controller) is connected to the P EGC (Physical Edge Gateway Controller) through the P EGC (Physical Edge Gateway Controller) and the P EGC (Physical Edge Gateway Controller). The P EGC (Physical Edge Gateway Controller) is responsible\nFigure 6.0C.2.4.5-1: Control plane of PEMC - PEGC (with LAN option and no additional PEGC)\nThe following figure 6.0C.2.4.5-2 depicts the control plane between PEGC and PEMC, wherein the PEMC and PEGC is connected via another PEGC and 5GC.\nThe figure depicts the control plane of PEMC, which includes the P EGC (Physical Ethernet Control Plane) and the PEGC (Physical Ethernet Gateway Control Plane). The P EGC is responsible for managing the physical Ethernet network, while the PEGC is responsible for managing the physical Ethernet gateway. The figure shows the LAN option and additional PEGC, indicating that the PEMC can support both LAN and WAN connections.\nFigure 6.0C.2.4.5-2: Control plane of PEMC - PEGC (with LAN option and additional PEGC)\nThe following figure 6.0C.2.4.5-3 depicts the control plane between PEMC and PEGC, wherein PINMF is involved in the path of the control plane.\nThe figure depicts the control plane of PEGC (PEM-C) in a 5G network, showing the various components and their interconnections. The diagram illustrates the control plane architecture, including the PEMC (PEM-C) and PINMF (PEM-C) components. The control plane is crucial for managing network functions, ensuring efficient resource allocation, and facilitating communication between different network layers.\nFigure 6.0C.2.4.5-3: Control plane of PEGC - PEMC (with PINMF)\nThe following figure 6.0C.2.5.1-1 depicts the user plane between PINEs.\nThe preceding context and figure name suggest that the telecommunication figure is related to the 3GPP standard, specifically addressing the use of non-3GPP access for address transfer. The figure shows a network architecture with multiple layers, including core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are shown in dashed lines to ensure failover reliability. The layered design aligns with SDN principles.\nNOTE:\tThe PEGC may perform address transfer for source address of received PDU over non-3GPP access before forwarding it over 3GPP access, and/or for destination address of received PDU over 3GPP access before forwarding it over non-3GPP access.\n\nFigure 6.0C.2.5.1-1: User plane between PINEs\nThe following figure 6.0C.2.5.2-1 depicts the user plane between PINE and PEMC.\nThe preceding context and figure name suggest that the telecommunication figure is related to the 3GPP standard, specifically addressing the use of non-3GPP access for address transfer. The figure shows a network architecture with multiple layers, including core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are shown in dashed lines to ensure failover reliability. The layered design aligns with SDN principles.\nNOTE:\tThe PEGC may perform address transfer for source address of received PDU over non-3GPP access before forwarding it over 3GPP access, and/or for destination address of received PDU over 3GPP access before forwarding it over non-3GPP access.\n\nFigure 6.0C.2.5.2-1: User plane of PINE - PEMC\nThe following figure 6.0C.2.5.3-1 depicts the user plane between PINE and external DN.\nThe preceding context and figure name suggest that the telecommunication figure is related to the 3GPP standard, specifically addressing the use of non-3GPP access for address transfer. The figure shows a network architecture with multiple layers, including core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are shown in dashed lines to ensure failover reliability. The layered design aligns with SDN principles.\nNOTE:\tThe PEGC may perform address transfer for source address of received PDU over non-3GPP access before forwarding it over 3GPP access, and/or for destination address of received PDU over 3GPP access before forwarding it over non-3GPP access.\n\nFigure 6.0C.2.5.3-1: User plane of PINE - external DN\nThe following figure 6.0C.2.6-1 depicts the reference architecture for PIN.\nThe preceding context and figure name suggest that the telecommunication figure is related to a network architecture, specifically a fiber-optic backbone. The figure shows a layered design with core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are shown in dashed lines, ensuring failover reliability. The figure is used to illustrate the architecture's design principles, which align with SDN principles.\nNOTE 1:\tThe PINMF can be a NF or trust AF, or 3rd party AF, and can be determined during conclusion phase.\n\nFigure 6.0C.2.6-1: Reference architecture\nThe PIN System Architecture contains the following reference points on application level:\nPin1:\tReference point between the PEMC and the PINE.\nPin2:\tReference point between the PINE and the PEGC.\nPin3:\tReference point between the PEMC and the PINMF, which is over user plane of 5GS.\nPin4:\tReference point between the PEGC and the PINMF, which is over user plane of 5GS.\nPin5:\tReference point between the PEMC and the PEGC, which is over non-3GPP access or PC5.\nThe PINMF (PIN Management Function) is a 3rd party/trusted AF or optionally an NF that includes AF functionality.\nThe PINMF supports the following functionalities:\n-\tAssignment of IDs, including PEMC ID, PEGC ID, PINE ID, and PIN ID.\n-\tRegistration of PINE, PEGC, PEMC.\n-\tAuthorization of PEMC and PEGC.\n-\tManagement of PIN for communication and topology.\n-\tInterworking with 5G NFs (e.g. PCF, UDM) for parameters provisioning to PEGC for discovery and communication.\n-\tStorage of PINE, PEGC, and PEMC information and PINE-PEGC association information.\n-\tConfiguration to PINE and PEMC for discovery.\n-\tQoS control for PEGC and specific PINE traffic flow.\nThe PEMC supports the following functionalities:\n-\tCreation/modification of PIN.\n-\tCommunication configuration for PIN.\n-\tTriggering PEGC to register to PINMF.\n-\tHandling PINE relay request.\nThe PEGC supports the following functionalities:\n-\tRelaying traffic for PINE according to parameters provisioned by 5GS.\n-\tDiscovery PINE.\n-\tAccess control and traffic enforcement for PINEs according to parameters provisioned by 5GS.\nThe PINE supports the following functionalities:\n-\tDiscovery and communication with PEGC.\n-\tDiscovery and communication with other PINEs via PIN direct connection or via PEGC relay path or outside the PIN via a PEGC relay path.\n-\tInteraction with PEMC for configuration and relay handling.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.0C.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "The impacts are described in solutions addresses to KIs other than KI#1, e.g. solution 8 and solution 12.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.0D\tSolution #0D: Personal IoT Networks Architecture in 5GS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.0D.1\tDescription",
                            "text_content": "This solution addresses Key Issue #1 \"5GC architecture enhancements to support PIN\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.0D.2\tProcedures",
                            "text_content": "Figure 6.0D.2.1-1 depicts the reference architecture of Personal IoT Networks in 5GS.\nThe figure depicts a personal IoT network architecture in 5G, illustrating the various components and their interconnections. It includes base stations (BSs), user equipment (UE), and network elements such as routers, switches, and gateways. The architecture is designed to support high-speed data transmission and low latency, with a focus on energy efficiency and network slicing.\nFigure 6.0D.2.1-1: Personal IoT Networks Architecture in 5GS\nP1:\tReference point between the PINE and the PEGC. This reference point is based on non-3GPP access (e.g. WIFI, Bluetooth).\nP2:\tReference point between the PEMC and the PEGC. This reference point is based on non-3GPP access (e.g. WIFI, Bluetooth) or 5G ProSe Direct Communication.\nP3:\tReference point between the PEMC and the PIN Application Server. This reference point can be based on the direct user plane path to 5GS, relay path via the PEGC, or other communication path via Internet.\nP4:\tReference point between the PEGC and the PIN Application Server. This reference point is based on the user plane path between PEGC and 5GS.\nThe PIN Application Server (PIN AS) is an optional NF and includes AF functionality can be deployed by mobile operator or an authorized third party. When the PIN AS is deployed by third party, the interworking with 5GS need to be transferred via NEF. PIN AS may support the following functionalities:\n-\tRegistration management of PINE, PEGC, PEMC.\n-\tPIN management and PIN status management.\n-\tStorage of profile and context data of PIN.\n-\tStorage of profile and context data of PINE, PEGC, PEMC.\n-\tConfiguration and parameters provisioning to PEGC, PEMC, PINE.\n-\tSupporting discovery of PIN, PINE and PEGC.\n-\tAF requested QoS control for PEGC and specific PINE traffic flow.\n-\tInterworking with 5G NFs (e.g. NEF, PCF, UDM, UDR) for provisioning of PIN Service Parameters and requesting policy control.\nThe PEMC supports the following functionalities:\n-\tPIN management (create/modify/delete/activate/deactivate a PIN).\n-\tSupporting add/remove of PINE and PEGC.\n-\tTime validity management of PIN and PINE.\nThe PEGC supports the following functionalities:\n-\tSupporting the relay path between PINE and 5GS.\n-\tSupporting the traffic relay between PINEs.\n-\tSupporting the PINE discovery and status report.\n-\tAccess control and traffic enforcement for PINEs.\n-\tTrigger the activation of communication path with the PINE for DL traffic.\n-\tTraffic routing for non-PIN capable devices.\nThe PINE supports the following functionalities:\n-\tDiscovery and communication with PEGC.\n-\tDiscovery and communication with other PINEs via PIN direct connection or via PEGC relay path or outside the PIN via a PEGC relay path.\n-\tDevice capability and status report.\n-\tPolicy and parameters retrieval and local configuration.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.0D.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "PCF:\tIn addition to the functions defined in TS 23.501 [2], the PCF includes the function to provision the SMF with PCC rules for PIN communication.\nNEF:\tFor PIN Application Functions to provide service specific information to the 3GPP network, the NEF supports additional PIN service parameters.\nUDR:\tThe UDR stores PIN Service Parameters provisioned by PIN AS, and supports the exposure of PIN Service Parameters to the PCF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.0E\tSolution#0E: PIN architecture",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.0E.1\tDescription",
                            "text_content": "This solution addresses Key Issue #1 \"5GC architecture enhancements to support PIN\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.0E.2\tProcedures",
                            "text_content": "Figure 6.0E.2.1-1 depicts the reference PIN architecture without AF/AS involved.\nThe N OTE: PIN architecture without AF involved means that AF is not responsible for PIN management. But PINE can access to the application server and also the AF can influence the traffic as existing mechanism.\nNOTE:\tPIN architecture without AF involved means that AF is not responsible for PIN management. But PINE can access to the application server and also the AF can influence the traffic as existing mechanism.\n\nFigure 6.0E.2.1-1: PIN Architecture without AF involved\nP1:\tReference point between the PINE and the PEMC. This reference point is based on non-3GPP access (e.g. WIFI, Bluetooth).\nP2:\tReference point between the PINE and the PEGC. This reference point can be based on the direct user plane path to 5GS, relay path via the PEGC, or other communication path via Internet.\nP3:\tReference point between the PEMC and the PEGC. This reference point is based on non-3GPP access (e.g. WIFI, Bluetooth) or 5G ProSe Direct Communication.\nThe main functions in PIN architecture above are following:\nPEMC:\n-\tPIN management (e.g. create/modify/delete a PIN).\n-\tPINE management (e.g. add/remove PINE/PEGC).\n-\tAllocate PINE identifier for the PINE.\n-\tStorage of PIN profile data (e.g. PIN ID, PIN name, valid time, etc.).\n-\tStorage of PINE profile data (e.g. PINE ID, PINE type, PINE capability, valid time, etc.).\n-\tSupporting the PINE/PIN discovery.\nPEGC:\n-\tSupporting the relay traffic between PINE and 5GC.\n-\tSupporting the traffic relaying between PINEs.\n-\tSupporting the PIN discovery.\n-\tAccess control and traffic enforcement for PINEs.\nPINE:\n-\tDiscovery and communication with PEGC.\n-\tCommunication with other PINE directly, or via 5GC, or via PEGC.\nUDM:\n-\tAllocate PIN ID associating with PEMC ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.0E.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "The impacts are described in solutions addresses to KIs other than KI#1, e.g. solution 9.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.1\tSolution #1: PIN and PIN element discovery and selection",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1.1\tDescription",
                            "text_content": "This solution mainly addresses the Key Issue#2 \"PIN and PIN element discovery and selection\". This solution also addresses the Key Issue #7 \"Identification of PIN and PIN Elements\" that PEMC assigns PINE ID to a PINE. This solution addresses part of Key Issue #3 \"Management of PIN and PIN Elements\" that PEGC informs 5GC for being a member of a PIN.\nThe solution proposes method for PIN element discovery and PIN selection, PEGC discovery in a PIN, discoverability of PIN elements in a PIN.\nThe following are the key aspects of the solution:\n-\tPIN elements discover a Personal IoT Network either by listening to announcements from a PEMC or by querying for a PIN by its services.\n-\tA PIN could be configured to support either an open or a restricted discovery.\n-\tA PIN element could set its discoverability level within a PIN.\n-\tA PEGC assignment is performed by PEMC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.2\tProcedures",
                            "text_content": "A PIN element offers one or more of PIN Services (these are corresponding to the functionality offered by the PIN element, some examples are audio output device, printer device, display device etc). A PIN might be configured to support only specific services.\nThere are two methods by which PIN elements discover and join a PIN.\nBoth methods are running on top of Non-3GPP (Bluetooth or WiFi) connections or on top of NR PC5 Direct Communication.\nNOTE:\tNR PC5 applies only for PIN elements with Gateway Capability and PIN elements with Management Capability.\nThe figure depicts a PIN element function, which is a crucial component in the communication system. It illustrates the various functions and operations performed by the PIN element, such as data transmission, error detection, and error correction. The figure provides a clear and concise representation of the PIN element's role in the communication process, making it easier to understand and interpret.\nFigure 6.1.2.1.1-1: PIN Element function\nThe first step is to discover PIN element functions on devices that are connected using any of these methods.  The following call flow explains the two methods of PIN element (PIN E) discovery.\nThe figure depicts a PIN discovery process, with the first step being the identification of the PIN, followed by the subsequent steps of the discovery process.\nFigure 6.1.2.1.1-2: PIN discovery\nMethod 1:\nIn this method, PEMC periodically sends PIN related information and waits for a response within a time window. The announced information includes PIN identifier, PIN services offered (including services over 5GS), PIN Class (open to all or restricted), time window within which PEMC expects join requests from PIN elements.\nA PIN is created by PEMC. PEMC periodically announces PIN parameters. This could be transmissions on multiple connections (Bluetooth links) or broadcast (WiFi, PC5)\nPIN elements receive the announcement from PEMC and depending on their local configurations decide whether to join the PIN or wait for another PEMC broadcast. For joining the PIN, a PIN element sends PIN Join Request. This contains the services the PIN element offers in the PIN and also whether PIN element can be discovered by other PIN elements within the PIN or externally. The PIN Join request can also carry security credentials which enables PEMC to successfully validate a PIN element and adds it to the PIN.\nA PIN Join Accept is sent by the PEMC through which the PIN element is informed of its PIN Element Identifier. The PIN Join Accept also include PIN Element Identifier for PEGC applicable for this PIN element.\nMethod 2:\nIn the second method, a PEMC, after it has been authorized by 5GC for PIN operation, begins to monitor incoming queries for PIN services. Depending on a local configuration or an announcement of PEMC information, e.g. PEMC or PEGC ID, a PIN element sends out a query to the PEMC and waits for response. PEMC announces PIN related information. This includes PIN identity, PIN services, PIN Class (open to all or restricted), time window within which PEMC expects \"PIN Join\" requests from PIN elements. PIN element then sends a PIN Join request as described for Method 1.\nEditor's note:\tWhether the protocol of the PIN layer is defined by 3GPP or it uses IETF protocols or part of Prose signalling is FFS.\nThere are three broad classes of PIN:\n1.\tPrivate PIN (e.g. home network).\n2.\tPublic PIN (e.g. shopping mall).\n3.\tPersonal Body area PIN (e.g. smart watch, smart glasses).\nPIN supports two types of discovery - open and restricted discovery. In an open discovery any PIN element can attempt to join the PIN. The restricted discovery allows only PIN elements which have been configured with the PIN information to join. This configuration could be based on user input or local configuration in devices.\nA PEMC offers a lookup service, where in a PIN element (either a member of the PIN or one that has not yet joined the PIN) is able to query for a PIN element identifier corresponding to a service.\nA PIN element can set its visibility when joining a PIN. PIN elements can also indicate whether they want to share their information to other elements by PEMC. PIN element visibility can be set to {Private = PIN element cannot be looked up by other PIN elements}, {Restricted = PIN element can be discovered by other members of the PIN}, {Public= PIN element can be discovered by anyone querying for it, irrespective of whether they are a member of the PIN or not}.\nThe figure depicts a 1.2.2 -1 PIN element discovery process, illustrating the steps involved in identifying and locating a specific PIN element within a network. The diagram shows the various components and their connections, highlighting the importance of proper identification and location in ensuring network security and integrity.\nFigure 6.1.2.2-1: PIN element discovery\nA UE capable of PEGC functionality is authorized for PIN operation by the 5GC.\nA PEGC joins a PIN as a PIN element using either of the above methods. Along with the services, it also indicates in the PIN Join request that it is capable of functioning as a PIN Gateway.\nThe figure depicts a PEGC (Physical-to-Logical-to-Control) election process, which is a crucial step in the network's control plane. The election process involves selecting a logical controller (LUC) to manage the network's physical resources. The figure shows the various steps involved in this process, including the selection of a candidate LUC, the validation of the candidate LUC, and the establishment of the LUC's role in the network. The figure is important for understanding the network's control plane and its role in managing the network's resources.\nFigure 6.1.2.3-1: PEGC selection\nA PEMC selects a PEGC depending on whether it is trusted by PEMC. This could be from pre-configurations. A PEMC can be pre-configured with certain UE identifiers for potentially suitable PEGC (3GPP identifiers e.g. SUCI or GPSI are used to identify trusted PEGCs). A PEMC can also query within a PIN to find any pre-configured UE that can function as PEGC in the PIN.\nPEMC assigns the role of PEGC by sending PEGC Assign Request to a PIN element capable of Gateway function. Once the PIN element accepts the PEGC assignment, it responds with PEGC Assign Accept. PEGC informs the membership of a PIN to the 5GC in PDU Session Establishment/Modification by including the PIN identifier for which it is acting as a PIN Gateway.\nA PEGC can also indicate to the PEMC that it wants to stop functioning as a Gateway. This could be due to power consumption limitations or moving out of coverage of cellular network. In this case, PEGC sends a PEGC Release Request to PEMC. The PEMC will run the PEGC selection procedure again and confirms the role change to the former PEGC with PEGC Release Confirm.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "Editor's note:\tThis clause captures impacts on existing 3GPP nodes and functional elements.\nUE: implements the PIN Element Function protocol.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2\tSolution #2: PIN and PINE discovery and selection",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tDescription",
                            "text_content": "This solution is based on the architecture alternative A describe in clause 6.0A.\nThis solution mainly addresses KI#2 and describes the PINE services discovery and selecting PEMC, PEGC and PINE functionality in the PIN network. This solution also addresses part of KI#3 for management of the association between PINE and PEGC.\nThe figure depicts a schematic of a PIN and PIN element discovery and selection process in a 5G network. It illustrates the steps involved in identifying and selecting the appropriate PINs for communication, highlighting the importance of proper selection for reliable communication.\nFigure 6.2.1.2-1: PIN and PIN element discovery and selection\nThis solution assumes that the PIN elements are connected to a wireless LAN/ PAN network and each element are reachable via the wireless link. The procedure to connect to the wireless network and assign IP address is out of the scope of this document.\nPEMC Identification: A NAS capable UE will register with the 5GS with \"PIN capable\" in the initial registration message to be authorized to form the PIN. 5GC architecture enhancements to support PIN are described in the solution for KI#1. Based on the \"PIN control function\" policies, the 5G core will authorize/deny the PIN formation. PIN element is identified as PEMC either by the 5GC policies or by 3rd party configuration. A PIN element with management capability (PEMC) can form a PIN and it can name the PIN based on the configuration. PEMC of the PIN will act as a broker in the proposed SBA architecture and respond to the PIN discovery query by the PINE or PEGC as shown in Figure 6.2.1.2-1 (a). PEMC will be NAS capable, and the policies and its capabilities are configured by the 5G core network. Policy and Provisioning for PIN are described in solution for KI#5.\nPEMC Discovery: This solution assumes that the PIN Elements in a PIN network are reachable via a wireless link such as WiFi, Bluetooth, WiGi etc. A device intending to join a PIN network will broadcast an http message for PIN discovery, and PEMC, when active, will respond to the query with PIN name and its capabilities as shown in Figure 6.2.1.2-1 (b). Once a device discovers the PIN networks and decides to join the PIN network based on the PINE local configuration. The device will authorize and register its services with the PEMC as described in solutions to KI#5.\nPEMC discovery Broadcast message: This solution uses IP broadcast message to discover PEMC. Unlike conventional http over TCP, this solution proposes to send an Http discovery message over UDP + IP broadcast address, so that all the devices connected wirelessly get the http-based broadcast message. PIN elements can discover PEMC by broadcasting this http discovery broadcast message and the appropriate all PEMC of different PIN will respond to the queries. Similarly, PEMC will periodically and upon successful PIN registration will send http-based discovery message to all the wirelessly connected devices.\nPIN Elements Discovery: The registered PINE can discover other PINE using the PINE discovery query to the PEMC (broker) as shown in Figure 6.2.1.2-1 (b). The PEMC will respond to the query with the list of all the devices, services and its FQDN or IP address. PIN elements can subscribe-notify for an event with the PEMC for example if a PINE wants to be notified when a PEGC or PINE with certain capabilities such as printer, scanner etc. joins the PIN.\nPEGC Selection and Discovery: UE capable of NAS will register itself with the 5GC using registration procedure given in TS 23.501 [2]. The UE will then discover the PIN using the PIN discovery query, will authenticate and register its gateway services with the PEMC. The PEMC will notify the subscribed PIN elements and it will include PEGC producer in the all the future PINE discovery queries. PEMC will assign PEGC to appropriate PINE based on the policies and notify both PINE and PEGC about their association.\nEditor's note:\tThe scenario of PEGC and PEMC not in same location is FFS\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tProcedures",
                            "text_content": "Editor's note:\tDetailed procedure is FFS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tImpacts on services, entities and interfaces",
                            "text_content": "The solution largely re-uses existing functionality\nThe solution has the following impacts:\nImpact to the UE (PEMC):\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features\n-\tAbility to maintain a list of all the PINE and its supported services\nImpact to the UE (PINE/PEGC):\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features\nImpact to the 5G System:\n-\tAdd new Network Function (PINCTL) to the NAS in 5GS\n-\tAdd new fields to the Registration request such as \"PIN capable\"\n-\tAdd new fields to the Registration Accept message such as \"PIN allowable\", \"PIN Name\"\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tSolution #3: Solution for PIN and PIN Elements discovery and selection",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tDescription",
                            "text_content": "This solution addresses Key Issue #2 \"PIN and PIN Element discovery and selection\".\nThis solution assumes the PINE is configured with basic information to select the PEMC as part of KI#6. Thus, PINE is able to select the PEMC and send the PIN_join request to join the PIN.\nThe PIN_join message contains the PIN Information as described in the clause 6.3.3.\nBased on the PIN information and available subscription information with PEMC, the PEMC decides whether to add the PINE into the PIN, in response PEMC may provide PEGC_name to the PIN in PIN_join_response command, if PINE has to be added to the PIN.\nWhether the PINE is authorised to join the PIN is decided by a solution to KI#5, and how the PINE is joined into the PIN is described using the solution to KI#3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tProcedures",
                            "text_content": "The figure depicts a schematic of a PIN and PIN elements discovery and selection process, highlighting the various components and their functions. The diagram illustrates the process of identifying and selecting PINs for communication systems, emphasizing the importance of proper selection for reliable communication.\nFigure 6.3.2-1: PIN and PIN Elements discovery and selection\n0)\tThe PINE is configured with PIN information (see below) either by 5GC (as part of KI#6), or by the authorised user. The PINE is configured with PEMC_name (e.g. FQDN or address, in general the identifier of the PEMC) either by the 5GC or the authorised user.\n1)\tPINE sends PIN_join message to the PEMC including the PIN information (see below) to the PEMC.\n1a)\tif the required PIN information for e.g. the requested service in the PIN information is not offered by any of the PINs then PEMC may choose to perform announce procedure as described in solution 1 additionally PEMC will broadcasted the required PIN information for e.g. the requested service, based on if any PINE which offers the PIN information for e.g. requested service joins the PIN the step 2a or step 2b are executed.\n2a)\tPEMC based on the PIN information decides whether to add the PINE in the respective PIN. If authorization of the PINE is successful following the solution selected as part of the KI#5, the PINE is added to the PIN by the PEMC, in this case PEMC may provide PEGC_name to the PINE as part of the PIN_join_accept message. The solution selected as part of the KI#3 will describe how to add the PINE by the PEMC to the PIN.\nIf PINE is added to the PIN then PEMC stores the PIN information e.g. Supported service/device type part of the PIN information to identify that PIN supports particular service for e.g. Printer. The discoverability criteria based on which this PINE is discoverable to other PINE in the PIN.\n2b)\tBased on PIN information if the PEMC is not able to select the PIN for example the respective service is not supported by any of the PINs or the PIN for respective group ID is not yet active then PIN_join_reject message is sent to the PINE. The PINE should not request for same PIN information for implementation dependent time.\nThe PIN information is at least one of the following:\na)\tSupported Service/device type (e.g. IOT, printer): Indicate particular service supported by the PINE.\nb)\tRequested Service/device type (e.g. IOT, Printer): Indicate the requested service which the PIN should support in which this PINE has to be added.\nc)\tGroup ID (also called as PIN ID): The group ID configured by the authorised user or the 5GC, indicates the request to join the PIN which supports a particular group.\nd)\tUser defined name: This is a plain string configured by authorized user or the 5GC in the PINE. Based on this plain string PEMC identifies which PIN the PINE should be added. This plain string can be any configurable text for example it can be an ID or PIN_NAME or PIN_DISCOVERY name etc.\ne)\tDiscoverability criteria:\nThe PINE is allowed to be discovered if requested for:\n1)\ta specific service.\n2)\ta specific group ID.\n3)\ta specific user defined name.\n4)\ta specific time for e.g. time slot.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "Editor's note:\tThis clause captures impacts on existing 3GPP nodes and functional elements.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4A\tSolution #4A: PIN and PIN Element discovery by A PINE",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4A.1\tDescription",
                            "text_content": "This solution resolves aspects of Key Issue #2 \"PIN and PIN Element discovery and selection\" that relate to how to discover PIN Elements in a PIN.\nIn this solution, connections between PINEs depends on lower layer (e.g. WIFI, Bluetooth), which is out of 3GPP scope. The PINEs (including PEMC and PEGC) communicate with each other for PIN discovery via established connections.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4A.2\tProcedures",
                            "text_content": "Figure 6 illustrates the discovery of PINs and PIN elements in a 4-port network. The diagram shows the network's topology, including the 4-port switch, 2-port router, and 1-port switch. The discovery process involves identifying the network's physical topology and identifying the corresponding network elements. This process is crucial for network management and troubleshooting.\nFigure 6.4A.2-1: PIN and PIN Element discovery\n0.\tConnections have been established between PEMC and other PINEs (including PEGC). How to establish connection depends on the lower layer (e.g. WiFi, Bluetooth), which is out of 3GPP scope.\n1.\tPEMC provides PIN discovery policy configuration to PINEs via the established connections from step 0. The PIN discovery policy includes enable/disable discovery, PIN ID used for PIN discovery, PIN information (PIN Elements list, capability, availability, reachability and services).\n2.\tPINEs (including PEGC) broadcast PIN announcements based on received PIN discovery policy. The PIN announcement includes PIN ID.\nNOTE:\tHow to broadcast the PIN announcement depends on the lower layer, for example, a PIN ID may be broadcasted as SSID in WiFi access.\n3.\tA PINE receives a PIN announcement from a PINE (including PEMC or PEGC). The PINE selects the PIN based on the received PIN ID in the PIN announcement and establishes a connection with the PINE. How to establish connection depends on the lower layer (e.g. WiFi, Bluetooth), which is out of 3GPP scope.\n4.\tThe PINE sends a PIN Solicitation Request, which indicates selected PIN ID and PIN information to be requested, e.g. PINEs in the PIN and corresponding capability, availability, reachability and services.\n5.\tThe PINE, which received the PIN Solicitation Request, sends PIN Solicitation response to the PINE, which includes the PIN information requested by the PIN element.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4A.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "UE:\n-\tPEMC provides PIN discovery policy configuration information to PINEs and PEGCs.\n-\tPINEs (Including PEMC/PEGC) broadcast and receive PIN announcements as per the received PIN discovery policy.\n-\tPINEs (Including PEMC/PEGC) send and respond to PIN solicitation request with PIN solicitation response.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4B\tSolution #4B: PIN Elements with Gateway Capabilities (PEGC) discovery and selection by PEMC",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4B.1\tDescription",
                            "text_content": "The aspect of the key issue #2 that is addressed by this solution is how to discover and select PIN Elements with Gateway Capability (PEGC). This solution also partly addresses Key Issue #6 for PEGC selection parameters provisioning to PEMC via 5GC.\nA typical PIN would consist of different PINEs (sensors, AR/VR, smart TV etc.) and these PINEs have different requirements and as such it could be possible that they require access to different 5G core networks services. This may mean that they need to use different PEGC's to communicate with the different core networks to access required services.\nA PEMC which does the management of the PINEs, would take into consideration PIN element types, connectivity & QoS requirements and accordingly, select a PEGC to ensure PINEs are connected to their respective core networks and meet required QoS requirements.\nThe solution addresses the above aspect and explains how a PEMC (PIN element with management capability) could be configured with the policy parameters and other information for PEGC selection.\nIn this solution, connections between PINEs depends on the lower layer (e.g. WIFI, Bluetooth), which is out of 3GPP scope. The PINEs (including PEMC and PEGC) communicate with each other for PIN discovery via established connections.\nA PIN may have several PINEs with different characteristics such as wearable devices, home automation devices, in the office or smart industrial automation devices, having different requirements and roles in terms of size, weight, power consumption, mission critical, high bandwidth and so forth. Users may create a network of all or subset of these devices (PIN) and for each PIN there can be one or more PEGCs available.\nTo make selection of most appropriate PEGC, the PEMC can consider PINEs characteristics (PIN Types supported, CN Connectivity, Power source, QoS support, network slice) or PIN type (Sensor Type, AR/VR, smart light, plug, UE, etc.). The PEMC could be configured with the identities, capabilities, and prioritization information for PEGCs as follows.\n1.\tThe PEMC device could be configured by the application layer/user interface with required information for PEGC selection. This could be something as \"user defined prioritized list of PEGCs\" along with the PEGC capabilities i.e. PEGC ID, PIN Type supported, QoS Support, 5G CN Identifier, Network slice, etc.\n2.\tThe PEGC selection parameters could be received by the PEMC during the registration procedure with the 5G core network, based on the provided PEMC capabilities in the registration request procedure. PEMC could request or receive data from active PINEs to learn PINEs characteristics before requesting 5G core network for parameters for PEGC selection.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4B.2\tProcedures",
                            "text_content": "In this option PEMC could request the 5G core network for PEGC selection information.\nThe figure depicts the PEGC selection information during the initial registration procedure, which is crucial for ensuring the correct selection of the physical layer (PHY) for the communication link. The figure shows the selection criteria, such as the number of physical layers (PELs) and the number of physical layers in the link, as well as the selection of the physical layer (PHY) for each PEG. This information is essential for the proper configuration of the communication link and ensures reliable communication.\nFigure 6.4B.2-1: PEGC selection information during initial registration procedure\n1.\tPEMC has successfully established connection with the PINEs via lower layers (i.e. WiFi, Bluetooth), which is out of 3GPP scope, determines the PIN type and PIN characteristics (PIN Type, size, QoS requirements etc.) and will accordingly request PEGC selection information from the 5G core network.\n2.\tThe UE sends registration request messages and indicates its support as PEMC in the 5GMM Capability information element and provides PEMC capabilities (PIN Type, size, QoS requirements etc.).\n3.\tThe AMF sends a registration accept message including \"network provided prioritized list of PEGCs\" list along with the PEGC capabilities i.e. PEGC IDs, PIN Type supported, CN Connectivity parameters, QoS Support, 5G CN Identifier, Network slice etc.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4B.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "UE (PEMC):\n-\tDetermines PIN characteristics based on the request from the PINEs to form the PIN.\n-\tIndicates support for PEMC Capability in the UE 5GMM Capability information element of the Registration Request message.\n-\tReceives PEGC selection information as part of the registration accept message.\nAMF:\n-\tReceives the indication of support for PEMC Capability in the UE 5GMM Capability information element of the Registration Request message.\n-\tDetermines PEGC selection information based on request from the PEMC (UE).\n-\tProvides PEGC selection information as part of the registration accept message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tSolution #5: Solution for authorization and management of PIN and PIN Elements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tDescription",
                            "text_content": "This solution mainly addresses Key Issue #3 \"Management of PIN and PIN Elements\", also partly addresses Key Issue #4 \"Communication of PIN\" for PINE visiting 5GC via PEGC.\nThe registration management is used to register or deregister a PEMC/PEGC/PINE with the PIN Application Server, and maintain the user context in the network.\nThe Initial Registration procedure involves execution of PEMC/PEGC/PINE authentication and access authorization based on the configuration of the owner of the device.\nOnce registered and if applicable the PEMC/PEGC/PINE updates its registration with the PIN Application Server:\n-\tperiodically, in order to remain reachable; or\n-\tto update its status, or\n-\tto update its communication path; or\n-\tto update its capabilities or parameters,\nThe profile of PINE/PEGC/PEMC is stored or updated in PIN AS after successful registration. The device profile may include following information:\n-\tDevice ID,\n-\tDevice name,\n-\tMAC address or Bluetooth ID,\n-\tGPSI of UE,\n-\tSecurity related information,\n-\tDevice type e.g. PINE, PEMC, PEGC,\n-\tDevice communication capabilities,\n-\tDevice services capabilities.\nA set of device context data of PINE or PEGC in a PIN may include following information:\n-\tAssociated PIN ID,\n-\tAssociated PEGC,\n-\tDevice state,\n-\tAllocated IP addresses/IPv6 prefix,\n-\tAuthorized communication paths.\nThe PEMC is registered into PIN AS and authorized to manage a PIN. The user of the PEMC can initiate the request to create a PIN via P4 reference point with PIN AS.\nThe PIN ID is allocated by PIN AS and an optional PIN Name can be allocated by the PEMC user. The profile and context data of the PIN is stored in PIN AS and synchronized with PEMC.\nFollowing context data may be stored in the PIN profile:\n-\tPIN state (active or inactive),\n-\tList of serving PEMCs, include:\n-\tPEMC ID,\n-\tPEMC state,\n-\tGPSI and PLMN ID.\n-\tList of serving PEGCs, include:\n-\tPEGC ID,\n-\tPEGC state,\n-\tGPSI and PLMN ID.\n-\tList of PINEs\n-\tPINE ID,\n-\tPINE state,\n-\tMAC address, BT ID, or GPSI and PLMN ID,\n-\tThe association with PEGC and other PINEs.\n-\tThe validity duration and the time validity of a PIN and PINE\nThe PEMC may invite/expel a PEGC or PINE in a PIN, and a PINE/PEGC may request to join/leave a PIN. All the request is routed to PIN AS for authorization. After successful authorization, PIN AS updated the PIN profile and modify the context data of the involved PEGC/PINE. The policy and parameters are provisioned to the PEGC via P3 reference point and to PINEs via P1 reference point to enforce the behaviour of the PINE and PEGC.\nAccording to the policy of mobile operator, PIN AS may provision the PIN related information to the NEF, PCF, UDR or UDM for policy control or subscription management.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tProcedures",
                            "text_content": "Figure 6.5.2.1-1 depicts a high-level procedure of PIN Elements registration, PIN management and invitation of PIN Elements to the PIN.\nThe figure depicts the registration and management of PIN elements in a 5G network. It illustrates the process of selecting and configuring PIN elements, as well as the management of PINs to ensure efficient communication.\nFigure 6.5.2.1-1: PIN Elements registration and PIN management\n1-3.\tRegistration of the PIN Elements (e.g. PINE, PEGC, PEMC) to the PIN, includes authentication and authorization of PIN Element, reporting of PIN Element ID and PIN Element profile to the PIN AS. It is assumed that the PIN Elements can communicate with PIN AS via Internet.\n4.\tAfter successful registration, the PEMC sends a request to the PIN AS to create a PIN. The PIN ID is assigned by the PIN AS to the PEMC.\n5.\tThe PEMC requests the PIN AS to add the PEGC into the PIN. If the invitation is accepted by the PEGC, the PIN AS updates the PIN profile and context data. The PIN AS sends configuration and parameters to the PEGC for PIN communication.\n6\tThe PIN AS provisions PIN Service Specific Parameters to the UDR (via NEF) for policy control of the PEGC, include e.g. the PIN ID, default QoS requirement and valid time for PIN communication.\n7.\tThe PEMC requests the PIN AS to add the PINE into the PIN, includes the communication requirement of the PINE, e.g. associated PEGC, whether the PINE is authorised to access 5GS via PEGC, and the QoS requirement. If the invitation is accepted by the PINE, the PIN AS updates the PIN profile and context data. The PIN AS sends configuration and parameters to the PINE and PEGC for PIN communication.\n8.\tThe PIN AS provisions PIN Service specific Parameters to the UDR (via NEF) for the association of the PINE with the PEGC, include e.g. PINE ID, default QoS requirement and valid time for the PINE communication with 5GS.\nThe figure depicts a 5G signal path, illustrating the signal propagation in a 5G network. It shows how signals reflect off buildings (NLOS) and combine at the receiver. Key components include the base station (gNB), user equipment (UE), and scatterers. The diagram highlights beamforming techniques to mitigate interference.\nFigure 6.5.2.2-1: PINE visiting to 5GS via PEGC\n1.\tPDU Session of PEGC is established.\n2.\tApplication layer signalling is exchanged between the PEGC and the PIN AS. A list of PINEs authorized to access the PEGC are provisioned to the PEGC.\n3.\tA PINE requests to access the PEGC for traffic relay to 5GS.\nNOTE:\tThe signalling exchange between PINE and PEGC is based on non-3GPP access (e.g. WIFI, Bluetooth) and application layer deployment.\n4.\tThe PEGC authenticate and authorizes the access of the PINE, and allocates IP address for the PINE.\n5.\tThe PEGC initiates PDU Session modification as defined in clause 4.3.3.2 of TS 23.502 [3].\nThe PEGC sends the PINE information to the SMF via NAS signalling, include the PINE ID, IP address of the PINE, IP address and allocated port number in case of NAT applied.\n6.\tThe SMF updates the PCF with the PINE information in SM Policy Association Modification.\n7.\tThe PCF queries the UDR for PIN Specific Service Parameters with the PINE ID, and receives the QoS requirement of the PINE communication.\nThe PCF derives the PCC rules for the PINE according to the QoS requirement received from the UDR and IP address/port number of the PINE from the SMF.\n8.\tThe PDU Session Modification procedures as specified in clause 4.3.3.2 of TS 23.502 [3] continues from step 2. The QoS flow for the PINE communication with 5GS is established.\n9.\tThe PEGC sends a response to the PINE.\n10.\tThe application traffic of the PINE is relayed to the 5GS via the PEGC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "PIN AS:\tThe PIN AS provisions PIN service specific parameters to the UDR (via NEF) for policy control of the PEGC.\nUDR:\tIn addition to the functions defined in TS 23.501 [2], the UDR performs the storage of PIN Service Parameters.\nNEF:\tFor PIN Application Functions to provide service specific parameters to the 3GPP network, the NEF supports additional PIN service parameters.\nPCF:\tThe PCF queries the UDR for PIN Service Parameters of a PINE and derives the PCC rules for the PINE communication with 5GS.\nSMF:\tThe SMF receives the PINE information via NAS message, and forwards it to PCF in SM Policy Association Modification request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.6\tSolution #6: Management of PIN and PIN Elements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tDescription",
                            "text_content": "This solution is based on architecture alternative B described in clause 6.0B.\nThis solution mainly addresses to Key Issue #3 \"Management of PIN and PIN Elements\". This solution also partly addresses Key Issue #5 \"Authorization for PIN\" and Key Issue #7 \"Identification of PIN and PIN Elements\".\nThis solution intends to enable the management of the PIN, such as creating/modifying a PIN and adding/removing the PIN Elements.\nIn this solution:\na)\t5GC is responsible for management PIN and PIN Elements. In particular, P-NF is new 5GC network function dedicated to PIN, such as for management of PIN and of PIN Elements. The request to create a PIN is sent to the P-NF, and the P-NF can process the request and determine whether UE can act as a PEMC based on the information provided in the request.\nb)\tP-NF is responsible for the identification of PIN and PIN Elements and for assigning the PIN identity. P-NF allocates a globally unique PIN identifier in order to identify the uniquely the PIN. For PIN Elements, it is allowed that a PINE can be added in more than one PIN. Thus, it is recommended to combine a PIN ID and the PINE ID to identify a PIN Elements. The format of PIN Identifier and the generation of PIN Identifier is determined by P-NF.\nc)\tAn authorized AF or UE can request to create a PIN. The request from AF contains the chosen PEMC information.\nd)\tPEMC selects and determines a PEGC via PC5-based mechanism, e.g. ProSe discovery, or via means like Bluetooth. After PEMC selects a PEGC, they establish a PC5 connection or connection via transport layer.\ne)\tBoth PEMC and PEGC are authenticated by 5GC as UE using the 5G registration procedure.\nf)\tIntroduction of a new PIN functions in 5GC managing the PIN.\ng)\tDefinition of PIN layer which decouples the Transport part and the PIN functionalities from the functionalities of the UE or N3GPP devices is in the scope of the PIN SID.\nh)\tThe PINE can only communicate to the PIN AF in DNN via user plane of the PEGC.\ni)\tOnly the PEMC and PEGC can communicate with the P-NF via the 5G NAS.\nj)\tThe PEMC and PEGC can directly communicate with the PIN AF via user plane PDU session.\nk)\tThe protocol between PINE, PEMC and PEGC over the user plane, i.e. via PDU session, is outside the scope of 3GPP.\nl)\tThe PEMC and PEGC belongs to the same PLMN. The roaming scenario is not supported\nm)\tThe solution assumes that the PEMC and the PEGC are located in the same PIN and they can communicate directly\nn)\tThe PEMC manages the PIN network so it has visibility of all PINE currently members of the PIN, and their identity.\no)\tIf the PEMC cannot communicate with PEGC directly, e.g. the PEGC is in the home and PEMC is located in office, the can communication via application layer or user plane PDU session.\nThis solution addresses the following scenarios:\n-\tHow to create and identify a PIN in 5GC.\n-\tHow to choose UE(s) to be PEMC and/or PEGC.\n-\tFor PINE(s), how to join a PIN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.2\tProcedures",
                            "text_content": "Two flow charts about PIN creation and PINE authentication and registration are proposed in the following.\nIn PIN creation, the AF initiates a request to create a PIN, and the request contains the chosen PEMC information. After the PIN creation successful and the PEMC allocated, the PEGC needs to be assigned. A potential discovery method of PEGC is shown below. More details can be seen in clause 6.6.2.1.\nThe PIN creation procedure is described in this clause.\nThe figure depicts a procedure for PIN creation and management in a 6.2-1 system, illustrating the steps involved in creating and managing PINs.\nFigure 6.6.2-1: Procedure for PIN Creation and Management\n0a-0b.\tThe UE supporting the PEMCF and PEGCF registered to 5GC before PIN creation. The PEMCF may interact with the PIN AF over the user plane based PIN specific application mechanism and procedure which are transparent to 3GPP and out of the scope, for example the PIN AF may get a message informing that PEMCF is connected and available.\n1a-1b:\tAF can send a PIN setup request to P-NF via NEF to create the PIN network within the 5GC, and the request contains the chosen PEMCF information.\n2.\tWhen P-NF receives the request, it needs to send a request to get the chosen PEMC data in order to check whether the UE supporting PEMCF. As defined before, the PEMCF supported UE is allowed to be PEMC.\n3a-3c:\tAfter that P-NF receives the confirm from the UDM, it creates a PIN network and generates the PIN ID if the PIN ID is not requested from the AF. The response is sent to the requestor accordingly.\n4a-4b:\tThe P-NF sends the indication of creation of PIN network to the PEMC with the PIN ID.\n5:\tThe PEMCF can discover the presence of the PEGCF via Prose Discovery mechanism and they establish a Prose Direct communication as transport layer. In case of connection between the PEGCF and PEMCF is via WLAN or BT and how the discovery and the transport layer set up is out of the 3GPP scope. After the establishment of transport layer the PEGCF send the PIN Join request message to the PEMCF with the PIN ID and PEGC ID.\n6a-6b:\tThe PEMCF sends a requests to authentication and authorisation for enabling the PEGCF for the PIN via NAS to the P-NF indicating the identity of the PEGC, the PIN ID, and the PEGC ID.\nNOTE:\tThe PEMCF can send a request to create PEGCF before connection setup between PEMCF and PEGCF. PEMCF may require an authentication of PEGC with the request.\n7:\tThe P-NF needs to send a request to get the UE data in order to check whether the UE supporting PEGCF.\n8:\tAfter the P-NF receives the confirm from UDM, the P-NF update the PIN context adding the PEGC ID to the PIN network.\n9a-9b:\tThe P-NF may notify to the PIN AF the addition of PEGC ID to the PIN ID if the PIN AF has been requested to be notified of PIN status changes in step 1a.\n10a-10b:\tThe P-NF responds to the PMEC about the step 6a result.\n11a-11b:\tThe P-NF informs the chosen PEGC that it is authorized to be the gateway of the PIN network which PIN ID and of the PEMC ID. Also, the PEMC can send the join request result to PEGC like step 11b.\nPINE authentication and registration procedure has the scope to perform the authentication and authorisation of PINE to be added to the PIN.\nThe figure depicts a procedure for PIN element authentication in a 6.2.2-1 standard, which is a crucial aspect of secure communication systems. The figure illustrates the steps involved in validating the authenticity of a PIN, including the use of a PIN pad, a keypad, and a screen. The diagram highlights the importance of proper authentication procedures to prevent unauthorized access to sensitive information.\nFigure 6.6.2.2-1 Procedure for PIN Element authentication\n0.\tThe PINE performs the PIN network discovery procedure.\nNOTE:\tThe PIN Network discovery procedure can reuse some of solution already defined in this TR.\n1.\tThe PINE may send a PIN Join request to the PEGCF of the selected PIN providing its own Identity and the Requested PIN ID. If in step 0 the PINE is not able to identify the requested PIN ID, the device may send the join message to the available identified PEGCF.\n2.\tWhen the PEGCF receives the PIN Join request from the PINE or when it performs the association for establishing the P2P transport layer can send the PIN Join request to the PEMCF without waiting the reception of the PIN Join message from PINE. This step may be specific for the P2P transport layer. The PINE ID may be derived from the previous association. e.g. from BT association, or the MAC address of the PINE.\nEditor's note:\tThe definition of PINE identity is FFS.\n3a-3b:\tThe PEMCF send a PIN identity request in order to trigger the PINE authentication & authorisation providing to the PINE the PIN ID and the PEMCF ID.\n4a-4b:\tThe PINE responds with its PINE ID and the information toward the PEMCF.\n5:\tThe PIN authentication is performed.\nEditor's note:\tThe detailed description of PIN authentication procedure is in SA WG3 scope.\n6a.\tWhen successfully authenticated the PEMC send a PIN update message toward the P-NF. The message is encapsulated in the PIN Container and transported over NAS.\n6b.\tThe AMF forwards the PIN message to P-NF in Npnf_Notify.\n7.\tThe PEMCF send PIN successful authentication to PINE. The PEMC verifies that the PINE ID and whether is authorised to be added to the PIN network.\n8.\tThe P-NF updates the PIN context adding the PINE ID to the PIN network identified by PIN ID.\n9a-9b.\tThe P-NF may notify to the PIN AF the addition of the PINE ID to the PIN ID if the PIN AF has been requested to be notified of PIN status changes.\nEditor's note:\tThe generation of PIN security key will be revised based on SA WG3 study.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.3\tImpacts on services, entities, and interfaces",
                            "text_content": "AMF:\n-\tSupport P-NF container messages.\nP-NF:\n-\tSupport the management of PIN, e.g. assign an authorised UE to be PEMC/PEGC, distribute a PIN ID to identify a PIN.\n-\tSupport the storage of PIN service information.\nNEF:\n-\tInteract with P-NF for exposure of PIN information toward AF.\nUDM:\nSupport to store UE subscription data of PIN capability.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tSolution #7: PIN Management and Communication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.7.1\tDescription",
                            "text_content": "This solution mainly addresses Key Issue #3 \"Management of PIN and PIN Elements\" and Key Issue #4 \"Communication of PIN\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.2\tProcedures",
                            "text_content": "The figure depicts a 5G signal path with various components such as base stations (gNB), user equipment (UE), and scatterers. The diagram highlights beamforming techniques to mitigate interference, and the fiber-optic backbone architecture with core switches, optical line terminals (OLTs), and distributed nodes. The layered design aligns with SDN principles.\nFigure 6.7.2.1-1: PEGC UE Registration with 5GS\nThe PEGC UE registers with the 5GS, with the following changes to the Registration procedure defined in clause 4.2.2.2.2 of TS 23.502 [3]:\n-\tIn the Registration message the PEGC indicates PIN Gateway capability.\n-\tAMF gets the PEGC UE's subscription data from the UDM which may contain information about the maximum number of PINE/ PIN allowed, PIN duration, allowed services, etc.\n-\tIf the subscription does not allow the UE to act as a PEGC the AMF may reject the registration with a new cause code.\nAfter the expiry of the PIN duration indicated to the PEGC by the AMF during the registration, AMF may initiate Network triggered de-registration procedure towards PEGC, as defined in clause 4.2.2.3.3 of TS 23.502 [3].\nNOTE 1:\tPINE management within PIN is managed by the PEMC without involvement of 5GS.\nNOTE 2:\tThe validity duration for individual PINE is handled at the application level by the PEMC or the PIN Application Server.\nThe solution is based on the following assumptions:\n-\tThe IP address allocation for the PINE connected to a PEGC is performed by the PEGC.\n-\tOnly IPv6 addressing is used within a PIN for networking. IPv4 addressing is not used.\n-\tA PIN may have more than one PEGC UEs acting as gateway at the same time.\n-\tA PEGC UE may use multiple PDU sessions to support the communication requirements from various PINE that are connected to the PEGC.\n-\tAn AF configures the PIN specific information required at 5GC level into the UDM/UDR. The information may be provided by the AF to the 5GC for routing policy management in the PEGC and/or for managing the QoS requirements for PIN communication. The information may include:\n-\tPIN Identifier.\n-\tList of authorized PINE connected to the PIN, along with IPv6 address assigned to the PINE.\n-\tList of PEGCs in the PIN along with their IPv6 address.\n-\tURSP guidance information for determining the URSP rules for PEGC.\n-\tQoS information with various PIN traffic flow descriptions.\nPEGC uses the IPv6 Prefix Delegation via DHCPv6 as explained in clause 4.6.2.3 of TS 23.316 [8] for acquiring a network prefix shorter than the default /64 prefix for a PDU Session. If IPv6 stateless autoconfiguration is used, the /64 default prefix used for IPv6 stateless autoconfiguration may be allocated from this network prefix; the remaining address space from the network prefix can be delegated to the PDU session using prefix delegation after the PDU Session establishment and IPv6 prefix allocation via IPv6 stateless address autoconfiguration as defined in clause 5.8.2.2.3 of TS 23.501 [2].\nThe PEGC maintains the address space provided by the SMF as an IPv6 address space pool available to the PDU Session for DHCPv6 IPv6 prefix requests from PINE. The total IPv6 address space available for the PDU Session may be aggregated into one IPv6 prefix that will represent all IPv6 addresses that the PEGC may use.\nAfter a PINE has established connection with the PEGC, it uses Dynamic Host Control Protocol version 6 (DHCPv6) mechanism to acquire an IPv6 address from the PEGC. PEGC assigns an IPv6 address from the address pool available in the PEGC through the IPv6 Prefix Delegation process.\nNOTE:\tThe feature for IPv6 Prefix Delegation via DHCPv6 as explained in clause 4.6.2.3 of TS 23.316 [8] is currently only supported by 5G-RG. The same features will have to be extended to UEs acting as PEGC.\nThe figure depicts the IPv6 address allocation process for PINE (Private Internet Network Environment) using IPv6 Prefix Delegation via DHCPv6. It illustrates the steps involved in assigning IPv6 addresses to PINE, including the use of IPv6 Prefix Delegation, which allows PINE to delegate IPv6 addresses to the internet. The figure also shows the steps for configuring the DHCPv6 server to accept IPv6 addresses from PINE, and the steps for assigning IPv6 addresses to PINE's network devices.\nFigure 6.7.2.2.2-1: IPv6 address allocation to PINE by PEGC using IPv6 Prefix Delegation via DHCPv6\nFigure 6.7.2.2.2-1 above shows the procedure for IPv6 address allocation to a PINE by PEGC. When a single PEGC supports multiple PIN, at least 1 PDU session is established by the PEGC for each individual PIN. Within a single PIN the PEGC may use different PDU session for different set of PINE(s). The process of IPv6 prefix delegation via DHCPv6 is performed for each PDU session that is used for supporting PINE communication.\n1a.\tWhen a PINE establishes a connection with the PEGC and requests relay, the PEGC UE establishes a PDU session based on the URSP rules provided by the network. The PEGC UE may also decide to re-use an existing PDU session based on the URSP rules evaluation. The SMF may allocate an IPv6 prefix to the PDU session during PDU Session establishment.\n1b.\tOptionally a single network prefix shorter than the default /64 prefix may be assigned to a PDU Session. The PEGC acts as a \"Requesting Router\" as described in IETF RFC 3633 [17] and inserts one or more IA_PD option(s) into a DHCPv6 Solicit message sent to the SMF via the user plane. The SMF acts as the DHCP server and fulfils the role of a \"Delegating Router\" according to IETF RFC 3633 [17]. The PEGC UE may optionally include the RAPID_COMMIT option in the DHCPv6 Solicit message to trigger two-message DHCPv6 procedure instead of the four-message DHCPv6 procedure. The SMF sends a DHCPv6 Reply message with one or more IA_PD prefix(es) for every IA_PD option that was received in the DHCPv6 Solicit message.\nIf IPv6 stateless autoconfiguration is used, the /64 default prefix used for IPv6 stateless autoconfiguration may be allocated from this network prefix; the remaining address space from the network prefix may be delegated to the PDU session. The address space is maintained by the PEGC UE as an IPv6 address space pool available to the PDU Session for DHCPv6 IPv6 prefix requests from PINE.\nPEGC UE needs to be configured such that it acts as the \"Requesting Router\" and request IPv6 prefix delegation. Subscription of the PEGC shall allow it to request IPv6 prefix delegation.\n1c.\tPEGC UE allocates IPv6 Prefixes to the PINEs. How the PEGC UE assigns IPv6 Prefixes to the PINE(s) is out-side the scope of 3GPP e.g. the PEGC may act as a DHCPv6 server or PEGC/PINE may use StateLess Address AutoConfiguration (SLAAC) for IPv6 prefix assignment to the PINE.\n1d.\tAfter the IPv6 address prefix allocated to a PINE, the PEGC UE updates the PIN Application server (or the PEMC) about the allocated IP address. This communication happens at the application layer over the user plane and outside the scope of 3GPP specification. The AF (or the PEMC acting as AF) may then use this information to provide QoS requirement for the PINE communication to the 5GC. The AF (or the PEMC acting as AF) may use the \"Setting up an AF session with required QoS procedure\" as defined in clause 4.15.6.6 of TS 23.502 [3] and \"AF session with required QoS update procedure\" as defined in clause 4.15.6.6a of TS 23.502 [3] to provide/update the requested QoS requirement to the 5GC.\n2a-2d\tThe PEGC may repeat the steps 1a through 1d for each PDU session established for PIN communication. The PEGC UE may decide to use an existing PDU session or establish a new PDU session for a PINE communication request based on the evaluation of the URSP rules provided to the PEGC UE by the network. When the PEGC UE decides to re-use an existing PDU session for a PINE communication request, the PEGC UE skips steps  2a, 2b and may peform only step 2c, 2d. An AF (or the PEMC acting as AF) may provide guidance for URSP generation following the procedure for \"Application guidance for URSP determination\" as defined in clause 4.15.6.10 of TS 23.502 [3].\nThe figure depicts a communication system using the PINE (Point-to-Intermediate-Node) protocol, which is a key component in 5G networks. The diagram illustrates the communication path from the source to the destination, with the PINE protocol being used at the intermediate nodes. The figure also includes key components such as the source, intermediate nodes, and the destination, highlighting the importance of this protocol in 5G networks.\nFigure 6.7.2.2.3-1: PINE communication via 5GS\nFigure 6.7.2.3-1 depicts a typical PIN communication scenario.\nWhen a PINE establishes a connection with the PEGC and requests relay, the PEGC assigns IPv6 Prefix to the PINE as described in clause 6.7.2.2. The PEGC UE may re-use an existing PDU session for the PINE communication or may establish a new PDU session. The PEGC UE may establish a PDU Session with type as IPv6 or IPv4/v6. When PDU session type IPv4/v6 is used, the PEGC may provide interworking between the PIN running on IPv6 and network running on IPv4.\nPINE discovers other PINE and PEGC in the PIN as per solutions agreed for KI#2, PIN and PIN Element discovery and selection. Since the Ipv6 Prefix is assigned to the PINE(s) based on IPv6 Prefix Delegation via DHCPv6, the traffic can be routed as shown in Figure 6.7.2.3-1 e.g.:\nPINE1 -> PEGC1 -> SMF1 -> DN -> SMF2 -> PEGC2 -> PINE13.\nThe 5GS provides QoS support for flow within a PDU session of a PEGC UE. To ensure end to end QoS handling for communication between PINE(s) from PEGC1 and PINE(s) from PEGC2 it is assumed that a single AF is responsible for providing QoS requirement to the 5GS and the AF provides QoS requirements for individual service data flow for each PEGC UE. If there are 2 different AF managing PEGC1 and PEGC2, it is assumed that there exists some communication between the two AFs (outside the scope of 3GPP) so that QoS is ensured end to end.\nA new Traffic Descriptor component (Source descriptors) is added into the URSP. This TD component is used by the PEGC UE to match the PINE that is generating the traffic or the PIN from which the traffic is generated, so that the PEGC UE may route traffic generated from different PINE or PIN using different PDU sessions.\nTable 6.7.2.2.4-1: New TD component in URSP\n\nThe \"Source descriptors\" TD may contain one or more of the below information:\n-\ta unique identity of the device that is using the UE as GW e.g. MAC address, source IP address/port, Bluetooth ID or any unique identifier given to the PINE within a PIN.\n-\tIdentity of the PIN (e.g. an SSID of the access point supported by the UE that is acting as a GW, or any other unique identifier used to identify the PIN).\n-\tAny other information that uniquely identify a PIN or a PINE or a device that is using the UE as a GW or an application running on a PINE or a device behind the UE.\nIt is assumed that the H-PCF has the necessary information available to include the \"Source descriptors\" information in the traffic descriptor of the URSP rules for a PEGC UE. The information can be made available to the H-PCF via:\n-\tProvisioning in the UDR as part of UE policy; or\n-\tAn AF providing \"Application guidance for URSP determination\" to the PCF.\nUE that supports the new \"Source descriptors\" TD component shall indicate the same (e.g. in 5GMM capability indication) to the AMF during registration. The PCF may include \"Source descriptors\" in TD of the URSP rule based on the UE's policy subscription data, AF guidance for URSP determination and only when the UE supports the new capability.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.7.2.2.4-1: New TD component in URSP",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.7.3\tImpacts on services, entities and interfaces",
                            "text_content": "The solution has the following impacts:\nUE:\n-\tUE shall indicate the list of other PINE that are served by the UE (acting as PEGC) within PIN to the 5GS.\n-\tUE supports the new \"source descriptor\" TD component for URSP.\nUDM:\n-\tUDM supports PEGC subscription.\nAMF:\n-\tAMF supports new failure cause code to indicate to the UE over NAS based on different failure conditions.\nPCF:\n-\tPCF supports the new \"source descriptor\" TD component for URSP generation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.8\tSolution #8: Management of PIN and PIN Elements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tDescription",
                            "text_content": "This solution is based on architecture alternative C described in clause 6.0C.\nThis solution mainly addresses KI#3 \"Management of PIN and PIN Elements\" and KI#5 \"Authorization for PIN\", i.e. authorization of PEMC management PIN and PEGC providing connectivity to and from 5G network. This solution also addresses part of KI#6 \"Policy and parameters provisioning for PIN\", i.e. the Connection parameters, RAT parameters, Discovery parameters, and Association parameters provisioning, part of KI#2 \"PIN and PIN Element discovery and selection\", i.e. PINE/PEGC broadcast information and PEMC discovers them before PINE/PEGC add into a PIN, and part of KI#7 \"Identification of PIN and PIN Elements\", i.e. PINMF assigns the PIN ID, PEMC ID, PEGC ID, and PINE ID.\nThe figure 6.8.1.2-1 depicts the concept of this solution.\nThe figure depicts a concept of the solution, illustrating the various components and their interconnections in a 5G network. It highlights the importance of signal propagation, beamforming techniques, and the use of optical fiber-optic backbone for reliable communication.\nFigure 6.8.1.2-1: Concept of the solution\nAll PINEs, PEGCs, and PEMCs shall be registered first before adding them into any PIN.\nThe Trust Members in the figure facilitate user to share PIN management among multiple PEMCs. The example of the Trust Members is multiple phones of the user for wearable cases, family members for smart home cases, partner members for smart office cases. The user can assign additional PEMCs from the Trust Members to a PIN. With multiple PEMCs option, the user can pick up any smart phone to manage the PIN that only includes wearable devices, or any family member of the user can buy a new device and update the PIN, which only includes devices in living room, to add the new device in the PIN without waiting the user back home, etc.\nThe Trust Members is a PIN related subscription of user, which includes PEMCs and/or PEGCs. If a PEGC is included in the Trust Members, e.g. the user also subscribes the smart home gateway as a trust member, the authorization of the PEGC is based on the subscription, otherwise the authorization of the PEGC is based on the request from the PEGC. The 5GC uses External Group ID and Internal Group ID to identify the Trust Member Group.\nThe figure 6.8.1.2-2 also shows an example of three PIN instances. The PIN1 incudes PEMC-A and PEMC-B, which means they both are able to update and delete PIN1. The PEMC-C and PEMC-D are included in Trust Members but are not the PEMC of PIN1, so they both only are able to view information of PIN1, e.g. for smart home cases, PEMC-A and PEMC-B belong to parents, while PEMC-C and PEMC-D belong to son and daughter. The PEGC-I included in both PIN1 and PIN2 is in Trust Members, hence it may be pre-configured into PIN1/PIN2 or dynamically added into PIN1/PIN2, and serves both PIN1 and PIN2. The PEGC-II included in PIN3 is not in Trust Members, hence it is dynamically added into the PIN3. The PEGC-III and PINE10 have been registered but not been added into any PIN instance yet.\nThe figure 6.8.1.3-1 depicts the overall procedure for PIN management.\nThe figure depicts the overall procedure for PIN management in a 5G network, illustrating the steps involved in managing point-to-point (P2P) and point-to-multipoint (P2MP) connections. The figure includes a flowchart, which outlines the sequence of actions for each step, ensuring a clear and concise understanding of the process.\nFigure 6.8.1.3-1: Overall procedure for PIN management\n1.\tThe PEMCs register themselves into PINMF first.\n2.\tA PEMC obtains device information of the PINE or PEGC via direct connection, and the PEMC registers the information of PINE or PEGC into PINMF. Using PEMC to register PINE and PEGC into PINMF is for associating the PINE and PEGC with the PEMC or the Trust Member Group of the PEMC.\n3.\t[Optional] In case a PEGC is registered but there's no PIN subscription for the PEGC, e.g. the PEGC is not included in the Trust Members as a PEGC, in order to make sure that the UE is not registered as PEGC unexpected, the PINMF redirects the PEGC via the PEMC to directly register itself into the PINMF.\n4.\tIn case a PEGC is registered, the PINMF requests the 5GC to provision parameters to the PEGC for PIN UP configuration, including PINE Address Allocation Rule and PDU Session Selection Rule.\n5.\tAny PEMC that is included in the Trust Members can query the registered device information and PIN configurations from the PINMF for sync-up.\n6.\tAny PEMC can create a PIN with one or multiple PEMCs that are included in Trust Members, e.g. all family members are able to update a PIN that includes devices in living room to add a new device for the PIN.\n7.\tAny PEMC that is able to manage a PIN can request the PINMF to update the PIN with PEGC and/or PINE addition or removal. In case a PEGC is added into the PIN, the PINMF requests the 5GC to provision parameters that received from the PEMC to the PEGC for PIN connection, including SSID/BT ID, password, etc.\n8.\tAny PEMC that is able to manage a PIN can request the PINMF to update the PIN with PEGC and PINE associations, which can be used for PIN access control. The PINMF requests the 5GC to provision parameters to the PEGC and sends parameters to the PINE via PEMC or a PEGC, the parameters are deduced from the received information from the PEMC.\n9.\tWhen a PINE connects to a PEGC and the connection is accepted by the PEGC, the PEGC indicates the active association information to the PINMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tProcedures",
                            "text_content": "The procedure describes how PEMC registers itself into the PINMF and PINMF registers itself into UDR, which considers that a PEMC may subscribe Trust Member Group.\nThe figure depicts the registration process of PEMC and PINMF, which are key components in the PEMC-PINMF registration scheme. PEMC is responsible for the registration of the physical layer parameters, while PINMF is responsible for the registration of the medium access control parameters. The figure illustrates the process of selecting the appropriate registration parameters and the steps involved in the registration process.\nFigure 6.8.2.1.1-1: Registration of PEMC and registration of PINMF\nPrecondition:\nThe user of the PEMC has subscribed PIN service.\n1.\tThe PEMC sends Registration Request (GPSI) to the PINMF-A, which may be according to the pre-configured information. If the PEMC is behind a PEGC, the PEMC sends Message Transfer Request (Registration Request) to the PEGC, and PEGC sends Transfer Message Request (PEMC Transport Address, Registration Request) to the PINMF.\n2.\tThe PINMF-A interacts with the UDR via UDM or NEF to check whether the UE identified by the GPSI has subscribed to be a PEMC. The UDR returns the subscribed PIN related information, which includes the indicator of whether the UE is a PEMC and the Trust Member Group ID if exists, as well as returns the registered PINMF Info related to the GPSI if exists.\n3.\t[Optional] If the PINMF Info is not received in step 2, the PINMF-A sends PINMF Registration Request (GPSI/Trust Member Group ID, PINMF Info) to the UDM/NEF. The registration of PINMF is for the purpose that when user changes cell phone for the PEMC or uses other PEMC in Trust Members, the management operation can still be done.\n4.\t[Optional] The UDM/NEF queries PINMF Info from the UDR according to the GPSI or Trust Member Group ID. The UDR returns the PINMF Info related to the GPSI or the Trust Member Group ID.\n5.\t[Optional] If the UDR does not return the PINMF Info, the UDM/NEF registers the PINMF-A into UDR related to the GPSI or the Trust Member Group ID.\nNOTE:\tThe UDM/NEF does not handle the successive PINMF Registration Request related to the GPSI or Trust Member Group ID until steps 4 and 5 are finished.\n6.\t[Optional] The UDM/NEF responds to the PINMF-A, which includes the registered PINMF Info.\n7.\tIf the returned PINMF Info in step 2 or step 6 indicates the PINMF-A, the PINMF-A responds to the PEMC with allocated PEMC ID. If the returned PINMF Info in step 6 does not indicate the PINMF-A, the PINMF-A instructs the PEMC to redirect the registration with the PINMF-B that indicated by the received PINMF Info. If the PEMC is behind a PEGC, the PINMF sends Transfer Message Request (PEMC Transport Address, Registration Response) to the PEGC, and the PEGC sends Message Transfer Request (Registration Response (PEMC ID)) to the PEMC.\n8.\t[Optional] If the PEMC is instructed to redirect the registration, steps 1-7a are performed again with the PINMF-B.\nThe procedure describes how a PEMC dynamically creates a PIN without adding or removing PINE/PEGC.\nThe figure depicts a 5G network with various elements such as base stations (gNB), user equipment (UE), and scatterers. It illustrates the signal propagation in a 5G network, highlighting the importance of beamforming techniques to mitigate interference. The figure also shows the fiber-optic backbone architecture, which is a key component of 5G networks.\nFigure 6.8.2.1-1: Create a PIN\nPrecondition:\nThe user may subscribe Trust Members that can act as PEMC or PEGC.\n1.\tThe PEMC sends Create PIN Request (PEMC ID, PIN name, PIN description, [Duration], [additional PEMC GPSIs]) to the PIN Management Function (PINMF) over application layer. The Duration indicates the lifetime of the PIN, the additional PEMC GPSIs indicates additional PEMCs that are allowed to manage the PIN. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 1 of clause 6.8.2.1.1. The PEMC may also send the PLMN ID to PINMF.\n2.\t[Optional] If additional PEMC GPSIs are received, the PINMF checks with the UDR whether the additional PEMCs identified by the additional PEMC GPSIs are included in the Trust Members of the PEMC identified by the PEMC ID. The interaction between PINMF and UDR is via UDM or NEF. The NEF shall verify whether the PINMF is the one that registered with the Trust Member Group. Although there maybe more than one PEMCs included in a PIN, the PINMF only allows one PEMC to control the PIN at any point of time.\n3.\tThe PINMF responds to the PEMC with the allocated PIN ID for the PIN. If the UE identified by the additional PEMC GPSI is not authorized to be a PEMC, the response includes the corresponding error information. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 7 of clause 6.8.2.1.1.\nThe procedure describes how a PEMC updates a PIN without adding or removing PINE/PEGC.\nThe figure depicts a user interface for updating a PIN in a mobile banking application. The interface includes a text field for entering the new PIN, a button for submitting the update, and a confirmation message. The figure shows the layout of the application, with the text field and button on the left, and the confirmation message on the right. The figure also includes a legend to explain the different options available for updating the PIN.\nFigure 6.8.2.1.3-1: Update a PIN\nPrecondition:\nThe user may subscribe Trust Members as describe in clause 6.8.2.1.2.\n1.\t[Optional] The PEMC may perform PIN List Information Query procedure as described in clause 6.8.2.1.5 and/or PIN Information Query procedure as described in clause 6.8.2.1.6. An example usage of this step is that when the user changes cell phone for acting PEMC.\n2.\tThe PEMC sends Update PIN Request (PEMC ID, PIN ID, [PIN name], [PIN description], [Duration], [additional PEMC GPSIs]) to the PINMF. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 1 of clause 6.8.2.1.1.\n3.\t[Optional] The PINMF determines whether the PEMC is allowed to manage the PIN. If yes, when additional PEMC GPSIs are received, the PINMF determines whether there're newly added PEMCs, if so, the PINMF checks with UDR whether the newly added PEMCs are included in Trust Members of the PEMC identified by the PEMC ID, the PINMF removes the PEMCs of the PIN that not identified by the additional PEMC GPSIs. The interaction between PINMF and UDR is via UDM or NEF. The NEF shall verify whether the PINMF is the one that registered with the Trust Member Group.\n4.\tThe PINMF responds to the PEMC. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 7 of clause 6.8.2.1.1.\nThe procedure describes how a PEMC deletes a dynamically created PIN that does not include any PINE/PEGC.\nThe figure depicts a user interface for a mobile device, specifically a smartphone, to delete a PIN. The interface includes a button labeled \"Delete\" and a text field where the user can input the PIN number to be deleted. The figure also includes a confirmation button to ensure the deletion is successful.\nFigure 6.8.2.1.4-1: Delete a PIN\n1.\tThe PEMC sends Delete PIN Request (PEMC ID, PIN ID) to the PINMF. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 1 of clause 6.8.2.1.1.\n2.\tThe PINMF determines whether the PEMC is allowed to manage the PIN. If yes, the PINMF removes the storage information related to the PIN. The PINMF responds to the PEMC. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 7 of clause 6.8.2.1.1.\nThe procedure describes how a PEMC queries the PINMF to obtain the information of PINs that pre-configured or dynamically created by the PEMC or other PEMCs that are trust members of the PEMC. An example usage of this procedure is that when the user changes cell phone for acting PEMC.\nThe figure depicts a query PIN list information interface, allowing users to access and manage their personal identification numbers (PINs) securely.\nFigure 6.8.2.1.5-1: Query PIN list information\nPrecondition:\nThe user may subscribe Trust Members as describe in clause 6.8.2.1.2.\n1.\tThe PEMC sends PIN List Information Query (PEMC ID) to the PINMF. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 1 of clause 6.8.2.1.1.\n2.\t[Optional] The PINMF may interact with the UDR to query the trust members of the UE. The PINMF finds out the PINs that managed by the PEMC and its trust members. The interaction between PINMF and UDR is via UDM or NEF. The NEF shall verify whether the PINMF is the one that registered with the Trust Member Group.\n3.\tThe PINMF responds to the PEMC with the list of PIN information, which includes PIN ID, PIN name, PIN description, and optionally contains Duration. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 7 of clause 6.8.2.1.1.\nThe procedure describes how a PEMC queries the PINMF to obtain the information of a PIN that pre-configured or dynamically created by the PEMC or other PEMCs that are trust members of the PEMC. An example usage of this procedure is that when the user changes cell phone for acting PEMC. If the PEMC is not a manager of the PIN, it is not able to modify or delete the PIN.\nThe figure depicts a user interface for querying PIN information in a telecommunications system. The interface includes a text field for entering the PIN, a button for submitting the query, and a confirmation button for verifying the result. The figure also includes a legend to help users understand the different options available for PIN verification.\nFigure 6.8.2.1.6-1: Query PIN information\nPrecondition:\nThe user may subscribe Trust Members as describe in clause 6.8.2.1.2.\n1.\tThe PEMC sends PIN Information Query (PEMC ID, PIN ID) to the PINMF. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 1 of clause 6.8.2.1.1.\n2.\t[Optional] The PINMF determines whether the PEMC is one of the managers of the PIN, or one of the trust members of the PIN manager. The interaction between PINMF and UDR is via UDM or NEF. The NEF shall verify whether the PINMF is the one that registered with the Trust Member Group.\n3.\tThe PINMF responds to the PEMC with the PIN information, which includes PIN name, PIN description, List of Device Info, Association Info, and optionally includes PEMC GPSIs and Duration. The Device Info is described in clause 6.8.2.2.3, the Association Info is described in clause 6.8.2.3.1. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 7 of clause 6.8.2.1.1.\nEditor's note:\tFor the case that PINMF is 3rd party AF, how the PEMC verifies that the information stored in and returned from the PINMF, which is received from a PEMC by the PINMF, is not tempered needs coordination of SA WG3.\nThe procedure describes how a PEMC registers the PINE into PINMF. An example usage of this procedure is that when initial discovery and initial direct connection establishment between the PEMC and the PINE have been done.\nThe figure depicts a registration process for PINE (Point-to-Point Interference Notification) in a 5G network. It illustrates the steps involved in identifying and resolving interference issues, ensuring a smooth and efficient communication experience for users.\nFigure 6.8.2.2.1-1: Registration of PINE\n1.\tThe PEMC sends Registration Required Request () to the PINE via direct connection. If the PINE has not been registered into PINMF (i.e. no PINE ID is provisioned), the PINE responds OK, otherwise the PINE responds failure.\n2.\tThe PINE sends Registration Request (Device Metadata) to the PEMC. The Device Metadata includes MAC address, vendor name, device description, PINE Function Address. If the PINE is able to be an announcer, the Device Metadata includes Connection Info, which contains, e.g. SSID/BT ID, password. The Device Metadata may include Service Characters Info, which can be, e.g. Recommend QoS Info. The Service Characters Info is used by PINMF to determine, based on the agreement between the PINMF and the operator, the DNN/S-NSSAI related information for the relay path established by PEGC.\nEditor's note:\tFor the case that PINMF is 3rd party AF, exposing password WiFi/BT to the PINMF has privacy concern, and if user want to hide SSID, exposing SSID to the PINMF also has privacy concern, how to secure protect the password from the PINMF needs coordination of SA3.\n3.\tThe PEMC sends Registration Request (PEMC ID, Device Metadata) to the PINMF. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 1 of clause 6.8.2.1.1.\n4.\tThe PINMF determines the registered device is PINE (GPSI is not included in the Device Metadata), it responds to the PEMC with the allocated PINE ID. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 7 of clause 6.8.2.1.1.\n5.\tThe PEMC sends Registration Response (PINE ID) to the PINE.\nThe procedure describes how a PEMC registers the PEGC into PINMF. An example usage of this procedure is that when initial discovery and initial direct connection establishment between the PEMC and the PEGC have been done.\nThe figure depicts a registration process for PEGC (Physical-to-Logical-to-Physical) in a 5G network. It illustrates the steps involved in converting physical network elements into logical ones, ensuring that the network is logically consistent and can be managed effectively.\nFigure 6.8.2.2.2-1: Registration of PEGC\n1.\tThe PEMC sends Registration Required Request () to the PEGC via direct connection. If the PEGC has not been registered into PINMF (i.e. no PEGC ID is provisioned), the PEGC responds OK, otherwise the PEGC responds failure.\n2.\tThe PEGC sends Registration Request (Device Metadata) to the PEMC. The Device Metadata is described in clause 6.8.2.2.1 with following exceptions:\n-\tThe PINE is replaced with PEGC, the PINE Function Address is replaced with PEGC Function Address.\n-\tGPSI of the PEGC is included.\n-\tService Characters Info is not included.\n-\tPLMN ID may be included.\n3.\tThe PEMC sends Registration Request (PEMC ID, Device Metadata) to the PINMF. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 1 of clause 6.8.2.1.1.\nEditor's note:\tFor the case that PINMF is 3rd party AF, exposing password of WiFi/BT to the PINMF has privacy concern, and if user want to hide SSID, exposing SSID to the PINMF also has privacy concern, how to secure protect the password from the PINMF needs coordination of SA WG3.\n4.\tThe PINMF determines the registered device is PEGC (GPSI is included in the Device Metadata), the PINMF interacts with the UDR to query the Trust Members of the PEMC. The interaction between PINMF and UDR is via UDM or NEF. The NEF shall verify whether the PINMF is the one that registered with the Trust Member Group.\nFollowing steps 5-9 and 11 are for the case when the PEGC is not included in the Trust Members.\n5.\t[Optional] If the UE identified by the GPSI is not a PEMC's trust member that acts as a PEGC, the PINMF should determine whether the PEGC is in the same PLMN as the PEMC, if they are not, the authorization is failed and the PINMF shall reject the Registration request and inform the PEMC to disconnect with the PEGC, otherwise the PINMF responds to the PEMC with Registration URI. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 7 of clause 6.8.2.1.1.\n6.\t[Optional] The PEMC responds to the PEGC with the Registration URI.\n7.\t[Optional] The PEGC may close direct connection with PEMC, or the PEMC close the direct connection based on the rejection from PINMF.\n8.\t[Optional] The PEGC connects to 5GS if in CM-IDLE state.\n9.\t[Optional] The PEGC sends Registration Request (GPSI) to the PINMF over a PDU Session according to the Registration URI. The PINMF verifies the registration.\n10.\tNo matter whether steps 5-9 are performed or not, the PINMF sends UP Configuration Request (PEMC GPSI/Trust Member Group ID, PEGC GPSI, List of Service Mapping Rule, [Address Allocation Rule]) to the PCF (optionally via NEF).\nThe Service Mapping Rule includes <Service Type/Default, association information>. The association information may be source IP Ranges, SSIDs, BT IDs, Packet filters, or combination of them. If Default is used, only one Service Mapping Rule is sent.\nThe Address Allocation Rule includes IP Ranges or DHCP Server Address, the IP Ranges are used by the PEGC to assign IP addresses for PINEs, the DHCP Server Address is used by the PEGC to relay the DHCP messages between PINEs and the DHCP Server. With IP Ranges option, the PINEs behind different PEGCs are able to be within different IP domains.\nThe NEF shall verify whether the PINMF is the one that registered with the PEMC GPSI/Trust Member Group.\n11.\tThe PCF queries UDR to obtain the subscribed service types of the PEMC or the Trust Member Group. The PCF generates List of PDU Session Selection Rule according to the List of Service Mapping Rule and the subscribed services. The PDU Session Selection Rule includes < {DNN, S-NSSAI, PDU Session Type, SSC mode}, association information>.\nWith DHCP Server Address option for Address Allocation Rule and association information for the PDU Session Selection Rule including source IP Ranges, the PINMF is able to act as a DHCP Server and allocate IP address for the PINE according to the PINE's Device Metadata (e.g. Recommend QoS Info, pre-configured DN information, device service type, etc.), then the PEGC can map the traffic of the PINE with the corresponding PDU Session according to the PDU Session Selection Rules.\n12.\tThe PCF invokes Namf_Communication_N1N2MessageTransfer (SUPI of PEGC, List of PDU Session Selection Rule, [Address Allocation Rule]) to the AMF.\n13.\tThe AMF sends the parameters via N1 message to the PEGC.\n14.\tIf the UE supports PEGC, the UE sends result to the AMF.\n15.\tIf the result from the UE is received, or timed out for receiving the result from UE (i.e. the UE does not support PEGC), the AMF invokes Namf_Communication_N1MessageNotify to the PCF.\n16.\tThe PCF responds to the PINMF, which indicates whether the UE supports PEGC.\n17.\t[Optional] If steps 5-9 are performed and PINMF is informed that the UE supports PEGC during step 16, the PINMF responds to the PEGC over 5GS with allocated PEGC ID, and the PINMF sends PEMC Event Notification (PEGC ID) to the PEMC. If the PEMC is behind a PEGC, the PINMF sends PEGC Event Notification (PEMC Event Notification) to the PEGC, and the PEGC sends PEMC Event Notification to the PEMC.\n18.\tIf steps 5-9 are not performed and PINMF is informed that the UE supports PEGC during step 16, the PINMF responds to the PEMC with allocated PEGC ID, the PEMC responds to the PEGC with the PEGC ID. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 7 of clause 6.8.2.1.1.\nThe procedure describes how a PEMC queries the PINMF to obtain the information of PINEs/PEGCs that has been registered into the PINMF by the PEMC or other PEMCs that are trust members of the PEMC. An example usage of this procedure is that when the user change cell phone for acting PEMC.\nThe figure depicts a query device list information interface, allowing users to view and manage their device information.\nFigure 6.8.2.2.3-1: Query device list information\nPrecondition:\nThe user may subscribe Trust Members as describe in clause 6.8.2.1.2.\n1.\tThe PEMC sends Device List Information Query Request (PEMC ID) to the PINMF. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 1 of clause 6.8.2.1.1.\n2.\t[Optional] The PINMF queries the UDR to obtain trust members of the PEMC. The PINMF finds out the devices that has been registered into the PINMF by the trust members. The interaction between PINMF and UDR is via UDM or NEF. The NEF shall verify whether the PINMF is the one that registered with the Trust Member Group.\n3.\tThe PINMF responds to the PEMC with the List of Device Info, which includes PINE ID/PEGC ID, MAC address, type (PEGC of PINE), vendor name, device description, PINE/PEGC Function Address. If the PINE/PEGC is able to be an announcer, the Device Info includes Connection Info, which contains, e.g. SSID/BT ID, password. If the PINE has active association in a PIN, the Device Info includes IP address(es) and association information (e.g. direct, PEGC routable, 5GC routable, etc.). If the type is PEGC, the Device Info includes IP address(es) and association information (e.g. direct, inner, 5GC routable, etc.). If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 7 of clause 6.8.2.1.1.\nEditor's note:\tFor the case that PINMF is 3rd party AF, how the PEMC verifies that the Device Information stored in and returned from the PINMF, which is received from a PEMC by the PINMF, is not tempered needs coordination of SA WG3.\nThe procedure describes how a PEMC adds/updates/removes PINEs for a PIN.\nThe figure depicts a graphical representation of a PIN (Point-to-Point Interface) setup, with various components such as the interface, the interface card, and the interface controller. The figure illustrates the process of adding, updating, or removing PINs for a specific interface, with arrows indicating the flow of data between the interface and the interface card. The figure is used to demonstrate the functionality of a PIN setup, allowing users to easily understand the steps involved in setting up and managing a PIN.\nFigure 6.8.2.2.4-1: Add/Update/Remove PINEs for a PIN\n1.\t[Optional] The PEMC performs PINE Registration procedure as described in clause 6.8.2.2.1, or Device List Information Query procedure as described in clause 6.8.2.2.3, or PIN List Information Query procedure as described in clause 6.8.2.1.5, or PIN Information Query procedure as described in clause 6.8.2.1.6.\nFor adding/updating PINE, if the PEMC is able to interact with the PINE (i.e. the PEMC is able to setup direct connection with the PINE, or the Device Info of the PINE includes IP address), the following steps are performed, otherwise stops. For removing PINEs, the following steps are performed.\n2.\tFor adding PINEs, the PEMC sends Create PIN Request (PEMC ID, PIN name, PINE ID, device name, [Connection Info], [RAT Info], [Discovery Info]) or Update PIN Request (PEMC ID, PIN ID, PINE ID, device name, [Connection Info], [RAT Info], [Discovery Info]) to the PINMF. For updating PINEs, the PEMC sends Update PIN Request (PEMC ID, PIN ID, PINE ID, device name, [Connection Info], [RAT Info], [Discovery Info]) to the PINMF. For removing PINEs, the PEMC sends Update PIN Request (PEMC ID, PIN ID, PINE ID) or Delete PIN Request (PEMC ID, PIN ID) to the PINMF. If the PINE is able to be an announcer, the Connection Info may be included to replace the one that already registered in PINMF. The RAT Info and Discovery Info may be included, which are described in clause 6.8.2.2.5 step 9. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 1 of clause 6.8.2.1.1.\nEditor's note:\tFor the case that PINMF is 3rd party AF, exposing password of WiFi/BT to the PINMF has privacy concern, and if user want to hide SSID, exposing SSID to the PINMF also has privacy concern, how to secure protect the password from the PINMF needs coordination of SA WG3.\n3.\tThe PINMF responds to the PEMC. For create/update PIN, the response includes PIN ID. For adding PINEs, the response includes Device Info as described in clause 6.8.2.2.3 with exception that the Connection Info is related to the PIN. For adding PINEs, if the PINE is not reachable according to the IP address(es) in the Device Info, and the PEMC has no direct connection with the PINE, the PEMC performs Remove PINEs procedure and stops. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 7 of clause 6.8.2.1.1.\n4.\tFor adding PINEs, the PEMC sends Create PIN Information Request (PIN ID, PINE ID, [Connection Info], [RAT Info], [Discovery Info]) to the PINE over direct connection, or sends PINE Notification (PEGC ID, PINE ID, Create PIN Information Request) to the PINMF then PINMF sends PEGC Event Notification (PINE ID, Create PIN Information Request) to the PEGC according to the PEGC ID, and the PEGC sends Message Transfer Request (Create PIN Information Request) to the PINE according to the PINE ID. For updating PINEs, the PEMC sends Update PIN Information Request (PIN ID, PINE ID, [Connection Info], [RAT Info], [Discovery Info]) to the PINE or requests PINMF to route the messages as described above. If the PINE is able to be an announcer and the PEMC determines to make the PINE announcer, the Connection Info is included. The RAT Info and Discovery Info may be included. For removing PINEs, the PEMC sends Delete PIN Information Request (PIN ID) to the PINE or requests PINMF to route the message as described above. If the PEMC is behind a PEGC, the message sent to the PINMF is encapsulated in PIN2 and PIN4 interfaces as described in step 1 of clause 6.8.2.1.1.\n5.\tThe PINE responds to the PEMC, or sends Message Transfer Request (PEMC ID, Create/Update/Delete PIN Information Response) to the PEGC, and PEGC sends PEMC Notification (PEMC ID, Create/Update/Delete PIN Information Response) to the PINMF, then PINMF sends Event Notification (Create/Update/Delete PIN Information Response) to the PEMC.\nThe procedure describes how a PEMC adds/removes a PEGC for a PIN.\nThe figure depicts a graphical representation of a PEGC (Point-to-Point Ethernet Gateway Controller) system, which is used for managing point-to-point Ethernet connections. The system includes various components such as the PEGC, Ethernet switch, and network interface controller (NIC). The figure illustrates the process of adding, updating, or removing PEGC s for a specific point-to-point Ethernet connection. The diagram is useful for network administrators to understand the configuration and management of PEGC s in a network.\nFigure 6.8.2.2.5-1: Add/Update/Remove PEGCs for a PIN\nPrecondition:\nThe user may subscribe Trust Members as describe in clause 6.8.2.1.2.\nThe user may change a PEGC with a new one without updating the associated PINE before the replacement, and request the network to reuse the PIN parameters of the old PEGC for the new one.\n1.\t[Optional] The PEMC performs PEGC Registration procedure as described in clause 6.8.2.2.2, or Device List Information Query procedure as described in clause 6.8.2.2.3, or PIN List Information Query procedure as described in clause 6.8.2.1.5, or PIN Information Query procedure as described in clause 6.8.2.1.6.\n2.\tFor adding PEGCs, the PEMC sends Create PIN Request (PEMC ID, PIN name, PEGC ID, device name, [Connection Info], [RAT Info], [Discovery Info]) or Update PIN Request (PEMC ID, PIN ID, PEGC ID, device name, [old PEGC ID], [Connection Info], [RAT Info], [Discovery Info]) to the PINMF. If the PEGC is able to be an announcer, the Connection Info may be included to replace the one that already registered in PINMF. The RAT Info and Discovery Info may be included, which are described in step 9. If the old PEGC ID is provided, the Connection Info, RAT Info, and Discovery Info are not needed, the PINMF uses the corresponding parameters of the old PEGC for the PEGC.\nFor removing PEGCs, the PEMC sends Update PIN Request (PEMC ID, PIN ID, PEGC ID) or Delete PIN Request (PEMC ID, PIN ID) to the PINMF.\nIf the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 1 of clause 6.8.2.1.1.\nEditor's note:\tFor the case that PINMF is 3rd party AF, exposing password of WiFi/BT to the PINMF has privacy concern, and if user want to hide SSID, exposing SSID to the PINMF also has privacy concern, how to secure protect the password from the PINMF needs coordination of SA WG3.\nFollowing steps 3-8 are for PIN Access Policy Provisioning.\n3.\tThe PINMF sends Create/Update/Delete PIN Request (PIN ID, SUPI/GPSI of PEGC, [Connection Info], [RAT Info], [Discovery Info]) to the PCF. The RAT Info includes RAT configuration information, e.g. whether the SSID is hidden or not when device is announcer, activated RAT types (e.g. WiFi, BT), etc. The Discovery Info includes discovery configuration, e.g. open/restrict when device is announcer (e.g. WiFi for open - accept connection for PIN1 and/or PIN2 interaction even when the connection is requested from one that is not in block and allowed MAC list, BT for restrict - accept connection only when the connection is requested from one that is in allowed MAC list), etc. The interaction between PINMF and PCF may be via NEF. The PCF may store the parameters into UDR.\n4.\tThe PCF invokes Namf_Communication_N1N2MessageTransfer (SUPI of PEGC, PIN ID, [Connection Info], [RAT Info], [Discovery Info]) to the AMF.\n5.\tThe AMF sends the PIN ID, Connection Info, RAT Info, and Discovery Info to the PEGC.\nEditor's note:\tFor the case that PINMF is 3rd party AF, how the PEGC authorize that the Connection Info, RAT Info, and Discovery Info are configured by a PEMC needs coordination of SA WG3.\n6.\tIf the UE supports PEGC, the UE sends result to the AMF.\n7.\tIf the result from the UE is received, or timed out for receiving the result from UE (i.e. the UE does not support PEGC), the AMF invokes Namf_Communication_N1MessageNotify to the PCF.\n8.\tThe PCF responds to the PINMF, which indicates whether the UE supports PEGC.\n9.\t[Optional] For creating/updating PIN, the PINMF responds to the PEMC with PIN ID and Device Info of the PEGC. For deleting PIN, the PINMF responds to the PEMC with PIN ID. The information in the Device Info is related to the PIN. If some configuration is not accepted by the PEGC during steps 3-8, the Device Info is included to reflect the update. If the UE does not support PEGC, the Device Info is not included. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 7 of clause 6.8.2.1.1.\nThe procedure describes how an association between PEGC and PINE is created or removed. One PINE can associate with multiple PEGCs, which means, without block indication, the PINE can setup direct connection with any of those PEGCs when they are close each other.\nThe figure depicts a network diagram with various components, including a base station (gNB), user equipment (UE), and scatterers. The diagram illustrates the signal propagation in a 5G network, with key components such as the base station, user equipment, and scatterers. The figure also highlights beamforming techniques to mitigate interference.\nFigure 6.8.2.3.1-1: Create/Remove association between PEGC and PINE\nPrecondition:\nThe PEGC and PINE have been added into the PIN.\nFor creating association with block indication and in case the PINE is announcer, or for creating association without block indication, if the PEMC is able to interact with the PINE (i.e. the PEMC is able to setup direct connection with the PINE, or the Device Info of the PINE includes IP address), the following steps are performed.\n1.\tThe PEMC sends Create/Remove Association Request (PEMC ID, PIN ID, Association Info, [Lifetime]) to the PINMF. The Association Info includes List of <PEGC ID, PINE ID, [block indication]>, and for association creation, the Association Info may include block indication to indicate the direct connection is not allowed to be setup. The Lifetime indicates the duration of the association. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 1 of clause 6.8.2.1.1.\nEditor's note:\tFor the case that PINMF is 3rd party AF, exposure of the Association Info to the PINMF has privacy concern, how to secure protect the Association Info from the PINMF needs coordination of SA WG3.\nFollowing steps 2-7 are for PIN Association Policy Provisioning.\n2-7.\tThese steps are for PIN Association Policy Provisioning, which is similar as described in steps 3-8 of clause 6.8.2.2.5 with following exception:\n-\tThe Association Policy is sent from PINMF to PEGC. The Association Policy includes <allowed MAC addresses> and/or <block MAC addresses> if the PEGC is announcer, and/or <allowed Link Info> and/or <block Link Info>, the Link Info includes SSID/BT ID and password of PINEs, if the PEGC is listener, and may include Lifetime.\nEditor's note:\tFor the case that PINMF is 3rd party AF, how the PEGC authorize that the Association Policy is configured by a PEMC needs coordination of SA WG3.\n8.\tThe PINMF responds to the PEMC with Device Info of PEGC and PINE with the exception that the Connection Info is related to the PIN. If the PEMC is behind a PEGC, the message is encapsulated in PIN2 and PIN4 interfaces as described in step 7 of clause 6.8.2.1.1.\nThe following steps are for creating association with block indication and in case the PINE is announcer, or for creating association without block indication.\n9.\t[Optional] The PEMC may setup direct connection with the PINE.\n10.\t[Optional] For creating association without block indication, the PEMC sends Association Create Request (PIN ID, List of <PEGC ID, PEGC Function Address, [Connection Info], [Link Info], [MAC address of PEGC]>) to the PINE. When the PINE is announcer, the Connection Info is included, which is included in the received Device Info of PINE, and MAC addresses of PEGCs may be included to indicate the PINE only accept the direct connection with the PEGCs corresponding to the MAC addresses.\nFor creating association with block indication and in case the PINE is announcer, the PEMC sends Association Create Request (PIN ID, MAC addresses, block indication) to the PINE, the PINE will not accept the direct connection from the devices corresponding to the MAC addresses.\nFor removing association, the PEMC sends Association Remove Request (PIN ID, [PEGC IDs], [MAC Addresses]) to the PINE, the PINE will remove the MAC addresses from the allowed list or block list, and remove PEGC Function Address, Connection Info, and MAC address corresponding to the PEGC IDs.\nThe PINE response to the PEMC.\nNOTE:\tThe Association Remove Request can be performed by the PEMC to install block list of devices other than PEGC into PINEs.\n11.\tThe PINE may perform Activate association procedure as described in clause 6.8.2.3.2.\nThe procedure describes how an association between PEGC and PINE is established after creation. When the PINE is close to a PEGC that direct connection is allowed to be setup, the procedure is performed.\nThe figure depicts a network setup with various components, including a base station (BTS), a user equipment (UE), and a network element (NE). The BTS is responsible for transmitting signals, while the UE is the device that receives and processes the signal. The NE is a network element that connects the BTS and UE, facilitating communication. The figure also includes a network element (NE) that is connected to the BTS and UE, ensuring that the signal is transmitted and received correctly. The figure is labeled with the figure number \"6.8.2.3.2-1,\" which indicates that it is part of a larger set of figures that describe various aspects of a network setup.\nFigure 6.8.2.3.2-1: Activate association\n1.\t[Optional] The PINE and PEGC setup direct connection.\n2.\t[Optional] If the PINE is a guest (has not registered into PINMF or has not been added into the PIN), the PINE sends Association Activate Request (PIN ID, [PINE ID], [Device Metadata]) to the PEGC. When the PINE has registered into PINMF, the PINE ID is included, otherwise Device Metadata is included.\n3.\tWhen the PEGC receives Association Activate Request from PINE, or the PEGC establishes direct connection with a PINE, the PEGC sends the Association Activate Request to the PEMC directly, or sends PEMC Notification (PEGC ID, Association Activate Request) to PINMF and PINMF sends PEMC Event Notification (PEGC, Association Activate Request) to the PEMC.\nIf PINE ID is not registered by the PEMC and not registered by the trust member of the PEMC (Device List Information Query procedure as described in clause 6.8.2.2.3 may be performed after step 3 for this purpose), the procedure stops.\n4.\t[Optional] If Device Metadata is received and the PEMC allows the PINE joins into the PIN, the PEMC performs steps 2-4 of PINE Registration procedure as described in clause 6.8.2.2.2.\n5.\t[Optional] If the PINE is a guest, the steps 1-8 of Create Association procedure as described in clause 6.8.2.3.1 are performed.\n6.\tThe PEMC responds to the PEGC, which includes the PIN ID, PINE ID. The PEMC sends the response directly or sends PEGC Notification (PEMC ID, PEGC ID, Association Activate Response) to PINMF and PINMF sends PEGC Event Notification (PEMC ID, Association Activate Response) to the PEGC.\n7.\tThe PEMC sends Event Notification (PEMC ID, Association Info, Active indication) to PINMF. The Association Info does not include block indication, the Active indication indicates the related association is active.\n8.\tThe PEGC sends Association Activate Response to the PINE.\nThe procedure describes how an active association between PEGC and PINE is deactivated.\nThe figure depicts a network configuration with various components, including a base station (gNB), user equipment (UE), and scatterers. The diagram illustrates the signal propagation in a 5G network, showing how signals reflect off buildings and combine at the receiver. Key components include the base station, user equipment, and scatterers. The figure highlights beamforming techniques to mitigate interference.\nFigure 6.8.2.3.3-1: Deactivate association\n1.\tIf the PEGC detects the direct connection between PINE and the PEGC is lost (e.g. lost heartbeat between PEGC Function and PINE Function over direct connection), the PEGC sends the Association Deactivate Request to the PEMC directly, or sends PEMC Notification (PEGC ID, Association Activate Request) to PINMF and PINMF sends PEMC Event Notification (PEGC ID, Association Activate Request) to the PEMC.\nDevice List Information Query procedure as described in clause 6.8.2.2.3 may be performed after step 1, e.g. the PEMC Function is recovered from dump.\n2.\tThe PEMC responds to the PEGC, which includes the PIN ID, PINE ID, and PEGC ID. The PEMC sends the response directly or sends PEGC Notification (PEMC ID, PEGC ID, Association Deactivate Response) to PINMF and PINMF sends PEGC Event Notification (PEMC ID, Association Deactivate Response) to the PEGC.\n3.\tThe PEMC sends Event Notification (PEMC ID, Association Info, Deactive indication) to PINMF. The Association Info does not include block indication, the Deactive indication indicates the related association is deactive.\nThe procedure describes how to activate or deactivate a PIN.\nThe figure depicts a user interface for activating or deactivating a PIN in a mobile device. The interface includes a button for activating the PIN, a text field for entering the PIN, and a confirmation button for confirming the PIN. The figure illustrates the user's interaction with the device, providing a clear and intuitive way to manage PINs.\nFigure 6.8.2.4-1: Activate/Deactivate a PIN\n1.\tThe PEMC sends PIN Activate/Deactivate Request (PEMC ID, PIN ID) to the PINMF.\n2.\tThe PINMF authorize whether the PEMC is able to manage the PIN, if authorization succeeds, the PINMF sends PIN Activate/Deactivate Request (PIN ID) to the PINEs via PEGCs. The PINEs stop traffic handling and respond to the PINMF via PEGC.\n3.\tThe PINMF sends PIN Activate/Deactivate Request (SUPI/GPSI, PIN ID) to the PCF per the PEGC in the PIN. The interaction between PINMF and PCF may be via NEF.\n4.\tThe PCF performs steps as described in steps 3-8 of clause 6.8.2.2.5 with indicator that instructs the PEGC to activate/deactivate D2D Routing Rule and D2N Routing Rule that described in solution #12, as well as open/close non-3GPP access radio if the PEGC is listener.\n5.\tThe PCF responds to the PINMF. The interaction between PINMF and PCF may be via NEF.\n6.\tThe PINMF responds to the PEMC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "PINMF:\n-\tSupport PIN ID assignment.\n-\tSupport PEMC and PEGC authorization operation.\n-\tSupport PIN management operations.\n- Support the ability of authorizing PEGC by PLMN.\nUDM:\n-\tSupport PEMC authorization.\n-\tSupport trust members query.\nUDR:\n-\tSupport PIN related information storage.\nNEF:\n-\tSupport exposure of PIN operations.\n-\tSupport interaction with UDR or PCF for PIN operations.\nPCF:\n-\tSupport PIN Parameters creation/update/removal.\nUE (support PEGC):\n-\tSupport PIN Parameters provisioning over NAS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.9\tSolution #9: PIN management and PINE management",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.9.1\tDescription",
                            "text_content": "This solution is to address the KI#3 \"Management of PIN and PIN Elements\", how an authorized UE to create a PIN. And how to add a device (PINE) into a PIN, when a PIN is created and PEMC is available. In this solution, it assumed that UDM is used to create/update/remove PIN profile that includes PIN information and PINEs information, and allocate/manage the PIN ID. And may allocate/manage PINE ID for the PIN. This solution also partly addresses the KI#2 \"PIN and PIN Element discovery and selection\", KI#5 \"Authorization for PIN\", KI#6 \"Policy and parameters provisioning for PIN\", and KI#7 \"Identification of PIN and PIN Elements\".\nIn this solution both PINE Info and PIN Info are defined as following:\nPINE Info:\n-\tPINE ID, unique ID within a PIN that could be allocated by PEMC/PEGC locally, or network.\n-\tPINE type, indicating whether it is PEMC, or PEGC, normal PINE.\n-\tPINE name, human readable information, e.g. printer in bedroom, or lamp in living room.\n-\tService, what the PINE can provide, e.g. printer, or lamp, or camera, etc.\n-\tPINE Valid time, how long for the PINE to be as member in the PIN.\n-\tCapability, indicating the communication capability, e.g. WiFi, BT, etc.\nPIN Info:\n-\tPIN ID, unique ID within a PLMN and allocated by network.\n-\tPIN name, is readable information for user.\n-\tPIN Services, the list of the services that the PINE(s) can provide, e.g. printer, lamp, camera, etc.\n-\tPIN valid time, to define how long the PIN can work, e.g. 30 minutes.\n-\tList of PINE Info, including all the information of PINEs in this PIN.\nEditor's note:\tIt is FFS how to authorize the UE to create PIN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.2\tProcedures",
                            "text_content": "The figure depicts a 9.2.1.1 -1: Authorized UE creating a PIN, which is a crucial step in the authentication process for accessing the network. The figure illustrates the process of creating a PIN, which is a one-time password used to authenticate the user. The figure also shows the steps involved in the authentication process, including the creation of the PIN, the input of the PIN, and the output of the PIN. The figure is important for ensuring the security of the network and preventing unauthorized access.\nFigure 6.9.2.1.1-1: Authorized UE creates a PIN\nHere the authorized UE is allowed by the PIN owner to initiate to create a PIN. When an authorized UE triggers a request to network for creating a PIN, it may bring the candidates PIN Info, e.g. the PIN name, etc. optionally candidates PINE Info, which some of the PIN/PINE Info may be designed by user before creating the PIN, e.g. PINE name, capability, etc.\n1.\tUE sends the request to AMF via gNB for creating a PIN, which including candidate PIN name, candidate PIN Service(s), candidate PIN valid time, optional if available, a list of candidates PINE information containing (candidates PINE ID, candidate PINE name, candidate PINE type, candidate PINE service, candidate PINE capability, candidate PINE valid time).\nWhen PINE ID is allocated by network, the candidates PINE ID is not included.\nNOTE:\tCreate PIN request message can be carried by Registration Request.\nEditor's note:\tWhether Service Request or others possible is FFS.\n2.\tAMF requests to UDM for creating the PIN, with information carried in step 1. AMF may check with UDM whether the UE is authorized to create PIN. If no, the AMF rejects the UE with proper cause.\n3.\tAMF sends the Create PIN response to UE/PEMC if the request is rejected by AMF.\n4.\tUDM allocates the PIN ID based on UE request, and may allocates PINE ID for each candidate PINE if PINE info included in the request, and create PIN profile in the UE's subscription data, including e.g.\nPIN Info:\n-\tPIN ID.\n-\tPIN name, e.g. Jian's smart home.\n-\tPIN Services, e.g. printer service, lamp service, camera service.\n-\tPIN valid time, e.g. 1 year.\n-\tList of PINE Info, including all the information of PINEs in this PIN.\nPINE1 Info:\n-\tPINE ID, e.g. J001.\n-\tPINE type, e.g. PINE.\n-\tPINE name, e.g. printer in bedroom.\n-\tService, e.g. printer service.\n-\tValid time, e.g. 10:00-18:00 each day.\n-\tCapability, e.g. WiFi, BT.\nPINE 2 Info ......\nPINE 3 Info ......\n5.\tUDM response to AMF with result of creating PIN, including the results, full PIN Info {PIN ID, PIN name, PIN Service, PIN valid time, optional list of PINE Info}.\n6.\tAMF sends the service accept to UE via gNB, including results, and full PIN Info.\nThe figure depicts a PIN creation process from a third-party source, illustrating the steps involved in generating a PIN. The process includes selecting a PIN number, entering the desired length, and selecting a security level. The figure also includes a visual representation of the PIN creation process, with arrows indicating the steps and a legend to help users understand the process.\nFigure 6.9.2.1.2-1: PIN creation from 3rd party\nProcedure:\n1.\tAF requests to create a new PIN network to UDM via NEF, including: PIN Info and PINE Info as defined in clause 6.9.1:\nPIN info: PIN ID, PIN name, PIN Service(s), PIN valid time, list of PINE info.\nPINE info: PINE ID, PINE name, PINE type, capability, Service(s) and valid time.\nAt least includes one PEMC, and may include multiple PINEs information.\n2.\tUDM creates PIN network based on the request from AF, by establishing PIN profile to the UE's subscription data to include PIN info received from AF, as well as the new PIN parameters generated by UDM, including PIN ID.\n3.\tWhen PIN is successfully established, UDM sends the PIN create response to AF via NEF, including result (accepted, or rejected), may include PIN info, e.g. PIN ID, other PIN parameters generated by UDM.\nThe result can be delivered to the 3rd party after step 9.\n4.\tUDM determines to trigger UPU procedure to provision the PIN info to the PEMC.\n5-6. UDM sends the PIN info to the PEMC via AMF and gNB.\n7.\tPEMC updates the PIN info locally based on the parameters received from UDM.\nThe figure depicts a PIN deleting triggered by UDM, which is a security feature in a network. It shows the process of a user deleting a PIN from a device, which is a crucial step in ensuring secure communication. The figure also includes a visual representation of the PIN, which is a 4-digit number used for authentication purposes. The UDM (User Data Management) feature is highlighted, which is a part of the network that manages user data and ensures security. The figure is important for understanding the security measures in a network and the role of UDM in maintaining the security of the network.\nFigure 6.9.2.1.3-1: PIN deleting triggered by UDM\n0.\tUDM determines to delete the PIN, due to e.g. PIN valid time expired.\n1.\tUDM sends the PIN delete notification to AMF(s), including PIN ID, PEMC ID(s).\n2.\tAMF sends the PIN delete notification to PEMC(s) via gNB, including PIN ID, PEMC ID(s).\n3.\tPEMC(s) sends the PIN delete notification to all the PINE(s) in this PIN.\n4.\tPINE(s) may send the PIN delete ACK to PEMC.\n5.\tPEMC(s) deletes all the PIN information. This step can be performed after step 2.\n6.\tOptional PEMC(s) sends the PIN delete ACK to UDM via gNB and AMF.\nThe figure depicts a device used to join a PIN, which is a key component in a 2D grid-based game. The device is connected to the grid, allowing players to move and interact with the game. The figure illustrates the grid's structure and the device's role in the game.\nFigure 6.9.2.2.1-1: A device to join a PIN\nIn this solution, it assumed that PEMC broadcasts PIN network information, e.g. PIN ID, PIN name, etc. so that the device discovers and selects the target PEMC, and connection between device and PEMC is established via non-3GPP RATs, e.g. WiFi, BT, etc.\n1.\tA device sends the Join PIN Request to PEMC via the established connection between the device and PEMC, including PIN ID, Device ID, PINE type (optional), capability, Service, name, etc. If PINE type is PEGC, the Join PIN Request should also contain PEGC's PLMN ID.\n2.\tPEMC determines to accept the request. How to determine to accept the request is up to implementation. PEMC allocates the PINE ID for the device. And PEMC determines the PINE type, e.g. act as PEMC, or PEGC, or PINE. If the PINE type is PEGC, the PEMC shall determine whether to accept the request based on the PLMN ID of both PEGC and PEMC. If the PLMN ID of PEGC is the same as the one of PEMC, the request is accepted. Otherwise, the request should be denied.\n3.\tPEMC sends the Join PIN response to the device, including result (accept, or reject), PIN Info and PINE Info as defined in clause 6.9.1.\nPIN info: PIN ID, PIN name, PIN Service(s), PIN valid time, list of PINE info;\nPINE info: PINE ID, PINE name, PINE type, capability, Service(s) and valid time.\n4.\tPEMC sends the PIN update request to AMF via gNB, including UE ID, PIN Info container [PIN ID, new PINE info {PINE ID, PINE type, PINE name, capability, service, valid time}].\nNOTE 1:\tThe PIN update request can be carried by Registration Request.\nEditor's note:\tWhether Service Request or others possible is FFS.\n5.\tAMF sends the Nudm_UECM_Registration Request to UDM for updating the UE's PIN Info, including message received in step 4.\nBefore updating the PIN Info, UDM may determine whether to accept the updating, e.g. accept new PINE.\n6.\tUDM updates the received PIN info to the UE's subscription data.\nWhen a PIN is created, the PIN related information is established as well in the requested UE's subscription data.\n7.\tUDM sends the response to AMF, including the results, and updated PIN Info.\n8.\tAMF sends the PIN update response to PEMC with result (accept, or reject), and updated PIN Info.\n9.\tFor another option instead of step 3, PEMC sends the join PIN Response to device with result, and PIN/PINE info same as in step 3 after PEMC updating the PIN info to UDM.\nNOTE 2:\tIn steps 1, 3 and 9, both application layer and new adapted layer are possible options for delivering the messages.\nThe figure depicts a scenario where an UE (User Equipment) joins a PIN (Point-to-Point Interface) via 5GC (5G Core Network). The diagram illustrates the process of the UE joining the PIN, highlighting the use of 5GC for network connectivity and the role of the 5G Core Network in providing a reliable and efficient network infrastructure.\nFigure 6.9.2.2.2-1 UE joins a PIN via 5GC\n1.\tUE sends the PINE join request to AMF via gNB, including PIN ID, PINE ID, PINE type, valid time, capability, etc.\n2.\tAMF sends the PINE join request to UDM, including PIN ID, PINE ID, PINE type, valid time, capability. AMF checks whether this UE is authorized to use PIN service. if no, the request is rejected.\n3.\tUDM triggers the PIN authenticate/authorization towards to the PEMC.\n4.\tAfter successfully PIN authentication/authorization, UDM updates the PIN profile with the new PINE information (PINE ID, PINE type, valid time, final valid time, or optional allocate PINE ID for the UE if it is not included in the request). UDM may determine the final valid time for the requested PINE\n5.\tUDM sends the PINE join response to AMF, including PINE ID, final valid time, PIN info [PIN ID, PIN service, valid time, etc.\n6.\tAMF sends the PINE Join response to the UE (PINE) via gNB, including the PIN related information in step 5.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "Network impacts:\n-\tUDM allocates PIN ID for each create PIN request.\n-\tUDM may allocate PINE ID for each requested PINE.\n-\tUDM may manage the PIN info and PINE Info.\n-\tAMF requests management of PIN/PINE to UDM based on the PIN related request.\n-\tUE (PEMC) determines whether PEGC can join PIN based on PLMN ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.10\tSolution #10: Management of PIN and PIN Elements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.10.1\tDescription",
                            "text_content": "This solution is based on the architecture alternative A describe in clause 6.0A.\nThis solution addresses KI#3 \"Management of PIN and PIN Elements\".\nThe figure depicts the PIN architecture and gateway to the 5G system, illustrating the various components and their interconnections. The diagram highlights the role of the gateway in managing the network, ensuring seamless communication between different network nodes.\nFigure 6.10.1.2-1: PIN Architecture and gateway to 5G System\nBackground on PIN Communication: Higher layer protocol such as http is used for internal PIN communication and 5G NAS signalling is used to communicate with 5G systems such as PIN registration as described in solution to KI#4. This solution uses IP broadcast message to discover PEMC. Unlike conventional http over TCP, this solution proposes to send an Http discovery message over UDP + IP broadcast address, so that all the devices connected wirelessly get the http-based broadcast message. PIN elements can discover PEMC by broadcasting this http discovery broadcast message and the appropriate PEMC of different PIN(s) will respond to the queries. Similarly, PEMC will periodically and upon successful PIN registration will send http-based discovery message to all the wirelessly connected devices. Once PINE discovers PEMC and gets the registered services and IP address or FQDN, it can communicate with any PINE using http query-response messages as described in solution for KI#4.\nOperator Policies or 3rd party policies: The operator policies are pushed to PIN from \"PIN Control Function\" (PINCTL) via NPINCTL of the 5GC to the PEMC of the PIN as described in solution for KI#1. PEMC will be NAS capable and register to the 5GC or it can register through PEGC. Upon registration and authentication with the 5G network, the PINCTL will communicate the policies to the PEMC. Similarly, the 3rd party configurations should be pushed to the PEMC to enforce them on the PIN network.\nPIN Management: The operator or 3rd party policies will be pushed to the PEMC of the appropriate PIN and the PEMC will update the repositories and notify PIN elements appropriately. The following use cases will further elaborate on management of PIN.\nCase \"Create PIN\": PEMC will broadcast the new PIN announcement using the PIN discovery response message to the connected devices on the wireless network. The devices on the wireless network will intercept and based on its configuration and policies the devices will decide to join the PIN.\nCase \"Modify PIN\": PEMC will update its repository with the updated PIN modification and notify the PIN elements appropriately.\nCase \"Delete PIN\": PEMC will delete its PIN related repository and notify all the PINE about the deletion of the PIN. Once the PIN is deleted, any query-response and subscribe-notify from the PINE will not be honoured.\nCase \"Activate PIN\": PEMC will broadcast the activation of PIN so that the devices in the local wireless network can decide to join the PIN by authenticating and registering with the PEMC.\nCase \"Deactivate PIN\": PEMC will delete all its PIN related repository and it will broadcast about the de-activation of the PIN to the PIN elements. Once the PIN is de-activated, any query-response in the PIN will not be honoured.\nPIN Element Management: The management of the PINE will be pushed to the PEMC either from the network operator or by the 3rd party.\nCase \"Add or delete PINE\": PEMC will add or delete a PINE's FQDN or IP address and its services to the PEMC repository and notify all the registered PINE about the PINE addition or deletion. Once the PINE is deleted, any request and subscribe from the PINE will not be responded or registered respectively.\nCase \"PEGC and PINE association\": Any changes to the PEGC and PINE association will be updated in the PEMC repository and the appropriate PEGC and PINE will be notified about the changes. For eg. Suppose PINE1 was associated with PEGC1 and PEMC is the broker of a PIN network, and if there is policy from the 5GC or 3rd party to change the association of PEGC1 with PINE1 then PEMC will update the old PEMC repository of the association of PEGC1 with PINE1 to PEGC2 with PINE2 and will notify all PEGC1, PEGC2 and PINE1 about the new policy association. After the policy update, PEGC1 will terminate any ongoing association and will not honour any new association request from the PINE1 and PEGC2 will honour and accept all the association from PINE2.\nPIN Duration Validity: PEMC of the PIN network can set a duration of the PIN network by starting a timer based on the allowed duration of the PIN, which will be a policy from the operator or 3rd party policies. At the end of the PIN allowable time, the PEMC will deactivate the PIN as described in case \"Deactivate PIN\". Once the PIN is deactivated, the PEMC will update the PINCTL of the 5G-Core about the PIN deactivation. Optionally, PINCTL can also start a timer to make sure that the PIN is disabled as per the allowable duration.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.2\tProcedures",
                            "text_content": "The figure depicts a PEMC (Power-Efficient Micro-Controller) triggered service request to update the PIN_List. The request is initiated by the PEMC, which is a device responsible for managing power consumption and communication in a micro-controller system. The PIN_List is a list of PINs used to control the system's power and communication functions. The figure illustrates the communication between the PEMC and the system, showing the request being sent to the system's control center for processing.\nFigure 6.10.2.1-1: PEMC Triggered Service Request to update PIN_List\n1.\tWhen a new PINE joins the PIN, the PEMC will send a new Service Request with updated PIN_List to the RAN. A typical Service Request with PIN_List will include \"PINE list\", which contains an updated list of PINE elements and its associated policies and parameters. For example, a typical \"PINE list\" will be as follows:\ni.\tPINE1, PEMC = FALSE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\nii.\tPINE2, PEMC = TRUE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\n2.\tRAN forwards the N2 message (Service Request with the updated PIN_List) to the AMF.\n3.\tConventional Authentication Security is performed according to clause 4.2.3 of TS 23.502 [3].\n4.\tAMF will send the Update PIN_List message to the PCF.\n5.\tPCF will send the Update PIN_List to PINCTRL for its approval.\n6.\tPINCTRL will decide based on the subscription and 3rd party/operators policy and send the Acknowledged update PIN_List to the PCF. A typical update PIN_List is as follows:\ni.\tPINE1, PEMC = FALSE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\nii.\tPINE2, PEMC = TRUE, PEGC=FALSE, 5G_Aceess=FASLE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\n7.\tPCF will send the Acknowledged update PIN_List to AMF.\n8.\tAMF will send N2 Request with Acknowledged PIN_List to RAN.\n9.\tRAN will send the Update PIN_List response and the acknowledged PIN_List to the PEMC.\nThe figure depicts a network-triggered service request to update PIN/PINE policies, illustrating the process of requesting changes to the policies of a specific network. The request is triggered by the network, indicating that the policy changes are necessary for the network's operation. The figure provides a visual representation of the process, showing the steps involved in updating the policy, such as the network identification, the request submission, and the response from the network.\nFigure 6.10.2.2-1: Network Triggered Service Request to update PIN/PINE Policies\n0.\tPINCTRL decides to update the PEMC PIN policies either due to operator or 3rd party policy update.\n1.\tPINCTRL invokes Namf_communication_N1N2MessageTransfer service operation provided by the AMF. The message includes SUPI of PEMC, PEMC PIN Policy container.\n2.\tIf the PEMC is registered and reachable by AMF in either 3GPP access or non-3GPP access, AMF shall transfers transparently the PEMC PIN Policy container to the PEMC via the registered and reachable access.\nIf the PEMC is not reachable by AMF over both 3GPP and non-3GPP access, the AMF reports to the PCF that the PEMC PIN Policy container could not be delivered to the PEMC using Namf_communication_N1N2MessageTransfer as mentioned in clause 4.2.3.3 of TS 23.502 [3].\n3.\tIf the PEMC is in CM-CONNECTED over 3GPP access or non-3GPP access, the AMF transfers transparently the PEMC PIN Policy container (PIN related policy information) received from the PINCTRL to the PEMC. The PEMC policy container includes the list of PIN policy as described in clause 6.10.2.1 and 6.10.2.2.\n4.\tThe PEMC updates the PIN Policy provided by the PINCTRL and sends the result to the AMF\n5.\tIf the AMF received the PEMC PIN Policy container and the PINCTRL subscribed to be notified of the reception of the PEMC PIN policy container then the AMF forwards the response of the PEMC to the PINCTRL using Namf_communication_N1N2MessageNotify. The PINTCTRL will further handle successful and failure Notification accordingly.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.3\tImpacts on services, entities and interfaces",
                            "text_content": "The solution largely re-uses existing functionality\nThe solution has the following impacts:\nImpact to the UE (PEMC):\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\n-\tAbility to maintain a list of all the PINE and its supported services.\nImpact to the UE (PINE/PEGC):\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\nImpact to the 5G System:\n-\tAdd new Network Function (PINCTL) to the NAS.\n-\tAdd new fields to the Registration request such as \"PIN capable\".\n-\tAdd new fields to the Registration Accept message such as \"PIN allowable\", \"PIN Name\".\n-\tAdd the following fields or parameters to the AMF paging:\n-\tUpdated \"PINE list\", which contains a list of PINE elements and its associated policies and parameters. For e.g. A typical \"PINE list\" will be as follows:\n-\tPINE1, PEMC = FALSE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED\n-\tPINE2, PEMC = TRUE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.11\tSolution #11: Differentiated QoS between a PINE and 5GS when a PEGC is used for the relay",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.11.1\tDescription",
                            "text_content": "This solution mainly addresses Key Issue #4 \"Communication of PIN\".\nQoS experienced by PINEs connected behind a PEGC depends on the end-to-end path between a PINE and the application server, i.e. depends on the QoS differentiation in both the 3GPP network and the non-3GPP network attached to the PEGC.\nFor example, a certain Packet Error Ratio (PER) can only be successfully ensured if it is enforced in both the 3GPP network and the non-3GPP network attached to the PEGC.\nTo address this shortcoming, this solution proposes to indicate Non-3GPP QoS assistance information to the PEGC to enable the PEGC to perform QoS differentiation for the PINEs in the non-3GPP network behind the PEGC.\nNote that this is conceptually similar as providing Additional QoS Information to a UE for trusted/untrusted access to 5GC as defined in TS 23.502 [3], which enables the UE to reserve resources in the non-3GPP network. The difference is that the Non-3GPP QoS assistance information is used to reserve resource in the non-3GPP network attached to the PEGC. In line with the definition of Additional QoS information, the details of how to enforce QoS in the non-3GPP network based on the Non-3GPP QoS assistance information are beyond the scope of 3GPP.\nThe solution is based on the following principles:\n-\tThis solution focuses on the AF requested QoS control of PINE communication to 5GS via PEGC, which has no dependence on the PIN management capability.\n-\tDuring PDU session establishment and PDU session modification, if the SMF provides the PEGC with QoS flow descriptions, the SMF may, based on subscription, additionally signal non-3GPP QoS assistance information for each QoS flow to the PEGC. The non-3GPP QoS assistance information consists of the following QoS information (if available at the SMF): QoS characteristics, GFBR/MFBR (if applicable), ARP, Periodicity.\n-\tBased on the non-3GPP QoS assistance information together with QoS rule information, the PEGC may reserve resources in the non-3GPP network.\nNOTE:\tThe details of how to enforce QoS based on the Non-3GPP QoS assistance information in the non-3GPP network are not subject of this solution and are considered to be beyond the scope of 3GPP.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.2\tProcedures",
                            "text_content": "The figure depicts a network architecture with non-3GPP network attached to the PEGC, illustrating the non-3GPP network's QoS assistance information to the PEGC. The figure includes non-3GPP network equipment, such as the PEGC, and the PEGC's QoS assistance information, which is crucial for ensuring QoS in the non-3GPP network.\nFigure 6.11.2-1: Providing Non-3GPP QoS assistance information to the PEGC to enable the PEGC to ensure QoS in the non-3GPP network attached to the PEGC\n1.\tPDU Session is established\n2.\tApplication layer signalling is exchanged between an application on a PINE connected to the PEGC and an application function (AF)\n3.\tBased on the application layer signalling, the AF requests QoS for application flows.\nNOTE 1:\tIf the AF is not considered trusted, then the AF interacts with the NEF instead. If the AF provides explicit QoS parameters, then AF (or NEF in case the AF is not trusted) interacts with PCF as defined in clause 4.15.6.6 of TS 23.502 [3].\n4.\tPCF sends PCC rules to the SMF.\nNOTE 2:\tSteps 1-4 are following existing Rel-17 specifications.\n5.\tSMF performs PDU Session modification as defined in clause 4.3.2 of TS 23.502 [3] and may include, based on subscription data of the PEGC and network operator's policy, in the N1 SM container per QoS-flow Non-3GPP QoS assistance information. The Non-3GPP QoS assistance information contains (if available at the SMF): QoS characteristics, GFBR/MFBR (if applicable), ARP, Periodicity.\n6.\tBased on the non-3GPP QoS assistance information and QoS rule information, the PEGC may reserve resources in the non-3GPP network.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "SMF:\n-\tTo provide per-QoS flow Non-3GPP QoS assistance information.\nPEGC:\n-\tTo receive additional Non-3GPP QoS assistance information in NAS-\tOptionally enforce QoS in the non-3GPP network. The details of how to enforce QoS in the non-3GPP network are not subject of this solution and are considered to be beyond the scope of 3GPP.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.12\tSolution #12: Communication of PIN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.12.1\tDescription",
                            "text_content": "This solution mainly addresses KI#4 \"Communication of PIN\". This solution also addresses some part of the KI#6 \"Policy and parameters provisioning for PIN\", i.e. UE to UE relay parameter provisioning and QoS parameter provisioning, as well as part of the KI#7 \"Identification of PIN and PIN Elements\", i.e. SMF assigns PINE ID and PINE IP and sends them to PEGC.\nThe steps in the following call flows depicted as grey line in the figures are out of SA WG2 scope.\nThis solution is related to the solution 8 \"management of PIN and PIN Elements\" addresses to KI#3, and the solution is based on architecture alternative C described in clause 6.0C.\nThe figure 6.12.1.2-1 depicts the overall procedure for PIN communication.\nThe figure depicts the overall procedure for PIN communication, illustrating the steps involved in establishing a secure communication link. It includes the use of a PIN code, which is a unique numerical code that is used to authenticate the communication. The figure shows the steps from the sender to the receiver, including the use of a PIN code, the transmission of the message, and the reception of the response. The figure is important for understanding the security and authentication process in PIN communication.\nFigure 6.12.1.2-1: Overall procedure for PIN communication\n1.\t[Optional] The PINE may send traffic for communicating with another PINE, or with PEMC, or outside the PIN. The PEGC does not have the routing rule for the traffic, then requests the PEMC to allow the routing.\n2.\t[Optional] If step 1 is performed and the PEGC has not established the PDU Session associated with PIN, the PEGC initiates PDU Session Establishment procedure. The PEMC may send traffic for communicating with a PINE, if the PEMC has not established PDU Session associated with PIN, the PEMC initiates PDU Session Establishment procedure. The PEGC and PEMC may establish the PDU Session associated with PIN anyway, i.e. no matter whether the relay is needed or not, the PEGCs and PEMCs setup the 5G-LAN as described in clause 5.29 of TS 23.501 [2] and clause 4.13.8 of TS 23.502 [3].\n3.\tThe PEMC requests communication with a PINE, or the PEMC requests communication for the PINE no matter whether step 1 is performed or not.\n4.\t[Optional] If the PEGC or the PEMC have established PDU Session associated with PIN, the PINMF requests the 5GC to setup or update the 5G-LAN, the 5G-LAN is not for only a specific PIN, but for all the PINs that the PEMC or Trust Members of the PEMC has created.\n5.\tThe PINMF requests 5GC to initiate PDU Session Modification. During the PDU Session Modification procedure, the policy and parameters for PIN QoS and routing is provisioned to SMF, UPF, NG-RAN, and PEGC.\nThe SMF may trigger the authentication and authorization procedure between a PINE and UDM/AAA via a PEGC so that any other malicious PINE is not able to forge the PINE to use its policy for communication.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.2\tProcedures",
                            "text_content": "The procedure describes how a virtual LAN is built and the routing rule for traffic is enforced.\nThe figure depicts a relay path management system in a 12-2-1 network, illustrating the various relay paths and their corresponding management strategies. The system includes a relay path manager, a relay path controller, and a relay path coordinator, all of which are crucial for ensuring efficient and reliable communication. The figure also highlights the importance of network slicing and network virtualization in managing these paths, as well as the use of network functions virtualization (NFV) to optimize network resources.\nFigure 6.12.2.1-1: Management of relay path\n1.\t[Optional] The PINE establishes direct connection with PEGC.\n2.\t[Optional] The PINE may send traffic for communicating within PIN or outside PIN.\n3.\t[Optional] If step 2 is performed and the PEGC does not have routing rule for the traffic, the PEGC sends the PIN Relay Request (PIN ID, PINE ID, Traffic description, [DN-specific ID]) to the PEMC directly, or sends PEMC Notification (PEGC ID, PIN Relay Request) to PINMF and PINMF sends PEMC Event Notification (PEGC ID, PIN Relay Request) to the PEMC. The Traffic description describes the 5-tuple of the traffic. If the request is related to internet services, the DN-specific ID may be included.\n4.\tThe PEMC sends Relay Activate/Deactivate Request (PIN ID, PEMC ID, PEGC ID, PINE ID, Packet filters) to the PINMF. If step 3 is performed, Relay Activate Request is used.\nThe PINMF authorizes the request whether the PEMC ID is able to manage the PIN, if succeeds, then the following steps are performed, otherwise stop.\n5.\t[Optional] If the PEGC, or PEGC and PEMC, need to be included in the 5G-LAN for all the PINs that created by the PEMC or the trust members of the PEMC, the PINMF sends UP Change Request ([SUPI/GPSI], UE address, [DNN/S-NSSAI], DNAI) to the PCF via N5 interface or NEF for the PEGC or PEGC and PEMC separately, which is described in clause 4.3.6.2, 4.3.6.3, and 4.3.6.4 of TS 23.502 [3] and clause 5.6.7 of TS 23,501 [2].\n6.\t[Optional] The procedure described in clause 4.3.5 of TS 23.502 [3] may be performed to change the serving SMF that supports PIN according to the DNAI. The AMF selects new SMF according to the combination of DNN and S-NSSAI, or combination of DNN, S-NSSAI, and DNAI. In order to anchor all the PDU Sessions of members in a PIN Trust Members Group at same SMF, the NRF is configured with one SMF associated with the combination of DNN and S-NSSAI, or the combination of DNN, S-NSSAI, and DNAI.\n7.\t[Optional] The SMF notifies the UP path management events with the indication whether the IP address of the PEGC/PEMC is changed to the PINMF (optionally via NEF) similar as described in steps 4a, 4b, and 4c of clause 4.3.6.3 in TS 23.502 [3].\nNOTE:\tFor 5G VN feature, in order to anchor all the PDU Sessions of a 5G VN group members at same SMF, the UDM is configured to map a combination of DNN, S-NSSAI to a 5G VN group, and NRF is configured to map the combination of DNN, S-NSSAI to one SMF. PIN can reuse the mechanism, but this requires different Trust Members Group is associated with different combination of DNN, S-NSSAI.\n8.\t[Optional] If the IP address of the PEMC is changed, the PEMC sends Event Notification (PEMC ID, old IP address, new IP address) to the PINMF.\n9.\t[Optional] If the IP address of the PEGC is changed, the PEGC sends Event Notification (PEGC ID, old IP address, new IP address) to the PINMF.\n10.\tThe PINMF sends Relay Activate/Deactivate Request ([SUPI/GPSI], UE address, [DNN/S-NSSAI], PIN ID, PINE ID, [P2P Routing Rule], [P2N Routing Rule, [NLSP Routing Rule], [DL Packet filters], [UL Packet filters], [Framed Route Info], [Authentication Assistance Info], QoS reference) to the PCF via N5 interface or NEF. The P2P Routing Rule is used by PEGC that includes the information whether some PINEs are allowed/disallowed to communicate with other PINEs via the PEGC. The P2N Routing Rule includes packet filters that the PEGC is able to relay and may include service requirements for the PINE associated with the packet filters. The NLSP Routing Rule is used by UPF that includes the information whether some PINEs are allowed/disallowed to access other PINEs, or the PEMCs. The UL/DL Packet filters includes the information whether some PINEs are allowed/disallowed to access internet, or a specific internet service. The Authentication Assistance Info may be included, which contains MAC Address that preconfigured in the PINMF for non-3GPP device case, or UE ID for PEMC case.\nIf it is the first time for activate the relay for the PEGC, the Framed Route Info may be included and used by the SMF to configure framed routing as described in clause 5.6.14 of TS 23.501 [2] for the PDU Session of the PEGC.\nThe PCF uses the policy of the PEGC to authorize the QoS requirements for the PINE.\nIn case of Framed Route is used, the IPv6 delegation or SMF assigned IP (step 9) for PINEs behind the PEGC may be used.\nThe SMF uses the Framed Route Info to configure framed routing as described in clause 5.6.14 of TS 23.501 [2] with the UPF for the PDU Session of the PEGC.\n11.\tThe PCF sends Relay Activate/Deactivate Request (SUPI, PDU Session ID, PIN ID, [P2P Routing Rule], [P2N Routing Rule], [NLSP Routing Rule], [DL Packet filters], [UL Packet filters], [Framed Route Info], [Authentication Assistance Info], QoS profile) to the SMF.\n12.\tThe SMF may trigger authentication and authorization procedure between PINE and UDM, or between PINE and external DN-AAA, via the PEGC, i.e. the SMF sends EAP Identity Request to the PINE. EAP framework is used for the authentication and authorization. When the authentication succeeds, the AAA sends the MAC Address to the SMF, the UDM sends UE ID to the SMF. The SMF verifies the MAC Address/UE ID based on the Authentication Assistance Info.\nEditor's note:\tThe authentication and authorization procedure as well as the content of the Authentication Assistance Info need coordination with SA WG3.\n13.\tThe SMF interacts with UPF(s) serving the PDU Session of the PEGC, or PEGC and PEMC to establish/update the 5G VN based on the DNAI, and install, update, remove a corresponding FWA according to the NLS Routing Rule and DL Packet filters.\n14.\tThe SMF performs PDU Session Modification with the PEGC, may add, update, or remove QoS flows serve the PINE, and delivers the PIN ID, P2P Routing Rule, and P2N Routing Rule to the PEGC via N1 message during the PDU Session Modification.\nThe QoS rules provided to the PEGC includes packet filters corresponds to PINEs, e.g. IP range, or port range, or both, the PEGC performs P2N relay and maps traffic with the QoS flow based on the QoS rules. The PCF may consider the type of direct connection (e.g. WiFi, BT, PC5) to deduce the QoS rules, e.g. uses a fixed value for the delay of direct connection.\nDuring the PDU Session Modification procedure, the SMF may allocate IP address for the PINE and sends the IP address and PINE ID to the PEGC via N1 message. The PEGC associates the PINE ID and IP address with the PINE, the PEGC transfers the inner address of the PINE to the IP address received. The PEGC responds to the SMF. If IPv6 delegation is used, the PEGC also sends the IP address of the PINE to the SMF. The PEGC may reports the Port Range that allocated for the PINE to the SMF. The SMF can identify the PINE via the PINE ID and the UPF can identify the PINE via the IP address.\nEditor's note:\tFor the case that PINMF is 3rd party AF, how the PEGC authorize that the P2P Routing Rule or P2N Routing Rule are configured by a PEMC needs coordination of SA WG3.\n15-16.\tThe SMF responds to the PCF. The PCF responds to the PINMF. If the Authentication Assistance Info is received, the SMF indicates whether the verification succeeds or not. The SMF may indicate Relay Assistance Info, which contains PINE related information, e.g. transferred IPv6 address of PINE, transferred IPv4 address and IP port range of PINE, etc. The interaction between PINMF and PCF may be via NEF.\n17.\tThe PINMF responds to the PEMC with Device Info of the PINE.\n18.\t[Optional] The PEMC responds to the PINE via PEGC.\nThe procedure describes how traffic is sent to a PINE when direct connection of the PINE is lost.\nThe figure depicts a mobile termination procedure for PINE, a protocol used in 5G networks. It illustrates the steps involved in terminating a mobile device's connection to a base station. The figure shows the mobile device's antenna, the base station's antenna, and the network's infrastructure, including the mobile termination unit (MTU) and the network's core network. The figure also includes a diagram of the network's routing and signaling paths, as well as the network's core network and the mobile termination unit.\nFigure 6.12.2.2-1: Mobile termination procedure for PINE\n1.\tThe PEGC established a PDU Session with SMF supporting PIN.\n2.\tThe PINMF sends Relay Activate Request ([SUPI/GPSI], UE address, [DNN/S-NSSAI], PIN ID, PINE ID, Status Info) to the PCF via N5 interface or NEF. The Status Info includes the type of the PINE, which indicates whether the PINE is notifiable, e.g. when the PINE is a listener and PEGC is announcer over the, e.g. WiFi, BT, etc, or when the PINE is an announcer and the PEGC is listener, e.g. the PINE is a hot spot of Wi-Fi.\n3.\tThe PCF sends Relay Activate Request (SUPI, PDU Session ID, PIN ID, PINE ID, Status Info) to the SMF.\n4-5.\tThe SMF responds to the PCF. The PCF responds to the PINMF (optionally via NEF).\n6.\tThe PEGC may detect that the communication with the PINE is not available, e.g. user closes the WiFi or BT on PINE or PEGC, or the PEGC closes the WiFi when in CM-IDLE. The PEGC sends Event Notification (PEGC ID, PINE ID, lost) to PINMF. The PINMF authorizes the request and sends Relay Activate Request ([SUPI/GPSI], UE address, [DNN/S-NSSAI], PIN ID, PINE ID, Status Info) to the PCF via N5 interface or NEF if authorization succeeds. The Status Info includes the information of the PINEs that are unreachable and notifiable. The PCF sends Relay Activate Request (SUPI, PDU Session ID, PIN ID, PINE ID, Status Info) to the SMF. The SMF responds to the PCF. The PCF responds to the PINMF (optionally via NEF).\nThe PEGC may detect that the direct connection with the PINE is lost, the PEGC initiates PDU Session Modification indicating the PINE is unreachable.\nThe PEGC may transit into CM-IDLE state or the PDU Session for relay may be inactive, the PEGC initiates PDU Session Modification.\n7.\tAccording to the information received in step 6 and the Status Info of the PINE, the SMF interacts with the UPF serving the PDU Session of the PEGC for instructing that DL data notification for the PINE is needed.\n8.\tWhen DL data to the PINE is arrived and DL data notification is instructed, the UPF sends DL data notification related to the PINE to the SMF.\n9.\tThe SMF sends N1 message to the PEGC via the AMF to indicate the PEGC to open WiFi or BT in order to establish direct connection with the PINE.\n10.\tThe PINE and the PEGC establish the direct connection according to the instruction.\nThe procedure describes how to support the credential provisioning for PINEs.\nThe figure depicts a detailed view of the credential provisioning process for PINE, a system used in the telecommunications industry. It shows the various stages of the process, including the creation of credentials, their distribution, and their management. The figure provides a clear and concise overview of the process, making it easy for users to understand the steps involved.\nFigure 6.12.2.3-1: Credential provisioning for PINE\n1.\t[Optional] The PINE establishes direct connection with PEGC.\n2.\t[Optional] The PINE sends Credential Provisioning Request (PIN ID, PINE ID, Duration) to the PEGC. The Duration indicates the lifetime of the path for the remote provisioning.\n3.\t[Optional] The PEGC sends the Credential Provisioning Request to the PEMC directly, or sends PEMC Notification (PEGC ID, Credential Provisioning Request) to PINMF and PINMF sends PEMC Event Notification (PEGC ID, Credential Provisioning Request) to the PEMC.\n4.\tThe PEMC sends Credential Provisioning Request (PIN ID, PEMC ID, PEGC ID, PINE ID, Duration) to the PINMF. The PEMC may change the Duration received from step 3.\nThe PINMF authorizes the request whether the PEMC ID is able to manage the PIN, if succeeds, then the following steps are performed, otherwise stop.\n5.\tThe PINMF sends Credential Provisioning Request ([SUPI/GPSI], UE address, [DNN/S-NSSAI], PIN ID, PINE ID, D2N Routing Rule, UL Packet filters, DL Packet filters, Duration) to the PCF via N5 interface or NEF. The PINMF may determines the Duration based on local policy. The D2N Routing Rule and DL Packet filters is generated based on the vendor name of the PINE.\n6.\tThe PCF sends Credential Provisioning Request (SUPI, PDU Session ID, PIN ID, D2N Routing Rule, DL Packet filters, Duration) to the SMF.\n7.\tThe SMF interacts with UPF serving the PDU Session of the PEGC to install a corresponding forwarding rule according to the DL Packet filters.\n8.\tThe SMF performs PDU Session Modification with the PEGC and delivers the PIN ID, PINE ID, D2N Routing Rule, and Duration to the PEGC via N1 message.\n9.\tThe SMF responds to the PCF.\n10.\tThe PCF responds to the PINMF (optionally via NEF).\n11.\tThe PINMF responds to the PEMC.\n12.\tThe PEMC responds to the PINE via PEGC, or sends Credential Provisioning Notification to the PINE.\nFrom now on, the PINE is able to interact with provision server, which may be a 3rd party or operator managed.\n13.\tWhen timeout, the SMF interacts with UPF serving the PDU Session of the PEGC to remove the corresponding forwarding rule according to the DL Packet filters. When timeout, the PEGC removes the D2N Routing Rule.\nNOTE:\tThe operator network can disallow the traffic to any known provision server until the credential provisioning request is authorized.\nEditor's note:\tThe support of credential provisioning needs coordination with SA WG3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "PINMF:\n-\tSupport PIN ID assignment.\n-\tSupport PIN parameters provisioning to PCF directly or via NEF.\nSMF:\n-\tSupport PIN Relay operations with PCF.\n-\tSupport instructing UPF for rules related to PIN Elements.\n-\tSupport provisioning relay information to PEGC over NAS.\n-\tSupport receiving and delivering N1 message related to DL data notification of a PINE.\n-\tSupport triggering authentication and authorization procedure between PINE and UDM/external DN-AAA.\n-\tSupport PINE ID and IP address provisioning for PINE to PEGC over NAS.\nPCF:\n-\tSupport authorizing the QoS requirements for PINE associated with the PEGC.\n-\tSupport PIN Association operations with PINMF and SMF.\nUE (support PEGC):\n-\tSupport relay information provisioning for PIN over NAS.\n-\tSupport proxy authentication and authorization procedure between PINE and UDM/external DN-AAA.\n-\tSupport PINE ID and IP address provisioning for PINE over NAS, and perform NAT for the PINE with the IP address.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.13\tSolution #13: Communication of PIN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.13.1\tDescription",
                            "text_content": "The solution describes the following PIN communication aspects:\n1)\tCommunication between PIN Elements within a PIN via PEGC, via 5GS and direct.\n2)\tPIN Element relay path setup with 5GS via PEGC\n3)\t5GS QoS differentiation for PINE via PEGC\nThe architecture for providing relay path between PINE and 5GS via PEGC\nThe relay path architecture between PINE and 5GS via PEGC is depicted in Figure 6.1.1 -1:1, illustrating the various components and their interconnections. The relay path is a crucial component of the network, facilitating the transmission of signals from the source to the destination. The relay path architecture consists of a series of relay nodes, which are interconnected through optical fibers. The relay nodes are equipped with optical line terminals (OLTs) and distributed nodes, ensuring redundancy and failover reliability. The relay path architecture is designed to align with SDN principles, allowing for efficient network management and control.\nFigure 6.13.1.1-1: Relay Path Architecture between PINE and 5GS via PEGC\nAssumption: The PIN elements are connected to a wireless LAN/ PAN network and each element are reachable via the wireless link. The procedure to connect to the wireless network and assign IP address is out of the scope of this document.\nThe salient feature of this solution is as follows:\n-\tSetup. PINE in the PIN will request PEGC for 5G session establishment using request-response queries. The PEGC will establish a PDU session with the 5G network based on the existing procedure defined in clause 4.3.2.2 of TS 23.502 [3].\n-\tPINE will configure PEGC as its default gateway, so that all the traffic is sent to the 5G network via PEGC relay.\n-\tPEGC acts as a Network Address Translator (NAT) between 5G network and the PIN by representing a unique IP address to all the PINE and PEMC in the PIN network.\n-\tPEGC establishes a unique PDU session with 5G network for every PINE requesting for 5GS relay access through PEGC.\n-\tPEGC maps local FQDN or IP address of the PINE to the PDU session ID and uses this mapping to forward the data from/to PINE and 5G PDU unique session.\n-\tQoS differentiation. This solution proposes following two ways to achieve differentiated services\n-\tPINE requesting for a desired QoS will request the PEGC to setup a PDU session using control signals (Http messages) with the intended QoS, and PEGC will setup appropriate PDU session. All the traffic from the PIN will be forwarded to the PDU session with the desired QoS.\n-\tPINE will use DSCP markings on the IP packet in the PIN to indicate the desired QoS and PEGC will setup an appropriate 5QI PDU session with the DNN, and further PEGC will reset the QoS marking on the IP packet and forward it to the established PDU session.\n-\tPEGC will also provide the necessary QoS as indicated by the PINE on the IP packets in the PIN network.\n-\tRelease. PINE in the PIN will request PEGC for 5G session release using request-response quires. The PEGC will release the respective PDU associated with the PINE - PEGC uses PDU ID and PINE FQDN or IP address of the PINE in the local PIN.\nThe architecture for providing communications between PINE in the PIN.\nThe figure depicts a relay path architecture between PINE and 5GS, illustrating the various paths through which signals are relayed. The relay path is composed of a series of relay nodes, each equipped with a relay switch, which allows for the transmission of signals from PINE to 5GS. The relay path is designed to ensure reliable communication, with redundant paths to prevent signal loss. The figure also includes a detailed description of the relay nodes, their connections, and the relay switches, providing a comprehensive understanding of the relay path architecture.\nFigure 6.13.1.2-1: Relay Path Architecture between PINE and 5GS via PEGC\nAssumption: The PIN elements are connected to a wireless LAN/ PAN network and each element are reachable via the wireless link. The procedure to connect to the wireless network and assign IP address is out of the scope of this document.\nThe salient feature of this solution is as follows:\n-\tDirect Communication. PINE, PEGC and PEMC will use Request-response and Subscribe-Notify methods to communicate with each other. Since PINE are reachable via direct or in LAN connection, PINE will communicate with each other directly using intended PINE's FQDN or IP address.\n-\tVia PEGC. PINE should set PEGC as its default gateway so that all the communication is via PEGC. Packets from PINE intended to other PIN elements in the PIN related to local services or local communication are routed by the PEGC locally, since PEGC has PINE repositories which includes FQDN or IP address of the PINE in the PIN.\n-\tVia 5GS. All the packets, from PINE, including local PIN destination are routed to the PEGC gateway. In case of local destination address, PEGC will map it to its NAT address and then forward it to the 5GC, which will in turn forward it back to the PEGC. Once PEGC receives such a packet, it will translate the NAT address to local PIN address and forward it to the appropriate PINE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.2\tProcedures",
                            "text_content": "The figure depicts a communication of PIN, which is a key component in the 5G network. It illustrates the transmission of data through various layers, including the base station (gNB), user equipment (UE), and scatterers. The diagram highlights the importance of beamforming techniques to mitigate interference and ensure reliable communication.\nFigure 6.13.2-1: Communication of PIN\n1.\tPINE (PINE1) in the PIN will send HTTP request to PEGC for PDU session establishment with the required QoS.\n2.\tPEGC will Acknowledge PINE (PINE1) with a HTTP OK response.\n3.\tPEGC will Establish PDU session with the requested QoS on behalf of PINE(PINE1) as described in clause 4.3.2.2 of TS 23.502 [3]. PEGC identifies this session as PDU1 mapped to the requested PINE(PINE1). (PINE1 can request for different QoS using the step 1 and PEGC will setup different sessions with the requested QoS and assigns a unique local destination port as shown in figure-6.13.1.1.\n4.\tOnce PDU session is established, PEGC will notify the PINE (PINE1) about successful PDU establishment with the intended QoS.\n5.\tPINE (PINE1) will forward all the traffic intended with QoS1 to the assigned PEGC port. PEGC will act as router + NAT to forward the packet to the PDU1 session.\n6.\tAnother PINE (PINE2) in the PIN can also send HTTP request to PEGC to establish PDU session with required QoS.\n7.\tPEGC will Acknowledge PINE (PINE2) with a HTTP OK response.\n8.\tPEGC will Establish PDU session with the requested QoS on behalf of PINE(PINE2) as described in clause 4.3.2.2 of TS 23.502 [3]. PEGC identifies this session as PDU2 mapped to the requested PINE(PINE2). (PINE2 can request for different QoS using the step 6 and PEGC will setup different sessions with the requested QoS and assigns a unique local destination port as shown in figure-6.13.1.1.\n9.\tOnce PDU session is established, PEGC will notify the PINE (PINE2) about successful PDU establishment with the intended QoS.\n10.\tPINE (PINE2) will forward all the traffic intended with QoS2 to the assigned PEGC port. PEGC will act as router + NAT to forward the packet to the PDU2 session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.3\tImpacts on services, entities and interfaces",
                            "text_content": "The solution largely re-uses existing functionality\nThe solution has the following impacts:\nImpact to the UE (PEMC):\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\n-\tAbility to maintain a list of all the PINE and its supported services.\n-\tAbility to respond to PINE and its service discovery queries from the PINE.\nImpact to the PINE:\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\n-\tAbility to request QoS using http request to the PEGC.\nImpact to the UE (PEGC):\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\n-\tAbility to register its gateway functionality to PEMC.\n-\tAbility to accept http QoS request from the PINE and setup multiple PDU session with the 5G System.\n-\tAbility to map PDU session ID to the IP address of the PINE and forward packets to/from the corresponding PDU session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.14\tSolution #14: Discover PIN and PIN element via direct discovery",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.14.1\tDescription",
                            "text_content": "The solution applies to Key Issue #2 \"PIN and PIN Element discovery and selection\" and Key Issue #6 \"Policy and parameters provisioning for PIN\".\nThe PIN architecture is depicted as in Figure 6.14.1-1. The PEMC and PEGC have Uu capability and can access 5GC using the procedures as defined in TS 23.502 [3]. The PINE may have limited communication capability and can only support some forms of direct non-3GPP access, e.g. Wi-Fi or BT.\nThe figure depicts a reference architecture for a PIN (Point-to-Point Network) system, illustrating the various components and their interconnections. The architecture includes a base station (BS), a user equipment (UE), and a network element (NE). The figure also shows the use of redundancy paths to ensure reliable communication.\nFigure 6.14.1-1: Reference architecture for PIN\nThe PEMC is responsible for managing the PIN, including creating a PIN, adding/removing a PINE from the PIN, etc. The PEMC may be preconfigured with PIN information that it can support, or the PIN information can be provisioned by PCF to the PEMC.\nThe PEGC provides connectivity services for PINE to access the network. The PEGC may be preconfigured with connectivity service information that it can support, or the connectivity service information can be provisioned by PCF to the PEGC.\nThe PINE can communicate with PEMC, PEGC and other PINEs via direct non-3GPP access (e.g. Wi-Fi and BT). The PINE discovers the PEMC by using direct discovery, and the PINE is authorized by the PEMC to join the PIN. The PINE discovers the PEGC also by using direct discovery if it needs to communicate with the network.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.14.2\tProcedures",
                            "text_content": "The policy and parameters for PIN and PIN element discovery may be provisioned by PCF.\nThe \"PCF based Service Authorization and Provisioning to UE\" procedure as defined in clause 6.2.2 of TS 23.304 [6] is reused with the following differences:\n-\tIf the UE indicates PEMC/PEGC Capability in the Registration Request message and if the UE is authorized to act as PEMC/PEGC based on subscription data, the AMF selects the PCF which supports PIN policy/parameter provisioning and establishes a UE policy association with the PCF for PIN policy/parameter delivery.\n-\tIf the UE supports PEMC/PEGC and it does not have valid PIN policy/parameters, the UE includes the UE Policy Container with indicating the PIN Policy Provisioning Request during registration procedure. The UE may also include PEMC/PEGC capabilities in the PIN Policy Provisioning Request and PCF may determine the PIN policy/parameters for the UE based on received UE capabilities.\n-\tIf the UE indicates the PIN Policy Provisioning Request in the UE Policy Container, the PCF determines whether to provision PIN policy/parameters to the UE, and the PCF provides the PIN policy/parameters to the UE by using the procedure as defined in clause 4.2.4.3 of TS 23.502 [3].\nThe \"AF-based service parameter provisioning for ProSe over control plane\" procedure as defined in clause 6.2.5 of TS 23.304 [6] is reused for PIN AS to provide PIN Service Parameters to the PCF.\nEditor's note:\tHow to support trusted PIN AS to provision PIN policy/parameter is FFS.\nDepicted in figure 6.14.2.2-1 is the procedure for PIN and PIN Element discovery.\nThe figure depicts a schematic of a PIN and PIN Element discovery process in a 14.2.2-1 network. The diagram illustrates the steps involved in identifying and locating the PIN and PIN Element, which are crucial components in the network's security architecture. The figure includes key components such as the network interface controller (NIC), the network protocol interface (NPIF), and the network protocol interface (NPIF), which are essential for the communication between the network and the user equipment (UE). The figure also highlights the importance of redundancy and failover mechanisms, ensuring the network's reliability and resilience.\nFigure 6.14.2.2-1: PIN and PIN Element discovery\n1.\tPEMC/PEGC is preconfigured or provisioned with PIN information as described in clause 6.14.2.1. The PIN information may include PIN identity, PIN type, etc. and the details are addressed by solutions for KI#7.\n2.\tThe PEGC discovers PEMC via direct discovery over non-3GPP access (e.g. Wi-Fi and BT) after the Wi-Fi or BT connection is established. The application layer signalling is used for direct discovery, and the PIN information is used as criteria for PEGC to discover the appropriate PEMC. The PEGC is added to the PIN if authorized by the PEMC.\n3.\tThe PINE discovers PEMC via direct discovery over non-3GPP access (e.g. Wi-Fi and BT) after the Wi-Fi or BT connection is established. The application layer signalling is used for direct discovery, and the PIN information is used as criteria for PINE to discover the appropriate PEMC. The PEGC info may also be provided to the PINE in order for PINE to discover a PEGC.\n4.\tThe PINE discovers PEGC via direct discovery over non-3GPP access (e.g. Wi-Fi and BT) after the Wi-Fi or BT connection is established. The application layer signalling is used for direct discovery, and the PEGC information and connectivity service information are used for PINE to discover an appropriate PEGC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.14.3\tImpacts on services, entities and interfaces",
                            "text_content": "UE:\n-\tRequest and Receive PIN policy/parameters from PCF.\n-\tSupport PIN and PIN Element discovery via direct discovery.\nPCF:\n-\tProvision PIN policy/parameters to UE.\nUDR:\n-\tStore PIN policy/parameters provided by PIN App Server.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.15\tSolution #15: Discovery of PIN/PINE Services via 5GC",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.15.1\tDescription",
                            "text_content": "This solution proposes to address the KI#2 \"PIN and PIN Element discovery and selection\" on how to discover the PIN/PINE Service.\nIn this solution, it is assumed that PINE is configured or aware of the PIN ID, and no target PINEs information was configured in the PINE.\nIn the case no PEMC is available, if the PINE (i.e. UE) has the capability to connect to 5G, it can request AMF to query the PIN profile stored in UDM in order to discover the PIN/PINE Service. Otherwise, the PINE (i.e. non-3GPP device) accesses the 5G network via PEGC for the PIN/PINE Service discovery.\nIn the case either PEMC or PEGC is available, the PINE can request the target PINE/PIN Service from PEMC directly or via PEGC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.15.2\tProcedures",
                            "text_content": "As in Figure 1, PINE-1 is assumed as one UE that can connect to 5G network. And PINE-1 is configured with PIN ID, no target PINE-2 information. PINE-2 can be reachable via PEGC.\nPINE-1 wants to find what the PINE service can be provided by the PIN, and selects the specific PINE Service based on the requirement.\nThe figure depicts a simplified representation of the PINE Service discovery process in a 5G network. It illustrates the steps involved in identifying and locating network services, including the use of 5G Core (5GC) for service discovery. The figure includes various components such as the 5G Core, network services, and network elements, all connected by dashed lines to represent the network's layered architecture. The figure is a simplified representation, highlighting the key components and their interactions, and serves as a visual aid for understanding the PINE Service discovery process in a 5G network.\nFigure 6.15.2-1: PINE Service discovery via 5GC\n1.\tPINE-1 sends the PIN Services Info Query request to AMF via gNB, including the PIN ID, and optional PINE-1 information (may be used for further authorization with PEMC). If PINE-1 is a non-3GPP device, the PIN Services Info Query request should be sent to PEGC-1 that has been associated with PINE-1, and then be forwarded to 5GC by PEGC-1.\n2.\tAMF checks whether the PINE-1 is authorized to use PIN Service.\n3.\tAdditional authorization may be needed from PEMC.\nEditor's note:\tIt is FFS for how to perform the authorization from PEMC.\n4.\tAMF sends the PIN Service Query request to UDM, with PIN ID.\n5.\tUDM feedbacks the PIN Services information to AMF, including the all the PINEs information, e.g. PINE ID, PINE name, PINE capability, PINE valid time, PINE type, List of PEGCs associated with PINE, etc.\n6.\tAMF sends the PIN Service Info Query response to PINE-1, including PIN Service Information as specified in step 5. If PINE-1 is a non-3GPP device, the PIN Services Info Query response should be sent to PINE-1 via PEGC-1.\n7.\tUpon receiving the information feedback from step 6, PINE-1 selects PINE-2 as the target PINE. According to the PINE information received at step 6, PINE-1 can determine if any PEGC has been associated with PINE-2. If so, PINE-1 triggers the PIN communication with PINE-2 via 5GC by using the information feedback from step 6, and step 8-11 can be skipped. Otherwise, PINE-1 sends the PIN Service Configuration request to PEMC, including PINE-2 ID.\n8.\tUpon receiving the PIN Service Configuration request with PINE-2 ID, PEMC may associate PINE-2 with a PEGC (e.g. PEGC-2), and then PINE-2 is able to connect to 5GC via PEGC. If PEGC-2 is chosen as the associated PEGC of PINE-2, PEMC sends the Connection Setup request including PEGC-2 ID to PINE-2.\n9.\tNon-3GPP connection is established between PEGC-2 and PINE-2.\n10.\tPINE-2 responds to the PEMC to acknowledge that the Non-3GPP connection has been established.\n11.\tPEMC responds to the PINE-1 with the PIN Service Configuration information, e.g. PEGC-2 ID, etc.\nThe figure depicts a local PINE discovery process in a 5G network, illustrating the steps involved in identifying and locating PINE (Physical Infrastructure for Network Enablers) nodes. The process involves identifying the PINE nodes, verifying their connectivity, and establishing communication with them. The figure also includes a visual representation of the network topology, highlighting the importance of PINE nodes in the 5G network.\nFigure 6.15.2.2-1: Local PINE discovery\nAssuming that there is already connection between PINE and PEGC, or PINE and PEMC:\n1.\tPINE sends PINE service Query request to PEMC directly, or via PEGC.\n2.\tPEMC sends the PINE Service Query response to PINE directly or via PEGC, including PINE list information, after successful authentication performed by PEMC.\n3.\tPINE selects the target PINE2, and initiates the PIN communication between PINE and PINE2 directly, or via PEGC, or via 5GC.\nThe figure depicts a PIN discovery process in a 5G network, illustrating the steps involved in identifying a Point-to-Point (P2P) interface (PIN) for communication. The diagram shows the various components, such as the base station (gNB), user equipment (UE), and scatterers, which are essential for the successful identification of a PIN. The figure also highlights the use of beamforming techniques to mitigate interference and ensure reliable communication.\nFigure 6.15.2.3-1: PIN discovery\n0.\tPEGC and PEMC are pre-configured with PIN Discovery information.\n1.\tPEGC and/or PEMC broadcast the PIN Discovery information, includes PIN ID, PIN name.\n2.\tPINE sends the Join PIN request directly to PEMC or via PEGC, including device ID, capability, valid time, etc.\n3a.\tPEMC triggers to update the PIN Profile in 5GC, e.g. UDM.\n3b.\tPEMC updates the PIN profile in PEMC, and sends Join PIN response to PINE directly, or via PEGC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.15.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "Network impacts:\n-\tUDM maintains the PIN profile.\n-\tUDM supports query and feedback the PIN service information based on the request from AMF.\n-\tAMF supports PIN Service Info Query request/response.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.16\tSolution #16: Policy and QoS differentiation for PINE traffic relayed by PEGC and 5GS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.16.1\tDescription",
                            "text_content": "This solution addresses KI#4 for the policy and QoS differentiation for PINE traffic relayed by PEGC.\nDifferentiated QoS can be provided for different PINEs by using configuration in the PEGC. This solution allows for traffic differentiation per PDU session / S-NSSAI and per QoS flow basis.\nIt is assumed that, when it is per PDU session basis differentiation, the default QoS associated with the PDU session can be different based on the DNN and S-NSSAI. PEGC can set up distinct PDU Session based on provided PINE information (e.g. the supported service type of the PINE). PEGC is configured (e.g. either pre-configured or delivered to PEGC by AF managing PIN via UP) with mapping information (e.g. between service types of PINE and DNN/S-NSSAI and QoS flow).\nWhen PEGC considers some PINE service types are similar and can be served with a common PDU session and DNN/S-NSSAI, then the PINEs that support these service types can be considered to share the same PDU session. If further differentiation among the PINEs using the same PDU session is needed, the PEGC can apply differentiation of PINEs based on QoS flow. The PEGC can identify the communication from PINEs based on, e.g. MAC address/Bluetooth ID or IP addresses/ports in case of NAT is applied.\nThe figure depicts a 16-port 16-1 switch with 16 different PINE groups, each with a different PDU session based on the service type supported by PINE. The switch is designed to support various PINE groups, ensuring efficient network management and failover capabilities.\nFigure 6.16.1-1: Example for different PINE group behind PEGC using different PDU sessions based on service type supported by PINE\nThe figure depicts a network with various types of point-to-point (P2P) Ethernet (PEGC) connections, each with its own point-to-point (P2P) Ethernet (PEGC) connection. The figure illustrates the use of different PDU sessions and QoS flow based on the service type, with different PDU sessions and QoS flow based on the service type.\nFigure 6.16.1-2: Example for different PINEs behind PEGC using same PDU session but different QoS flow based on service type\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.16.2\tProcedures",
                            "text_content": "The procedures for PDU Session Establishment and PDU Session Modification are captured in clauses 4.3.2 and 4.3.3 of TS 23.502 [3].\nIf there is PIN related dynamic QoS requirement from AF via 5GC, the procedure in clause 4.15.6.6 of TS 23.502 [3] is applied.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.16.3\tImpacts on services, entities and interfaces",
                            "text_content": "No impacts to 3GPP entities compared to 3GPP Rel-17.\nPEGC:\n-\tBe able to establish one PDU Session per PINE service type.\n-\tBe able to map one or multiple service type or sub-service type to one QoS flow of the PDU session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.17\tSolution #17: PIN Communication by local routing in 5GC",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.17.1\tDescription",
                            "text_content": "This solution addresses the Key Issue #4, specifically the question \"How to select communication path for communication between PIN Elements, e.g. direct communication, via PEGC, via 5GS\".\nThe following are the key aspects of this solution:\n1.\tIn a Personal IoT Network with more than one PEGC, PIN elements connected to different PEGCs are able to communicate with each other through a communication locally routed in 5GC.\n2.\tThe solution proposes the use of routing framework similar to the 5G VN group communication to enable the local routing communication path for PIN.\n3.\tThe PIN AF provisions the required group and group member configurations for creating the N4 rules for local routing.\nThis solution is built on top of the NEF-SMF association framework created for a PIN as defined in Solution #12.\nWhen a PIN is setup within a 5G network, the 5GS provides methods for routing PIN communication within the secure domain of 5GS without having to route communication via the external Data Network.\nA communication path within a PIN via 5GS is realized using procedures for local switching within UPF or using N19 interface between the PDU Sessions of the PEGCs that are members of the PIN.\nThis method applies for a PIN that has more than one PEGC authorized for communication to 5GC. A PIN can be authorized only for local routing if all PEGCs are connected to the same UPF or using N19 interface between any UPFs within the SMF service area.\nPIN can also be configured for local routing only withing specific geographical areas. For example, only when the PEGCs are connecting to the 5GC from specific NG-RANs. The configuration can also be restricted for specific time periods when it is more critical for PIN to have secure intra-5GC routing.\nA granular identification of PDUs for local routing is performed by configuring packet filter sets (e.g. identified by IP 5-tuples) such that only certain PIN elements may have the privilege for local routing services.\nAF uses external parameter provisioning interface to provide local switching or 5GS routing configurations for the PIN traffic. A PIN AF configures the following parameters to the 5GC:\n-\tDNN/S-NSSAI.\n-\tPDU Session Type.\n-\tPIN Identifier.\n-\tPIN Element identifiers (IP Addresses, GPSIs) that require local routing support.\nThis can also include list of IP addresses assigned to PINEs behind a PEGC UE using Framed Routing in a PDU Session. If a PEGC applies NAT-ing for PIN elements, the AF only configures IP Address of the PEGC.\nPIN AF can also authorize a subset of PEGCs within a PIN for local routing.\n-\tLocation restrictions for local routing.\n-\tWhether N19 based routing is allowed.\n-\tAF can provide geographic locations where PEGCs may opt for local routing.\n-\tTime restrictions for local routing.\n-\tTraffic characteristics for local routing.\n-\tPacket Filter Set (e.g. IP 5tuples) to identify more granular routing requirements.\nThe following figure illustrates the overall architecture view when local routing is enforced. The figure shows an example when a PIN with the two PEGCs (a \"smart home hub\" based PIN Gateway and a smartphone based PIN Gateway) have established PIN PDU Sessions with two UPFs. The PIN specific tunnel is set up over the N19 interface between the UPFs. The architecture is applicable for any number of PEGCs in a PIN.\nThe figure depicts a simplified architecture for local routing in a 5G network, illustrating the various components and their interactions. Key elements include the base station (gNB), user equipment (UE), and scatterers. The diagram highlights the use of beamforming techniques to mitigate interference, and the presence of redundancy paths to ensure failover reliability.\nFigure 6.17.1.1-1: Architecture for local routing in 5GS\nBased on parameters from the AF request, SMF identifies the affected PDU Sessions to be configured to support local routing. When all PEGCs have PDU Sessions in the same UPF, then local switching within the UPF is used. A group-level N4 session is created in all UPFs serving the PEGCs of the PIN when PIN Gateways are connected to different UPFs. In the group-level N4 rules, the PIN Identifier is used as Network Instance. The local routing is supported only when all the UPFs are in the same SMF service area.\nWhen a PDU session is established /modified for UE as a PEGC for a PIN configured for local routing, SMF evaluates whether the conditions for installing UPF rules for local routing are satisfied. If the conditions are met, SMF configures the UPF with the routing rules as described in the procedure description.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.2\tProcedures",
                            "text_content": "The figure depicts a local routing scheme for PIN communication, with a focus on the 17.2-1 line. It illustrates the use of a local routing table (LRT) to determine the best path for data transmission between two nodes. The LRT is updated in real-time, ensuring that the most efficient path is used for each data packet. This local routing scheme is particularly useful in scenarios where the network topology is complex and the need for efficient data transmission is critical.\nFigure 6.17.2-1: Local routing for PIN communication\nStep 0.\tThe PIN is created. PIN is provisioned with one or more PEGCs. This example shows a PIN with 2 PEGCs, the same procedure is applicable for more than two PEGCs.\nStep 1a, 1b.\tPEGCs establish/modify PDU Sessions for the PIN.\nStep 2.\tPEMC informs the PIN AF with the IP addresses of the PEGCs over application layer. In case Framed routing is used, the PINE identifiers that require local routing is also informed to the PIN AF. A PIN AF within the trusted domain of 5GC may also be referred as PIN Management Function or PIN MF.\nStep 3a, 3b.\tThe PIN AF configures NEF whether PIN requires local routing as described in clause 6.12.2.2. The PIN AF also provisions other PIN routing information for as described in clause 6.12.2.2.\nAdditionally, it includes the parameters identified above.\nIf PEGCs use NAT functionality, individual PINE IP Addresses are not included in the list of IP Addresses, only PEGC IP addresses are included.\nStep 4.\tNEF-SMF association is created for PIN management as described in clause 6.12.2.1. NEF provides to the SMF, the configurations for creating N4 rules for local routing.\nStep 5.\tSMF evaluates the location and time restrictions if applicable for local routing.\nStep 6.\tSMF creates the N4 rules as described in clause 5.8.2.13 of TS 23.501 [2] with the following differences.\n-\tThe following rules are configured for processing packets arriving from this PEGC:\n-\tin order to detect the traffic, a PDR containing Source Interface set to \"access side\", and CN Tunnel Information set to PDU Session tunnel header (i.e. N3 or N9 GTP-U F-TEID); and\n-\tin order to forward the traffic, a FAR containing Destination Interface set to \"5G PIN internal\"+PIN Identifier.\n-\tThe following rules are configured for processing packets towards this PEGC:\n-\tin order to detect the traffic, a PDR containing Source Interface set to \"5G PIN internal\" + PIN identifier, and Destination Address set to the IP address (es) of this PEGC/ the PIN elements (IP addresses configured for framed routing if that is used); and\n-\tin order to forward the traffic, a FAR containing Outer Header Creation indicating the N3/N9 tunnel information, and Destination Interface set \"access side\".\nIf N19 based forwarding is to be used, SMF configures the group level N4 session for each N19 tunnel as follows:\n-\tfor processing packets received from a N19 tunnel with the following N4 rules are created:\n-\tin order to detect the traffic, a PDR containing Source Interface set to \"core side\", and CN Tunnel Information set to N19 tunnel header (i.e. N19 GTP-U F-TEID); and\n-\tin order to forward the traffic, a FAR containing Destination Interface set to \"5G PIN internal\" + PIN identifier.\n-\tfor processing packets towards 5G PIN Gateway/Elements anchored at other UPFs with the following N4 rules:\n-\tin order to detect the traffic, a PDR containing Source Interface set to \"5G PIN internal\"+PIN Identifier, and Destination Address set to the IP address (es) of PEGCs/PIN Elements anchored at the peer UPF of this N19 tunnel; and\n-\tin order to forward the traffic to a 5G PIN Gateway/Element anchored at another UPF via the N19 tunnel, a FAR containing Outer Header Creation indicating the N19 tunnel information, Destination Interface set to \"core side\".\nThe SMF may also configure the following N4 rules for the group-level N4 Session to process packets with an unknown destination address:\n-\tin order to detect the traffic, a PDR containing Source Interface set to \"5G PIN internal\" + PIN identifier, a match-all Packet Filter, and a Precedence set to the lowest precedence value; and\n- in order to process the traffic, a FAR containing Destination Interface set to \"core side\" to route the traffic via N6 by default, or in the case of local SMF configuration that N6-based forwarding is not applied a FAR instructing the UPF to drop the traffic.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "PIN AF (PIN MF):\n-\tSupport PIN Association operations to provision PIN Routing information for local routing.\nNEF:\n-\tProvides the necessary configurations for creating N4 rules.\nSMF:\n-\tSupport local routing operations for PIN by provisioning N4 rules.\nEditor's note:\tAdditional impacts are FFS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.18\tSolution #18: Delay budget between PINE and PEGC",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.18.1\tDescription",
                            "text_content": "QoS experienced by PINE behind a PEGC depends on the end-to-end path between a PINE and the application server, i.e. depends on the QoS differentiation in both the 3GPP network and the non-3GPP network attached to the PEGC.\nThe packet delay budget (PDB) currently only considers the delay between the UPF and the UE (i.e. PEGC); the additional delay between the PEGC and the PINE is not accounted for.\nTo address this shortcoming, this solution proposes to make 5GS aware of the additional delay that can occur in the non-3GPP network attached to the PEGC and to compensate for this delay in 5GS. The compensation is achieved by reducing the PDB for the 3GPP network by the delay that can occur in the non-3GPP network attached to the PEGC (referred to as non-3GPP delay hereafter).\nThis solution proposes two enhancements to make 5GS aware of the non-3GPP delay:\n-\tA Default non-3GPP network delay budget is configured in the UDR as part of the PDU Session policy control subscription information. The PCF applies the Default non-3GPP delay budget when taking policy decisions, i.e. the PCF reduces the PDB for a given flow by the Default non-3GPP delay budget.\n-\tIf supported by the PEGC and if the PEGC wants to change the default non-3GPP delay budget for a specific flow, the PEGC may use the UE requested PDU Session Modification procedure to request a non-3GPP delay budget for a set of packet filters. The SMF provides the Requested non-3GPP delay budget received from the PEGC to the PCF, which takes it into account for the subsequent policy decision.\nThis solution focuses on the delay budget of non-3GPP access and PDB adjustment for 5G QoS flow, which has no dependence on the PIN management capability.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.18.2\tProcedures",
                            "text_content": "The figure depicts a network with non-3GPP network attached to the PEGC, taking into account delays in the non-3GPP network. The figure shows the network architecture, including the non-3GPP network, PEGC, and the 5GS network.\nFigure 6.18.2-1: Taking delays in the non-3GPP network attached to the PEGC into account in 5GS\n1.\tPDU Session is established.\n2.\tApplication layer signalling is exchanged between an application on a PINE connected to the PEGC and an application function (AF).\n3.\tBased on the application layer signalling, the AF requests QoS for application flows.\nNOTE 1:\tIf the AF is not considered trusted, then the AF interacts with the NEF instead. If the AF provides explicit QoS parameters, then AF (or NEF in case the AF is not trusted) interacts with PCF as defined in clause 4.15.6.6 of TS 23.502 [3].\nNOTE 2:\tSteps 1-3 are following existing Rel-17 specifications.\n4.\tPCF creates/updates PCC rules based on the AF request. If the PDU Session policy control subscription information in the UDR contains a Default non-3GPP delay budget, then the PCF takes it into account by reducing the PDB for the application flows by the Default non-3GPP delay budget.\n5.\tPCF sends the PCC rules to the SMF and also includes the non-3GPP delay budget.\n6.\tSMF completes the PDU Session modification based on the PCC rules received from the PCF and includes in the N1 SM container the non-3GPP delay budget provided by the PCF. A PEGC that does not support the non-3GPP delay budget information, will ignore the non-3GPP delay budget included in the N1-SM container.\n7.\tApplication traffic is exchanged between the application on a PINE connected to the PEGC and an application function (AF).\n8.\tIf the PEGC supports signalling of non-3GPP delay budget information and determines the need to request a different non-3GPP delay budget for a specific flow of a PINE, then the PEGC initiates the UE requested PDU Session Modification procedure and includes the Requested non-3GPP delay budget. The packets filters that the PEGC includes in the UE requested PDU Session Modification Request include at least the PINE' IP address and optionally port numbers. In case PEGC has assigned a private IP address to the PINE, then the PEGC includes its own IP address and the port numbers used for the PINE.\nNOTE 3:\tHow the PEGC determines the need to request a different non-3GPP delay budget for a specific flow (e.g. by monitoring the delays in the non-3GPP network) is up to PEGC implementation.\n9.\tThe SMF provides the Requested Non-3GPP delay budget to the PCF.\n10.\tPCF creates/updates PCC rules based on the Requested non-3GPP delay budget received from the SMF by reducing the PDB for the application flows by the Requested non-3GPP delay budget received from the SMF. The PCF may also alternatively apply a different non-3GPP delay budget, based on operator policy. PCF uses the packet filters as signalled by the PEGC for the PCC rules as per existing procedures.\n11.\tPCF sends updated PCC rules to the SMF and also includes the non-3GPP network budget.\n12.\tSMF completes the PDU Session modification based on the PCC rules received from the PCF and includes in the N1 SM container the non-3GPP delay budget provided by the PCF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.18.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "SMF:\n-\tSupport signalling of non-3GPP delay budget between UE and PCF.\nPCF:\n-\tReceive Default non-3GPP delay budget from UDR.\n-\tTake Default non-3GPP delay budget from UDR into account for policy decisions (specifically for calculating PDB).\n-\tProvide non-3GPP delay budget to SMF.\n-\tOptionally, support receiving Requested non-3GPP delay budget from SMF.\n-\tOptionally, take Requested non-3GPP delay budget from SMF into account for policy decisions (specifically for calculating PDB).\nUDR:\n-\tSupport Default non-3GPP delay budget as part of the PDU Session policy control subscription information.\nPEGC:\n-\tOptionally, support receiving non-3GPP delay budget from SMF.\n-\tOptionally, support signalling Requested non-3GPP delay budget to SMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.19\tSolution #19: QoS handling for PINE communication with 5GC via PEGC",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.19.1\tDescription",
                            "text_content": "The solution applies to Key Issue #4 \"Communication of PIN\" and Key Issue #6 \"Policy and parameters provisioning for PIN\".\nThe PIN architecture is depicted as in Figure 6.19.1-1. The PEMC and PEGC have Uu capability and can access 5GC using the procedures as defined in TS 23.502 [3]. The PINE may have limited communication capability and can only support some forms of direct non-3GPP access, e.g. Wi-Fi or BT.\nThe figure depicts a reference architecture for a PIN (Point-to-Point Network) system, illustrating the various components and their connections. The architecture includes a base station (BS), a user equipment (UE), and a network element (NE). The figure also shows the use of redundancy paths to ensure reliable communication.\nFigure 6.19.1-1: Reference architecture for PIN\nThe PEMC is responsible for managing the PIN, including creating a PIN, adding/removing a PINE from the PIN, etc. The PEMC may be preconfigured with PIN information that it can support, or the PIN information can be provisioned by PCF to the PEMC.\nThe PEGC provides connectivity services for PINE to access the network. The PINE can communicate with PEMC, PEGC and other PINEs via direct non-3GPP access (e.g. Wi-Fi and BT). The PINE can also communicate with 5GC via the PEGC, and the PEGC acts as an IP router to relay traffic between PINE and 5GC.\nFor a PINE accessing network via PEGC, the QoS requirement of the relayed traffic can be satisfied by the corresponding QoS control for the direct non-3GPP access (out of 3GPP scope) and the QoS control for the QoS flow. The end-to-end QoS can be met when the QoS requirements are properly translated and satisfied over the two legs respectively.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.19.2\tProcedures",
                            "text_content": "The policy and parameters for PIN and PIN element discovery may be provisioned by PCF.\nThe \"PCF based Service Authorization and Provisioning to UE\" procedure as defined in clause 6.2.2 of TS 23.304 [6] is reused for PCF to provision PIN policy and parameters to PEGC.\nThe \"AF-based service parameter provisioning for ProSe over control plane\" procedure as defined in clause 6.2.5 of TS 23.304 [6] is reused for PIN AS to provide PIN Service Parameters to the PCF.\nThe PIN policy and parameters include:\n-\ta mapping between a Uu QoS parameters (including 5QI, GFBR/MFBR, ARP) value and QoS information of direct non-3GPP access (including QoS characteristics, GFBR/MFBR, ARP, Periodicity).\nDepicted in figure 6.19.2.2-1 is the procedure for Network initiated QoS flow establishment for PINE.\nThe figure depicts a network initiated QoS flow establishment for PINE, which is a protocol used in 5G networks to ensure high-quality service delivery to end-users. The flow is initiated by the network, and the QoS parameters are set to ensure that the service is delivered at the highest possible level. The figure shows the flow initiation process, including the network, the PINE protocol, and the QoS parameters.\nFigure 6.19.2.2-1: Network initiated QoS flow establishment for PINE\n1.\tThe PEGC registers to network and establishes PDU session for relaying PINE traffic.\n2.\tPINE discovers PEGC using solutions for KI#2 and establishes connection with PEGC over direct non-3GPP access (e.g. Wi-Fi and BT).\nThe application layer signalling interacts between PINE and PIN AS.\n3.\tThe PIN AS may trigger a new QoS flow establishment and that triggers PCF-initiated QoS flow establishment procedure as defined in clause 4.3.3 of TS 23.502 [3].\n4.\tThe PEGC receives 5QI for the new established QoS flow from SMF, and the PEGC determines the direct non-3GPP access QoS info based on the PCF provisioned mapping as described in clause 6.19.2.1.\n5.\tThe PEGC applies direct non-3GPP QoS information to reserve resources over direct non-3GPP access, which is out of 3GPP scope.\nThe traffic from/to the PINE is relayed by the PEGC.\nDepicted in figure 6.19.2.2-2 is the procedure for PINE initiated QoS flow establishment.\nThe figure depicts a flow establishment process initiated by PINE (Pilot Inoculation and Network Enrollment) in a 192.2.2 network. The flow is established using a QoS (Quality of Service) flow, which ensures that the network provides a certain level of service to the user. The figure shows the flow initiation process, including the use of PINE, the network enrollment, and the establishment of the QoS flow.\nFigure 6.19.2.2-2: PINE initiated QoS flow establishment\n1.\tThe PEGC registers to network, and establishes PDU session for relaying PINE traffic.\n2.\tPINE discovers PEGC using solutions for KI#2 and establishes connection with PEGC over direct non-3GPP access (e.g. Wi-Fi and BT).\n3.\tThe PINE establishes Wi-Fi/BT connection with PEGC and provides direct non-3GPP access QoS info to the PEGC (out of 3GPP scope).\nEditor's note:\tIt is assumed PINE can provide QoS info to PEGC using existing Wi-Fi/BT mechanism, and reference to Wi-Fi/BT spec can be added later.\n4.\tThe PEGC determines the 5QI and other QoS parameters based on the PCF provisioned mapping as described in clause 6.19.2.1.\n5.\tThe PEGC initiates PDU session modification procedure to establish new QoS flow.\nThe traffic from/to the PINE is relayed by the PEGC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.19.3\tImpacts on services, entities and interfaces",
                            "text_content": "PEGC:\n-\tRequest and Receive PIN policy/parameters from PCF.\nPCF:\n-\tProvision PIN policy/parameters to PEGC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.20\tSolution #20: PIN communication using multiple PEGCs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.20.1\tDescription",
                            "text_content": "This solution focuses on the scenario when a PIN has multiple PEGCs. A valid use case could be a PIN has more and more PINE join, so that a single PEGC may not be able to serve all the PINE, in terms of the capacity and bandwidth. If more than one PEGC is introduced for a PIN, it is necessary to consider the issues, such as dynamic association between the PINE(s) and PEGC, user plane configuration for PEGC's PDU session, taking into account the load balance issues for a single PEGC, etc.\nThis solution addresses the following scenarios in the assumption of multiple PEGCs:\n-\tHow to manage the association between PEGC and PINE.\n-\tHow to enable a PIN Element to use a PEGC to communicate with a 5GS.\n-\tHow to support a relay path management for a PINE.\nFollowing are the principles for this solution:\na)\tThis solution is based on solution #6.\nb)\tPEMCF is responsible for managing the association between PEGC and PIN Elements (PINE). A PEGC can be used as a relay for one or more PIN Element\nc)\tWhen PEMCF has configured the association between PEGC and PIN Elements, it will report the association to P-NF. P-NF is responsible for managing and storing the association. PEMC will also notify the association to the relevant PEGC and PIN Elements.\nd)\tWhen a PINE needs path relay, it will send a request to its targeted PEGC via PIN layer. The PEGC will determine whether to request the session management for SMF. If it does, the PEGC will send a request to the PIN PDU session establishment. When SMF receives the PIN PDU session request, SMF will send a request to P-NF to get the association between the targeted PINE and the configured PEGC. If there is only one PEGC in the PIN, framed routing is reused as described in TS 23.501 [2] clause 5.6.14.\ne)\tAfter getting the mapping from P-NF, SMF will set the corresponding PDR and FAR and sends the rules to UPF.\nf)\tWhen UPF receives the downlink data to a PINE, it will transfer the data to the corresponding PEGC via the PDU session for PIN service based on the according FAR and PDR. The FAR indicates targeted PDU session of the PEGC, and PEGC will transfer the downlink data to the relevant PINE. It is assumed that the SMF can control the PEGC only has one session for PIN service and the PEGC provides a list of IP address of the PINE behind it by using framed routing.\ng)\tAfter determining the association between PEGC and PINE, PEMC can modify the configured association. For instance, if there is an overload situation in the PEGC and it cannot meet the relay QoS requirement for other PINE(s), the PEGC will send a notification to the PEMC. This is done via the interaction between PEGC and PEMC. PEGC notifies the PEMC of the load status. The PEMC can assign another PEGC for the PINE. The PEMC sends the updated association to P-NF. Then P-NF notifies SMF to update the routing rules.\nFigure 6.20.1-1 depicts the reference architecture for the solution.\nThe figure depicts a selection of a PEGC (Physical-to-Physical Encapsulation Gateway) for traffic relay, highlighting the importance of selecting the appropriate PEGC based on the network's requirements. The figure illustrates the various options available, such as Ethernet, MPLS, and VPLS, and their respective advantages and disadvantages. The selection process is crucial for ensuring efficient and reliable communication in the network.\nFigure 6.20.1-1: The selection of a PEGC for traffic relay\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.20.2\tProcedures",
                            "text_content": "A procedures for PIN communication using multiple PEGCs is shown in Figure 6.20.2-1.\nThe figure depicts a PIN communication system using multiple PEGCs, illustrating the use of physical layer encryption (PELC) for secure communication.\nFigure 6.20.2-1: PIN communication using multiple PEGCs\n0.\tStep 0 is the process of PIN creation, which is described in clause 6.6.2 of solution #6.\n1.\tPEMC configures the association between PEGC and PIN Elements (PINE) and notifies the association to the relevant PEGC and PIN Elements. PEGC will allocate the IP address to its associated PINE, and PEGC notifies the association to PEMC.\n2.\tPEMC reports the association to P-NF. P-NF stores the association.\n3.\tA PINE needs path relay and sends a request to its targeted PEGC via PIN layer. The PEGC will determine whether to request the session management for SMF. If the PINE has the association with the PEGC, the PEGC will send a request to the PIN PDU session establishment.\n4.\tThe SMF verifies that the PEGC has only one session for the PIN service and that the PEGC has provided either the framed routing information as specified in clause 5.6.14 of TS 23.501 [2] or the IP address that it has allocated to the PINE in accordance to the PEGC subscription data. SMF receives the PIN PDU session request, and sends a request to P-NF to get the association between the targeted PINE and the configured PEGC. P-NF responds to the request with the mapping.\n5.\tDepending on what the PEGC provides in step 4, the SMF will provide the UPF with either the framed routing information or the IP address that the PEGC has allocated to the PINE. When the PEGC sends the IP address associated to the PINE ID, it is possible for the network to have better visibility of the PIN context. The SMF sets the PDR and FAR and sends the rules to the UPF.\nNOTE:\tIf the AF communicates with the PEGC via the application layer, the Frame route information may also be sent by the PIN AF via the NEF.\n6.\tSMF responds to PEGC request. When UPF receives the downlink data to a PINE, it will transfer the data to the corresponding PEGC via the PDU session for PIN service based on the according FAR and PDR. When PEGC receives the downlink data, it will transfer the data to the targeted PINE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.20.3\tImpacts on services, entities, and interfaces",
                            "text_content": "PEMC:\n-\tDetermine the association between PEGC and PINE.\n-\tSend the association to P-NF, and if the association changes, send the notification to update the association in P-NF.\nP-NF:\n-\tRecord traffic data route rules, including the association between PEGC and PINE.\n-\tNotify SMF the updated association.\nPEGC:\n-\tSupport to send a request for a PIN PDU session establishment.\nSMF:\n-\tSupport to get the association from P-NF, and set the according PDR and FAR based on the association.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.21\tSolution #21: Authorization of a PINE for PIN Access",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.21.1\tDescription",
                            "text_content": "This solution addresses Key Issue #5: Authorization for PIN.\nThe principle of this solution is that, in order to join a PIN, a PINE must first discover a PEMC and send a join request to the PEMC. The PEMC will then authorize the PINE for connectivity to the PIN and may authorize the PINE to access 5GS services via a PEGC.\nThe procedure assumes that a 3GPP defined PIN Protocol will be used to communicate between PINEs (e.g. between the PINE and PEMC).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.2\tProcedures",
                            "text_content": "A procedure for authorizing a PINE for access to a PIN is shown in Figure 6.21.2-1. As a precondition, the PINE is configured with Bootstrap Information. Bootstrap Information includes:\n-\tInformation that is used to discover a PIN.\n-\tAn Initial PINE ID (e.g. a unique PINE ID or a mapped PINE ID).\n-\tInformation that can be used in an Authorization procedure.\nIf the PINE is a UE, the Bootstrap Information may have been received in a UE Configuration Update message. The Bootstrap Information may also be provisioned out of band, e.g. manually entered, pre-configured in the ME during manufacturing.\nAlso, as a precondition, the PINE discovers a PEMC (e.g. using key issue #2 solutions). And PEMC is able to communicate with the PEGC either via PC5 or via the 5GC.\nThe figure depicts a 21.2-1 PINE authorization, which is a crucial step in the process of authorizing a user to access a specific resource or system. The figure shows a user, a PIN, and a PIN code, indicating that the user must enter the PIN to gain access. The PIN is represented by a 21.2-1, which is a unique identifier for the user. The figure also includes a 1, which represents the resource or system that the user is trying to access. The figure is important for ensuring that only authorized users can access the resource or system, and that the PIN is entered correctly to gain access.\nFigure 6.21.2-1: PINE Authorization\n1.\tIn step 1, the PINE sends a PIN Protocol Join Request to the PEMC. The request includes at least the Initial PINE ID from the Bootstrap information.\n2.\tIn step 2, if the PEMC already has the necessary information to perform an authorization procedure with the PINE, then the procedure skips to step 6. Otherwise, the PEMC sends a request NAS PINE AUTHORIZATION (Initial PINE ID) Request to the AMF to obtain the necessary information to authorize the PINE.\n3.\tIn step 3, the AMF uses the Initial PINE ID to determine what NF (e.g. a UDM/UDR or a P-NF (e.g. Solution #6)) to contact to obtain the information that is necessary to authorize the PINE.\nNOTE 1:\tThis step is only necessary if the PINE ID is associated with a PLMN that is different than that of the AMF.\n4.\tIn step 4, the AMF executes a procedure with the NF to obtain necessary information to authorize the PINE. The information from the NF also indicates if the PIN is permitted to access the 5GS services via a PEGC.\n5.\tIn step 5, the AMF responds to the PEMC with the necessary information to authorize the PINE in a NAS PINE AUTHORIZATION RESPONSE. The information from the AMF also indicates if the PIN is permitted to access the 5GS services via a PEGC.\n6.\tIn step 6, if the PINE is not authorized to access services of the 5GS via a PEGC, the flow skips to step 8. Otherwise, the PEMC sends a PIN Protocol PEGC Configuration Command to provide a PEGC with the identity of the PINE so that the PEGC knows that the PINE is permitted to access the services of the 5GS via the PEGC.\nNOTE 2:\tThe solution assumes as per the architectural assumption that the PEMC can communicate with the PEGC.\n7.\tIn step 7, the PEGC sends a PIN Protocol PEGC Configuration Response to acknowledge the command of step 6.\n8.\tIn step 8, the PEMC sends a PIN Protocol Join Response to the PINE and indicates if the PINE is authorized to join the PIN. If the PINE is permitted to join the PIN and access services of the 5GS, then the PIN Protocol Join Response also provides the PINE with a PEGC ID.\nNOTE 3:\tThe PEMC should authenticate the PINE before authorizing it to connect to the PIN. How this is done is left for SA WG3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "PINE:\n-\tUses a PIN Protocol to send a PIN Protocol Join Request and receive a PIN Protocol Join Response.\nPEMC:\n-\tUses a PIN Protocol to receive a PIN Protocol Join Request and send a PIN Protocol Join Response.\n-\tSends a NAS PINE AUTHORIZATION request and receives a NAS PINE AUTHORIZATION Response.\n-\tUses a PIN Protocol to send a PIN Protocol PEGC Configuration Command and receive a PIN Protocol PEGC Configuration Response.\nPEGC:\n-\tUses a PIN Protocol to receive a PIN Protocol PEGC Configuration Command and send a PIN Protocol PEGC Configuration Response.\nAMF:\n-\tResolves a PINE ID to determine what NF to contact to authorize the PINE.\n-\tSends a request to an NF to authorize the PINE and receives a response.\n-\tReceives a NAS PINE AUTHORIZATION request and sends a NAS PINE AUTHORIZATION Response.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.22\tSolution #22: PIN Authorization",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.22.1\tDescription",
                            "text_content": "The solution is based on architecture alternative 0A described in clause 6.0A, and describes the following Authentication process:\n-\tPINE and its authorization to access 5GS, PEGC and other PINE.\n-\tAuthorization/De-Authorization of the PEMC.\nThe architecture for Authorizing PIN Elements to access other PINE, PEGC and PEMC in the PIN.\nThe figure depicts a token-based authorization architecture, which is a method of authentication and authorization in which tokens are used to represent user identities and permissions. The architecture is based on the concept of tokens, which are small, unique identifiers that represent a user's identity and permissions. Tokens are used to authenticate users, grant access to resources, and manage access control policies. The figure shows the different components of the architecture, including the token generation process, token storage, and token management. The architecture is designed to be flexible and scalable, allowing for easy integration with existing systems and systems that use token-based authentication.\nFigure 6.22.1-1: Token based Authorization Architecture\nAssumption: That the PIN elements are connected to a wireless LAN/ PAN network and each element are reachable via the wireless link. The procedure to connect to the wireless network and assign IP address is out of the scope of this document.\nThe salient feature of this solution is as follows:\n-\tPEMC Initialization. PEMC will communicate with the PINCTRL -as described in solution for KI#1- of the 5GC to download authorization policies. PEMC will use these downloaded policies to enforce authorization policies on PINE, PEGC and PEMC.\n-\tPINE Authorization. Suppose PINE1 of the PIN, intending to communicate with the other PINE for eg. PINE2, will send \"Authenticate and Request Access Token\" Request query to the PEMC, which will respond with the access Token to the requesting PINE (PINE1) based on the authorization policies. This access Token will also be sent to PINE2 so that it is aware that PINE1 is authorized to access PINE2.  PEMC will also update its central repository with the Access Token and its associated PINE(s).\n-\tPINE De-Authorization: Suppose PINE1 of the PIN, which has the access Token to access PINE2 of a PIN must be de-authorized due to operator or 3rd party policies. Then the PEMC will delete the Access Token and its associated PINE(s) from the central repository and communicate PINE De-Authorization message to the appropriate PINE(s).\n-\tPINE to PINE Communication with Access Token. Suppose PINE1 and PINE2 are authorized by the PEMC to communicate on the PIN. PINE1 will send an \"Service Request with Access Token\" to the PINE2 and it will authorize based on the access Token received from the PEMC and provide its services accordingly.\n-\tPINE to 5GS access Authorization. Suppose PINE1 of the PIN, intending to communicate with 5GS via PEGC will send \"Authenticate and Request Access Token\" Request query to the PEMC, which will respond with the access Token to the requesting PINE (PINE1) based on the authorization policies. This access Token will also be sent to PEGC so that it is aware that PINE1 is authorized to access 5GS. The PEMC will also update its central repository with the Access Token and its associated PINE and 5GS services via PEGC.\n-\tPINE to 5GS Communication with Access Token. Suppose PINE1 and PEGC are authorized by the PEMC for PINE1 to access 5GS. Then PINE1 will send a \"Service Request with Access Token\" to the PEGC and it will authorize based on the access Token received from the PEMC and provide 5GS accordingly.\n-\tPINE to 5GS Communication De-Authorization: Suppose PINE1 of the PIN, which has the access Token to access 5GS via PEGC of a PIN must be de-authorized due to operator or 3rd party policies. Then the PEMC will delete the Access Token and its associated PINE(s) from the central repository and communicate PINE De-Authorization message to the appropriate the PEGC and PINE. PINE1 Access Token to 5GS is no more valid.\n-\tPEMC Authorization: A NAS capable UE will register with the 5GS with \"PIN capable\" in the initial registration message to be authorized to form the PIN. 5GC architecture enhancements to support PIN are described in the solution for KI#1 and KI#6. Based on the \"PIN control function\" policies, the 5G core will authorize/deny the PIN formation. Once authorized by the 5G Core, the PIN element is identified as PEMC.\n-\tPEMC De-Authorization: 5GS will send a PEMC de-authorization message to the PEMC and it will send an PIN deactivation message as described in solution KI#3. Then will PEMC will de-authorization Acknowledge message to the 5G core.\nThis solution assumes that authorisation procedure is based on https protocol\nEditor's note:\tThe definition of access Token is FFS and under SA3 responsibility\nEditor's note:\tThe authentication procedure and security aspects are under SA3 responsibility, so considerations and evaluation on feasibility of authorisation mechanism based on token is outside SA2 scope.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.22.2\tProcedures",
                            "text_content": "The figure depicts a complex network structure, with various layers and components, including PINE1 authorisation, which is a crucial aspect of network security.\nFigure 6.22.2.1-1: PINE1 authorisation\n1.\tPINE1 intending to communicate with PINE2 (e.g. Printer) will send PINE2 access Token query to PEMC.\n2.\tPEMC will request PINE1 for \"Identity request\" before granting PINE2 Token.\n3.\tPINE1 sends its registered Identity to PEMC.\n4.\tPEMC will decide to grant PINE1 access to PINE2 based on the policies from PINCTRL.\n5.\tPEMC will also send PINE1/PINE2 access Token to PINE2.\n6.\tPINE2 will send acknowledgment for PINE1/PINE2 Token.\n7.\tPEMC sends PINE2 access Token to PINE1.\n8.\tPINE1 will send access request + PINE1/PINE2 Token to PINE2.\n9.\tPINE2 will acknowledge with OK + access grant.\n10.\tCommunication between PINE1 and PINE2 begins.\nThe figure depicts a communication channel between two devices, with the first device being a 5G network and the second device being a PINE communication system. The figure shows the authorisation process for PINE communication to 5GS, with the first device being the 5G network and the second device being the PINE communication system.\nFigure 6.22.2.2-1: Authorisation for PINE communication to 5GS\n1.\tPINE1 intending to access 5G system via PEGC will send PEGC access Token query to PEMC.\n2.\tPEMC will request PINE1 for \"Identity request\" before granting PEGC Token.\n3.\tPINE1 sends its registered Identity to PEMC.\n4.\tPEMC will decide to grant PEGC access to PINE1 based on the policies from PINCTRL.\n5.\tPEMC will also send PINE1/PEGC access Token to PEGC\n6.\tPEGC will send acknowledgment for PINE1/PEGC Token.\n7.\tPEMC sends PEGC access Token to PINE1.\n8.\tPINE1 will send access request + PINE1/PEGC Token to PEGC.\n9.\tPEGC will acknowledge with OK + access grant\n10.\tCommunication between PINE1 and 5G system via PEGC begins.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.22.3\tImpacts on services, entities and interfaces",
                            "text_content": "The solution has the following impacts:\nImpact to the UE (PEMC):\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\n-\tAbility to maintain a list of all the PINE and its supported services.\nImpact to the UE (PINE/PEGC):\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\nImpact to the 5G System:\n-\tAdd new Network Function (PINCTRL) to the NAS in 5GS.\n-\tAdd new fields to the Registration request such as \"PIN capable\".\n-\tAdd new fields to the Registration Accept message such as \"PIN allowable\", \"PIN Name\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.23\tSolution #23: Policy provisioning framework for PIN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.23.1\tDescription",
                            "text_content": "This solution addresses the key issue \"Policy and parameters provisioning for PIN\". The solution presents a framework for policy and parameter provisioning for Personal IoT Networks.\nThe policy and parameters for certain types of Personal IoT Networks (e.g. a smart home network) are heavily influenced by the Application Function (AF). It is foreseen that different AFs have varying requirements on how PIN policies are to be provisioned in the 5G network. Some types of PINs will work with pre-configured/pre-provisioned policy parameters. The traffic routing rules or other management parameters will not have any dynamic aspects. Any PIN created by authorized PEMCs will have the same characteristics. This is a static pre-provisioning of PIN policy parameters.\nIn certain other types of PIN networks, there may be some static components of PIN policies. There will also be a set of dynamic parameters which AF will configure after a PIN is established.\nA third type of PIN networks will have all dynamic PIN policies. The PEMC may only have a minimum configuration to initiate establishment of a PIN. Further on, the policy and parameters for the PIN operation will be provisioned dynamically by the AF.\nThis solution provides the framework for Policy provisioning in all three cases for PINs that rely on PIN AF or PIN MF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.23.2\tProcedures",
                            "text_content": "A PEMC initiates PIN establishment only if it is authorized to act as a PEMC. The authorization for PEMC is provided based on UE subscription information during registration procedure.\nThe figure depicts a network configuration with various pre-provisioned policies, including PINs, which are used to manage access control and security in a 5G network. PINs are essential for ensuring secure communication and preventing unauthorized access.\nFigure 6.23.2.1-1: PIN pre-provisioned policies\n1.\tAn AF uses parameter provisioning services to provide PIN policies. PIN policies could include PIN identifier policies, privacy policies and traffic routing policies.\n2.\tA UE capable of PEMC operation registers in the 5G network. AMF includes PEMC authorization as part of registration procedure.\n3.\tUE request PIN Policy provisioning to PCF. A UE may optionally include PIN AF identifiers to fetch the appropriate policies.\n4.\tPCF fetches PIN policies according to the UE's subscription. PIN policies can include PIN identifier or policies for self-assigning PIN identifier, privacy policies, traffic routing policies. PIN policies could also include indication to inform 5GC about PIN creation. PCF delivers UE policies using the UE Configuration Update procedure defined in clause 4.2.4 of TS 23.502 [3].\n5.\tPIN elements are added to PIN network.\n6.\tUE informs PIN establishment to AMF. AMF may provide further time and geographic restriction policies at this stage.\nNOTE:\tThe exact PIN policies provisioned by the AF may also be defined by other solutions to this Key Issue.\nThe figure depicts a dynamic policy update process for a PIN (Point-to-Point Network Interface) in a 23.2.2-1 network. The process involves updating the policy of the network interface, which is a crucial component for managing network traffic and ensuring efficient communication. The figure illustrates the steps involved in updating the policy, including the selection of the policy update method, the selection of the policy update interval, and the selection of the policy update interval for the selected method. The figure also includes a visual representation of the network interface, showing the status of the policy update process and the status of the network interface.\nFigure 6.23.2.2-1: PIN dynamic policy updates\n1.\tPEMC UE indicates PEMC capability to the AMF. The AMF provides PEMC authorization. AMF also indicates that PEMC UE is allowed for dynamic PIN creation.\n2.\tPIN is established\n3.\tThe PIN related information is exchanged over application layer to PIN AF\n4.\tPEMC UE informs AMF of PIN establishment. PIN identifiers and UE identifiers for PEGC are informed to the AMF. AMF provisions basic PIN policy, including geographic area or time restrictions for operation.\n5.\tPIN AF derives the PIN policies specific to the MNO and updates it to PCF directly or through NEF.\n6.\tPCF updates the policies (including privacy policies for PIN and PINE discovery) that have to be provisioned to the PEMC UE based on UE subscription data.\n7.\tPCF triggers policy update to the PEMC UE. PCF delivers UE policies using the UE Configuration Update procedure defined in clause 4.2.4 of TS 23.502 [3]. Traffic routing policies for PIN are delivered as URSP rules.\nNOTE:\tThe exact PIN policies provisioned/updated by the AF may also be defined by other solutions to this Key Issue.\nThe figure depicts a PIN initiated policy retrieval process in a 23.2.3-1 network. The process involves a series of steps, including policy retrieval, policy update, and policy execution. The figure illustrates the flow of data and control in the network, highlighting the importance of policy management in ensuring network reliability and efficiency.\nFigure 6.23.2.3-1: PIN initiated policy retrieval\n1.\tPEMC UE registers with 5GC. The AMF provides PEMC authorization. AMF also indicates that PEMC UE is allowed for dynamic PIN creation.\n2.\tPIN is established.\n3.\tPEMC UE informs AMF of PIN establishment. PIN identifiers and UE identifiers for PEGC are informed to the AMF. AMF provisions basic PIN policy, including geographic area or time restrictions for operation.\n4.\tAMF also generates event to notify PIN AF about PIN Creation.\n5.\tPIN AF derives the PIN policies specific to this PIN instance and updates it to PCF directly or through NEF.\n6.\tPCF updates the policies (including, privacy policies for PIN and PINE discovery) that have to be provisioned to the PEMC UE based on UE subscription data. PCF delivers UE policies using the UE Configuration Update procedure defined in clause 4.2.4 of TS 23.502 [3]. Traffic routing policies for PIN are delivered as URSP rules.\nNOTE:\tThe exact PIN policies provisioned/updated by the AF may also be defined by other solutions to this Key Issue.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.23.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "AMF:\n-\tHandling of PEMC, PEGC authorization during registration. Handling of PIN establishment information, generating PIN establishment events towards AF.\nPCF:\n-\tHandling PIN policy parameters from AF. Provisioning PIN policy parameters towards PEMC/PEGC UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.24\tSolution #24: PIN Policy and Parameters Provisioning using the UE Configuration Update Procedure",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.24.1\tDescription",
                            "text_content": "This solution addresses Key Issue #6: Policy and parameters provisioning for PIN.\nThe principle of this solution is that a UE that can act as a PINE, PEGC, or PEMC indicates its PINE, PEGC, and/or PEMC capability to the AMF during registration. This indication is provided by the AMF to the PCF. The PCF may then use the \"UE Configuration Update procedure for transparent UE Policy Delivery\" procedures to deliver PIN related parameters and policies to the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.24.2\tProcedures",
                            "text_content": "The Registration procedures as defined in clause 4.2.2.2 of TS 23.502 [3], UE Policy Association Establishment procedure as defined in clause 4.16.11 of TS 23.502 [3], UE Policy Association Modification procedure as defined in clause 4.16.12 of TS 23.502 [3], and UE Configuration Update procedure for transparent UE Policy Delivery procedure as defined in clause 4.2.4.3 of TS 23.502 [3] apply with the following additions:\n-\tthe UE indicates its PINE, PEGC, and/or PEMC capability(ies) in the 5GMM Capability IE of the Registration Request message.\n-\tthe AMF provides the capability indication(s) to the PCF in the UE Policy Association Establishment and UE Policy Association Modification procedures.\n-\tthe PCF provides PIN policies and parameters to the UE by using the UE Configuration Update procedure for transparent UE Policy delivery procedure.\nThe PIN parameters and policies may include polices that relate to one or more PIN(s). For each PIN, the following set of information may be included in the PIN policies and parameters. Some of the information below may be part of the UE Subscription profile:\n-\tPIN ID.\n-\tPIN type (e.g. Sensor Type, AR/VR, smart light, plug, UE, etc.).\n-\tWhether the UE is permitted to act as a PINE, PEGC, and/or PEMC.\n-\tPermitted Discovery Types (e.g. open or restricted).\n-\tSecurity policies and parameters for communication within the PIN.\nNOTE:\tWhat and whether security policies and parameters for communication within the PIN are sent to the UE will be determined by SA WG3 (e.g. policies and parameters that relate to authenticating and authorizing other PINEs).\n-\tPolicies and Parameters that are sent if the UE is permitted to act as a PEMC:\n-\tThe DNN that should be used when sending PIN related traffic to the 5GC (e.g. communication with a PIN AS).\n-\tIdentities of UEs that can act as a PEGC in the PIN.\n-\tWhether traffic from the PIN may be forwarded via the 5GC (i.e. via a PGEC).\n-\tIdentities of PINEs that can join the PIN.\n-\tIdentities that the PEMC may assign to PINEs that join the PIN.\n-\tA validity duration and/or time validity for the PIN.\n-\tPIN Start time, i.e. the time when the PEMC may begin creating the PIN.\n-\tPIN size, i.e. maximum number of allowed PINEs.\n-\tPolicies and Parameters that are sent if the UE is permitted to act as a PEGC:\n-\tWhether traffic from the PIN may be forwarded via the 5GC (i.e. via a PEGC).\n-\tIf traffic may be forwarded via the 5GC, then the DNN that should be used when sending PIN related traffic via the 5GC.\n-\tTraffic routing rule (e.g. URSP rule) to enable the PEGC UE to identify application traffic generated from a PIN or by a PINE within a PIN and determine how to route the requested application traffic.\n-\tIdentities of UEs that can act as a PEMC in the PIN.\n-\tPolicies and Parameters that are sent if the UE is permitted to act as a PINE:\n-\tWhether traffic from the PIN may be forwarded via the 5GC (i.e. via a PEGC).\n-\tIdentities of UEs that can act as a PEMC in the PIN.\n-\tIdentities of UEs that can act as a PEGC in the PIN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.24.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "UE:\n-\tUE indicates its PINE, PEGC, and/or PEMC capability(ies) in the 5GMM Capability IE of the Registration Request message.\n-\tReceives PIN policies and parameters in the UE Configuration Update procedure for transparent UE Policy delivery procedure.\nAMF:\n-\tProvides the UE's PINE, PEGC, and/or PEMC capability(ies) to the PCF in the UE Policy Association Establishment and UE Policy Association Modification procedures.\nPCF:\n-\tReceives the UE's PINE, PEGC, and/or PEMC capability(ies) from the PCF in the UE Policy Association Establishment and UE Policy Association Modification procedures.\n-\tSends PIN policies and parameters to the UE in the UE Configuration Update procedure for transparent UE Policy delivery procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.25\tSolution #25: Policy and Parameter provisioning for PIN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.25.1\tDescription",
                            "text_content": "The solution is based on architecture alternative 0A described in clause 6.0A, and describes the procedures to provision policy and parameter for the PIN such as how policies and parameters are sent communicated to the PIN and vice versa.\nThis solution addresses KI#6 and describes the procedure to provision policy and parameters to the PIN.\nMore than 500 billion IoT devices are expected to be IoT devices by 2030, and to manage these PIN network and PIN elements by 5GC, this solution proposes to add PIN control function- a new network function to 5GC. This NF will be able to accept operator's policies statically or dynamically and be able to push them to the PIN and PIN elements. PEMC will register as PIN capable to the 5GC with a list of PIN elements and its capabilities to the new network function - PIN control function. Based on the operator or 3rd party policies such as add/delete PIN, add/remove a PINE for the PIN etc. the \"PIN ctrl function\" will acknowledge the PEMC accordingly. To push and query these policies, this solution proposes to add NPINCF Interface between PEMC of PIN to PINCF (Pin Control Function) as shown in Figure 6.0A.2.1-1.\nTo summarize, this solution proposes to add the following to provision policy and parameters for the PIN:\n1)\tAdd PIN Control Function to the 5GC (PIN Ctrl Func) that can push operators or 3rd party policies to the PIN. The policies will include create/delete a PIN, add/remove a PINE for the PIN etc.\n2)\tAdd Interface NPINCF between PINCTRL and other NF communication via SBI.\n3)\tAdd Reference point P1 between PEMC/PEGC and PINCTRL communication.\n4)\tThis solution proposes to add the following fields to the initial UE registration request message as defined in clause 5.5.1 of TS 24.501 [7]:\na.\t\"PIN Capable\", which can be true or false.\nb.\t\"PINE list\", which is a list of all the PIN elements with reachable address such as PINE1@SUCI_PIN, PINE2@SUCI_PIN etc.\nc.\tEach PINE in the PINE list will contain the intended features:\ni.\tPINE1, PEMC = FALSE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED (True/False values indicate that the functionality is allowed/not-allowed for e.g. PEMC = False indicates that the UE is not allowed to function as PEMC.\nii.\tPINE2, PEMC = TRUE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED\n5)\tThis solution proposes to add the following fields to the initial UE registration accept message as defined in clause 5.5.1 of TS 24.501 [7]:\na.\t\"PIN allowable\", which can be true or false.\nb.\t\"PINE list\", which contains a list of PINE elements and its associated policies and parameters. For e.g. A typical \"PINE list\" will be as follows:\ni.\tPINE1, PEMC = FALSE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\nii.\tPINE2, PEMC = TRUE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\n6)\tThis solution proposes to use UE Triggered Service Request as described in clause 4.2.3.2 of TS 23.502 [3] to push after registration policy and parameters to the PIN. This solution proposes to add the following fields or parameters to the Service Request:\na.\tUpdated \"PINE list\", which contains a list of PINE elements and its associated policies and parameters. For e.g. A typical \"PINE list\" will be as follows:\ni.\tPINE1, PEMC = FALSE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\nii.\tPINE2, PEMC = TRUE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.25.2\tProcedures",
                            "text_content": "The figure depicts a PEMC registration process with the PIN_Capability and PIN_List features, illustrating the steps involved in configuring a PEMC for a specific network.\nFigure 6.25.2.1-1: PEMC Registration with PIN_Capability and PIN_List\n0.\tPEMC will add PIN_Capability and PIN_List along with the conventional registration AN message which includes (AN parameters, Registration Request (Registration type, SUCI, Security params, PIN_Capability, PIN_List, etc.) as mentioned in clause 4.2.2 of TS 23.502 [3].\n1.\tPEMC will send the new Registration message with PIN_capable and PIN_List to the SMF via RAN. The following are the new PIN related fields:\na.\t\"PIN Capable\", which can be true or false.\nb.\t\"PINE list\", which is a list of all the PIN elements with reachable address such as PINE1@SUCI_PIN, PINE2@SUCI_PIN etc.\nc.\tEach PINE in the PINE list will contain the intended features:\ni.\tPINE1, PEMC = FALSE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\nii.\tPINE2, PEMC = TRUE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\n2.\tAMF will perform its conventional Identity request, Auth/Security, UDM selection, PCF selection etc. as mentioned in clause 4.2.2 of TS 23.502 [3].\n3.\tPCF selection procedure is performed according to clause 4.2.2 of TS 23.502 [3].\n4.\tAMF performs its Conventional Policy association Establishment/Mod and adds PIN_Capable, PIN_List to the PCF message as mentioned in clause 4.2.2 of TS 23.502 [3].\n5.\tPCF will send the PIN_Capable, PIN_List allowed/disallowed message to PINCTRL.\n6.\tPINCTRL will query the UDM for the subscription to send the decide and communicate the following message back to PCF:\na.\t\"PIN allowable\", which can be true or false.\nb.\t\"PINE list\", which contains a list of PINE elements and its associated policies and parameters. For e.g. A typical \"PINE list\" will be as follows:\ni.\tPINE1, PEMC = FALSE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\nii.\tPINE2, PEMC = TRUE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\n7.\tConventional PDU session_updateSMContext, UE context modification Req/Res is performed according to clause 4.2.2 of TS 23.502 [3] is performed.\n8.\tRegistration Accept, along with PIN_Capability, PIN_List Response message from PCF is sent as a Response to the PEMC.\nThe figure depicts a PEMC (Power-Efficient Micro-Controller) triggered service request to update the PIN_List, illustrating the communication between the PEMC and the system.\nFigure 6.25.2.2-1: PEMC Triggered Service Request to update PIN_List\n1.\tWhen a new PINE joins the PIN, the PEMC will send a new Service Request with updated PIN_List to the RAN. A typical Service Request with PIN_List will include the following:\na.\t\"PINE list\", which contains an updated list of PINE elements and its associated policies and parameters. For e.g. A typical \"PINE list\" will be as follows:\ni.\tPINE1, PEMC = FALSE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\nii.\tPINE2, PEMC = TRUE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\n2.\tRAN forwards the N2 message (Service Request with the updated PIN_List) to the AMF.\n3.\tConventional Authentication Security is performed according to clause 4.2.3 of TS 23.502 [3].\n4.\tAMF will send the Update PIN_List message to the PCF.\n5.\tPCF will send the Update PIN_List to PINCTRL for its approval.\n6.\tPINCTRL will decide based on the subscription and 3rd party/operators policy and send the Acknowledged update PIN_List to the PCF. A typical update PIN_List is as follows:\ni.\tPINE1, PEMC = FALSE, PEGC=FALSE, 5G_Aceess=TRUE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\nii.\tPINE2, PEMC = TRUE, PEGC=FALSE, 5G_Aceess=FASLE, PINE_TO_PINE=TRUE, DURATION = UNLIMITED.\n7.\tPCF will send the Acknowledged update PIN_List to AMF.\n8.\tAMF will send N2 Request with Acknowledged PIN_List to RAN.\n9.\tRAN will send the Update PIN_List response and the acknowledged PIN_List to the PEMC.\nThe figure depicts a network-triggered service request to update PIN/PINE policies, illustrating the process of requesting changes to the network's policies. The request is triggered by the network, indicating that the policy changes are necessary for the network's operation. The figure shows the steps involved in the request, such as the network's response to the request, and the steps taken by the requester to ensure the policy changes are implemented correctly.\nFigure 6.25.2.3-1: Network Triggered Service Request to update PIN/PINE Policies\n1.\tPINCTRL decides to update the PEMC PIN policies either due to operator or 3rd party policy update.\n2.\tPINCTRL invokes Namf_communication_N1N2MessageTransfer service operation provided by the AMF. The message includes SUPI of PEMC, PEMC PIN Policy container.\n3.\tIf the PEMC is registered and reachable by AMF in either 3GPP access or non-3GPP access, AMF shall transfers transparently the PEMC PIN Policy container to the PEMC via the registered and reachable access.\nIf the PEMC is not reachable by AMF over both 3GPP and non-3GPP access, the AMF reports to the PCF that the PEMC PIN Policy container could not be delivered to the PEMC using Namf_communication_N1N2MessageTransfer as mentioned in clause 4.2.3.3 of TS 23.502 [3].\n4.\tIf the PEMC is in CM-CONNECTED over 3GPP access or non-3GPP access, the AMF transfers transparently the PEMC PIN Policy container (PIN related policy information) received from the PINCTRL to the PEMC. The PEMC policy container includes the list of PIN policy as described in clauses 6.25.2.1 and 6.25.2.2.\n5.\tThe PEMC updates the PIN Policy provided by the PINCTRL and sends the result to the AMF\n6.\tIf the AMF received the PEMC PIN Policy container and the PINCTRL subscribed to be notified of the reception of the PEMC PIN policy container then the AMF forwards the response of the PEMC to the PINCTRL using Namf_communication_N1N2MessageNotify. The PINTCTRL will further handle successful and failure Notification accordingly.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.25.3\tImpacts on services, entities and interfaces",
                            "text_content": "The solution largely re-uses existing functionality\nThe solution has the following impacts:\nImpact to the 5GCore:\n-\tAdd New Network Function - PIN control function (PINCTRL)- to the 5GCore.\n-\tAdd New Interfaces P1 and NPINCTRL to the 5G system.\n-\tAdd New PIN Policy container, which will contain PIN Policy related fields.\n-\tAdd PIN_Capable fields to the Registration message.\n-\tAdd PIN_List field to the Registration message.\n-\tAdd PIN_List update to the Service request message.\n-\tAdd Namf_communication_N1N2MessageNotify message with PEMC PIN Policy container.\n-\tAdd PIN_Capable and PIN_List fields to registration accept message.\n-\tAdd Delivery of PIN Policies message and results of Delivery of PIN Policies.\nImpact to the UE (PEMC):\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\n-\tAbility to maintain a list of all the PINE and its supported services.\n-\tAbility to respond to PINE and its service discovery queries from the PINE.\nImpact to the PINE:\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\n-\tAbility to request QoS using http request to the PEGC.\nImpact to the UE (PEGC):\n-\tAbility to support http broadcast messages, http request-response and http based subscribe-notify features.\n-\tAbility to register its gateway functionality to PEMC.\n-\tAbility to accept http QoS request from the PINE and setup multiple PDU session with the 5G System.\n-\tAbility to map PDU session ID to the IP address of the PINE and forward packets to/from the corresponding PDU session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.26\tSolution #26: Solution for parameter provisioning of PIN subscription data",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.26.1\tDescription",
                            "text_content": "This solution describes how the PIN subscription data is configured in the PEGC/PEMC as required as part of the KI#6.\nThe solution describes UDM provides the subscription data to the PEGC/PEMC but the same information can be considered as policy and provided by the PCF to the PEGC/PEMC.\nPEGC PIN subscription data and PEMC PIN subscription data described can also be configured by the authorised user in the PEGC and/or PEMC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.2\tProcedures",
                            "text_content": "The figure depicts a provisioning PIN subscription data flow, illustrating the process of creating a PIN for a specific user. The flow starts with the user initiating the subscription, which is then sent to the provisioning server for validation. The server then sends the PIN to the user's device for authentication. The entire process is depicted in a flowchart, with each step clearly labeled and connected by arrows, illustrating the sequential steps involved in the process.\nFigure 6.26.2-1: Provisioning PIN subscription data\n1)\tThe PEGC/PEMC initiates registration procedure. As part of registration procedure PEGC/PEMC include the PIN input information. The PIN input information consists of one of below based on request is from PEGC or PEMC:\nFor PEGC:\na)\tThe UE wants to be(or anchor) as PEGC; and/or\nb)\tThe PIN ID (identity) for which it wants to be(or anchor) as PEGC .\nFor PEMC:\na)\tThe UE wants to be(or anchor) as PEMC; and/or\nb)\tThe PIN ID (identity) for which it wants to be(or anchor) as PEMC.\n2)\tAMF sends the PIN input information to the UDM.\n3)\tUDM based on subscription or PIN input information includes the PIN subscription data as described below.\n4)\tIf UDM includes the PIN subscription data the AMF indicates to the UE in registration accept message that UE is allowed to act as PEGC/PEMC and provide respective PIN subscription data in registration accept message.\nPEGC PIN subscription data:\na)\tOne or more PIN-IDs: Kind of group ID. The PEGC is allowed to join the PIN.\nb)\tMax number threshold: Threshold of maximum number of PINEs allowed for the PEGC. PEGC enforce max number threshold of PINEs.\nc)\tPer PINE Max duration: After a PINE has joined a PIN, how long it is allowed to be retained in the PIN. PEGC removes the PINE from the PIN when PINE max duration is reached.\nd)\tApplicable time slot for PEGC: For all the PIN-IDs. i.e. the PEGC will stop functioning if it is not in the allowable time slot. If PEMC attempts to add PEGC in the PIN during non allowed time slot an appropriate reject cause is provided to the PEMC so that PEMC can select some other PEGC for the PIN-ID.\ne)\tMax duration for PEGC- After UE starts behaving as a PEGC the maximum duration it should act as a PEGC after which it should cease to act as PEGC release all the PIN-E, indicate the same to PEMC.\nf)\tPer PIN-ID:\ni)\tMaximum duration: The time till UE should act as PEGC; once this time is expired the PEGC will stop acting as PEGC for the respective PIN-ID; or\nii)\tTime slot (start time-end time) for which a PIN-ID is valid for this PEGC. PEGC will stop or cease to act as PEGC for that PIN-ID if it is not in the allowed time slot;\niii)\tMaximum threshold: Threshold of maximum number of PINEs allowed per PIN-ID for the PEGC.\nPEMC PIN subscription data:\na)\tOne or more PIN-IDs: Kind of group ID. The PEMC is allowed to join/create the PIN.\nb)\tMax number threshold: Threshold of maximum number of PINEs/PEGCs allowed for the PEMC across all the PIN-IDs. PEMC enforce max number threshold of PINEs/PEGCs.\nc)\tPer PINE Max duration: After a PINE has joined a PIN, how long it is allowed to be retained in the PIN. PEMC removes the PINE from the PIN when PINE max duration is reached.\nd)\tApplicable time slot for PEMC: For all the PIN-IDs. i.e. the PEMC will stop functioning if it is not in the allowable time slot. If PINE requests to join the PIN during non allowed time slot an appropriate reject cause is provided by the PEMC.\ne)\tMax duration for PEMC: After UE starts behaving as a PEMC i.e. after creating a PIN or receiving an indication from 5GC NF that it should act as PEMC the maximum duration it should act as a PEMC after which it should cease to act as PEMC and release all the PINs.\nf)\tPer PIN-ID:\ni)\tMaximum duration: It is the time when PEMC is setup for a given PIN-ID i.e. the start time to the \"maximum duration\" in subscription; once this time is expired the PEMC will cease to act as PEMC for the respective PIN-ID; or\nii)\tTime slot (start time-end time) for which a PIN-ID is valid for this PEMC. PEMC will stop or cease to act as PEMC for that PIN-ID if it is not in the allowed time slot;\niii)\tMaximum threshold: Threshold of maximum number of PINEs allowed per PIN-ID for the PEMC.\ng)\tPer PEGC:\ni)\tMaximum duration: It is the time when PEGC is setup by PEMC. the start time to the \"maximum duration\" in subscription; once this time is expired the PEGC is removed from the PIN by PEMC;\nii)\tTime slot (start time-end time) for which a PEGC is valid. PEMC will remove PEGC from the PIN if it is not in the allowed time slot;\niii)\tMaximum threshold: Threshold of maximum number of PINEs allowed per PEGC for the PEMC.\nh)\tPriorities among PEGCs.\nPEGCs can be assigned priority, which will be used when threshold is reached. Assignment or re-assignment of the PEGC based on the priorities. If a higher priority PEGC joins a PIN and max number threshold is reached for PIN, the PEGC removes a lower priority PEGC to allow higher priority PEGC.\nPEGC PIN subscription data and PEMC PIN subscription data described can also be configured by the authorised user in the PEGC and/or PEMC.\nThe solution above describes UDM provides the subscription data to the PEGC/PEMC but the same information can be considered as policy and provided by the PCF to the PEGC/PEMC after the UE has completed the registration procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.3\tImpacts on services, entities and interfaces",
                            "text_content": "This solution impacts the following system entities.\nUE:\n-\tUE acting as PEGC/PEMC includes the PIN information IE in registration request message.\n-\tUE receives the indication in registration accept message if it can act as PEGC/PEMC or both along with respective PIN subscription data.\nAMF:\n-\tAs part of registration request message PIN information IE is received. AMF sends the PIN information to the UDM as part of Nudm_SDM_Get, in response the received PIN subscription data is sent to the UE in registration accept message.\nUDM:\n-\tUDM provides respective PIN subscription data if allowed as per the subscription of the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.27\tSolution #27: Management for identification for PIN and PINE",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.27.1\tDescription",
                            "text_content": "This solution is to address how to define the identification of PIN and PINE for Key Issue#7, and also address how to allocate the identification for PINE and PIN for Key Issue #3.\nAn appropriate format of PINE identifier is needed so that one PINE can communicate with another PINE via PEGC, or via PEGC via 5GC within a PIN.\nIn this solution, it proposes that one PINE identifier is consisting of:\n-\tPIN ID.\n-\tPEGC ID, or PEMC ID.\n-\tElement ID.\nPIN ID is used to identify a PIN network which the PINE is belonging to. PEGC ID is used to identify a PEGC which serving the PINE to access to 5GC. Element ID is used to uniquely identify the PINE within same PEGC. When the PINE is PEGC or PEMC, no Element ID is needed. So one PINE can precisely find the PEGC that serving the target PINE by using the PIN ID +PEGC ID, and identifying target PINE with further Element ID.\nPINE identifier can be allocated for the device by PEGC when first joining the PIN. When there are multiple PEGCs in a PIN, the PINE (e.g. PIN ID + PEGC-1 ID+ EID) moves from one PEGC-1 to PEGC-2, new PINE identifier is needed and allocated by PEGC-2. So that the PINE ID is identifiable with serving PEGC.\nPEGC and PEMC allocates the ID for itself, no Element ID is needed, e.g. PEGC ID =PIN ID + PEGC ID; PEMC ID = PIN ID + PEMC ID.\nOne PINE can have multiple PINEs allocated by multiple PEGCs. The PINE identifier allocated by one PEGC can be only used in this PEGC. When the PEGC leaves the PIN, all the PINE identifier(s) allocated by this PEGC are removed accordingly.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.27.2\tProcedures",
                            "text_content": "Editor's note:\tThe figure of the call flow needs to be provided.\n1.\tDevice (PINE) requests to PEGC for joining the PIN, with device information, e.g. device ID, or mac address, capability, service, valid time.\n2.\tPEGC sends the request with device information to PEMC for approval with the necessary device information in step1, and PINE ID allocated by PEGC, which contains PIN ID, PEGC ID, and an Element ID.\n3.\tWhen the device is accepted as PINE by PEMC, PEMC sends the new PINE information (e.g. PINE identifier, PINE Service, PINE capability, valid time, etc.) to UDM to update the PIN profile.\n4.\tPEMC sends the result to the Device (PINE) with PIN info, PINE info via PEGC.\n5.\tThe device receives the PIN/PINE information, becomes as a PINE.\nEditor's note:\tThe figure of the call flow needs to be provided.\n1.\tWhen one PINE moves to a new PEGC, and expects to access to 5GC via this PEGC, then the PEGC allocates a new PINE identifier for this PINE.\n2.\tPEGC notifies the PEMC to update the PIN profile in UDM with the new PINE information.\nEditor's note:\tIt is FFS for allocation for PIN identifier\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.27.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "UE/PEGC:\n-\tAllocate the PINE ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tEvaluation",
            "description": "Editor's note:\tThis clause will provide evaluation of different solutions. Further evaluation for solutions is needed until the solutions are stable.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tEvaluation on Key Issue #1",
                    "description": "",
                    "summary": "",
                    "text_content": "There are 4 solutions for key issue #1 that introduce new function(s) in 5GC for managing the PIN and 1 solution that instead proposes to only enhance the existing functions for managing the PIN.\nSolution #0A introduces a new Network Function, (PINCTRL) and proposes that the interaction between PEMC/PEGC and the PINCTRL is over NAS. Considering NAS protocol is not more flexible than other protocols, e.g. HTTP(S), the PINCTRL is designed to only support limited function set.\nSolution #0B introduces a new Network Functions (P-NF) and a 3rd party AF, (P-AF) and proposes that the interaction between PEMC/PEGC and the P-NF is over NAS. Considering NAS protocol is not more flexible than other protocols, e.g. HTTP(S), the P-NF is designed to only support limited function set.\nSolution #0C introduces a new function (PINMF) that can act as NF or as AF, and proposes that the interaction between PEMC/PEGC and the PINMF is over 5GS user plane, so there will be no NAS impact for PIN management and communication. The impact on NAS is limited to provisioning of policy and parameters where needed. NAS protocol is not more flexible than other protocols, e.g. HTTP(S). If the PINMF is a NF, this solution is similar to solution #0A and solution #0B, and the PINMF can only support a limited function set. If the PINMF is an AF, there is no need to use NAS protocol. The interaction between PINMF and PEGC/PEMC can be achieved via application over user plane, which adds flexibility and causes less impact on 5GC.\nSolution #0D introduces a new Application Function (PIN Application Server). There will be no NAS impact for PIN management and communication for this solution, and the impact on NAS is only for policy and parameters provisioning when needed.\nSolution #0E proposes to support PIN by enhancing existing function (e.g. UDM, UDR). PEMC is responsible for PIN and PINE management which is carried over application layer, 5GC only involves minimized PIN management (e.g. allocate PIN ID). In this architecture, PEMC can communicate/manage the PINEs/PEGCs/PEMCs directly (e.g. via WiFi, BT, PC5) or via 5GC without specific PIN AF involving the PIN/PINE management. Considering PEMC is defined as purely management role, there is no need another duplicated management role (i.e. PIN AF) involved which may introduce additional complexity and cost for user. Also considering PEMC/PEGC/PINE are configured/provisioned with the identifiers of other PINEs, so the PIN communication and PIN/PINE management are becoming simply \"UE to UE\" without AF involved.\nIn summary, the interaction among PINE, PEGC and PEMC can be achieved via application layer. The AF can reuse existing mechanism of QoS parameters provisioning to facilitate PIN communication, producing minimum impacts on 5GS.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tEvaluation on Key Issue #2",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.2.1\tGeneral",
                            "text_content": "Solution #1, Solution #2, Solution #3, Solution #4a, Solution #4b, Solution #9, Solution #14, and Solution #15 are for Key Issue #2.\nThis Key Issue has two aspects, one is discovery, which is for the criterial to determine whether to establish a wireless connection with another entity, the other is selection, which is for the criterial to access services provided by another entity over the established wireless connections.\nThe following mechanisms for discovery have been indicated:\na)\tDiscovery based on information, which is locally configured, over a dedicated PIN protocol layer (solution #1).\nb)\tDiscovery based on HTTP/UDP broadcast over wireless connections among PINEs/PEGCs/PEMCs (solution #2).\nc)\tDiscovery based on information of the wireless access, e.g. SSID for WiFi, device name for BT, PC5 discovery information, etc. which is locally configured or provisioned by 5GC (solution #4a, #8).\nd)\tDiscovery based on input from authorized user via UI or authorized APP on the PEMC (solution #3).\ne)\tDiscovery based on input from authorized user via UI or authorized APP on the PEMC or based on parameter that are received from the 5GC during registration (solution #3).\nf)\tDiscovery based on information which is configured or provisioned by 5GC (solution #4a, #8, #15).\ng)\tIn case Discovery via 5GC, the Discovery information (e.g. PIN ID, and/or PIN name) is configured or input from authorized user for the PINE (solution#9, #15).\nFollowing mechanisms for selection have been indicated:\na)\tSelection based on information over a dedicated PIN protocol layer among PINEs/PEGCs/PEMCs (solution #1, #3, #4a).\nb)\tSelection based on HTTP/UDP broadcast over wireless connections among PINEs/PEGCs/PEMCs (solution #2).\nc)\tSelection based on application layer interaction among PINEs/PEGCs/PEMCs (solution #4b, #8, #14).\nd)\tSelection based on application layer interaction between PINEs/PEGCs/PEMCs and an PIN AF or a PIN NF (solution #8).\ne)\tSelection based on selection parameters received from the 5GC (solution #4b, #14, #15).\nNOTE:\tSome combination of the above principles is not possible or not able to be alternative.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.2\tEvaluation on solution #1",
                            "text_content": "Solution #1 defines a dedicated PIN protocol layer over non-3GPP access or PC5.\nThe PEMC is discovered by a new device based on the information in the PIN Announce message that PEMC broadcasts over the PIN protocol layer. For joining into a PIN to become a PINE, the device can send PIN Join Request to the PEMC directly (alternative 1), or, the PEMC monitors the PIN Query Request broadcasted from a device over the PIN protocol layer and responds the information to the device directly (alternative 2).\nThe PEMC is the repository that manages the information of services that provided by PINEs/PEGCs in a PIN. When the PIN Join Request is accepted, the PINE is assigned the role of PEGC by the PEMC based on the capability information indicated in the PIN protocol layer by the PINE. The PEMC could query within the PIN to find any pre-configured UE that can function as PEGC in the PIN. The PEGC can release the role of PEGC for a PIN by sending PIN Release Request to the PEMC, which means the PEGC should be close to the PEMC for releasing the role.\nThe solution introduces a PIN element function layer over non-3GPP access or PC5.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.3\tEvaluation on solution #2",
                            "text_content": "After the PEMC, PINE, and PEGC have established wireless connection with each other, the PINE is able to select services based on HTTP/UDP broadcast over wireless connections. The PEMC is the repository that manages the information of services that provided by PINEs/PEGCs in a PIN, as well as the broker that manages the token for service requirement between PINEs and between PEGC and PINEs. The PEMC will assign a PEGC to an appropriate PINE based on the policies and notify both PINE and PEGC about their association.\nThe solution requires the ability to support http broadcast messages, http request-response and http based subscribe-notify features, and that the PEMC acts as a repository for all the PINE and its supported services.\nThe solution also introduces a new network function to the 5GC (i.e. PINCTL).\nThe solution adds an information element (i.e. \"PIN Capable\") to the registration message and information elements such as \"PIN allowable\" and \"PIN Name\" to the registration accept message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.4\tEvaluation on solution #3",
                            "text_content": "The device discovers a PEMC based on information, e.g. PEMC name, PEMC ID, FQDN, address, etc. that inputs from authorized user via UI. If the device is a UE, it also can be provisioned by 5GC the information for discovering a PEMC.\nFor joining into a PIN, the device sends PIN_join message to the PEMC with PIN information related to the device, which is useful for PINE/service selection by other PINEs and be configured by authorized user or by 5GC. The PEMC uses the PIN Information to decide whether to add the PINE to the PIN (e.g. checks if the requested service is supported by the PIN). The PEMC authorizes the PIN_join message, and may respond with PEGC information to the device if the device is authorized to be a PINE. After joining into a PIN as a PINE, the PINE discovers the PEGC with the information received from the PEMC.\nThe PEMC stores the PIN information (Supported/requested services, group ID, discoverability criteria etc.) for the PINEs.\nWhen the information for discovering a PEMC is provisioned by 5GC and is therefore semi-static, the flexibility in the discovery process is much reduced. Provisioning PIN discovery information by 5GC may not be feasible and flexible.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.5\tEvaluation on solution #4A",
                            "text_content": "The device discovers a PIN based on PIN ID broadcasted by all PINEs/PEGCs/PEMCs, the PIN ID can map to wireless access information, e.g. SSID for WiFi. The PINE/PEGC that has joined into a PIN is configured with PIN ID, PIN information (PIN Elements list, capability, availability, reachability, and services) and PIN discovery policy by PEMC, and the devices can establish connection with any joined PINE for joining into a PIN and obtaining PIN information.\nThe solution proposes that the PEMC provide PIN discovery policy configuration information to PINEs and PEGCs, broadcast and receive PIN announcements as per the received PIN discovery policy and send and respond to PIN solicitation request with PIN solicitation response.\nThe solution proposes a scenario that the PINE can join a PIN via another PINE which may not be PEMC/PEGC. This is not in the SID scope which is specific about the PINE joining a PIN only via PEGC/PEMC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.6\tEvaluation on solution #4B",
                            "text_content": "The PEMC is configured with PEGC selection information (prioritized list of PEGCs along with PEGCs capabilities i.e. PEGC IDs, PIN Type supported, CN Connectivity parameters, QoS Support, 5G CN Identifier, Network slice, QoS Requirements, etc) by application layer, user interface, or 5GC, which includes QoS consideration, slice, PIN type supported. The PEMC can consider PINEs characteristics (PIN Types supported, CN Connectivity, Power source, QoS support, network slice) or PIN type (Sensor Type, AR/VR, smart light, plug, UE, etc.) to request 5G core network for PEGC selection information.\nThe solution proposes that the PEMC determine PIN characteristics based on active PINEs, information from PINE requests, and PEGC selection information that is received from the 5GC.\nFor PEGC selection information provided by 5GC, it implies that the PEMC and PEGC are binding, which is not flexible for the scenario that the PIN may be applied to, e.g. a UE may join a PIN based on demand.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.7\tEvaluation on solution #8",
                            "text_content": "The PINE/PEGC is initially configured with information for wireless broadcast, e.g. SSID for WiFi, and PEMC discovers PINE/PEGC by APP on the PEMC. After establishing wireless connection with PEMC, the PINE/PEGC is provisioned with PIN configuration information over application layer, which can include the discovery information over wireless access for a PIN, e.g. SSID of other PINEs/PEGCs for WiFi, or include broadcast information over wireless access for a PIN that other PINE/PEGC can discover, e.g. SSID of the PINE/PEGC.\nAfter establishing wireless connection with PEMC, the PINE/PEGC can obtain PEGC/PINE selection information from PEMC over application layer.\nObtaining PIN discovery related information via application layer enable the dynamic and flexible PIN discovery configuration.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.8\tEvaluation on solution #9",
                            "text_content": "The PEMC/PEGC broadcasts PIN ID or PIN name, and the PINE discovers PEMC based on the broadcasted PIN ID or PIN name. In case of PIN discovery via 5GC, the Discovery information (e.g. PIN ID, PIN name, etc.) are configured or input from user via UI.\nThe solution proposed that the UDM stores PIN profile which is somehow static, making the PIN as a static or fixed group. With this solution the requirement of being able to discover and join a PIN group dynamically on demand cannot be met.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.9\tEvaluation on solution #14",
                            "text_content": "The PIN elements (PINEs) can communicate with the PEMC/PEGC and other PINEs via direct non-3gpp access (e.g. Wi-Fi and BT). The discovery of PIN elements (PEGC/PEMC for PINE, PEMC for PEGC etc.) occurs via direct discovery over non-3GPP access (e.g. Wi-Fi and BT) after the Wi-Fi or BT connection is established using application layer signalling and using PIN information as the criteria (e.g. PIN identity, PIN type etc.). PIN information including PIN identity, PIN type, etc. is either preconfigured or provisioned by PCF, and can be used for PINE/PEGC to select an appropriate PEGC/PEMC. The method of PIN information provisioned by PCF relies on that the subscription of PEGC/PEMC shall contain the necessary information, which implies that the PEGC and PEMC are binding, which is not flexible and may not allow a PEGC to join another PIN group which is managed by another PEMC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.10\tEvaluation on solution #15",
                            "text_content": "The solution focuses on the PIN/PINE service discovery in the case a PEMC/PEGC is not available, and the PINE is a UE. For the case a new PINE performing PIN Discovery via a PEMC/PEGC, the PEMC/PEGC broadcasts the Discovery information (e.g. PIN ID or/and PIN name). For the case where one PINE discovers another PINE, the Discovery information is pre-configured in the PINE.\nThe PINE, which can access the 5G network, sends a PIN service info query to the network requesting PIN service Information. The UDM sends the PIN service information (PINE ID, PINE name, PINE capability, PINE valid time, PINE type, etc.) via the AMF to the requesting PINE. The PINE triggers the communication with the desired PINE using the acquired PIN service information. The AMF authorizes PINE to uses PIN service. The PIN Service information includes all the PINEs information, e.g. PINE ID, PINE name, PINE capability, PINE valid time, PINE type, etc. By using such PIN Services information, PINE selects the target PINE that can provide the specific PINE Service.\nThe solution relies on the UDM maintaining the PIN profile, which implies that the PEGC and PEMC are binding. This is not flexible and may not allow a PEGC to join other PIN groups which is managed by another PEMC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.3\tEvaluation on Key Issue #3",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.3.1\tGeneral",
                            "text_content": "Editor's note:\tThis clause will provide high level principles indicated by solutions, which helps the conclusion stage. Further update is needed.\nThis Key Issue has two aspects, one is PIN management by PEMC, the other is PIN management by network.\nThe following mechanisms for PIN management by PEMC have been indicated:\na)\tPIN management over application layer between PINE/PEGC and PEMC (solution #2, #8).\nb)\tPIN management over a dedicated PIN protocol layer between PINE/PEGC and PEMC (solution #1, #6, #9).\nc)\tPEGC informs association information to PEMC directly (solution #2, #6).\nd)\tA PIN AF or a PIN NF informs association information to PEMC over application layer (solution #8).\nThe following mechanisms for PIN management by network have been indicated:\na)\tPIN management over application layer with a PIN AF (solution #5).\nb)\tPIN management over application layer with a PIN NF (solution #6, #7, #9, #10).\nc)\tPIN management over application layer with a PIN AF, and the PIN AF interacts with a PIN NF via NEF, e.g. UDR, P-NF (solution #5, #6).\nd)\tPIN management over NAS between PEMC and 5GC (e.g. via PDU Session Modification procedure) and a PIN NF (e.g. P-NF) or multiple PIN NFs (e.g. UDM and AMF) manages the PIN (solution #1, #6, #7, #9).\nNOTE:\tSome combination of the above principles is not possible or not able to be alternative.\nThere are 8 solutions (sol#1, sol#2&10, sol#5, sol#6, sol#7, sol#8, sol#9, sol#20) covering this KI. The main aspects include the management of different types of PINEs and the configuration of the PIN.\nThe evaluation of KI#3 is broken down into six objectives that the solutions address. For each objective we present the functionality that is intended to be used, the impacts on the system and which solution proposes the approach.\nTable 7.3.1-1: Evaluation of KI#3 related alternatives\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.1-1: Evaluation of KI#3 related alternatives",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.2\tEvaluation on solution #1",
                            "text_content": "The PEMC manages the PINE and PEGC for a PIN via a dedicated PIN protocol layer.\nAfter a device is assigned to be a PEGC of a PIN by the PEMC, the PEGC indicates PIN ID and PEGC info to 5GC via PDU Session Modification procedure for adding the PEGC into the PIN in 5GC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.3\tEvaluation on solution #2",
                            "text_content": "The PEMC manages the PINE and PEGC based on HTTP/UDP protocol, and is able to assign the association between the PINE and PEGC. After the association is assigned, the PEMC notifies the association to the PINE and the PEGC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.4\tEvaluation on solution #5",
                            "text_content": "The PIN AS is the function that manages PIN at network side over application layer. The PIN AS stores/updates the PIN information in UDR via NEF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.5\tEvaluation on solution #6",
                            "text_content": "A network function P-NF is introduced to manage PIN in 5GC and provides service operators for PIN management. A PIN AF is the function that manages PIN on network side over application layer, which interacts with P-NF via NEF to request PIN management in 5GC.\nAfter receiving the PIN creation/deletion request from PIN AF, the P-NF interacts with AMF, who sends NAS message to the PEMC, for PIN creation/deletion. After a PIN has been has been created, when the PEMC is informed that the PIN is updated, e.g. a PINE joins to a PIN via a PEGC and the PEGC informs the PEMC, the PEMC sends NAS message to the AMF for the PIN update, and the AMF interacts with the P-NF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.6\tEvaluation on solution #7",
                            "text_content": "The UDM is the network function that stores PIN information, and the AMF is the network function to manage PIN.\nThe PEGC registers to 5GS with PINE info managing the association information for a PIN, and the AMF queries the PIN information from the UDM for authorize the association.\nThe AMF de-registers the PEGC when PIN duration expired, which implies the PEGC shall register to 5GS again in order to obtain 5G service for itself.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.7\tEvaluation on solution #8",
                            "text_content": "The PEMC manages a PIN for adding/removing a PINE or PEGC over application layer on top of the direct wireless connection between the PEMC and the PINE/PEGC.\nThe PINMF in 5GC is the function that manages PIN at network side. The PEMC interacts with the PINMF over application layer for managing a PIN, including PIN creation/deletion, updating PINE/PEGC information for a PIN, and authorize PINE/PEGC association management.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.8\tEvaluation on solution #9",
                            "text_content": "The UDM is the NF that manages PIN. The PEMC interacts with AMF over NAS for PIN creation/deletion that optionally with information of PINEs, the PEMC also interacts with AMF over NAS with information of PIN and information of PINEs for PIN update, e.g. PINE adding/removing. The AMF interacts with the UDM for corresponding PIN management operations.\nThe PEMC manages PINEs/PEGCs for a PIN via the dedicated PIN protocol between the PINEs and the PEMC directly.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.9\tEvaluation on solution #10",
                            "text_content": "The PINCTL in 5GC is the function that manages PIN. The PINCTL communicates the policies to the PEMC for PIN management.\nThe PEMC manages PINEs/PEGCs for a PIN via HTTP/UDP protocol over direct wireless connection.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.10\tEvaluation on solution #20",
                            "text_content": "Editor's note:\tFurther evaluation is needed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.4\tEvaluation on Key Issue #4",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.4.1\tGeneral",
                            "text_content": "Following mechanisms for device to network relay path management have been indicated:\na)\tOne PDU Session of the PEGC serves multiple PINEs (solution #5, #11, #12). The PDU Session may be dedicated to relay traffic of PINE in the PIN(s) (as in Annex X.3). Alternatively, other applications in the UE hosting PEGC may share the PDU Session to relay traffic for the PIN (Annex X.2).\nb)\tOne PDU Session of the PEGC serves one PINE (solution #13).\nIn the case of one PDU Session serves multiple PINEs, following mechanisms for SMF selection that serving the PDU Session of a PEGC for relay have been indicated:\na)\tDuring the PDU Session Establishment procedure, an enhanced SMF supporting PIN is selected (solution #5 implies).\nb)\tWhen initial device to network relay is required from a PEGC, a PIN AF or PIN NF sends DNAI to the PCF to trigger the SMF selection for a PDU Session of the PEGC (solution #12).\nIn the case of one PDU Session serves multiple PINEs, following mechanisms for QoS and policy differentiation have been indicated:\na)\tDuring UE (PEGC) initiated PDU Session Modification procedure with PINE information, which is triggered by PINE, the PCF queries information for the PINE from the UDR and devices policy for the PINE. The QoS and policy information of the PINE is provided to the PEGC (solution #5).\nb)\tDuring network initiated PDU Session Modification procedure for a PEGC, which is triggered by a PIN AF or PIN NF, the QoS and policy information related to PINEs associated with the PEGC is provided to the PEGC. The PCF is able to provide QoS and policy information related to the PINEs (solution #11, #12).\nc)\tThe PCF obtains the QoS and policy requirements for a PINE from UDR (solution #5).\nd)\tThe PCF obtains the QoS and policy requirements from a PIN AF or PIN NF, which may be via the SMF serving the PDU Session of the PEGC (solution #11, #12).\nIn the case of one PDU Session serves one PINE, following mechanisms for QoS and policy differentiation have been indicated:\na)\tThe PEGC maps between DSCP over direct wireless connection and 5QI over 5GS access (solution #13).\nThe following mechanisms for install routing information related to communication for device to device via 5GC and PIN status information for DL data notification for a PINE have been indicated:\na)\tRouting information and PIN status information is provided by SMF to UPF for routing traffic of PINEs between PDU Sessions of PEGCs for a PIN (solution #12).\nNOTE:\tSome combination of the above principles is not possible or not able to be alternative.\nThere are 9 solutions (sol#5, sol#11, sol#12, sol#13, sol#16, sol#17, sol#18, sol#19, and sol #20) addressing this KI. The mains aspects include the communications between PINE and services outside of the PIN via PEGC and 5GS.\nThe evaluation of KI#4 is based on the following classification of solution's characteristics:\na)\tSo1#13 and sol#16 define QoS differentiation for PINE traffic relayed by PEGC and 5GS.\nb)\tSol#17 and sol#20 define PIN routing in presence of multiple PEGCs.\nc)\tSol#5&11&18, and sol#19 define QoS information for non-3GPP access.\nd)\tSol#12 proposes a solution for communication of PIN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.2\tEvaluation on solution #5",
                            "text_content": "The PINE requests PEGC over application layer, PEGC initiates PDU Session Modification with PINE information. During the PDU Session Modification procedure, the PCF queries the UDR according to the PINE information and derives policy for the PINE, which is used as part of policy for reserving the resources of the PDU Session of the PEGC.\nThe PEGC is provisioned with authorization information for device to network relay over application layer by the PIN AS, and based on the authorization information to allow or disallow the PINE to visit network.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.3\tEvaluation on solution #11",
                            "text_content": "The PIN AF provides QoS requirement for a PINE to PCF, the PCF derives policy rules for the PINE and notifies the SMF of the policy change, then the SMF initiates PDU Session Modification procedure with the PEGC associated with the PINE. Non-3GPP QoS assistance information is generated by SMF and sent for each QoS flow to PEGC based on PEGC subscription data and operators policy. The PEGC receives the non-3GPP QoS association information and reserves the resources in the non-3GPP network according to the non-3GPP QoS association information. The non-3GPP QoS assistance information includes QoS characteristics, GFBR/MFBR (if applicable), ARP, Periodicity.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.4\tEvaluation on solution #12",
                            "text_content": "The PEMC sends relay request over application layer to the PINMF, and the PINMF sends service requirements for the PINE to PCF. Then the SMF performs PDU Session Modification with the PEGC by interacting with PCF. The routing information also can be stored in UDM, and the procedures are in control plane.\nWhen initial device to network relay is required from a PEGC over application layer, the PINMF provides a DNAI to the PCF, which triggers the SMF reselection procedure for the PDU Session of the PEGC. According to the DNAI, the enhanced SMF supporting PIN can be selected by the AMF.\nWhen PINE service is requested from the PEGC over application layer, the PINMF interacts with the SMF for providing QoS and policy requirement of the PINE, the SMF interacts with PCF serving the PDU Session of the PEGC to derive QoS and policy information for the PINE, and triggers network initiated PDU Session Modification procedure for reserving the resources of the PDU Session of the PEGC and sending the mapping information to the PEGC for the PEGC mapping the traffic of the PINE into corresponding QoS flows.\nThe PINMF provides the routing information to the SMF via NEF, and the SMF sends the routing information to UPF to allow or disallow the relay between PINEs via the 5GC. The PINMF also provides PIN status information to the SMF via NEF, and the SMF sends the information to the UPF for DL data notification for a specific PINE. The UPF notifies SMF for downlink data of a PINE according to the PIN status information, and SMF notifies PINMF to trigger PINE/PEGC opening non-3GPP access for direct connection setup.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.5\tEvaluation on solution #13",
                            "text_content": "The PINE in the PIN requests PEGC for 5G session establishment and PEGC establishes PDU Session per PINE that associated with the PEGC when the PINE requests the PEGC to perform device to network traffic relay, i.e. the PINE requests the PEGC for relay with QoS information, the PEGC establishes appropriate PDU Session for the relay and maps DSCP field of the traffic over the direct wireless connection with 5QI.\nIn order to forward the data, PEGC maps local FQDN or IP address of the PINE to the PDU session ID. About QoS differentiation, PINE can request PEGC for a desired QoS or PINE can use DSCP marking on the IP packet to indicate the desired QoS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.6\tEvaluation on solution #16",
                            "text_content": "Differentiated QoS can be provided for different PINEs per PDU session / S-NSSAI and per QoS flow basis, default QoS associated with the PDU session can be different based on the DNN and S-NSSAI. PEGC is configured (e.g. either pre-configured or delivered to PEGC by AF managing PIN via UP) with mapping information (e.g. between service types of PINE and DNN/S-NSSAI and QoS flow). The PEGC can identify the communication from PINEs based on, e.g. MAC address/Bluetooth ID or IP addresses/ports in case of NAT is applied.\nThe difference from sol #13 is that if some PINE service types are similar and can be served with a common PDU session and DNN/S-NSSAI, these PINEs can be can be considered to share the same PDU session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.7\tEvaluation on solution #17",
                            "text_content": "The SMF configures group-level N4 session for all UPFs serve the PDU Sessions of PEGCs in a PIN to enable local routing via 5GC. The framework is similar to 5G VN group communication to enable the local routing communication path for PIN. The PIN AF provisions the required group and group member configurations for creating the N4 rules for local routing.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.8\tEvaluation on solution #18",
                            "text_content": "UDR contains Default non-3GPP delay budget for a PEGC, according to the AF request, the PCF indicates the non-3GPP delay budget to the PEGC and the adjusted PDB to NG-RAN via PDU Session Modification procedure. The PEGC takes the non-3GPP delay budget into account for the direct connection with a PINE.\nA default non-3GPP network delay budget is configured in the UDR or PEGC requests to change the default non-3GPP delay budget for a specific flow with the PDU Session Modification procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.9\tEvaluation on solution #19",
                            "text_content": "This solution provisions a mapping between a Uu QoS parameters and QoS information of direct non-3GPP access. The PEGC determines the direct non-3GPP access QoS info based on the PCF provisioned mapping or the PINE establishes Wi-Fi/BT connection with PEGC and provides direct non-3GPP access QoS info to the PEGC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.10\tEvaluation on solution #20",
                            "text_content": "This solution deals with PIN communication using multiple PEGCs. The association between PEGC and PIN Elements is stored in specific network function, the P-NF. The PINE requests PEGC for traffic relay, PEGC sends PDU Session request to SMF, and SMF will send a request to P-NF to get the association between the targeted PINE and the configured PEGC when SMF receives the PIN PDU session request from PEGC. After getting the mapping from P-NF, SMF will set the corresponding PDR and FAR and sends the rules to UPF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.5\tEvaluation on Key Issue #5",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.5.1\tGeneral",
                            "text_content": "Solution #1, solution #5, solution #6, solution #8, solution #9, solution #21, and solution #22 are for Key Issue #5.\nThe key issue emphasizes on the aspects to authorize/de-authorize a PINE, PEMC and PEGC for PIN services.\nThe following mechanisms for PEMC authorization have been indicated:\na)\tPEMC is authorized without 5GC involvement (solution #5).\nb)\tPEMC is authorized based on subscription of PIN feature or subscription of a PIN (solution #6, #8, #9).\nc) PEMC is authorized with 5GC involvement (solution #22).\nThe following mechanisms for PEGC authorization have been indicated:\na)\tPEGC is authorized without 5GC involvement (solution #5).\nb)\tPEGC is authorized when it is a UE (solution #8).\nc)\tPEGC is authorized based on subscription (solution #6) by the 5GC (solution #1).\nThe following mechanisms for PINE authorization have been indicated:\na)\tPINE is authorized without 5GC involvement (solution #5).\nb)\tPINE is authorized with 5GC involvement (solution #21, #22).\nThe following mechanisms for authorizing a PEGC to provide connectivity to and from the 5G network for other PINEs have been indicated:\na)\tThe 5GC authorizes the PINE to connect to the 5G network via the PEGC (solution #21, #22).\nNOTE:\tSome combination of the above principles is not possible or not able to be alternative.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.5.2\tEvaluation on solution #1",
                            "text_content": "In the second method, a PEMC, after it has been authorized by 5GC for PIN operation, begins to monitor incoming queries for PIN services.\nA UE capable of PEGC functionality is authorized for PIN operation by the 5GC.\nThe solution relies on that the 5GC needs to store the PIN information in order to authorize the PEMC, which implies that an UE can only be authorized to be a PEMC based on subscription which is not flexible.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.5.3\tEvaluation on solution #5",
                            "text_content": "The PIN AS, who manages PIN at network side, authorizes whether a PEMC is allowed to manage a PIN, where the user of the PEMC can initiate the request to create a PIN via P4 reference point with PIN AS. The PIN AS also authorizes whether a PINE/PEGC is allowed to join into a PIN. The PEMC may invite/expel a PEGC or PINE in a PIN, and a PINE/PEGC may request to join/leave a PIN. All the requests are routed to the PIN AS for authorization.\nThe solution #5 allows PINE(s) to join/leave a PIN without 5GC involvement, which is a simple and flexible solution.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.5.4\tEvaluation on solution #6",
                            "text_content": "The P-NF queries the UDM to learn about UE subscription and based on the information received from the UDM the P-NF for authorizes the PEMC and the PEGC to manage the PIN by PEMC and to establish PIN connectivity with the 5GC respectively.\nThe PEGC interacts with PEMC directly for authorizing the PINE to join via a PEGC.\nThe solution requires that the 5GC shall store the PIN information e.g. a UE can be a PEGC/PEMC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.5.5\tEvaluation on solution #8",
                            "text_content": "The PINMF interacts with UDM for PEMC authorization, i.e. to determine whether the PEMC has subscribed PIN service as a manager or not. The PINMF also determines whether the additional PEMCs/PEGCs are trusted members of the PIN. PINMF authorize PEGC only if PEMC added the PEGC into a PIN over application layer and the PEGC registered into PINMF over application layer. There may be more than one PEMCs included in a PIN, the PINMF only allows one PEMC to control the additional PEMCs in the PIN.\nPINMF verifies the PEGC is a UE based on whether the parameters provisioned to PEGC over 5GC success or not.\nThe solution requires the UDM to store the PIN information e.g. whether PEMC/PEGC are trusted members of the PIN. This implies that the PEGC and PEMC are binding, which make the PIN creation is not flexible, e.g. an UE join a PIN dynamically.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.5.6\tEvaluation on solution #9",
                            "text_content": "The AMF interacts with UDM for PEMC authorization based on the request from the UE with PEMC capability, i.e. for creating a PIN. The AMF sends a request the UDM for creating the PIN and includes the information as received from the initiating UE. AMF may also check with UDM whether the UE is authorized to create the PIN.\nThe solution requires the UDM to store the PIN information e.g. whether an UE can be a PEMC/PEGC. The subscription shall include the PIN related capability, which is not flexible for usage of PIN services.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.5.7\tEvaluation on solution #21",
                            "text_content": "In Solution #21, a PINE must first discover a PEMC and send a join request to the PEMC. The PEMC will then authorize the PINE for connectivity to the PIN by obtaining authorization information from UDM/UDR/P-NF via the AMF. The PEMC may authorize the PINE to access 5GS services via a PEGC.\nThe solution #21 assumes that a 3GPP defined PIN Protocol will be used for the direct communication between PINEs (e.g. between the PINE and PEMC or PEGC).\nThe solution requires the UDM to store the PIN information e.g. whether an UE can be a PEMC/PEGC. The subscription shall include the PIN related capability, which is not flexible for usage of PIN services.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.5.8\tEvaluation on solution #22",
                            "text_content": "In Solution #22, a PINE authorization to access the 5GS, PEGC and other PINEs is performed by Token based authorization. A PINE sends \"Authenticate and Request Access Token\" Request query to the PEMC, which will respond with the access Token to the requesting PINE based on the authorization policies already stored in PEMC, provided by 5GC.\nAuthorization/De-Authorization of the PEMC is performed with involvement by 5GC, which allows operators to control the devices to join/leave PIN.\nThe solution is beyond SA2 scope, which includes specific authentication and authorization method, which shall be discussed and evaluated by SA3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.6\tEvaluation on Key Issue #6",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.6.1\tGeneral",
                            "text_content": "Solution #4B, solution #5, solution #7, solution #8, solution #9, solution #12, solution #14, solution #19, solution #23, solution #24, solution #25, and solution #26 are for Key Issue #6.\nThe following mechanisms for provisioning of PIN related policy and parameters related to discovery and selection have been indicated:\na)\tDiscovery and selection information is provided over application layer to the PEGC and PINE (solution #5, #8).\nb)\tDiscovery and selection information is provided over application layer to the PEMC (solution #5, #8, and #9).\nc)\tRouting information is provided over application layer to PEGC (solution #4b, #5).\nThe following mechanisms for provisioning of PIN related policy and parameters routing information related to device to network relay and device to device relay via 5GC/NAS signalling have been indicated:\na)\tDiscovery and selection information is provided over NAS to PEGC or PEMC through AMF (solution #4b, #7, #8, #9, #12, #14, #19, #23, #24, #25, #26).\nb)\tRouting information is provided over NAS to PEGC, including PDU session related, i.e. provisioned through SMF, and non-PDU session related, i.e. provisioned through AMF (solution #8, #12).\nNOTE:\tSome combination of the above principles is not possible or not able to be alternative.\nThe following mechanisms for provisioning of PIN related policy and parameters via 5GC/PCF/UDM (with more transparent NAS delivery) have been indicated:\na)\tPIN related policy and parameters are delivered to PEGC/PEMC via PCF using delivery mechanism similar to URSP/ProSe policy (solution #14, #23, #24, #25).\nb)\tPIN related policy and parameters are delivered to PEGC/PEMC via UDM using delivery mechanism similar to UPU (solution #8, #12).\nc)\tPIN related QoS control and differentiation via 5GC can also be enforced in 5GC via PCF using existing procedure (solution#19, #12) with the request from AF/PINMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.2\tEvaluation on solution #4B",
                            "text_content": "During registration procedure, the PEMC registers to 5GC with PEMC capability information, which includes PIN type, size, QoS requirements, and the AMF responds with a NAS accept message including PEGC selection information, which includes QoS consideration, slice, PIN type supported. The PEGC selection information is used by the PEMC to select PEGCs for itself and other PINEs. The PEMC sends the discovery and selection parameters to PEGC(s)/PINE(s).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.3\tEvaluation on solution #5",
                            "text_content": "The PIN AS, who manages PIN at network side, provisions parameters to PINE, PEGC, and PEMC over application layer. The PIN related parameters are related to PIN management, PIN discovery and selection, communication path. All the requests are routed to the PIN AS for authorization.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.4\tEvaluation on solution #7",
                            "text_content": "During the PEGC registration procedure, the UDM provides subscription information that includes PIN info to the AMF, and the AMF sends it to PEGC via a NAS accept message.\nThe solution assumes that all PINEs are linked to each other already before the PEGC register to the 5GS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.5\tEvaluation on solution #8",
                            "text_content": "The PINMF provisions discovery and selection parameters to PEMC and PINE over application layer.\nWhen discovery and selection parameters related to a PEGC is provisioned to the UDR by the PINMF via NEF, the UE configuration update procedure is triggered to send the parameters to the PEGC.\nThe solution indicates that a new NF PINMF can provide PIN related info to PINE/PEMC/PEGC via application layer/user plane and/or NAS/control plane.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.6\tEvaluation on solution #9",
                            "text_content": "After receiving a request for PIN creation over NAS from a PEMC, the AMF requests that the UDM create PIN context/profile and provide PIN related information including discovery and selection parameters for the PIN, and then forwards the parameters with the PIN creation response to the PEMC over NAS.\nThe solution also proposes that, when a PINE joins the PIN, the PEMC may request a PIN related information update by sending a request for PIN update over NAS. The AMF updates the PEMC subscription data in UDM with joined PINE information.\nThe solution further proposes the UDM can receive a PIN creation request from the AF via the NEF. The UDM may update the PEMC with PIN related information using NAS UE configuration update procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.7\tEvaluation on solution #12",
                            "text_content": "During the PDU Session Modification procedure, the SMF sends the routing information to the PEGC (or UPF in case 5GC is involved in the communication) according to the requirements from the PINMF via PCF. The routing information to PEGC allows or disallows the relay between PINEs via the PEGC for device to device relay, and allows or disallows a PINE visit 5GS via a PEGC for device to network relay.\nThe solution proposes that the PIN related information update is sent from the PINMF to PEGC via UDM/AMF.\nThe solution introduces a new NF PINMF that can communicate with the PEGC/PEMC via application layer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.8\tEvaluation on solution #14",
                            "text_content": "The PEGC / PEMC may be preconfigured with connectivity service information that it can support, or the connectivity service information can be provisioned by PCF to the PEGC / PEMC similar to ProSe policy delivery to UE. The PCF receives PIN related information from AF via the NEF.\nThe UE indicates PEMC/PEGC Capability in the Registration Request message, and the AMF selects the PCF supports PIN if the UE is authorized to act as PEMC/PEGC based on subscription data. The UE may include the UE Policy Container with indicating the PIN Policy Provisioning Request during registration procedure. The UE may also include PEMC/PEGC capabilities in the PIN Policy Provisioning Request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.9\tEvaluation on solution #19",
                            "text_content": "The \"PCF based Service Authorization and Provisioning to UE\" procedure as defined in clause 6.2.2 of TS 23.304 [6] is reused by the PCF to provision PIN policy and parameters to PEGC similar to ProSe policy delivery to UE. The PCF receives PIN related information from AF via the NEF. The PIN policy and parameters include a mapping between a Uu QoS parameters (including 5QI, GFBR/MFBR, ARP) values and QoS information of direct non-3GPP access (including QoS characteristics, GFBR/MFBR, ARP, Periodicity). In case of PIN communication via 5GC, PCF provides PCC rules to SMF/UPF based on existing PDU session modification procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.10\tEvaluation on solution #23",
                            "text_content": "PIN policies are provisioned to the PEGC / PEMC from the PCF. The PCF receives PIN related information from AF via NEF.\nThe PCF provides PIN related information to PEMC via AMF when PEMC registers in the 5GS if PIN related information is already available in PCF. It is also possible that PIN related information may be delivered by AF to PCF after PEMC registration in 5GS. The solution includes also PEMC triggered PIN related information retrieval.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.11\tEvaluation on solution #24",
                            "text_content": "UE indicates capability to AMF during registration procedure, then AMF indicates UE capability to PCF during the UE Policy Association Establishment and UE Policy Association Modification procedures.\nThe PCF provides PIN policies and parameters to the PEGC / PEMC by using the UE Configuration Update procedure for transparent UE Policy delivery procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.12\tEvaluation on solution #25",
                            "text_content": "A PINCTRL network function provides PIN policies and parameters to the PEGC / PEMC via NAS signalling.\nThe PCF receives PIN related information from new NF PINCTRL. The PCF provides PIN related information to PEMC via AMF with NAS message with explicit PIN related information.\nThe solution proposes also PEMC/network triggered PIN related information update. For PEMC triggered information update, it involves AMF/PCF/PINCTRL using NAS with mixture of existing and new NAS messages. For Network triggered information update, PINCTRL uses N1N2message delivery service in AMF directly without PCF involvement.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.13\tEvaluation on solution #26",
                            "text_content": "The solution proposes the PIN related information is part of the subscription data for PEGC/PEMC. The UDM/UDR provides PIN policies, and they are sent to the PEGC / PEMC in the Registration Response (e.g. PIN information specific NAS parameters in Registration Accept message).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.7\tEvaluation on Key Issue #7",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.7.1\tGeneral",
                            "text_content": "The following mechanisms for PIN ID management have been indicated:\na)\tUDM allocates the PIN ID (solution #9).\nb)\tA new NF for PIN management allocates the PIN ID (solution #6).\nc)\tAn AF for PIN management allocates the PIN ID (solution #8).\nThe following mechanisms for PINE ID and PINE IP management have been indicated:\na)\tPEMC allocates the PINE ID (solution #1).\nb)\tUDM allocates the PINE ID (solution #9).\nc)\tSMF allocates the PINE ID and PINE IP (solution #12).\nd)\tPEGC allocates the PINE ID for the PINE connecting to this PEGC (solution #27).\nNOTE:\tSome combination of the above principles is not possible or not able to be alternative.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.2\tEvaluation on solution #1",
                            "text_content": "The PEMC assigns the PINE ID to a PINE during the PINE interacting with the PEMC to join into a PIN. 5GC is not involved in PIN ID/PINE ID allocation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.3\tEvaluation on solution #3",
                            "text_content": "Group ID (also called as PIN ID): The group ID configured by the authorized user or the 5GC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.4\tEvaluation on solution #5",
                            "text_content": "After successful registration, the PEMC sends a request to the PIN AS to create a PIN. The PIN ID is assigned by the PIN AS to the PEMC.\nThe PIN AS provisions PIN Service Specific Parameters to the UDR (via NEF) for policy control of the PEGC, include e.g. the PIN ID, default QoS requirement and valid time for PIN communication. The PINE ID may be used in 5GC for policy and QoS control in 5GC for PIN traffic via 5GC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.5\tEvaluation on solution #6",
                            "text_content": "When requested by a PIN AF via NEF for creating a PIN, the new PIN Network Function P-NF assigns the PIN ID and send it to the PEMC via AMF over NAS as well as send it to the PIN AF via NEF.\nFor PIN Elements, it is allowed that a PINE can be added in more than one PIN. Thus, it is recommended to combine PIN ID and PINE ID to identify PIN Elements\nThe P-NF is a 5GC NF and represents the functionality providing the capability to manage the PIN in 5GC, e.g. processing the request of creating PIN, choosing a UE to be a PEMC and distribute a PIN ID to identify a PIN, etc.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.6\tEvaluation on solution #8",
                            "text_content": "When requested by a PEMC over application layer for creating a PIN, the PINMF assigns the PIN ID. The PIN ID is provided to PEGC/PEMC/PINE via application layer or NAS message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.7\tEvaluation on solution #9",
                            "text_content": "In this solution, it assumed that UDM is used to create/update/remove PIN profile that includes PIN information and optional PINEs information with PIN ID/PINE ID, based on input PIN information from PEMC when request the creation of the PIN via NAS. The UDM allocates/manages the PIN ID. The UDM may allocate/manage PINE ID for the PIN.\nPINE ID, unique ID within a PIN that could be allocated by PEMC locally, or network.\nPIN ID, unique ID within a PLMN and allocated by network.\nWhen a PEMC requested over NAS to create a PIN, the AMF interacts with the UDM for creating the PIN. The UDM allocates PIN ID and optional PINE ID(s) for the PIN and the PINEs included in the PIN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.8\tEvaluation on solution #12",
                            "text_content": "When device to network relay is requested from a PEGC over application layer, the PINMF indicates the information related to the relay to the SMF serving the PDU Session of the PEGC for the relay. The SMF allocates PINE ID and PINE IP and sends them to the PEGC via network initiated PDU Session Modification procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.9\tEvaluation on solution #27",
                            "text_content": "The solution proposes that PINE ID is formulated based on PIN ID + PEGC/PEMC ID + (optional) Element ID, PEMC/PEGC ID is consisting of PIN ID and PEMC ID/PEGC ID, unique within a PIN. The Element ID is unique within a PIN. The PINE ID is allocated by PEGC and uploaded to PEMC/UDM (i.e. new PEGC means new PINE ID).\nPEGC is responsible for allocating the PINE ID for the PINE after authentication by PEMC at the same time the association between PEGC and the PINE(s) is established.\nOne PINE may have multiple PINE IDs if it is connected to multiple PEGCs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "8\tConclusions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "8.1\tConclusion on Key Issue #1",
                    "description": "",
                    "summary": "",
                    "text_content": "The following interim conclusions are agreed for principles of Personal IoT Networks Key Issue #1 \"5GC architecture enhancements to support PIN\":\n1)\tThe functionality of PINE is not defined by 3GPP and therefore are not specified by SA WG2.\n2)\tApplication Functions may be used to control PIN network via user plane of 5G network and this interaction is implementation specific.\n3)\tThe reference point among PINE, PEGC, and PEMC, no matter whether non-3GPP access or sidelink or via 5GC is used, is transparent to the 5GS and not specified by SA WG2.\n4)\tLegacy UE acting as PEMC needs to be considered.\n5)\tMulti-hop P2P (i.e. communication between a chain of PINEs) and P2N relay (i.e. communication from a PINE to another PINE or to the network via an intermediate PINE) are not studied in this release.\n6)\tIn this Release, data traffic of PINE over control plane is not studied.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.2\tConclusion on Key Issue #2",
                    "description": "",
                    "summary": "",
                    "text_content": "The following conclusions are agreed, which does not have normative work:\n1)\tThe interfaces for PIN discovery between PINE and PEGC, PINE and PEMC, PEGC and PEMC are divided into two layers: transport layer and application layer.\na)\tThe transport layer is based on non-3GPP communication or 3GPP PC5 between PEGC and PEMC (which includes direct communication and direct discovery). Transport layer functionality based on non-3GPP communication specification is outside the 3GPP scope. When transport layer is based on 3GPP PC5, the existing procedures defined for 5G ProSe Direct Communication are re-used.\nb)\tThe application layer for PIN and PIN Element discovery and selection is not specified by SA WG2. No normative work is required for this aspect.\n2)\tThe mechanism for discovering of PIN, and PIN elements is based on non-3GPP access discovery method and is not specified by 3GPP.\n3)\tThe procedure of selection of PEMC and PEGC by PINE is implementation specific and therefore it is not specified by 3GPP.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.3\tConclusion on Key Issue #3",
                    "description": "",
                    "summary": "",
                    "text_content": "The following interim principles are agreed for Key Issue #3 \"Management of PIN and PIN Elements\":\n1)\tPEMC is responsible for PIN Element management (e.g. add/remove the PINE/PEGCs, etc.), which is out of SA2 scope.\n2)\tNEF/UDM supports AF provisioning parameters for managing PIN policy and 5GC resources activation/deactivation of a PIN with parameter of PIN ID.\n3)\tAF may access the PIN Profile invoking a NEF API.\n4)\tIn case of multiple PEMCs in a PIN, how to assure that only one PEMC is controlling the PIN at any point of time is implementation specific (e.g. via Application specific mechanism carried by application layer) and therefore it is not specified.\n5)\tThe 5GC is not responsible for managing the PIN validity duration.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.4\tConclusion on Key Issue #4",
                    "description": "",
                    "summary": "",
                    "text_content": "The normative work is based on the following principles\n1)\tWhen the communication between a PEMC and a PINE behind a PEGC takes place via 5GC, or when the communication between PINEs requires multiple PEGCs and 5GC, the existing traffic forwarding functionalities in 5GS via UPF(s) or N6 can be applied if available.\n2)\tNon-3GPP QoS assistance information (including QoS characteristics, GFBR/MFBR UL/DL, MPLR UL/DL) that contains the same parameters as the Additional QoS Information specified in table 9.3.1.1-2 of TS 24.502 [9] may be sent to PEGC from SMF to assist the deriving of N3GPP QoS parameters for PIN.\na)\tWhether and how PEGC performs the deriving of QoS parameters and mapping procedure to be applied between the PINE and the PEGC is implementation specific and therefore it is not specified by 3GPP.\n3)\tDifferentiated traffic routing and QoS control may be required by a PEGC.\n4)\tIf AF for PIN is used, the AF can request the 5GC to exposes capabilities in order for the AF to provision parameters for resources configuration/deconfiguration for a PIN, QoS authorization for a PIN, QoS control for the PIN traffic, and routing control for the PIN traffic. The mechanism and criteria used by the AF to determine the need for a QoS modification for the PIN traffic are out of 3GPP scope.\n5)\tPDU session management functionality can be used by the PEGC.\na)\tWhen the PEGC detects new packets (PIN signalling or PIN traffic or creation of PIN) from a device in the PIN, it may map the PIN or PIN packets to an existing PDU session or establish a new PDU session. The criteria for taking the decision can be based on existing mechanism or implementation.\nNOTE 1:\tThe procedure is the same used when application generating the traffic resides directly on the UE.\nb)\tThe PEGC initiates PDU Session Establishment/Modification Request with necessary information:\ni)\tTo enable 5GC to manage system resources related to a PIN, which includes one or more PEGCs.\nii)\tTo differentiate QoS control on PIN traffic.\nNOTE 2:\tThe AF relies on PIN signalling between the PINE/PEGC/PEMC and the PIN AF, which is transferred via UP transparently to the 5G system, to determine the need for a QoS modification.\n6)\tThe procedure for supporting one PINE connected to multiple PEGCs in the same PIN and PINE to move between PEGCs is outside the 3GPP scope.\n7)\tPIN direct communication is not specified since it is implementation specific.\n8)\tPIN indirect communication via PEGC is managed within the PIN, which may be supported by 5GS.\n9)\tA PEGC may establish a single or multiple PDU Sessions used for PIN communication. One PEGC may serve more than one PINs. One PIN may be served by one or more PDU sessions. PIN may be served by more than one PDU sessions in the PEGC. (See PIN Session models as described in Annex A).\n10)\tIPv6 Prefix Delegation as described in clause 4.6.2.3 of TS 23.316 [5], or DHCP proxy by PEGC, or Framed Routing as described in clause 5.6.14 of TS 23.501 [2] are applied for IP address allocation of PINEs connected to PEGC.\nNOTE 3:\tFramed Route support will be further considered during normative work.\n11)\tIf AF for PIN is used, the AF may provide necessary parameters to 5GC which may be considered by PCF to generate the PIN Route Selection Policy for PDU Session selection by PEGC(s) and to generate the URSP accordingly for PEMC(s).\n12)\tRouting of traffic from/to PDU session and the PIN elements is left to implementation\n13)\tPIN is a service that needs user subscribing from operator, the user's PIN service subscription is used by operator for policy configuration to PEGCs.\n14)\tUDR is enhanced to support the storage and retrieval of PIN related policy and QoS parameters.\n15)\tThe N3GPP network delay between PINE and PEGC may be signalled from PEGC to PCF, and be taken into account when PCF derives the PDB value of QoS flow for PEGC.\n16)\tThe 5G system support for anchoring PDU Sessions of PEGCs and PEMCs at same SMF based on a combination of DNN, S-NSSAI.\nNOTE 4:\tOther possibility without anchoring at same SMF may be determined in normative phase.\n17)\tIf AF for PIN is used, the 5GC authorizes the number of PIN that the AF requests to create, which results in the number of PDU Sessions per PEGC/PEMC for PIN, according to user's PIN service subscription, which reflect the agreement between user and operator for using PIN service.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.5\tConclusion on Key Issue #5",
                    "description": "",
                    "summary": "",
                    "text_content": "The following conclusions are agreed for Authorization for PIN:\n1)\tPIN application-level Authentication and Authorization of PIN and PIN Elements are not specified by SA WG2.\n2)\tPEGC is authorized by 5GC to provide PIN service via subscription in the UDM.\n3)\tPEGC is subject to operator policies for any PIN services that operate over 5GC.\n4)\tA PINE is authorized by PEMC to join a PIN.\n5)\tA PINE is allowed or disallowed to connect to a PEGC by the PEGC based on the provisioned information.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.6\tConclusion on Key Issue #6",
                    "description": "",
                    "summary": "",
                    "text_content": "The following principles are concluded for Key Issue #6 \"Policy and parameters provisioning for PIN\":\n1)\tThe PIN policy and parameter(s) are configured in the PEGC via application layer and it is implementation specific, therefore it is not specified by 3GPP.\n2)\tThe policy and parameters provisioned to PEGC by 5GC, with the support of AF, for PIN communication include the following information:\na)\tThe QoS flow mapping for PINE's traffic relay is received via PDU Session Modification procedure from PCF.\nb)\tNon-3GPP QoS assistance information.\nNOTE:\tExisting procedures are used to deliver the parameters to PEGC.\n3)\tThe existing procedure used by the SMF to provide the UPF with, PDR, FAR, etc are applicable without modification.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.7\tConclusion on Key Issue #7",
                    "description": "",
                    "summary": "",
                    "text_content": "The following principles are concluded for Key Issue #7 \"Identification of PIN and PIN Elements\":\n1)\tNEF/UDM supports storing PIN ID in UDR, which may be received from AF.\nNOTE 1:\tWhether external and internal PIN ID are needed, and who allocates the PIN ID, are determined in normative phase.\n2)\tPIN ID is uniquely identifiable within the 5G network,\nNOTE 2:\tIt will be determined during the normative phase whether the PIN ID is defined as an external PIN identifier in similar way of the External Group Identifier and GPSI, and an 5G internal PIN identifier similar as Internal Group Identifier.\n3)\tPINE ID awareness in 5GC is not needed.\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.1\tGeneral",
            "description": "In this Annex, we describe the PIN Session models with the assumption that one PDU Session serves one PIN.\n5GC can enforce PIN level QoS by applying the QoS for the PDU Session since the PIN and the PDU Session has one-to-one relationship. For example, if the operator applies the PIN level AMBR, it can enforce PIN-AMBR by enforcing PDU Session AMBR through the existing policy framework.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.2\tShared PIN Session Model",
            "description": "With this model, the applications of the PEGC also can use the same PDU Session that is used for relaying the PIN traffic as depicted in the Figure A.2-1.\nThe figure depicts a shared PIN session model, illustrating the communication between two devices. The model is based on the shared PIN (Public Key Infrastructure) protocol, which ensures secure communication between two devices. The figure shows the communication paths, including the sender, receiver, and the shared PIN. The model is designed to be efficient and reliable, with the use of shared keys and public key infrastructure.\nFigure A.2-1: Shared PIN Session Model\nWith this model, a PDU Session can serve one PIN of PEGC.\nActivation or deactivation of the PIN of PEGC does not require the PDU Session Establishment procedures. The QoS control on PIN may be limited without the PEGC engagement.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.3\tDedicated PIN Session Model",
            "description": "With this model, the applications of the UE do not share the same PDU Session that is used for relaying the PIN traffic as depicted in the Figure A.3-1.\nThe figure depicts a dedicated PIN session model, which is a key component in the design of a dedicated physical-in-space (DPI) network. The model is used to model the physical layer of a DPI network, which is a key component in the design of a dedicated physical-in-space (DPI) network. The model is used to model the physical layer of a DPI network, which is a key component in the design of a dedicated physical-in-space (DPI) network.\nFigure A.3-1: Dedicated PIN Session Model\nWith this model, one PDU Session is mapped to one PIN network and other applications of the UE do not share the same PDU Session.\nActivation or deactivation of the PIN of PEGC can involve the PDU Session Establishment/Modification/Release procedure.\n\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "",
                    "table number": 6,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        }
    ]
}