{
    "document_name": "33216-i00.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document contains objectives, requirements and test cases that are specific to the eNB network product class. It refers to the Catalogue of General Security Assurance Requirements and formulates specific adaptions of the requirements and test cases given there, as well as specifying requirements and test cases unique to the eNB network product class.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TR 33.117 (Release 15): \"Catalogue of general security assurance requirements\".\n[3]\t3GPP TS 33.401: \"3GPP System Architecture Evolution (SAE); Security architecture\".\n[4]\t3GPP TR 33.926: \"Security Assurance Specification (SCAS) threats and critical assets in 3GPP network product classes\".\n[5]\t3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA); Radio Resource Control (RRC); Protocol specification\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tDefinitions",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms and definitions given in TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in TR 21.905 [1].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905 [1].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\teNodeB-specific security requirements and related test cases",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "eNodeB specific security requirements include both requirements derived from eNodeB-specific security functional requirements as well as security requirements derived from threats specific to eNB as described in TR 33.926 [4]. Generic security requirements and test cases common to other network product classes have been captured in TS 33.117 [2] and are not repeated in the present document.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\teNodeB-specific security functional adaptations of requirements and related test cases",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.2.1\tIntroduction",
                            "text_content": "Present clause contains eNodeB-specific security functional adaptations of requirements and related test cases.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.2\tSecurity functional requirements on the eNodeB deriving from 3GPP specifications and related test cases",
                            "text_content": "Requirement Name: Control plane data confidentiality protection\nRequirement Reference: TS 33.401 [3], clause 5.3.4a\nRequirement Description: \"The eNB shall provide confidentiality protection for control plane packets on the S1/X2 reference points.\" as specified in TS 33.401 [3], clause 5.3.4a.\nThreat References: TR 33.926 [4], clause C.2.2.1 – Control plane data confidentiality protection.\n\nTest Case:\nThe requirement mentioned in this clause is tested in accordance to the procedure mentioned in clause 4.2.3.2.4 of TS 33.117 [2].\nRequirement Name: Control plane data integrity protection\nRequirement Reference: TS 33.401 [3], clause 5.3.4a\nRequirement Description: \"The eNB shall provide integrity protection for control plane packets on the S1/X2 reference points.\" as specified in TS 33.401 [3], clause 5.3.4a.\nThreat References: TR 33.926 [4], clause C.2.2.2 – Control plane data integrity protection.\nTest Case:\nThe requirement mentioned in this clause is tested in accordance to the procedure mentioned in clause 4.2.3.2.4 of TS 33.117 [2].\nRequirement Name: User plane data ciphering and deciphering at eNB\nRequirement Reference: TS 33.401 [3], clause 5.3.4\nRequirement Description: \"The eNB shall cipher and decipher user plane packets between the Uu reference point and the S1/X2 reference points.\" as specified in TS 33.401 [3], clause 5.3.4.\nThreat References: TR 33.926 [4], clause C.2.2.3 – User plane data ciphering and deciphering at eNB.\nTest Case:\nTest Name: TC-DATA-CIP-eNB-Uu\nPurpose: To verify that the user data packets are confidentiality protected over the air interface.\nPre-Condition:\n-\tThe eNB network product shall be connected in emulated/real network environments. UE and the MME may be simulated,\n-\tThe tester can capture the messages via the air interface.\n-\tThe tester shall enable the user plane ciphering protection and ensure EEA0 is not used.\nExecution Steps:\n1. The UE sends an attach request to the MME.\n2. The MME sends a KeNB and the UE security capability to the eNB.\n3. eNB selects an algorithm and sends AS SMC to the UE,\n4. eNB receive AS SMP from the UE.\nExpected Results:\nUser plane packets sent by the eNB after eNB sending AS SMC is ciphered.\nExpected format of evidence:\nEvidence suitable for the interface e.g. Screenshot containing the operational results.\nTest Name: TC-DATA-CIP-eNB-S1/X2\nThe requirement mentioned in this clause is tested in accordance to the procedure mentioned in clause 4.2.3.2.4 of TS 33.117 [2].\nRequirement Name: User plane data integrity protection\nRequirement Reference: TS 33.401 [3], clause 5.3.4\nRequirement Description: \"The eNB shall handle integrity protection for user plane packets for the S1/X2 reference points.\" as specified in TS 33.401 [3], clause 5.3.4.\nThreat References: TR 33.926 [4], clause C.2.2.4 – User plane data integrity protection.\nTest Case:\nThe requirement mentioned in this clause is tested in accordance to the procedure mentioned in clause 4.2.3.2.4 of TS 33.117 [2].\nRequirement Name: AS algorithms selection\nRequirement Reference: TS 33.401 [3], clause 7.2.4.1; TS 33.401 [3], clause 7.2.4.2.1\nRequirement Description: \" The serving network shall select the algorithms to use dependent on: the UE security capabilities of the UE, and the configured allowed list of security capabilities of the currently serving network entity.\" as specified in TS 33.401 [3], clause 7.2.4.1\".\n\"Each eNB shall be configured via network management with lists of algorithms which are allowed for usage. There shall be one list for integrity algorithms, and one for ciphering algorithms. These lists shall be ordered according to a priority decided by the operator.\" as specified in TS 33.401 [3], clause 7.2.4.2.1.\nThreat References: TBA\nTest Case:\nPurpose:\nVerify that the eNB selects the algorithms with the highest priority in its configured list.\nPre-Conditions:\nTest environment with the eNB has been pre-configured with allowed security algorithms with priority.\nExecution Steps\n1)\tThe UE sends attach request message to the eNB.\n2)\tThe eNB receives S1 context setup request message.\n3)\tThe eNB sends the SECURITY MODE COMMAND message.\n4)\tThe UE replies with the AS SECURITY MODE COMPLETE message.\nExpected Results:\nThe eNB initiates the SECURITY MODE COMMAND message that includes the chosen algorithm with the highest priority according to the ordered lists and is contained in the UE EPS security capabilities.\nThe MAC in the AS SECURITY MODE COMPLETE message is verified, and the AS protection algorithms are selected and applied correctly.\nExpected format of evidence:\nSample copies of the log files.\nRequirement Name: The check of RRC integrity\nRequirement Reference: TS 33.401 [3], clause 7.4.1\nRequirement Description: \" The supervision of failed RRC integrity checks shall be performed both in the ME and the eNB. In case of failed integrity check (i.e. faulty or missing MAC-I) is detected after the start of integrity protection, the concerned message shall be discarded. \" as specified in TS 33.401 [3], clause 7.4.1.\nSecurity Objective References: TBA\nTest Case:\nPurpose:\nVerify that the message is discarded in case of failed integrity check (i.e. faulty or missing MAC-I).\nPre-Conditions:\nTest environment with RRC Protection is activated at the eNB.\nExecution Steps\nPositive:\nThe eNB receives a RRC message with a right MAC-I.\nNegative:\nThe eNB receives a RRC message with a wrong MAC-I or missing MAC-I.\nExpected Results:\nThe RRC message is discarded in the negative test.\nExpected format of evidence:\nSample copies of the log files.\nRequirement Name: The selection of EIA0\nRequirement Reference: TS 33.401 [3], clause 5.1.4.2\nRequirement Description: \" EIA0 is only allowed for unauthenticated emergency calls \" as specified in TS 33.401 [3], clause 5.1.4.2.\nThreat References: TBA\nTest Case:\nPurpose:\nVerify that  AS NULL integrity algorithm is used correctly.\nPre-Conditions:\nTest environment with a UE . The UE may be simulated.\nThe vendor shall provide documentation describing how EIA0  is disabled or enabled.\nExecution Steps\nPositive:\n1)\tThe eNB receives a UE security capability only containing EIA0 from S1 context setup message.\n2)\tThe eNB sends AS SMC to the UE.\nNegative:\n1)\tThe eNB receives a UE security capability that contains EIA0 and other integrity algorithm(s).\n2)\tThe eNB sends AS SMC to the UE.\nExpected Results:\nEIA0 is only selected in the Positive test.\nExpected format of evidence:\nSample copies of the log files.\nRequirement Name: Key refresh at the eNB\nRequirement Reference: TS 33.401 [3], clause 7.2.9.1; TS 36.331 [5], clause 5.3.1.2.\nRequirement Description: \"Key refresh shall be possible for KeNB, KRRC-enc, KRRC-int, KUP-int, and KUP-enc and shall be initiated by the eNB when a PDCP COUNTs is about to be re-used with the same Radio Bearer identity and with the same KeNB. \" as specified in TS 33.401 [3], clause 7.2.9.1.\nMoreover, \"The eNB is responsible for avoiding reuse of the COUNT with the same RB identity and with the same KeNB, e.g. due to the transfer of large volumes of data, release and establishment of new RBs. In order to avoid such re-use, the eNB may e.g. use different RB identities for successive RB establishments, trigger an intra cell handover or by triggering a transition from RRC_CONNECTED to RRC_IDLE or RRC_INACTIVE and then back to RRC_CONNECTED.\" as specified in TS 36.331 [x], clause 5.3.1.2.\nThreat References: TR 33.926[4], clause C.2.3.1 – Key reuse for eavesdropping\nTest Case 1:\nTest Name: TC_ENB_KEY_REFRESH_ PDCP_COUNT\nPurpose:\nVerify that the eNB performs KeNB refresh when PDCP COUNTs are about to wrap around.\nPre-Conditions:\nThe UE may be simulated.\nExecution Steps\n1)\tThe eNB sends AS Security Mode Command message  to the UE, and the UE respondswith the  AS ecurity Sode Momplete messageC.\n2)\tThe UE sends RRC messages or UP messages to the eNB with an increasing PDCP COUNT until the value wraps around.\nExpected Results:\nThe eNB triggers an intra-cell handover and takes a new KeNB into use.\nExpected format of evidence:\nPart of log that shows the PDCP COUNT wraping around and the intra-cell handover. This part can be presented, for example as a screenshot.\nTest Case 2:\nTest Name: TC_ENB_KEY_REFRESH_DRB_ID\nPurpose:\nVerify that the eNB performs KeNB refresh when DRB-IDs are about to be reused under the following conditions:\n-\tthe successive Radio Bearer establishment uses the same RB identity while the PDCP COUNT is reset to 0, or\n-\tthe PDCP COUNT is reset to 0 but the RB identity is increased after multiple calls and wraps around.\nPre-Conditions:\nThe UE and MME may be simulated.\nExecution Steps\n1)   The eNB sends the AS Security Mode Command message to the UE.\n2)\tthe UE responds with the AS Security Mode Complete message.\n3)\tA DRB is set up.\n4)\tDRB is set up and torn down for multiple times within one active radio connection without the UE going to idle (e.g. by the UE making multiple IMS calls, or by the MME requesting bearer setup and bearer deactivation), until the DRB ID is reused.\nExpected Results:\nBefore DRB ID reuse, the eNB takes a new KeNB into use by e.g. triggering an intra-cell handover or triggering a transition from RRC_CONNECTED to RRC_IDLE or RRC_INACTIVE and then back to RRC_CONNECTED.\nExpected format of evidence:\nPart of log that shows all the DRB identities and the intra-cell handover or the transition from RRC_CONNECTED to RRC_IDLE or RRC_INACTIVE and then back to RRC_CONNECTED. This part can be presented, for example, as a screenshot.\nRequirement Name: AS integrity algorithm selection\nRequirement Reference: TS 33.401 [3], clause 7.4.2\nRequirement Description: The eNB shall protect the SECURITY MODE COMMAND message with the integrity algorithm, which has the highest priority according to the ordered lists.\nThreat References: TBA\nTest Case:\nPurpose:\nVerify that AS integrity protection algorithm is selected and applied correctly.\nPre-Conditions:\nTest environment with UE. UE may be simulated.\nExecution Steps:\nThe eNB sends the SECURITY MODE COMMAND message. The UE replies with the SECURITY MODE COMPLETE message.\nExpected Results:\n1.\tThe eNB has selected the integrity algorithm which has the highest priority according to the ordered lists and is contained in the UE EPS security capabilities. The eNB checks the message authentication code on the SECURITY MODE COMPLETE message.\n2.\tThe MAC in the SECURITY MODE COMPLETE is verified, and the AS integrity protection algorithm is selected and applied correctly.\nExpected format of evidence:\nSnapshots containing the result.\nRequirement Reference: TS 33.401 [3], clause 7.2.4.2.2\nRequirement Description: \"In the path-switch message, the target eNB shall send the UE EPS security capabilities received from the source eNB to the MME.\" as specified in TS 33.401 [3], clause 7.2.4.2.2.\"\nThreat References: TBA\nTest Case:\nPurpose:\nVerify that bidding down is prevented in X2-handovers.\nPre-Conditions:\nTest environment with source eNB and target eNB, and the source eNB may be simulated.\nExecution Steps:\nThe target eNB sends the path-switch message to the MME.\nExpected Results:\nThe UE EPS security capabilities are in the path-switch message.\nExpected format of evidence:\nSnapshots containing the result\nRequirement Name: AS protection algorithm selection in eNB change.\nRequirement Reference: TS 33.401 [3], clause 7.2.4.2.2, and clause 7.2.4.2.3\nRequirement Description: \"The target eNB shall select the algorithm with highest priority from the UE EPS security capabilities according to the prioritized locally configured list of algorithms (this applies for both integrity and ciphering algorithms). The chosen algorithms shall be indicated to the UE in the handover command if the target eNB selects different algorithms compared to the source eNB\" as specified in TS 33.401 [3], clause 7.2.4.2.2, and clause 7.2.4.2.3.\nThreat References: TBA\nTest Case:\nPurpose:\nVerify that AS protection algorithm is selected correctly.\nPre-Conditions:\nTest environment with source eNB, target eNB and MME. Source eNB and MME may be simulated.\nExecution Steps:\nTest Case 1:\nSource eNB transfers the ciphering and integrity algorithms used in the source cell to the target eNB in the handover request message.\nTarget eNB verifies the algorithms and selects AS algorithms which have the highest priority according to the ordered lists. Target eNB includes the algorithm in the handover command.\nTest Case 2:\nMME sends the UE EPS security capability to the Target eNB.\nThe target eNB selects the AS algorithms which have the highest priority according to the ordered lists in the HANDOVER COMMAND.\nThe above test cases assume that the algorithms selected by the target eNB are different from the ones received from the source eNB.\nExpected Results:\nFor both test cases:\n1.\tThe UE checks the message authentication code on the handover command message.\n2.\tThe MAC in the handover complete message is verified, and the AS integrity protection algorithm is selected and applied correctly.\nExpected format of evidence:\nSnapshots containing the result.\nRequirement Name: RRC and UP downlink ciphering at the eNB.\nRequirement Reference: TS 33.401 [3], clause 7.2.4.5\nRequirement Description: \"The eNB shall start RRC and UP downlink ciphering after sending the AS security mode command message\" .\nThreat References: TBA\nTest Case:\nTest Name: TC_eNB_DL_Cipher\nPurpose: To verify that the eNB performs RRC and UP downlink ciphering after sending the AS security mode command message.\nPre-Condition:\n-\tThe UE and eNB network products are connected in the test environment. UE may be simulated.\n-\tThe tester shall have access to the AS security context and the corresponding cryptographic keys (e.g. RRC and UP cipher keys).\n-\tThe tester has access to Uu interface and ability to capture the Uu interface messages with the debug port enabled in the UE.\nExecution Steps:\n1)\tThe tester shall POWER ON the UE to trigger the registration procedures (Attach and SMC).\n2)\tThe tester performs packet capturing over the Uu interface using any packet analyser.\n3)\tThe tester filters the AS SMC command message and the following RRC and UP downlink packets from eNB to UE.\n4)\tThe tester proceeds the testing based on the parameters (algorithm identifier and algorithm distinguisher) present in the AS SMC command message.\nCase 1: If the parameters refer to null ciphering algorithm, the tester verifies that the downlink packets filtered in step 3 are unciphered.\nCase 2: If the parameters refer to algorithms such as SNOW, AES, ZUC, the tester verifies that the downlink packets filtered in step 3 are ciphered.\nThe tester also checks if the packets are ciphered in accordance with the selected algorithm stated in the AS SMC command message.\nNOTE:\tThe requirement mentioned in this clause is tested in accordance with the procedure mentioned in clause 4.2.3.2.4 of TS 33.117 [2].\nExpected Results:\n-\tThe downlink packets following the AS SMC command message are ciphered except NULL ciphering algorithm case.\nExpected format of evidence:\nEvidence suitable for the interface, e.g. Screenshot contains the operation results.\nRequirement Name: Map a UE NR security capability\nRequirement Reference: TS 33.401 [3], clause E.3.10.2\nRequirement Description: \" The MeNB that does not have the UE NR security capabilities shall create them as follow:\n-\tSet the support of NEA0, 128-NEA1, 128-NEA2, 128-NEA3, NIA0, 128-NIA1, 128-NIA2, 128-NIA3 to the same as EEA0, 128-EEA1, 128-EEA2, 128-EEA3, EIA0, 128-EIA1, 128-EIA2, 128-EIA3 respectively; and\n-\tSet the rest of the bits to 0.\" as specified in TS 33.401 [3], clause E.3.10.2.\nThreat References: TBA\nTest Case:\nTest Name: TC_MAP_NR_SEC_CAP\nPurpose: To verify that the eNB creates  mapped UE NR security capabilities.\nPre-Condition:\n-\tThe eNB and gNB network products are connected in the test environment. The gNB may be simulated.\n-\tTester shall have access to trigger dual connection to a gNB.\n-\tThe Tester shall have access to the X2 interface.\nExecution Steps:\n1)\tThe MeNB does not receive UE NR security capabilities from S1 Initial Context Setup Request message.\n2)\tThe MeNB sends SN Addition Request Message to the SgNB.\n3)\tThe tester checkes if the NR security capabilities are included in SN Addition Request Message.\nExpected Results:\nThe SN Addition Request Message contains UE NR security capabilities, i.e. NEA0, 128-NEA1, 128-NEA2, 128-NEA3, NIA0, 128-NIA1, 128-NIA2, 128-NIA3\nExpected format of evidence:\nEvidence suitable for the interface, e.g. Screenshot contains the operation results.\nRequirement Name: UE NR security capability is only sent to a SgNB\nRequirement Reference: TS 33.401 [3], clause E.3.4.3\nRequirement Description: \"When adding SgNB while establishing an EN-DC connection, the MeNB shall send these created UE NR security capabilities to the SgNB. Other than for adding an SgNB, the created UE NR security capabilities shall not be sent from the MeNB.\" as specified in TS 33.401 [3], clause E.3.4.3.\nThreat References: TBA\nTest Case:\nTest Name: TC_NR_SEC_CAP_SENT\nPurpose: To verify that the UE NR security capabilities are only sent to a SgNB.\nPre-Condition:\n-\tThe UE, gNB and eNB network products are connected in the test environment. UE and gNB may be simulated.\n-\tThe tester shall have access to the X2 interface.\nExecution Steps:\n1) The tester triggers MeNB to send SN addition Request message to a SgNB.\n2) The tester triggers UE HO from MeNB to another eNB.\n3) The tester checks if the UE NR security capabilities were sent in the X2 interface in both step 1 and step 2.\nExpected Results:\nThe UE NR security capabilities are only sent to the SgNB.\nExpected format of evidence:\nEvidence suitable for the interface, e.g. Screenshot contains the operation results.\nRequirement Reference: TS 33.401 [3], clause E.3.4.3\nRequirement Description: \" A target eNB that has received the UE NR security capabilities during handover shall include the UE NR security capabilities in the S1-PATH SWITCH-REQUEST message.\" as specified in TS 33.401 [3], clause E.3.4.3.\"\nThreat References: TBA\nTest Case:\nTest Name: TC_BID_DOWN_X2\nPurpose:\nVerify that bidding down is prevented in X2-handovers when target eNB receives a NR security capability.\nPre-Conditions:\nTest environment with source eNB and target eNB, and the source eNB may be simulated.\nExecution Steps:\nThe target eNB sends the path-switch message to the MME.\nExpected Results:\nThe UE NR security capability is in the path-switch message.\nExpected format of evidence:\nSnapshots containing the result.\nRequirement Name: Integrity protection of user data between the UE and the eNB.\nRequirement Reference: TS 33.401 [3], clause 5.1.4.\nRequirement Description: \"User plane packets between the eNB and the UE may be integrity protected on the Uu interface. \" in clause 5.1.4\nThreat References: TBD\nTest Case:\nTest Name: TC-UP-DATA-INT_eNB\nPurpose: To verify that the user data packets are integrity protected over the Uu interface.\nPre-Condition:\n-\tThe eNB network product shall be connected in emulated/real network environments. UE may be simulated.\n-\tTester shall have knowledge of integrity algorithm and integrity protection keys.\n-\tThe tester can capture the message via the Uu interface, or can capture the message at the UE.\nExecution Steps:\n1. eNB sends RRCConnectionReconfiguration with integrity protection indication \"on\".\n2. Check any User data sent by eNB after sending RRCConnectionReconfiguration and while the UE is in active state is integrity protected.\nExpected Results:\nAny user plane packets sent between UE and eNB over the Uu interface after eNB sending RRCConnectionReconfiguration is integrity protected.\nExpected format of evidence:\nEvidence suitable for the interface e.g. Screenshot containing the operational results.\nRequirement Name: Select the right UP integrity protection policy.\nRequirement Reference: TS 33.401 [2] clause 7.3.3\nRequirement Description: \" The eNB shall be locally configured with UP integrity protection policy. \" in clause 7.3.3\nThreat References: TBD\nTest Case:\nTest Name: TC_LOCAL_UP_INTEGRITY_PROTECTION_CONFIGURATION\nPurpose: To verify that the eNB is locally configured with a UP integrity protection policy\nPre-Condition:\n-\tThe eNB network product shall be connected in emulated/real network environments. UE and MME may be simulated.\n-\tThe eNB locally configured to activate UP integrity protection by default if no UP integrity protection policy is received from MME.\n-\tTester shall have knowledge of integrity algorithm and integrity protection keys.\n-\tThe tester can capture the message via the Uu interface, or can capture the message at the UE.\nExecution Steps:\n1. MME sends EPS security capability with EIA7 indicating the UP integrity protection is supported by the UE. But the MME does not send a UP integrity protection policy to the eNB.\n2. eNB sends RRCConnectionReconfiguration with integrity protection indication \"on\".\n3. Check any User data sent by eNB after sending RRCConnectionReconfiguration and while the UE is in active state is integrity protected.\nExpected Results:\nAny user plane packets sent between UE and eNB over the Uu interface after eNB sending RRCConnectionReconfiguration is integrity protected.\nExpected format of evidence:\nEvidence suitable for the interface e.g. Screenshot containing the operational results.\nRequirement Name: Select the right UP IP policy.\nRequirement Reference: TS 33.401 [2] clause 7.3.3\nRequirement Description: \" If the eNB receives UP integrity protection policy from the MME, the eNB shall use the received UP integrity protection policy, otherwise, the eNB shall use the locally configured UP integrity protection policy if EIA7 in the EPS security capability indicates that the UE supports user plane integrity protection with EPC. \" in clause 7.3.3\nThreat References: TBD\nTest Case:\nTest Name: TC_ UP_IP_POLICY_Selection\nPurpose: To verify that the eNB has a locally configured UP IP policy\nPre-Condition:\n-\tThe eNB network product shall be connected in emulated/real network environments. UE and MME may be simulated.\n-\tThe eNB locally UP IP is set to NOT NEEDED.\n-\tTester shall have knowledge of integrity algorithm and integrity protection keys.\n-\tThe tester can capture the message via the Uu interface, or can capture the message at the UE.\nExecution Steps:\n1. MME sends EPS security capability with EIA7 indicating the UP IP is supported by the UE. But the MME does sends a UP IP policy with REQUIRED to the eNB.\n2. eNB sends RRCConnectionReconfiguration with integrity protection indication \"on\".\n3. Check any User data sent by eNB after sending RRCConnectionReconfiguration and while the UE is in active state is integrity protected.\nExpected Results:\nAny user plane packets sent between UE and eNB over the Uu interface after eNB sending RRCConnectionReconfiguration is integrity protected.\nExpected format of evidence:\nEvidence suitable for the interface e.g. Screenshot containing the operational results.\nRequirement Name: Select the right UP IP policy in S1 handover.\nRequirement Reference: TS 33.401 [2] clause 7.3.3\nRequirement Description: \" At an S1-handover, the source MME shall send the UE's UP integrity protection policy and the UE EPS security capability to the target eNB via the target MME. Besides, the source eNB shall also send the UE's UP integrity protection policy if received from the source MME to the target eNB in a source-to-target container. The target eNB shall use the UE capability indicating support of UP IP in EPS together with the UP integrity protection policy received from the MME and ignore the UP integrity protection received in the source-to-target container. If the target eNB does not receive the UP integrity protection policy from the MME, the target eNB shall use the UE capability indicating support of UP IP in EPS together with the UP integrity protection policy received from the source eNB. If both policies from MME and source eNB are absent, but EIA7 in the EPS security capability indicates that the UE supports use of user plane protection with EPC, the eNB shall use locally configured UP integrity protection policy.\" in clause 7.3.3\nThreat References: TR 33.926 [4], clause C.2.2.a, UP integrity protection policy selection\nTest Case:\nTest Name: TC_ UP_IP_POLICY_Selection_S1_Handover\nPurpose: To verify that the eNB has correct selection on UP IP policy in S1 handover\nPre-Condition:\n-\tThe target eNB network product shall be connected in emulated/real network environments. UE, source eNB and MME may be simulated.\n-\tThe target eNB locally UP IP is set to NOT NEEDED.\n-\tTester shall have knowledge of integrity algorithm and integrity protection keys.\n-\tThe tester can capture the message via the Uu interface, or can capture the message at the UE.\nExecution Steps:\nTest Case 1:\n1)\tMME sends EPS security capability with EIA7 indicating the UP IP is supported by the UE. And the MME sends a UP IP policy with REQUIRED to the target eNB.\n2)\tSource eNB sends UP IP policy with NOT NEEDED in the source-to-target container to the target eNB.\n3)\teNB sends RRCConnectionReconfiguration with integrity protection indication \"on\".\n4)\tCheck any User data sent by eNB after sending RRCConnectionReconfiguration and before UE enters CM-Idle state is integrity protected.\nTest Case 2:\n1)\tMME sends EPS security capability with EIA7 indicating the UP IP is supported by the UE. And the MME does not send a UP IP policy to the target eNB.\n2)\tSource eNB sends UP IP policy with REQUIRED in the source-to-target container to the target eNB.\n3)\teNB sends RRCConnectionReconfiguration with integrity protection indication \"on\".\n4)\tCheck any User data sent by eNB after sending RRCConnectionReconfiguration and before UE enters CM-Idle state is integrity protected.\nTest Case 3:\n1)\tMME sends EPS security capability with EIA7 indicating the UP IP is supported by the UE. And the MME does not send a UP IP policy to the target eNB.\n2)\tSource eNB does not send UP IP policy in the source-to-target container to the target eNB.\n3)\teNB sends RRCConnectionReconfiguration with integrity protection indication \"off\".\n4)\tCheck any User data sent by eNB after sending RRCConnectionReconfiguration and before UE enters CM-Idle state is not integrity protected.\nExpected Results:\nFor test case 1 and 2, any user plane packets sent between UE and eNB over the Uu interface after eNB sending RRCConnectionReconfiguration is integrity protected.\nFor test case 3, any user plane packets sent between UE and eNB over the Uu interface after eNB sending RRCConnectionReconfiguration is not integrity protected.\nExpected format of evidence:\nEvidence suitable for the interface e.g. Screenshot containing the operational results.\nRequirement Reference: TS 33.401 [3], clause 7.3.3\nRequirement Description: \"Further, in the Path-Switch message, the target eNB shall send the UE's UP integrity protection policy and corresponding E-RAB ID to the MME. The sent UP integrity protection policy can either be the one received from source eNB or the locally configured one if the target eNB does not receive it from the source eNB, but the EIA7 in the EPS security capability indicates that the UE supports user plane integrity protection with EPC. \" as specified in TS 33.401 [3], clause 7.3.3.\nThreat References: TR 33.926 [4], clause C.2.2.a, bidding down for UP IP Policy\nTest Case:\nPurpose:\nVerify that bidding down for UP IP policy is prevented in X2-handovers.\nPre-Conditions:\n-\tThe target eNB network product shall be connected in emulated/real network environments. UE, source eNB and MME may be simulated.\n-\tThe target eNB locally UP IP is set to NOT NEEDED.\nExecution Steps:\nTest Case 1:\n-\tSource eNB sends EPS security capability with EIA7 indicating the UP IP is supported and UP IP policy with REQUIRED in Handover Request message to the target eNB.\n-\teNB sends path-switch request message with UP IP policy with REQUIRED to the MME.\nTest Case 2:\n-\tSource eNB sends EPS security capability with EIA7 indicating the UP IP is supported in Handover Request message to the target eNB. The source eNB does not send UP IP policy in the Handover Request message.\n-\teNB sends path-switch request message with UP IP policy with NOT NEEDED to the MME.\nExpected Results:\nFor test case 1, the UP IP policy with REQUIRED is in the path-switch request message.\nFor test case 2, the UP IP policy with NOT NEEDED is in the path-switch request message.\nExpected format of evidence:\nSnapshots containing the result.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.3\tTechnical baseline",
                            "text_content": "The present clause provides baseline technical requirements.\nThere are no eNB-specific additions to clause 4.2.3.2.1 of TS 33.117 [2].\nThere are no eNB-specific additions to clause 4.2.3.2.2 of TS 33.117 [2].\nThere are no eNB-specific additions to clause 4.2.3.2.3 of TS 33.117 [2].\nThere are no eNB-specific additions to clause 4.2.3.2.4 of TS 33.117 [2].\nThe requirement and testcases in clause 4.2.3.2.5 of TS 33.117 [2] is not applicable to eNB network product.\nThere are no eNB-specific additions to clause 4.2.3.3 of TS 33.117 [2].\neNB-specific adaptation to clause 4.2.3.4.2.1 of TS 33.117 [2] is:\n-\tDual-factor authentication by combining several authentication options as noted in clause 4.2.3.4.2.1 of TS 33.117 [2] for higher level of security is not applicable to the eNB.\nApart from the above exception, there are no other eNB-specific adaptations to clause 4.2.3.4.2 of TS 33.117 [2].\nThere are no eNB-specific additions to clause 4.2.3.5 of TS 33.117 [2].\nThere are no eNB-specific additions to clause 4.2.3.6 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.4\tOperating systems",
                            "text_content": "eNB-specific additions to clause 4.2.4 of TS 33.117 [2] are:\nFor the requirement defined in clause 4.2.4.1.1.2\tHandling of ICMP of TS 33.117[2]:\n-\t Echo Reply can be sent by default.\n-\tIn case of remote base station auto deployment, Router Advertisement can be processed.\nApart from the above exceptions, there are no eNB-specific addtions to clause 4.2.4 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.5\tWeb servers",
                            "text_content": "There are no eNB-specific additions to clause 4.2.5 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.6\tNetwork devices",
                            "text_content": "There are no eNB-specific additions to clause 4.2.6 of TS 33.117 [2].\nThere are no eNB-specific additions to clause 4.2.6.2.1 of TS 33.117 [2].\nThere are no eNB-specific additions to clause 4.2.6.2.2 of TS 33.117 [2].\nThe requirement and testcase in clause 4.2.6.2.3 of TS 33.117 [2] is not applicable to eNB network product.\nThere are no eNB-specific additions to clause 4.2.6.2.4 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.7\tVoid",
                            "text_content": "\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.3\teNodeB-specific adaptations of hardening requirements and related test cases",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.3.1\tIntroduction",
                            "text_content": "The present clause contains eNodeB-specific adaptations of hardening requirements and related test cases.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.2\tTechnical Baseline",
                            "text_content": "There are no eNB-specific additions to clause 4.3.2 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.3\tOperating Systems",
                            "text_content": "There are no eNB-specific additions to clause 4.3.3 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.4\tWeb Servers",
                            "text_content": "There are no eNB-specific additions to clause 4.3.4 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.5\tNetwork Devices",
                            "text_content": "There are no eNB-specific additions to clause 4.3.5 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.6\tVoid",
                            "text_content": "\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.4\teNodeB-specific adaptations of basic vulnerability testing requirements and related test cases",
                    "description": "",
                    "summary": "",
                    "text_content": "There are no eNB-specific additions to clause 4.4 of TS 33.117 [2].\n\n",
                    "tables": [
                        {
                            "description": "",
                            "table number": 1,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        }
    ]
}