{
    "document_name": "33739-i10.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Report has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\t\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\t\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\t\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\t\tindicates that something is possible\ncannot\t\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\t\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\t\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document studies the security aspects related to the new features and procedures resulting from the continuation of the work on Edge Computing support in 5G Systems, i.e. 5G System Enhancements for Edge Computing in 3GPP TR 23.700-48 [2], and enhanced architecture for enabling Edge Applications in 3GPP TR 23.700-98 [3]. The study bases on the work done in the 3GPP TS 33.558 [4] and 3GPP TR 33.839 [5].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TR 23.700-48: \"5G System Enhancements for Edge Computing; Phase 2\".\n[3]\t3GPP TR 23.700-98: \"Study on Enhanced architecture for enabling Edge Applications \".\n[4]\t3GPP TS 33.558: \"Security aspects of enhancement of support for enabling edge applications\".\n[5]\t3GPP TR 33.839: \"Study on security aspects of enhancement of support for edge computing in the 5G Core (5GC)\".\n[6]\t3GPP TS 33.220: \"Generic Authentication Architecture (GAA); Generic Bootstrapping Architecture (GBA)\".\n[7]\t3GPP TS 33.501: \"Security architecture and procedures for 5G System\".\n[8]\t3GPP TS 33.535: \"Authentication and Key Management for Applications (AKMA) based on 3GPP credentials in the 5G System (5GS)\".\n[9]\t3GPP TS 23.502: \"Procedures for the 5G System (5GS)\".\n[10]\t3GPP TS 33.222: \"Generic Authentication Architecture (GAA); Access to network application functions using Hypertext Transfer Protocol over Transport Layer Security (HTTPS)\".\n[11]\t3GPP TS 23.558: \"Architecture for enabling Edge Applications\".\n[12]\tIETF RFC 8446: \"The Transport Layer Security (TLS) Protocol Version 1.3\".\n[13]\t3GPP TS 33.210: \"Network Domain Security (NDS); IP network layer security\".\n[14]\tGSMA TS.43: \"Service Entitlement Configuration\".\n[15]\t3GPP TS 23.548: \"5G System Enhancements for Edge Computing; Stage 2\".\n[16]\t3GPP TS 23.503: \"Policy and charging control framework for the 5G System (5GS); Stage 2\".\n[17]\tIETF RFC 7858: \"Specification for DNS over Transport Layer Security (TLS)\".\n[18]\tIETF RFC 8310: \"Usage Profiles for DNS over TLS and DNS over DTLS\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].\nApplication Client: Application software resident in the UE performing the client function.\nApplication Context: A set of data about the Application Client that resides in the Edge Application Server.\nApplication Context Relocation: End-to-end service continuity procedure described in clause 8.8.\nApplication Context Transfer: Refers to the transfer of the Application Context between the source Edge Application Server and the target Edge Application Server, which is a part of the service continuity procedure described in clause 8.8.\nApplication Server: Application software resident in the cloud performing the server function.\nEdge Application Server: An Application Server resident in the Edge Hosting Environment.\nEdge Computing: A concept, as described in 3GPP TS 23.501 [2], that enables operator and 3rd party services to be hosted close to the UE's access point of attachment, to achieve an efficient service delivery through the reduced end-to-end latency and load on the transport network.\nEdge Computing Service Provider: A mobile network operator or a 3rd party service provider offering Edge Computing service.\nEEC Context: A set of data about the Edge Enabler Client that resides in the Edge Enabler Server.\nEdge Data Network: A local Data Network that supports the architecture for enabling edge applications.\nEdge Enabler Client: A functional entity resident in the UE providing services for the Application Clients.\nEdge Enabler Layer: The overall functionality provided by the entities such as Edge Enabler Client, Edge Enabler Server and Edge Configuration Server, in support of applications as per the architecture defined in clause 6.\nEdge Enabler Server: A functional entity resident in the Edge Hosting Environment providing services for the Edge Application Servers and Edge Enabler Clients\nEdge Hosting Environment: An environment providing support required for Edge Application Server's execution.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tSymbols",
                    "description": "",
                    "summary": "",
                    "text_content": "Void.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.3\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\nAAnF\tAKMA Anchor Function\nAC\tApplication Client\nACID\tApplication Client Identification\nACR\tApplication Context Relocation\nACT\tApplication Context Transfer\nAF\tApplication Function\nAKMA\tAuthentication and Key Management for Applications\nAMF\tAccess and Mobility Management Function\nAPI\tApplication Programming Interface\nAUSF\tAuthentication Server Function\nBSF\tBinding Support Function\nDNAI\tData Network Access Identifier\nDNN\tData Network Name\nDNS\tDomain Name System\nEAS\tEdge Application Server\nEASDF\tEdge Application Server Discovery Function\nEASID\tEdge Application Server Identification\nECS\tEdge Configuration Server\nECSP\tEdge Computing Service Provider\nEDN\tEdge Data Network\nEEC\tEdge Enabler Client\nEEL\tEdge Enabler layer\nEES\tEdge Enabler Server\nEESID\tEdge Enabler Server Identification\nEHE\tEdge Hosting Environment\nFQDN\tFully Qualified Domain Name\nGBA\tGeneric Bootstrapping Architecture\nGPSI\tGeneric Public Subscription Identifier\nGSM\tGlobal System for Mobile Communications\nGSMA\tGSM Association\nH-ECS\tHome Edge Configuration Server\nHSS\thome subscriber server\nIP\tInternet Protocol\nKDF\tKey Derivation Function\nMNO\tMobile Network Operator\nNAT\tNetwork Address Translation\nNEF\tNetwork Exposure Function\nNRF\tNetwork Repository Function\nOPG\tOperator Platform Group\nPCF\tPolicy Control Function\nPCO\tProtocol Configuration Option\nPSA\tPDU Session Anchor\nPDU\tProtocol Data Unit\nRAT\tRadio Access Technology\nS-EAS\tSource Edge Application Server\nS-EES\tSource Edge Enabler Server\nSMF\tSession Management Function\nS-NSSAI\tSingle Network Slice Selection Assistance Information\nT-EAS\tTarget Edge Application Server\nT-EES\tTarget Edge Enabler Server\nTLS\tTransport Layer Security\nUDM\tUnified Data Management\nUE\tUser Equipment\nUPF\tUser Plane Function\nURI\tUniform Resource Identifier\nV-ECS\tVisited Edge Configuration Server\nV-EES\tVisited Edge Enabler Server\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tOverview of Edge Computing - Phase 2",
            "description": "The present document studies the security enhancements on the support for Edge Computing of phase 2 in the 5G Core network defined in 3GPP TS 23.548 [15], and application architecture for enabling Edge Applications of phase 2 defined in 3GPP TS 23.558 [11].\nFor the EC supported in 5GC, refer to 3GPP TS 23.548 [15].\nFor more details on enabling Edge Applications, it is proposed to refer to 3GPP TS 23.558 [11].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "5\tKey issues",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Clause 5 describes the security key issues related with 5G System Enhancements for Edge Computing of 3GPP TR 23.700-48 [2] in clause 5.2, and Enhanced Architecture for Enabling Edge Applications of 3GPP TR 23.700-98 [3] in clause 5.3.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.2\tKey issues related with 5G System Enhancements for Edge Computing",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tKey issue #1.1: How to authorize PDU session to support local traffic routing to access an EHE in the VPLMN",
                            "text_content": "Two scenarios (i.e. UE accessing EHE in VPLMN via an LBO PDU Session and UE accessing EHE in VPLMN via a PDU Session established as HR) are described in 3GPP TR 23700-48 [2], clause 5.1.2. One issue is left for study from the security point of view for the scenario using a PDU Session with a PSA in the HPLMN, i.e. how to authorize the PDU session to support local traffic routing to access an EHE in the VPLMN.\nIt is suggested to study whether the existing secondary authentication can be reused here for this new scenario.\nUnauthorized UE could access the PDU session to support local traffic routing to access an EHE in the VPLMN.\n5G system should support PDU session authorization to support the local traffic routing to access an EHE in the VPLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tKey issue #1.2: Security of EAS discovery procedure via V-EASDF in VPLMN",
                            "text_content": "In 3GPP TS 23700-48 [2], two scenarios on how the UE accesses the EHE in VPLMN are described: the UE accesses EHE via an LBO PDU Session or the UE accesses EHE via a Home Routed (HR) PDU Session. For the discovery of the EAS located in EHE in VPLMN, the V-EASDF will be selected by the V-SMF and the V-EASDF address is sent to UE by the V-SMF directly (i.e. LBO case) or via H-SMF (i.e. HR case). The UE then exchanges DNS messages with V-EASDF to perform EAS discovery. Therefore, if the DNS message is modified by an attacker, then the DNS message could be sent to a compromised DNS server, in which case a wrong EAS address is allocated. Alternatively, the attacker could modify the EAS address and replace it with an address to a malicious AS.\nAccording to clause 6.7.2.3 of 3GPP TS 23.548 [15], when the target FQDN of the DNS query cannot be resolved by the V-EASDF, then the V-EASDF can send the DNS request to the DNS server address of HPLMN. Investigation on whether this communication between the V-EASDF and DNS server of the HPLMN also needs to be protected against unauthorized access and modifications by the attackers is required.\nWithout protection of the DNS message, an attacker could manipulate the DNS messages causing a disruption to the discovery procedure and edge services or misleading the UE to malicious servers.\nIf the communication between V-EASDF and DNS server of HPLMN is not security protected, then a malicious or compromised entity who can monitor the incoming and outgoing traffic of V-EASDF can learn the DNS query of the UE. Also, that entity could manipulate the DNS messages causing a disruption to the discovery procedure and edge services or misleading the UE to malicious servers.\nThe system should support secure EAS discovery procedure via V-EASDF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tKey issues related with enhanced architecture for enabling Edge Applications",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tKey Issue #2.1: Authentication and authorization of the EEC/UE by the ECS/EES",
                            "text_content": "This key issue aims at addressing authentication and authorization problem for the EEC/UE by the ECS/EES considering both the non-roaming and roaming cases.\nRegarding the non-roaming case, Rel-17 security specification of edge computing support, 3GPP TS 33.558 [4], the authentication methods for EEC are left as out of scope for Rel-17. From the standardization point of view, these mechanisms need to be standardized to solve interoperability issues.\nRegarding the roaming case, in 3GPP TR 23.700-98 [3], it is stated that \"It is required to clarify how an EEC hosted in the roaming UE can be authenticated and authorized to access the edge computing services available in the VPLMN. The related requirement is described in GSMA OPG as follows: 'Access of roaming subscribers to edge applications in the visited network shall be subject to authorization by the subscriber's Home OP and the Visited OP'.\".\nHowever, the edge computing authorization procedures for roaming scenarios, which may need the cooperation of home network and visiting network, are still unclear. Moreover, mechanisms which can be utilized to authenticate EEC hosted in the roaming UE or the roaming UE itself and data protection are not defined. Therefore, the procedures and mechanisms about authenticating and authorizing EEC hosted in the roaming UE or the roaming UE itself and data protection need to be studied.\nRegarding both the non-roaming and roaming cases, investigations about UE authentication and authorization by the EES/ECS and about whether UE authentication and authorization is enough instead of EEC authentication and authorization by the EES/ECS are required.\nIf the EEC hosted in the UE or the UE is not authenticated and authorized both in the non-roaming and roaming cases, an attacker can impersonate the EEC/UE, manipulate the data communicated with edge computing servers, and track victim UEs.\nMutual authentication and authorization between EEC/UE and edge servers considering both the non-roaming and roaming scenarios should be supported.\nCommunication between EEC/UE and edge servers considering both the non-roaming and roaming scenarios should be securely protected.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.2\tKey issue #2.2: Authentication mechanism selection between EEC and ECS/EES",
                            "text_content": "In 3GPP TS 33.558 [4], clauses 6.2 and 6.3 introduce the authentication and authorization between EEC and ECS, EEC and EES. And it is concluded for authentication between EEC and ECS, EEC and EES, TLS authentication methods shall be used, and the details of TLS authentication method, (e.g. TLS with AKMA as specified in 3GPP TS 33.535 [8], TLS with GBA as specified in 3GPP TS 33.222 [10], other TLS authentication methods that uses other than 3GPP subscription credential(s) which is out of 3GPP) are out of scope of the present document.\nHowever, with these multiple authentication methods, how to select which authentication mechanism to use between the EEC and EES, EEC and ECS is not addressed. Not knowing which authentication to use between EEC and EES, EEC and EES would lead to mis-synchronization between the EEC and EES, EEC and ECS.\nFor EDGE authentication mechanism selection, the roaming scenario needs to be taken into consideration.\nFor EDGE authentication mechanism selection, the authentication capability supported by the UE and the network entities needs to be taken into consideration.\nThis key issue is to study the selection of authentication mechanism for the authentication procedures between EEC and ECS, EEC and EES for Edge service.\nIf the authentication between the EEC and ECS or EEC and EES is done without the security method selection, it would cause mis-synchronization between the EEC and EES/ECS.\nSelection of authentication mechanism for the authentication procedures between EEC and EES and between EEC and ECS shall be supported.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.3\tKey issue #2.3: Authentication and Authorization between V-ECS and H-ECS",
                            "text_content": "In 3GPP TR 23.700-98 [3], it defines roaming architecture, the roaming architecture uses ECSs provided in HPLMN and VPLMN, in which the EEC in the UE obtains services from V-ECS and V-EES. In the architecture, the H-ECS is associated with HPLMN, while the V-ECS and the EDN which the UE accesses is associated with VPLMN. A new reference point EDGE-10 is defined between ECSs (i.e. V-ECS and H-ECS). The new interface is introduced for EES discovery in roaming PLMN in solution 5 or V-ECS information retrieval in solution 14.\nWithout authentication or authorization, the Malicious H-ECS may be able to obtain EES information or V-ECS information from V-ECS. This attack leads to exposing the topology details, server information within the V-PLMN domain. A malicious V-ECS may obtain UE information from H-ECS, which may cause exposure of UE privacy.\nV-ECS and H-ECS shall perform mutual authentication.\nThe V-ECS shall be able to authorize the H-ECS to get the EES information or V-ECS information.\nH-ECS shall only communicate with an authorized V-ECS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.4\tKey issue #2.4: Transport security for the EDGE10 interface",
                            "text_content": "In 3GPP TR 23.700-98 [3], it defines roaming architecture, the roaming architecture uses ECSs provided in HPLMN and VPLMN, in which the EEC in the UE obtains services from V-ECS and V-EES. In the architecture, the H-ECS is associated with HPLMN, while the V-ECS and the EDN which the UE accesses is associated with VPLMN. A new reference point EDGE-10 is defined between ECSs (i.e. V-ECS and H-ECS). The new interface is introduced for EES discovery in roaming PLMN in solution 5 or V-ECS information retrieval in solution 14. This key issues studies the related transport security, i.e. confidentiality, integrity, and replay-protection.\nWithout confidentiality, integrity, and replay protection, an attacker may eavesdrop or manipulate or replay the communication or initiate the MITM attacks on the interface.\nConfidentiality protection, integrity protection, and replay-protection shall be supported on the EDGE-10 interface.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.5\tKey issue #2.5: Authentication and Authorization between AC and EEC",
                            "text_content": "As per 3GPP TR 23.700-98 [3], EDGE-5 reference point enables interactions between the Application Client (AC) and the Edge Enabler Client (EEC). EDGE-5 reference point supports AC registration, EAS discovery, ACR request, AC subscription, and AC notification.\nAC may request the EEC for EEL service and also can request AC subscription. The EEC creates the subscription and when required, performs necessary operations such as EAS discovery, ACR etc., delivering notifications to the AC as required.\nWhen performing EAS discovery without authentication and authorization, a malicious application client may receive the list of services and gain insights on the topology structure the Edge Data Network from the EEC. The received information can reveal Edge Data Network's topology (e.g. number of Edge Application Servers, Application Server Functionalities, API type, protocols). A malicious application client may use this information to launch attacks on the Edge Data Network or use this information to gain competitive advantage.\nThe Edge Enabler Client (EEC) should be able to provide mutual authentication with the Application Client over EDGE-5 interface.\nThe Edge Enabler Client (EEC) should be able to determine whether Application client is authorized to access EEL service offered by Edge Enabler Client (EEC).\nNOTE:\tHow to fulfil above security requirements is left to the UE implementation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.6\tKey issue #2.6: New KI on authorization between EESes",
                            "text_content": "According to TR 23.558 [11], the EDGE-9 reference point enables interactions between the Edge Enabler Servers (EES).\nEDGE-9 supports:\na)\tdiscovery of T-EAS information to support Application Context Relocation (ACR);\nb)\tEEC context relocation procedures; and\nc)\ttransparent transfer of the application context during Edge Enabler layer Managed ACR.\nIn the situations such as UE mobility, overload control, or maintenance, different EESs can be more suitable for serving the ACs in the UE. Such mobility transitions result in replacing the source the EES (S-EES) with a target EES (T-EES). Replacing the S-EES with the T-EES requires a procedure named Application Context Relocation (ACR).\n3GPP TS 33.558 [4] clause 5.1.2 states that \"confidentiality, integrity, and replay protection shall be supported on the EDGE-1-4 and EDGE 6-9 interfaces\". In addition, for the interfaces EDGE-3/6/9, \"the EAS, EES and ECS shall support TLS and HTTPS\". However, how these EESes authenticate and authorize each other was not clearly defined.\nTherefore, it is proposed to study authenticate and authorization between two EESes.\nIf the S-EES is not authenticated and authorized by the T-EES, then the services of the T-EES can be consumed by unauthorized entities.\nIf the T-EES is not authorized by the S-EES, then the EEC application context can be sent to an entity not authorized to receive the information.\nIf the T-EES is not authenticated by the S-EES, then EEC context and in the application context can be revealed to unauthorized entities. Also, disruption of the service can happen.\nThe S-EES and T-EES should mutually authenticate each other. Also, T-EES should authorize the S-EES and the T-EES should be authorized to receive the information from the S-EES.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.7\tKey issue #2.7: EEC provided information verification",
                            "text_content": "Clause 8.6.5 of 3GPP TS 23.558 [11] defines UE identifier API which is used by an EAS or EEC to obtain the identifier of the UE if the EAS or EEC does not have it (e.g. has not already cached). This identifier, called UE ID (could be the GPSI or the EEL-generated Edge UE ID, defined in clause 7.2.6 of 3GPP TS 23.558 [11]), is used by the EAS to invoke capability APIs specific to UEs over EDGE-3 and/or EDGE-7 depending on the UE ID type.\nThe EES uses user information (e.g. IP address) received in the UE Identifier API invocation and obtains the UE identifier by interacting with NEF as specified in clause 4.15.10 of 3GPP TS 23.502 [9]. The EES may utilize the Nnef_UEId_Get service (clause 4.15.10 of 3GPP TS 23.502 [9]) providing the user information provided by the EEC, i.e. private UE IP address.\nSince the user information (i.e. private UE IP address) may be used to determine the UE ID, it is needed to ensure that the user information is trusted, and the EEC is authorized to use this user information as a parameter in the API invocation.\nThis key issue is to study the security and privacy aspects of usage of user information provided by the EEC in the UE ID API invocation.\nIf user information (i.e. the private UE IP address) provided by the EEC is not verified and the EEC is not authorized to use this information, a malicious or compromised EEC or a malicious API consumer can try to execute IP address spoofing attacks to learn identifiers of other UEs, including those they are not authorized to access. In this case, the EAS obtains an incorrect UE identifier, when the EAS use this incorrect UE identifier to invoke capability APIs specific to UE over EDGE-7, unauthorized information (e.g. UE location) belonging to another UE is exposed to the EAS.\nThe user information (i.e. private UE IP address) provided by the EEC should be verified and the EEC should be authorized to use this information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tProposed solutions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.0\tMapping of Solutions to Key Issues",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 6.0-1: Mapping of Solutions to Key Issues\n\n",
                    "tables": [
                        {
                            "description": "Table 6.0-1: Mapping of Solutions to Key Issues",
                            "table number": 3,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.1\tSolution #1: Authentication and authorization between EEC hosted in the roaming UE and ECS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1.1\tSolution overview",
                            "text_content": "This solution addresses the KI #2.1 of the present document, in which the solution re-uses the existing GBA to support the mutual authentication procedure.\nIn edge computing scenarios, one UE may have multiple EECs. Each EEC hosted in UE should be authenticated and authorized by the ECS.\nMoreover, to authenticate the EEC via correct network functions, ECS needs to know if UE is roaming. Specifically, without the correct serving network name of EEC/UE, ECS cannot connect to the correct network functions related to the authentication procedure.\nTo address the challenge, authentication and authorization between EEC hosted in the roaming UE and ECS are proposed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.2\tSolution details",
                            "text_content": "The figure depicts a network architecture with EEC (End-to-End Certification) hosted in the roaming UE (User Equipment) and ECS (Customer Service) hosted in the EEC. Authentication and authorization between the two entities are managed through a secure communication channel, ensuring the security and integrity of the network.\nFigure 6.1.2-1: Authentication and authorization between EEC hosted in the roaming UE and ECS\nIt is assumed that UE(EEC) and ECS have selected the GBA with TLS as the authentication mechanism.\nStep 0.\tUE is registered in the home network. UE obtains B-TID from BSF in the home network during the GBA procedure. By regarding the ECS as the NAF, according to 3GPP TS 33.220 [6], UE can calculate Ks_NAF, Ks_int_NAF, and Ks_ext_NAF based on NAF ID of the ECS. UE selects one of them as the KECS. And UE can derive KEEC-ECS based on KECS and EEC ID. KEEC-ECS can be derived using KDF that is defined in Annex B of 3GPP TS 33.220 [6], where EEC ID is served as the input parameter and KECS is served as key that is utilized to derive KEEC-ECS.\nStep 1.\tEEC sends provisioning request to the ECS. The provisioning request includes B-TID, encrypted EEC ID, and key indicator, where EEC ID is encrypted by KECS. Key indicator is a string (e.g. 'Ks_int_NAF') that is utilized to indicate the key type that is served as the KECS. EEC may also send GPSI to ECS via the provisioning request. MAC-I is the Message Authentication Code that is employed to protect the integrity of B-TID, encrypted EEC ID, GPSI (if provided), and key indicator. MAC-I can be built on Annex D of 3GPP TS 33.501 [7], where KECS is served as the integrity key.\nStep 2.\tUpon receiving the provisioning request, ECS detects the home network of the UE based on the B-TID according to 3GPP TS 33.220 [6]. ECS should obtain UE information, which include the PLMN identifier where the UE is currently located, the access types that are utilized by the UE, and RAT types that are utilized by the UE. According to subclause 6.1.3.18 of 3GPP TS 23.503 [16], AF can obtain UE information from PCF using the event report procedure. And ECS can verify if UE is roaming by comparing the home network identifier with the PLMN identifier that is sent by PCF. Specifically, UE is roaming if Mobile Country Code and Mobile network Code in home network identifier are not identical to these in PLMN identifier that is sent by PCF. If EEC is not hosted in the roaming UE, the non-roaming authentication and authorization mechanism among EEC and ECS can be employed. Otherwise, the procedure goes to step 3.\nStep 3.\tIn UE roaming scenarios, according to 3GPP TS 33.220 [6], ECS needs to request KECS (i.e. KAF corresponding to ECS) via Zn-Proxy if ECS is connected to the serving network of UE. The authentication request includes the B-TID, NAF ID of the ECS and key indicator. In roaming scenarios, the ECS directly request KECS from BSF in the home network of UE/ECS if ECS is connected to the home network of UE.\nStep 4.\tZn-Proxy sends the authentication request to the BSF in the home network of the UE. The authentication request includes the B-TID, NAF ID of the ECS and key indicator.\nStep 5.\tBSF derive the KECS according to the B-TID, NAF ID of the ECS and key indicator. BSF sends the KECS and the corresponding expiration time to the Zn-Proxy. In roaming scenarios, the BSF directly sends KECS to ECS if ECS is connected to the home network of UE.\nStep 6.\tZn-Proxy sends the KECS and KECS expiration time to the ECS.\nStep 7.\tIf MAC-I is received, ECS leverages the KECS and MAC-I to verify the integrity of the provisioning request message. If the provisioning request message is modified, ECS terminates the provisioning request procedure. Otherwise, ECS decrypt the EEC ID. EEC checks if the EEC is authorized to do the provisioning request operation based on the pre-configured policy. If the EEC is authorized, the procedure goes to step 8. Otherwise, ECS terminates the provisioning request procedure.\nStep 8.\tUpon receiving the KECS, ECS derives the KEEC-ECS based on the KECS and EEC ID. KEEC-ECS can be derived using KDF that is defined in Annex B of 3GPP TS 33.220 [6], where EEC ID is served as the input parameter and KECS is served as key that is utilized to derive KEEC-ECS.\nStep 9.\tMutual authentication and TLS connection is realized based on clause 5 of 3GPP TS 33.222 [10], where KEEC-ECS is served as NAF key. ECS can also verify the GPSI of UE via UE identifier API.\nStep 10.\tECS generates token for the EEC after the EEC is authenticated and TLS connection is established. The token is sent to UE through secure TLS connection. ECS authorize EEC based on the pre-configureed policies. Considering EEC and GPSI of UE are successfully authenticated by the ECS, the EES service tokens may include the ECS FQDN (issuer), EEC ID and GPSI (subject), expected EES service name(s) (Scope), EES FQDN (audience), expiration time (expiration), the digital signature generated by the ECS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.3\tSolution evaluation",
                            "text_content": "ECS can verify if EEC is hosted in a roaming UE based on B-TID and UE information that is obtained from PCF.\nMutual authentication between EEC and ECS can be realized based on KEEC-ECS.\nECS authorizes EEC based on the pre-configured policies.\nThe solution is realized based on GBA.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2\tSolution #2: Authentication and authorization between EEC hosted in the roaming UE and EES",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tSolution overview",
                            "text_content": "This solution addresses the KI #2.1 of the present document.\nThis solution reuses the existing GBA mechanism to support the mutual authentication procedure.\nIn edge computing scenarios, one UE may have multiple EECs. Each EEC hosted in UE should be authenticated and authorized by the EES.\nMoreover, to authenticate the EEC via correct network functions, EES needs to know if UE is roaming. Specifically, without the correct serving network name of EEC/UE, ECS cannot connect to the correct network functions related to the authentication procedure.\nSince EEC may authorized by ECS to request services from EES, EES needs to support verify the token that is generated by the ECS.\nTo address the challenge, authentication and authorization between EEC hosted in the roaming UE and EES are proposed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tSolution details",
                            "text_content": "The figure depicts a two-dimensional representation of the authentication and authorization process between the EEC and EES based on the Zn-Proxy protocol. The figure shows the EEC and EES as two separate entities, with the Zn-Proxy protocol being the central element. The authentication and authorization process is depicted as a series of steps, with the EEC and EES interacting through the Zn-Proxy protocol to exchange information and perform necessary actions. The figure provides a visual representation of the protocol's structure and the steps involved in the authentication and authorization process.\nFigure 6.2.2-1: Authentication and authorization between the EEC and EES based on Zn-Proxy\nIt is assumed that EES is deployed in the 3GPP operator domain and trusted by the 3GPP operator.\nIt is assume that EES has obtained certificate or public key of ECS.\nIt is assumed that UE(EEC) and EES have selected the GBA with TLS as the authentication mechanism.Step 0. UE is registered in the home network. UE obtains B-TID from BSF in the home network during the GBA procedure. By regarding the ECS as the NAF, according to 3GPP TS 33.220 [6], UE can calculate Ks_NAF, Ks_int_NAF, and Ks_ext_NAF based on NAF ID of the EES. UE selects one of them as the KEES. And UE can derive KEEC-EES based on KEES and EEC ID. KEEC-EES can be derived using KDF that is defined in Annex B of 3GPP TS 33.220 [6], where EEC ID is served as the input parameter and KEES is served as key that is utilized to derive KEEC-EES.\nStep 1.\tEEC sends EEC registration request to the EES. The request includes B-TID, encrypted EEC ID, and key indicator, where EEC ID is encrypted by KEES. Key indicator is a string (e.g. 'Ks_int_NAF') that is utilized to indicate the key that is served as the KEES. EEC may also send GPSI to EES via the provisioning request. If ECS authorize EEC to access EES via the token, ECC will send the token to the EES via the provisioning request. MAC-I is the Message Authentication Code that is employed to protect the integrity of B-TID, encrypted EEC ID, GPSI (if provided), key indicator, and the token (if provided by ECS). MAC-I can be built on Annex D of 3GPP TS 33.501 [7], where KEES is served as the integrity key. The generation of MAC-I is optional.\nStep 2.\tUpon receiving the provisioning request, EES detects the home network of the UE based on the B-TID according to 3GPP TS 33.220 [6]. ECS should obtain UE information, which include the PLMN identifier where the UE is currently located, the access types that are utilized by the UE, and RAT types that are utilized by the UE. According to subclause 6.1.3.18 of 3GPP TS 23.503 [16], EES can obtain UE information from PCF using the event report procedure. And EES can verify if UE is roaming by comparing the home network identifier with the PLMN identifier that is sent by PCF. Specifically, UE is roaming if Mobile Country Code and Mobile network Code in home network identifier are not identical to those in PLMN identifier that is sent by PCF. If EEC is not hosted in the roaming UE, the non-roaming authentication and authorization mechanism among EEC and EES can be employed. Otherwise, the procedure goes to step 3.\nStep 3.\tIn UE roaming scenarios, according to 3GPP TS 33.220 [6], EES needs to request KEES (i.e. KAF corresponding to EES) via Zn-Proxy if EES is connected to the serving network of UE. The authentication request includes the B-TID, NAF ID of the EES and key indicator. In roaming scenarios, the EES directly request KEES from BSF in the home network of UE/ECS if EES is connected to the home network of UE.\nStep 4.\tZn-Proxy sends the authentication request to the BSF in the home network of the UE. The authentication request includes the B-TID, NAF ID of the EES and key indicator.\nStep 5.\tBSF derives the KEES according to the B-TID, NAF ID of the EES and key indicator. BSF sends the KEES and the corresponding expiration time to the Zn-Proxy. In roaming scenarios, the BSF directly sends KEES to EES if EES is connected to the home network of UE.\nStep 6.\tZn-Proxy sends the KEES and KEES expiration time to the EES.\nStep 7.\tIf MAC-I is received, EES leverages the KEES and MAC-I to verify the integrity of the provisioning request message. If the provisioning request message is modified, EES terminates the provisioning request procedure. Otherwise, EES decrypts the EEC ID.\nStep 8.\tUpon receiving the KEES, EES derives the KEEC-EES based on the KEES and EEC ID. KEEC-EES can be derived using KDF that is defined in Annex B of 3GPP TS 33.220 [6], where EEC ID is served as the input parameter and KEES is served as key that is utilized to derive KEEC-EES.\nStep 9.\tMutual authentication and TLS connection can be realized based on KEEC-EES. Specifically, the mutual authentication and TLS connection is realized based on clause 5 of 3GPP TS 33.222 [10], where KEEC-EES is served as NAF key.\nStep 10.\tEES authorizes EEC for the requested service. The EEC authorization is processed based on pre-configured policies or the token provided by the EEC. For the pre-configured policies based EEC authorization case, EES authorizes the EEC if the EEC registration request message matches the pre-configured policies. For the token-based EEC authorization case, the EES first checks if the token is expired. If the token is not expired, EES verifies the ECS digital signature in the token using the public key or certificate of ECS. Otherwise, EES rejects the request. If ECS digital signature in the token is successfully verified, EES checks against EEC ID, GPSI (if provided), and requested EES service name(s) against the token claims. If the information is matched, EES authorizes EEC to access the requested service. Otherwise, EES rejects the request.\nStep 11.\tEES sends the authorization result via the EEC registration response message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tSolution evaluation",
                            "text_content": "EES can verify if EEC is hosted in a roaming UE based on B-TID and UE information that is obtained from PCF.\nMutual authentication between EEC and EES can be realized based on KEEC-EES.\nEES authorizes EEC based on the pre-configured policies or tokens that are generated by EEC.\nThe solution is realized based on GBA.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tSolution #3: Authentication mechanism selection between EEC and ECS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tSolution overview",
                            "text_content": "This solution proposes a mechanism to select one of the authentication method(s) supported by Home network and indicate the same to the EEC addressing the security requirements of key issue#2.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tSolution details",
                            "text_content": "The figure depicts a selection of authentication mechanisms used in the EEC (End-to-End Encryption) and ECS (End-to-End Encryption) protocols. The selection is based on the encryption strength and the need for additional security measures. The figure includes a legend to help users understand the different encryption methods and their respective strengths.\nFigure 6.3.2-1: Authentication mechanism selection between EEC and ECS\nStep 1.\tThe 3GPP network provides the ECS configuration information to the EEC as specified in 3GPP TS 23.558 [11]. The ECS configuration information includes the ECS address, ECS provider identifier and authentication method(s) selected by HN and SN.\nStep 2.\tThe UE determines the authentication method based on the information received in ECS configuration information. The selection of the authentication method by the UE, EEC, 3GPP network and the ECS can be as follows:\n-\tIf more than one authentication methods are supported, the authentication method selected by EEC, HN and SN based on the operator or local policy is selected.\n-\tIf one authentication method is selected and indicated then the same should be used by the UE, EEC, HN and SN.\n-\tIf no supported authentication method in common, then a default authentication method has to be selected. Defining default authentication method is based on operator policy.\nStep 3.\tThe UE sends the initial provisioning request to the ECS. The initial provisioning request includes the relevant parameter (e.g. A-KID or B-TID or OAuth Token) based on the selected authentication method.\nStep 4.\tThe UE and the ECS performs the authentication using the selected authentication method.\nTable 6.3.2.1-1 describes the information elements of ECS configuration information as specified in clause 8.3.2.1, table 8.3.2.1-1 of 3GPP TS 23.558 [11], with an additional IE to indicate selected authentication method.\nTable 6.3.2.1-1: ECS configuration information per ECS\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.3.2.1-1: ECS configuration information per ECS",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.3.3\tSolution evaluation",
                            "text_content": "This solution addresses the security requirement from Key issue#2.2 i.e. selection of authentication mechanism for authentication procedures between EEC and ECS.\nIn this solution the decision or selection of the authentication method is determined based on the UE, EEC, home network and serving network capability. The selected authentication is indicated to the EEC in ECS configuration information provisioned per ECS. The solution requires a mechanism to provision the HPLMN capability to the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tSolution #4: Authentication mechanism selection between EEC and EES",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4.1\tSolution overview",
                            "text_content": "This solution proposes a mechanism to select one of the authentication methods supported by Home network and indicate the same to the EEC addressing the security requirements of key issue#2.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.2\tSolution details",
                            "text_content": "The figure depicts the EES (E-Authentication Service) profile during the EES registration, showing the supported authentication methods.\nFigure 6.4.2-1: EES indicates the supported authentication method in\nEES profile during the EES registration\nStep 1.\tThe EES sends the EES registration request to the ECS. The request from the EES includes the EES profile, EES security credentials and the supported authentication method(s) by the EES.\nStep 2.\tUpon receiving the request from the EES, the ECS verifies the security credentials of the EES and stores the EES registration information obtained in step 1.\nStep 3.\tThe ECS sends an EES registration response indicating success or failure of the registration operation.\nDuring service provisioning, the ECS responds to the EEC's request with a service provisioning response which includes a list of EDN configuration information, e.g. identification of the EDN, EDN service area, the required information (e.g. URI, IP address) for establishing a connection to the EES and authentication method selected. ECS selects the authentication method between the EEC and EES based on the authentication method(s) supported by the UE, EEC, EES, HN and SN. ECS gets the information on the home network and serving network supported authentication method(s) from the core network. The NEF exposes the network supported authentication method.\nTable 6.4.2.1-1 describes the information elements of EES profile as specified in clause 8.2.6, table 8.2.6-1 of 3GPP TS 23.558 [11], with additional IE to indicate selected authentication method.\nTable 6.4.2.1-1: EES Profile\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.4.2.1-1: EES Profile",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.4.3\tSolution evaluation",
                            "text_content": "This solution addresses the security requirement from Key issue#2.2, i.e. selection of authentication mechanism for authentication procedures between EEC and EES.\nIn this solution the decision or selection of the authentication method is determined based on the UE, EEC, home network and serving network. EES indicates the supported authentication method(s) to the ECS in the EES profile. The NEF exposes the authentication method supported by the network. The solution requires a new service provided by the NEF. The ECS then selects the authentication method based on UE, EEC, EES, HN and SN and then indicates the selected authentication method to the EEC in the service provisioning response.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tSolution #5: 5GC-based authentication mechanism selection between EEC and ECS/EES",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tSolution overview",
                            "text_content": "This solution addresses KI 2.2 of the present document.\nTo select TLS with GBA/AKMA based authentication methods, EES/ECS needs to support GBA/AKMA protocol. However, in some cases, EES/ECS cannot select TLS with GBA/AKMA based authentication methods even if EEC/ECS can support GBA/AKMA protocol.\nSpecifically, in TLS with GBA/AKMA based authentication methods, EES/ECS takes the role of NAF or AF. To do the mutual authentication between EES/ECS and ECC, EES/ECS needs to obtain keys (e.g. KAF in AKMA scenarios) from 5GC. However, EES/ECS may fail to obtain keys from 5GC. For instance, according to subclause 6.2.1 of 3GPP TS 33.535 [8], it is stated that \"The AanF shall check whether the AanF can provide the service to the AF based on the configured local policy or based on the authorization information or policy provided by the NRF using the AF_ID. If it succeeds, the following procedures are executed. Otherwise, the AanF shall reject the procedure. \". According to clause J.2 of 3GPP TS 33.220 [6], it is stated that \"In any case, the GAA based security setup will fail between the UE and the NAF since the NAF did not get the NAF specific shared key(s)\". And EES/ECS without keys cannot support TLS with GBA/AKMA based authentication methods.\nTherefore, ECS/EES needs to ensure it can obtain keys from 5GC during the selection of the authentication method between EEC and ECS/EES.\nTo address the problem, the 5GC-based authentication mechanism selection between EEC and ECS/EES is proposed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tSolution details",
                            "text_content": "The figure depicts a selection of authentication methods used in the EEC (Enhanced Early Configuration) and ECS/EES (Enhanced Configuration and Scheduling) protocols. The methods are presented in a matrix format, with each row representing a different authentication method and each column representing a different security level. The figure provides a visual representation of the authentication process, allowing for easy comparison and understanding of the different security levels.\nFigure-6.5.2.1: Authentication method selection between EEC and ECS/EES\nIt is assumed that the negotiation messages between EEC and ECS/EES are protected by TLS 1.3.\nStep 1.\tThe EEC sends the authentication method selection request to the ECS/EES. EEC sends the authentication method identifiers (e.g. TLS with AKMA , TLS with GBA) and the types of key(e.g. Ks_int_NAF) that it supports in this message, EEC may send A-KID or B-TID to ECS/EES in the authentication method selection request message.\nStep 2.\tUpon receiving authentication method selection request, ECS/EES choose an authentication method based on the authentication methods that the EEC supports and its pre-configured policies. The policies may contain the priority of the network supported authentication methods configured by 3GPP operators or ECS/EES providers. The ECS/EES may select the authentication method based on the priority of the network supported authentication methods.\nStep 3a.\tIf ECS/EES selects AKMA or GBA based authentication method, ECS/EES needs to request authentication key from AANF or BSF in the home network of UE/EEC. Otherwise, the procedure goes to step 3b. ECS/EES identifies the home network of the UE/EEC based on the A-KID/B-TID. The authentication key is KAF of EEC/EES when ECS/EES chooses AKMA-based authentication method. The authentication key is NAF key of EEC/EES when ECS/EES chooses GBA-based authentication method. Details about the authentication key request procedure depend on the selected authentication method. If ECS/EES can obtain authentication key corresponding to the selected authentication method, ECS/EES can determine to use the selected method to do the authentication. For the case that ECS/EES chooses AKMA or GBA based authentication method, ECS/EES needs to exclude the selected method and re-select the authentication method if ECS/EES cannot obtain the authentication key. To re-select the authentication method, the procedure goes to step 2. And ECS/EES needs to skip the authentication method that it excludes in step 3a during the re-select procedure.\nStep 3b.\tECS/EES sends the selected authentication method to the UE/EEC via the authentication mechanism selection response message. ECS/EES needs to send the error code to the UE/EEC when ECS/EES cannot support any authentication methods provided by the UE/EEC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tSolution evaluation",
                            "text_content": "In this solution, ECS/EES can re-select authentication mechanism when ECS/EES cannot obtain keys related to the selected authentication method from 5GC.\nBefore choosing authentication mechanism related to AKMA/GBA, ECS/EES needs to obtain key related to AKMA/GBA from 5GC. The obtaining of keys related to AKMA/GBA from 5GC implicitly indicates the security capability of 5GC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.6\tSolution #6: ECS/EES authentication method information provisioning",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tSolution overview",
                            "text_content": "This solution addresses KI#2.2: Authentication mechanism selection between EEC and ECS/EES.\nDuring the PDU session establishment procedure, UE that hosts EEC(s) receives ECS/EES authentication method information (e.g. via PCO) and determines which to use.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.2\tSolution details",
                            "text_content": "If the UE hosts an EEC and supports transferring the ECS/EES authentication method information from the 5GC to the EEC, the UE indicates in the PCO at PDU Session establishment that it supports the ability to receive ECS address(es) via NAS and to transfer the ECS Address(es) to the EEC(s) (see 3GPP TS 23.502 [9]). As described in 3GPP TS 23.502 [9], if the UE supports the ability to receive ECS/EES authentication method information via NAS and to transfer the ECS/EES authentication method information to the EEC(s), the UE may receive ECS/EES authentication method information from the SMF via PCO during PDU Session Establishment and/or during PDU Session Modification procedures.\nThe SMF may receive ECS/EES authentication method information from the UDM together with SM subscription information. The UDM in the HPLMN may provide the SMF with ECS/EES authentication method information. Or the ECS/EES authentication method information is preconfigured in the SMF, for example, in H-SMF for HR case or V-SMF for LBO cases.\nThe SMF determines the ECS/EES authentication method information to be sent to the UE based on UE subscription information received from UDM (as described in clause 4.15.6.3d-2 of 3GPP TS 23.502 [9]).\nAccording to the ECS/EES authentication method information received from SMF (via PCO), UE selects TLS authentication methods both supported by EEC and ECS/EES. If there is no authentication methods supported by both sides, it returns failure.\nIf the UE has already done an edge computing service in the home network, the UE stores the selected TLS authentication method. While roaming, after receiving the ECS/EES authentication method information from SMF (via PCO), the UE checks if the selected TLS authentication method is supported by ECS/EES. If the selected TLS authentication method is not supported, it returns failure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.3\tSolution evaluation",
                            "text_content": "This solution has the following impacts:\n-\tUE: UE that hosts EEC(s) use the indicator (e.g. PCO) to indicate that it supports the ability to receive ECS/EES authentication information. According to the received ECS/EES authentication information, UE selects TLS authentication methods supported by both sides. UE that hosts EEC(s) stores the TLS authentication method used in the home network.\n-\tSMF: The ECS/EES authentication method information may be preconfigured in the SMF. SMF provides ECS/EES authentication information to UE.\nNOTE:\tThis solution requires a method to provision an ordered list for authentication mechanism supported by HPLMN to the UE (EEC).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tSolution #7: Negotiation procedure for the Authentication and Authorization",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.7.1\tSolution overview",
                            "text_content": "This contribution addresses key issue #2.2 \"Authentication mechanism selection between EEC and ECS/EES\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.2\tSolution details",
                            "text_content": "The negotiation procedure is as follows in figure 6.7.2-1.\nThe figure depicts a negotiation procedure for the Authentication and Authorization between EEC and ECS. It illustrates the steps taken by the EEC to authenticate and authorize the ECS, and the ECS to verify the authenticity of the EEC. The figure shows the EEC's request for authentication, the ECS's response, and the EEC's verification of the response. The figure is a visual representation of the negotiation process, providing a clear and concise explanation of the authentication and authorization process between the EEC and ECS.\nFigure 6.7.2-1: Negotiation Procedure for the Authentication and\nAuthorization between EEC and ECS\nStep 0.\tPrimary authentication is performed as defined in 3GPP TS 33.501 [7]. After this step, UE is successfully registered into the 5GS network.\nStep 1.\tUE sends the EEC Registration Request message as defined in 3GPP TS 23.558 [11], which includes the list of UE supporting authentication mechanisms. The potential authentication mechanisms list includes TLS with AKMA, TLS with GBA, TLS with certificate, or other mechanisms if any. The order in the list indicates the priority of the UE preference.\nWhen UE supports AKMA or GBA, UE shall include the corresponding Key ID (A-KID or B-TID) in the EEC registration request, which could implicitly indicate HPLMN supports AKMA and UE has subscribed with AKMA service.\nStep 2.\tECS selects one authentication method from the list of UE supporting authentication mechanisms based on local policy. If there is no shared authentication mechanisms between EEC and network, the network could cease the authentication, and the following steps from step 3 will not take place.\nStep 3.\tIf there is shared authentication mechanism, and ECS successfully chose one in Step 2, then ECS sends the EEC registration response including the chosen authentication mechanism to UE.\nStep 4.1.\tAfter receiving the response from ECS in step 3, UE prepares for the authentication procedure according to the chosen authentication mechanism. E.g. generating AKMA/GBA keys or key for other mechanisms. The procedures to derive the credentials follow the 3GPP TS 33.535 [8] for AKMA, 3GPP TS 33.220 [6] for GBA, IETF RFC 8446 [12] for TLS 1.3.\nStep 4.2.\tAfter sending the response to UE in step 3, network prepares for the authentication procedure according to the chosen authentication mechanism. E.g. generating AKMA/GBA keys or generating certificates. The procedures follow the 3GPP TS 33.535 [8] for AKMA, 3GPP TS 33.220 [6] for GBA, IETF RFC 8446 [12] for TLS 1.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.3\tSolution evaluation",
                            "text_content": "This solution is not evaluated.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.8\tSolution #8: Authentication mechanisms selected by ECS/EES",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tSolution overview",
                            "text_content": "This solution addresses the Key Issue #2.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tSolution details",
                            "text_content": "The selection of the authentication methods between EEC and ECS/EES is under the control of the entities operating ECS/EES.\nThe authentication between EEC and ECS is performs thanks to the execution of TLS handshake protocol with authentication method selected by the ECS. The authentication method selected by the ECS for TLS handshake is configured in the EEC or sent to the EEC.\nAt the end of the procedure for authentication and authorization between the EEC and the ECS, the ECS sends to the EEC the service response that includes EES authentication capability for authentication between the EEC and the EES. The EES authentication capability for authentication indicates the authentication method selected by the EES for the TLS handshake.\nNOTE:\tHow to consider security capabilities of Ues and PLMNs in the negotiation is not addressed in the present document.\nThe authentication between EEC and EES is performed thanks to the execution of TLS handshake protocol with authentication method indicated in EES authentication capability, which was sent at the end of the authentication and authorization procedure between the EEC and the ECS.\nNOTE:\tHow to consider security capabilities of Ues and PLMNs in the negotiation is not addressed in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.3\tSolution evaluation",
                            "text_content": "This solution is not evaluated.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.9\tSolution #9: Authentication mechanism selection procedure between EEC and ECS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.9.1\tSolution overview",
                            "text_content": "This solution addresses security requirement for authentication mechanism selection between EEC and ECS in key issue #2.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.2\tSolution details",
                            "text_content": "For authentication between EEC and ECS, EEC and ECS should support TLS with certificates by default, and optionally support, TLS with AKMA as specified in 3GPP TS 33.535 [8], TLS with GBA as specified in 3GPP TS 33.222 [10]. And the detail of TLS authentication method selection needs to be addressed.\nTo support authentication between the EEC and ECS, the EEC and the ECS should be configured with the security capability according to the local configuration (TLS with certificates by default, TLS with AKMA [8], and TLS with GBA [6], optionally supported).\nBefore the authentication mechanism selection procedure between EEC and ECS, the EEC should be pre-configured with or have discovered the address (e.g. URI) of the ECS as specified in clause 8.3.2 of 3GPP TS 23.558[11]. There is a list for authentication mechanism supported by HPLMN, which is ordered according to a priority based on operator's security policy. The EEC obtains the HPLMN supported mechanism list during registration, and chooses the authentication mechanism with highest priority based on HPLMN supported mechanism list and its security capability. The shared key-based authentication with certificate-based AF authentication or shared key-based mutual authentication using TLS between UE and AF as specified in Annex B of 3GPP TS 33.535[8] or clauses 5.3 and 5.4 of 3GPP TS 33.222[10] is used for the authentication mechanism selection. In this case, EEC takes the role of UE and ECS takes the role of AF respectively.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.3\tSolution evaluation",
                            "text_content": "This solution addresses KI#2.2 by authentication mechanism selection between EEC and ECS.\nThis solution based on TLS authentication protocols introduces no impact to network entities and existing procedures.\nThis solution requires a method to provision an ordered list for authentication mechanism supported by HPLMN to the UE (EEC).\nIn this solution, TLS with certificates is adopted as the default authentication for EEC and ECS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.10\tSolution #10: Authentication mechanism selection procedure between EEC and EES",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.10.1\tSolution overview",
                            "text_content": "This solution addresses security requirement for authentication mechanism selection between EEC and EES in key issue #2.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.2\tSolution details",
                            "text_content": "For authentication between EEC and EES, should support TLS with certificates by default, and optionally support TLS with AKMA as specified in 3GPP TS 33.535 [8], TLS with GBA as specified in 3GPP TS 33.222 [10]. And the detail of TLS authentication method selection needs to be addressed.\nTo support authentication between the EEC and EES, the EEC and the EES should be set with the security capability according to the local configuration (TLS with certificates by default, TLS with AKMA [6], TLS with GBA [8] and, or other TLS authentication methods optionally supported).\nBefore the authentication mechanism selection procedure between EEC and EES, the EEC should be configured with the address (e.g. URI) of the EES by the ECS as defined in clause 8.3.3 of 3GPP TS 23.558[11]. There is a list for authentication mechanism supported by HPLMN, which is ordered according to a priority based on the operator's security policy. The EEC obtains the HPLMN supported mechanism list during registration, and chooses the authentication mechanism with highest priority based on HPLMN supported mechanism list and its security capability. The shared key-based authentication with certificate-based AF authentication or shared key-based mutual authentication using TLS between UE and AF as specified in Annex B of 3GPPTS 33.535[8] or clauses 5.3 and 5.4 of 3GPPTS 33.222[10] is used for the authentication mechanism selection. In this case, EEC takes the role of UE and EES takes the role of AF respectively.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.3\tSolution evaluation",
                            "text_content": "This solution addresses KI#2.2 by authentication mechanism selection between EEC and EES.\nThis solution based on TLS authentication protocols introduces no impact to network entities and existing procedures.\nThis solution requires a method to provision an ordered list for authentication mechanism supported by HPLMN to the UE (EEC).\nIn this solution, TLS with certificates is adopted as the default authentication for EEC and EES.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.11\tSolution #11: Authentication mechanism selection procedure among EEC, ECS, and EES",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.11.1\tSolution overview",
                            "text_content": "This solution addresses security requirement for authentication mechanism selection between EEC and ECS, EEC and EES in key issue #2.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.2\tSolution details",
                            "text_content": "The EEC should be configured with the security capability according to the local configuration. The EEC should support TLS with certificates by default, and should optionally support TLS with AKMA [6] and, TLS with GBA [8]). The ECS and EES should be separately configured via network management with mechanisms that are are allowed the ECS and EES should support TLS with certificates by default and optionally support TLS with AKMA [6] and TLS with GBA [8].\nThe EES provides the supported authentication mechanism(s) to the ECS during the EES registration procedure in clause 8.4.4.2.2 in 3GPP TS 23.558[11], and the ECS stores the security capability of the registered EES.\nThe ECS provisions the Edge configuration information to the EEC which contains the information for establishing a connection with EESs (such as URI), in the Service provisioning procedure as specified in clause 8.3.3 of 3GPP TS 23.558[11]. ECS helps the authentication mechanism selection between EEC and EES, and contains the selection result in the Edge configuration information, to establish the security connection between EEC and EES.\nThe figure depicts a procedure for selecting the authentication mechanism among EEC, EES, and ECS, which is crucial for ensuring secure communication in a network.\nFigure 6.11.2-1: Procedure for authentication mechanism selection among EEC, EES, and ECS\nStep 0a:\tThere is a list for authentication mechanism supported by HPLMN, which is ordered according to a priority based on operator's security policy. The edge enabled UE (EEC) obtains the HPLMN supported mechanism list during registration.\nStep 0b:\tThe EEC is pre-configured with or has discovered the address (e.g. URI) of the ECS.\nStep 1.\tThe EEC chooses an authentication mechanism with the highest priority based on the HPLMN supported mechanism list and its security capability, and sends an Authentication Mechanism Selection Request message to the ECS, including EEC security capability, the chosen authentication mechanism, and may include the UE identifier such as GPSI, connectivity information, UE location and AC profile(s) information. Step 2a. The ECS stores the security capability of EEC, and checks if it supports the authentication mechanism chosen by EEC.\nStep 2b.\tThe ECS may utilize the capabilities (e.g. UE location) of the 3GPP core network or the profile(s) provided by the EEC, to identify the EES as specified in clause 8.3.3.2 of 3GPP TS 23.558[11]. With the security capability of the identified EES stored in EES registration, and the receiving security capability of the EEC in step 1, the ECS checks if the identified EES supports the authentication mechanism chosen by EEC.\nStep3.\tThe ECS sends the Authentication Mechanism Selection Request message to the identified EES, including EEC security capability, and the authentication mechanism chosen by EEC. If not, the step 6 and step 7 can be skipped.\nStep4.\tIf ECS supports any mechanism in EEC's security capability, ECS may use the authentication mechanism EEC chooses or another mechanism in EEC's security capability (e.g. based on local policy), ECS should sends EEC the Authentication Mechanism Selection completes message including the selection result. Otherwise the ECS should reply with a failure indication.\nECS helps the identified EES to select the authentication mechanism based on the security capability of EEC and EES, and authentication mechanism chosen by EEC and HPLMN., and the selection result of ECS should be contained in the Edge configuration information, and provide to the EEC in the Service provisioning procedure as specified in clause 8.3.2.2 of 3GPP TS 23.558 [11], for the EEC to establish security connection with the EES. If the EES could not support any mechanism in EEC's security capability, ECS sends a failure indication to EEC.\nStep5.\tUpon receiving the Authentication Mechanism Selection Complete message from ECS with the selection result, EEC starts using the mechanism indicated in selection result to authenticate and establish TLS connection with ECS. Otherwise the authentication mechanism selection failed between EEC and ECS.\nStep6.\tAfter the authentication and TLS connection establishment between EEC and ECS, the ECS sends back EEC's security capability and chosen mechanism to the EEC, and this message can be security protected by the TLS context. Thus, the EEC can verify the message had not been tampered with. The EES stores the security capability of EEC, and checks if it supports the authentication mechanism chosen by EEC.\nStep 7.\tIf EES supports any mechanism in EEC's security capability, EES uses the authentication mechanism EEC chooses or another mechanism in EEC's security capability (e.g. based on local policy), EES sends EEC the Authentication Mechanism Selection Response message including the selection result. If EES does not support any of the authentication mechanisms as indicated by EEC's security capability, the ECS replies with a failure indication.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.3\tSolution evaluation",
                            "text_content": "This solution addresses the security requirement of KI #2.2 i.e. selection of authentication mechanism for authentication procedures between EEC and ECS/EES.\nThis solution reuses the existing signalling and processes (i.e. EES registration and ECS service provisioning as specified in clause 8.4.4 and clause 8.3.3 of 3GPP TS 23.558 [11]) in ECS helping the authentication mechanism selection between EEC and EES. Specifically, The EES provides the supporting mechanism to the ECS during the EES registration. After receiving the authentication mechanism chosen by EEC and EEC's security capability, the ECS can choose the authentication mechanism supported by EEC and EES, then provide the selection result as Edge configuration information to the EEC. Therefore, this solution can reduce signalling overhead comparing with separately negotiation method.\nThis solution requires a method to provision an ordered list for authentication mechanism supported by HPLMN to the UE (EEC).\nIn this solution, TLS with certificates is adopted as the default authentication for EEC, ECS and EES.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.12\tSolution #12: Authorization for PDU session supporting local traffic routing to access an EHE in the VPLMN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.12.1\tIntroduction",
                            "text_content": "The following solution addresses the security requirement for the key issue #1.1 How to authorize PDU session to support local traffic routing to access an EHE in the VPLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.2\tSolution details",
                            "text_content": "Two scenarios have been defined in 3GPP TR 23.700-48 [2]: accessing EHE via LBO PDU Session or via HR PDU Session.\nAccording to the current PDU establishment procedure, the secondary authentication can be used for PDU session authorization irrespective of whether it is an LBO or HR PDU session. Hence, it is suggested to reuse the secondary authentication for key issue #1.1.\nFor the first scenario, the existing mechanism defined in 3GPP TS 33.501 [7] that uses the subscription data for the authorization and secondary authentication if necessary can be reused for the PDU session authorization.\nFor the second scenario, enhanced authorization on whether to support local traffic routing to access EHE is required according to the subscription data besides the existing mechanism defined in 3GPP TS 33.501 [7] for the first scenario.\nNOTE:\tThe authorization on whether to support local traffic routing to access EHE in the HR PDU session can be left to the agreement in 3GPP TR 23.700-48 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.3\tSolution evaluation",
                            "text_content": "The proposed solution meets all the requirements of key issue #1.1. The solution reuses the already specified secondary authentication for authorization between UE and Edge Data Network, and the potential authorization enhancement based on subscription in 3GPP TR 23.700-48 [2]. Hence, there is no impact of the existing security procedures.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.13\tSolution #13: A solution for authentication of EEC/UE and GPSI verification by EES/ECS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.13.1\tSolution overview",
                            "text_content": "This solution addresses the key issue #2.1 where it is stated that EEC/UE authentication is required considering both the roaming and non-roaming cases. EEC authentication means verification of the EEC ID sent from the EEC to the ECS/EES while UE authentication means verification of the GPSI of the UE that hosts the EEC communicating with the ECS/EES.\nThe solution proposes usage of AKMA for UE and EEC authentication by the ECS/EES. In addition to the AKMA usage for UE authentication, this solution uses AF Specific UE ID retrieval API as an optional solution to authenticate the UE, i.e. to verify the GPSI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.2\tSolution details",
                            "text_content": "The procedure flow of the solution is depicted in figure 6.13.2-1 and the steps are explained below. The solution assumes that there is a mechanism in the UE to authenticate the EEC.\nThe figure depicts the authentication process of EEC (Enhanced Early Configuration) and UE (User Equipment) by ECS/EES (Enhanced Early Configuration and Security). It illustrates the use of ECS/EES to authenticate EEC and UE, ensuring secure communication between the two devices.\nFigure 6.13.2-1: Authentication of EEC and UE by ECS/EES\nStep 0.\tUE and HPLMN run primary authentication and derive KAKMA. UE learns the A-KID and KAKMA.\nStep 1.\tKAF is derived as defined in AKMA procedure. KEEC is derived from KAF and EEC-ID as KEEC = KDF(KAF, EEC-ID). KEEC and E(KAF, EEC-ID) are revealed to the EEC where E(KAF, EEC-ID) is the encryption of EEC-ID under the key KAF.\nThe EEC ID is authenticated in the UE with a method out of the scope of this solution, e.g. by the operating system running in the UE. Since the KEEC derived from the EEC ID is revealed only to the authenticated EEC having the EEC ID, the EES/ECS will ensure that the EEC is the client having the EEC ID after driving the KEEC from the EEC ID.\nIf the EEC ID is sent over a secure channel between EEC and EES/ECS, then no additional encryption for it is necessary.\nStep 2.\tThe EEC sends a session establishment request to the ECS/EES, including the parameters A-KID, E(KAF, EEC-ID).\nStep 3.\tThe EES/ECS request KAF from the network. In this request, ECS/EES sends A-KID and ECS-ID/EES-ID.\nStep 4.\tThe network executes the authentication and authorization for the ECS/EES as defined in the AKMA procedure and if the result is successful then derives the KAF such that KAF = KDF (KAKMA, ECS-ID/EES-ID).\nStep 5.\tThe network sends KAF, expire time for the key and and optionally GPSI to the ECS/EES.\nStep 6.\tUsing the KAF key, the ECS/EES decrypts the encrypted EEC-ID and also derives KEEC such that KEEC = KDF(KAF, EEC-ID).\nStep 7.\tThe EEC and the ECS/EES use KEEC in Ua* protocol, instead of KAF.\nIf the EEC sends GPSI to the ECS/EES, then the ECS/EES verifies the received GPSI using the GPSI received from the network via AKMA or via UE ID API.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.3\tSolution evaluation",
                            "text_content": "This solution addresses key issue #2.1 by proposing a mechanism for authentication of both the EEC and UE by the ECS/EES. The authentication of the EEC by the ECS/EES relies on the authentication of the EEC by the UE with a method out of the scope of this solution.\nThis solution doesn't have any impact on the existing AKMA mechanism.\nThis solution also proposes two alternative methods for validation of the GPSI, by the ECS/EES, which is optionally sent by the EEC to the ECS/EES. These methods are re-using the existing AKMA and UE ID retrieval API.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.14\tSolution #14: A solution for authentication of UE and GPSI verification by EES/ECS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.14.1\tSolution overview",
                            "text_content": "This solution addresses the key issue #2.1 where it is stated that UE authentication is required considering both the roaming and non-roaming cases. UE authentication means verification of the GPSI of the UE that hosts the EEC communicating with the ECS/EES.\nThe solution proposes usage of AKMA for UE authentication by the ECS/EES. In addition to the AKMA usage for UE authentication, this solution uses AF Specific UE ID retrieval API as an optional solution to authenticate the UE, i.e. to verify the GPSI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.14.2\tSolution details",
                            "text_content": "The procedure flow of the solution is depicted in figure 6.14.2-1 and the steps are explained below.\nThe figure depicts the authentication process of EEC (Enhanced Early Configuration) and UE (User Equipment) by ECS/EES (Enhanced Early Configuration and Security). It illustrates the use of ECS/EES to authenticate EEC and UE, ensuring secure communication between the two devices. The figure shows the ECS/EES components, such as the ECS, EES, and EEC, and their respective interfaces. The authentication process is depicted in a step-by-step manner, with each step clearly labeled. The figure also includes a diagram of the ECS/EES interface, showing the communication between the ECS and EES components. Overall, the figure provides a clear and concise representation of the authentication process, making it easy to understand and follow.\nFigure 6.14.2-1: Authentication of EEC and UE by ECS/EES\nStep 0.\tUE and HPLMN run primary authentication and derive KAKMA. UE learns the A-KID and KAKMA.\nStep 1.\tKAF is derived as defined in AKMA procedure and revealed to the EEC.\nStep 2.\tThe EEC sends a session establishment request to the ECS/EES, including the parameter A-KID.\nStep 3.\tThe EES/ECS request KAF from the network. In this request, ECS/EES sends A-KID and ECS-ID/EES-ID.\nStep 4.\tThe network executes the authentication and authorization for the ECS/EES as defined in the AKMA procedure and if the result is successful then derives the KAF such that KAF = KDF (KAKMA, ECS-ID/EES-ID).\nStep 5.\tThe network sends KAF, expire time for the key and and optionally GPSI to the ECS/EES.\nStep 6.\tThe EEC and the ECS/EES use KAF in Ua* protocol.\nIf the EEC sends GPSI to the ECS/EES, then the ECS/EES verifies the received GPSI using the GPSI received from the network via AKMA or via UE ID API.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.14.3\tSolution evaluation",
                            "text_content": "This solution addresses key issue #2.1 by proposing to re-use existing AKMA mechanism for authentication the UE by the ECS/EES. It does not have any impact on the existing AKMA mechanism.\nThis solution also proposes two alternative methods for validation of the GPSI, by the ECS/EES, which is optionally sent by the EEC to the ECS/EES. These methods are re-using the existing AKMA and UE ID retrieval API.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.15\tSolution #15: Authentication algorithm selection procedure between EEC and ECS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.15.1\tSolution overview",
                            "text_content": "This solution addresses security requirement for authentication algorithm selection between EEC and ECS in key issue #2.2.\nIn this solution, the UE first retrieves the supported Authentication mechanism (s) of the network during registration, and optionally get the ECS Authentication mechanism capability. When the EEC intend to connect to ECS, the EEC determines the used authentication mechanism or candidate authentication mechanism.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.15.2\tSolution details",
                            "text_content": "This solution assumes that:\n-\tHome network and/or Serving network, UE (EEC), ECS (as NAF in GBA, or AF in AKMA) may support one or multiple mechanisms (e.g. TLS with AKMA, TLS with GBA).\n-\tEEC and ECS shall support TLS with certificates by default.\nThe figure depicts a selection of authentication mechanisms used in the EEC and ECS, with a focus on the EEC's role in ensuring secure communication. The figure includes various authentication methods such as token-based, key-based, and biometric authentication, each represented by different shapes and colors. The EEC's role is highlighted by its inclusion in the figure, emphasizing its importance in the authentication process.T\nFigure 6.15.2-1: Authentication mechanism selection between the EEC and ECS\nStep 0.\tSupported Authentication method(s) per network (e.g. GBA, AKMA) of PLMN(s) is stored in UDM.\nStep 1.\tDuring the registration procedure, the UDM obtains the supported Authentication method(s) based on the PLMN Id provided by AMF. In non-roaming case, the UDM obtains the supported Authentication method(s) of UE HPLMN, if the UE is in roaming case, the UDM also obtains the supported authentication mechanism (s) of the UE's VPLMN. The UDM provides to UE via AMF using UCU procedure or registration response.\nStep 2a.\t[Optional] During PDU Session Establishment, the SMF may provide ECS Address Configuration Information (ECS ID (e.g. FQDN or IP address(es) of ECS), [Authentication mechanism capability]) to the UE. The Authentication mechanism capability indicates the authentication mechanism the ECS support. When the UE would like to connect with ECS, if the Authentication mechanism capability received, performs step 2b, skip steps 3 to 5. Otherwise, performs steps 3 to 5 and skip step 2b.\nStep 2b.\t[Conditional] The UE determines the available network authentication mechanism based on the received supported authentication mechanism (s) and the PLMN Id of network the ECS located. Then the EEC determines the target authentication mechanism based on EEC authentication capability, authentication mechanism capability and the available network authentication mechanism.\nStep 3.\t[Conditional] The UE determines the available network authentication method based on the received supported authentication mechanism (s) and the PLMN Id of network the ECS located. Then the EEC determines the candidate authentication mechanism (s) based on EEC authentication capability and the available network authentication mechanism. The UE sends request to ECS with candidate authentication mechanism (s).\nStep 4.\tThe ECS determines selected authentication mechanism based on the received candidate authentication mechanism and the configured local policy.\nStep 5.\tThe ECS sends response with selected authentication mechanism to EEC.\nStep 6.\tEEC and ECS establish the TLS based on the selected authentication mechanism.\nAfter the TLS established, the ECS sends the received candidate authentication mechanism(s) to the UE via the service provisioning response during the service provisioning procedure as specified in clause 8.3.3.2.2 of 3GPP TS23.558 [11]. The EEC checks candidate authentication mechanism(s) sent by the ECS match the ones stored in the EEC to ensure that these were not modified by an attacker.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.15.3\tSolution evaluation",
                            "text_content": "This solution proposes the 5GC to provide the UE supported authentication methods of UE SN and/or HN during the the registration procedure. And the ECS Authentication mechanism capability is preconfigured as part of ECS Address Configuration Information. Then the EEC can determine the candidate authentication mechanism(s) which is supported by UE, EEC and SN/HN and send the candidate mechanism(s) to the ECS, and the ECS determines the used authentication based on received candidate authentication mechanism(s). The solution also extends the service provisioning procedure to send the replayed candidate authentication mechanism for preventing binding down attack because the negotiation procedure is not protected.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.16\tSolution #16: Authentication algorithm selection procedure between EEC and EES",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.16.1\tSolution overview",
                            "text_content": "This solution addresses security requirement for authentication algorithm selection between EEC and EES in key issue #2.2.\nIn this solution, the UE first retrieves the supported Authentication mechanism (s) of the network during registration, and optionally get the EES Authentication mechanism capability from ECS. When the EEC intend to connect to EES, the EEC determines the used authentication mechanism or candidate authentication mechanism.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.16.2\tSolution details",
                            "text_content": "This solution assumes that:\n-\tHome network and/or Serving network, UE(EEC), EES (as NAF in GBA, or AF in AKMA) may support one or multiple mechanisms (e.g. TLS with AKMA, TLS with GBA).\n-\tEEC and EES shall support TLS with certificates by default.\nThe figure depicts a selection of authentication mechanisms used in the EEC and EES of a communication system. The EEC (End-to-End Communication) and EES (End-to-End Security) are crucial components of a communication system, responsible for ensuring the security and integrity of the data transmitted. The figure illustrates the various authentication mechanisms used, such as token-based, key-based, and biometric authentication, each with its own advantages and disadvantages. The figure also includes a comparison of the EEC and EES, highlighting the differences in their security mechanisms and the impact on the overall system performance.\nFigure 6.16.2-1: Authentication mechanism selection between the EEC and EES\nStep 0.\tDuring the registration procedure, the UDM obtains the supported Authentication method(s) based on the PLMN Id provided by AMF. In non-roaming case, the UDM obtains the supported Authentication method(s) of UE HPLMN, if the UE is in roaming case, the UDM also obtains the supported authentication mechanism (s) of the UE's VPLMN. The UDM provides to UE via AMF using UCU procedure or registration response.\nStep 1.\tEEC establishes TLS connection with ECS based on the AKMA or GBA or certificate.\nStep 2.\tThe EEC sends the service request to the ECS.\nStep 3.\tThe ECS should authorize the EEC by its local authorization policy, if the authentication and authorization is successful, then the ECS processes the request.\nStep 4.\tThe ECS decides whether access tokens are required for the candidate EESes using the configuration information and issues separate EES access tokens to be used for each candidate EESes that use token-based authorization. The ECS sends the EES access tokens to the EEC. Optionally, the Authentication mechanism capability is included. The Authentication mechanism capability indicates the authentication mechanism the EES support.\nWhen the EEC would like to connect with EES, if the Authentication mechanism capability received, performs step 5, skip steps 6 to 8. Otherwise, performs steps 6 to 8 and skip step 5.\nStep 5.\t[Conditional]The UE determines the available network authentication mechanism based on the received supported authentication mechanism (s) and the PLMN Id of network the EES located. Then the EEC determines the target authentication mechanism based on EEC authentication capability, authentication mechanism capability and the available network authentication mechanism.\nStep 6.\t[Conditional] The UE determines the available network authentication method based on the received supported authentication mechanism (s) and the PLMN Id of network the EES located. Then the EEC determines the candidate authentication mechanism (s) based on EEC authentication capability and the available network authentication mechanism. The EEC sends request to EES with candidate authentication mechanism (s).\nStep 7.\t[Conditional]The EES determines selected authentication mechanism based on the received candidate authentication mechanism and the configured local policy.\nStep 8.\t[Conditional]The EES sends response with selected authentication mechanism to EEC.\nStep 9.\tEEC and ECS establish the TLS based on the selected authentication mechanism.\nAfter the TLS established, the EES sends the received candidate authentication mechanism(s) to the UE via the EAS discovery response during the EAS Discovery procedure as specified in clause 8.5.2.2 of 3GPP TS23.558 [11]. The EEC checks candidate authentication mechanism(s) sent by the EES match the ones stored in the EEC to ensure that these were not modified by an attacker.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.16.3\tSolution evaluation",
                            "text_content": "This solution proposes the 5GC to provide supported authentication methods of UE SN and/or HN to UE during the the registration procedure and the ECS to provide the EES's security authentication mechanism capability during the EES discovery procedure (e.g. service provisioning procedure), then the EEC can determine the used authentication mechanism(s) which is supported by UE, EEC, EES and SN/HN. In addition, if the ECS does not provide the EES's security authentication mechanism capability, the EEC can determine the candidate authentication mechanism(s) which is supported by UE, EEC and SN/HN and send the candidate mechanism(s) to the EES, and the EES determines the used authentication based on received candidate authentication mechanism(s). In this case, the EES need to extends the EAS discovery procedure to send the replayed candidate authentication mechanism for preventing binding down attack because the negotiation procedure is not protected.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.17\tSolution #17: Using existing AKMA/GBA negotiation mechanism",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.17.1\tSolution overview",
                            "text_content": "This solution addresses key issue #2.2 that focuses on authentication method negotiation for the case that there is more than one authentication method for the authentication of EEC/UE. This contribution proposes a solution that re-uses existing negotiation mechanism for AKMA/GBA.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.2\tSolution details",
                            "text_content": "This solution proposes a mechanism for shared key based EEC/UE authentication and certificate based ECS/EES authentication in clause 6.17.2.1 and a mechanism for shared key based mutual authentication in clause 6.17.2.2.\nIt is assumed that the ECS/EES is preconfigured with the information indicating which feature (AKMA or GBA) is supported by the HPLMN. The steps of the negotiation procedure are described below.\nIf it is not possible to configure the information about the authentication method support of HPLMN in the ECS/EES, then it can be assumed that the UE/EEC is preconfigured with that information. In this case, in step 2 the UE/EEC sends supported PSK hints to the ECS/EES:\n1)\tThe UE/EEC and ECS/EES establish TLS connection using TLS server certificate.\n2)\tThe UE/EEC sends all possible PSK hints (\"3GPP-AKMA\", \"3GPP-bootstrapping\", \"3GPP-bootstrapping-uicc\", \"3GPP-bootstrapping-digest\") and the HPLMN identifier to the server (ECS/EES).\n3)\tThe server indicates the PSK identity hints considering the support of the HPLMN, and the existence of the agreement between the server and the HPLMN about the usage of AKMA/GBAin the HTTP response.\n4)\tRemaining steps in clause 5.3 in TS 33.222 [10] with the enhancements specified in Annex B.1.2 of 3GPP TS 33.535 [8] are executed.\nNOTE:\tUsing of HPLMN identifier is not addressed in the present document.\nIt is assumed that the ECS/EES is preconfigured with the information indicating which feature (AKMA or GBA) is supported by the HPLMN. The steps of the negotiation procedure are described below.\nIf it is not possible to configure the information about the authentication method support of HPLMN in the ECS/EES, then it can be assumed that the UE/EEC is preconfigured with that information. In this case, in step 2 the ECS/EES doesn't need to consider the authentication method support of the HPLMN and includes possible PSK identity hints considering the existence of the agreement between the server and the HPLMN about the usage of AKMA/GBA, in step 3 the UE/EEC selects the PSK identity hint considering the HPLMN support and UE/EEC capability:\n1)\tThe UE/EEC sends ClientHello message including the HPLMN identifier to the server (ECS/EES).\n2)\tThe server sends ServerHello and ServerKeyExchange message to the UE/EEC. In the ServerKeyExchange message, the server includes the PSK identity hints considering the support of the HPLMN, i.e. \"3GPP-AKMA\" or \"3GPP-bootstrapping\", \"3GPP-bootstrapping-uicc\", \"3GPP-bootstrapping-digest\".\nThe UE/EEC can store the feature support information to use it in further interactions between the EEC and ECS/EES.\n3)\tThe UE/EEC runs AKMA or GBA procedures and sends the PSK hint and A-KID or B-TID in the ClientKeyExchange message to the server.\nIt is assumed that the ECS/EES is preconfigured with the information indicating which feature (AKMA or GBA) is supported by the HPLMN. The steps of the negotiation procedure are described below.\nIf it is not possible to configure the information about the authentication method support of HPLMN in the ECS/EES, then it can be assumed that the UE/EEC is preconfigured with that information. In this case, in step 1 the UE/EEC generates A-KID or B-TID depending on the HPLMN support, in step 2, the UE/EEC sends A-KID or B-TID depending on the HPLMN support and includes related PSK identity hints depending on the HPLMN support, in step 3 the ECS/EES doesn't need to consider the authentication method support of the HPLMN, step 4 is not executed if the UE/EEC has already performed the GBA bootstrapping procedure:\n1)\tThe UE/EEC sends ClientHello message including all possible PSK identity hints (i.e. \"3GPP-AKMA\", \"3GPP-bootstrapping\", \"3GPP-bootstrapping-uicc\" and \"3GPP-bootstrapping-digest\") and A-KID/B-TID (if available) to the server.\nIf none of A-KID or B-TID is available, then the UE/EEC includes the HPLMN identifier in the ClientHello message.\n2)\tThe server extracts the HPLMN id from the A-KID or the B-TID (if included) and checks the configured HPLMN support information. Then the server sends the ServerHello message including the appropriate PSK hint (\"3GPP-AKMA\" if HPLMN supports AKMA or \"3GPP-bootstrapping\", \"3GPP-bootstrapping-uicc\", \"3GPP-bootstrapping-digest\" if HPLMN supports GBA). If the PSK hint indicates a GBA type of method and the ClientHello message includes a dummy B-TID then the server requests the UE to run a new GBA bootstrapping as specified in 3GPP TS 33.222 [10], 5.4.0.2, step 2.\n3)\tStep 4. The UE/EEC executes the GBA bootstrapping procedure if the PSK hint from the server indicates that GBA should be run.\nThe UE/EEC can store the feature support information to use it in further interactions between the EEC and ECS/EES.\nIn case of authentication negotiation failure, whether the server provides services is up to implementation.\nIf the EEC sends the GPSI to the server, the server needs to verify the GPSI to ensure that the GPSI belongs to the GPSI of the UE where the EEC is running. There are two alternatives for this verification: AKMA and AF Specific UE ID Retrieval API. Since the decision is done by the server itself, there is no need to have a negotiation mechanism for this check. The server decides on the method considering existence of AKMA usage agreement with the HPLMN. How this decision is done is left to implementation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.3\tSolution evaluation",
                            "text_content": "The solution uses existing AKMA/GBA negotiation mechanism that utilizes TLS negotiation method as much as possible. To handle the negotiation failure case, the solution leaves the decision to the implementation considering possible future services that can be provided by the servers, where some of them can be more critical in terms of security and privacy.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.18\tSolution #18: Authentication and Authorization between V-ECS and H-ECS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.18.1\tSolution overview",
                            "text_content": "This solution addresses the security requirement for authentication and authorization between V-ECS and H-ECS in key issue #2.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.18.2\tSolution details",
                            "text_content": "Pre-requisite:\n-\tThe V-ECS and H-ECS are preconfigured with credentials (e.g. certificate, shared keys/secrets) for mutual authentication.\nThe mutual authentication between V-ECS and H-ECS can be done based on the preconfigured credentials.\nThe H-ECS can authorize the V-ECS based on preconfigured local authorization policy.\n6.18.3\tSolution evaluation\nThe solution addresses the key issue #2.3.\nPreconfigured credentials could be used for mutual authentication between V-ECS and H-ECS, and local policy could be used for v-ECS authorization by H-ECS. No further impact is identified on ECSes.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.19\tSolution #19: Authorization of V-ECS in roaming scenario",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.19.1\tSolution overview",
                            "text_content": "This contribution propose new solution for key issue#2.3. In roaming scenario, if the service provisioning request contains the serving PLMN ID, it is proposed that the H-ECS requests the 3GPP core network the list of VPLMN IDs UE is authorized to roam in and check against the received PLMN ID to authorize the V-ECS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.19.2\tSolution details",
                            "text_content": "In this solution, it is assumed that the HPLMN (ECSP1) and VPLMN (ECSP2) have a service level agreement to share edge services. If the H-ECS cannot discover a suitable EES to serve the UE at the current location (e.g. all the EESs registered on the H-ECS do not cover the given UE location), the H-ECS discovers another V-ECS which may have suitable EES and discovers the EES via the V-ECS.\nFor roaming scenario, if the service provisioning request from the EEC from the EEC does not contain the serving PLMN ID, the H-ECS requests the UDM the list of VPLMN IDs or ECS provider identifier allowed for the UE. If the PLMN ID is sent or included in the service provisioning request by the EEC, then the H-ECS checks with the pre-configured roaming information or the H-ECS reaches out to the UDM to check if the provided PLMN ID is the PLMN that the UE is allowed to access and is authorized to avail the Edge services.\nThe figure depicts a schematic representation of the authorization process for V-ECS (Virtual-Edge Computing) by H-ECS (Hybrid-Edge Computing). It illustrates the flow of authorization requests from V-ECS to H-ECS, highlighting the steps involved in verifying the identity of the requesting entity and ensuring the security of the authorization process. The figure includes various components such as authorization request, authorization response, and authorization status, providing a clear visual representation of the authorization process.\nFigure 6.19.2-1: Authorization of V-ECS by H-ECS\nStep 1.\tThe EEC sends a service provisioning request to the H-ECS. The request may include the UE location. For roaming scenario, the request may also include serving PLMN ID of the UE hosting the EEC.\nStep 2.\tIf the request does not contain the UE location information, the H-ECS interacts with 3GPP core network to retrieve the UE location. If the H-ECS cannot discover a suitable EES-2 to serve the UE at the received or retrieved UE location based on the received information (e.g. all the EESs registered on the H-ECS do not cover the given UE location), the H-ECS discovers another V-ECS which may have suitable EES based on the information such as the UE location.\nStep 3.\tFor roaming scenario, if the request does not contain the serving PLMN ID, the H-ECS requests the core network to retrieve the list of VPLMNs supporting EDGE. The H-ECS sends roaming information request message to the NEF.\nSteps 4-5.\tThe NEF retrieves the roaming information from the UDM. The roaming information includes the list of VPLMNs supporting EDGE and/or preferred ECSPs in VPLMN and/or EES or ECS provider identifier.\nStep 6.\tThe H-ECS can check if the edge computing service for the EEC can be supported in the VPLMN based on the received roaming information on edge computing services between PLMNs or ECSPs. The H-ECS discovers the V-ECS which have suitable EES based on the roaming information.\nNOTE:\tWhether local configuration in the ECS is enough or ECS needs to learn the list from the UDM is not addressed in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.19.3\tSolution evaluation",
                            "text_content": "This solution is not evaluated.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.20\tSolution #20: Transport security for the EDGE10 interface",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.20.1\tSolution overview",
                            "text_content": "This solution addresses security requirement for transport security for the EDGE10 interface in key issue #2.4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.20.2\tSolution details",
                            "text_content": "Since the EDGE10 interface is SBI based, it is proposed to reuse the same security mechanisms specified in 3GPP TS 33.558 [4] as for EDGE6/9.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.20.3\tSolution evaluation",
                            "text_content": "This solution addresses the transport security for the EDGE10 in the key issue #2.4. The solution is based on reusing existing mechanisms and hence has no standard impact.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.21\tSolution #21: Using local policy on authorization between EESes",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.21.1\tSolution overview",
                            "text_content": "This solution addresses KI#2.6 on the authorization between EESes.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.2\tSolution details",
                            "text_content": "For the EDGE-9 interface between EESes, it is proposed to base authorization on local policies described in 3GPP TS 33.501 [7] clause 13.3.0.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.3\tSolution evaluation",
                            "text_content": "This solution addresses the requirements of KI#2.6 on the authorization between EESes.\nLocal policy could be reused here for the authorization between EESes. No further impact is identified on the EES.\n6.22\tSolution #22: Using existing TLS 1.3 to perform negotiation mechanism\n6.22.1\tSolution overview\nThis solution addresses key issue #2.2 by providing a secure way to negotiate the authentication method used between the EEC and ECS/EES using existing procedures.\n6.22.2\tSolution details\nThere are multiple methods that the EEC could use to authenticate to the ECS/EES with the main ones as follows.\nNOTE 1:\tThis solution is not taking a stance on the viability of these solutions. It is focusing on providing a method for negotiating between the possible methods.\nThe solution use TLS 1.3 with the any of the following included in the ClientHello based on the authentication methods that the EEC can use:\n-\tAKMA: AKID and symmetric key ciphersuite(s);\n-\tGBA: B-TID and symmetric key ciphersuite(s);\n-\tDigest/Token methods: Ciphersuite(s) supporting server side certificates only; and\n-\tClient certificates: Ciphersuites supporting both client and server side certificates.\nFrom this information, the ECS/ESS can determine which are possible authentication methods. If the UE and ECS/EES do not support a common method, the TLS handshake will fail.\nFor example, in case A-KID/B-TID are sent along with other methods supported by the UE, the ECS/EES can easily determine if an AKMA/GBA key is available for that UE. This is done by first using the A-KID (or B-TID) received in the ClientHello to determine the HPLMN of the UE and further determine if the ECS/EES supports AKMA (or GBA) with that HPLMN. The ECS/EES can then request an AKMA (GBA) key using related interfaces. If these steps succeed then the ECS/EES can use AKMA (GBA) with the UE to establish the TLS connection. If any of these steps fails, the ECS/EES can respond to the ClientHello and try any of the other methods supported by the EEC, and complete the TLS handshake appropriately.\nThe TLS handshake protects the method from bidding down.\nThe solution requires no new functionality to be supported.\nNOTE 2:\tFor client authentication methods that happen in the TLS tunnel, the Digest realm parameter can be used as a hint of which digest credentials might work with the ECS/ESS. For token methods, information in or related to the token is used to decide if the token can be used with ECS/ESS.\n6.22.3\tSolution evaluation\nhis solution is not evaluated.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.23\tSolution #23: EAS discovery procedure protection",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.23.1\tSolution overview",
                            "text_content": "The key issue #1.2 is proposed to protect EAS discovery procedure via V-EASDF. In an edge computing environment, DNS message is needed to query the Edge application Server's address. If the DNS destination address is modified by the attacker, then the wrong Edge Application Server address may be allocated. This attack may make UE connected to a far Edge server and ruin the advantage of the MEC, even worse, the false DNS server may lead UE to connect to a compromised Edge Server.\n3GPP TS 33.501 [7] has an informative annex P.2 describing security aspects on DNS for 5G, and it is proposed to reuse the DNS over (D)TLS in the MEC system.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.23.2\tSolution details",
                            "text_content": "According to the specification in 3GPP TS23.548 [15], V-EASDF is used as DNS server for EAS discovery. Therefore, V-EASDF should support DNS over (D)TLS, as specified in IETF RFC 7858 [17] and IETF RFC 8310 [18]. The V-EASDF that are deployed within the 3GPP network can enforce the use of DNS over (D)TLS. The core network configures the V-EASDF security information to the UE as follows: the V-SMF can be preconfigured with the V-EASDF security information, or fetch the information from the V-EASDF. And then V-SMF provides the V-EASDF security information to UE directly (i.e. LBO case), or via H-SMF (i.e. case where HR SBO is authorized by HPLMN), during the PDU session establishment or during modification procedure when the V-SMF determines to use a new V-EASDF for EAS discovery.\nIf the core network is used for V-EASDF security information provisioning, the V-SMF provides the V-EASDF security information to UE directly (i.e. LBO case) or via H-SMF (i.e. LBO case) during the PDU session establishment or modification procedure when the V-SMF determines to use V-EASDF for EAS discovery.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.23.3\tSolution evaluation",
                            "text_content": "This solution reuses the security recommendations from 3GPP TS 33.501 [7].\nThis solution restricts to the provisioning from the v-SMF to the UE in the visited network, which means that it does not impact the provision from the HPLMN to the UE.\nIn addition, it requires UE and V-EASDF to support DNS over (D)TLS, if the core network is used for V-EASDF security information provisioning, the V-SMF is responsible for provide the security information of V-EASDF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.24\tSolution #24: Public key signature based ECS/EES authentication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.24.1\tSolution overview",
                            "text_content": "This solution proposes a mechanism to set and select the public key signature based ECS/EES authentication using server certificate or raw public key based TLS as default authentication mechanism, when there is no support for common method between UE and ECS/EES. This solution partially addresses the security requirements of key issue#2.1, as only authenticity of the server is verified.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.24.2\tSolution details",
                            "text_content": "The public key signature based ECS/EES authentication using server certificate or raw public key based TLS is used as default authentication mechanism, when UE/EEC, HN, SN and ECS/EES fails to negotiate a common method and/or based on operators choice. It is mandatory to support the public key signature based ECS/EES authentication using certificate or raw public key based TLS in the ECS, EES and UE and to be used only when there is no common mutual authentication method supported.\nThe root certificate (for ECS/EES certificate verification) or the public key is provisioned to the UE/EEC as part of ECS configuration information during service provisioning.\nAs there is no client/UE side authentication and authorization performed, the UE is provided with no privileged services and not provided with UE specific information, but provided only with generic information i.e. the ECS/EES and the network is not allowed to expose any UE specific information for example, UE ID, location information like so, as this may lead to privacy issue (exposing UE specific information to an unauthenticated UE).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.24.3\tSolution evaluation",
                            "text_content": "This solution partially addresses the security requirement from Key issue#2.1, as only server side authentication is performed, not the mutual authentication. The solution has impact on provisioning of root certificate or the public key. However, at least server side authentication is required for the scenarios where there is no common mutual authentication method supported by the UE, HN, SN and ECS/EES in order to provide EDGE service to the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.25\tSolution #25: Utilizing Token-Based Solutions for EEC authentication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.25.1\tSolution overview",
                            "text_content": "The methods for authentication of EEC by the ECS/EES has been left as out of scope for Rel-17 in 3GPP TS 33.558 [4]. In the present document, possible methods and negotiation mechanisms have been studied under key issue #2.1 and #2.2, respectively.\nPossible options proposed so far include AKMA, GBA and TLS client certificate. Also, how to handle negotiation failure cases are under discussion. To prevent negotiation failures, there can be two alternatives:\n1)\tthe UE side or PLMN side has to support all the methods;\n2)\tat least one mandatory method should be specified.\nIf none of the alternatives cannot be agreeable by SA3 working group, then it is possible to have negotiation failures in run time.\nTo handle the negotiation failures, two approaches have been proposed so far in the discussions:\n1)\tno client authentication;\n2)\tTLS client certificates usage.\nIt should be noted that TLS client certificates are not feasible in practice because it is not appropriate to use Internet PKI for many instances of applications running different Ues and to handle private PKIs for the setting that there are different players and providers. Thus, the only alternative becomes no client authentication. However, if no client authentication is specified as one option, then having other methods will not bring any security value because the malicious client will find a way to use no client authentication method.\nTo look to the problem from a different perspective, commonly used methods in the ecosystem should be considered for client authentications in UEs. One of the methods commonly used in the ecosystem is the methods based on token usage. There can be different methods how and where the client can receive a token. One example can be the utilization of Service Entitlement Configuration mechanisms documented by GSMA in [14] where the Entitlement Configuration Server provides a token to the client to be used towards to the servers for related services.\nThis contribution proposes a high-level solution for EEC authentication using token-based mechanisms.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.25.2\tSolution details",
                            "text_content": "The EEC authentication is executed by a mechanism out of scope of this solution. Such a mechanism can be Service Entitlement Configuration specified in [14] where the Entitlement Configuration Server issues a token for the client. After the authentication, the EEC receives a token to be used towards to the Edge Configuration Server (ECS) / Edge Enabler Server (EES).\nUtilization of such a token-based mechanism can be embedded to the authentication between the EEC and the ECS/EES mechanism as follows considering the Service Entitlement Configuration specified in [14] as an example.\n1)\tThe EEC requests a token from the Entitlement Configuration Server. This request can be executed via the Entitlement Client specified in [14] or the EEC can have functionality of the Entitlement Client. The Entitlement Configuration Server authenticates the EEC/UE using one of the methods specified in [14] and then issues a token with the claims of the Entitlement Configuration Server FQDN, EEC ID, optionally GPSI, ECS/EES FQDN, and expire time.\n2)\tFor the ECS/EES authentication by the EEC, TLS server certificate is used. For EEC authentication by the ECS/EES, the EEC provides the token to the ECS/EES so that the ECS/EES accepts the request coming from the EEC. The ECS/EES validates the claims in the token and verifies the token by communicating with the Entitlement Configuration Server or by using the certificate of the Entitlement Configuration Server.\nThe communication between Entitlement Configuration Server and ECS/EES is not in the scope of this solution (i.e. it is in the scope of [14]). This solution requires that this communication is security protected to prevent token interception by unauthorized entities. The security credential and the authentication of the EEC by the Entitlement Configuration Server is out of scope of this solution (i.e. it is in the scope of [14]).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.25.3\tSolution evaluation",
                            "text_content": "This solution introduces another authentication method option, token-based approach, which is a method widely used in the ecosystem. The details of the token-based solution are not specified but an example is presented to skect how this method can be used.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.26\tSolution #26: Using authorization token on authorization between EESes",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.26.1\tSolution overview",
                            "text_content": "This solution addresses KI#2.6 on the authorization between EESes.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.2\tSolution details - Target EES Decided ACR",
                            "text_content": "For the EDGE-9 interface between EESes, it is proposed to use the authorization token for application context transfer authorization between the S-EES and the T-EES.\nFigure 6.26.2-1 illustrates an example procedure for EEC Authorization of EEC Context transfer in a scenario where an ACR procedure IS initiated by the EEC and the procedure requires that EEC Context be PUSHED from the S-EES to the T-EES.\nThe figure depicts a flow diagram illustrating the application context transfer process with ACT authorization tokens. It shows the flow of data from the source application to the target application, including the use of authorization tokens for secure communication. The diagram includes various components such as the source application, the target application, and the authorization tokens, all connected by lines and arrows to demonstrate the flow of data.\nFigure 6.26.2-1: Application Context Transfer with ACT authorization tokens\nFigure 6.26.2-1 shows the procedure of application context transfer from S-EES to T-EES steps with the following:\nStep 1.\tThe EEC established a secure connection with the source ECS which is optionally based on TLS setup with AKMA or GBA pre-shared key using the procedure specified in 3GPP TS 33.558 [4]. Depending on configuration, a reauthentication or AKMA/GBA may be needed when AC receives the ACR Selection message.\nStep 2.\tThe AC receives the ACR Selection message and this message triggers the EEC to start ACT. The AC decides to initiate the transfer of application context from the S-EES to the T-EES. In addition to request the authorization token for EES and EAS access, the EEC also request tokens for application context transfer authorization from the S-EES to T-EES (ACT authorization tokens). Alternatively, the tokens may have been received in the ACR Selection message.\nStep 3.\tECS processes the request and generates the requested tokens after authorization of EEC. The ACT authorization token may include but not limited to AC ID, S-EES ID, T-EES ID, ECS ID, token validity time, action authorized, claims, scope, etc.\nSince the EEC is the owner of the application context stored in EES and the context contains sensitive information such as UE ID, UE location, and etc, the relocation of the application context from the source EES to the target EES. Therefore, in this step, the EEC agree the application context transfer and request a token from the ECS that the T-EES and S-EES can use as the approval that the application context transfer is authorized by the EEC. In this case, the ECS serves as the Authorization Server, the same role when the ECS issues authorization token used by the EEC to access the EES.\nStep 4.\tThe ECS sends the tokens and ACT authorization tokens to the AC/EEC.\nStep 5.\tThe AC/EEC establishes TLS with the target ECS if the ECS changes during ACR and it receives tokens of authorization to access T-EES, and setup TLS with T-EES.\nThe AC/EEC sends an Application Context Transfer request to the T-EES and the request included T-EES access authorization tokens and ACT Authorization tokens.\nStep 6.\tOptionally, the T-EES and S-EES setup the security connection (e.g. TLS connection) if there is a need.\nStep 7.\tThe T-EES authorizes the AC with EES access token, and then send the application context transfer request along with the ACT Authorization token to the S-EES.\nStep 8.\tUpon receiving the ACT request from the T-EES, the S-EES validates the received authorization token.\nStep 9.\tThe S-EES transfer the AC application context to the T-EES if the token validation is successful.\nStep 10.\tThe T-EES sends the ACT complete message to the AC/EEC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.3\tSolution details: Source EAS decided ACR",
                            "text_content": "Figure 6.26.3-1 illustrates an example procedure for EEC Authorization of EEC Context transfer in a scenario where an ACR procedure IS NOT initiated by the EEC and the procedure requires that EEC Context be PUSHED from the S-EES to the T-EES.\nIn this scenario, the S-EAS may detect the need of ACR locally or is notified by the S-EES via ACR management notifications or UE location notifications. In the same time, the EEC has also subscribed to receive ACR information notifications for target information notification events.\nWhen the notification is received by the EEC from the S-EES, the EEC responds to the EES with the authorization token to authorize the ACR to be used for the application context transfer from the S-EES and T-EES. The S-EAS make the decision about whether to perform the ACR, and starts the ACR at a proper time.\nThe figure depicts a simplified schematic of an S-EAS (Signal-Enhanced Automatic Repeat Request) decision algorithm, which is used to determine the appropriate Automatic Repeat Request (ARQ) sequence for a given signal. The algorithm is based on the signal strength and the channel conditions, and it determines the best ARQ sequence to maximize the signal-to-noise ratio (SNR) and minimize the energy consumption. The figure shows the decision process, including the selection of the appropriate ARQ sequence and the calculation of the SNR.\nFigure 6.26.3-1: S-EAS decided ACR\nPhase 0: EEC Configuration and Provision:\n0.\tSame as steps 1-4 in the figure 6.26.2-1. The EEC received the ACR authorization token from the ECS as the results.\nPhase I: ACR Detection:\n1.\tThe S-EAS either receives ACR management notifications from source Edge Enabler Sever indicating that ACR may be required (\"ACR monitoring\" event), or self detects the need for ACR (e.g. upon receipt of a \"user plane path change\" event or UE location notification.\nPhase II: ACR Decision:\n2.\tThe S-EAS makes the decision to perform the ACR.\nPhase III: ACR Execution:\n3.\tThe S-EAS discovers the T-EAS.\n4.\tThe S-EAS sends selected T-EAS declaration message to S-EES, to inform S-EES the determined. The S-EAS may send the ACID and Predicted/Expected UE location or Expected AC Geographical Service Area to the EES. When the EES receives the predicted/expected UE location or Expected AC Geographical Service Area from the EAS, then the EES will determine to monitor the UE mobility.\n5.\tBased on the T-EAS selection information received from the S-EAS, the S-EES sends the target information notification to the EEC as described in clause 8.8.3.5.3 of 3GPP TR 33.839 [5]. The selected T-EES may be included in the target information and the ACID which corresponds to the selected target EAS is included in the notification sent to the EEC as described in clause 8.8.3.5.3 of 3GPP TR 33.839 [5].\nAlternative to step 0, if authorization token is based on the EES instance, the EEC can request the authorization token from the ECS before send the request in the next step.\n6.\tWhen the EEC receives the ACR information and authorizes the application context relocation, it responds to the S-EES with the authorization token.\n7.\tIf the T-EES is different than the S-EES and the EEC Context at the S-EES is not stale, the S-EES initiates EEC Context Push relocation with the T-EES with the authorization token received from the EEC. Otherwise, if the T-EES is the same as the S-EES, EEC Context Push relocation is skipped.\nThe EES context transfer procedure is the same as in the steps 6-9 in the figure 6.26.2-1 and therefore they are not repeated here.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.4\tSolution details: S-EES executed ACR",
                            "text_content": "Figure 6.26.4-1 illustrates an example procedure for EEC Authorization of EEC Context transfer in a scenario where an ACR procedure IS initiated by the EEC and the procedure requires that EEC Context be PULLED from the S-EES to the T-EES.\nIn the case of S-EES executed ACR, the EEC has subscribed to receive ACR information notifications for target information notification events.\nWhen the notification is received from the S-EES, the EEC responds to the EES with the authorization token to authorize the ACR to be used for the application context transfer from the S-EES and T-EES.\nThe figure depicts a simplified representation of an ACR (Automatic Configuration Request) execution in a 5G network. It shows the steps involved in configuring the network, including the use of S-E (Service-Enhanced) and ES (Enhanced Service) protocols. The figure illustrates the process of requesting an ACR from the network controller, which is then executed by the S-E and ES protocols. The ACR execution is depicted as a series of steps, with each step represented by a different color and symbol. The figure also includes a legend to help understand the different colors and symbols used in the diagram. Overall, the figure provides a clear and concise visual representation of the ACR execution process in a 5G network.\nFigure 6.26.4-1: S-EES executed ACR\nPhase 0: EEC Configuration and Provision:\n0.\tSame as steps 1-4 in the figure 6.26.2-1 of the clause 6.26.2. The EEC received the ACR authorization token from the ECS as the results.\n1.\tThe S-EAS may initiate EELManagedACR with S-EES. In this step, the S-EAS and S-EES negotiate an address of the Application Context storage to S-EES.\nPhase I: ACR Detection:\n2.\tDetection entities (S-EAS, S-EES, EEC) detect that ACR may be required and identify the ACID and Predicted/Expected UE location or Expected AC Geographical Service Area. The detection by the S-EES may be triggered by the User Plane path change notification received from the 3GPP Core Network due to S-EAS request for \"ACR facilitation\" event.\nPhase II: ACR Decision:\n3.\tThe detection entity performs ACR launching procedure with the ACR action indicating ACR determination and the corresponding ACR determination data. If the EEC or S-EAS detect the ACR event, the EEC or S-EAS may inform S-EES with ACID, and predicted/expected UE location or Expected AC Geographical Service Area in the ACR launching procedure.\n4.\tThe S-EES authorizes the message if received. The S-EES decides to execute ACR based on the information received or local detection, and the information of EEC context or EAS profile, and then proceed the below steps. When the EES receives the predicted/expected UE location or Expected AC Geographical Service Area from the EEC or the EAS in ACR determination, or the EES received service continuity planning from EAS in ACR facilitation event subscription, then the EES will determine to monitor the UE mobility.\nPhase III:\tACR Execution:\n5a.\tThe S-EES determines T-EES and T-EAS via the Discover T-EAS procedure.\n5b.\tIf required, the S-EES performs ACR parameter information procedure by sending the ACR parameter information request to the T-EES.\n6.\tThe S-EES sends the target information notification to the EEC.\nAlternative to step 0, if authorization token is based on the EES instance, the EEC can request the authorization token from the ECS before send the request in the next step.\n7.\tAs the results of receiving the notification, the EEC responds to the EES with the authorization token to authorize the ACR.\n8.\tIf the T-EES is different than the S-EES and the EEC Context at the S-EES is not stale, the S-EES initiates EEC Context Push relocation with the T-EES along with the authorization token received from the EEC in step 7. Otherwise, if the T-EES is the same as the S-EES, EEC Context Push relocation is skipped.\nThe EES context transfer procedure is the same as in the steps 6-9 in the figure 6.26.2-1 in clause 6.26.2 and therefore they are not repeated here.\n9.\tThe S-EES may apply the AF traffic influence with the N6 routing information of the T-EAS in the 3GPP Core Network (if applicable).\n10.\tThe S-EES sends the ACR management notification to the S-EAS to initiate ACT between the S-EAS and the T-EAS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.5\tSolution evaluation",
                            "text_content": "This solution addresses the requirements of KI#2.6 on the authorization between EESes.\nAuthorization token is used here for the authorization between EESes dynamically and authorized by the application user. No further impact is identified on the EES.\nWhen the EEC Context contans sensitive information on the AC and the EEC is the information owner, the ACR should be authorized by the AC/EEC. Authorization using the token can fulfil such need and provides more flexible and dynamic authorization mechanism when the application context contains sensitive AC/EEC information and needs to get the permission from the information owner.\nNOTE:\tHow to get the target EES's ID in the authorization token is not addressed in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.27\tSolution #27: Token-based solution for authorization between EESes",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.27.1\tSolution overview",
                            "text_content": "This solution addresses KI#2.6 on the authorization between EESes.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.27.2\tSolution details",
                            "text_content": "For the EDGE-9 interface between EESes, it is proposed to use the authorization token similar to the token-based solution for EEC authorization by the EES, specified in clause 6.2 of 3GPP TS 33.558 [4]. For token-based solution, OAuth 2.0 framework is used with client credentials grant type where the ECS assumes the role of authorization server. The token includes the T-EES FQDN, the S-EES FQDN, the ECS FQDN and optionally the EEC ID in the token claims.\nFor the case that the two EESes are registered to different ECSes, the following procedure similar to the procedure of multiple NRF deployment case defined in clause 13.4.1.1.3 of 3GPP TS 33.501 [7] is applied. An EES sends its access token requests to the ECS where it is registered as OAuth 2.0 client. The ECS authenticates the EES and can verify the input parameters in the access token request. After successful authentication and verification of the input parameters, the ECS can forward the access token request to another ECS. If an ECS receives an access token request for an EES that is not registered at this ECS, the ECS determines the target ECS where the EES is registered and forwards the access token request to the target ECS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.27.3\tSolution evaluation",
                            "text_content": "This solution addresses the requirements of KI#2.6 on the authorization between EESes.\nSince the ECS has the knowledge of source and target EES and also already assumes the role of authorization server for the token-based solution for EEC authorization by the EES, it can be stated that this solution re-uses existing mechanism.\nRegarding the resource server role, since the EES implements the role of resource server for the EEC authorization case specified in clause 6.3 of 3GPP TS 33.558 [4], there is no additional impact on the EES.\nRegarding the client role, the EES needs to implement the client role functionality.\nThe solution also addresses the case that the two EESes are registered to different ECSes, by using a mechanism similar to the procedure defined in clause 13.4.1.1.3 of 3GPP TS 33.501 [7].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.28\tSolution #28: Usage of randomly generated ticket to verify EEC provided IP address",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.28.1\tSolution overview",
                            "text_content": "This solution is for the key issue on EEC provided IP address verification.\nSince the core network assigned IP addresses are guessable values, a compromised EEC can spoof the IP address to learn the identifier of another UE. To prevent such attacks, this solution proposes to use a non-guessable parameter called ticket or nonce provided by the core network to the EEC and to check the mapping between the IP address and the ticket value in the UE ID API invocation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.28.2\tSolution details",
                            "text_content": "High-level overview of the solution is presented in figure 6.28.2-1 and steps are explained in detail below.\nThe figure depicts a network interface card (NIC) with a 10G Ethernet interface, which is used to verify the IP address of the device. The figure shows the EEC (Ethernet End-of-Line) interface, which is responsible for the physical layer of the network. The figure also includes a 10G Ethernet cable, which is used to connect the NIC to the network. The figure is labeled with the figure number \"6.28.2-1,\" which indicates that it is part of a larger set of figures that provide detailed information about network components.\nFigure 6.28.2-1: EEC provided IP address verification\nStep 1:\tIn the PDU session establishment, the SMF/UPF generates a random ticket value during UE IP address allocation procedure. The ticket value in addition to the private IP address is sent to the UE by SMF.\nStep 2:\tThe ticket value is sent to the PCF.\nStep 3:\tThe ticket value is sent to and stored in the BSF as part of the PDU session binding information.\nStep 4:\tThe EEC in the UE sends the ticket value and the IP address to the EES.\nStep 5:\tThe EES invokes the Nnef_UEId GET service operation using the ticket value and the IP address.\nStep 6:\tThe NEF sends the received ticket value to the BSF (Binding Support Function specified in TS 23.501) in Nbsf_Management_Discovery service operation.\nStep 7:\tThe BSF performs the verification by checking the mapping between the ticket value and the IP address.\nNOTE:\tIf the BSF cannot find a binding information having both requested IP address and ticket, it implies that the verification fails.\nStep 8:\tThe BSF sends the verification result to the NEF.\nStep 9:\tIf the verification is successful, then the NEF provides the AF specific GPSI to the EES.\nStep 10:\tThe EES sends the response to the EEC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.28.3\tSolution evaluation",
                            "text_content": "This solution addresses the potential security requirements with less impact on the network functions. The SMF will only need to generate a random ticket and send it to the UE and BSF, without needing to store any parameter.\nThis solution works under the assumption that the EEC can obtain 3GPP core network allocated IP address from lower layer.\nThis solution has an impact on the BSF for receiving and checking the ticket, impact on SMF for generating the ticket, and impact on PCF for forwarding the ticket to the BSF.\nNOTE:\tMore evaluation is needed, especially the impact on the various entities involved.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.29\tSolution #29: Authorizing the Service Consumer when Resolving an IP Address to a UE ID",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.29.1\tSolution overview",
                            "text_content": "The Nbsf_Management_Discovery service is used to resolve a UE IP Address to a SUPI. The solution describes how to enhance the service so that the BSF can verify that the consumer is authorized to obtain the UE ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.29.2\tSolution details",
                            "text_content": "This solution supports the 5G System to verify the IP address in the request to obtain a UE Identifier. In the proposed procedure, both the EEC and BSF perform a hash calculation. The UE's IP Address is an input to the hash calculation. Some additional inputs to the hash calculation are values that are known to the UE that hosts the EEC and the BSF, whch is not easily known when combined, or determined, by functions other than the UE that hosts the EEC (e.g. the SUPI of the UE). When the BSF is requested to provide information about the UE (e.g. the SUPI of the UE), the BSF may compare the result of the BSF's calculation and the hash value that was provided by the EEC of the UE. If the result of the BSF's calculation and the hash value that was provided by the EEC of the UE are the same, then the BSF can support the request. If the result of the BSF's calculation and the hash value that was provided by the EEC of the UE are not the same, then the BSF may not authorize the request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.29.3\tSolution evaluation",
                            "text_content": "This solution is not evaluated.\nThe figure depicts a visual representation of IP address verification using a hash function. It illustrates the process of checking the validity of an IP address by comparing it to a pre-defined set of hash values. The figure shows a series of squares, each representing a different IP address, and a hash value corresponding to that address. The squares are arranged in a grid pattern, with the hash values being displayed in the top row and the IP addresses in the bottom row. The figure is a clear and concise visual aid for understanding the concept of IP address verification and its application in network security.\nFigure 6.29.3-1: IP Address Verification Using Hash\nStep 1.\tThe EEC performs the authentication and authorization procedures with EES. Thereafter, the secured communication is established between the EEC and the EES.\nStep 2.\tThe EES generate a nonce such as a time stamp, and other related parameters.\nStep 3.\tThe nonce is sent to the EEC that will derive the shared credential with the same inputs as the network side, to be used for future use such as the API invocation between the EEC and the EES.\nStep 4.\tWhen the EEC is triggered by the AC to get the UE ID, the EEC invokes the API Nnef_UEId_Get to get the UE ID from EES. The request from the EEC includes the IP address and credential along with other parameters specified in 3GPP TS 23.558 [11]. The request can include an IP Address and the request can be to retrieve a UE ID that is associated with the IP Address.\nIn addition, the request includes a hash value. The EEC may determine the hash value using the following parameters as inputs:\n-\tthe private IP Address of the UE;\n-\tthe SUPI of the UE;\n-\tthe DNN and/or S-NSSAI of the PDU Session that the IP Address is associated with;\n-\tthe credential that is shared between the EEC and BSF.\nStep 5.\tThe EES may receive the request from the EEC. The EES may then act as an AF and invoke Nnef_UEId_Get request service of the NEF. The EES includes the IP Address that was provided by the EES as an input to the Nnef_UEId_Get request service invocation along with the nonce generated in the step 2.\nStep 6.\tThe NEF authorizes the AF request. If the authorization is not granted, the NEF replies to the EES with a Result value indicating authorization failure; otherwise the NEF proceeds with the following steps. The NEF determines corresponding DNN and/or S-NSSAI information: this may have been provided by the EES or is determined by the NEF based on the requesting EES Identifier and EES Provider Information.\nIf the NEF has received a Port Number in step 5, based on configuration, the NEF may recognize the address received is an IP address which is different from the actual private UE IP address assigned by 5GC, i.e. the UE is behind a NAT. If so, the NEF performs steps 7 to 10. Otherwise, steps 7 to 10 are skipped.\nStep 7.\tThe NEF uses the Nnrf_NFDiscovery service operation to obtain the address of the UPF implementing NAT functionality for the UE (public) IP address. The request includes the UE (public) IP address. The NEF may also include the DNN and S-NSSAI associated with the AF ID, as well as the IP domain.\nStep 8.\tThe NRF responds with a Nnrf_NFDiscovery response message including the UPF address of the UPF implementing NAT functionality for the UE (public) IP address.\nStep 9.\tThe NEF uses the Nupf_GetPrivateUEIP_Get service operation to request UE's (private) IP address from the UPF. The request includes the UE (public) IP address and Port Number, and optionally IP domain, DNN and S-NSSAI associated with the AF ID.\nStep 10.\tThe UPF responds with the Nupf_GetPrivateUEIP_Get response message including UE's IP address and optionally, the IP domain. If the UPF has applied a NAT functionality, the UE's IP address returned by the UPF is the private UE IP address.\nStep 11.\tWhen the NEF invokes the Nbsf_Management_Discovery service operation, the NEF provides the hash value and the nonce to the BSF.\nStep 12.\tThe BSF will determine the SUPI that is associated with IP Address, derive the credential using the same inputs as the EEC, and calculate the expected hash value. The calculation that is used to determine the expected hash value will be the same as the calculation that the EEC performed in step 4.\nThe BSF will compare the expected hash value and the hash value that was received.\nStep 13.\tIf the received hash value and the expected hash value are the same, then the BSF will respond to the NEF with a SUPI.\nIn step 13 if the received hash value and the expected hash value are different, then the BSF will respond to the NEF with an indication that request is denied because the IP Address is not associated with the UE that made the request.\nStep 14.\tThe NEF will then use the SUPI to query the UDM and receive the UE ID from the UDM. The NEF interacts with UDM to retrieve the AF specific UE Identifier via the Nudm_SDM_Get service operation. The request message includes SUPI and at least one of Application Port ID, MTC Provider Information or AF Identifier.\nStep 15.\tThe UDM responds to the NEF with an AF specific UE Identifier represented as an External Identifier for the UE which is uniquely associated with the Application Port ID, MTC provider Information and/or AF Identifier.\nStep 16.\tThe NEF will send the UE ID to the EES.\nStep 17.\tThe EES will send the UE ID to the EEC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.30\tSolution #30: Usage of existing public IP address to verify EEC provided IP address",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.30.1\tSolution overview",
                            "text_content": "This solution is for the key issue 2.7 on EEC provided IP address verification.\nThe EEC can spoof the IP address because the source IP address (i.e. UE private IP address) of the message is concealed by UPF via NAT, the EES only know the public IP address which can be used by different UEs. In NAT case, to differentiate different UEs using the same public IP address, the UPF will allocate a unique port number for each UE and the UPF stores the mapping between private IP address, public IP address and port number, the IP information knowed in each node in NAT case is showed in the following figure 6.30.1-1.\n\nFigure 6.30.1-1: NAT procedure\nTherefore, to verify the EEC provided IP address, this solution proposes to use the mapping between private IP address, public IP address and port number in the UPF to verify the mapping EEC provided IP address, EES obtained public IP address and port number based on the source IP address and port number of received UE ID API message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.30.2\tSolution details",
                            "text_content": "The procedure of the solution is presented in figure 6.30.2-1 and steps are explained in detail below.\nThe figure depicts a network interface card (NIC) that provides Ethernet address and port number verification through an existing public IP address and port number. This feature is essential for ensuring network security and proper communication between devices.\nFigure 6.30.2-1 EEC provided IP address verification via existing public IP address and port number\nStep 0.\tIf NAT is used, the UPF stores the mapping between private IP address, public IP address, port number.\nStep 1.\tThe EEC in the UE sends UE Identifier API request with the private IP address#1 to the EES as clause 8.6.5 of 3GPP TS23.558 [11].\nStep 2.\tEES obtains the UE public IP address#2, port number based on the sourse IP address and sourse port number of the IP data from UPF which include the UE Idenfifier API request.\nStep 3.\tEES requests to retrieve UE ID via the Nnef_UEId_Get service operation. The request message includes private IP address #1, public IP address#2, port number associated with the public IP address#2.\nSteps 4-5.\tNEF obtains the private IP address#3 from UPF via existing procedure specified in clause 4.15.10 (from step 3 to step 6) of 3GPP TS23.502 [9].\nStep 6.\tNEF verify if the private IP address#3 is equal to EEC provided IP address#1, if verification is successful, the NEF continues to obtain the AF specific GPSI via step 7 and step 8.\nSteps 7-8.\tNEF obtains AF specific GPSI via existing procedure specified in clause 4.15.10 (from step 7 to step 10) of 3GPP TS23.502 [9].\nSteps 9-10.\tNEF sends Nnef_UEId_Get response with AF specific GPSI to EES, and the EES send UE Identifier API request with AF specific GPSI to EEC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.30.3\tSolution evaluation",
                            "text_content": "This solution is not evaluated.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.31\tSolution #31: AKMA/GBA based verification of EEC provided IP address",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.31.1\tSolution overview",
                            "text_content": "This solution leverages the BSF to address key issue #2.7.\nIn specific, according to clause 4.15.10 and clause 5.2.13 of 3GPP TS 23.502 [9], the BSF maintains the mapping relationship between the IP address and SUPI of the UE.According to clause 4.5.2 of 3GPP TS 33.220 [6], the UE can obtain a random number from the BSF if it needs to do GBA based authentication mechanism.\nRefering to clause 6.1 of 3GPP TS 33.535 [8], the AAnF maintans the mapping relationship between the A-KID and the SUPI of the UE.\nTherefore, in this solution, A-KID and the random number in GBA scenarios are used as the verification information to enable the BSF to detect IP address spoofing attack.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.31.2\tSolution details",
                            "text_content": "The figure depicts a simplified IP address verification mechanism for edge computing scenarios, illustrating the process of checking the validity of IP addresses. It shows the IP address verification process, including the use of a lookup table, a check for the presence of a specific IP address, and the use of a lookup table to check for the presence of a specific IP address. The figure also includes a check for the presence of a specific IP address in the lookup table, and a check for the presence of a specific IP address in the lookup table. The figure also includes a check for the presence of a specific IP address in the lookup table, and a check for the presence of a specific IP address in the lookup table. The figure also includes a check for the presence of a specific IP address in the lookup table, and a check for the presence of a specific IP address in the lookup table. The figure also includes a check for the presence of a specific IP address in the lookup table, and a check for the presence of a specific IP address in the lookup table. The figure also includes a check for the presence of a specific IP address in the lookup table, and a check for the presence of a specific IP address in the lookup table. The figure also includes a check for the presence of a\nFigure 6.31.2-1: IP address verification mechanism for edge computing scenarios\nStep 1.\tEES receives the UE's IP address and the verification information from the EAS/UE/EEC. The verification information is the random number in GBA scenarios or A-KID in AKMA scenarios.\nStep 2.\tEAS/EES sends the UE's IP address and the verification information to the BSF.\nStep 3.\tIf A-KID is provided, the NEF gets SUPI of the UE from the AAnF. Otherwise, step 3 can be skipped.\nStep 4.\tThe NEF provides the UE's IP address, the random number, or SUPI of the UE to the BSF.\nStep 5.\tThe BSF locates the IP address allocated to the UE by the network based on the received SUPI.\n-\tIn specific, with the verification information of the random number, the BSF first locates the UE's IMPI based on the random number.\n-\tThen the BSF identifies the UE's SUPI based on the IMPI.\n-\tThe BSF compares the IP address allocated by the network with the received one.\nStep 6.\tIf the IP addresses are not identical, the BSF sends the error message to the NEF. Otherwise, the BSF sends SUPI of the UE to the NEF.\nStep 7.\tIf the NEF receives the SUPI from the BSF, the NEF gets an AF-specific UE ID from the UDM. Otherwise, step 7 can be skipped.\nStep 8.\tIf the NEF receives an error message from the BSF, the NEF forwards the error information to the EAS/EES in the response message. Otherwise, the NEF sends the response message containing the AF-specific UE ID to the EAS/EES.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.31.3\tSolution evaluation",
                            "text_content": "This solution is not evaluated.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.32\tSolution #32: KDF based verification of EEC provided IP address",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.32.1\tSolution overview",
                            "text_content": "This solution leverages the BSF to address key issue #2.7.\nIn specific, according to clause 4.15.10 and clause 5.2.13 of 3GPP TS 23.502 [9], BSF maintains the mapping relationship between the IP address and the SUPI. To generate verification information, the IP address and the SUPI are set as the inputs of the KDF. The output of the KDF is set as the verification information that enables BSF to detect IP address spoofing attack.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.32.2\tSolution details",
                            "text_content": "It is assumed that the BSF generates the network side verification information based on the locally stored IP address and SUPI of the UE.\nStep 1.\tEEC/UE sends the UE's IP address and the verification information to the EES directly or via the EAS. The verification information is generated based on the IP address and the SUPI of the UE. In specific, the IP address and the SUPI of the UE are set as the input of the KDF. And the output of the KDF is set as the verification information.\nStep 2.\tEES sends the UE's IP address and the verification information to the BSF via the NEF.\nStep 3.\tFor the BSF side, if the network side verification information is not identical to the one provided by the EEC/UE, BSF sends the error message to EES to indicate the IP address spoofing attack.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.32.3\tSolution evaluation",
                            "text_content": "This solution is not evaluated.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.33\tSolution #33: Verification of EEC provided IP address",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.33.1\tSolution overview",
                            "text_content": "This solution addresses the security requirement of key issue#2.7 on EEC provided IP address verification.\nThis solution proposes to use a PDU session ID for verifying the authenticity of assigned IP address.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.33.2\tSolution details",
                            "text_content": "The figure depicts a network interface card (NIC) with a 10G Ethernet interface, which is used to verify the IP address of a device. The figure shows the EEC (Ethernet End-of-Line) interface, which is responsible for transmitting the IP address to the network. The figure also includes a 10G Ethernet cable and a 10G Ethernet switch, which are essential components of the network infrastructure.\nFigure 6.33.2-1: EEC provided IP address verification\nStep 1:\tThe UE/EEC invokes UE Identifier API exposed by the EES. The request includes the CN assigned private IP address of the UE and the PDU session ID.\nStep 2:\tOn receiving the UE Identifier API request, the EES invokes Nnef_UEId_Get service operation for translating the UE's Private IP address to its UE ID. EES includes the received IP Address and PDU Session ID in the request message.\nStep 3:\tThe NEF invokes the Nudm_SDM_Get request and sends the corresponding SUPI in the request.\nStep 4:\tIn Nudm_SDM_Get response the UDM sends the AF specific UE identifier and the PDU session ID(s) of the SUPI.\nStep 5:\tThe NEF verifies whether the received PDU Session ID from EES is present in the list of PDU session ID(s) from the UDM.\nStep 6-7:\tIf the verification is successful, then the NEF provides the AF specific UE Identifier to the EES in Nnef_UEId_Ger response. Then the EES forwards the AF specific UE Identifier to the UE/EEC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.33.3\tSolution evaluation",
                            "text_content": "This solution is not evaluated.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.34\tSolution #34: Verification of EEC provided IP address using access token",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.34.1\tSolution overview",
                            "text_content": "This solution addresses the security requirement of key issue#2.7 on EEC provided IP address verification.\nThis solution proposes to use an access token for mapping with the assigned IP address. This access token is provided by the ECS as specified in 3GPP TS 33.558 [4].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.34.2\tSolution details",
                            "text_content": "The figure depicts a network interface card (NIC) with a 10G Ethernet interface, which is used to verify the IP address of the device. The figure shows the EEC (Ethernet End-of-Line) interface, which is responsible for the physical connection between the NIC and the network. The figure also includes a 10G Ethernet cable, which is used to connect the NIC to the network. The figure is labeled with the figure number \"6.34.2-1,\" which indicates that it is part of a larger set of figures that provide detailed information about network components and their connections.\nFigure 6.34.2-1: EEC provided IP address verification\nStep 1:\tThe UE/EEC invokes UE Identifier API exposed by the EES. The request includes the CN assigned private IP address of the UE and the access token.\nStep 2:\tOn receiving the UE Identifier API request, the EES verifies the access token and then invokes Nnef_UEId_Get service operation for translating the UE's Private IP address to its UE ID. EES includes the received IP Address in the request message.\nStep 3:\tThe NEF invokes the Nudm_SDM_Get request and sends the corresponding SUPI in the request.\nStep 4-5:\tIn Nudm_SDM_Get response the UDM sends the AF specific UE identifier and UE IDs of the received SUPI. The NEF provides the AF specific UE Identifier and UE IDs to the EES in Nnef_UEId_Get response.\nStep 6:\tThe EES then verifies whether the UE ID received in the access token from EEC and from the NEF are the same.\nStep 7:\tIf the verification is successful, then the EES provides the AF specific UE Identifier to the EEC in UE Identifier API response.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.34.3\tSolution evaluation",
                            "text_content": "This solution is not evaluated.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tConclusions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tConclusions for Key Issue #2.4",
                    "description": "",
                    "summary": "",
                    "text_content": "Solution #20 that proposes to reuse the TLS to solve key issue #2.4 is endorsed for conclusion.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tConclusions for Key Issue #2.3",
                    "description": "",
                    "summary": "",
                    "text_content": "Solution#18 is endorsed for normative phase for the mutual TLS authentication, and authorization based on local policy between V-ECS and H-ECS.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.3\tConclusions for Key Issue #2.5",
                    "description": "",
                    "summary": "",
                    "text_content": "Key issue #2.5 requires that the Edge Enabler Client (EEC) should be able to provide mutual authentication with the Application Client over EDGE-5 interface, and the EEC should be able to determine whether Application client is authorized to access EEL service offered by EEC.\nIt is concluded that UE could handle the Authentication and Authorization between AC and EEC base on local policy, security mechanisms for authentication and authorization between AC and EES are left to implementation.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.4\tConclusions for Key Issue #1.1",
                    "description": "",
                    "summary": "",
                    "text_content": "It is agreed in 3GPP TR 23.700-48 [2] to support authorizing the HR-local traffic routing to access EHE in the PDU session. Solution #12 that proposes to reuse secondary authentication to solve key issue #1.1 is endorsed for conclusion. Hence, no normative work is required on Key issue #1.1.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.5\tConclusions for Key Issue #2.1",
                    "description": "",
                    "summary": "",
                    "text_content": "It is concluded to reuse authentication and authorization mechanism specified in 3GPP TS 33.558 [4] to realize authorization and mutual authentication between UE and ECS/EES.\nServer side certificate-based TLS authentication is mandatory supported.\nIt is concluded to clarify in the normative work that ECS/EES can retrieve the GPSI from the core network if necessary and the ECS/EES should not trust the GPSI received from the EEC/UE.\nNOTE 1:\tIf only Server side certificate-based TLS authentication is performed, it is left to implementation on which services will be provided by the ECS/EES.\nNOTE 2:\tToken-based solutions (e.g. Solution #25 for EEC/UE authentication by the ECS/EES) are left to implementation.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.6\tConclusions for Key Issue#2.2",
                    "description": "",
                    "summary": "",
                    "text_content": "It is concluded that the negotiation mechanism will re-use existing TLS v1.3. If the UE has information about the capability (authentication method) of the server in the ECS/EES configuration information, then the EEC/UE can use this information in the negotiation. The ECS configuration information with the information on the authentication method can be received as specified in 3GPP TS 23.558 [11]. The EES configuration information with the information on the authentication method can be received from the ECS. Further optimization regarding having knowledge about the capability, such as UE storing the selected algorithm from past negotiation results, can be left to EEC/UE implementation.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.7\tConclusions for Key Issue #2.6",
                    "description": "",
                    "summary": "",
                    "text_content": "Solution #21 that proposes to use local policy for authorization as described in 3GPP TS 33.501 [7] clause 13.3.0 between EESes is endorsed for conclusion. Hence, no new mechanism is required.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.8\tConclusions for Key Issue #1.2",
                    "description": "",
                    "summary": "",
                    "text_content": "It is proposed to reuse the DNS over (D)TLS specified in Annex P of 3GPP TS33.501 [7] to protect the discovery message between UE and V-EASDF.\nHence, it is required to clarify in Annex T of 3GPP TS33.501 [7] that the UE and V-EASDF need to support DNS over (D)TLS, and if the core network is used to configure the security information used for (D)TLS protection to the UE as specified in Annex P of 3GPP TS33.501 [7], the V-SMF as the specific NF of the core network is used to provide the security information of V-EASDF to the UE directly (i.e. LBO case), or via H-SMF (i.e. case where HR SBO is authorized by HPLMN), during the PDU session establishment or during modification procedure when the V-SMF determines to use a new V-EASDF for EAS discovery. The V-SMF can be preconfigured with the V-EASDF security information, or fetch the information from the V-EASDF.\nNOTE:\tThe security information of V-EASDF provided to the UE is only related with the VPLMN parameter.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.9\tConclusions for Key Issue #2.7",
                    "description": "",
                    "summary": "",
                    "text_content": "There is no agreement for this key issue in the present document.\n\n\n\n",
                    "tables": [
                        {
                            "description": "",
                            "table number": 6,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        }
    ]
}