{
    "document_name": "33887-i01.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Report has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\t\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\t\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\t\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\t\tindicates that something is possible\ncannot\t\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\t\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\t\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The objectives of the present document are to identify key issues, potential security and privacy requirements and solutions with respect to:\n-\tWhether and how to identify, authenticate and authorize the Authenticable Non-3GPP devices behind the Residential Gateway (RG) connecting to the network.\n-\tWhether and how to identify, authenticate and authorize the 3GPP devices (UE or N5CW devices) behind the Residential Gateway (RG) connecting to the network.\n-\tSecurity aspects of supporting slice in 5WWC.\n-\tWhether and how the security aspects for UE TNAP mobility can be supported in the 5GS without performing the full authentication.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TR 23700-17 \"Study on the support for 5WWC, Phase 2\".\n[3]\t3GPP TR 33.316 \"Wireless and wireline convergence access support for the 5G System (5GS)\".\n[4]\t3GPP TS 33.501: \"Security architecture and procedures for 5G System\".\n[5]\tIETF RFC 5448: \" Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')\".\n[6]\tIEEE Std 802.11™-2020 Part 11: \"Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications\".\n[7]\t3GPP TS 23.502: \"Procedures for the 5G System\".\n[8] \tIETF RFC 6696: \"EAP Extensions for the EAP Re-authentication Protocol (ERP)\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in TR 21.905 [1], in TS 33.501 [4] and in TR 23.700-17 [2] are applied.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tSymbols",
                    "description": "",
                    "summary": "",
                    "text_content": "Void.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.3\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in TR 21.905 [1], in TS 33.501 [2] and in TR 23.700-17 [2] are applied.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tAssumptions",
            "description": "The figure depicts a non-roaming architecture for 5G Core Network, highlighting the use of non-3GPP access points for mobility within trusted non-roaming zones. The architecture is designed to ensure reliable and secure communication, with redundancy paths and failover mechanisms to maintain connectivity in the event of network failures.\nFigure 4.1-1: Non-roaming architecture for 5G Core Network with mobility within trusted non-3GPP access\nFigure 4.1-1 shows the non roaming architecture for 5G core network for mobility use case where the target trusted non-3GPP Access Point and source Trusted Non-3GPP Access Point are connected to the same Trusted Non-3GPP Gateway Function (TNGF).\nIn the present document, when UE switches from one TNAP (source) to another TNAP (destination) within the same TNGF, full authentication is not performed.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "5\tKey issues",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tKey issue #1: Authentication of AUN3 device behind RG and supporting EAP",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.1.1\tKey issue details",
                            "text_content": "The AUN3 device is a non-3GPP device that does not support NAS over non-3GPP access, but it can be identified and/or authenticated by 5GC. For example, an AUN3 device may support EAP-AKA', or does not support EAP based authentication but has a subscription with the 5GC.\nThis key issue considers AUN3 devices supporting EAP based authentication.\nAUN3 devices supporting EAP can be connected to RG via WLAN or wireline. RG is connected to 5GC via 3GPP access or W-AGF as defined in TS 23.316 [3] clause 4.10. Currently, authentication of these AUN3 devices is not sufficiently defined in 3GPP. I.e., how AUN3 devices connected with RG over Wi-Fi are authenticated and how the interface between AUN3 devices and RG is protected.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.2\tThreats",
                            "text_content": "If authentication of AUN3 device behind RG is not properly defined, an attacker may be able to impersonate an AUN3.\nWhen AUN3 devices connect to the RG over Wi-Fi, the session between AUN3 devices and the RG is not protected. Due to this, MitM can intercept the AUN3 device's communication.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.3\tPotential security requirements",
                            "text_content": "5GC should be able to authenticate the AUN3 device behind RG.\nThe 5GS should provide a means for the AUN3 device and RG to get a shared key that could be used to provide protection of the interface between them.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.2\tKey issue #2: Security aspect of slice information exposure of N3IWF/TNGF to UE",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tKey issue details",
                            "text_content": "The solutions to KI #2 enable the selection of TNGF/N3IWF that support the S-NSSAI(s) required by the UE, as defined in TR 23700-17 [2]. Many solutions are presented, and one of the categories is:\n-\tUE is able to discover the slice of TNGF/N3IWF and select TNGF/N3IWF accordingly.\nExposing the S-NSSAI information from the network nodes (TNGF/N3IWF) to any UE will cause privacy issues and should be studied.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tThreats",
                            "text_content": "If UE and network node exchanges interested slice information without any protection, then the MitM will be able to intercept what slices/services UE is interested in. Therefore, it will leak the privacy information of the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.3\tPotential security requirements",
                            "text_content": "The 5G system shall provide means to protect the slice information associated with the initial UE communication with the N3IWF/TNGF node.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tKey issue #3: Security aspect of slice information exposure of N3IWF/TNGF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tKey issue details",
                            "text_content": "The solutions to KI #2 enable the selection of TNGF/N3IWF that support the S-NSSAI(s) required by the UE, as defined in TR 23.700-17 [2]. Many solutions are presented, and one of the categories is:\n-\tThe UE chooses the default TNGF/N3IWF, and the network selects the appropriate TNGF/N3IWF based on UE slice requirements and relocates the TNGF.\nTR 23.700-17 [2] includes a few solutions, for example, solutions 10 and 11, include the IKE v2 procedure enhancement to relocate the TNGF/N3IWF. The security aspects of the solutions in this category should be studied.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.2\tThreats",
                            "text_content": "In case the TNGF/N3IWF relocation information is sent to the UE without protection, for example, the target SSID, the information may be tampered during the transfer. Even though the SSID is publicly known, if the target SSID is tampered, the UE may continue to connect to an unappropriated TNGF/N3IWF and the system may be in the loop to relocate the TNGF/N3IWF for the UE. In this case, the UE will suffer a DoS Attack.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.3\tPotential security requirements",
                            "text_content": "The TNGF/N3IWF relocation information shall be securely sent to the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.4\tKey issue #4: Security aspect of TNAP mobility without full authentication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.4.1\tKey issue details",
                            "text_content": "Mobility between two TNAPs within the same trusted Non-3GPP Access Network Gateway Function(TNGF) is not supported in 3GPP currently. For example, when UE moves between two nearby or overlapping TNAP1 and TNAP2, the connectivity will break. Therefore, UE services will be interrupted. The UE needs to reconnect, go through another authentication procedure to continue the service even though the second non-3GPP access connects to the same 5GC.\nThere could be some potential security solutions where UE switches the TNAP1 to TNAP2 without breaking the connectivity. However, the security aspects of optimizations of inter-TNAP mobility were never studied in SA3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.2\tThreats",
                            "text_content": "NA.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.3\tPotential security requirements",
                            "text_content": "5GS should support a mechanism for communication between the UE and TNAP/TNGF to establish security with a TNAP without performing full authentication when the UE switches from another TNAP within the same TNGF.\nWhile switching from one TNAP to another TNAP within the same TNGF, the interface between UE and the new TNAP shall be confidentiality, integrity, and replay protected.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tKI #5: Authentication of UE connecting to RG using NSWO procedure",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tKey issue details",
                            "text_content": "In clause 7B.4 of TS 33.501, UE behind RG can connect to 5GC via TNGF in trusted Non-3GPP access or N3IWF in untrusted Non-3GPP access procedures with the entire wireline access treated as part of the trusted or untrusted Non-3GPP access.\nIn TS 23.501 [2] clause 4.2.15, UE is allowed to use 5G credentials based on NSWO to authenticate to the 5GC to first obtain a local IP address and then to use untrusted Non-3GPP access to register to the 5GC.\nSimilarly, when UE is behind RG, the UE should also be able to use NSWO to first authenticate to 5GC to obtain a local IP address before using the untrusted Non-3GPP access to register with 5GC.\nEven when UE does not use untrusted Non-3GPP access to register, it is still beneficial for UE behind RG to use 5G credentials to authenticate to 5GC, since it allows operators to identify UE behind RG and then to offer enhanced services (e.g. Wi-Fi speed increase) to the UE.\nThis key issue is to allow UE behind RG to be authenticated by 5GC using NSWO procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tSecurity threats",
                            "text_content": "If the 5GC cannot authenticate UE connecting to RG, the 5GC may provide service to unauthorized devices behind RG.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tPotential requirements",
                            "text_content": "5GS shall support authentication of UE behind RG using NSWO procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tProposed solutions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.0\tMapping of solutions to key issues",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 6.0-1: Mapping of solutions to key issues\n\n",
                    "tables": [
                        {
                            "description": "Table 6.0-1: Mapping of solutions to key issues",
                            "table number": 3,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.1\tSolution #1: EAP_AKA prime based authentication for AUN3 devices",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1.1\tIntroduction",
                            "text_content": "This solution addresses the authentication of AUN3 devices based on the EAP_AKA prime method.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.2\tSolution details",
                            "text_content": "The figure depicts a simplified representation of EAP-AKA prime based AUN3 authentication, which is a key component in the authentication process of the EAP-AKA protocol. The figure shows the EAP-AKA protocol, which is a key component in the authentication process of the EAP-AKA protocol. The figure illustrates the EAP-AKA protocol, which is a key component in the authentication process of the EAP-AKA protocol. The figure shows the EAP-AKA protocol, which is a key component in the authentication process of the EAP-AKA protocol. The figure shows the EAP-AKA protocol, which is a key component in the authentication process of the EAP-AKA protocol. The figure shows the EAP-AKA protocol, which is a key component in the authentication process of the EAP-AKA protocol. The figure shows the EAP-AKA protocol, which is a key component in the authentication process of the EAP-AKA protocol. The figure shows the EAP-AKA protocol, which is a key component in the authentication process of the EAP-AKA protocol. The figure shows the EAP-AKA protocol, which is a key component\nFigure 6.1.2.1-1: EAP-AKA prime based AUN3 authentication\n1a.\tThe AUN3 device establishes a WLAN connection with the WLAN Access Network (AN), using procedures specified in IEEE 802.11.\n1b, 1c.\tL2 connection and EAP identity retrieval are performed. AUN3 device sends back EAP Response/Identity message. The AUN3 device uses SUCI in NAI format (i.e., username@realm format as specified in clause 28.7.3 of TS 23.003) or 5G-GUTI.\n2a, 3a, 3b, 3c.\tIf the RG is an FN-RG, the FN-RG sends the EAP response/Identity including the NAI to the W-AGF. The W-AGF creates a registration request on behalf of the AUN3 device with a new indication that the registration is on behalf of an AUN3 device where protection is required for the interface between the AUN3 device and RG. The W-AGF selects the AMF/SEAF. The W-AGF sends to the AMF/SEAF a registration request on behalf of the AUN3 device. The registration request includes the NAI SUCI, wireline network name if available, and the new indication. The same message content is forwarded from AMF to AUSF and then from AUSF to UDM.\n2b, 3b, 3c.\tIf the RG is a 5G-RG, the 5G-RG sends a NAS Registration Request message to the AMF, including the received SUCI and the new indicator for encryption required for AUN3 device.\n4.\tAuthentication procedure for EAP-AKA' is performed as defined in the clause 6.1.3.1 of TS 33.501 [4].\n5.\tBased on the indication in step 3, AMF derives the WAGF key.\n6.\tThe AMF sends NAS Security Mode Command mode and provides the WAGF key (KWAGF') to W-AGF.\n7.\tW-AGF/RG derive the KAUN3 as PMK key from the WAGF key (KWAGF').\nNote:\tWhether the PMK is derived by RG and W-AGF is out if 3GPP scope.\n8.\tRG and AUN3 device will derive WLAN keys from PMK.\n9.\tThe AUN3 device performs a 4-way handshake to establish a secure connection with the WLAN AN.\nWhen deriving the keys KWAGF' for AUN3 device not supporting NAS, from KAMF then the following parameters should be used input S to the KDF.\n-\tFC = 0x<to be defined>\n-\tP0 = Device distinguisher (shall be set to 0x01 for AUN3 device, others it will be 0x00)\n-\tL0 = length of Device distinguisher (i.e. 0x00 0x04)\n- \tP1 = Access type distinguisher\n-\tL1 = length of Access type distinguisher (i.e. 0x00 0x01)\nThe access type distinguisher shall be set to the value for 'non-3GPP (0x02) when deriving KWAGF'.\nWhen deriving a KAUN3 key from KWAGF' the following parameters shall be used to form the input S to the KDF.\n- \tFC = 0x<to be defined>\n-\t P0 = Usage type distinguisher\n-\tL0 = length of Usage type distinguisher (i.e. 0x00 0x01)\nUsage type distinguisher value is set to 0x01.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.3\tEvaluation",
                            "text_content": "This solution meets both the requirements mentioned in the KI1 for the AUN3 device that support 5G key hierarchy. i.e.\n-\t5GC should be able to authenticate the AUN3 device behind RG.\n-\tThe 5GS should provide a means for the AUN3 device and RG to get a shared key that could be used to provide protection of the interface between them.\nImpact on the NFs:\nAUSF/UDM: New indication received for AUN3 devices and select authentication algorithm accordingly.\nAMF: generates the keys and provides the same to RG/W-AGF.\nRG/W-AGF: receives new key material from AMF and then derives the PMK.\nUE: derive the new keys.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2\tSolution #2: EAP base authentication for AUN3 devices behind RG in PLMN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tIntroduction",
                            "text_content": "An AUN3 device connecting to RG in a PLMN is registered to the 5GC by the 5G-RG or W-AGF and is authenticated by 5GC using EAP-AKA', as specified in RFC 5448 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tSolution details",
                            "text_content": "The figure depicts a 5G network with various components such as base stations (gNB), user equipment (UE), and scatterers. The diagram illustrates the signal propagation in a 5G network, highlighting the multi-path signal path and beamforming techniques to mitigate interference. The fiber-optic backbone architecture is shown in Figure 4, with core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are depicted in dashed lines, ensuring failover reliability. The layered design aligns with SDN principles.\nFigure 6.2.2-1\n1. The AUN3 device attempts to establish a layer 2 connection with the RG either via Ethernet or Wi-Fi. If the layer 2 connection is based on Ethernet, steps 13-14 are skipped.\n2.\tThe RG initiates the EAP authentication procedure by sending an EAP request/Identity to the AUN3 device in a layer frame (e.g. EAPOL).\n3. The AUN3 device sends back an EAP response/Identity including its Network Access Identifier (NAI) in the form of username@realm. The username part of the NAI may be encrypted if the AUN3 device supports SUPI protection\n4a-4b.\tIf the RG is an FN-RG, the FN-RG sends the EAP response/Identity including the NAI to the W-AGF. The W-AGF constructs a SUCI from NAI-based SUPI using NULL scheme and sends a NAS Registration Request message to the AMF, including the SUCI and AUN3 device indicator.\n4c. If the RG is a 5G-RG, the 5G-RG constructs a SUCI from the NAI-based SUPI of the AUN3 device, and sends a NAS Registration Request message to the AMF, including the SUCI and an AUN3 device indicator.\n5.\tThe AMF/SEAF selects the AUSF based on the SUCI in the received registration request and sends a Nausf_UEAuthentication_Authenticate Request message to the AUSF. It contains the SUCI of the AUN3 device, and an AUN3 device indicator.\n6. The AUSF sends a Nudm_UEAuthentication_Get Request to the UDM. It contains the SUCI of the AUN3 device and the AUN3 device indicator.\n7. The UDM invokes the SIDF to map the SUCI to the SUPI and selects an authentication method based on the SUPI. When the \"username\" part of the SUPI is \"anonymous\" or omitted, the UDM may select an authentication method based on the “realm” part of the SUPI, the AUN3 device indicator, a combination of the \"realm\" part and the AUN3 device indicator, or the UDM local policy.\n8. The UDM sends a Nudm_UEAuthentication_Get Response to the AUSF, which contains the SUPI of the AUN3 device and an indicator of the selected EAP-AKA'.\n9.\tThe AUSF and the AUN3 device perform EAP-AKA'. Storage and procession of credentials for EAP-AKA' is described in clause 6 of TS 33.501 [4].\n10.\t If the EAP authentication between the AUSF and the AUN3 device is completed successfully, the AUSF sends to the AMF/SEAF an EAP-Success message along with the SUPI and the MSK in a Nausf_UEAuthentication_Authenticate Response message.\n11a-11b.\tIf steps 4a-4b is executed, the AMF/SEAF sends to the W-AGF the EAP-Success message and the MSK in an Authentication Result message. The W-AGF sends to the FN-RG the EAP-Success message and the MSK in AAA message.\n11c. If step 4c is executed, the AMF/SEAF sends to the 5G-RG the EAP-Success message and the MSK in an Authentication Result message.\n12.\t The RG sends to the AUN3 device the EAP-Success message in a layer 2 frame.\n13a-13b. The AUN3 device and the RG use the first 256-bit of the MSK as the PMK, from which the WLAN keys are derived.\n14. The AUN3 and the RG performs four-way handshaking to establish WLAN secure connection.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tEvaluation",
                            "text_content": "This solution meets the requirement that an AUN3 device shall be able to authenticate to the 5GC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tSolution #3: EAP base authentication for AUN3 devices behind RG in SNPN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tIntroduction",
                            "text_content": "This solution defines an authentication procedure for AUN3 devices behind RG (5G-RG or FN-RG) in SNPN. It differs from Annex O of TS 33.501 [4] in that:\n1. it allows 5G-RG to register AUN3 device to 5GC on its behalf, while in Annex O, it is always the W-AGF that registers N5GC device to the 5GC.\n2. it allows the AUN3 device to connect to RG via Wi-Fi based on the MSK from the EAP authentication between the AUN3 device and the AUSF. In Annex O, the N5GC device connects to the RG via wireline (e.g. Ethernet) and MSK is not sent back by the AUSF to the RG to facilitate Wi-Fi four-way handshaking.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tSolution details",
                            "text_content": "The figure depicts a 3D representation of a 5G network, illustrating the signal propagation in a 5G network. It shows how signals reflect off buildings (NLOS) and combine at the receiver. Key components include the base station (gNB), user equipment (UE), and scatterers. The diagram highlights beamforming techniques to mitigate interference.\nFigure 6.3.2-1\n1. The AUN3 device attempts to establish a layer 2 connection with the RG either via Ethernet or Wi-Fi. If the layer 2 connection is based on Ethernet, steps 13-14 are skipped.\n2.\tThe RG initiates the EAP authentication procedure by sending an EAP request/Identity to the AUN3 device in a layer frame (e.g. EAPOL).\n3. The AUN3 device sends back an EAP response/Identity including its Network Access Identifier (NAI) in the form of username@realm. The username part of the NAI may be encrypted if the AUN3 device supports SUPI protection. Otherwise, the anonymous NAI can be used if the EAP method supports subscription identifier privacy\n4a-4b.\tIf the RG is an FN-RG, the FN-RG sends the EAP response/Identity including the NAI to the W-AGF. The W-AGF constructs a SUCI from NAI-based SUPI using NULL scheme and sends a NAS Registration Request message to the AMF, including the SUCI and AUN3 device indicator.\n4c. If the RG is a 5G-RG, the 5G-RG constructs a SUCI from the NAI-based SUPI of the AUN3 device, and sends a NAS Registration Request message to the AMF, including the SUCI and an AUN3 device indicator.\n5.\tThe AMF/SEAF selects the AUSF based on the SUCI in the received registration request and sends a Nausf_UEAuthentication_Authenticate Request message to the AUSF. It contains the SUCI of the AUN3 device, and an AUN3 device indicator.\n6. The AUSF sends a Nudm_UEAuthentication_Get Request to the UDM. It contains the SUCI of the AUN3 device and the AUN3 device indicator.\n7. The UDM invokes the SIDF to map the SUCI to the SUPI and selects an authentication method based on the SUPI. When the \"username\" part of the SUPI is \"anonymous\" or omitted, the UDM may select an authentication method based on the “realm” part of the SUPI, the AUN3 device indicator, a combination of the \"realm\" part and the AUN3 device indicator, or the UDM local policy.\n8. The UDM sends a Nudm_UEAuthentication_Get Response to the AUSF, which contains the SUPI of the AUN3 device and an indicator of the selected authentication method. EAP-AKA' as specified in RFC 5448 [5] or other key generating EAP method can be selected.\n9.\tThe AUSF and the AUN3 device perform EAP authentication based on the selected authentication method. Storage and processing of credentials for EAP authentication method is described in Annex I of TS 33.501 [4].\n10.\t If the EAP authentication between the AUSF and the AUN3 device is completed successfully, the AUSF sends to the AMF/SEAF an EAP-Success message along with the SUPI and the MSK in a Nausf_UEAuthentication_Authenticate Response message.\n11a-11b.\tIf steps 4a-4b is executed, the AMF/SEAF sends to the W-AGF the EAP-Success message and the MSK in an Authentication Result message. The W-AGF sends to the FN-RG the EAP-Success message and the MSK in AAA message.\n11c. If step 4c is executed, the AMF/SEAF sends to the 5G-RG the EAP-Success message and the MSK in an Authentication Result message.\n12.\t The RG sends to the AUN3 device the EAP-Success message in a layer 2 frame.\n13a-13b. The AUN3 device and the RG use the first 256-bit of the MSK as the PMK, from which the WLAN keys are derived.\n14. The AUN3 and the RG performs four-way handshaking to establish WLAN secure connection.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.3\tEvaluation",
                            "text_content": "This solution meets the requirement that an AUN3 device connecting to RG shall be able to authenticate to 5GC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tSolution #4: EAP base authentication for AUN3 devices behind RG in SNPN by AAA server",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4.1\tIntroduction",
                            "text_content": "This solution addresses KI#1 by authenticating AUN3 devices behind RG (5G-RG or FN-RG) in SNPN using an AAA server as the credential holder.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.2\tSolution details",
                            "text_content": "The figure depicts a 5G network with various components such as base stations (gNB), user equipment (UE), and scatterers. The diagram illustrates the signal propagation in a 5G network, highlighting the multi-path signal path and beamforming techniques to mitigate interference. The fiber-optic backbone architecture is shown, with core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are depicted in dashed lines, ensuring failover reliability. The layered design aligns with SDN principles.\nFigure 6.4.2-1\n1. The AUN3 device attempts to establish a layer 2 connection with the RG either via Ethernet or Wi-Fi. If the layer 2 connection is based on Ethernet, steps 13-14 are skipped.\n2.\tThe RG initiates the EAP authentication procedure by sending an EAP request/Identity to the AUN3 device in a layer frame (e.g. EAPOL).\n3. The AUN3 device sends back an EAP response/Identity including its Network Access Identifier (NAI) in the form of username@realm. The username part of the NAI may be encrypted if the AUN3 device supports SUPI protection. Otherwise, the anonymous NAI can be used if the EAP method supports subscription identifier privacy.\n4a-4b.\tIf the RG is an FN-RG, the FN-RG sends the EAP response/Identity including the NAI to the W-AGF. The W-AGF constructs a SUCI from NAI-based SUPI using NULL scheme and sends a NAS Registration Request message to the AMF, including the SUCI and AUN3 device indicator.\n4c. If the RG is a 5G-RG, the 5G-RG constructs a SUCI from the NAI-based SUPI of the AUN3 device, and sends a NAS Registration Request message to the AMF, including the SUCI and an AUN3 device indicator.\n5.\tThe AMF/SEAF selects the AUSF based on the SUCI in the received registration request and sends a Nausf_UEAuthentication_Authenticate Request message to the AUSF. It contains the SUCI of the AUN3 device, and an AUN3 device indicator.\n6. The AUSF sends a Nudm_UEAuthentication_Get Request to the UDM. It contains the SUCI of the AUN3 device and the AUN3 device indicator.\n7. The UDM invokes the SIDF to map the SUCI to the SUPI and selects an authentication method based on the SUPI. When the \"username\" part of the SUPI is \"anonymous\" or omitted, the UDM may select an authentication method based on the “realm” part of the SUPI, the AUN3 device indicator, a combination of the \"realm\" part and the AUN3 device indicator, or the UDM local policy.\n8. The UDM sends a Nudm_UEAuthentication_Get Response to the AUSF, which contains the SUPI of the AUN3 device and an indicator of the selected authentication method.\n9. Based on the indication from the UDM, the AUSF shall select an NSSAAF as defined in TS 23.501 [2] and initiate a Nnssaaf_AIWF_Authenticate service operation towards that NSSAAF as defined in clause 14.4.2.\n10. The NSSAAF shall select AAA Server based on the domain name corresponding to the realm part of the SUPI. The NSSAAF shall perform related protocol conversion and relay EAP messages to the AAA Server.\n11.\tThe AAA and the AUN3 device perform EAP authentication based on the selected authentication method. Storage and processing of credentials for EAP authentication method is described in Annex I of TS 33.501 [4].\n12. After successful authentication, an EAP Success message, the MSK and the SUPI (i.e., the AUN3 identifier that is used for the successful EAP authentication) shall be provided from the AAA Server to the NSSAAF.\n13. The NSSAAF returns the EAP Success message, the MSK and the SUPI to the AUSF using the Nnssaaf_AIWF_Authenticate service operation response message.\n14.\tThe AUSF sends to the AMF/SEAF the EAP-Success message along with the SUPI and the MSK in a Nausf_UEAuthentication_Authenticate Response message.\n15a-15b.\tIf steps 4a-4b is executed, the AMF/SEAF sends to the W-AGF the EAP-Success message and the MSK in an Authentication Result message. The W-AGF sends to the FN-RG the EAP-Success message and the MSK in AAA message.\n15c. If step 4c is executed, the AMF/SEAF sends to the 5G-RG the EAP-Success message and the MSK in an Authentication Result message.\n16.\t The RG sends to the AUN3 device the EAP-Success message in a layer 2 frame.\n17a-17b. The AUN3 device and the RG use the first 256-bit of the MSK as the PMK, from which the WLAN keys are derived.\n18. The AUN3 and the RG performs four-way handshaking to establish WLAN secure connection.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.3\tEvaluation",
                            "text_content": "This solution meets the requirement that an AUN3 device shall be able to authenticate to 5GC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tSolution #5: TNAP mobility solution with rand",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tIntroduction",
                            "text_content": "This solution addresses the security solution of TNAP mobility defined in KI#4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tSolution details",
                            "text_content": "The TNAP (Telecommunication Network Access Point) mobility procedure is depicted in Figure 6.5.2-1, illustrating the steps taken by the network access point (NAP) to ensure seamless connectivity for mobile users. The figure shows the NAP's location, signal strength, and connectivity status, as well as the steps taken to maintain these conditions. The TNAP's mobility procedure is crucial for ensuring that mobile users can access the internet and other network services, regardless of their location.\nFigure 6.5.2-1: TNAP mobility procedure\nUE is connected to TNAP#1 via the procedure defined in TS 33.501 figure 7A.2.1-1. Once authenticated, TNGF sends the reauth Id to UE over the protected interface. Reauth Id can be a generated as <PLMNID><TNGF_ID> <Temp Id>.\nNote 1: TNGF Id could be TNGF address (like fqdn)already defined by SA2.\n2, 3.\tUE decides to move from TNAP#1 to TNAP#2 and creates an L2 connection with TNAP#2.\n4, 5, 6.\tTNAP#2 sends the L2 EAP-Request for Identity towards the UE and the UE responds back with an L2 EAP-Response with Identity and a TNAP_Mobility_Indication flag. The TNAP2 forwards the EAP response with reauth Id and the TNAP_Mobility_Indication flag towards TNGF.\n7,8. \t Based on the reauth Id, TNFG identifies the UE and retrieves the context and TNAP_Mobility_Indication, the TNGF checks if the stored context in step 1 is valid and then derives the TNAP' keys as described in clause 6.5.2.2 of the present document. The TNGF responds back to TNAP#2 with the generated key RAND value and MAC for the RAND value. Message Authentication Code (MAC) is derived by using the TNGF key stored in TNGF. In TNAP#2, the newly received TNAP key is considered as Pairwise Master Key (PMK).\n9, 10,11.\tThe TNAP#2 sends an EAP-notification back to the UE with the RAND value along with MAC. If MAC validation is successful then based on the RAND value, UE derives the keys. A 4-way handshake is executed (see IEEE 802.11) which establishes a security context between the WLAN AP and the UE that is used to protect unicast and multicast traffic over the air.\nOnce the procedure is complete, the TNGF sends the new reauth Id to UE over the secure interface that UE can use for the next interaction.\nNOTE 2: \tIf the UE gets the new IP configurations from TNAP2, then the UE updates the SA address using an IKE informational request \"UPDATE_SA_ADDRESS\" to TNGF for further communications.\nThe figure depicts a 5G network with various components such as base stations (gNB), user equipment (UE), and scatterers. The diagram illustrates the signal propagation in a 5G network, highlighting the multi-path signal path and beamforming techniques to mitigate interference. The fiber-optic backbone architecture is shown, with core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are depicted in dashed lines, ensuring failover reliability. The layered design aligns with SDN principles.\nFigure 6.5.2.2-1\nDerivation of KTNAP' from KTNGF during mobility use the following input parameters.\n-\tFC = 0xWX\n-\tP1 = RAND,\n-\tL1 = length of RAND (i.e. 0x00 0x04)\nThe input key KEY shall be KTNGF.\nWhen KTNAP' is derived in Mobility, and RAND shall be generated and shared with UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tEvaluation",
                            "text_content": "The solution addresses KI#4.\nUE and TNGF performs mutual authentication during UE TNAP mobility without performing the full authentication.\nImpact on the nodes/UE:\nTable 6.5.3-1\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.5.3-1",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "6.6\tSolution #6: TNAP mobility solution with count",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tIntroduction",
                            "text_content": "This solution addresses the security issue due to TNAP mobility defined in KI#4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.2\tSolution details",
                            "text_content": "The TNAP (Telecommunication Network Access Point) mobility procedure is depicted in Figure 6.6.2-1, illustrating the steps taken by the network access point (NAP) to ensure seamless connectivity for mobile users. The figure shows the NAP's location, signal strength, and connectivity status, as well as the steps taken to maintain these conditions. The TNAP is responsible for providing mobile users with reliable and secure access to the network, and this procedure is crucial for maintaining the quality of service for all users.\nFigure 6.6.2-1: TNAP mobility procedure\n1)\tUE is connected to TNAP#1 via the procedure defined in TS 33.501 figure 7A.2.1-1. Once authenticated, TNGF sends the reauth Id to UE over the protected interface. Reauth Id can be a generated as <PLMNID><TNGF_ID> <Temp Id>.\nNote 1: TNGF Id could be TNGF address (like fqdn)already defined by SA2.\n2, 3.\tUE decides to move from TNAP#1 to TNAP#2 and creates an L2 connection with TNAP#2.\n4, 5, 6.\tTNAP#2 sends the L2 EAP-Request for Identity towards the UE and the UE responds back with an L2 EAP-Response with Identity and a TNAP_Mobility_Indication flag. The TNAP2 forwards the EAP response with reauth Id and the TNAP_Mobility_Indication flag towards TNGF..\n7, 8. \t Based on the reauth Id, TNFG identifies the UE and retrieves the context and checks if the stored context in step 1 is valid and then derives the TNAP' keys as described in clause 6.6.2.2 of the present document. The TNGF responds back to TNAP#2 with the generated key. In TNAP#2, the newly received TNAP key is considered as Pairwise Master Key (PMK).\n9, 10, 11.\tThe TNAP#2 sends an EAP-notification back to the UE with the update flag. Based on the flag, UE updates the counter and derives the keys. A 4-way handshake is executed (see IEEE 802.11) which establishes a security context between the WLAN AP and the UE that is used to protect unicast and multicast traffic over the air.\nOnce the procedure is complete, the TNGF sends the new reauth Id to UE over the secure interface that UE can use for the next interaction.\nNOTE 2: If the UE gets the new IP configurations from TNAP2, then the UE updates the SA address using IKE informational request \"UPDATE_SA_ADDRESS\" to TNGF for further communications.\nThe figure depicts a 5G network with various components such as base stations (gNB), user equipment (UE), and scatterers. The diagram illustrates the signal propagation in a 5G network, highlighting the multi-path signal path and beamforming techniques to mitigate interference. The fiber-optic backbone architecture is shown, with core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are depicted in dashed lines, ensuring failover reliability. The layered design aligns with SDN principles.\nFigure 6.6.2.2-1\nDerivation of KTNAP' from KTNGF during mobility use the following input parameters.\n-\tFC = 0xWX\n-\tP1 = COUNT,\n-\tL1 = length of COUNT (i.e. 0x00 0x04)\nThe input key KEY shall be KTNGF.\nIn this case, the COUNT shall be the downlink NAS COUNT of the Non-3GPP access.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.3\tEvaluation",
                            "text_content": "TNGF and UE: Generate new keys based on the count value and handle the reauth Id.\nTNAP: use updated keys for the mobility scenario\nNOTE: \tCount desynchronization issue is not addressed in this solution.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tSolution #7: Using Fast BSS Transition for TNAP mobility",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.7.1\tIntroduction",
                            "text_content": "This solution addresses key issue #4: Security aspect of TNAP mobility.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.2\tSolution details",
                            "text_content": "This solution addresses the TNAP mobility using the Fast BSS Transition protocol [6].\nThe Fast BSS Transition (FT) key hierarchy is established based on the Master Session Key (MSK) by the R0 Key Holder (R0KH) that is collocated with the 802.1X authenticator as specified in [aa]. To support the Fast BSS Transition, the entity that will hold the root key needs to obtain a 256 bit key (KFT) from the TNGF, which is then used as an input key to create the FT key hierarchy .\nThe key KFT is derived from KTNGF using fixed inputs similar to the derivation of KTNAP from KTNGF described in Annex A.22 of TS 33.501 [4] but using a new Usage type distinguisher, e.g. 0x03.\nThe key KFT is used to create the FT key hierarchy specified in 802.11 [6]. Specifically, KFT is used as Master PMK (MPMK) that is used as an input key for R0-Key-Data derivation. With the R0-Key-Data, the FT key hierarchy is established In effect, KFT links the 5G key hierarchy and FT key hierarchy as it is derived from a key in the 5G key hierarchy and being used to create the FT key hierarchy (see Figure 6.7.2-1 for more details).\nWhen UE switches to a new TNAP within the same mobility domain identified by the Mobility domain identifier (MDID), the UE performs the fast BSS transition procedure as specified in [6].\nThe entity that has received KFT from the TNGF takes the role of PMK R0 Key Holder (R0KH) that holds the key, PMK-R0. The R0KH derives PMK-R1 from PMK-R0 and provides it to the new AP (i.e., TNAP in TNAN) during the FT procedure.\nFigure 6.7.2-1 shows how the 5G and FT key hierarchies link together in this solution.\nThe figure depicts a hierarchical structure of 5G and FT (Fiber to the Home) networks, illustrating the link between the two. The FT hierarchy is shown in a simplified form, with the 5G hierarchy represented by a more complex structure. The figure highlights the importance of the 5G network in providing high-speed connectivity, while the FT network is crucial for delivering reliable and low-latency services to homes.\nFigure 6.7.2-1: Link between the 5G and FT key hierarchies\nNOTE: \tThe TNGF can send both KTNAP and KFT to the entity that holds the root key of the FT key hierarchy as an MSK. The TNGF sets the MSK to KTNAP || KFT, where MSK is 512 bits and the KTNAP and KFT are 256 bits. The TNGF sends the MSK using existing mechanisms.\nThis clause contains a brief overview of the FT security procedure with no attempt to give the complete details (see [6] for those details). None of the details need to be changed by the proposed solution.\nThe FT capability is advertised in the Beacon and Probe Response frames by including the MDIE. The MDIE is advertised in the Beacon and Probe Response frames to indicate the Mobility Domain ID (MDID), FT capability, and the FT policy.\nThe key PMK-R0 and PMK-R1 are identified by PMKR0Name and PMKR1Name respectively. Each AP gets a different PMK-R1 provided to it to secure the communications between the UE and AP. Finally, nonces (SNonce from UE and ANonce from the AP) are used to ensure freshness of the traffic key (PTK) between the UE and AP.\nFigure 6.7.2.2-1 shows a UE attaching to the first AP that results in establishing the FT key hierarchy.\nThe figure depicts the initial UE association process in a 5G network, showing the steps taken by the network to establish a connection between the base station (gNB) and the user equipment (UE). The figure illustrates the use of beamforming techniques to mitigate interference, with key components such as the base station, user equipment, and scatterers highlighted. The layered design of the optical backbone aligns with SDN principles, ensuring failover reliability.\nFigure 6.7.2.2-1: Initial UE association\nStep 1: The UE wants to connect to the AP that is advertising FT capability through inserting the MDE into Beacons and ProbeResponses. The MDE informs about that the AP is FT capable, the mobility domain ID and the potential support of FT over DS.\nStep 2: The UE and AP exchange 802.11 Authentication Request and Response.\nStep 3: The UE sends a (Re)association Request to the AP with a MDE included indicating that the UE wants to perform FT within the indicated mobility domain.\nStep 4: The AP responds with a (Re)association Response including the MDE and both R1KH-ID and R0KH-ID, if it agrees with the proposed FT adoption\nSteps 5a-c: EAP authentication is run and results in the UE and R0KH both having PMK-R0 and PMKR0Name. The AP is provided with PMK and the UE calculates PMK.\nStep 6: The 4-way handshake is performed between the UE and AP.\nStep 7: The UE and AP start securely exchanging data.\nThe important takeaway from the initial attachment is that the UE and R0KH both have PMK-R0 and the PMKR0Name and the UE has the R0KH-ID.\nFigure 6.7.2.2-2 shows AP mobility using the over the air procedure.\nThe figure depicts the AP mobility in a 5G network, showing how the AP moves between different locations to provide coverage. The mobility is represented by the arrows, with the AP's position indicated by the position on the map. The figure also includes the AP's signal strength, which is represented by the color and the size of the circle. The figure is a visual representation of the network's coverage and the AP's movement, providing a clear understanding of the network's architecture and its ability to provide coverage to users.\nFigure 6.7.2.2-2: AP mobility\nSteps 0: The UE has connected to an AP and established the FT key hierarchy as shown in Figure 6.7.2.2-1.\nStep 1: The UE finds another AP (called target AP) advertising FT capability and the same mobility domain. The UE sends an 802.11 Authentication Request to the Target AP including MDE, R0KH-ID, PMKR0Name and SNonce.\nStep 2: The target AP queries the R0KH for the required PMK-R1and fetches the PMK-R1 from the R0KH using R0KH-ID and PMKR0Name.\nStep 3: The target AP sends an 802.11 Authentication Response to the UE including ANonce and R1KH-ID.\nStep 4: The UE calculates PMKR1Name and initiates its reassociation to the target AP continuing the establishment of a PTK for the new association\nStep 5: The UE sends a Reassociation Request including PMKR1Name, ANonce, SNonce and MIC. The target AP checks the MIC and if successful installs the derived PTK for the subsequent data exchanges.\nStep 6: The target AP sends a Reassociation Response including ANonce, SNonce and MIC. The UE checks the MIC and, if successful, installs likewise the PTK for the subsequent data exchanges.\nStep 7: The UE and AP start securely exchanging data.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.3\tEvaluation",
                            "text_content": "This solution requires new functionality of deriving a new key from an existing key in the UE and TNGF. This new key is then used to create the root key of the FT key hierarchy and hence allow the establishment of security between the UE and a new TNAP using the existing FT procedures in case of TNAP mobility. When the UE transitions from one TNAP to a new TNAP, the FT procedures enable the UE to establish a security association with the new TNAP using only 2 round trips of messages between the UE and the new TNAP.\nThe R0KH is part of the TNAN.\nThe relationship between MDID and TNGF ID will be determined in the normative phase.\nThe procedures in the solution are executed when the TNAN supports FT.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.8\tSolution #8: Security Establishment for TNAP Mobility",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tIntroduction",
                            "text_content": "The solutions address Key Issue #4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tSolution details",
                            "text_content": "The solution describes to provide UE with TNGF ID and exchange freshness parameter (such as nonce to facilitate challenge and common security establishment between UE and Trusted Non-3GPP Access Network i.e., TNGF) during the Initial registration procedure (i.e., following a successful authentication for trusted non-3GPP access) as shown in Figure 6.8.2-1. Further if a UE connected to TNGF via a TNAP (i.e., say TNAP 1) decides to move to another TNAP (i.e., say TNAP 2), the solution propose to use the following Security Establishment procedure for TNAP Mobility shown in Figure 6.8.2-2 as described below.\nThe figure depicts a network authentication scheme for trusted non-3GPP access, with a focus on the use of digital signatures and encryption techniques. The authentication process involves the use of digital certificates, which are digitally signed and encrypted to ensure the authenticity of the user's identity. The figure also includes a visual representation of the network topology, with the authentication process taking place at the network edge, where the user's identity is verified before being granted access to the network.\nFigure 6.8.2-1: Authentication for trusted non-3GPP access\nThe actual registration procedure for trusted non-3GPP access steps related to 6.8.2-1 are described in TS 23.502, clause 4.12a.2.2 and the related authentication steps are shown in TS 33.501, clause 7A.2.1. Therefore, the necessary enhancements for steps 10b – 10e are described below.\nDuring EAP-5G procedure (i.e., executed in steps 4-10), the additional access parameters are exchanged between the UE and the TNGF at step 10: The TNGF sends TNGF address and TNGF Nonce (TNonce) to UE in step 10b. Further the UE sends to TNGF, a UE Nonce (UNonce) in step 10c. The UE and the TNGF can derive a Reauth-ID for the UE from TNGF key using the inputs parameters such as TNGF-ID, Nonce from TNGF, Nonce from UE.\nThe figure depicts a security establishment procedure for TNAP Mobility, which is a mobile network technology. It illustrates the steps taken to establish a secure connection between a mobile device and a network. The figure includes a diagram of the network infrastructure, such as base stations (BSs) and mobile devices, as well as the security protocols and procedures involved in the establishment process.\nFigure 6.8.2-2: Security Establishment procedure for TNAP Mobility\nThe steps shown in Figure 6.8.2-2 is described as follows:\n1.\tThe UE established a layer-2 (L2) connection with TNAP2.\n2.\tThe TNAP2 initiates an EAP session as usually by requesting the UE identity.\n3.\tThe UE provides a Network Access Identifier (NAI) containing username = Reauth-ID and realm = nai.5gc.tngf<TNGF-ID>.mnc<MNC>.mcc<MCC>.3gppnetwork.org. The Reauth-ID was derived as described for figure 6.8.2-1 and the TNGF-ID was received when the UE was first connected to TNGF, e.g. with an Initial Registration via TNGF. The UE provides username = Reauth-ID because the UE does not want to initiate NAS signaling with 5GC, but it wants to reauthenticate with the TNGF.\n4.\tThe TNAP1 selects TNGF based on the TNG1-ID in the received realm and forwards the NAI to TNGF.\n5.\tThe TNGF finds a stored UE context containing the received Reauth-ID, thus, it determines that the UE is a known UE which requests reauthentication. Therefore, it initiates the following steps. If the TNGF cannot find a stored UE context containing the received Reauth-ID, then the TNGF sends either an error response to UE, it initiates the signalling procedure related to normal authentication for trusted non-3GPP access as described in TS 33.501 clause 7A.2.1.\nThe UE context was created in the TNGF when the UE performed an initial registration (see Figure 6.8.2-1) via TNGF.\n6.\tThe TNGF sends a 5G-Challenge packet to UE which contains a TNonce value and a Message Authentication Code1 (MAC1) derived by using the TNGF key stored in TNGF.\n7.\tThe UE derives an expected MAC1 (XMAC1) using TNGF key stored in UE, and TNonce and compares XMAC1 with the received MAC1. If they match, the TNGF is authenticated by the UE.\n8.\tThe UE generates a UNonce and derives a MAC2 using TNGF key stored in UE, and with UNonce and TNonce.\n9.\tThe UE responds with a 5G-Challenge containing UNonce, TNonce and MAC2.\n10.\tThe TNGF derives an expected MAC2 (XMAC2) using TNGF and with UNonce and TNonce. Compares XMAC2 with the received MAC2. If they match, the UE is authenticated by TNGF.\n11.\tThe TNGF derives a fresh Reauth-ID for the UE, e.g. by using TNGF key stored in TNGF, TNGF-ID, TNonce and UNonce. In addition, the TNGF derives a new TNAP key by using the TNGF key stored in TNGF, the TNGF-ID, the TNonce and UNonce values.\n12.\tThe TNGF completes the EAP-5G session by sending an EAP-Success packet to UE and the new TNAP key to TNAP2.\n13.\tThe UE derives a new Reauth-ID by using the TNGF key stored in UE, TNGF-ID, TNonce and UNonce. If the UE and the TNGF share the same TNGF key, then the Reauth-ID derived independently in the UE and in the TNGF will be the same. In addition, the UE derives also a new TNAP key similarly to the TNGF (as in step 11).\n14.\tThe new TNAP key is applied to establish over-the-air security between the UE and TNAP2. If needed, the UE may receive new IP configuration information (e.g. a new IP address).\n15.\tThe UE resumes communication with TNGF via TNAP2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.3\tEvaluation",
                            "text_content": "The solution addresses KI#4 and it enables the following aspects:\nUE and TNGF performs mutual authentication during UE TNAP mobility as part of re-authentication by exchanging nonces and verifying a related MAC.\nFurther impacts related to the solution includes:\nFor UE TNAP mobility scenario, the UE and TNGF derives new TNAP key using the previously established security context (from the initial primary authentication) i.e., TNGF key and nonce(s) as a freshness parameter. The UE and TNGF need to derive a Re-auth ID, the details of the inputs is up to the normative work. UE need to construct NAI using Re-auth ID and TNGF information. The TNGF need to find a stored UE context based on Reauth-ID.\nTNGF: Need to provide Nonce, TNGF ID to UE during initial registration procedure. Alternatively, an existing TNGF address can be used TNGF ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.9\tSolution #9: AUN3 device supporting 5G Key hierarchy (i.e. N5CW)",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.9.1\tIntroduction",
                            "text_content": "This solution addresses the authentication of AUN3 devices supporting 5G key hierarchy(i.e. N5CW) based on the EAP_AKA prime method.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.2\tSolution details",
                            "text_content": "The figure depicts a 9.2.1 -1 authentication protocol, which is based on the EAP-AKA prime protocol. It is a key component of the EAP-TLS protocol, which is used for secure communication over the internet. The figure shows the authentication process, including the use of the EAP-AKA prime protocol, which is a key component of the EAP-TLS protocol. The figure also includes the EAP-TLS protocol, which is used for secure communication over the internet.\nFigure 6.9.2.1-1: EAP-AKA prime based AUN3 (i.e. N5CW) authentication\n1a.\tThe AUN3 device establishes a WLAN connection with the WLAN Access Network (AN), using procedures specified in IEEE 802.11.\n1b, 1c.\tL2 connection and EAP identity retrieval are performed. AUN3 device sends back EAP Response/Identity message. The AUN3 device uses SUCI in NAI format (i.e., username@realm format as specified in clause 28.7.3 of TS 23.003) or 5G-GUTI.\n2a, 3a, 3b, 3c.\tIf the RG is an FN-RG, the FN-RG sends the EAP response/Identity including the NAI to the W-AGF. The W-AGF creates a registration request on behalf of the AUN3 device with a new indication that the registration is on behalf of an AUN3 device where protection is required for the interface between the AUN3 device and RG. The W-AGF selects the AMF/SEAF. The W-AGF sends to the AMF/SEAF a registration request on behalf of the AUN3 device. The registration request includes the NAI SUCI, wireline network name if available, and the new indication. The same message content is forwarded from AMF to AUSF and then from AUSF to UDM.\n2b, 3b, 3c.\tIf the RG is a 5G-RG, the 5G-RG sends a NAS Registration Request message to the AMF, including the received SUCI and the new indicator for encryption required for AUN3 device.\n4.\tAuthentication procedure for EAP-AKA' is performed as defined in the clause 6.1.3.1 of TS 33.501 [4].\n5.\tBased on the indication in step 3, AMF derives the WAGF key.\n6.\tThe AMF sends NAS Security Mode Command mode and provides the WAGF key (KWAGF') to W-AGF.\n7.\tW-AGF/RG derive the KRG as PMK key from the WAGF key (KWAGF').\n8.\tRG and AUN3 device will derive WLAN keys from PMK.\n9.\tThe AUN3 device performs a 4-way handshake to establish a secure connection with the WLAN AN.\nWhen deriving the keys KWAGF' for AUN3 from KAMF then the following parameters should be used input S to the KDF.\n-\tFC = 0x<to be defined>\n- \tP0 = Access type distinguisher\n-\tL0 = length of Access type distinguisher (i.e. 0x00 0x01)\nThe access type distinguisher shall be set to the value for 'non-3GPP (0x02) when deriving KWAGF'.\nWhen deriving a KRG key from KWAGF' the following parameters shall be used to form the input S to the KDF.\n- \tFC = 0x<to be defined>\n-\t P0 = Usage type distinguisher\n-\tL0 = length of Usage type distinguisher (i.e. 0x00 0x01)\nUsage type distinguisher value is set to 0x02.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.3\tEvaluation",
                            "text_content": "This solution meets both the requirements mentioned in the KI for the AUN3 device that support 5G key hierarchy. i.e.\n-\t5GC should be able to authenticate the AUN3 device behind RG.\n-\tThe 5GS should provide a means for the AUN3 device and RG to get a shared key that could be used to provide protection of the interface between them.\nImpact on the entities\nAUSF/UDM: New indication received for AUN3 devices and select authentication algorithm accordingly.\nAMF: generates the keys and provides the same to RG/W-AGF.\nRG/W-AGF: receives new key material from AMF and then derives the PMK.\nUE: derive the new keys.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.10\tSolution #10: TNAP mobility solution without full authentication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.10.1\tIntroduction",
                            "text_content": "This solution addresses key issue #4: Security aspect of TNAP mobility.\nIn this solution, the TNAP is the EAP authenticator and the TNGF is the authentication server. The full authentication means the UE runs an EAP-5G authentication with the TNGF and run a primary authentication with the AUSF that is encapsulated in the EAP-5G authentication. Compared to the full authentication, this procedure does not need to run the primary authentication with AUSF, thus it is referred to as the non-full(without full) authentication procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.2\tSolution details",
                            "text_content": "The figure depicts a TNAP (Telecommunication Network Access Point) mobility procedure, illustrating the steps taken by the network to ensure the smooth movement of mobile devices within the network. The TNAP is a crucial component of a 5G network, responsible for managing the movement of mobile devices and ensuring seamless connectivity. The figure shows the TNAP's role in managing the network's traffic, routing, and security, all while maintaining the highest possible performance.\nFigure 6.10.2-1: TNAP mobility procedure\n1-3. UE connected to TNAP#1 by performing the procedure defined in TS33.501 7A.2.1 step1- step19.\n4. The TNGF knows the UE reconnect to the TNGF again, but via TNAP#2 by receiving the same UE ID in the previous connection. The UE ID is the SUCI or 5G-GUTI used in step1.\n5. TNGF finds the UE security context based on the UE ID, and determines to perform re-authentication procedure based on UE ID. The TNGF generates KTNGF' that is equivalent to the EAP 5G reauthentication root key by using the method in A.22 of TS 33.501 [4] with the usage type distinguisher set to 0x03, with the input key KTNGF\nNote:\tWhether the additional key KTNGF is needed is not addressed in this solution.\n6. TNGF sends EAP-REQ message to start the re-authentication procedure, a, Nonce-TNGF and the HMAC are carried in this message. HMAC is generated by using fresh parameter and KTNGF'. TNAP#2 forward this message to UE.\n7. UE finds the KTNGF by using TNGF ID in step 4, and generates KTNGF' by using the same method in step5, and verifies the HMAC. if the verification passes, perform next steps.\n8. UE sends EAP-RES message, Nonce-UE and HMAC are carried in AN-Parameters of this message, HMAC is generated by using Nonce-UE parameter and KTNGF' , TNAP#2 forward this message to TNGF.\n9. TNGF verifies the HMAC, if the verification passes, TNGF generates KTNAP' by using method defined in TS 33.501 clause A.22.\n10. TNGF sends EAP-Success message to TNAP#2, KTNAP' generated in step 9 is carried in this message. TNAP#2 forward EAP-Success message to UE.\n11. After receiving EAP-Success message, UE generates KTNAP' by using the same method in step 9.\n12. UE and TNAP#2 establish security association by using the newly generated KTNAP'.\n13. TS 33.501 clause 7A.2.1 step 12- step 19.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.3\tEvaluation",
                            "text_content": "This solution addresses the requirement of KI #4 by generating a new KTNGF'.\nThis solution impacts UE and TNGF without affecting other NFs.\nThis solution proposes to use the SUCI or 5G-GUTI used in the IDi of IPsec as the key identifier in the non-full authentication procedure to locate the key KTNGF. In case the UE used SUCI in the primary authentication it need to store the SUCI and use it when it wants to TNAP mobility.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.11\tSolution #11: Security of N3IWF/TNGF reallocation",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.11.1\tIntroduction",
                            "text_content": "This solution addresses KI#3 and is built on solution#15 in TR 23.700-17 [2] V0.3.0, but only includes the N3IWF Relocation case. In this solution, an IPsec tunnel is setup before initiating the UE policy Association Establishment procedure and before the AMF sends a Registration Reject message. Please note that, according to TS 33.501 [4], the NAS message is sent over IPsec tunnel. Since the conclusion in TR 23.700-17 [2] has concluded that TNGF Relocation uses the same manner as N3IWF, then the solution in clause 6.11.2 can also be applied to TNGF Reallocation case.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.2\tSolution details",
                            "text_content": "The figure depicts a relocation procedure for N3IWF, a type of optical fiber used in telecommunication networks. The diagram illustrates the steps involved in moving the fiber from one location to another, including the use of a fiber-optic splice tool and a fiber-optic splice tool. The figure also shows the placement of the splice tool and the fiber, as well as the connection of the splice tool to the fiber. The figure is important for understanding the process of fiber-optic splice and relocation in telecommunication networks.\nFigure 6.11.2-1: N3IWF Relocation procedure\nNOTE: \tThe solution can be reused to TNGF relocation case by replacing N3IWF with TNGF.\n1.\tUE connects to S-N3IWF and sends the Registration Request message to the AMF as defined from step 1a to step 6b in clause 7.2.1 of TS 33.501 [4] and as defined from step 1 to step 6b in clause 7A.2.1 of TS 33.501 [4].\n2. If the Registration Request contains a SUCI, AMF initiates primary authentication. If the UE contains a 5G-GUTI, and the AMF successfully verified the integrity protection of the Registration Request message, whether the AMF initiates primary authentication and NAS SMC procedure the same as what is defined in TS 33.501 [4].\n3. The AMF determines to use T-N3IWF as described in TR 23.700-17 [2].\n4. The AMF generate a KNI3WF, and sends it to the S-N3IWF for setting up the IPsec as defined from step 12 to step 15 in clause 7.2.1 of TS 33.501 [4] and as defined from step 10a to step 14 in clause 7A.2.1 of TS 33.501 [4].\n5. The same as step 9 described in solution#15 of TR 23.700-12 [2].\n6. The same as step 10a described in solution#15 of TR 23.700-12 [2]. The UE and the AMF keep the security context. The AMF includes a new 5G-GUTI in the Registration Reject message.\n7. After successfully verifying the integrity protection of the message in steps 5 or 6, the UE re-registered to the AMF using T-N3IWF. The Registration Request message contains the new 5G-GUTI and is protected by the security context generated in step 2, or previously generated before step 1.\n8. If no relocation is needed again, the AMF proceeds with the rest of procedures defined in clause 7.2.1 of TS 33.501 [4] and clause 7A.2.1 of TS 33.501 [4]. Particularly, the AMF generates a new KNI3WF for setting up the IPsec tunnel.\n9. The AMF sends NAS Registration Accept message to the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.3\tEvaluation",
                            "text_content": "The solution proposes to establish the IPsec tunnel before sending the redirection information (e.g. new SSID and associated Requested NSSAI) in the Registration Reject message. In this way, the security between the UE and the AMF is established and the redirection information can be protected.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.12\tSolution #12: Authentication of UE connecting to RG by NSWO",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.12.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #5 on the authentication of UE connecting to RG, by using the NSWO procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.2\tSolution details",
                            "text_content": "A UE connecting to the 5G-RG or FN-RG via WLAN, in the case that the WLAN supports IEEE 802.1X, can use the NSWO authentication.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.3\tEvaluation",
                            "text_content": "This solution meets the requirement that 5GS shall support authentication of UE connecting to RG using 5G credentials.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.13\tSolution #13: TNAP mobility using modified ERP",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.13.1\tIntroduction",
                            "text_content": "This solution targets key issue #4 Security aspect of TNAP mobility without full authentication.\nIn earlier versions of TS 23.502 [7] it was specified that EAP re-authentication (ERP) may be used for TNAP mobility in trusted access. This would enable UEs to move from one access point to another without performing a full primary authentication. This option was removed from Rel-16 and Rel-17 since the use of ERP required this to be supported by AUSF and AMF which had not been specified in stage 3 specifications.\nIn short, it was specified that AUSF should generate the key rRK from EMSK and send it to the TNGF. The TNGF would then derive further keys from rRK, as specified in RFC 6696 [8] also shown below.\n\nrRK\n|\n+--------+--------+\n| | |\nrIK rMSK1 ...rMSKn\n\nwhere\nrRK is the re-authentication Root Key, derived from the EMSK (from the EAP authentication).\nrIK is the re-authentication Integrity Key, derived from the rRK. Used for the integrity protection of all messages between the peer and the ERP server.\nrMSK is re-authentication MSK, derived from the rRK. There are multiple keys of this type (rMSK1, …rMSKn). These keys are derived by the ERP server and the peer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.2\tSolution details",
                            "text_content": "This solution proposes to reuse ERP for reauthentication but modify the method of how the root key (rRK) is derived. Instead of deriving the key rRK from EMSK, the rRK is derived from KTNGF.\nSection 4.2 of RFC 6696 [8] specifying ERP, the properties for rRK are listed:\nThe rRK has the following properties. These properties apply to the\nrRK regardless of the parent key used to derive it.\n\no  The length of the rRK MUST be equal to the length of the parent\nkey used to derive it.\n\no  The rRK is to be used only as a root key for re-authentication and\nnever used to directly protect any data.\n\no  The rRK is only used for the derivation of the rIK and rMSK as\nspecified in this document.\n\no  The rRK MUST remain on the peer and the server that derived it and\nMUST NOT be transported to any other entity.\n\no  The lifetime of the rRK is never greater than that of its parent\nkey.  The rRK is expired when the parent key expires and MUST be\nremoved from use at that time.\n\nThe above properties do not require that rRK is derived from EMSK, nor does it require that the rRK is derived by the EAP server.\nTo fulfil the above properties, it is possible to derive the key rRK from KTNGF as long as the other keys derived from KTNGF are separated from the rRK and that the rRK is not used for anything else than further key derivation. The current key hierarchy for trusted access is displayed in Figure 6.13.2-1. A proposal for how the key hierarchy can be made to reflect the needs is provided in Figure 6.13.2-2.\nIn this solution, the key rRK, is derived from KTNGF. The derivation of rRK is performed according to section 4.1 of RFC 6696 [8] replacing the input key EMSK with the key KTNGF. The lower layer keys (rIK, rMSK1, etc) are derived from rRK according to RFC 6696 [8].\nThe difference is that no extra key needs to be transferred from the AMF and no ERP requests needs to be sent.\nAnother difference compared to ERP is that in standard ERP, the AUSF would need to receive an indication to derive rRK during primary authentication. This is called the bootstrapping steps of ERP. With the proposed modification however, a similar bootstrapping is not needed since the rRK will be based on KTNGF that is anyway present in the TNGF. This means that the bootstrapping is implicit rather than explicit. The rRK can be derived by TNGF once a mobility request is received or at any time when it is convenient.\nThe figure depicts a hierarchical structure of trusted non-3GPP access, with the current key hierarchy being 13.2-1. The hierarchy includes various access control levels, such as 13.2-1, which is the highest level and is responsible for managing access to non-3GPP services. The figure also includes a legend to help understand the different access levels and their respective responsibilities.\nFigure 6.13.2-1: Current key hierarchy for trusted non-3GPP access\nThe figure depicts a proposed key hierarchy for trusted non-3GPP access to support TNAP mobility, with a focus on ensuring the security and reliability of the network.\nFigure 6.13.2-2: Proposal for updated key hierarchy for trusted non-3GPP access to support TNAP mobility\nNOTE 1: \tInitial UE identifier between UE and target TNAP, and its protection is not addressed by the present document.\nNOTE 2: \tSession correlation at the TNGF when the target TNAP contacts the TNGF is not addressed by the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.3\tEvaluation",
                            "text_content": "This solution modifies the key derivation in ERP.\nThe procedures are based on KTNGF instead of EMSK.\nThe solution impacts TNGF and UE.\nNOTE 1: \tInitial UE identifier between UE and target TNAP, and its protection is not addressed by the present document.\nNOTE 2: \tSession correlation at the TNGF when the target TNAP contacts the TNGF is not addressed by the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tConclusions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tKey issue #1: Authentication of AUN3 device behind RG and supporting EAP",
                    "description": "",
                    "summary": "",
                    "text_content": "It is concluded that solutions #2, #3, and #4 are used as the basis for normative specifications for authentication of AUN3 devices behind RG, where the AUN3 devices do not support 5G key hierarchy. More specifically,\n-\tSolution #2 is used as the basis for PLMN\n-\tSolution #3 and #4 are used as the basis for SNPN.\nThe AUN3 device supporting the 5G key hierarchy is also called the N5CW device. It is concluded that solution #9 is used as a basis for the normative specification.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tKey issue #2: Security aspect of slice information exposure of N3IWF/TNGF to UE",
                    "description": "",
                    "summary": "",
                    "text_content": "SA2 TR 23700-17 was fully concluded for the KI2, where SA2 preferred UE-centric solutions. However, the information is delivered to the UE via PCF policies (ANDSP/WLANSP), which is protected by NAS security.\nKI#2 was proposed on the basis of solution 13 and solution 14 in TR 23.700-17 where unprotected slice information is shared between UE and the network. However, Solution 13 and Solution 14 have not been chosen for normative work in TR 23.700-17, hence this key issue does not need any normative work.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.3\tKey issue #3: Security aspect of slice information exposure of N3IWF/TNGF",
                    "description": "",
                    "summary": "",
                    "text_content": "For both TNGF and N3IWF, solution #11 is the basis for normative work. However, whether IPSec is needed, or NAS SMC is sufficient is to be decided in the normative phase.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.4\tKey issue #4: Security aspect of TNAP mobility without full authentication",
                    "description": "",
                    "summary": "",
                    "text_content": "No Conclusion.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.5\tKey issue #5: Authentication of UE connecting to RG using NSWO",
                    "description": "",
                    "summary": "",
                    "text_content": "It is concluded that solution #12 is used as the basis for normative work.\n\n\n\n\n",
                    "tables": [
                        {
                            "description": "",
                            "table number": 5,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        }
    ]
}