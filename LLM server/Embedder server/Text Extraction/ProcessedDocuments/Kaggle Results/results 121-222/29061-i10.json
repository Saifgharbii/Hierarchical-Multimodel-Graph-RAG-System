{
    "document_name": "29061-i10.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification (TS) has been produced by the 3rd Generation Partnership Project (3GPP).\nThe present document describes the network interworking for the Packet Domain. Interworking to various external networks is defined together with the interworking for data forwarding while subscribers roam within the 3GPP system.\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\nY\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document defines the requirements for Packet Domain interworking between a:\na)\tPLMN and PDN;\nb)\tPLMN and PLMN.\nThe present document is valid for a PLMN in A/Gb mode as well as for a PLMN in Iu mode. If text applies only for one of these systems it is explicitly mentioned by using the terms \"A/Gb mode\" and \"Iu mode\". Please note, that the A interface does not play any role in the scope of the present document although the term \"A/Gb mode\" is used.\nFor inter-working between EPC PLMN and external networks, the present document is valid for both 3GPP accesses and non-3GPP accesses.\nThe present document also defines, in clause 17, the protocol for the Gmb interface, in clause 20, the protocol for the SGmb interface, and in clause 19, the protocol for the Mz interface.\nThe present document also defines, in clause 18, the usage of Radius at the Pk Reference Point between the GGSN and the Presence Network Agent.\nThe term \"Packet Domain\" includes both EPC based and non-EPC based Packet Domains.\nThe present document also defines the specific requirements for rate control related to CIoT optimisations.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\tVoid.\n[2]\t3GPP TS 22.060: \"General Packet Radio Service (GPRS); Service Description; Stage 1\".\n[3]\t3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service Description; Stage 2\".\n[4]\tVoid.\n[5]\tVoid.\n[6]\tVoid.\n[7]\tVoid.\n[8]\tVoid.\n[9]\tVoid.\n[10]\t3GPP TS 27.060: \"Packet Domain; Mobile Station (MS) supporting Packet Switched services\".\n[11]\tITU-T Recommendation E.164: \"The international public telecommunication numbering plan\".\n[12]\tVoid.\n[13]\tVoid.\n[14]\tVoid.\n[15]\tIETF RFC 768 (1980): \"User Datagram Protocol\" (STD 6).\n[16]\tIETF RFC 791 (1981): \"Internet Protocol\" (STD 5).\n[17]\tIETF RFC 792 (1981): \"Internet Control Message Protocol\" (STD 5).\n[18]\tIETF RFC 793 (1981): \"Transmission Control Protocol\" (STD 7).\n[19]\tIETF RFC 1034 (1987): \"Domain names – concepts and facilities\" (STD 7).\n[20]\tVoid.\n[21a]\tIETF RFC 1661 (1994): \"The Point-to-Point Protocol (PPP)\" (STD 51).\n[21b]\tIETF RFC 1662 (1994): \"PPP in HDLC-like Framing\".\n[22]\tIETF RFC 1700 (1994): \"Assigned Numbers\" (STD 2).\n[23]\t3GPP TS 44.008: \"Mobile radio interface layer 3 specification; Core Network protocols; Stage 3\".\n[24]\t3GPP TS 29.060: \"General Packet Radio Service (GPRS); GPRS Tunnelling Protocol (GTP) across the Gn and Gp interface\".\n[25]\tIETF RFC 2794 (2000): \"Mobile IP Network Address Identifier Extension for IPv4\", P. Calhoun, C. Perkins.\n[26]\tIETF RFC 2131 (1997): \"Dynamic Host Configuration Protocol\".\n[27]\tIETF RFC 1542 (1993): \"Clarification and Extensions for the Bootstrap Protocol\".\n[28]\tVoid.\n[29]\tVoid.\n[30]\tIETF RFC 3344 (2002): \"IP Mobility Support\", C. Perkins.\n[31]\tIETF RFC 2486 (1999): \"The Network Access Identifier\", B. Aboba and M. Beadles.\n[32]\tVoid.\n[33]\tVoid.\n[34]\tVoid.\n[35]\tVoid.\n[36]\tVoid.\n[37]\tIETF RFC 2290 (1998): \"Mobile-IPv4 Configuration Option for PPP IPCP\", J. Solomon, S. Glass.\n[38]\tIETF RFC 2865 (2000): \"Remote Authentication Dial In User Service (RADIUS)\", C. Rigney, S. Willens, A. Rubens, W. Simpson.\n[39]\tIETF RFC 2866 (2000): \"RADIUS Accounting\", C. Rigney, Livingston.\n[40]\t3GPP TS 23.003: \"Numbering, addressing and identification\".\n[41]\tIETF RFC 3576 (2003): \"Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS)\", M.Chiba, M.Eklund, D.Mitton, B.Aboba.\n[42]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[43]\tVoid.\n[44]\tVoid.\n[45]\tIETF RFC 3118 (2001): \"Authentication for DHCP Messages\", R. Droms, W. Arbaugh.\n[46]\tIETF RFC 3315 (2003) \"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)\", R. Droms, J. Bound, B. Volz, T. Lemon, C. Perkins, M. Carney.\n[47]\t3GPP TS 24.229: \"IP Multimedia Call Control Protocol based on SIP and SDP\".\n[48]\tIETF RFC 2710 (1999): \"Multicast Listener Discovery (MLD) for IPv6\", S. Deering, W. Fenner, B. Haberman.\n[49]\tIETF RFC 2460 (1998): \"Internet Protocol, Version 6 (IPv6) Specification\", S.Deering, R.Hinden.\n[50]\tIETF RFC 3162 (2001): \"RADIUS and IPv6\", B. Adoba, G. Zorn, D. Mitton.\n[51]\tIETF RFC 2548 (1999): \"Microsoft Vendor-specific RADIUS Attributes\", G.Zorn.\n[52]\t3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".\n[53]\tVoid\n[54]\t3GPP TS 24.008: \"Mobile radio interface layer 3 specification; Core Network protocols; Stage 3\".\n[55]\tVoid.\n[56]\tVoid\n[57]\tVoid.\n[58]\tIETF RFC 1035 (1987): \"Domain names – implementation and specification\" (STD 13).\n[59]\tVoid.\n[60]\tIETF RFC 1771 (1995): \"A Border Gateway Protocol 4 (BGP-4)\".\n[61]\tIETF RFC 1825 (1995): \"Security Architecture for the Internet Protocol\".\n[62]\tIETF RFC 1826 (1995): \"IP Authentication Header\".\n[63]\tIETF RFC 1827 (1995): \"IP Encapsulating Security Payload (ESP)\".\n[64]\tVoid.\n[65]\t3GPP TS 23.246: \"Multimedia Broadcast/Multicast Service (MBMS) Architecture and Functional Description\".\n[66]\tVoid.\n[67]\tVoid.\n[68]\t3GPP TS 23.141: \"Presence Service; Architecture and functional description\".\n[69]\t3GPP TS 32.422: \"Subscriber and equipment trace: Trace Control and Configuration Management\".\n[70]\t3GPP TS 48.018: \"Base Station System (BSS) – Serving GPRS Support Node (SGSN); BSS GPRS Protocol (BSSGP)\".\n[71]\t3GPP TS 23.107: \"Quality of Service (QoS) Concept and Architecture\".\n[72]\t3GPP TS 25.346: \"Introduction of the Multimedia Broadcast Multicast Service (MBMS) in the Radio Access Network (RAN)\".\n[73]\tIETF RFC 4604 (2006): \"Using Internet Group Management Protocol Version 3 (IGMPv3) and Multicast Listener Discovery Protocol Version 2 (MLDv2) for Source-Specific Multicast\".\n[74]\tIETF RFC 4607 (2006): \"Source-Specific Multicast for IP\".\n[75]\t3GPP TS 29.212: \"Policy and Charging Control (PCC); Reference points\".\n[76]\t3GPP TS 29.213: \"Policy and charging control signalling flows and Quality of Service (QoS) parameter mapping\".\n[77]\t3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".\n[78]\t3GPP TS 23.402: \"Architecture enhancements for non-3GPP accesses\".\n[79]\tIETF RFC 4039 (2005): \"Rapid Commit Option for the Dynamic Host Configuration Protocol version 4 (DHCPv4)\".\n[80]\tIETF RFC 3736 (2004): \"Stateless Dynamic Host Configuration Protocol (DHCP) Service for IPv6\".\n[81]\t3GPP TS 29.274: \"Evolved GPRS Tunnelling Protocol for EPS (GTPv2)\".\n[82]\tIETF RFC 4291 (2006): \"IP Version 6 Addressing Architecture\".\n[83]\tIETF RFC 4862 (2007): \"IPv6 Stateless Address Autoconfiguration\".\n[84]\t3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet System (EPS)\".\n[85]\tIETF RFC 2132 (1997): \"DHCP Options and BOOTP Vendor Extensions\".\n[86]\tIETF RFC 3361 (2002): \"Dynamic Host Configuration Protocol (DHCP-for-IPv4) Option for Session Initiation Protocol (SIP) Servers\".\n[87]\tIETF RFC 3646 (2003): \"DNS Configuration options for Dynamic Host Configuration Protocol for IPv6 (DHCPv6)\".\n[88]\tIETF RFC 3319 (2003): \"Dynamic Host Configuration Protocol (DHCPv6) Options for Session Initiation Protocol (SIP) Servers\".\n[89]\tIETF RFC 4861 (2007): \"Neighbor Discovery for IP Version 6 (IPv6)\".\n[90]\t3GPP TS 23.203: \"Policy and charging control architecture\".\n[91]\tIETF RFC 4739 (2006): \"Multiple Authentication Exchanges in the Internet Key Exchange (IKEv2) Protocol\".\n[92]\t3GPP TS 25.413: \"UTRAN Iu Interface RANAP Signalling\".\n[93]\tIETF RFC 5176 (2008): \"Dynamic Authorization Extentions to Remote Authentication Dial In User Service (RADIUS)\".\n[94]\t3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA); Radio Resource Control (RRC); Protocol specification\".\n[95]\t3GPP TS 23.380: \"IMS Restoration Procedures\".\n[96]\t3GPP TS 29.303: \"Domain Name System Procedures; Stage 3\".\n[97]\tIETF RFC 4818 (2007): \"RADIUS Delegated-IPv6-Prefix Attribute\".\n[98]\t3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Overall description\"\n[99]\t3GPP TS 23.221: \"Architectural requirements\".\n[100]\t3GPP TS 23.682: \"Architecture Enhancements to facilitate communications with Packet Data Networks and Applications\".\n[101]\t3GPP TS 29.336: \"Home Subscriber Server (HSS) Diameter interfaces for interworking with packet data networks and applications\".\n[102]\tIETF RFC 4282 (2005): \"The Network Access Identifier\".\n[103]\t3GPP TS 29.275: \"Proxy Mobile IPv6 (PMIPv6) based Mobility and Tunnelling protocols; Stage 3\".\n[104]\t3GPP TS 23.007: \"Restoration procedures\".\n[105]\t3GPP TS 29.229: \"Cx and Dx interfaces based on Diameter protocol; Protocol details\".\n[106]\t3GPP TS 25.446: \"MBMS synchronisation protocol (SYNC)\".\n[107]\t3GPP TS 25.323: \"Packet Data Convergence Protocol (PDCP) specification\".\n[108]\tVoid.\n[109]\tIETF RFC 4960 (2007): \"Stream Control Transmission Protocol\".\n[110]\t3GPP TS 29.128: \"Mobility Management Entity (MME) and Serving GPRS Support Node (SGSN) interfaces for interworking with packet data networks and applications \".\n[111]\tIETF RFC 6733: \"Diameter Base Protocol\".\n[112]\t3GPP TS 23.285: \"Architecture Enhancements for V2X services\".\n[113]\t3GPP TS 29.468: \"Group Communication System Enablers for LTE (GCSE_LTE); MB2 Reference point; Stage 3\".\n[114]\t3GPP TS 29.244: \"Interface between the Control Plane and the User Plane of EPC Nodes; Stage 3\".\n[115]\t3GPP TS 38.413: \"NG Radio Access Network (NG-RAN); NG Application Protocol (NGAP)\".\n[116]\tIETF RFC 2869: \"RADIUS Extensions\".\n[117]\t3GPP TS 23.214: \"Architecture enhancements for control and user plane separation of EPC nodes; Stage 2\".\n[118]\tIETF RFC 2661: \" Layer Two Tunneling Protocol \"L2TP\".\n[119]\tIETF RFC 2868: \"RADIUS Attributes for Tunnel Protocol Support\".\n[120]\tIETF RFC 7155: \"Diameter Network Access Server Application\".\n[121]\t3GPP TS 29.214: \"Policy and Charging Control over Rx reference point\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tDefinitions",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms and definitions given in 3GPP TS 22.060 [2], 3GPP TS 23.060 [3], 3GPP TS 23.401 [77], 3GPP TS 23.402 [78] and the following apply:\n2G- / 3G-: prefixes 2G- and 3G- refers to functionality that supports only A/Gb mode GPRS or Iu mode, respectively, e.g., 2G-SGSN refers only to the A/Gb mode GPRS functionality of an SGSN. When the prefix is omitted, reference is made independently from the A/Gb mode GPRS or Iu mode functionality.\nA/Gb mode: indicates that the text applies only to a system or sub-system which operate in A/Gb mode of operation, i.e. with a functional division that is in accordance with the use of an A or a Gb interface between the radio access network and the core network.\nIu mode: indicates that the text applies only to a system or a sub-system which operates in Iu mode of operation, i.e. with a functional division that is in accordance with the use of an Iu-CS or Iu-PS interface between the radio access network and the core network.\nIP-CAN session: association between a UE and an IP network\nThe association is identified by a UE represented by an IPv4 address and/or an IPv6 prefix together with a UE identity information, if available, and a PDN identity (e.g. APN). An IP-CAN session incorporates one or more IP-CAN bearers. Support for multiple IP-CAN bearers per IP-CAN session is IP-CAN specific. An IP-CAN session exists as long as the related UE IPv4 address and/or IPv6 prefix are established and announced to the IP network.\nEPC based Packet Domain: Packet domain which makes use of EPC nodes (e.g. P-GW, S-GW, etc.).\nPacket Domain Bearer: A transmission path between a UE and a GGSN/P-GW, terminating at the User Plane protocol stack under the IP layers.\nNR RedCap: a 3GPP RAT type Identifier used in the Core Network only, which is a sub-type of NR RAT type, and defined to identify in the Core Network the NR when used by a UE indicating NR Reduced Capability.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "Abbreviations used in the present document are listed in 3GPP TR 21.905 [42]. For the purposes of the present document, the following additional abbreviations apply:\n5QI\t5G QoS Identifier\nAMBR\tAggregate Maximum Bit Rate\nAPN\tAccess Point Name\nARP\tAllocation and Retention Priority\nATM\tAsynchronous Transfer Mode\nAPCO\tAdditional Protocol Configuration Options\nBG\tBorder Gateway\nBM-SC\tBroadcast/Multicast Service Centre\nCHAP\tChallenge Handshake Authentication Protocol\nCIoT\tCellular Internet of Things\nDHCP\tDynamic Host Configuration Protocol\nDHCPv6\tDynamic Host Configuration Protocol version 6\nDNS\tDomain Name System\nDSMIPv6\tDual-Stack MIPv6\nDVMRP\tDistance Vector Multicast Routing Protocol\nEPC\tEvolved Packet Core\nePDG\tEvolved Packet Data Gateway\nEPS\tEvolved Packet System\nFQDN\tFully Qualified Domain Name\nGBR\tGuaranteed Bit Rate\nGFBR\tGuaranteed Flow Bit Rate\nGGSN\tGateway GPRS Support Node\nGTP-U\tGPRS Tunnelling Protocol for user plane\nICMP\tInternet Control Message Protocol\nIETF\tInternet Engineering Task Force\nIGMP\tInternet Group Management Protocol\nIMS\tIP Multimedia Subsystem\nIP\tInternet Protocol\nIPCP\tIP Control Protocol (PPP NCP for IPv4)\nIPv4\tInternet Protocol version 4\nIPv6\tInternet Protocol version 6\nIPV6CP\tIPv6 Control Protocol (PPP NCP for IPv6)\nISDN\tIntegrated Services Digital Network\nISP\tInternet Service Provider\nL2TP\tLayer Two Tunneling Protocol\nLAC\tL2TP Access Concentrator\nLAN\tLocal Area Network\nLNS\tL2TP Network Server\nMBMS\tMultimedia Broadcast/Multicast Service\nMBR\tMaximum Bit Rate\nMFBR\tMaximum Flow Bit Rate\nMIP\tMobile IP\nMLD\tMulticast Listener Discovery\nMME\tMobility Management Entity\nMOSPF\tMulticast Open Shortest Path First\nMS\tMobile Station\nMT\tMobile Terminal\nMTC\tMachine Type Communication\nMTU\tMaximum Transfer Unit\nNAI\tNetwork Access Identifier\nNCGI\tNR Cell Global Identity\nPAP\tPassword Authentication Protocol\nPCC\tPolicy and Charging Control\nPCO\tProtocol Configuration Options\nPCRF\tPolicy and Charging Rules Function\nP-CSCF\tProxy Call Session Control Function\nPDCP\tPacket Data Convergence Protocol\nPDN\tPacket Data Network\nPDU\tProtocol Data Unit\nP-GW\tPDN Gateway\nPGW-C\tPDN Gateway Control plane function\nPGW-U\tPDN Gateway User plane function\nPIM-SM\tProtocol Independent Multicast – Sparse Mode\nPPP\tPoint-to-Point Protocol\nPS\tPacket Switched\nQCI\tQoS Class Identifier\nRADIUS\tRemote Authentication Dial In User Service\nSCEF\tService Capability Exposure Function\nSGSN\tServing GPRS Support Node\nS-GW\tServing Gateway\nSMDS\tSwitched Multimegabit Data Service\nSMF\tSession Management Function\nTCP\tTransmission Control Protocol\nTE\tTerminal Equipment\nTEID\tTunnel End-point Identifier\nTMGI\tTemporary Mobile Group Identity\nTWAN\tTrusted WLAN Access Network\nUDP\tUser Datagram Protocol\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.3\tSymbols",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the following symbols apply:\nGb\tInterface between an SGSN and a BSC.\nGi\tReference point between Packet Domain and an external packet data network.\nGmb\tReference point between GGSN and BM-SC.\nGn\tInterface between two GSNs within the same PLMN.\nGo\tInterface between a GGSN and a PDF.\nGp\tInterface between two GSNs in different PLMNs. The Gp interface allows support of Packet Domain network services across areas served by the co-operating PLMNs.\nGs\tInterface between an SGSN and MSC.\nIu\tInterface between the RNS and the core network. It is also considered as a reference point.\nPk\tReference Point between GGSN and Presence Network Agent.\nR\tThe reference point between a non-ISDN compatible TE and MT. Typically this reference point supports a standard serial interface.\nS2a\tIt provides the user plane with related control and mobility support between trusted non-3GPP IP access and P-GW.\nS2b\tIt provides the user plane with related control and mobility support between ePDG and P-GW.\nS2c\tIt provides the user plane with related control and mobility support between UE and P-GW. This reference point is implemented over trusted and/or untrusted non-3GPP Access and/or 3GPP access.\nS5\tInterface between a S-GW and a P-GW within the same PLMN.\nS8\tInterface between a S-GW and a P-GW in different PLMNs.\nSgi\tThe reference point between the EPC based PLMN and the packet data network.\nSgi-mb\tThe reference point between BM-SC and MBMS GW for MBMS data delivery.\nSGmb\tThe reference point for the control plane between BM-SC and MBMS GW.\nT6a\tReference point used between SCEF and serving MME.\nT6b\tReference point used between SCEF and serving SGSN.\nUm\tThe interface between the MS and the fixed network part in A/Gb mode. The Um interface is the A/Gb mode network interface for providing packet data services over the radio to the MS. The MT part of the MS is used to access the GSM services through this interface.\nUu\tInterface between the mobile station (MS) and the fixed network part in Iu mode. The Uu interface is the Iu mode network interface for providing packet data services over the radio to the MS. The MT part of the MS is used to access the UMTS services through this interface.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tNetwork characteristics",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tKey characteristics of PLMN",
                    "description": "",
                    "summary": "",
                    "text_content": "The PLMN is fully defined in the 3GPP technical specifications. The Packet Domain related key characteristics are found in 3GPP TS 23.060 [3] , 3GPP TS 23.401 [77] and 3GPP TS 23.402 [78].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tKey characteristics of PSDN",
                    "description": "",
                    "summary": "",
                    "text_content": "Void.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.3\tKey characteristics of IP Networks",
                    "description": "",
                    "summary": "",
                    "text_content": "The Internet is a conglomeration of networks utilising a common set of protocols. IP protocols are defined in the relevant IETF STD specifications and RFCs. The networks topologies may be based on LANs (e.g. Ethernet), Point to Point leased lines, PSTN, ISDN, X.25 or WANs using switched technology (e.g. SMDS, ATM).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5\tInterworking Classifications",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tService Interworking",
                    "description": "",
                    "summary": "",
                    "text_content": "Service interworking is required when the Teleservice at the calling and called terminals are different. For Packet Domain, service interworking is not applicable at the Gi/Sgi reference point.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.2\tNetwork Interworking",
                    "description": "",
                    "summary": "",
                    "text_content": "Network interworking is required whenever a PLMN is involved in communications with another network to provide end-to-end communications. The PLMN shall interconnect in a manner consistent with that of a normal Packet Data Network (type defined by the requirements e.g. IP). Interworking appears exactly like that of Packet Data Networks.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.3\tNumbering and Addressing",
                    "description": "",
                    "summary": "",
                    "text_content": "See 3GPP TS 23.003 [40] and the relevant section for IP addressing below.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "6\tAccess reference configuration",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The figures depicted in subclauses 6.2 and 6.3 below are the logical representation of the EPC and the non-EPC based Packet Domains. Physically, an operator’s PLMN may consist of both EPC and non-EPC nodes. In other words, for example, an operator’s PLMN may have both GGSNs and P-GWs; and a Rel-8 SGSN may initiate PDP context activation procedure via both Gn/Gp and S4/S5/S8 reference points.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.2\tAccess Interfaces and Reference Points for non-EPC based Packet Domain",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure 1a shows the relationship between the MS, its terminal equipment and the PLMN network in the non-EPC based overall Packet Domain environment.\n\nThe figure depicts non-EPC based Packet Domain Access Interfaces and Reference Points, illustrating the various network layers and their interconnections.\nFigure 1a: Non-EPC based Packet Domain Access Interfaces and Reference Points\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.3\tAccess Interfaces and Reference Points for EPC based Packet Domain",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure 1b shows the relationship between the UE and the EPS network for both the 3GPP access and the non-3GPP access in the EPC based Packet Domain environment. The S8/S2a/S2b interface includes GTP-based and PMIP-based.\nThe figure depicts the EPC-based Packet Domain Access Interfaces and Reference Points in a 5G network. It illustrates the various interfaces used for data transmission, including the EPC (Evolved Packet Core), which is responsible for packet routing and management. The figure also shows the reference points used to establish communication between different devices, such as the base station (gNB) and the user equipment (UE). The diagram highlights the importance of these components in ensuring efficient and reliable communication in a 5G network.\nFigure 1b: EPC based Packet Domain Access Interfaces and Reference Points\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "7\tInterface to Packet Domain Bearer Services",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tA/Gb mode",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure 2a shows the relationship of the non-EPC based Packet Domain Bearer in A/Gb mode terminating at the SNDCP layer to the rest of the A/Gb mode Packet Domain environment. It is shown for reference purposes only and detailed information can be found in 3GPP TS 23.060 [3].\nFigure 2a illustrates the user plane for Packet Domain services in A/Gb mode, showing the network architecture with multiple layers and services. The figure highlights the use of 100G Ethernet for high-speed data transmission, with 100G-capable switches and routers. The user plane is divided into two layers: the Packet Domain and the Data Domain. The Packet Domain layer supports services such as voice, video, and data, while the Data Domain layer supports data services like file transfer and web browsing. The figure also includes a 100G-capable switch and router, which enables high-speed data transmission and efficient network management.\nFigure 2a: User Plane for Packet Domain services in A/Gb mode\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tIu mode",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure 2b shows the relationship of the non-EPC based Packet Domain Bearer in Iu mode, terminating at the PDCP layer, to the rest of the Iu mode Packet Domain environment. It is shown for reference purposes only and detailed information can be found in 3GPP TS 23.060 [3].\nThe figure depicts a user plane for Packet Domain services in Iu mode, illustrating the network's architecture and the various services that can be accessed.\nFigure 2b: User Plane for Packet Domain services in Iu mode\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.3\tInterface to EPC-based Packet Domain Bearer Services",
                    "description": "",
                    "summary": "",
                    "text_content": "The user plane for EPC based packet domain services can be found in 3GPP TS 23.401 [77] , 3GPP TS 23.402 [78] and 3GPP TS 23.060 [3].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "8\tSubscription checking",
            "description": "The subscription of an MS/UE is checked by the PLMN during IP-CAN session establishment procedure as described in 3GPP TS 23.060 [3], 3GPP TS 23.401 [77] and 3GPP TS 23.402 [78]. The GGSN/P-GW implicitly checks its internal context related to the destination address for each mobile terminated packet. For PDN types other than Non-IP, if there is a context IP-CAN session associated with the IP address the packet shall be forwarded towards the MS/UE; otherwise the packet shall be discarded or rejected depending on the implemented protocol. For PDN type \"Non-IP\", the packet shall be forwarded towards the MS/UE, discarded or rejected depending on the implemented protocol.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "8A\tPrevention of IP spoofing",
            "description": "For PDN types other than \"Non-IP\", if IP spoofing has to be prevented, the GGSN/P-GW shall verify the source IP address of the IP packets issued by the UE and compare it against the address, IPv4 or IPv6, assigned for the IP-CAN session. If the verification fails for a packet,the GGSN/P-GW shall discard the packets and shall be capable to log the event in the security log against the subscriber information (IMSI/MSISDN).\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "9\tMessage Screening",
            "description": "Screening functions reside within the Packet Domain as described in 3GPP TS 22.060 [2], 3GPP TS 23.060 [3], 3GPP TS 23.401 [77] and 3GPP TS 23.402 [78]. Screening may be applicable for only certain protocols. Screening is outside the scope of the present document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "10\tInterworking with PSDN (X.75/X.25)",
            "description": "Figure 3: Void\nFigure 4: Void\nFigure 5: Void\nFigure 6: Void\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "11\tInterworking with PDN (IP)",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "11.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Packet Domain shall support interworking with networks based on the Internet Protocol (IP). These interworked networks may be either intranets or the Internet. Packet Domain may also support interworking with networks handling Non-IP data services.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "11.2\tPDN Interworking Model",
                    "description": "",
                    "summary": "",
                    "text_content": "The Packet Domain can interwork with IP networks and networks handling Non-IP data services. When interworking with the IP networks, the Packet Domain can operate IPv4 and/or IPv6. The interworking point with the IP networks or networks handling Non-IP data services is at the Gi and Sgi reference point. Additionally, the interworking point with network handling Non-IP data services may also be the T6a (T6) reference point for Control Plane CIoT EPS Optimizations (see 3GPP TS 29.128 [110]) . These interworking points are shown in figure 7.\nThe figure depicts a complex network interworking scenario, illustrating the interconnection of various network elements such as IP routers, switches, and network devices. The diagram highlights the importance of network virtualization and the use of network functions virtualization (NFV) to optimize network resources and improve performance. The figure also demonstrates the use of network slicing and network function virtualization (NFV) to create virtual networks and allocate resources efficiently. Overall, the figure provides a comprehensive overview of the interworking of IP networks and the role of virtualization in modern network architecture.\nFigure 7: IP network interworking\nThe GGSN/P-GW for interworking with the IP network is the access point of the Packet Domain (see figure 8). In this case the Packet Domain network will look like any other IP network or subnetwork.\nThe figure depicts the protocol stacks of GGSN and P-GW for IP network interworking, illustrating the interconnection of GGSN and P-GW to facilitate IP network communication.\nFigure 8: The protocol stacks of GGSN and P-GW for the IP network interworking\nTypically in the IP networks, the interworking with subnetworks is done via IP routers. The Gi reference point is between the GGSN and the external IP network; and the Sgi reference point is between the P-GW and the external IP network. From the external IP network’s point of view, the GGSN/P-GW is seen as a normal IP router. The L2 and L1 layers are operator specific.\nIt is out of the scope of the present document to standardise the router functions and the used protocols in the Gi/Sgi reference point.\nInterworking with user defined ISPs and private/public IP networks is subject to interconnect agreements between the network operators.\nNo user data or header compression is done in the GGSN/P-GW.\nBoth the GGSN/P-GW (for both Control Plane and User Plane CIoT EPS Optimizations) and the SCEF (for Control Plane CIoT EPS Optimization) for interworking with the network handling Non-IP data services are the access points of the Packet Domain. See 3GPP TS 23.401 [77] and 3GPP TS 23.060 [3] for further details.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "11.2.1\tAccess to Internet, Intranet or ISP through Packet Domain",
                            "text_content": "The access to Internet, Intranet or ISP may involve specific functions such as user authentication, user’s authorization, end to end encryption between MS and Intranet/ISP, allocation of a dynamic address belonging to the PLMN/Intranet/ISP addressing space, IPv6 address autoconfiguration, etc.\nFor this purpose the Packet Domain may offer:\n-\teither direct transparent access to the Internet; or\n-\ta non transparent access to the Intranet/ISP. In this case the Packet Domain, i.e. the GGSN/P-GW, takes part in the functions listed above.\nThe mechanisms for host configuration and user authentication described in this subclause and its subclauses are applicable for the initial IP-CAN session establishment to allocate IP addresses (IPv4 and/or IPv6) to the MS. For GTP based access, the activation of any subsequent IP-CAN bearers for that IP-CAN session, (i.e.secondary PDP context activation Procedure’, dedicated bearer activation), as well as the use of TFTs, is described in 3GPP TS 23.060 [3], 3GPP TS 23.401 [77].\nThe figure depicts a PDN (Physical-to-Data Network) interworking model, specifically a transparent case, illustrating the interconnection of various network elements such as optical line terminals (OLTs), distributed nodes, and core switches. The model demonstrates the use of redundancy paths to ensure failover reliability and the alignment with SDN principles.\nFigure 9: Example of the PDN Interworking Model, transparent case\nIn figure 9, an example PDN interworking model for transparent access to the Internet is provided for a GGSN and its Gi reference point.\nIn transparent access to the Internet case:\n-\tthe MS is given an IPv4 address and/or an IPv6 prefix belonging to the operator addressing space. The IPv4 address and/or IPv6 prefix is assigned either at subscription in which case it is a static address or at IP-CAN session establishment in which case it is a dynamic address. This IPv4 address and/or IPv6 prefix if applicable is used for packet forwarding between the Internet and the GGSN/P-GW and within the packet domain. With IPv6, Stateless Address Autoconfiguration shall be used to assign an IPv6 address to the MS. These procedures are as described in the IPv6 non-transparent access case except that the addresses belong to the operator addressing space.\n-\tthe MS need not send any authentication request at IP-CAN session establishment procedure and the GGSN/P-GW need not take any part in the user authentication/authorization process.\nThe transparent case provides at least a basic ISP service. As a consequence of this it may therefore provide a bearer service for a tunnel to a private Intranet.\nNote that the remainder of this subclause deals with this specific use-case as depicted in figure 10.\n-\tThe user level configuration may be carried out between the TE and the intranet, the Packet Domain network is transparent to this procedure.\nThe used protocol stack is depicted in figure 10.\nThe figure depicts a transparent access point (TAP) that allows users to access an intranet, illustrating the concept of network visibility and security.\nFigure 10: Transparent access to an Intranet\nIn figure 10, an example for transparent access to an Intranet is provided for a GGSN and its Gi reference point, but the same principle is applicable to EPC.\nThe communication between the PLMN and the Intranet may be performed over any network, even an insecure network e.g. the Internet. There is no specific security protocol between the GGSN and the Intranet because security is ensured on an end to end basis between the MS and the intranet by the \"Intranet Protocol\".\nUser authentication and encryption of user data are done within the \"Intranet Protocol\" if either of them is needed. This \"Intranet Protocol\" may also carry private (IP) addresses belonging to the address space of the Intranet.\nAn example of an \"Intranet Protocol\" is Ipsec (see RFC 1825 [61]). If Ipsec is used for this purpose then Ipsec authentication header or security header may be used for user (data) authentication and for the confidentiality of user data (see RFC 1826 [62] and RFC 1827 [63]). In this case private IP tunnelling within public IP takes place.\nIn this case:\n-\tthe MS is given an address belonging to the Intranet/ISP addressing space. The address is given either at subscription in which case it is a static address or at PDP context activation in which case it is a dynamic address. This address is used for packet forwarding within the GGSN and for packet forwarding on the Intranet/ISP. This requires a link between the GGSN and an address allocation server, like AAA, DHCP, …, belonging to the Intranet/ISP;\n-\tthe MS shall send an authentication request at PDP context activation and the GGSN requests user authentication from a server, like AAA, DHCP, …, belonging to the Intranet/ISP;\n-\tthe protocol configuration options are retrieved (if requested by the MS at PDP context activation) from some server (AAA or DHCP, …) belonging to the Intranet/ISP;\n-\tthe communication between the Packet Domain and the Intranet/ISP may be performed over any network, even an insecure e.g. the Internet. In case of an insecure connection between the GGSN and the Intranet/ISP there may be a specific security protocol in between. This security protocol is defined by mutual agreement between PLMN operator and Intranet/ISP administrator.\nThe figure depicts the signalling plane of a non-transparent case, illustrating the various components and their interactions. The diagram includes a base station (gNB), a user equipment (UE), and a scatterer, highlighting the importance of signal reflection and interference mitigation in 5G networks.\nFigure 11a: Signalling plane of non transparent case\nNOTE: The transport protocol UDP is used for DHCP and RADIUS, and TCP or SCTP are used for Diameter.\nThe following description bullet items describe the signal flow.\n1)\tThe TE sends an AT-command to the MT to set up parameters and enter PPP mode. The MT responds with an AT-response.\n2)\tLCP negotiates Maximum-Receive-Unit and authentication protocol. The negotiated authentication protocol is, either CHAP, PAP or ‘none’. The MT shall try to negotiate for CHAP as first priority.\n3)\tIf the negotiated authentication protocol is either of CHAP or PAP, the TE authenticates itself towards the MT by means of that protocol. The MT stores the necessary authentication data and sends a forced positive acknowledgement of the authentication to the TE.\n4)\tThe TE requests IP configuration by sending the IPCP Configure-Request message to the MT indicating either the static IP address that shall be used or that an IP-address shall be dynamically allocated.\n5)\tThe MT sends the Activate PDP context request message to the SGSN, including the Protocol Configuration Options. The SGSN sends the Create PDP context req message to the chosen GGSN including the unmodified Protocol Configuration Options.\n6)\tThe GGSN deduces from the APN:\n-\tthe server(s) to be used for address allocation, authentication and protocol configuration options retrieval;\n-\tthe protocol like RADIUS, DHCP, … to be used with this / those server(s);\n-\tthe communication and security feature needed to dialogue with this / those server(s) e.g. tunnel, IPSec security association, dial-up connection (using possibly PPP), …\nAs an example the GGSN may use one of the following options:\n-\tRADIUS for authentication and IP-address allocation. The AAA server responds with either an Access-Accept or an Access-Reject to the RADIUS client in the GGSN;\n-\tRADIUS for authentication and DHCP for host configuration and address allocation. The AAA server responds with either an Access-Accept or an Access-Reject to the RADIUS client in the GGSN. After a successful authentication, the DHCP client discovers the DHCP server(s) in the ISP/Intranet and receives host configuration data.\n-\tIf the received Protocol Configurations Options IE contains a PPP IPCP Configure-Request packet, the GGSN shall analyse all the contained IPCP options and their requested values. In accordance with the relevant PPP RFC 1661 [21a] and RFC 1662 [21b] the GGSN shall respond with the following messages:\n-\tzero or one PPP IPCP Configure-Reject packet containing options not supported and options which values cannot be returned;\n-\tzero or one PPP IPCP Configure-Nak packet containing options that are supported but has requested values that are incorrect/unsupported; and\n-\tzero or one PPP IPCP Configure-Ack packet containing options that are supported and has requested values that are correct/supported.\nAny returned PPP IPCP packets shall be contained in the Protocol Configurations Options IE.\n7)\tThe GGSN sends back to the SGSN a Create PDP Context Response message, containing the Protocol Configuration Options IE. The cause value shall be set according to the outcome of the host –authentication and –configuration. A PDP context activation shall not be rejected solely due to the presence of unsupported or incorrect PPP IPCP options or option values, received from the MS in the Protocol Configurations Options IE. The MS may however later decide to immediately deactivate the activated PDP context due to the information received in the Protocol Configurations Options IE received from the network.\n8)\tDepending on the cause value received in the Create PDP Context Response the SGSN sends either an Activate PDP Context Accept or an Activate PDP Context Reject, to the MS.\nIf Protocol Configuration Options are received from the GGSN, the SGSN shall relay those to the MS. The MT sends either the configuration-ack packet (e.g. IPCP Configure Ack in PPP case), the configure-nack packet in case of dynamic address allocation (e.g. IPCP Configure Nack in PPP case), or a link Terminate request (LCP Terminate-Request in PPP case) back to the TE. In the case where a configure-nack packet was sent by the MT, a local negotiation may take place at the R reference point (i.e. the TE proposes the new value to the MT), after which a configuration-ack packet is sent to the TE.\n9)\tIn case a configuration-ack packet was sent to the TE, the link from the TE to the external ISP/Intranet is established and IP packets may be exchanged.\nIn case a link terminate request packet was sent to the TE, the TE and MT negotiates for link termination. The MT may then send a final AT-response to inform the TE about the rejected PDP Context activation.\nA link terminate request packet (such as LCP Terminate-request in PPP case) causes a PDP context deactivation.\nEXAMPLE:\tIn the following example PPP is used as layer 2 protocol over the R reference point.\nThe MT acts as a PPP server and translates Protocol Configuration Options into SM message Ies. GTP-C carries this information unchanged to the GGSN which uses the information e.g. for DHCP or RADIUS authentication and host configuration. The result of the host authentication and configuration is carried via GTP-C to the SGSN which relays the information to the MT. The MT sends an IPCP Configure-Ack to the TE with the appropriate options included.\nThe figure depicts a PDP context activation for the IPv4 Non-transparent case, illustrating the process of determining the appropriate PDP context for a given network scenario. The figure shows a network with multiple layers, including a PDP context, a PDP context activation, and a PDP context selection. The PDP context activation process involves determining the appropriate PDP context based on the network's characteristics, such as the number of layers, the number of PDPs, and the network's traffic patterns. The figure provides a visual representation of the process, making it easier to understand and interpret.\nFigure 11b: PDP Context Activation for the IPv4 Non-transparent case\nIn this case:\n-\ta static or a dynamic IPv4 address belonging to the Intranet/ISP addressing space is allocated to a UE at IP-CAN session establishment. The methods of allocating IP address to the UE are specified in 3GPP TS 23.060 [3], 3GPP TS 23.401 [77] and 3GPP TS 23.402 [78]. The allocated IPv4 address is used for packet forwarding within the P-GW and for packet forwarding on the Intranet/ISP;\n-\tas a part of the IP-CAN session establishment, the P-GW may request user authentication from an external AAA server (i.e. RADIUS, Diameter) belonging to the Intranet/ISP;\n-\tthe IPv4 address allocation to the UE may be performed based on the subscription or a local address pool, which belongs to the Intranet/ISP addressing space, provisioned in the P-GW. The IPv4 address allocation to the UE may also be done via the address allocation servers (i.e. DHCPv4, RADIUS AAA, Diameter AAA) belonging to the Intranet/ISP;\n-\tif requested by the UE at IP-CAN session establishment, the P-GW may retrieve the Protocol Configuration Options or IPv4 configuration parameters from a locally provisioned database in P-GW and/or from some external server (i.e. DHCPv4, RADIUS AAA, Diameter AAA) belonging to the Intranet/ISP;\n-\tthe communication between the Packet Domain and the Intranet/ISP may be performed over any network, even an insecure network ,e.g. the Internet. In case of an insecure connection between the P-GW and the Intranet/ISP, there may be a specific security protocol in between. This security protocol is defined by mutual agreement between PLMN operator and Intranet/ISP administrator.\nTable 0 summarizes the IPv4 address allocation and parameter configuration use cases between the UE and the P-GW that may lead the P-GW to interwork with the external DHCPv4, RADIUS AAA and Diameter AAA servers over Sgi reference point. For detailed description of the signalling flows between the UE and the P-GW, see the references in the table. The detailed description of the signalling use cases that may be triggered between the P-GW and the external servers are specified in this document, as referenced in the table.\nTable 0 : IPv4 address allocation and parameter configuration use cases\n\nWhen using IPv6 Address Autoconfiguration, the process of setting up the access to an Intranet or ISP involves two signalling phases. The first signalling phase is done in the control plane and consists of the PDP context activation or initial attach (e.g. create default bearer) for EPC based access, followed by a second signalling phase done in the user plane.\nThe user plane signalling phase shall be stateless. The stateless procedure, which involves only the MS/UE and the GGSN/P-GW, is described in subclause \"IPv6 Stateless Address Autoconfiguration\".\nFor APNs that are configured for IPv6 address allocation, the GGSN/P-GW shall only use the Prefix part of the IPv6 address for forwarding of mobile terminated IP packets. The size of the prefix shall be according to the maximum prefix length for a global IPv6 address as specified in the IPv6 Addressing Architecture, see RFC 4291 [82].\nThe GGSN/P-GW indicates to the MS/UE that Stateless Autoconfiguration shall be performed by sending Router Advertisements as described in the corresponding subclause below and according to the principles defined in RFC 4861 [89] and RFC 4862 [83].\nFor MS/UE having IPv6, IPv6 Stateless Address Autoconfiguration is mandatory.\nIn this case:\n-\tThe GGSN provides the MS with an IPv6 Prefix belonging to the Intranet/ISP addressing space. A dynamic IPv6 address shall be given using stateless address autoconfiguration. This IPv6 address is used for packet forwarding within the packet domain and for packet forwarding on the Intranet/ISP;\n-\tthe MS may send an authentication request at PDP context activation and the GGSN may request user authentication from a server, e.g. AAA, …, belonging to the Intranet/ISP;\n-\tthe protocol configuration options are retrieved (if requested by the MS at PDP context activation) from some server, e.g. AAA, …, belonging to the Intranet/ISP;\n-\tin order to avoid any conflict between the link-local address of the MS and that of the GGSN, the Interface-Identifier used by the MS to build its link-local address shall be assigned by the GGSN. The GGSN ensures the uniqueness of this interface-identifier. The MT shall then enforce the use of this Interface-Identifier by the TE.\n-\tthe communication between the Packet Domain and the Intranet/ISP may be performed over any network, even an insecure e.g. the Internet. In case of an insecure connection between the GGSN and the Intranet/ISP there may be a specific security protocol over the insecure connection. This security protocol is defined by mutual agreement between PLMN operator and Intranet/ISP administrator.\n-\tthe MS may request for DNS server IPv6 addresses using the PCO IE in e.g. the PDP Context Request message. In that case the GGSN may return the IP address of one or more DNS servers in the PCO in the PDP Context Response message. The DNS address(es) shall be coded in the PCO as specified in 3GPP TS 24.008 [54]. If a list of servers is received, the MS shall adhere to the explicit prioritisation order of the list.\nIn the following signalling flow example, PPP is used as layer 2 protocol over the R reference point. The MT behaves as a PPP server and translates Protocol Configuration Options into SM message Ies. GTP-C carries this information unchanged to the GGSN which uses the information e.g. for RADIUS authentication. The result of the host authentication is carried via GTP-C back to the SGSN, which then relays the result to the MT. The MT finalises the IPV6CP negotiation by sending an IPV6CP Configure-Ack message to the TE with the appropriate options included, e.g. Interface-Identifier. The Interface-Identifier shall be used in the TE to create a link-local address to be able to perform the IPv6 address autoconfiguration (see subclauses 11.2.1.3.2 and 11.2.1.3.3).\n1)\tThe TE sends an AT-command to the MT to set up parameters and enter PPP mode. The MT responds with an AT-response.\n2)\tLCP negotiates Maximum-Receive-Unit and authentication protocol. The negotiated authentication protocol is either CHAP, PAP or ‘none’. The MT shall try to negotiate for CHAP as first priority.\n3)\tIf the negotiated authentication protocol is either of CHAP or PAP, the TE authenticates itself towards the MT by means of that protocol. The MT stores the necessary authentication data and sends a forced positive acknowledgement of the authentication to the TE.\n4)\tThe TE requests IPv6 Interface-Identifier negotiation by sending the IPV6CP Configure-Request message to the MT.\n5)\tThe MT sends the Activate PDP Context Request message to the SGSN, including the Protocol Configuration Options. The Protocol Configuration Options IE may contain negotiated LCP options such as negotiated Authentication Protocol as well as any authentication data previously stored in the MT. It may also contain a request for dynamic configuration of DNS server IPv6 addresses. The MS shall for dynamic address allocation leave PDP Address empty and set PDP Type to IPv6 or IPv4v6. The SGSN sends the Create PDP context request message to the chosen GGSN including the unmodified Protocol Configuration Options.\n6)\tThe GGSN deduces from local configuration data associated with the APN:\n-\tthe source of IPv6 Prefixes (GGSN internal prefix pool, or external address allocation server);\n-\tany server(s) to be used for address allocation, authentication and/or protocol configuration options retrieval (e.g. IMS related configuration, see 3GPP TS 24.229 [47]);\n-\tthe protocol e.g. RADIUS, to be used with the server(s);\n-\tthe communication and security feature needed to communicate with the server(s);\nAs an example the GGSN may use one of the following options:\n-\tGGSN internal Prefix pool for IPv6 prefix allocation and no authentication;\n-\tGGSN internal Prefix pool for IPv6 prefix allocation and RADIUS for authentication. The AAA server responds with either an Access-Accept or an Access-Reject to the RADIUS client in the GGSN;\n-\tRADIUS for authentication and IPv6 prefix allocation. The AAA server responds with either an Access-Accept or an Access-Reject to the RADIUS client in the GGSN;\nNOTE:\tDHCPv6 may be used for IPv6 prefix allocation.\nIPv6 Prefixes in a GGSN internal Prefix pool shall be configurable and structured per APN.\nThe GGSN shall in the PDP Address IE in the Create PDP Context Response return an IPv6 address composed of a Prefix and an Interface-Identifier. The Interface-Identifier may have any value and it does not need to be unique within or across APNs. It shall however not conflict with the Interface-Identifier the GGSN has selected for its own side of the MS-GGSN link. The Prefix assigned by the GGSN or the external AAA server shall be globally or site-local unique.\nThe GGSN shall analyse the requested values of all the protocol options contained in the received Protocol Configurations Options IE. The contents of the Protocol Configurations Options IE sent in the GGSN response shall be in accordance with the relevant standards e.g. the PPP standard RFC 1661 [21a] and RFC 1662 [21b].\n7)\tThe GGSN sends back to the SGSN a Create PDP Context Response message, containing the PDP Address IE and the Protocol Configuration Options IE. The Protocol Configuration Options IE may contain configuration data such as a list of DNS server IPv6 addresses. The cause value shall be set according to the outcome of the host authentication and configuration.\n8)\tDepending on the cause value received in the Create PDP Context Response, the SGSN either stores the PDP Address and sends an Activate PDP Context Accept to the MS or, sends an Activate PDP Context Reject, to the MS.\nIf Protocol Configuration Options are received from the GGSN, the SGSN shall relay those to the MS.\n9)\tThe MT extracts the Interface-Identifier from the address received in the PDP Address IE and ignores the Prefix part. If this Interface-Identifier is identical to the tentative Interface-Identifier indicated in the IPV6CP Configure-Request message sent from the TE, the MT sends an IPV6CP Configure Ack packet, indicating this Interface-Identifier, to the TE.\nIf the Interface-Identifier extracted from the address contained in the PDP Address IE is not identical to the tentative Interface-Identifier indicated in the IPV6CP Configure-Request message sent from the TE, the MT sends an IPV6CP Configure-Nak packet, indicating the Interface-Identifier extracted from the address contained in the PDP Address IE, to the TE. The TE then sends a new IPV6CP Configure-Request message to the MT, indicating the same Interface-Identifier as was indicated in the received IPV6CP Configure Nak (as indicated by the dotted IPV6CP Configure-Request and Configure-Ack in the figure below). Finally the MT responds with a IPV6CP Configure Ack packet.\nIn case a PDP Context Reject was sent to the MS the MT sends an LCP Terminate-Request to the TE.\n10)\tWhen the TE has accepted the Interface-Identifier given by the MT, the user plane link from the TE to the GGSN and the external ISP/Intranet is established and the IPv6 address autoconfiguration may proceed.\nIn case a link terminate request packet was sent to the TE, the TE and MT negotiates for link termination. The MT may then send a final AT-response to inform the TE about the rejected PDP Context activation.\nAn LCP Terminate-request causes a PDP context deactivation.\nDHCPv6 is a protocol used for IPv6 prefix allocation, which is a crucial step in the process of setting up a network. It allows network administrators to allocate unique IP addresses to devices on their network, ensuring that each device has a unique address. DHCPv6 is a more efficient and secure way to allocate IP addresses compared to DHCPv4, which is the older version of the protocol.\nNOTE:\tDHCPv6 may be used for IPv6 prefix allocation.\n\nFigure 11ba: PDP Context Activation for the IPv6 Non-transparent case\nIn this case, the P-GW provides the UE with an IPv6 Prefix belonging to the Intranet/ISP addressing space. A dynamic IPv6 address is given using stateless address autoconfiguration. This IPv6 address is used for packet forwarding within the packet domain and for packet forwarding on the Intranet/ISP.\nWhen a P-GW receives an initial access request (e.g. Create Session Request or Proxy Binding Update) message, the P-GW deduces from local configuration data associated with the APN:\n-\tThe source of IPv6 Prefixes (P-GW internal prefix pool, or external address allocation server);\n-\tAny server(s) to be used for address allocation, authentication and/or protocol configuration options retrieval (e.g. IMS related configuration, see 3GPP TS 24.229 [47]);\n-\tThe protocol, i.e. RADIUS, Diameter or DHCPv6, to be used with the server(s);\n-\tThe communication and security feature needed to communicate with the server(s);\nAs an example the P-GW may use one of the following options:\n-\tP-GW internal Prefix pool for IPv6 prefixes allocation and no authentication;\n-\tP-GW internal Prefix pool for IPv6 prefixes allocation and RADIUS for authentication. The AAA server responds with either an Access-Accept or an Access-Reject to the RADIUS client in the P-GW;\n-\tRADIUS for authentication and IPv6 prefix allocation. The AAA server responds with either an Access-Accept or an Access-Reject to the RADIUS client in the P-GW;\nThe P-GW includes the PDP Address IE in the the initial access response (e.g. Create Session Response or Proxy Binding Acknowledgement) and return an IPv6 address composed of a Prefix and an Interface-Identifier. The Interface-Identifier may have any value and it does not need to be unique within or across APNs. It shall however not conflict with the Interface-Identifier that the P-GW has selected for its own side of the UE-P-GW link. The Prefix assigned by the P-GW or the external AAA server shall be globally or site-local unique (see the Note in subclause 11.3 of this document regarding the usage of site-local addresses).\nTable 0.a summarizes the IPv6 prefix allocation and parameter configuration use cases between the UE and the P-GW that may lead the P-GW to interwork with the external RADIUS AAA, Diameter AAA and DHCPv6 servers over Sgi reference point. For detailed description of the signalling flows between the UE and the P-GW, see the references in the table. The detailed description of the signalling use cases that may be triggered between the P-GW and the external servers are specified in this document, as referenced in the table.\nTable 0.a : IPv6 prefix allocation and parameter configuration use cases\n\nAs described in 3GPP TS 23.060 [3], the IPv6 prefix of a PDP Context of PDP type IPv6 or IPv4v6 activated by means of the IPv6 Stateless Address Autoconfiguration Procedure is uniquely identified by the prefix part of the IPv6 address only. The MS may select any value for the Interface-Identifier part of the address. The only exception is the Interface-Identifier for the link-local address used by the MS (see RFC 4291 [82]). This Interface-Identifier shall be assigned by the GGSN to avoid any conflict between the link-local address of the MS and that of the GGSN itself. This is described in subclause \"IPv6 PDP Context Activation\" above.\nFor IPv6 the PDP Context Activation phase is followed by an address autoconfiguration phase. The procedure describing APNs configured to use Stateless Address Autoconfiguration, may be as follows:\n1)\tAfter the first phase of setting up IPv6 access to an Intranet or ISP, the MS shall use the IPv6 Interface-Identifier, as provided by the GGSN, to create its IPv6 Link-Local Unicast Address according to RFC 4291 [82].\nBefore the MS can communicate with other hosts or Mses on the Intranet/ISP, the MS must obtain an IPv6 Global or Site-Local Unicast Address. The simplest way is the IPv6 Stateless Address Autoconfiguration procedure described below and in 3GPP TS 23.060 [3]. The procedure is consistent with RFC 4862 [83].\nThe procedure below takes place through signalling in the user plane. It is done on the link between the MS and the GGSN. From the MS perspective the GGSN is now the first router on the link.\n2)\tAfter the GGSN has sent a Create PDP Context Response message to the SGSN, it shall start sending Router Advertisements periodically on the new MS-GGSN link established by the PDP Context. The MS may issue a Router Solicitation directly after the user plane establishment. This shall trigger the GGSN to send a Router Advertisement immediately.\nTo indicate to the MS that stateless address autoconfiguration shall be performed, the GGSN shall leave the M-flag cleared in the Router Advertisement messages. The GGSN may set the O-flag if there are additional configuration parameters that need to be fetched by the MS (see below).\nThe Prefix sent in the Router Advertisements shall be identical to the Prefix returned in the Create PDP Context Response. The Prefix is contained in the Prefix Information Option of the Router Advertisements and shall have the A-flag set (\"Autonomous address configuration flag\") and the L-flag cleared (i.e. the prefix should not be used for on-link determination). The lifetime of the prefix shall be set to infinity. In practice, the lifetime of a Prefix will be the lifetime of its PDP Context. There shall be exactly one Prefix included in the Router Advertisements.\nThe handling of Router Advertisements shall be consistent with what is specified in RFC 4861 [89]. For the MS-GGSN link however, some specific handling shall apply. The randomisation part to determine when Router Advertisements shall be sent may be omitted since the GGSN is the only router on the link. Furthermore, some 3GPP specific protocol constants and default values shall apply (see subclause \"IPv6 Router Configuration Variables in the GGSN\"). These relate to the periodicity of the Router Advertisements initially and during continued operation. The motivation for this is to have a faster user-plane set-up even in bad radio conditions and to minimize MS power consumption during long continued operation.\n3)\tWhen creating a Global or Site-Local Unicast Address, the MS may use the Interface-Identifier received during the PDP Context Activation phase or it may generate a new Interface-Identifier. There is no restriction on the value of the Interface-Identifier of the Global or Site-Local Unicast Address, since the Prefix is unique. Interface-Identifiers shall in any case be 64-bit long.\nSince the GGSN guarantees that the Prefix is unique, the MS does not need to perform any Duplicate Address Detection on addresses it creates. That is, the ‘DupAddrDetectTransmits’ variable in the MS should have a value of zero. If the MS finds more than one Prefix in the Router Advertisement message, it shall only consider the first one and silently discard the others. The GGSN shall not generate any globally unique IPv6 addresses for itself using the Prefix assigned to the MS in the Router Advertisement.\nIf the O-flag (\"Other configuration flag\") was set in the Router Advertisement, the MS may start a DHCP session to retrieve additional configuration parameters. See subclause 13.2.2 \"Other configuration by the Intranet or ISP\". If the MS is not DHCP capable, the O-flag may be ignored.\nIPv6 Stateless Address Autoconfiguration (SAAC) is a feature in IPv6 that allows a network to automatically configure a new address for a device without requiring a new configuration. This feature is beneficial for network administrators as it simplifies the process of assigning addresses to devices and reduces the need for manual configuration. SAAC is particularly useful in scenarios where a device is constantly changing its IP address, such as in a mobile network where devices may be connected to multiple base stations. By using SAAC, network administrators can ensure that devices are assigned with the correct IP address, reducing the risk of network errors and improving the overall network performance.\nFigure 11bb: IPv6 Stateless Address Autoconfiguration\nThis subclause describes the signalling flows for the IPv6 Stateless Address Autoconfiguration procedures for EPC, in the case of using GTP-based S5/S8/S2a, and PMIP-based S5/S8/S2a. The procedures are based on the descriptions in TS 23.401 [77] and TS 23.402 [78]. Subclause 11.2.3.1a lists the use cases between the UE to the P-GW that may trigger the P-GW to interwork with the external PDNs for IPv6 Prefix allocation.\nIPv6 prefix is delivered to UE in Router Advertisement message from the access router, in the process of IPv6 Stateless Address Autoconfiguration.\nIn the procedure in the cases of using GTP-based S5/S8, P-GW acts as an access router, and allocates to a UE a globally unique /64 IPv6 prefix if the PLMN allocates the prefix, or P-GW retrieves IPv6 prefix from an external PDN if one is allocated by the external PDN and advertises it to the UE.  In the latter procedure, P-GW uses RADIUS, Diameter or DHCPv6 protocol for the retrieval of an IPv6 prefix.\nFollowing is the flow for IPv6 Stateless Address Autoconfiguration for EPC using GTP-based S5/S8.\n1.\tUE initiates the Attach procedure, indicating ‘IPv6’ or ‘IPv4v6’ for PDN type in PDP type information element.\n2.\tMME requests for Default Bearer creation by sending Create Session Request to the S-GW.\n2x. The S-GW sends Create Session Request to the P-GW.\n3.\tP-GW retrieves IPv6 prefix using RADIUS, Diameter, or DHCPv6 mechanism. This procedure is performed when an external PDN allocates an IPv6 prefix.\n4.\tThe P-GW sends Create Session Response. It includes the IPv6 interface identifier I IPv6 prefix.\n5.\tS-GW sends Create Session Response message to the MME. It includes the IPv6 interface identifier I IPv6 prefix.\n5x. The MME sends Attach Accept message to the UE without the IPv6 prefix. The UE shall ignore the IPv6 prefix if it receives one in the message.\n6.\tAfter receiving the Attach Accept message, the UE may send a Router Solicitation to the P-GW to solicit a Router Advertisement message.\n7.\tThe P-GW sends a Router Advertisement message to the UE, solicited or unsolicited. It shall include an IPv6 prefix in Prefix Information option field of the message. The prefix is the same as the one in the Attach Accept message, if it is provided during the default bearer establishment. For the handling of M, O, L and A flags, and the lifetime of the prefix in the Router Advertisement message, follow the description in subclause 11.2.1.3.2.\nIPv6 Stateless Address Autoconfiguration (SAAC) is a feature in IPv6 that allows a network to automatically configure its address space based on the network's needs. This feature is particularly useful for networks that require a large number of addresses, such as those in the Internet, and can be used to improve network performance and reduce the need for manual configuration. SAAC is a key component of the IPv6 standard and is designed to be easy to use and implement.\nFigure 11bc: IPv6 Stateless Address Autoconfiguration for GTP-based S5/S8\nIf PMIP-based S5/S8 is used, S-GW acts as an access router. Therefore, it is responsible for receiving Router Solicitation from and sending Router Advertisement message to the UE. Other than this, procedure is the same as the case of using GTP-based S5/S8; P-GW allocates, or retrieves an IPv6 prefix from the external PDN.  The prefix is delivered from the P-GW to the S-GW in the IPv6 Home Network Prefix Option IE of a Proxy Binding Ackowledgement message.\nIn addition, the S-GW shall initiate sending the IPv6 Router Advertisement message (either solicited or unsolicited) to the UE once the PDN connection with PDN type IPv4v6 or IPv6 is setup after the procedure of E-UTRAN initial Attach, UE requested PDN connectivity, intra-3GPP access handover with Serving GW relocation, or handover from non-3GPP IP Access with S2a/S2b to 3GPP Access.\nFollowing diagram shows the case where PMIP-based S5/S8 is used.\nThe figure depicts a simplified representation of IPv6 Stateless Address Autoconfiguration (SAE) for PMIP-based S5/S8, which is a method used in IPv6 networks to automatically configure the IP address of a device. The figure shows the various components involved in the process, including the IPv6 address, the PMIP protocol, and the S5/S8 interface. The SAE process is crucial for ensuring network stability and reliability, as it allows devices to automatically update their IP addresses based on the network conditions.\nFigure 11bd: IPv6 Stateless Address Autoconfiguration for PMIP-based S5/S8\nFor trusted non-3GPP accesses, the non-3GPP network supports prefix advertisement for IPv6 prefix received from the P-GW in PMIPv6 Proxy Binding Acknowledgement. If the trusted non-3GPP access network is a WLAN network, for GTP/PMIP –based S2a, TWAN acts as an access router. Therefore, TWAN is responsible for receiving Router Solicitation from and sending Router Advertisement message to the UE. Other than this, procedure is the same as the case of using GTP/PMIP-based S5/S8; P-GW allocates, or retrieves an IPv6 prefix from the external PDN. The prefix is delivered from the P-GW to the TWAN in the IPv6 Home Network Prefix Option IE of a Proxy Binding Ackowledgement message or in the PDN Address Allocation IE of Create Session Response message.\nFollowing diagram shows the case for trusted non-3GPP access network for WLAN access where GTP/PMIP-based S2a is used.\nIPv6 Stateless Address Autoconfiguration (SA) is a feature in IPv6 that allows a network to automatically configure a new address for a device when it is added to the network. This feature is used in trusted WLAN access for GTP/PMIP-based S2a, ensuring that devices can be added to the network without requiring manual configuration.\nFigure 11be: IPv6 Stateless Address Autoconfiguration for trusted WLAN access for GTP/PMIP-based S2a\nThe P-GW ensures that the advertised IPv6 prefix is globally unique. Regarding the handling of Duplicate Address Detection, follow subclause 11.2.1.3.2.\nThe UE constructs its full IPv6 address in accordance with RFC 4862[83]. For the handling of IPv6 interface identifier, refer to subclause 11.2.1.3.2.\nIf the P-GW, S-GW and TWAN receive Neighbor Solicitation message from the UE, it shall answer with Neighbor Advertisement message.\nTo renew the allocated IPv6 prefix, the P-GW (GTP based S5/S8), S-GW (PMIPv6 based S5/S8) or TWAN (GTP/PMIP based S2a) shall send an IPv6 Router Advertisement (solicited or unsolicited) to the UE with the same assigned IPv6 prefix and and new non-zero values in preferred and valid lifetime fields for the PDN connection (PDN type IPv4v6 or IPv6), before the Router Advertisement lifetime and prefix lifetime expiry, as specified in IETF RFC 4861 [89]. When sending the IPv6 Router Advertisement message, the S-GW may trigger the paging (e.g. by sending a Downlink Data Notification message to the MME) if the UE is in idle state. In order to reduce paging an idle UE to deliver RA,  the Router Advertisement lifetime and IPv6 prefix lifetime shall be configured accordingly.\nIf a UE supports multiple PDN connections functionality, it can connect to multiple P-GWs simultaneously, or it can access multiple PDNs through a single P-GW. In the former case, the IPv6 prefix allocated for its default bearer is used for the UE’s dedicated bearers toward the same PDN. In the latter case, IPv6 Stateless Address Autoconfiguration procedure is applied for each PDN connection.\nVoid.\nFigure 11bc : Void\nFor IPv6 Address Autoconfiguration to work properly , network entities which act as an access router towards the MS/UE, i.e. PDN GW, Serving GW, ePDG and TWAN, shall be consistent with the RFCs specifying this process (for example RFC 4862 [83] and RFC 4861 [89]), unless stated otherwise in this or other 3GPP specifications.\nRFC 4861 [89] specifies a set of conceptual router configuration variables. Some of these variables require particular attention in GPRS and EPC in order to preserve radio resources and MS/UE power consumption while still allowing for appropriate robustness and fast user-plane set-up time even in bad radio conditions, or simply because they have a particular meaning in GPRS and EPC. These particular variables are listed below with appropriate (default) values and shall be configurable per APN. The values specified hereafter are specific to GPRS and EPC, and supersede those specified in RFC 4861 [89].\nMaxRtrAdvInterval\nShall have a default value of 21 600 s (6 h).\nMinRtrAdvInterval\nShall have a default value of 0,75 × MaxRtrAdvInterval i.e.16 200 s (4,5 h).\nAdvValidLifetime\nShall have a value giving Prefixes infinite lifetime, i.e. 0xFFFFFFFF. The assigned prefix remains Preferred until PDP Context/Bearer Deactivation.\nAdvPreferredLifetime\nShall have a value giving Prefixes infinite lifetime, i.e. 0xFFFFFFFF. The assigned prefix remains Preferred until PDP Context/Bearer Deactivation.\nRFC 4861 [89] also specifies a number of protocol constants. The following shall have specific values for GPRS and EPC:\nMAX_INITIAL_RTR_ADVERT_INTERVAL\nThis constant may be a variable within GPRS and EPC. It may have a value that gradually increases (exponentially or by some other means) with the number of initial Router Advertisements sent. This will enable a fast set-up of the MS-GGSN or MS/UE-PDN GW/Serving GW/ePDG/TWAN links in most cases, while still allowing the MS/UE to receive a Router Advertisement within the initial phase, even in case of bad radio conditions or slow response time, without having to send a large number of initial Router Advertisements.\nMAX_INITIAL_RTR_ADVERTISEMENTS\nThis is the number of Router Advertisements sent during the initial phase after the MS-GGSN or MS/UE-PDN GW/Serving GW/ePDG/TWAN links have been established. The value of this constant shall be chosen carefully, and in conjunction with MAX_INITIAL_RTR_ADVERT_INTERVAL, so as to not overload the radio interface while still allowing the MS/UE to complete its configuration in a reasonable delay. For instance, the default value could be chosen so that initial Router Advertisements are sent for at least 30 s.\nAfter the initial phase, the periodicity is controlled by the MaxRtrAdvInterval and the MinRtrAdvInterval constants.\nOptionally, a single network prefix shorter than the default /64 prefix may be assigned to a PDN connection. In this case, the /64 default prefix used for IPv6 stateless autoconfiguration will be allocated from this network prefix; the remaining address space from the network prefix can be delegated to the PDN connection using prefix delegation after the PDP context activation/default bearer establishment and IPv6 prefix allocation via IPv6 stateless address autoconfiguration as defined in clause 11.2.1.3.2/11.2.1.3.2a. When PLMN based parameter configuration is used, the GGSN / PDN GW provides the requested IPv6 prefix from a locally provisioned pool. When external PDN based IPv6 prefix allocation is used, the GGSN / PDN GW may obtain the prefix from the external PDN as per subclauses 16.4 and 16a.4.\nFor the detailed description of the UE uses DHCPv6 to request additional IPv6 prefixes refer to 3GPP TS 23.060 [3] and 3GPP TS 23.401 [77].\nGeneral\nA way to allow users to roam from one environment to another, between fixed and mobile, between public and private as well as between different public systems is to use Mobile IP RFC 3344 [30]. Mobile IP (MIP) is a mobility management protocol developed by IETF. The Mobile IP Foreign Agent (FA) RFC 3344 [30] is located in the Core Network in the GGSN. MIP also uses a Home Agent (HA) RFC 3344 [30] which may or may not be located in a PLMN network.\nInterworking model for MIP\nA FA is located in the GGSN. The interface between the GGSN and the FA will probably not be standardised as the GGSN/FA is considered being one integrated node. The mapping between these two is a matter of implementation. Each FA must be configured with at least one care-of address. In addition a FA must maintain a list that combines IP addresses with TEIDs of all the visiting MSs that have registered with the FA. IP packets destined for the MS are intercepted by the HA and tunneled to the MS’s care-of address, i.e. the FA. The FA de-tunnels the packets and forwards the packets to the MS. Mobile IP related signalling between the MS and the FA is done in the user plane. MIP registration messages RFC 3344 [30] are sent with UDP.\n\nFigure 11c: The protocol stacks for the Gi IP reference point in the MIP signalling plane\n\nThe figure depicts a protocol stack for user access with MIP (Multi-Input Multi-Output), illustrating the various components involved in user access. The stack includes a user interface (UI), a protocol stack, and a protocol stack for access control (AC). The UI is designed to provide a user-friendly interface for users to interact with the system, while the protocol stack handles the communication between the user and the system. The AC component ensures that only authorized users can access the system, preventing unauthorized access and unauthorized data transfer.\nFigure 11d: Protocol stacks for user access with MIP\nIn figure 11d: \"(Tunneling)\" is intended to show asymmetric traffic flow. Tunneling (IP-in-IP) is only used in the direction from the ISP towards the MT.\nAuthentication of the user is supported in Mobile IPv4. This authentication mechanism may involve communication with an authentication server (e.g. RADIUS), although this is not shown in figure 11d.\nAddress allocation – at PDP context activation no IP address is allocated to the MS indicated by 0.0.0.0. in the \"Requested PDP Address\" field. If the MS does not have a static IP address which it could register with the HA, it will acquire a dynamic IP address from the HA RFC 2794 [25]. After completion of the PDP activation the SGSN is informed of the assigned IP address by means of the GGSN initiated PDP Context Modification Procedure.\nAn example of a signalling scheme, shown in figure 11e, is described below. In this example the MS is separated into a TE and MT, with AT commands and PPP used in-between (see 3GPP TS 27.060 [10]). The PS attach procedures have been omitted for clarity.\nThe figure depicts a simplified representation of a PDP context activation with Mobile IP registration, illustrating the process of attaching a PS to a network. The figure includes a PS, a mobile IP registration (MIP) procedure, and a PS attach procedure. The MIP procedure involves the use of a mobile IP address, which is a unique identifier for a mobile device. The PS attach procedure is a crucial step in the process, as it ensures that the PS is properly connected to the network. The figure provides a clear and concise visual representation of the PDP context activation process, making it easier to understand and follow.\nFigure 11e: Example of PDP Context activation with Mobile IP registration\n(the PS attach procedure not included)\n1.\tThe AT command carries parameters that the MT needs to request the PDP Context Activation. The important parameter here, is the APN (Access Point Name), see clause A below. The AT command is followed by a setup of the PPP connection between the MT and the TE.\n2.\tAs part of the PPP connection, LCP negotiates Maximum-Receive-Unit between the TE and the MT. No PPP authentication is required when using MIPv4.\n3.\tAs part of the PPP connection, the TE sends an IPCP Configure Request using the MIPv4 configuration option (see RFC 2290 [37]). The TE sends either its Home Address or a null address (i.e. 0.0.0.0) if the Network Address identifier is used (see RFC 2794 [25]).\n4.\tThe MT sends the \"Activate PDP Context Request\" to the SGSN. The message includes various parameters of which the \"APN\" (Access Point Name) and the \"Requested PDP Address\" are of interest here. The TE/MT may use APN to select a reference point to a certain external network or to select a service. APN is a logical name referring to the external packet data network or to a service that the subscriber wishes to connect to. The \"Requested PDP Address\" should be omitted for all MSs using Mobile IP. This is done irrespective of if the TE has a permanently assigned Mobile IP address from its Mobile IP home network, a previously assigned dynamic home address from its Mobile IP home network or if it wishes the Mobile IP home network to allocate a \"new\" dynamic home address.\nA.\tThe SGSN will base the choice of GGSN based on the APN that is given by the MS.\n5.\tThe SGSN requests the selected GGSN to set up a PDP Context for the MS. The PDP address and APN fields are the same as in the \"Activate PDP Context Request\" message.\n6.\tA Create PDP Context Response is sent from the GGSN/FA to the SGSN. If the creation of PDP Context was successful, some parameters will be returned to the SGSN, if not, an error code will be returned. If the GGSN has been configured, by the operator, to use a Foreign Agent for the requested APN, the PDP address returned by the GGSN shall be set to 0.0.0.0. indicating that the PDP address shall be reset by the MS with a Home Agent after the PDP context activation procedure.\n7.\tThe Activate PDP Context Accept message is sent by the SGSN to the MT and contains similar information as the Create PDP Context Response message.\n8.\tThe MT sends an IPCP Configure Ack to the TE in order to terminate the PPP connection phase.\n9.\tThe Agent Advertisement RFC 3344 [30] is an ICMP (Internet Control Message Protocol) Router Advertisement message with a mobility agent advertisement extension. The latter part contains parameters of the FA that the mobile node needs, among those are one or more care-of addresses that the FA offers. This message should be sent, in the Packet Domain user plane, as an IP limited broadcast message, i.e. destination address 255.255.255.255, however only on the TEID for the requesting MS to avoid broadcast over the radio interface.\n10.\tThe Mobile IP Registration Request is sent from the mobile node to the GGSN/FA across the Packet Domain backbone as user traffic. The mobile node includes its (permanent) home address as a parameter RFC 3344 [30]. Alternatively, it can request a temporary address assigned by the home network by sending 0.0.0.0 as its home address, and include the Network Access Identifier (NAI) in a Mobile-Node-NAI Extension RFC 2794 [25] and RFC 2486 [31].\n11.\tThe FA forwards the Mobile IP Registration Request to the home network of the mobile node, where a home agent (HA) processes it. Meanwhile, the GGSN/FA needs to store the home address of the mobile node or the NAI and the local link address of the MS, i.e. the TEID (Tunnel Endpoint ID).\n12.\tThe Registration Reply is sent from the home network to the FA, which extracts the information it needs and forwards the message to the mobile node in the Packet Domain user plane. As the FA/GGSN knows the TEID and the NAI or home address, it can pass it on to the correct MS.\nB.\tThe GGSN/FA extracts the home address from the Mobile IP Registration Reply message and updates its GGSN PDP Context.\n13.\tThe GGSN triggers a \"GGSN initiated PDP Context modification procedure\" in order to update the PDP address in the SGSN and in the MT.\n3GPP and non-3GPP accesses provide IP services for a MS/UE. The GGSN/P-GW endpoint is a GTPv1-U tunnel (controlled by GTP Gn/Gp or S5/S8/S2a/S2b) or IP tunnel (controlled by S5/S8/S2a/S2b PMIPv6 or employed by a UE with MIPv4 or DSMIPv6).\nThe MTU of the IP tunnel on the MS/UE side of the IP link may be different than the MTU of the IP link connecting the GGSN/P-GW to the PDN. As a result IP packets crossing the Gi/Sgi interface may need to be fragmented. Unnecessary fragmentation should be avoided when possible due to the following;\n-\tFragmentation is bandwidth inefficient, since the complete IP header is duplicated in each fragment.\n-\tFragmentation is CPU intensive since more fragments require more processing at IP endpoints and IP routers. It also requires additional memory at the receiver.\n-\tIf one fragment is lost, the complete IP packet has to be discarded. The reason is there is no selective retransmission of IP fragments provided in IPv4 or IPv6.\nTo avoid unnecessary fragmenting of IP packets the MS/UE, or a server in an external IP network, may find out the end-to-end MTU by path MTU discovery and hence fragment correctly at the source. IP Fragmentation on Gi/Sgi shall be handled according to IETF RFC 791 [16] and IETF RFC 2460 [49]. The GGSN/P-GW shall enforce the MTU of IP packets to/from the MS/UE based on IETF RFC 791 [16] and IETF RFC 2460 [49].\nControl plane and user plane separation of PGW as PGW-C and PGW-U, has been introduced as described in 3GPP TS 23.214 [117].\nFor UE IP address from the DN AAA server in the external PDN: If the AAA server in the external PDN is reachable only via the PGW-U, the PGW-U forward all the Diameter or RADIUS messages between the DN AAA server in the external PDN and the PGW-C, according to 3GPP TS 29.244 [114].\nFor UE IP address from DHCPv4/v6 server in the external PDN: If the DHCPv4/v6 server in the external PDN is reachable only via the PGW-U, the PGW-U forward all the DHCPv4/v6 messages between the DHCPv4/v6 server in the external PDN and the PGW-C. according to 3GPP TS 29.244 [114].\nNOTE:\tIf the DN AAA server or the DHCPv4/v6 server in the external PDN is reachable directly, then the PGW-C communicates with it directly, without involving the PGW-U.\nL2TP (described in IETF RFC 2661 [118]) is a standard method for tunneling encapsulated Point-to-Point Protocol (PPP) frames over an IP network. L2TP operates between two L2TP endpoints (LAC and LNS), and tunnels PPP-encapsulated IP traffic between these endpoints. L2TP runs over UDP/IP and was originally defined for systems where PPP is used by an end-device to connect to a network (e.g. via DSL connections, or 2G/3G PPP PDP context). In these cases, a LAC could be deployed in the network (e.g. in a BNG or GGSN/PGW) to tunnel the PPP traffic to a server (LNS) over an IP network.\nFor CUPS with the UE using IP PDN connection, the PPP functionality that is required to use L2TP is instead supported by the PGW-U, as illustrated in below figure. Upon receiving a PDN connection session establishment request from the UE via MME and SGW-C, PGW-C may depend on local L2TP configuration per APN or the received L2TP information from a DN AAA server in Access-Accept message, request the PGW-U to setup L2TP tunnel towards an L2TP network server (LNS) in the external DN and tunnel the PDN Connection user plane traffic in this L2TP tunnel. In this case the PGW-U acts as a L2TP access concentrator (LAC).\nTo enable this, the PGW-C may provide L2TP tunnel information to the PGW-U as LAC, such as LNS IP address as described in 3GPP TS 29.244 [114]. This L2TP tunnel information may be configured on the PGW-C as part of the APN configuration or received from the DN-AAA server. Alternatively, the L2TP tunnel parameters may be configured in the PGW-U. The L2TP tunnel parameters include necessary parameters for setting up L2TP tunnel towards the LNS (e.g. LNS address, tunnel password).\nIn addition, the PGW-C may provide PAP/CHAP authentication information to the PGW-U, for use in L2TP session establishment, in case it was received from the UE in the PCO or ePCO IE of the PDN Connection establishment request message.\nWhen L2TP is to be used for a PDN Connection, the PGW-C may select a PGW-U and requests the UE IP address to be allocated by LNS according to 3GPP TS 29.244 [114], the PGW-U (LAC) may retrieve this IP address from the LNS.\nThe figure depicts a L2TP tunnel between a CUPS (Client Unicast Protocol Server) and an external DN (Domain Name Server). The tunnel is designed to provide secure communication between the two endpoints, ensuring that sensitive data is transmitted securely. The tunnel is implemented using L2TP (Layer 2 Tunneling Protocol), which is a protocol used for data transmission over a network. The tunnel is implemented using a L2TP tunnel, which is a type of L2TP tunnel that is used to establish a secure connection between two devices. The tunnel is designed to provide a secure connection between the CUPS and the external DN, ensuring that sensitive data is transmitted securely.\nFigure 11f: L2TP Tunnel between CUPS and external DN\nBelow figure describes the L2TP connection procedures between CUPS and external DN, upon the UE is accessed in EPS and the PGW-C and PGW-U has been negotiated supporting L2TP feature.\nThe figure depicts the L2TP connection procedures between CUPS and external DN, illustrating the steps involved in establishing a secure and reliable VPN connection.\nFigure 11g: L2TP connection procedures between CUPS and external DN\n0.\tThe PGW-C and the PGW-U negotiated supporting L2TP feature as specified in 3GPP TS 29.244 [114].\n1.\tThe PGW-C receives a PDN Connection session establishment request from the UE via MME and SGW-C.\nThe UE may include the authentication information for PAP and/or CHAP in PCO or ePCO IE. The PGW-C may locally configure the UE authentication information for a given APN.\nThe PGW-C may determine that an L2TP session is required for the PDN Connection session based on local configured L2TP parameters per APN.\n2.\tThe PGW-C may receive the L2TP Tunnel parameters (e.g. LNS IP address or FQDN, tunnel password) from the DN-AAA server in Access-Accept message or Diameter AAA message, or local configured.\n3.\tIf L2TP protocol is determined to support the PDN connection, the PGW-C selects a PGW-U supporting L2TP and be configured with the LAC name/addresses and then requests the PGW-U to setup an L2TP tunnel if needed and/or L2TP session towards the L2TP network server (LNS).\nThe PGW-C sends PFCP Session Establishment Request to the PGW-U, which may include L2TP Tunnel Information for setting up a L2TP tunnel and L2TP session information to setup a L2TP session, together with the information for authentication used during L2TP Tunnel setup, as well as for L2TP session.\nThe L2TP Tunnel Information includes LNS IPv4 address or IPv6 address of LNS, Tunnel Password.\nThe L2TP Session Information includes specific information related to the PDN Connection, e.g. a Calling Number which may be set to UE's MSISDN, an indication to instruct that the PGW-U shall request the LNS to allocate an IP address for the PDN session, indications to instruct that the PGW-U shall request the LNS to provide DNS server addresses or NBNS server addresses etc. as specified in 3GPP TS 29.244 [114].\n4.\tThe PGW-U checks if any existing L2TP tunnel can be used to serve the PDN Connection according to the information provided in the L2TP Tunnel Information. \n\nIf the PGW-U decides to setup a new L2TP tunnel, it initiates L2TP Tunnel establishment by sending an SCCRQ (Start-Control-Connection-Request) message towards the LNS, the PGW-U will allocate a Tunnel ID, and it may include a CHAP Challenge to authenticate the LNS. The Challenge and Challenge Response (to be included in SCCCN) is produced by the PGW-U using the Tunnel Password received from the PGW-C.\nThe LNS responds with an SCCRP (Start-Control-Connection-Reply) message, containing its allocated Tunnel ID and a CHAP Challenge Response to the Challenge in SCCRQ.\nThe PGW-U then responds with a Challenge response for tunnel authentication in the SCCCN (Start-Control-Connection-Connected) message. An L2TP tunnel is established after the tunnel authentication is successful, with the reception of the SCCCN message sent by the PGW-U to the LNS.\nIf the PGW-U decides to use an already existing L2TP tunnel for the requested PDN Connection from the PGW-C, it proceeds with step 5 below directly without current step.\n5.\tOnce the L2TP Tunnel is established (or already present) between the PGW-U and the LNS for the PDN Connection requested by the UE, the PGW-U proceeds with L2TP session setup towards the LNS.\nThe PGW-U sends an ICRQ (Incoming-Call-Request) message towards the LNS, which contains the Tunnel ID assigned by the LNS, its assigned Session ID, and optionally, the Calling Number and Called Number. The LNS responds with an ICRP (Incoming-Call-Reply) message and provides the Session ID assigned by it to the LAC.\nThe PGW-U then sends an ICCN (Incoming-Call-Connected) message. If proxy LCP and authentication are employed, the ICCN message includes the link control parameters (e.g. MRU) and UE authentication information sent from the PGW-C which was received via PCO or ePCO IE in step 1. In addition, the PGW-U (LAC) will act as a PPP endpoint to use IPCP to request UE IP Address, DNS server address and/or NBNS server address(es).\nThe LCP renegotiation may by triggered by the LNS after receiving the ICCN message. If so, the LAC and LNS will use PPP LCP to communicate link specific control parameter (e.g. MRU), and indicate authentication type, then either PPP PAP/CHAP takes place. The PPP IPCP transactions takes places to retrieve UE IP Address, DNS server address and/or NBNS server address.\n6.\tThe status of the L2TP session setup is sent by the PGW-U to the PGW-C in a PFCP Session Establishment Response.\n7.\tThe PGW-C sends a PDU Session Establishment Response to the UE and the user data session is initiated, which may contain the DNS and NBNS Server information.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 0 : IPv4 address allocation and parameter configuration use cases",
                                    "table number": 1,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 0.a : IPv6 prefix allocation and parameter configuration use cases",
                                    "table number": 2,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "11.2.2\tAccess to networks handling Non-IP data services through Packet Domain",
                            "text_content": "The support of Non-IP data is part of the CIoT EPS optimisations (see 3GPP TS 23.401 [77]) and 3GPP TS 23.060 [3]). A PDN/PDP Type \"Non-IP\" is used for Non-IP data. The Non-IP data delivery to the network handling Non-IP data services is accomplished by one of two mechanisms:\n-\tDelivery using SCEF\n-\tDelivery using a Point-to-Point (PtP) SGi tunnel\nData delivery using SCEF is further described in 3GPP TS 29.128 [110].\nIn order to allow Non-IP delivery data using SGi PtP tunnelling based on UDP/IP (see subclause 11.8), the Packet Domain may offer direct transparent access to the Non-IP Packet Data Network with the following characteristics:\n-\tThe IPv4 address and/or IPv6 prefix is assigned as part of the PDN connection establishment and identifies the PDN connection of the UE within the PLMN domain.\n-\tIP address allocation procedures for the UE (i.e. PDN connection) are performed by the GGSN/P-GW based on APN configuration. Only a single IP address is used (i.e. either IPv4 or IPv6 prefix+Interface Identifier is allocated/assigned). In case of IPv6 the GGSN/P-GW assigns an Interface Identifier for the PDN connection. The IP address or IP prefix is not provided to the UE (i.e. SLAAC / Router Advertisements are not performed. DHCP or DHCPv6 are not used).\n-\tThe assigned IPv4 address or IPv6 prefix is used for UDP/IP encapsulation for PtP tunneling between the Non-IP network and the GGSN/P-GW (see subclause 11.8).\n-\tStateless Address Autoconfiguration does not apply for IPv6. Both IPv4 and IPv6 addresses belong to the operator addressing space.\nUser authentication and encryption of user data when accessing networks handling Non-IP data services is outside 3GPP specification.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "11.3\tNumbering and Addressing",
                    "description": "",
                    "summary": "",
                    "text_content": "In the case of interworking with public IP networks (such as the Internet), the PLMN operator shall use public network addresses. These public addresses can be reserved from the responsible IP numbering body, or from an ISP with which the PLMN operator has an agreement. In case of IPv6, a global IPv6 prefix can be obtained from the same sources.\nIn the case of interworking with private IP networks, two scenarios can be identified:\n1.\tthe PLMN operator manages internally the subnetwork IPv4 addresses and/ or IPv6 prefixes as applicable. Each private network is assigned a unique subnetwork IPv4 addresses and/ or IPv6 prefixes. Normal routing functions are used to route packets to the appropriate private network;\n2.\teach private network manages its own addressing. In general this will result in different private networks having overlapping address ranges. A logically separate connection (e.g. an IP in IP tunnel or layer 2 virtual circuit) is used between the GGSN/P-GW and each private network. In this case the IP address alone is not necessarily unique. The pair of values, Access Point Name (APN) and IPv4 address and/or IPv6 prefixes, is unique.\nNOTE 1:\tIn IPv6, \"site-local addresses\"were originally designed to be used for addressing inside of a site that is similar to the usage of \"private addresses\" in IPv4. The usage of \"site-local-addresses\" is deprecated as specified in RFC 4291 [82]. Existing implementations and deployments may continue using site-local addresses. However, in new implementations the prefix that was allocated for \"site local addresses\" shall be treated as for \"global unicast addresses\", see RFC 4291 [82].\nThe PLMN operator allocates the IP addresses for the subscribers in either of the following ways.\n-\tThe PLMN operator allocates a static IPv4 address and/or a static IPv6 prefix when the subscription record is built. The IPv4 address and/or IPv6 prefix are respectively reserved from a pool of free IPv4 addresses and/or IPv6 prefixes. Each external network has its own pool of IPv4 addresses and/or IPv6 prefixes.\n-\tThe PLMN operator allocates (either on its own or in conjunction with the external network) a dynamic IPv4 address and/or a dynamic IPv6 prefix as described in 3GPP TS 23.060 [3], 3GPP TS 23.401 [77] and 3GPP TS 23.402 [78].\nFor UEs used for Machine-Type Communications (MTC) as described in 3GPP TS 23.401 [77] and 3GPP TS 23.060 [3] and Cellular Internet of Things (CIoT) as described in 3GPP TS 23.401 [77] and 3GPP TS 23.060 [3], IPv6 address allocation should be the primary mechanism for IP address allocation. IPv4 based address allocation is considered a transition solution and is deprecated for MTC used over 3GPP accesses.\nNOTE 2: \tFor implementation guidelines related to transition and other aspects of IPv4 address usage see 3GPP TS 23.221 [99] Annex B.\nIn case of transferring Non-IP data over SGi PtP tunnelling based on UDP/IP (see subclause 11.8) the PLMN operator uses private network addresses for the establishment of the tunnel.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "11.4\tCharging",
                    "description": "",
                    "summary": "",
                    "text_content": "The PLMN operator may define the accuracy of the charging mechanism using one of the following categories:\n-\tevery source/destination pair is logged separately;\n-\tsource/destination pairs are logged to an accuracy of subnetworks;\n-\tsource/destination pairs are logged to an accuracy of connection types (e.g., external data network, corporate network, another mobile).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "11.5\tDomain Name System Server (DNS Server)",
                    "description": "",
                    "summary": "",
                    "text_content": "Provision of Domain Name services shall be provided by the PLMN operators in the transparent case and the ISP in the non transparent case. For non-EPS networks see 3GPP TS 23.060 [3] (DNS documentation is provided in RFC 1034 [19] and RFC 1035 [58]) and for EPS networks see 3GPP TS 29.303 [96].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "11.6\tScreening",
                    "description": "",
                    "summary": "",
                    "text_content": "The way the PLMN is performing the operator controlled screening and the subscription controlled screening is out of the scope of the present document. These functions may be done, for example, in a firewall.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "11.7\tIP Multicast access",
                    "description": "",
                    "summary": "",
                    "text_content": "NOTE: This section is applicable only to GERAN and UTRAN.\nThe Packet Domain could allow access to IP Multicast traffic coming from an external network. The support of IP-Multicast in the Packet Domain is optional.\nIn order for the Packet Core Network to support Multicast traffic that will allow the MS/UE to subscribe to multicast groups from outside the PLMN, the GGSN/P-GW shall support IGMP (IPv4) and/or MLD (IPv6) and one or more Inter-Router Multicast protocols, such as DVMRP, MOSPF, or PIM-SM.\nIGMP/MLD is an integral part of IP. All hosts wishing to receive IP multicasts are required to implement IGMP (or equivalent) and class-D IPv4 addresses or MLD and IPv6 multicast according to RFC 2710 [48]. IGMP/MLD messages are encapsulated in IP datagrams.\nTo be able to deliver IP-Multicast packets to the appropriate Tes, the GGSN/P-GW may have an IP-Multicast proxy functionality.\nThe IP-Multicast proxy will perform the following tasks:\nNOTE:\tIn this example it is assumed that IGMP/MLD is used as a Host-Router Multicast protocol.\n-\tmaintain a list of mobiles that joined one or more Multicast groups. This list is built/updated each time the GGSN/P-GW receives an IGMP Join or MLD Report message from the mobile;\n-\tsend, based on this maintained list of mobiles, multicast routing information to the routers attached to the Packet Domain, allowing them to route multicast packets;\n-\tupon reception by the GGSN/P-GW of multicast packets, make and send a copy as Point-to-Point packets, to each mobile of the group.\nIP-Multicast traffic can only be handled after an MS/UE has attached to the Packet Domain, and a bearer (e.g. Activated PDP context(s)) (including possibly authentication) pointing to the preferred ISP/external network for this purpose. The Multicast traffic is handled at the application level from a Packet Domain perspective and is sent over UDP/IP.\nFigure 12 depicts the protocol configuration for handling Multicast traffic (control plane) for the non-EPC based domain case. The Multicast traffic handling affects the GGSN by the introduction of the IP-Multicast proxy and the support for an Inter-Router Multicast protocol and a host-router multicast protocol. If the protocol configuration for handling Multicast traffic (control plane) is applied for Sgi (i.e EPC based packet domain), the P-GW has the functionality of GGSN and Sgi corresponds to the Gi in Figure 12.\nThe figure depicts a protocol configuration for IP-Multicast handling in the control plane of a network. It illustrates the various components involved in IP-Multicast, including the IP header, IP packet, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body, IP packet header, IP packet body,\nFigure 12: Protocol configuration for IP-Multicast handling (control plane)\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "11.8\tNon-IP data transfering over SGi",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "11.8.1\tGeneral",
                            "text_content": "When support of Non-IP data is provided at the Gi/SGi interface, different Point-to-Point (PtP) tunneling techniques may be used. When using PtP tunneling by UDP/IP encapsulation subclause 11.8.2 below shall be followed. Other techniques as described in clause 11.8.3 below may be used.\nThe Gi/SGi based Non-IP data delivery is applicable to the User Plane CIoT EPS Optimization and the Control Plane CIoT EPS Optimization (see 3GPP TS 23.401 [77] and 3GPP TS 23.060 [3]).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "11.8.2\tGi/SGi PtP tunnelling based on UDP/IP",
                            "text_content": "Gi/SGi PtP tunnelling based on UDP/IP may be used to deliver Non-IP data to an AS via Gi/SGi.\nThe PtP tunnel is set up by configuration of tunnel parameters in both end of the tunnel.\nThe following parameters are pre-configured in the GGSN/P-GW per APN;\n-\tthe UDP destination port number to use when sending Non-IP data;\n-\tthe UDP port number it wants to receive Non-IP data;\n-\tthe destination IP address to be used for sending Non-IP data.\nNOTE 1:\tMany APNs can resolve to the same P-GW, but each APN can be unique to a particular AS.\nThe following is pre-configured in the AS;\n-\tthe UDP destination port number to use when sending Non-IP data;\n-\tthe UDP port number it wants to receive Non-IP data.\nNOTE 2:\tThe GGSN/P-GW as well as the AS can use any UDP port numbers not assigned by IANA. The port numbers used need to be aligned between peers.\nIP address allocation procedures for the UE (i.e. PDN connection) are performed by the GGSN/P-GW as described in subclause 11.2.2. \nThe UE IP address for the PDN connection or IPv6 prefix allocated for the PDN connection+suffix assigned for the PtP tunnel end point in the GGSN/P-GW is used as source address in the GGSN/P-GW and as destination address in the AS for the PtP tunnel.\nDuring the PDP context/PDN connection establishment, the GGSN/P-GW associates the GTP-U tunnel for the PDP context/PDN connection with the Gi/SGi PtP tunnel. The GTP-U tunnel with PDP/PDN type “Non-IP” is used.\nThe GGSN/P-GW acts as a transparent forwarding node between the UE used for CIoT and the AS.\nNOTE 3:\tThe UE can include application level identity to AS, what kind of identity is out of scope of this specification.\nFor uplink delivery, if the uplink data is received from the GTP-U tunnel the GGSN/P-GW shall forward the received data to the AS over the Gi/SGi PtP tunnel associated with the GTP-U tunnel using UDP/IP encapsulation with the destination address of the AS and the configured UDP destination port number for “Non-IP” data as described above.\nFor downlink delivery, the AS shall send the data using UDP/IP encapsulation with the IP address or IPv6 prefix+suffix of the UE as destination address and the configured UDP destination port number for “Non-IP” data as described above.\nNOTE 3:\tThe UDP source port number to use for both uplink and downlink Non-IP data transfer can be a pre-configured or a locally allocated port number in the GGSN/P-GW and AS respectively.\nNOTE 4:\tFor downlink delivery, the GGSN/P-GW decapsulates the received data (i.e. removes the UDP/IP headers) and forwards the data to SGSN/S-GW on the GTP-U tunnel identified by the IP address or the IPv6 prefix of the UE (i.e. PDN connection) for delivery to the UE.\n\nFigure 11.8: Protocol configuration for Non-IP data (user plane) using SGiPtP tunneling\n\nFigure 11.9: Protocol configuration for Non-IP data (user plane) using Gi PtP tunneling.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "11.8.3\tOther SGi PtP tunnelling mechanisms",
                            "text_content": "SGi PtP tunnelling mechanisms such as PMIPv6/GRE, L2TP, GTP-C/U, etc, may be used to deliver Non-IP data to AS via SGi.\nThe PtP tunnel is established towards the AS by the P-GW. Depending on the type of protocol employed on the SGi PtP tunnel, the SGi PtP tunnel setup may be done at the time of attach or at the time of first MO datagram being sent by the CIoT UE.\nThe P-GW selects the AS based on the P-GW configuration (eg. per APN, or per PtP tunnel type etc).\nNOTE:\tIP address allocation procedures for the UE are not performed by the P-GW.\nFor uplink Non-IP data, the P-GW forwards the received data to the AS over the established SGi PtP tunnel.\nFor downlink Non-IP data, the AS locates the right SGi PtP tunnel for the UE (using information such as UE identifiers in the Non-IP protocol itself, etc) to forward the data. The AS sends the data to P-GW over the established SGi PtP tunnel. The P-GW inturn sends the data to S-GW on the GTP-U tunnel identified by the associated SGi PtP tunnel for delivery to the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "11.9\tTransport Level Marking",
                    "description": "",
                    "summary": "",
                    "text_content": "Based on operator policy, the transport level packet marking (e.g. setting the DiffServ Code Point) by the P-GW in the uplink may be based on the QCI, and optionally the ARP priority level, of the associated EPS bearer.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "12\tInterworking with PDN (PPP)",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "12.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "By means of the PDP type ‘PPP’ Packet Domain may support interworking with networks based on the point-to-point protocol (PPP), as well as with networks based on any protocol supported by PPP through one of its Network Control Protocols (NCPs). All protocols currently supported by PPP NCPs are listed in RFC 1661 [21a] and RFC 1662 [21b]. It may also support interworking by means of tunnelled PPP, by e.g. the Layer Two Tunnelling Protocol (L2TP).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "12.2\tPDN Interworking Model",
                    "description": "",
                    "summary": "",
                    "text_content": "The interworking point is at the Gi reference point. The GGSN for interworking with the ISP/PDN is the access point of the Packet Domain (see figure 13). The GGSN will either terminate the PPP connection towards the MS or may further relay PPP frames to the PDN. The PPP frames may be tunnelled in e.g. L2TP.\nThe figure depicts the protocol stacks for the Gi PPP reference point, illustrating the various components and their interactions. The diagram includes the protocol stack for the Gi PPP reference point, which is a key component in the Gi network. The stack includes the protocol stack for the Gi PPP reference point, which is a key component in the Gi network. The stack includes the protocol stack for the Gi PPP reference point, which is a key component in the Gi network. The stack includes the protocol stack for the Gi PPP reference point, which is a key component in the Gi network. The stack includes the protocol stack for the Gi PPP reference point, which is a key component in the Gi network. The stack includes the protocol stack for the Gi PPP reference point, which is a key component in the Gi network. The stack includes the protocol stack for the Gi PPP reference point, which is a key component in the Gi network. The stack includes the protocol stack for the Gi PPP reference point, which is a key component in the Gi network. The stack includes the protocol stack for the Gi PPP reference point, which is a key component in the Gi network. The stack includes the protocol stack for the Gi PPP reference point, which is a key component in the Gi network. The stack includes the protocol\nFigure 13: The protocol stacks for the Gi PPP reference point\nIn case the external PDN is an IP based network and the GGSN terminates PPP the same description applies as specified in subclause 11.2.\nIn case the GGSN tunnels PPP frames to the PDN, the GGSN may behave like a LAC towards the external network.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "12.2.1\tVirtual dial-up- and direct Access to PDNs, or ISPs through Packet Domain",
                            "text_content": "The access to PDNs, or ISPs may involve specific functions such as: user authentication, user’s authorization, end to end encryption between MS and PDN/ISP, allocation of a dynamic address belonging to the PLMN/PDN/ISP addressing space, etc.\nFor this purpose the PLMN may offer, based on configuration data:\n-\tdirect access to an IP based Intranet/ISP using a protocol configuration as depicted in figure 14. Here DHCP and/or RADIUS are used between the GGSN and Intranet/ISP for performing the specific functions mentioned above. The Packet Domain may also offer access to networks based on any protocol supported by PPP through one of its Network Control Protocols (NCPs);\nThe figure depicts a protocol stack for direct access to IP-based Intranets/ISPs, illustrating the various components and their interactions.\nFigure 14: Protocol stack for direct access to IP-based Intranets/ISPs\n-\tvirtual dial-up access to a PDN with PPP frame tunnelling as depicted in figure 15.\nThe figure depicts a protocol stack for virtual dial-up access with PPP frame tunnelling, illustrating the various components and their interactions.\nFigure 15: Protocol stack for virtual dial-up access with PPP frame tunnelling\nIn this case:\n-\tthe MS is given an address belonging to the Intranet/ISP addressing space. The address is given either at subscription in which case it is a static address or at PDP context activation in which case it is a dynamic address. This address is used for packet forwarding within the GGSN and for packet forwarding on the Intranet/ISP. This requires a link between the GGSN and an address allocation server, such as AAA, or DHCP, belonging to the Intranet/ISP;\n-\tthe communication between the Packet Domain and the Intranet/ISP may be performed over any network, even an insecure e.g. the Internet. In case of an insecure connection between the GGSN and the Intranet/ISP there may be a specific security protocol in between. This security protocol is defined by mutual agreement between PLMN operator and Intranet/ISP administrator.\nThe following description bullet items describe the signal flow.\n1)\tThe TE sends an AT-command to the MT to set up parameters.\n2)\tThe MT sends the Activate PDP context request message to the SGSN which sends the Create PDP context request message to the chosen GGSN.\n3)\tThe GGSN deduces from the APN:\n-\tthe server(s) to be used for address allocation and authentication;\n-\tthe protocol such as RADIUS, DHCP or L2TP to be used with this / those server(s);\n-\tthe communication and security feature needed to dialogue with this / those server(s) e.g. tunnel ,IPSec security association, dial-up connection (using possibly PPP).\nAs an example the GGSN may use one of the following options:\n-\tRADIUS for authentication and IP-address allocation. The AAA server responds with either an Access-Accept or an Access-Reject to the RADIUS client in the GGSN;\n-\tRADIUS for authentication and DHCP for host configuration and address allocation. The AAA server responds with either an Access-Accept or an Access-Reject to the RADIUS client in the GGSN. After a successful authentication, the DHCP client discovers the DHCP server(s) in the ISP/Intranet and receives host configuration data;\n-\tL2TP for forwarding PPP frames to a L2TP Network Server.\n4)\tThe GGSN sends back to the SGSN a Create PDP Context Response message.\n5)\tDepending on the cause value received in the Create PDP Context Response the SGSN may either send the Activate PDP Context Accept message or send the Activate PDP Context Reject message to the MS.\n6)\tThe MT responds with an AT-response that may indicate whether the context activation was successful or not. In the case of a non-successful context activation the response may also indicate the cause.\nIn case of a successful context activation, the TE will start its PPP protocol after the LLC link has been established. The LCP, Authentication and NCP negotiations are then carried out. During these negotiations the GGSN may acknowledge values, for any LCP options related to ‘L2’ framing (e.g. ‘ACCM’, ‘ACFC’ and ‘FCS-Alternatives’), as proposed by the MT, which itself is forwarding these negotiations from the TE.\nNOTE:\tWith the <PDP Type>\"PPP\" the MT may provide a PPP relay (or proxy) function between the TE and GGSN. This gives the opportunity for the MT to intercept the ‘L2’ framing end to end negotiations.\nEXAMPLE:\tIn the following example the successful PDP context activation is shown.\nThe figure depicts a simplified representation of a 5G network, highlighting the key components such as base stations (gNB), user equipment (UE), and scatterers. The diagram illustrates the signal propagation in a 5G network, with key components like the base station, user equipment, and scatterers highlighted. The figure also shows the use of beamforming techniques to mitigate interference.\nFigure 16a\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "13\tInterworking with PDN (DHCP)",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "13.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "In current LAN environments the most commonly used configuration protocol is DHCP (Dynamic Host Configuration Protocol, RFC 2131 [26]) and DHCPv6 (Dynamic Host Configuration Protocol for IPv6, IETF RFC 3315 [46]). It provides a mechanism for passing a large set of configuration parameters to hosts connected to a TCP/IP network (IP address, sub-net mask, domain name, MTU, etc.) in an automatic manner. Moreover DHCP may assign IP addresses to clients for a finite lease time, allowing for sequential reassignment of addresses to different users.\nThe lease time is chosen by the administrator of the DHCP server (in the external network), and is therefore out of the scope of the present document.\nThe Packet Domain may obtain IP address via external DHCP server during the packet bearer establishment procedures (e.g. PDP Context activation, default bearer establishment). The GGSN/P-GW acts as a DHCP client towards the external DHCP server.\nThe Packet Domain offers the end user the possibility to run DHCP end-to-end the same way as he does when connected directly to a LAN (e.g. an enterprise Intranet). No modifications should be required in common implementations of DHCP clients and servers. However in non-EPC based Packet Domain, a DHCP relay agent function is needed in the GGSN so as to allow correct routing of DHCP requests and replies between the TE and the DHCP servers. In EPC based Packet Domain for 3GPP access networks, the P-GW acts a DHCP server towards the UE and it acts as a DHCP client towards the external DHCP server. For trusted non-3GPP access networks, the non-3GPP access network may act as a DHCP relay or DHCP server. In the trusted WLAN access network, the TWAN acts a DHCP server towards the UE and PGW acts as a DHCP client towards the external DHCP server for the GTP/PMIP-based S2a.\nIn non-EPC based Packet Domain,at PDP context activation no IP address is allocated, this is done afterwards through DHCP. After the TE’s configuration has been completed by DHCP, the PDP context is updated by means of the GGSN-initiated PDP Context Modification Procedure in order to reflect the newly assigned IP address.\nIn the following cases the bearer associated with the allocated IP address (i.e. IPv4 address or IPv6 prefix) shall be released:\n-\tif the DHCP lease expires;\n-\tif the DHCP renewal is rejected by the DHCP server;\n-\tif the IP address is changed during the renewal process. Usually when the lease is renewed, the IP address remains unchanged. However, if for any reason (e.g. poor configuration of the DHCP server), a different IP address is allocated during the lease renewal process the associated bearer shall be released.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "13.2\tPDN Interworking Model of GGSN for DHCP",
                    "description": "",
                    "summary": "",
                    "text_content": "A DHCP relay agent shall be located in the GGSN used for interworking with the IP network as illustrated in the following figure 16b.\nThe figure depicts the protocol stacks for the Gi IP reference point for DHCP, illustrating the various components involved in the DHCP process. The diagram includes the DHCP server, DHCP client, and the DHCP reference point, highlighting the communication between these components. The figure also shows the IP address allocation process, with the DHCP server assigning IP addresses to the DHCP client and the DHCP reference point. The DHCP reference point is shown as a separate entity, indicating its role in the DHCP process.\nFigure 16b: The protocol stacks for the Gi IP reference point for DHCP\nThe DHCP relay agent relays the requests received from the DHCP client to the DHCP server(s), and the replies received from the server(s) to the corresponding client. The DHCP relay agent allows for the replies from DHCP servers to be delivered to the correct terminal, as the logical connection from the MT terminates in the GGSN, and consequently only the GGSN holds enough information to locate the DHCP client. How the DHCP relay agent identifies the MT based on the DHCP messages is out of the scope of 3GPP standardisation.\nDHCP provides mechanisms for user authentication and integrity protection, but does not offer any message confidentiality, therefore additional mechanisms (e.g. Ipsec tunnel) may be provided if the link towards the external network is not secure. However this is out of the scope of the present document.\nApart from the particulars mentioned above, this model is basically the same as the one for interworking with IP networks described elsewhere in the present document. Using DHCP corresponds to the transparent access case as the GGSN does not take part in the functions of authentication, authorisation, address allocation, etc.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "13.2.1\tAddress allocation by the Intranet or ISP",
                            "text_content": "The MS is given an address belonging to the Intranet/ISP addressing space. The address is given dynamically immediately after the PDP context activation. This address is used for packet forwarding between the Intranet/ISP and the GGSN and within the GGSN.\nThe MS may authenticate itself to the Intranet/ISP by means of the relevant DHCP procedures (see RFC 3118 [45]).\nThe protocol configuration options are retrieved from the DHCP server belonging to the Intranet/ISP.\nThe figure depicts a protocol stack for access with DHCP, illustrating the end-to-end process of obtaining a network address and IP address from a DHCP server. The stack includes the DHCP client, DHCP server, and DHCP client-server communication.\nFigure 16c: Protocol stack for access with DHCP end-to-end\nThe following description bullet items describe the DHCPv4 signal flow. For a detailed description of the DHCP messages refer to RFC 2131 [26] and RFC 1542 [27]. The end-to-end protocol configuration is depicted in figure 16c.\n1)\tThe TE and MT exchange several AT commands carrying the QoS and other parameters requested by the TE, and requesting the activation of a PDP context of PDP type IP. The TE selects the APN of the configured Intranet/ISP offering a DHCP service, or the APN consisting of the Reserved Service Label for DHCP that the user has subscribed to. In the latter case the TE will be connected to a PLMN operator-configured service provider offering a DHCP service (according to the APN selection rules).\n2)\tThe MT sends the Activate PDP Context Request message to the SGSN with an empty PDP address field.\n3)\tThe SGSN selects a GGSN based on the APN requested by the MS and sends a Create PDP Context Request message to that GGSN. The GGSN replies with a Create PDP Context Response message. If the GGSN has not been configured by the operator to use external PDN address allocation with DHCP for the requested APN, the cause shall be set to ‘Service not supported’. No IP address is assigned at this point; the PDP address returned by the GGSN is set to 0.0.0.0, indicating that the IP address is not yet assigned and shall be negotiated by the TE with the Intranet/ISP after the PDP context activation procedure.\n4)\tDepending on the cause value received in the Create PDP Context Response the SGSN sends either an Activate PDP Context Accept or an Activate PDP Context Reject back to the MT. In case of a successful activation the PDP context is established with the PDP address set to 0.0.0.0.\n5)\tUpon reception of the Activate PDP Context Accept, the MT sends an AT response to the TE that acknowledges the completion of the PDP context activation procedure.\n6)\tThe TE sends a DHCPDISCOVER message with the IP destination address set to the limited broadcast address (all 1s). The GGSN will pass the DHCPDISCOVER to the DHCP relay agent which will relay the request to the DHCP server configured for the APN of the PDP context. If more than one DHCP server is configured for a given APN, the request will be sent to all of them. The DHCP relay agent will add enough information to the DHCPDISCOVER message to be able to relay the replies back to the MS. How this is done is out of the scope of 3GPP standardisation.\n7)\tDHCP servers receiving the DHCPDISCOVER request reply by sending a DHCPOFFER message including an offered IP address. The DHCP relay agent forwards the replies to the proper MS.\n8)\tThe TE chooses one of the possibly several DHCPOFFERs and sends a DHCPREQUEST confirming its choice and requesting additional configuration information. The relay agent relays the DHCPOFFER as explained in step 6.\n9)\tThe selected DHCP server receives the DHCPREQUEST and replies with a DHCPACK containing the configuration information requested by the TE. The DHCP relay agent relays the DHCPACK to the TE.\n10)\tThe DHCP relay agent passes the allocated IP address to the GGSN which stores it in the corresponding PDP context. The GGSN then initiates a PDP context modification procedure by sending an Update PDP Context Request to the appropriate SGSN with the End User Address information element set to the allocated IP address.\n11)\tThe SGSN sends a Modify PDP Context Request to the MT with the allocated IP address in the PDP Address information element. The MT acknowledges by sending a Modify PDP Context Accept to the SGSN.\n12)\tThe SGSN sends an Update PDP Context Response to the GGSN. The PDP context has been successfully updated with the allocated IP address.\nEXAMPLE:\tIn the following example a successful PDP context activation with use of DHCP from end to end is shown.\nThe figure depicts the DHCPv4 signal flow in a 5G network, illustrating the various steps involved in the DHCPv4 protocol. The flow starts at the source device (e.g., a mobile device) and ends at the destination device (e.g., a server). Key components include the source device, the DHCP server, the DHCP client, and the network interface controller (NIC). The figure highlights the use of DHCPv4, which is a protocol that allows devices to request and receive IP addresses and other network resources. The flow is depicted in a simplified manner, with the DHCPv4 process being broken down into smaller steps.\nFigure16d: DHCPv4 signal flow\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "13.2.2\tOther configuration by the Intranet or ISP (IPv6 only)",
                            "text_content": "When using IPv6, in some situations the MS may need additional configuration information from the Intranet or ISP besides the IP address. It may for example be IMS related configuration options (see 3GPP TS 24.229 [47]). If the MS is DHCP capable and the IPv6 address has been allocated using Stateless Address Autoconfiguration, the MS may use a procedure as in the example below to configure additional external network protocol parameters, or other parameters that apply to the Intranet or ISP. The GGSN shall in this case indicate to the MS that there is additional configuration information to retrieve by setting the O-flag in the Router Advertisements. This shall be configured per APN in the GGSN.\nThe following description bullet items describe an example of a signal flow, where the MS directs an Information-Request to the All_DHCP_Relay_Agents_and_Servers multicast address. The MS may also direct the message to a specific server instead of all servers. For a detailed description of the DHCPv6 messages refer to the DHCPv6 IETF RFC 3315 [46]. The sequence is depicted in figure 16f.\n1)\tA Router Advertisement with the O-flag set, is sent from GGSN to TE to indicate to it to retrieve other configuration information.\n2)\tThe TE sends an INFORMATION-REQUEST message with the IP destination address set to the All_DHCP_Relay_Agents_and_Servers multicast address defined in the DHCPv6 IETF RFC 3315 [46]. The source address shall be the link-local address of the MS. The DHCP relay agent in the GGSN shall forward the message.\n3)\tDHCP servers receiving the forwarded INFORMATION-REQUEST message, reply by sending a RELAY-REPLY message, with the \"Relay Message\" option including a REPLY message with the requested configuration parameters.\nThe TE chooses one of the possibly several REPLY messages and extracts the configuration information.\nEXAMPLE:\tIn the following example a request for information with use of DHCPv6 from end to end is shown.\nThe figure depicts the DHCPv6 Other configuration signal flow, illustrating the various steps involved in configuring the DHCPv6 service. The flow includes the initial DHCP request, the negotiation phase, and the final configuration step. The figure provides a visual representation of the process, making it easier to understand the steps and the steps involved in configuring the DHCPv6 service.\nFigure 16f: DHCPv6 Other configuration signal flow\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "13.3\tPDN Interworking Model of P-GW for DHCP",
                    "description": "",
                    "summary": "",
                    "text_content": "A DHCP Client shall be located in the P-GW used for interworking with the IP network as illustrated in Figure 16g.\nThe figure depicts the protocol stacks for the Sgi IP reference point for DHCP, illustrating the various components involved in the DHCP process. The diagram includes the IP address, subnet mask, and default gateway, as well as the DHCP server and client, and the DHCP request and response. The figure highlights the importance of network protocols in ensuring efficient communication and data transfer in a network.\nFigure 16g: The protocol stacks for the Sgi IP reference point for DHCP\nThe DHCP client function in P-GW shall be used to allocate IP address(es) to the UE and/or to configure associated parameters via external DHCP servers in PDN(s). As both IPv4 and IPv6 address allocation are supported in EPS, the P-GW shall have both DHCPv4 and DHCPv6 client functions.\nThe procedures where the DHCP client function in the P-GW is used are further described in TS 23.060 [3], TS 23.401 [77] and TS 23.402 [78]. The procedures are IPv4 address allocation and IPv4 parameter configuration via an external DHCPv4 server in a PDN; IPv6 Prefix allocation via stateless address autoconfiguration; and IPv6 parameter configuration via stateless DHCPv6. These procedures are detailed in the subclauses below.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "13.3.1\tAddress allocation by the Intranet or ISP",
                            "text_content": "The subclauses below provide the signalling flows when the IP address allocation and/or the IP parameter configuration to a UE is performed via an external DHCP server in the PDN.\nThe UE may obtain the IPv4 address and/or its configuration parameters at or after the initial access signalling (e.g. default bearer establishment) to the packet domain. The request for IPv4 address and/or configuration parameters from the UE may trigger the P-GW acting as DHCPv4 client to request the IPv4 address and/or configuration parameters from an external DHCPv4 server and deliver them to the UE. See subclause 11.2.1.2.2 for details. The DHCPv4 functions in the P-GW, the UE and the external DHCPv4 server shall be compliant to RFC 2131 [26], RFC 1542 [27] and RFC 4039 [79].\nThe following bullet items describe the successful IPv4 address allocation and parameter configuration signalling flow between the P-GW and the external DHCPv4 server as depicted Figure 16h. For a detailed description of the DHCPv4 messages, refer to RFC 2131 [26], RFC 1542 [27] and RFC 4039 [79].\nFigure 16h is an example signalling flow for IPv4 address allocation and parameter configuration at the default bearer setup using DHCPv4 as specified in RFC 2131 [26]. If the optimized signalling (Rapid Commit Option) is used as per RFC 4039 [79], the messages 2-3 can be eliminated.\n1)\tThe DHCPv4 client function in the P-GW sends a DHCPDISCOVER as an IP limited broadcast message, i.e. the destination address 255.255.255.255, towards the external PDN. If the P-GW has the DHCPv4 server IP addresses configured for the APN, the DHCPDISCOVER shall be send as unicast (or even multicast) to the external DHCPv4 servers.\n2)\tUpon receiving the DHCPDISCOVER request message, the external DHCPv4 servers reply by sending a DHCPOFFER message including an offered IP address. Several DHCPOFFER messages may be received by the P-GW if multiple DHCPv4 servers respond to the DHCPDISCOVER.\n3)\tThe DHCPv4 client function in the P-GW processes the messages and sends a DHCPREQUEST towards the selected external DHCPv4 server.\n4)\tUpon receiving the DHCPREQUEST message, the selected external DHCPv4 server acknowledges the address allocation by sending a DHCPACK containing the lease period (T1), the time-out time (T2) and the configuration information requested in DHCPREQUEST. The P-GW stores the allocated IPv4 address, the lease timers and the configuration parameters. The IPv4 address and the configuration parameters shall be delivered to the UE through P-GW to UE messages.\nThe figure depicts the signalling flow for IPv4 address allocation and parameter configuration using DHCPv4. It illustrates the steps involved in assigning and configuring IPv4 addresses and parameters, including the use of DHCPv4 to manage the network's address space and configuration.\nFigure 16h: The signalling flow for IPv4 address allocation and parameter configuration using DHCPv4\nFigure 16i is an example signalling flow for IPv4 address lease renew by using DHCPv4 protocol as specified in RFC 2131 [26].\n1)\tThe DHCPv4 client function in the P-GW sends a unicast DHCPREQUEST towards the external DHCPv4 server to extend the lease period of the allocated IPv4 address.\n2)\tThe external DHCPv4 server replies with a DHCPACK message confirming the renewed lease and the T1 and T2 timers are restarted.\nThe figure depicts the signalling flow for IPv4 address lease renew using DHCPv4. It illustrates the steps involved in the lease renewal process, including the request for a new lease, the negotiation of lease terms, and the assignment of a new lease. The flow is depicted in a flowchart format, with arrows indicating the sequence of events. The figure also includes a legend to explain the different symbols used in the flowchart.\nFigure 16i: The signalling flow for IPv4 address lease renew using DHCPv4\nWhen the IPv6 prefix is allocated from the external PDN, it is the P-GW’s responsibility to obtain the IPv6 prefix for external PDN, allocate and release the IPv6 prefix. The P-GW may use DHCPv6 to obtain the IPv6 prefix from the external PDN. In this context, the P-GW shall act as a DHCP client as per IETF RFC 3315 [46] towards the external DHCPv6 server. The use cases between the UE and the P-GW that may lead the P-GW to interwork with the external DHCPv6 servers are described in subclause 11.2.1.3.1a.\nA UE that has obtained an IPv6 address can use stateless DHCP to request other configuration information such as a list of DNS recursive name servers or SIP servers.\nFor 3GPP networks if such IPv6 configuration parameters are locally provisioned in the P-GW, the P-GW returns the requested parameters to the UE via its DHCPv6 server function. For trusted non-3gpp access networks, if such IPv6 configuration parameters are locally provisioned in the P-GW, the P-GW may return the requested parameters to the UE via its DHCPv6 server function or the P-GW may return the IPv6 configuration parameters to the non-3gpp access network and then the non-3GPP access network may send the parameters to the UE via its DHCPv6 server function. When the non-3GPP access network is a trusted WLAN network, the PGW always returns the IPv6 configuration parameters to the TWAN via GTP/PMIP message, and then the TWAN sends the parameters to the UE via its DHCPv6 server function. When an external DHCP6 server in a PDN is used to obtain the requested parameters, which is the use case covered in this subclause, the P-GW acts as a DHCPv6 client towards the external DHCPv6 server while acting a DHCPv6 server towards the UE.\nThe IPv6 parameter configuration via stateles DHCPv6 function in the UE, the P-GW and the external DHCPv6 Server shall be compliant to RFC 3736 [80]. An example signalling flow for the GGSN is described in Subclause 13.2.2. For the P-GW, the signalling flow is same with the following modifications:\n-\tFor 3GPP access networks, the P-GW sends Router Advertisement for GTP-based S5/S8. In the case of PMIP-based S5/S8, the S-GW sends the Router Advertisement. For trusted non-3GPP access networks, the trusted non-3GPP access network sends the Router Advertisement for PMIP S2a.When the non-3GPP access network is a trusted WLAN network, the TWAN sends the Router Advertisement\nAs stated above, the P-GW acts as a DHCPv6 server towards the UE, while acting as a DHCPv6 client towards the external DHCPv6 server.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "13a\tInterworking with IMS",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "13a.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Interworking with the IP Multimedia Core Network Subsystem (IMS) puts additional requirements on the GGSN/P-GW. When the MS/UE connects to the IP Multimedia Core Network Subsystem (IMS), specific parameters in Session Management messages may be handled. The IMS specific parameters are: IMS signalling flag, P-CSCF address request, P-CSCF restoration support, returned P-CSCF address(es) and flow identifier(s).\nFor interworking with the IMS, the Gx interface (see 3GPP TS 29.212 [75]) is used to correlate the session (SIP/SDP) and the bearer (PDP Contexts).\nThe mechanisms in GGSN/P-GW to support IMS shall be:\n-\tP-CSCF discovery.\n-\tDedicated signalling bearer (e.g. PDP contexts) (with or without enhanced QoS) for IMS signalling; with associated packet filters to permit signalling to/from designated servers.\n-\tGx interface for policy and charging control of bearer (e.g. PDP contexts) for IMS media flows.\n-\tP-CSCF restoration.\nThese mechanisms are however not restricted to the IMS and could be used for other services that could benefit from these mechanisms.\nThe P-GW shall not modify the fields Type of Service (IPv4) and Traffic Class (IPv6) of the received downlink packets.\nNOTE:\tThe P-CSCF can support paging policy differentiation for different traffic or service types over LTE by marking the fields Type of Service (IPv4) and Traffic Class (IPv6) (see clause L.3.2.4 of 3GPP TS 24.229 [47]).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "13a.2\tIMS Interworking Model",
                    "description": "",
                    "summary": "",
                    "text_content": "The signalling interface between MS/UE and P-CSCF is a logical interface, i.e. it is using GPRS or EPC as a bearer. The Gx interface is used for network communication between the GGSN/P-GW and the PCRF. For a description of the IMS architecture, refer to 3GPP TS 23.228 [52]. For a more detailed view of GGSN/P-GW IMS interworking, see 3GPP TS 29.213 [76].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "13a.2.1\tIMS Specific Configuration in the GGSN/P-GW",
                            "text_content": "The GGSN/P-GW shall have a list of preconfigured addresses of signalling servers (P-CSCF servers). This list shall be provided to MSs/UEs on request. The list shall be possible to preconfigure per APN.\nThe GGSN/P-GW shall have locally preconfigured packet filters, and/or applicable PCC rules, as specified in 3GPP TS 29.212 [75] to be applied on the dedicated signalling bearer (e.g. PDP context). The packet filters shall filter up-link and down-link packets and only allow traffic to/from the signalling servers and to DNS and DHCP servers. The locally preconfigured packet filters shall be possible to pre-configure per APN.\nIt shall be possible to enable/disable the use of the Gx interface per APN. When Gx is enabled the GGSN/P-GW shall handle IP-CAN Bearer Establishment (e.g. Create PDP Context Requests) as specified in 3GPP TS 29.212 [75].\nThe GGSN/P-GW shall support IPv4 and/or IPv6 addresses and protocol for IMS signalling and IMS bearers.\nThe methods for an MS/UE to discover P-CSCF address(es) may vary depending on the access technology that the MS/UE is on. The details of the P-CSCF discovery mechanisms for various accesses are specified in 3GPP TS 23.228 [52] and 3GPP TS 24.229 [47]. For example, for an MS/UE accesing to IMS via GPRS in GERAN and UTRAN, the GGSN shall provide support for P-CSCF discovery in three different ways (see 3GPP TS 23.228 [52] and 3GPP TS 24.229 [47]):\n-\tGPRS procedure for P-CSCF discovery, i.e. request and provision of P-CSCF address(es) within the PCO IE in GPRS Session Management procedures (see 3GPP TS 24.008 [54]).\n-\tVia DHCP servers i.e. the GGSN shall provide the functionality of a DHCP relay agent\n-\tIf the MS/UE has a P-CSCF FQDN locally configured and request the DNS IP address(es) from the GGSN (via PCO or DHCP procedures), the GGSN shall be able to provide DNS IP address(es) to the MS/UE.\nSimilarly, the PGW shall have similar functional support depending on the P-CSCF discovery methods supported by the UE on the access technology. For example, for a UE in 3GPP access network (i.e. GERAN, UTRAN, EUTRAN), the P-GW shall support same functions as the GGSN that are specified above except that the P-GW does not act as a DHCP relay agent between the MS/UE and the external DHCP server. In other words, as specified in clause 13 of this document, the P-GW shall have DHCP server function towards the MS/UE while acting as a DHCP client towards external DHCP server, if the P-GW is configured to request DNS and/or P-CSCF IP addresses from external DHCP servers.\nThe GGSN/P-GW shall be able to deliver DNS and/or P-CSCF addresses to the MS/UE if requested by the MS/UE via PCO (see 3GPP TS 24.008 [54] and 3GPP TS 24.301 [84]) or via DHCP procedures using the relevant DHCP options for IPv4/IPv6 DNS and SIP servers (see RFC 2132 [85], RFC 3361 [86], RFC 3646 [87] and RFC 3319 [88]).\nOn APNs providing IMS services, the information advertised in Router Advertisements from GGSN/P-GW to MSs/UEs shall be configured in the same manner as for other APNs providing IPv6 services (see subclause 11.2.1.3.4), except that the \"O-flag\" shall be set.\nNOTE:\tThe \"O- flag\" shall be set in IPv6 Router Advertisement messages sent by the GGSN/P-GW for APNs used for IMS services. This will trigger a DHCP capable MS/UE to start a DHCPv6 session to retrieve server addresses and other configuration parameters. An MS/UE which doesn’t support DHCP will simply ignore the \"O-flag\". An MS/UE, which doesn’t support DHCP, shall request IMS specific configuration (e.g. P-CSCF address) via the other discovery methods supported in the MS/UE (i.e. via locally configured P-CSCF address/FQDN in the MS/UE or via PCO procedure, if applicable).\nThe GGSN/P-GW shall have configurable policy rules for controlling bearers (e.g. PDP contexts) used for signalling as specified in section 13a.2.2.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "13a.2.2\tIMS Specific Procedures in the GGSN/P-GW",
                            "text_content": "When an MS/UE indicates a request for a P-CSCF address in the PCO IE in a Create PDP Context Request message on GERAN/UTRAN or for E-UTRAN in initial access request (e.g. Attach Request, PDN Connectivity Request), the GGSN/P-GW shall respond with one or more P-CSCF server addresses if preconfigured for this APN. If the GGSN/P-GW has no P-CSCF address available, the GGSN/P-GW shall ignore the request. If the GGSN/P-GW provides more than one P-CSCF IPv4/IPv6 address in the response, the GGSN/P-GW shall sort the addresses with the highest priority P-CSCF server first in the PCO IE. The GGSN/P-GW may use different prioritisations for different Mses/UEs, e.g. for load sharing between the P-CSCF servers.\nThe GGSN/P-GW may use a keep alive mechanism and/or other type based on local policy (e.g. statistical monitoring) to be able to detect a failure of P-CSCF address(es) preconfigured in the APN. The keep alive mechanism should make use of STUN or CRLF as specified for the UE in 3GPP TS 24.229 [47], clause K.2.1.5. As an alternative, ICMP echo request/response may be used. The GGSN/P-GW shall then provide only those P-CSCF address(es) that are available in a Create PDP Context Response/Create Session Response.\nThe coding of the PCO IE is described in the 3GPP TS 24.008 [54]. This procedure shall be followed regardless of whether or not the MS/UE uses a dedicated PDP context/EPS bearer for IMS signalling, and irrespective of the Gx status for the APN.\nIf the GGSN/P-GW detects a failure:\n-\tin P-CSCF address(es) being used by the MS/UEs, if received via Gx (as specified in 3GPP TS 23.380 [95], clause 5); or\n-\tupon receiving a P-CSCF restoration indication from the MME/SGSN or the PCRF,\nthen the GGSN/P-GW shall act as specified in 3GPP TS 23.380 [95], clause 5.\nThe following applies for establishing a PDP context/EPS bearer for IMS signalling in the GGSN/P-GW as per 3GPP TS 23.228 [52]:\nI.\tThe GGSN/P-GW shall allow IMS signalling on a \"general-purpose PDP context\"/default EPS bearer, in which case the IMS signalling shall be provided like any other transparent services provided by the packet domain.\nII.\tThe GGSN/P-GW may (dependent on operator policy) also support PDP Contexts/EPS Bearers dedicated for IMS services. If the the bearer establishment selected for the APN is controlled by the MS/UE, the MS/UE may request a dedicated PDP context/EPS Bearer for IMS signalling (see 3GPP TS 24.229 [47]) by setting the IM CN Subsystem signalling flag in the PCO IE. Specifically, the GGSN/P-GW may receive the IM CN Subsystem signalling flag in the PCO IE in the PDP context activation or Secondary PDP context activation for GERAN and UTRAN accesses; in the Attach, UE-requested PDN connectivity request or UE-requested bearer resource modification procedures for E-UTRAN access. If the bearer establishment selected for the APN is controlled by the network, depending on the operator policy, the GGSN or P-GW may also activate a PDP context or dedicated EPS bearer for IMS signalling via network-initiated Secondary PDP context activation or network-initiated Dedicated Bearer activation procedures, respectively. If dedicated PDP contexts/EPS Bearers for IMS signalling are not supported, the GGSN/P-GW will reset the signalling flag in the response to the MS/UE. For P-GW, if the APN offers non-IMS services, the default bearer shall not be allowed to be set up as a dedicated IM CN signalling bearer. If the PDP context/EPS bearer can be established as a dedicated bearer for IMS signalling, the GGSN/P-GW can provide a set of UL filters for the PDP context/EPS bearer used for IMS. The UL filters provide the MS/UE with the rules and restrictions applied by the GGSN/P-GW for the dedicated PDP context/EPS bearer for IMS signalling. The GGSN/P-GW can in addition provide the IMS signalling flag to explicitly indicate to the MS/UE the intention of using the PDP context/EPS bearer for IMS related signalling.\nIn both cases, I and II,\n-\tThe GGSN may receive the Signalling Indication parameter in the QoS IE. This indicates a request for prioritised handling over the radio interface. The GGSN shall be able to downgrade the QoS (dependent on operator policy) by resetting the Signalling Indication according to the normal procedures for QoS negotiation, see 3GPP TS 23.060 [3].\n-\tDuring the (default or dedicated) EPS bearer activation procedure, the P-GW may receive the request for appropriate QCI for IMS signalling traffic as specified in 3GPP TS 23.203 [90] in EPS bearer QoS IE that indicates the prioritised handling of the EPS bearer over the radio interface. The P-GW may either accept or reject the request based on the operator policy configured at the P-GW.\nIM CN subsystem signalling flag and Signalling Indication or appropriate QCI for IMS signalling in the QoS IE may be used independently of each other. However, based on the operator policy, the network may honor the Signalling Indication or appropriate QCI for IMS signalling if the IM CN Subsystem signalling flag is present in PCO IE.\nThe operator may provide other properties to the PDP contexts/EPS bearers dedicated for IMS signalling, e.g. special charging. It is out of the current scope of this TS to further specify these properties.\nFor a PDP Context/EPS bearer marked as a dedicated for IMS signalling, the GGSN/P-GW shall apply the applicable PCC rules, as specified in 3GPP TS 29.212 [75], and/or locally preconfigured packet filters, which shall only allow packets to be sent to and from a set of signalling servers, such as P-CSCF(s), DHCP server(s) and DNS server(s). The TFT filters on the dedicated signalling bearer shall have a precedence value so that they precede any other TFT filters. This will secure the use of the correct PDP context/EPS bearer for the signalling traffic, and that only authorized traffic uses the signalling PDP context. The locally preconfigured packet filters shall be defined in the GGSN/P-GW by the operator.\nFor PDP Contexts/EPS bearers used to carry IMS media flows, specific policies may be applied. The policy includes packet filtering, which enables a specific charging for these PDP Contexts/EPS bearers, see 3GPP TS 29.212 [75].\nThe creation of a PDP Context/EPS bearer to be used to carry media flows involves interaction between the MS/UE and the GGSN/P-GW and between the GGSN/P-GW and the PCRF. The interaction between the GGSN/P-GW and the PCRF, i.e. the Gx interface, is described in detail in 3GPP TS 29.212 [75]. The interaction between the MS/UE and GGSN/P-GW is described in 3GPP TS 29.213 [76].\nIf Gx is enabled for the APN, the GGSN/P-GW contacts the PCRF selected during the establishment of the APN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "13b\tInterworking with BM-SC in EPS",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "13b.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "MBMS GW is used for interworking with the BM-SC in EPS. One or more MBMS GWs may be used in a PLMN. The specific message, i.e. session start/session update/session stop, and specific parameters, e.g. TMGI, MBMS service area, list of MBMS control plane nodes, are handled.\nMBMS GW provides the Sgi-mb (user plane) reference point and the SGmb (control plane) reference point for interworking with the BM-SC.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "13b.2\tBM-SC interworking model of MBMS GW",
                    "description": "",
                    "summary": "",
                    "text_content": "The control plane and user plane protocol stacks of the MBMS GW for interworking with BM-SC are illustrated in Figure 16j , Figure 16k and Figure 16l. The figures include the following protocols:\n-\tThe \"Diameter\" SGmb application, as specified in clause 20.\n-\tThe Control part of the Evolved GPRS Tunnelling Protocol for EPS, GTPv2-C, as specified in 3GPP TS 29.274 [81].\n-\tThe User Datagram Protocol,UDP, as specified in IETF RFC 768 [15].\n-\tThe Transmission Control Protocol, TCP, as specified in IETF RFC 793 [18]\n-\tThe Stream Control Transmission Protocol, SCTP, as specified in IETF RFC 4960 [109].\n-\tThe Packet Data Convergence Protocol, PDCP, as specified in 3GPP TS 25.323 [107].\n-\tThe MBMS synchronisation protocol, SYNC, as specified in 3GPP TS 25.446 [106].\n-\tThe Internet Protocol, IP.\n-\tL1 and L2 transport protocols for IP (various options exist).\nThe figure depicts the control plane protocol stacks of MBMS GWs for interworking with BM-SC, illustrating the various components and their interconnections.\nFigure 16j: The control plane protocol stacks of MBMS GW for interworking with BM-SC\nThe figure depicts the user plane protocol stacks of MBMS GWs for interworking with BM-SC for multicast, illustrating the various protocols and their respective roles in the network.\nFigure 16k: The user plane protocol stacks of MBMS GW for interworking with BM-SC for multicast\nThe figure depicts the user plane protocol stacks of MBMS GWs for interworking with BM-SC for broadcast, illustrating the various protocols and their respective roles in the network.\nFigure 16l: The user plane protocol stacks of MBMS GW for interworking with BM-SC for broadcast\nA BM-SC sends user plane data to an MBMS GW either by IP unicast (default), or by IP multicasting. Through the control plane communication a BM-SC provides an MBMS GW with necessary data, so that MBMS GW could forward the user plane data downlink either by multicast (default) or by unicast.\nPDCP is not used when the MBMS service is broadcasted in the E-UTRAN, refer to 3GPP TS 36.331 [94].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "13b.3\tForwarding of user plane packets at the MBMS GW",
                    "description": "",
                    "summary": "",
                    "text_content": "If user plane data are to be sent to the MBMS Gateway using IP unicast, the MBMS Gateway allocates an IP transport address and a separate UDP port for each MBMS bearer ( i.e the service uniquely identified by its TMGI and Flow ID and provided by the EPS to deliver the same IP datagrams to multiple receivers in a designated location). The MBMS Gateway uses that destination unicast IP address and destination UDP port of user plane packets received over the SGi-mb interface to determine on which MBMS bearer to forward the received user plane packet.\nIf user plane data are to be sent to the MBMS Gateway using IP multicast encapsulation, the MBMS Gateway uses, the SGi-mb (transport) plane destination multicast address used and the SGi-mb (transport) plane source UDP port number provided by the BM-SC of user plane packets received over the SGi-mb interface to determine on which MBMS bearer to forward the received user plane packet.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "14\tInternet Hosted Octet Stream Service (IHOSS)",
            "description": "Figure 17: Void\nFigure 18: Void\nFigure 19: Void\nFigure 20: Void\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "15\tInterworking between Packet Domains",
            "description": "The primary reason for the interworking between Packet Domains is to support roaming subscribers as described in 3GPP TS 23.060 [3]. The general model for both GPRS and EPS Packet Domain interworking is shown in figure 21.\nThe figure depicts a general interworking model for GPRS Packet Domains and EPS Packet Domains, which are used to support roaming subscribers. The model outlines the communication paths between the two domains, including the use of GPRS and EPS technologies. It also highlights the need for efficient routing and network management to ensure seamless roaming experiences for users.\nFigure 21: General interworking model for GPRS Packet Domains and EPS Packet Domains to support roaming subscribers.\nNOTE:\tThere may be multiple Packet Domains of the same type which interwork each other, such as the case of interwork between two GPRS Packet Domains.\nFor roaming subscribers that have a PDP address allocated from the HPLMN a forwarding route between the HPLMN and the VPLMN is created. This route is used for both mobile terminated and mobile originated data traffic. The communication is done via the BGs (Border Gateways) as described in 3GPP TS 23.060 [3].\nThe procedures to set the link between the SGSN in the VPLMN and the GGSN in the HPLMN are described in 3GPP TS 23.060 [3].\nThe inter-PLMN link may be any packet data network or dedicated link as described in 3GPP TS 23.060 [3]. The PLMN operators may have a dedicated inter-PLMN link to fulfil the QoS requirements of a certain protocol.\nIn the case of interworking between EPS Packet Domains, S8 reference point is the inter-PLMN interface, linking PDN GW of HPLMN and Serving GW of VPLMN.  The procedure for setting the link is described in 3GPP TS 23.401 [77] and TS 23.402 [78].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "15.1\tSecurity Agreements",
                    "description": "",
                    "summary": "",
                    "text_content": "Each PLMN operator may support Ipsec (RFC 1825 [61]) and accompanying specifications for authentication (RFC 1826 [62]) and encryption (RFC 1827 [63]) as a basic set of security functionality in its border gateways. The PLMN operators may decide to use other security protocols based on bilateral agreements.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "15.2\tRouting protocol agreements",
                    "description": "",
                    "summary": "",
                    "text_content": "Each PLMN operator may support BGP (RFC 1771 [60]) as a basic set of routing functionality in its border gateways. The PLMN operators may decide to use other routing protocols based on bilateral agreements.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "15.3\tCharging agreements",
                    "description": "",
                    "summary": "",
                    "text_content": "Sharing the cost of the inter-PLMN link is subject to the agreement between the PLMN operators.\nThere may be a requirement to collect charging information in the Border Gateway (see figure 21) and this is down to the normal interconnect agreement between PLMN and PDN operators.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "16\tUsage of RADIUS on Gi/Sgi interface",
            "description": "A GGSN may, on a per APN basis, use RADIUS authentication to authenticate a user and RADIUS accounting to provide information to an AAA (Authentication, Authorization and Accounting) server.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "16.1\tRADIUS Authentication and Authorization",
                    "description": "",
                    "summary": "",
                    "text_content": "RADIUS Authentication and Authorization shall be used according to RFC 2865 [38], RFC 3162 [50] and RFC 4818 [97].\nThe RADIUS client function may reside in a GGSN/P-GW. When the GGSN receives a Create PDP Context request message or the P-GW receives an initial access request (e.g. Create Session Request) the RADIUS client function may send the authentication information to an authentication server, which is identified during the APN provisioning.\nThe authentication server checks that the user can be accepted. The response (when positive) may contain network information, such as an IPv4 address and/or IPv6 prefix for the user when the GGSN or P-GW is interworking with the AAA server.\nThe information delivered during the RADIUS authentication can be used to automatically correlate the users identity (the MSISDN or IMSI) to the IPv4 address and/or IPv6 prefix, if applicable, assigned/confirmed by the GGSN/P-GW or the authentication server respectively. The same procedure applies, in case of sending the authentication to a ‘proxy’ authentication server.\nRADIUS Authentication is only applicable to the primary PDP context. When the GGSN receives an Access-Accept message from the authentication server it shall complete the PDP context activation procedure. If Access-Reject or no response is received, the GGSN shall reject the PDP Context Activation attempt with a suitable cause code, e.g. User Authentication failed. The GGSN may also use the RADIUS re-authorization procedure for the purpose of IPv4 address allocation to the MS for PDP type of IPv4v6 after establishment of a PDN connection.\nFor EPS, RADIUS Authentication is applicable to the initial access request. When the P-GW receives an Access-Accept message from the authentication server it shall complete the initial access procedure. If Access-Reject or no response is received, the P-GW shall reject the initial access procedure with a suitable cause code. The P-GW may also use the RADIUS re-authorization procedure for the purpose of IPv4 address allocation to the UE for PDN type of IPv4v6 after establishment of a PDN connection. The use cases that may lead this procedure are:\n-\tDeferred IPv4 address allocation via DHCPv4 procedure after successful attach on 3GPP accesses.\n-\tDeferred IPv4 address allocation after successful attach in trusted non-3GPP IP access on S2a.\n-\tDeferred IPv4 home address allocation via DSMIPv6 Re-Registration procedure via S2c.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "16.2\tRADIUS Accounting",
                    "description": "",
                    "summary": "",
                    "text_content": "RADIUS Accounting shall be used according to IETF  RFC 2866 [39] , IETF RFC 2869 [116], IETF  RFC 3162 [50] and IETF  RFC 4818 [97].\nThe RADIUS accounting client function may reside in a GGSN/P-GW. The RADIUS accounting client may send information to an accounting server, which is identified during the APN provisioning. The accounting server may store this information and use it to automatically identify the user. This information can be trusted because the Packet Domain network has authenticated the subscriber (i.e. SIM card and possibly other authentication methods).\nThe GGSN/P-GW may use the RADIUS Accounting-Request Start and Stop messages during IP-CAN bearer (e.g. primary and secondary PDP context, default and dedicated bearer) activations and deactivations procedures, respectively. For EPC based Packet domain, if the P-GW is not aware of the IP-CAN bearers, e.g. in case of PMIP-based S5/S8, the P-GW may use the RADIUS Accounting-Request Start and Stop messages per IP-CAN session as it would be one IP-CAN bearer.\nThe use of Accounting-Request STOP and in addition the Accounting ON and Accounting OFF messages may be used to ensure that information stored in the accounting server is synchronised with the GGSN/P-GW information.\nIf the AAA server is used for IPv4 address and/or IPv6 prefix assignment, then, upon reception of a RADIUS Accounting-Request STOP message for all IP-CAN bearers associated to an IP-CAN session defined by APN and IMSI or MSISDN, the AAA server may make the associated IPv4 address and/or IPv6 prefix available for assignment.\nFor PDN/PDP type IPv4v6 and deferred IPv4 address allocation, when the IPv4 address is allocated or re-allocated, the accounting session that was established for the IPv6 prefix allocation shall be used to inform the accounting server about the allocated IPv4 address by sending RADIUS Accounting-Request Interim-Update with Framed-IP-Address attribute and its value field containing the allocated IPv4 address. Similarly, the release of IPv4 address shall be indicated to the accounting server by sending RADIUS Accounting-Request Interim-Update without the Framed-IP-Address attribute.\nIn order to avoid race conditions, the GGSN/P-GW shall include a 3GPP Vendor-Specific sub-attribute \"Session Stop indicator\" when it sends the Accounting-Request STOP for the last IP-CAN bearer of an IP-CAN session and the IP-CAN session is terminated (i.e. the IPv4 address and/or IPv6 prefix and any associated GTP tunnels or PMIP tunnel can be released). The AAA server shall not assume the IP-CAN session terminated until an Accounting-Request STOP with the Session Stop indicator is received.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "16.3\tAuthentication and accounting message flows on Gi interface",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "16.3.1\tIP PDP type",
                            "text_content": "Figure 22 represents the RADIUS message flows between a GGSN and an Authentication, Authorization and Accounting (AAA) server.\nThe figure depicts a network architecture with a focus on the fiber-optic backbone, highlighting the role of core switches, optical line terminals (OLTs), and distributed nodes. The layered design aligns with SDN principles, emphasizing redundancy and failover reliability.\nNOTE 1:\tIf some external applications require RADIUS Accounting request (Start) information before they can process user packets, then the selected APN (GGSN) may be configured in such a way that the GGSN drops user data until the Accounting Response (START) is received from the AAA server. The GGSN may wait for the Accounting Response (START) before sending the CreatePDPContextResponse. The GGSN may reject the PDP context if the Accounting Response (START) is not received.\nNOTE 2:\tSeparate accounting and authentication servers may be used.\nNOTE 3:\tThe Access-Request message shall be used for primary PDP context only.\nNOTE 4:\tThe Accounting-Request (Start) message may be sent at a later stage, e.g. after IPv6 address has been assigned and PDP Context updated, in case of IP address allocation via DHCPv4 after successful PDP context activation signalling.\n\nFigure 22: RADIUS message flow for PDP type IP (successful user authentication case)\nWhen a GGSN receives a Create PDP Context Request message for a given APN, the GGSN may (depending on the configuration for this APN) send a RADIUS Access-Request to an AAA server. The AAA server authenticates and authorizes the user. If RADIUS is also responsible for IPv4 address and/or IPv6 prefix allocation the AAA server shall return the allocated IPv4 address and/or IPv6 prefix in the Access-Accept message.\nWhen PDP type is IPv4v6 and deferred IPv4 addressing via IPv4 address pool in the AAA server is used, the GGSN may intiate RADIUS re-authorization procedures after successful initial attach for the purpose of IPv4 address allocation or to renew the lease for a previously allocated IPv4 address. In this case, the GGSN shall set the Service-Type attribute to \"Authorize Only\" and the 3GPP-Allocate-IP-Type subattribute to the type of IP address to be allocated in the Access-Request message sent to the AAA server. See subclause 16.4.7.2 for the conditions to use 3GPP-Allocate-IP-Type sub-attribute in Access-Request messages. If the GGSN is using DHCPv4 signalling towards the MS and the RADIUS server includes the Session-Timeout attribute in the Access-Accept, the GGSN may use the Session-Timeout value as the DHCPv4 lease time. The GGSN shall not set the DHCPv4 lease time value higher than the Session-Timeout value. The GGSN may renew the DHCP lease to the MS without re-authorization towards the AAA server providing that the new lease expiry is no later than the Session-Timeout timer expiry. If the GGSN wishes to extend the lease time beyond the current Session-Timeout expiry, it shall initiate a new AAA re-authorization.\nEven if the GGSN was not involved in user authentication (e.g. transparent network access mode), it may send a RADIUS Accounting-Request START message to an AAA server. This message contains parameters, e.g. the tuple which includes the user-id and IPv4 address and/or IPv6 prefix, to be used by application servers (e.g. WAP gateway) in order to identify the user. This message also indicates to the AAA server that the user session has started. The session is uniquely identified by the Acct-Session-Id that is composed of the Charging-Id and the GGSN-Address.\nIf some external applications require RADIUS Accounting request (Start) information before they can process user packets, then the selected APN (GGSN) may be configured in such a way that the GGSN drops user data until the Accounting Response (START) is received from the AAA server. The GGSN may wait for the Accounting Response (START) before sending the CreatePDPContextResponse. The GGSN may reject the PDP context if the Accounting Response (START) is not received. The authentication and accounting servers may be separately configured for each APN.\nFor PDP type IPv4, at IPv4 address allocation via DHCP4 signalling between the TE and the PDN, no IPv4 address is available at PDP context activation. In that case the GGSN may wait to send the Accounting-Request START message until the TE receives its IPv4 address in a DHCPACK.\nFor PDP type IPv4v6 and deferred IPv4 addressing, when the IPv4 address is allocated or re-allocated, the accounting session that was established for the IPv6 prefix allocation shall be used to inform the accounting server about the allocated IPv4 address by sending RADIUS Accounting-Request Interim-Update with the Framed-IP-Address attribute and its value field containing the allocated IPv4 address.\nWhen the GGSN receives a Delete PDP Context Request message and providing a RADIUS Accounting-Request START message was sent previously, the GGSN shall send a RADIUS Accounting-Request STOP message to the AAA server, which indicates the termination of this particular user session. The GGSN shall immediately send a Delete PDP context response, without waiting for an Accounting-Response STOP message from the AAA server.\nThe AAA server shall deallocate the IPv4 address and/or IPv6 prefix (if any) initially allocated to the subscriber, if there is no session for the subscriber.\nFor PDP type IPv4v6 and deferred IPv4 addressing, when the GGSN receives a message from the MS or the network indicating the release of the IPv4 address (e.g. receiving DHCPRELEASE) or decides to release the IPv4 address on its own (e.g. due to DHCP lease timer expiry or GGSN assigned IPv4 address), the GGSN shall inform the accounting server about the deallocation of the IPv4 address by sending RADIUS Accounting-Request Interim-Update without the Framed-IP-Address attribute.\nAccounting-Request ON and Accounting-Request OFF messages may be sent from the GGSN to the AAA server to ensure the correct synchronization of the session information in the GGSN and the AAA server.\nThe GGSN may send an Accounting-Request ON message to the AAA server to indicate that a restart has occurred. The AAA server may then release the associated resources.\nPrior to a scheduled restart, the GGSN may send Accounting-Request OFF message to the AAA server. The AAA server may then release the associated resources.\nIf an Access-Challenge is sent to the GGSN when an Access-Request message is pending and when IP PDP type is used, the GGSN shall silently discard the Access-Challenge message and it shall treat an Access-Challenge as though it had received an Access-Reject instead RFC 2865 [38].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16.3.2\tPPP PDP type",
                            "text_content": "Figure 23 describes the RADIUS message flows between a GGSN and an Authentication, Authorization and Accounting (AAA) server for the case where PPP is terminated at the GGSN. The case where PPP is relayed to an LNS is beyond the scope of the present document.\nThe figure depicts a network architecture with separate accounting and authentication servers, highlighting the importance of these components in ensuring network security and data integrity.\nNOTE 1:\tSeparate accounting and Authentication servers may be used.\nNOTE 2: \tActual messages depend on the used authentication protocol (e.g. PAP, CHAP).\nNOTE 3: \tIf some external applications require RADIUS Accounting request (Start) information before they can process user packets, then the selected APN (GGSN) may be configured in such a way that the GGSN drops user data until the Accounting Response (START) is received from the AAA server. The GGSN may delete the PDP context if the Accounting Response (START) is not received.\nNOTE 4: \tAn LCP termination procedure may be performed. Either the MS or the GGSN may initiate the context deactivation.\nNOTE 5: \tThe Access-Request message shall be used for primary PDP context only.\nNOTE 6: \tNetwork Initiated deactivation.\nNOTE 7: \tUser Initiated deactivation.\n\nFigure 23: RADIUS message flow for PDP type PPP (successful user authentication case)\nWhen a GGSN receives a Create PDP Context Request message for a given APN, the GGSN shall immediately send a Create PDP context response back to the SGSN. After PPP link setup, the authentication phase may take place. During Authentication phase, the GGSN sends a RADIUS Access-Request to an AAA server. The AAA server authenticates and authorizes the user. If RADIUS is also responsible for IP address allocation the AAA server shall return the allocated IP address or IPv6 prefix in the Access-Accept message (if the user was authenticated).\nIf the user is not authenticated, the GGSN shall send a Delete PDP context request to the SGSN.\nEven if the GGSN was not involved in user authentication (e.g. for PPP no authentication may be selected), it may send a RADIUS Accounting-Request START message to an AAA server. This message contains parameters, e.g. a tuple which includes the user-id and IP address or IPv6 prefix, to be used by application servers (e.g. WAP gateway) in order to identify the user. This message also indicates to the AAA server that the user session has started, and the QoS parameters associated to the session.\nIf some external applications require RADIUS Accounting request (Start) information before they can process user packets, then the selected APN (GGSN) may be configured in such a way that the GGSN drops user data until the Accounting Response (START) is received from the AAA server. The GGSN may delete the PDP context if the Accounting Response (START) is not received. The Authentication and Accounting servers may be separately configured for each APN.\nWhen the GGSN receives a Delete PDP Context Request message and providing a RADIUS Accounting-Request START message was sent previously, the GGSN shall send a RADIUS Accounting-Request STOP message to the AAA server, which indicates the termination of this particular user session. The GGSN shall immediately send a Delete PDP context response, without waiting for an Accounting-Response STOP message from the AAA server.\nThe AAA server shall deallocate the IP address or IPv6 prefix (if any) initially allocated to the subscriber.\nAccounting-Request ON and Accounting-Request OFF messages may be sent from the GGSN to the AAA server to ensure the correct synchronization of the session information in the GGSN and the AAA server.\nThe GGSN may send an Accounting-Request ON message to the AAA server to indicate that a restart has occurred. The AAA server may then release the associated resources.\nPrior to a scheduled restart, the GGSN may send Accounting-Request OFF message to the AAA server, the AAA server may then release the associated resources.\nIf an Access-Challenge is sent to the GGSN when using PPP PDP type, the GGSN shall handle it by PPP CHAP providing PPP CHAP was the selected Authentication protocol. If CHAP authentication was not selected, authentication shall fail RFC 2865 [38].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16.3.3\tAccounting Update",
                            "text_content": "During the life of a PDP context some information related to this PDP context may change (i.e. SGSN address if a Inter-SGSN RA update occurs). Upon reception of an UpdatePDPContextRequest from the SGSN, the GGSN may send an Accounting Request Interim-Update to the AAA server to update the necessary information related to this PDP context (see figure 24). Interim updates are also used when the IPv4 address is allocated/released/re-allocated for deferred IPv4 addressing for the PDP type IPv4v6. If the GGSN receives an UpdatePDPContextRequest from the SGSN that specifically indicates a direct tunnel establishment or a direct tunnel teardown (switching the user plane tunnel end back to the SGSN), and only the GTP user plane address and/or the GTP-U TEID have changed, then the GGSN should not send the Accounting Request Interim-Update to the AAA server. In such cases, the GGSN need not wait for the RADIUS AccountingResponse from the AAA server message before sending the UpdatePDPContextResponse to the SGSN. The GGSN may delete the PDP context if the AccountingResponse is not received from the AAA.\nThe figure depicts a simplified representation of a GGSN (Gateway Security Service Node) in a 5G network, highlighting its role in managing the network's security and accounting processes. The GGSN is responsible for authenticating and accounting for the network's traffic, ensuring that the network's security is maintained and that the accounting process is accurate. The figure also includes a RADIUS (Remote Authentication Dial-In User Service) server, which is responsible for authenticating and accounting for the network's users. The figure also includes a AAA (Authentication, Authorization, and Accounting) server, which is responsible for authenticating and accounting for the network's users. The figure also includes a PDP (Policy Data Plane) server, which is responsible for managing the network's policy data. The figure also includes a GGSN (Gateway Security Service Node) that is responsible for authenticating and accounting for the network's traffic. The figure also includes a RADIUS (Remote Authentication Dial-In User Service) server that is responsible for authenticating and accounting for the network's users. The figure also includes a AAA (Authentication, Authorization, and Accounting) server that is responsible for authenticating and accounting for the network's users. The figure\nNOTE:\tAs shown the GGSN need not wait for the RADIUS AccountingResponse from the AAA server message to send the UpdatePDPContextResponse to the SGSN. The GGSN may delete the PDP context if the AccountingResponse is not received from the AAA.\n\nFigure 24: RADIUS for PDP context Update\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16.3.4\tAAA-Initiated PDP context termination",
                            "text_content": "RADIUS is used as the protocol between the GGSN and an AAA server or proxy for applications (e.g. MMS) to deliver information related to GPRS user session. However some IP applications could need to interwork with the GGSN to terminate a particular PDP context. For this purpose, the AAA server or proxy may send a RADIUS Disconnect Request to the GGSN. As depicted in figure 25, the GGSN may react by deleting the corresponding PDP context or silently discard the Disconnect Request message. For more information on RADIUS Disconnect, see RFC 3576 [41]. If the GGSN deletes the corresponding PDP context, it need not wait for the DeletePDPContextResponse from the SGSN before sending the RADIUS DisconnectResponse to the AAA server.\nThe Teardown-Indicator in the RADIUS Disconnect Request message indicates to the GGSN that all PDP contexts for this particular user and sharing the same user session shall be deleted. The PDP contexts belong to the same IP-CAN session are identified by the Acct-Session-Id. The Charging-Id contained in the Acct-Session-Id can be of any PDP context of the user. The GGSN is able to find out all the related PDP contexts sharing the same user session once it has found the exact PDP context from the Acct-Session-Id. If a user has the same user IP address for different sets of PDP contexts towards different networks, only the PDP contexts linked to the one identified by the Acct-Session-Id shall be deleted.\nSince the Charging-Id contained in the Acct-Session-Id is already sufficient to uniquely identify PDP context(s) for a user session on a GGSN, it has no impact if the user IP address is not known by the GGSN (e.g. in the case of transparent PPP IP-CAN sessions). In this case the user IP address in the Disconnect message should be set to zero (e.g. 0.0.0.0 for IPv4).\nThe figure depicts a network setup with a GGSN (Gateway Services Gateway) and SGSN (Service Gateway Services) nodes, illustrating the communication between them. The GGSN is responsible for managing the RADIUS (Remote Authentication Dial-In User Service) and AAA (Authentication, Authorization, Accounting) services, while the SGSN handles the GGSN's RADIUS and AAA services. The figure also shows the deletion of the PDP context response from the SGSN, which is a crucial step in the RADIUS Disconnect process.\nNOTE:\tAs showed on figure 25, the GGSN need not wait for the DeletePDPContextResponse from the SGSN to send the RADIUS DisconnectResponse to the AAA server.\n\nFigure 25: PDP Context deletion with RADIUS\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "16.3a\tAuthentication and accounting message flows on Sgi interface",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "16.3a.1\tAuthentication, Authorization and Accounting procedures",
                            "text_content": "When a P-GW receives an initial access request (e.g. Create Session Request or Proxy Binding Update) message for a given APN, the P-GW may (depending on the configuration for this APN) send a RADIUS Access-Request to an AAA server. The AAA server authenticates and authorizes the user. If the RADIUS server is also responsible for IPv4 address and/or IPv6 prefix allocation, the AAA server shall return the allocated IPv4 address and/or IPv6 prefix in the Access-Accept message.\nWhen PDN type is IPv4v6 and deferred IPv4 addressing via IPv4 address pool in the AAA server is used, the P-GW may intiate RADIUS re-authorization procedures after successful initial attach for the purpose of IPv4 address allocation or to renew the lease for a previously allocated IPv4 address. In this case, the P-GW shall set the Service-Type attribute to \"Authorize Only\" and the 3GPP-Allocate-IP-Type subattribute to the type of IP address to be allocated in the Access-Request message sent to the AAA server. See subclause 16.4.7.2 for the conditions to use 3GPP-Allocate-IP-Type sub-attribute in Access-Request messages. If the P-GW is using DHCPv4 signalling towards the UE and the RADIUS server includes the Session-Timeout attribute in the Access-Accept, the P-GW may use the Session-Timeout value as the DHCPv4 lease time. The P-GW shall not set the DHCPv4 lease time value higher than the Session-Timeout value. The P-GW may renew the DHCP lease to the UE without re-authorization towards the AAA server providing that the new lease expiry is no later than the Session-Timeout timer expiry. If the P-GW wishes to extend the lease time beyond the current Session-Timeout expiry, it shall initiate a new AAA re-authorization.\nEven if the P-GW was not involved in user authentication, it may send a RADIUS Accounting-Request (START) message to an AAA server. This message may contain parameters, e.g. the tuple which includes the user-id and IPv4 address and/or IPv6 prefix, to be used by application servers (e.g. WAP gateway) in order to identify the user. This message also indicates to the AAA server that the user session has started. The session is uniquely identified by the Acct-Session-Id that is composed of the Charging-Id and the PGW-Address.\nIf some external applications require RADIUS Accounting-Request (START) information before they can process user packets, then the selected APN (P-GW) may be configured in such a way that the P-GW drops user data until the Accounting-Response (START) is received from the AAA server. The P-GW may wait for the Accounting-Response (START) before sending the initial access response (e.g. Create Session Response or Proxy Binding Acknowledgement). The P-GW may reject the initial access request if the Accounting-Response (START) is not received. The authentication and accounting servers may be separately configured for each APN.\nFor PDN type IPv4, at IPv4 address allocation via DHCPv4 signalling between the UE and the PDN, no IPv4 address is available at initial access. In that case the P-GW may wait to send the Accounting-Request (START) message until the UE receives its IPv4 address in a DHCPACK.\nFor PDN type IPv4v6 and deferred IPv4 addressing, when the IPv4 address is allocated or re-allocated, the accounting session that was established for the IPv6 prefix allocation shall be used to inform the accounting server about the allocated IPv4 address by sending RADIUS Accounting-Request Interim-Update with the Framed-IP-Address attribute and its value field containing the allocated IPv4 address.\nWhen the P-GW receives a message indicating a bearer deactivation request or PDN disconnection request or detach request (e.g. Delete Bearer Command or Proxy Binding Update with lifetime equal 0) and providing a RADIUS Accounting-Request (START) message was sent previously, the P-GW shall send a RADIUS Accounting-Request (STOP) message to the AAA server, which indicates the termination of this particular bearer or user session. The P-GW shall immediately send the corresponding response (e.g. Delete Bearer Request or Proxy Binding Ack with lifetime equal 0) to the peer node (e.g. S-GW) in the Packet Domain, without waiting for an Accounting-Response (STOP) message from the AAA server.\nThe AAA server shall deallocate the IPv4 address and/or IPv6 prefix initially allocated to the subscriber, if there is no session for the subscriber.\nFor PDN type IPv4v6 and deferred IPv4 addressing, when the P-GW receives a message from the UE or the network indicating the release of the IPv4 address (e.g. receiving DHCPRELEASE) or decides to release the IPv4 address on its own (e.g. due to DHCP lease timer expiry or P-GW assigned IPv4 address), the P-GW shall inform the accounting server about the deallocation of the IPv4 address by sending RADIUS Accounting-Request Interim-Update without the Framed-IP-Address attribute.\nAccounting-Request (ON) and Accounting-Request (OFF) messages may be sent from the P-GW to the AAA server to ensure the correct synchronization of the session information in the P-GW and the AAA server.\nThe P-GW may send an Accounting-Request (ON) message to the AAA server to indicate that a restart has occurred. The AAA server may then release the associated resources.\nPrior to a scheduled restart, the P-GW may send Accounting-Request (OFF) message to the AAA server. The AAA server may then release the associated resources.\nIf an Access-Challenge is sent to the P-GW when an Access-Request message is pending, the P-GW shall silently discard the Access-Challenge message and it shall treat an Access-Challenge as though it had received an Access-Reject instead RFC 2865 [38].\nFor example, figure 25a.1 represents the RADIUS message flows between a P-GW and an Authentication, Authorization and Accounting (AAA) server, which is applicable for GTP based S5/S8:\nThe figure depicts a network architecture with a focus on the fiber-optic backbone, highlighting the role of core switches, optical line terminals (OLTs), and distributed nodes. The layered design aligns with SDN principles, ensuring redundancy and failover reliability.\nNOTE 1:\tIf some external applications require RADIUS Accounting request (Start) information before they can process user packets, then the selected APN (P-GW) may be configured in such a way that the P-GW drops user data until the Accounting Response (START) is received from the AAA server. The P-GW may wait for the Accounting Response (START) before sending the Create Session Response. The P-GW may reject the bearer if the Accounting Response (START) is not received.\nNOTE 2:\tSeparate accounting and authentication servers may be used.\n\nFigure 25a.1: An example of RADIUS message flow on Sgi interface for GTP-based S5/S8 (successful user authentication case)\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16.3a.2\tAccounting Update",
                            "text_content": "During the life of an IP-CAN bearer some information related to this bearer may change. Upon occurrence of the following events, the P-GW may send RADIUS Accounting Request Interim-Update to the AAA server: RAT change, S-GW address change and QoS change. Interim updates are also used when the IPv4 address is allocated/released/re-allocated for deferred IPv4 addressing for the PDN type IPv4v6.\nWhen the P-GW receives a signalling request (e.g. Modify Bearer Request in case of GTP-based S5/S8) that indicates the occurrence of one of these chargeable events, the P-GW may send an Accounting Request Interim-Update to the AAA server to update the necessary information related to this bearer. The P-GW need not wait for the RADIUS AccountingResponse message from the AAA server before sending the response for the triggering signalling message (e.g. Modify Bearer Response). The P-GW may delete the bearer if the AccountingResponse is not received from the AAA.\nThe P-GW may also send interim updates at the expiry of an operator configured time limit.\nThe following Figure 25a.2 is an example message flow to show the procedure of RADIUS accounting update, which applicable for GTP based S5/S8:\nThe figure depicts a RADIUS accounting update for a Modify Bearer Request, illustrating the process of updating the accounting information for a specific user. The update is performed by the RADIUS server, which sends the necessary updates to the RADIUS client. The figure shows the steps involved in the update, including the creation of a new account, the addition of the new user, and the transmission of the updated accounting information. The figure is a visual representation of the complex process of managing user accounts in a network, highlighting the importance of accurate and timely accounting updates for network security and performance.\nFigure 25a.2: RADIUS accounting update for Modify Bearer Request\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16.3a.3\tAAA-Initiated Bearer termination",
                            "text_content": "RADIUS is used as the protocol between the P-GW and the AAA server or proxy for applications (e.g. MMS) to deliver information related to EPS user session. However some IP applications could need to interwork with the P-GW to release the corresponding resource (e.g. terminate a particular bearer or Resource Allocation Deactivation procedures as defined in TS 23.402 [78]). For this purpose, the AAA server or proxy may send a RADIUS Disconnect Request to the P-GW. On receipt of the Disconnect-Request from the AAA server, the P-GW shall release the corresponding resources and reply with a Disconnect-ACK. If the P-GW is unable to release the corresponding resources, it shall reply to the AAA server with a Disconnect-NAK. For more information on RADIUS Disconnect, see IETF RFC 3576 [41]. If the P-GW deletes the corresponding bearer, it need not wait for the response from the S-GW or non-3GPP IP access or ePDG before sending the RADIUS DisconnectResponse to the AAA server.\nThe Teardown-Indicator in the RADIUS Disconnect Request message indicates to the P-GW that all IP-CAN bearers for this particular user and sharing the same user session shall be deleted. The IP-CAN bearers that belong to the same IP-CAN session are identified by the Acct-Session-Id. The Charging-Id contained in the Acct-Session-Id can be of any IP-CAN bearer of the user. The P-GW is able to find out all the related IP-CAN bearers sharing the same user session once it has found the exact IP-CAN bearer from the Acct-Session-Id. If a user has the same user IP address for different sets of IP-CAN bearers towards different networks, only the IP-CAN bearers linked to the one identified by the Acct-Session-Id shall be deleted.  If the value of Teardown-Indicator is set to \"0\" or if TI is missing, and if the Acct-Session-Id identifies the default bearer, the P-GW shall tear-down all the IP-CAN bearers that share the same user session identified by the Acct-Session-Id.\nThe following Figure 25a.3 is an example message flow to show the procedure of RADIUS AAA-Initiated Bearer termination, which applicable for GTP based S5/S8:\nThe figure depicts a network setup with a P-GW (Primary Gateway) and a S-GW (Secondary Gateway) connected through a RADIUS (Remote Authentication Dial-In User Service) server. The P-GW needs to send a RADIUS DisconnectResponse to the AAA (Authentication, Authorization, Accounting) server to disconnect the session. The figure also includes a Delete Bearer Response from the S-GW to the P-GW, indicating that the session is being deleted.\nNOTE:\tAs shown on figure 25a.3, the P-GW need not wait for the Delete Bearer Response from the S-GW to send the RADIUS DisconnectResponse to the AAA server.\n\nFigure 25a.3: AAA-initiated bearer termination with RADIUS\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "16.4\tList of RADIUS attributes",
                    "description": "",
                    "summary": "",
                    "text_content": "The following tables describe the actual content of the RADIUS messages exchanged between the GGSN/P-GW and the AAA server. Other RADIUS attributes may be used as defined in RADIUS RFC(s). Unless otherwise stated, when the encoding scheme of an attribute is specified as UTF-8 encoding, this shall be interpreted as UTF-8 hexadecimal encoding.\nNOTE:\tAny digit is converted into UTF-8 character. For example, digit 5 is converted to UTF-8 character ‘5’, which in hexadecimal representation has a value 0x35. Similarly, a hexadecimal digit F is converted to either UTF-8 character ‘F’, which in hexadecimal representation has a value 0x46, or to UTF-8 character ‘f’, which in hexadecimal representation has a value 0x66.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "16.4.1\tAccess-Request message (sent from GGSN/P-GW to AAA server)",
                            "text_content": "Table 1 describes the attributes of the Access-Request message.\nTable 1: The attributes of the Access-Request message\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 1: The attributes of the Access-Request message",
                                    "table number": 3,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "16.4.2\tAccess-Accept (sent from AAA server to GGSN/P-GW)",
                            "text_content": "Table 2 describes the attributes of the Access-Accept message. See RFC 2548 [51] for definition of MS specific attributes.\nTable 2: The attributes of the Access-Accept message\n\nNOTE:\tThe other optional attributes starting with \"Tunnel-\" not listed in the above table,  can be referred to the IETF RFC 2868[119] with implementation specific.\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 2: The attributes of the Access-Accept message",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "16.4.3\tAccounting-Request START (sent from GGSN/P-GW to AAA server)",
                            "text_content": "Table 3 describes the attributes of the Accounting-Request START message.\nTable 3: The attributes of the Accounting-Request START message\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 3: The attributes of the Accounting-Request START message",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "16.4.4\tAccounting Request STOP (sent from GGSN/P-GW to AAA server)",
                            "text_content": "Table 4 describes the attributes of the Accounting-Request STOP message.\nTable 4: The attributes of the Accounting-Request STOP message\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 4: The attributes of the Accounting-Request STOP message",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "16.4.5\tAccounting Request ON (optionally sent from GGSN/P-GW to AAA server)",
                            "text_content": "Table 5 describes the attributes of the Accounting-Request ON message.\nTable 5: The attributes of the Accounting-Request ON message\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5: The attributes of the Accounting-Request ON message",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "16.4.6\tAccounting Request OFF (optionally sent from GGSN/P-GW to AAA server)",
                            "text_content": "Table 6 describes the attributes of the Accounting-Request OFF message.\nTable 6: The attributes of the Accounting-Request OFF message\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6: The attributes of the Accounting-Request OFF message",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "16.4.7\tSub-attributes of the 3GPP Vendor-Specific attribute",
                            "text_content": "Table 7 describes the sub-attributes of the 3GPP Vendor-Specific attribute of the Access-Request, Access-Accept, Accounting-Request START, Accounting-Request STOP, Accounting-Request Interim-Update and Disconnect-Request messages. The applicability of each sub-attribute to Gi and Sgi reference points is also indicated in Table 7.\nTable 7: List of the 3GPP Vendor-Specific sub-attributes\n\nThe information represented by some of the Sgi sub-attributes may not be available to the P-GW depending on the UE’s radio access and the S5/S8 protocol type (GTP or PMIP). For example, the P-GW will be aware of the User Location Info (e.g. TAI) if the user is in LTE access and GTP based S5/S8 is used.  However, such information is not passed to the P-GW when PMIP based S5/S8 is utilised. In such scenarios, if a sub-attribute is configured in the P-GW to be transferred to the RADIUS AAA server, but the information in the P-GW is not up to date or not available; the P-GW shall not send the corresponding sub-attribute, unless otherwise stated in the following subclause where the encoding of each sub-attribute is specified.\nIn this subclause the provisions of IETF RFC 2865 [38] apply, which in particular specify the following:\n-\tthe Length field of an attribute is one octet, and it indicates the length of this Attribute including the Type, Length and Value fields.\n-\ttype String may be 1-253 octets long and it contains binary data (values 0 through 255 decimal, inclusive).  Strings of length zero (0) shall not be sent, but the entire attribute shall be omitted. A NULL terminating character shall not be appended to an attribute of type String.\n-\ttype Text may be 1-253 octets long and it contains UTF-8 encoded characters.  Text of length zero (0) shall not be sent, but the entire attribute shall be omitted. A NULL terminating character shall not be appended to an attribute of type Text.\n-\ttype Address is 32 bit value and most significant octet is the first one.\n-\ttype Integer is 32 bit unsigned value and most significant octet is the first one.\nThe RADIUS vendor Attribute is encoded as follows (as per IETF RFC 2865 [38])\n\n\nn  7\n3GPP Vendor Id = 10415\nThe string part is encoded as follows:\n\n\nm  2 and m  248\nThe 3GPP specific attributes encoding is clarified below.\nNOTE 1:\tUnless otherwise stated, the encoding of the value field of a 3GPP vendor-specific attribute is identical for Gi and Sgi.\n1 – 3GPP-IMSI\n\n\n3GPP Type: 1\nn 15\nLength: m  17\nIMSI value: Text type:\nA GGSN (or a P-GW) receives IMSI that is encoded according to 3GPP TS 29.060 [24] (or 3GPP TS 29.274 [81]) and converts IMSI into the UTF-8 characters, which are encoded as defined in 3GPP TS 23.003 [40]. There shall be no padding characters between the MCC and MNC, and between the MNC and MSIN. If the IMSI is less than 15 digits, the padding in the GTP information element shall be removed by the GGSN (or the P-GW) and not encoded in this sub-attribute.\n2 – 3GPP-Charging ID\n\n\n3GPP Type: 2\nLength: 6\nCharging ID value: 32 bits unsigned integer\n3 – 3GPP-PDP type\n\n\n3GPP Type: 3\nLength: 6\nPDP type value: Unsigned 32 bits integer type\nPDP type may have the following values:\n0 = IPv4\n1 = PPP\n2 = IPv6\n3 = IPv4v6\n4 = Non-IP\n5 = Unstructured\n6 = Ethernet\nFor P-GW, this sub-attribute represents PDN Type and therefore only the values \"0\", \"2\", \"3\" and \"4\" are applicable.\nThe value 5 Unstructured and 6 Ethernet of PDP type does not apply for the present specification. For specifications referencing the present RADIUS VSA, those values shall only apply if it is explicitely endorsed within the referencing specification.\n4 – 3GPP-Charging Gateway address\n\n\n3GPP Type: 4\nLength: 6\nCharging GW address value: Address type.\n5 – 3GPP-GPRS Negotiated QoS profile\n\n\n3GPP Type: 5\nLength: For GGSN, L  37 (release 7 or higher) or L  33 (release 6 or release 5) or L  27 (release 4 or release 99) or L = 11 (release 98). For P-GW, the length varies depending on the value of QCI. See below for details.\nQoS profile value: Text type\nUTF-8 encoded QoS profile syntax:\n\"<Release indicator> – <release specific QoS IE UTF-8 encoding>\"\n<Release indicator> = UTF-8 encoded number (two characters) :\nFor GGSN:\n\"98\" = Release 98\n\"99\"= Release 99 or release 4\n\"05\"= Release 5 or release 6\n\"07\"= Release 7 or higher\nFor P-GW:\n\"08\"= Release 8 or higher\nFor SMF:\n\"15\"= Release 15 or higher\n<release specific QoS profile UTF-8 encoding> = UTF-8 encoded QoS profile for the release indicated by \tthe release indicator.\nThe UTF-8 encoding of a QoS IE is defined as follows: each octet is described by 2 UTF-8 encoded characters, defining its hexadecimal representation.\nFor GGSN:\nThe QoS profile definition is in 3GPP TS 24.008 [54].\nThe release 98 QoS profile data is 3 octets long, which then results in a 6 octets UTF-8 encoded string.\nThe release 99 and release 4 QoS profile data is 11 octets long, which results in a 22 octets UTF-8 encoded string.\nThe release 5 and release 6 QoS profile data is 14 octets long, which results in a 28 octets UTF-8 encoded string.\nThe release 7 (and higher) QoS profile data is 16 octets long, which results in a 32 octets UTF-8 encoded string.\nFor P-GW:\nIt contains the following QoS parameters associated with the EPS bearer:\n-\tQCI\n-\tARP\n-\tGBR QoS information (UL/DL MBR, UL/DL GBR) or UL/DL APN-AMBR. In other words if the value of QCI indicates a GBR bearer, the GBR QoS information shall be present. If the value of QCI indicates a non-GBR bearer, the APN-AMBR information shall be present.\nThe encoding of the EPS bearer QoS profile parameters is specified in 3GPP TS 29.274 [81]: ARP is specified in Bearer QoS IE; QCI, UL MBR, DL MBR, UL MBR and DL MBR are specified in Flow QoS IE; UL APN-AMBR and DL APN-AMBR are specified in AMBR IE.\nFor GBR QCIs, the encoding of UTF-8 encoded QoS Profile field shall be as follows:\n\n\nFor non-GBR QCIs, the UL/DL MBR and UL/DL GBR fields shall not be present; UL APN-AMBR and DL APN-AMBR fields shall be encoded (in UTF-8 encoded format) respectively after the QCI field.\nFor SMF:\nIt contains the following QoS parameters associated with the QoS flow:\n-\t5QI\n-\tARP\n-\tGBR QoS information (UL/DL MFBR, UL/DL GFBR) or UL/DL Session-AMBR. In other words if the value of 5QI indicates a GBR QoS flow, the GBR QoS information shall be present. If the value of 5QI indicates a non-GBR QoS flow, the Session-AMBR information shall be present.\n5QI value range is 0-255. ARP shall be encoded as Allocation/Retention Priority IE defined in 3GPP TS 29.274 [81]. The UTF-8 encoded UL/DL MFBR, UL/DL GFBR and UL/DL Session-AMBR has the following pattern:\n'^\\d+(\\.\\d+)? (bps|Kbps|Mbps|Gbps|Tbps)$'\nExamples:\n\"125 Mbps\", \"0.125 Gbps\", \"125000 Kbps\"\nFor GBR 5QIs, the encoding of UTF-8 encoded QoS Profile field shall be as follows:\n\n\nFor non-GBR 5QIs, the encoding of UTF-8 encoded QoS Profile field shall be as follows:\n\n\nThe above structures for encoding the QoS profile of Release indicator \"15\" do not apply for the present specification. For specifications referencing the present VSA, those formats shall only apply if it is explicitely endorsed within the referencing specification.\n\n6 – 3GPP-SGSN address\n\n\n3GPP Type: 6\nLength: 6\nSGSN address value: Address type.\n7 – 3GPP-GGSN address\n\n\n3GPP Type: 7\nLength: 6\nGGSN address value: Address type.\n8 – 3GPP-IMSI MCC-MNC\n\n\n3GPP Type: 8\nLength: n shall be 7 or 8 octets depending on the presence of MNC digit 3\nIMSI MCC-MNC address value: Text type.\nThis is the UTF-8 encoded characters representing the IMSI MCC-MNC numerical values. In accordance with 3GPP TS 29.060 [24] (for GGSN), 3GPP TS 29.274 [81] (for P-GW) and 3GPP TS 23.003 [40], the MCC shall be 3 digits and the MNC shall be either 2 or 3 digits. There shall be no padding characters between the MCC and MNC.\n9 – 3GPP-GGSN MCC-MNC\n\n\n3GPP Type: 9\nLength: n shall be 7 or 8 octets depending on the presence of MNC digit 3\nGGSN address value: Text type.\nThis is the UTF-8 encoding of the GGSN MCC-MNC values. In accordance with 3GPP TS 23.003 [40] and 3GPP TS 29.060 [24] the MCC shall be 3 digits and the MNC shall be either 2 or 3 digits. There shall be no padding characters between the MCC and MNC.\n10 – 3GPP-NSAPI\n\n\n3GPP Type: 10\nLength: 3\nNSAPI value: Text Type.\nIt is the value of the NSAPI of the PDP context the RADIUS message is related to. It is encoded as its hexadecimal representation, using one UTF-8 encoded character. The GGSN should receive NSAPI values in the following hexadecimal range 05 – 0F. The GGSN shall discard digit 0 and convert the remaining digit into one UTF-8 coded character.\nFor P-GW, the value of this sub-attribute represents the EPS Bearer ID as specified in 3GPP TS 29.274 [81].\n11 – 3GPP-Session Stop Indicator\n\n\n3GPP Type: 11\nLength: 3\nValue is set to all 1.\n3GPP-Session Stop Indicator value: Bit String type.\n12 – 3GPP-Selection-Mode\n\n\n3GPP Type: 12\nLength: 3\nSelection mode value: Text type.\nThe format of this sub-attribute shall be a character that represents a single digit, mapping from the binary value of the selection mode in the Create PDP Context message (3GPP TS 29.060 [24]) for the GGSN, and the Create Session Request message (3GPP TS 29.274 [81]) for the P-GW. Where 3GPP TS 29.060 [24] provides for interpretation of the value, e.g. map ‘3’ to ‘2’, this shall be done by the GGSN.\n13 – 3GPP-Charging-Characteristics\n\n\n3GPP Type: 13\nLength: 6\nCharging characteristics value: Text type.\nThe charging characteristics is value of the 2 octets. The value field is taken from the GTP IE described in 3GPP TS 29.060 [24], subclause 7.7.23 for the GGSN and 3GPP TS 29.274 [81] for the P-GW.\nEach octet of this IE field value is represented via 2 UTF-8 encoded character, defining its hexadecimal representation.\n14 – 3GPP-Charging Gateway IPv6 address\n\n\n3GPP Type: 14\nLength: 18\nCharging GW IPv6 address value: IPv6 Address.\nCharging GW IPv6 address is Octet String type.\n15 – 3GPP-SGSN IPv6 address\n\n\n3GPP Type: 15\nLength: 18\nSGSN IPv6 address value: IPv6 Address.\nSGSN IPv6 address is Octet String type.\n16 – 3GPP-GGSN IPv6 address\n\n\n3GPP Type: 16\nLength: 18\nGGSN IPv6 address value: IPv6 Address.\nSGSN IPv6 address is Octet String type.\n17 – 3GPP-IPv6-DNS-Servers\n\n\n3GPP Type: 17\nLength: m = n × 16 + 2; n  1 and n  15; k = m-15\nIPv6 DNS Server value: IPv6 Address.\nIPv6 DNS Server address is Octet String type.\nThe 3GPP- IPv6-DNS-Servers sub-attribute provides a list of one or more (‘n’) IPv6 addresses of Domain Name Server (DNS) servers for an APN. The DNS servers are listed in the order of preference for use by a client resolver, i.e. the first is ‘Primary DNS Server’, the second is ‘Secondary DNS Server’ etc. The sub-attribute may be included in Access-Accept packets.\n18 – 3GPP-SGSN MCC-MNC\n\n\n3GPP Type: 18\nLength: n shall be 7 or 8 octets depending on the presence of MNC digit 3\nSGSN MCC-MNC address value: Text type.\nThis is the UTF-8 encoding of the MCC-MNC values extracted from the RAI or from the Serving Network. In accordance with 3GPP TS 23.003 [40] and 3GPP TS 29.060 [24] (for the GGSN and P-GW connected to a Gn/Gp SGSN) and 3GPP TS 29.274 [81] (for the P-GW in GTP/PMIP S5/S8, S2a, S2b), the MCC shall be 3 digits and the MNC shall be either 2 or 3 digits. There shall be no padding characters between the MCC and MNC.\n19 – 3GPP-Teardown Indicator\n\n\n3GPP Type: 19\nLength: 3\nOctet 3 is Octet String type.\nFor GGSN, if the value of TI is set to \"1\", then all PDP contexts that share the same user session with the PDP context identified by the Acct-Session-Id shall be torn down. Only the PDP context identified by the Acct-Session-Id shall be torn down if the value of TI is \"0\" (see subclause 16.3.4 \"AAA-Initiated PDP context termination\"), or if TI is missing.\nFor P-GW, the usage of Teardown-Indicator is as follows (see subclause 16.3a.3 for more deails):\n-\tif the value of TI is set to \"1\", then all IP-CAN bearers that share the same user session with the IP-CAN bearer identified by the Acct-Session-Id shall be torn down.\n-\tif the value of TI is \"0\", or if TI is missing, only the IP-CAN bearer identified by the Acct-Session-Id shall be torn down. If the Acct-Session-Id identifies the default bearer, the P-GW shall tear down all the IP-CAN bearers that share the same user session identified by the Acct-Session-Id.\n20 -3GGP- IMEISV\n\n\n3GPP Type: 20\nIMEISV value: Text type.\nA GGSN receives IMEI(SV) that is encoded according to 3GPP TS 29.060 [24]. A P-GW receives IMEI(SV) that is encoded in ME Identity IE specified in 3GPP TS 29.274 [81]. The GGSN or the P-GW converts IMEI(SV) into a  sequence of UTF-8 characters.IMEI(SV) shall be encoded as defined in 3GPP TS 23.003 [40].\n14  n  16\nn = 16 for IMEISV, where TAC = 8 digits  SNR = 6 digits & SVN = 2 digits;\nn = 15 for IMEI, where TAC = 8 digits  SNR = 6 digits & Spare = 1 digit;\nn = 14 for IMEI, where TAC = 8 digits  SNR = 6 digits (Spare digit is not sent)\n21 – 3GPP-RAT-Type\n\n\n3GPP Type: 21\nThe 3GPP-RAT-Type sub-attribute indicates which Radio Access Technology is currently serving the UE.\nRAT field: Radio Access Technology type values. RAT field is Octet String type. For GGSN, it shall be coded as specified in 3GPP TS 29.060 [24]. For P-GW, it shall be coded as follows:\n0-9\t\tAs specified in 3GPP TS 29.274 [81]\n10-50\t\tSpare for future use\n51\t\t\tNR\n52\t\t\tNR in unlicensed bands\n53\t\t\tTrusted WLAN\n54\t\t\tTrusted Non-3GPP access\n55\t\t\tWireline access\n56\t\t\tWireline Cable access\n57\t\t\tWireline BBF access\n58\t\t\tNR RedCap\n59-100\t\tSpare for future use\n101\t\tIEEE 802.16e\n102\t\t3GPP2 eHRPD\n103\t\t3GPP2 HRPD\n104\t\t3GPP2 1xRTT\n105\t\t3GPP2 UMB\n106-255\tSpare for future use\nThe value 51-58 does not apply for the present specification. For specifications referencing the present RADIUS VSA, the value shall only apply if it is explicitely endorsed within the referencing specification.\n22 – 3GPP-User-Location-Info\n\n\n3GPP Type: 22\nLength=m, where m depends on the Geographic Location Type\nFor example, m= 10 in the CGI and SAI types.\nGeographic Location Type field is used to convey what type of location information is present in the ‘Geographic Location’ field. For GGSN, the Geographic Location Type values and coding are as defined in 3GPP TS 29.060 [24]. For P-GW, the Geographic Location Type values and coding are defined as follows:\n0\t\t\tCGI\n1\t\t\tSAI\n2\t\t\tRAI\n3-127\t\tSpare for future use\n128\t\tTAI\n129\t\tECGI\n130\t\tTAI and ECGI\n131\t\teNodeB ID\n132\t\tTAI and eNodeB ID\n133\t\textended eNodeB ID\n134\t\tTAI and extended eNodeB ID\n135\t\tNCGI\n136\t\t5GS TAI\n137\t\t5GS TAI and NCGI\n138\t\tNG-RAN Node ID\n139\t\t5GS TAI and NG-RAN Node ID\n140-255\tSpare for future use\nGeographic Location field is used to convey the actual geographic information as indicated in the Geographic Location Type. For GGSN, the coding of this field is as specified in 3GPP TS 29.060 [24]. For P-GW, the coding of this field shall be as follows:\n-\tIf the Geographic Location Type has a value indicating CGI, SAI, RAI, TAI or ECGI (i.e. the value field is equal to 0, 1, 2, 128, or 129), the coding of the Geographic Location field shall be as per clauses 8.21.1 to 8.21.5, respectively, in 3GPP TS 29.274 [81],\n-\tIf the Geographic Location Type has a value indicating TAI and ECGI (i.e. the value field is equal to 130), in Geographic Location field both TAI and ECGI shall be encoded one after another as per clauses 8.21.4 and 8.21.5 in 3GPP TS 29.274 [81]. TAI information shall be encoded first starting with Octet 4 of 3GPP-User-Location-Info.\n-\tIf the Geographic Location Type has a value indicating eNodeB ID (i.e. the value field is equal to 131), the coding of the Geographic Location field shall be as defined in subclause 8.21.7 in 3GPP TS 29.274 [81].\n-\tIf the Geographic Location Type has a value indicating TAI and eNodeB ID (i.e. the value field is equal to 132), in Geographic Location field both TAI and eNodeB ID shall be encoded one after another as per subclauses 8.21.4 and 8.21.7 in 3GPP TS 29.274 [81].\n-\tIf the Geographic Location Type has a value indicating extended eNodeB ID (i.e. the value field is equal to 133), the coding of the Geographic Location field shall be as defined in subclause 8.21.8 in 3GPP TS 29.274 [81].\n-\tIf the Geographic Location Type has a value indicating TAI and extended eNodeB ID (i.e. the value field is equal to 134), in Geographic Location field both TAI and extended eNodeB ID shall be encoded one after another as per subclauses 8.21.4 and 8.21.8 in 3GPP TS 29.274 [81].\nNOTE 1:\tThe Geographic Location Type values \"TAI and ECGI\" is used only in 5GC-EPC interworking e.g in 3GPP TS 29.214 [121].\nThe Geographic Location Type values \"NCGI\", \"5GS TAI\", \"5GS TAI and NCGI\", \"NG-RAN Node ID\" and \"5GS TAI and NG-RAN Node ID\" are only introduced to extend the 3GPP-User-Location-Info AVP derived from the 3GPP Vendor-Specific RADIUS attributes and shall not apply for the present specification. For specifications referencing the present data type, those values shall only apply if they are explicitely endorsed within the referencing specification. For those values, the Geographic Location field shall be coded as follows:\nNOTE 2:\tThe Geographic Location Type values \"NCGI\", \"NG-RAN Node ID\" and \"5GS TAI and NG-RAN Node ID\" are not used in 5G till current releases, while the value \"5GS TAI and NCGI\" is used only in 5GC e.g in 3GPP TS 29.214 [121].\n-\tIf the Geographic Location Type has a value indicating NCGI (i.e. the value field is equal to 135), the coding of the Geographic Location field shall be as per subclause 9.3.1.7 in 3GPP TS 38.413 [115]. Spare bits shall be placed just after the PLMN Identity and shall be set to zero.\n-\tIf the Geographic Location Type has a value indicating 5GS TAI (i.e. the value field is equal to 136), the coding of the Geographic Location field shall be as per subclause 9.3.3.11 in 3GPP TS 38.413 [115].\n-\tIf the Geographic Location Type has a value indicating 5GS TAI and NCGI (i.e. the value field is equal to 137), in Geographic Location field both 5GS TAI and NCGI shall be encoded one after another as per subclause 9.3.3.11 in 3GPP TS 38.413 [115] and per subclause 9.3.1.7 in 3GPP TS 38.413 [115]. Spare bits for the NCGI shall be placed just after the PLMN Identity and shall be set to zero.\n-\tIf the Geographic Location Type has a value indicating NG-RAN Node ID (i.e. the value field is equal to 138), the first octet of the Geographic Location field shall be length of the NG-RAN Node ID in unit of bit, and it also indicates the type of NG-RAN node as follows:\n1.\tlength value = 18, short ng-eNodeB ID\n2.\tlength value = 20, ng-eNodeB ID\n3.\tlength value = 21, long ng-eNodeB ID\n4.\tlength value = 22-32, gNodeB ID\nStarting from the second octet of the Geographic Location field, the coding shall be as per subclause 9.3.1.5 in 3GPP TS 38.413 [115], i.e. first PLMN information then NG-RAN Node ID. Spare bits shall be set to zero.\n-\tIf the Geographic Location Type has a value indicating 5GS TAI and NG-RAN Node ID (i.e. the value field is equal to 139), in Geographic Location field both 5GS TAI and NG-RAN Node ID shall be encoded one after another as per subclause 9.3.3.11 in 3GPP TS 38.413 [115] and as described for NG-RAN Node ID (i.e. the value field is equal to 138). Spare bits shall be set to zero.\nGeographic Location Type and Geographic Location fields are Octet String type.\n23 – 3GPP-MS-TimeZone\n\n\n3GPP Type: 23\nLength=4\nThe Time Zone field and the Daylight Saving Time fields are used to indicate the offset between universal time and local time in steps of 15 minutes of where the MS/UE currently resides.\nFor GGSN, both fields are coded as specified in 3GPP TS 29.060 [24] and represented as Octet String type. For, P-GW, both fields are coded as specified in 3GPP TS 29.274 [81] in UE-Time Zone IE and represented as Octet String type.\n24 – 3GPP-Camel-Charging-Info\n\n\n3GPP Type: 24\nLength=m\nm depends  on the size of the CAMELInformationPDP IE.\nThe CAMEL Charging Information Container field is used to copy the CAMELInformationPDP IE including Tag and Length from the SGSN’s CDR (S-CDR).\nThe coding of this field is as specified in 3GPP TS 29.060 [24] and represented as Octet String type.\n25 – 3GPP-Packet-Filter\n\n\n3GPP Type: 25\nLength: n\nEach 3GPP-Packet-Filter sub-attribute contains only one packet filter. Multiple 3GPP-Packet-Filter sub-attributes can be sent in one RADIUS Accounting Request message.\nWhen the GGSN/P-GW sends the packet filter information, the RADIUS message shall carry ALL (or none) of the packet filters.\nPacket Filter Value:\n\n\nDirection Value:\n00000000: Downlink\n00000001: Uplink\n00000010: Bidirectional\nThe packet filter content is represented as Octet String type. The packet filter content is defined below:\n\n\nNOTE 3:\tThe sending of this sub-attribute is not recommended for an inter-operator interface for security reason.\n26 – 3GPP-Negotiated-DSCP\n\n\n3GPP Type: 26\nLength:  3\nNegotiated DSCP value: Octet String\nDSCP value: Octet String type.\n27 – 3GPP-Allocate-IP-Type\n\n\n3GPP Type: 27\nIf multiple Access-Request signalling towards a AAA server is needed during the lifetime of a PDN connection (e.g. for PDN/PDP type IPv4v6 and deferred IPv4 addressing), this sub-attribute shall be included in the Access-Request message to indicate how the AAA server needs to treat the request. The P-GW/GGSN may also use this sub-attribute if the AAA server is configured to allocate both IPv4 address and IPv6 prefix but the P-GW/GGSN requires assignment of only one IP type or both IP types (e.g. because the UE supports single IP stack and it has requested PDN/PDP type of IPv4 or IPv6).\nIf this sub-attribute does not exist in Access-Request from P-GW/GGSN to the AAA server, the IP address allocation shall be based on the IP address allocation policy configured in the the AAA server.\nIP Type field: It is encoded in Octet String type and the following decimal equivalent values apply:\n0\tDo not allocate IPv4 address or IPv6 prefix. \nThe typical use case is for PDN/PDP type IPv4v6 and deferred IPv4 addressing and only IPv4 address is allocated by the AAA server but IPv6 prefix is allocated by some other means, e.g. local pool in the P-GW/GGSN. The Access-Request from the P-GW/GGSN to the AAA server during the UE’s initial access to the network shall set the value of this sub-attribute to 0.\n1\tAllocate IPv4 address\nThe typical use case is for PDN/PDP type IPv4v6 and deferred IPv4 addressing and the IPv4 address (and/or IPv6 prefix) is allocated by the AAA server. The Access-Request from the P-GW/GGSN to the AAA server when the P-GW/GGSN receives UE-initiated IPv4 address allocation signalling (e.g. DHCPv4) after UE’s successful initial access to the PDN shall set the value of this attribute to 1.  In this case, if the AAA server had allocated an IPv6 prefix earlier during UE’s initial access to the network, same IPv6 prefix shall be kept allocated.\n2\tAllocate IPv6 prefix\nThe typical use case is for PDN/PDP type IPv4v6 and deferred IPv4 addressing and both IPv4 address and IPv6 prefix are allocated by the AAA server. The Access-Request from the P-GW/GGSN to the AAA server during the UE’s initial access to the network shall set the value of this sub-attribute to 2.\n3\tAllocate IPv4 address and IPv6 prefix\nCurrently there is no use case identified to use this specific value for PDN/PDP tpe IPv4v6 and deferred IPv4 addressing. One potential use case is for PDN/PDP type IPv4v6 and non-deferred IPv4 addressing and both IPv4 address and IPv6 prefix are allocated by the AAA server. The Accesss-Request from the P-GW/GGSN to the AAA server may use this value to have both IPv4 address and IPv6 prefix assigned to the UE.\n4-255\tReserved for future use\n28 – External-Identifier\n\n\n3GPP Type: 28\nn   72 / 253                (n  72 octets shall be supported, n   253 octets recommended, refer to 3GPP TS 29.336 [101] and  IETF RFC 4282 [102])\nLength: m  74 / 255   (m  74 octets shall be supported, m   255 octets recommended, refer to 3GPP TS 29.336 [101] and  IETF RFC 4282 [102])\nExternal-Identifier value: Text type.\nA globally unique identifier of a UE used towards external server instead of IMSI and MSISDN, refer to 3GPP TS 23.682 [100] and 3GPP TS 23.003 [40].\n29 – TWAN-Identifier\n\n\n3GPP Type: 29\nLength=m, where m depends on the type of location that is present as described in 3GPP TS 29.274 [81].\nTWAN Identifier field is used to convey the location information in a Trusted WLAN Access Network (TWAN). The coding of this field shall be the same as for the GTP TWAN Identifier starting with Octet 5, as per clause 8.100 in 3GPP TS 29.274 [81].\nTWAN Identifier field is Octet String type.\n30 – 3GPP-User-Location-Info-Time\n\n\n3GPP Type: 30\nLength=6\nUser Location Info time field is Unsigned32 type, it indicates the NTP time at which the UE was last known to be in the location which is reported during bearer deactivation or UE detach procedure.\n31 – 3GPP-Secondary-RAT-Usage\n\n\n3GPP Type: 31\nLength=28\nMultiple 3GPP-Secondary-RAT-Usage sub-attributes can be sent in one RADIUS Accounting Request Interim-Update/STOP message.\nOctet 3 is Octet String type. The encoding of RAT field (bit 1 to bit 4) is:\n0 – NR\n1 – NR-U\n2 – EUTRA\n3 – EUTRA-U\n4 – Unlicensed Spectrum\n5-15 – spare, reserved for future use\nSESS (bit 5): If it is set to 1, it indicates the secondary RAT usage of the PDU session.\nThe values 1, 2 and 3 of RAT field and SESS field do not apply for the present specification. For specifications referencing the present RADIUS VSA, they shall only apply if it is explicitely endorsed within the referencing specification. Bit 6 to bit 8 of octet 3 is spare and reserved for future use.\nThe encoding of octets 4 to 28 is specified in Secondary RAT Usage Data Report IE of 3GPP TS 29.274 [81].\n32 – 3GPP-UE-Local-IP-Address\n\n\n3GPP Type: 32\nLength=7 or 19\nIP Type field: It is encoded in Octet String type and the following decimal equivalent values apply:\n1\t\t\tUE local IPv4 address \n2\t\t\tUE local IPv6 address\nUE local IP address field: It is encoded in Octet String type, with 4 octets when the IP Type is UE local IPv4 address, or with 16 octets when the IP Type is UE local IPv6 address.\n33 – 3GPP-UE-Source-Port\n\n\n3GPP Type: 33\nLength=5\nSource Port Type field: It is encoded in Octet String type and the following decimal equivalent values apply:\n1\t\t\tUDP Source Port \n2\t\t\tTCP Source Port\nPort Number field: It is encoded in Octet String type, with bit 8 of Octet 4 represents the most significant bit of the port number and bit 1 of Octet 5 represents the least significant bit.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7: List of the 3GPP Vendor-Specific sub-attributes",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 10,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 11,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 12,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 13,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 14,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 15,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 16,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 17,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 18,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 19,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 20,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 21,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 22,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 23,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 24,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 25,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 26,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 27,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 28,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 29,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 30,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 31,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 32,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 33,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 34,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 35,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 36,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 37,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 38,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 39,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 40,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 41,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 42,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 43,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 44,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 45,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 46,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 47,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 48,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 49,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "16.4.8\tAccounting Request Interim-Update (sent from GGSN/P-GW to AAA server)",
                            "text_content": "Table 8 describes the attributes of the Accounting-Request Interim-Update message.\nTable 8: The attributes of the Accounting-Request Interim-Update message\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8: The attributes of the Accounting-Request Interim-Update message",
                                    "table number": 50,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "16.4.9\tDisconnect Request (optionally sent from AAA server to GGSN/P-GW)",
                            "text_content": "Table 9 describes the attributes of the Disconnect-Request message.\nTable 9: The attributes of the Disconnect-Request message\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 9: The attributes of the Disconnect-Request message",
                                    "table number": 51,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "title": "16a\tUsage of Diameter on Gi/Sgi interface",
            "description": "As an operator option, it is also possible to use the Diameter protocol in order to provide Authentication, Authorization and Accounting services.\nA GGSN/P-GW may, on a per APN basis, use Diameter authentication to authenticate a user and Diameter accounting to provide information to a Diameter server.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "16a.1\tDiameter Authentication and Authorization",
                    "description": "",
                    "summary": "",
                    "text_content": "Diameter Authentication and Authorization shall be used according to RFC 7155 [120].\nThe GGSN/P-GW and the Diameter server shall advertise the support of the Diameter NASREQ Application by including the value of the appropriate application identifier in the Capability-Exchange-Request and Capability-Exchange-Answer commands as specified in IETF RFC 6733 [111].\nThe Diameter client function may reside in a GGSN/P-GW. When the GGSN/P-GW receives an initial attach (e.g. Create PDP Context) request message the Diameter client function may send the authentication information to an authentication server, which is identified during the APN provisioning.\nThe authentication server checks that the user can be accepted. The response (when positive) may contain network information, such as an IPv4 address and/or IPv6 prefix for the user when the GGSN/P-GW is interworking with the AAA server.\nThe information delivered during the Diameter authentication can be used to automatically correlate the users identity (the MSISDN or IMSI) to the IPv4 address and/or IPv6 prefix, if applicable, assigned/confirmed by the GGSN/P-GW or the authentication server respectively. The same procedure applies, in case of sending the authentication to a ‘proxy’ authentication server.\nDiameter Authentication is applicable to the initial access (e.g. primary PDP context or the default bearer). When the GGSN/P-GW receives a positive response from the authentication server it shall complete the initial access (e.g. PDP context activation) procedure. If a failure or no response is received, the GGSN/P-GW shall reject the initial access (e.g. PDP Context Activation) attempt with a suitable cause code, e.g. User Authentication failed.\nThe GGSN may also use the Diameter re-authorization procedure for the purpose of IPv4 address allocation to the UE for PDP type of IPv4v6 after establishment of a PDN connection.\nFor EPS, the P-GW may also use the Diameter re-authorization procedure for the purpose of IPv4 address allocation to the UE for PDN type of IPv4v6 after establishment of a PDN connection. The use cases that may lead this procedure are:\n-\tDeferred IPv4 address allocation via DHCPv4 procedure after successful attach on 3GPP accesses.\n-\tDeferred IPv4 address allocation after successful attach in trusted non-3GPP IP access on S2a.\n-\tDeferred IPv4 home address allocation via DSMIPv6 Re-Registration procedure via S2c.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "16a.2\tDiameter Accounting",
                    "description": "",
                    "summary": "",
                    "text_content": "Diameter Accounting shall be used according to RFC 7155 [120].\nThe Diameter accounting client function may reside in a GGSN/P-GW. The Diameter accounting client may send information to an accounting server, which is identified during the APN provisioning. The accounting server may store this information and use it to automatically identify the user. This information can be trusted because the PS access network has authenticated the subscriber (i.e. SIM card and possibly other authentication methods).\nDiameter Accounting messages may be used during both primary and secondary PDP context activation for non-EPC based packet domain (both the default bearer and dedicated bearer for the EPC based packet domain) and deactivation procedures respectively.\nIf the AAA server is used for IPv4 address and/or IPv6 prefix assignment, then, upon reception of a Diameter Accounting-Request STOP message for all IP-CAN bearers associated to an IP-CAN session defined by APN and IMSI or MSISDN, the AAA server may make the associated IPv4 address and/or IPv6 prefix available for assignment.\nFor PDN/PDP type IPv4v6 and deferred IPv4 address allocation, when the IPv4 address is allocated or re-allocated, the accounting session that was established for the IPv6 prefix allocation shall be used to inform the accounting server about the allocated IPv4 address by sending Diameter Accounting-Request Interim-Update with Framed-IP-Address AVP and its value field containing the allocated IPv4 address. Similarly, the release of IPv4 address shall be indicated to the accounting server by sending Diameter Accounting-Request Interim-Update without the Framed-IP-Address AVP.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "16a.3\tAuthentication and accounting message flows on Gi interface",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "16a.3.1\tIP PDP type",
                            "text_content": "Figure 25a represents the Diameter message flows between a GGSN and a Diameter server.\nThe figure depicts a network architecture with a focus on fiber-optic backbone, illustrating the core switches, optical line terminals (OLTs), and distributed nodes. The layered design aligns with SDN principles, with redundancy paths shown in dashed lines to ensure failover reliability.\nNOTE 1:\tIf some external applications require Diameter Accounting request (Start) information before they can process user packets, then the selected APN (GGSN) may be configured in such a way that the GGSN drops user data until the Accounting Answer (START) is received from the Diameter server. The GGSN may wait for the Accounting Answer (START) before sending the CreatePDPContextResponse. The GGSN may reject the PDP context if the Accounting Answer (START) is not received.\nNOTE 2:\tSeparate accounting and authentication servers may be used.\nNOTE 3:\tThe AA-Request message shall be used for primary PDP context only.\nNOTE 4:\tThe Accounting-Request (Start) message may be sent at a later stage, e.g. after IPv4 address has been assigned and PDP Context updated, in case of IP address allocation via DHCPv4 after successful PDP context activation signalling.\n\nFigure 25a: Diameter message flow for PDP type IP (successful user authentication case)\nWhen a GGSN receives a Create PDP Context Request message for a given APN, the GGSN may (depending on the configuration for this APN) send a Diameter AA-Request to a Diameter server. The Diameter server authenticates and authorizes the user. If Diameter is also responsible for IPv4 address and/or IPv6 prefix allocation the Diameter server shall return the allocated IPv4 address and/or IPv6 prefix in the AA-Answer message. The AA-Request and AA-Answer messages are only used for the primary PDP context.\nWhen PDP type is IPv4v6 and deferred IPv4 addressing via IPv4 address pool in the AAA server is used, the GGSN may intiate Diameter re-authorization procedures after successful initial attach for the purpose of IPv4 address allocation or to renew the lease for a previously allocated IPv4 address. In this case, the GGSN shall set the Session-Id to the value used in the initial access request, the Auth-Request-Type AVP to \"AUTHORIZE_ONLY\" and the 3GPP-Allocate-IP-Type AVP to the type of IP address to be allocated in the AA-Request message sent to the AAA server. See subclause 16.4.7.2 for the conditions to use 3GPP-Allocate-IP-Type AVP in AA-Request messages. If the GGSN is using DHCPv4 signalling towards the MS and the Diameter server includes the Session-Timeout attribute in the Access-Accept, the GGSN may use the Session-Timeout value as the DHCP lease time. The GGSN shall not set the DHCPv4 lease time value higher than the Session-Timeout value. The GGSN may renew the DHCP lease to the MS without re-authorization towards the AAA server providing that the new lease expiry is no later than the Session-Timeout timer expiry. If the GGSN wishes to extend the lease time beyond the current Session-Timeout expiry, it shall initiate a new AAA re-authorization.\nEven if the GGSN was not involved in user authentication (e.g. transparent network access mode), it may send a Diameter Accounting-Request (START) message to a Diameter server. If no Diameter session is already open for the user a Diameter session needs to be activated, otherwise the existing Diameter session is used to send the Accounting-Request (START). The NSAPI will identify the particular PDP context this accounting refers to. The Accounting-Request message also indicates to the Diameter server that the user session has started. This message contains parameters, e.g. the tuple which includes the user-id, IPv4 address and/or IPv6 prefix, and the MSISDN to be used by application servers (e.g. WAP gateway) in order to identify the user.\nIf some external applications require Diameter Accounting request (Start) information before they can process user packets, then the selected APN (GGSN) may be configured in such a way that the GGSN drops user data until the Accounting Answer (START) is received from the Diameter server. The GGSN may wait for the Accounting Answer (START) before sending the CreatePDPContextResponse. The GGSN may reject the PDP context if the Accounting Answer (START) is not received. The authentication and accounting servers may be separately configured for each APN.\nFor PDP type IPv4, at IPv4 address allocation via DHCP4 signalling between the TE and the PDN, no IPv4 address is available at PDP context activation. In that case the GGSN may wait to send the Accounting-Request (START) message until the TE receives its IP address in a DHCPACK.\nFor PDP type IPv4v6 and deferred IPv4 addressing, when the IPv4 address is allocated or re-allocated, the accounting session that was established for the IPv6 prefix allocation shall be used to inform the accounting server about the allocated IPv4 address by sending Diameter Accounting-Request Interim-Update with the Framed-IP-Address AVP and its value field containing the allocated IPv4 address.\nWhen the GGSN receives a Delete PDP Context Request message and providing a Diameter Accounting-Request (START) message was sent previously, the GGSN shall send a Diameter Accounting-Request (STOP) message to the Diameter server, which indicates the termination of this particular user accounting session. The NSAPI will identify the particular PDP context this accounting refers to. The GGSN shall immediately send a Delete PDP context response, without waiting for an Accounting-Answer (STOP) message from the Diameter server.\nIf this was the last PDP context for that PDP address, the GGSN shall additionally send an STR message to the Diameter server. The Diameter server shall reply with an STA and shall deallocate the IP address or IPv6 prefix (if any) initially allocated to the subscriber.\nFor PDP type IPv4v6 and deferred IPv4 addressing, when the GGSN receives a message from the MS or the network indicating the release of the IPv4 address (e.g. receiving DHCPRELEASE) or decides to release the IPv4 address on its own (e.g. due to DHCP lease timer expiry for GGSN assigned IPv4 address), the GGSN shall inform the accounting server about the deallocation of the IPv4 address by sending Diameter Accounting-Request Interim-Update without the Framed-IP-Address AVP.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16a.3.2\tPPP PDP type",
                            "text_content": "Figure 25b describes the Diameter message flows between a GGSN and a Diameter server for the case where PPP is terminated at the GGSN. The case where PPP is relayed to an LNS is beyond the scope of the present document.\nThe figure depicts a network architecture with separate accounting and authentication servers, highlighting the importance of these components in ensuring network security and data integrity.\nNOTE 1:\tSeparate accounting and Authentication servers may be used.\nNOTE 2: \tActual messages depend on the used authentication protocol (e.g. PAP, CHAP).\nNOTE 3: \tIf some external applications require Diameter Accounting request (Start) information before they can process user packets, then the selected APN (GGSN) may be configured in such a way that the GGSN drops user data until the Accounting Answer (START) is received from the AAA server. The GGSN may delete the PDP context if the Accounting Response (START) is not received.\nNOTE 4: \tAn LCP termination procedure may be performed. Either the MS or the GGSN may initiate the context deactivation.\nNOTE 5: \tThe AA-Request message shall be used for primary PDP context only.\nNOTE 6: \tNetwork Initiated deactivation.\nNOTE 7: \tUser Initiated deactivation.\n\nFigure 25b: Diameter message flow for PDP type PPP (successful user authentication case)\nWhen a GGSN receives a Create PDP Context Request message for a given APN, the GGSN shall immediately send a Create PDP context response back to the SGSN. After PPP link setup, the authentication phase may take place. During Authentication phase, the GGSN sends a Diameter AA-Request to a Diameter server. The Diameter server authenticates and authorizes the user. If Diameter is also responsible for IP address allocation the Diameter server shall return the allocated IP address or IPv6 prefix in the AA-answer message (if the user was authenticated).\nIf the user is not authenticated, the GGSN shall send a Delete PDP context request to the SGSN. The AA-Request and AA-Answer messages are only used for the primary PDP context.\nEven if the GGSN was not involved in user authentication (e.g. for PPP no authentication may be selected), it may send a Diameter Accounting-Request (START) message to a Diameter server. If no Diameter session is already open for the user a Diameter session needs to be activated, otherwise the existing Diameter session is used to send the Accounting-Request (START). The NSAPI will identify the particular PDP context this accounting refers to. The Accounting-Request message also indicates to the Diameter server that the user session has started, and the QoS parameters associated to the session. This message contains parameters, e.g. a tuple which includes the user-id, IP address or IPv6 prefix, and the MSISDN to be used by application servers (e.g. WAP gateway) in order to identify the user.\nIf some external applications require Diameter Accounting request (Start) information before they can process user packets, then the selected APN (GGSN) may be configured in such a way that the GGSN drops user data until the Accounting Answer (START) is received from the Diameter server. The GGSN may delete the PDP context if the Accounting Answer (START) is not received. The Authentication and Accounting servers may be separately configured for each APN.\nWhen the GGSN receives a Delete PDP Context Request message and providing a Diameter Accounting-Request (START) message was sent previously, the GGSN shall send a Diameter Accounting-Request (STOP) message to the Diameter server, which indicates the termination of this particular user session. The NSAPI will identify the particular PDP context this accounting refers to. The GGSN shall immediately send a Delete PDP context response, without waiting for an Accounting-Answer (STOP) message from the Diameter server.\nIf this was the last PDP context for that PDP address, the GGSN shall additionally send an STR message to the Diameter server. The Diameter server shall reply with an STA and shall deallocate the IP address or IPv6 prefix (if any) initially allocated to the subscriber.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16a.3.3\tAccounting Update",
                            "text_content": "During the life of a PDP context some information related to this PDP context may change (i.e. SGSN address if an Inter-SGSN RA update occurs). Upon reception of an UpdatePDPContextRequest from the SGSN, the GGSN may send an Accounting Request (Interim) to the Diameter server to update the necessary information related to this PDP context (see figure 25c). Interim updates are also used when the IPv4 address is allocated/released/re-allocated for deferred IPv4 addressing for the PDP type IPv4v6.\nIf the GGSN receives an UpdatePDPContextRequest from the SGSN that specifically indicates a direct tunnel establishment or a direct tunnel teardown (switching the user plane tunnel end back to the SGSN), and only the GTP user plane address or the GTP-U TEID have changed, then the GGSN should not send the Accounting Request (Interim) message to the Diameter server. In such cases, the GGSN need not wait for the Diameter Accounting Answer from the Diameter server message before sending the UpdatePDPContextResponse to the SGSN. The GGSN may delete the PDP context if the Accounting Answer is not received from the Diameter server.\nThe figure depicts a simplified representation of a GGSN (Gateway Submarine Telephone Network) in a 5G network, highlighting its role in managing the network's data traffic. The GGSN is responsible for receiving and processing Diameter Accounting Answer messages from the Diameter server, which are used to update the PDP context in the SGSN. The figure also shows the GGSN's ability to delete the PDP context if the Accounting Answer is not received from the Diameter server.\nNOTE:\tAs shown the GGSN need not wait for the Diameter Accounting Answer message from the Diameter server to send the UpdatePDPContextResponse to the SGSN. The GGSN may delete the PDP context if the Accounting Answer is not received from the Diameter server.\n\nFigure 25c: Diameter for PDP context Update\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16a.3.4\tServer-Initiated PDP context termination",
                            "text_content": "Diameter is used as the protocol between the GGSN and a Diameter server or proxy for applications (e.g. MMS) to deliver information related to GPRS user session. However some IP applications could need to interwork with the GGSN to terminate a particular PDP context. For this purpose, the Diameter server or proxy may send a Diameter ASR to the GGSN along with the NSAPI necessary to identify the particular PDP context to be terminated. As depicted in figure 25d, the GGSN should react by deleting the corresponding PDP context. If the GGSN deletes the corresponding PDP context, it need not wait for the DeletePDPContextResponse from the SGSN before sending the ASA to the server.\nThe absence of the NSAPI in the Diameter ASR message indicates to the GGSN that all PDP contexts for this particular user and sharing the same user session shall be deleted. The PDP contexts belonging to the same IP-CAN session are identified by the Diameter Session-Id. If a user has the same user IP address for different sets of PDP contexts towards different networks, only the PDP contexts linked to the one identified by the Diameter Session-Id shall be deleted.\nThe figure depicts a network setup with a GGSN (Gateway Services Node) and an SGSN (Service Gateway Node), both connected to a Diameter server. The GGSN is responsible for sending the ASA (Access Service Agent) to the Diameter server, while the SGSN is responsible for receiving the ASA from the Diameter server. The figure also shows the network topology with various nodes, including the GGSN, SGSN, and Diameter server, as well as the ASA and the DeletePDPContextResponse.\nNOTE:\tAs showed on figure 25d, the GGSN need not wait for the DeletePDPContextResponse from the SGSN to send the ASA to the Diameter server.\n\nFigure 25d: PDP Context deletion with Diameter\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "16a.3a\tAuthentication and accounting message flows on Sgi interface",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "16a.3a.1\tAuthentication, Authorization and Accounting procedures",
                            "text_content": "When a P-GW receives an initial access request (e.g.Create Session Request or Proxy Binding Update) message for a given APN, the P-GW may (depending on the configuration for this APN) send a Diameter AA-Request to a Diameter server. The Diameter server authenticates and authorizes the user. If the Diameter server is also responsible for IPv4 address and/or IPv6 prefix allocation the Diameter server shall return the allocated IPv4 address and/or IPv6 prefix in the AA-Answer message.\nWhen PDN type is IPv4v6 and deferred IPv4 addressing via IPv4 address pool in the AAA server is used, the P-GW may intiate Diameter re-authorization procedures after successful initial attach for the purpose of IPv4 address allocation or to renew the lease for a previously allocated IPv4 address. In this case, the P-GW shall set the Session-Id to the value used in the initial access request, the Auth-Request-Type AVP to \"AUTHORIZE_ONLY\" and the 3GPP-Allocate-IP-Type AVP to the type of IP address to be allocated in the AA-Request message sent to the AAA server. See subclause 16.4.7.2 for the conditions to use 3GPP-Allocate-IP-Type AVP in AA-Request messages. If the P-GW is using DHCPv4 signalling towards the UE and the Diameter server includes the Session-Timeout attribute in the Access-Accept, the P-GW may use the Session-Timeout value as the DHCP lease time. The P-GW shall not set the DHCPv4 lease time value higher than the Session-Timeout value. The P-GW may renew the DHCP lease to the UE without re-authorization towards the AAA server providing that the new lease expiry is no later than the Session-Timeout timer expiry. If the P-GW wishes to extend the lease time beyond the current Session-Timeout expiry, it shall initiate a new AAA re-authorization.\nEven if the P-GW was not involved in user authentication, it may send a Diameter Accounting-Request (START) message to a Diameter server. If no Diameter session is already open for the same PDN connection a Diameter session needs to be activated, otherwise the existing Diameter session is used to send the Accounting-Request (START). For GTP-based S5/S8/S2a/S2b, if accounting is used per IP-CAN bearer, the EPS bearer ID will identify the particular bearer this accounting message refers to. The Accounting-Request message also indicates to the Diameter server that the user session has started.This message contains parameters, e.g. the tuple which includes the user-id and IPv4 address and/or IPv6 prefix, to be used by application servers (e.g. WAP gateway) in order to identify the user. This message also indicates to the Diameter server that the user session has started.\nIf some external applications require Diameter Accounting Request (START) information before they can process user packets, then the selected APN (P-GW) may be configured in such a way that the P-GW drops user data until an Accounting-Answer (START) indicating success is received from the Diameter server. The P-GW may wait for the Accounting-Answer (START) before sending the initial access response (e.g. Create Session Response or Proxy Binding Acknowledgement). The P-GW may reject the initial access request if the Accounting-Answer (START) is not received. The authentication and accounting servers may be separately configured for each APN.\nFor PDN type IPv4, at IPv4 address allocation via DHCPv4 signalling between the UE and the PDN, no IPv4 address is available at initial access. In that case the P-GW may wait to send the Accounting-Request START message until the UE receives its IPv4 address in a DHCPACK.\nFor PDN type IPv4v6 and deferred IPv4 addressing, when the IPv4 address is allocated or re-allocated, the accounting session that was established for the IPv6 prefix allocation shall be used to inform the accounting server about the allocated IPv4 address by sending Diameter Accounting-Request Interim-Update with the Framed-IP-Address AVP and its value field containing the allocated IPv4 address.\nWhen the P-GW receives a message indicating a bearer deactivation request or PDN disconnection request or detach request (e.g. Delete Bearer Command or Proxy Binding Update with lifetime equal 0) and providing a Diameter Accounting-Request START message was sent previously, the P-GW shall send a Diameter Accounting-Request (STOP) message to the Diameter server, which indicates the termination of this particular bearer or user session. The P-GW shall immediately send the corresponding response (e.g. Delete Bearer Request or Proxy Binding Ack with lifetime equal 0) to the peer node (e.g. S-GW) in the Packet Domain, without waiting for an Accounting-Answer (STOP) message from the Diameter server.\nIf the last bearer of an IP-CAN session is deactivated, the P-GW shall additionally send an STR message to the Diameter server. The Diameter server shall reply with an STA and shall deallocate the IPv4 address and/or IPv6 prefix (if any) initially allocated to the subscriber.\nFor PDN type IPv4v6 and deferred IPv4 addressing, when the P-GW receives a message from the UE or the network indicating the release of the IPv4 address (e.g. receiving DHCPRELEASE) or decides to release the IPv4 address on its own (e.g. due to DHCP lease timer expiry for P-GW assigned IPv4 address), the P-GW shall inform the accounting server about the deallocation of the IPv4 address by sending Diameter Accounting-Request Interim-Update without the Framed-IP-Address AVP.\nThe following Figure 25d.1 is an example message flow to show the procedure of Diameter Authentication and Accounting, which is applicable for GTP based S5/S8:\nThe figure depicts a network architecture with a focus on fiber-optic backbone, highlighting the role of core switches, optical line terminals (OLTs), and distributed nodes. The layered design aligns with SDN principles, with redundancy paths and Diameter Accounting for user data processing.\nNOTE 1:\tIf some external applications require Diameter Accounting request (Start) information before they can process user packets, then the selected APN (P-GW) may be configured in such a way that the P-GW drops user data until the Accounting Answer (START) is received from the Diameter server. The P-GW may wait for the Accounting Answer (START) before sending the Create Session Response. The P-GW may reject the bearer if the Accounting Answer (START) is not received.\nNOTE 2:\tSeparate accounting and authentication servers may be used.\n\nFigure 25d.1: An example of Diameter Authentication and Accounting on Sgi for GTP-based S5/S8\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16a.3a.2\tAccounting Update",
                            "text_content": "During the life of a bearer some information related to this bearer may change. Upon occurrence of the following events the P-GW may send an Accounting Request (Interim) to the Diameter server: RAT change, S-GW address change and QoS change. Interim updates are also used when the IPv4 address is allocated/released/re-allocated for deferred IPv4 addressing for the PDN type IPv4v6.\nWhen the P-GW receives a signalling request (e.g. Modify Bearer Request in case of GTP-based S5/S8) that indicates the occurrence of one of these chargeable events, the P-GW may send an Accounting Request (Interim) to the Diameter server to update the necessary information related to this bearer. The P-GW need not wait for the Diameter Accounting Answer message from the Diameter server before sending the response for the triggering signalling message (e.g. Modify Bearer Response). The P-GW may delete the bearer if the Accounting Answer is not received from the Diameter server.\nThe P-GW may also send interim updates at the expiry of an operator configured time limit.\nThe message flow in figure 25d.2 provides an example for Diameter Accounting Update procedure on Sgi interface, which is applicable for GTP based S5/S8:\nThe figure depicts a 25-200mm diameter counting update for bearer modification, illustrating the process of updating the diameter of a bearer to accommodate changes in the material or size of the bearer.\nFigure 25d.2: Diameter accounting update for bearer modification\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16a.3a.3\tServer-Initiated Bearer termination",
                            "text_content": "Diameter is used as the protocol between the P-GW and a Diameter server or proxy for applications (e.g. MMS) to deliver information related to the user session. However some IP applications could need to interwork with the P-GW to release the corresponding resource (e.g. terminate a particular bearer or Resource Allocation Deactivation procedures as defined in TS 23.402 [78]). For this purpose, the Diameter server or proxy may send a Diameter ASR along with the EPS bearer ID, if available, to identify the particular bearer to be terminated to the P-GW. The P-GW should react by deleting the corresponding bearer. If the P-GW deletes the corresponding bearer, it need not wait for the response from the S-GW or trusted non-3GPP IP access or ePDG before sending the ASA to the server.\nThe absence of the EPS bearer ID in the Diameter ASR message indicates to the P-GW that all bearers/resources for this particular user and sharing the same user session shall be deleted. The bearer(s)/resources belonging to the same IP-CAN session are identified by the Diameter Session-Id. If a user has the same user IP address(es) for different sets of bearers towards different networks, only the bearers linked to the one identified by the Diameter Session-Id shall be deleted.\nThe message flow in figure 25d.3 provides an example for Server-initiated Bearer Termination procedure on Sgi interface, which is applicable for GTP based S5/S8:\n\nThe figure depicts a server-initiated bearer termination with Diameter, a protocol used for network management and security. The diagram illustrates the process of terminating a bearer session, with the server initiating the termination and the client initiating the termination request. The figure also includes the Diameter protocol, which is used to establish and maintain the session, and the termination request, which is sent to the server to close the session. The figure is important for understanding the Diameter protocol and its role in network management and security.\nFigure 25d.3: Server-initiated Bearer Termination with Diameter\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "16a.4\tGi/Sgi Diameter messages",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes the Gi and the Sgi interface Diameter messages.\nThe relevant AVPs that are of use for the Gi/Sgi interface are detailed in this clause. Other Diameter NASREQ (IETF RFC 7155 [120]) AVPs, even if their AVP flag rules is marked with \"M\", are not required for being compliant with the current specification.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "16a.4.1\tAAR Command",
                            "text_content": "The AAR command, defined in Diameter NASREQ (IETF RFC 7155 [120]), is indicated by the Command-Code field set to 265 and the ‘R’ bit set in the Command Flags field. It may be sent by the GGSN to a Diameter server, during Primary PDP Context activation only, in order to request user authentication and authorization. In the case of P-GW, the AAR may be sent upon reception of an initial access request (e.g. Create Session Request or Proxy Binding Update) message for a given APN to request user authentication and authorization.\nThe relevant AVPs that are of use for the Gi/Sgi interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gi/Sgi purposes and should be ignored by the receiver or processed according to the relevant specifications.\nThe bold marked AVPs in the message format indicate optional AVPs for Gi/Sgi, or modified existing AVPs. For Sgi, some of the optional 3GPP vendor-specific AVPs listed in the message format below are not applicable. See table 9a in subclause 16a.5 to see the list of vendor-specific AVPs that are applicable to the GGSN and the P-GW.\nMessage Format:\n<AA-Request> ::= < Diameter Header: 265, REQ, PXY >\n< Session-Id >\n{ Auth-Application-Id }\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Auth-Request-Type }\n[ Destination-Host ]\n[ NAS-Port ]\n[ NAS-Port-Id ]\n[ NAS-Port-Type ]\n[ Origin-State-Id ]\n[ Port-Limit ]\n[ User-Name ]\n[ User-Password ]\n[ Service-Type ]\n[ Authorization-Lifetime ]\n[ Auth-Grace-Period ]\n[ Auth-Session-State ]\n[ Callback-Number ]\n[ Called-Station-Id ]\n[ Calling-Station-Id ]\n[ Originating-Line-Info ]\n[ Connect-Info ]\n[ CHAP-Auth ]\n[ CHAP-Challenge ]\n*\t[ Framed-Compression ]\n[ Framed-Interface-Id ]\n[ Framed-IP-Address ]\n*\t[ Framed-IPv6-Prefix ]\n*\t[ Delegated-IPv6-Prefix ]\n[ Framed-IP-Netmask ]\n[ Framed-MTU ]\n[ Framed-Protocol ]\n*\t[ Login-IP-Host ]\n*\t[ Login-IPv6-Host ]\n[ Login-LAT-Group ]\n[ Login-LAT-Node ]\n[ Login-LAT-Port ]\n[ Login-LAT-Service ]\n*\t[ Tunneling ]\n*\t[ Proxy-Info ]\n*\t[ Route-Record ]\n[ 3GPP-IMSI]\n[ External-Identifier]\n[ 3GPP-Charging-ID ]\n[ 3GPP-PDP-Type ]\n[ 3GPP-CG-Address ]\n[ 3GPP-GPRS-Negotiated-QoS-Profile ]\n[ 3GPP-SGSN-Address ]\n[ 3GPP-GGSN-Address ]\n[ 3GPP-IMSI-MCC-MNC ]\n[ 3GPP-GGSN-MCC-MNC ]\n[ 3GPP-NSAPI ]\n[ 3GPP-Selection-Mode ]\n[ 3GPP-Charging-Characteristics ]\n[ 3GPP-CG-IPv6-Address ]\n[ 3GPP-SGSN-IPv6-Address ]\n[ 3GPP-GGSN-IPv6-Address ]\n[ 3GPP-SGSN-MCC-MNC ]\n[ 3GPP-User-Location-Info ]\n[ 3GPP-RAT-Type ]\n[ 3GPP-CAMEL-Charging-Info ]\n[ 3GPP-Negotiated-DSCP ]\n[ 3GPP-Allocate-IP-Type ]\n[ TWAN-Identifier ]\n[ 3GPP-UE-Local-IP-Address ]\n[ 3GPP-UE-Source-Port ]\n*\t[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16a.4.2\tAAA Command",
                            "text_content": "The AAA command, defined in Diameter NASREQ (IETF RFC 7155 [120]), is indicated by the Command-Code field set to 265 and the ‘R’ bit cleared in the Command Flags field., It is sent by the Diameter server to the GGSN/P-GW in response to the AAR command.\nThe relevant AVPs that are of use for the Gi/Sgi interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gi/Sgi purposes and should be ignored by the receiver or processed according to the relevant specifications.\nThe \"Tunneling\" AVP may include the \"Tunnel-Type\" with value 3 to represent L2TP tunnel type, \"Tunnel-Medium-Type\" and \"Tunnel-Server-Endpoint\" AVPs. If more than one set of these \"Tunneling\" AVPs are provided, the optional \"Tunnel-Preference\" AVP may be provided in each set to identify the relative preference. The Tunnel-Password AVP may be used to authenticate to a remote server.\nNOTE:\tThe other optional AVPs within the \"Tunneling\" AVPs not listed in the above description, can be referred to the IETF RFC 7155 [120] with implementation specific.\nThe bold marked AVPs in the message format indicate optional AVPs for Gi/Sgi, or modified existing AVPs.\nMessage Format:\n<AA-Answer> ::= < Diameter Header: 265, PXY >\n< Session-Id >\n{ Auth-Application-Id }\n{ Auth-Request-Type }\n{ Result-Code }\n{ Origin-Host }\n{ Origin-Realm }\n[ User-Name ]\n[ Service-Type ]\n*\t[ Class ]\n[ Acct-Interim-Interval ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n[ Idle-Timeout ]\n[ Authorization-Lifetime ]\n[ Auth-Grace-Period ]\n[ Auth-Session-State ]\n[ Re-Auth-Request-Type ]\n[ Multi-Round-Time-Out ]\n[ Session-Timeout ]\n*\t[ Reply-Message ]\n[ Origin-State-Id ]\n*\t[ Filter-Id ]\n[ Port-Limit ]\n[ Prompt ]\n[ Callback-Id ]\n[ Callback-Number ]\n*\t[ Framed-Compression ]\n[ Framed-Interface-Id ]\n[ Framed-IP-Address ]\n*\t[ Framed-IPv6-Prefix ]\n[ Framed-IPv6-Pool ]\n*\t[ Framed-IPv6-Route ]\n*\t[ Delegated-IPv6-Prefix ]\n[ Framed-IP-Netmask ]\n*\t[ Framed-Route ]\n[ Framed-Pool ]\n[ Framed-IPX-Network ]\n[ Framed-MTU ]\n[ Framed-Protocol ]\n[ Framed-Routing ]\n*\t[ Login-IP-Host ]\n*\t[ Login-IPv6-Host ]\n[ Login-LAT-Group ]\n[ Login-LAT-Node ]\n[ Login-LAT-Port ]\n[ Login-LAT-Service ]\n[ Login-Service ]\n[ Login-TCP-Port ]\n*\t[ NAS-Filter-Rule ]\n*\t[ QoS-Filter-Rule ]\n*\t[ Tunneling ]\n*\t[ Redirect-Host ]\n[ Redirect-Host-Usage ]\n[ Redirect-Max-Cache-Time ]\n*\t[ Proxy-Info ]\n[ 3GPP-IPv6-DNS-Servers ]\n*\t[ External-Identifier]\n*\t[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16a.4.3\tACR Command",
                            "text_content": "The ACR command, defined in IETF RFC 6733 (Diameter Base) [111], is indicated by the Command-Code field set to 271 and the ‘R’ bit set in the Command Flags field. It is sent by the GGSN/P-GW to the Diameter server to report accounting information for a certain IP-CAN bearer (e.g. PDP context) or an IP-CAN session of a certain user.\nThe relevant AVPs that are of use for the Gi/Sgi interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gi/Sgi purposes and should be ignored by the receiver or processed according to the relevant specifications.\nThe bold marked AVPs in the message format indicate optional AVPs for Gi/Sgi, or modified existing AVPs. For Sgi, some of the optional 3GPP vendor-specific AVPs listed in the message format below are not applicable. See table 9a in subclause 16a.5 to see the ones that are applicable.\nMessage Format:\n<AC-Request> ::= < Diameter Header: 271, REQ, PXY >\n< Session-Id >\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Accounting-Record-Type }\n{ Accounting-Record-Number }\n[ Acct-Application-Id ]\n[ User-Name ]\n[ Origin-State-Id ]\n[ Destination-Host ]\n[ Event-Timestamp ]\n[ Acct-Delay-Time ]\n[ NAS-Identifier ]\n[ NAS-IP-Address ]\n[ NAS-IPv6-Address ]\n[ NAS-Port ]\n[ NAS-Port-Id ]\n[ NAS-Port-Type ]\n*\t[ Class ]\n[ Service-Type ]\n[ Accounting-Input-Octets ]\n[ Accounting-Input-Packets ]\n[ Accounting-Output-Octets ]\n[ Accounting-Output-Packets ]\n[ Acct-Authentic ]\n[ Accounting-Auth-Method ]\n[ Acct-Session-Time ]\n[ Acct-Tunnel-Connection ]\n[ Acct-Tunnel-Packets-Lost ]\n[ Callback-Id ]\n[ Callback-Number ]\n[ Called-Station-Id ]\n[ Calling-Station-Id ]\n*\t[ Connection-Info ]\n[ Originating-Line-Info ]\n[ Authorization-Lifetime ]\n[ Session-Timeout ]\n[ Idle-Timeout ]\n[ Port-Limit ]\n[ Accounting-Realtime-Required ]\n[ Acct-Interim-Interval ]\n*\t[ Filter-Id ]\n*\t[ NAS-Filter-Rule ]\n*\t[ Qos-Filter-Rule ]\n[ Framed-Compression ]\n[ Framed-Interface-Id ]\n[ Framed-IP-Address ]\n[ Framed-IP-Netmask ]\n*\t[ Framed-IPv6-Prefix ]\n[ Framed-IPv6-Pool ]\n*\t[ Framed-IPv6-Route ]\n*\t[ Delegated-IPv6-Prefix ]\n[ Framed-IPX-Network ]\n[ Framed-MTU ]\n[ Framed-Pool ]\n[ Framed-Protocol ]\n*\t[ Framed-Route ]\n[ Framed-Routing ]\n*\t[ Login-IP-Host ]\n*\t[ Login-IPv6-Host ]\n[ Login-LAT-Group ]\n[ Login-LAT-Node ]\n[ Login-LAT-Port ]\n[ Login-LAT-Service ]\n[ Login-Service ]\n[ Login-TCP-Port ]\n*\t[ Tunneling ]\n*\t[ Proxy-Info ]\n*\t[ Route-Record ]\n[ 3GPP-IMSI]\n[ External-Identifier]\n[ 3GPP-Charging-ID ]\n[ 3GPP-PDP-Type ]\n[ 3GPP-CG-Address ]\n[ 3GPP-GPRS-Negotiated-QoS-Profile ]\n[ 3GPP-SGSN-Address ]\n[ 3GPP-GGSN-Address ]\n[ 3GPP-IMSI-MCC-MNC ]\n[ 3GPP-GGSN-MCC-MNC ]\n[ 3GPP-NSAPI ]\n[ 3GPP-Selection-Mode ]\n[ 3GPP-Charging-Characteristics ]\n[ 3GPP-CG-IPv6-Address ]\n[ 3GPP-SGSN-IPv6-Address ]\n[ 3GPP-GGSN-IPv6-Address ]\n[ 3GPP-SGSN-MCC-MNC ]\n[ 3GPP-IMEISV ]\n[ 3GPP-RAT-Type ]\n[ 3GPP-User-Location-Info ]\n[ 3GPP-MS-Time-Zone ]\n[ 3GPP-CAMEL-Charging-Info ]\n[ 3GPP-Packet-Filter ]\n[ 3GPP-Negotiated-DSCP ]\n[ TWAN-Identifier ]\n[ 3GPP-User-Location-Info-Time ]\n*\t[ 3GPP-Secondary-RAT-Usage ]\n[ 3GPP-UE-Local-IP-Address ]\n[ 3GPP-UE-Source-Port ]\n*\t[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16a.4.4\tACA Command",
                            "text_content": "The ACA command, defined in Diameter Base (IETF RFC 6733 [111]), is indicated by the Command-Code field set to 271 and the ‘R’ bit cleared in the Command Flags field., It is sent by the Diameter server to the GGSN/P-GW in response to the ACR command.\nThe relevant AVPs that are of use for the Gi/Sgi interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gi/Sgi purposes and should be ignored by the receiver or processed according to the relevant specifications.\nMessage Format:\n<AC-Answer> ::= < Diameter Header: 271, PXY >\n< Session-Id >\n{ Result-Code }\n{ Origin-Host }\n{ Origin-Realm }\n{ Accounting-Record-Type }\n{ Accounting-Record-Number }\n[ Acct-Application-Id ]\n[ User-Name ]\n[ Event-Timestamp ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n[ Origin-State-Id ]\n[ NAS-Identifier ]\n[ NAS-IP-Address ]\n[ NAS-IPv6-Address ]\n[ NAS-Port ]\n[ NAS-Port-Id ]\n[ NAS-Port-Type ]\n[ Service-Type ]\n[ Accounting-Realtime-Required ]\n[ Acct-Interim-Interval ]\n*\t[ Class ]\n*\t[ Proxy-Info ]\n*\t[ Route-Record ]\n*\t[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16a.4.5\tSTR Command",
                            "text_content": "The STR command, defined in IETF RFC 6733 (Diameter Base) [111], is indicated by the Command-Code field set to 275 and the ‘R’ bit set in the Command Flags field. It is sent by the GGSN/P-GW to the Diameter server to terminate a DIAMETER session corresponding to an IP-CAN session of a certain user.\nThe relevant AVPs that are of use for the Gi/Sgi interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gi/Sgi purposes and should be ignored by the receiver or processed according to the relevant specifications.\nMessage Format:\n<ST-Request> ::= < Diameter Header: 275, REQ, PXY >\n< Session-Id >\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Auth-Application-Id }\n{ Termination-Cause }\n[ User-Name ]\n[ Destination-Host ]\n*\t[ Class ]\n[ Origin-State-Id ]\n*\t[ Proxy-Info ]\n*\t[ Route-Record ]\n*\t[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16a.4.6\tSTA Command",
                            "text_content": "The STA command, defined in IETF RFC 6733 (Diameter Base) [111], is indicated by the Command-Code field set to 275 and the ‘R’ bit cleared in the Command Flags field. It is sent by the Diameter server to the GGSN/P-GW in response to an STR command.\nThe relevant AVPs that are of use for the Gi/Sgi interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gi/Sgi purposes and should be ignored by the receiver or processed according to the relevant specifications.\nMessage Format:\n<ST-Answer>  ::= < Diameter Header: 275, PXY >\n< Session-Id >\n{ Result-Code }\n{ Origin-Host }\n{ Origin-Realm }\n[ User-Name ]\n*\t[ Class ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n[ Origin-State-Id ]\n*\t[ Redirect-Host ]\n[ Redirect-Host-Usage ]\n[ Redirect-Max-Cache-Time ]\n*\t[ Proxy-Info ]\n*\t[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16a.4.7\tASR Command",
                            "text_content": "The Abort-Session-Request (ASR) command, defined in IETF RFC 6733 (Diameter Base) [111], is indicated by the Command-Code set to 274 and the message flags’ ‘R’ bit set, is sent by the Diameter server to the GGSN to request that the PDP Context identified by the 3GPP-NSAPI AVP is to be terminated. The absence of the 3GPP-NSAPI AVP will indicate to the GGSN that all the PDP contexts for this particular user and sharing the same user session need to be deleted.  Similarly, for P-GW, the ASR command is sent by the Diamater server to the P-GW to request that the EPS bearer identified by the 3GPP-NSAPI AVP is to be terminated. In the absence of the 3GPP-NSAPI AVP or if the value of 3GPP-NSAPI AVP points to the default EPS bearer, the P-GW shall terminate the IP-CAN session associated with the same user session.\nThe relevant AVPs that are of use for the Gi/Sgi interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gi/Sgi purposes and should be ignored by the receiver or processed according to the relevant specifications.\nThe bold marked AVPs in the message format indicate optional AVPs for Gi/Sgi, or modified existing AVPs.\nMessage Format:\n<ASR>  ::= < Diameter Header: 274, REQ, PXY >\n< Session-Id >\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Destination-Host }\n{ Auth-Application-Id }\n[ Origin-State-Id ]\n*\t[ Proxy-Info ]\n[ 3GPP-NSAPI ]\n*\t[ Route-Record ]\n*\t[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "16a.4.8\tASA Command",
                            "text_content": "The Abort-Session-Answer (ASA) command, defined in IETF RFC 6733 (Diameter Base) [111], is indicated by the Command-Code set to 274 and the message flags’ ‘R’ bit clear, is sent in response to the ASR.\nThe relevant AVPs that are of use for the Gi/Sgi interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gi/Sgi purposes and should be ignored by the receiver or processed according to the relevant specifications.\nThe bold marked AVPs in the message format indicate optional AVPs for Gi/Sgi or modified existing AVPs.\nMessage Format:\n<ASA>  ::= < Diameter Header: 274, PXY >\n< Session-Id >\n{ Result-Code }\n{ Origin-Host }\n{ Origin-Realm }\n[ User-Name ]\n[ Origin-State-Id ]\n[ Experimental-Result ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n*\t[ Redirected-Host ]\n[ Redirected-Host-Usage ]\n[ Redirect-Max-Cache-Time ]\n*\t[ Proxy-Info ]\n*\t[ AVP ]\n\nThe Experimental-Result AVP contains an Experimental-Result-Code AVP and will signal to the Diameter server that the IP-CAN bearer (e.g. PDP context) has been succesfully terminated as requested. See subclause 16a.6 for the description of the Experimental-Result-Code AVP.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "16a.5\tGi/Sgi specific AVPs",
                    "description": "",
                    "summary": "",
                    "text_content": "The following table lists the Gi/Sgi specific Diameter AVPs. The Vendor-Id header of all Gi/Sgi specific AVPs defined in the present specification shall be set to 3GPP (10415).\nTable 9a: Gi/Sgi specific AVPs\n\nThe information represented by some of the Sgi AVPs may not be available to the P-GW depending on the UE’s radio access and the S5/S8 protocol type (GTP or PMIP). For example, the P-GW will be aware of the User Location Info (e.g. TAI) if the user is in LTE access and GTP based S5/S8 is used. However, such information is not passed to the P-GW when PMIP based S5/S8 is utilised. In such scenarios, if an Sgi specific AVP is configured in the P-GW to be transferred to the Diameter AAA server, but the information in the P-GW is not up to date or not available; the P-GW shall not send the corresponding AVP, unless otherwise stated in the AVP definitions in subclause 16.4.7.2.\n",
                    "tables": [
                        {
                            "description": "Table 9a: Gi/Sgi specific AVPs",
                            "table number": 52,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "16a.6\tGi/Sgi specific Experimental-Result-Code AVP",
                    "description": "",
                    "summary": "",
                    "text_content": "Diameter Base IETF RFC 6733 [111] defines a number of Result-Code AVP values that are used to report protocol errors and how those are used. Those procedures and values apply for the present specification.\nDue to the Gi/Sgi specific AVPs, new application results can occur and the Experimental-Result AVP is used to transfer the 3GPP-specific result codes. The Experimental-Result AVP is a grouped AVP containing the Vendor-Id AVP set to the value of 3GPP’s vendor identifier (10415) and an Experimental-Result-Code AVP.\nThe following Gi/Sgi specific Experimental-Result-Code value is defined:\nDIAMETER_PDP_CONTEXT_DELETION_INDICATION (2021)\nFor GGSN this is an indication to the server that the requested PDP Context or IP-CAN session has been deleted.\nFor P-GW this is an indication to the server that the requested bearer or IP-CAN session has been deleted.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "16a.7\tGi/Sgi re-used AVPs",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 9b lists the Diameter AVPs re-used by the Gi/Sgi reference point from existing Diameter Applications, reference to the respective specifications and a short description of the usage within the Gi/Sgi reference point.\nTable 9b: Gi/Sgi re-used Diameter AVPs\n\n",
                    "tables": [
                        {
                            "description": "Table 9b: Gi/Sgi re-used Diameter AVPs",
                            "table number": 53,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "17\tUsage of Diameter on Gmb interface",
            "description": "Signalling between GGSN and BM-SC is exchanged at Gmb reference point. BM-SC functions for different MBMS bearer services may be provided by different physical network elements. To allow this distribution of BM-SC functions, the Gmb protocol must support the use of proxies to correctly route the different signalling interactions in a manner which is transparent to the GGSN.\nThe GGSN uses the Gmb interface\n-\tto request authorisation/deactivation of a user for a multicast MBMS service,\n-\tto register/de-register the GGSN for receiving a multicast MBMS service.\n-\tto receive indication of session start, session update and session stop messages, which shall cause the GGSN, SGSN and RAN to set up/tear down the appropriate resources for the service. For further details, see 3GPP TS 23.246 [65].\n-\tto receive indication if IP multicast distribution to UTRAN should be used for the MBMS user plane data.\nThe support of Gmb within the GGSN is optional, and needed for MBMS.\nThe Gmb application is defined as an IETF vendor specific Diameter application, where the vendor is 3GPP. The vendor identifier assigned by IANA to 3GPP (http://www.iana.org/assignments/enterprise-numbers) is 10415. The Gmb application identifier value assigned by IANA is 16777223.\nThe Gmb application identifier value shall be included in the Auth-Application-Id AVP.\nThe BM-SC and the GGSN shall advertise the support of the Gmb application by including the value of the application identifier in the Auth-Application-Id AVP and the value of the 3GPP (10415) in the Vendor-Id AVP of the Capabilities-Exchange-Request and Capabilities-Exchange-Answer commands as specified in IETF RFC 6733 [111], i.e. as part of the Vendor-Specific-Application-Id AVP. The Capabilities-Exchange-Request and Capabilities-Exchange-Answer commands are specified in the Diameter Base Protocol.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "17.1\tMBMS user authorisation",
                    "description": "",
                    "summary": "",
                    "text_content": "Upon reception of an IGMP (IPv4) or MLD (IPv6) Join message for an IP multicast address allocated to MBMS services, the GGSN shall request authorisation of the user for this multicast MBMS bearer service (identified by the PDP context over which the IGMP join is received).\nThe GGSN shall support pre-configuration of a BM-SC or Gmb proxy server for authorisation purposes to which the request shall be sent. The GGSN may support a list of pre-configured BM-SC servers based on the MBMS bearer service requested, for authorisation purposes.\nUpon receipt of an MBMS UE Context Establishment Request for a user who has not already been authorised for the MBMS bearer service, the GGSN shall request authorisation of the user for this service.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "17.2\tMBMS service registration / de-registration",
                    "description": "",
                    "summary": "",
                    "text_content": "The MBMS service registration of the GGSN at the BM-SC shall be performed after authorisation of the first user on a particular GGSN, for a particular multicast MBMS Bearer service. The MBMS service de-registration of the GGSN shall be performed when the last user leaves a particular GGSN, for a particular multicast MBMS bearer service.\nThe MBMS de-registration procedure shall be initiated by BM-SC when the specific multicast MBMS service is terminated.\nThe GGSN shall support pre-configuration of a BM-SC or Gmb proxy server for registration/de-registration purposes. The GGSN may support a list of pre-configured BM-SC servers based on the MBMS bearer service requested for bearer registration purposes.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "17.3\tMBMS session start / update/ stop",
                    "description": "",
                    "summary": "",
                    "text_content": "The MBMS session start shall be used by the BM-SC to trigger the bearer resource establishment and announce the arrival of data for a MBMS bearer service (along with the attributes of the data to be delivered e.g. QoS or MBMS service area) to every GGSN that will deliver the MBMS bearer service. The MBMS session start shall also be used by the BM-SC to indicate to GGSN if IP multicast mechanism should be used for user plane data distribution to UTRAN.\nThe MBMS session update shall be used by the BM-SC to trigger the update of MBMS session attributes in the affected GGSNs.\nThe MBMS session stop shall be used by the BM-SC to indicate the end of the data stream for an MBMS bearer service to every GGSN that has been delivering the MBMS bearer service.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "17.4\tMBMS user deactivation",
                    "description": "",
                    "summary": "",
                    "text_content": "The MBMS user deactivation is a procedure that removes the MBMS UE context from the GGSN for a particular multicast MBMS bearer service (also called \"leaving procedure\"). This procedure can be initiated by the GGSN or the BM-SC over the Gmb interface.\nWhen the last user leaves a particular GGSN, for a particular MBMS multicast service, a de-registration process shall be initiated.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "17.5\tMessage flows",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "17.5.1\tService activation",
                            "text_content": "The multicast MBMS bearer service activation procedure registers the user in the network to enable the reception of data from a specific multicast MBMS bearer service\nThe figure depicts the activation of an MBMS multicast service, illustrating the process of sending multicast messages to multiple recipients. MBMS stands for Multicast Broadcast Multicast Service, which is a type of multicast service that allows for the transmission of data to multiple recipients simultaneously. The figure shows the activation of the multicast service, with the sender initiating the transmission and the receiver receiving the message. The MBMS service is used in various applications, such as video streaming, file sharing, and network management, to improve network efficiency and reliability.\nFigure 26; Activation of an MBMS multicast service\n1.\tThe GGSN receives an IGMP (IPv4) or MLD (IPv6) Join message from a UE, over the default PDP context to signal its interest in receiving a particular multicast MBMS bearer service identified by an IP multicast address.\n2.\tThe GGSN sends an AAR seeking authorization for the activating UE to receive data from a particular service.\n3.\tThe authorization decision is provided in the AAA together with the APN to be used for creation of the MBMS UE context. If the AAA indicates that the UE is not authorized to receive the MBMS data the process terminates with no additional message exchange.\n4.\tThe GGSN sends an MBMS Notification Request (IP multicast address, APN, Linked NSAPI) to the SGSN. Linked NSAPI is set equal to the NSAPI of the PDP context over which the Join request was received. The IP multicast address is the one requested by the UE in the Join request. The APN may be different from the APN to which the default PDP context has been activated. In any case, the APN may resolve to a GGSN that is different from the GGSN receiving the IGMP/MLD Join request. The GGSN starts a MBMS Activation Timer as GGSN may receive no response, e.g. in case SGSN or UE does not support MBMS.\n5.\tThe SGSN sends a MBMS Notification Response (Cause) to the GGSN that sent the MBMS Notification Request, where Cause shall indicate successful or unsuccessful MBMS context activation for the reason of SGSN or UE . Upon reception of the response message with Cause indicating unsuccessful operation or time-out of the MBMS Activation Timer in the GGSN, the GGSN may fallback to IP multicast access as defined in clause 11.7.\n6.\tThe SGSN creates an MBMS UE context and sends a Create MBMS Context Requests (IP multicast address, APN, RAI) to the GGSN. That GGSN may be different from the GGSN receiving the IGMP/MLD Join request.\n7.\tThe GGSN sends an AAR seeking authorization for the activating UE.\n8.\tThe authorization decision is provided in the AAA\n9.\tIf the GGSN does not have the MBMS Bearer Context information for this MBMS bearer service, i.e. the GGSN was not yet registered, the GGSN sends a AAR to the BM-SC. See subclause 17.5.4 \"Registration Procedure\".\nIf no TMGI has been allocated for this MBMS bearer service, the BM-SC will allocate a new TMGI. This TMGI will be passed to GGSN via the AAA message.\n10.\tThe BM-SC responds with a AAA containing the MBMS Bearer Context information for this MBMS bearer service and adds the identifier of the GGSN to the \"list of downstream nodes\" parameter in its MBMS Bearer Context. See subclause 17.5.4 \"Registration Procedure\".\n11.\tThe GGSN creates an MBMS UE context and sends a Create MBMS Context Response to the SGSN\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.5.2\tSession start procedure",
                            "text_content": "The BM-SC initiates the MBMS session start procedure when it is ready to send data. This informs the GGSN of the imminent start of the transmission and MBMS session attributes are provided to the GGSNs included in the list of downstream nodes in BM-SC. For a multicast MBMS service these are the GGSNs that have previously registered for the corresponding MBMS bearer service. The bearer plane is allocated.\nBM-SC and GGSN shall at least support IP unicast encapsulation of IP multicast datagrams, which shall be default mode of sending user plane data. BM-SC may support sending user plane IP multicast datagrams to GGSN, and GGSN also may support this mode of operation.\nThe MBMS (Multi-Band Multiservice Mission) session starts procedure in Figure 27 illustrates the steps taken by the MBMS system to initiate a session with a satellite. The figure shows the various components involved in the MBMS process, including the satellite, ground station, and the MBMS system itself. The MBMS system uses a combination of satellite and ground station signals to provide a reliable and efficient communication service.\nFigure 27: MBMS Session Start procedure\n1.\tThe BM-SC sends a RAR message to indicate the impending start of the transmission and to provide the session attributes to the GGSNs listed in the \"list of downstream nodes\" parameter of the corresponding MBMS Bearer Context. BM-SC may indicate to GGSN that BM-SC supports sending the user plane IP multicast data without IP unicast encapsulation. In such case BM-SC shall send multicast source address as specified by IETF RFC 4604 [73] and IETF RFC 4607 [74]. The BM-SC sets the state attribute of its MBMS Bearer Context to ‘Active’. By sending \"CN IP Multicast Distribution\" parameter to GGSN, the BM-SC indicates if IP multicast mechanism should be used for user plane data distribution to UTRAN. \"MBMS HC Indicator\" parameter, if present, indicates that a header compression is used for MBMS user plane data.\n2.\tFor a broadcast MBMS bearer service the GGSN creates an MBMS Bearer Context. The GGSN stores the session attributes in the MBMS Bearer Context, sets the state attribute of its MBMS Bearer Context to ‘Active’ and sends a RAA message to the BM-SC. In case GGSN receives BM-SC multicast source address, which indicates BM-SC support for both modes of sending user plane data, GGSN decides in which mode GGSN shall receive the user plane data. In case GGSN decides to receive unicast encapsulated data, then GGSN shall send own IP address and UDP port for the encapsulating unicast IP and UDP layer of the user plane to BM-SC. In case GGSN decides to receive IP multicast packets, then GGSN shall join the multicast group as specified by IETF RFC 4604 [73] and IETF RFC 4607 [74], and indicate to BM-SC about the decision.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.5.3\tSession stop procedure",
                            "text_content": "The BM-SC initiates the MBMS session stop procedure when it considers the MBMS session terminated. Typically this will happen when there is no more MBMS data expected to be transmitted for a sufficiently long period of time to justify the release of bearer plane resources in the network.\nThe MBMS (Multi-Band Multiservice Mission) session stop procedure is depicted in Figure 28, illustrating the steps taken to terminate a MBMS session. The figure shows the MBMS interface, the MBMS session, and the termination process. The MBMS interface is shown with the MBMS protocol, while the MBMS session is highlighted with its status and the termination process is depicted with the MBMS session stop procedure. The MBMS session stop procedure is a crucial step in MBMS operations, ensuring the proper termination of the session and preventing any potential disruptions.\nFigure 28: MBMS Session Stop procedure\n1.\tThe BM-SC sends a RAR message to all GGSNs listed in the \"list of downstream nodes\" parameter of the affected MBMS Bearer Context to indicate that the MBMS session is terminated and the bearer plane resources can be released.\n2.\tThe GGSN sets the state attribute of its MBMS Bearer Context to ‘Standby’ and sends a RAA message to the BM-SC. An AAR message is not mandated for the Gmb application in response to a RAR- RAA command exchange.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.5.4\tRegistration procedure",
                            "text_content": "The registration procedure occurs when the GGSN indicates the BM-SC that it would like to receive session attributes and data for a particular multicast MBMS bearer service, in order to be distributed further downstream. A corresponding MBMS Bearer Context is established as a result between the GGSN and the BM-SC.\nThe MBMS (Mobile Broadband Massive MIMO) registration procedure is depicted in Figure 29, illustrating the steps involved in verifying and validating the registration of a mobile broadband Massive MIMO system. The figure shows a flowchart with various stages, including the initial setup, data transmission, and verification of the registration process. The MBMS registration procedure is crucial for ensuring the proper functioning of the system and ensuring the quality of service for mobile users.\nFigure 29: MBMS Registration procedure\n1.\tWhen the GGSN has no MBMS Bearer Context for an MBMS bearer service and the GGSN receives an MBMS Registration from an SGSN for this MBMS bearer service, or when the first MBMS UE Context is created in the GGSN for an MBMS bearer service for which the GGSN has no MBMS Bearer Context, the GGSN sends a AAR message (containing the IP multicast address and the APN) to the BM-SC.\n2.\tUpon reception of an AAR from a GGSN, the BM-SC adds the identifier of the GGSN to the \"list of downstream nodes\" parameter in its MBMS Bearer Context and responds with an AAA message (containing TMGI, and Required Bearer Capabilities). If the MBMS Bearer Context is in the ‘Active’ state, the BM-SC initiates the Session Start procedure with the GGSN, as described in clause 17.5.2 \"Session Start Procedure\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.5.5\tDe-registration procedure (GGSN initiated)",
                            "text_content": "The MBMS de-registration is the procedure by which the GGSN informs the BM-SC that it does not need to receive signalling, session attributes and data for a particular multicast MBMS bearer service anymore and therefore would like to be removed from the corresponding distribution tree.\nThe MBMS (Multi-Band Multi-Spectral) de-registration procedure is a crucial step in the de-registration process of a Multi-Band Multi-Spectral (MBMS) system. This procedure involves the de-registration of the MBMS signal from the receiver to the base station (BS) and vice versa. The de-registration process is essential for ensuring the integrity of the MBMS signal and maintaining the quality of the communication. The de-registration procedure is typically performed using a de-registration algorithm that takes into account the characteristics of the MBMS signal, such as its frequency, bandwidth, and power levels. The output of the de-registration procedure is a de-registered MBMS signal that is ready for transmission to the BS.\nFigure 30: MBMS De-Registration procedure\n1.\tWhen the \"list of downstream nodes\" of a particular MBMS Bearer Context in the GGSN becomes empty and the GGSN has no MBMS UE Contexts linked to that MBMS Bearer Context, the GGSN sends a STR message to the BM-SC. If a bearer plane had been established over Gi for this MBMS bearer service, the bearer plane is released.\n2.\tThe BM-SC removes the identifier of the GGSN from the \"list of downstream nodes\" parameter of the affected MBMS Bearer Context and confirms the operation by sending a STA message to the GGSN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.5.6\tDe-registration procedure (BM-SC initiated)",
                            "text_content": "This MBMS de-registration procedure is initiated by BM-SC when the specific multicast MBMS bearer service is terminated. This procedure tears down the distribution tree for the delivery of session attributes and MBMS data. This procedure results in releasing of all MBMS Bearer Contexts.\nThe MBMS (Multi-Band Multi-Spectral) de-registration procedure in Figure 31 involves the initiation of a BM-SC (Beamforming-based Scattering Channel) de-registration process. This procedure is crucial for ensuring the accuracy and reliability of the de-registration process, as it involves the use of beamforming techniques to mitigate interference and improve the overall performance of the system.\nFigure 31: MBMS De-Registration procedure BM-SC initiated\n1.\tThe BM-SC sends a ASR message to all GGSNs contained in the \"list of downstream nodes\" parameter of the corresponding MBMS Bearer Context to indicate that a specific MBMS bearer service is terminated.\n2.\tThe GGSN returns a ASA message to the BM-SC. The BM-SC releases all MBMS UE Contexts and removes the identifier of the GGSN from the \"list of downstream nodes\" parameter of the corresponding MBMS Bearer context.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.5.7\tService deactivation",
                            "text_content": "The multicast service deactivation is a signalling procedure that will terminate the user registration to a particular MBMS multicast service. The multicast service deactivation can be initiated by the GGSN, when indicated so by the UE, or by the BM-SC, for service specific reasons.\nThe MBMS Service deactivation procedure is depicted in Figure 32, illustrating the steps taken to terminate the MBMS service. The figure shows the user interface, the MBMS service, and the deactivation process, with a clear and concise layout that simplifies the process for users.\nFigure 32: MBMS Service deactivation procedure\n1.\tThe UE sends an IGMP (IPv4) or MLD (IPv6) Leave message over the default PDP context to leave a particular multicast service identified by an IP multicast address.\n2.\tThe GGSN sends a STR to the BM-SC, indicating that the UE is requesting to leave the multicast service. The session to be terminated is uniquely identified by the Diameter session-id.\n3.\tUpon reception of the STR, the BM-SC verifies that the IP multicast address corresponds to a valid MBMS bearer service and sends a STA to the GGSN that originated the Leave Indication. The APN shall be the same that was provided during service activation (see \" Service Activation\" procedure).\n4.\tUpon reception of the STA the GGSN sends an MBMS UE Context Deactivation Request to the SGSN. The IP multicast address, APN and IMSI together identify the MBMS UE Context to be deleted by the SGSN. The APN is the one received in step 3.\n5.\tThe GGSN receives a Delete MBMS Context Request (NSAPI). This GGSN may be different from the GGSN that receives IGMP Leave request in step 1.\n6.\tThe GGSN deletes the MBMS UE Context and sends a STR to the BM-SC to confirm the successful deactivation of the MBMS UE Context.\n7.  The BM-SC, then, deletes the MBMS UE Context and sends a confirmation to the GGSN in a STA message.\n8.\tIf the GGSN does not have any more users interested in this MBMS bearer service and the \"list of downstream nodes\" in the corresponding MBSM Bearer Context is empty, the GGSN initiates a De-Registration procedure as specified in 17.5.5.\n9.\tThe BM-SC confirms the operation by sending a STA message to the GGSN as specified in 17.5.5.\nThis section defines the BM-SC initiated Multicast Service Deactivation procedure.\nThe figure depicts a step-by-step process for deactivating a bidirectional modulation service (BMS) in a 2G/3G/4G network. The process involves initiating a bidirectional modulation service (BMS) deactivation procedure, which is initiated by the base station (BTS) and the mobile station (MS). The figure illustrates the steps involved in the deactivation procedure, including the initiation of the procedure, the transmission of the deactivation message, and the response from the MS. The figure also shows the status of the BMS, indicating whether it is active or deactivated.\nFigure 32a: BM-SC initiated MBMS Service deactivation procedure\n1.\tThe BM-SC sends an ASR to the GGSN, indicating that the UE shall be removed from the multicast service. The session to be terminated is uniquely identified by the Diameter session-id.\n2.\tUpon reception of the ASR, the GGSN sends an ASA to the BM-SC\n3.\tUpon reception of the ASR the GGSN sends an MBMS UE Context Deactivation Request to the SGSN. The IP multicast address, APN and IMSI together identify the MBMS UE Context to be deleted by the SGSN.\nSteps from 5 to 9 of figure 32 in section 17.5.7 follow.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.5.8\tTrace Session Activation procedure",
                            "text_content": "The Trace Session Activation procedure occurs when the GGSN indicates to the BM-SC that a Trace Session needs to be activated.\nThe figure depicts the process of session activation in a 5G network, illustrating the steps involved in initiating a session between a base station (gNB) and a user equipment (UE). The figure shows the various components involved, such as the gNB, UE, and scatterers, highlighting the importance of beamforming techniques to mitigate interference.\nFigure 33: Trace Session Activation procedure\n1.\tWhen the GGSN has received a Trace Activation message from the SGSN, in a Create MBMS Context Request/Update MBMS Context Request, that requires the activation of a Trace Session in the BM-SC, the GGSN sends an AAR message (containing the IMSI and the Additional MBMS Trace Info AVPs) to activate a trace session in the BM-SC.\n2.\tUpon reception of an AAR from a GGSN to activate a Trace Session, the BM-SC responds with an AAA message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.5.9\tTrace Session Deactivation procedure",
                            "text_content": "The Trace Session Deactivation procedure occurs when the GGSN indicates to the BM-SC that a Trace Session, previously activated, needs to be deactivated.\nFigure 34 illustrates the trace session deactivation procedure in a 5G network, demonstrating how sessions are terminated when they exceed a certain threshold. This process is crucial for maintaining network reliability and efficiency.\nFigure 34: Trace Session Deactivation procedure\n1.\tWhen the GGSN has received a Trace Deactivation message from the SGSN, in a Create MBMS Context Request/Update MBMS Context Request, that requires the deactivation of a Trace Session in the BM-SC, the GGSN sends a STR message (containing the Additional MBMS Trace Info AVP) to deactivate a trace session in the BM-SC and to tear down the corresponding Diameter Session previously established to activate the Trace Session.\n2.\tUpon reception of an STR from a GGSN to deactivate a Trace Session, the BM-SC responds with an STA message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.5.10\tMBMS UE Context Modification Procedure",
                            "text_content": "During the multicast MBMS bearer service activation, the MBMS UE Context is stored in the BM-SC. Later, the MBMS UE Context shall be updated when the UE enters a new Routeing Area (RA) served by a new SGSN or the UE is transitioning between UTRAN and A/Gb mode GERAN or vice versa (Inter-system Intra-SGSN change). See 3GPP TS 23.246 [65] and 3GPP TS 29.060 [24]. GGSN shall pass the relevant data via the Gmb interface to enable the BM-SC to update its MBMS UE context accordingly.\nThe figure depicts a modified MBMS UE context in a BM-SC network, illustrating the changes made to enhance signal quality and reduce interference. The modified UE includes a new antenna configuration, a more efficient power amplifier, and a more robust beamforming technique to improve signal reception. The figure also highlights the importance of proper network design and configuration to ensure optimal performance and reliability.\nFigure 35; Modification of an MBMS UE Context in BM-SC\n1,\tOn request from SGSN, the MBMS UE Context is updated in the GGSN.\n2.\tThe GGSN sends updated MBMS UE Context parameters (RAI, and CGI/SAI as specified in clause 17.6.1) to BM-SC in an AAR message.\n3.\tThe BM-SC updates its MBMS UE Context fields and  responds with an AAA message.\nIf the GGSN receives new or updated trace information in step 1, then the above procedure may be followed by a Trace Session Activation procedure (see clause 17.5.8) or a Trace Session Deactivation procedure (see clause 17.5.9).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.5.11\tSession Update Procedure",
                            "text_content": "The BM-SC initiates the MBMS session update procedure when the service area for an ongoing MBMS session shall be modified. This procedure is defined only for MBMS broadcast services. The MBMS session update procedure is initiated towards one or more of the GGSNs in the list of downstream nodes in the BM-SC, according to the changes in the service area.\nNOTE:\tIn addition, when the MBMS Service Area for an ongoing broadcast session is changed in the BM-SC, then GGSN(s) may be added to, or removed from, the list of downstream nodes in the BM-SC. The BM-SC will initiate MBMS session start procedures or MBMS session stop procedures towards these GGSNs accordingly.\nThe attributes that can be modified by the session update procedure are the MBMS Service Area, and the list of downstream nodes for GGSN.\nWhen a session update message is received, GGSN will update its MBMS Bearer Context accordingly and inform its downstream SGSNs of the changed MBMS service area. If a list of downstream SGSNs is included in the session update message, GGSN shall initiate a session start procedure towards the new downstream SGSNs, and a session stop procedure towards the SGSNs that have been removed from the list.\nThe MBMS (Multi-Band Multi-Service) session update procedure in Figure 27a illustrates the steps taken to update the session information in a multi-service network. The figure shows the flow of data between the MBMS server and the network, highlighting the importance of efficient data transmission and management.\nFigure 27a: MBMS Session Update procedure\n1.\tThe BM-SC sends a RAR message to the GGSNs that need to update its session attributes.\n2.\tGGSN stores the updated session attributes in the MBMS Bearer Context, initiates session start, session stop or session update procedures towards the SGSNs in its list of downstream nodes and sends an RAA message to the BM-SC. An AAR message is not mandated for the Gmb application in response to a RAR-RAA command exchange.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.5.12\tMBMS broadcast session termination (GGSN initiated)",
                            "text_content": "The figure depicts a broadcast session termination scenario in a 5G network, illustrating the various components involved in the process. The diagram shows the base station (gNB), user equipment (UE), and scatterers, highlighting the importance of beamforming techniques to mitigate interference.\nFigure 36: Broadcast session termination\n1.\tIn exceptional cases (e.g. resource pre-emption or timeout of the MBMS session), the GGSN may send an STR command to the BM-SC to initiate the termination of the Diameter session related to a broadcast MBMS bearer service. If a bearer plane had been established over Gi for this MBMS bearer service, the bearer plane is released.\n2.\tThe BM-SC removes the Diameter session and confirms the operation by sending an STA message to the GGSN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "17.6\tGmb Messages",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause defines the Gmb interface Diameter messages.\nThe relevant AVPs that are of use for the Gmb interface are detailed in this clause. Other Diameter NASREQ (IETF RFC 7155 [120]) AVPs, even if their AVP flag rules is marked with \"M\", are not required for being compliant with the current specification.\nAll Gmb specific AVPs for Gmb are needed to be compliant to the Gmb interface unless otherwise stated.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "17.6.1\tAAR Command",
                            "text_content": "The AAR command, defined in Diameter NASREQ (IETF RFC 7155 [120]), is indicated by the Command-Code field set to 265 and the ‘R’ bit set in the Command Flags field. It, is sent by the GGSN to the BM-SC to request user authorization (authorize the activating UE to receive Data) , to modify an MBMS UE Context in the BM-SC or to register the GGSN for a particular multicast MBMS bearer service. When used for these purposes, the Additional-MBMS-Trace-Info AVP shall not be included.\nWhen the AAR command is used by the GGSN to modify an MBMS UE context in the BM-SC, it shall include all the parameters that have been changed according to the triggering Update MBMS Context Request, ref. fig. 35. The inclusion of CGI/SAI in the 3GPP-User-Location-Info AVP shall be according to the rules detailed in subclause 15.1.1a in 3GPP TS 23.060 [3]). The Called-Station-Id AVP, Calling-Station-Id AVP, Framed-IP-Address AVP, Framed-IPv6-Prefix AVP and Framed-Interface-Id AVP shall not be included,\nThe AAR command is also used when the GGSN needs to activate a Trace Session in the BM-SC. In this case the Called-Station-Id AVP, Calling-Station-Id AVP, Framed-IP-Address AVP, Framed-IPv6-Prefix AVP, Framed-Interface-Id AVP, and RAI AVP shall not be included. For more detailed description of Trace Session activation/deactivation procedures see 3GPP TS 32.422 [69].\nThe relevant AVPs that are of use for the Gmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nThe bold marked AVPs in the message format indicate new optional AVPs for Gmb, or modified existing AVPs.\nMessage Format:\n<AA-Request> ::= < Diameter Header: 265, REQ, PXY >\n< Session-Id >\n{ Auth-Application-Id }\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Auth-Request-Type }\n[ Destination-Host ]\n[ Called-Station-Id ]\n[ Calling-Station-Id ]\n[ Framed-IP-Address]\n[ Framed-IPv6-Prefix ]\n[ Framed-Interface-Id ]\n*\t[ Proxy-Info ]\n*\t[ Route-Record ]\n[ 3GPP-IMSI]\n[ RAI ]\n[ 3GPP-IMEISV ]\n[ 3GPP-RAT-Type ]\n[ 3GPP-User-Location-Info ]\n[ 3GPP-MS-TimeZone ]\n[ Additional-MBMS-Trace-Info ]\n\nThe GGSN shall allocate a new Session-Id each time an AAR command is sent, except for the case when the AAR is sent to modify an existing MBMS UE Context in the BM-SC.\nA request for user authorisation for an MBMS bearer service is indicated by the presence of the MSISDN within the Calling-Station-Id AVP and the 3GPP-IMSI. Otherwise the request is for the GGSN to be authorised (i.e. registered) to receive the MBMS bearer service.The Framed-IPv6-Prefix AVP contains the IPv6 prefix of the multicast address identifying the MBMS bearer service.\nThe Framed-Interface-Id AVP contains the IPv6 interface identifier of the multicast address identifying the MBMS bearer service.\nThe Framed-IP-Address AVP contains the IPv4 multicast address identifying the MBMS bearer service.\nThe Called-Station-Id AVP contains the Access Point Name (APN) on which the MBMS bearer service authorisation request was received.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.6.2\tAAA Command",
                            "text_content": "The AAA command, defined in Diameter NASREQ (IETF RFC 7155 [120]), is indicated by the Command-Code field set to 265 and the ‘R’ bit cleared in the Command Flags field., It is sent by the BM-SC to the GGSN in response to the AAR command.\nWhen the AAA command is used to acknowledge an AAR that activated a Trace Session, the only Gmb specific AVP that shall be included is the 3GPP-IMSI AVP.\nThe relevant AVPs that are of use for the Gmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nThe bold marked AVPs in the message format indicate new optional AVPs for Gmb, or modified existing AVPs.\nMessage Format:\n<AA-Answer> ::= < Diameter Header: 265, PXY >\n< Session-Id >\n{ Auth-Application-Id }\n{ Origin-Host }\n{ Origin-Realm }\n[ Result-Code ]\n[ Experimental-Result ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n*\t[ Proxy-Info ]\n[ Alternative-APN ]\n[ 3GPP-IMSI]\n[ TMGI ]\n[ Required-MBMS-Bearer-Capabilities ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.6.3\tSTR Command",
                            "text_content": "The STR command, defined in IETF RFC 6733 (DIAMETER BASE) [111], is indicated by the Command-Code field set to 275 and the ‘R’ bit set in the Command Flags field, It is sent by the GGSN to the BM-SC to terminate a DIAMETER session.\nA DIAMETER session for a multicast MBMS service is terminated when the last MBMS UE context for the MBMS bearer service is deleted. This informs the BM-SC that the GGSN would like to be deleted from the distribution tree of a particular MBMS bearer service (De-registration procedure).\nA DIAMETER session for an individual UE’s multicast MBMS service authorisation is terminated when the UE has requested to the GGSN to leave the MBMS bearer service.\nA DIAMETER session for a broadcast MBMS service may be terminated by the GGSN in exceptional cases.\nThe STR command is also used to deactivate a Trace Session previously activated in the BM-SC and to terminate the associated Diameter Session initiated by the AAR that activated the Trace session. The Gmb specific AVP Additonal-MBMS-Trace-Info shall be included in the STR command only in the case of a Trace Session deactivation. For more detailed description of Trace Session activation/deactivation procedures see 3GPP TS 32.422 [69].\nThe relevant AVPs that are of use for the Gmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nMessage Format:\n<ST-Request> ::= < Diameter Header: 275, REQ, PXY >\n< Session-Id >\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Auth-Application-Id }\n{ Termination-Cause }\n[ Destination-Host ]\n*\t[ Class ]\n[ Origin-State-Id ]\n*\t[ Proxy-Info ]\n*\t[ Route-Record ]\n[ Additional-MBMS-Trace-Info ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.6.4\tSTA Command",
                            "text_content": "The STA command, defined in IETF RFC 6733 (DIAMETER BASE) [111], is indicated by the Command-Code field set to 275 and the ‘R’ bit cleared in the Command Flags field, is sent in response to an STR command (e.g. De-registration procedure).\nThe relevant AVPs that are of use for the Gmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nMessage Format:\n<ST-Answer>  ::= < Diameter Header: 275, PXY >\n< Session-Id >\n{ Result-Code }\n{ Origin-Host }\n{ Origin-Realm }\n*\t[ Class ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n[ Origin-State-Id ]\n*\t[ Redirect-Host ]\n[ Redirect-Host-Usage ]\n[ Redirect-Max-Cache-Time ]\n*\t[ Proxy-Info ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.6.5\tRe-Auth-Request Command",
                            "text_content": "The Re-Auth-Request (RAR) command, defined in IETF RFC 6733 (DIAMETER BASE) [111], is indicated by the Command-Code set to 258 and the message flags’ ‘R’ bit set.\nThe relevant AVPs that are of use for the Gmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nThe bold marked AVPs in the message format indicate new optional AVPs for Gmb, or modified existing AVPs.\nMessage Format:\n<RAR>  ::= < Diameter Header: 258, REQ, PXY >\n< Session-Id >\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Destination-Host }\n{ Auth-Application-Id }\n{ Re-Auth-Request-Type }\n[ Called-Station-Id ]\n[ Framed-IP-Address]\n[ Framed-IPv6-Prefix ]\n[ Framed-Interface-Id ]\n[ MBMS-StartStop-Indication ]\n[ MBMS-Service-Area ]\n[ MBMS-Required-QoS ]\n[ MBMS-Session-Duration ]\n[ MBMS-Service-Type ]\n[ MBMS-Counting-Information ]\n[ MBMS-Session-Identity ]\n[ MBMS-Session-Repetition-number ]\n[ TMGI ]\n*  \t[ 3GPP-SGSN-Address ]            ; broadcast case only\n*  \t[ 3GPP-SGSN-IPv6-Address ]       ; broadcast case only\n[ MBMS-2G-3G-Indicator ]\n[ MBMS-Time-To-Data-Transfer ]\n[ MBMS-User-Data-Mode-Indication ]\n[ MBMS-BMSC-SSM-IP-Address ]\n[ MBMS-BMSC-SSM-IPv6-Address ]\n[ MBMS-Flow-Identifier ]\n[ CN-IP-Multicast-Distribution ]\n[ MBMS-HC-Indicator ]\n[ Origin-State-Id ]\n*\t[ Proxy-Info ]\n*\t[ Route-Record ]\n\nThe MBMS-StartStop-Indication AVP will indicate if the command is indicating an MBMS Session Start procedure, an MBMS Session Update procedure or an MBMS Session Stop procedure.\nThe Diameter Session-Id is used in subsequent procedures to identify the corresponding MBMS session.\nIn the multicast case, the BM-SC shall use the Diameter Session-Id that was received during the GGSN Registration procedure. In the broadcast case, the BM-SC shall allocate a Diameter Session-Id for the first RAR message that is used for the first MBMS Session Start procedure of the MBMS bearer service. Then this Diameter Session-Id will be used for the subsequent MBMS sessions of the same MBMS bearer service. The BM-SC will create a new Diameter Session-Id for a subsequent Session Start procedure if, in exceptional cases, the Diameter session for the MBMS bearer service has been deleted.\nBM-SC shall not initiate a new Session Start procedure for a certain MBMS bearer service until the previous MBMS session for that service has been stopped.\nFor the MBMS Session Start procedure, RAR is sent by the BM-SC to the GGSN(s) that will deliver the MBMS service (e.g. in the multicast case these are the GGSNs that have previously registered for the corresponding multicast MBMS bearer service), when it is ready to send data. This is a request to activate all necessary bearer resources in the network for the transfer of MBMS data and to notify interested UEs of the imminent start of the transmission. For broadcast MBMS bearer services the RAR message contains either an IPv4 address or an IPv6 address for each participating SGSN.\nFor the MBMS Session Update procedure, RAR is sent by the BM-SC in order for  the GGSN(s) to update their session attributes. The updated MBMS-Service-Area AVP shall be included. The MBMS-StartStop-Indication AVP with the value UPDATE shall be included. The MBMS-Time-To-Data-Transfer with the value set to 0 shall be included. The MBMS-Session-Duration AVP shall be included to indicate the duration of the remaining part of the MBMS session. The 3GPP-SGSN-Address AVP and the 3GPP-SGSN-IPv6-Address AVP shall be included if the related lists of downstream nodes in the GGSN(s) have changed. The other bold marked AVPs shall be included as given by the previous, corresponding MBMS Session Start procedure.\nFor the MBMS Session Stop procedure, RAR is sent by the BM-SC to the GGSN(s) when it considers the MBMS session to be terminated. The session is typically terminated when there is no more MBMS data expected to be transmitted for a sufficiently long period of time to justify a release of bearer plane resources in the network.\nFor the MBMS Session Start procedure, the MBMS-Required-QoS indicates the QoS that is required for the MBMS bearer service for the actual MBMS session. The information of the MBMS-2G-3G-Indicator, the MBMS-Service-Area and the MBMS-Counting-Information is passed from BM-SC transparently through GGSN to the SGSN(s) that are relevant for the actual MBMS bearer service.\nAccording to 3GPP TS 23.246 [65], a specific MBMS bearer service is uniquely identified by its IP multicast address and an APN. For the MBMS Session Start procedure for broadcast  MBMS bearer services, the following AVPs are  included (either IPv4 or IPv6 address) to enable GGSN to relate incoming payload packets to the actual MBMS bearer service and distribute the packets to the downstream SGSNs related to this service:\n-\tThe Framed-IPv6-Prefix AVP contains the IPv6 prefix of the multicast address.\n-\tThe Framed-Interface-Id AVP contains the IPv6 interface identifier of the multicast address.\n-\tThe Framed-IP-Address AVP contains the IPv4 multicast address.\n-\tThe Called-Station-Id AVP contains the Access Point Name (APN) for which the MBMS bearer service is defined.\nAccording to 3GPP TS 23.246 [65], the MBMS-Flow-Identifier is optional, used only for broadcast services with location dependent content. For such services, several sessions with the same TMGI, but different MBMS-Flow-Identifiers, may be going on in parallel. However, at any specific location only one version of the content may be available at any point in time. Hence, the MBMS-Service-Areas of the related MBMS bearer contexts shall not overlap.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.6.6\tRE-Auth-Answer Command",
                            "text_content": "The Re-Auth-Answer (RAA) command, defined in IETF RFC 6733 (DIAMETER BASE) [111], is indicated by the Command-Code set to 258 and the message flags’ ‘R’ bit clear, is sent in response to the RAR.\nThe relevant AVPs that are of use for the Gmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nThe bold marked AVPs in the message format indicate new optional  AVPs for Gmb, or modified existing AVPs.\nMessage Format:\n<RAA>  ::= < Diameter Header: 258, PXY >\n< Session-Id >\n{ Origin-Host }\n{ Origin-Realm }\n[ Result-Code ]\n[ Experimental-Result ]\n[ MBMS-StartStop-Indication ]\n[ MBMS-GGSN-Address ]            ; for unicast encapsulated user data\n[ MBMS-GGSN-IPv6-Address ]       ; for unicast encapsulated user data\n[ MBMS-GW-UDP-Port]              ; for unicast encapsulated user data\n[ MBMS-User-Data-Mode-Indication ]\n[ Origin-State-Id ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n*\t[ Redirected-Host ]\n[ Redirected-Host-Usage ]\n[ Redirected-Host-Cache-Time ]\n*\t[ Proxy-Info ]\n\nIf multicast user plane data are to be sent to the GGSN using IP unicast, the GGSN shall allocate an IP transport address and a separate UDP port for each MBMS bearer ( i.e the service uniquely identified by its TMGI and Flow ID and provided by the GPRS to deliver the same IP datagrams to multiple receivers in a designated location). The GGSN shall then use the destination unicast IP address and destination UDP port of user plane packets received over the Gi interface to determine on which MBMS bearer to forward the received user plane packet.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.6.7\tAbort-Session-Request Command",
                            "text_content": "The Abort-Session-Request (ASR) command, defined in IETF RFC 6733 (DIAMETER BASE) [111], is indicated by the Command-Code set to 274 and the message flags’ ‘R’ bit set, is sent by the BM-SC to the GGSN to request that the session identified by the Session-Id be stopped.\nThe relevant AVPs that are of use for the Gmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nMessage Format\n<ASR>  ::= < Diameter Header: 274, REQ, PXY >\n< Session-Id >\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Destination-Host }\n{ Auth-Application-Id }\n[ Origin-State-Id ]\n* [ Proxy-Info ]\n* [ Route-Record ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.6.8\tAbort-Session-Answer Command",
                            "text_content": "The Abort-Session-Answer (ASA) command, defined in IETF RFC 6733 (DIAMETER BASE) [111], is indicated by the Command-Code set to 274 and the message flags’ ‘R’ bit clear, is sent in response to the ASR.\nThe relevant AVPs that are of use for the Gmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for Gmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nMessage Format\n<ASA>  ::= < Diameter Header: 274, PXY >\n< Session-Id >\n{ Result-Code }\n{ Origin-Host }\n{ Origin-Realm }\n[ Origin-State-Id ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n* [ Redirected-Host ]\n[ Redirected-Host-Usage ]\n[ Redirect-Max-Cache-Time ]\n* [ Proxy-Info ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "17.7\tGmb specific AVPs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "17.7.0\tGeneral",
                            "text_content": "Table 10 describes the Gmb specific Diameter AVPs. The Vendor-Id header of all Gmb specific AVPs defined in the present specification shall be set to 3GPP (10415).\nThe Gmb specific AVPs require to be supported to be compliant to the present specification. All AVPs in table 10 are mandatory within Gmb interface unless otherwise stated.\nTable 10: Gmb specific AVPs\n\nTable 11 lists the set of Diameter AVPs that are not Gmb specific, but are reused from other Diameter applications by the Gmb interface. A reference is done to the specifications where the AVPs are specified.  This set of AVPs requires to be supported to be compliant to the present specification.\nTable 11: Gmb reused AVPs from other Diameter applications.\n\nNOTE:\tDiameter Base AVPs are not listed as support of them is mandated by IETF RFC 6733 [111].\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 10: Gmb specific AVPs",
                                    "table number": 54,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 11: Gmb reused AVPs from other Diameter applications.",
                                    "table number": 55,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "17.7.1\t3GPP-Vendor-Specific AVP",
                            "text_content": "Void.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.2\tTMGI AVP",
                            "text_content": "The TMGI AVP (AVP code 900) is of type OctetString, and contains the Temporary Mobile Group Identity allocated to a particular MBMS bearer service. It is allocated by the BM-SC. The encoding of TMGI is specified in 3GPP TS 24.008 [54]. When allocating the TMGI, BM-SC shall always include the MCC and MNC in the TMGI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.3\tRequired-MBMS-Bearer-Capabilities AVP",
                            "text_content": "The Required-MBMS-Bearer-Capabilities AVP (AVP code 901) is of type UTF8String, and contains the minimum bearer capabilities the UE needs to support. The information contained in this AVP is UTF-8 encoded MBMS bearer capabilities as defined in 3GPP TS 24.008 [54].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.4\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.5\tMBMS-StartStop-Indication AVP",
                            "text_content": "The MBMS-StartStop-Indication AVP (AVP code 902) is of type Enumerated. The following values are supported:\nSTART (0)\nThe message containing this AVP is indicating an MBMS session start procedure.\nSTOP\t(1)\nThe message containing this AVP is indicating an MBMS session stop procedure.\nUPDATE (2)\nThe message containing this AVP is indicating an MBMS session update procedure.\nHEARTBEAT (3)\nThe message containing this AVP is indicating an MBMS heartbeat procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.6\tMBMS-Service-Area AVP",
                            "text_content": "The MBMS-Service-Area AVP (AVP code 903) is of type OctetString, and indicates the area over which the MBMS bearer service has to be distributed. The AVP consists of the following parts:\n\n\nThe MBMS service area code represents the coding for the MBMS Service Area Identity.\nThe MBMS Service Area Identity and its semantics are defined in subclause 15.3 of 3GPP TS 23.003 [40].\nThe length of an MBMS service area code is 2 octets.\nEach MBMS service area code shall only be present once in the list.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 56,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "17.7.7\tMBMS-Session-Duration AVP",
                            "text_content": "The MBMS-Session-Duration AVP (AVP code 904) is of type OctetString with a length of three octets and indicates the estimated session duration (MBMS Service data transmission). Bit 8 of octet 1 to bit 8 of octet 3 (17 bits) express seconds, for which the maximum allowed value is 86400 seconds. Bits 7 to 1 of octet 3 (7 bits) express days, for which the maximum allowed value is 18 days. The coding is as follows (the ‘s’ bits represent the seconds, the ‘d’ bits represent the days):\n\n\nFor the whole session duration the seconds and days are added together and the maximum session duration is 19 days.\nThe lowest value of this AVP (i.e. all 0’s), is reserved to indicate an indefinite value to denote sessions that are expected to be always-on.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 57,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "17.7.8\tAlternative-APN AVP",
                            "text_content": "The Alternative-APN AVP (AVP code 905) is of type UTF8String, and contains the value of a new APN. This AVP is optional within the Gmb interface. BM-SC only includes it if the UE must use a different APN for the MBMS PDP Context from the one used in the Join message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.9\tMBMS-Service-Type AVP",
                            "text_content": "The MBMS-Service-Type AVP (AVP code 906) is of type Enumerated, and contains explicit information about the type of service that the BM-SC Start Procedure is about to start.\nMULTICAST (0)\nThe Start Procedure signalled by the BM-SC is for a Multicast Service.\nBROADCAST (1)\nThe Start Procedure signalled by the BM-SC is for a Broadcast Service.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.10\tMBMS-2G-3G-Indicator AVP",
                            "text_content": "The MBMS-2G-3G-Indicator AVP  (AVP code 907) is of type Enumerated. It indicates whether the MBMS bearer service will be delivered in 2G- only, 3G- only of both coverage areas. The following values are supported:\n2G (0)\nThe MBMS bearer service shall only be delivered in 2G only coverage areas.\n3G (1)\nThe MBMS bearer service shall only be delivered in 3G only coverage areas.\n2G-AND-3G (2)\nThe MBMS bearer service shall be delivered both in 2G and 3G coverage areas.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.11\tMBMS-Session-Identity  AVP",
                            "text_content": "The MBMS-Session-Identity AVP (AVP code 908) is of type OctetString. Its length is one octet.  It is allocated by the BM-SC. Together with TMGI it identifies a transmission of a specific MBMS session.  The initial transmission and subsequent retransmissions of the MBMS session will use the same values of these parameters. This AVP is optional within the Gmb interface.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.12\tRAI AVP",
                            "text_content": "The RAI AVP (AVP Code 909) is of type UTF8String, and contains the Routing Area Identity of the SGSN where the UE is registered. RAI use and structure is specified in 3GPP TS 23.003 [40].\nIts value shall be encoded as a UTF-8 string on either 11 (if the MNC contains two digits) or 12 (if the MNC contains three digits) octets as follows:\n-\tThe MCC shall be encoded first using three UTF-8 characters on three octets, each character representing a decimal digit starting with the first MCC digit.\n-\tThen, the MNC shall be encoded as either two or three UTF-8 characters on two or three octets, each character representing a decimal digit starting with the first MNC digit.\n-\tThe Location Area Code (LAC) is encoded next using four UTF-8 characters on four octets, each character representing a hexadecimal digit of the LAC which is two binary octets long.\n-\tThe Routing Area Code (RAC) is encoded last using two UTF-8 characters on two octets, each character representing a hexadecimal digit of the RAC which is one binary octet long.\nNOTE:\tAs an example, a RAI with the following information: MCC=123, MNC=45, LAC=41655(0xA2C1) and RAC=10(0x0A) is encoded within the RAI AVP as a UTF-8 string of \"12345A2C10A\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.13\tAdditional-MBMS-Trace-Info AVP",
                            "text_content": "The Additional-MBMS-Trace-Info AVP (AVP Code 910) is of type OctetString. This AVP contains Trace Reference2, Trace Recording Session Reference, Triggering Events in BM-SC, Trace Depth for BM-SC, List of interfaces in BM-SC, Trace Activity Control For BM-SC which are all part of the Additional MBMS Trace Info IE as specified in TS 29.060 [24].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.14\tMBMS-Time-To-Data-Transfer AVP",
                            "text_content": "The MBMS-Time-To-Data-Transfer AVP (AVP code 911) is of type OctetString. Its length is one octet. It indicates the expected time between reception of the MBMS Session Start  (RAR(Start) command) and the commencement of the MBMS Data flow. The coding is specified as per the Time to MBMS Data Transfer Value Part Coding of the Time to MBMS Data Transfer IE in 3GPP TS 48.018 [70].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.15\tMBMS-Session-Repetition-Number AVP",
                            "text_content": "The MBMS-Session-Repetition-Number AVP (AVP code 912) is of type OctetString with a length of one octet. It contains the session identity repetition number of the MBMS transmission session on the Gmb interface. The value 0 indicates the first transmission of a session. The values 1 to 255 represents the retransmission sequence number of a session. When the optional MBMS-Session-Identity AVP is included in the MBMS Session Start RAR (Start) command by the BM-SC, the BM-SC shall also provide the corresponding MBMS-Session-Repetition-Number AVP, and vice versa.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.16\tMBMS-Required-QoS AVP",
                            "text_content": "The MBMS-Required-QoS AVP (AVP code 913) is the quality of service required for the MBMS bearer service. It is specified as UTF8String with the following encoding:\n\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 58,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "17.7.17\tMBMS-Counting-Information AVP",
                            "text_content": "The MBMS-Counting-Information AVP (AVP code 914) is of type Enumerated, and contains explicit information about whether the MBMS Counting procedures are applicable for the MBMS Service that is about to start. See 3GPP TS 25.346 [72].\nThis AVP is only valid for UTRAN access type.\nThe following values are supported:\nCOUNTING-NOT-APPLICABLE (0)\nThe MBMS Session Start Procedure signalled by the BM-SC is for a MBMS Service where MBMS Counting procedures are not applicable.\nCOUNTING-APPLICABLE (1)\nThe MBMS Session Start Procedure signalled by the BM-SC is for a MBMS Service where MBMS Counting procedures are applicable.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.18\tMBMS-User-Data-Mode-Indication AVP",
                            "text_content": "The MBMS-User-Data-Mode-Indication AVP (AVP code 915) is of type Enumerated. The meaning of the message containing this AVP depends on the sending entity. The absence of this AVP indicates unicast mode of operation.\nThe following values are supported:\nUnicast (0)\nWhen BM-SC sends this value, that indicates to GGSN that BM-SC supports only unicast mode (IP multicast packets encapsulated over UDP by IP unicast header).\nWhen GGSN sends this value, that indicates to BM-SC that BM-SC shall send user plane data with unicast mode (IP multicast packets encapsulated over UDP by IP unicast header).\nMulticast and Unicast (1)\nWhen BM-SC sends this value, that indicates to GGSN that BM-SC supports both modes of operation.\nWhen GGSN sends this value, that indicates to BM-SC that BM-SC shall send user plane data with multicast mode.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.19\tMBMS-GGSN-Address AVP",
                            "text_content": "The MBMS-GGSN-Address AVP (AVP code 916) is of type OctetString, and contains the value of GGSN’s Ipv4 address for user plane data. Ipv4 only or dual stack GGSN includes this AVP in case BM-SC requests GGSN’s user plane unicast address.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.20\tMBMS-GGSN-Ipv6-Address AVP",
                            "text_content": "The MBMS-GGSN-Ipv6-Address AVP (AVP code 917) is of type OctetString, and contains the value of GGSN’s Ipv6 address for user plane data. Dual stack GGSN includes this AVP in case BM-SC requests GGSN’s user plane unicast address.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.21\tMBMS-BMSC-SSM-IP-Address AVP",
                            "text_content": "The MBMS-BMSC-SSM-IP-Address AVP (AVP code 918) is of type OctetString, and contains the value of BM-SC’s IPv4 address for Source Specific Multicasting. IPv4 only or dual stack BM-SC includes this AVP.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.22\tMBMS-BMSC-SSM-IPv6-Address AVP",
                            "text_content": "The MBMS-BMSC-SSM-IPv6-Address AVP (AVP code 919) is of type OctetString, and contains the value of BM-SC’s IPv6 address for Source Specific Multicasting. Dual stack BM-SC includes this AVP.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.23\tMBMS-Flow-Identifier AVP",
                            "text_content": "The MBMS-Flow-Identifier AVP (AVP code 920) is of type OctetString. Its length is two octets. It represents a location dependent subflow of a broadcast MBMS bearer service. When present, the MBMS-Flow-Identifier together with the TMGI uniquely identify an MBMS Bearer Context.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.24\tCN-IP-Multicast-Distribution AVP",
                            "text_content": "CN-IP-Multicast-Distribution AVP (AVP code 921) is of type Enumerated. It represents an indication if IP multicast distribution to UTRAN should be used for the MBMS user plane data. The following values are supported:\nNO-IP-MULTICAST (0)\nValue 0 indicates that IP multicast distribution of MBMS user plane data to UTRAN shall not be used.\nIP-MULTICAST\t(1)\nValue 1 indicates that MBMS user plane data to UTRAN should be delivered by IP multicast mechanism.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.7.25\tMBMS-HC-Indicator AVP",
                            "text_content": "MBMS-HC-Indicator AVP (AVP code 922) is of type Enumerated. It represents an indication if header compression is used by BM-SC when sending for MBMS user plane data. The enumeration values are defined in 3GPP TS 25.413 [92].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "17.7a\t\tGmb re-used AVPs",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 17.7a.1 lists the Diameter AVPs re-used by the Gmb reference point from other existing Diameter Application, reference to their respective specifications and short description of their usage witin the Gmb reference point. Other AVPs from existing Diameter Applications, except for the AVPs from Diameter base protocol, do not need to be supported. The AVPs from Diameter base protocol are not included in table 17.7a.1, but they are re-used for the Gmb reference point. Unless otherwise stated, re-used AVPs shall maintain their 'M', 'P' and 'V' flag settings. Where RADIUS VSAs are re-used, they shall be translated to Diameter AVPs as described in IETF RFC 7155 [120] with the exception that the 'M' flag shall be set and the 'P' flag may be set.\nTable 17.7a.1: Gmb re-used Diameter AVPs\n\n",
                    "tables": [
                        {
                            "description": "Table 17.7a.1: Gmb re-used Diameter AVPs",
                            "table number": 59,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "17.8\tGmb specific Experimental-Result-Code AVP values",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "17.8.0\tGeneral",
                            "text_content": "There are two different types of errors in Diameter; protocol and application errors. A protocol error is one that occurs at the base protocol level, those are covered in the Diameter Base IETF RFC 6733 [111] specific procedures. Application errors, on the other hand, generally occur due to a problem with a function specified in a Diameter application.\nDiameter Base IETF RFC 6733 [111] defines a number of Result-Code AVP values that are used to report protocol errors and how those are used. Those procedures and values apply for the present specification.\nDue to the Gmb specific AVPs, new applications errors can occur. The Gmb specific errors are described by the Experimental-Result-Code AVP in this clause, below. Note that according to IETF RFC 6733 [111], the Diameter node reports only the first error encountered and only one Result-Code AVP or one Experimental-Result AVP is included in the Diameter answer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.8.1\tSuccess",
                            "text_content": "Resulting codes that fall within the Success category are used to inform a peer that a request has been successfully completed.\nThe Result-Code AVP values defined in Diameter Base IETF RFC 6733 [111] are applicable.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.8.2\tPermanent Failures",
                            "text_content": "Errors that fall within the Permanent Failures category are used to inform the peer that the request failed, and should not be attempted again.\nThe Result-Code AVP values defined in Diameter Base IETF RFC 6733 [111] are applicable. Also the following specific Gmb Experimental-Result-Code values are defined for permanent failures:\nDIAMETER_ERROR_START_INDICATION (5120)\nThis error covers the case when a MBMS Session Start procedure could not be performed due to some of the required session attributes that are necessary to activate the bearer resources are missing (QoS, MBMS Service Area…).  The Failed-AVP AVP must contain the missing AVP.\nDIAMETER_ERROR_STOP_INDICATION (5121)\nAn indication of session stop has been received with no session start procedure running.\nDIAMETER_ERROR_UNKNOWN_MBMS_BEARER_SERVICE (5122)\nThe requested MBMS service is unknown at the BM-SC.\nDIAMETER_ERROR_SERVICE_AREA (5123)\nThe MBMS service area indicated for a specific MBMS Bearer Service is unknown or not available.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "17.8.3\tTransient Failures",
                            "text_content": "Errors that fall within the transient failures category are used to inform a peer that a request could not be satisfied at the time it was received, but it may be satisfied in the future.\nThe Result-Code AVP values defined in Diameter Base IETF RFC 6733 [111] are applicable. Also the following specific Gmb Experimental-Result-Code value is defined for transient failures:\nDIAMETER_ERROR_OUT_OF_RESOURCES (4121)\nThis error covers the case when a MBMS Session Start procedure could not be performed due to a temporary resource shortage in the GGSN. The BM-SC may re-try later.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "18\tUsage of RADIUS at the Pk Reference Point",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "18.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The Pk Reference Point is defined in 3GPP TS 23.141 [68] and allows the GGSN to report presence relevant events to the Presence Network Agent (such as PDP context activation/de-activation). This reference point is implemented using the mechanisms for Accounting of the RADIUS interface on the Gi reference point as defined in Clause 16.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "18.2\tRadius Profile for Pk Reference Point",
                    "description": "",
                    "summary": "",
                    "text_content": "The RADIUS interface on Gi reference point as defined in Clause 16 is used for the Pk Reference Point as clarified in the Profile in this Clause.\nOnly the following messages are required for the Radius Profile for the Pk reference Point:\n-\tAccounting-Request START\n-\tAccounting-Response START\n-\tAccounting-Request STOP\n-\tAccounting-Response STOP\nFor the Radius Profile for the Pk Reference Point, only the mandatory Parameters within the Accounting-Request START and Accounting-Request STOP messages according to Clauses 16.4.3 and 16.4.4, respectively, and the Parameter \"Calling-Station-Id\" need to be supported. The usage of other parameters is optional. They may be ignored by the Presence Network Agent.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "18.3\tInterconnecting the Presence Network Agent and the GGSN",
                    "description": "",
                    "summary": "",
                    "text_content": "The Presence Network Agent may be directly attached to the GGSN or via a Radius Proxy.\nIf the GGSN needs to connect both to an AAA server and a Presence Network Agent for the same APN, but supports only a single RADIUS interface, the GGSN can be directly attached to the AAA server. The Presence Network Agent can in turn be attached to the AAA server, which acts as a RADIUS proxy. If the AAA server is configured as a RADIUS Proxy between the Presence Network Agent and the GGSN, the Radius Profile for the Pk Reference Point shall be applicable on the interface between the Presence Network Agent and the AAA server.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "19\tUsage of Diameter on Mz interface",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "19.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "3GPP TS 23.246 [65] specifies that when MBMS bearers are used to provide MBMS user services to roaming users, three specific scenarios are used.\nOne uses a GGSN in the Home PLMN, which is not related to Mz interface. The other two are enabled by use of the Mz interface for multicast services and are further described below.\nMz is the roaming variant of the Gmb reference point with the same functionality as decribed under Gmb, i.e. with MBMS bearer and user specific signalling. The support of Mz with in BM-SC is needed for MBMS roaming scenario. Mz interface is defined between the visited BM-SC and the home BM-SC.\nMBMS bearer and user specific Mz signalling is used between a BM-SC in the visited PLMN and a BM-SC in the home PLMN when MBMS services from the home PLMN are offered by the visited PLMN.\nUser specific signalling is used between a BM-SC in the visited PLMN and a BM-SC in the home PLMN when the visited PLMN offers MBMS user service to roaming users. This user specifice Mz signalling provides home PLMN authorisation for MBMS user service that are provided by the visited PLMN.\nMz may use proxy capabilities as described for Gmb, e.g. to proxy signalling between BM-SCs.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "19.2\tCall flows in roaming scenarios",
                    "description": "",
                    "summary": "",
                    "text_content": "The procedures described in clause 17 of the present specification: Session Start procedure (clause 17.5.2), Session Stop procedure (clause 17.5.3), Registration procedure (clause 17.5.4), De-registration procedure (GGSN initiated) (clause 17.5.5), De-registration procedure (BM-SC initiated) (clause 17.5.6), Trace Session Activation procedure (clause 17.5.8), Trace Session Deactivation procedure (clause 17.5.9), MBMS UE Context Modification procedure (clause 17.5.10), and Session Update procedure (clause 17.5.11) work exactly the same in roaming scenarios, i.e when the GGSN is in a visited PLMN and the BM-SC is in the home PLMN, and they are Gmb procedures only and are not needed over Mz interface.\nService activation procedures and Service deactivation procedures are the only procedures over Mz interface, and are described in detail in the following subclauses.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "19.2.1\tService activation",
                            "text_content": "A visited PLMN may offer to roaming users MBMS user services from their home PLMN. For this case, the PDP connection, which will be used for the JOIN step, may be from the UE to the visited GGSN due to operator policy or routing optimization. Then the authorization is done in the BM-SC in visited PLMN with the authorization information retrieved from the BM-SC in home PLMN.\nWhether GGSN of home or visited PLMN would be used is based on the operator policy, or agreement between PLMNs.\nThe MBMS user traffic is provided by the BM-SC in home PLMN and proxyed.\nThe figure depicts the activation of an MBMS multicast service in a roaming scenario, where service is provided in the home PLMN. The service is activated by the MBMS, which is a multicast service that provides a single service to multiple subscribers. The figure shows the activation process, including the MBMS server, the home PLMN, and the subscriber devices. The activation is depicted in a graphical format, with the MBMS server being the central point of the activation process. The home PLMN is shown as the recipient of the service, and the subscriber devices are shown as the end users. The activation process is shown in a step-by-step manner, with the MBMS server initiating the activation, the home PLMN receiving the service, and the subscriber devices receiving the service.\nFigure 28: Activation of an MBMS multicast service in roaming scenario with service provided in the home PLMN\n1.\tThe GGSN sends an AAR to the BM-SC in visited PLMN seeking authorizationt for the activating roaming UE to receive data from a particular service.\n2.\tThe BM-SC in visited PLMN finds the BM-SC in home PLMN which will serve the roaming UE based on the multicast IP address, and identity of the user, and sends the AAR to it for the roaming UE to receive data from a particular service.\n3.\tThe authorization decision is provided from BM-SC in home PLMN in the AAA to BM-SC in visited PLMN. An APN may be included in the signalling between BM-SCs, which indicates a GGSN in home PLMN which will serve the UE for the specific MBMS service. The BM-SC in the visit network may modify the APN based on the operator policy or agreement between PLMNs.\n4.\tThe authorization decision, as received from BM-SC in home PLMN, is provided in the AAA to GGSN together with the APN to be used for creation of the MBMS UE Context If  the AAA indicates that  the roaming UE is not authorized to receive  the MBMS data the process terminates with no additional message exchange.\nWhether GGSN of home or visited PLMN would be used is based on the operator policy, or agreement between PLMNs, for example, the visited BM-SC may modify the APN from the home BM-SC according to configuration of operator policy.\n5.\tThe GGSN sends an AAR seeking authorization for the activating UE to BM-SC in home PLMN. This GGSN may be different from the GGSN that receives IGMP join message.\n6.\tThe authorization decision is provided in the AAA to GGSN.\nWhen visited and home PLMN support the same classes of MBMS user services, a visited PLMN may offer its own MBMS user services to roaming users. In this case, the authorization is done in the BM-SC in visited PLMN with the authorization information retrieved from the BM-SC in home PLMN. Then the MBMS user traffic is provided by the BM-SC in visited PLMN.\nThe figure depicts a MBMS multicast service activation in a roaming scenario, where service is provided to a PLMN visited by the MBMS. The activation is depicted with a service provider (SP) and a mobile base station (MBMS) in the same network, illustrating the interconnection between the two. The MBMS multicast service is activated, and the service is provided to the PLMN, highlighting the importance of network interoperability and the role of MBMS in providing reliable and efficient communication services.\nFigure 29a: Activation of an MBMS multicast service in roaming scenario with service provided in the visited PLMN\n1.\tThe GGSN sends an AAR to the BM-SC in visited PLMN seeking authorizationt information for the activating roaming UE to receive data from a particular service.\n2.\tThe BM-SC in visited PLMN finds the BM-SC in home PLMN which have the authorization information for the roaming UE based on the multicast IP address, and identity of the user, and sends the AAR to it for the roaming UE to receive authorization from a particular service.\n3.\tThe authorization decision is provided from BM-SC in home PLMN in the AAA to BM-SC in visited PLMN.\n4.\tThe authorization decision, as received from BM-SC in home PLMN, is provided in the AAA to GGSN together with the APN to be used for creation of the MBMS UE Context If  the AAA indicates that  the roaming UE is not authorized to receive  the MBMS data the process terminates with no additional message exchange.\n5.\tThe GGSN sends an AAR seeking authorization for the activating UE to BM-SC in visited PLMN. This GGSN may be different from the GGSN that receives IGMP join message.\n6.\tThe authorization decision is provided in the AAA to GGSN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19.2.2\tService deactivation",
                            "text_content": "In the given telecommunication figure, Figure 30a, MBMS multicast service is deactivated in a roaming scenario, with service provided in the home PLMN. The figure illustrates the deactivation process, showing the MBMS multicast service being turned off at the home PLMN, and the service being provided in the roaming PLMN. This scenario demonstrates the importance of network management and the need for efficient service provisioning in mobile networks.\nFigure 30a: Deactivation of an MBMS multicast service in roaming scenario with service provided in the home PLMN\n1.\tUpon receiving the leave indication, the GGSN sends an STR to the BM-SC in visited PLMN, indicating that the roaming UE is requesting to leave the multicast service. The session to be terminate is uniquely identified by the Diameter session-id.\n2.\tUpon reception of the STR, the BM-SC in visited PLMN finds the BM-SC in home PLMN which serves the roaming UE, and sends an STR to it for the roaming UE to deactivate a particular service.\n3.\tUpon reception of the STR, the BM-SC in home PLMN verifies that the IP multicast address corresponds to a valid MBMS bearer service and responds the BM-SC in visited PLMN with an ST-Answer. The APN shall be the same that was provided during service activation.\n4.\tUpon reception  of the STA, the BM-SC in visited PLMN sends an STA to the GGSN that orignated the Leave Indication.\n5.\tThe GGSN which is used to establish the MBMS bearer service deletes the MBMS UE Context and sends an STR to the BM-SC in home PLMN to confirm the successful deactivation of the MBMS UE Context.\n6.\tThe BM-SC in home PLMN then, deletes the MBMS UE Context and sends a confirmation to the GGSN in an STA message.\nIn the given telecommunication figure, Figure 31a, we can observe a scenario where a MBMS multicast service is deactivated in a roaming scenario. The figure depicts a network with multiple paths, including the one for the MBMS multicast service. The service is deactivated when the user is in a PLMN (Point-to-Multipoint Network) and the MBMS multicast service is not provided. This scenario highlights the importance of network management and the need for proper network planning to ensure reliable and efficient communication.\nFigure 31a: Deactivation of an MBMS multicast service in roaming scenario with service provided in the visited PLMN\n1.\tUpon receiving the leave indication, the GGSN sends an STR to the BM-SC in visited PLMN, indicating that the roaming UE is requesting to leave the multicast service. The session to be terminate is uniquely identified by the Diameter session-id.\n2.\tUpon reception of the STR, the BM-SC in visited PLMN verifies that the IP multicast address corresponds to a valid MBMS bearer service and sends an STR to the BM-SC in home PLMN.\n3.\tThe BM-SC in home PLMN responds the BM-SC in visited PLMN with an ST-Answer.\n4.\tUpon reception of the STA, the BM-SC in visited PLMN sends an STA to the GGSN that orignated the Leave Indication. The APN shall be the same that was provided during service activation.\n5.\tThe GGSN deletes the MBMS UE Context and sends an STR to the BM-SC in visited PLMN to confirm the successful deactivation of the MBMS UE Context.\n6.\tThe BM-SC in visited PLMN, then, delets the MBMS UE Context and sends a confirmation to the GGSN in an STA message.\nThis section defines the BM-SC in the home PLMN initiated multicast service deactivation procedure.\nThe figure depicts a scenario where a home PLMN initiates a MBMS multicast service deactivation procedure. The BM-SC (Baseband-to-Serving Converter) is responsible for converting the MBMS multicast service into a traditional voice service. The figure illustrates the process of deactivating the multicast service, which is crucial for maintaining network stability and reducing the load on the network.\nFigure 32b: BM-SC in the home PLMN initiated MBMS multicast service deactivation procedure\n1.\tThe BM-SC in home PLMN sends an ASR to the BM-SC in visited PLMN, indicating that the UE shall be removed from a specific multicast service. The session to be terminated is uniquely identified by the Diameter session-id.\n2.\tThe BM-SC in the visited PLMN sends an ASR to the GGSN indicating that the UE shall be removed from the multicast service. The session to be terminated is uniquely identified by the Diameter session-id.\n3.\tUpon reception of the ASR, the GGSN sends an ASA to the BM-SC in visited PLMN.\n4.\tUpon reception of the ASA, the BM-SC in visited PLMN sends an ASA to the BM-SC in home PLMN.\n5.\tUpon reception of the ASR in step 3, the GGSN sends an MBMS UE Context Deactivation Request to the SGSN. The IP multicast address, APN and IMSI together identify the MBMS UE Context to be deleted by the SGSN.\nSteps 5 and 6 of Figure 30a in section 19.2.2.1 follows in roaming scenarios where service was provided in the home PLMN.\nSteps 5 and 6 of Figure 31a in section 19.2.2.2 follows in roaming scenarios where service was provided in the visited PLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "19.3\tMz messages",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause defines the Mz interface Diameter messages.\nThe Diameter messages used in the Mz protocol, are the same as specified for Gmb interface described in Clause 17 of the present specification: AAR Command (clause 17.6.1), AAA Command (clause 17.6.2), STR Command (clause 17.6.3), STA Command (clause 17.6.4), Abort-Session-Request Command (clause 17.6.7) and Abort-Session-Answer Command (17.6.8).\nTo route Diameter messages from the visited PLMN to the home PLMN, the BM-SC in the visited PLMN shall derive the realm of the home PLMN from the user’s IMSI. The way to derive the realm of the home PLMN from IMSI is specified in 3GPP TS 23.003 [40] subclause 15.4.\nThe derived realm of the home PLMN shall be filled in the Destination-Realm AVP of messages sent from the visited PLMN to the home PLMN, i.e. AAR command, STR command.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "19.4\tMz specific AVPs",
                    "description": "",
                    "summary": "",
                    "text_content": "The Mz specific AVPs are the same as specified in Table 10 and Table 11. The Vendor-Id header of all Mz specific AVPs defined in the present specification shall be set to 3GPP (10415).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "19.5\tMz specific Experimental-Result-Code AVP values",
                    "description": "",
                    "summary": "",
                    "text_content": "There are two different types of errors in Diameter; protocol and application errors. A protocol error is one that occurs at the base protocol level, those are covered in the Diameter Base IETF RFC 6733 [111] specific procedures. Application errors, on the other hand, generally occur due to a problem with a function specified in a Diameter application.\nDiameter Base IETF RFC 6733 [111] defines a number of Result-Code AVP values that are used to report protocol errors and how those are used. Those procedures and values apply for the present specification.\nNote that according to IETF RFC 6733 [111], the Diameter node reports only the first error encountered and only one Result-Code AVP or one Experimental-Result AVP is included in the Diameter answer.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "19.5.1\tSuccess",
                            "text_content": "The success result codes specified in clause 17.8.1 of the present specification are applicable for Mz.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19.5.2\tPermanent Failures",
                            "text_content": "The Result-Code AVP values defined in Diameter Base IETF RFC 6733 [111] are applicable. Also the following specific Gmb Experimental-Result-Code value defined in clause 17.8.2 is applicable for Mz:\nDIAMETER_ERROR_UNKNOWN_MBMS_BEARER_SERVICE (5122)\nThe requested MBMS service is unknown at the BM-SC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "19.5.3\tTransient Failures",
                            "text_content": "Errors that fall within the transient failures category are used to inform a peer that a request could not be satisfied at the time it was received, but it may be satisfied in the future.\nThe Result-Code AVP values defined in Diameter Base IETF RFC 6733 [111] are applicable.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "20\tUsage of Diameter on SGmb interface",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "20.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Signalling between MBMS GW and BM-SC is exchanged at SGmb reference point.\nThe MBMS GW uses the SGmb interface:\n-\tto receive indication of session start, session update and session stop messages, which shall cause the MBMS GW, MME/SGSN and E-UTRAN/UTRAN to set up/tear down the appropriate resources for the service. For further details, see 3GPP TS 23.246 [65];\n-\tto enable the BM-SC and MBMS GW to detect an SGmb path failure or the restart of the peer MBMS node. For further details, see 3GPP TS 23.007 [104].\n-\tto enable the BM-SC to transfer the M1 interface information of local MBMS information. For further details, see 3GPP TS 23.285 [112].\nNOTE:\tThe localized MBMS architecture refers to Annex B of 3GPP TS 23.285 [112].\nThe SGmb application is defined as an IETF vendor specific Diameter application, where the vendor is 3GPP. The vendor identifier assigned by IANA to 3GPP (http://www.iana.org/assignments/enterprise-numbers) is 10415. The SGmb application identifier value assigned by IANA is 16777292.\nThe SGmb application identifier value shall be included in the Auth-Application-Id AVP.\nThe BM-SC and the MBMS GW shall advertise the support of the SGmb application by including the value of the application identifier in the Auth-Application-Id AVP and the value of the 3GPP (10415) in the Vendor-Id AVP of the Capabilities-Exchange-Request and Capabilities-Exchange-Answer commands as specified in IETF RFC 6733 [111], i.e. as part of the Vendor-Specific-Application-Id AVP. The Capabilities-Exchange-Request and Capabilities-Exchange-Answer commands are specified in the Diameter Base Protocol.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "20.2\tMBMS session start / update/ stop",
                    "description": "",
                    "summary": "",
                    "text_content": "The MBMS session start shall be used by the BM-SC to trigger the bearer resource establishment and announce the arrival of data for a MBMS bearer service (along with the attributes of the data to be delivered e.g. QoS, MBMS service area, or MBMS-Cell-List) to every MBMS GW that will deliver the MBMS bearer service.\nThe MBMS session update shall be used by the BM-SC to trigger the update of MBMS session attributes in the affected MBMS GWs. The attributes that can be modified are the MBMS service area, the MBMS-Cell-List and the list of MBMS control plane nodes (MMEs, SGSNs).\nThe MBMS session stop shall be used by the BM-SC to indicate the end of the data stream for an MBMS bearer service to every MBMS GW that has been delivering the MBMS bearer service.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "20.2A\tMBMS heartbeat",
                    "description": "",
                    "summary": "",
                    "text_content": "The MBMS heartbeat procedure enables the BM-SC and MBMS GW to detect an SGmb path failure or the restart of the peer MBMS node, as specified in 3GPP TS 23.007 [104].\nThe use of this procedure shall be negotiated between the BM-SC and MBMS GW upon contacting the peer node for the first time.\nNOTE:\tThe MBMS Heartbeat procedure however applies per (BM-SC, MBMS GW) pair, i.e. not per MBMS session.\nWhen this procedure is applied, the BM-SC and MBMS GW shall detect an SGmb path failure or the restart of the peer MBMS node as specified in clause 29 of 3GPP TS 23.007 [104].\nThe BM-SC and MBMS GW shall maintain a local restart counter which shall be incremented monotonically whenever the MBMS node restarts with loss of previous states.\nThe MBMS heartbeat message shall include the Restart Counter AVP set to the local restart counter of the sending node. The Restart-Counter AVP may also be  included in any other SGmb messages e.g. if contacting the peer node for the first time or if the local restart counter has been incremented.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "20.3 \tMessage flows",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "20.3.1\tSession start procedure",
                            "text_content": "The BM-SC initiates the MBMS session start procedure when it is ready to send data. This informs the MBMS GW of the imminent start of the transmission and MBMS session attributes are provided to the MBMS GWs included in the list of downstream nodes in BM-SC. The bearer plane is allocated.\nBM-SC and MBMS GW shall at least support IP unicast encapsulation of IP multicast datagrams, which shall be default mode of sending user plane data. BM-SC may support IP multicast encapsulation of user plane IP multicast datagrams and MBMS GW also may support this mode of operation.\nThe MBMS Session Start procedure in Figure 20.3.1.1 illustrates the steps taken by the MBMS (Mobile Backhaul Management System) to initiate a session with a mobile network. The figure shows the MBMS server, which is responsible for managing the session, as well as the mobile network's network interface controller (NICA) and the mobile network's network control center (NCC). The MBMS server communicates with the NICA and NCC to establish the session, and the MBMS server also manages the session's parameters, such as the session ID and the session duration. The MBMS server also manages the session's security, ensuring that only authorized users can initiate the session.\nFigure 20.3.1.1: MBMS Session Start procedure\n1.\tThe BM-SC sends an RAR message to indicate the impending start of the transmission and to provide the session attributes to the MBMS GWs listed in the \"list of downstream nodes\" parameter of the corresponding MBMS Bearer Context. BM-SC may indicate to MBMS GW that BM-SC supports sending the user plane IP multicast data without IP unicast encapsulation. In such case BM-SC shall send multicast source address as specified by IETF RFC 4604 [73] and IETF RFC 4607 [74] and the user plane multicast destination address.\nIf IP unicast mode is used, the BM-SC shall also require the MBMS GW to select one UDP port for the reception of the user plane data for the related MBMS service (identified by TMGI and Flow ID).\nThe BM-SC may also indicate its intent to use IP multicast encapsulation of IP multicast datagrams across Sgi-mb. In this case, the BM-SC shall specify an Sgi-mb (transport) destination multicast IP address associated with the MBMS bearer context, as well as the source UDP port. The inclusion of these data shall mean IP multicast encapsulation of IP multicast datagram is the only offered multicast mode over Sgi-mb. The destination UDP port for IP multicast transport shall be fixed as port number 927. The BM-SC shall also specify the (transport) multicast source address.\nThe BM-SC shall indicate the M1 interface information of local MBMS information as specified in 3GPP TS 23.285 [112] if the BM-SC determines to use the local MBMS information.\n2.\tThe MBMS GW creates an MBMS Bearer Context, stores the session attributes in the MBMS Bearer Context, initiates session start procedure towards the MMEs/SGSNs in its list of MBMS control plane nodes and sends an RAA message to the BM-SC. In case MBMS GW receives BM-SC multicast source address, which indicates BM-SC support for both modes of sending user plane data, MBMS GW decides in which mode MBMS GW shall receive the user plane data. In case MBMS GW decides to receive unicast encapsulated data, then MBMS GW shall send own IP address for user plane to BM-SC and the MBMS GW shall also indicate the UDP port on which the user plane data shall be received. In case MBMS GW decides to receive IP multicast packets, then MBMS GW shall join the multicast group as specified by IETF RFC 4604 [73] and IETF RFC 4607 [74], and indicate to BM-SC about the decision. In case MBMS GW decides to use M1 interface information of local MBMS information, the MBMS GW skips the allocation procedure for IP multicast distribution.\nIf configured, the MBMS GW sends the RAA message after receiving the first session start response (when positive) message from any MME.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.3.2\tSession update procedure",
                            "text_content": "The BM-SC initiates the MBMS session update procedure when service attributes (e.g. Service Area, MBMS cell list, Access indicator or ARP) for an ongoing MBMS session shall be modified. The MBMS session update procedure update procedure is initiated towards one or more of the MBMS GWs in the list of downstream nodes in the BM-SC, according to the changes in the service area.\nNOTE:\tIn addition, when the MBMS Service Area for an ongoing broadcast session is changed in the BM-SC, then MBMS GW(s) may be added to, or removed from, the list of downstream nodes in the BM-SC. The BM-SC will initiate MBMS session start procedures or MBMS session stop procedures towards these MBMS GWs accordingly.\nThe attributes that can be modified by the RAR message are the MBMS Service Area, the MBMS-Cell-List, the ARP, the Access indicator and the list of MBMS control plane nodes (MMEs, SGSNs).\nWhen a session update message is received, the MBMS GW updates its MBMS Bearer Context accordingly and informs its downstream MMEs/SGSNs of the changed service attributes. If a list of MBMS control plane nodes (MMEs, SGSNs) is included in the session update message, MBMS GW shall initiate a session start procedure towards the new MMEs/SGSNs, and a session stop procedure towards the MMEs/SGSNs that have been removed from the list.\nThe MBMS Session Update procedure in Figure 20.3.2.1 illustrates the steps taken to update the session information in a Multi-Bank Multiple-Sided Mission-Critical System (MBMS). The figure shows a flowchart with various stages, including data collection, data processing, and data transmission. The MBMS is a critical component in mission-critical systems, ensuring the secure and reliable transmission of data.\nFigure 20.3.2.1: MBMS Session Update procedure\n1.\tThe BM-SC sends an RAR message to all MBMS GWs listed in the \"list of downstream nodes\" parameter of the affected MBMS Bearer Context to indicate that the MBMS session is updated.\n2.\tThe MBMS GW stores the new session attributes in the MBMS Bearer Context, initiates session start, session stop or session update procedure towards the MMEs/SGSNs in its list of MBMS control plane nodes and sends an RAA message to the BM-SC. An AAR message is not mandated for the SGmb application in response to an RAR- RAA command exchange.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.3.3\tSession stop procedure",
                            "text_content": "The BM-SC initiates the MBMS session stop procedure when it considers the MBMS session terminated. Typically this will happen when there is no more MBMS data expected to be transmitted for a sufficiently long period of time to justify the release of bearer plane resources in the network.\nThe MBMS (Multi-Band Multiservice Multicast) session stop procedure is depicted in Figure 20.3.3.1, illustrating the steps taken to terminate a session in a multi-service multicast network. The figure shows the MBMS session stop procedure, which involves the following steps:\n\n1. **Session Identification**: The MBMS session is identified by the sender and receiver.\n2. **Session Termination**: The sender sends a session termination message to the MBMS server.\n3. **Session Termination**: The MBMS server responds with a session termination message.\n4. **Session Termination**: The sender sends a session termination message to the MBMS server.\n5. **Session Termination**: The MBMS server responds with a session termination message.\n6. **Session Termination**: The sender sends a session termination message to the MBMS server.\n7. **Session Termination**: The MBMS server responds with a session termination message.\n8. **Session Termination**: The sender sends a session termination message to the MBMS server.\n9. **Session Termination**: The MBMS server responds with a session termination message.\n10. **Session Termination**: The sender sends a session\nFigure 20.3.3.1: MBMS Session Stop procedure\n1.\tThe BM-SC sends an RAR message to all MBMS GWs listed in the \"list of downstream nodes\" parameter of the affected MBMS Bearer Context to indicate that the MBMS session is terminated and the bearer plane resources can be released.\n2.\tThe MBMS GW releases the resources regarding the session and sends an RAA message to the BM-SC. An AAR message is not mandated for the SGmb application in response to an RAR- RAA command exchange.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.3.4 \tMBMS session termination (MBMS GW initiated)",
                            "text_content": "\nThe figure depicts MBMS session termination, showing the process of terminating a session in a multi-media broadcast system. The figure illustrates the various components involved, such as the MBMS (Media Broadcast Management System) and the session termination process. The figure also includes a diagram of the MBMS system, with the session termination process highlighted.\nFigure 20.3.4.1: MBMS session termination\n1.\tIn exceptional cases (e.g. resource pre-emption or timeout of the MBMS session), the MBMS GW may send an STR command to the BM-SC to initiate the termination of the Diameter session related to an MBMS bearer service. If a bearer plane had been established over SGi-mb for this MBMS bearer service, the bearer plane is released. If the MBMS GW detects the SGi-mb path failure as specified in subclause 20.3.2.1 of 3GPP TS 23.007 [104], the MBMS GW shall set the Termination-Cause to \"DIAMETER_LINK_BROKEN\" (see IETF RFC 6733 [111]) and shall include the Diagnostic-Info AVP set to \"User Plane Failure\" if it tears down the MBMS session as a result of detecting an SGi-mb path failure.\n2.\tThe BM-SC removes the Diameter session and confirms the operation by sending an STA message to the MBMS GW.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.3.5\tMBMS heartbeat procedure",
                            "text_content": "The BM-SC initiates the MBMS heartbeat procedure to detect a SGmb path failure or the restart of the MBMS GW as specified in 3GPP TS 23.007 [104].\n\nThe MBMS Heartbeat procedure initiated by the BM-SC in Figure 20.3.5.1 demonstrates the process of monitoring and controlling the heartbeat of a medical device. The procedure is initiated by the BM-SC, which is a critical component of the MBMS system, responsible for managing the heartbeat of the device. The procedure is initiated by the BM-SC, which is a critical component of the MBMS system, responsible for managing the heartbeat of the device. The procedure is initiated by the BM-SC, which is a critical component of the MBMS system, responsible for managing the heartbeat of the device.\nFigure 20.3.5.1: MBMS Heartbeat procedure initiated by the BM-SC\n1.\tThe BM-SC sends an RAR message to the MBMS GW and indicates this is a heartbeart request. The BM-SC also includes the Restart-Counter AVP set to its local restart counter.\n2.\tThe MBMS GW sends an RAA message to the BM-SC to acknowledge the heartbeat request. The MBMS GW also includes the Restart-Counter AVP set to its local restart counter.\nThe MBMS GW initiates the MBMS heartbeat procedure to detect a SGmb path failure or the restart of the BM-SC as specified in 3GPP TS 23.007 [104].\nThe MBMS Heartbeat procedure initiated by the MBMS GW in Figure 20.3.5.2 demonstrates the MBMS's ability to initiate a heartbeat procedure to ensure the proper functioning of the MBMS system. This procedure is crucial for maintaining the integrity of the MBMS system and ensuring its reliability.\nFigure 20.3.5.2: MBMS Heartbeat procedure initiated by the MBMS GW\n1.\tThe MBMS GW sends an RAR message to the BM-SC and indicates this is a heartbeart request. The MBMS GW also includes the Restart-Counter AVP set to its local restart counter.\n2.\tThe BM-SC sends an RAA message to the MBMS GW to acknowledge the heartbeat request. The BM-SC also includes the Restart-Counter AVP set to its local restart counter.\nIn the context of this procedure, the Diameter session shall be implicitly terminated, i.e. the client (server) shall behave as if the Auth-Session-State AVP was set to the value NO_STATE_MAINTAINED (1), as described in IETF RFC 6733 [111]. As a consequence, the server shall not maintain any state information about this session and the client shall not send any session termination request.\nNOTE:\tThe Auth-Session-State AVP is not included in the RAR/RAA message as this is not permitted by the Diameter base protocol. See IETF RFC 6733 [111].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "20.4\tSGmb Messages",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause defines the SGmb interface Diameter message.\nThe relevant AVPs that are of use for the SGmb interface are detailed in this clause. Other Diameter NASREQ (IETF RFC 7155 [120]) AVPs, even if their AVP flag rules is marked with \"M\", are not required for being compliant with the current specification.\nAll SGmb specific AVPs for SGmb are needed to be compliant to the SGmb interface unless otherwise stated.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "20.4.1\tRe-Auth-Request Command",
                            "text_content": "The Re-Auth-Request (RAR) command, defined in IETF RFC 6733 (DIAMETER BASE) [111], is indicated by the Command-Code set to 258 and the message flags’ ‘R’ bit set.\nThe relevant AVPs that are of use for the SGmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for SGmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nThe bold marked AVPs in the message format indicate new optional AVPs for SGmb, or modified existing AVPs.\nMessage Format:\n<RAR>  ::= < Diameter Header: 258, REQ, PXY >\n< Session-Id >\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Destination-Host }\n{ Auth-Application-Id }\n{ Re-Auth-Request-Type }\n[ Called-Station-Id ]\n[ Framed-IP-Address]\n[ Framed-IPv6-Prefix ]\n[ Framed-Interface-Id ]\n[ MBMS-Access-Indicator ]\n[ MBMS-StartStop-Indication ]\n[ MBMS-Service-Area ]\n[ QoS-Information ]\n[ MBMS-Session-Duration ]\n[ MBMS-Session-Identity ]\n[ MBMS-Session-Repetition-number ]\n[ TMGI ]\n* \t[ 3GPP-SGSN-Address ]\n* \t[ 3GPP-SGSN-IPv6-Address ]\n[ MBMS-Time-To-Data-Transfer ]\n[ MBMS-Data-Transfer-Start ]\n[ MBMS-Data-Transfer-Stop ]\n[ MBMS-Flags ]\n[ MBMS-User-Data-Mode-Indication ]\n[ MBMS-BMSC-SSM-IP-Address ]\n[ MBMS-BMSC-SSM-IPv6-Address ]\n[ MBMS-Flow-Identifier ]\n[ CN-IP-Multicast-Distribution ]\n[ MBMS-HC-Indicator ]\n[ MBMS-GW-UDP-Port-Indicator]\t; for IP unicast encapsulated user data\n[ MBMS-GW-SSM-IP-Address ]\t\t; for IP multicast encapsulated user data\n[ MBMS-GW-SSM-IPv6-Address ]\t; for IP multicast encapsulated user data\n[ MBMS-BMSC-SSM-UDP-Port ]\t\t; for IP multicast encapsulated user data\n[ MBMS-Cell-List ]\n[ Local-M1-Information ]\n[ Origin-State-Id ]\n*\t[ Proxy-Info ]\n*\t[ Route-Record ]\n*\t[ Supported-Features ]\n[ Restart-Counter ]\n\nFor the MBMS Session Start procedure, RAR is sent by the BM-SC to the MBMS GW(s) that will deliver the MBMS service when it is ready to send data. This is a request to activate all necessary bearer resources in the network for the transfer of MBMS data. The RAR message contains either an IPv4 address included in 3GPP-SGSN-Address AVP or an IPv6 address included in 3GPP-SGSN-IPv6-Address AVP for each participating MBMS control plane nodes (MMEs, SGSNs). The MBMS-Time-to-Data-Transfer AVP shall be included to indicate the expected time between the reception of the MBMS Session Start and the transmission of MBMS data flows. For E-UTRAN access, the RAR message may also contain the MBMS-Data-Transfer-Start AVP containing the absolute time stamp of the data delivery start. The RAR message shall also contain the MBMS-Service-Area AVP. If the MBMS Cell List feature is supported, or if the BM-SC does not yet know whether the MBMS-GW supports this feature, the RAR may contain the MBMS-Cell-List AVP. For the distributed MCE architectures, i.e. when the MCE is part of eNB as described in clause 15.1.1 in TS 36.300 [98], the MBMS-Data-Transfer-Start AVP should be used at MBSFN operation mode to ensure synchronized session control and to facilitate a graceful reallocation of resources for the MBSFN when needed. The RAR message shall also contain the Local-M1-Information AVP if the BM-SC determines to use the local MBMS information as specified in 3GPP TS 23.285 [112].\nThe MBMS-Flags AVP may provide specific control indications in relation to MBMS, e.g. whether the MBMS Session Start procedure is used to re-establish an MBMS session.\nFor the MBMS Session Update procedure, RAR is sent by the BM-SC in order for the MBMS GW(s) to update their session attributes. If the MBMS service area or the MBMS cell list needs to be changed, the MBMS-Service-Area AVP shall be included in the RAR. If the MBMS Cell List feature is supported and the MBMS cell list needs to be changed, the MBMS-Cell-List AVP shall also be included. If the MBMS-Service-Area AVP but no MBMS-Cell-List AVP is included, this shall indicate that any MBMS Cell List included in a previous RAR does no longer apply. If the Access indicator needs to be updated, it shall be included in the MBMS-Access-Indicator AVP. For E-UTRAN access, the RAR message may also contain the MBMS-Data-Transfer-Start AVP containing the absolute time stamp of the data delivery start. For the distributed MCE architectures, i.e. when the MCE is part of eNB as described in clause 15.1.1 in TS 36.300 [98], the MBMS-Data-Transfer-Start AVP should be used at MBSFN operation mode to ensure synchronized session control and to facilitate a graceful reallocation of resources for the MBSFN when needed. The MBMS-StartStop-Indication AVP with the value UPDATE shall be included. The MBMS-Time-To-Data-Transfer with AVP the value set to 0 shall be included. The MBMS-Session-Duration AVP shall be included to indicate the duration of the remaining part of the MBMS session. The 3GPP-SGSN-Address AVP and the 3GPP-SGSN-IPv6-Address AVP shall be included if the related lists of MBMS control plane nodes (MMEs, SGSNs) in the MBMS GW(s) have changed. If the ARP needs to be changed, the QoS-Information AVP shall be included. The other bold marked AVPs shall be included as given by the previous, corresponding MBMS Session Start procedure.\nFor the MBMS Session Stop procedure, RAR is sent by the BM-SC to the MBMS GW(s) when it considers the MBMS session to be terminated. The session is typically terminated when there is no more MBMS data expected to be transmitted for a sufficiently long period of time to justify a release of bearer plane resources in the network. For E-UTRAN access, the RAR message may also contain the MBMS-Data-Transfer-Stop AVP containing the absolute time stamp of the data delivery stop. The MBMS-Flags AVP may provide specific control indications, e.g. whether the MBMS Session Stop procedure is used to release the MBMS bearer context locally.\nFor the MBMS Session Start procedure, the Qos-Information AVP indicates the QoS that is required for the MBMS bearer service for the actual MBMS session. Only the QoS-Class-Identifier AVP, Max-Requested-Bandwidth-DL AVP, Guaranteed-Bitrate-DL AVP and Allocation-Retention-Priority AVP within the QoS-Information AVP are applicable for the MBMS bearer service. The MBMS-Service-Area AVP is passed from BM-SC transparently through MBMS GW to the MMEs/SGSN(s) that are relevant for the actual MBMS bearer service. The MBMS-Cell-List AVP is also passed transparently through MBMS GW to the MMEs. The MBMS-Access-Indicator AVP indicates in which radio access types the MBMS bearer service shall be broadcasted, i.e UTRAN, or E-UTRAN, or both.\nThe usage of MBMS-StartStop-Indication AVP, Session-Id AVP, Framed-IP-Address AVP, Framed-IPv6-Prefix AVP, Framed-Interface-Id AVP, Called-Station-Id AVP and MBMS-Flow-Identifier AVP can refer to Gmb interface as described in clause 17.6.5.\nIf unicast mode is used, the MBMS GW shall select an IP unicast address and a destination UDP port that is unique within the MBMS GW or that IP unicast address.\nIf IP multicast encapsulation of application IP multicast datagram is used over Sgi-mb, the BM-SC shall select a source UDP port that is unique within the BM-SC for that IP multicast address.\nFor the MBMS Heartbeat procedure, RAR is sent by the BM-SC to the MBMS GW, or vice-versa. The RAR message shall contain the following AVPs:\n-\tthe MBMS-StartStop-Indication AVP set to the value \"heartbeat\";\n-\tthe Restart-Counter AVP set to the local restart counter of the sender.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.4.2\tRE-Auth-Answer Command",
                            "text_content": "The Re-Auth-Answer (RAA) command, defined in IETF RFC 6733 (DIAMETER BASE) [111], is indicated by the Command-Code set to 258 and the message flags’ ‘R’ bit clear, is sent in response to the RAR.\nThe relevant AVPs that are of use for the SGmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for SGmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nThe bold marked AVPs in the message format indicate new optional AVPs for SGmb, or modified existing AVPs.\nMessage Format:\n<RAA>  ::= < Diameter Header: 258, PXY >\n< Session-Id >\n{ Origin-Host }\n{ Origin-Realm }\n[ Result-Code ]\n[ Experimental-Result ]\n[ MBMS-StartStop-Indication ]\n[ MBMS-GGSN-Address ]             ; for unicast encapsulated user data\n[ MBMS-GGSN-Ipv6-Address ]        ; for unicast encapsulated user data\n[ MBMS-User-Data-Mode-Indication ]\n[ MBMS-GW-UDP-Port]               ; for unicast encapsulated user data\n[ Origin-State-Id ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n*\t[ Redirected-Host ]\n[ Redirected-Host-Usage ]\n[ Redirected-Host-Cache-Time ]\n[ Proxy-Info ]\n*\t[ Supported-Features ]\n[ Restart-Counter ]\n\nFor the MBMS Heartbeat procedure, RAA is sent by the BM-SC to the MBMS GW, or vice-versa. The RAA message shall contain the following AVPs:\n-\tthe MBMS-StartStop-Indication AVP set to the value \"heartbeat\";\n-\tthe Restart-Counter AVP set to the local restart counter of the sender.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.4.3\t\tSession-Termination-Request Command",
                            "text_content": "A DIAMETER session may be terminated by the MBMS GW in exceptional cases.\nThe relevant AVPs that are of use for the SGmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for SGmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nMessage Format:\n<ST-Request> ::= < Diameter Header: 275, REQ, PXY >\n< Session-Id >\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Auth-Application-Id }\n{ Termination-Cause }\n[ Destination-Host ]\n*\t[ Class ]\n[ Origin-State-Id ]\n*\t[ Proxy-Info ]\n*\t[ Route-Record ]\n[ Diagnostic-Info ]\n[ Restart-Counter ]\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.4.4\t\tSession-Termination-Answer Command",
                            "text_content": "The STA command, defined in IETF RFC 6733 (DIAMETER BASE) [111], is indicated by the Command-Code field set to 275 and the ‘R’ bit cleared in the Command Flags field, is sent in response to an STR command.\nThe relevant AVPs that are of use for the SGmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for SGmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nMessage Format:\n<ST-Answer>  ::= < Diameter Header: 275, PXY >\n< Session-Id >\n{ Result-Code }\n{ Origin-Host }\n{ Origin-Realm }\n*\t[ Class ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n[ Origin-State-Id ]\n*\t[ Redirect-Host ]\n[ Redirect-Host-Usage ]\n[ Redirect-Max-Cache-Time ]\n*\t[ Proxy-Info ]\n[ Restart-Counter ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.4.5\tAbort-Session-Request Command",
                            "text_content": "The Abort-Session-Request (ASR) command, defined in IETF RFC 6733 (DIAMETER BASE) [111], is indicated by the Command-Code set to 274 and the message flags’ ‘R’ bit set, is sent by the BM-SC to the MBMS GW to request that the session identified by the Session-Id be stopped.\nThe relevant AVPs that are of use for the SGmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for SGmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nMessage Format\n<ASR>  ::= \t< Diameter Header: 274, REQ, PXY >\n< Session-Id >\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Destination-Host }\n{ Auth-Application-Id }\n[ Origin-State-Id ]\n*\t[ Proxy-Info ]\n*\t[ Route-Record ]\n[ Restart-Counter ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.4.6\tAbort-Session-Answer Command",
                            "text_content": "The Abort-Session-Answer (ASA) command, defined in IETF RFC 6733 (DIAMETER BASE) [111], is indicated by the Command-Code set to 274 and the message flags’ ‘R’ bit clear, is sent in response to the ASR.\nThe relevant AVPs that are of use for the SGmb interface are detailed in the ABNF description below. Other valid AVPs for this command are not used for SGmb purposes and should be ignored by the receiver or processed according to the relevant specifications.\nMessage Format\n<ASA>  ::= < Diameter Header: 274, PXY >\n< Session-Id >\n{ Result-Code }\n{ Origin-Host }\n{ Origin-Realm }\n[ Origin-State-Id ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n*\t[ Redirected-Host ]\n[ Redirected-Host-Usage ]\n[ Redirect-Max-Cache-Time ]\n*\t[ Proxy-Info ]\n[ Restart-Counter ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "20.5\t\tSGmb re-used AVPs",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 20.5.1 lists the Diameter AVPs re-used by the SGmb reference point from the Gmb reference point and other existing Diameter Application, reference to their respective specifications and short description of their usage witin the SGmb reference point. When reused from Gmb reference point, the specific clause in the present specification is referred. Other AVPs from existing Diameter Applications, except for the AVPs from Diameter base protocol, do not need to be supported. The AVPs from Diameter base protocol are not included in table 20.5.1, but they are re-used for the SGmb reference point. Where RADIUS VSAs are re-used, they shall be translated to Diameter AVPs as described in RFC 7155 [120] with the exception that the ‘M’ flag shall be set and the ‘P’ flag may be set.\nTable 20.5.1 : SGmb re-used Diameter AVPs\n\n",
                    "tables": [
                        {
                            "description": "Table 20.5.1 : SGmb re-used Diameter AVPs",
                            "table number": 60,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "20.5a\t\tSGmb specific AVPs",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 20.5a.1 describes the SGmb specific Diameter AVPs. The Vendor-Id header of all SGmb specific AVPs defined in the present specification shall be set to 3GPP (10415).\nThe SGmb specific AVPs require to be supported to be compliant with the present specification. All AVPs in table 20.5a.1 are mandatory within SGmb interface unless otherwise stated.\nTable 20.5a.1: SGmb specific AVPs\n\n",
                    "tables": [
                        {
                            "description": "Table 20.5a.1: SGmb specific AVPs",
                            "table number": 61,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "20.5a.1\tMBMS-Access-Indicator AVP",
                            "text_content": "The MBMS-Access-Indicator AVP (AVP code 923) is of type Enumerated. It indicates whether the MBMS bearer service will be delivered in UTRAN-only, E-UTRAN-only or both coverage areas. The following values are supported:\nUTRAN (0)\nThe MBMS bearer service shall only be delivered in UTRAN only coverage areas.\nE-UTRAN (1)\nThe MBMS bearer service shall only be delivered in E-UTRAN only coverage areas.\nUTRAN-AND-E-UTRAN (2)\nThe MBMS bearer service shall be delivered both in UTRAN and E-UTRAN coverage areas.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.5a.2\tMBMS-GW-SSM-IP-Address AVP",
                            "text_content": "The MBMS-GW-SSM-IP-Address AVP (AVP code 924) is of type OctetString and contains the Sgi-mb (transport) plane IPv4 destination multicast address used by BM-SC for IP multicast encapsulation of application IP multicast datagrams.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.5a.3\tMBMS-GW-SSM-IPv6-Address AVP",
                            "text_content": "The MBMS-GW-SSM-IPv6-Address AVP (AVP code 925) is of type OctetString and contains the Sgi-mb (transport) plane IPv6 prefix of the destination multicast address used by BM-SC for IP multicast encapsulation of application IP multicast datagrams.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.5a.4\tMBMS-BMSC-SSM-UDP-Port AVP",
                            "text_content": "The MBMS-BMSC-SSM-UDP-Port AVP (AVP code 926) is of type OctetString and contains the Sgi-mb (transport) plane source UDP port number at the BM-SC for IP multicast encapsulation of IP multicast datagrams.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.5a.5\tMBMS-GW-UDP-Port AVP",
                            "text_content": "The MBMS-GW-UDP-Port AVP (AVP code 927) is of type OctetString, and contains the value of the UDP port from which the user plane data will be received in the MBMS-GW.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.5a.6\tMBMS-GW-UDP-Port-Indicator AVP",
                            "text_content": "MBMS-GW-UDP-Port-Indicator AVP (AVP code 928) is of type Enumerated. It indicates that the payload related to the MBMS service is required to be delivered in the MBMS UDP Port assigned by the MBMS-GW.\nUDP-PORT-REQUIRED (1)\nValue 1 indicates that the user plane data corresponding to the MBMS service shall be delivered on the UDP Port provided by the MBMS-GW.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.5a.7\tMBMS-Data-Transfer-Start AVP",
                            "text_content": "The MBMS-Data-Transfer-Start AVP (AVP code 929) is of type Unsigned64.\nThis value indicates the time in seconds for the radio resources set up relative to 00:00:00 on 1 January 1900 (calculated as continuous time without leap seconds and traceable to a common time reference) where binary encoding of the integer part is in the first 32 bits and binary encoding of the fraction part in the last 32 bits. The fraction part is expressed with a granularity of 1 /2**32 second.\nThis AVP is only valid for E-UTRAN access type.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.5a.8\tMBMS-Data-Transfer-Stop AVP",
                            "text_content": "The MBMS-Data-Transfer-Stop AVP (AVP code 930) is of type Unsigned64.\nThis value indicates the time in seconds for the release of resources relative to 00:00:00 on 1 January 1900 (calculated as continuous time without leap seconds and traceable to a common time reference) where binary encoding of the integer part is in the first 32 bits and binary encoding of the fraction part in the last 32 bits. The fraction part is expressed with a granularity of 1 /2**32 second.\nThis AVP is only valid for E-UTRAN access type.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.5a.9\tMBMS-Flags AVP",
                            "text_content": "The MBMS-Flags AVP (AVP coce 931) is of type Unsigned32. It provides control indications.\nIt shall contain a bit mask. The meaning of the bits shall be as defined in table 20.5a.9.1:\nTable 20.5a.9.1 : MBMS-Flags\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 20.5a.9.1 : MBMS-Flags",
                                    "table number": 62,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "20.5a.10\tRestart-Counter AVP",
                            "text_content": "The Restart-Conter AVP (AVP coce 932) is of type Unsigned32. This is a monotonically increasing value that is advanced whenever the MBMS entity restarts with loss of previous state, for example upon restart. The Restart-Counter AVP may be included in any Diameter message over the SGmb reference point, including CER/CEA.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "20.5a.11\tDiagnostic-Info AVP",
                            "text_content": "The Diagnostic-Info AVP (AVP code 933) is of type Unsigned32.\nIt shall contain a bit mask. The meaning of the bits shall be as defined in table 20.5a.11.1:\nTable 20.5a.11.1 : Diagnostic-Info\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 20.5a.11.1 : Diagnostic-Info",
                                    "table number": 63,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "20.5a.12\tMBMS-Cell-List AVP",
                            "text_content": "The MBMS-Cell-List AVP (AVP code 934) is of type OctetString. It contains the MBMS Cell Listthat the E-UTRAN uses to determine a set of radio resources to be used for the broadcast. Based on the cell ID list, the set of radio resources selected may be reduced from the full set of resources defined by the MBMS service area.\nThe AVP shall consist of two octets indicating the number of cell identifiers in the list, followed by a sequence of maximum 4096 cell identifiers, coded as E-CGIs.\n\nThe ECGI and its semantics are defined in subclause 19.6 of 3GPP TS 23.003 [40].\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 64,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "20.6\tSGmb specific Experimental-Result-Code AVP values",
                    "description": "",
                    "summary": "",
                    "text_content": "The same codes specified in clause 17.8 apply here except DIAMETER_ERROR_UNKNOWN_MBMS_BEARER_SERVICE (5122)\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "20.7\tUse of the Supported-Features AVP on the SGmb reference point",
                    "description": "",
                    "summary": "",
                    "text_content": "The Supported-Features AVP is used during session establishment to inform the destination host about the required and optional features that the origin host supports. The client shall, in the first request in a Diameter session indicate the set of supported features. The server shall, in the first answer within the Diameter session indicate the set of features that it has in common with the client and that the server shall support within the same Diameter session. Any further command messages shall always be compliant with the list of supported features indicated in the Supported-Features AVPs during session establishment. Features that are not advertised as supported shall not be used to construct the command messages for that Diameter session. Unless otherwise stated, the use of the Supported-Features AVP on the SGmb reference point shall be compliant with the requirements for dynamic discovery of supported features and associated error handling on the Cx reference point as defined in clause 7.2.1 of 3GPP TS 29.229 [105].\nThe base functionality for the SGmb reference point is the 3GPP Rel-11 standard and a feature is an extension to that functionality. If the origin host does not support any features beyond the base functionality, the Supported-Features AVP may be absent from the SGmb commands. As defined in clause 7.1.1 of 3GPP TS 29.229 [105], when extending the application by adding new AVPs for a feature, the new AVPs shall have the M bit cleared and the AVP shall not be defined mandatory in the command ABNF.\nAs defined in 3GPP TS 29.229 [105], the Supported-Features AVP is of type grouped and contains the Vendor-Id, Feature-List-ID and Feature-List AVPs. On the SGmb reference point, the Supported-Features AVP is used to identify features that have been defined by 3GPP and hence, for features defined in this document, the Vendor-Id AVP shall contain the vendor ID of 3GPP (10415). If there are multiple feature lists defined for the SGmb reference point, the Feature-List-ID AVP shall differentiate those lists from one another.\nOn receiving an initial request application message, the destination host shall act as defined in clause 7.2.1 of 3GPP TS 29.229 [105]. The following exceptions apply to the initial RAR/RAA command pair:\n-\tIf the BM-SC supporting post-Rel-11 SGmb functionality is able to interoperate with a MBMS GW supporting Rel-11, the RAR shall include the features supported by the BM-SC within Supported-Features AVP(s) with the ‘M’ bit cleared. Otherwise, the RAR shall include the supported features within the Supported-Features AVP(s) with the M-bit set.\nNOTE 1:\tOne instance of Supported-Features AVP is needed per Feature-List-ID.\n-\tIf the RAR command does not contain any Supported-Features AVP(s) and the MBMS GW supports Rel-11 SGmb functionality, the RAA command shall not include the Supported-Features AVP. In this case, both BM-SC and MBMS GW shall behave as specified in the Rel-11 version of this document.\n-\tIf the RAR command contains the Supported-Features AVP, the MBMS GW shall include the Supported-Features AVP in the RAA command, with the ‘M’ bit cleared, indicating only the features that both the BM-SC and MBMS GW support.\nNOTE 2:\tThe client will always declare all features that are supported according to table 20.7.1. When more than one feature identifying a release is supported by both BM-SC and MBMS GW, the BM-SC will work according to the latest common supported release.\nOnce the BM-SC and MBMS GW have negotiated the set of supported features during session establishment, the set of common features shall be used during the lifetime of the Diameter session.\nThe table below defines the features applicable to the SGmb interface for the feature list with a Feature-List-ID of 1.\nTable 20.7.1: Features of Feature-List-ID 1 used in SGmb\n\nVoid.\n",
                    "tables": [
                        {
                            "description": "Table 20.7.1: Features of Feature-List-ID 1 used in SGmb",
                            "table number": 65,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "B.1\tGeneral",
            "description": "The present annex defines specific requirements for rate control related to CIoT optimisations.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.2\tSupport of rate control of user data",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "B.2.0\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The rate of user data sent to and from a UE (e.g. a UE using CIoT EPS Optimizations) can be controlled in two different ways:\n-\tServing PLMN rate control\n-\tAPN rate control\nServing PLMN rate control is further described in 3GPP TS 23.401 [77].\nThe APN rate control parameters are a part of the configuration data stored in the GGSN/PGW and is configured on per APN basis.\nAPN rate control allows HPLMN operators on per APN and user to control the amount of user data sent DL and UL.\nThis is done with help of policing user data on a maximum number of user data packets per time unit both DL and UL. APN rate control DL policing is done in the GGSN/PGW or the SCEF and the APN rate control policing UL is done in the UE. The GGSN/PGW or SCEF can also do APN rate control UL policing.\nFor further information on APN rate control UL in the UE, see 3GPP TS 24.301 [84].\nFor further information on APN rate control in the SCEF, see 3GPP TS 29.128 [110].\nNOTE:\tExisting AMBR mechanisms are not suitable for such a service since, for radio efficiency and UE battery life reasons, an AMBR of e.g. > 100kbit/s is desirable and such an AMBR translates to a potentially large daily data volume.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "B.2.1\tAPN Rate Control in the PGW",
                    "description": "",
                    "summary": "",
                    "text_content": "To enable APN rate control it shall be configured in the PGW per APN.\nThe APN rate control parameters, if configured, shall consist of:\n-\tthe maximum number of DL user data packets per time unit,\n-\tthe maximum number of UL user data packets per time unit,\n-\tan indication whether the UE is allowed to send additional exception reports when the limit for the UL APN rate control has been reached , and\n-\tif UE supports it, the maximum number of additional UL exception reports per time unit.\nPossible time units shall be, minute, hour, day or week.\n\nIf the UE does not indicate APN rate control support, the GGSN/PGW may refrain from providing APN rate control information to the UE.\nNOTE 1:\tThe UE indicates support for APN rate control with help of an indicator in the Protocol Configuration Options IE (PCO IE) or the Extended Protocol Configuration Options IE (ePCO IE), see 3GPP TS 24.008 [54] or 3GPP TS 24.301 [84] for IE definition. The APN rate control indicator within the PCO/ePCO IE is received at IP-CAN session establishment.\nNOTE 2:\tThe UE and network support of the ePCO IE, is indicated with help of the Indication IE. The ePCO support indication within the Indication IE can be received at IP-CAN session establishment or at IP-CAN session modification. See 3GPP TS 29.274 [81] for IE definition.\nIf the APN rate control is supported by the UE and the Indication IE is received indicating support of ePCO IE at the IP-CAN session establishment request and the PGW supports the ePCO IE, the PGW shall in the reply, if configured for the APN used, include APN UL rate control parameters in the ePCO IE, see 3GPP TS 24.008 [54] for IE definition.\nIf the ePCO IE is not supported the PGW shall use the PCO IE.\nThe GGSN shall use the PCO IE.\nIf the APN rate control UL parameter(s) is modified and the ePCO IE is supported, the PGW shall initiate an IP-CAN session modification procedure and include the APN UL rate control parameters in the ePCO IE. \nIf the ePCO IE is not supported the PGW shall use the PCO IE.\nThe GGSN shall use the PCO IE.\nThe GGSN/PGW shall enforce the APN rate control per UE and APN according to the configuration for DL and may enforce APN rate control for UL, e.g. when the PGW have indicated to the UE that the UE is not allowed to send exception reports when the limit for the UL APN rate control has been reached.\nNOTE 3:\tThe UE locally enforces this uplink APN rate control instruction. The UE considers this APN rate control instruction as valid until it receives a new one from the GGSN/PGW.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "B.2.2\tServing PLMN Rate Control information handling in the PGW",
                    "description": "",
                    "summary": "",
                    "text_content": "If Serving PLMN rate control information is received in the Serving PLMN Rate Control IE from the MME, the PGW shall store this information and use that for rate control enforcement DL for this UE.\nIf the PGW previously have received Serving PLMN rate control information, the PGW shall behave as follows:\n-\tIf the PGW receives new Serving PLMN rate control information in the Serving PLMN Rate Control IE from the MME, the PGW shall replace the old Serving PLMN rate control information with the new Serving PLMN rate control information and use that for rate control enforcement DL for this UE.\n-\tIf the PGW receives no Serving PLMN rate control information in the Serving PLMN Rate Control IE from the MME in an IP-CAN session establishment or an IP-CAN session modification , the PGW shall still consider the latest received Serving PLMN rate control information from the MME as valid.\n-\tIf PGW receives an indication that Serving PLMN rate control does not apply in the Serving PLMN Rate Control IE, the PGW shall remove the rate control information based on Serving PLMN rate control information.\nSee 3GPP TS 29.274 [81] for Serving PLMN Rate Control IE definition.\nAPN rate control, if configured, also applies for the same IP-CAN session, see subclause B.2.1.\n\n\n",
                    "tables": [
                        {
                            "description": "",
                            "table number": 66,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        }
    ]
}