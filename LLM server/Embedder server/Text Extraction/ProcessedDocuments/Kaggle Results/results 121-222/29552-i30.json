{
    "document_name": "29552-i30.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\t\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\t\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\t\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\t\tindicates that something is possible\ncannot\t\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\t\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\t\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document specifies detailed call flows of Network Data Analytics over the Nnwdaf, Nsmf, Npcf, Nnsacf, Namf, Nnrf, Nnssf, Nnef, Naf, Ndccf, Nadrf, Nmfaf, Nudm, Nupf and Ngmlc service-based interfaces and their relationship with the flow level signalling in 5G system.\nNOTE:\tThe call flows depicted in this Technical Specification do not cover all traffic cases.\nThe stage 2 definition and procedures of Network Data Analytics are contained in 3GPP TS 23.288 [2] and 3GPP TS 23.502 [3]. The 5G System Architecture is defined in 3GPP TS 23.501 [4].\nDetailed definitions of the involved services are provided in 3GPP TS 29.520 [5], 3GPP TS 29.508 [6], 3GPP TS 29.523 [7], 3GPP TS 29.554 [8], 3GPP TS 29.521 [9], 3GPP TS 29.522 [10], 3GPP TS 29.591 [11], 3GPP TS 29.517 [12], 3GPP TS 29.574 [15], 3GPP TS 29.575 [16], 3GPP TS 29.576 [17], 3GPP TS 29.503 [22], 3GPP TS 29.510 [23], 3GPP TS 29.507 [24], 3GPP TS 29.512 [25], 3GPP TS 29.564 [40] and 3GPP TS 29.515 [41].\nThe Technical Realization of the Service Based Architecture and the Principles and Guidelines for Services Definition of the 5G System are specified in 3GPP TS 29.500 [13] and 3GPP TS 29.501 [14].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.288: \"Architecture enhancements for 5G System (5GS) to support network data analytics services\".\n[3]\t3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".\n[4]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[5]\t3GPP TS 29.520: \"5G System; Network Data Analytics Services; Stage 3\".\n[6]\t3GPP TS 29.508: \"5G System; Session Management Event Exposure Service; Stage 3\".\n[7]\t3GPP TS 29.523: \"5G System; Policy Control Event Exposure Service; Stage 3\".\n[8]\t3GPP TS 29.554: \"5G System; Background Data Transfer Policy Control Service; Stage 3\".\n[9]\t3GPP TS 29.521: \"5G System; Binding Support Management Service; Stage 3\".\n[10]\t3GPP TS 29.522: \"5G System; Network Exposure Function Northbound APIs; Stage 3\".\n[11]\t3GPP TS 29.591: \"5G System; Network Exposure Function Southbound Services; Stage 3\".\n[12]\t3GPP TS 29.517: \"5G System; Application Function Event Exposure Service; Stage 3\".\n[13]\t3GPP TS 29.500: \"5G System; Technical Realization of Service Based Architecture; Stage 3\".\n[14]\t3GPP TS 29.501: \"5G System; Principles and Guidelines for Services Definition; Stage 3\".\n[15]\t3GPP TS 29.574: \"5G System; Data Collection Coordination Services; Stage 3\".\n[16]\t3GPP TS 29.575: \"5G System; Analytics Data Repository Services; Stage 3\".\n[17]\t3GPP TS 29.576: \"5G System; Messaging Framework Adaptor Services; Stage 3\".\n[18]\t3GPP TS 29.518: \"5G System; Access and Mobility Management Services; Stage 3\".\n[19]\t3GPP TS 28.532: \"Management and orchestration; Generic management services\".\n[20]\t3GPP TS 29.536: \"5G System: Network Slice Admission Control Services; Stage 3\".\n[21]\t3GPP TS 29.531: \"5G System: Network Slice Selection Services; Stage 3\".\n[22]\t3GPP TS 29.503: \"5G System; Unified Data Management Services; Stage 3\".\n[23]\t3GPP TS 29.510: \"5G System; Network Function Repository Services; Stage 3\".\n[24]\t3GPP TS 29.507: \"5G System; Access and Mobility Policy Control Service; Stage 3\".\n[25]\t3GPP TS 29.512: \"5G System; Session Management Policy Control Service; Stage 3\".\n[26]\t3GPP TS 29.510: \"5G System: Network function repository services; Stage 3\".\n[27]\t3GPP TS 28.552: \"Management and orchestration; 5G performance measurements\".\n[28]\t3GPP TS 28.533: \"Management and orchestration; Architecture framework\".\n[29]\t3GPP TS 37.320: \" Radio measurement collection for Minimization of Drive Tests (MDT); Overall description\".\n[30]\t3GPP TS 28.554: \" Management and orchestration; 5G end to end Key Performance Indicators (KPI)\".\n[31]\t3GPP TS 28.550: \"Management and orchestration; Performance assurance\".\n[32]\tVoid.\n[33]\t3GPP TS 38.331: \"NR; Radio Resource Control (RRC) protocol specification\".\n[34]\t3GPP TS 36.331: \"Radio Resource Control (RRC); Protocol specification\".\n[35]\t3GPP TS 38.215: \"NR; Physical layer measurements\".\n[36]\t3GPP TS 28.310: \"Management and orchestration; Energy efficiency of 5G\".\n[37]\t3GPP TS 28.545: \"Management and orchestration; Fault Supervision (FS)\".\n[38]\t3GPP TS 28.104: \"Management and orchestration; Management Data Analytics (MDA)\".\n[39]\t3GPP TS 29.551: \"5G System; Packet Flow Description Management Service; Stage 3\".\n[40]\t3GPP TS 29.564: \"5G System; User Plane Function Services; Stage 3\".\n[41]\t3GPP TS 29.515: \"5G System; Gateway Mobile Location Services; Stage 3\".\n[42]\t3GPP TS 28.622: \"Generic Network Resource Model (NRM)Integration Reference Point (IRP); Information Service (IS)\".\n[43]\t3GPP TS 32.422: \"Subscriber and equipment trace; Trace control and configuration management\".\n[44]\t3GPP TS 28.537: \"Management and orchestration; Management capabilities\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tSymbols",
                    "description": "",
                    "summary": "",
                    "text_content": "None.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.3\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\nADRF\tAnalytics Data Repository Function\nAF\tApplication Function\nAMF \tAccess and Mobility Management Function\nAnLF\tAnalytics Logical Function\nCEF\tCharging Enablement Function\nDCCF\tData Collection Coordination Function\nFL\tFederated Learning\nGMLC\tGateway Mobile Location Centre\nLMF\tLocation Management Function\nMDAF\tManagement Data Analytics Function\nMDT\tMinimization of Drive Tests\nMFAF\tMessaging Framework Adaptor Function\nML\tMachine Learning\nMTLF\tModel Training Logical Function\nNEF\tNetwork Exposure Function\nNRF\tNetwork Repository Function\nNSACF\tNetwork Slice Admission Control Function\nNSSF\tNetwork Slice Selection Function\nNWDAF\tNetwork Data Analytics Function\nOAM\tOperation, Administration, and Maintenance\nPCF\tPolicy Control Function\nRE-NWDAF\tRoaming Exchange NWDAF\nSMF\tSession Management Function\nUDM\tUnified Data Management\nUPF\tUser Plane Function\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tReference Architecture for Data Analytics",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "For the enablement of network data analytics services, the NWDAF interacts with different entities for different purposes:\n-\tData Collection:\na)\tcollecting Data from OAM, MDAF and/or 5GC NFs (e.g. AMF);\nb)\tcollecting Data from untrusted AF via NEF; and/or\nc)\tcollecting Analytics and/or Data from 5GC NFs via DCCF or via DCCF together with ADRF and/or MFAF or via NWDAF hosting DCCF i.e. an NWDAF that implements DCCF functionality internally and supports the Nnwdaf_DataManagement API for collecting data, the Nnwdaf_EventSubscription API for collecting analytics;\n-\tAnalytics Exposure:\na)\tExposing Analytics to 5GC NFs;\nb)\tExposing Analytics to untrusted AF via NEF; and/or\nc)\tExposing Analytics to 5GC NFs via DCCF or via DCCF together with ADRF and/or MFAF or via NWDAF hosting DCCF and/or ADRF i.e. an NWDAF that implements DCCF and/or ADRF functionality internally and supports the Nnwdaf_EventSubscription API;\n-\tStoring and Retrieving data in ADRF.\nThe entities mentioned above interact also with each other as described in the procedures of clause 5.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tData Collection",
                    "description": "",
                    "summary": "",
                    "text_content": "As depicted in Figure 4.2-1, the 5G System architecture allows NWDAF to collect data from any 5GC NF (e.g. AMF, SMF), OAM and/or MDAF directly or via DCCF, DCCF together with ADRF and/or MFAF, or via NWDAF in non-roaming case. The roaming architecture for data collection is defined in clause 4.5.\n\nFigure 4.2-1: Data Collection Architecture\nWhen DCCF, ADRF, MFAF or NWDAF hosting DCCF are present in the network, whether the NWDAF directly contacts the Data Source NF or goes via the DCCF, or NWDAF hosting DCCF is based on configuration of the NWDAF.\nThe Data Source NF may be AMF, SMF, UDM, UPF, GMLC, AF, NSACF, NRF and/or NEF with the related data collection procedures described in clause 5.5. If the Data Source is OAM, the NWDAF may collect relevant management data from the services in the OAM as configured by the PLMN operator with NG RAN or 5GC performance measurements as defined in TS 28.552 [27] and 5G End to end KPIs as defined in TS 28.554 [30]. The NWDAF may use the OAM services e.g. generic performance assurance and fault supervision management services as defined in TS 28.532 [19], PM (Performance Management) services as defined in TS 28.550 [31] and/or FS (Fault Supervision) services as defined in TS 28.545 [37]. The procedure for data collection from OAM is defined in clause 6.2.3.2 of TS 23.288 [2]. The NWDAF may collect the analysis results from MDAF, e.g. service experience and energy saving state analysis and/or end-to-end latency analysis in TS 28.104 [38]. The procedure for analytics collection from MDAF is defined in clause 6.2.14.2 of TS 23.288 [2]. Before NWDAF requests analytics from the MDA Management Function, the NWDAF firstly discovers the MDAF via the MnS discovery service producer as defined in clause 5 of TS 28.537 [42].\nFor the specific analytics event, the applicable Data Source NF(s) and the related data collection procedures and scope are described in the corresponding analytics event subclause within clause 5.7.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.3\tAnalytics Exposure",
                    "description": "",
                    "summary": "",
                    "text_content": "As depicted in Figure 4.3-1, the 5G System architecture allows NWDAF to expose data to any 5GC NF (e.g. AMF) directly or via DCCF/MFAF in non-roaming case. For roaming case, the roaming architecture as described in clause 4.5 is added between HPLMN and VPLMN.\nThe figure depicts a detailed analysis of the telecommunication architecture, specifically focusing on the exposing architecture. It illustrates the various components and their interconnections, highlighting the importance of network performance and reliability. The figure is a crucial visual aid for understanding the complex network structure and its components, which are essential for designing, implementing, and maintaining telecommunication networks.\nFigure 4.3-1: Analytics Exposing Architecture\nWhen DCCF, ADRF, MFAF or NWDAF are present in the network, whether the Analytics consumer directly contacts the NWDAF or goes via the DCCF or via the NWDAF hosting DCCF and/or ADRF is based on configuration of the Analytics consumer.\nThe Analytics consumer may be AMF, SMF, NSSF, PCF, LMF, AF, NEF, OAM and/or CEF when directly contacts NWDAF with the related analytics exposure procedures described in clause 5.2.2 and clause 5.2.3. The Analytics consumers may be AMF, SMF, NSSF, PCF, LMF, AF and/or NEF when contacts via the DCCF with the related analytics exposure procedures described in clause 5.2.4 and clause 5.2.5.\nFor the specific analytics event, the applicable Analytics consumer(s) and the related analytics exposure procedures and scope are descibed in the corresponding analytics event subcluase within clause 5.7.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.4\tData Storage and Retrieval",
                    "description": "",
                    "summary": "",
                    "text_content": "As depicted in Figure 4.4-1, the 5G System architecture allows the consumer to store and retrieve the collected data in the ADRF directly or via DCCF/MFAF.\nThe figure depicts a data storage and retrieval architecture, illustrating the various components and their interconnections. The architecture includes data storage nodes, data retrieval nodes, and a network interface controller (NIC). The figure illustrates the use of network virtualization and data replication to ensure data availability and reliability.\nFigure 4.4-1: Data Storage and Retrieval Architecture\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.5\tRoaming architecture for data collection and analytics exposure",
                    "description": "",
                    "summary": "",
                    "text_content": "Based on operator's policy and local regulations (e.g. privacy), data or analytics may be exchanged between PLMNs (i.e. HPLMN and VPLMN) via RE-NWDAF (i.e. an NWDAF with roaming exchange capability in each PLMN used as exchange point to exchange data and/or analytics with other PLMNs) using the architecture shown in Figure 4.5-1.\nThe figure depicts a roaming architecture for exchanging data or analytics between V-PLMN and H-PLMN. It illustrates the various paths and components involved in the data exchange, including the use of roaming access points (RAPs) and the exchange of data between the two PLMNs. The figure highlights the importance of network slicing and network virtualization in enabling efficient data exchange and analytics between different network segments.\nFigure 4.5-1: Roaming Architecture to exchange Data or Analytics between V-PLMN and H-PLMN\nIn roaming scenario, the H-RE-NWDAF is the enforcement point to check user consent. The H-RE-NWDAF retrieves the roaming-related user consent for a user from the UDM.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5\tSignalling Flows for the Network Data Analytics Framework",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes the Network Data Analytics related Signalling Flows, including the procedures for analytics exposure, analytics aggregation from multiple NWDAFs, analytics context and analytics subscription transferring between different NWDAFs, ML model provisioning, data collection, specified Network Data Analytics generation and the NWDAF discovery and selection. The specific NF service operations which are used in these procedures are also provided in the procedure descriptions.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.2\tAnalytics Exposure Procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tGeneral",
                            "text_content": "The analytics exposure procedures allow the NF service consumers (i.e. NFs, OAM and AFs) to obtain the analytics information from the NWDAF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tNetwork data analytics Subscribe/Unsubscribe/Notify",
                            "text_content": "This procedure is used in non-roaming case by the NF service consumers (i.e. NFs, OAM and AFs) to subscribe to/unsubscribe from analytics information directly from the NWDAF, it is also used by the NWDAF to notify the observed analytics event(s) to the NF service consumer if subscribed before.\nThe figure depicts a network architecture with various components, including 5G Core Network Functions (5GC NFs), Optical Access Multiplexers (OAMs), and Aggregated Forwarding Units (AFs). It illustrates the flow of data between the core network and the access network, highlighting the importance of network slicing and network slicing functions (NSF) in managing network resources and ensuring efficient data transmission.\nFigure 5.2.2.1-1: Analytics Subscribe/Unsubscribe/Notify initiated by 5GC NFs, OAM or AFs\n1.\tIn order to subscribe to notification(s) of analytics information from the NWDAF, the NF service consumer invokes Nnwdaf_EventsSubscription_Subscribe service operation by sending an HTTP POST request targeting the resource \"NWDAF Events Subscriptions\". The request includes the subscribed events and may include event filter information.\nIn order to update the existing subscription, the NF service consumer invokes Nnwdaf_EventsSubscription_Subscribe service operation by sending an HTTP PUT request with Resource URI of the resource \"Individual NWDAF Event Subscription\".\n2.\tThe NWDAF responds to the Nnwdaf_EventsSubscription_Subscribe service operation. Upon receipt of the HTTP POST request, if the subscription is accepted to be created, the NWDAF responds to the NF service consumer with \"201 Created\", and the URI of the created subscription is included in the Location header field.\nUpon receipt of the HTTP PUT request, if the subscription is accepted to be updated, the NWDAF responds to the NF service consumer with \"200 OK\" or \"204 No Content\"\n3.\tIf the NWDAF observes the subscribed event(s), the NWDAF invokes Nnwdaf_EventsSubscription_Notify service operation to report the event(s) by sending an HTTP POST request with {notificationURI} as Notification URI. When calculating accuracy information for the analytics or the ML model for which analytics feedback information has been received, in addition to comparing predictions of ML model and its corresponding ground truth data, the NWDAF may additionally determine and take into account whether the action(s) taken by the NF service consumer affects the ground truth data corresponding to Analytics ID requested at the time which the prediction refers to as described in the procedures for Analytics Accuracy Monitoring and ML Model Accuracy Monitoring, which may affect the accuracy calculation.\nEditor's Note: It is FFS to move the specification of this behaviour to the procedures for Analytics Accuracy Monitoring and ML Model Accuracy Monitoring if the latter are agreed and added to the specification.\n4.\tThe NF service consumer sends an HTTP \"204 No Content\" response to the NWDAF.\n5.\tIn order to unsubscribe to the notification(s) of analytics information from the NWDAF, the NF service consumer invokes Nnwdaf_EventsSubscription_Unsubscribe service operation by sending an HTTP DELETE request targeting the resource \"Individual NWDAF Event Subscription\", to the NWDAF to unsubscribe from analytics information. The request includes the event subscriptionId of the existing subscription that is to be deleted.\n6.\tThe NWDAF responds to the Nnwdaf_EventsSubscription_Unsubscribe service operation. If the unsubscription is accepted, the NWDAF responds with \"204 No Content\".\nNOTE:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify service operations refer to 3GPP TS 29.520 [5].\nThis procedure is used by the AF to subscribe to/unsubscribe from analytics information from the NWDAF via the NEF, it is also used by the NWDAF to notify the analytics event(s) to the AF via the NEF, if subscribed before.\nThe figure depicts a network architecture with various elements such as base stations (BUs), user equipment (UE), and network elements (NE). It illustrates the communication paths and the role of each component in the network. The figure also shows the use of network functions virtualization (NFV) to enable efficient network management and automation. The architecture is designed to support analytics, subscriber management, and notification services, which are essential for enhancing the user experience and ensuring network reliability.\nFigure 5.2.2.2-1: Analytics Subscribe/Unsubscribe/Notify initiated by AFs via the NEF\n1.\tIn order to subscribe to notification(s) of analytics exposure via the NEF, the AF invokes the Nnef_AnalyticsExposure_Subscribe request by sending an HTTP POST request message targeting the resource \"Analytics Exposure Subscriptions\" as defined in clause 4.4.14.1 of 3GPP TS 29.522 [10].\nIn order to update an existing analytics exposure subscription, the AF shall send an HTTP PUT request message to the NEF to the resource \"Individual Analytics Exposure Subscription\" requesting to change the subscription.\n2.\tUpon receipt of the HTTP request from the AF, if the AF is authorized with the requested analytics event(s) and the requested parameters comply with the inbound restriction in the analytics exposure mapping, the NEF shall invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in step 1 in clause 5.2.2.1.\n3.\tThe NWDAF responds to the Nnwdaf_EventsSubscription_Subscribe service operation as described in step 2 in clause 5.2.2.1.\n4.\tUpon receipt of the HTTP request response from the NWDAF, the NEF shall invoke the Nnef_AnalyticsExposure_Subscribe response message by mapping and forwarding the response to the AF.\n5.\tIf the NWDAF observes the subscribed event(s), the NWDAF invokes Nnwdaf_EventsSubscription_Notify service operation as described in step 3 in clause 5.2.2.1 to the NEF. When calculating accuracy information for the analytics or the ML model for which analytics feedback information has been received, in addition to comparing predictions of ML model and its corresponding ground truth data, the NWDAF may additionally determine and take into account whether the action(s) taken by the AF affects the ground truth data corresponding to Analytics ID requested at the time which the prediction refers to as described in the procedures for Analytics Accuracy Monitoring and ML Model Accuracy Monitoring, which may affect the accuracy calculation.\nEditor's Note: It is FFS to move the specification of this behaviour to the procedures for Analytics Accuracy Monitoring and ML Model Accuracy Monitoring if the latter are agreed and added to the specification.\n6.\tIf the NEF receives an analytics information notification from the NWDAF indicating that the subscribed analytics event has been detected, the NEF shall invoke the Nnef_AnalyticsExposure_Notify request by sending HTTP POST request message provide a notification to the AF request including the AnalyticsEventNotification data structure at least with the detected analytics event identified by the notification URI together with the notification correlation identifier received during creation of the Individual Analytics Exposure Subscription.\n7.\tUpon receipt of the analytics event notification, the AF shall respond the NEF with a \"204 No Content\" status code to confirm the received notification in Nnef_AnalyticsExposure_Notify response message.\n8.\tThe NEF shall forward the HTTP \"204 No Content\" response to the NWDAF.\n9.\tIn order to delete an existing analytics exposure subscription, the AF shall invoke the Nnef_AnalyticsExposure_Unsubscribe request by sending an HTTP DELETE request message to the NEF to the resource \"Individual Analytics Exposure Subscription\".\n10.\tIf the NEF receives an HTTP DELETE request from the AF, the NEF shall invoke the Nnwdaf_EventsSubscription_Unsubscribe service operation as described in step 5 in clause 5.2.2.1.\n11.\tThe NWDAF responds to the Nnwdaf_EventsSubscription_Unsubscribe service operation as described in step 6 in clause 5.2.2.1.\n12.\tThe NEF shall forward the HTTP \"204 No Content\" response to the AF.\nNOTE:\tDetails of AnalyticsExposure API refer to clause 4.4.14 and clause 5.6 of 3GPP TS 29.522 [4].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.3\tNetwork data analytics information request",
                            "text_content": "This procedure is used in non-roaming case by the NF service consumers (i.e. 5GC NFs, OAM and AFs) to retrieve analytics information directly from the NWDAF. The analytics architecture for analytics exposure is defined in clause 4.5.\nThe figure depicts a network data analytics info request procedure, illustrating the steps involved in requesting information from the network. The figure includes a flowchart with arrows indicating the sequence of actions, such as selecting the network, initiating the request, and receiving the response. The figure also includes a legend to clarify the different types of data that can be requested, such as network statistics, network performance, and network security. The figure is a visual representation of the process, making it easy to understand and follow.\nFigure 5.2.3.1-1: Network data analytics info request procedure\n1.\tThe NF Service Consumer invokes Nnwdaf_AnalyticsInfo_Request service operation by sending an HTTP GET request targeting the resource \"NWDAF Analytics\", to the NWDAF to request the analytics information. The request includes analytics identifier and related event filter information.\n2.\tThe NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation. If the request is accepted, the response includes the requested analytics information with \"200 OK\".\nNOTE:\tFor details of Nnwdaf_AnalyticsInfo_Request service operation refer to 3GPP TS 29.520 [5].\nThis procedure is used by the AFs to retrieve analytics information from the NWDAF via the NEF.\nThe figure depicts a network architecture with various elements such as base stations (BTS), user equipment (UE), and optical fiber components. It illustrates the multi-path signal propagation in a 5G network, highlighting the role of beamforming techniques to mitigate interference. The figure also shows the fiber-optic backbone architecture, with core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are depicted in dashed lines, ensuring failover reliability. The layered design aligns with SDN principles.\nFigure 5.2.3.2-1: Analytics Request initiated by AFs via the NEF\n1.\tIn order to fetch analytics information, the AF invoke the Nnef_AnalyticsExposure_Fetch request by sending an HTTP POST request message to the NEF to the customized operation URI \"{apiRoot}/3gpp-analyticsexposure/v1/fetch\" as defined in clause 4.4.14.2 of 3GPP TS 29.522 [10].\n2.\tUpon receipt of the HTTP request from the AF, if the AF is authorized with the requested analytics event(s) and the requested parameters comply with the inbound restriction in the analytics exposure mapping, the NEF shall invoke the Nnwdaf_AnalyticsInfo_Request service operation as described in step 1 in clause 5.2.3.1.\n3.\tThe NWDAF responds with the analytics information as described in step 2 in clause 5.2.3.1 to the NEF.\n4.\tThe NEF responds with the analytics information to the AF.\nNOTE:\tDetails of AnalyticsExposure API refer to clause 4.4.14 and clause 5.6 of 3GPP TS 29.522 [4].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.4\tAnalytics Exposure via DCCF",
                            "text_content": "This procedure is used by NF service consumer(s) based on local configuration, to subscribe/unsubscribe to NWDAF analytics event(s) via the DCCF, and upon the delivery option \"Delivery via DCCF\" configured on the DCCF, also used by DCCF to notify the NF service consumer(s) of the analytics information via the DCCF if subscribed before.\nThe figure depicts a 4-1-2-1 network with 4 data centers (DCs) and 1 cloud computing facility (CFC). The network is designed to provide analytics services to users, with 4 DCs serving as data centers and 1 CFC as a cloud computing facility. The network is designed to provide high availability and scalability, with 4 DCs serving as data centers and 1 CFC as a cloud computing facility. The network is designed to provide high availability and scalability, with 4 DCs serving as data centers and 1 CFC as a cloud computing facility.\nFigure 5.2.4-1: Analytics Exposure via DCCF\n1.\tIn order to subscribe to notification(s) of analytics exposure via the DCCF based on local configuration, the NF service consumer invokes the Ndccf_DataManagement_Subscribe service operation by sending an HTTP POST request message targeting the resource \"DCCF Analytics Subscriptions\", the HTTP POST message shall include the NdccfAnalyticsSubscription data structure as request body with parameters as defined in clause 5.1.6.2.2 of 3GPP TS 29.574 [15].\n2.\tThe DCCF keeps track of the analytics actively being collected for the Analytics Subscription it is coordinating. The NWDAF or ADRF may register the analytics data profile (may include the analytics data related service operation, Analytics Specification, NWDAF ID or ADRF ID) with the DCCF. The DCCF may then determine whether certain historical analytics data may be available in the NWDAF or ADRF based on the analytics data profile and the request time window.\nIf the historical analytics data handling is not applicable or not supported, the DCCF shall proceed step 3a, skip step 3b, step 4b, step 5b, step 3c, step 4c and step 5c.\nIf the historical analytics data is available in an ADRF, the DCCF shall proceed step 3a and step 3b, skip step 3c, step 4c and step 5c.\nIf the historical analytics data is available in an NWDAF, the DCCF shall proceed step 3a and step 3c, skip step 3b, step 4b and step 5b.\n3a.\tThe DCCF shall determine whether the analytics requested are already being collected.\nIf the requested analytics are already being collected by an NF service consumer, the DCCF adds the new NF service consumer to the list of NF service consumers that are subscribed for these analytics.\nIf the DCCF cannot handle the subscription request, shall take the error handling as defined in clause 4.2.2.2.2 of 3GPP TS 29.574 [15]\nIf the DCCF determines that no subscriptions need to be created or modified (e.g. because all the data can be made available either via pre-existing subscriptions or because of the historical data handling) then step 4a and step 5a are skipped.\n3aa.\tThe DCCF may respond to the Ndccf_DataManagement_Subscribe service operation with HTTP \"201 Created\" status code with the message body containing a representation of the created subscription if the DCCF add the new NF service consumer to the list of NF service consumers that are subscribed, or if error case happened may respond with corresponding error information.\n4a\tIf the analytics requested at step 1 are not already available yet, the DCCF shall invoke the Nnwdaf_EventsSubscription_Subscribe service operation by sending an HTTP POST request message request to the NWDAF targeting the resource \"NWDAF Events Subscriptions\" to subscribe to a new analytics exposure subscription, or if the analytics subscribed in step 1 partially matches an analytics that is already being collected by the DCCF from an NWDAF, and a modification of this subscription to the NWDAF would satisfy both the existing analytics subscriptions as well as the newly requested analytics, by sending an HTTP PUT request to the resource \"Individual Analytics Exposure Subscription\" to replace an existing analytics exposure subscription. The request includes the subscribed event(s) and event filter information received from the NF service consumer, mapping to the parameters as defined in clause 5.1 of 3GPP TS 29.520 [5].\nNOTE:\tIf the NWDAF instance or NWDAF Set is not identified by the NF service consumer, the DCCF determines the NWDAF instances that can provide analytics. If the consumer requested storage of analytics in an ADRF but an ADRF ID is not provided by the NF service consumer, or the collected analytics is to be stored in an ADRF according to configuration on the DCCF, the DCCF selects an ADRF to store the collected analytics data.\n5a\tThe NWDAF responds to the Nnwdaf_EventsSubscription_Subscribe service operation.\nUpon receipt of the HTTP POST request, if the subscription is accepted to be created, the NWDAF responds to the DCCF with \"201 Created\" status code, and the URI of the created subscription is included in the Location header field.\nUpon receipt of the HTTP PUT request, if the subscription is accepted to be updated, the NWDAF responds to the DCCF with \"200 OK\" or \"204 No Content\" status code.\n3b\tIf the historical analytics data handling is applicable, and the DCCF determine to retrieve analytics data from the ADRF, the DCCF shall determine which ADRF instances might provide the analytics.\n4b\tIn order to retrieve the historical analytics data from the ADRF, the DCCF shall invoke the Nadrf_DataManagement_RetrievalSubscribe service operation by sending an HTTP POST request message targeting the resource \"ADRF Data Retrieval Subscriptions\", the HTTP POST message shall include the NadrfDataRetrievalSubscription data structure as request body with parameters as defined in clause 5.1.6 of 3GPP TS 29.575 [16].\n5b\tThe ADRF responds to the Nadrf_DataManagement_RetrievalSubscribe service operation.\nUpon receipt of the HTTP POST request, if the subscription is accepted to be created, the ADRF responds to the DCCF with \"201 Created\" status code, and the URI of the created subscription is included in the Location header field.\n3c\tIf the historical analytics data handling is applicable, and the DCCF determine to retrieve analytics data from the NWDAF, the DCCF shall determine which NWDAF instances might provide the analytics as described and proceed step 4c.\n4c\tIn order to retrieve the historical analytics data from the NWDAF, the DCCF may invoke the Nnwdaf_EventsSubscription_Subscribe service operation by sending an HTTP POST request message targeting the resource \"NWDAF Events Subscriptions\", the HTTP POST message shall include the NnwdafEventsSubscription data structure as request body with parameters as defined in clause 5.1.6 of 3GPP TS 29.520 [5] or Nnwdaf_AnalyticsInfo_Request request by sending an HTTP GET request message targeting the resource \"NWDAF Analytics\" with parameters as defined in clause 5.2.3.2.3.1 of 3GPP TS 29.520 [5].\n5c\tThe NWDAF responds to the Nnwdaf_EventsSubscription_Subscribe or Nnwdaf_AnalyticsInfo_Request service operation.\nUpon receipt of the HTTP POST request, if the subscription is accepted to be created, the NWDAF responds to the DCCF with \"201 Created\" status code, and the URI of the created subscription is included in the Location header field.\n6.\tThe DCCF responds to the Ndccf_DataManagement_Subscribe service operation with HTTP \"201 Created\" status code with the message body containing a representation of the created subscription.\n7a.\t(conditional)When the analytics are available, the NWDAF invokes the Nnwdaf_EventsSubscription_Notify service operation by sending an HTTP POST request message to notify the analytics information to the DCCF.\n8a.\tThe DCCF responds to the Nnwdaf_EventsSubscription_Notify service operation with HTTP \"204 No Content\" status code.\n7b.\t(conditional)When the historical analytics data are available in the ADRF, the ADRF shall invoke the Nadrf_DataManagement_RetrievalNotify service operation by sending an HTTP POST request message to notify the historical analytics or Fetch Instructions to the DCCF.\n8b.\tThe DCCF responds to the Nadrf_DataManagement_RetrievalNotify service operation with HTTP \"204 No Content\" status code.\n7c.\t(conditional)When the historical analytics data are available in the NWDAF, the NWDAF may invoke the Nnwdaf_EventsSubscription_Notify service operation by sending an HTTP POST request message to notify the historical analytics data to the DCCF.\n8c.\tThe DCCF responds to the Nnwdaf_EventsSubscription_Notify service operation with HTTP \"204 No Content\" status code.\n9.\tUpon the delivery option \"Delivery via DCCF\" configured on the DCCF. the DCCF invokes the Ndccf_DataManagement_Notify service operation by sending HTTP POST request message(s) to send the analytics data to all notification endpoints indicated in step 1. Analytics sent to notification endpoints may be processed and formatted by the DCCF so they conform to delivery requirements for each NF service consumer or notification endpoint.\nNOTE:\tAccording to Formatting Instructions provided by the NF service consumer, multiple notifications from a NWDAF can be combined in a single Ndccf_DataManagement_Notify so many notifications from an NWDAF results in fewer notifications (or one notification) to the NF service consumer. Alternatively, a notification can instruct the analytics notification endpoint to fetch the analytics from the DCCF.\n10.\t\tThe NF service consumer responds to the Ndccf_DataManagement_Notify service operation with HTTP \"204 No Content\" status code.\n11.\t(conditional) The NF service consumer invokes the Ndccf_DataManagement_Fetch service operation by sending an HTTP GET request message to fetch the analytics from the DCCF before an expiry time, if received the fetch instruction in NdccfDataManagement_Notify service operation in step 9.\n12.\tThe NF service consumer responds to the Ndccf_DataManagement_Fetch service operation with HTTP \"204 No Content\" status code.\n13.\tWhen the NF service consumer no longer need the subscription to the analytics requested in step 1, shall invoke the Ndccf_DataManagement_Unsubscribe service operation by sending an HTTP DELETE request message with \"{xxx}\" as Resource URI, where \"{subscriptionId}\" is the event subscriptionId of the existing subscription that is to be deleted., using the Subscription Correlation Id received in response to its subscription in step 1. The DCCF removes the NF service consumer from the list of NF service consumers that are subscribed for these analytics.\n14.\tThe DCCF responds to the Ndccf_DataManagement_Unsubscribe service operation with HTTP \"204 No Content\" status code, upon removed the NF service consumer from the list of NF service consumers that are subscribed for these analytics\n15a.\tIf there are no other NF service consumers subscribed to the analytics, the DCCF invokes the Nnwdaf_EventsSubscription_Unsubscribe service operation by sending an HTTP DELETE request message to the NWDAF.\n16a.\tThe NWDAF responds to the Nnwdaf_EventsSubscription_Unsubscribe service operation with HTTP \"204 No Content\" status code, upon the analytics event(s) subscription is removed.\n15b.\tIf DCCF determines that no other NF service consumers requiring the historical analytics data from the ADRF, the DCCF may invoke the Nadrf_DataManagement_RetrievalUnSubscribe service operation by sending an HTTP DELETE request message to the ADRF.\n16b.\tThe ADRF responds to the Nadrf_DataManagement_RetrievalUnSubscribe service operation with HTTP \"204 No Content\" status code, upon the analytics data retrieval subscription is removed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.5\tAnalytics Exposure via DCCF and MFAF",
                            "text_content": "This procedure is used by NF service consumer(s) based on local configuration, to subscribe/unsubscribe to NWDAF analytics event(s) via the DCCF, and upon the delivery option \"Delivery via Messaging Framework \" configured on the DCCF, the 3GPP DCCF Adaptor (3da) Data Management service and 3GPP Consumer Adaptor (3ca) Data Management service of the Messaging Framework Adaptor Function (MFAF) are used to interact with the 3GPP Network and the Messaging Framework for analytics information delivery to the NF service consumer(s) subscribed notification endpoint(s).\nThe figure depicts a network architecture with various components, including DCCF (Data Center Communication Framework) and Messaging Framework, which are essential for analyzing and managing data traffic in a telecommunications network. The DCCF is used for data center-to-data center communication, while the Messaging Framework is used for data center-to-telecom network communication. The figure illustrates the flow of data through these components, highlighting the importance of proper network design and management for efficient data transmission and analysis.\nFigure 5.2.5-1: Analytics Exposure via DCCF and Messaging Framework\n1.\tIn order to subscribe to notification(s) of analytics exposure via the DCCF based on local configuration, the NF service consumer invokes the Ndccf_DataManagement_Subscribe service operation by sending an HTTP POST request message targeting the resource \"DCCF Analytics Subscriptions\", the HTTP POST message shall include the NdccfAnalyticsSubscription data structure as request body with parameters as defined in clause 5.1.6.2.2 of 3GPP TS 29.574 [15].\n2.\tUpon the delivery option \"Delivery via MFAF\" configured on the DCCF, in order to create configuration of mapping data in the MFAF, the DCCF shall invoke the Nmfaf_3daDataManagement_Configure service operation by sending an HTTP POST request message targeting the resource \"MFAF Configurations\", the HTTP POST message shall include the MfafConfiguration data structure as request body with parameters as defined in clause 5.1.6 of 3GPP TS 29.576 [17].\n3.\tThe MFAF responds to the Nmfaf_3daDataManagement_Configure service operation.\nUpon receipt of the HTTP POST request, if the configuration is accepted to be created, the MFAF responds to the DCCF with \"201 Created\", and the URI of the created configuration is included in the Location header field.\n4.\tThe DCCF keeps track of the analytics actively being collected for the Analytics Subscription it is coordinating. The NWDAF or ADRF may register the analytics data profile (may include the analytics data collection related service operation, Analytics Specification, NWDAF ID or ADRF ID) with the DCCF. The DCCF may then determine whether certain historical analytics data may be available in the NWDAF or ADRF based on the analytics data profile and the request time window.\nIf the historical analytics data handling is not applicable or not supported, the DCCF shall proceed step 5a, skip step 5b step 6b, step 7b, step 5c step 6c and step 7c.\nIf the historical analytics data is available in an ADRF, the DCCF shall proceed step 5a and step 5b, skip step 5c, step 6c and step 7c.\nIf the historical data is available in an NWDAF, the DCCF shall proceed step 5a and step 5c, skip step 5b, step 6b and step 7b.\n5a.\tThe DCCF shall determine whether the analytics data requested in step 1 are already being collected.\nIf the analytics data requested are already being collected by an NF service consumer, the DCCF adds the NF service consumer to the list of analytics consumers that are subscribed for these data.\nIf the DCCF cannot handle the subscription request, shall take the error handling as defined in clause 4.2.2.2.2 of 3GPP TS 29.574 [15]\nIf the DCCF determines that no subscriptions need to be created or modified (e.g. because all the data can be made available either via pre-existing subscriptions or because of the historical data handling) then step 6a and step 7a are skipped.\n5aa.\tThe DCCF may respond to the Ndccf_DataManagement_Subscribe service operation with HTTP \"201 Created\" status code with the message body containing a representation of the created subscription if the DCCF adds the new NF service consumer to the list of NF service consumers that are subscribed, or if error case happened may respond with corresponding error information.\n6a\tIf the requested data at step 1 are not already available yet, the DCCF shall invoke the Nnwdaf_EventsSubscription_Subscribe service operation by sending an HTTP POST request message request to the NWDAF targeting the resource \"NWDAF Events Subscriptions\" to subscribe to a new analytics exposure subscription, or if the analytics subscribed in step 1 partially matches an analytics that is already being collected by the DCCF from an NWDAF, and a modification of this subscription to the NWDAF would satisfy both the existing analytics subscriptions as well as the newly requested analytics, by sending an HTTP PUT request to the resource \"Individual Analytics Exposure Subscription\" to replace an existing analytics exposure subscription. The request includes the subscribed event(s) and event filter information received from the NF service consumer, mapping to the parameters as defined in clause 5.1 of 3GPP TS 29.520 [5].\nNOTE 1:\tIf the NWDAF instance or NWDAF Set is not identified by the NF service consumer, the DCCF determines the NWDAF instances that can provide analytics. If the consumer requested storage of analytics in an ADRF but an ADRF ID is not provided by the NF service consumer, or the collected analytics is to be stored in an ADRF according to configuration on the DCCF, the DCCF selects an ADRF to store the collected data.\n7a\tThe NWDAF responds to the Nnwdaf_EventsSubscription_Subscribe service operation.\nUpon receipt of the HTTP POST request, if the subscription is accepted to be created, the NWDAF responds to the DCCF with \"201 Created\" status code, and the URI of the created subscription is included in the Location header field.\nUpon receipt of the HTTP PUT request, if the subscription is accepted to be updated, the NWDAF responds to the DCCF with \"200 OK\" or \"204 No Content\" status code.\n5b\tIf the historical analytics data handling is applicable, and the DCCF determine to retrieve analytics data from the ADRF, the DCCF shall determine which ADRF instances might provide the analytics.\n6b\tIn order to retrieve the historical analytics data from the ADRF, the DCCF shall invoke the Nadrf_DataManagement_RetrievalSubscribe service operation by sending an HTTP POST request message targeting the resource \"ADRF Data Retrieval Subscriptions\", the HTTP POST message shall include the NadrfDataRetrievalSubscription data structure as request body with parameters as defined in clause 5.1.6 of 3GPP TS 29.575 [16].\n7b\tThe ADRF responds to the Nadrf_DataManagement_RetrievalSubscribe service operation.\nUpon receipt of the HTTP POST request, if the subscription is accepted to be created, the ADRF responds to the DCCF with \"201 Created\" status code, and the URI of the created subscription is included in the Location header field.\n5c\tIf the historical data handling is applicable, and the DCCF determines to retrieve analytics data from the NWDAF, the DCCF shall determine which NWDAF instances might provide the analytics as described and proceed step 6c.\n6c\tIn order to retrieve the historical analytics data from the NWDAF, the DCCF may invoke the Nnwdaf_EventsSubscription_Subscribe service operation by sending an HTTP POST request message targeting the resource \"NWDAF Events Subscriptions\", the HTTP POST message shall include the NnwdafEventsSubscription data structure as request body with parameters as defined in clause 5.1.6 of 3GPP TS 29.520 [5] or Nnwdaf_AnalyticsInfo_Request request by sending an HTTP GET request message targeting the resource \"NWDAF Analytics\" with parameters as defined in clause 5.2.3.2.3.1 of 3GPP TS 29.520 [5].\n7c\tThe NWDAF responds to the Nnwdaf_EventsSubscription_Subscribe or Nnwdaf_AnalyticsInfo_Request service operation.\nUpon receipt of the HTTP POST request, if the subscription is accepted to be created, the NWDAF responds to the DCCF with \"201 Created\", and the URI of the created subscription is included in the Location header field.\n8.\tThe DCCF responds to the Ndccf_DataManagement_Subscribe service operation with HTTP \"201 Created\" status code with the message body containing a representation of the created subscription.\n9a.\t(conditional)When the analytics are available, the NWDAF invokes the Nnwdaf_EventsSubscription_Notify service operation by sending an HTTP POST request message to notify the analytics information to the MFAF.\n10a.\tThe MFAF responds to the Nnwdaf_EventsSubscription_Notify service operation with HTTP \"204 No Content\" status code.\n11a.\tThe MFAF invokes the Nmfaf_3caDataManagement_Notify service operation by sending HTTP POST request message(s) to send the analytics data to all notification endpoints indicated in step 1. Analytics data sent to notification endpoints may be processed and formatted by the MFAF so that they conform to delivery requirements for each NF service consumer and/or notification endpoint.\nNOTE 2:\tAccording to Formatting Instructions provided by the NF service consumer, multiple notifications from the NWDAF can be combined in a single Nmfaf_3caDataManagement_Notify so that many notifications from an NWDAF result in fewer notifications (or one notification) to the NF service consumer and/or the subscribed notification endpoint(s). Alternatively, a notification can instruct the analytics data notification endpoint to fetch the analytics data from the MFAF.\n12a.The NF service consumer responds to the Nmfaf_3caDataManagement_Notify service operation with HTTP \"204 No Content\" status code.\n9b.\t(conditional)When the historical analytics data are available in the ADRF, the ADRF shall invoke the Nadrf_DataManagement_RetrievalNotify service operation by sending an HTTP POST request message to notify the historical analytics or Fetch Instructions to the MFAF.\n10b.\tThe MFAF responds to the Nadrf_DataManagement_RetrievalNotify service operation with HTTP \"204 No Content\" status code.\n11b.\tThe MFAF invokes the Nmfaf_3caDataManagement_Notify service operation by sending HTTP POST request message(s) to send the analytics data to all notification endpoints indicated in step 1. Analytics data sent to notification endpoints may be processed and formatted by the MFAF so that they conform to delivery requirements for each NF service consumer or notification endpoint.\nNOTE 3:\tAccording to Formatting Instructions provided by the NF service consumer, multiple notifications from an ADRF can be combined in a single Nmfaf_3caDataManagement_Notify so many notifications from an ADRF results in fewer notifications (or one notification) to the NF service consumer and/or the subscribed notification endpoint(s). Alternatively, a notification can instruct the analytics data notification endpoint to fetch the analytics data from the MFAF.\n12b.The NF service consumer responds to the Nmfaf_3caDataManagement_Notify service operation with HTTP \"204 No Content\" status code.\n9c.\t(conditional)When the historical analytics data are available in the NWDAF, the NWDAF may invoke the Nnwdaf_EventsSubscription_Notify service operation by sending an HTTP POST request message to notify the historical analytics data to the MFAF.\n10c.\tThe MFAF responds to the Nnwdaf_EventsSubscription_Notify service operation with HTTP \"204 No Content\" status code.\n11c.\tThe MFAF invokes the Nmfaf_3caDataManagement_Notify service operation by sending HTTP POST request message(s) to send the analytics data to all notification endpoints indicated in step 1. Analytics data sent to notification endpoints may be processed and formatted by the MFAF so they conform to delivery requirements for each NF service consumer or notification endpoint.\nNOTE 4:\tAccording to Formatting Instructions provided by the NF service consumer, multiple notifications from a NWDAF can be combined in a single Nmfaf_3caDataManagement_Notify so many notifications from an NWDAF results in fewer notifications (or one notification) to the NF service consumer and/or the subscribed notification endpoint(s). Alternatively, a notification can instruct the analytics data notification endpoint to fetch the analytics data from the MFAF.\n12c.\tThe NF service consumer responds to the Nmfaf_3caDataManagement_Notify service operation with HTTP \"204 No Content\" status code.\n13.\t(conditional) The NF service consumer invoke the Nmfaf_3caDataManagement_Fetch service operation by sending an HTTP GET request message to fetch the data from the MFAF before an expiry time, if received the fetch instruction in Nmfaf_3caDataManagement_Notify service operation in step 11a, step 11b or step 11c.\n14.\tThe MFAF responds to the Nmfaf_3caDataManagement_Fetch service operation with HTTP \"200 OK\" status code with the message body containing the NmfafResourceRecord data structure.\n15.\tWhen the NF service consumer no longer need the subscription to the requested data in step 1, shall invoke the Ndccf_DataManagement_Unsubscribe service operation by sending an HTTP DELETE request message with \"{apiRoot}/nnwdaf-datamanagement/v1/subscriptions/{subscriptionId}\" as Resource URI, where \"{subscriptionId}\" is the event subscriptionId of the existing subscription that is to be deleted., using the Subscription Correlation Id received in response to its subscription in step 1. The DCCF removes the NF service consumer from the list of NF service consumers that are subscribed for these analytics data.\n16.\tThe DCCF responds to the Ndccf_DataManagement_Unsubscribe service operation with HTTP \"204 No Content\" status code, upon removed the NF service consumer from the list of NF service consumers that are subscribed for these analytics data.\n17a.\tIf there are no other NF service consumers subscribed to the analytics data, the DCCF invoke the Nnwdaf_EventsSubscription_Unsubscribe service operation by sending an HTTP DELETE request message to the NWDAF.\n18a.\tThe DWDAF responds to the Nnwdaf_EventsSubscription_Unsubscribe service operation with HTTP \"204 No Content\" status code, upon the analytics event(s) subscription is removed.\n17b.\tIf DCCF determines that no other NF service consumers requiring the historical analytics data from the ADRF, the DCCF may invoke the Nadrf_DataManagement_RetrievalUnSubscribe service operation by sending an HTTP DELETE request message to the ADRF.\n18b.\tThe ADRF responds to the Nadrf_DataManagement_RetrievalUnSubscribe service operation with HTTP \"204 No Content\" status code, upon the data retrieval subscription is removed.\n17c.\tWhen DCCF determines that NF service consumer mapping has to be removed from MFAF, the DCCF may invoke the Nmfaf_3daDataManagement_Deconfigure service operation by sending an HTTP DELETE request message to the MFAF.\n18c.\tThe MFAF responds to the Nmfaf_3daDataManagement_Deconfigure service operation with HTTP \"204 No Content\" status code, upon removing the individual resource linked to the delete request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.6\tProcedure for Analytics Exposure in Roaming Case",
                            "text_content": "The procedure depicted in Figure 5.2.6.1-1 is used by the V-RE-NWDAF as service consumer to subscribe/unsubscribe to notifications about analytics exposure from the HPLMN for inbound roaming users.\nThe figure depicts a procedure for analytics exposure from HPLMN to VPLMN, illustrating the steps involved in data transmission and analysis.\nFigure 5.2.6.1-1: Procedure for analytics exposure from HPLMN to VPLMN\n1.\tThe consumer NF in VPLMN (e.g. AMF) discovers a V-RE-NWDAF as described in clause 5.2.8.3 and invoke Nnwdaf_AnalyticsInfo_Request or Nnwdaf_EventsSubscription_Subscribe service operation to the V-RE-NWDAF. For the inbound roaming user(s) indicated in the Target of Analytics Reporting, V-RE-NWDAF determines based on operator configuration and the requested analytics whether analytics from the HPLMN are required, or the analytics can be derived locally.\nNOTE 1:\tIt is possible that the Target of Analytics Reporting sent by the Consumer NF to the V-RE-NWDAF includes both inbound roaming user(s) and non-roaming user(s).\n2.\tThe V-RE-NWDAF checks the roaming agreements related to analytics from HPLMN to determine if the roaming analytics request/subscribe can be accepted or must be rejected. If the request is rejected, the following steps are skipped.\nThe V-RE-NWDAF discovers a H-RE-NWDAF as described in clause 5.8.2.3 then invoke Nnwdaf_RoamingAnalytics_Request or Nnwdaf_RoamingAnalytics_Subscribe service operation as described in clause 4.9.2.2 and clause 4.9.2.3 of 3GPP TS 29.520 [5], based on the Analytics request/subscribe received from the Consumer NF in VPLMN. The Target of Analytics Reporting sent by the V-RE-NWDAF to the H-RE-NWDAF only contains the inbound roaming user(s).\nNOTE 2:\tThe inbound roaming user(s) are distinguished by the V-RE-NWDAF according to UE ID(s) (i.e. SUPI(s)).\n3.\tThe H-RE-NWDAF checks the roaming agreements between the HPLMN and the VPLMN, and user consent for analytics if needed, to determine if the roaming analytics request/subscribe can be accepted or must be rejected. If the roaming analytics request/subscribe is rejected, the following steps are skipped.\n3a\tIf the H-RE-NWDAF supports to generate the requested analytics, it collects data from the NF(s) and/or OAM in HPLMN and derives the requested analytics, respond with Nnwdaf_RoamingAnalytics_Request response or Nnwdaf_RoamingAnalytics_Subscribe response to the V-RE-NWDAF then responds to the consumer NF; otherwise steps 3b and 3c are executed.\n3b-3c.\t[Optional] If the H-RE-NWDAF does not support to generate the requested analytics, it may request/subscribe to other NWDAF(s) in the HPLMN (if available) by invoking Nnwdaf_AnalyticsInfo_Request or Nnwdaf_EventsSubscription_Subscribe service operation for the analytics and get corresponding response/notification by Nnwdaf_AnalyticsInfo_Request response, Nnwdaf_EventsSubscription_Subscribe response or Nnwdaf_EventsSubscription_Notify service operation.\n4.\tThe H-RE-NWDAF sends the HPLMN analytics information to the V-RE-NWDAF using either Nnwdaf_RoamingAnalytics_Request response, Nnwdaf_RoamingAnalytics_Subscribe response or Nnwdaf_RoamingAnalytics_Notify request message as described in clause 4.9.2.2 and clause 4.9.2.3 of 3GPP TS 29.520 [5], depending on the service used in step 2. The H-RE-NWDAF may restrict the exposed analytics information based on HPLMN operator polices.\n5.\tIf the Consumer NF also indicates request or subscription of analytics information available in the VPLMN (e.g. via Target of Analytics Reporting) in step 1, the V-RE-NWDAF collects data from the NF(s) and/or OAM in VPLMN and derives the requested analytics.\n6.\tThe V-RE-NWDAF sends the HPLMN analytics information received in step 4, or the aggregated analytics information if step 5 are performed, to the Consumer NF in VPLMN using either Nnwdaf_AnalyticsInfo_Request response, Nnwdaf_EventsSubscription_Subscribe or Nnwdaf_EventsSubscription_Notify request message described in clause 4.2.2 of 3GPP TS 29.520 [5] depending on the service used in step 1.\nNOTE 3:\tThe present document describes that the RE-NWDAF may perform analytics aggregation for roaming scenario, but whether and how the RE-NWDAF performs analytics aggregation for roaming scenario are up to implementation.\nNOTE 4:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify, Nnwdaf_AnalyticsInfo_Request and/or Nnwdaf_RoamingAnalytics_Subscribe/Unsubscribe/Notify/Request service operations refer to 3GPP TS 29.520 [5].\nThe procedure depicted in Figure 5.2.6.2-1 is used by the H-RE-NWDAF as service consumer to subscribe/unsubscribe to notifications about analytics exposure from the VPLMN for outbound roaming users.\nThe figure depicts a procedure for analytics exposure from VPLMN to HPLMN, illustrating the steps involved in data transmission and analysis.\nFigure 5.2.6.2-1: Procedure for analytics exposure from VPLMN to HPLMN\n1.\tUpon the Consumer NF is aware that the UE(s) indicated in Target of Analytics Reporting is/are roaming, Consumer NF in HPLMN (e.g. H-PCF) discovers a H-RE-NWDAF as described in clause 5.2.8.3 and invoking a Nnwdaf_AnalyticsInfo_Request or a Nnwdaf_EventsSubscription_Subscribe service operation. For the outbound roaming user(s) indicated in the Target of Analytics Reporting, the H-RE-NWDAF determines based on operator configuration and the requested analytics whether analytics or input data from the VPLMN are required, or the analytics can be derived locally.\nNOTE 1:\tIt is possible that the Target of Analytics Reporting sent by the Consumer NF to the H-RE-NWDAF includes both outbound roaming user(s) and non-roaming user(s).\nNOTE 2:\tThe H-NWDAF is not depicted in the flow.\n2.\tThe H-RE-NWDAF checks user consent and roaming agreements between the HPLMN and the VPLMN to determine if the roaming analytics request/subscription can be accepted or must be rejected. If the request is rejected, the following steps are skipped.\nThe H-RE-NWDAF discovers the V-RE-NWDAF as described in clause 5.2.8.3.\nThe H-RE-NWDAF invoke a Nnwdaf_RoamingAnalytics_Request or a Nnwdaf_RoamingAnalytics_Subscribe service operation, based on the Analytics request/subscribe received from the Consumer NF in HPLMN. The Target of Analytics Reporting sent by the H-RE-NWDAF to the V-RE-NWDAF only contains the outbound roaming user(s).\n3a.\tThe V-RE-NWDAF checks the roaming agreements between the HPLMN and the VPLMN, to determine if the roaming analytics request/subscribe can be accepted or must be rejected. If the roaming analytics request/subscribe is rejected, the following steps are skipped.\nIf the V-RE-NWDAF supports to generate the requested analytics, it collects data from the NF(s) serving the roaming UE(s) and/or OAM in VPLMN and derives the analytics; otherwise steps 3b and 3c are executed.\n3a1-3a2\tThe V-RE-NWDAF may respond with Nnwdaf_RoamingAnalytics_Request response or Nnwdaf_RoamingAnalytics_Subscribe response to the H-RE-NWDAF then responds to the consumer NF; otherwise steps 3b and 3c are executed.\n3b-3c.\tIf the V-RE-NWDAF does not support to generate the requested analytics, it may request/subscribe to other NWDAF(s) in the VPLMN (if available) for the analytics and get corresponding response/notification(s) by invoking Nnwdaf_AnalyticsInfo_Request or Nnwdaf_EventsSubscription_Subscribe service operation for the analytics and get corresponding response/notification by Nnwdaf_AnalyticsInfo_Request response, Nnwdaf_EventsSubscription_Subscribe response or Nnwdaf_EventsSubscription_Notify service operation.\n4.\tThe V-RE-NWDAF may sends the VPLMN analytics information to the H-RE-NWDAF using either Nnwdaf_RoamingAnalytics_Request response, Nnwdaf_RoamingAnalytics_Subscribe or Nnwdaf_RoamingAnalytics_Notify request message as described in clause 4.9.2.2 and clause 4.9.2.3 of 3GPP TS 29.520 [5], depending on the service used in step 2. The V-RE-NWDAF may restrict the exposed analytics information based on VPLMN operator polices.\n5.\tIf the Consumer NF also indicates request or subscription of analytics information available in the HPLMN (e.g. via Target of Analytics Reporting) in step 1, H-RE-NWDAF collects data from the NF(s) and/or OAM in HPLMN and derives the analytics. These steps can be executed in parallel with steps 3-6. The H-RE-NWDAF may perform analytics aggregation with the analytics information received from the V-RE-NWDAF and analytics information generated by itself, based on the analytics request or subscription.\n6.\tH-RE-NWDAF sends the VPLMN analytics information received in step 4, or the aggregated analytics information if step 5 are performed, to the Consumer NF in HPLMN using either Nnwdaf_AnalyticsInfo_Request response, Nnwdaf_EventsSubscription_Subscribe response or Nnwdaf_EventsSubscription_Notify service operation as described in clause 4.2.2 of 3GPP TS 29.520 [5] depending on the service used in step 1, depending on the service used in step 1.\nNOTE 3:\tThe present document describes that the RE-NWDAF may perform analytics aggregation for roaming scenario, but whether and how the RE-NWDAF performs analytics aggregation for roaming scenario are up to implementation.\nNOTE 4:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify, Nnwdaf_AnalyticsInfo_Request and/or Nnwdaf_RoamingAnalytics_Subscribe/Unsubscribe/Notify/Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tAnalytics Aggregation from Multiple NWDAFs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tGeneral",
                            "text_content": "Analytics Aggregation refers to the case in which an NWDAF with respective capabilities aggregates the analytics provided by other NWDAFs to serve a request from an NF service consumer.\nIf multiple NWDAFs are deployed, an NWDAF instance may be specialized to provide Analytics for one or more Analytics event(s). Each NWDAF instance may serve a certain Area of Interest or TAI(s) and multiple NWDAFs may be needed to serve a particular Analytics event collectively. An NWDAF may have the capability to aggregate the Analytics (per Analytics event) received from the other NWDAFs and/or the Analytics generated by itself. Analytics aggregation applies to scenarios where NWDAF service consumer requests or subscribes to analytics with or without provisioning of Area of Interest.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.2\tAnalytics aggregation with provisioning of Area of Interest",
                            "text_content": "This procedure is used by the service consumer to request Analytics event(s) for an Area of Interest, in which multiple NWDAFs are required to serve the request collectively.\nThe figure depicts a 3D visualization of a network's analytics aggregation with a focus on the Area of Interest (AoI). It illustrates the process of aggregating data from various sources, such as sensors, to provide a comprehensive view of the network's performance. The figure shows the distribution of data points across different areas, highlighting the importance of prioritizing certain areas for analysis. The visualization also includes a representation of the network's topology, showing the distribution of nodes and links. This figure is crucial for network operators to understand the network's performance and make informed decisions.\nFigure 5.3.2-1: Analytics aggregation with provisioning of Area of Interest\n1a-1c.\tIn order to obtain the specific network data analytics, the NF service consumer selects an NWDAF (e.g. NWDAF1) with aggregation capability according to the results returned by NRF or available information obtained by other means. The NWDAF service consumer invokes Nnwdaf_AnalyticsInfo_Request or Nnwdaf_EventsSubscription_Subscribe service operations as described in clause 5.2.3.1 and clause 5.2.2.1 to the selected NWDAF.\nIn the request message, the analytics event, analytics filter information including the Area of Interest (e.g. TAI-1, TAI-2, TAI-n, if available) and the Target of Analytics Reporting are provided. The NWDAF service consumer may indicate the time when the analytics is needed in \"timeAnaNeeded\" attribute, which needs to be equal or greater than the supported Analytics Delay per Analytics event of the Aggregator NWDAF.\n2-5b.\tThe Aggregator NWDAF selects the other NWDAF instances, which collectively can cover the area of interest indicated in the request, according to the results returned by the NRF and/or the UDM, or available information obtained by other means. The Aggregator NWDAF invokes Nnwdaf_AnalyticsInfo_Request or Nnwdaf_EventsSubscription_Subscribe service operations to each selected NWDAF (e.g. NWDAF2, NWDAF3) as described in clause 4.2.2.2 or clause 4.3.2.2 of 3GPP TS 29.520 [5].\n6-9b.\tThe selected NWDAFs send response or notification containing the requested analytics to the Aggregator NWDAF. If the selected NWDAFs (e.g. NWDAF 2 and/or NWDAF 3) cannot reply or notify the requested analytics before the expiry of the time that the Aggregator NWDAF has indicated, they may send an error response or error notification to the Aggregator NWDAF including a \"revised waiting time\" in \"rvWaitTime\" attribute.\n10.\tThe Aggregator NWDAF aggregates the analytics received from the selected NWDAFs and the analytics of its own.\n11a-11c.\tThe Aggregator NWDAF sends a response or notification containing the aggregated output analytics for the requested Analytics event(s) to the NWDAF service consumer.\nIf the Aggregator NWDAF cannot reply or notify the requested analytics before the expiry of the time that the consumer has indicated in \"timeAnaNeeded\" attribute, it may sends an error response or error notification to the consumer including a \"revised waiting time\" in \"rvWaitTime\" attribute.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.3\tAnalytics aggregation without provisioning of Area of Interest",
                            "text_content": "This procedure is used by the service consumer to request Analytics event(s) without providing an Area of Interest, in which multiple NWDAFs are required to serve the request collectively.\nThe figure depicts a simplified representation of analytics aggregation without the provision of Area of Interest (AoI) visualization. It illustrates the process of aggregating data from multiple sources, such as sensors, without the need for a dedicated visualization tool. This approach is commonly used in real-time analytics to quickly analyze and understand data trends.\nFigure 5.3.3-1: Analytics aggregation without provisioning of Area of Interest\n1a-1c.\tIn order to obtain the specific network data analytics, the NF service consumer selects an NWDAF (e.g. NWDAF1) with aggregation capability according to the results returned by NRF or available information obtained by other means. The NWDAF service consumer invokes Nnwdaf_AnalyticsInfo_Request or Nnwdaf_EventsSubscription_Subscribe service operations as described in clause 5.2.3.1 and clause 5.2.2.1 to the selected NWDAF. If not, the NWDAF service consumer should select a NWDAF with large serving area from the candidate NWDAFs which supports analytics aggregation, e.g. NWDAF1.\n2a-4b.\tIf the requested analytics requires UE location information, e.g. for the Analytics events \"UE_MOBILITY\", \"ABNORMAL_BEHAVIOUR\", or \"USER_DATA_CONGESTION\", then:\n-\t2a-2b: The Aggregator NWDAF may query UDM to discover the NWDAF serving the UE by invoking Nudm_UECM_Get service operation as described in clause 5.3.2.5.12 of 3GPP TS 29.503 [23], if it is supported.\n-\t3a-4b: The Aggregator NWDAF may determine the AMF serving the UE, then requests UE location information from the AMF by invoking Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18]. The AMF notifies the UE location information by invoking Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518 [18] clause 5.3.2.4.\n5.\tIf the requested analytics does not require UE location information, e.g. for the Analytics events \"SERVICE_EXPERIENCE\", \"NF_LOAD\", or \"UE_COMM\", the Aggregator NWDAF can determine the NFs to be contacted for data collection.\n6.\tWith the data obtained in step 3a-5, the Aggregator NWDAF may query the NRF for discovering the required NWDAF, by sending an NF discovery request including UE location or NF serving area as a filter to NRF, and obtains candidates target NWDAF(s) that can provide the required analytics.\n7.\tIf a single target NWDAF (e.g. NWDAF2) can provide the requested analytics data, the Aggregator NWDAF can redirect the Nnwdaf_AnalyticsInfo_Request to that target NWDAF or request an analytics subscription transfer to that target NWDAF.\n8.\tIf the Aggregator NWDAF decides to request analytics from one or more target NWDAFs, the steps 2-9b of the analytics aggregation procedure in clause 5.3.2 are executed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.4\tProcedures for Analytics Transferring",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.4.1\tAnalytics context transfer initiated by target NWDAF selected by the NWDAF service consumer",
                            "text_content": "The procedure in below figure is used when an NWDAF service consumer decides to select a new NWDAF instance due to internal or external triggers, e.g. the NWDAF service consumer starts serving a UE with analytics subscription information received upon UE context transfer procedure as described in 3GPP TS 23.502 [3], or the NWDAF service consumer starts to request NF related analytics, or the NWDAF service consumer receives a \"Termination Request\" for an existing analytics subscription from an NWDAF. The NWDAF service consumer sends to the target NWDAF information about the NWDAF previously used for analytics subscription, if available, in Nnwdaf_EventsSubscription_Subscribe service operation. The target NWDAF may initiate the transfer of the analytics context, using the Nnwdaf_AnalyticsInfo_ContextTransfer.\nThe procedure in below figure is also used when an Aggregator NWDAF, as the NWDAF service consumer, decides to select a new NWDAF to request output analytics for analytics aggregation. For example, upon receiving a Termination Request from one of the NWDAFs that are collectively serving a request for analytics subscription, the Aggregator NWDAF queries the NRF or UDM to select a target NWDAF using information e.g. the UE location, the 5GC NFs (identified by their NF Set IDs or NF types) serving the UE or to be contacted for data collection (if Area of Interest is not provisioned for the requested analytics), or the subset of AoI (if Area of Interest is provisioned for the requested analytics). Then, the Aggregator NWDAF sends information about the NWDAF previously used for analytics subscription, if available, in Nnwdaf_EventsSubscription_Subscribe service operation towards the selected target NWDAF.\nThe figure depicts a network traffic flow scenario, where the target network device (NWDAF) is selected by the network device access (NWDAF) service consumer. The traffic flow is initiated by the target network device, and the analytics context transfer is initiated by the network device access service consumer.\nFigure 5.4.1-1: Analytics context transfer initiated by target NWDAF selected by the NWDAF service consumer\n0.\tWhen the NWDAF service consumer (e.g. AMF) changes, the new NWDAF service consumer may receive the old subscription information from the old NWDAF service consumer.\n1.\tThe NWDAF service consumer determines to select an NWDAF instance. The NWDAF service consumer discovers and selects the target NWDAF as specified in clause 5.8.\n2.\tTo send a request for analytics subscription to the target NWDAF, the NWDAF service consumer invokes Nnwdaf_EventsSubscription_Subscribe service operation by sending the HTTP POST request message targeting the resource \"NWDAF Events Subscriptions\" to the target NWDAF. The NWDAF service consumer includes information on the previous analytics subscription (e.g., NWDAF ID and Subscription ID) which relates to the requested analytics subscription, if available. If the target NWDAF accepts the analytics subscription request, it responds with HTTP \"201 Created\" to the NWDAF service consumer. Details are described in clause 4.2.2.2 of 3GPP TS 29.520 [5].\nIf the target NWDAF does not receive information of previous analytics subscription in step 2, for UE related Analytics, the target NWDAF may discover previously used NWDAF in UDM as specified in clause 5.8.\nNOTE:\tIf the selected target NWDAF instance is the same as the source NWDAF instance (as received from the other consumer in step 0), the new NWDAF service consumer invokes Nnwdaf_EventsSubscription_Subscribe service operation by sending the HTTP PUT request message targeting the resource \"Individual NWDAF Event Subscription\" to the target NWDAF, and the target NWDAF will update the existing analytics subscription to the new NWDAF service consumer. Following steps are skipped.\n3.\tIf the target NWDAF decides to request an analytics context transfer from the previously used NWDAF, it invokes the Nnwdaf_AnalyticsInfo_ContextTransfer service operation by sending the HTTP GET request message targeting the resource \"NWDAF Context\" to the source NWDAF as described in clause 4.3.2.3 of 3GPP TS 29.520 [5].\nTarget NWDAF is now ready to generate analytics information by taking into account the information received in step 3.\n4.\t[Optional] Source NWDAF may purge analytics context after completion of step 3a, if performed, and if not already done, unsubscribes from the data source(s) and/or model source(s) that are no longer needed for the remaining analytics subscriptions.\n5.\t[Optional] Target NWDAF may subscribe to relevant data source(s) and/or model source(s), if it is not yet subscribed to the data source(s) and/or model source(s).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.2\tAnalytics Subscription Transfer initiated by source NWDAF",
                            "text_content": "The procedure in below figure is used by a source NWDAF instance to request the transfer of analytics subscription(s) to another target NWDAF instance, using the Nnwdaf_EventsSubscription_Transfer service operation.\nIf the source NWDAF discovers that the NWDAF service consumer may change concurrently to this procedure, the source NWDAF should not perform the procedure. In such a case, the source NWDAF may send a message to indicate to the NWDAF service consumer that it will not serve this subscription anymore.\nNOTE 1:\tTo discover the possible change of NWDAF service consumer, if the Analytics Event is UE related, the source NWDAF takes actions responding to external trigger (such as UE mobility), for example, checking if the Target of Analytics Reporting is still within the serving area of the analytics consumer, if the serving area information is available.\nNOTE 2:\tHandling of overload situation or preparation for a graceful shutdown are preferably executed inside an NWDAF Set, when available, therefore, not requiring an analytics subscription transfer as described in this clause. Below procedure is applicable for analytics subscription transfer across NF Sets or if the NWDAF is not deployed in a Set.\nThe figure depicts a subscription transfer initiated by a source NWDAF, illustrating the process of data transfer between two entities. The NWDAF is a key component in the network, responsible for managing and distributing analytics subscriptions. The figure shows the flow of data from the source to the destination, highlighting the importance of efficient data transfer in the network.\nFigure 5.4.2-1: Analytics subscription transfer initiated by source NWDAF\n0.\tThe NWDAF service consumer subscribes to analytics from source NWDAF. The NWDAF service consumer may send its NF ID or serving area, enabling the source NWDAF to determine whether the following analytics subscription transfer procedure is applicable. Optionally the source NWDAF subscribes to UE mobility events.\n1.\t[Optional] Source NWDAF determines, e.g. triggered by a UE mobility event notification, to prepare an analytics subscription transfer to target NWDAF(s) as described in clause 5.4.3 with steps 0-1, 5- 6 will be followed.\n2.\tSource NWDAF determines, e.g. based on the UE location information received and the analytics consumer's serving area either directly received in step 0 or indirectly received via NRF, to perform an analytics subscription transfer to target NWDAF(s). Therefore, the source NWDAF determines the analytics subscription(s) to be transferred to a target NWDAF.\n3.\tSource NWDAF performs an NWDAF discovery and selects the target NWDAF. NWDAF discovery may be skipped if the target NWDAF had already been discovered as part of a prepared analytics subscription transfer. In the case of aggregated analytics from multiple NWDAFs, the source NWDAF may use the set of NWDAF identifiers related to aggregated analytics to preferably select a target NWDAF that is already serving the consumer.\n4.\tSource NWDAF requests, using Nnwdaf_EventsSubscription_Transfer service operation, a transfer of the analytics subscription(s) determined in step 2 to the target NWDAF as described in clause 4.2.2.5 of 3GPP TS 29.520 [5], the response message in step 4b is optional.\n5.\tTarget NWDAF accepts the analytics subscription transfer and takes over the analytics generation based on the information received from the source NWDAF.\nThe ML model related information namely ModelInfo may be provided by the source NWDAF in the Nnwdaf_EventsSubscription_Transfer request message.\n-\tIf the instance ID or set ID of NWDAF(s) containing MTLF carried in \"modelProvIds\" attribute is provided in the Nnwdaf_EventsSubscription_Transfer, target NWDAF may request or subscribe to the ML model(s) from the indicated NWDAF(s).\nNOTE 3:\tIf the provided ID(s) of NWDAF(s) containing MTLF carried in \"modelProvIds\" attribute are not part of the locally configured ID(s) of NWDAFs containing MTLF, the target NWDAF discovers the NWDAF(s) containing MTLF as described in clause 5.8.2.3.\n-\tWhen the source NWDAF itself provides the ML models, the address of ML model files may be provided, and the target NWDAF retrieves the ML model(s) from the indicated address.\nTarget NWDAF may use the above retrieved ML models and the ML models retrieved from the locally configured NWDAFs containing MTLF for the transferred analytics subscription.\nNOTE 4:\tIf not yet done during a prepared analytics subscription transfer, the target NWDAF allocates a new Subscription ID to the received analytics subscriptions.\nNOTE 5:\tThe target NWDAF might already have received information on some/all of the analytics subscriptions as part of the prepared analytics subscription transfer request received in step 1 and, thus, might already have started to prepare for the analytics generation, e.g. by having already subscribed to relevant event notifications.\n6.\tTarget NWDAF informs the NWDAF service consumer about the successful analytics subscription transfer using a Nnwdaf_EventsSubscription_Notify request message. A new Subscription ID, which was assigned by the target NWDAF, is provided in the Subscription ID and the old Subscription Id, which was allocated by the source NWDAF, is provided in the Old Subscription ID parameter of this message.\nNOTE 6:\tNotification correlation information in the Nnwdaf_EventsSubscription_Notify message allows the NWDAF service consumer to correlate the notifications to the initial subscription request made with the source NWDAF in step 0.\nNOTE 7:\tThe existing Analytics context in the source NWDAF is not deleted directly but will be purged first when it was collected by the target NWDAF.\nNOTE 8:\tIf this subscription is used as input for analytics aggregation by the NWDAF service consumer, the NWDAF service consumer may inform the other NWDAFs instance participating in this analytics aggregation that the Set of NWDAF identifiers of NWDAF instances used by the NWDAF service consumer for this analytics aggregation has changed using the Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 4.2.2.2 of 3GPP TS 29.520 [5].\n7.\t[Conditional] If \"analytics context identifier(s)\" had been included in the Nnwdaf_EventsSubscription_Transfer Request received in step 4, the target NWDAF requests the \"analytics context\" by invoking the Nnwdaf_AnalyticsInfo_ContextTransfer service operation as described in clause 4.3.2.3 of 3GPP TS 29.520 [5].\n8.\t[Optional] Target NWDAF subscribes to relevant data source(s), if it is not yet subscribed to the data source(s) for the data required for the Analytics.\n9.\t[Optional] Target NWDAF confirms the analytics subscription transfer to the source NWDAF by sending Nnwdaf_EventsSubscription_Transfer response message as described in clause 4.2.2.5 of 3GPP TS 29.520 [5], if the response has not been sent in step 4b.\n10.\t[Optional] Source NWDAF unsubscribes with the data source(s) that are no longer needed for the remaining analytics subscriptions. In addition, Source NWDAF unsubscribes with the NWDAF(s) containing MTLF, if exist, which are no longer needed for the remaining analytics subscriptions.\nNOTE 9:\tAt this point, the analytics subscription transfer is deemed completed, i.e. the source NWDAF can delete all information related to the successfully transferred analytics subscription.\n11-12.\tTarget NWDAF at some point derives new output analytics based on new input data and notifies the NWDAF service consumer about the new analytics using a Nnwdaf_EventsSubscription_Notify message as described in clause 4.2.2.4 of 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.3\tPrepared analytics subscription transfer",
                            "text_content": "The procedure in below figure is used by a NWDAF instance to request another NWDAF instance for a prepared analytics subscription transfer from the source NWDAF instance, using the Nnwdaf_EventsSubscription_Transfer service operation.\nNOTE 1:\tThe source NWDAF might determine that it needs to prepare to transfer analytics to another NWDAF instance, e.g. when the source NWDAF estimates for UE related analytics subscription that the UE might enter an area which is not covered by the source NWDAF (e.g., by subscribing to AMF event exposure service for UE mobility event notifications, by performing UE mobility analytics, or by subscribing to another NWDAF providing UE mobility analytics). If the source NWDAF discovers that the analytics consumer may change concurrently to this procedure, the source NWDAF does not perform the procedure. If the procedure makes use of predictions to determine the candidate NWDAFs, care must be taken with regards to load and signalling cost when sending data to an NWDAF that will not eventually start serving the UE.\nNOTE 2:\tThe source NWDAF might also determine that it needs to prepare to transfer analytics subscriptions to another NWDAF instance, as the source NWDAF wants to resolve an internal load situation or prepare for a graceful shutdown.\nNOTE 3:\tHandling of overload situation or preparation for a graceful shutdown are preferably executed inside an NWDAF Set, when available.\nThe figure depicts a simplified representation of a telecommunications subscription transfer process, illustrating the steps involved in transferring a subscription from one service provider to another. The figure includes various elements such as a subscription number, the service provider, and the recipient, as well as a flowchart that outlines the process. The use of arrows and labels helps to visually represent the sequence of actions and the logical flow of the process. The figure is a useful tool for understanding the complexities of telecommunications subscription transfer and can be used to train and test algorithms for managing such processes.\nFigure 5.4.3-1: Prepared analytics subscription transfer\n1a-1b.\tThe NWDAF service consumer subscribes to analytics from source NWDAF by invoking Nnwdaf_EventsSubscription_Subscribe service operation. The source NWDAF responses to Nnwdaf_EventsSusbcription_Subscribe service operation.\n2a-2b. The source NWDAF generates the requested analytics and notify the NWDAF service consumer by invoking the Nnwdaf_EventsSusbcription_Notify service operation. The NWDAF service consumer responses to the Nnwdaf_EventsSusbcription_Notify service operation.\n3. The source NWDAF determines that it needs to prepare to transfer the analytics subscription to another NWDAF instance.\n4. The source NWDAF discovers and selects the target NWDAF as described in clause 5.8.2.3.\n5a-5b. The source NWDAF invokes Nnwdaf_EventsSubscription_Transfer service operation by sending an HTTP POST request to the target NWDAF and the \"transReqType\" attribute in the request message is set to \"PREPARE\". The target NWDAF sends an HTTP \"201 Created\" to the source NWDAF.\n6a-6b. If analytics context identifier information had been included in the Nnwdaf_EventsSubscription_Transfer request message, the target NWDAF requests the analytics context information from the source NWDAF by invoking the Nnwdaf_AnalyticsInfo_ContextTransfer service operation by sending the HTTP GET request message targeting the resource \"NWDAF Context\" to the source NWDAF.\n7. The target NWDAF collect the data required for the analytics from the relevant data source(s), if it is not yet collected.\n8a-8b. The source NWDAF invokes the Nnwdaf_EventsSubscription_Transfer service operation by sending an HTTP DELETE request to cancel the prepared analytics subscritpiton transfer. The target NWDAF sends response to the source NWDAF and deletes the analytics data that is no longer needed. If the target NWDAF had already subscribed to entities to collect data or ML models during the analytics subscription preparation, it unsubscribes from those entities if the subscriptions are not needed for other active analytics subscriptions.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.5\tData Collection",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.5.1\tProcedure for Data Collection from NFs",
                            "text_content": "The procedure in Figure 5.5.1.1-1 is used by NWDAF to subscribe/unsubscribe at NFs in order to be notified for data collection on related event(s), using Event Exposure Services as listed in Table 6.2.2.1-1 defined in TS 23.288 [2] clause 6.2.2.\n\nThe figure depicts a simplified representation of event exposure subscribe/unsubscribe for NF (Network Function) events in a 5G network. It illustrates the process of how NF events are exposed to the network, allowing for efficient management and control. The figure includes key components such as the event source, event destination, and the event type, as well as the event subscription/unsubscription mechanism. This figure is crucial for network management and control in 5G networks, ensuring efficient and reliable operation.\nFigure 5.5.1.1-1: Event Exposure Subscribe/Unsubscribe for NFs\n1a.\tIf data is to be collected for a user, i.e. for a SUPI or GPSI, the user consent has not been checked by the data consumer, and local policy and regulations require to check user consent, the NWDAF invokes Nudm_SDM_Get service operation by sending an HTTP GET request targeting the resource \"AccessAndMobilitySubscriptionData\" to the UDM to request the data type \"User consent\" as described in clause 5.2.2.2 of 3GPP TS 29.503 [22]. Otherwise the procedure begins with step 3.\n2a.\tThe UDM responds to the Nudm_SDM_Get service operation. If the request is accepted, the response includes the requested data with \"200 OK\". In subsequent steps, the NWDAF excludes the SUPI or GPSI from requests to collect data for users for whom the user consent is not granted.\n1b.\tFor the users for which the user consent is granted, the NWDAF subscribes to notifications of changes of the user consent by invoking the Nudm_SDM_Subscribe service operation by sending an HTTP POST request targeting the resource \"SdmSubscriptions\" to the UDM as described in clause 5.2.2.3 of 3GPP TS 29.503 [22].\n2b.\tThe UDM responds to the Nudm_SDM_Subscribe service operation. If the request is accepted, the UDM responds with \"201 Created\".\n3.\tIn order to subscribe to notifications (or to modify subscriptions to notifications) of data events from the data source NF (e.g. UDM, AMF, SMF, NEF, AF), the NWDAF invokes the Nnf_EventExposure_Subscribe service operation by sending an HTTP POST (or PUT, for modification) request targeting the resource representing event exposure subscriptions of that NF, e.g. as described in clause 5.5.2.2 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.2 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.3 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.2 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.2 of 3GPP TS 29.517 [12] for the AF.\n4.\tThe NF responds to the Nnf_EventExposure_Subscribe service operation. Upon receipt of the HTTP POST request, if the subscription is accepted to be created, the NF responds to the NWDAF with \"201 Created\", and the URI of the created subscription is included in the Location header field.\n5.\tIf the NF observes the subscribed event(s), the NF invokes Nnf_EventExposure_Notify service operation to report the event(s) by sending an HTTP POST request, e.g. as described in clause 5.5.2.4 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.4 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.2 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.4 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.4 of 3GPP TS 29.517 [12] for the AF.\n6a.\tIf the user consent changes and the NWDAF has subscribed to UDM to notifications of user consent change for a user, the UDM invokes Nudm_SDM_Notification service operation by sending an HTTP POST request as described in clause 5.2.2.5 of 3GPP TS 29.503 [22].\n6b.\tThe NWDAF responds to the Nudm_SDM_Notification service operation with \"204 No Content\".\n6c.\tThe NWDAF may invoke Nudm_SDM_Unsubscribe service operation by sending an HTTP DELETE request as described in clause 5.2.2.4 of 3GPP TS 29.503 [22] to unsubscribe from UDM to be notified of user consent change for each user whose user consent is revoked.\n6d.\tIf the deletion request is accepted, the UDM responds to the Nudm_SDM_Unsubscribe service operation with \"204 No Content\".\n7.\tIf the user consent is no longer granted or the data collection is no longer required, the NWDAF unsubscribes to the notifications of data events from the NF. The NWDAF invokes Nnf_EventExposure_Unsubscribe service operation by sending an HTTP DELETE request targeting the resource that represents the previously created individual event exposure subscription, e.g. as described in clause 5.5.2.3 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.3 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.4 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.3 of 3GPP TS 29.591 [11] for the NEF, clause 4.2.3 of 3GPP TS 29.517 [12] for the AF. The request includes the event subscriptionId of the existing subscription that is to be deleted.\n8.\tThe NF responds to the Nnf_EventExposure_Unsubscribe service operation. If the subscription deletion is accepted, the NF responds with \"204 No Content\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.2\tData collection profile registration",
                            "text_content": "This procedure depicted in Figure 5.5.2-1 is used by NWDAF or ADRF to register/update a data collection profile to the DCCF during/after the procedure of data collection.\nThe NWDAF or ADRF procedure involves the registration of data profiles to the DCCF, which is a crucial step in ensuring the efficient and secure transmission of data within the network. This procedure ensures that the data profiles are correctly registered and can be transmitted without any issues.\nFigure 5.5.2-1: Procedure for the NWDAF or ADRF to register data profile to DCCF\n1.\tAn ADRF or NWDAF instance is collecting or has collected data directly, e.g. from collocated NF.\n2.\tIn order to register a data collection profile, the ADRF or NWDAF invokes the Ndccf_ContextManagement_Register service operation by sending an HTTP POST request targeting the resource \"DCCF Data Collection Profiles\" as described in clause 4.3.2.2 of 3GPP TS 29.574 [15].\n3.\tThe DCCF responds to the Ndccf_ContextManagement_Register service operation. Upon receipt of the HTTP POST request, if the data profile is accepted to be created, the DCCF responds to the ADRF or NWDAF with \"201 Created\", and the URI of the created profile is included in the Location header field.\n4.\tIn order to update a data collection profile, the Data Consumer invokes the Ndccf_ContextManagement_Update service operation by sending an HTTP PUT request targeting the resource \"Individual DCCF Data Collection Profile\" as described in clause 4.3.2.3 of 3GPP TS 29.574 [15].\n5.\tThe DCCF responds to the Ndccf_ContextManagement_Update service operation. Upon receipt of the HTTP PUT request, if the data profile is accepted to be updated, the DCCF responds to the ADRF or NWDAF with \"200 OK\" with a response body containing a representation of the updated data profile or \"204 No Content\".\n6.\tTo obtain historical data and if the data consumer is configured to collect data via the DCCF using the Ndccf_DataManagement_Subscribe service operation, the data consumer uses the procedures described in clause 5.5.3.\n7.\tThe ADRF or NWDAF requests to delete a registered data collection profile at the DCCF invoking the Ndccf_ContextManagement_Deregister service operation by sending a HTTP DELETE request targeting the \"Individual DCCF Data Collection Profile\" resource of the DCCF as described in clause 4.3.2.4 of 3GPP TS 29.574 [15].\n8.\tThe DCCF responds to the Ndccf_ContextManagement_Deregister service operation with HTTP \"204 No Content\" status code, if the data collection profile is successfully removed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.3\tProcedure for Data Collection using DCCF",
                            "text_content": "The procedure depicted in Figure 5.5.3.1-1 is used by a data consumer (e.g. NWDAF) to obtain data and be notified of events via the DCCF using the Ndccf_DataManagement_Subscribe service operation. Whether the data consumer directly contacts the Data Source or goes via the DCCF is based on configuration of the data consumer.\n\nThe figure depicts a data collection system using DCCF (Data Collection via DCCF), which is a method of collecting data from a network. The system includes a data collector (DC), a data collection point (DCP), and a data collection network (DCN). The DC collects data from the DCP, which is a point on the network where data is collected. The DCN is a network of data collection points that are connected to the DC, allowing for efficient data collection. The figure shows the components and connections of the system, providing a clear understanding of how data is collected and transmitted.\nFigure 5.5.3.1-1: Data Collection via DCCF\n1.\tIn order to subscribe to notification(s) of events exposure via the DCCF based on local configuration, the Data Consumer invokes the Ndccf_DataManagement_Subscribe service operation by sending an HTTP POST request targeting the resource \"DCCF Data Subscriptions\" as described in clause 4.2.2.2.4 of 3GPP TS 29.574 [15].\n2a.\tIf data is to be collected for a user, i.e. for a SUPI or GPSI, the user consent has not been checked by the data consumer, and local policy and regulations require to check user consent, the DCCF invokes the Nudm_SDM_Get service operation by sending an HTTP GET request targeting the resource \"AccessAndMobilitySubscriptionData\" at the UDM to request the data type \"User consent\" as described in clause 5.2.2.2 of 3GPP TS 29.503 [22]. Otherwise the procedure continues with step 4.\n3a.\tThe UDM responds to the Nudm_SDM_Get service operation. If the request is accepted, the response includes the requested data with \"200 OK\". In subsequent steps, the DCCF excludes the SUPI or GPSI from requests to collect data for users for whom the user consent is not granted.\n2b.\tFor the users for which the user consent is granted, the DCCF subscribes to notifications of changes of the user consent by invoking the Nudm_SDM_Subscribe service operation by sending an HTTP POST request targeting the resource \"SdmSubscriptions\" at the UDM as described in clause 5.2.2.3 of 3GPP TS 29.503 [22].\n3b.\tThe UDM responds to the Nudm_SDM_Subscribe service operation. If the request is accepted, the UDM responds with \"201 Created\" status code.\n4.\tThe DCCF determines the NF type(s) and/or OAM to retrieve the data based on the Service Operation requested in step 1. If the NF instance or NF Set ID is not provided by the data consumer. The DCCF determines the NF instances that can provide data as described in TS 23.288 [2] clause 5A.2 and clause 6.2.2.2. If the consumer requested storage of data in an ADRF but the ADRF ID is not provided by the data consumer, or the collected data is to be stored in an ADRF according to configuration on the DCCF, the DCCF selects an ADRF to store the collected data.\nThe DCCF keeps track of the data actively being collected from the Data Sources it is coordinating. The NWDAF or ADRF may register the data collection profile (including the data collection related Service Operation, Analytics/Data Specification, NWDAF ID or ADRF ID) with the DCCF. The DCCF may then determine whether certain historical data may be available in the NWDAF or ADRF based on the data collection profile and the request time window.\nIf the historical data handling is not applicable or not supported, the DCCF shall proceed with step 5a and skip step 5b, step 6b, step 7b, step 5c, step 6c, and step 7c.\nIf the historical data is available in an ADRF, the DCCF shall proceed with step 5a and step 5b, and skip step 5c, step 6c, and step 7c.\nIf the historical data is available in an NWDAF, the DCCF shall proceed with step 5a and step 5c, and skip step 5b, step 6b, and step 7b.\n5a.\tThe DCCF shall determine whether the data requested in step 1 are already being collected.\nIf the data requested are already being collected by a data consumer, the DCCF adds the data consumer to the list of data consumers that are subscribed for these data.\nIf the DCCF determines that no subscriptions need to be created or modified (e.g. because all the data can be made available either via pre-existing subscriptions or because of the historical data handling) then step 6a and step 7a are skipped.\n6a.\tIf the data requested in step 1 are not yet available, the DCCF shall invoke the Nnf_EventExposure_Subscribe service operation by sending an HTTP POST request message request to the NF targeting the resource representing event exposure subscriptions to subscribe to a new event exposure subscription, e.g. as described in clause 5.5.2.2 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.2 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.3 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.2 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.2 of 3GPP TS 29.517 [12] for the AF.\nOtherwise, if the requested data subscribed in step 1 partially matches data that is already being collected by the DCCF from an NF, and a modification of this subscription to the NF would satisfy both the existing data  subscriptions as well as the newly requested data, the DCCF shall send a request to the individual event exposure subscription resource to update an existing event exposure subscription, e.g. as described in clause 5.5.2.5 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.2.3 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.3.3 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.2.3 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.2.3 of 3GPP TS 29.517 [12] for the AF.\n7a.\tThe NF responds to the Nnf_EventExposure_Subscribe service operation.\nUpon receipt of an HTTP POST request, if the subscription is accepted to be created, the NF responds to the DCCF with \"201 Created\" status code, and the URI of the created subscription is included in the Location header field.\nUpon receipt of an HTTP PUT request, if the subscription is accepted to be updated, the NF responds to the DCCF with \"200 OK\" or \"204 No Content\" status code.\n5b.\tIf the historical data handling is applicable, and the DCCF determines to retrieve data from the ADRF, the DCCF shall determine which ADRF instances might provide the data.\n6b.\tIn order to retrieve the historical data from the ADRF, the DCCF shall invoke the Nadrf_DataManagement_RetrievalSubscribe service operation by sending an HTTP POST request message targeting the resource \"ADRF Data Retrieval Subscriptions\" as described in clause 4.2.2.6 of 3GPP TS 29.575 [16].\n7b.\tThe ADRF responds to the Nadrf_DataManagement_RetrievalSubscribe service operation.\nUpon receipt of the HTTP POST request, if the subscription is accepted to be created, the ADRF responds to the DCCF with \"201 Created\" status code, and the URI of the created subscription is included in the Location header field.\n5c.\tIf the historical data handling is applicable, and the DCCF determines to retrieve data from the NWDAF, the DCCF shall determine which NWDAF instances might provide the requested data.\n6c.\tIn order to retrieve the historical data from the NWDAF, the DCCF shall invoke the Nnwdaf_DataManagement_Subscribe service operation by sending an HTTP POST request message targeting the resource \"NWDAF Data Management Subscriptions\", as described in clause 4.4.2.2 of 3GPP TS 29.520 [5].\n7c.\tThe NWDAF responds to the Nnwdaf_DataManagement_Subscribe service operation.\nUpon receipt of the HTTP POST request, if the subscription is accepted to be created, the NWDAF responds to the DCCF with \"201 Created\" status code, and the URI of the created subscription is included in the Location header field.\n8.\tThe DCCF responds to the Ndccf_DataManagement_Subscribe service operation with HTTP \"204 No Content\" status code.\n9a.\tWhen the data are available, the NF invokes the Nnf_EventExposure_Notify service operation by sending an HTTP POST request message to notify the data events to the DCCF, e.g. as described in clause 5.5.2.4 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.4 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.2 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.4 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.4 of 3GPP TS 29.517 [12] for the AF.\n10a.\tThe DCCF responds to the Nnf_EventExposure_Notify service operation with HTTP \"204 No Content\" status code.\n9b.\tWhen the historical data are available in the ADRF, the ADRF shall invoke the Nadrf_DataManagement_RetrievalNotify service operation by sending an HTTP POST request message to notify the historical data or Fetch Instructions to the DCCF as described in clause 4.2.2.8 of 3GPP TS 29.575 [16].\n10b.\tThe DCCF responds to the Nadrf_DataManagement_RetrievalNotify service operation with HTTP \"204 No Content\" status code.\n9c.\tWhen the historical data are available in the NWDAF, the NWDAF shall invoke the Nnwdaf_DataManagement_Notify service operation by sending an HTTP POST request message to notify the historical data to the DCCF as described in clause 4.4.2.4 of 3GPP TS 29.520 [5].\n10c.\tThe DCCF responds to the Nnwdaf_DataManagement_Notify service operation with HTTP \"204 No Content\" status code.\n11.\tIf the DCCF is configured to deliver the data itself (and not via the MFAF), the DCCF invokes the Ndccf_DataManagement_Notify service operation by sending HTTP POST request message(s) to send the data to all notification endpoints indicated in step 1. Data sent to notification endpoints may be processed and formatted by the DCCF, so they conform to delivery requirements for each NF service consumer or notification endpoint.\nNOTE:\tAccording to Formatting Instructions provided by the NF service consumer, multiple notifications from a NF can be combined in a single Ndccf_DataManagement_Notify so that many notifications from an NF result in fewer notifications (or one notification) to the Data Consumer. Alternatively, a notification can instruct the data notification endpoint to fetch the data from the DCCF.\n12.\t\tThe NF service consumer responds to the Ndccf_DataManagement_Notify service operation with HTTP \"204 No Content\" status code.\n13.\tThe Data Consumer invokes the Ndccf_DataManagement_Fetch service operation by sending an HTTP GET request message as described in clause 4.2.2.5 of 3GPP TS 29.574 [15] to fetch the data from the DCCF before an expiry time, if the fetch instruction was previously received via the NdccfDataManagement_Notify service operation in step 11.\n14.\tThe DCCF responds to the Ndccf_DataManagement_Fetch service operation with HTTP \"200 OK\" status code with the message body containing the data received earlier from the data source.\n15.\tWhen the NF service consumer no longer needs the subscription to the requested data in step 1, it shall invoke the Ndccf_DataManagement_Unsubscribe service operation by sending an HTTP DELETE request message as described in clause 4.2.2.3.3 of 3GPP TS 29.574 [15]. The DCCF removes the NF service consumer from the list of NF service consumers that are subscribed for these data.\n16.\tThe DCCF responds to the Ndccf_DataManagement_Unsubscribe service operation with HTTP \"204 No Content\" status code, if the NF service consumer is successfully removed from the list of NF service consumers that are subscribed for these data.\n16a.\tIf the user consent changes and the DCCF has subscribed to UDM to notifications of user consent change for a user, the UDM invokes Nudm_SDM_Notification service operation by sending an HTTP POST request as described in clause 5.2.2.5 of 3GPP TS 29.503 [22].\n16b.\tThe DCCF responds to the Nudm_SDM_Notification service operation with \"204 No Content\".\n16c.\tThe DCCF may invoke Nudm_SDM_Unsubscribe service operation by sending an HTTP DELETE request as described in clause 5.2.2.4 of 3GPP TS 29.503 [22] to unsubscribe from UDM to be notified of user consent change for each user whose user consent is revoked.\n16d.\tIf the deletion request is accepted, the UDM responds to the Nudm_SDM_Unsubscribe service operation with \"204 No Content\".\n17a.\tIf there are no other NF service consumers subscribed to the data or the user consent for a user, i.e. for a SUPI or GPSI, is no longer granted, the DCCF invokes the Nnf_EventExposure_Unsubscribe service operation by sending an HTTP DELETE request message to the Data Source, e.g. as described in clause 5.5.2.3 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.3 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.4 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.3 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.3 in 3GPP TS 29.517 [12] for the AF.\n18a.\tThe Data Source responds to the Nnf_EventExposure_Unsubscribe service operation with HTTP \"204 No Content\" status code, if the data event(s) subscription is successfully removed.\n17b.\tIf the DCCF determines that no other NF service consumers require the historical data from the ADRF, the DCCF invokes the Nadrf_DataManagement_RetrievalUnsubscribe service operation by sending an HTTP DELETE request message to the ADRF as described in clause 4.2.2.7 of 3GPP TS 29.575 [16].\n18b.\tThe ADRF responds to the Nadrf_DataManagement_RetrievalUnsubscribe service operation with HTTP \"204 No Content\" status code, if the data retrieval subscription is successfully removed.\n17c.\tIf DCCF determines that no other NF service consumers require the historical data from the NWDAF, the DCCF invokes the Nnwdaf_DataManagement_Unsubscribe service operation by sending an HTTP DELETE request message to the NWDAF as described in clause 4.4.2.3 of 3GPP TS 29.520 [5].\n18c.\tThe NWDAF responds to the Nnwdaf_DataManagement_Unsubscribe service operation with HTTP \"204 No Content\" status code, if the data subscription is successfully removed.\nThis procedure depicted in Figure 5.5.3.2-1 is used by a data consumer (e.g. NWDAF) to obtain data and be notified of events using the DCCF and a Messaging Framework. The 3GPP DCCF Adaptor (3da) Data Management service and 3GPP Consumer Adaptor (3ca) Data Management service of the Messaging Framework Adaptor Function (MFAF) are used to interact with the Messaging Framework. Whether the data consumer directly contacts the Data Source or goes via the DCCF is based on configuration.\nThe figure depicts a data collection system using DCCF (Data Collection Communication Channel) and a messaging framework. It illustrates the communication between the data collection system and the messaging framework, highlighting the use of DCCF for data collection and the messaging framework for communication.\nFigure 5.5.3.2-1: Data Collection via DCCF and via Messaging Framework\n1.\tIn order to subscribe to notification(s) of events exposure via the DCCF based on local configuration, the Data Consumer invokes the Ndccf_DataManagement_Subscribe service operation by sending an HTTP POST request message targeting the resource \"DCCF Data Subscriptions\", as described in clause 4.2.2.2.4 of 3GPP TS 29.574 [15].\n2a.\tIf data is to be collected for a user, i.e. for a SUPI or GPSI, the user consent has not been checked by the data consumer, and local policy and regulations require to check user consent, the DCCF invokes Nudm_SDM_Get service operation by sending an HTTP GET request message targeting the resource \"AccessAndMobilitySubscriptionData\" at the UDM to request the data type \"User consent\" as described in clause 5.2.2.2 of 3GPP TS 29.503 [22]. Otherwise the procedure continues with step 4.\n3a.\tThe UDM responds to the Nudm_SDM_Get service operation. If the request is accepted, the response includes the requested data with \"200 OK\" status code. In subsequent steps, the DCCF excludes the SUPI or GPSI from requests to collect data for users for whom the user consent is not granted.\n2b.\tFor the users for which the user consent is granted, the DCCF subscribes to notifications of changes of the user consent by invoking the Nudm_SDM_Subscribe service operation by sending an HTTP POST request message targeting the resource \"SdmSubscriptions\" at the UDM as described in clause 5.2.2.3 of 3GPP TS 29.503 [22].\n3b.\tThe UDM responds to the Nudm_SDM_Subscribe service operation. If the request is accepted, the UDM responds with \"201 Created\" status code.\n4.\tIf the DCCF is configured to perform data delivery via the MFAF, in order to create configuration of mapping data in the MFAF, the DCCF shall invoke the Nmfaf_3daDataManagement_Configure service operation by sending an HTTP POST request message targeting the resource \"MFAF Configurations\", as described in clause 4.2.2.2.2 of 3GPP TS 29.576 [17].\nIn order to update configuration of mapping data in the MFAF, the DCCF shall invoke the Nmfaf_3daDataManagement_Configure service operation by sending an HTTP PUT request message targeting the resource \"Individual MFAF Configuration\", as described in clause 4.2.2.2.3 of 3GPP TS 29.576 [17].\n5.\tThe MFAF responds to the Nmfaf_3daDataManagement_Configure service operation.\nUpon receipt of the HTTP POST request message, if the configuration is accepted to be created, the MFAF responds to the DCCF with \"201 Created\" status code, and the URI of the created configuration is included in the Location header field.\nUpon receipt of the HTTP PUT request message, if the configuration is accepted to be updated, the MFAF responds to the DCCF with \"200 OK\" or \"204 No Content\" status code.\n6.\tThe DCCF determines the NF type(s) and/or OAM to retrieve the data based on the Service Operation requested in step 1. If the NF instance or NF Set ID is not provided by the data consumer. the DCCF determines the NF instances that can provide data as described in TS 23.288 [2] clause 5A.2 and clause 6.2.2.2. If the consumer requested storage of data in an ADRF but the ADRF ID is not provided by the data consumer, or the collected data is to be stored in an ADRF according to configuration on the DCCF, the DCCF selects an ADRF to store the collected data.\nThe DCCF keeps track of the data actively being collected from the Data Sources it is coordinating. The NWDAF or ADRF may register the data collection profile (including the data collection related Service Operation, Analytics/Data Specification, NWDAF ID or ADRF ID) with the DCCF. The DCCF may then determine whether certain historical data may be available in the NWDAF or ADRF based on the data collection profile and the request time window.\nIf the historical data handling is not applicable or not supported, the DCCF shall proceed with step 7a, and skip step 7b, step 8b, step 9b, step 7c, step 8c, and step 9c.\nIf the historical data is available in an ADRF, the DCCF shall proceed with step 7a and step 7b, and skip step 7c, step 8c, and step 9c.\nIf the historical data is available in an NWDAF, the DCCF shall proceed with step 7a and step 7c, and skip step 7b, step 8b, and step 9b.\n7a.\tThe DCCF shall determine whether the data requested in step 1 are already being collected.\nIf the data requested are already being collected by a data consumer, the DCCF adds the data consumer to the list of data consumers that are subscribed for these data.\nIf the DCCF determines that no subscriptions need to be created or modified (e.g. because all the data can be made available either via pre-existing subscriptions or because of the historical data handling) then step 8a and step 9a are skipped.\n8a.\tIf data requested in step 1 are not available yet, the DCCF shall invoke the Nnf_EventExposure_Subscribe service operation by sending an HTTP POST request message request to the NF targeting the resource representing event exposure subscriptions to subscribe to a new event exposure subscription, e.g. as described in clause 5.5.2.2 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.2 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.3 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.2 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.2 of 3GPP TS 29.517 [12] for the AF.\nOtherwise, if the requested data subscribed in step 1 partially matches data that is already being collected by the DCCF from an NF, and a modification of this subscription to the NF would satisfy both the existing data  subscriptions as well as the newly requested data, the DCCF shall send a request to the individual event exposure subscription resource to update an existing event exposure subscription, e.g. as described in clause 5.5.2.5 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.2.3 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.3.3 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.2.3 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.2.3 of 3GPP TS 29.517 [12] for the AF.\n9a.\tThe NF responds to the Nnf_EventExposure_Subscribe service operation.\nUpon receipt of the HTTP POST request message, if the subscription is accepted to be created, the NF responds to the DCCF with \"201 Created\" status code, and the URI of the created subscription is included in the Location header field.\nUpon receipt of the HTTP PUT request message, if the subscription is accepted to be updated, the NF responds to the DCCF with \"200 OK\" or \"204 No Content\" status code.\n7b.\tIf the historical data handling is applicable, and the DCCF determines to retrieve data from the ADRF, the DCCF shall determine which ADRF instances might provide the data.\n8b.\tIn order to retrieve the historical data from the ADRF, the DCCF shall invoke the Nadrf_DataManagement_RetrievalSubscribe service operation by sending an HTTP POST request message targeting the resource \"ADRF Data Retrieval Subscriptions\", as described in clause 4.2.2.6 of 3GPP TS 29.575 [16].\n9b.\tThe ADRF responds to the Nadrf_DataManagement_RetrievalSubscribe service operation.\nUpon receipt of the HTTP POST request message, if the subscription is accepted to be created, the ADRF responds to the DCCF with \"201 Created\" status code, and the URI of the created subscription is included in the Location header field.\n7c.\t If the historical data handling is applicable, and the DCCF determines to retrieve data from the NWDAF, the DCCF shall determine which NWDAF instances might provide the data.\n8c.\tIn order to retrieve the historical data from the NWDAF, the DCCF shall invoke the Nnwdaf_DataManagement_Subscribe service operation by sending an HTTP POST request message targeting the resource \"NWDAF Data Management Subscriptions\", as described in clause 4.4.2.2 of 3GPP TS 29.520 [5].\n9c.\tThe NWDAF responds to the Nnwdaf_DataManagement_Subscribe service operation.\nUpon receipt of the HTTP POST request message, if the subscription is accepted to be created, the NWDAF responds to the DCCF with \"201 Created\" status code, and the URI of the created subscription is included in the Location header field.\n10.\tThe DCCF responds to the Ndccf_DataManagement_Subscribe service operation with HTTP \"204 No Content\" status code.\n11a.\tWhen the data are available, the NF invokes the Nnf_EventExposure_Notify service operation by sending an HTTP POST request message to notify the data events to the MFAF, e.g. as described in clause 5.5.2.4 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.4 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.2 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.4 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.4 of 3GPP TS 29.517 [12] for the AF.\n12a.\tThe MFAF responds to the Nnf_EventExposure_Notify service operation with HTTP \"204 No Content\" status code.\n11b.\tWhen the historical data are available in the ADRF, the ADRF shall invoke the Nadrf_DataManagement_RetrievalNotify service operation by sending an HTTP POST request message to notify the historical data or Fetch Instructions to the MFAF as described in clause 4.2.2.8 of 3GPP TS 29.575 [16].\n12b.\tThe MFAF responds to the Nadrf_DataManagement_RetrievalNotify service operation with HTTP \"204 No Content\" status code.\n11c.\tWhen the historical data are available in the NWDAF, the NWDAF shall invoke the Nnwdaf_DataManagement_Notify service operation by sending an HTTP POST request message to notify the historical data to the MFAF as described in clause 4.4.2.4 of 3GPP TS 29.520 [5].\n12c.\tThe MFAF responds to the Nnwdaf_DataManagement_Notify service operation with HTTP \"204 No Content\" status code.\n13.\tThe MFAF invokes the Nmfaf_3caDataManagement_Notify service operation by sending HTTP POST request message(s) to send the data to all notification endpoints indicated in step 1. Data sent to notification endpoints may be processed and formatted by the MFAF so they conform to delivery requirements for each NF service consumer or notification endpoint.\nNOTE:\tAccording to Formatting Instructions provided by the NF service consumer, multiple notifications from a NF can be combined in a single Nmfaf_3caDataManagement_Notify so that many notifications from an NF results in fewer notifications (or one notification) to the Data Consumer. Alternatively, a notification can instruct the data notification endpoint to fetch the data from the MFAF.\n14.\tThe NF service consumer responds to the Nmfaf_3caDataManagement_Notify service operation with HTTP \"204 No Content\" status code.\n15.\tThe Data Consumer invokes the Nmfaf_3caDataManagement_Fetch service operation by sending an HTTP GET request message as described in clause 4.2.2.5 of 3GPP TS 29.574 [15] to fetch the data from the DCCF before an expiry time, if the fetch instruction was received in Nmfaf_3caDataManagement_Notify service operation in step 13.\n16.\tThe MFAF responds to the Nmfaf_3caDataManagement_Fetch service operation with HTTP \"200 OK\" status code with the message body containing the NmfafResourceRecord data structure.\n17.\tWhen the NF service consumer no longer needs the subscription to the requested data in step 1, it shall invoke the Ndccf_DataManagement_Unsubscribe service operation by sending an HTTP DELETE request message as described in clause 4.2.2.3.3 of 3GPP TS 29.574 [15]. The DCCF removes the NF service consumer from the list of NF service consumers that are subscribed for these data.\n18.\tThe DCCF responds to the Ndccf_DataManagement_Unsubscribe service operation with HTTP \"204 No Content\" status code, if the NF service consumer is successfully from the list of NF service consumers that are subscribed for these data.\n18a.\tIf the user consent changes and the DCCF has subscribed to UDM to notifications of user consent change for a user, the UDM invokes Nudm_SDM_Notification service operation by sending an HTTP POST request as described in clause 5.2.2.5 of 3GPP TS 29.503 [22].\n18b.\tThe DCCF responds to the Nudm_SDM_Notification service operation with \"204 No Content\".\n18c. The DCCF may invoke Nudm_SDM_Unsubscribe service operation by sending an HTTP DELETE request as described in clause 5.2.2.4 of 3GPP TS 29.503 [22] to unsubscribe from UDM to be notified of user consent change for each user whose user consent is revoked.\n18d.\tIf the deletion request is accepted, the UDM responds to the Nudm_SDM_Unsubscribe service operation with \"204 No Content\".\n19a.\tIf there are no other NF service consumers subscribed to the data or the user consent for a user, i.e. for a SUPI or GPSI, is no longer granted, the DCCF invokes the Nnf_EventExposure_Unsubscribe service operation by sending an HTTP DELETE request message to the Data Source, e.g. as described in clause 5.5.2.3 of 3GPP TS 29.503 [22] for the UDM, clause 5.3.2.3 of 3GPP TS 29.518 [18] for the AMF, clause 4.2.4 of 3GPP TS 29.508 [6] for the SMF, clause 4.2.2.3 of 3GPP TS 29.591 [11] for the NEF, or clause 4.2.3 in 3GPP TS 29.517 [12] for the AF.\n20a.\tThe Data Source responds to the Nnf_EventExposure_Unsubscribe service operation with HTTP \"204 No Content\" status code, if the data event(s) subscription is successfully removed.\n19b.\tIf DCCF determines that no other NF service consumers requiring the historical data from the ADRF, the DCCF may invoke the Nadrf_DataManagement_RetrievalUnsubscribe service operation by sending an HTTP DELETE request message to the ADRF as described in clause 4.2.2.7 of 3GPP TS 29.575 [16].\n20b.\tThe ADRF responds to the Nadrf_DataManagement_RetrievalUnsubscribe service operation with HTTP \"204 No Content\" status code, upon the data retrieval subscription is removed.\n19c.\tIf DCCF determines that no other NF service consumers require the historical data from the NWDAF, the DCCF may invoke the Nnwdaf_DataManagement_Unsubscribe service operation by sending an HTTP DELETE request message to the NWDAF as described in clause 4.4.2.3 of 3GPP TS 29.520 [5].\n20c.\tThe NWDAF responds to the Nnwdaf_DataManagement_Unsubscribe service operation with HTTP \"204 No Content\" status code, upon the data subscription is removed.\n19d.\tWhen the DCCF determines that an NF service consumer mapping has to be removed from MFAF, the DCCF invokes the Nmfaf_3daDataManagement_Deconfigure service operation by sending an HTTP DELETE request message to the MFAF as described in clause 4.2.2.3 of 3GPP TS 29.576 [17].\n20d.\tThe MFAF responds to the Nmfaf_3daDataManagement_Deconfigure service operation with HTTP \"204 No Content\" status code, if the individual resource linked to the delete request is successfully removed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.4\tProcedure for Data Collection in Roaming Case",
                            "text_content": "The procedure depicted in Figure 5.5.4.1-1 is used by the H-RE-NWDAF as service consumer to subscribe/unsubscribe to notifications about data event exposure from the VPLMN for outbound roaming users.\nThe figure depicts a network diagram illustrating the data collection process for outbound roaming users. It shows the H-RE-NWDAF and V-RE-NWDAF nodes, which are part of the network's data collection infrastructure. The diagram highlights the use of H-RE-NWDAF for data collection from V-RE-NWDAF, which is crucial for managing and analyzing data related to outbound roaming users.\nFigure 5.5.4.1-1: data collection by H-RE-NWDAF from V-RE-NWDAF for outbound roaming users\n1.\tFor subscription to collected data related to the outbound roaming UE(s), the H-RE-NWDAF checks the user consent of related users.\n2.\tThe H-RE-NWDAF of HPLMN discovers V-RE-NWDAF of VPLMN that supports the Nnwdaf_RoamingData service using the NRF as specified for roaming case in clause 5.8.2.3.\nNOTE 1:\tThe access to the Nnf_EventExposure services is expected to be restricted to NF service consumers within the same PLMN to prevent bypassing checks based on user consent and operator policy.\n3.\tThe H-RE-NWDAF subscribes/unsubscribes to notifications about data event exposure by invoking the Nnwdaf_RoamingData_Subscribe / Nnwdaf_RoamingData_Unsubscribe service operation message as described in clause 4.8.2.2 and clause 4.8.2.3 of 3GPP TS 29.520 [5].\n4a.\tThe V-RE-NWDAF checks whether the HPLMN is authorised to request the input data based on VPLMN operator polices (that may depend on the HPLMN and may indicate permissible or restricted input data and related parameters).\n4b.\tThe V-RE-NWDAF responds to the H-RE-NWDAF with Nnwdaf_RoamingData_Subscribe / Nnwdaf_RoamingData_Unsubscribe service operation message as described in clause 4.8.2.2 and clause 4.8.2.3 of 3GPP TS 29.520 [5].\n5.\tThe V-RE-NWDAF triggers new data collection from NF(s) as described in clause 5.5.1 or clause 5.5.1.\n6.\tThe V-RE-NWDAF may restrict the exposed input data based on VPLMN operator polices (that may depend on the HPLMN) and may store them for auditing.\n7a-7b.\tThe V-RE-NWDAF notifies data to the H-RE-NWDAF as described in clause 4.8.2.4 of 3GPP TS 29.520 [5].\nNOTE 2:\tFor details of Nnwdaf_RoamingData_Subscribe/Unsubscribe/Notify service operations refer to 3GPP TS 29.520 [5].\nThe procedure depicted in Figure 5.5.4.2-1 is used by the V-RE-NWDAF as service consumer to subscribe/unsubscribe to notifications about data event exposure from the HPLMN for inbound roaming users.\nThe figure depicts a network diagram illustrating the data collection process for inbound roaming users. It shows the various nodes and their connections, including the V-RE-NWDAF and H-RE-NWDAF, which are used to collect data from the H-RE-NWDAF for inbound roaming users. The diagram highlights the importance of network segmentation and redundancy to ensure reliable data collection and failover.\nFigure 5.5.4.2-1: Data Collection by V-RE-NWDAF from H-RE-NWDAF for inbound roaming users\n1.\tThe V-RE-NWDAF of VPLMN discovers H-RE-NWDAF of HPLMN that supports the Nnwdaf_RoamingData service using the NRF as specified in clause 5.8.2.3.\nNOTE 1:\tThe access to the Nnf_EventExposure services is expected to be restricted to NF service consumers within the same PLMN to prevent bypassing checks based on user consent and operator policy.\n2.\tThe V-RE-NWDAF subscribes/unsubscribes to data event exposure by invoking Nnwdaf_RoamingData_Subscribe / Nnwdaf_RoamingData_Unsubscribe service operation message as described in clause 4.8.2.2 and clause 4.8.2.3 of 3GPP TS 29.520 [5].\n3a.\tThe H-RE-NWDAF checks if the VPLMN is authorised to subscribe to the indicated input data based on HPLMN operator polices (that may depend on the VPLMN and may indicate permissible or restricted input data and related parameters) and user consent of related users.\n3b.\tThe H-RE-NWDAF responds to the V-RE-NWDAF with Nnwdaf_RoamingData_Subscribe / Nnwdaf_RoamingData_Unsubscribe service operation message as described in clause 4.8.2.2 and clause 4.8.2.3 of 3GPP TS 29.520 [5].\n4.\tThe H-RE-NWDAF triggers new data collection if needed and monitors the requested input data, using procedures as described in clauses 6.2.1 to 6.2.8.\n5.\tThe H-RE-NWDAF may restrict the exposed input data based on HPLMN operator polices (that may depend on the VPLMN) and may store them for auditing.\n6a-6b.\tThe H-RE-NWDAF notifies data event to the V-RE-NWDAF as described in clause 4.8.2.4 of 3GPP TS 29.520 [5].\nNOTE 2:\tFor details of Nnwdaf_RoamingData_Subscribe/Unsubscribe/Notify service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.6\tML Model provisioning procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.6.1\tGeneral",
                            "text_content": "The ML Model provisioning procedures allow the NF service consumers (i.e. NWDAF (MTLF+AnLF), NWDAF (AnLF)) to obtain the ML model information on the related Analytics from another NWDAF (i.e. an NWDAF containing MTLF).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6.2\tML Model Subscribe/Unsubscribe/Notify procedure",
                            "text_content": "The procedure is used by an NF service consumer to subscribe to/unsubscribe from the ML model information on the related Analytics on NWDAF containing MTLF, and also used by the NWDAF containing MTLF to notify the ML model information to the NF service consumer if it subscribed to the ML model information previously.\nThe figure depicts a simplified model of a machine learning (ML) model's subscribe/unsubscribe/notify procedure. It illustrates the steps involved in a typical ML model's lifecycle, including subscription, unsubscription, and notification. The figure is a simplified representation, highlighting the key components and their interactions.\nFigure 5.6.2-1: ML Model Subscribe/Unsubscribe/Notify procedure\n1.\tIn order to subscribe to ML model information, the NF service consumer invokes Nnwdaf_MLModelProvision_Subscribe service operation by sending an HTTP POST request targeting the resource \"NWDAF ML Model Provision Subscriptions\", as described in clause 4.5.2.2 of 3GPP TS 29.520 [5]. See 3GPP TS 29.520 [5] clause 5.4 for details.\nIn order to modify the existing subscription, the NF service consumer invokes Nnwdaf_MLModelProvision_Subscribe service operation by sending an HTTP PUT request with Resource URI of the resource \"Individual NWDAF ML Model Provision Subscription\".\n2.\tThe NWDAF containing MTLF responds to the Nnwdaf_MLModelProvision_Subscribe service operation. Upon receipt of the HTTP POST request, if the subscription is accepted to be created, the NWDAF containing MTLF responds to the NF service consumer with \"201 Created\", and the URI of the created subscription is included in the Location header field.\nUpon receipt of the HTTP PUT request, if the subscription is accepted to be updated, the NWDAF containing MTLF responds to the NF service consumer an HTTP \"200 OK\" with a response body containing a representation of the updated subscription or \"204 No Content\".\n3.\tIf the NWDAF containing MTLF determines that the subscribed ML model information is available, the NWDAF containing MTLF invokes Nnwdaf_MLModelProvision_Notify service operation to report the ML model information by sending an HTTP POST request to the NF service consumer identified by the notification URI received during the creation/modification of the subscriptions, as described in clause 4.5.2.4 of 3GPP TS 29.520 [5].\n4.\tThe NF service consumer responds to the NWDAF containing MTLF with an HTTP \"204 No Content\" message.\n5.\tIn order to unsubscribe from the notification(s) of the ML model information, the NF service consumer invokes Nnwdaf_MLModelProvision_Unsubscribe service operation by sending an HTTP DELETE request, which targets the resource \"Individual NWDAF ML Model Provision Subscription\", to the NWDAF containing MTLF.\n6.\tIf the request is accepted, the NWDAF containing MTLF deletes the subscription and responds to the NF service consumer with an HTTP \"204 No Content\" message.\nNOTE:\tFor details of Nnwdaf_MLModelProvision_Subscribe/Unsubscribe/Notify service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.6A\tML Model Training procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.6A.1\tGeneral",
                            "text_content": "The ML Model training procedures allow the NF service consumers (i.e. NWDAF containing MTLF) to subscribe to another NWDAF (i.e. an NWDAF containing MTLF) for a trained ML model and/or the information about ML model training based on the ML model file or ML Model information provided by the consumer and the data for the training.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6A.2\tML Model Training Subscribe/Unsubscribe/Notify procedure",
                            "text_content": "The procedure is used by an NF service consumer to subscribe to/unsubscribe from the ML model training, and also used by the NWDAF containing MTLF to notify the ML model and/or ML model training information to the NF service consumer if it subscribed to the ML model and/or ML model training information previously.\nThe figure depicts a step-by-step procedure for training a machine learning model, specifically a subscription/unsubscribe/notify system. It includes the steps to subscribe, unsubscribe, and notify users, as well as the necessary code to implement these procedures. The figure is a visual representation of the process, making it easier to understand and follow.\nFigure 5.6A.2-1: ML Model Training Subscribe/Unsubscribe/Notify procedure\n1.\tIn order to subscribe to ML model and/or ML model training information, the NF service consumer invokes Nnwdaf_MLModelTraining_Subscribe service operation by sending an HTTP POST request targeting the resource \"NWDAF ML Model Training Subscriptions\", as described in clause 4.6.2.2 of 3GPP TS 29.520 [5]. See 3GPP TS 29.520 [5] clause 5.5 for details.\nIn order to modify the existing subscription, the NF service consumer invokes Nnwdaf_MLModelTraining_Subscribe service operation by sending an HTTP PUT request or an HTTP PATCH request with Resource URI of the resource \"Individual NWDAF ML Model Training Subscription\".\n2.\tThe NWDAF containing MTLF responds to the Nnwdaf_MLModelTraining_Subscribe service operation. Upon receipt of the HTTP POST request, if the subscription is accepted to be created, the NWDAF containing MTLF responds to the NF service consumer with \"201 Created\", and the URI of the created subscription is included in the Location header field.\nUpon receipt of the HTTP PUT request or the HTTP PATCH request, if the subscription is accepted to be updated, the NWDAF containing MTLF responds to the NF service consumer an HTTP \"200 OK\" with a response body containing a representation of the updated subscription or \"204 No Content\".\n3.\tIf the NWDAF containing MTLF determines that the subscribed ML model and/or ML model training information is available, the NWDAF containing MTLF invokes Nnwdaf_MLModelTraining_Notify service operation to report the ML model and/or ML model training information by sending an HTTP POST request to the NF service consumer identified by the notification URI received during the creation/modification of the subscriptions, as described in clause 4.6.2.4 of 3GPP TS 29.520 [5].\n4.\tThe NF service consumer responds to the NWDAF containing MTLF with an HTTP \"204 No Content\" message.\n5.\tIn order to unsubscribe from the notification(s) of the ML model and/or ML model training information, the NF service consumer invokes Nnwdaf_MLModelTraining_Unsubscribe service operation by sending an HTTP DELETE request, which targets the resource \"Individual NWDAF ML Model Training Subscription\", to the NWDAF containing MTLF.\n6.\tIf the request is accepted, the NWDAF containing MTLF deletes the subscription and responds to the NF service consumer with an HTTP \"204 No Content\" message.\nNOTE:\tFor details of Nnwdaf_MLModelTraining_Subscribe/Unsubscribe/Notify service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.7\tProcedures for Specific Network Data Analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.7.1\tGeneral",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.2\tNetwork Slice (Instance) load level Analytics",
                            "text_content": "This procedure is used by the NF to obtain the network slice (instance) load level analytics which are calculated by the NWDAF based on the information collected from the NSACF, NRF, AMF, SMF and/or OAM. If the NF is an AF which is untrusted, the AF will request analytics via the NEF as described in clause 5.2.3.2.\nThe figure depicts a procedure for network slice (instance) load level analytics, illustrating the steps involved in analyzing the load of network slices in a network. The figure includes a flowchart with arrows indicating the sequence of actions, such as selecting a network slice, analyzing the load, and reporting the results. The figure is a visual representation of the process, making it easy to understand and follow.\nFigure 5.7.2-1: Procedure for Network Slice (Instance) load level Analytics\n1a.\tIn order to obtain the network slice (instance) load level analytics, the NF may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to obtain the network slice (instance) load level analytics, the NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2a-2b.\tIf the event is set to \"LOAD_LEVEL_INFORMATION\" or \"NSI_LOAD_LEVEL\", the NWDAF invokes Nnrf_NFDiscovery_Request service operation as described in clause 5.3.2.2 of 3GPP TS 29.510 [26] to discover the AMF, SMF and NSSF instance(s) relevant to the analytics filters provided in the subscription request. The NRF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\t(Only for \"NSI_LOAD_LEVEL\")The NWDAF may invoke Nnssf_NSSelection_Get service operation as described in clause 5.2.2.2 of 3GPP TS 29.531 [21] to obtain the NSI ID(s) corresponding to the S-NSSAI in the subscription request. The NRF responds to the NWDAF an HTTP \"201 Created\" response.\n4a-4b.\t(Only for \"NSI_LOAD_LEVEL\")The NWDAF may invoke Nnrf_NFManagement_NFStatusSubscribe service operation as described in clause 5.2.2.5 of 3GPP TS 29.510 [26] to subscribe to the resource usage information of a network slice instance obtained from its constituent NF instances. The NRF responds to the NWDAF an HTTP \"201 Created\" response.\n5a-5b. (Only for \"NSI_LOAD_LEVEL\")\tIf step 4a and step 4b are performed, the NRF may invoke Nnrf_NFManagement_NFStatusNotify service operation as described in clause 5.2.2.6 of 3GPP TS 29.510 [26]. The NWDAF responds to the NRF an HTTP \"204 No Content\" response.\n6a-6b.\tThe NWDAF may invoke Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to subscribe to the notification of individual UE registration/deregistration registered to an S-NSSAI or to an S-NSSAI and NSI ID, or request the total number of UEs served by the AMF per S-NSSAI or per S-NSSAI and NSI ID. The AMF responds to the NWDAF an HTTP \"201 Created\" response.\n7a-7b.\tIf step 6a and step 6b are performed, the AMF invokes Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518 [18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\" response.\n8a-8b.\tThe NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" to subscribe to the notification of individual PDU session established or PDU session released in an S-NSSAI or request the total number of PDU Sessions established in an S-NSSAI. The SMF responds to the NWDAF an HTTP \"201 Created\" response.\n9a-9b.\tIf step 8a and step 8b are performed, the SMF may invoke Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 8a. The NWDAF responds to the SMF an HTTP \"204 No Content\" response.\n10.\tThe NWDAF may collect \"Performance measurement\" to the OAM to get the mean number of UEs registered as described in clause 5.2.1 of TS 28.552 [27], mean number of PDU sessions established as described in clause 5.3.1 of TS 28.552 [27] and/or the resource usage information of a network slice instance obtained from its constituent NF instances as described in clause 6.2 of TS 28.552 [27]. (Obtaining the resource usage information of a network slice instance is only applicable for \"NSI_LOAD_LEVEL\" event).\n11a-11b.\tThe NWDAF may invoke Nnsacf_SliceEventExposure_Subscribe service operation as described in clause 5.3.2.2 of 3GPP TS 29.536 [20] to request the number of UEs registered to the network slice and/or the number of PDU sessions established to the network slice.\n12a-12b.\tThe NSACF may invoke Nnsacf_SliceEventExposure_Notify service operation as described in clause 5.3.2.4 of 3GPP TS 29.536 [20]. The NWDAF responds to the NSACF an HTTP \"204 No Content\" response.\n13.\tThe NWDAF calculates the network slice (instance) load level analytics based on the data collected from AMF, SMF, NRF, NSACF and/or OAM.\n14a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n14b-14c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n15a-15b.\tThe same as step 5a and step 5b.\n16a-16b.\tThe same as step 7a and step 7b.\n17a-17b.\tThe same as step 9a and step 9b.\n18.\tThe same as step 10.\n19a-19b.\tThe same as step 12a and step 12b.\n20.\tThe same as step 13.\n21a-21b.\tThe same as step 14b and step 14c.\nNOTE 1:\tFor details of Nsmf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.508 [6].\nNOTE 2:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.3\tObserved Service Experience Analytics",
                            "text_content": "This procedure is used by the NF to obtain the Service Experience analytics which are calculated by the NWDAF based on the information collected from the AMF, SMF, UPF, GMLC, AF, OAM and/or MDAF. If the NF is an AF which is untrusted, the AF will request analytics via the NEF as described in clause 5.2.3.2.\nThe figure depicts a step-by-step procedure for Service Experience Analytics (SEA), a methodology used to analyze and optimize the customer experience of a telecommunication service. The figure includes a flowchart that outlines the process, from identifying the customer's needs to analyzing the data and making recommendations for improvement. The use of arrows and boxes highlights the key steps, such as data collection, data analysis, and data visualization. The figure is a visual representation of the complex process involved in SEA, making it easy to understand and follow.\nFigure 5.7.3-1: Procedure for Service Experience Analytics\n1a.\tIn order to obtain the Service Experience analytics, the NF may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to obtain the Service Experience analytics, the NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2a-2b.\tIf the event is set to \"SERVICE_EXPERIENCE\", the NWDAF may invoke Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to subscribe to the notification of UE ID and UE location. The AMF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the AMF invokes Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518 [18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\" response.\n4a-4b.\tThe NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" to subscribe to the notification of QFI, IP filter information, DNAI, UPF information, Application ID, DNN and S-NSSAI. The SMF responds to the NWDAF an HTTP \"201 Created\" response.\n5a-5b.\tIf step 4a and step 4b are performed, the SMF may invoke Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 4a. The NWDAF responds to the SMF an HTTP \"204 No Content\" response.\n6a-6b.\tIf the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to request the service data and performance data from AF directly. The AF responds to the NWDAF an HTTP \"201 Created\" response.\n7a-7b.\tIf step 6a and step 6b are performed, the AF may invoke Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 6a. The NWDAF responds to the AF an HTTP \"204 No Content\" response.\n8a-8d.\tIf the AF is untrusted, the NWDAF may invoke Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP POST request targeting the resource \"Network Exposure Event Subscriptions\" and then the NEF invokes Naf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\". The AF responds to the NEF an HTTP \"201 Created\" response and then the NEF responds to the NWDAF an HTTP \"201 Created\" response.\n9a-9d.\tIf step 8a to step 8d are performed, the AF may invoke Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NEF identified by the notification URI received in step 8b and the NEF invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 8a. The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the NEF responds to the AF an HTTP \"204 No Content\" response.\n10a-10b.\tThe NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" as described in 3GPP TS 29.508 [6] to subscribe via the SMF to UPF information for a specific UE. The SMF subscribes to the UPF on behalf of the NWDAF using the Nupf_EventExposure_Subscribe service operation as described in 3GPP TS 29.564 [40] and, after having received the successful response from the UPF, it responds to the NWDAF with an HTTP \"201 Created\" response.\n11a-11b.\tIf step 10a and step 10b are performed, the UPF may invoke Nupf_EventExposure_Notify service operation as described in 3GPP TS 29.564 [40] by sending an HTTP POST request to the NWDAF identified by the notification URI provided in step 6a. The NWDAF responds to the UPF an HTTP \"204 No Content\" response.\n12a-12b.\tIf the NF requestes fine granularity location analytics information, the NWDAF may invoke Ngmlc_Location_ProvideLocation service operation to retrieve UE Location and UE Location Accuracy by sending an HTTP POST request to the URI associated with the \"provide-location\" custom operation as described in 3GPP TS 29.515 [41] clause 5.2.2.2. The GMLC responds to the NWDAF an HTTP \"201 Created\" response.\n13a-13b.\tIf step 12a and step 12b are performed, the GMLC may invoke Ngmlc_Location_EventNotify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 4a. The NWDAF responds to the GMLC an HTTP \"204 No Content\" response.\n14a.\tThe NWDAF may collect Reference Signal Received Power and Reference Signal Received Quality as specified in clause 5.5 of TS 38.331 [33] and clause 5.5.5 of TS 36.331 [34], Signal-to-noise and interference ratio as specified in clause 5.1 of TS 38.215 [35], the mapping information between cell ID and frequency and/or Cell Energy Saving State data as specified in clauses 3.1 and 6.2 of TS 28.310 [36] from OAM. If the NF is AF or NEF requesting per application analytics with UE granularity, the NWDAF may collect the average UL/DL RAN throughput, the UL/DL RAN packet delay and the UL/DL RAN Packet loss rate as described in clause 5.2.1.1 and 5.4.1.1 of TS 37.320 [29].\n14b.\tThe NWDAF may collect service experience and energy saving state analysis as specified in clause 8.4.2.1.3 and clause 8.4.4.3 of TS 28.104 [38] from MDAF. The information element of the analysis from MDAF include ServiceExperienceIssueType, AffectedObjects, ServiceExperienceStatistics, ServiceExperiencePredictions, and StatisticsOfCellsEsState.\n15.\tThe NWDAF calculates the Service Experience analytics based on the data collected from AMF, SMF, UPF, GMLC, AF, OAM and/or MDAF.\n16a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n16b-16c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n17a-17b.\tThe same as step 3a and step 3b.\n18a-18b.\tThe same as step 5a and step 5b.\n19a-19d.\tThe same as step 7a and step 7b.\n20a-20d.\tThe same as step 9a and step 9b.\n21a-21b.\tThe same as step 11a and step 11b.\n22a-22b.\tThe same as step 13a and step 13b.\n23.\tThe same as step 15.\n24a-24b.\tThe same as step 16b and step 16c.\nNOTE 1:\tFor details of Nsmf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.508 [6].\nNOTE 2:\tFor details of Nnef_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.591 [11].\nNOTE 3:\tFor details of Naf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.517 [12].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.4\tNF load Analytics",
                            "text_content": "This procedure is used by the NWDAF service consumer (may be an NF, or the OAM) to obtain the NF load analytics which are calculated by the NWDAF based on the information collected from the NRF and/or the OAM, may also collect UE input data via the AF (for the untrusted AF via the NEF). If target NF type is UPF, the NWDA may collect the information from UPF.\nFigure 5 illustrates the procedure for performing load analytics on a 4-1 network. The figure shows a step-by-step process for analyzing network load, including the identification of network components, the selection of load metrics, and the implementation of load analytics algorithms. The figure is crucial for network operators to understand the performance of their network and make informed decisions to optimize network resources and improve user experience.\nFigure 5.7.4-1: Procedure for NF load Analytics\n1a.\tIn order to obtain the NF load analytics, the NWDAF service consumer may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1, the requested event is set to \"NF_LOAD\" with the supported feature \"NfLoad\".\n1b-1c.\tIn order to obtain the NF load analytics, the NWDAF service consumer may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1, the subscribed event is set to \"NF_LOAD\" with the supported feature \"NfLoad\".\n2a-2b.\tThe NWDAF may invoke Nnrf_NFDiscovery_Request service operation as described in clause 5.3.2.2 of 3GPP TS 29.510 [26] for each NF, to obtain the initial NF profile which contains NF status and may contains NF load information. The NRF responds to the NWDAF an HTTP \"201 Created\" response.\n3.\tThe NWDAF may collect \"Performance measurement\" to the OAM to get the NF resource usage information as described in clause 5.7 of 3GPP TS 28.552 [27] and/or may collect the NF resource configuration change information as described in clause 5.2 of 3GPP TS 28.533 [28]. The NWDAF may also collect the MDT data information for UE as described in 3GPP TS 37.320 [29].\n4a-4b.\tThe NWDAF may invoke Nnrf_NFManagement_NFStatusSubscribe service operation as described in clause 5.2.2.5 of 3GPP TS 29.510 [26] to subscribe to the NF status and/or NF load information. The NRF responds to the NWDAF an HTTP \"201 Created\" response.\n5a-5b.\tIf step 4a and step 4b are performed, the NRF may invoke Nnrf_NFManagement_NFStatusNotify service operation as described in clause 5.2.2.6 of 3GPP TS 29.510 [26]. The NWDAF responds to the NRF an HTTP \"204 No Content\" response.\n6.\tIf the target NF type is UPF, the NWDAF may collect traffic usage report information from UPF.\nNOTE 1:\tHow the NWDAF collects UPF information is not defined in this release of the specification.\n7a-7b.\tIf the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe service operation to the AF directly by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to collect the Collective Behaviour of UEs. The AF responds to the NWDAF an HTTP \"201 Created\" response.\n8a-8b.\tIf step 7a and step 7b are performed, the AF invokes Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 7a. The NWDAF responds to the AF an HTTP \"204 No Content\" response.\n9a-9d.\tIf the AF is untrusted, the NWDAF may invoke Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP POST request targeting the resource \"Network Exposure Event Subscriptions\" and then the NEF invokes Naf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to collect the Collective Behaviour of UEs. The AF responds to the NEF an HTTP \"201 Created\" response and then the NEF responds to the NWDAF an HTTP \"201 Created\" response.\n10a-10d.\tIf step 9a to step 9d are performed, the AF invokes Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NEF identified by the notification URI received in step 9b and the NEF invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 9a. The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the NEF responds to the AF an HTTP \"204 No Content\" response.\n11.\tThe NWDAF calculates the NF load analytics based on the data collected from NRF, OAM, UPF and/or AF.\n12a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n12b-12c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n13.\tThe same as step 3.\n14a-14b.\tThe same as step 5a and step 5b.\n15.\tThe same as step 6.\n16a-16b.\tThe same as step 8a and step 8b.\n17a-17d.\tThe same as step 10a to step 10d.\n18.\tThe same as step 11.\n19a-19b.\tThe same as step 12b and step 12c.\nNOTE 2:\tFor details of Naf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.517 [12].\nNOTE 3:\tFor details of Nnef_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.591 [11].\nNOTE 4:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.5\tNetwork Performance Analytics",
                            "text_content": "This procedure is used by the NF to obtain the network performance analytics which are calculated by the NWDAF based on the information collected from the AMF, NRF and/or OAM. If the NF is an AF which is untrusted, the AF will request analytics via the NEF as described in clause 5.2.3.2.\nThe figure depicts a five-step procedure for network performance analytics, illustrating the steps involved in analyzing network performance.\nFigure 5.7.5-1: Procedure for Network Performance Analytics\n1a.\tIn order to obtain the network performance analytics, the NF may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to obtain the network performance analytics, the NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2a-2b.\tIf the event is set to \"NETWORK_PERFORMANCE\", the NWDAF may invoke Nnrf_NFManagement_NFStatusSubscribe service operation as described in clause 5.2.2.5 of 3GPP TS 29.510 [26] to subscribe to NF (e.g. SMF, UPF) load and status information. The NRF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the NRF may invoke Nnrf_NFManagement_NFStatusNotify service operation as described in clause 5.2.2.6 of 3GPP TS 29.510 [26]. The NWDAF responds to the NRF an HTTP \"204 No Content\" response.\n4a-4b.\tIf the event is set to \"NETWORK_PERFORMANCE\" and the type of network performance is set to \"NUM_OF_UE\", the NWDAF invokes Nnrf_NFDiscovery_Request service operation as described in clause 5.3.2.2 of 3GPP TS 29.510 [26] to discover the AMF(s) belonging to the AMF Region(s) that include(s) the Area of Interest. The NRF responds to the NWDAF an HTTP \"201 Created\" response.\n5a-5b.\tThe NWDAF may invoke Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to collect the number of UEs located in the Area of Interest from AMF. The AMF responds to the NWDAF an HTTP \"201 Created\" response.\n6a-6b.\tIf step 5a and step 5b are performed, the AMF invokes Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518 [18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\" response.\n7.\tThe NWDAF may collect \"Performance measurement\" to the OAM to get the status and load information and the performance per Cell Id in the Area of Interest as described in clause 5.1 of TS 28.552 [27].\n8.\tThe NWDAF calculates the network performance analytics based on the data collected from AMF, NRF and/or OAM.\n9a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n9b-9c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n10a-10b.\tThe same as step 3a and step 3b.\n11a-11b.\tThe same as step 6a and step 6b.\n12.\tThe same as step 7.\n13.\tThe same as step 8.\n14a-14b.\tThe same as step 9b and step 9c.\nNOTE:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.6\tUE Mobility Analytics",
                            "text_content": "This procedure is used by the NF to obtain UE mobility analytics, which is calculated by the NWDAF based on the information collected from the AMF, AF and/or OAM. If the NF is an AF which is untrusted, the AF will request analytics via the NEF as described in clause 5.2.3.2.\nThe figure depicts a procedure for analyzing the mobility of a user in a 5G network. It illustrates the steps involved in determining the user's location, such as using GPS signals, cellular network data, and other sources of information. The figure also shows how the data is processed and analyzed to provide insights into the user's movement patterns and potential areas of interest.\nFigure 5.7.6-1: Procedure for UE Mobility analytics\n1a.\tIn order to obtain the UE mobility analytics, the NF may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to obtain the UE mobility analytics, the NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2a-2b.\tThe NWDAF may invoke Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18]. This step may be skipped when e.g. the UE mobility information is available. The AMF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the AMF invokes Namf_EventExposure_Notify service operation as described in clause 5.3.2.4 of 3GPP TS 29.518 [18]. The NWDAF responds to the AMF an HTTP \"204 No Content\" response.\n4a-4b.\tIf the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe service operation to the AF directly by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\". The AF responds to the NWDAF an HTTP \"201 Created\" response.\n5a-5b.\tIf step 4a and step 4b are performed, the AF invokes Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 4a. The NWDAF responds to the AF an HTTP \"204 No Content\" response.\n6a-6d.\tIf the AF is untrusted, the NWDAF may invoke Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP POST request targeting the resource \"Network Exposure Event Subscriptions\" and then the NEF invokes Naf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\". The AF responds to the NEF an HTTP \"201 Created\" response and then the NEF responds to the NWDAF an HTTP \"201 Created\" response.\n7a-7d.\tIf step 6a to step 6d are performed, the AF invokes Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NEF identified by the notification URI received in step 6b and the NEF invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 6a. The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the NEF responds to the AF an HTTP \"204 No Content\" response.\n8.\tThe NWDAF may invoke \"streaming data reporting service reportStreamData\" service operation to the OAM as described in clause 12.5.1.1.5 of 3GPP TS 28.532 [19].\n9.\tThe NWDAF may invoke the \"File data reporting service subscribe\" service operation to the OAM as described in clause 12.6.1.1.3 of 3GPP TS 28.532 [19] or invoke \"File data reporting service listAvailableFiles\" service operation to the OAM as described in clause 12.6.1.1.2 of 3GPP TS 28.532 [19].\n10. The NWDAF calculates the requested UE mobility analytics based on the data collected from AMF, AF and/or OAM.\n11a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n11b-11c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n12a-12b.\tThe same as step 3a and step 3b.\n13a-13b.\tThe same as step 5a and step 5b.\n14a-14d.\tThe same as step 7a and step 7d.\n15.\tThe same as step 9.\n16.\tThe same as step 10.\n17a-17b.\tThe same as step 11b and step 11c.\nNOTE 1:\tFor details of Naf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.517 [12].\nNOTE 2:\tFor details of Nnef_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.591 [11].\nNOTE 3:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.7\tUE Communication Analytics",
                            "text_content": "This procedure is used by the NF to obtain UE communication analytics, which is calculated by the NWDAF based on the information collected from the AMF, SMF, UPF, and/or AF. If the NF is an AF which is untrusted, the AF will request analytics via the NEF as described in clause 5.2.3.2.\nThe figure depicts a procedure for analyzing user communication analytics in a 5G network, illustrating the steps involved in collecting, processing, and analyzing data from the network.\nFigure 5.7.7-1: Procedure for UE Communication analytics\n1a.\tIn order to obtain the UE communication analytics, the NF may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to obtain the UE communication analytics, the NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2a-2b.\tThe NWDAF may invoke Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to retrieve one or more Type Allocation codes, UE connection management state, UE access behaviour trends and UE location trends from AMF. The AMF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the AMF may invoke Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518 [18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\" response.\n4a-4b.\tThe NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" to request the information of the UE and/or N4 session related data to calculate the analytics. The SMF responds to the NWDAF an HTTP \"201 Created\" response.\n5a-5b.\tIf step 4a and step 4b are performed, the SMF may invoke Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 4a. The NWDAF responds to the SMF an HTTP \"204 No Content\" response.\n6a-6b.\tThe NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" as described in 3GPP TS 29.508 [6] to subscribe via the SMF to UPF information for a specific UE. The SMF subscribes to the UPF on behalf of the NWDAF using the Nupf_EventExposure_Subscribe service operation as described in 3GPP TS 29.564 [40] and, after having received the successful response from the UPF, it responds to the NWDAF with an HTTP \"201 Created\" response.\n7a-7b.\tIf step 6a and step 6b are performed, the UPF may invoke Nupf_EventExposure_Notify service operation as described in 3GPP TS 29.564 [40] by sending an HTTP POST request to the NWDAF identified by the notification URI provided in step 6a. The NWDAF responds to the UPF an HTTP \"204 No Content\" response.\n8a-8b.\tIf the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to request the service data from AF directly. The AF responds to the NWDAF an HTTP \"201 Created\" response.\n9a-9b.\tIf step 8a and step 8b are performed, the AF may invoke Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 8a. The NWDAF responds to the AF an HTTP \"204 No Content\" response.\n10a-10d.\tIf the AF is untrusted, the NWDAF may invoke Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP POST request targeting the resource \"Network Exposure Event Subscriptions\" and then the NEF invokes Naf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\". The AF responds to the NEF an HTTP \"201 Created\" response and then the NEF responds to the NWDAF an HTTP \"201 Created\" response.\n11a-11d.\tIf step 10a to step 10d are performed, the AF may invoke Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NEF identified by the notification URI received in step 8b and the NEF invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 8a. The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the NEF responds to the AF an HTTP \"204 No Content\" response.\n12. The NWDAF calculates the requested UE communication analytics based on the data collected from AMF, SMF, UPF and/or AF.\n13a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n13b-13c.\tIf step 1b and step 1c are performed, the NWDAF may invoke Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n14a-14b.\tThe same as step 3a and step 3b.\n15a-15b.\tThe same as step 5a and step 5b.\n16a-16b.\tThe same as step 7a and step 7b.\n17a-17b.\tThe same as step 9a and step 9b.\n18a-18d.\tThe same as step 11a and step 11d.\n19.\tThe same as step 12.\n20a-20b.\tThe same as step 13b and step 13c.\nNOTE 1:\tFor details of Nsmf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.508 [6].\nNOTE 2:\tFor details of Naf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.517 [12].\nNOTE 3:\tFor details of Nnef_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.591 [11].\nNOTE 4:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.8\tExpected UE behavioural Analytics",
                            "text_content": "This procedure is used by the NF to obtain the expected UE behavioural parameters, which are calculated by the NWDAF based on the information collected from the AMF, SMF, AF and/or OAM. If the NF is an AF which is untrusted, the AF will request analytics via the NEF as described in clause 5.2.3.2.\nThe figure depicts a procedure for expected behavioral analytics, illustrating the steps involved in analyzing the expected behavior of a system. The figure includes a flowchart with arrows indicating the sequence of actions, a list of steps, and a table with data points for each step. The table shows the expected values for each step, providing a clear and concise representation of the expected behavior.\nFigure 5.7.8-1: Procedure for Expected behavioural Analytics\n1a.\tIn order to obtain the expected UE behavioural parameters, the NF may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to obtain expected UE behavioural parameters, the NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2a.\tIf the event is set to \"UE_MOBILITY\", the NWDAF collects data from AMF, AF and/or OAM as described in clause 5.7.6 from step 2a to step 9.\n2b.\tIf the event is set to \"UE_COMM\", the NWDAF collects data from AMF, SMF and/or AF as described in clause 5.7.7 from step 2a to step 9d.\n3. The NWDAF calculates the expected UE behavioural parameters based on the collected data from AMF, SMF, AF and/or OAM.\n4a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n4b-4c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n5a-5b.\tThe AMF, SMF, AF and/or OAM send the notifications to the NWDAF if it has subscribed to the related events in step 2a or step 2b.\n6.\tThe same as step 3.\n7a-7b.\tThe same as step 4b and step 4c.\nNOTE:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.9\tAbnormal UE behavioural Analytics",
                            "text_content": "This procedure is used by the NF to obtain the abnormal UE behavioural analytics which are calculated by the NWDAF based on the information collected from the AMF, SMF, AF and/or OAM. If the NF is an AF which is untrusted, the AF will request analytics via the NEF as described in clause 5.2.3.2.\nThe figure depicts a procedure for abnormal UE behavioral analytics, illustrating the steps involved in analyzing user behavior in a 5G network.\nFigure 5.7.9-1: Procedure for Abnormal UE behavioural Analytics\n1a.\tIn order to obtain the abnormal UE behavioural parameters, the NF may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to obtain abnormal UE behavioural parameters, the NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2a.\tIf the event is set to \"ABNORMAL_BEHAVIOUR\" and the expected UE analytics type is set to \"MOBILITY\" or \"MOBILITY_AND_COMMUN\", or the list of exception IDs includes \"UNEXPECTED_UE_LOCATION\", \"PING_PONG_ACROSS_CELLS\", \"UNEXPECTED_RADIO_LINK_FAILURES\", or \"UNEXPECTED_WAKEUP\", the NWDAF collects data from AMF, AF and/or OAM as described in clause 5.7.6 from step 2a to step 9.\n2b.\tIf the event is set to \"ABNORMAL_BEHAVIOUR\" and the expected UE analytics type is set to \"COMMUN\" or \"MOBILITY_AND_COMMUN\", or the list of exception IDs includes \"SUSPICION_OF_DDOS_ATTACK\", \"UNEXPECTED_LONG_LIVE_FLOW\", \"UNEXPECTED_LARGE_RATE_FLOW\", \"WRONG_DESTINATION_ADDRESS\", \"TOO_FREQUENT_SERVICE_ACCESS\" or \"UNEXPECTED_WAKEUP\", the NWDAF collects data from AMF, SMF and/or AF as described in clause 5.7.7 from step 2a to step 9d.\n3.\tThe NWDAF calculates the abnormal UE behavioural parameters based on the collected data from AMF, SMF, AF and/or OAM.\n4a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n4b-4c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n5a-5b.\tThe AMF, SMF, AF and/or OAM send the notifications to the NWDAF if it has subscribed to the related events in step 2a or step 2b.\n6.\tThe same as step 3.\n7a-7b.\tThe same as step 4b and step 4c.\nNOTE:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.10\tUser Data Congestion Analytics",
                            "text_content": "This procedure is used by the NWDAF service consumer (may be an NF e.g. NEF, AF, or PCF) to obtain the User Data Congestion analytics which are calculated by the NWDAF based on the information collected from the AMF, OAM, UPF and/or AF.\nThe figure depicts a procedure for analyzing user data congestion in a 5G network. It illustrates the steps involved in identifying and mitigating congestion issues, such as signal loss, packet loss, and latency. The figure includes a flowchart and a matrix to represent the data flow and the network topology, respectively. The matrix shows the number of users, the number of packets per user, and the number of packets per second, providing a visual representation of the network's performance. The figure also includes a legend to explain the different colors and symbols used in the matrix. Overall, the figure serves as a practical guide for network operators to understand and manage user data congestion in a 5G network.\nFigure 5.7.10-1: Procedure for User Data Congestion Analytics\n1a.\tIn order to obtain the User Data Congestion analytics, the NWDAF service consumer may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1, the requested event is set to \"USER_DATA_CONGESTION\" with the supported feature \"UserDataCongestion\".\n1b-1c.\tIn order to obtain the User Data Congestion analytics, the NWDAF service consumer may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1, the subscribed event is set to \"USER_DATA_CONGESTION\" with the supported feature \"UserDataCongestion\".\n2a-2b.\tThe NWDAF may invoke Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to retrieve the UE location information. The AMF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the AMF may invoke Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518 [18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\" response.\n4.\tThe NWDAF may collect \"Performance measurement\" to the OAM to get the Performance Measurements that will be used by the NWDAF to determine congestion levels. Performance Measurements are related to information transfer over the user plane and/or the control plane (e.g. UE Throughput, DRB Setup Management, RRC Connection Number, PDU Session Management, and Radio Resource Utilization as defined in 3GPP TS 28.552 [27]). The NWDAF may obtain measurements by invoking management services that are defined in 3GPP TS 28.532 [19] and 3GPP TS 28.550 [31].\n5.\tThe NWDAF may collect data related to User Data Congestion analytics information from UPF.\nNOTE 1:\tHow the NWDAF collects UPF information is not defined in this release of the specification.\n6a-6b.\tIf the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe service operation to the AF directly by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to collect the data related to User Data Congestion analytics information. The AF responds to the NWDAF an HTTP \"201 Created\" response.\n7a-7b.\tIf step 6a and step 6b are performed, the AF invokes Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 6a. The NWDAF responds to the AF an HTTP \"204 No Content\" response.\n8a-8d.\tIf the AF is untrusted, the NWDAF may invoke Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP POST request targeting the resource \"Network Exposure Event Subscriptions\" and then the NEF invokes Naf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to collect the data related to User Data Congestion analytics information. The AF responds to the NEF an HTTP \"201 Created\" response and then the NEF responds to the NWDAF an HTTP \"201 Created\" response.\n9a-9d.\tIf step 8a to step 8d are performed, the AF invokes Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NEF identified by the notification URI received in step 8b and the NEF invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 8a. The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the NEF responds to the AF an HTTP \"204 No Content\" response.\n10.\tThe NWDAF calculates the User Data Congestion analytics based on the data collected from AMF, OAM, UPF and/or AF.\n11a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n11b-11c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n12a-12b.\tThe same as step 3a and step 3b.\n13.\tThe same as step 4.\n14.\tThe same as step 5.\n15a-15b.\tThe same as step 7a and step 7b.\n16a-16d.\tThe same as step 9a to step 9d.\n17.\tThe same as step 10.\n18a-18b.\tThe same as step 11b and step 11c.\nNOTE 2:\tFor details of Naf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.517 [12].\nNOTE 3:\tFor details of Nnef_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.591 [11].\nNOTE 4:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.11\tQoS Sustainability Analytics",
                            "text_content": "This procedure is used by the NWDAF service consumer (maybe an NF, e.g. AF) to obtain the QoS Sustainability analytics, which are calculated by the NWDAF based on the information collected from the OAM, for a path of interest or for an area of interest with coarse granularity (i.e. TAIs or Cell IDs).\nThe figure depicts a procedure for QoS sustainability in telecommunication networks, illustrating the steps involved in maintaining high-quality service levels. The figure includes a flowchart with various stages, such as network monitoring, network optimization, and network management, to ensure the continuous improvement of QoS.\nFigure 5.7.11-1: Procedure for QoS Sustainability Analytics\n1a.\tIn order to obtain the QoS sustainability analytics, the NWDAF service consumer may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1, the requested event is sent to \"QOS_SUSTAINABILITY\" with the supported feature \"QoSSustainability\".\n1b-1c.\tIn order to obtain the QoS sustainability analytics, the NWDAF service consumer may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1, the subscribed event is set to \"QOS_SUSTAINABILITY\" with the supported feature \"QoSSustainability\".\n2.\tThe NWDAF may collect \"Performance measurement\" to the OAM to get the RAN UE Throughput in clause 6.3.6 of 3GPP TS 28.554 [30], QoS flow Retainability information as described in clause 6.5.1 of 3GPP TS 28.554 [30]. If the \"QoSSustainabilityExt_eNA\" feature is supported, the NWDAF may collect the average UL/DL packet transmission delay through RAN part to the UE as described in clause 6.3.1.2 of 3GPP TS 28.554 [30], the UL/DL packet delay on GTP path on N3 for non-GBR traffic, the UL/DL capacity measurement from UPF to NG-RAN or from UE to UPF based on GTP path, and the UL/DL available capacity measurement from UPF to NG-RAN or from UE to UPF based on GTP path as described in clause 5.1 and clause 5.4 of 3GPP TS 28.552 [27].\n3.\tThe NWDAF calculates the QoS sustainability analytics based on the data collected from OAM.\n4a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n4b-4c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n5.\tThe same as step 2.\n6.\tThe same as step 3.\n7a-7b.\tThe same as step 4b and step 4c.\nNOTE:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.12\tDispersion Analytics",
                            "text_content": "This procedure is used by the NWDAF service consumer to obtain the dispersion analytics which are calculated by the NWDAF based on the information collected from the AMF, SMF, UPF and/or AF.\nThe figure depicts a procedure for dispersion analytics, illustrating the steps involved in analyzing the dispersion of signals in a 5G network. The figure includes a base station (gNB), user equipment (UE), and scatterers, with key components such as beamforming techniques to mitigate interference and the use of optical fiber-optic backbone architecture for redundancy.\nFigure 5.7.12-1: Procedure for Dispersion Analytics\n1a.\tIn order to obtain the Dispersion analytics, the NWDAF service consumer may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1, the requested event is set to \"DISPERSION\" with the supported feature \"Dispersion\".\n1b-1c.\tIn order to obtain the Dispersion analytics, the NWDAF service consumer may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1, the subscribed event is set to \"DISPERSION\" with the supported feature \"Dispersion\".\n2a-2b.\tThe NWDAF may invoke Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to retrieve the location and/or slice based UE transactions dispersion information. The AMF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the AMF may invoke Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518 [18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\" response.\n4a-4b.\tThe NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" to subscribe to the notification of UE transactions dispersion information which may be slice based. The SMF responds to the NWDAF an HTTP \"201 Created\" response.\n5a-5b.\tIf step 4a and step 4b are performed, the SMF may invoke Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 4a. The NWDAF responds to the SMF an HTTP \"204 No Content\" response.\n6a-6c.\tThe NWDAF may subscribe to collect UE data volume dispersion information from the serving UPF either via the SMF (by performing steps 6a1, 6a2, 6a3, and 6a4, which are the same as steps 3a, 4a, 4b, and 3b of clause 5.7.17) or directly to the UPF (by performing steps 6b1, 6b2, which are the same as steps 5a and 5b of clause 5.7.17). Then, the UPF may invoke the Nupf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI provided in step 6a1 or step 6b1 and the NWDAF responds to the UPF with an HTTP \"204 No Content\" response as described in 3GPP TS 29.564 [40].\nNOTE 1:\tHow the NWDAF collects UPF information is not defined in this release of the specification.\n7a-7b.\tIf the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe service operation to the AF directly by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to collect the UE data volume dispersion information. The AF responds to the NWDAF an HTTP \"201 Created\" response.\n8a-8b.\tIf step 7a and step 7b are performed, the AF invokes Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 7a. The NWDAF responds to the AF an HTTP \"204 No Content\" response.\n9a-9d.\tIf the AF is untrusted, the NWDAF may invoke Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP POST request targeting the resource \"Network Exposure Event Subscriptions\" and then the NEF invokes Naf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to collect the UE data volume dispersion information. The AF responds to the NEF an HTTP \"201 Created\" response and then the NEF responds to the NWDAF an HTTP \"201 Created\" response.\n10a-10d.\tIf step 9a to step 9d are performed, the AF invokes Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NEF identified by the notification URI received in step 8b and the NEF invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 9a. The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the NEF responds to the AF an HTTP \"204 No Content\" response.\n11.\tThe NWDAF calculates the Dispersion analytics based on the data collected from AMF, SMF, UPF and/or AF.\n12a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n12b-12c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n13a-13b.\tThe same as step 3a and step 3b.\n14a-14b.\tThe same as step 5a and step 5b.\n15a-15b.\tThe same as step 6c1and step 6c2.\n16a-16b.\tThe same as step 8a and step 8b.\n17a-17d.\tThe same as step 10a to step 10d.\n18.\tThe same as step 11.\n19a-19b.\tThe same as step 12b and step 12c.\nNOTE 2:\tFor details of Nsmf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.508 [6].\nNOTE 3:\tFor details of Naf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.517 [12].\nNOTE 4:\tFor details of Nnef_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.591 [11].\nNOTE 5:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.13\tWLAN Performance Analytics",
                            "text_content": "This procedure is used by the NWDAF service consumer to obtain the WLAN performance analytics which are calculated by the NWDAF based on the information collected from the SMF, UPF and/or OAM. If the NF is an AF which is untrusted, the AF will request analytics via the NEF as described in clause 5.2.3.2.\nThe figure depicts a step-by-step procedure for WLAN performance analytics, illustrating the process of analyzing WLAN performance. It includes a step-by-step guide to identify and troubleshoot issues, as well as a visual representation of the steps involved.\nFigure 5.7.13-1: Procedure for WLAN Performance Analytics\n1a.\tIn order to obtain the WLAN performance analytics, the NWDAF service consumer may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1, the requested event is set to \"WLAN_PERFORMANCE\" with the supported feature \"WlanPerformance\".\n1b-1c.\tIn order to obtain the WLAN performance analytics, the NWDAF service consumer may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1, the subscribed event is set to \"WLAN_PERFORMANCE\" with the supported feature \"WlanPerformance\".\n2a-2b.\tThe NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" to subscribe to the notification of Information on PDU Session for WLAN. The SMF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the SMF may invoke Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 2a. The NWDAF responds to the SMF an HTTP \"204 No Content\" response.\n4.\tThe NWDAF may subscribe to collect UE communications information for WLAN from the UPF either via the SMF (by performing steps 6a1, 6a2, 6a3, and 6a4, which are the same as steps 3a, 4a, 4b, and 3b of clause 5.7.17) or directly to the UPF (by performing steps 6b1, 6b2, which are the same as steps 5a and 5b of clause 5.7.17). Then, the UPF may invoke the Nupf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI provided in step 6a1 or step 6b1 and the NWDAF responds to the UPF with an HTTP \"204 No Content\" response as described in 3GPP TS 29.564 [40].\n5.\tThe NWDAF may collect WLAN measurement results from the OAM. The WLAN measurement data from OAM is collected via MDT and aligned with the WLAN measurement reporting list described in clause 5.1.1.3.3 of TS 37.320 [29].\n6.\tThe NWDAF calculates the WLAN performance analytics based on the data collected from SMF, UPF and/or OAM.\n7a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n7b-7c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n8a-8b.\tThe same as step 3a and step 3b.\n9a-9b.\tThe same as step 4c1and step 6c2.\n10.\tThe same as step 5.\n11.\tThe same as step 6.\n12a-12b.\tThe same as step 7b and step 7c.\nNOTE 1:\tFor details of Nsmf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.508 [6].\nNOTE 2:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.14\tSession Management Congestion Control Experience Analytics",
                            "text_content": "This procedure is used by the NWDAF service consumer e.g. SMF to obtain the Session Management Congestion Control Experience Analytics which are calculated by the NWDAF based on the information collected from the SMF.\nThe figure depicts a procedure for Session Management Congestion Control Experience Analytics, which is a key component of 5G network management. It illustrates the steps involved in managing congestion in 5G networks, including session management, experience analytics, and control mechanisms. The figure shows the flow of data packets through the network, highlighting the importance of efficient routing and control to ensure smooth operation.\nFigure 5.7.14-1: Procedure for Session Management Congestion Control Experience Analytics\n1a.\tIn order to obtain the SMCCE (Session Management Congestion Control Experience) analytics, the NWDAF service consumer may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1, the requested event is set to \"SM_CONGESTION\" with the supported feature \"SMCCE\".\n1b-1c.\tIn order to obtain the SMCCE (Session Management Congestion Control Experience) analytics, the NWDAF service consumer may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1, the subscribed event is set to \"SM_CONGESTION\" with the supported feature \"SMCCE\".\n2a-2b.\tThe NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" to subscribe to the notification of Information on UE ID and SMCC experience for PDU Session. The SMF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the SMF may invoke Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 2a. The NWDAF responds to the SMF an HTTP \"204 No Content\" response.\n4.\tThe NWDAF calculates the Session Management Congestion Control Experience analytics based on the data collected from SMF.\n5a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n5b-5c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\nNOTE 1:\tFor details of Nsmf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.508 [6].\nNOTE 2:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify and Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.15\tRedundant Transmission Experience Analytics",
                            "text_content": "This procedure is used by the NWDAF service consumer (may be an NF e.g. SMF) to obtain the Redundant Transmission Experience Analytics which are calculated by the NWDAF based on the information collected from the AMF, AF, SMF, UPF OAM and/or MDAF.\nThe figure depicts a procedure for redundant transmission experience, illustrating the steps taken to ensure reliable and uninterrupted communication in a 5G network. The diagram includes key components such as the base station (gNB), user equipment (UE), and scatterers, which are essential for signal propagation and reception. The figure also highlights the use of beamforming techniques to mitigate interference, ensuring a smooth and uninterrupted communication experience.\nFigure 5.7.15-1: Procedure for Redundant Transmission Experience Analytics\n1a.\tIn order to obtain the Redundant Transmission Experience Analytics, the NWDAF service consumer may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1, the requested event is set to \"RED_TRANS_EXP\" with the supported feature \"RedundantTransmissionExp\".\n1b-1c.\tIn order to obtain the Redundant Transmission Experience Analytics, the NWDAF service consumer may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1, the subscribed event is set to \"RED_TRANS_EXP\" with the supported feature \"RedundantTransmissionExp\".\n2a-2b.\tThe NWDAF may invoke Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to retrieve the UE Mobility information. The AMF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the AMF may invoke Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518 [18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\" response.\n4a-4b.\tThe NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" to subscribe to the notification of Information related to PDU Session established with redundant transmission. The SMF responds to the NWDAF an HTTP \"201 Created\" response.\n5a-5b.\tIf step 4a and step 4b are performed, the SMF may invoke Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 4a. The NWDAF responds to the SMF an HTTP \"204 No Content\" response.\n6.\tThe NWDAF may collect data related to packet delay measurement information from UPF either via the SMF (by performing steps 6a1, 6a2, 6a3, and 6a4, which are the same as steps 3a, 4a, 4b, and 3b of clause 5.7.17) or directly to the UPF (by performing steps 6b1, 6b2, which are the same as steps 5a and 5b of clause 5.7.17). Then, the UPF may invoke the Nupf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI provided in step 6a1 or step 6b1 and the NWDAF responds to the UPF with an HTTP \"204 No Content\" response as described in 3GPP TS 29.564 [40].\n7a.\tThe NWDAF may collect \"Performance measurement\" to the OAM to get the UL/DL packet drop rate on GTP path on N3, UL/DL packet delay measurement on GTP path on N3 and/or UL/DL packet drop/loss rate of RAN part measurement refer to clause 5.1 of TS 28.552 [27] for the performance measurement in NG-RAN.\n7b.\tThe NWDAF may collect end-to-end analysis as specified in clause 8.4.2.4.3 of TS 28.104 [38] from MDAF. The information element of the analysis from MDAF include E2ELatencyIssueType and AffectedObjects.\n8a-8b.\tIf the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe service operation to the AF directly by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to collect the service data related to UE mobility information. The AF responds to the NWDAF an HTTP \"201 Created\" response.\n9a-9b.\tIf step 8a and step 8b are performed, the AF invokes Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 8a. The NWDAF responds to the AF an HTTP \"204 No Content\" response.\n10a-10d.\tIf the AF is untrusted, the NWDAF may invoke Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP POST request targeting the resource \"Network Exposure Event Subscriptions\" and then the NEF invokes Naf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to collect the service data related to UE mobility information. The AF responds to the NEF an HTTP \"201 Created\" response and then the NEF responds to the NWDAF an HTTP \"201 Created\" response.\n11a-11d.\tIf step 10a to step 10d are performed, the AF invokes Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NEF identified by the notification URI received in step 10b and the NEF invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 10a. The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the NEF responds to the AF an HTTP \"204 No Content\" response.\n12.\tThe NWDAF calculates the Redundant Transmission Experience Analytics based on the data collected from AMF, AF SMF, UPF OAM and/or MDAF.\n13a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n13b-13c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n14a-14b.\tThe same as step 3a and step 3b.\n15a-15b.\tThe same as step 5a and step 5b.\n16a-16b.\tThe same as step 6c1 and step 6c2.\n17.\tThe same as step 7.\n18a-18b.\tThe same as step 9a and step 9b.\n19a-18d.\tThe same as step 11a and step 11d.\n20.\tThe same as step 12.\n21a-21b.\tThe same as step 13b and step 13c.\nNOTE 1:\tFor details of Naf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.517 [12].\nNOTE 2:\tFor details of Nsmf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.508 [6].\nNOTE 3:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.16\tDN Performance Analytics",
                            "text_content": "This procedure is used by the NF to obtain DN performance analytics, which is calculated by the NWDAF based on the information collected from the AMF, SMF, AF, UPF and/or OAM. If the NF is an AF which is untrusted, the AF will request analytics via the NEF as described in clause 5.2.3.2.\nThe figure depicts a procedure for DN (Data Network) performance analytics, illustrating the steps involved in analyzing data network performance. It includes a flowchart that outlines the process, from data collection to analysis, and provides visual cues to guide the user through the steps.\nFigure 5.7.16-1: Procedure for DN Performance Analytics\n1a.\tIn order to obtain the DN performance analytics, the NF may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to obtain the DN performance analytics, the NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2a-2b.\tThe NWDAF may invoke Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to retrieve the UE location information and SUPI(s) from AMF. The AMF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the AMF may invoke Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518 [18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\" response.\n4a-4b.\tThe NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" to request DNN, S-NSSAI, application ID, UPF info, DNAI, IP filter information and QFI. The SMF responds to the NWDAF an HTTP \"201 Created\" response.\n5a-5b.\tIf step 4a and step 4b are performed, the SMF may invoke Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 4a. The NWDAF responds to the SMF an HTTP \"204 No Content\" response.\n6.\tThe NWDAF may collect performance data from AF as described in clause 5.7.7 from step 6a to step 9d.\n7.\tThe NWDAF may collect QoS flow bit rate, QoS flow packet delay, packet transmission and packet retransmission information from UPF.\nNOTE 1:\tHow NWDAF collects UE communication related data from UPF is not defined in this Release of the specification.\n8.\tThe NWDAF may collect Reference Signal Received Power and Reference Signal Received Quality as specified in clause 5.5 of TS 38.331 [33] and clause 5.5.5 of TS 36.331 [34], Signal-to-noise and interference ratio as specified in clause 5.1 of TS 38.215 [35], the mapping information between cell ID and frequency and Cell Energy Saving State data as specified in clauses 3.1 and 6.2 of TS 28.310 [36] from OAM.\n9. The NWDAF calculates the DN performance analytics based on the data collected from AMF, SMF, AF, UPF and/or OAM.\n10a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n10b-10c.\tIf step 1b and step 1c are performed, the NWDAF may invoke Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n11a-11b.\tThe same as step 3a and step 3b.\n12a-12b.\tThe same as step 5a and step 5b.\n13.\tThe same as step 6.\n14.\tThe same as step 9.\n15a-15b.\tThe same as step 10b and step 10c.\nNOTE 2:\tFor details of Nsmf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.508 [6].\nNOTE 3:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.17\tPFD Determination Analytics",
                            "text_content": "This procedure is used by the NWDAF service consumer e.g. NEF(PFDF) to obtain PFD determination analytics for the know application(s), which is calculated by the NWDAF based on the information collected from the UPF and the NEF(PFDF).\nFigure 5 illustrates the procedure for performing PFD (Power Factor) determination analytics, which is an essential step in ensuring the proper functioning of electrical systems. The figure shows a step-by-step process for analyzing the power factor of a circuit, including the use of a power factor analyzer (PFA) and a power factor correction (PFC) circuit. The PFA measures the power factor of the circuit, while the PFC circuit corrects the power factor to improve the overall efficiency of the electrical system. This figure is crucial for maintaining the reliability and performance of electrical systems, as it helps to identify and correct any issues that may arise due to imbalances in power flow.\nFigure 5.7.17-1: Procedure for PFD Determination Analytics\n1a.\tIn order to obtain the PFD determination analytics, the consumer NF may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to obtain the PFD determination analytics, the consumer NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2a-2b.\tThe NWDAF invokes Nnef_PFDManagement_Fetch service operation as described in clause 4.2.2 of 3GPP TS 29.551 [39] by sending an HTTP POST request targeting the resource \"Individual application PFD\" to retrieve PFDs for an Application Identifier(s) from the NEF (PFDF). The NEF (PFDF) responds to the NWDAF an HTTP \"200 OK\" response, with the content containing a representation of an \"Individual application PFD\" resource or a \"PFD of applications\" resource for the requested application identifier(s).\n3.\tThe NWDAF determines whether it needs to collect data and, if needed, it collects the data either directly from the UPF or indirectly via the SMF and identifies the SMF(s) and/or UPF(s) to retrieve the data.\n3a-3b.\t[Option 1] The NWDAF invokes Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" to retrieve the IP flow related information for the application. The SMF responds to the NWDAF an HTTP \"201 Created\" response.\n4a-4b.\tThe SMF invokes Nupf_EventExposure_Subscribe service operation as described in clause 5.2.2.2 of 3GPP TS 29.564 [40] to retrieve the IP flow related information for the application from UPF. The UPF responds to the SMF an HTTP \"201 Created\" response.\n5a-5b.\t[Option 2] The NWDAF directly invokes Nupf_EventExposure_Subscribe service operation as described in clause 5.2.2.2 of 3GPP TS 29.564 [40] to retrieve the IP flow related information for the application from UPF. The UPF responds to the NWDAF an HTTP \"201 Created\" response.\n6a-6b.\tThe UPF invokes Nupf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 4a or step 5a. The NWDAF responds to the UPF an HTTP \"204 No Content\" response.\n7.\tThe NWDAF calculates the PFD determination analytics based on the data collected from UPF and NEF (PFDF).\n8a.\tIf step 1a is performed, the NWDAF sends the Nnwdaf_AnalyticsInfo_Request response as described in clause 5.2.3.1, with HTTP \"204 No Content\" response if the NWDAF decides no PFD data to be updated or newly reported; or with HTTP \"200 OK\" response containing the PFD determination analytics in the case that the NWDAF decides the PFD information for the existing Application ID is new or to be updated.\n8b-8c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1 containing the PFD determination analytics information in the case that the NWDAF decides the PFD information for the existing Application ID is new or to be updated.\nNOTE 1:\tFor details of Nsmf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.508 [6].\nNOTE 2:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\nNOTE 3:\tFor details of Nnef_PFDManagement_Fetch service operation refer to 3GPP TS 29.551 [39].\nNOTE 4:\tFor details of Nupf_EventExposure_Subscribe/Unsubscribe/Notify service operations refer to 3GPP TS 29.564 [40].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.18\tE2E data volume transfer time analytics",
                            "text_content": "This procedure is used by the NWDAF service consumer (may be an NF e.g. AF or NEF)  to obtain E2E (end-to-end) data volume transfer time analytics, which is calculated by the NWDAF based on the information collected from the AMF, SMF, AF, and/or OAM. If the NF is an AF which is untrusted, the AF will request analytics via the NEF as described in clause 5.2.3.2.\nThe figure depicts a procedure for E2E data volume transfer time analytics, illustrating the steps involved in analyzing the time it takes for data to travel from source to destination. The figure includes a flow chart with arrows indicating the sequence of steps, such as data collection, data processing, and data analysis. The use of color-coded arrows and labels helps to visually represent the steps and their order, making it easier to understand the process. The figure also includes a legend to explain the different colors and symbols used in the flow chart, further aiding in the interpretation of the data transfer time analytics process.\nFigure 5.7.17-1: Procedure for E2E data volume transfer time analytics\n1a.\tIn order to obtain the E2E data volume transfer time analytics, the NWDAF service consumer may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to obtain the E2E data volume transfer time analytics, the NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2a-2b.\tThe NWDAF may invoke Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to retrieve the UE location information and SUPI(s) from AMF. The AMF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the AMF may invoke Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518 [18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\" response.\n4a-4b.\tThe NWDAF may invoke Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" to request DNN, S-NSSAI, application ID, QoS flow packet delay, and QFI. The SMF responds to the NWDAF an HTTP \"201 Created\" response.\n5a-5b.\tIf step 4a and step 4b are performed, the SMF may invoke Nsmf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 4a. The NWDAF responds to the SMF an HTTP \"204 No Content\" response.\n6a-6b.\tIf the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe service operation to the AF directly by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to collect the End-to-end data volume transfer time information. The AF responds to the NWDAF an HTTP \"201 Created\" response.\n7a-7b.\tIf step 6a and step 6b are performed, the AF invokes Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 7a. The NWDAF responds to the AF an HTTP \"204 No Content\" response.\n8a-8d.\tIf the AF is untrusted, the NWDAF may invoke Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP POST request targeting the resource \"Network Exposure Event Subscriptions\" and then the NEF invokes Naf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to collect the E2E data volume transfer time information. The AF responds to the NEF an HTTP \"201 Created\" response and then the NEF responds to the NWDAF an HTTP \"201 Created\" response.\n9a-9d.\tIf step 8a to step 8d are performed, the AF invokes Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NEF identified by the notification URI received in step 8b and the NEF invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 9a. The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the NEF responds to the AF an HTTP \"204 No Content\" response.\n10.\tThe NWDAF may collect RAN part delay in clause 6.3.1.2, and 6.3.1.7 of TS 28.554 [30], RAN Throughput for DL and UL in clauses 5.2.1.1 and 5.4.1.1 of TS 37.320 [29], RAN Packet delay for DL and UL per QCI per UE packet delay as specified in clauses 5.2.1.1 of TS 37.320 [29] and and per DRB per UE packet delay as specified in clauses 5.4.1.1 of TS 37.320 [29]. RAN Packet loss rate for DL and UL including the per QCI per UE packet loss rate as specified in clauses 5.2.1.1 of TS 37.320 [29] and the per DRB per UE packet loss rate as specified in clauses 5.4.1.1 of TS 37.320 [29], the distribution of UL/DL/round trip packet delay between PSA UPF and UE as captured in TS 28.552 [27]. from OAM.\n11. The NWDAF calculates the End-to-end data volume transfer time analytics based on the data collected from AMF, SMF, AF, and/or OAM.\n12a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n12b-12c.\tIf step 1b and step 1c are performed, the NWDAF may invoke Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\nNOTE 1:\tFor details of Nsmf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.508 [6].\nNOTE 2:\tFor details of Naf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.517 [12].\nNOTE 3:\tFor details of Nnef_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.591 [11].\nNOTE 4:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.19\tPDU Session Traffic Analytics",
                            "text_content": "This procedure is used by the NWDAF service consumer (e.g. PCF) to subscribe or request PDU Session Traffic analytics statistics on whether traffic of UEs via one or multiple PDU sessions is according to the information provided by the service consumer.\nFigure 5.7.19-1: Procedure for PDU Session Traffic Analytics\n1a.\tIn order to obtain the PDU Session Traffic analytics, the NWDAF service consumer (e.g. PCF) may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to obtain the PDU Session Traffic analytics, the NWDAF service consumer (e.g. PCF) may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2.\tThe NWDAF determines whether it needs to collect the data and, if needed, it collects the data either directly from the UPF or indirectly via the SMF and identifies the SMF(s) and/or UPF(s) to retrieve the data.\n3a-3b.\t[Option 1] The NWDAF invokes Nsmf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"SMF Notification Subscriptions\" to retrieve \"UserDataUsageMeasures\" UPF event for the S-NSSAI/DNN and SUPI(s). The SMF responds to the NWDAF an HTTP \"201 Created\" response.\n4a-4b.\tThe SMF invokes Nupf_EventExposure_Subscribe service operation as described in clause 5.2.2.2 of 3GPP TS 29.564 [40] to retrieve \"UserDataUsageMeasures\" UPF event for the S-NSSAI/DNN and SUPI(s) from the UPF. The UPF responds to the SMF an HTTP \"201 Created\" response.\n5a-5b.\t[Option 2] The NWDAF directly invokes Nupf_EventExposure_Subscribe service operation as described in clause 5.2.2.2 of 3GPP TS 29.564 [40] to retrieve \"UserDataUsageMeasures\" UPF event for the S-NSSAI/DNN and SUPI(s) from the UPF. The UPF responds to the NWDAF an HTTP \"201 Created\" response.\n6a-6b.\tThe UPF invokes Nupf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 4a or step 5a. The NWDAF responds to the UPF an HTTP \"204 No Content\" response.\n7.\tThe NWDAF derives analytics indicating a list of UEs and the traffic they route according to the provided information provided by the consumer (i.e. Traffic Descriptor, S-NSSAI and DNN), including its volume and the traffic they route and a list of UEs which route traffic that it is not expected according to the information provided by the consumer (i.e. Traffic Descriptor, S-NSSAI and DNN) including its volume.).\n8a.\tIf step 1a is performed, the NWDAF sends the Nnwdaf_AnalyticsInfo_Request response containing the PDU Session Traffic analytics as described in clause 5.2.3.1.\n8b-8c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation containing the PDU Session Traffic analytics as described in clause 5.2.2.1.\nNOTE 1:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\nNOTE 2:\tFor details of Nsmf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.508 [6].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.20\tRelative Proximity Analytics",
                            "text_content": "This procedure is used by the NWDAF service consumer e.g. NEF or AF to obtain Relative Proximity Analytics among UEs provided by NWDAF to assist more accurately localize a cluster (or a set) of UEs via provisioning statistics and/or prediction information related to their relative proximity.\nRelative Proximity Analytics is a technique used in network management to analyze the proximity of devices to each other, which can be used to improve network performance and security.\nFigure 5.7.20-1: Procedure for Relative Proximity Analytics\n1a.\tIn order to obtain the Relative Proximity Analytics, the NF may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to subscribe to the Relative Proximity Analytics, the NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2a-2b.\tIf the event is set to \"RELATIVE_PROXIMITY\" and the subscription/request is authorized, the NWDAF may invoke Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to subscribe to the notification of UE ID and UE location. The AMF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the AMF invokes Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518 [18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\" response.\n4a-4b.\tThe NWDAF may invoke Ngmlc_Location_ProvideLocation service operation to retrieve UE Location and UE Location Accuracy by sending an HTTP POST request to the URI associated with the \"provide-location\" custom operation as described in 3GPP TS 29.515 [41] clause 5.2.2.2. The GMLC responds to the NWDAF an HTTP \"201 Created\" response.\n5a-5b.\tIf step 4a and step 4b are performed, the GMLC may invoke Ngmlc_Location_EventNotify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 4a. The NWDAF responds to the GMLC an HTTP \"204 No Content\" response.\n6a-6b.\tIf the AF is trusted, the NWDAF may invoke Naf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\" to subscribe the Proximity attributes and/or Proximity related input data of UE(s) from AF directly. The AF responds to the NWDAF an HTTP \"201 Created\" response.\n7a-7b.\tIf step 6a and step 6b are performed, the AF may invoke Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 6a. The NWDAF responds to the AF an HTTP \"204 No Content\" response.\n8a-8d.\tIf the AF is untrusted, the NWDAF may invoke Nnef_EventExposure_Subscribe service operation to the NEF by sending an HTTP POST request targeting the resource \"Network Exposure Event Subscriptions\" and then the NEF invokes Naf_EventExposure_Subscribe service operation by sending an HTTP POST request targeting the resource \"Application Event Subscriptions\". The AF responds to the NEF an HTTP \"201 Created\" response and then the NEF responds to the NWDAF an HTTP \"201 Created\" response.\n9a-9d.\tIf step 8a to step 8d are performed, the AF may invoke Naf_EventExposure_Notify service operation by sending an HTTP POST request to the NEF identified by the notification URI received in step 8b and the NEF invokes Nnef_EventExposure_Notify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 8a. The NWDAF responds to the NEF an HTTP \"204 No Content\" response and then the NEF responds to the AF an HTTP \"204 No Content\" response.\n10.\tThe NWDAF may collect Per UE information of Speed and Orientation related input data as specified in clause 4.3.30 of TS 28.622 [42], clause 11.1 of TS 28.532 [19] and clause 5.10.29 of TS 32.422 [43].\n11.\tThe NWDAF derives the Relative Proximity Analytics based on the data collected from AMF, GMLC, (DC)AF, and/or OAM.\n12a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n12b-12c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\n13a-13b.\tThe same as step 3a and step 3b.\n14a-14b.\tThe same as step 5a and step 5b.\n15a-15b.\tThe same as step 7a and step 7b.\n16a-16d.\tThe same as step 9a and step 9b.\n17.\tThe same as step 10.\n18.\tThe same as step 11.\n19a-19b.\tThe same as step 12b and step 12c.\nNOTE 1:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\nNOTE 2:\tFor details of Nnef_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.591 [11].\nNOTE 3:\tFor details of Naf_EventExposure_Subscribe/Notify service operations refer to 3GPP TS 29.517 [12].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.21\tMovement Behaviour Analytics",
                            "text_content": "This procedure is used by the NWDAF service consumer e.g. NEF or AF to obtain Movement Behaviour Analytics provided by NWDAF regarding the location, direction and velocity of UEs during an analytics target period in a target area.\nThe figure depicts a procedure for movement behavior analytics, illustrating the steps involved in analyzing the movement behavior of a system. It includes a flowchart that outlines the process, with key steps such as data collection, data analysis, and decision-making. The figure is essential for understanding the methodology and ensuring efficient and effective movement behavior analysis in various systems.\nFigure 5.7.21-1: Procedure for Movement Behaviour Analytics\n1a.\tIn order to obtain the Movement Behaviour Analytics, the NF may invoke Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n1b-1c.\tIn order to subscribe to the Movement Behaviour Analytics, the NF may invoke Nnwdaf_EventsSubscription_Subscribe service operation as described in clause 5.2.2.1.\n2a-2b.\tIf the event is set to \"MOVEMENT_BEHAVIOUR\" and the subscription/request is authorized, the NWDAF may invoke Namf_EventExposure_Subscribe service operation as described in clause 5.3.2.2.2 of 3GPP TS 29.518 [18] to subscribe to the notification of UE ID and UE positions. The AMF responds to the NWDAF an HTTP \"201 Created\" response.\n3a-3b.\tIf step 2a and step 2b are performed, the AMF invokes Namf_EventExposure_Notify service operation as described in 3GPP TS 29.518 [18] clause 5.3.2.4. The NWDAF responds to the AMF an HTTP \"204 No Content\" response.\n4a-4b.\tThe NWDAF may invoke Ngmlc_Location_ProvideLocation service operation to retrieve UE Fine granularity locations by sending an HTTP POST request to the URI associated with the \"provide-location\" custom operation as described in 3GPP TS 29.515 [41] clause 5.2.2.2. The GMLC responds to the NWDAF an HTTP \"201 Created\" response.\n5a-5b.\tIf step 4a and step 4b are performed, the GMLC may invoke Ngmlc_Location_EventNotify service operation by sending an HTTP POST request to the NWDAF identified by the notification URI received in step 4a. The NWDAF responds to the GMLC an HTTP \"204 No Content\" response.\n6.\tThe NWDAF derives the Movement Behaviour Analytics based on the data collected from AMF and/or GMLC.\n7a.\tIf step 1a is performed, the NWDAF responds to the Nnwdaf_AnalyticsInfo_Request service operation as described in clause 5.2.3.1.\n7b-7c.\tIf step 1b and step 1c are performed, the NWDAF invokes Nnwdaf_EventsSusbcription_Notify service operation as described in clause 5.2.2.1.\nNOTE:\tFor details of Nnwdaf_EventsSubscription_Subscribe/Unsubscribe/Notify or Nnwdaf_AnalyticsInfo_Request service operations refer to 3GPP TS 29.520 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.8\tProcedures for NWDAF Discovery and Selection",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.8.1\tGeneral",
                            "text_content": "NWDAF may be deployed in multiple configuration options. Not all these configurations require the same registration, discovery and selection procedures. The discovery and selection may depend on the NWDAF deployment option and the types of analytics it procedures, (i.e., whether it is related to Network Functions or to UEs) or the data that is able to collect from NFs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.8.2\tProcedures related to NRF",
                            "text_content": "NWDAF (de-)registers in NRF as a regular network function. See TS 29.510 [23] for details.\nA consumer of analytics services may use the NRF for discovering an NWDAF containing AnLF or MTLF.\nIf the NWDAF service consumer needs to discover an NWDAF containing AnLF that is able to collect data from particular data sources identified by their NF Set IDs or NF types, the consumer may query NRF with the Nnrf_NFDiscovery_NFDiscover service operation, providing the NF Set IDs (serving-nf-set-id attribute) or NF types (serving-nf-type attribute) in the discovery request. See 3GPP TS 29.510 [23] for details.\nIf the NWDAF service consumer (NWDAF containing MTLF) needs to discover an NWDAF containing MTLF that support Federated Learning identified by their FL capability (i.e. FL server or FL client), the consumer may query NRF with the Nnrf_NFDiscovery_NFDiscover service operation for discovery of FL Server NWDAF (NWDAF containing MTLF) or FL Client NWDAF (NWDAF containing MTLF). See 3GPP TS 29.510 [23] for details.\nIf the NWDAF service consumer needs to discover an NWDAF containing MTLF that is able to provide ML model provisioning services with trained ML models available for one or more Analytics ID(s), the consumer may query NRF with the Nnrf_NFDiscovery_NFDiscover service operation for discovery of NWDAF containing the required trained ML model. See 3GPP TS 29.510 [23] for details.\nIn the roaming architecture, a consumer in the same PLMN as the RE-NWDAF discovers the RE-NWDAF by querying for an NWDAF where the roaming exchange capability is indicated in its NRF profile. A consumer in a peer PLMN (i.e. RE-NWDAF) discovers the RE-NWDAF by querying for an NWDAF in the target PLMN that is supporting the specific services defined for roaming. A RE-NWDAF discovers the RE-NWDAF in a different PLMN (i.e. HPLMN or VPLMN) using the procedure defined in clause 4.17.5 (if delegated discovery is not used) or clause 4.17.10 (if delegated discovery is used) of TS 23.502 [3], where the detailed parameters are determined based on the analytics request or subscription from the consumer 5GC NF, operator policy, user consent and/or local configuration. See 3GPP TS 29.510 [23] for details.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.8.3\tProcedures related to UDM",
                            "text_content": "For UE-related analytics or for analytics that involve UE-related data collection, an NWDAF containing AnLF may register in UDM using the Nudm_UECM_Register service operation (see TS 29.503 [22] clause 5.3.2.2.8). This is useful especially in scenarios of co-location of the NWDAF containing AnLF with other network functions (e.g., AMF, SMF) and in certain deployment models. Figure 5.8.3.2.1-1 illustrates the signalling flow.\nThe figure depicts a network-wide data flow (NWDAF) with AnLF registration in UDM, illustrating the flow of data from the source to the destination.\nFigure 5.8.3.2.1-1: NWDAF containing AnLF registration in UDM\n1.\tNWDAF containing AnLF triggers a registration in UDM, e.g. based on local configuration in the NWDAF containing AnLF, the reception of a new Analytics subscription request, start of collection of UE related data or an OAM configuration action.\n2.\tThe NWDAF containing AnLF registers into UDM for the served UE, by sending Nudm_UECM_Registration request (UE ID of the served user, NWDAF Instance ID, NF Set ID, Analytics ID(s)).\n3.\tUDM sends a response to NWDAF containing AnLF. A successful response consists of a \"200 OK\" or \"201 Created\". If the operation is unsuccessful, UDM responds with proper error response code. See TS 29.503 [22] for details.\nIf an NWDAF containing AnLF has previously registered in UDM for one or more analytics IDs for a given UE, the NWDAF containing AnLF may modify the registration at any time. This may be due to, e.g., the NWDAF containing AnLF adds one or more Analytic IDs for the UE, or the NWDAF containing AnLF removes one or more Analytics IDs, but keep registered in UDM for at least one Analytic ID. The NWDAF containing AnLF sends an Nudm_UECM_Update service operation (NWDAF registration ID, added or removed Analytics ID(s)), see TS 29.503 [22] clause 5.3.2.6.4. Figure 5.8.3.2.2-1 illustrates the signalling flow.\nThe figure depicts a network-wide data flow update in the NWDAF (Network Wide Data Flow Update) process, which is a key component of the AnLF (Anomaly-based Load Forecasting) system. The update involves the registration of anomalies in the UDM (Unified Data Management) database, which is used to monitor and manage network data. The figure illustrates the process of updating the database with new data, ensuring that the system is up-to-date and accurate.\nFigure 5.8.3.2.2-1: NWDAF containing AnLF registration update in UDM\n1.\tIf an NWDAF containing AnLF has previously registered one or more Analytics IDs for a UE in UDM, the NWDAF containing AnLF triggers an update of the registration in UDM, e.g. based on the NWDAF containing AnLF serving the UE of one or more additional Analytic ID(s) or based on the NWDAF containing AnLF not serving the UE for one or more Analytic ID(s) but serving the UE for at least one Analytic ID.\n2.\tThe NWDAF containing AnLF updates its registration in UDM for the served UE, by sending Nudm_UECM_Update request (NWDAF Registration Id, added or removed Analytic ID(s)).\n3.\tUpon success UDM sends a \"204 No Content\" response to the NWDAF containing AnLF. If the operation is unsuccessful, UDM responds with proper error response code. See TS 29.503 [22] for details.\nIf an NWDAF containing AnLF has previously registered in UDM for one or more analytics ID for a given UE, when the NWDAF containing AnLF no longer serves the UE, e.g., it does not collect data for the UE for that Analytics ID or does no keep produce analytic reports or does not keep any data related to the UE, the NWDAF containing AnLF should de-register from UDM by invoking the Nudm_UECM_Deregistration service operation (NWDAF registration ID, Analytics ID(s)), see TS 29.503 [22] clause 5.3.2.4.8). Figure 5.8.3.2.3-1 illustrates the signalling flow.\nThe figure depicts a network-wide deregistration process for the AnLF (Anomalous Low Frequency) signal, which is a key component in the NWDAF (Network Wide Deactivation) scheme. The process involves deregistering the AnLF signal from the UDM (Universal Time Division Multiple Access) network, ensuring that only the required signals are active. This is crucial for maintaining network stability and performance.\nFigure 5.8.3.2.3-1: NWDAF containing AnLF deregistration from UDM\n1.\tIf an NWDAF containing AnLF has previously registered one or more Analytics IDs for a UE in UDM, the NWDAF containing AnLF triggers a complete deregistration from UDM, e.g. based on the NWDAF containing AnLF not collecting data any longer for the UE, or the NWDAF containing AnLF not producing analytics reports for the UE, or the NWDAF containing AnLF not keeping analytics data for the UE.\n2.\tThe NWDAF containing AnLF deregisters from UDM for the served UE, by sending Nudm_UECM_Deregistration request (NWDAF Registration Id).\n3.\tUDM sends a \"204 No Content\" response to the NWDAF containing AnLF. See TS 29.503 [22] for details.\nFor UE related analytics, if the NWDAF service consumer needs to discover an NWDAF containing AnLF that is serving or holds data for a UE, the NWDAF serving consumer may query UDM with the target SUPI and the Analytics ID. If the response from UDM indicates multiple candidate NWDAFs, the NWDAF service consumer may, e.g., determine an instance of an NWDAF containing AnLF that has registered in UDM (registrationTime attribute) around the time of interest of the data or analytics, and may also query NRF, as specified in clause 5.8.2.3 in order to determine the capabilities of these NWDAFs and select the most appropriate one. Figure 5.8.3.3-1 illustrates the signalling flow.\nThe figure depicts a network traffic flow (NWDAF) with AnLF (Anomalous Local Forwarding) in UDM (User Data Management) traffic. The figure illustrates the discovery of the anomaly, which is a critical step in network traffic analysis.\nFigure 5.8.3.3-1: Discovery of NWDAF containing AnLF in UDM\n1.\tThe NWDAF service consumer sends an Nudm_UECM_Get request to the UDM (UE ID, Analytics ID(s), NF type = NWDAF).\n2.\tUpon success, UDM sends a \"200 OK\" response to the service consumer including the NWDAF information registered for the UE ID. If the operation is unsuccessful, UDM responds with proper error response code. See TS 29.503 [22] for details.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.8.4\tProcedures for PCF learning NWDAF IDs for served UEs",
                            "text_content": "PCF may receive from AMF and SMF the IDs of the NWDAFs containing AnLF that are used by AMF, SMF, and UPF, so that the PCF may select the same NWDAF containing AnLF being used for a specific UE.\nWhen the AMF creates or updates an Access and Mobility Policy Association for a UE, the AMF may include the IDs of the NWDAF containing AnLF that are used by the AMF, along with their Analytic ID(s), in the Npcf_AMPolicyControl_Create/Update service operations, as illustrated in Figure 5.8.4-1. See details in TS 29.507 [24].\nThe figure depicts a 5G network with various components, including base stations (gNB), user equipment (UE), and scatterers. The diagram illustrates the signal propagation in a 5G network, highlighting the multi-path signal propagation and beamforming techniques to mitigate interference. The fiber-optic backbone architecture is also shown, with core switches, optical line terminals (OLTs), and distributed nodes. The layered design aligns with SDN principles, providing redundancy and failover reliability.\nFigure 5.8.4-1: PCF leaning from AMF NWDAFs containing AnLF\nThe PCF may select those NWDAF instances discovered through the Npcf_AMPolicyControl_Create/Update request as the ones to use for their associated analytic ID(s) for the UE for which those AM Policy Associations are related to.\nWhen the SMF creates or updates a Session Management Policy Association for a UE, the SMF may include the IDs of the NWDAF containing AnLF that are used by the SMF and UPF, along with their Analytic ID(s), in the Npcf_SMPolicyControl_Create/Update service operations, as illustrated in Figure 5.8.4-2. See details in TS 29.512 [25].\nThe figure depicts a 5G network with various components, including PCF (Passive Cellular Femtocells), SMF (Small-cell Femtocells), and UPF (Ultra-dense Femtocells). An LF (Long-Term Evolution) leaning from an SMF and an UPF NWDAF (Near-Wall Distributed Antenna System) containing an AnLF (Antenna Line Fading Unit) are shown. This figure illustrates the integration of these components to provide high-speed and reliable wireless connectivity in a 5G network.\nFigure 5.8.4-2: PCF leaning from SMF and UPF NWDAFs containing AnLF\nThe PCF may select those NWDAF instances discovered through the Npcf_SMPoliycControl_Create/Update request as the ones to subscribe for their associated analytic ID(s) for the UE for which those SM Policy Associations are related to.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.9\tAnalytics Data Repository procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.9.1\tGeneral",
                            "text_content": "The Analytics Data Repository procedures allow the NF service consumers (e.g. NWDAF, DCCF or MFAF) to store, retrieve or delete collected data and analytics in the ADRF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.9.2\tHistorical Data and Analytics Storage/Retrieval/Deletion procedure",
                            "text_content": "The procedure is used by an NF service consumer (e.g. NWDAF, DCCF or MFAF) to store, retrieve or delete historical data and/or analytics, i.e. data and/or analytics related to past time period that has been obtained by the consumer.\nThe figure depicts a detailed historical data and analytics storage/deletion procedure, illustrating the steps taken to ensure data integrity and compliance with regulatory requirements.\nFigure 5.9.2-1: Historical Data and Analytics storage/deletion procedure\n1.\tIn order to store data or analytics, the NF service consumer invokes Nadrf_DataManagement_StorageRequest service operation by sending an HTTP POST request targeting the resource \"ADRF Data Store Records\" in clause 4.2.2.2 of 3GPP TS 29.575 [16].\n2.\tThe ADRF stores the data or analytics sent by the consumer. The ADRF may, based on implementation, determines whether the same data or analytics is already stored or being stored based on the information sent in step 1 by the consumer and, if the data or analytics is already stored or being stored in the ADRF, the ADRF decides to not store again the data or analytics sent by the consumer.\n3.\tIf the data or analytics is stored, the ADRF sends Nadrf_DataManagement_StorageRequest Response message to the consumer with HTTP \"201 Created\" status code including a representation of the created record.\n4.\tIn order to retrieve the stored data or analytics from the ADRF, the NF service consumer shall invoke the Nadrf_DataManagement_RetrievalRequest service operation by sending an HTTP GET request targeting the resource \"ADRF Data Store Records\" as described in clause 4.2.2.5 of 3GPP TS 29.575 [16].\n5.\tIf the requested data is found, the ADRF sends Nadrf_DataManagement_RetrievalRequest Response message to the consumer with HTTP \"200 OK\" status code including a representation of the matched record.\n6.\tIn order to deleted the specified data or analytics from the ADRF, the NF service consumer shall invoke the Nadrf_DataManagement_Delete service operation by sending an HTTP DELETE request targeting the resource \"Individual ADRF Data Store Record\" as described in clause 4.2.2.9 of 3GPP TS 29.575 [16] if the NF service consumer delete the resource including the transaction identifier, or by sending an HTTP POST request including the time window in which the data to be deleted was collected and data or analytics specification.\n7.\tThe ADRF deletes the specified stored data or analytics requested by the consumer.\n8.\tIf the deletion is successful processed, the ADRF sends Nadrf_DataManagement_Delete Response message to the consumer with HTTP \"204 No Content\" status code.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.9.3\tHistorical Data and Analytics Storage via Notifications",
                            "text_content": "The procedure is used by an NF service consumer (e.g. NWDAF, DCCF) to store received notifications in the ADRF.\nThe figure depicts a detailed historical data and analytics storage/deletion procedure, illustrating the steps taken to ensure data integrity and compliance with regulatory requirements.\nFigure 5.9.3-1: Historical Data and Analytics storage/deletion procedure\n1-2.\tBased on provisioning or based on reception of a DataManagement subscription request (e.g. see clause 5.5.3.1), the NF service consumer (e.g. DCCF or NWDAF) determines that notifications are to be stored in the ADRF.\n3.\tThe NF service consumer invokes Nadrf_DataManagement_StorageSubscriptionRequest service operation by sending an HTTP POST request in clause 4.2.2.3 of 3GPP TS 29.575 [16].\n4.\tThe ADRF may, based on implementation, determines whether the same data or analytics is already stored or being stored based on the information sent in step 3 by the consumer.\n5.\tIf the request is successfully processed and accepted, the ADRF sends Nadrf_DataManagement_StorageSubscriptionRequest Response message to the consumer with HTTP \"200 OK \" status code including a transaction reference identifier. If the data and/or analytics is already stored or being stored in the ADRF, the ADRF sends Nadrf_DataManagement_StorageSubscriptionRequest Response message to the consumer indicating that data or analytics is stored.\n6a.\tADRF invokes Ndccf_DataManagement_Subscribe service operation to subscribe to the DCCF to receive notifications by sending an HTTP POST request message targeting the resource \"DCCF Analytics Subscriptions\", the HTTP POST message shall include notification endpoint address and a notification correlation ID as defined in clause 5.1.6.2.2 of 3GPP TS 29.574 [15].\n6b.\tADRF invokes Nnwdaf_DataManagement_Subscribe service operation to subscribe to the NWDAF to receive notifications by sending an HTTP POST request message targeting the resource \"NWDAF Data Management Subscriptions\", the HTTP POST message shall include notification endpoint address and a notification correlation ID as defined in clause 4.4.2.2 of 3GPP TS 29.520 [5].\n7a\tIf the Subscription is successfully processed and accepted, the DCCF sends Ndccf_DataManagement_Subscribe Response message to the consumer with HTTP \"201 Created\" status code with the message body containing a representation of the created subscription.\n7b\tIf the Subscription is successfully processed and accepted, the NWDAF sends Nnwdaf_DataManagement_Subscribe Response message to the consumer with HTTP \"201 Created\" status code with the message body containing a representation of the created subscription.\n8.\tThe NF service consumer (e.g. DCCF, MFAF or NWDAF) sends Analytics or Data notifications containing the notification correlation ID provided by the ADRF to ADRF notification endpoint address when the historical analytics data are available.\nIf the NWDAF is the service consumer in step 7, the NWDAF invokes Nnwdaf_DataManagement_Notify service operation as defined in clause 4.4.2.4 of 3GPP TS 29.520 [5]. The ADRF stores the notifications and responses to the Nnwdaf_DataManagement_Notify service operation with HTTP \"204 No Content\" status code.\nIf the DCCF is used for data collection in step 7, the DCCF invokes Ndccf_DataManagement_Notify service operation as defined in clause 4.2.2.4 of 3GPP TS 29.574 [15]. The ADRF stores the notifications and responses to the Ndccf_DataManagement_Notify service operation with HTTP \"204 No Content\" status code.\nIf the Messaging Framework is used for data collection in step 7, the procedure defined in clause 5.5.3.2 is applicable.\n9.\tThe NF service consumer determines that notifications no longer need to be stored in the ADRF.\n10.\tIn order to request the ADRF to delete the specified data or analytics subscription, the NF service consumer shall invoke the Nadrf_DataManagement_StorageSubscriptionRemoval service operation by sending an HTTP POST request as described in clause 4.2.2.4 of 3GPP TS 29.575 [16], including the transaction reference identifier.\n11.\tIf the deletion is successful processed, the ADRF sends Nadrf_DataManagement_StorageSubscriptionRemoval Response message with HTTP \"204 No Content\" status code to the consumer.\n12a.\tADRF invokes Ndccf_DataManagement_Unsubscribe service operation to subscribe to the DCCF to receive notifications by sending an HTTP DELETE request message targeting the resource \"Individual DCCF Analytics Subscription\", the HTTP URI shall include identifier of the existing analytics subscription that is to be deleted as defined in clause 4.2.2.3.2 of 3GPP TS 29.574 [15].\n12b.\tADRF invokes Nnwdaf_DataManagement_Unsubscribe service operation to subscribe to the NWDAF to receive notifications by sending an HTTP DELETE request message targeting the resource \"Individual NWDAF Data Management Subscription\", the HTTP DELETE URI shall include identifier of the existing analytics subscription that is to be deleted as defined in clause 4.4.2.3.2 of 3GPP TS 29.520 [5].\n13a\tIf the removal of the corresponding subscription is successfully processed and accepted, the DCCF sends Ndccf_DataManagement_Unsubscribe Response message to the consumer with HTTP \"204 No Content\" status code.\n13b\tIf the removal of the corresponding subscription is successfully processed and accepted, the NWDAF sends Nnwdaf_DataManagement_Unsubscribe Response message to the consumer with HTTP \"204 No Content\" status code.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.10\tFederated Learning among Multiple NWDAFs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.10.1\tGeneral",
                            "text_content": "The NWDAF containing MTLF can leverage Federated Learning (FL) technique to train an ML model. To apply FL technique for ML model training, there is no need for input data transfer (e.g. centralized into one NWDAF) but only need for cooperation among multiple NWDAFs (MTLF) distributed in different areas, i.e. sharing of ML model(s) and of the learning results among multiple NWDAFs (MTLF).\nThe NWDAF containing MTLF determines to train an ML model either based on local configuration or when it receives the request from NWDAF containing AnLF as described in clause 5.3 of 3GPP TS 23.288 [17]. If the NWDAF containing MTLF can act as an FL server for the ML model training, then FL procedure is initiated by the NWDAF containing MTLF as FL server NWDAF directly, otherwise, the NWDAF containing MTLF should discover an FL server NWDAF as described in clause 5.3.2.2 of 3GPP TS 29.510 [26] and request the FL server NWDAF to provide the trained ML model as described in clause 5.10.2.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.2\tProcedures related to Federated Learning",
                            "text_content": "This procedure is used by the NWDAF containing MTLF (FL Server NWDAF) to trigger FL among multiple NWDAF instances, by the multiple NWDAF containing MTLF (the FL Server NWDAF and FL Client NWDAF(s)) to execute Federated Learning in FL execution phase.\n\nThe figure depicts a general procedure for FL (Fiber Localization) among Multiple NWDAF (Network Wide Dense Aperture). It illustrates the steps involved in determining the optimal path for a signal to be transmitted, taking into account factors such as signal strength, distance, and interference. The figure includes a flowchart and a legend to help understand the process.\nFigure 5.10.2.1-1: General procedure for FL among Multiple NWDAF\n0a-0b.\tTo send a request for ML model analytics events subscription to the NWDAF containing MTLF (the FL Server NWDAF), the NWDAF service consumer (NWDAF containing AnLF or NWDAF containing MTLF) invokes the Nnwdaf_MLModelProvision_Subscribe service operation by sending an HTTP POST request targeting the resource \"NWDAF ML Model Provision Subscriptions\".\nThe FL Server NWDAF responses to the Nnwdaf_MLModelProvision_Subscribe service operation. Upon receipt of the HTTP POST request, if the subscription is accepted to be created, the FL Server NWDAF responds to the NWDAF service consumer with \"201 Created\", and the URI of the created subscription is included in the Location header field. Details are described in clause 4.5.2.2 of 3GPP TS 29.520 [5].\nNOTE 1:\tThe ML model accuracy threshold can be used to indicate the target ML Model Accuracy of the training process, and the FL Server NWDAF may stop the training process when the ML model accuracy threshold is achieved during the training process.\nIf the consumer (i.e. the NWDAF containing AnLF or NWDAF containing MTLF) provides the Time when the ML model is needed, the FL Server NWDAF can take this information into account to decide the maximum response time for its FL Client NWDAFs.\n0e.\tThe FL Server NWDAF selects NWDAF(s) containing MTLF (FL Client NWDAF(s)) as described in clause 5.10.2.2.\n1a-1b.\tTo request the selected NWDAF containing MTLF (the FL Client NWDAF) to perform the local model training, the FL Server NWDAF may invoke Nnwdaf_MLModelTraining_Subscribe service operation by sending an HTTP POST request targeting the resource \"NWDAF ML Model Training Subscriptions\". The FL Client NWDAF responses to the Nnwdaf_MLModelTraining_Subscribe service operation with an HTTP \"201 Created\" status code to the FL Server NWDAF, as defined in clause 4.6.2.2 of 3GPP TS 29.520 [5].\n2a-2b.\tTo subscribe to notification (or to modify subscriptions to notifications) of data events from the data source NF, each FL Client NWDAF may invoke the Nnf_EventExposure_Subscribe service operation by sending an HTTP POST (or PUT, for modification) request targeting the resource representing event exposure subscriptions of that NF.\nThe data source NF responds to the Nnf_EventExposure_Subscribe service operation. Upon receipt of the HTTP POST request, if the subscription is accepted to be created, the NF responds to the FL Client NWDAF with \"201 Created\", and the URI of the created subscription is included in the Location header field.\n3a-3b.\tIf the data source NF observes the subscribed event(s), the NF invokes the Nnf_EventExposure_Notify service operation to report the event(s) by sending an HTTP POST request.\nOn success, the FL Client NWDAF sends an HTTP \"204 No Content\" response to the NF.\n4.\tDuring FL training process, each FL Client NWDAF further trains the retrieved ML model from the FL Server NWDAF based on its own/collected data, and reports interim local ML model information to the FL Server NWDAF before the maximum response time elapses. Each FL Client NWDAF also computes local model metric and reports it to the FL Server NWDAF. The ML model information are exchanged between the FL Client NWDAF(s) and the FL Server NWDAF during the FL training process.\n4a-4b.\tTo report the ML model training information, the FL Client NWDAF may invoke Nnwdaf_MLModelTraining_Notify service operation as defined in clause 4.6.2.4 of 3GPP TS 29.520 [5]. The FL Server NWDAF stores the notification and responds to the Nnwdaf_MLModelTraining_Notify service operation with an HTTP \"204 No Content\" status code to the FL Client NWDAF.\n4c.\t[Optional] If FL Server NWDAF receives notification that the FL Client NWDAF is not able to complete the training within the maximum response time, the FL Server NWDAF may send to the FL Client NWDAF an new maximum response time by invoking Nnwdaf_MLModelTraining_Subscribe, before which the FL Client NWDAF shall report the interim local ML model information to the FL Server NWDAF. Otherwise, the FL Server NWDAF may indicate FL Client NWDAF to skip reporting for this iteration.\n5.\tThe FL Server NWDAF aggregates all the local ML model information retrieved at step 4, to update the global ML model. The FL Server NWDAF may also compute the global model metric.\n-\tIf the FL Server NWDAF provides the maximum response time for the FL Client NWDAFs to provide the interim local ML model information in step 1 or the new maximum response time in step 4, the FL Server NWDAF decides either to wait for the FL Client NWDAFs which have not yet provided their interim local ML model within the new maximum response time or to aggregate only the retrieved local ML model information instances to update global ML model. The FL Server NWDAF makes this decision, considering the notification from the FL Client NWDAF or, if the notification is not received, based on local configuration.\n6a.\t[Optional] Based on the NWDAF service consumer request, the FL Server NWDAF updates the global ML model metric to the NWDAF service consumer periodically or dynamically when some pre-determined status (e.g. ML model accuracy threshold) is achieved.\n6aa-6ab.\tTo report the ML model training information, the FL Server NWDAF invokes Nnwdaf_MLModelProvision_Notify service operation as defined in clause 4.5.2.4 of 3GPP TS 29.520 [5]. The NWDAF service consumer stores the notification and responds to the Nnwdaf_MLModelProvision_Notify service operation with an HTTP \"204 No Content\" status code to the FL Server NWDAF.\n6b.\t[Optional] The NWDAF service consumer decides whether the current model can fulfil the requirement. The NWDAF service consumer modifies subscription (stops or continues the training process) according to the NWDAF service consumer decision.\n6ba.\tTo modify the existing subscription, the NWDAF service consumer invokes Nnwdaf_MLModelProvision_Subscribe service operation by sending an HTTP PUT request with Resource URI of the resource \"Individual NWDAF ML Model Provision Subscription\". The FL Server NWDAF responds to the NWDAF service consumer with an HTTP \"200 OK\" or \"204 No Content\" status code, as defined in clause 4.5.2.2.3 of 3GPP TS 29.520 [5].\n6bb.\tTo unsubscribe the ML model, the NWDAF service consumer invokes Nnwdaf_MLModelProvision_Unsubscribe service operation by sending an HTTP DELETE request which targets the resource \"Individual NWDAF ML Model Provision Subscription\", to the FL Server NWDAF, as defined in clause 4.5.2.3 of 3GPP TS 29.520 [5]. If the request is accepted, the FL Server NWDAF deletes the subscription and responds to the NWDAF service consumer with an HTTP \"204 No Content\" message.\n6c.\t[Optional]\tAccording to the request from the NWDAF service consumer, the FL Server NWDAF updates or terminates the current FL training process. If it terminates the current FL training process, steps 7 and 8 are skipped.\n7.\tIf the FL procedure continues, the FL Server NWDAF sends the aggregated ML model information to each FL Client NWDAF for next round model training.\nTo modify the existing subscription, the FL Server NWDAF invokes Nnwdaf_MLModelTraining_Subscribe service operation by sending an HTTP PUT request or an HTTP PATCH request with Resource URI of the resource \"Individual NWDAF ML Model Training Subscription\". The FL Client NWDAF responds to the FL Server NWDAF an HTTP \"200 OK\" or \"204 No Content\" status code, as defined in clauses 4.6.2.2.3 and 4.6.2.2.4 of 3GPP TS 29.520 [5].\n8.\tEach FL Client NWDAF updates its own ML model based on the aggregated ML model information distributed by the FL Server NWDAF at step 7.\nNOTE 2:\tThe steps 4-8 should be repeated until the training termination condition (e.g. maximum number of iterations, or the result of loss function is lower than a threshold) is reached.\n9a-9b.\tTo unsubscribe to the notifications of data events from the data source NF, the FL Client NWDAF invokes the Nnf_EventExposure_Unsubscribe service operation by sending an HTTP DELETE request targeting the resource that represents the previously created individual event exposure subscription.\nThe data source NF responds to the Nnf_EventExposure_Unsubscribe service operation. If the subscription deletion is accepted, the NF responds with \"204 No Content\".\n10.\tIf the FL Server NWDAF determines that the subscribed ML model information is available, the FL Server NWDAF may invoke the Nnwdaf_MLModelProvision_Notify service operation or the Nnwdaf_MLModelTraining_Notify service operation to report the ML model information by sending an HTTP POST request to the NWDAF service consumer identified by the notification URI received during the creation/modification of the subscriptions. The NWDAF service consumer responds to the FL Server NWDAF with an HTTP \"204 No Content\" message.\n11a-11b.\tTo unsubscribe from the notification(s) of the ML model information, the NWDAF service consumer invokes the Nnwdaf_MLModelProvision_Unsubscribe service operation by sending an HTTP DELETE request, which targets the resource \"Individual NWDAF ML Model Provision Subscription\", to the FL Server NWDAF, as defined in clause 4.5.2.3 of 3GPP TS 29.520 [5].\nIf the request is accepted, the FL Server NWDAF deletes the subscription and responds to the NWDAF service consumer with an HTTP \"204 No Content\" message.\nThis procedure is used by the NWDAF containing MTLF (as FL Server NWDAF or FL Client NWDAF(s)) to register into NRF, discover the FL Server NWDAF and select FL Client NWDAF(s) for Federated Learning (FL).\n\nThe figure depicts a step-by-step procedure for preparing a federated learning system, with a focus on the preparation phase. It includes tasks such as data collection, data cleaning, and model training, all of which are crucial for the successful execution of federated learning. The figure also highlights the importance of communication between the different parties involved in the system, such as the central server, the clients, and the edge devices. Overall, the figure provides a comprehensive guide for preparing a federated learning system, ensuring that it is ready for deployment.\nFigure 5.10.2.2-1: Preparation procedure for Federated Learning\nThe NWDAF containing MTLF as FL Server NWDAF or FL Client NWDAF(s) registered to NRF its NF profiles. Details are described in clause 5.2.2.2 of 3GPP TS 29.510 [26].\n1.\tThe FL Server NWDAF and FL Client NWDAF(s) are discovered via NRF. Details are described in clause 5.3.2.2 of 3GPP TS 29.510 [26].\n2.\tThe Nnwdaf_MLModelTraining service may be used for the preparation information exchange between the FL Server NWDAF and the FL Client NWDAF(s).\n2a.\tThe FL Server NWDAF invokes Nnwdaf_MLModelTraining_Subscribe service operation by sending an HTTP POST request targeting the resource \"NWDAF ML Model Training Subscriptions\", The request shall include the \"mLPreFlag\" attribute and set to \"true\". Details are described in clause 4.6.2.2 of 3GPP TS 29.520 [5].\n2b.\tThe FL Client NWDAF(s) checks if it meets the ML model training requirement as described in clause 5.5.6.2.2 of 3GPP TS 29.520 [5] and/or can successfully download the model if the model information is provided in the request, and decides whether to join the FL process based on operator policy (e.g. pre-configured list of ML models) and/or implementation.\n2c.\tThe FL Client NWDAF responses or notifies to the Nnwdaf_MLModelTraining_Subscribe request to indicate its decision. Upon receipt of the HTTP POST request, if the preparation request is accepted, the FL Client NWDAF responds to the FL Server NWDAF with \"201 Created\", otherwise, responds with \"403 Forbidden\" as described in 3GPP TS 29.520 [5].\nNOTE:\tStep 2 can be skipped if the FL Server NWDAF can decide that the FL Client NWDAF(s) supports the FL procedure to be performed, e.g. based on information acquired from previous FL procedures or from the NRF, or based on local configuration.\n3.\tThe FL Server NWDAF determines the final list of FL Client NWDAF(s) to be involved in the FL procedures based on the information received in step 1 and other information received in step 2 (if available).\nThis procedure is used by the NWDAF containing MTLF (the FL Server NWDAF) to maintain a FL process in FL execution phase, including: the FL Server NWDAF triggers reselection, addition, or removal of FL Client NWDAF(s), discovery of new FL Client NWDAF(s) via NRF, and FL Client NWDAF(s) joins or leaves FL process dynamically.\nIn FL execution phase, the FL Server NWDAF monitors the status changes of FL Client NWDAF(s), and may reselect the FL Client NWDAF(s) based on the received information of status changes.\nNOTE:\tThe FL Server NWDAF checks if there is a need to carry on the FL execution phase and then reselects FL members for the next iteration if needed.\n\nThe figure depicts a step-by-step procedure for maintaining a federated learning process in FL execution phase. It includes steps such as data collection, data preprocessing, model training, model evaluation, and model deployment. The figure provides a clear and concise visual representation of the process, making it easy to understand and follow.\nFigure 5.10.2.3-1: Procedure for Maintenance of Federated Learning Process in FL Execution Phase\nThe FL Server NWDAF registered to NRF by invoking the Nnrf_NFManagement_NFRegister_request service operation about the FL process, which includes Analytics ID.\n1.\tThe FL Server NWDAF may get the updated status of the current FL Client NWDAF(s) via NRF by using the Nnrf_NFManagement service in the FL execution phase. Details are described in clauses 5.2.2.5 and 5.2.2.6 of 3GPP TS 29.510 [26].\n2.\tThe current FL Client NWDAF(s) may inform the FL Server NWDAF to leave the FL process. The FL Client NWDAF(s) invokes Nnwdaf_MLModelTraining_Notify service operation by sending an HTTP POST request to the FL Server NWDAF identified by the notification URI received during the creation/modification of the subscriptions. The request shall include \"termTrainReq\" attribute and with the \"termTrainCause\" attribute in data type \"TermMLModelTrainInfo\" being provided. Details are described in clause 4.6.2.4 of 3GPP TS 29.520 [5]. The FL Server NWDAF responds to the Nnwdaf_MLModelTraining_Notify service operation with an HTTP \"204 No Content\" status code to the FL Client NWDAF(s).\n3.\tThe FL Server NWDAF may get the information of the new FL Client NWDAF(s) dynamically via NRF. Details are described in clauses 5.2.2.5 and 5.2.2.6 of 3GPP TS 29.510 [26].\n4.\tThe FL Server NWDAF may subscribe to other NWDAF (Assist NWDAF) or the FL Client NWDAF(s) for analytics of the FL Client NWDAF(s), as defined in clauses 4.2.2.2 and 4.2.2.4 of 3GPP TS 29.520 [5].\n5.\tThe FL Client NWDAF(s) may send Status report of FL training and Global ML Model Accuracy Information. The FL Client NWDAF(s) invokes Nnwdaf_MLModelTraining_Notify service operation to the FL Server NWDAF. The FL Server NWDAF stores the notification and responds to the Nnwdaf_MLModelTraining_Notify service operation with an HTTP \"204 No Content\" status code to the FL Client NWDAF(s). Details are described in clause 4.6.2.4 of 3GPP TS 29.520 [5].\n6.\tThe FL Server NWDAF checks the FL Client NWDAF(s) status based on the received information, determines whether reselection of the FL Client NWDAF(s) for the next round(s) of FL is needed. The checking and determination are made according to the updated status of the FL Client NWDAF(s) received in steps 1-5.\n7.\tIf re-selection is needed as determined in step 6 and if step 3 is not performed, the FL Server NWDAF may discover new candidate FL Client NWDAF(s) via NRF by using the Nnrf_NFDiscovery services as described in clause 5.3.2.2 of 3GPP TS 29.510 [26]. The FL Server NWDAF reselects the FL Client NWDAF(s) from the current FL Client NWDAF(s) and the new candidate FL Client NWDAF(s).\n8.\tThe FL Server NWDAF sends termination request to the FL Client NWDAF(s) which will be removed from the FL process, and optionally indicating the reason. The FL Client NWDAF(s) terminates FL operations when receives a termination request from the FL Server NWDAF and may perform further action to be qualified in participation of FL training in the next cycles.\n8a-8b.\tTo send the termination request, the FL Server NWDAF may invoke the Nnwdaf_MLModelTraining_Unsubscribe service operation by sending an HTTP DELETE request, which targets the resource \"Individual NWDAF ML Model Training Subscription\", to the FL Client NWDAF(s). If the request is accepted, the FL Client NWDAF deletes the subscription and responds to the FL Server NWDAF service consumer with an HTTP \"204 No Content\" message. Details are described in clause 4.6.2.3 of 3GPP TS 29.520 [5].\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 3,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}