{
    "document_name": "32422-i10.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "Introduction",
            "description": "The present document is part of a TS-family covering the 3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; Telecommunication management, as identified below:\nTS 32.421 [2]:\t\"Subscriber and equipment trace: Trace concepts and requirements\";\nTS 32.422:\t\"Subscriber and equipment trace: Trace control and configuration management\";\nTS 32.423 [3]:\t\"Subscriber and equipment trace: Trace data definition and management\";\nAdditionally, there is a GSM only Subscriber and Equipment Trace specification: 3GPP TS 52.008 [5].\nSubscriber and Equipment Trace provide very detailed information at call level on one or more specific mobile(s). This data is an additional source of information to Performance Measurements and allows going further in monitoring and optimisation operations.\nContrary to Performance Measurements, which are a permanent source of information, Trace is activated on user demand for a limited period of time for specific analysis purposes.\nTrace plays a major role in activities such as determination of the root cause of a malfunctioning mobile, advanced troubleshooting, optimisation of resource usage and quality, RF coverage control and capacity improvement, dropped call analysis, Core Network, UTRAN, EPC, 5GC, E-UTRAN and NG-RAN procedure validation.\nThe capability to log data on any interface at call level for a specific user (e.g. IMSI or SUPI) or mobile type (e.g. IMEI or IMEISV), or service initiated from a UE allows getting information which cannot be deduced from Performance Measurements such as perception of end-user QoS during his call (e.g. requested QoS vs. provided QoS), correlation between protocol messages and RF measurements, or interoperability with specific mobile vendors.\nMoreover, Performance Measurements provide values aggregated on an observation period, Subscriber and Equipment Trace give instantaneous values for a specific event (e.g., call, location update, etc.).\nIf Performance Measurements are mandatory for daily operations, future network planning and primary trouble shooting, Subscriber and Equipment Trace is the easy way to go deeper into investigation and network optimisation.\nIn order to produce this data, Subscriber and Equipment Trace are carried out in the NEs, which comprise the network. The data can then be transferred to an external system (e.g. an Operations System (OS) in TMN terminology, for further evaluation).\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document describes the mechanisms used for the control and configuration of the Trace, Minimization of Drive Test (MDT), Radio Link Failure (RLF) and RRC Connection Establishment Failure (RCEF) reporting functionality at the management system (at the Element Manager (EM) and or Network Manager (NMs) in UMTS and EPS), Network Elements (NEs) and User Equipment (UEs). For Trace functionality, it covers the triggering events for starting/stopping of subscriber/UE activity traced over 3GPP standardized signalling interfaces, the types of trace mechanisms, configuration of a trace, level of detail available in the trace data, the generation of Trace results in the NEs and UE and the transfer of these results to management system. For MDT, it also covers logged MDT and immediate MDT mechanims in both management based and signalling based scenarios. GSM is excluded from the RAT systems which the present document can be applied to.\nThe mechanisms for Trace, MDT, RLF and RCEF reporting activation/deactivation are detailed in clause 4; clause 5 details the various Trace, MDT, RLF and RCEF reporting control and configuration parameters and the triggering events that can be set in a network. Trace, MDT, RLF and RCEF reporting concepts and requirements are covered in 3GPP TS 32.421 [2] while Trace and MDT data definition and management is covered in 3GPP TS 32.423 [3].\nThe conditions for supporting Network Sharing are stated in 3GPP TS 32.421 [2].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "The condition for supporting user consent handling for MDT does not apply to Standalone Non-Public Network, i.e., SNPN as per TS 23.501[40].2\tReferences",
            "description": "The following documents contain provisions, which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\nNOTE:\tOverall management principles are defined in 3GPP TS 32.101 [1].\n[1]\t3GPP TS 32.101: \"Telecommunication management; Principles and high level requirements\".\n[2]\t3GPP TS 32.421: \"Telecommunication management; Subscriber and equipment trace: Trace concepts and requirements\".\n[3]\t3GPP TS 32.423: \"Telecommunication management; Subscriber and equipment trace: Trace data definition and management\".\n[4]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[5]\t3GPP TS 52.008: \"Telecommunication management; GSM subscriber and equipment trace\".\n[6]\t3GPP TS 23.060: \"General Packet Radio Service (GPRS) Service description; Stage 2\".\n[7]\t3GPP TS 23.205: \"Bearer-independent circuit-switched core network; Stage 2\".\n[8]\t3GPP TS 23.108: \"Mobile radio interface layer 3 specification, core network protocols; Stage 2 (structured procedures)\".\n[9]\t3GPP TS 23.246: \"Multimedia Broadcast/Multicast Service (MBMS); Architecture and functional description\".\n[10]\t3GPP TS 29.232: \"Media Gateway Controller (MGC) - Media Gateway (MGW); interface; Stage 3\".\n[11]\t3GPP TS 29.002: \"Mobile Application Part (MAP) specification\".\n[12]\t3GPP TS 29.060: \"General Packet Radio Service (GPRS); GPRS Tunnelling Protocol (GTP) across the Gn and Gp interface\".\n[13]\t3GPP TS 25.413: \"UTRAN Iu interface Radio Access Network Application Part (RANAP) signalling\".\n[14]\t3GPP TS 23.218: \"IP Multimedia (IM) session handling; IM call model; Stage 2\".\n[15]\t3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".\n[16]\t3GPP TS 29.228: \"IP Multimedia (IM) Subsystem Cx and Dx Interfaces; Signalling flows and message contents\".\n[17]\t3GPP TS 29.328: \"IP Multimedia Subsystem (IMS) Sh interface; Signalling flows and message contents\".\n[18]\tEnabler Release Definition for OMA Device Management Specifications, version 1.2, The Open Mobile Alliance™ ().\n[19]\t3GPP TS 32.240: \"Telecommunication management; Charging management; Charging architecture and principles\".\n[20]\t3GPP TS 32.260: \"Telecommunication management; Charging management; IP Multimedia Subsystem (IMS) charging\".\n[21]\tVoid\n[22]\t3GPP TS 23.402: \"Architecture enhancements for non-3GPP accesses\".\n[23]\tVoid\n[24]\t3GPP TS 32.442: \"Telecommunication management; Trace management Integration Reference Point (IRP); Information Service (IS)\".\n[25]\t3GPP TS 29.273: \"Evolved Packet System (EPS); 3GPP EPS AAA interfaces\".\n[26]\t3GPP TS 29.272: \"Evolved Packet System (EPS); Mobility Management Entity (MME) and Serving GPRS Support Node (SGSN) related interfaces based on Diameter protocol\".\n[27]\t3GPP TS 32.615: \"Telecommunication management; Configuration Management (CM); Bulk CM Integration Reference Point (IRP): eXtensible Markup Language (XML) definitions\".\n[28]\t3GPP TS 32.342: \"Telecommunication management; File Transfer (FT) Integration Reference Point (IRP): Information Service (IS)\".\n[29]\t3GPP TS 29.212: \" Policy and Charging Control (PCC);Reference points\".\n[30]\t3GPP TS 37.320: \"Universal Terrestrial Radio Access (UTRA) and Evolved Universal Terrestrial Radio Access (E-UTRA); Radio measurement collection for Minimization of Drive Tests (MDT);Overall description; Stage 2\".\n[31]\t3GPP TS 25.331: \"Radio Resource Control (RRC); Protocol specification\"\n[32]\t3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA); Radio Resource Control (RRC); Protocol specification\".\n[33]\t3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet System (EPS); Stage 3\".\n[34]\t3GPP TS 29.274: \"3GPP Evolved Packet System (EPS); Evolved General Packet Radio Service (GPRS) Tunnelling Protocol for Control plane (GTPv2-C); Stage 3\".\n[35]\t3GPP TS 32.622: \"Telecommunication management; Configuration Management (CM); Generic network resources Integration Reference Point (IRP): Network Resource Model (NRM)\".\n[36]\t3GPP TS 36.413: \"Evolved Universal Terrestrial Radio Access Network (E-UTRAN); S1 Application Protocol\".\n[37]\t3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and Evolved Universal Terrestrial Radio Access Network (E-UTRAN): Overall description stage 2\".\n[38]\t3GPP TS 36.214: \"Evolved Universal Terrestrial Radio Access (E-UTRA); Physical layer - Measurements\".\n[39]\tVoid\n[40]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[41]\t3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\"\n[42]\t3GPP TS 38.300: \"NR and NG-RAN Overall Description; Stage 2\".\n[43]\t3GPP TS 38.331: \"NR; Radio Resource Control (RRC); Protocol specification\".\n[44]\t3GPP TS 38.401: \"NG-RAN; Architecture Description\".\n[45]\t3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS); Stage 3\".\n[46]\t3GPP TS 28.541: \"5G Network Resource Model (NRM); Stage 2 and stage 3\".\n[47]\t3GPP TS 28.532: \"Management and orchestration; Generic management services\"\n[48]\t3GPP TS 28.533: \"Management and orchestration; Architecture framework\".\n[49]\t3GPP TS 38.413: \"NG-RAN; NG Application Protocol (NGAP)\".\n[50]\t3GPP TS 38.314: \"NR; Layer 2 measurements\".\n[51]\t3GPP TS 38.321: \"NR; Medium Access Control (MAC) protocol specification\".\n[52]\t3GPP TS 38.305: \"NG Radio Access Network (NG-RAN); Stage 2 functional specification of User Equipment (UE) positioning in NG-RAN\".\n[53]\t3GPP TS 32.158: \"Management and orchestration; Design rules for Representational State Transfer (REST) Solution Sets (SS)\".\n[54]\t3GPP TS 25.215: \"Physical layer; Measurements (FDD)\".\n[55]\t3GPP TS 25.321: \"Medium Access Control (MAC) protocol specification\".\n[56]\t3GPP TS 36.314: \"Evolved Universal Terrestrial Radio Access (E-UTRA); Layer 2 - Measurements\".\n[57]\t3GPP TS 36.321: \"Evolved Universal Terrestrial Radio Access (E-UTRA); Medium Access Control (MAC) protocol specification\".\n[58]\t3GPP TS 28.552:\"Management and Orchestration; 5G performance measurements\".\n[59]\t3GPP TS 25.123: \" Requirements for support of radio resource management (TDD)\".\n[60]\t3GPP TS 25.133: \" Requirements for support of radio resource management (FDD) \".\n[61]\t3GPP TS 32.156: \"Fixed Mobile Convergence (FMC) Model repertoire\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tDefinitions",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms and definitions given in TR 21.905 [4] , TS 23.501 [40], TS 38.300 [42] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in TR 21.905 [4] , TS 23.501 [40] or TS 38.300 [42].\nManagement based MDT: MDT data is collected from UEs in a specified area. The area is defined as a list of cells (UTRAN or E-UTRAN) or as a list of tracking/routing/location areas. The management  based MDT is an enhancement of the management based trace functionality. Management based MDT can be either a logged MDT or Immediate MDT.\nImmediate MDT: See 3GPP TS 37.320 [30]\nLogged MDT: See 3GPP TS 37.320 [30]\nLogged MBSFN MDT: Collection of MBSFN measurements in idle and connected mode. Applicable only for eUTRAN.\nSignalling based MDT:MDT data is collected from one specific UE. The UE that is participating in the MDT data collection is specified as IMEI(SV) or as IMSI. The signalling based MDT is an enhancement of the signalling based subscriber and equipment trace. A signalling based MDT can be either a logged MDT or Immediate MDT.\nMBSFN Area: See 3GPP TS 36.300 [37]\nMBSFN Area Reserved Cell: See 3GPP TS 36.300 [37]\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in TR 21.905 [4], TS 32.101 [1] , TS 23.501 [40], TS 38.300 [42] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905 [4].\nAS\tApplication Server\nBGCF\tBreakout Gateway Control Function\nCAG\tClosed Access Group\nCSCF\tCall Session Control Function\nI-CSCF\tInterrogating-CSCF\nIM CN SS\tIP Multimedia Core Network Subsystem\nIMEI-TAC\tIMEI Type Allocation Code\nNID\tNetwork ID\nP-CSCF\tProxy – CSCF\nPNI-NPN\tPublic Network Integrated Non-Public NetworkRCEF\tRRC Connection Establishment Failure\nRLF\tRadio Link Failure\nS-CSCF\tServing-CSCF\nSNPN\tStand-alone Non-Public NetworkTAU\tTracking Area Update\nTRSR\tTrace Recording Session Reference\nTR\tTrace Reference\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tTrace/UE measurements activation and deactivation",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tTrace Session activation / deactivation for Trace and MDT",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.1.1\tManagement activation",
                            "text_content": "In Management activation, the Trace Control and Configuration parameters are sent directly to the concerned NE by its management system in UMTS or EPS (by its EM). This NE shall not propagate the received data to any other NE's - whether or not it is involved in the actual recording of the call.\nOnce the parameters have been provided, the NE looks for the IMSI or IMEI (IMEISV) passing through it. If it does not have them, these shall be provided to the NE (that performs the trace recording) as part of traffic signalling by the CN.\nThe following figure represents the management based trace functionality within a PLMN. The figure represents a typical PLMN network. A dotted arrow with \"Trace Parameter Configuration\" represents the availability of the management based trace functionality at the EM for that domain.\nNOTE:\tThere is no propagation of trace parameters in management based trace activation.\nThe figure depicts an overview of management activation for an UMTS system, illustrating the various components and their functions. It includes a diagram of the network architecture, highlighting the role of the base station (gNB), user equipment (UE), and scatterers. The figure also illustrates the use of beamforming techniques to mitigate interference, and the presence of redundancy paths to ensure failover reliability.\nFigure 4.1.1.1.1: Overview of management activation for an UMTS system\nIf the NE failed to activate the Trace Session, a Trace failure notification shall be sent to the TCE, and the Trace failure notification has the the same parameters as the notification notifyTraceRecordingSessionFailure defined in 3GPP TS 32.442 [24], the Trace failure notification file XML schema is defined in Annex A.\nIn 5GS the management trace activation utilizes the Services Based Management Architecture (SBMA) defined in TS 28.533 [48]. The NE is configured with Trace Control and Configuration parameters via interaction between Provisioning MnS (see definitions in TS 28.532 [47]) consumer and Provisioning MnS producer. Figure 4.1.1.1.2-1 below illustrates the 5GS management activation where the role of a Provisioning MnS producer is played by the NE and the role of a Provisioning MnS consumer is played by the Management System. The configured NE shall not propagate the received Trace Control and Configuration parameters to any other NE's - whether or not it is involved in the actual recording of the call.\nThe figure depicts a simplified overview of the management activation process for 5G Service Delivery Network (SDN) in a 5G network. It illustrates the various components involved in managing network services, such as network slicing, network slicing management, and network slicing activation. The figure provides a clear visual representation of the process, making it easier to understand and follow.\nFigure 4.1.1.1.2-1: Overview of management activation for 5GS\nOnce configured with Trace Control and Configuration parameters, the NE shall activate the Trace Session. If the NE failed to activate the Trace Session in a file-based reporting case, a Trace failure notification shall be sent to the TCE. XML based encoding of the Trace failure notification file is defined in Annex A. Administrative messages can also be used if the NE failed to activate a Trace Session, or if there are errors for an ongoing session, and are included in the trace data.  An example of an administrative message is the Trace Recording Session Not Started administrative message (see TS 32.423 [3]).\n\nWhen an RNC receives Trace Session activation from the EM it shall start a Trace Session. The trace control and configuration parameters of the Trace Session are received in Trace Session activation from the EM. The RNC shall not forward these trace control and configuration parameters to other nodes. The received trace control and configuration parameters shall be saved and used to determine when and how to start a Trace Recording Session. (Starting a Trace Recording Session is described in subclause 4.2.2.1). A Trace Session may be requested for a limited geographical area.\nSince a RNC has visibility of an IMSI, it can start an IMSI Trace all by itself when a Trace session is requested for an IMSI or a list of IMSI’s. However, a RNC does not have visibility of the IMEI(SV). Hence, when a Trace session is requested for an IMEI(SV) or a list of IMEI(SV), the RNC shall send the requested IMEI(SV) / list of IMEI(SV)s in an 'Uplink Information Exchange Request' message to the interacting MSC Server(s) and SGSN(s). The MSC Servers and SGSNs shall store the requested IMEI(SV)s per RNC. For each subscriber/UE activity the MSC Servers and SGSNs shall request IMEI(SV), if it is not already provided. For each subscriber/UE activity the MSC server/SGSN shall check whether a trace request is active in an RNC for the IMEI(SV). If a match is found, the MSC Server/SGSN shall inform the RNC about the IMEI(SV) in CN Invoke Trace, so that the RNC can trace the control signalling according to the trace control and configuration parameters that are received from its EM.\nIf an Inter-MSC SRNS Relocation or an Inter-SGSN SRNS relocation occurs, the anchor MSC Server or source SGSN shall transfer the IMSI and IMEI(SV) for the subscriber/UE activity to the non anchor MSC Server or target SGSN. The non anchor MSC Server/target SGSN shall check whether it has received a trace request from the target RNC for the transferred IMEI(SV). If a match is found on the IMEI(SV) in the non anchor MSC Server/target SGSN, the MSC Server/SGSN shall inform the RNC about the IMEI(SV) in the CN Invoke Trace. The IMSI shall be transferred from the non anchor MSC Server/target SGSN to the target RNC in Relocation Request. The RNC can then trace the subscriber/UE activity according to the trace control and configuration parameters that are received from its EM.\nIn case of management based MDT data collection, the UE selection should be done in the radio network at RNC based on the input information received from OAM, like device capability information and area scope. In this case there is no IMSI, IMEI(SV) selection.\nThe following figure shows an example scenario how the MDT configuration is done utilising the cell traffic trace functionality:\n\n\nThe figure depicts a simplified representation of a management-based MDT activation in an UTRAN network. It illustrates the various components involved in the activation process, including the MDT (Management Decision Tree), the MDT activation process, and the activation status. The figure provides a clear visual representation of the steps involved in the activation process, making it easier to understand and follow.\nFigure 4.1.1.2a.1: Example formanagement  based MDT activation in UTRAN\n1)\tThe EM sends a Trace Session activation request to the RNC. This request includes the parameters for configuring MDT data collection:\n-\tArea Scope where the MDT data should be collected: list of UTRAN cells. Routing Area or Location Area should be converted to UTRAN cells.\n-\tJob Type\n-\tList of Measurements\n-\tReporting Trigger (only in case of Immediate MDT)\n-\tReport Interval (only in case of Immediate MDT)\n-\tReport Amount (only in case of Immediate MDT)\n-\tEvent Threshold (Only in case of Immediate MDT)\n-\tLogging Interval (Only in case of Logged MDT)\n-\tLogging Duration (Only in case of Logged MDT)\n-\tTrace Reference\n-\tTCE IP Address\n-\tAnonymization of MDT Data.\n-\tMeasurement Quantity\n-\tMeasurement Period UMTS (Only in case of Immediate MDT and if either of the measurements M6, M7 is requested in the list of measurement parameter).\n-\tCollection Period for RRM Measurements UMTS (present only if any of M4 or M5 measurements are requested).\n-\tPositioning Method\n2)\tWhen RNC receives the Trace Session activation request from its EM, it shall start a Trace Session and should save the parameters associated to the Trace Session.\n3)\tVoid.\n4)\tRNC shall select the suitable UEs for MDT data collection. The selection is based on the area received from the EM and the area where UE is roaming, user consent information received from the core network (As described in clause 4.6.2 of the present document).If the user is not in the specified area or if  the Management Based MDT Allowed IE is not received from the Core Network (which indicates lacking user consent)the UE shall not be selected by the RNC for MDT data collection. During UE selection , the RNC shall take into account also the UE capability (MDT capability) when it selects UE for logged MDT configuration. If the UE does not support logged MDT the UE shall not be selected. The RNC should also start the Data Volume measurement if it is requested in the MDT configuration.\n5)\tRNC shall activate the MDT functionality to the selected UEs. As part of this operation the RNC shall allocate a Trace Recording Session Reference and send at least the following configuration information to the UE in case of Logged MDT:\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tTCE Id (The value signalled as IP address of TCE from the EM is mapped to a TCE Id, using a configured mapping in the RNC)\n-\tLogging Interval\n-\tLogging Duration\n-\tAbsolute time reference\n-\tArea Scope where the MDT data should be collected: list of UTRAN cells/RA/LA\nIn case of Immediate MDT only the measurements and their parameters needs to be sent to the UE:\n-\tList of Measurements\n-\tReporting Trigger\n-\tReport Interval\n-\tReport Amount\n-\tEvent Threshold (only if event based reporting is configured in reporting trigger)\n6)\tWhen UE receives the MDT activation it shall start the MDT functionality based on the received configuration parameters. The MDT related measurements are reported to the RNC via RRC signalling. In case of Logged MDT the MDT reporting is done when the network requests the log. The MDT log is requested if UE’s rPLMN matches the PLMN where TCE used to collect MDT data resides (e.g. RNC’s primary PLMN) by sending the UEInformationRequest message. The MDT log is sent by the UE in the UEInformationResponse message. If the MDT anonymization requires the IMEI-TAC in the MDT record, RNC shall send the Trace Recording Session Reference, Trace Reference, serving Cell Identifier (containing serving cell PLMN and Cell ID, for immediate MDT only), TCE IP Address and IMSI in the UPLINK INFORMATION EXCHANGE REQUEST message to the SGSN/MSC Server via Iu connection. When SGSN/MSC Server receives this Iu signalling message containing the Trace Recording Session Reference, Trace Reference, TCE  IP A ddress, IMSI, the SGSN/MSC Server shall look up the corresponding equipment identities (IMEI (SV)) of the given IMSI from its database, and send the IMEI-TAC together with the Trace Recording Session Reference and Trace Reference to the TCE, as described in section 4.7 of the present document. For logged MDT, SGSN/MSC Server shall send the IMEI-TAC together with the Trace Recording Session Reference, Trace Reference to the TCE.\nFor immediate MDT, RNC shall include the serving cell identifier in the UPLINK INFORMATION EXCHANGE REQUEST message.\nThe UE should report the Trace Reference, Trace Recording Session Reference and TCE Id together with the MDT reports to the network in case of Logged MDT.\n7)\tWhen RNC receives the MDT report from the UE the RNC shall compare the Trace PLMN (PLMN portion of Trace Reference) with the PLMN where TCE used to collect MDT data resides (e.g. its primary PLMN). In case of a match, for immediate MDT, it shall capture it and put the UE’s serving cell CGI together with the MDT report from the UE to the trace record. In case of a match, for logged MDT, the RNC shall capture it and put it to the trace record. Otherwise it shall discard the MDT report.\nNOTE:\tFor management based Immediate MDT, TRSR may be duplicated among different RNCs when multiple cells are selected as the area scope for the same MDT job. In this case, the combination of TRSR and the UE’s serving cell CGI in the MDT report can uniquely identify one trace recording session.\n8)\tThe Trace Records shall be forwarded to the Trace Collection Entity indicated in the MDT report received from the UE in case of Logged MDT. The RNC translates the TCE Id received from the UE to the TCE  IP Address before it forwards the measurement records to the TCE. (The address translation is done by using configured mapping in the RNC.) The RNC shall not provide the IMSI in the MDT.\nThe Immediate MDT measurement configuration is deleted in the UE together with the RRC context when entering idle mode.\nThe Logged MDT trace session is preserved in the UE until the duration time of the trace session expires, including also multiple idle periods interrupted by idle-connected-idle state transitions.\nThe Logged MDT trace session context of the UE is stored in the network as long as the trace session is active, including also the periods when the UE is in connected state.\nEM shall validate that the MCC and MNC in the Trace Reference is the same as the PLMN supported by all the RNCs specified in the area scope. If the RNC receives a request with a PLMN in the TraceReference that does not match any PLMN in its list, it shall ignore the request.\nWhen a SGSN, GGSN or BM-SC receives Trace Session activation from the EM it shall start a Trace Session. The trace control and configuration parameters of the Trace Session are received in the Trace Session activation from the EM. The SGSN/GGSN/BM-SC shall not forward these trace control and configuration parameters to other nodes. The received trace control and configuration parameters shall be saved and used to determine when and how to start a Trace Recording Session. (Starting a Trace Recording Session is described in subclause 4.2.2.2).\nWhen a MSC Server receives Trace Session activation from the EM it shall start a Trace Session. The trace control and configuration parameters of the Trace Session are received in the Trace Session activation from the EM. The MSC Server shall not forward these trace control and configuration parameters to other nodes. The received trace control and configuration parameters shall be saved and used to determine when and how to start a Trace Recording Session. (Starting a Trace Recording Session is described in subclause 4.2.2.3).\nWhen a S-CSCF/P-CSCF receives Trace Session activation from EM, the S-CSCF/P-CSCF shall start a Trace Session. The Trace control and configuration parameters of the Trace Session, received from EM in the Trace Session activation, shall be saved. The Trace control and configuration parameters define when the S-CSCF and P-CSCF shall start and stop a Trace Recording Session.\nThe following figure illustrates the Trace Session activation in S-CSCF and in P-CSCF in case of Management based activation.\nThe figure depicts the trace session activation in IMS, showing the initiation of a session and the subsequent transmission of data. The session is initiated by the sender, which sends a request to the receiver, and the receiver responds with a response. The transmission of data is depicted as a series of packets, each containing a header and payload. The figure illustrates the flow of data and the initiation of a session, highlighting the importance of trace session activation in the IMS architecture.\nFigure 4.1.1.5.1: Trace Session activation in IMS\nIn E-UTRAN the Management Based Trace Activation can be fulfilled with the E-UTRAN Cell Traffic trace functionality. In this case the Trace Session Activation is done to one or a list E-UTRAN cells within one eNodeB, where Trace Session is activated.\nThe following trace control and configuration parameters of the Trace Session are received by eNodeB in the Trace Session activation message from the EM:\n-\tTrace Reference\n-\tTrace Depth\n-\tTrace Target: list of E-UTRAN cells\n-\tList of Interfaces for eNB\n-\tTrace Collection Entity IP Address\nWhen eNodeB receives the Trace Session Activation message from the EM for a given or a list of E-UTRAN cell(s) the eNodeB shall start a Trace Session for the given or list of E-UTRAN cell(s). If no list of E-UTRAN cell(s) is present the eNodeB shall start a Trace Session for all cells.\nFor management based MDT data collection with no IMSI/IMEI(SV) criteria, the UE selection can be done in the radio network at eNB based on the input information received from EM and the user consent information stored in the eNB. This mechanism works for the following OAM input parameters:\n-\tArea information only\nThe following figure summarizes the flow how the MDT configuration is done utilising the cell traffic trace functionality for this scenario:\nThe figure depicts a simplified representation of a management-based MDT activation in an E-UTRAN network. It illustrates the various components involved in the activation process, including the base station (BTS), user equipment (UE), and the management device (MDM). The figure highlights the importance of proper network configuration and management to ensure efficient and reliable communication.\nFigure 4.1.1.6a.1: Example formanagement  based MDT activation in E-UTRAN\n0)\tWhenever the eNB receives the Management based MDT allowed IE in Initial Context Setup Request or in Handover Request message, it shall save it for possible later usage.\n1)\tThe EM sends a Trace Session activation request to the eNB. This request includes the parameters for configuring UE measurements:\n-\tJob Type\n-\tArea Scope where the UE measurements should be collected: list of E-UTRAN cells. Tracking Area should be converted to E-UTRAN cell.\n-\tList of Measurements\n-\tReporting Trigger\n-\tReport Interval\n-\tReport Amount\n-\tEvent Threshold\n-\tLogging Interval\n-\tLogging Duration\n-\tTrace Reference\n-\tTCE IP Address\n-\tAnonymization of MDT Data.\n-\tMeasurement Period LTE (if either of the measurements M4, M5 is requested)\n-\tCollection Period for RRM Measurements LTE (present only if M3 measurements are requested).\n-\tCollection Period M6 in LTE (present only if any of M6 measurements (DL or UL) is requested).\n-\tCollection Period M7 in LTE (present only if any of M7 measurements (DL or UL)is requested).\n-\tPositioning Method\n-\tMDT PLMN List\nNote that at the same time not all the parameters can be present. The criteria for which parameters are present are described in clause 5 of the present document.\n2)\tWhen eNB receives the Trace Session activation request from its EM, it shall start a Trace Session and should save the parameters associated to the Trace Session.\n3)\teNB shall select the suitable UEs for MDT data collection. The selection is based on the area received from the EM and the area where UE islocated, user consent information received from the core network as part of the Management Based MDT Allowed IE (As described in section in 4.6. of this document).If the user is not in the specified area or if the Management Based MDT Allowed IE is not present in the UE context the UE shall not be selected by the eNB for MDT data collection. During UE selection, the eNB shall take into account also the UE capability (MDT capability) when it selects UE for logged MDT configuration. If the UE does not support logged MDT the UE shall not be selected. \nIf M4 or M5 measurements are requested in the MDT configuration, eNB should start the measurement according to the received configuration. Details of the measurements are defined in TS 36.314 [56].\n4)\teNB shall activate the MDT functionality to the selected UEs. When eNB selects a UE it shall take into account the availability of Management Based MDT Allowed IE in the user context and the area scope parameter received in MDT configuration (Trace Session activation). Detailed description about user consent handling and how it is provided to the eNB is described in section 4.6.2. If there is no Management Based MDT Allowed IE in the user context or the user is outside the area scope defined in the MDT configuration, the UE shall not be selected for MDT data collection. The eNB shall assign Trace Recording Session Reference corresponding to the selected UE. The eNB shall send at least the following configuration information to the UE in case of Logged MDT:\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tTCE Id (The value signalled as IP address of TCE from the EM is mapped to a TCE Id, using a configured mapping in the eNB)\n-\tLogging Interval\n-\tLogging Duration\n-\tAbsolute time reference\n-\tArea Scope where the UE measurements should be collected: list of E-UTRAN cells/TA.\n-\tMDT PLMN List\nNOTE:\tFor UEs currently being in idle mode and camping in the cell the logged MDT configuration cannot be sent. These UEs may be configured when they initiate some activity (e.g., Service Request or Tracking Area Update) at next time.\nIn case of Immediate MDT the following parameters shall be sent to the UE:\n-\tList of Measurements\n-\tReporting Trigger\n-\tReport Interval\n-\tReport Amount\n-\tEvent Threshold\nNote that at the same time not all the parameters can be present. Conditions of the parameters are described in clause 5 of the present document.\nIf positioning method indicates GNSS positioning, eNB should activate the GNSS module of the UE via RRC as specified in TS 36.331 [32]. If positioning method indicates E-Cell ID positioning, the eNB should collect the UE reported UE Rx-Tx time difference measurements as specified in TS 36.331[32] measurement procedures, as well as, any available eNB measured eNB Rx-Tx time differenc, Angle of Arrival measurements as specified in TS 36.214 [38] and capture it in MDT trace record.\nIf Reporting Trigger parameter indicates that all configured RRM measurement trigger should be reported in MDT, then eNB should ask the UE to provide the \"best effort\" location information together with the measurement reporting by setting the includeLocationInfo IE in all RRC measurement reporting configurations.\n5)\tWhen UE receives the MDT activation it shall start the MDT functionality based on the received configuration parameters.\n6)\tThe eNodeB shall not retrieve MDT report from the UE if UE’s rPLMN does not match the PLMN where TCE used to collect MDT data resides (e.g. eNodeB’s primary PLMN). When the eNodeB receives the MDT report from UE, the eNodeB shall get the Trace Recording Session Reference, Trace Reference and TCE Id from the report, and compare the Trace PLMN (PLMN portion of Trace Reference) with the PLMN where TCE used to collect MDT data resides (e.g. its primary PLMN) and discard MDT report in case of a mismatch. Otherwise if the MDT anonymization requires the IMEI-TAC in the MDT record eNodeB shall send the Trace Recording Session Reference, Trace Reference, serving cell CGI, and TCE IP Address in the CELL TRAFFIC TRACE message to the MME via the S1 connection. When MME receives this S1 signalling message containing the Trace Recording Session Reference , Trace Reference, serving cell CGI, and the Privacy Indicator (that shall be set to Logged MDT or Immediate MDT depending on the configured Job Type) if so indicated in the privacy indicator, the MME shall look up the subscriber identities (IMEI (SV)) of the given call from its database, and send the IMEI-TAC together with the Trace Recording Session Reference and Trace Reference and for immediate MDT also the serving cell CGI to the TCE, as described in section 4.7 of the present document. For logged MDT, MME will send the IMEI-TAC together with the Trace Recording Session Reference, Trace Reference to the TCE.\nNOTE: For management based Immediate MDT, TRSR may be duplicated among different eNodeBs when multiple cells are selected as the area scope for the same MDT job. In this case, the combination of TRSR and the UE’s serving cell CGI in the MDT report can uniquely identify one trace recording session.\n7)\tFor Immediate MDT when the eNB receives the MDT report from the UE in the RRC message the eNB shall capture it and put the UE’s serving cell CGI together with the MDT report from the UE to the trace record. A UE configured to perform Logged MDT measurements in IDLE indicates the availability of MDT measurements, by means of a one bit indicator, in RRCConnectionSetupComplete message during connection establishment as specified in [2]. The eNB can decide to retrieve the logged measurements based on this indication by sending the UEInformationRequest message to the UE. The UE can answer with the collected MDT logs in UEInformationResponse message.\n8)\tThe eNB shall forward the Trace Records to the Trace Collection Entity (TCE). In case of logged MDT, the TCE Id is indicated in the MDT report is translated to the actual IP address of the TCE by the eNB before it forwards the measurement records. (The address translation is using configured mapping in the eNB.) In case of immediate MDT, the IP address of the TCE is indicated for the eNB in the trace configuration.\nThe Immediate MDT measurement configuration is deleted in the UE together with the RRC context when entering idle mode.\nThe Logged MDT trace session is preserved in the UE until the duration time of the trace session expires, including also multiple idle periods interrupted by idle-connected-idle state transitions.\nThe Logged MDT trace session context of the UE is stored in the network as long as the trace session is active, including also the periods when the UE is in connected state.\nEM shall validate that the MCC and MNC specified in the Trace Reference is the same as the PLMN supported by all the cells specified in the area scope. If the eNodeB receives a request with a PLMN in the TraceReference that does not match any PLMN in its list, it shall ignore the request.\nFor management-based Logged MBSFN MDT data collection with no IMSI/IMEI(SV) criteria, the UE selection can  be done in the radio network at eNB based on the input information received from EM, the device capability (MDT capable and UEs capable of logging Measurements for MBSFN) and the user consent information stored in the eNB. This mechanism works for the following OAM input parameters:\n-\tArea Information\n-\tMBSFN Area List\nThe following figure summarizes the flow how the Logged MBSFN MDT configuration is done utilising the cell traffic trace functionality for this scenario:\nThe figure depicts a management-based MBSFN (Management-based Base Station Synchronization and Forwarding) Logged MDT activation in E-UTRAN, which is a key component of the 5G network architecture. The figure illustrates the various elements involved in the MBSFN process, including the base station (gNB), user equipment (UE), and scatterers. The diagram highlights the importance of beamforming techniques to mitigate interference and ensure reliable communication.\nFigure 4.1.1.6b.1: Example for management-based MBSFN Logged MDT activation in E-UTRAN\n0)\tWhenever the eNB receives the Management based MDT allowed IE in Initial Context Setup Request or in Handover Request message, it shall save it for possible later usage.\n1)\tThe EM sends a Trace Session activation request to the eNB. This request includes the parameters for configuring UE measurements:\n-\tJob Type  - Logged MBSFN MDT\n-\tArea Scope where the UE measurements should be collected: list of E-UTRAN cells. Tracking Area, should be converted to E-UTRAN cell.\n-\tLogging Interval\n-\tLogging Duration\n-\tTrace Reference\n-\tTCE IP Address\n-\tAnonymization of MDT Data.\n-\tMDT PLMN List\n-\tMBSFN Area List (applicable if Job Type is Logged MBSFN MDT)\nNOTE: The criteria for which parameters are present are described in clause 5 of the present document.\n2)\tWhen eNB receives the Trace Session activation request from its EM, it shall start a Trace Session and should save the parameters associated to the Trace Session.\n3)\teNB shall select the suitable UEs for MDT data collection. The selection is based user consent information received from the core network as part of the Management Based MDT Allowed IE (As described in section in 4.6. of this document).If the Management Based MDT Allowed IE is not present in the UE context the UE shall not be selected by the eNB for MDT data collection. During UE selection, the eNB shall take into account also the UE capability (MDT capability and MBSFN logging capability). If the UE does not support MBSFN logging capability the UE shall not be selected for Logged MBSFN MDT.\n4)\teNB shall activate the Logged MBSFN MDT functionality to the selected UEs. The eNB shall assign Trace Recording Session Reference corresponding to the selected UE. The eNB shall send at least the following configuration information to the UE in case of Logged MDT or Logged MBSFN MDT:\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tTCE Id (The value signalled as IP address of TCE from the EM is mapped to a TCE Id, using a configured mapping in the eNB)\n-\tLogging Interval\n-\tLogging Duration\n-\tAbsolute time reference\n-\tArea Scope where the UE measurements should be collected: list of E-UTRAN cells/TA\n-\tMDT PLMN List\n-\tMBSFN Area List\nNOTE:\tFor UEs currently being in idle mode and camping in the cell the logged MBSFN MDT configuration cannot be sent. These UEs may be configured when they initiate some activity (e.g., Service Request or Tracking Area Update) at next time.\nNOTE: Conditions of the parameters are described in clause 5 of the present document.\n5)\tWhen UE receives the MDT activation it shall start the MDT functionality based on the received configuration parameters.\n6)\tThe eNodeB shall not retrieve MDT report from the UE if UE’s rPLMN does not match the PLMN where TCE used to collect MDT data resides (e.g. eNodeB’s primary PLMN). When the eNodeB receives the MDT report from UE, the eNodeB shall get the Trace Recording Session Reference, Trace Reference and TCE Id from the report, and compare the Trace PLMN (PLMN portion of Trace Reference) with the PLMN where TCE used to collect MDT data resides (e.g. its primary PLMN) and discard MDT report in case of a mismatch. Otherwise if the MDT anonymization requires the IMEI-TAC in the MDT record eNodeB shall send the Trace Recording Session Reference, Trace Reference, serving cell CGI, and TCE IP Address in the CELL TRAFFIC TRACE message to the MME via the S1 connection. When MME receives this S1 signalling message containing the Trace Recording Session Reference , Trace Reference, serving cell CGI, and the Privacy Indicator (that shall be set to Logged MDT – for  ) if so indicated in the privacy indicator, the MME shall look up the subscriber identities (IMEI (SV)) of the given call from its database, and send the IMEI-TAC together with the Trace Recording Session Reference and Trace Reference to the TCE.\nNOTE: For management-based Immediate MDT, TRSR may be duplicated among different eNodeBs when multiple cells are selected as the area scope for the same MDT job. In this case, the combination of TRSR and the UE’s serving cell CGI in the MDT report can uniquely identify one trace recording session.\n7)\tA  UE configured to perform Logged MBSFN MDT in IDLE or CONNECTED mode (when MBMS service is available)  indicates the availability of MDT measurements, by means of a one bit indicator, in RRCConnectionSetupComplete message during connection establishment as specified in [2]. The eNB can decide to retrieve the logged measurements based on this indication by sending the UEInformationRequest message to the UE. The UE can answer with the collected MDT logs in UEInformationResponse message.\n8)\tThe TCE Id indicated in the MDT report is translated to the actual IP address of the TCE by the eNB before it forwards the measurement records. (The address translation is using configured mapping in the eNB.)\nThe Logged MBSFN MDT session is preserved in the UE until the duration time of the trace session expires, including also multiple idle periods interrupted by idle-connected-idle state transitions.\nThe Logged MBSFN MDT trace session context of the UE is stored in the network as long as the trace session is active, while UE is in idle or connected state.\nEM shall validate that the MCC and MNC specified in the Trace Reference is the same as the PLMN supported by all the cells specified in the area scope. If the eNodeB receives a request with a PLMN in the TraceReference that does not match any PLMN in its list, it shall ignore the request.\nWhen a MME, SGW or PGW receives Trace Session activation from the EM, it shall start a Trace Session. The following trace control and configuration parameters of the Trace Session are received in the Trace Session activation from the EM:\n-\tTrace Target: IMSI or IMEISV\n-\tTrace Reference\n-\tTriggering Events for this network element\n-\tTrace Depth\n-\tList of Interfaces for this network element\n-\tTrace Collection Entity IP Address\nThe MME, SGW or PGW shall not forward these trace control and configuration parameters to other nodes. The received trace control and configuration parameters shall be saved and used to determine when and how to start a Trace Recording Session. (Starting a Trace Recording Session is described in subclause 4.2.2.6).\nWhen an AF, AMF, AUSF, NEF, NRF, NSSF, PCF, SMF, SMSF, UPF or UDM receives Trace Session activation from the management function, it shall start a Trace Session. The following trace control and configuration parameters of the Trace Session are received in the Trace Session activation from the management function:\n-\tTrace Target: SUPI or IMEISV.\n-\tTrace Reference.\n-\tTriggering Events for this network element.\n-\tTrace Depth.\n-\tList of Interfaces for this network element.\n-\tTrace Collection Entity IP Address for the file-based trace reporting or Trace Reporting Consumer URI for the streaming trace reporting.\nThe AF, AMF, AUSF, NEF, NRF, NSSF, PCF, SMF, SMSF, UPF or UDM shall not forward these trace control and configuration parameters to other nodes. The received trace control and configuration parameters shall be saved and used to determine when and how to start a Trace Recording Session. (Starting a Trace Recording Session is described in subclause 4.2.2.9).\nIn NG-RAN the Management Based Trace Activation can be fulfilled with the NG-RAN Cell Traffic trace functionality. In this case the Trace Session Activation is done to one or a list NG-RAN cells within one NG-RAN node, where Trace Session is activated.\nThe following trace control and configuration parameters of the Trace Session are received by NG-RAN node in the Trace Session activation message from the management system:\n-\tTrace Reference.\n-\tTrace Depth.\n-\tTrace Target: NG-RAN cells list.\n-\tList of Interfaces for NG-RAN node.\n-\tTrace Collection Entity IP Address for the file-based trace reporting or Trace Reporting Consumer URI for the streaming trace reporting.\nWhen NG-RAN node receives the Trace Session Activation message from the management system for a given or a list of NG-RAN cell(s) the NG-RAN node shall start a Trace Session for the given or list of NG-RAN cell(s). If no list of NG-RAN cell(s) is present the NG-RAN node shall start a Trace Session for all cells.\nFor management based MDT data collection with no IMSI/IMEI(SV)/SUPI criteria in the case of non-split architecture, the UE selection can be done in the radio network at gNB based on the input information received from management system and the user consent information stored in the gNB. This mechanism works for the following OAM input parameters:\n-\tArea information only\nThe following figure summarizes the flow as an example how the MDT configuration is done utilising the cell traffic trace functionality for this scenario:\n\nThe figure depicts a simplified representation of a non-split architecture in a 5G network, illustrating the management-based MDT activation process. The figure includes various components such as base stations (BTS), user equipment (UE), and scatterers. The diagram highlights the use of beamforming techniques to mitigate interference, and the presence of redundancy paths ensures failover reliability. The layered design of the optical backbone aligns with SDN principles, allowing for efficient network management and control.\nFigure 4.1.1.9.2.1: Example for management based MDT activation in NG-RAN in the case of non-split architecture\nWhenever the gNB receives the Management based MDT allowed IE in Initial Context Setup Request or in Handover Request message, it shall save it for possible later usage.\n1)\tThe management system sends a Trace Session activation request to the gNB. This request includes the parameters for configuring UE measurements:\n-\tJob Type.\n-\tArea Scope where the UE measurements should be collected: list of NG-RAN cells. Tracking Area should be converted to NG-RAN cell, s, additionally a list of NPN IDs in NG-RAN.\n-\tList of Measurements.\n-\tReporting Trigger.\n-\tReport Interval.\n-\tReport Amount.\n-\tEvent Threshold.\n-\tLogging Interval.\n-\tLogging Duration.\n-\tTrace Reference.\n-\tTCE IP Address.\n-\tAnonymization of MDT Data.\n-\tCollection Period for RRM Measurements NR (present only if any of M4 or M5 measurements are requested).\n-\tCollection Period M6 in NR (present only if any of M6 measurements (DL or UL) is requested).\n-\tCollection Period M7 in NR (present only if any of M7 measurements (DL or UL)is requested).\n-\tPositioning Method.\n-\tMDT PLMN List.\n-\tReport Type for Logged MDT (periodical logged or event-triggered measurement) for logged MDT only.\n- \tEvent Threshold, Hysteresis and Time to Trigger (present only if L1 event is configured for logged MDT)\n-\tEvent List for Event Triggered Measurement for logged MDT only.\n-\tArea Configuration for Neighbouring Cells for logged MDT only.\n-\tSensor Information for logged MDT and immediate MDT.\n-\tExcess packet delay thresholds (present only if M6 measurements are requested).\n\nNote that at the same time not all the parameters can be present. The criteria for which parameters are present are described in clause 5 of the present document.\n2)\tWhen gNB receives the Trace Session activation request from its management system, it shall start a Trace Session and should save the parameters associated to the Trace Session.\n3)\tgNB shall select the suitable UEs for MDT data collection. The selection is based on the area received from the management system and the area where UE is located, user consent information received from the core network as part of the Management based MDT PLMN List IE (As described in section in 4.9.2 of this document). If the user is not in the specified area or if the  Management based MDT PLMN List IE is not present in the UE context the UE shall not be selected by the gNB for MDT data collection. During UE selection, the gNB shall take into account also the UE capability (MDT capability) when it selects UE for logged MDT configuration. If the UE does not support logged MDT, the UE shall not be selected. \nIf M4 or M5 measurements are requested in the MDT configuration, gNB should start the measurement according to the received configuration. Details of the measurements are defined in TS 38.314 [50].\n4)\tgNB shall activate the MDT functionality to the selected UEs. When gNB selects a UE, it shall take into account the availability of Management based MDT PLMN List IE in the user context and the area scope parameter received in MDT configuration (Trace Session activation). Detailed description about user consent handling and how it is provided to the gNB is described in section 4.9.2. If there is no Management based MDT PLMN List IE in the user context or the user is outside the area scope defined in the MDT configuration, the UE shall not be selected for MDT data collection. The gNB shall assign Trace Recording Session Reference corresponding to the selected UE. The gNB shall send at least the following configuration information to the UE in case of Logged MDT:\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tTCE Id (The value signalled as IP address of TCE from the EM is mapped to a TCE Id, using a configured mapping in the gNB)\n-\tLogging Interval\n-\tLogging Duration\n-\tAbsolute time reference\n-\tArea Scope where the UE measurements should be collected: list of NG-RAN cells/TA, additionally a list of NPN IDs in NR.\n.\n-\tMDT PLMN List\n\nNOTE:\tFor UEs currently being in idle or inactive mode and camping in the cell the logged MDT configuration cannot be sent. These UEs may be configured when they initiate some activity (e.g., Service Request or Tracking Area Update) at next time.\nIn case of Immediate MDT, the following parameters shall be sent to the UE:\n-\tList of Measurements\n-\tReporting Trigger\n-\tReport Interval\n-\tReport Amount\n-\tEvent Threshold\n-\tExcess packet delay thresholds (present only if M6 UL measurements are requested)\nNote that at the same time not all the parameters can be present. Conditions of the parameters are described in clause 5 of the present document.\ngNB performs necessary actions (e.g. activates GNSS module of the UE, enables and collects certain positioning measurements) specified in TS 38.305 [52] according to the value of Positioning Method (see clause 5.10.19) received in the Trace configuration. gNB captures location information and/or positioning measurements in the MDT trace record.\nIf Reporting Trigger parameter indicates that all configured RRM measurement trigger should be reported in MDT, then gNB should ask the UE to provide the \"best effort\" location information together with the measurement reporting by setting the includeCommonLocationInfo IE in all RRC measurement reporting configurations.\n5)\tWhen UE receives the MDT activation it shall start the MDT functionality based on the received configuration parameters.\n6)\tThe gNB shall not retrieve MDT report from the UE if UE’s rPLMN does not match the PLMN where TCE used to collect MDT data resides (e.g. gNB’s primary PLMN). When the gNB receives the MDT report from UE, the gNB shall get the Trace Recording Session Reference, Trace Reference and TCE Id from the report, and compare the Trace PLMN (PLMN portion of Trace Reference) with the PLMN where TCE used to collect MDT data resides (e.g. its primary PLMN) and discard MDT report in case of a mismatch. Otherwise if the MDT anonymization requires the IMEI-TAC in the MDT record gNB shall send the Trace Recording Session Reference, Trace Reference, serving cell CGI, and TCE IP Address in the CELL TRAFFIC TRACE message to the AMF via the NG connection. When AMF receives this NG signalling message containing the Trace Recording Session Reference, Trace Reference, serving cell CGI, and the Privacy Indicator (that shall be set to Logged MDT or Immediate MDT depending on the configured Job Type) if so indicated in the privacy indicator, the AMF shall look up the subscriber identities (IMEI(SV)) of the given call from its database, and send the IMEI-TAC together with the Trace Recording Session Reference and Trace Reference and for immediate MDT also the serving cell CGI to the TCE, as described in section 4.7 of the present document. For logged MDT, AMF will send the IMEI-TAC together with the Trace Recording Session Reference, Trace Reference to the TCE.\nNOTE: For management based Immediate MDT, TRSR may be duplicated among different gNBs when multiple cells are selected as the area scope for the same MDT job. In this case, the combination of TRSR and the UE’s serving cell CGI in the MDT report can uniquely identify one trace recording session.\n7)\tFor Immediate MDT when the gNB receives the MDT report from the UE in the RRC message the gNB shall capture it and put the UE’s serving cell CGI together with the MDT report from the UE to the trace record. A UE configured to perform Logged MDT measurements in IDLE or INACTIVE indicates the availability of MDT measurements, by means of a one-bit indicator, in RRCConnectionSetupComplete message during connection establishment as specified in 3GPP TS 32.421 [2]. The gNB can decide to retrieve the logged measurements based on this indication by sending the UEInformationRequest message to the UE. The UE can answer with the collected MDT logs in UEInformationResponse message.\n8)\tThe gNB shall forward the Trace Records to the Trace Collection Entity (TCE). In case of logged MDT, the TCE Id is indicated in the MDT report is translated to the actual IP address of the TCE by the gNB before it forwards the measurement records. (The address translation is using configured mapping in the gNB.) In case of immediate MDT, the IP address of the TCE is indicated for the gNB in the trace configuration.\nThe Immediate MDT measurement configuration is deleted in the UE together with the RRC context when entering idle or inactive mode.\nThe Logged MDT trace session is preserved in the UE until the duration time of the trace session expires, including also multiple idle or inactive periods interrupted by various state transistions such as idle-connected-idlestate transitions.\nThe Logged MDT trace session context of the UE is stored in the network as long as the trace session is active, including also the periods when the UE is in connected state.\nManagement system shall validate that the MCC and MNC specified in the Trace Reference is the same as the PLMN supported by all the cells specified in the area scope. If the gNB receives a request with a PLMN in the TraceReference that does not match any PLMN in its list, it shall ignore the request.\nFor management based MDT data collection with no IMSI/IMEI(SV)/SUPI criteria in the case of split RAN architecture, the UE selection can be done in the radio network at gNB-CU-CP, gNB-CU-UP and gNB-DU based on the input information received from management system and the user consent information stored in the gNB-CU-CP, gNB-CU-UP, gNB-DU. The area scope as optional parameter is needed to apply this mechanism.\nThe following figure summarizes an example of the flow how the MDT configuration for gNB-CU-CP is done utilising the cell traffic trace functionality for this scenario:\nThe figure depicts a split architecture with gNB-CU-CP in a 5G network, illustrating the activation of a Management-based Dynamic Time-based (MDT) for gNB-CU-CP in a split architecture. The figure shows the activation of the MDT for gNB-CU-CP, which is a key component in managing the network's dynamic time-based (DT) traffic. The activation of the MDT ensures that the network can adapt to changing traffic patterns and maintain high performance. The figure also highlights the importance of managing DT traffic in a split architecture, as it can help to optimize network resources and improve overall performance.\nFigure 4.1.1.9.3.1: Example for management based MDT activation for gNB-CU-CP in NG-RAN in the case of split architecture\nIn the case of split RAN architecture, the management system may send the MDT activation directly to gNB-CU-CP, gNB-DU, or gNB-CU-UP. If a gNB-CU-CP receives a management based MDT activation, it may propagate the MDT configuration to gNB-DUs and/or gNB-CU-UPs over F1 and E1 in case that the activation involves measurements collected by multiple nodes under the same gNB-CU-CP control in split RAN architecture.\nThe overall description for management-based MDT activation in a split architecture is defined in TS 38.401 [44].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.1.2\tSignalling activation",
                            "text_content": "In Signalling activation, the Trace Activation shall be carried out from the Core Network EM only [EM (PS), EM (CS), EM (HSS), EM (UE) and EM(EPC) are generally considered to be in the Core Network. A Core Network EM can be any of these or their combinations].\nIn case of home subscriber trace (i.e. in the HPLMN) the Trace Session activation shall go to the HSS / MSC Server / SGSN / MME. Instances where the home subscriber is roaming in a VPLMN, the HSS may initiate a trace in that VPLMN. The VPLMN may reject such requests.\nIn case of foreign subscriber trace (i.e. the HPLMN operator wishes to trace foreign subscribers roaming in his PLMN) the Trace Session activation shall go the MSC Server/VLR, SGSN / MME. Depending on the Trace Control and Configuration parameters received, the Core Network shall propagate the activation to selected NE's in the entire network – RAN and Core Network.\nIf the NE failed to activate the Trace Session, a Trace failure notification shall be sent to the TCE, and the Trace failure notification has the the same parameters as the notification notifyTraceRecordingSessionFailure defined in 3GPP TS 32.442 [24], the Trace failure notification file XML schema is defined in Annex A.\nIn 5GS the signaling trace activation utilizes the Services Based Management Architecture (SBMA) defined in TS 28.533 [48]. A 5GC NE is configured with Trace Control and Configuration parameters via interaction between Provisioning MnS (see definitions in TS 28.532 [47]) consumer and Provisioning MnS producer. Figure 4.1.2.1.2-1 below illustrates the 5GS signaling activation where the role of a Provisioning MnS producer is played by the 5GC NE and the role of a Provisioning MnS consumer is played by the Management System.\nIn case of home subscriber trace (i.e. in the HPLMN), the Trace Session activation shall go to the 5GC NE which played as the Provisioning MnS producer, such as UDM, AMF and SMF. Instances where the home subscriber is roaming in a VPLMN, the Provisioning MnS producer may initiate a trace in that VPLMN. The VPLMN may reject such requests.\nIn case of foreign subscriber trace (i.e. the HPLMN operator wishes to trace foreign subscribers roaming in his PLMN), the Trace Session activation shall go to the 5GC NE located in the PLMN operator (i.e. the 5GC NE belongs to VPLMN as described in clause 4.2.4 of TS 23.501 [40], such as AMF/SMF).\nDepending on the Trace Control and Configuration parameters received, the configured 5GC NE shall propagate the activation to selected NE's in the entire network – RAN and Core Network.\nThe figure depicts a schematic overview of signaling activation for 5G, illustrating the various stages and components involved in the signaling process. It includes key elements such as base stations (BSS), user equipment (UE), and scatterers, as well as the role of the network in providing signal coverage and quality. The figure highlights the importance of signal propagation in 5G networks, emphasizing the need for efficient signal paths and beamforming techniques to mitigate interference and ensure reliable communication.\nFigure 4.1.2.1.2-1: Overview of signaling activation for 5GS\nIf the NE failed to activate the Trace Session in a file-based reporting case, a Trace failure notification shall be sent to the TCE. XML based encoding of the Trace failure notification shall follow the Trace failure notification file XML schema defined in Annex A. Administrative messages can also be used if the NE failed to activate a Trace Session, or if there are errors for an ongoing session, and are included in the trace data. An example of an administrative message is the Trace File Abnormal Closed administrative message (see 3GPP TS 32.423 [3]).\n\nThe following figure represents the signalling based trace functionality within a PLMN. The figure represents a typical PLMN network. A dotted arrow with \"Trace Parameter Configuration\" represents the availability of the trace functionality at the EM for that domain. However, it can be done from the EM (CS Domain). Similarly \"Trace Parameter Propagation\" is allowed only for the interfaces indicated in the figure. E.g. there is no parameter propagation over Iu-B.\nThe trace propagation across multiple PLMNs of the same operator (e.g. deployment scenario where UMTS part of the network has one PLMN and LTE part of the network as another PLMN) follows the rules of the Intra-PLMN signalling activation.\nNOTE:\tFor tracing on the basis of IMEI(SV), the signalling based activation can be only initiated from the MSC/VLR or SGSN.\nThe figure depicts an overview of intra-PLMN signalling activation for UMTS and EPS, highlighting the various signaling paths and their activation status.\nFigure 4.1.2.2.1: Overview of Intra-PLMN Signalling Activation for UMTS and EPS\nThe following figure represents the signalling based trace functionality between PLMNs. This is particularly useful when a roaming subscriber needs to be traced in a network. The figure represents a typical PLMN network and its connections with another PLMN’s HSS. A dotted arrow with \"Trace Parameter Configuration\" represents the availability of the trace functionality at the EM for that domain. E.g. you cannot invoke a Signalling Trace at the EM (UTRAN) because there is no such arrow shown in the figure. You can however do it from the EM (CS Domain). Similarly \"Trace Parameter Propagation\" is allowed only for the interfaces indicated in the figure. E.g. there is no parameter propagation over Iu-B.\nNOTE:\tThere is no intention to allow tracing of a home subscriber roaming in a foreign network i.e. the trace function is limited to PLMNs of a single operator.\nThe figure depicts the inter-PLMN signalling activation for UMTS and EPS, illustrating the various signaling paths and their activation points. It highlights the importance of proper signaling in ensuring reliable communication between different network layers.\nFigure 4.1.2.3.1: Overview of Inter-PLMN Signalling Activation for UMTS and EPS\nSee subclause 4.2.3.1.\nThe following figure shows the Trace Session activation in the PS domain. The figure is an example of tracing PDP context.\nThe figure depicts a trace session activation in the PS domain for a PDP context, illustrating the flow of data between the sender and receiver. The session is initiated by the sender, which sends a PDP message to the receiver. The receiver then processes the message and sends a response back to the sender. The trace shows the sequence of events, including the sender's message, the receiver's response, and the subsequent data exchange. This figure provides a visual representation of the data flow in a PS domain, which is a key concept in network management and troubleshooting.\nFigure 4.1.2.5.1: Trace session activation in PS domain for PDP Context\nWhen a UE registers with the network by sending an ATTACH_REQUEST message to the SGSN, it updates the location information in the HSS by sending the UPDATE_GPRS_LOCATION message to the HSS. The HSS checks if the UE is being traced. If it is being traced, the HSS shall propagate the trace control and configuration parameters to the SGSN by sending a MAP-ACTIVATE_TRACE_MODE - see 3GPP TS 29.002 [11] message to the SGSN. When an inter-SGSN routing area update occurs, HSS shall send the MAP-ACTIVATE_TRACE_MODE message to the new SGSN.\nWhen SGSN receives the MAP-ACTIVATE_TRACE_MODE message it shall store the trace control and configuration parameters and shall start a Trace Session.\nWhen any of the triggering events defined in the trace control and configuration parameters occur, (e.g. PS session is started (i.e. a ACTIVATE PDP CONTEXT REQUEST message is received from the UE)) the SGSN shall propagate the trace control and configuration parameters to the GGSN (by sending a GTP-CREATE_PDP_CONTEXT_REQUEST message) and to the radio network (by sending a RANAP-CN_INVOKE_TRACE message), if it is defined in the trace control and configuration parameters (NE types to trace). The Trace Session activation to UTRAN is described in clauses 4.1.2.4.\nWhen HSS sends the MAP-ACTIVATE_TRACE_MODE message to SGSN it shall include the following parameters to the message (The values related to the EPS domain shall be used for the Trace Session activation through the S3 interface in case of an Inter-RAT handover event.):\n-\tTrace Target: IMSI (M).\n-\tTrace Reference (M).\n-\tTriggering Events for SGSN (M) , GGSN (M) , MME (M), Serving GW(M) and PDN GW(M).\n-\tTrace Depth (M).\n-\tList of NE Types to trace (M).\n-\tList of Interfaces for SGSN (O), GGSN (O) and/or RNC (O) , MME (O), Serving GW (O), PDN GW(O), eNB(O).\n-\tTrace Collection Entity IP Address (O).\nWhen the SGSN sends the GTP-CREATE_PDP_CONTEXT_REQUEST message to GGSN it shall include the following parameters to the message:\n-\tTrace Target: IMSI or IMEI(SV) (M).\n-\tTrace Reference (M).\n-\tTrace Recording Session Reference (M).\n-\tTriggering Events for GGSN (M).\n-\tTrace Depth (M).\n-\tList of Interfaces for GGSN (O).\n-\tTrace Collection Entity IP Address (O).\nFigure 4.1.2.5.2 is an example of tracing for MBMS Context.\nThe figure depicts a trace session activation in the PS domain for MBMSContext, illustrating the flow of data between the sender and receiver. The session is initiated by the sender, which sends a message to the receiver, and the receiver responds with a response. The trace session is a crucial component of the MBMSContext protocol, enabling efficient communication between the sender and receiver.\nFigure 4.1.2.5.2: Trace session activation in PS domain for MBMSContext\nWhen HSS receives a Trace Session activation from its , it shall store the received trace control and configuration parameters. At this point a Trace Session shall be started in the HSS.\nWhen a UE registers with the network by sending an ATTACH_REQUEST message to the SGSN, it updates the location information in the HSS by sending the UPDATE_GPRS_LOCATION message to the HSS. The HSS checks if the UE is being traced. If it is being traced, the HSS shall propagate the trace control and configuration parameters to the SGSN by sending a MAP-ACTIVATE_TRACE_MODE message to the SGSN. When an inter-SGSN routing area update occurs, HSS shall send the MAP-ACTIVATE_TRACE_MODE message to the new SGSN.\nWhen SGSN receives the MAP-ACTIVATE_TRACE_MODE message it shall store the trace control and configuration parameters and shall start a Trace Session.\nIn case of an inter-SGSN handover the trace control and configuration parameters (both PS domain specific and EPS domain specific parameters) shall be propagated to the target SGSN.\nIn case of an inter-RAT handover the SGSN shall send the PS and EPS specific Trace control and configuration parameters to the target MME via the S3 interface.\nWhen any of the triggering events defined in the trace control and configuration parameters occur, (i.e. an ACTIVATE MBMS CONTEXT REQUEST message is sent to the UE)) the SGSN shall propagate the trace control and configuration parameters to the GGSN (by sending a GTP-CREATE_MBMS_CONTEXT_REQUEST message) and to the radio network (by sending a RANAP-CN_INVOKE_TRACE message), if it is defined in the trace control and configuration parameters (NE types to trace). The Trace Session activation to UTRAN is described in clauses 4.1.2.4.\nThe GGSN shall propagate the trace control and configuration parameters to the BM-SC (by sending a Diameter Gmb AAR message) if the BM-SC is defined in the trace control and configuration parameters (NE types to trace).\nWhen HSS sends the MAP-ACTIVATE_TRACE_MODE message to SGSN it shall include the following parameters in the message:\n-\tTrace Target: IMSI (M).\n-\tTrace Reference (M).\n-\tTriggering Events for SGSN (M), GGSN (M) and BM-SC (M).\n-\tTrace Depth (M).\n-\tList of NE Types to trace (M).\n-\tList of Interfaces for SGSN (O), GGSN (O), BM-SC (O) and/or RNC (O).\n-\tTrace Collection Entity IP Address (O).\nWhen the SGSN sends the GTP-CREATE_MBMS_CONTEXT_REQUEST message to GGSN it shall include the following parameters in the message:\n-\tTrace Target: IMSI or IMEI(SV) (M).\n-\tTrace Reference (M).\n-\tTrace Recording Session Reference (M).\n-\tTriggering Events for GGSN (M) and BM-SC (M).\n-\tTrace Depth (M).\n-\tList of Interfaces for GGSN (O) and BM-SC (O).\n-\tTrace Collection Entity IP Address (O).\nWhen the GGSN sends the Diameter Gmb AAR message to the BM-SC it shall include the following parameters in the message:\n-\tTrace Target: IMSI or IMEI(SV) (M).\n-\tTrace Reference (M).\n-\tTrace Recording Session Reference (M).\n-\tTriggering Events for BM-SC (M).\n-\tTrace Depth (M).\n-\tList of Interfaces for BM-SC (O).\n-\tTrace Collection Entity IP Address (O).\nFigure 4.1.2.6.1 shows the Trace Session activation in the CS domain. The figure is an example of tracing Mobile Originating Call.\nThe figure depicts a detailed representation of the trace session activation in the CS domain, illustrating the various components and their interactions. It highlights the role of the session controller (SC) in managing the session activation process, which is crucial for ensuring the smooth operation of the network. The figure also includes the session controller (SC) and the session manager (SM) in the context of the network, highlighting their roles in managing session activation and ensuring the network's performance.\nFigure 4.1.2.6.1: Trace Session Activation in CS domain\nWhen HSS receives Trace Session activation from the  it should store the trace control and configuration parameters associated to the Trace Session.\nIf the UE registers to the network, by sending a LOCATION UPDATING REQUEST message to the MSC/VLR, the MSC Server/VLR updates the location information in the HSS by sending the MAP-UPDATE_LOCATION message to the HSS. After receiving the UPDATE_LOCATION message HSS shall propagate the trace control and configuration parameters by sending a MAP-ACTIVATE_TRACE_MODE message to the MSC Server/VLR.\nWhen the MSC Server/VLR receives the MAP-ACTIVATE_TRACE_MODE message from the HSS, it shall store the trace control and configuration parameters.\nWhen any of the triggering event, defined in the trace control and configuration parameters, occurs (e.g. in case of Mobile Originating Call is started (i.e. the MSC Server receives the CM_SERVICE_REQUEST message with service type set to originating call establishment)) the MSC Server should propagate the trace control and configuration parameters to the MGW (by sending an ADD command with a trace package - see 3GPP TS 29.232 [10]) and to the radio network if it is defined in the trace control and configuration parameters (NE types to trace). Trace Session activation for UTRAN is described in clauses 4.1.2.4. In case of inter-MSC Server handover the MSC Server-A should propagate the trace control and configuration parameters to the MSC Server-B.\nWhen HSS sends the MAP-ACTIVATE_TRACE_MODE message to MSC Server it shall include the following parameters to the message:\n-\tTrace Target: IMSI (M).\n-\tTrace Reference (M).\n-\tTriggering Events for MSC Server (M) and MGW (M).\n-\tTrace Depth (M).\n-\tList of NE Types to trace (M).\n-\tList of Interfaces for MSC Server (O), MGW (O) and/or RNC (O).\n-\tTrace Collection Entity IP Address (O).\nWhen the MSC Server sends the ADD command with trace package to MGW it shall include the following parameters to the message:\n-\tTrace Target: IMSI or IMEI(SV) (M).\n-\tTrace Reference (M).\n-\tTrace Recording Session Reference (M).\n-\tTriggering Events for MGW (M).\n-\tTrace Depth (M).\n-\tList of Interfaces for MGW (O).\n-\tTrace Collection Entity (O) IP Address.\nIf a HPLMN operator activates a Trace Session for a home subscriber, while it (MS) is roaming in a VPLMN, it (HSS or UDM) may restrict the propagation of the Trace Session activation message to a MSC Server/VLR or to a SGSN or to a SMF located in the VPLMN.\nAlso, a MSC Server/VLR, a SGSN or a SMF located in a VPLMN may accept any Trace Session activation message(s) coming from an HSS or UDM located in another PLMN. However, there shall be a capability to reject activations from another PLMN.\nFigure 4.1.2.9.1.1 illustrates signalling based activation for service level tracing within a home IM CN SS and a visited IM CN SS. An arrow with \"Trace Parameter Configuration\" represents the availability of the trace functionality at the EM for that domain. Similarly, An arrow with \"Trace Parameter Propagation\" represents the ability to propagate trace parameters only for the interfaces indicated.\nThe figure depicts an overview of signalling activation for service level tracing in an IMS network, illustrating the various stages and components involved in the process.\nFigure 4.1.2.9.1.1: Overview of Signalling Activation for service level tracing for IMS\nTrace Activation shall be initiated from the Core Network EM only [EM (UE), and EM (HSS)].\nThe EM (UE) and the interactions between the EM (UE) and the UE shall be achieved using OMA Device Management [18].\nWhen service level tracing for IMS is required for a registered home subscriber in the home IM CN SS Trace Session activation shall go to the UE and the HSS. The HSS shall propagate the Trace Session activation to the S-CSCF, I-CSCF and the AS.\nThe S-CSCF and I-CSCF shall propagate the Trace Session activation to the P-CSCF. The Trace Session activation shall be propagated to the MRF, MGCF and BGCF via the S-CSCF. When an IMS NE (i.e. S/I/P-CSCF, AS, HSS, MRF, MGCF, BGCF) receives Trace Session activation it shall save the received Trace control and configuration parameters and shall start a Trace Session.\nWhen service level tracing for IMS is required for a registered home subscriber in a visited IM CN SS Trace Session activation shall go to the UE and the HSS. The HSS shall propagate the Trace Session activation to the S-CSCF, I-CSCF and the AS. The I-CSCF may prohibit the propagation of the Trace Session activation from the home IM CN SS to the P-CSCF in the visited IM CN SS.\n\nFigure 4.1.2.9.2.1 illustrates the sending of Trace Session activation towards the HSS, S-CSCF,  and \nP-CSCF during the registration of a UE with the IM CN SS.\nAs described in 3GPP TS 23.228 [15] for the purposes of signalling flows the user is considered always to be roaming. For a user roaming in their home network, the home network shall perform the role of the visited network elements and the home network elements.\nNOTE:\tFor detailed information of application level registration procedures for IMS see 3GPP TS 23.228 [15].\nThe figure depicts a trace session activation for a non-registered user, showing the steps involved in initiating a session. The user must first register with the network, which involves providing personal information and verifying their identity. Once registered, the user can initiate a session by sending a request to the network. The request is then processed by the network, which may involve authentication and authorization checks. Once the request is approved, the network sends a response to the user, indicating that the session is activated. The figure provides a clear and concise visual representation of the process, making it easy to understand the steps involved in initiating a session.\nFigure 4.1.2.9.2.1: Trace Session activation for non-registered user\nWhen HSS receives Trace Session activation from its EM (Step 1), it shall update the user information associated with the user for whom the trace is to be applied (Step 2). The HSS shall store the received trace control and configuration parameters (Step 3). At this point a Trace Session shall be started in the HSS.\nWhen the EM sends the Trace Session activation to the HSS it shall include the following trace and configuration parameters in the message:\n-\tTrace Target: Public User Identity (i.e. Identity of user initiating/terminating the service to be traced) (M)\n-\tService identification (M)\n-\tTrace Reference (M)\n-\tTriggering Events for HSS (M)\n-\tTrace Depth (M)\n-\tList of NE Types (M)\n-\tTriggering Events for S-CSCF (M), I-CSCF (M), P-CSCF (M), AS (M), BGCF (M), MRF (M), MGCF (M)\nWhen the EM sends the Trace Session activation to the HSS it may include the following trace and configuration parameters in the message if required:\n-\tList of Interfaces for HSS (O)\n-\tList of Interfaces for S-CSCF (O), I-CSCF (O), P-CSCF (O), AS (O), BGCF (O), MRF (O), MGCF (O).\nAs described in 3GPP TS 23.228 [15] when a UE registers with the network by sending a REGISTER message (Steps 4 to 10), the HSS sends Service Control (user and filter information) to the S-CSCF (Steps 11). It shall also propagate trace control and configuration parameters to the S-CSCF. At this point a Trace Session shall be started in the S-CSCF (Step 12).\nWhen the HSS sends the Cx-Put-Response operation to the S-CSCF (see 3GPP TS 29.228 [16]) it shall include the following trace and configuration parameters:\n-\tTrace Target: Public User Identity (i.e. Identity of user initiating/terminating the service to be traced) (M)\n-\tService identification (M)\n-\tTrace Reference (M)\n-\tTriggering Events for S-CSCF (M)\n-\tTrace Depth (M)\n-\tList of NE Types (M)\n-\tTriggering Events for I-CSCF (M), P-CSCF (M), BGCF (M), MGCF (M)\nWhen the HSS sends the Cx-Put-Response operation to the S-CSCF it may include the following trace and configuration parameters if required:\n-\tList of Interfaces for S-CSCF (O)\n-\tList of Interfaces for I-CSCF (O), P-CSCF (O), BGCF (O), MGCF (O)\n\nAs described in 3GPP TS 23.218 [14] on reception of a REGISTER request, the S-CSCF shall send a third-party REGISTER request to the Application Server if the registration request from the user matches a contained trigger as downloaded from the HSS (Step 13 and 14).\nAs described in 3GPP TS 29.328 [17] the Application Server shall request from the HSS information such as service and user related information. In this case, the HSS shall determine that a trace request for the user is active and shall return to the Application Server trace control and configuration parameters (Step 16). At this point a Trace Session shall be started in the AS (Step 17).\nWhen the HSS sends the Sh-Pull-Response operation to the AS (see 3GPP TS 29.328 [17]) it shall include the following trace and configuration parameters:\n-\tTrace Target: Public User Identity (i.e. Identity of user initiating/terminating the service to be traced) (M).\n-\tService identification (M)\n-\tTrace Reference (M)\n-\tTriggering Events for AS (M)\n-\tTrace Depth (M)\n-\tList of NE Types (M)\n-\tTriggering Events for MRF (M)\nWhen the HSS sends the Sh-Pull-Response operation to the AS it may include the following trace and configuration parameters if required:\n-\tList of Interfaces for AS (O)\n-\tList of Interfaces for MRF (O)\n\nUpon successful registration the S-CSCF shall return a SIP 200 OK and shall propagate the received trace control and configuration parameters to the I-CSCF (Step 18). At this point a Trace Session shall be started in the I-CSCF (Step 19).\nWhen the S-CSCF sends the 200 OK (Register) message to the I-CSCF (see 3GPP TS 24.228 [15]) it shall include the following trace and configuration parameters:\n-\tTrace Target: Public User Identity (i.e. Identity of user initiating/terminating the service to be traced) (M).\n-\tService identification (M)\n-\tTrace Reference (M)\n-\tTrace Depth (M)\n-\tTriggering Events for I-CSCF (M)\n-\tList of NE Types (M)\n-\tTriggering Events for P-CSCF (M)\nWhen the S-CSCF sends the 200 OK (Register) message to the I-CSCF it may include the following trace and configuration parameters if required:\n-\tList of interfaces for I-CSCF (O)\n-\tList of interfaces for P-CSCF (O)\nIf the P-CSCF resides in the same (i.e. home IM CN SS) network as the I-CSCF, the I-CSCF forwards the SIP 200 OK and shall propagate the retrieved trace control and configuration parameters to the P-CSCF (Step 20). At this point a Trace Session shall be started in the P-CSCF (Step 21).\nWhen the I-CSCF sends the 200 OK (Register) message to the P-CSCF (see 3GPP TS 24.228 [15]) it shall include the following trace and configuration parameters:\n-\tTrace Target: Public User Identity (i.e. Identity of user initiating/terminating the traced service) (M)\n-\tService identification (M)\n-\tTrace Reference (M)\n-\tTrace Depth (M)\n-\tTriggering Events for P-CSCF (M)\n-\tList of NE Types (M)\nWhen the I-CSCF sends the 200 OK (Register) message to the P-CSCF it may include the following trace and configuration parameters if required:\n-\tList of Interfaces for P-CSCF (O).\nIf the P-CSCF resides in a different (i.e. visited IM CN SS) network as the I-CSCF, the I-CSCF forwards the SIP 200 OK and may propagate the retrieved trace control and configuration parameters to the P-CSCF. If the P-CSCF is in a different network than the I-CSCF and the sending of trace control and configuration parameters from the home IM CN SS to the visited IM CN SS is prohibited then the I-CSCF shall restrict the sending of the trace control and configuration parameters.\nThe P-CSCF shall forward the SIP 200 OK to the UE. The P-CSCF shall not send the retrieved trace control and configuration parameters.\nFigure 4.1.2.9.3.1 illustrates the sending of Trace Session activation towards the HSS, S-CSCF,  and P-CSCF during the re-registration of a UE with the IM CN SS.\nAs described in 3GPP TS 23.228 [15] periodic application level re-registration is initiated by the UE either to refresh an existing registration or in response to a change in the registration status of the UE. Re-registration follows the same process as that defined for registration of a non-registered user.\nThe figure depicts a trace session activation for a registered UE in a 5G network. It illustrates the process of initiating a session, including the identification of the registered UE, the selection of a session type, and the initiation of the session. The figure also shows the flow of data between the UE and the network, with the session being the central element.\nFigure 4.1.2.9.3.1: Trace Session activation for registered UE\nWhen HSS receives Trace Session activation from its EM (Step 1), it shall update the user information associated with the user for whom the trace is to be applied (Step 2). The HSS shall store the received trace control and configuration parameters (Step 3). At this point a Trace Session shall be started in the HSS.\nWhen the EM sends the Trace Session activation to the HSS it shall include the trace and configuration parameters as described in clause 4.1.2.9.2.\nPrior to expiry of the agreed registration timer, the UE initiates a re-registration by sending a REGISTER message. \nThe subsequent steps of re-registration of the UE as described in 3GPP TS 23.228 [15] and the signalling flow steps as described in subclause 4.1.2.9.2 apply.\nThe IM CN SS shall request a re-authentication of a registered UE when Trace Session activation is required before the UE performs a periodic re-registration, and when the subscription status of the registered UE is not to be affected.\nFollowing a network initiated re-authentication, the UE shall re-register with the IM CN SS and the procedures described for Trace Session activation for a registered UE shall apply.\nFigure 4.1.2.9.4.1 illustrates the sending of Trace Session activation from the Device Management Server (DMS) to a UE and the subsequent propagation of a SIP message including a start trigger event from the UE and the P-CSCF.\n\nThe figure depicts a trace session activation at a UE, illustrating the process of a user initiating a session with a network service. The figure shows the UE's connection to the network, with the session activation occurring at the UE's interface. The visual elements include the UE's antenna, the network interface, and the session activation button, all of which are essential components of the session initiation process.\nFigure 4.1.2.9.4.1: Trace Session activation at a UE\nA management session shall be established (Step 1) in accordance with OMA Device Management [18]. When a UE receives Trace Session Activation (Step 2) as part of the received management operation it shall store the Trace Control and configuration parameters, and may (e.g. depending on Operator conditions) start a trace session (Step 3).\nWhen any of the triggering events occur at the UE (e.g. the service to be traced from the traced UE is initiated), and when the condition(s) as defined by the trace control and configuration parameters within the received management operation occur, the UE shall start a trace recording (Step 4). As described in subclause 4.2.3.5 the UE shall include in the outgoing SIP (service) signalling message (e.g. INVITE) a Start Trigger Event (Step 5).\nFigure 4.1.2.10.1 summarizes the Trace Session activation procedure in EPC:\nThe figure depicts the trace session activation procedure in an EPC (Enterprise Physical Layer) network with a GTP-based S5 interface. It illustrates the steps involved in initiating a session, including the initiation of a session, the establishment of a session, and the termination of the session. The figure provides a visual representation of the process, making it easier to understand and follow.\nFigure 4.1.2.10.1: Trace Session activation procedure in EPC with GTP based S5 interface:\nThe Trace Session activation in MME can come for a home subscriber trace from HSS via the S6a interface or for a foreign subscriber from the EM of MME.\nWhen the UE makes an attach request to the MME, it updates the location information in the HSS. The HSS checks if the UE is being traced. If it is being traced, the HSS shall propagate the trace control and configuration data to the MME by including the trace control and configuration parameters into the S6a-Insert subscriber data message or the S6a-Update Location Answer message. If the traced UE has already attached before receiving the Trace Session Activation from the EM/NM, the HSS shall also propagate the trace control and configuration data to the MME by either S6a-Insert subscriber data message or the S6a-Update Location Answer message. When MME receives the trace control and configuration data from the HSS it shall store the information and shall start a Trace Session.\nDuring inter-MME TAU, the MME shall propagate the trace control and configuration parameters to the target MME within an S10- Context Response as part of inter-MME TAU procedures. During attach procedures where the context information is requested from the target MME, the MME shall propagate the trace control and configuration parameters within an S10-Identification Response message. During inter-MME handover, the MME shall propagate the trace control and configuration parameters to the target MME within an S10- Forward Relocation Request message as part of inter-MME handover procedures. During inter-RAT handover procedure, the MME shall propagate the trace control and configuration parameters to the target SGSN via the S3 interface as part of the inter-RAT handover procedure.\nIf the List of NE Types parameter specifies tracing in the SGW and/or Tracing in the PGW, MME shall propagate the trace control and configuration parameters via the S11 interface to the SGW per one of the following messages:\n1)\tif a default bearer connection has not been established, via the S11: Create Session Request message;\n2)\totherwise via the S11-Trace Session Activation message.\nThe SGW upon receiving the trace control and configuration parameters shall start a trace session.\nIf the List of NE Types parameter specifies Tracing in the PGW, SGW shall propagate the trace control and configuration parameters via the S5 interface to the PGW per one of the following messages:\n1)\tif a default bearer connection has not been established, via the S5: Create Session Request message;\n2)\totherwise via the S5-Trace Session Activation message.\nThe PGW upon receiving the trace control and configuration parameters shall start a trace session.\nWhen a triggering events, defined in the trace control and configuration data occur (i.e. a session is started) a Trace Recording Session should  be started and the trace control and configuration data should be propagated to the radio network to the eNB if the List of NE Types parameter specifies eNB tracing. However if the triggering events parameter at MME indicates that all events should be traced, Trace Recording Session shall be started only when the user specific S1 association is setup to the eNB and the Trace Recording Session is kept as long as the user specific S1 association is released or the Trace Session is deactivated. See section 4.2.3.6.\nWhen HSS activates the trace to the MME the following trace control and configuration parameters shall be included in the message (the values related to the PS domain shall be used for Trace Session Activation during inter-RAT handover procedure):\n-\tTrace Target: IMSI or IMEISV\n-\tTrace Reference\n-\tTriggering Events for MME, Serving GW, PDN GW, SGSN, GGSN\n-\tTrace Depth\n-\tList of NE Types to trace\n-\tList of Interfaces for MME, Serving GW, PDN GW, eNB, SGSN, GGSN, RNC\n-\tTrace Collection Entity IP Address\nWhen MME activates the trace to the SGW the following trace control and configuration parameters shall be included in the message:\n-\tTrace Target: IMSI or IMEISV\n-\tTrace Reference\n-\tTriggering Events for Serving GW, PDN GW\n-\tTrace Depth\n-\tList of NE Types to trace\n-\tList of Interfaces for Serving GW, PDN GW\n-\tTrace Collection Entity IP Address\nWhen SGW activates the trace to the PGW the following trace control and configuration parameters shall be included in the message:\n-\tIMSI or IMEISV\n-\tTrace Reference\n-\tTriggering events for PDN GW\n-\tTrace Depth\n-\tList of Interfaces for PDN GW\n-\tTrace Collection Entity IP Address\nWhen MME sends the trace control and configuration parameters to the eNB the following information shall be included in the message:\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tTrace Depth\n-\tTrace Collection Entity\nand the following information may be included in the message:\n-\tList of Interfaces for eNB\nFigure 4.1.2.10.1.A illustrates the Trace Session activation in case of PMIP based S5 interface. The figure contains only the difference compare to the GTP based S5 interface.\nThe figure depicts a detailed representation of the session activation process from the SWG to the PGW in a 5G network, illustrating the various steps involved in managing session initiation. The figure includes key components such as the SWG, PGW, and the S5 interface, highlighting the importance of proper network management in ensuring efficient and reliable communication.\nFigure 4.1.2.10.1.A: Trace Session Activation from SWG to PGW in case of PMIP based S5 interface\nWhen the SGW receives the Trace Session activation message and the List of NE Type to trace parameter specifies Tracing in the PDN GW , SGW shall send Trace Session Activation to PDN GW via the PCRF. The Trace Session activation can be done as part of the IP CAN session establishment or as a standalone procedure [29].\nThe Trace Session Activation shall include the following information:\n-\tTrace Target: IMSI or IMEISV\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tTrace Depth\n-\tTriggering Events for PDN GW\n-\tList of Interfaces for PDN GW\n-\tTrace Collection Entity IP Address\nWhen the PCRF receives the Trace Session Activation it shall forward the same trace control and configuration parameters to the PDN GW [29].\nFigure 4.1.2.10.2 illustrates the Trace Session activation when the UE is attached from a non-3GPP access network with DSMIPv6 on S2c or PMIP on S2a or S2b interface.\nThe figure depicts the trace session activation procedure for a UE attaching from a non-3GPP access network via DSMIPv6 on S2c or PMIP on S2a/S2b, illustrating the steps involved in initiating a session with the PGW.\nFigure 4.1.2.10.2: Trace Session activation procedure to PGW in case of UE attaches from non-3GPP access network via DSMIPv6 on S2c or PMIP on S2a/S2b\nWhen the UE attaches to the EPC network via a non-3GPP access network the Trace Session activation to the PGW can be done via HSS and AAA server. Therefore when the UE attach is signalled to the HSS via non-3GPP access network, the HSS shall send the Trace control and configuration parameters to the AAA server as part of the user profile download [25]. The following information shall be included in the downloaded user data:\n-\tTrace Target:IMSI, or IMEI(SV)\n-\tTrace Reference\n-\tTriggering Event for PGW\n-\tTrace Depth\n-\tList of Interfaces for PGW\n-\tTrace Collection Entity IP Address\nWhen the AAA server receives the user profile, which contains also the trace control and configuration parameters, it shall store the received trace control and configuration parameters. The AAA server shall forward the received trace control and configuration parameters in the authorization when it receives the authorization request from the PGW during the PDN connectivity.\nThe event, which triggers the authorization in the PDN GW depend on the used IP mobility protocol:\nIn case of DSMIP (option A), it is a binding update received from the UE,\nIn case of PMIP (Option B), it is a proxy binding update request received from the Trusted Non-3GPP GW or ePDG playing the role of the Mobile Access Gateway (MAG)\nIf the UE is already registered to the HSS by a AAA server via the SWx interface, Trace Session activation shall also be possible from the HSS to the PDN GW via the AAA server. In that case the HSS sends the Trace Session activation message with a push profile request.\nThe AAA server shall examine the received user profile and if Trace Session activation is needed in the PDN GW, it shall initiate a re-authorization procedure towards the PDN GW. The Trace Session is activated to te PDN GW using this re-authorization procedure. When PDN GW receives the Trace Session activation message, it shall save the received trace control and configuration parameters.\nFigure 4.1.2.10.3 illustrates the Trace Session activation when the UE is attached from a non-3GPP access with GTP on the S2b interface.\nThe figure depicts the trace session activation procedure for a UE attaching to an EPC from a non-3GPP access using GTP-based S2b. The procedure involves the UE initiating a session with the PGW, which is then activated by the UE's access provider. The session is initiated using the S2b protocol, which is a key component of the 3GPP S2b protocol suite. The figure also includes a visual representation of the session activation process, including the initiation of the session, the establishment of the session, and the activation of the session.\nFigure 4.1.2.10.3: Trace Session activation procedure to PGW when the UE is attaches to EPC from a non-3GPP access with GTP based S2b\nWhen the UE attaches to the EPC network via a non-3GPP access network the Trace Session activation to the PGW can be done via HSS, AAA server and ePDG. Therefore when the UE attach is signalled to the HSS via non-3GPP access network, the HSS shall send the Trace control and configuration parameters to the AAA server as part of the user profile download (see [22] , [25] and [34]). \nThe following information shall be included in the downloaded user data:\n-\tTrace Target:IMSI, or IMEI(SV)\n-\tTrace Reference\n-\tTriggering Event for PGW\n-\tTrace Depth\n-\tList of Interface for PGW\n-\tTrace Collection Entity IP Address\nThe ePDG sends a GTPv2 Create Session Request which contains trace information message to the PGW. The RAT type indicates the non-3GPP IP access technology type.\nFigure 4.1.2.10.4 illustrates the Trace Session activation when the UE is already attached from a non-3GPP access with GTP based S2b, i.e. trace session activation after a session has been created.\nIf the UE is already registered to the HSS by a AAA server via the SWx interface, Trace Session activation shall also be possible from the ePDG to the PDN GW. In that case the HSS sends the Trace activation message with a push profile request.\nThe figure depicts the trace session activation procedure to PGW when the UE is already attached to an EPC from a non-3GPP access with GTP-based S2b. The procedure involves the UE initiating a session with the PGW, which is then activated by the UE's access provider. The session is initiated using the S2b protocol, which is a GTP-based protocol used for session initiation. The figure also shows the connection between the UE and the PGW, as well as the connection between the UE and the access provider.\nFigure 4.1.2.10.4: Trace Session activation procedure to PGW when the UE is already attached to EPC from a non-3GPP access with GTP based S2b\nThe AAA shall examine the received information and if Trace Session activation is needed in the PDN GW, it shall initiate a reauthorization request towards the ePDG. ePDG sends a GTPv2 Trace Session Activation message to the PGW when determining from the updated profile that a trace activation is needed. When PDN GW receives the Trace Session activation message, it shall save the received trace control and configuration parameters.\nThe following figure illustrates an example scenario when the UE attaches to the EPC domain, then makes an inter-RAT handover to the UMTS and makes another handover back from UMTS to E-UTRAN.\nIn this scenario, a trace session is activated in case of inter-RAT handover, as depicted in Figure 4.1.2.10.4.1. The figure illustrates the process of activating a trace session, which is a crucial step in ensuring the smooth operation of a network. The activation of a trace session is initiated by the RAT (Remote Access Terminal) and is dependent on the handover between two RATs. The figure shows the steps involved in the activation process, including the identification of the RATs involved, the initiation of the trace session, and the subsequent steps to ensure the successful handover.\nFigure 4.1.2.10.4.1 Example scenario for Trace Session activation in case of inter-RAT handover\nIn order to support the inter-RAT trace between EPS and PS domain when the HSS sends the Trace Session Activation message to the SGSN/MME respectively it shall send the trace control and configuration parameters that are applicable for both PS and EPC domains. These parameters shall be transferred in the Trace Session Activation message in the S6a/S6d interface respectively. When MME/SGSN receives the Trace Session Activation message from the HSS or from MME/SGSN the trace control and configuration parameters shall be stored and a Trace Session shall be started.\nWhen the MME sends the Forward Relocation Request messager to the S4-SGSN the MME shall sends the following trace control and configuration parameters for Trace Session activation to the SGSN:\n-\tTrace Target: IMSI or IMEI(SV)\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tTrace Depth\n-\tTriggering Events for SGSN, GGSN, RNC, MME, Serving GW, PDN GW and eNB\n-\tList of Interfaces for SGSN, GGSN, RNC, MME, Serving GW, PDN GW and eNB\n-\tTrace Collection Entity IP Address\nThe Trace Control and Configuration parameters shall be propagated during an inter-RAT handover procedure from the source node to the target node. The propagated Trace Control and Configuration parameters shall include values that are applicable for both EPS and PS domain during the inter-RAT handover procedure.\nSimilarly, in case of Gn SGSN those parameters shall be transferred through S6a/Gn interface from the HSS to the MME/Gn SGSN. The Trace Control and Configuration parameter of both domain shall be stored in the Trace Session in MME/Gn SGSN respectively.\nThe Trace Session should be activated in in an eNB when the eNB receives the TRACE START, INITIAL CONTEXT SETUP REQUEST or HANDOVER REQUEST message with the IE Trace Activation from the MME and if some activities have been started on the interfaces that have been requested to be traced.\nIf the subscriber or equipment which is traced makes a handover to a target eNB using the X2 interface, the source eNB should propagate the trace control and configuration parameters further to the target eNB by using the HANDOVER REQUEST message. When the target eNB receives the HANDOVER REQUEST message it should immediately start a Trace Session according to the trace control and configuration parameters received in the HANDOVER REQUEST message.\nIf the subscriber or equipment which is traced makes a handover to a target eNB using the S1 interface, it is the MME's responsibility to propagate the trace control and configuration parameters to the target eNB.\nInteraction with Relocation\nIf the tracing shall continue also after the relocation has been performed, the CN Invoke Trace procedure shall be re-initiated from the CN towards the future eNB after the Relocation Resource Allocation procedure has been executed successfully.\nThe TRACE START, INITIAL CONTEXT SETUP REQUEST or HANDOVER REQUEST message that is received from the MME contains the following information:\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tTrace Depth\n-\tList of Interfaces for eNB\n-\tTrace Collection Entity IP Address\nIf the Trace Reference is the same as an existing Trace Session for the same subscriber or equipment, the eNB shall not activate a new Trace Session and the existing Trace Session will not be impacted. See clause 4.2.3.6 for the conditions on whether or not the Trace Recording Session should be started.\nIf the Trace Reference is the same as an existing Trace Session for different subscriber(s) or equipment(s), the eNB shall not activate a new Trace Session, and the eNB shall not start a new Trace Recording Session.\nUE measurements activation extends the EPC trace activation procedure, as described in .10. When a Trace Session is activated, configuration parameters of MDT are added into the message.\nFor IMSI/IMEI(SV)/IMEI-TAC based UE selection, or IMSI/IMEI(SV)/IMEI-TAC combined with geographical area based UE selection, UE performance measurements activation request is propagated to UE finally.\nThis mechanism works for the following input parameters:\n-\tIMSI only or\n-\tIMSI and area information or\n-\tIMEI(SV) only or\n-\tIMEI(SV) and area information or\n-\tIMEI-TAC only or\n-\tIMEI-TAC and area information\nAfter the IMSI, IMEISV or IMEI-TAC type user attached to the network, the MME shall forward the MDT configurations to the corresponding eNB which serves the IMSI,  IMEISV or IMEI-TAC type user. If the area criterion is specified and is not satisfied, the MME shall keep the MDT configuration first and then forward it to the serving eNB only when the area criterion is satisfied.\nMDT criteria checking on eNB:\n-\tFor immediate MDT, after eNB got the MDT configuration, the eNB can detect the area information and decide whether the selected IMSI/IMEISV can fit into the criteria for initiating MDT data collection. If the area information criterion is not met, the eNB keeps the MDT configuration and propagates it during handover as specified in section 4. 4.\n-\tFor logged MDT, the eNB will forward the MDT configuration criteria to the selected IMSI/IMEISV. The area criteria checking will be done at UE side after UE received the MDT configuration criteria.\n- \tFor logged MBSFN MDT, the eNB will forward the MDT configuration criteria to the selected IMSI/IMEISV. The area criteria checking will be done at UE side after UE received the MDT configuration criteria.\nMDT criteria checking on UE:\n-\tFor immediate MDT, there is no need to do MDT criteria checking on UE.\n-\tFor logged MDT, The area criteria checking will be done at UE side after UE received the MDT configuration criteria.\nIn case of logged MDT, after UE receives from eNodeB the configuration parameters via the message RRC Connection Reconfiguration, it detects whether it stays within the specified area. If yes the UE will execute measurement job. Otherwise UE will do nothing but waiting.\nIn case of Logged MBSFN MDT, after UE receives from eNodeB the configuration parameters via the message RRC Connection Reconfiguration. The UE will log measurements as long as it receives MBMS service from an indicated target MBSFN area and is within the configured logging area.\nIn case of Immediate MDT trace (e.g., IMSI/IMEI based selection), the Immediate MDT trace session context of the UE shall be preserved in the network when the UE enters idle mode.\nThe Logged MDT or Logged MBSFN MDT trace session is preserved in the UE until the duration time of the trace session expires, including also multiple idle periods interrupted by idle-connected-idle state transitions.\nThe Logged MDT trace session context of the UE is stored in the network as long as the trace session is active, including also the periods when the UE is in connected state.\nThe Logged MBSFN MDT trace session context of the UE is stored in the network as long as the trace session is active, while UE is in idle or connected state.\nTwo scenarios shall be considered according to UE status when  activates MDT job: before UE attachment, after UE attachment, different procedures are described in .12.2, 4.1.2.12.3, 4.1.2.12.5,4.1.2.12.6.\nAs shown in figure .12.1, by adding configurations of MDT EMS activate the Trace Session for MDT job.\nThe figure depicts the MDT activation procedure in an EPC (Enterprise Physical Layer) network, illustrating the steps involved in activating the MDT (Multi-Domain Traffic) in a 5G network. The figure shows the MDT as a central element, with various sub-elements such as the MDT controller, MDT interface, and MDT interface controller. The activation process is depicted in a step-by-step manner, with each step highlighted in a different color, making it easy to understand the sequence of actions. The figure also includes a legend to clarify the different colors and symbols used in the activation process. Overall, the figure provides a clear and concise representation of the MDT activation procedure in an EPC network, making it useful for understanding the process and its components.\nFigure .12.1: MDT activation procedure in EPC\nWhen HSS activates the trace, for MDT job, to the MME the following configuration parameters shall be included in the message:\n-\tJob Type\n-\tTrace Target: IMSI or IMEISV or IMEI-TAC\n-\tArea Scope (e.g. TA, Cell)\n-\tTrace Reference\n-\tList of Measurements\n-\tReporting Trigger\n-\tReport Interval\n-\tReport Amount\n-\tEvent Threshold\n-\tLogging Interval\n-\tLogging Duration\n-\tMeasurement period LTE (if either of the measurements M4, M5 is requested)\n-\tCollection Period for RRM Measurements LTE (present only if M3 measurement is requested).\n-\tCollection Period M6 in LTE (present only if any of M6 measurements (DL or UL) is requested).\n-\tCollection Period M7 in LTE (present only if any of M7 measurements (DL or UL)is requested).\n-\tPositioning Method\n-\tMDT PLMN List\n-\tTrace Collection Entity IP Address\nNote that at the same time not all the parameters can be present. The conditions are described in clause 5.10 of the present document.\nThe specified geographical area field is available when IMSI/IMEI(SV)/IMEI-TAC combined with geographical area are needed for UE selection.\nWhen MME activate MDT activation to eNodeB, the MDT configuration parameters can be included in the message in the Initial Context Setup:\n-\tArea Scope (TA, Cell)\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tList of Measurements\n-\tReporting Trigger\n-\tReport Amount\n-\tReport Interval\n-\tEvent Threshold\n-\tLogging Interval\n-\tLogging Duration\n-\tTrace Collection Entity IP Address\n-\tCollection period for RRM Measurements LTE (present only if M3 measurement is requested).\n-\tCollection Period M6 in LTE (present only if any of M6 measurements (DL or UL) is requested).\n-\tCollection Period M7 in LTE (present only if any of M7 measurements (DL or UL)is requested).\n-\tMeasurement Period LTE (if either of the measurements M4, M5 is requested)\n-\tPositioning Method\n-\tMDT PLMN List\nNote that at the same time not all the parameters can be present. The conditions are described in clause 5.10 of the present document.\nThe MME receives and stores MDT user consent indication from HSS as part of subscriber information when user context is established in MME at UE attachment. The MME shall consider the MDT user consent information when activating an MDT trace session for the UE. Details on the user consent handling are described in section 4.6.\nIf positioning method indicates GNSS positioning, eNB should activate the GNSS module of the UE via RRC as specified in TS 36.331 [32]. If positioning method indicates E-Cell ID positioning, the eNB should collect the UE reported UE Rx-Tx time difference measurements as specified in TS 36.331[32] measurement procedures, as well as, any available eNB measured eNB Rx-Tx time difference, Angle of Arrival measurements as specified in TS 36.214 [38] and capture it in MDT trace record.\nIf Reporting Trigger parameter indicates that all configured RRM measurement trigger should be reported in MDT, then eNodeB should ask the UE to provide the \"best effort\" location information together with the measurement reporting by setting the includeLocationInfo IE in all RRC measurement reporting configurations.\n\nThe figure depicts a multi-tiered mesh-based Dynamic Time-Sensitive (MDT) activation in an Evolved Packet Core (EPC) after an UE attachment. The activation is depicted in a layered structure, with each tier representing a different level of network management and control. The activation is activated by the UE, which is connected to the EPC through the MDT. The activation is activated by the UE, which is connected to the EPC through the MDT. The activation is activated by the UE, which is connected to the EPC through the MDT. The activation is activated by the UE, which is connected to the EPC through the MDT. The activation is activated by the UE, which is connected to the EPC through the MDT. The activation is activated by the UE, which is connected to the EPC through the MDT. The activation is activated by the UE, which is connected to the EPC through the MDT. The activation is activated by the UE, which is connected to the EPC through the MDT. The activation is activated by the UE, which is connected to the EPC through the MDT. The activation is activated by the UE, which is connected to the EPC through the M\nFigure .12.2: MDT activation in EPC after UE attachment\nThe messages propagated to HSS, MME and eNodeB are the same as described in clause .12.2.\nWhen MME can send Trace Start to eNodeB, the following configuration parameters shall be included in the message:\n-\tArea Scope (TA, Cell)\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tList of Measurements\n-\tReporting Trigger\n-\tReport Amount\n-\tReport Interval\n-\tEvent Threshold\n-\tLogging Interval\n-\tLogging Duration\n-\tTrace Collection Entity IP Address\n-\tMeasurement period LTE (if either of the measurements M4, M5 is requested)\n-\tPositioning Method\n-\tCollection Period for RRM Measurements LTE (present only if M3 measurement is requested)\n-\tCollection Period M6 in LTE (present only if any of M6 measurements (DL or UL) is requested).\n-\tCollection Period M7 in LTE (present only if any of M7 measurements (DL or UL)is requested).\n-\tMDT PLMN List.\nNote that at the same time not all the parameters can be present. The conditions are described in clause 5.10 of the present document.\nThe MME shall consider the MDT user consent information when activating an MDT trace session for the UE. Detailed procedures about user consent is described in Section 4. 6.1.\nIn case of logged MDT and the UE is currently being in idle mode, the MME is not required to initiate paging of the UE in order to send the configuration.\nThen eNodeB initiates RRC Connection Reconfiguration Request in case of immediate MDT or the IdleMDTConfiguration RRC message in case of logged MDT toward the UE and sends the MDT measurement configuration parameters as received from the MME.\nImmediate/Logged signalling based MDT criteria may consist of a cell list. MME shall validate whether the serving cell is controlled by the same eNodeB as any other cell in the cell list. If yes, the MDT activation shall be sent to the serving eNodeB.\nIf positioning method indicates GNSS positioning, eNB should activate the GNSS module of the UE via RRC as specified in TS 36.331 [32]. If positioning method indicates E-Cell ID positioning, the eNB should collect the UE reported UE Rx-Tx time difference measurements as specified in TS 36.331[32] measurement procedures, as well as, any available eNB measured eNB Rx-Tx time difference, Angle of Arrival measurements as specified in TS 36.214 [38] and capture it in MDT trace record.\nHandling of various scenarios for Signalling based Logged/Immediate MDT are addressed below:\n1)\tEM initiating MDT activation shall validate that PLMNs specified in the MDT PLMN Listare  supported by all the cells specified in the area scope If the eNodeB receives a request where none of the PLMNs in the MDT PLMN List match any PLMN in its list, it shall ignore the request\n2)\tVoid.\n3)\tMME shall be informed with a TRACE FAILURE INDICATION message if the eNodeB could not configure the UE because it was in the middle of a handover (refer to TS 36.413[36]). MME shall try to reactivate MDT in the target cell if the target cell scope meets the MDT criteria.\n4)\tVoid.\n5)\tWhen the UE re-enters PLMN (specified in the MDT PLMN List) then the MME shall be responsible for restarting the Immediate MDT activation (if it is as a result of an X2 handover then one option is MME could use the path switch request as trigger). However this is best effort. There can be cases where MME may not be able to restart the MDT when the UE re-enters the PLMN (specified in the MDT PLMN List): for example: If the UE performs intra eNB handover where path switch is not necessarily sent, the MME may not be able to restart MDT\nFigure .12.5 shows activation of  the Trace Session for MDT job from EPC before the UE attaches to the network.\nThe figure depicts the MDT activation procedure in an EPC (Enterprise Physical Layer) network, illustrating the steps involved in activating the MDT (Multi-Domain Traffic) in a 5G network. The figure shows the MDT as a central element, with various sub-elements such as the MDT controller, MDT interface, and MDT interface controller. The activation procedure involves the MDT controller activating the MDT interface, which then activates the MDT interface controller, and finally, the MDT interface activating the MDT. The figure also includes a visual representation of the MDT interface, showing the various interfaces and interfaces controllers.\nFigure .12.5: MDT activation procedure in EPC\nWhen HSS activates the trace, for MDT job, to the MME the following configuration parameters shall be included in the message:\n-\tJob Type\n-\tTrace Target: IMSI or IMEISV or IMEI-TAC\n-\tArea Scope (e.g. TA, Cell)\n-\tTrace Reference\n-\tLogging Interval\n-\tLogging Duration\n-\tMDT PLMN List\n-\tMBSFN Area List\nNOTE: The conditions are described in clause 5.10 of the present document.\n-\tTrace Collection Entity IP Address\nThe Specified geographical area field is available when IMSI/IMEI(SV)/IMEI-TAC combined with geographical area are needed for UE selection.\nWhen MME activate MDT activation to eNodeB, the MDT configuration parameters can be included in the message in the Initial Context Setup:\n-\tArea Scope (TA, Cell)\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tLogging Interval\n-\tLogging Duration\n-\tTrace Collection Entity IP Address\n-\tMDT PLMN List\n-\tMBSFN Area List\nNote that at the same time not all the parameters can be present. The conditions are described in clause 5.10 of the present document.\nThe MME receives and stores MDT user consent indication from HSS as part of subscriber information when user context is established in MME at UE attachment. The MME shall consider the MDT user consent information when activating an MDT trace session for the UE. Details on the user consent handling are described in section 4.6.\n\nThe figure depicts a log of MBSFN (Multi-Band Signal Fusion Network) activation in an EPC (Evolved Packet Core) after an UE (User Equipment) attachment. The activation is logged in the MDT (Multi-Domain Traffic) log, indicating the successful completion of the UE attachment process.\nFigure .12.6: Logged MBSFN MDT activation in EPC after UE attachment\nThe messages propagated to HSS, MME and eNodeB are the same as described in clause .12.2.\nWhen MME can send Trace Start to eNodeB, the following configuration parameters shall be included in the message:\n-\tArea Scope (TA, Cell)\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tLogging Interval\n-\tLogging Duration\n-\tTrace Collection Entity IP Address\n-\tMDT PLMN List\n-\tMBSFN Area List (applicable only if the Job Type is Logged MBSFN MDT)\nNOTE: The conditions are described in clause 5.10 of the present document.\nThe MME shall consider the MDT user consent information when activating an MDT trace session for the UE. Detailed procedures about user consent is described in Section 4. 6.1.\nIn case of Logged MBSFN MDT if the UE is currently being in idle mode, the MME is not required to initiate paging of the UE in order to send the configuration.\nIf target MBSFN area(s) is configured, UE applies it in addition to other restrictions such as the logging area. The UE will log measurements as long as it receives MBMS service from an indicated target MBSFN area and is within the configured logging area [30].\nThe configured logging area can span PLMNs in the MDT PLMN List. If no area is configured, the UE will log measurements throughout the PLMNs of the MDT PLM.\nMDT activation in PS domain extends the trace activation procedure, as described in .5. When a Trace Session is activated, configuration parameters of MDT are added into the Trace Session Activation message(s).\nFor IMSI/IMEI(SV) based UE selection, or IMSI/IMEI(SV) combined with geographical area based UE selection, UE performance measurements activation request is propagated to UE finally.\nDetailed behaviour of the UE when it receives the configuration parameters is described in 3GPP TS 37.320 [30].\nIn case of Immediate MDT trace (e.g., IMSI/IMEI based selection), the Immediate MDT trace session context of the UE shall be preserved in the network when the UE enters idle mode.\nThe Logged MDT trace session is preserved in the UE until the duration time of the trace session expires, including also multiple idle periods interrupted by idle-connected-idle state transitions.\nThe Logged MDT trace session context of the UE is stored in the network as long as the trace session is active, including also the periods when the UE is in connected state.\nTwo scenarios shall be considered according to UE status when the network activates MDT job: before UE attachment, after UE attachment, different procedures are described in 4.1.2.13.2 and 4.1.2.13.2a.\nThe MDT activation procedure is shown in figure 4.1.2.13.2.1.\nThe figure depicts the MDT activation procedure in the PS domain during the attach procedure, illustrating the steps involved in activating the MDT (Multi-Domain Traffic) in the network. The figure shows the MDT activation process, which involves the activation of the MDT in the PS domain, and the steps taken to ensure the activation is successful. The figure also includes the steps for the attach procedure, which involves the activation of the MDT in the PS domain and the steps taken to ensure the activation is successful.\nFigure 4.1.2.13.2.1: MDT activation procedure in PS domain during attach procedure\nThe Trace Session activation is started from the , when it activates the Trace Session to the HSS. The HSS stores the trace control and configuration parameters in its database.\nWhen a UE registers with the network by sending an ATTACH_REQUEST message to the SGSN, it updates the location information in the HSS by sending the UPDATE_GPRS_LOCATION message to the HSS. The HSS checks if the UE is being traced. If it is being traced, the HSS shall propagate the trace control and configuration parameters to the SGSN by sending a MAP-ACTIVATE_TRACE_MODE - see 3GPP TS 29.002 [11] message to the SGSN (This message can be embedded also in the MAP INSERT SUBSCRIBER DATA message). The SGSN receives and stores MDT user consent indication from HSS as part of subscriber information when user context is established in SGSN at UE attachment (details are available in clause 4. 6.1). When an inter-SGSN routing area update occurs, HSS shall send the MAP-ACTIVATE_TRACE_MODE message to the new SGSN. The Trace Session Activation from HSS to SGSN shall contain the following MDT specific parameters in addition to the existing trace parameters:\n-\tJob Type.\n-\tArea Scope.\n-\tList of Measurements.\n-\tReporting Trigger.\n-\tReport Interval.\n-\tReport Amount.\n-\tEvent Threshold.\n-\tLogging Interval..\n-\tLogging Duration.\n-\tTrace Collection Entity IP Address.\n-\tMeasurement Quantity.\n-\tMeasurement Period UMTS (if either of the measurements M6, M7 is requested).\n-\tCollection Period for RRM Measurements UMTS (present only if any of M4 or M5 measurements are requested).\n- \tEvent Threshold for UE Power Headroom Measurement UMTS (present only if event triggered reporting for M4 measurement is requested).\n-\tPositioning Method.\n-\tMDT PLMN List.\nNote that at the same time not all of the parameters can be present. The condition which parameters shall be present is described in clause 5 of the present document.\nWhen SGSN receives the MAP-ACTIVATE_TRACE_MODE message it shall store the trace control and configuration parameters and shall start a Trace Session and shall send the CN_INVOKE_TRACE message to the RNC. The SGSN shall consider the MDT user consent information when activating an MDT trace session for the UE. The SGSN shall send the following parameters to the RNC beside the existing trace parameters:\n-\tJob Type.\n-\tArea Scope.\n-\tList of Measurements.\n-\tReporting Trigger.\n-\tReport Interval.\n-\tReport Amount.\n-\tEvent Threshold.\n-\tLogging Interval.\n-\tLogging Duration.\n-\tTrace Collection Entity IP Address.\n-\tMeasurement Quantity.\n-\tMeasurement Period UMTS (if either of the measurements M6, M7 is requested).\n-\tCollection Period for RRM Measurements UMTS (present only if any of M4 or M5 measurements are requested).\n- \tEvent Threshold for UE Power Headroom Measurement UMTS (present only if event triggered reporting for M4 measurement is requested).\n-\tPositioning Method.\n-\tMDT PLMN List.\nNote that at the same time not all of the parameters can be present. The conditions which parameters shall be present is described in clause 5 of the present document.\nThe MDT activation procedure after UE attaches to the network is shown in figure ..1.\n\nFigure ..1 MDT activation procedure in PS domain after UE attachs to the network\nWhen a UE registers with the network by sending an ATTACH_REQUEST message to the SGSN, it updates the location information in the HSS by sending the UPDATE_GPRS_LOCATION message to the HSS.\nThe Trace Session activation is started from the , when it activates the Trace Session to the HSS. When the HSS send trace activation to the SGSN, the HSS shall propagate the trace control and configuration parameters to the SGSN by sending a MAP-ACTIVATE_TRACE_MODE - see 3GPP TS 29.002 [11] message to the SGSN (This message can be embedded also in the MAP INSERT SUBSCRIBER DATA message). The SGSN receives and stores MDT user consent indication from HSS as a part of subscriber information (details are available in Section 4. 6.1). When an inter-SGSN routing area update occurs, HSS shall send the MAP-ACTIVATE_TRACE_MODE message to the new SGSN. The Trace Session Activation from HSS to SGSN shall contain the following MDT specific parameters in addition to the existing trace parameters:\n-\tJob Type.\n-\tArea Scope.\n-\tList of Measurements.\n-\tReporting Trigger.\n-\tReport Interval.\n-\tReport Amount.\n-\tEvent Threshold.\n-\tLogging Interval.\n-\tLogging Duration.\n-\tTrace Collection Entity IP Address.\n-\tMeasurement Quantity.\n-\tMeasurement Period UMTS (if either of the measurements M6, M7 is requested).\n-\tCollection Period for RRM Measurements UMTS (present only if any of M4 or M5 measurements are requested).\n- \tEvent Threshold for UE Power Headroom Measurement UMTS (present only if event triggered reporting for M4 measurement is requested).\n-\tPositioning Method.\n-\tMDT PLMN List.\nNote that at the same time not all of the parameters can be present. The condition which parameters shall be present is described in clause 5 of the present document.\nWhen SGSN receives the MAP-ACTIVATE_TRACE_MODE message it shall store the trace control and configuration parameters and shall start a Trace Session and shall send the CN_INVOKE_TRACE message to the RNC. The SGSN shall consider the MDT user consent information when activating an MDT trace session for the UE. The SGSN shall send the following parameters to the RNC beside the existing trace parameters:\n-\t Job Type.\n-\tArea Scope.\n-\tList of Measurements.\n-\tReporting Trigger.\n-\tReport Interval.\n-\tReport Amount.\n-\tEvent Threshold.\n-\tLogging Interval.\n-\tLogging Duration.\n-\tTrace Collection Entity IP Address.\n-\tMeasurement Quantity.\n-\tMeasurement Period UMTS (if either of the measurements M6, M7 is requested).\n-\tCollection Period for RRM Measurements UMTS (present only if any of M4 or M5 measurements are requested).\n- \tEvent Threshold for UE Power Headroom Measurement UMTS (present only if event triggered reporting for M4 measurement is requested).\n-\tPositioning Method.\n-\tMDT PLMN List.\nNote that at the same time not all of the parameters can be present. The conditions which parameters shall be present is described in clause 5 of the present document.\nHandling of various scenarios for Signalling based Logged/Immediate MDT is addressed below:\n1)\tEM initiating MDT activation shall validate that the MCC and MNC specified in the Trace Reference is the same as the PLMN supported by all the RNCs specified in the area scope. If the RNC receives a request with a PLMN in the TraceReference that does not match any PLMN in its list, it shall ignore the request.\n2)\tSGSN shall trigger the MDT activation only when the MDT area criterion is satisfied. But if the RNC receives a request that is outside the area scope then the RNC shall store the MDT configuration and forward the request when a handover occurs (intra PLMN).\n3)\tWhen the UE re-enters the PLMN (in Trace Reference) which matches the area scope defined in the MDT configuration then the SGSN shall be responsible for restarting the Immediate MDT activation. However, this is best effort.\n4)\tVoid.\n5)\tSGSN shall re-initiate CN Invoke Trace procedure to reactivate MDT job after successful SRNS relocation if the RNC could not configure the UE since it was in the middle of inter-RNC handover (refer to TS 25.413 [13]). SGSN shall try to reactivate MDT in the target cell if the target cell scope meets the MDT criteria.\n6)\tVoid.\n7)\tManagement based MDT criteria may consist of a cell list. SGSN shall validate whether the UE is controlled by the same RNC as any other cell in the cell list. If yes, the MDT activation shall be sent to the serving RNC. If the RNC receives a Signalling Based MDT activation request when the UE is served by a cell that is in the RNC but not in the MDT area scope then the RNC shall store the MDT configuration and configure the UE when the UE moves to a cell in the RNC (intra RNC handover) that satisfies the area scope in the request.\nIn UMTS it is also possible to send the MDT job activation via the CS domain instead of the PS domain. The activation mechanism is shown in figure 4.1.2.14.1.\nThe figure depicts the MDT activation procedure in the CS domain during the attach procedure, illustrating the steps involved in activating the MDT (Multi-Domain Traffic) in the network. The figure shows the MDT activation process, which involves the activation of the MDT in the CS domain, and the steps taken to ensure the activation is successful. The figure also includes the activation of the MDT in the CS domain, which is a crucial step in ensuring the successful activation of the MDT in the network.\nFigure 4.1.2.14.1: MDT activation procedure in CS domain during attach procedure\nThe Trace Session activation is started from the , when it activates the Trace Session to the HSS. The HSS stores the trace control and configuration parameters in its database.\nWhen a UE registers with the network by sending an ATTACH_REQUEST message to the MSC Server, it updates the location information in the HSS by sending the UPDATE_LOCATION message to the HSS. The HSS checks if the UE is being traced. If it is being traced, the HSS shall propagate the trace control and configuration parameters to the MSC Server by sending a MAP-ACTIVATE_TRACE_MODE - see 3GPP TS 29.002 [11] message to the MSC Server (This message can be embedded also in the MAP INSERT SUBSCRIBER DATA message). The MSC Server receives and stores MDT user consent indication from HSS as part of subscriber information at UE attachment (details are available in Section 4.2.8.1). When an inter-VLR Location Area update occurs, HSS shall send the MAP-ACTIVATE_TRACE_MODE message to the new VLR / MSC Server. The Trace Session Activation from HSS to MSC Server shall contain the following MDT specific parameters in addition to the existing trace parameters:\n-\tJob Type\n-\tArea Scope\n-\tList of Measurements\n-\tReporting Trigger\n-\tReport Interval\n-\tReport Amount\n-\tEvent Threshold\n-\tLogging Interval\n-\tLogging Duration\n-\tTrace Collection Entity IP Address\n-\tMeasurement Quantity\n-\tMeasurement Period UMTS (if either of the measurements M6, M7 is requested)\n-\tCollection Period for RRM Measurements UMTS (present only if any of M4 or M5 measurements are requested).\n- \tEvent Threshold for UE Power Headroom Measurement UMTS (present only if event triggered reporting for M4 measurement is requested)\n-\tPositioning Method\n-\tMDT PLMN List\nNote that at the same time not all of the parameters can be present. The condition under which parameters shall be present is described in clause 5 of the present document.\nWhen MSC Server receives the MAP-ACTIVATE_TRACE_MODE message it shall store the trace control and configuration parameters and shall start a Trace Session and shall send the CN_INVOKE_TRACE message to the RNC. The MSC Server shall consider the MDT user consent information when activating an MDT trace session for the UE. The MSC Server shall send the following parameters to the RNC beside the existing trace parameters:\n-\t Job Type.\n-\tArea Scope.\n-\tList of Measurements.\n-\tReporting Trigger.\n-\tReport Interval.\n-\tReport Amount.\n-\tEvent Threshold.\n-\tLogging Interval.\n-\tLogging Duration.\n-\tTrace Collection Entity IP Address.\n-\tMeasurement Quantity.\n-\tMeasurement Period UMTS (if either of the measurements M6, M7 is requested).\n-\tCollection Period for RRM Measurements UMTS (present only if any of M4 or M5 measurements are requested).\n- \tEvent Threshold for UE Power Headroom Measurement UMTS (present only if event triggered reporting for M4 measurement is requested).\n-\tPositioning Method.\n-\tMDT PLMN List.\nNote that at the same time not all of the parameters can be present. The condition under which parameters shall be present is described in clause 5 of the present document.\nIn case of Immediate MDT trace (e.g., IMSI/IMEI based selection), the Immediate MDT trace session context of the UE shall be preserved in the network when the UE enters idle mode.\nThe Logged MDT trace session is preserved in the UE until the duration time of the trace session expires, including also multiple idle periods interrupted by idle-connected-idle state transitions.\nThe Logged MDT trace session context of the UE is stored in the network as long as the trace session is active, including also the periods when the UE is in connected state.\nHandling of various scenarios for Signalling based Logged/Immediate MDT is addressed below:\n1)\tEM initiating MDT activation shall validate that the MCC and MNC specified in the Trace Reference is the same as the PLMN supported by all the cells specified in the area scope. If the RNC receives a request with a PLMN in the TraceReference that does not match any PLMN in its list , it shall ignore the request\n2)\tMSC-S shall trigger the activation only when the MDT area criterion is satisfied. But if for some reason the RNC receives a request that is outside the area scope then the RNC shall store the MDT configuration and forward the request when a handover occurs (intra PLMN).\n3)\tWhen the UE re-enters the PLMN (in Trace Reference) which matches the area scope defined in the MDT configuration then the MSC shall be responsible for restarting the Immediate MDT activation. However this is best effort.\n4)\tVoid.\n5)\tMSC-S shall re-initiate CN Invoke Trace procedure to reactivate MDT job after SRNS relocation (refer to TS 25.413 [13]) if the RNC could not configure the UE since it was in the middle of inter RNC handover. MSC-S shall try to reactivate MDT in the target cell if the target cell scope meets the MDT criteria.\n6)\tVoid.\n7)\tManagement based MDT criteria may consist of a cell list. MSC-S shall validate whether the UE is controlled by the same RNC as any other cell in the cell list. If yes, the MDT activation shall be sent to the serving RNC. If the RNC receives a Signalling Based MDT activation request when the UE is served by a cell that is in the RNC but not in the MDT area scope then the RNC shall store the MDT configuration and configure the UE when the UE moves to a cell in the RNC (intra RNC handover) that satisfies the area scope in the request\nFigure 4.1.2.15.1.1 illustrates the signaling Trace Session activation procedure in 5GC as part of the Registration procedure:\nThe figure depicts the trace activation in 5G following the Registration procedure, showing the various steps involved in the process.\nFigure 4.1.2.15.1.1: Trace activation in 5GC following the Registration procedure\nThe steps 3-6, 12 and 15 below are parts of the General Registration procedure - see 3GPP TS 23.502 [41] clause 4.2.2.2 for specific details. Present document does not attempt to re-define how General Registration procedure works, but rather illustrates the signaling Trace Activation aspects.\n1.\tManagement system activates Trace Session to the UDM. The following trace control and configuration parameters shall be included in the Trace Activation message:\n-\tTrace Target: SUPI or IMEISV.\n-\tTrace Reference.\n-\tTriggering Events for AMF, SMF, UPF and PCF.\n-\tTrace Depth.\n-\tList of NE Types to trace.\n-\tList of Interfaces for AMF, SMF, UPF, PCF and NG-RAN.\n-\tTrace Collection Entity IP Address for the file-based trace reporting or Trace Reporting Consumer URI for the streaming trace reporting.\n2.\tUDM stores the trace control and configuration parameters received from the management system.\n3.\tUE sends Registration request to NG-RAN node.\n4.\tNG-RAN node selects appropriate AMF.\n5.\tNG-RAN node forwards the UE Registration request to the selected AMF.\n6.\tAMF receives the trace control and configuration parameters information from UDM via Nudm_SDM_Get operation (see step 14 in clause 4.2.2.2.2 and clause 5.2.3.3 of 3GPP TS 23.502 [41]).\n7.\tAMF stores the trace control and configuration parameters received from the UDM.\n8.\tAMF starts the Trace Session according to the received configuration.\n9.\tAMF sends the Start Trace message over NG interface (N2 interface from the 5GC perspective)\n10.\tNG-RAN node stores the trace control and configuration parameters received from the AMF. This step is part of NG-RAN signaling trace activation - see clause 4.1.2.16 for more details.\n11.\tNG-RAN node starts the Trace Session according to the received configuration. This step is part of NG-RAN signaling trace activation - see clause 4.1.2.16 for more details.\n12.\tAMF establishes Policy Association with PCF (see step 16 in clause 4.2.2.2.2 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the PCF.\n13.\tPCF stores the trace control and configuration parameters received from the AMF as part of Policy Association.\n14.\tPCF starts the Trace Session according to the received configuration.\n15.\tAMF provides the trace control and configuration parameters information to the SMF as part of the SM Context (see step 18 in clause 4.2.2.2.2 of 3GPP TS 23.502 [41]).\n16.\tSMF stores the trace control and configuration parameters received from the AMF.\n17.\tSMF starts the Trace Session according to the received configuration.\n\nFigure 4.1.2.15.1.2 illustrates the signaling Trace Session activation procedure in 5GC as part of the PDU Session Establishment procedure for the UE that has already been registered:\nThe figure depicts the trace activation in 5G following the PDU Session Establishment procedure, showing the various steps involved in establishing a session, including the initiation of the PDU, the establishment of the session, and the subsequent activation of the trace.\nFigure 4.1.2.15.1.2: Trace activation in 5GC following the PDU Session Establishment procedure\nThe steps 6, 10, 11, 14 and 15 below are parts of the UE Requested PDU Session Establishment procedure - see 3GPP TS 23.502 [41] clause 4.3.2.2 for specific details. Present document does not attempt to re-define how UE Requested PDU Session Establishment procedure works, but rather illustrates the signaling Trace Activation aspects.\n1.\tManagement system activates Trace Session to the UDM. The following trace control and configuration parameters shall be included in the Trace Activation message:\n-\tTrace Target: SUPI or IMEISV.\n-\tTrace Reference.\n-\tTriggering Events for AMF, SMF, UPF and PCF.\n-\tTrace Depth.\n-\tList of NE Types to trace.\n-\tList of Interfaces for AMF, SMF, PCF, UPF and NG-RAN.\n-\tTrace Collection Entity IP Address for the file-based trace reporting or Trace Reporting Consumer URI for the streaming trace reporting.\n2.\tUDM stores the trace control and configuration parameters received from the management system.\n3.\tUDM sends Nudm_SDM_Notification to AMF with the trace control and configuration parameters information (see clauses 4.5.1 and 5.2.3.3 of 3GPP TS 23.502 [41]).\n4.\tAMF stores the trace control and configuration parameters received from the UDM.\n5.\tAMF starts the Trace Session according to the received configuration.\n6.\tUE sends PDU Session Establishment request to AMF\n7.\tAMF sends the Start Trace message over NG interface (N2 interface from the 5GC perspective)\n8.\tNG-RAN node stores the trace control and configuration parameters received from the AMF. This step is part of NG-RAN signaling trace activation - see clause 4.1.2.16 for more details.\n9.\tNG-RAN node starts the Trace Session according to the received configuration. This step is part of NG-RAN signaling trace activation - see clause 4.1.2.16 for more details.\n10.\tAMF selects an appropriate SMF\n11.\tAMF sends the Nsmf_PDUSession_CreateSMContext request to the selected SMF with the trace control and configuration parameters.\n12.\tSMF stores the trace control and configuration parameters received from the AMF.\n13.\tSMF starts the Trace Session according to the received configuration.\n14.\tSMF selects an approprite PCF\n15.\tSMF establishes Session Management Policy Association with PCF (see step 7 in clause 4.3.2.2.1 of 3GPP TS 23.502 [x5]) and provides the trace control and configuration parameters information to the PCF.\n16.\tPCF stores the trace control and configuration parameters received from the SMF as part of Policy Association.\n17.\tPCF starts the Trace Session according to the received configuration.\n18.\tSMF selects an approprite UPF\n19.\tSMF performs N4 Session Establishment with UPF (see step 10 in clause 4.3.2.2.1 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the UPF.\n20.\tUPF stores the trace control and configuration parameters received from the SMF as part of N4 Session Establishment.\n21.\tUPF starts the Trace Session according to the received configuration.\n\nFigure 4.1.2.15.1.3 illustrates the signaling Trace Session activation procedure in 5GC as part of the PDU Session Establishment procedure for the UE that has already been registered where SMF obtains trace control and configuration parameters from UDM via Nudm_UECM_Registration procedure:\nThe figure depicts the trace activation in 5G following the PDU Session Establishment procedure, showing the various steps involved in establishing a session, including the initiation of the PDU, the establishment of the session, and the subsequent activation of the trace.\nFigure 4.1.2.15.1.3: Trace activation in 5GC following the PDU Session Establishment procedure\nThe steps 6, 10, 11, 14 and 15 below are parts of the UE Requested PDU Session Establishment procedure - see 3GPP TS 23.502 [41] clause 4.3.2.2 for specific details. Present document does not attempt to re-define how UE Requested PDU Session Establishment procedure works, but rather illustrates the signaling Trace Activation aspects.\n1.\tManagement system activates Trace Session to the UDM. The following trace control and configuration parameters shall be included in the Trace Activation message:\n-\tTrace Target: SUPI or IMEISV\n-\tTrace Reference\n-\tTriggering Events for AMF, SMF, UPF and PCF\n-\tTrace Depth\n-\tList of NE Types to trace\n-\tList of Interfaces for AMF, SMF, UPF, PCF and NG-RAN\n-\tTrace Collection Entity IP Address for the file-based trace reporting or Trace Reporting Consumer URI the streaming trace reporting\n2.\tUDM stores the trace control and configuration parameters received from the management system.\n3.\tUDM sends Nudm_SDM_Notification to AMF with the trace control and configuration parameters information (see clauses 4.5.1 and 5.2.3.3 of 3GPP TS 23.502 [41]).\n4.\tAMF stores the trace control and configuration parameters received from the UDM.\n5.\tAMF starts the Trace Session according to the received configuration.\n6.\tUE sends PDU Session Establishment request to AMF\n7.\tAMF sends the Start Trace message over NG interface (N2 interface from the 5GC perspective)\n8.\tNG-RAN node stores the trace control and configuration parameters received from the AMF. This step is part of NG-RAN signaling trace activation - see clause 4.1.2.16 for more details.\n9.\tNG-RAN node starts the Trace Session according to the received configuration. This step is part of NG-RAN signaling trace activation - see clause 4.1.2.16 for more details.\n10.\tAMF selects an appropriate SMF\n11.\tAMF sends the Nsmf_PDUSession_CreateSMContext request to the selected SMF\n12.\tSMF performs NuDM_UECM_Registration procedure with UDM and receives the trace control and configuration parameters from UDM\n13.\tSMF stores the trace control and configuration parameters received from the UDM.\n14.\tSMF starts the Trace Session according to the received configuration.\n15.\tSMF selects an approprite PCF\n16.\tSMF establishes Session Management Policy Association with PCF (see step 7 in clause 4.3.2.2.1 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the PCF.\n17.\tPCF stores the trace control and configuration parameters received from the SMF as part of Policy Association.\n18.\tPCF starts the Trace Session according to the received configuration.\n19.\tSMF selects an approprite UPF\n20.\tSMF performs N4 Session Establishment with UPF (see step 10 in clause 4.3.2.2.1 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the UPF.\n21.\tUPF stores the trace control and configuration parameters received from the SMF as part of N4 Session Establishment.\n22.\tUPF starts the Trace Session according to the received configuration.\nNote: The specific scenarios where SMF receives trace control and configuration parameters either from UDM or from AMF are specified in 3GPP TS 23.502 [41].\n\nFigure 4.1.2.15.1.4 illustrates the signaling Trace Session activation procedure in 5GC as part of the PDU Session Modification procedure for the UE that has already been registered and has an on-going PDU Session:\nThe figure depicts a trace activation in a 5G network, showing the PDU Session Modification procedure. The trace activation is a crucial step in the network's operation, where the PDU (Physical Data Unit) is modified to reflect the new session information. This process ensures that the network can continue to function properly, even if a device is disconnected or the network is experiencing a temporary outage. The figure provides a visual representation of the process, highlighting the importance of trace activation in maintaining network reliability and efficiency.\nFigure 4.1.2.15.1.4: Trace activation in 5GC following the PDU Session Modification procedure\nThe steps 6 and 9 below are parts of the PDU Session Modification procedure - see 3GPP TS 23.502 [41] clause 4.3.3.2 for specific details. Present document does not attempt to re-define how PDU Session Modification procedure works, but rather illustrates the signaling Trace Activation aspects.\n1.\tManagement system activates Trace Session to the UDM. The following trace control and configuration parameters shall be included in the Trace Activation message:\n-\tTrace Target:SUPI or IMEISV.\n-\tTrace Reference.\n-\tTriggering Events for AMF, SMF, UPF and PCF.\n-\tTrace Depth.\n-\tList of NE Types to trace.\n-\tList of Interfaces for AMF, SMF, UPF, PCF and NG-RAN.\n-\tTrace Collection Entity IP Address for the file-based trace reporting or Trace Reporting Consumer URI for the streaming trace reporting.\n2.\tUDM stores the trace control and configuration parameters received from the management system.\n3.\tUDM sends Nudm_SDM_Notification to AMF with the trace control and configuration parameters information (see clauses 4.5.1 and 5.2.3.3 of 3GPP TS 23.502 [41]).\n4.\tAMF stores the trace control and configuration parameters received in step 9.\n5.\tAMF starts the Trace Session according to the received configuration.\n6.\tAMF sends Nsmf_PDUSession_UpdateSMContext request with the trace control and configuration parameters information to the SMF\n7.\tSMF stores the trace control and configuration parameters received from the UDM.\n8.\tSMF starts the Trace Session according to the received configuration.\n9.\tSMF performs Session Management Policy Modification with PCF (see step 7 in clause 4.3.3.2 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the PCF.\n10.\tPCF stores the trace control and configuration parameters received from the SMF as part of Policy Association.\n11.\tPCF starts the Trace Session according to the received configuration.\n12.\tSMF performs N4 Session Modification with UPF (see step 10 in clause 4.3.2.2.1 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the UPF.\n13.\tUPF stores the trace control and configuration parameters received from the SMF as part of N4 Session Modification.\n14.\tUPF starts the Trace Session according to the received configuration.\n15.\tAMF sends the Start Trace message over NG interface (N2 interface from the 5GC perspective)\n16.\tNG-RAN node stores the trace control and configuration parameters received from the AMF. This step is part of NG-RAN signaling trace activation - see clause 4.1.2.16 for more details.\n17.\tNG-RAN node starts the Trace Session according to the received configuration. This step is part of NG-RAN signaling trace activation - see clause 4.1.2.16 for more details.\n\nFigure 4.1.2.15.1.5 illustrates the signaling Trace Session activation procedure in 5GC as part of the PDU Session Modification procedure for the UE that has already been registered and has an on-going PDU Session where UDM notifies SMF about trace activation directly:\nThe figure depicts a trace activation in a 5G network, showing the PDU Session Modification procedure (with UDM to SMF notification). The trace activation is a crucial step in the network's operation, where the PDU (Physical Data Unit) is modified to indicate the change in the session. This process ensures that the network can continue to function properly, even if a session is modified. The figure provides a visual representation of this process, with the PDU, UDM (User Data Modulation), and SMF (Session Management Function) clearly labeled.\nFigure 4.1.2.15.1.5: Trace activation in 5GC following the PDU Session Modification procedure (with UDM to SMF notification)\nThe steps 6 and 9 below are parts of the PDU Session Modification procedure - see 3GPP TS 23.502 [41] clause 4.3.3.2 for specific details. Present document does not attempt to re-define how PDU Session Modification procedure works, but rather illustrates the signaling Trace Activation aspects.\n1.\tManagement system activates Trace Session to the UDM. The following trace control and configuration parameters shall be included in the Trace Activation message:\n-\tTrace Target: SUPI or IMEISV.\n-\tTrace Reference.\n-\tTriggering Events for AMF, SMF, UPF and PCF.\n-\tTrace Depth.\n-\tList of NE Types to trace.\n-\tList of Interfaces for AMF, SMF, UPF, PCF and NG-RAN.\n-\tTrace Collection Entity IP Address for the file-based trace reporting or Trace Reporting Consumer URI for the streaming trace reporting.\n2.\tUDM stores the trace control and configuration parameters received from the management system.\n3.\tUDM sends Nudm_SDM_Notification to AMF with the trace control and configuration parameters information (see clauses 4.5.1 and 5.2.3.3 of 3GPP TS 23.502 [41]).\n4.\tAMF stores the trace control and configuration parameters received in step 9.\n5.\tAMF starts the Trace Session according to the received configuration.\n6.\tUDM sends Nudm_SDM_Notification to SMF with the trace control and configuration parameters information (see clauses 4.5.2 and 5.2.3.3 of 3GPP TS 23.502 [41]).\n7.\tSMF stores the trace control and configuration parameters received from the UDM.\n8.\tSMF starts the Trace Session according to the received configuration.\n9.\tSMF performs Session Management Policy Modification with PCF (see step 7 in clause 4.3.3.2 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the PCF.\n10.\tPCF stores the trace control and configuration parameters received from the SMF as part of Policy Association.\n11.\tPCF starts the Trace Session according to the received configuration.\n12.\tSMF performs N4 Session Modification with UPF (see step 10 in clause 4.3.2.2.1 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the UPF.\n13.\tUPF stores the trace control and configuration parameters received from the SMF as part of N4 Session Modification.\n14.\tUPF starts the Trace Session according to the received configuration.\n15.\tAMF sends the Start Trace message over NG interface (N2 interface from the 5GC perspective)\n16.\tNG-RAN node stores the trace control and configuration parameters received from the AMF. This step is part of NG-RAN signaling trace activation - see clause 4.1.2.16 for more details.\n17.\tNG-RAN node starts the Trace Session according to the received configuration. This step is part of NG-RAN signaling trace activation - see clause 4.1.2.16 for more details.\nNote: The specific scenarios where SMF receives trace control and configuration parameters either from UDM or from AMF are specified in 3GPP TS 23.502 [41].\n\nThe figure 4.1.2.15.2.1 below illustrates an example scenario when UE served by 5GC with ongoing PDU session and active Trace Session makes an inter-RAT handover from NG-RAN to the E-UTRAN and makes another handover back from E-UTRAN to NG-RAN illustrated in figure 4.1.2.15.2.2.\nThe figure depicts the signaling trace activation during an inter-RAT handover from NG-RAN to E-UTRAN in a 5G network. It illustrates the process of signaling activation, which is crucial for ensuring reliable communication between different radio access technologies (RATs). The figure shows the activation of signaling traces at various points, including the base station (gNB), user equipment (UE), and scatterers. The diagram highlights the importance of signal path optimization and the use of beamforming techniques to mitigate interference.\nFigure 4.1.2.15.2.1: Signaling Trace Activation during Inter-RAT handover from NG-RAN to E-UTRAN\nThe steps 1 - 3, 6, 9, 12 - 22, 24, 26 and 28 on figure 4.1.2.15.2.1 are parts of the 5GS to EPS handover using N26 interface procedure - see 3GPP TS 23.502 [41] clause 4.11.1.2.1 for specific details. Present document does not attempt to re-define how 5GS to EPS handover using N26 interface procedure works, but rather illustrates the signaling Trace Activation aspects.\nWhen AMF sends the Relocation Request to MME, AMF shall include the following trace control and configuration parameters for the Trace Activation:\n-\tTrace Target:SUPI or IMEISV.\n-\tTrace Reference.\n-\tTriggering Events for MME, Serving GW, PDN GW, SGSN, GGSN.\n-\tTrace Depth.\n-\tList of NE Types to trace.\n-\tList of Interfaces for MME, Serving GW, PDN GW, eNB, SGSN, GGSN, RNC.\n-\tTrace Collection Entity IP Address for the file-based trace reporting or Trace Reporting Consumer URI for the streaming trace reporting.\nThe figure depicts the signaling trace activation during an inter-RAT handover from E-UTRAN to NG-RAN. It illustrates the process of signaling activation, which is a critical step in network handover. The figure shows the activation of signaling traces at the E-UTRAN and NG-RAN interfaces, highlighting the importance of this step in ensuring reliable handover.\nFigure 4.1.2.15.2.2: Signaling Trace Activation during Inter-RAT handover from E-UTRAN to NG-RAN\nThe steps 1, 2, 5, 8, 11 and 13 - 21 on figure 4.1.2.15.2.2 are parts of the EPS to 5GS handover using N26 interface procedure - see 3GPP TS 23.502 [41] clause 4.11.1.2.2 for specific details. Present document does not attempt to re-define how EPS to 5GS handover using N26 interface procedure works, but rather illustrates the signaling Trace Activation aspects.\nWhen MME sends the Forward Relocation Request to AMF, MME shall include the following trace control and configuration parameters for the Trace Activation:\n-\tTrace Target: SUPI or IMEISV.\n-\tTrace Reference.\n-\tTriggering Events for AMF, SMF, UPF and PCF.\n-\tTrace Depth.\n-\tList of NE Types to trace.\n-\tList of Interfaces for AMF, SMF, UPF, PCF and NG-RAN.\n-\tTrace Collection Entity IP Address.\nFigure 4.1.2.15.3.1 illustrates the signaling Trace Session activation procedure in 5GC as part of the Registration via Untrusted non-3GPP Access procedure:\nThe figure depicts a trace activation in 5G following the Registration via Untrusted non-3GPP Access procedure. It shows the activation of a trace in a 5G network, with the activation point marked as 15.3.1. The activation is initiated by a 3GPP Access procedure, which is not trusted by the network. This activation is crucial for ensuring network security and preventing unauthorized access.\nFigure 4.1.2.15.3.1: Trace activation in 5GC following the Registration via Untrusted non-3GPP Access procedure\nThe steps 3-11, 14 and 17 below are parts of the Registration via Untrusted non-3GPP Access procedure - see 3GPP TS 23.502 [41] clauses 4.12.2 and 4.2.2 for specific details. Present document does not attempt to re-define how Registration via Untrusted non-3GPP Access procedure works, but rather illustrates the signaling Trace Activation aspects.\n1.\tManagement system activates Trace Session to the UDM. The following trace control and configuration parameters shall be included in the Trace Activation message:\n-\tTrace Target: SUPI or IMEISV.\n-\tTrace Reference.\n-\tTriggering Events for AMF, SMF, UPF and PCF.\n-\tTrace Depth.\n-\tList of NE Types to trace.\n-\tList of Interfaces for AMF, SMF, UPF, PCF and NG-RAN.\n-\tTrace Collection Entity IP Address for the file-based trace reporting or Trace Reporting Consumer URI for the streaming trace reporting.\n2.\tUDM stores the trace control and configuration parameters received from the management system.\n3.\tUE connects to the Untrusted non-3GPP Access Network and obtains an IP address\n4.\tUE performs IKE authentication with N3IWF\n5.\tN3IWF selects appropriate AMF\n6.\tN3IWF sends N2 Registration request to AMF\n7.\tAMF requests AAA Key from AUSF\n8.\tUE authenticates with AUSF via N3IWF and AMF\n9.\tUE establishes Signaling IPsec SA with N3IWF\n10.\tUE sends SMC Complete to AMF\n11.\tAMF receives the trace control and configuration parameters information from UDM via Nudm_SDM_Get operation (see step 14 in clause 4.2.2.2.2 and clause 5.2.3.3 of 3GPP TS 23.502 [41]).\n12.\tAMF stores the trace control and configuration parameters received from the UDM.\n13.\tAMF starts the Trace Session according to the received configuration.\n14.\tAMF establishes Policy Association with PCF (see step 16 in clause 4.2.2.2.2 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the PCF.\n15.\tPCF stores the trace control and configuration parameters received from the AMF as part of Policy Association.\n16.\tPCF starts the Trace Session according to the received configuration.\n17.\tAMF provides the trace control and configuration parameters information to the SMF as part of the SM Context (see step 18 in clause 4.2.2.2.2 of 3GPP TS 23.502 [41]).\n18.\tSMF stores the trace control and configuration parameters received from the AMF.\n19.\tSMF starts the Trace Session according to the received configuration.\n\nFigure 4.1.2.15.3.2 illustrates the signaling Trace Session activation procedure in 5GC as part of the PDU Session Establishment via Untrusted non-3GPP Access procedure for the UE that has already been registered:\nThe figure depicts a trace activation in 5G following the PDU Session Establishment via Untrusted non-3GPP Access procedure. It shows the steps involved in establishing a session, including the use of a PDU (Session Initiation Protocol) and the subsequent activation of the trace. The figure provides a visual representation of the process, allowing for a clear understanding of the steps involved.\nFigure 4.1.2.15.3.2: Trace activation in 5GC following the PDU Session Establishment via Untrusted non-3GPP Access procedure\nThe steps 6 - 9, 13 and 16 - 19 below are parts of the UE Requested PDU Session Establishment via Untrusted non-3GPP Access procedure - see 3GPP TS 23.502 [41] clause 4.12.5 for specific details. Present document does not attempt to re-define how UE Requested PDU Session Establishment via Untrusted non-3GPP Access procedure works, but rather illustrates the signaling Trace Activation aspects.\n1.\tManagement system activates Trace Session to the UDM. The following trace control and configuration parameters shall be included in the Trace Activation message:\n-\tTrace Target: SUPI or IMEISV\n-\tTrace Reference\n-\tTriggering Events for AMF, SMF, UPF and PCF\n-\tTrace Depth\n-\tList of NE Types to trace\n-\tList of Interfaces for AMF, SMF, UPF, PCF and NG-RAN\n-\tTrace Collection Entity IP Address for the file-based trace reporting or Trace Reporting Consumer URI for the streaming trace reporting.\n2.\tUDM stores the trace control and configuration parameters received from the management system.\n3.\tUDM sends Nudm_SDM_Notification to AMF with the trace control and configuration parameters information (see clauses 4.5.1 and 5.2.3.3 of 3GPP TS 23.502 [41]).\n4.\tAMF stores the trace control and configuration parameters received from the UDM.\n5.\tAMF starts the Trace Session according to the received configuration.\n6.\tThe messages exchanged between UE and AMF shall be sent to N3IWF via the IPsec SA for NAS signalling established as specified in clause 4.12.2 of 3GPP TS 23.502 [41].\n7.\tUE sends PDU Session Establishment request to AMF\n8.\tAMF selects an appropriate SMF\n9.\tAMF sends the Nsmf_PDUSession_CreateSMContext request to the selected SMF\n10.\tSMF stores the trace control and configuration parameters received from the AMF.\n11.\tSMF starts the Trace Session according to the received configuration.\n12.\tSMF selects an approprite PCF\n13.\tSMF establishes Session Management Policy Association with PCF (see step 7 in clause 4.3.2.2.1 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the PCF.\n14.\tPCF stores the trace control and configuration parameters received from the SMF as part of Policy Association.\n15.\tPCF starts the Trace Session according to the received configuration.\n16.\tSMF performs N4 Session Establishment with UPF (see step 10 in clause 4.3.2.2.1 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the UPF.\n17.\tUPF stores the trace control and configuration parameters received from the SMF as part of N4 Session Establishment.\n18.\tUPF starts the Trace Session according to the received configuration.\n19.\tAMF sends N2 PDU Session Request to N3IWF\n20. N3IWF determines the necessary number of IPsec child SAs and establishes them with UE\n21.\tN3IWF sends PDU Session Establishment accept to UE\n22.\tN3IWF sends N2 PDU Session Request Ack to AMF\n\nFigure 4.1.2.15.3.3 illustrates the signaling Trace Session activation procedure in 5GC as part of the PDU Session Establishment via Untrusted non-3GPP Access procedure for the UE that has already been registered where SMF obtains trace control and configuration parameters from UDM via Nudm_UECM_Registration procedure:\nThe figure depicts a trace activation in 5G following the PDU Session Establishment via Untrusted non-3GPP Access procedure. It shows the steps involved in establishing a session, including the use of a PDU (Session Initiation Protocol) and the subsequent activation of the trace. The figure provides a visual representation of the process, allowing for a clear understanding of the steps involved.\nFigure 4.1.2.15.3.3: Trace activation in 5GC following the PDU Session Establishment via Untrusted non-3GPP Access procedure\nThe steps 6 - 9, 13 and 16 - 19 below are parts of the UE Requested PDU Session Establishment via Untrusted non-3GPP Access procedure - see 3GPP TS 23.502 [41] clause 4.12.5 for specific details. Present document does not attempt to re-define how UE Requested PDU Session Establishment via Untrusted non-3GPP Access procedure works, but rather illustrates the signaling Trace Activation aspects.\n1.\tManagement system activates Trace Session to the UDM. The following trace control and configuration parameters shall be included in the Trace Activation message:\n-\tTrace Target: SUPI or IMEISV\n-\tTrace Reference\n-\tTriggering Events for AMF, SMF, UPF and PCF\n-\tTrace Depth\n-\tList of NE Types to trace\n-\tList of Interfaces for AMF, SMF, UPF, PCF and NG-RAN\n-\tTrace Collection Entity IP Address for the file-based trace reporting or Trace Reporting Consumer URI for the streaming trace reporting.\n2.\tUDM stores the trace control and configuration parameters received from the management system.\n3.\tUDM sends Nudm_SDM_Notification to AMF with the trace control and configuration parameters information (see clauses 4.5.1 and 5.2.3.3 of 3GPP TS 23.502 [41]).\n4.\tAMF stores the trace control and configuration parameters received from the UDM.\n5.\tAMF starts the Trace Session according to the received configuration.\n6.\tThe messages exchanged between UE and AMF shall be sent to N3IWF via the IPsec SA for NAS signalling established as specified in clause 4.12.2 of 3GPP TS 23.502 [41].\n7.\tUE sends PDU Session Establishment request to AMF\n8.\tAMF selects an appropriate SMF\n9.\tAMF sends the Nsmf_PDUSession_CreateSMContext request to the selected SMF\n10.\tSMF performs NuDM_UECM_Registration procedure with UDM and receives the trace control and configuration parameters from UDM\n11.\tSMF stores the trace control and configuration parameters received from the UDM.\n12.\tSMF starts the Trace Session according to the received configuration.\n13.\tSMF selects an approprite PCF\n14.\tSMF establishes Session Management Policy Association with PCF (see step 7 in clause 4.3.2.2.1 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the PCF.\n15.\tPCF stores the trace control and configuration parameters received from the SMF as part of Policy Association.\n16.\tPCF starts the Trace Session according to the received configuration.\n17.\tSMF performs N4 Session Establishment with UPF (see step 10 in clause 4.3.2.2.1 of 3GPP TS 23.502 [41]) and provides the trace control and configuration parameters information to the UPF.\n18.\tUPF stores the trace control and configuration parameters received from the SMF as part of N4 Session Establishment.\n19.\tUPF starts the Trace Session according to the received configuration.\n20.\tAMF sends N2 PDU Session Request to N3IWF\n21. N3IWF determines the necessary number of IPsec child SAs and establishes them with UE\n22.\tN3IWF sends PDU Session Establishment accept to UE\n23.\tN3IWF sends N2 PDU Session Request Ack to AMF\nNOTE:\tThe specific scenarios where SMF receives trace control and configuration parameters either from UDM or from AMF are specified in 3GPP TS 23.502 [41].\nThe Trace Session should be activated in in an NG-RAN node when the NG-RAN node receives the TRACE START, INITIAL CONTEXT SETUP REQUEST or HANDOVER REQUEST message with the IE Trace Activation from the AMF and if some activities have been started on the interfaces that have been requested to be traced.\nIf the subscriber or equipment which is traced makes a handover to a target NG-RAN node using the Xn interface, the source NG-RAN node should propagate the trace control and configuration parameters further to the target NG-RAN node by using the HANDOVER REQUEST message. When the target NG-RAN node receives the HANDOVER REQUEST message it should immediately start a Trace Session according to the trace control and configuration parameters received in the HANDOVER REQUEST message.\nIf the subscriber or equipment being traced at the old NG-RAN node has been sent to RRC_INCTIVE and then establishes RRC Connection to a new NG-RAN node, the new NG-RAN node initiates the Retrieve UE Context procedure using Xn interface. The old NG-RAN node should propagate the trace control and configuration parameters further to the new NG-RAN node by using the RETRIEVE UE CONTEXT RESPONSE message. When the new NG-RAN node receives the RETRIEVE UE CONTEXT RESPONSE message it should immediately start a Trace Session according to the trace control and configuration parameters received in the RETRIEVE UE CONTEXT RESPONSE message.\nIf the subscriber or equipment which is traced makes a handover to a target NG-RAN node using the NG interface, it is the AMF's responsibility to propagate the trace control and configuration parameters to the target NG-RAN node.\nIf the tracing shall continue also after the relocation has been performed, the 5GC Trace Start procedure shall be re-initiated from the 5GC towards the future NG-RAN node after the Relocation Resource Allocation procedure has been executed successfully.\nThe TRACE START, INITIAL CONTEXT SETUP REQUEST or HANDOVER REQUEST message that is received from the AMF contains the following information:\n-\tTrace Reference and Trace Recording Session Reference.\n-\tList of Interfaces for NG-RAN node.\n-\tTrace Depth.\n-\tTrace Collection Entity IP Address for the file-based trace reporting or Trace Reporting Consumer URI for the streaming trace reporting.\nIf the Trace Reference is the same as an existing Trace Session for the same subscriber or equipment, the NG-RAN node shall not activate a new Trace Session and the existing Trace Session will not be impacted. See clause 4.2.3.12 for the conditions on whether or not the Trace Recording Session should be started.\nIf the Trace Reference is the same as an existing Trace Session for different subscriber(s) or equipment(s), the NG-RAN node shall not activate a new Trace Session, and the NG-RAN node shall not start a new Trace Recording Session.\nIf the NG-RAN node is not able to activate the trace session due to ongoing handover of the UE to another NG-RAN node, the NG-RAN node shall inform the AMF with the TRACE FAILURE INDICATION message using NG interface.\nUE measurements activation extends the 5GC trace activation procedure, as described in 4.1.2.15. When a Trace Session is activated, configuration parameters of MDT are added into the message.\nFor IMSI/IMEI(SV)/IMEI-TAC/SUPI based UE selection, or IMSI/IMEI(SV)/IMEI-TAC/SUPI combined with geographical area information, UE performance measurements activation request is propagated to the selected UE.\nThis mechanism works for the following input parameters:\n-\tIMSI only or\n-\tIMSI and area information or\n-\tIMEI(SV) only or\n-\tIMEI(SV) and area information or\n-\tIMEI-TAC only or\n-\tIMEI-TAC and area information or\n-\tSUPI only or\n-\tSUPI and area information\nAfter the IMSI, IMEISV, IMEI-TAC or SUPI type user attached to the network, the AMF shall forward the MDT configurations to the corresponding gNB which serves the IMSI, IMEISV, IMEI-TAC or SUPI type user. If the area criterion is specified and is not satisfied, the AMF shall keep the MDT configuration first and then forward it to the serving gNB only when the area criterion is satisfied.\nMDT criteria checking on gNB:\n-\tFor immediate MDT, after gNB got the MDT configuration, the gNB can detect the area information and decide whether the selected IMSI/IMEISV/SUPI can fit into the criteria for initiating MDT data collection. If the area information criterion is not met, the gNB keeps the MDT configuration and propagates it during handover as specified in clause 4. 4.\n-\tFor logged MDT, the gNB will forward the MDT configuration criteria to the selected IMSI/IMEISV/SUPI. The area criteria checking will be done at UE side after UE received the MDT configuration criteria.\nMDT criteria checking on UE:\n-\tFor immediate MDT, there is no need to do MDT criteria checking on UE.\n-\tFor logged MDT, the area criteria checking will be done at UE side after UE received the MDT configuration criteria.\nIn case of logged MDT, after UE receives from gNB the configuration parameters via the message RRC Connection Reconfiguration, it detects whether it stays within the specified area. If yes, the UE will execute measurement job. Otherwise UE will do nothing but waiting.\nIn case of Immediate MDT trace (e.g., IMSI/IMEI/SUPI based selection), the Immediate MDT trace session context of the UE shall be preserved in the network when the UE enters idle mode or inactive mode.\nThe Logged MDT MDT trace session is preserved in the UE until the duration time of the trace session expires, including also multiple idle periods interrupted by various state transistions such as idle-connected-idle state transitions.\nThe Logged MDT trace session context of the UE is stored in the network as long as the trace session is active, including also the periods when the UE is in connected state.\nIn the case of signalling based immediate MDT trace, if the UE is in inactive state at the time of receiving the immediate trace, then the gNB that receives this configuration shall store it.  The gNB shall also forward it as part of UE context retrieval procedure to the cell in another node that the UE camped onto and is in connected mode.\nTwo scenarios shall be considered according to UE status when management system activates MDT job: before UE attachment, after UE attachment, different procedures are described in .17.2 and 4.1.2.17.3.\nAs shown in figure .17.2.1, by adding configurations of MDT management system activate the Trace Session for MDT job.\n\nThe figure depicts a simplified representation of the MDT activation procedure in 5G Core and Non-Standalone (NG-RAN) networks. It illustrates the steps involved in activating the MDT, including the selection of the MDT, the configuration of the MDT, and the activation of the MDT. The figure also includes a visual representation of the MDT, such as the MDT's location and the number of MDTs involved. The figure is a useful tool for understanding the MDT activation procedure in 5G networks and for comparing it to the more complex procedures used in other networks.\nFigure 4.1.2.17.2.1: Example of MDT activation procedure in 5GC and NG-RAN\nThe MDT activation procedure before UE attachment in 5GC is the same as in EPC, When UDM activates the trace, for MDT job, to the AMF the following configuration parameters shall be included in the message:\n-\tJob Type\n-\tTrace Target: IMSI or IMEISV or IMEI-TAC or SUPI\n-\tArea Scope (e.g. TA, Cell)\n-\tTrace Reference\n-\tList of Measurements\n-\tReporting Trigger\n-\tReport Interval\n-\tReport Amount\n-\tEvent Threshold\n-\tLogging Interval\n-\tLogging Duration\n-\tCollection Period for RRM Measurements NR (present only if any of M4 or M5 measurements are requested).\n-\tCollection Period M6 in NR (present only if any of M6 measurements (DL or UL) is requested).\n-\tCollection Period M7 in NR (present only if any of M7 measurements (DL or UL)is requested).\n-\tPositioning Method\n-\tMDT PLMN List\n-\tTrace Collection Entity IP Address\n-\tExcess packet delay thresholds (present only if M6 UL measurements are requested)\nNote that at the same time not all the parameters can be present. The conditions are described in clause 5.10 of the present document.\nThe Specified geographical area field is available when IMSI/IMEI(SV)/IMEI-TAC/SUPI combined with geographical area are needed for UE selection.\nWhen AMF activate MDT activation to gNB, the MDT configuration parameters can be included in the message in the Initial Context Setup:\n-\tArea Scope (TA, Cell).\n-\tTrace Reference.\n-\tTrace Recording Session Reference.\n-\tList of Measurements.\n-\tReporting Trigger.\n-\tReport Amount.\n-\tReport Interval.\n-\tEvent Threshold.\n-\tLogging Interval.\n-\tLogging Duration.\n-\tTrace Collection Entity IP Address.\n-\tCollection Period for RRM Measurements NR (present only if any of M4 or M5 measurements are requested).\n-\tCollection Period M6 in NR (present only if any of M6 measurements (DL or UL) is requested).\n-\tCollection Period M7 in NR (present only if any of M7 measurements (DL or UL)is requested).\n-\tPositioning Method.\n-\tMDT PLMN List.\n-\tReport Type for Logged MDT (periodical logged or event-triggered measurement) for logged MDT only.\n-\tEvents List for Event-Triggered Measurement for logged MDT only.\n-\tEvent Threshold, Hysteresis and Time to trigger (present only if L1 event is configured for logged MDT).\n-\tArea Configuration for Neighbouring Cells for logged MDT only.\n-\tSensor Information for logged MDT and immediate MDT.\n-\tExcess packet delay thresholds (present only if M6 UL measurements are requested)\n\n\nThe figure depicts an example of MDT activation in 5G Core and Non-Standalone (NG-RAN) networks after UE attachment. It illustrates the process of activating MDTs in both 5G Core and Non-Standalone (NG-RAN) networks. The figure shows the activation of MDTs in the 5G Core network, highlighting the importance of MDTs in ensuring network reliability and performance.\nFigure .17.3.1: Example of MDT activation in 5GC and NG-RAN after UE attachment\nThe MDT activation procedure after UE attachment in 5GC is the same as in EPC, When UDM activates the trace, for MDT job, to the AMF the following configuration parameters shall be included in the message:\n-\tArea Scope (TA, Cell).\n-\tTrace Reference.\n-\tTrace Recording Session Reference.\n-\tList of Measurements.\n-\tReporting Trigger.\n-\tReport Amount.\n-\tReport Interval.\n-\tEvent Threshold.\n-\tLogging Interval.\n-\tLogging Duration.\n-\tTrace Collection Entity IP Address.\n-\tPositioning Method.\n-\tCollection Period for RRM Measurements NR (present only if any of M4 or M5 measurements are requested).\n-\tCollection Period M6 in NR (present only if any of M6 measurements (DL or UL) is requested).\n-\tCollection Period M7 in NR (present only if any of M7 measurements (DL or UL)is requested).\n-\tMDT PLMN List.\n-\tReport Type for Logged MDT (periodical logged or event-triggered measurement) for logged MDT only.\n-\tEvents List for Event-Triggered Measurement for logged MDT only.\n- \tEvent Threshold, Hysteresis and Time to Trigger (present only if L1 event is configured for logged MDT)..\n-\tArea Configuration for Neighbouring Cells for logged MDT only.\n-\tSensor Information for logged MDT and immediate MDT.\n-\tExcess packet delay thresholds (present only if M6 UL measurements are requested)\nIn case of logged MDT and the UE is currently being in idle or inactive mode, the AMF is not required to initiate paging of the UE in order to send the configuration.\nHandling of various scenarios for Signalling based Logged/Immediate MDT are addressed below:\n1)\tManagement System initiating MDT activation shall validate that PLMNs specified in the MDT PLMN List are  supported by all the cells specified in the area scope If the gNB receives a request where none of the PLMNs in the MDT PLMN List match any PLMN in its list, it shall ignore the request.\n2) AMF shall be informed with a TRACE FAILURE INDICATION message if the gNB could not configure the UE because it was in the middle of a handover, see TS 38.413 [49]. AMF shall try to reactivate MDT in the target cell if the target cell scope meets the MDT criteria.\n3)\tWhen the UE re-enters PLMN (specified in the MDT PLMN List) then the AMF shall be responsible for restarting the Immediate MDT activation (if it is as a result of an Xn handover then one option is AMF could use the path switch request as trigger). However, this is best effort. There can be cases where AMF may not be able to restart the MDT when the UE re-enters the PLMN (specified in the MDT PLMN List): for example: If the UE performs intra gNB handover where path switch is not necessarily sent, the AMF may not be able to restart MDT.\n\nThe figure depicts an example of MDT activation in 5G Core and Non-Standalone (NG-RAN) networks after UE attachment in a split architecture. It illustrates the process of activating MDTs in both 5G Core and Non-Standalone (NG-RAN) networks, highlighting the importance of MDTs in ensuring network reliability and performance.\nFigure .17.5.1: Example of MDT activation in 5GC and NG-RAN after UE attachment in a split architecture\nWhen AMF sends a Trace Start message to gNB-CU-CP, the gNB-CU-CP decides if gNB-CU-UP or gNB-DU, or both should be involved in the MDT measurement.  It means that the gNB-CU-CP shall send the TRACE START message to gNB-CU-UP and/or gNB-DU if these nodes should be involved in the MDT measurement.\nIn case of the split architecture, the configuration parameters that shall be included in the message are same as in the case of non-split architecture, see clause 4.1.2.17.3.\nThe overall description for signalling based MDT activation procedure in the case of split architecture can be found in TS 38.401 [44].\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.1.3\tManagement deactivation",
                            "text_content": "When last Trace session is requested to be ended for an IMEI(SV) or a list of IMEI(SV), the RNC shall send the requested IMEI(SV)/list of IMEI(SV)s in 'Uplink Information Exchange Request' to the interacting MSC Server(s) and SGSN(s). The MSC Servers and SGSNs shall remove the requested IMEI(SV)s for the RNC in question.\nWhen a SGSN, GGSN or BM-SC receives a Trace Session Deactivation from its EM, the Trace Session identified by the Trace Reference, shall be deactivated in SGSN/GGSN/BM-SC.\nIf a Trace Recording Session is active at the time of receiving a Trace Session deactivation from the EM, the SGSN/GGSN/BM-SC may choose to continue the Trace Recording Session till it ends gracefully or may stop it immediately. In all cases, the SGSN/GGSN/BM-SC shall deactivate the requested Trace Session immediately at the end of the Trace Recording Session.\nWhen a MSC Server receives a Trace Session Deactivation from its EM, the Trace Session identified by the Trace Reference, shall be deactivated in MSC Server.\nIf a Trace Recording Session is active at the time of receiving a Trace Session deactivation from the EM, the MSC Server may choose to continue the Trace Recording Session till it ends gracefully or may stop it immediately. In all cases, the MSC Server shall deactivate the requested Trace Session immediately at the end of the Trace Recording Session.\nWhen a S-CSCF/P-CSCF receives a Trace Session deactivation from the EM, the Trace Session identified by the Trace Reference, shall be deactivated.\nIf a Trace Recording Session is active at the time of receiving a Trace Session deactivation from the EM, the S-CSCF/P-CSCF may choose to continue the Trace Recording Session till it ends gracefully or may stop it immediately. In all cases, the S-CSCF/P-CSCF shall deactivate the requested Trace Session immediately at the end of the Trace Recording Session.\nThe following figure illustrates how the Trace Session is deactivated when a Trace Recording Session is going on (e.g. a SIP INVITE method is being traced in S-CSCF).\nThe figure depicts a detailed representation of session deactivation in the Internet Message Service (IMS) protocol, illustrating the various steps and components involved in the process. The figure includes a flowchart, which outlines the steps from initiation to completion, and a series of nodes representing different components such as the session controller, session manager, and session deactivation manager. The nodes are connected by arrows, indicating the flow of information and the sequence of actions. The figure also includes a legend to help understand the different colors and symbols used in the flowchart. Overall, the figure provides a comprehensive overview of the IMS session deactivation process, making it easier to understand and follow.\nFigure 4.1.3.4.1: Trace session deactivation in IMS\nIn E-UTRAN the Cell Traffic trace functionality can be deactivated when the eNodeB receives the Trace Session Deactivation message from the EM. At this time the eNodeB shall deactivate the Trace Session for those E-UTRAN Cells that have been indicated in the Trace Session Deactivation message received from the EM.\nWhen a MME, SGW or PGW receives a Trace Session Deactivation from its EM, the Trace Session identified by the Trace Reference, shall be deactivated in the MME, SGW or PGW.\nIf a Trace Recording Session is active at the time of receiving a Trace Session deactivation from the EM, the MME may choose to continue the Trace Session and the Trace Recording Session till it ends gracefully or may stop it immediately. In all cases, the MME shall deactivate the requested Trace Session immediately at the end of the Trace Recording Session.\nWhen the eNodeB receives the indication from EM for MDT trace session deactivation, it shall deactivate the trace session for those E-UTRAN cells that have been indicated in the message. In case of immediate MDT trace session the eNodeB shall deactivate the corresponding MDT RRC measurements in the UEs that have been configured for immediate MDT as part of the given trace session.\nThe UE shall silently discard a logged MDT or Logged MBSFN MDT trace session when logging duration expires and shall indicate the availability of logged measurement results to the network next time it enters connected mode.\nIn 5GC the management trace deactivation utilizes the Services Based Management Architecture (SBMA) defined in TS 28.533 [48]. The NE Trace Control and Configuration parameters are removed via interaction between Provisioning MnS (see definitions in TS 28.532 [47]) consumer and Provisioning MnS producer. Figure 4.1.3.9-1 below illustrates the 5GC management deactivation where the role of a Provisioning MnS producer is played by the NE and the role of a Provisioning MnS consumer is played by the Management System.\nThe figure depicts a detailed overview of management deactivation for 5G Core, including the various steps and considerations involved in managing the network's resources. It highlights the importance of proper management to ensure the smooth operation of the network and prevent potential issues.\nFigure 4.1.3.9-1: Overview of management deactivation for 5GC\nWhen an AF, AMF, AUSF, NEF, NRF, NSSF, PCF, SMF, SMSF, UPF or UDM receives a Trace Session Deactivation from its management system, the Trace Session identified by the Trace Reference, shall be deactivated in the AF, AMF, AUSF, NEF, NRF, NSSF, PCF, SMF, SMSF, UPF or UDM.\nIf a Trace Recording Session is active at the time of receiving a Trace Session deactivation from the management system, the AMF may choose to continue the Trace Session and the Trace Recording Session till it ends gracefully or may stop it immediately. In all cases, the AMF shall deactivate the requested Trace Session immediately at the end of the Trace Recording Session.\nIn NG-RAN the management trace deactivation utilizes the Services Based Management Architecture (SBMA) defined in TS 28.533 [48]. The Cell Traffic trace functionality can be deactivated when the NG-RAN node Trace Control and Configuration parameters are removed via interaction between Provisioning MnS (see definitions in TS 28.532 [47]) consumer and Provisioning MnS producer.. At this time the NG-RAN node shall deactivate the Trace Session for those NG-RAN Cells that have been indicated in the Trace Session Deactivation message received from the management system. Figure 4.1.3.10-1 below illustrates the NG-RAN management deactivation where the role of a Provisioning MnS producer is played by the NE and the role of a Provisioning MnS consumer is played by the Management System.\nThe figure depicts an overview of management deactivation for NG-RAN, highlighting the steps involved in deactivating the management functions of the network. The figure includes a diagram of the network, with various components such as base stations (BTS), radio access network (RAN), and network functions virtualization (NFV) nodes. The management deactivation process is depicted in a step-by-step manner, with each step clearly labeled and accompanied by a corresponding icon. The figure also includes a legend to help users understand the different icons and their meanings. Overall, the figure provides a comprehensive overview of the management deactivation process for NG-RAN, making it easier for network operators to understand and implement this critical management function.\nFigure 4.1.3.10-1: Overview of management deactivation for NG-RAN\nWhen the gNB receives the indication from management system for MDT trace session deactivation, it shall deactivate the trace session for those NG-RAN cells that have been indicated in the message. In case of immediate MDT trace session, the gNB shall deactivate the corresponding MDT RRC measurements in the UEs that have been configured for immediate MDT as part of the given trace session.\nIn the case of split RAN architecture, If MDT trace session in gNB-CU-UP and/or gNB-DU has been activated by gNB-CU-CP, the responsible gNB-CU-CP shall deactivate the corresponding MDT trace sessions in gNB-CU-UP and/or gNB-DU.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.1.4\tSignalling deactivation",
                            "text_content": "In Signalling deactivation, the Trace Deactivation shall always be carried out from the Core Network EM only [EM (PS), EM (CS), EM(EPC) and EM (HSS) are generally considered to be in the Core Network. A Core Network EM can be any of these or their combinations]. In case of home subscriber trace (i.e. in the HPLMN) the Trace Session deactivation shall go to the HSS, MSC Server/VLR, SGSN or MME. In case of foreign subscriber trace (i.e. the HPLMN operator wishes to deactivate tracing on foreign subscribers roaming in his PLMN) the Trace Session deactivation shall go the MSC Server/VLR SGSN or MME. The Management System shall deactivate the Trace Session in the same NE where it activated the Trace Session.\nWhen an HSS receives a Trace Session deactivation from its Management system, it shall deactivate the active Trace Session corresponding to the Trace Reference received in the deactivation message. The HSS shall delete all trace control and configuration parameters associated with this Trace Session. If a Trace Recording Session is active at the time of receiving a Trace Session deactivation message from the EM, the HSS may choose to continue the Trace Recording Session till it ends gracefully or may stop it immediately. In all cases, the HSS shall deactivate the requested Trace Session immediately at the end of the Trace Recording Session.\nIn 5GS the signaling trace deactivation utilizes the Services Based Management Architecture (SBMA) defined in TS 28.533 [48]. The 5GC NE Trace Control and Configuration parameters are removed via interaction between Provisioning MnS (see definitions in TS 28.532 [47]) consumer and Provisioning MnS producer. Figure 4.1.4.1.2-1 below illustrates the 5GS signaling deactivation where the role of a Provisioning MnS producer is played by the 5GC NE and the role of a Provisioning MnS consumer is played by the Management System. The 5GC NE shall propagate the deactivation to in the entire network. Detailed signalling deactivation mechanisms are specified for 5GC in clause 4.1.4.11 and for NG-RAN in clause 4.1.4.12.\nThe figure depicts a schematic overview of signaling deactivation for 5G, highlighting the various steps and components involved in the deactivation process. The figure includes a flowchart, which illustrates the sequential steps of signaling deactivation, such as signal detection, signal processing, and deactivation. The figure also includes a legend to help understand the different colors and symbols used in the flowchart. Overall, the figure provides a clear and concise visual representation of the signaling deactivation process for 5G networks.\nFigure 4.1.4.1.2-1: Overview of signaling deactivation for 5GS\nWhen RNC receives the CN_DEACTIVATE_TRACE message it shall deactivate the Trace Session for the indicated Trace Reference in the CN_DEACTIVATE_TRACE message. In case of simultaneous CS/PS connections, the trace session for the indicated Trace Reference shall be closed upon reception of the CN DEACTIVATE TRACE message from any of the CN domain, whether it was the one which initiated trace session activation or not.\nThe Trace Session is also deactivated in the RNC when the Iu connection to the Core Network is released.\nIf CN_INVOKE_TRACE message is received for only one Iu connection (either CS or PS) the Trace Session shall be deactivated in the RNC when the IU_RELEASE_COMMAND message is received from the Core Network for that Iu connection where the CN_INVOKE_TRACE message is sent.\nThe following figure shows this behaviour:\nThe figure depicts a trace session deactivation (signalling) in UTRAN 1, illustrating the process of signaling in a network.\nFigure 4.1.4.2.1: Trace session deactivation (Signalling) in UTRAN 1\nIf CN_INVOKE_TRACE message is received by the RNC for both Iu-CS and Iu-PS connection with the same Trace Reference number than the Trace Session shall not be deactivated in the RNC when any of the Iu connection is released (when the first IU_RELEASE_COMMAND message is received). The Trace Session shall be deactivated when the second Iu connection is released (the second IU_RELEASE_COMMAND message is received). The following figure shows the situation.\nThe figure depicts a detailed representation of the session deactivation (signalling) in the UTRAN 2 protocol, illustrating the various steps and components involved in the process.\nFigure 4.1.4.2.2: Trace session deactivation (Signalling) in UTRAN 2\nInteraction with Soft-handover\nThe Trace Session should be deactivated in a Drift RNC when the DRNC receives the IUR_DEACTIVATE_TRACE message or the Iur connection is released.\nWhen an RNC deactivates a Trace Session the Trace Recording Session shall also be stopped at the same time.\nNOTE:\tIn RNC the Trace Session and the Trace Recording Session always the same.\nWhen an HSS receives a Trace Session deactivation from the Management System it shall send a MAP_DEACTIVATE_TRACE_MODE message to the SGSN.\nWhen the SGSN receives a MAP_DEACTIVATE_TRACE_MODE message it shall deactivate the Trace Session identified by the Trace Reference received in the MAP_DEACTIVATE_TRACE_MODE message.\nIf a Trace Recording Session is active at the time of receiving a deactivation message (in SGSN it is the MAP-DEACTIVATE_TRACE_MODE, in GGSN it is the GTP Update PDP Context Request or the Update MBMS Context Request, in BM-SC it is the Diameter Gmb STR message), the SGSN and/or the GGSN and/or the BM-SC may choose to continue the Trace Recording Session till it ends gracefully or may stop it immediately. In all cases, the SGSN/GGSN/BM-SC shall deactivate the requested Trace Session immediately at the end of the Trace Recording Session. When the SGSN deactivates the Trace Session, it shall delete all trace control and configuration parameters associated with the corresponding Trace Session.\nIf SGSN deactivates the Trace Session during the Trace Recording Session, the SGSN should deactivate the trace to the RNC by using the CN_DEACTIVATE_TRACE RANAP message and should deactivate the trace to the GGSN by sending the GTP Update PDP Context Request or the Update MBMS Context Request message with Trace Activity Control set to Trace Deactivation.\nIf the GGSN deactivates the Trace Session during the Trace Recording Session, the GGSN should deactivate the trace to the BM-SC (by sending a Diameter Gmb STR message).\nWhen an HSS receives Trace Session deactivation from the Management System it shall send a MAP_DEACTIVATE_TRACE_MODE message to the MSC Server.\nWhen the MSC Server receives a MAP_DEACTIVATE_TRACE_MODE message it shall deactivate the Trace Session identified by the Trace Reference received in the MAP_DEACTIVATE_TRACE_MODE message.\nIf a Trace Recording Session is active at the time of receiving a MAP_DEACTIVATE_TRACE_MODE message from the HSS, the MSC Server may choose to continue the Trace Recording Session till it ends gracefully or may stop it immediately. In all cases, the MSC Server shall deactivate the requested Trace Session immediately at the end of the Trace Recording Session. When the MSC Server deactivates the Trace Session it shall delete all trace control and configuration parameters associated with the corresponding Trace Session. .\nIf MSC Server deactivates the Trace Session during a Trace Recording Session, it should deactivate the trace to the RNC by sending the _DEACTIVATE_TRACE RANAP message and should deactivate the trace to the MGW.\nWhen an IMS NE (i.e. S/I/P-CSCF, AS, HSS, MRF, MGCF, BGCF) receives Trace Session deactivation the Trace Session, as identified by the Trace Reference, shall be deactivated.\nIf a Trace Recording Session(s) within the Trace session is active at the time of receiving a Trace Session deactivation, the IMS NE may stop the trace recording session(s) immediately or it may choose to continue the Trace Recording Session(s) till the session(s) ends gracefully (e.g. the SIP session ends after a specific period of time, or upon completion of a SIP session and the reception of a SIP BYE).\nIn all cases, the IMS NE shall deactivate the requested Trace Session immediately at the end of the Trace Recording Session(s). When the IMS NE deactivates the Trace Session, it shall delete all associated trace control and configuration parameters associated with that Trace Session.\nTrace Session deactivation may be initiated from the Core Network EM only [EM (UE), and EM (HSS)]. The same EM that initiated Trace Session activation shall initiate a Trace Session deactivation in the same Network Element (NE).\nWhen Trace Session deactivation is required for a registered home subscriber in the home IM CN SS, Trace Session deactivation shall go to the UE and the HSS. The HSS shall propagate the Trace Session deactivation to the S-CSCF, I-CSCF, and the AS. The S-CSCF and I-CSCF shall propagate the Trace Session deactivation to the P-CSCF. The Trace Session deactivation shall be propagated to the MRF, MGCF and BGCF via the S-CSCF.\nWhen Trace deactivation is required for a registered home subscriber in a visited IM CN SS, Trace Session deactivation shall go to the UE and the HSS. The HSS shall propagate the Trace Session deactivation to the S-CSCF, I-CSCF and the AS.\nDepending on whether the I-CSCF had previously propagated a Trace Session Activation to the P-CSCF serving the UE (see subclause 4.1.2.9.2) where Trace is to be initiated the I-CSCF may propagate the Trace Session deactivation to the P-CSCF.\nAn Active Trace Session may be deactivated at an IMS NE following the detection of a Stop Triggering Event, e.g. Trace Session expiry time.\nIn the case where there is one or more active Trace Recording Sessions, the IMS NE shall deactivate the Trace Session immediately following the detection of a Stop Triggering Event associated for each of the Trace Recording Session(s), e.g. following the detection of SIP final response or a SIP Request Failure.\nWhen the IMS NE deactivates the Trace Session Stop Triggering Event, it shall delete all associated trace control and configuration parameters associated with that Trace Session.\nWhen required, an active Trace Session at an IMS NE may be deactivated directly by its EM. The Management based Trace Session deactivation mechanism (see clause 4.1.1) shall be used for this purpose.\nThe EM (UE) and the interactions between the EM (UE) and the UE shall be achieved using OMA Device Management [18].\nFigure 4.1.4.6.3.1 illustrates the sending of Trace Session Deactivation from the Device Management Server (DMS) to a UE.\n\nThe figure depicts a trace session deactivation at a UE, illustrating the process of terminating a session in a 5G network. The session deactivation is a crucial step in ensuring network reliability and security. The figure shows the UE's connection to the network, with the session deactivation occurring at the UE's end. The deactivation process involves disconnecting the UE from the network, which is essential for maintaining network integrity and preventing unauthorized access. The figure also highlights the importance of network security measures, such as encryption and authentication, in ensuring the safety of sensitive data.\nFigure 4.1.4.6.3.1: Trace session deactivation at a UE\nTrace Session deactivation shall be initiated from the Device Management Server (DMS). The same DMS that initiated Trace Session activation shall initiate a Trace Session deactivation in the same UE (Step 1).\nWhen a UE receives Trace Session Deactivation as part of the received management operation from its DMS (Step 2) it may deactivate the Trace Session (Step 3).\nIf a Trace Recording Session(s) within the Trace session is active at the time of receiving a Trace Session deactivation, the UE may stop the trace recording session(s) immediately (see note), or it may choose to continue the Trace Recording Session(s) until the session(s) end gracefully (e.g. the SIP session ends after a specific period of time, or upon completion of a SIP session and the reception of a SIP BYE).\nNOTE:\tWhen the Trace session is stopped the UE may deactivate or delete its management operation.\nWhen an HSS receives a Trace Session Deactivation from the Management System it shall send an S6a-Delete Subscriber Data Request message to the MME at which the UE is currently registered if MME is included in the NE types for Tracing, via the S6a interface to remove the \"trace data\" from subscription data (see 3GPP TS 29.272[26]). The HSS shall deactivate trace if trace is active at the HSS.\nWhen the MME receives the S6a-Delete Subscriber Data Request message to remove the \"trace data\" from subscription data (see 3GPP TS 29.272 [26]) or the Trace Session is deactivated directly from the EM it shall deactivate the Trace Session identified by the Trace Reference.\nIf the UE was registered to the HSS by an MME via the S6a interface, (i.e. the user is attached to a 3GPP access network), the Trace Session shall be deactivated to the MME via the S6a interface.\nIf the user was registered by a AAA server via the SWx interface (i.e. the user is attached to a non-3GPP network) the HSS shall send the Trace Session deactivation request with a push profile request.\nThe AAA server shall examine the received user profile and if it detects that the Trace Session shall be deactivated, it shall initiate a re-authorization procedure towards the PDN GW. The Trace Session is deactivated in the PDN GW by using this re-authorization procedure.\nWhen the PDN GW receives the updated authorization data with trace information that represents Trace Session deactivation request, it shall deactivate the Trace Session identified by the Trace Reference.\nThe following figure illustrates the Trace Session deactivation when the user is attached to a non-3GPP access network for DSMIPv6 on S2c or PMIP on S2a/S2b.\nThe figure depicts a trace session deactivation mechanism in a 3GPP-compliant network, specifically for DSMIPv6 on S2c or PMIP on S2a/S2b. The session deactivation is triggered when an UE is attached from a non-3GPP access network, ensuring that the network remains secure and reliable.\nFigure 4.1.4.7.1: Trace Session deactivation in case UE attached from non-3GPP access network for DSMIPv6 on S2c or PMIP on S2a/S2b\nIf the user was registered by a AAA server via the SWx interface (i.e. the user is attached to a non-3GPP network) the HSS shall send the Trace Session deactivation request with a push profile request.\nThe AAA server shall examine the received user profile and if it detects that the Trace Session shall be deactivated, it shall initiate a re-authorization procedure towards the ePDG. \nThe ePDG shall examine the received information from the AAA and if it detects that the Trace Session shall be deactivated (see 3GPP TS 29.273 [22]), it shall initiate a trace deactivation procedure towards the PDN GW (see 3GPP TS 29.274 [34]).\nWhen the PDN GW receives the data with trace information that represents Trace Session deactivation request, it shall deactivate the Trace Session identified by the Trace Reference.\nThe figure depicts a trace session deactivation in case of an UE attached from a non-3GPP access network for a GTP-based S2b interface. The session is deactivated when the UE is not connected to the 3GPP network.\nFigure 4.1.4.7.2: Trace Session deactivation in case UE attached from non-3GPP access network for GTP based S2b interface\nWhen the MME receives the S6a-Delete Subscriber Data Request message to remove the \"trace data\" from subscription data (see 3GPP TS 29.272 [26]) or the Trace Session is deactivated directly from the EM it shall deactivate the Trace Session identified by the Trace Reference.\nIf a Trace Recording Session is active at the time of receiving a deactivation message, the MME may choose to continue the Trace Recording Session until it ends gracefully or may stop it immediately. In all cases, the MME shall deactivate the requested Trace Session immediately at the end of the Trace Recording Session. When the MME deactivates the Trace Session, it shall delete all trace control and configuration parameters associated with the corresponding Trace Session.\nIf MME deactivates the Trace Session during the Trace Recording Session, the MME should deactivate the trace at the eNB by sending the S1-Deactivate Trace message to the eNodeB via the S1 interface and should deactivate the trace at the SGW by sending an S11-Trace Session Deactivation message to the SGW via the S11 interface. The message sent by MME shall include the Trace Reference to identify the Trace Session that is to be deactivated.\nWhen SGW receives an S11-Trace Session Deactivation message from the MME, the SGW may choose to continue the Trace Recording Session until it ends gracefully or may stop it immediately. In all cases, the SGW shall deactivate the requested Trace Session immediately at the end of the Trace Recording Session. If SGW deactivates the Trace Session during the Trace Recording Session, the SGW should deactivate the trace at the PDN GW by sending the S5-Trace Session Deactivation message to the PGW via the GTP based S5 interface. In case of PMIP based S5 interface the SGW should deactivate the trace to the PDN GW using PCC signalling, i.e. by sending a Trace Deactivation message to the PCRF and PCRF forwards the trace deactivation message to the PDN GW [29].When the SGW deactivates the Trace Session, it shall delete all trace control and configuration parameters associated with the corresponding Trace Session.\nWhen PGW receives an S5-Trace Session Deactivation message from the SGW, or S2b-Trace Session Deactivation message from the ePDG, or it receives the Trace Session Deactivation message from PCRF in case of PMIP based S5, the PDN GW may choose to continue the Trace Recording Session until it ends gracefully or may stop it immediately. In all cases, the PDN GW shall deactivate the requested Trace Session immediately at the end of the Trace Recording Session. When the PDN GW deactivates the Trace Session, it shall delete all trace control and configuration parameters associated with the corresponding Trace Session.\nWhen a Trace Session Deactivation message is sent on any interface the Trace Reference that identifies the Trace Session shall be included to the Trace Session Deactivation message.\nThere are two different events that deactivate a Trace Session:\n1)\tWhen eNB receives the S1- Deactivate Trace message it shall deactivate the Trace Session for the indicated Trace Reference.\n2)\tWhen the eNB releases the UE context the Trace Recording Session shall be stopped and the Trace Session is deactivated at the eNB.\n\nWhen the MME receives a Trace Session Deactivation request for an MDT Trace Session of a UE, it shall act according to the following.\nIn case of an immediate MDT trace session and the UE being in connected mode, the MME shall send trace session deactivation toward the eNodeB. The eNodeB shall deactivate the corresponding MDT RRC measurements in the UE and shall discard the given trace session context.\nIn case of an immediate MDT trace session and the UE being in idle mode, the MME shall silently discard the stored trace session context.\nNote: \tSignaling based deactivation does not apply for logged MDT or Logged MBSFN MDT trace sessions, the logged MDT and Logged MBSFN MDT trace session terminates when logging duration expires.\nThe UE shall discard a logged MDT or Logged MBSFN MDT trace session when logging duration expires and shall indicate the availability of logged measurement results to the network next time it enters connected mode.\nFigure 4.1.4.11.1 illustrates the signaling Trace Session deactivation procedure in 5GC:\n\n\nFigure 4.1.4.11.1: Trace deactivation in 5GC procedure\n1.\tManagement system deactivates Trace Session to the UDM.\n2.\tUDM sends Nudm_SDM_Notification to AMF with the trace deactivation information (see clause 5.2.3.3.3 of 3GPP TS 23.502 [41]).\n3.\tAMF deactivates the Trace Session according to the received information.\n4.\tAMF sends the DEACTIVATE TRACE message over NG interface (N2 interface from the 5GC perspective)\n5.\tNG-RAN node deactivates the Trace Session according to the received information received from the AMF. This step is part of NG-RAN signaling trace deactivation - see clause 4.1.2.12 for more details.\n6.\tAMF sends the Nsmf_PDUSession_UpdateSMContext request to the SMF\n7.\tSMF deactivates the Trace Session according to the received information.\n8.\tSMF performs Session Management Policy Modification with PCF (see step 7 in clause 4.3.3.2 of 3GPP TS 23.502 [41]) and provides the trace deactivation information to the PCF.\n9.\tPCF deactivates the Trace Session according to the received information.\n10\tSMF performs N4 Session Modification with UPF (see step 10 in clause 4.3.3.2 of 3GPP TS 23.502 [41]) and provides the trace deactivation information to the UPF.\n11.\tUPF deactivates the Trace Session according to the received information.\n\nFigure 4.1.4.11.2 illustrates the signaling Trace Session deactivation procedure in 5GC where UDM notifies SMF about trace deactivation directly:\n\n\nFigure 4.1.4.11.2: Trace deactivation in 5GC procedure (with UDM to SMF notification)\n1.\tManagement system deactivates Trace Session to the UDM.\n2.\tUDM sends Nudm_SDM_Notification to AMF with the trace deactivation information (see clause 5.2.3.3.3 of 3GPP TS 23.502 [41]).\n3.\tAMF deactivates the Trace Session according to the received information.\n4.\tAMF sends the DEACTIVATE TRACE message over NG interface (N2 interface from the 5GC perspective)\n5.\tNG-RAN node deactivates the Trace Session according to the received information received from the AMF. This step is part of NG-RAN signaling trace deactivation - see clause 4.1.2.12 for more details.\n6.\tUDM sends Nudm_SDM_Notification to SMF with the trace deactivation information (see clause 5.2.3.3.3 of 3GPP TS 23.502 [41]).\n7.\tSMF deactivates the Trace Session according to the received information.\n8.\tSMF performs Session Management Policy Modification with PCF (see step 7 in clause 4.3.3.2 of 3GPP TS 23.502 [41]) and provides the trace deactivation information to the PCF.\n9.\tPCF deactivates the Trace Session according to the received information.\n10\tSMF performs N4 Session Modification with UPF (see step 10 in clause 4.3.3.2 of 3GPP TS 23.502 [41]) and provides the trace deactivation information to the UPF.\n11.\tUPF deactivates the Trace Session according to the received information.\nThere are two different events that deactivate a Trace Session:\n1.\tWhen NG-RAN node receives the DEACTIVATE TRACE message using NG interface, it shall deactivate the Trace Session for the indicated Trace Reference.\n2.\tWhen the NG-RAN node releases the UE context the Trace Recording Session shall be stopped and the Trace Session is deactivated at the NG-RAN node.\nIf the NG-RAN node is not able to deactivate the trace session due to ongoing handover of the UE to another NG-RAN node, the NG-RAN node shall inform the AMF with the TRACE FAILURE INDICATION message using NG interface.\nIn case of an immediate MDT trace session and the UE being in connected mode in a split architecture, the AMF shall send DEACTIVATE TRACE message using NG interface toward the gNB-CU-CP. The gNB-CU-CP shall send trace session deactivation towards gNB-CU-UP and/or gNodeB-DU if the trace sessions in the gNB-CU-UP and/or gNB-DU have been activated by the gNB-CU-CP. The gNB-CU-CP shall also deactivate the corresponding MDT RRC measurements in the UE and shall discard the given trace session context.\nNote: \tSignaling based deactivation does not apply for logged MDT trace sessions. The logged MDT trace session terminates when logging duration expires.\nWhen the AMF receives a Trace Session Deactivation request for an MDT Trace Session of a UE, it shall act according to the following.\nIn case of an immediate MDT trace session and the UE being in connected mode, the AMF shall send trace session deactivation toward the eNB/gNB. The eNB/gNB shall deactivate the corresponding MDT RRC measurements in the UE and shall discard the given trace session context.\nIn case of an immediate MDT trace session and the UE being in idle mode, the AMF shall silently discard the stored trace session context.\nIn case of an immediate MDT trace session and the UE being in inactive state, the AMF that is aware of inactive state shall silently discard the stored trace session context.\nNote: \tSignaling based deactivation does not apply for logged MDT or Logged MBSFN MDT trace sessions. The logged MDT and Logged MBSFN MDT trace session terminates when logging duration expires.\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.1.5\tMDT Trace selection conditions",
                            "text_content": "In Immediate MDT, both in case of signalling based and management based MDT trace activation, it is always the network that evaluates all selection conditions for activating the MDT measurements and deactivating the MDT measurements (this evaluation is done continuously during the selected call session). The network activates and deactivates the MDT measurements toward the UE accordingly via RRC.\nIn Logged MDT and Logged MBSFN MDT, the network configures UEs for MDT tracing that are eligible based on the specified selection criteria. If area based condition is specified in the trace configuration, it is sent to the UE at configuration time and the UE will evaluate the area condition as it moves in the network in idle mode.\nImmediate MDT, Logged MDT and Logged MBSFN MDT measurements shall always be configured as separate trace sessions.\nIn cases of overlapping MDT configuration request the signaling based request shall override the management based request. For logged MDT and Logged MBSFN MDT, prior to re configuring, the eNB shall retrieve the MDT logs from the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.2\tTrace Recording Session Start / Stop triggering for Trace and MDT",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.2.1\tGeneral",
                            "text_content": "The Trace Session activation contains the triggering events parameter. The actual start/stop triggering events corresponding to the values of the triggering events parameter are defined in triggering events tables in sub-clause 5.1 in the present document.\nIf a UMTS or EPS NE failed to start the Trace Recording Session, a Trace failure notification file shall be sent to the TCE, and the Trace failure notification has the the same parameters as the notification notifyTraceRecordingSessionFailure defined in 3GPP TS 32.442 [24], the Trace failure notification file XML schema is defined in Annex A.\nIf a 5GS NE failed to start the Trace Recording Session in a file-based reporting case, a Trace failure notification file shall be sent to the TCE following the Trace failure notification file XML schema is defined in Annex A. If the NE failed to start the Trace Recording Session in a streaming reporting case, a Trace failure notification shall be sent to the Trace Reporting MnS consumer. In addition, a new Alarm may be reported via the Fault Supervision MnS (see definitions in TS 28.532 [47]).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.2\tStarting a trace recording session - management based",
                            "text_content": "In an RNC, a Trace Recording Session should start after the reception of the CN_INVOKE_TRACE message from the CN and if some activities have been started on the interfaces that have been requested to be traced. The RNC shall record those signalling messages in the interfaces that are defined in the list of interfaces parameter. Trace depth defines whether entire signalling messages or just some IEs needs to be recorded.\nThe RNC may not start a Trace Recording Session if there are insufficient resources available for the recording.\nWhen RNC starts a Trace Recording Session it shall assign a Trace Recording Session Reference for the Trace Recording Session.\nWhen several PLMNs are supported in the RAN, for starting Trace and management based MDT the RNC shall only select UEs where the pLMNTarget = PLMN identity that the UE includes in Initial Direct Transfer message 3GPP TS 25.331 [31].\n\nIn a SGSN/GGSN/BM-SC, a Trace Recording Session should start after the reception of a Trace Session Activation from EM and if any of the defined start triggering events occur. During the Trace Recording Session, the SGSN/GGSN/BM-SC shall record those signalling messages in the interfaces that are defined in the list of interfaces parameter. The Trace Depth parameter defines whether entire signalling messages or just some IEs need to be recorded.\nThe IMSI and IMEISV shall be available in the SGSN, in the GGSN and in the BM-SC for at least those connections which shall be traced.\nThe SGSN/GGSN/BM-SC may not start a Trace Recording Session if there are insufficient resources available for the recording.\nIf the SGSN/GGSN/BM-SC receives the Trace Session Activation during an established session (e.g. during an active PDP context or an active MBMS context), it may start the Trace Recording Session immediately. However, if any of the start triggering events occur in the SGSN/GGSN/BM-SC after receiving the Trace Session Activation, it shall start the Trace Recording Session.\nWhen a Trace Recording Session is started, the SGSN/GGSN/BM-SC shall assign a Trace Recording Session Reference for the Trace Recording Session.\nIn a MSC Server, a Trace Recording Session shall start after the reception of a Trace Session Activation from EM and if any of the defined start triggering events occur. During the Trace Recording Session, the MSC Server shall record those signalling messages in the interfaces that are defined in the list of interfaces parameter. The Trace Depth parameter defines whether entire signalling messages or just some IEs needs to be recorded.\nThe IMSI and the IMEISV shall be available in the MSC Server for at least those connections which shall be traced.\nThe MSC Server may not start a Trace Recording Session if there are insufficient resources available for the recording.\nIf the MSC Server receives the Trace Session Activation during an established call, it may start the Trace Recording Session immediately. However, if any of the start triggering events occurs in MSC Server after receiving the Trace Session Activation, it shall start the Trace Recording Session.\nWhen a Trace Recording Session is started, the MSC Server shall assign a Trace Recording Session Reference for the Trace Recording Session.\nIn E-UTRAN, after the Cell Traffic Trace has been activated in the monitored cell(s), the eNodeB shall start a Trace Recording Session for new call(s)/session(s) and for already existing call(s)/session(s) (events for existing call(s)/session(s) are not required to be recorded prior to the activation of the cell traffic trace). When the eNodeB starts a Trace Recording Session it shall allocate a Trace Recording Session Reference for the given call or session. The eNodeB shall send the allocated Trace Recording Session Reference, and the Trace Reference and the Trace Collection Entity IP Address in the CELL TRAFFIC TRACE message to the MME via the S1 connection.\nWhen MME receives this new S1 signalling message containing the Trace Recording Session Reference and Trace Reference, the MME shall look up the IMSI/IMEI(SV) of the given call from its database and shall send the IMSI/IMEI(SV) numbers together with the Trace Recording Session Reference and Trace Reference to the Trace Collection Entity.\nWhen several PLMNs are supported in the RAN, for starting Trace the eNB shall only select UEs where the pLMNTarget = selectedPLMN-Identity that the UE includes in RRCConnectionSetup message 3GPP TS 36.331 [32].\nThe format of the file sent to the TCE from the MME is defined in 3GPP TS 32.423 [3], clause A.2.2.\nThe figure 4.2.2.5.1 illustrates the procedure.\nThe figure depicts a layered network architecture with core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are shown in dashed lines, ensuring failover reliability. The layered design aligns with SDN principles.\nFigure 4.2.2.5.1\nIn a MME, SGW or PGW, a Trace Recording Session should start after the reception of a Trace Session Activation from EM and if any of the defined start triggering events occur. During the Trace Recording Session, the MME, SGW or PGW shall record those signalling messages in the interfaces that are defined in the list of interfaces parameter. The Trace Depth parameter defines whether entire signalling messages or just some IEs need to be recorded.\nThe IMSI and IMEISV shall be available in the MME and in the SGW for at least those connections which shall be traced.\nThe MME, SGW or PGW may not start a Trace Recording Session if there are insufficient resources available for the recording.\nIf the MME, SGW or PGW receives the Trace Session Activation during an established session (e.g. during an active PDP context), it may start the Trace Recording Session immediately. However, if any of the start triggering events occur in the MME, SGW or PGW after receiving the Trace Session Activation, it shall start the Trace Recording Session.\nWhen a Trace Recording Session is started, the MME, SGW or PGW shall assign a Trace Recording Session Reference for the Trace Recording Session.\nA trace recording session of immediate MDT or logged MDT or Logged MBSFN MDTshall be started in the eNodeB for each selected UE that satisfy the MDT UE selection criteria (i.e. capability condition), provided that a cell trace session for immediate MDT or logged MDT or Logged MBSFN MDT has been activated in the eNodeB from EM for the given cell(s) before.\nThe eNodeB shall configure the corresponding MDT RRC measurements at the selected UE.\nWhen several PLMNs are supported in the RAN for management based MDT, possibly combined with Trace, the eNB shall only select UEs where the pLMNTarget = selectedPLMN-Identity that the UE includes in RRCConnectionSetup message 3GPP TS 36.331 [32].\n\nThere is no starting mechanism at the UE for MDT trace recording sessions. The UE shall execute the received MDT measurement configuration. In case of logged MDT or Logged MBSFN MDT, the UE shall store the trace recording session parameters as received from the eNodeB.\nWhen several PLMNs are supported in the RAN, for starting logged MDT the UE shall only perform logging for the cells recived in the MDT measuerment configuration, if they are allowed as selected PLMNs.\nWhen several PLMNs are supported in the RAN, for starting Logged MBSFN MDT the UE shall only perform logging for the cells and MBSFN area received in the MDT measurement configuration, if they are allowed as selected PLMNs.\nIn an AF, AMF, AUSF, NEF, NRF, NSSF, PCF, SMF, SMSF, UPF or UDM, a Trace Recording Session should start after the reception of a Trace Session Activation from management system and if any of the defined start triggering events occur. During the Trace Recording Session, the AF, AMF, AUSF, NEF, NRF, NSSF, PCF, SMF, SMSF, UPF or UDM shall record those signalling messages in the interfaces that are defined in the list of interfaces parameter. The Trace Depth parameter defines whether entire signalling messages or just some IEs need to be recorded.\nThe SUPI and IMEISV shall be available in the AMF, SMF and in the PCF for at least those connections which shall be traced.\nThe AF, AMF, AUSF, NEF, NRF, NSSF, PCF, SMF, SMSF, UPF or UDM may not start a Trace Recording Session if there are insufficient resources available for the recording.\nIf the AF, AMF, AUSF, NEF, NRF, NSSF, PCF, SMF, SMSF, UPF or UDM receives the Trace Session Activation during an established session, it may start the Trace Recording Session immediately. However, if any of the start triggering events occur in the AF, AMF, AUSF, NEF, NRF, NSSF, PCF, SMF, SMSF, UPF or UDM after receiving the Trace Session Activation, it shall start the Trace Recording Session.\nWhen a Trace Recording Session is started, the AF, AMF, AUSF, NEF, NRF, NSSF, PCF, SMF, SMSF, UPF or UDM shall assign a Trace Recording Session Reference for the Trace Recording Session.\nIn NG-RAN, after the Cell Traffic Trace has been activated in the monitored cell(s), the NG-RAN node shall start a Trace Recording Session for new call(s)/session(s) and for already existing call(s)/session(s) (events for existing call(s)/session(s) are not required to be recorded prior to the activation of the cell traffic trace). When the NG-RAN node starts a Trace Recording Session it shall allocate a Trace Recording Session Reference (TRSR) for the given call or session. For file-based trace reporting, the NG-RAN node shall send the allocated Trace Recording Session Reference, the Trace Reference and the Trace Collection Entity IP Address in the CELL TRAFFIC TRACE message to the AMF via the NG connection. For streaming trace reporting, the NG-RAN node shall send the allocated Trace Recording Session Reference, the Trace Reference and the URI of the Trace Reporting MnS consumer in the CELL TRAFFIC TRACE message to the AMF via the NG connection.\nWhen AMF receives this new NG signalling message containing the Trace Recording Session Reference (TRSR) and Trace Reference (TR), the AMF shall look up the SUPI/IMEI(SV) of the given call from its database and shall send the SUPI/IMEI(SV) numbers together with the Trace Recording Session Reference and Trace Reference to the Trace Collection Entity in case of the file-based trace reporting, or to Trace Reporting MnS consumer in case of the streaming trace reporting.\nWhen several PLMNs are supported in the RAN, for starting Trace the NG-RAN node shall only select UEs where the pLMNTarget = selectedPLMN-Identity that the UE includes in RRCConnectionSetup message 3GPP TS 38.331 [43].\nIn case of NPN, when several NPNs are supported in the NG-RAN, for starting Trace the NG-RAN node shall only select UEs where the nPNTarget match the NPN that the UE includes in RRCConnectionSetup message 3GPP TS 38.331 [43].\nFor file-based trace reporting, the format of the file sent to the TCE from the AMF is defined in 3GPP TS 32.423, clause A.2.2.\nFor streaming trace reporting, the format of the AMF data sent to Trace Reporting MnS consumer is defined in 3GPP TS 32.423 [3].\nThe figure 4.2.2.10.1 illustrates the procedure for file-based trace reporting.\nThe figure depicts the NG-RAN trace starting mechanism, which includes file-based trace reporting, highlighting the importance of trace management in network operations.\nFigure 4.2.2.10.1: NG-RAN trace starting mechanism with file-based trace reporting\nThe figure 4.2.2.10.2 illustrates the procedure for streaming trace reporting.\nThe figure depicts the NG-RAN trace starting mechanism, which involves streaming trace reporting, highlighting the importance of real-time monitoring and trace reporting in network management.\nFigure 4.2.2.10.2: NG-RAN trace starting mechanism with streaming trace reporting\nA trace recording session of immediate MDT or logged MDT shall be started in the gNB for each selected UE that satisfy the MDT UE selection criteria (i.e. capability condition), provided that a cell trace session for immediate MDT or logged MDT has been activated in the gNB from management system for the given cell(s) before.\nThe gNB shall configure the corresponding MDT RRC measurements at the selected UE.\nWhen several PLMNs are supported in the RAN for management based MDT, possibly combined with Trace, the gNB shall only select UEs where the pLMNTarget = selectedPLMN-Identity that the UE includes in RRCConnectionSetup message 3GPP TS 38.331 [43].\nIn case of NPN, when several NPNs are supported in the NG-RAN, for starting Trace the NG-RAN node shall only select UEs where the nPNTarget match the NPN that the UE includes in RRCConnectionSetup message 3GPP TS 38.331 [43].\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.3\tStarting a trace recording session - signalling based",
                            "text_content": "In an RNC the Trace Recording Session will always be the same as the Trace Session as no triggering events are defined in UTRAN. Therefore a Trace Recording Session should be started in an SRNC when the SRNC receives the CN_INVOKE_TRACE message from the Core Network and if some activities have been started on the interfaces that have been requested to be traced.\nThe CN_INVOKE_TRACE message that is received from the Core Network (MSC Server or SGSN) contains the following information:\n-\tTrace Reference\n-\tTrace Target: UE identity (IMSI or IMEI(SV))\n-\tTrace Recording Session Reference\n-\tTrace Depth\n-\tList of Interfaces for RNC\n-\tJob Type\n-\tArea Scope\n-\tList of Measurements\n-\tReporting Trigger\n-\tReport Interval\n-\tReport Amount\n-\tEvent Threshold\n-\tLogging Interval\n-\tLogging Duration\n-\tTrace Collection Entity IP Address\n-\tMDT PLMN List\nNote that at the same time not all of the parameters can be present. The conditions which parameters shall be present is described in clause 5 of the present document.\nIf the Job Type parameter indicates MDT (e.g. Immediate or logged MDT is required) in the CN_INVOKE_TRACE message the RNC shall also configure MDT to the UE. The detailed mechanism of the MDT configuration to the UE is defined in TS 37.320 [30] and TS 25.331 [31].\nThe RNC shall send the following parameters to the UE in case of Logged MDT:\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tArea Scope\n-\tTCE Id (The value signalled as IP address of TCE is mapped to a TCE Id, using a configured mapping in the RNC).\n-\tLogging Interval\n-\tLogging Duration\n-\tMDT PLMN List\nIn case of Immediate MDT the RNC shall send the following parameters to the UE:\n-\tList of Measurements\n-\tReporting Trigger\n-\tReport Interval\n-\tReport Amount\n-\tEvent Threshold\nNote that at the same time not all of the parameters can be present. The conditions which parameters shall be present is described in clause 5 of the present document.\nIf the SRNC does not have enough resources it may not start a Trace Recording Session.\nThe Trace Recording Session Reference shall be the same as received in the CN_INVOKE_TRACE message.\nIn a DRNC the Trace Recording Session should be started when the DRNC receives the IUR_INVOKE_TRACE message. If the DRNC does not have enough resources it may not start a Trace Recording Session.\nThe Trace Session is activated to the RNC by sending a CN_INVOKE_TRACE message from the CN (MSC Server or SGSN). When RNC receives the CN_INVOKE_TRACE message it should immediately start a Trace Session and a Trace Recording Session according to the trace control and configuration parameters received in the CN_INVOKE_TRACE message.\nIf there are not enough resources in RNC to start a Trace Recording Session, the RNC may reject to start a Trace Recording Session. However the RNC shall start the Trace Session. Session and if MDT activation is requested shall activate the MDT to the UE.\nWhen SRNC/DRNC receives the trace control and configuration parameters:\n-\tIf the Trace Reference is the same as an existing Trace Session for the same subscriber or equipment in SRNC/DRNC, the SRNC/DRNC shall not activate a new Trace Session and the existing Trace Session will not be impacted;\n-\tIf the Trace Recording Session Reference is the same as an existing Trace Recording Session in the existing Trace Session having the same Trace Reference, the SRNC/DRNC shall not start a new Trace Recording Session;\n-\tIf the trace control and configuration parameters are received from the same CN domain (CS/PS) as the existing Trace Recording Session(s) if any, and the Trace Recording Session Reference is not the same as any existing Trace Recording Session(s) in the existing Trace Session having the same Trace Reference, the SRNC/DRNC shall start a new Trace Recording Session;\n-\tIf the trace control and configuration parameters are received from different CN domain (CS/PS) as the existing Trace Recording Session(s) if any (i.e. the RNC has simultaneoud CS and PS connection and CN_INVOKE_TRACE is received from both connection), regardless of the Trace Recording Session Reference is the same or not as any existing Trace Recording Session(s) in the existing Trace Session having the same Trace Reference, the SRNC shall not start a new Trace Recording Session;\n-\tIf the Trace Reference is the same as an existing Trace Session for different subscriber(s) or equipment(s) in SRNC/DRNC, the SRNC /DRNC shall not activate a new Trace Session, and the SRNC/DRNC shall not start a new Trace Recording Session.\nThe following figure shows an example for a CS call how the Trace Session is activated to RNC. In the example it is assumed that there is no PS connection at all during the CS call.\nThe figure depicts a trace recording session in UTRAN, a signaling protocol used in 5G networks. It illustrates the process of starting a trace recording session, which is essential for network monitoring and troubleshooting. The figure shows the various components involved, such as the signaling protocol, the trace recorder, and the network interface controller (NICA). The visual representation of the trace recorder and the network interface controller highlights the importance of these components in ensuring the smooth operation of the network.\nFigure 4.2.3.1.1: Starting a Trace Recording Session (Signalling) in UTRAN\nInteraction with soft-handovers\nIf the subscriber or equipment, which is traced, makes a soft handover the SRNC should propagate the trace control and configuration parameters (including MDT specific parameters if they are available) further to the DRNC by using the IUR_INVOKE_TRACE message. When the DRNC receives the IUR_INVOKE_TRACE message it should immediately start a Trace Session and a Trace Recording Session according to the trace control and configuration parameters received in the IUR_INVOKE_TRACE message.\nIf there are insufficient resources in the DRNC, the DRNC may not start a Trace Recording Session.\nThe Trace Recording Session Reference sent by the SRNC to the DRNC shall be the same what SRNC has received in the CN_INVOKE_TRACE message from the CN.\nInteraction with Relocation\nIf the tracing shall continue also after the relocation has been performed, the CN Invoke Trace procedure shall be re-initiated from the CN towards the future SRNC after the Relocation Resource Allocation procedure has been executed successfully.\nIn SGSN/GGSN/BM-SC a Trace Recording Session should start after the reception of a Trace Session Activation message (in SGSN it is the MAP-ACTIVATE_TRACE_MODE, in GGSN it is the GTP-Create PDP Context request or Update PDP Context request, in BM-SC it is the Diameter Gmb AAR message) and if any of the defined start triggering events occur. During the Trace Recording Session, the SGSN/GGSN/BM-SC shall record the signalling messages in the interfaces that are defined in the list of interfaces parameter. The Trace Depth parameter defines whether entire signalling messages or just some IEs need to be recorded.\nThe SGSN/GGSN/BM-SC may not start a Trace Recording Session if there are insufficient resources available for the recording.\nIn case of an established session, the SGSN may start the Trace Recording Session immediately after the reception of the Trace Session Activation message. However, if any of the start triggering events occurs in SGSN after receiving the Trace Session activation message, it shall start the Trace Recording.\nWhen a Trace Recording Session is started in SGSN, it shall assign a Trace Recording Session Reference for the Trace Recording Session. When the SGSN propagates the Trace control and configuration parameters to GGSN or to UTRAN (I.e. activates a Trace Session in GGSN/UTRAN), it shall include the assigned Trace Recording Session Reference in the Trace Session Activation message. When an SGSN starts a Trace Recording Session and the list of NE types parameter requires GGSN tracing, it shall send the GTP- Update PDP Context Request or Create PDP Context Request message for activating the Trace Session to GGSN. When a GGSN starts a Trace Recording Session and the list of NE types parameter requires BM-SC tracing, it shall send a Diameter Gmb AAR message to the BM-SC in order to activate a Trace Session in the BM-SC. Also, when an SGSN starts a Trace Recording Session and the list of NE types parameter requires RNC tracing, it shall send the CN_INVOKE_TRACE message to the RNC in order to activate a Trace Session in RNC. In both cases the Trace Session and the Trace Recording Session in the receiving NE should start at the same time.\nIn case of SRNS relocation the SGSN shall send the CN_INVOKE_TRACE message to the new SRNC after the successful Relocation Resource Allocation procedure.\nSGSN has to find the identity of the mobile before it activates a Trace Session towards other NE. The IMEI(SV) can be got from the  by using the Identification procedure on the Iu interface.\nWhen the SGSN sends the Trace Session activation (CN_INVOKE_TRACE) message to RNC it shall include the following parameters to the message:\n-\tTrace Target: IMSI or IMEI (SV) (M).\n-\tTrace Reference (M).\n-\tTrace Recording Session Reference (M).\n-\tTrace Depth (M).\n-\tList of Interfaces (O).\n-\tTrace Collection Entity IP Address (O).\nIn MSC Server/MGW a Trace Recording Session should start after the reception of a Trace Session Activation message (MAP-ACTIVATE TRACE MODE in MSC Server and ADD/MOD command with Trace package in MGW) and if any of the defined start triggering events occur. During the Trace Recording Session the MSC Server/MGW shall record the signalling messages in the interfaces that are defined in the list of interfaces parameter. The Trace Depth parameter defines whether entire signalling messages or just some IEs need to be recorded.\nThe MSC Server may not start a Trace Recording Session if there are insufficient resources available for the recording.\nIn case of an established call, the MSC Server may start the Trace Recording Session immediately after the reception of the MAP-ACTIVATE_TRACE_MODE message. However, if any of the start triggering events occur in the MSC Server after receiving the Trace Session activation message, it shall start the Trace Recording Session.\nWhen a Trace Recording Session is started in MSC Server, it shall assign a Trace Recording Session Reference for the Trace Recording Session. When the MSC Server propagates the Trace control and configuration parameters to MGW or to UTRAN (I.e. activates a Trace Session in MGW/UTRAN) it shall include the assigned Trace Recording Session Reference in the Trace Session Activation message.\nWhen an MSC Server starts a Trace Recording Session and the list of NE types parameter requires MGW tracing, it shall send the ADD/MOD command with trace package to MGW in order to activate the trace in MGW. Also, when an MSC Server starts a Trace Recording Session and the list of NE types parameter requires RNC tracing, it shall send the CN_INVOKE_TRACE message to the RNC. In both cases the Trace Session and the Trace Recording Session in the receiving NE should start at the same time.\nMSC Server has to find the identity of the mobile before it activates a Trace Session towards other NE. The IMEI(SV) can be got from the  by using the Identification procedure on the Iu interface.\nIn case of SRNS relocation the MSC Server shall send the CN_INVOKE_TRACE message to the new SRNC after the successful Relocation Resource Allocation procedure. The following figure shows an example how the Trace Session is activated with CN_INVOKE_TRACE message in case of relocation.\nThe figure depicts a trace recording session in the CS domain, illustrating the process of initiating a recording session in the communication system. The session is initiated by a signal from the transmitter, which is then transmitted to the receiver, where it is received by the receiver. The receiver then processes the signal and sends it back to the transmitter, which initiates the recording session. The session is initiated by a signal from the transmitter, which is then transmitted to the receiver, where it is received by the receiver. The receiver then processes the signal and sends it back to the transmitter, which initiates the recording session. The session is initiated by a signal from the transmitter, which is then transmitted to the receiver, where it is received by the receiver. The receiver then processes the signal and sends it back to the transmitter, which initiates the recording session. The session is initiated by a signal from the transmitter, which is then transmitted to the receiver, where it is received by the receiver. The receiver then processes the signal and sends it back to the transmitter, which initiates the recording session. The session is initiated by a signal from the transmitter, which is then transmitted to the receiver, where it is received by the receiver. The receiver then processes the signal and sends it back to the\nFigure 4.2.3.3.1: Starting a Trace Recording Session (Signalling) in CS Domain\nWhen the new SRNC receives the CN_INVOKE_TRACE message it should start immediately a Trace Session and a Trace Recording session according to the trace control and configuration parameters received in the CN_INVOKE_TRACE message. The Trace Session shall automatically be deactivated in the old RNC when the Iu connection is released.\nWhen the MSC Server sends the Trace Session activation (CN_INVOKE_TRACE) message to RNC it shall include the following parameters to the message:\n-\tTrace Target: IMSI or IMEI (SV) (M).\n-\tTrace Reference (M).\n-\tTrace Recording Session Reference (M).\n-\tTrace Depth (M).\n-\tList of Interfaces to trace (O).\n-\tTrace Collection Entity IP Address (O).\nA trace recording session should start when there is an active trace session and when an appropriate start triggering event occurs. Figure 4.2.3.5.1.1 illustrates the initiation of a trace recording session at the UE, P-CSCF and S-CSCF within an originating network when any of the defined triggering events as defined in Trace Session Activation occur. When a triggering event occurs in the UE (Step 1) it includes in the outgoing SIP (service) signalling message a service level tracing Start Triggering Event (Step 2) and starts a trace recording session (Step 3). When the P-CSCF receives the SIP (service) signalling message containing the Start Triggering Event it authenticates the received Start Triggering Event (step 4) and starts its trace recording session (Step 5). The P-CSCF forwards the SIP (service) signalling message containing the Start Triggering Event to the S-CSCF (Step 7) and starts its trace recording session (Step 8).\nThe figure depicts a trace recording session within an originating network, with various components highlighted such as the network interface controller (NIC), network interface module (NIM), and network management system (NMS). The session is initiated by the NIC, which initiates the trace recording process. The NIM and NMS are responsible for managing the trace recording session, ensuring its proper functioning and compliance with network policies.\nFigure 4.2.3.5.1.1a: Starting a Trace Recording Session within originating network\nFigure 4.2.3.5.1.2 illustrates the initiation of a trace recording session at the AS, I-CSCF, HSS, S-CSCF, P-CSCF and UE within the terminating network when any of the defined triggering events as defined in Trace Session Activation occur.\nNOTE:\tAll origination, termination and S-CSCF to CSCF procedures as described in 3GPP TS 23.228 [15] apply.\nThe figure depicts a trace recording session within a terminating network, illustrating the process of starting a trace recording session. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated by a device. The session is initiated by a user, and the recording is initiated\nFigure 4.2.3.5.1.1b: Starting a Trace Recording Session within terminating network\nWhen S-CSCF#1 receives the SIP (service) signalling message containing the Service Level Tracing Start Trigger Event (step 7) it shall start a trace recording session (Step 8). Based on the service control information (step 10) S-CSCF#1 forwards the SIP (service) signalling message containing the Start Trigger Event to the Application Server (Step 11).\nOn reception of the SIP INVITE the Application Server adds, removes, or modifies the header contents contained in the SIP INVITE (see 3GPP TS 23.218) and proxies the SIP INVITE together with the Start Trigger Event back to S-CSCF#1 (Step 14). The Application Server also starts a trace recording session (Step 12).\nS-CSCF#1 forwards the SIP INVITE containing the service level tracing Start Trigger Event request to I-CSCF#2 (Step 15). At this point the I-CSCF starts a trace recording session Step 16).\nI-CSCF#2 initiates a query to the HSS for the current location of the terminating user (UE#2) and includes in the Cx-User Location procedure the service level tracing Start Trigger Event (Step 20).\nWhen the HSS receives the query for the current location and an associated Start Trigger Event it shall start a trace recording session (Step 19) and returns to the I-CSCF#2 the address of the current S-CSCF (S-CSCF#2) for the terminating user and the service level tracing Start Trigger Event (20).\nI-CSCF#2 forwards the SIP INVITE containing the Start Trigger Event to the S-CSCF (S-CSCF#2) that will handle the session termination. When the S-CSCF receives the SIP INVITE containing the Start Trigger Event it starts a trace recording session (Step 21).\nThe S-CSCF forwards the SIP INVITE containing the Start Trigger Event to the P-CSCF (P-CSCF#2). When the P-CSCF receives the SIP INVITE containing the Start Trigger Event it starts a trace recording session (Steps 24 and 25).\nThe P-CSCF forwards the SIP INVITE containing the Start Trigger Event to the terminating UE (UE#2). When the terminating UE receives the SIP INVITE containing the Start Trigger Event it starts a trace recording session (Step 28).\nThe continuation of the termination procedures is as defined in 3GPP TS 23.228 [15].\nFor a UE that has an active trace session (see subclause 4.1.2.9.4) one or more trace recording session(s) (e.g. to allow the tracing for several different simultaneous services) shall be started when any of the defined triggering events occur at the UE, and when the condition(s) as defined by the trace control and configuration parameters within the received management operation occur.\n\nA Trace recording session(s) may be initiated at an originating UE when:\n1)\tThe UE detects the initiation of the specified service to be traced. The service may be initiated either by the end user or by an application.\nThe triggering events at a terminating UE include:\n1)\tThe UE detects the initiation of the specified service to be traced. The service may be initiated either by the end user or by an application.\n2)\tThe UE detects the reception of an incoming SIP message containg the service level tracing Start Triggering Event.\nA Trace recording session(s) may be initiated at a UE (both originating and terminating) when it detects a start trigger event initiated directly by the Device Management server for the purpose of allowing not only SIP information related to the service to be traced, but also information relating to the processes performed by the UE to support the initialization of the service.\nUpon the detection of a triggering event the UE shall include in the appropriate outgoing SIP (service) signalling message (i.e. the outgoing signalling messages associated with the service to be traced) a service level tracing Start Triggering Event.\nFor an IMS NE (i.e. S/I/P-CSCF, AS, HSS, MRF, MGCF, BGCF) that has an active trace session (see subclause .9) a trace recording session should be started when it receives in an incoming SIP (service) signalling message or DIAMETER signalling message containing a service level tracing Start Triggering Event and when the information contained within the service level tracing Start Triggering Event matches the information received by the IMS NE during trace session activation. The IMS NE shall also start the recording of signalling messages in the interfaces that are defined in the list of received interfaces parameter.\nAn IMS NE (i.e. S/I/P-CSCF, AS, HSS, MRF, MGCF, BGCF) that receives an incoming SIP (service) signalling message containing a service level tracing Start Triggering Event should forward in an appropriate outgoing SIP (service) signalling message (i.e. outgoing signalling messages associated with the service being traced) the same service level tracing Start Triggering Event (i.e. service level tracing Start Triggering Event with the same Trace Reference).\nWhen an IMS NE has an active trace session and trace recording session, and when an incoming SIP (service) signalling message is part of an existing dialog or standalone transaction and contains a service level tracing Start Trigger Event the IMS NE shall determine that an active Trace Recording Session exists and shall not start a new Trace Recording Session.\nDepending on operator policy, a HSS may forward the service level tracing Start Triggering Event to an external AS (see 3GPP TS 23.218 [14]). In the case of a terminating session a S-CSCF or I-CSCF may forward the service level tracing Start Triggering Event to a P-CSCF in a visited IM CN SS. A P-CSCF shall send a service level tracing Start Triggering Event to a terminating UE.\nWhen a P-CSCF receives a SIP (service) signalling message containing a service level tracing Start Triggering Event from a UE it shall authenticate the Start Triggering Event by comparing the information contained within the received service level tracing Start Triggering Event (see subclause 5.2) either against the information it received within the Start Trace activation message or by requesting information from the I-CSCF or S-CSCF. If the received service level tracing Start Triggering Event is authenticated by the P-CSCF it should start a trace recording session and shall forward the service level tracing Start Triggering Event in the appropriate outgoing SIP (service) signalling message.\nIf the authentication of the incoming service level tracing Start Triggering Event fails the P-CSCF shall not start a trace recording session and shall not forward the service level tracing Start Triggering Event in any outgoing SIP (service) signalling message. The P-CSCF should provide an indication to the Management System following the unsuccessful authentication of the service level tracing Start Triggering Event.\nWhen an IMS NE does not have an active trace session when it receives an incoming SIP (service) signalling message that contains a service level tracing Start Trigger Event, the IMS NE shall not initiate a Trace Recording Session and should forward in an appropriate outgoing SIP (service) signalling message the same service level tracing Start Trigger Event.\nCharging for Service Level Tracing for IMS shall be fulfilled using IMS charging mechanism as specified in TS 32.240 [19] and TS 32.260 [20].\nIt shall be possible to apply specific tariffs (e.g. zero rating) to the bearer and/or signalling traffic associated with services subjected to Service Level Tracing for IMS.\nAs described in subclause 4.2.3.5 an IMS NE that has an active trace session should start a trace recording session when it detects a service level tracing Start Triggering Event. An IMS NE shall also provide an indication in the generated charging information that service level tracing has been applied.\nIn an eNB the Trace Recording Session will always be the same as the Trace Session as no triggering events are defined in eNB.\nTracing starts immediately at eNodeB upon reception of the trace control and configuration parameters. The eNodeB may not start a Trace Recording Session if there are insufficient resources available for the recording, however, the eNodeB shall store the trace control and configuration parameters, and forward these parameters when the UE handovers to other eNBs over X2.\nThe Trace Recording Session shall be started at the eNB when it receives trace control and configuration parameters via one of the following messages:\n1)\tvia an S1-Initial Context Setup Request message from the MME in response to an S1-Initial UE Message\n2)\tvia an S1-Trace Start message from the MME in response to an S1-Initial UE Message or when an established S1AP connection exists\n3)\tvia an S1-Handover Request message from the target MME as part of intra/inter-MME handover procedures via S1\n4)\tvia an X2-Handover Request message from a source eNodeB as part of inter-eNodeB handover procedures via X2\nThere can only be one Trace Recording Session Reference per Trace Reference at one given time for a UE trace session. So there shall be only one TR/TRSR to be propagated during S1 and X2 handover.\nIf the Trace Reference is the same as an existing Trace Session for the same subscriber or equipment, and the Trace Recording Session Reference is the same as the existing Trace Recording Session in the existing Trace Session having the same Trace Reference, the eNB shall not start a new Trace Recording Session and shall continue with the existing trace session and ignore the second request.\nIf the Trace Reference is the same as an existing Trace Session for the same subscriber or equipment, and the Trace Recording Session Reference is not the same as the existing Trace Recording Session in the existing Trace Session having the same Trace Reference, the eNB shall continue with the existing trace session and ignore the second request.\nIn MME/SGW/PGW a Trace Recording Session should start after the reception of a Trace Session Activation message and if any of the defined start triggering events occur. During the Trace Recording Session, the MME/SGW/PGW shall record the signalling messages in the interfaces that are defined in the list of interfaces parameter. The Trace Depth parameter defines whether entire signalling messages or just some IEs need to be recorded.\nThe MME/SGW/PGW may not start a Trace Recording Session if there are insufficient resources available for the recording.\nIn case of an established session, the MME/SGW/PGW may start the Trace Recording Session immediately after the reception of the trace control and configuration parameters. However, if any of the start triggering events occurs in MME/SGW/PGW after receiving the trace control and configuration parameters, it shall start the Trace Recording Session.\nIn the case of the triggering events come into collision on the same traced UE as defined in 3GPP TS 24.301[33], the MME shall not start a new Trace Recording Session for the later event(s), and shall use the existing Trace Recording Session and Trace Recording Session Reference to continuing the trace recording for these events until one stop triggerring event occurs.\nMME shall start a Trace Recording Session for a certain Trace Session  only if there is no ongoing Trace Recording Session for this Trace Session. i.e. at any given time, there can be a maximum of one Trace Recording Session for a certain Trace Session.\nWhen a Trace Recording Session is started in MME, it shall assign a Trace Recording Session Reference for the Trace Recording Session. When the MME propagates the Trace control and configuration parameters to E-UTRAN (i.e. activates a Trace Session in eNB), it shall include the assigned Trace Recording Session Reference in the Trace Session Activation message.\nAlso, when an MME starts a Trace Recording Session and the list of NE types parameter requires eNB tracing, it shall propagate the trace control and configuration parameters including the Trace Recording Session Reference via the S1 interface to the eNodeB per one of the following messages:\n1)\tif an S1 connection exists, via the S1-Trace Start message\n2)\tif the S1 connection does not exist, via the S1-Trace Start message prior to S1 connection setup, or via the S1-Initial Context Setup Request message during S1 connection setup\n3)\tduring intra/inter-MME handover over S1, via the S1-Handover Request message\nIn above cases the Trace Session and the Trace Recording Session in the receiving NE should start at the same time\nIf all events are set in the triggering event parameter at the MME, MME shall send Trace Session Activation message to eNB not only when the MME starts the Trace Recording Session, but also when an Intra-MME handover happens. In this case the MME shall send Trace Session activation to the target eNB via the S1-Handover Request message..\nNOTE: \tIn case of \"UE-Initiated Detach Procedure with UE camping on GERAN/UTRAN and ISR activated / SGSN-Initiated Detach Procedure with ISR activated\",\n Trace is not activated in eNB.\nIn the MME, no trace recording sessions are started for MDT trace sessions. The MME sends the trace session activation to the eNodeB with parameters as specified in 4.1.2.12.\nA trace recording session of either immediate or logged MDT or Logged MBSFN MDT shall be started in the eNodeB for a given UE when a trace session activation request is received from the MME for the UE and the MDT UE selection conditions are satisfied for the UE. The eNodeB shall configure the corresponding MDT RRC measurements at the UE. If selection conditions are not satisfied, the eNodeB shall store the trace control and configuration parameters, and forward these parameters when the UE handovers to other eNBs over X2 or S1.\nIf the eNodeB receives a Signalling Based MDT activation request when the UE is served by a cell that is in the eNodeB but not in the MDT area scope then the eNodeB shall store the MDT configuration and configure the UE when the UE moves to a cell in the eNodeB (intra eNodeB handover) that satisfies the area scope in the request.\nThere is no starting mechanism at the UE for MDT trace recording sessions. The UE shall execute the received MDT measurement configuration. In case of logged MDT or Logged MBSFN MDT,, the UE shall store the trace recording session parameters as received from the eNodeB.\nIn AMF, PCF, SMF or UPF a Trace Recording Session should start after the reception of a Trace Session Activation message and if any of the defined start triggering events occur. During the Trace Recording Session, the AMF, PCF, SMF or UPF shall record the signalling messages in the interfaces that are defined in the list of interfaces parameter. The Trace Depth parameter defines whether entire signalling messages or just some IEs need to be recorded.\nThe AMF, PCF, SMF or UPF may not start a Trace Recording Session if there are insufficient resources available for the recording.\nIn case of an established session, the AMF, PCF, SMF or UPF may start the Trace Recording Session immediately after the reception of the trace control and configuration parameters. However, if any of the start triggering events occurs in AMF, PCF, SMF or UPF after receiving the trace control and configuration parameters, it shall start the Trace Recording Session.\nIn the case of the triggering events come into collision on the same traced UE as defined in 3GPP TS 24.501[45], the AMF shall not start a new Trace Recording Session for the later event(s), and shall use the existing Trace Recording Session and Trace Recording Session Reference to continuing the trace recording for these events until one stop triggerring event occurs.\nAMF shall start a Trace Recording Session for a certain Trace Session  only if there is no ongoing Trace Recording Session for this Trace Session. i.e. at any given time, there can be a maximum of one Trace Recording Session for a certain Trace Session.\nWhen a Trace Recording Session is started in AMF, it shall assign a Trace Recording Session Reference for the Trace Recording Session. When the AMF propagates the Trace control and configuration parameters to NG-RAN (i.e. activates a Trace Session in NG-RAN node), it shall include the assigned Trace Recording Session Reference in the Trace Session Activation message.\nAlso, when an AMF starts a Trace Recording Session and the list of NE types parameter requires NF-RAN node tracing, it shall propagate the trace control and configuration parameters including the Trace Recording Session Reference via the NG interface to the NG-RAN node per one of the following messages:\n1)\tif an NG connection exists, via the NG-Trace Start message\n2)\tif the NG connection does not exist, via the NG-Trace Start message prior to NG connection setup, or via the NG-Initial Context Setup Request message during NG connection setup\n3)\tduring intra/inter-AMF handover over NG, via the NG-Handover Request message\nIn above cases the Trace Session and the Trace Recording Session in the receiving NE should start at the same time\nIf all events are set in the triggering event parameter at the AMF, AMF shall send Trace Session Activation message to NG-RAN node not only when the AMF starts the Trace Recording Session, but also when an Intra-AMF handover happens. In this case the AMF shall send Trace Session activation to the target NG-RAN node via the NG-Handover Request message.\nIn a NG-RAN node the Trace Recording Session will always be the same as the Trace Session as no triggering events are defined in NG-RAN node.\nTracing starts immediately at NG-RAN node upon reception of the trace control and configuration parameters Trace Activation IE). The NG-RAN node may not start a Trace Recording Session if there are insufficient resources available for the recording, however, the NG-RAN node shall store the trace control and configuration parameters, and forward these parameters when the UE handovers to other NG-RAN nodes over Xn or when other NG-RAN node retrieves the UE Context over Xn.\nThe Trace Recording Session shall be started at the NG-RAN node when it receives trace control and configuration parameters via one of the following messages:\n1)\tvia an INITIAL CONTEXT SETUP REQUEST message over NG from the AMF\n2)\tvia a TRACE START message over NG from the AMF. If no UE-associated logical NG-connection exists, the UE-associated logical NG-connection will be established as part of the Trace Start procedure.\n3)\tvia an NG HANDOVER REQUEST message from the target AMF as part of intra/inter-AMF handover procedures via NG.\n4)\tvia an Xn HANDOVER REQUEST message from a source NG-RAN node as part of inter-NG-RAN node handover procedures via Xn\n5)\tvia an Xn RETRIEVE UE CONTEXT RESPONSE message from old NG-RAN node after been sent to RRC_INCTIVE and then establishing RRC Connection to a new NG-RAN node\nThere can only be one Trace Recording Session Reference per Trace Reference at one given time for a UE trace session. So there shall be only one TR/TRSR to be propagated during NG and Xn handover.\nIf the Trace Reference is the same as an existing Trace Session for the same subscriber or equipment, and the Trace Recording Session Reference is the same as the existing Trace Recording Session in the existing Trace Session having the same Trace Reference, the NG-RAN node shall not start a new Trace Recording Session and shall continue with the existing trace session and ignore the second request.\nIf the Trace Reference is the same as an existing Trace Session for the same subscriber or equipment, and the Trace Recording Session Reference is not the same as the existing Trace Recording Session in the existing Trace Session having the same Trace Reference, the NG-RAN node shall continue with the existing trace session and ignore the second request.\nThere is no starting mechanism in 5GC for signalling based MDT as no trace recording sessions are started for MDT trace sessions in AMF.\nA trace recording session of either immediate or logged MDT shall be started in the gNB for a given UE when a trace session activation request is received from the AMF for the UE and the MDT UE selection conditions are satisfied for the UE. The gNB shall configure the corresponding MDT RRC measurements at the UE. If selection conditions are not satisfied, the gNB shall store the trace control and configuration parameters and forward these parameters when the UE handovers to other gNBs over Xn or N2.\nIf the gNB receives a signalling based MDT activation request when the UE is served by a cell that is in the gNB but not in the MDT area scope then the gNB shall store the MDT configuration and configure the UE when the UE moves to a cell in the gNB (intra gNB handover) that satisfies the area scope in the request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.4\tStopping a trace recording session - management based",
                            "text_content": "The Trace Recording Session in the RNC shall be stopped when the last connection, which belongs to the traced subscriber/mobile, is released.\nIn SGSN, GGSN and BM-SC a Trace Recording Session shall be stopped when any of the defined stop triggering events occur. If Trace Session deactivation is received during the Trace Recording Session, the SGSN is allowed to finish tracing of the on-going procedures (e.g. session). In this case the Trace Recording Session shall be stopped between the reception of the Trace Session deactivation and the appropriate stop-triggering event.\nThe following figure illustrates the successful case in tracing a PDP context when a Trace Recording Session is stopped.\nThe figure depicts a graphical representation of a PDP context (Management Based) in the PS domain, specifically focusing on the process of stopping a trace recording session. The figure includes various elements such as the PDP context, the PDP context manager, the PDP context manager's interface, and the PDP context manager's interface's interface. The figure also includes a visual representation of the PDP context manager's interface, which shows the various options and controls available for managing the PDP context. The figure is a useful tool for understanding the process of stopping a trace recording session in a PDP context and provides a clear and concise visual representation of the process.\nFigure 4.2.4.2.1: Stopping a Trace Recording Session for a PDP Context (Management Based) - PS domain\nThe following figure illustrates the successful case in tracing a MBMS context when a Trace Recording Session is stopped.\nThe figure depicts a diagram illustrating the process of stopping a trace recording session for a Management Based (MBMS) context in the PS domain. The figure shows the various components involved in the session, such as the MBMS context, the trace recorder, and the associated software. The diagram highlights the steps involved in stopping the session, including the selection of the context, the initiation of the session, and the termination of the session. The figure provides a clear and concise visual representation of the process, making it easy to understand and follow.\nFigure 4.2.4.2.2: Stopping a Trace Recording Session for a MBMS Context (Management Based) - PS domain\n\nIn MSC Server a Trace Recording Session shall be stopped when any of the defined stop triggering events occur. If Trace Session deactivation is received during the Trace Recording Session, the MSC Server is allowed to finish tracing of the on-going procedures (e.g. calls). In this case the Trace Recording Session shall be stopped in MSC Server between the reception of the Trace Session deactivation and the appropriate stop-triggering event.\nThe following figure illustrates the successful case in tracing a call and the time of stopping a Trace Recording Session.\nThe figure depicts a stop trace recording session in the CS domain, with a focus on the management-based approach. It illustrates the process of stopping a trace recording session, highlighting the steps involved in managing the session, such as initiating the session, stopping it, and managing the session logs. The figure also includes a visual representation of the session, showing the status of the session, the status of the recording, and the status of the recording log.\nFigure 4.2.4.3.1: Stopping a Trace Recording Session (Management Based) - CS domain\n\nThe Trace Recording Session in the eNodeB shall be stopped when the call/session is ended in the cell under trace or the call/session is haneded over to another cell. If the Trace Session is deactivated at a time when there are ongoing sessions the trace recording session may be stopped immediately or gracefully when the session ends.\nIn MME, SGW and PGW a Trace Recording Session shall be stopped when any of the defined stop triggering events occur. If Trace Session deactivation is received from its EM during the Trace Recording Session, the MME, SGW and PGW are allowed to finish tracing of the on-going procedures (e.g. session). In this case the Trace Recording Session shall be stopped between the reception of the Trace Session deactivation and the appropriate stop-triggering event.\nIn case of immediate MDT, the eNodeB shall stop a trace recording session for a given UE when the UE changes cell or goes to idle mode or when the cell trace session is deactivated at the eNodeB from its EM. The eNodeB shall deactivate the corresponding MDT RRC measurements in the UE.\nIn case of logged MDT or Logged MBSFN MDT,, there is no stopping mechanism in the eNodeB. The eNodeB does not need to maintain a logged MDT or Logged MBSFN MDT, trace recording session once it has been configured in the UE.\nIn case of logged MDT or Logged MBSFN MDT,, the UE shall stop an ongoing trace recording session when logging duration expires and it shall indicate the availability of logged measurement results to the network next time it enters connected mode.\nThe UE shall discard an ongoing logged MDT trace recording session when it receives a new logged MDT or Logged MBSFN MDT, trace recording session configuration from the network.\nThe UE shall discard an ongoing Logged MBSFN MDT trace recording session when it receives a new logged MDT or Logged MBSFN MDT trace recording session configuration from the network.\nIn AF, AMF, AUSF, NEF, NRF, NSSF, PCF, SMF, SMSF, UPF or UDM a Trace Recording Session shall be stopped when any of the defined stop triggering events occur. If Trace Session deactivation is received from its management system during the Trace Recording Session, the AF, AMF, AUSF, NEF, NRF, NSSF, PCF, SMF, SMSF, UPF or UDM are allowed to finish tracing of the on-going procedures (e.g. session). In this case the Trace Recording Session shall be stopped between the reception of the Trace Session deactivation and the appropriate stop-triggering event.\nThe Trace Recording Session in the NG-RAN node shall be stopped when the call/session is ended in the cell under trace or the call/session is haneded over to another cell. If the Trace Session is deactivated at a time when there are ongoing sessions the trace recording session may be stopped immediately or gracefully when the session ends.\nIn case of immediate MDT, the gNB shall stop a trace recording session for a given UE when the UE changes cell or goes to idle mode or inactive state or when the cell trace session is deactivated at the gNB from its NG-RAN management system The gNB shall deactivate the corresponding MDT RRC measurements in the UE.\nIn case of logged MDT, there is no stopping mechanism in the gNB. The gNB does not need to maintain a logged MDT, trace recording session once it has been configured in the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.5\tStopping a trace recording session - signalling based",
                            "text_content": "In an RNC the Trace Recording Session will always be the same as the Trace Session as no triggering events are defined in UTRAN. Therefore a Trace Recording Session shall always be stopped in an RNC when the RNC deactivates the Trace Session. For more information on Trace Session deactivation in UTRAN see subclause 4.1.4.2.\nA Trace Recording Session shall be stopped when the SGSN/GGSN/BM-SC detect any of the stop triggering events.\nHowever, if a SGSN receives a Trace Session deactivation either from its EM (in case of tracing roaming subscribers) or from HSS (in case of tracing home subscribers) during an ongoing Trace Recording Session, it may stop it immediately or at any time until the occurrence of an appropriate stop-triggering event.\nA GGSN shall stop a Trace Recording Session when it receives a Trace Session deactivation message (GTP- Update PDP Context Request and Trace Activity Control is set to Trace Deactivation )from the SGSN or at any time until the occurrence of an appropriate stop-triggering event.\nA BM-SC shall stop a Trace Recording Session when it receives a Diameter Gmb STR message from the GGSN or at any time until the occurrence of an appropriate stop-triggering event.\nWhen a Trace Recording Session is stopped in a SGSN, the SGSN shall send a Trace Session deactivation message to the NEs where tracing was required, as defined in the \"List of NE types\" configuration parameter, received in the Trace Session activation message. The Trace Reference, used for the deactivation procedure, shall be the same as used in the SGSN for the activation of the Trace Session.\nThe following figure illustrates a successful case in tracing a PDP context, when a Trace Recording Session is stopped. (Reference 3GPP TS 23.060 [6].)\nThe figure depicts a 5G network with various components such as base stations (gNB), user equipment (UE), and scatterers. The diagram highlights the importance of beamforming techniques to mitigate interference and the use of redundant paths for failover reliability. The fiber-optic backbone architecture is shown with core switches, optical line terminals (OLTs), and distributed nodes, aligning with SDN principles.\nNOTE:\tThe activation to SGSN can come from EM-SGSN (in the figure just EM) or from the HSS.\n\nFigure 4.2.5.2.1: Stopping a Trace Recording Session for a PDP Context (Signalling based) - PS domain\nThe following figure illustrates a successful case in tracing a MBMS context, when a Trace Recording Session is stopped. (Reference 3GPP TS 23.246 [9].)\nThe figure depicts a diagram illustrating the process of stopping a trace recording session for a MBMS context in the PS domain. It shows the various components involved, such as the MBMS context, the trace recording session, and the PS domain. The figure provides a visual representation of the steps involved in stopping the session, ensuring that the process is clear and understandable.\nFigure 4.2.5.2.2: Stopping a Trace Recording Session for a MBMS Context (Signalling based) - PS domain\n\nA Trace Recording Session shall be stopped when the MSC Server and MGW detect any of the stop triggering events.\nHowever, if a MSC Server receives a Trace Session deactivation either from its EM (in case of tracing roaming subscribers) or from HSS (in case of tracing home subscribers) during an ongoing Trace Recording Session, it may stop it immediately or at any time until the occurrence of an appropriate stop-triggering event.\nA MGW shall stop a Trace Recording Session when it receives a MOD command with trace package (indicating Trace Deactivation) from the MSC Server or at any time until the occurrence of an appropriate stop-triggering event.\nWhen a Trace Recording Session is stopped in a MSC Server, the MSC Server shall send a Trace Session deactivation message to the NEs where tracing was required, as defined in the \"List of NE types\" configuration parameter, received in the Trace Session activation message. The Trace Reference, used for the deactivation procedure, shall be the same as used in the MSC Server for the activation of the Trace Session.\nThe following figure illustrates a successful case in tracing a call, when a Trace Recording Session is stopped. (Reference 3GPP TS 23.205 [7] and 3GPP TS 23.108 [8].)\nThe figure depicts a schematic representation of a trace recording session in the CS domain, specifically focusing on the stopping process. It illustrates the various components involved, such as the transmitter, receiver, and the signal path, which are essential for capturing and recording telecommunication signals. The figure also highlights the importance of signal integrity and the use of error-correcting codes to ensure reliable communication.\nFigure 4.2.5.3.1: Stopping a Trace Recording Session (Signalling based) - CS domain\nThe following figure illustrates the stopping of a trace recording session at the UE, P-CSCF, S-CSCF, I-CSCF and HSS (Steps 13 to 22) following the unsuccessful attempt of an IP multimedia subsystem procedure. For clarity purposes the starting of trace recording sessions are also illustrated (steps 1 to 12). In the case where the HSS is unable to fulfil a Diameter User location query from the I-CSCF (see 3GPP TS 29.228 [16]), the HSS shall return to the I-CSCF a permanent failure in the Diameter location query response (Steps 13 and 15). At this point the HSS and the I-CSCF shall stop their trace recording sessions (Steps 14 and 16). On reception of the SIP Final Response containing the permanent failure status code the S-CSCF, P-CSCF and UE stop their trace recording sessions (Steps 17 to 22).\nThe figure depicts a trace recording session in a network, with various components such as IP multimedia subsystem procedures, IP multimedia subsystem procedures, and IP multimedia subsystem procedures. The session is stopped following the unsuccessful attempt of an IP multimedia subsystem procedure.\nFigure 4.2.5.5.1.1: Stopping a Trace Recording Session following the unsuccessful attempt of an IP multimedia subsystem procedure\nA UE (both originating and terminating) shall stop a trace recording session immediately following:\n1)\tThe termination of an IP multimedia subsystem procedure (as defined in 3GPP TS 23.228 [15]). For example, when a successfully established IP multimedia subsystem session ends, or upon a SIP Final Response message (2xx, 3xx, 4xx, 5xx and 6xx response codes).\n2)\tThe detection of a stop-triggering event (e.g. time expiry period) as defined by the trace control and configuration parameters within the received management operation.\n3)\tThe detection of a stop-triggering event originating directly from the Device Management server for a specific Trace Recording Session(s).\nDepending on Operator conditions, when a UE receives from the Device Management server a request to deactivate the management operation it shall either:\n1)\tContinue the Trace Recording Session (s) until it ends gracefully; or\n2)\tStop the Trace Recording session (s) immediately.\nIn all cases, the UE shall deactivate the Trace Session (s) immediately at the end of the Trace Recording Session(s).\nWhen a UE receives a request to deactivate the management operation no new Trace Recording sessions shall be initiated.\nAn IMS NE (i.e. S/I/P-CSCF, AS, HSS, MRF, MGCF, BGCF) shall stop a trace recording session immediately following:\n1)\tThe termination of an IP multimedia subsystem procedure (as defined in 3GPP TS 23.228 [15]). For example, when a successfully established IP multimedia subsystem session ends.\n2)\tThe detection of a stop-triggering event (e.g. time expiry period) as defined in the Trace Session Activation message.\nWhen an IMS NE receives a Trace Session deactivation during an ongoing Trace Recording Session, it may stop the Trace Recording Session immediately or at any time until the occurrence of an appropriate stop-triggering event.\nAs described in clause 4.1.4.6.3, Trace Session deactivation shall be initiated from the Device Management Server. Following the completion of any trace recording sessions at the UE and during the subsequent deactivation of the Trace Session, the UE shall indicate to the Device Management server that Trace Records are available for retrieval.\nOnce the Trace records have been retrieved the management object may be deleted from the UE.\n\nIn an eNB the Trace Recording Session will always be the same as the Trace Session as no triggering events are defined in E-UTRAN. Therefore a Trace Recording Session shall always be stopped in an eNB when the eNB deactivates the Trace Session since there can be only one trace reference/trace recoding session reference combination per Trace Session at any given time. For more information on Trace Session deactivation in E-UTRAN, see clause 4.1.4.8.\nA Trace Recording Session may be stopped when the MME/SGW/PGW detect any of the stop triggering events. Detection of a stop trigger event results in MME/SGW/PGW immediately stopping the trace recording session.\nHowever, if an MME receives a Trace Session deactivation either from its EM (in case of tracing roaming subscribers) or from HSS (in case of tracing home subscribers) during an ongoing Trace Recording Session, it may stop it immediately or at any time until the occurrence of an appropriate stop-triggering event.\nWhen a Trace Recording Session is stopped in an MME, the MME may send a S1-Deactivate Trace message to the eNB where tracing was required, as defined in the \"List of NE types\" configuration parameter, received in the Trace Session activation message. . If the triggering event parameter indicates that all events shall be traced, the MME shall not send the S1-Deactivate Trace message to the eNB. If the Trace Recording Session is not terminated in the MME, then it shall not be deactivated in the eNB. The Trace Reference, used for the deactivation procedure, shall be the same as used in the MME for the activation of the Trace Session. This only applies to the eNB as the PGW and SGW have their own triggering criteria.\nThere is no stopping mechanism in the EPC for MDT trace recording sessions, as there are no starting mechanisms either (see also clause 4.2.3.8).\nIn case of immediate MDT, the eNodeB shall stop an ongoing trace recording session for a given UE when a trace session deactivation is received from the MME. The eNodeB shall deactivate the corresponding MDT measurements in the UE.\nIf the configured area scope is not satifisfied in the target cell after a handover, the eNB may deactivate the Immediate MDT configured to the UE like explained in clause 4. 4.\nIn case of logged MDT or Logged MBSFN MDT, there is no stopping mechanism in the eNodeB. The eNodeB does not need to maintain a logged MDT or Logged MBSFN MDT trace recording session once it has been configured in the UE.\nIn case of logged MDT or Logged MBSFN MDT, the UE shall stop an ongoing trace recording session when logging duration expires and it shall indicate the availability of logged measurement results to the network next time it enters connected mode.\nThe UE shall discard an ongoing logged MDT trace recording session when it receives a new logged MDT or Logged MBSFN MDT trace recording session configuration from the network.\nThe UE shall discard an ongoing logged MBSFN MDT trace recording session when it receives a new logged MDT or logged MBSFN MDT trace recording session configuration from the network.\nA Trace Recording Session may be stopped when the AMF, PCF, SMF or UPF detect any of the stop triggering events. Detection of a stop trigger event results in AMF, PCF, SMF or UPF immediately stopping the trace recording session.\nHowever, if an AMF receives a Trace Session deactivation either from its management system (in case of tracing roaming subscribers) or from UDM (in case of tracing home subscribers) during an ongoing Trace Recording Session, it may stop it immediately or at any time until the occurrence of an appropriate stop-triggering event.\nWhen a Trace Recording Session is stopped in an AMF, the AMF may send a NG-Deactivate Trace message to the NG-RAN node where tracing was required, as defined in the \"List of NE types\" configuration parameter, received in the Trace Session activation message. . If the triggering event parameter indicates that all events shall be traced, the AMF shall not send the NG-Deactivate Trace message to the NG-RAN node. If the Trace Recording Session is not terminated in the AMF, then it shall not be deactivated in the NG-RAN node. The Trace Reference, used for the deactivation procedure, shall be the same as used in the AMF for the activation of the Trace Session. This only applies to the NG-RAN node as the 5GC nodes have their own triggering criteria.\nIn a NG-RAN node the Trace Recording Session will always be the same as the Trace Session as no triggering events are defined in NG-RAN. Therefore a Trace Recording Session shall always be stopped in an NG-RAN node when the NG-RAN node deactivates the Trace Session since there can be only one trace reference/trace recoding session reference combination per Trace Session at any given time. For more information on Trace Session deactivation in NG-RAN, see subclause 4.1.4.12.\nThere is no stopping mechanism in the 5GC for MDT trace recording sessions, see clause 4.2.3.13.\nIn case of immediate MDT, the gNB shall stop an ongoing trace recording session for a given UE when a trace session deactivation is received from the AMF. The gNB shall deactivate the corresponding MDT measurements in the UE.\nIf the configured area scope is not satisfied in the target cell after a handover, the gNB may deactivate the Immediate MDT configured to the UE like explained in clause 4.4.\nIn case of logged MDT, there is no stopping mechanism in the gNB. The gNB does not need to maintain a logged MDT trace recording session once it has been configured in the UE.\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.6\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.7\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.8\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.9\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.3\tRLF reporting",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.3.1\tTrace session activation for RLF reporting in E-UTRAN",
                            "text_content": "RLF reporting is activated to the eNB as a special Trace Session where the Job Type indicates RLF reporting only. The detailed procedure is shown in figure 4.3.1.1 where one UE experiences an RLF event and the reestablishment is successful to the source eNB.\nIn this figure, we see a simplified representation of a 5G network, with a focus on signal propagation and the role of RLF (Reestablishment of Lost Frequencies) reporting. The figure illustrates the signal path, with key components such as the base station (gNB), user equipment (UE), and scatterers. The diagram highlights the use of beamforming techniques to mitigate interference, and the presence of redundant paths to ensure failover reliability. The layered design of the optical backbone aligns with SDN principles, allowing for efficient network management and control.\nFigure 4.3.1.1 Example scenario for RLF reporting when UE reestablishment is successful at source eNB.\nWhen the eNB receives the Trace Session activation indicating RLF reporting only, the eNB shall start a Trace Session. This Trace Session shall collect only RLF reports received from the UE. The Trace Session activation message received from the  shall contain the following information:\n-\tTrace Reference\n-\tJob Type = RLF reporting only\n-\tTCE IP Address\nFigure 4.3. 1.2 shows another example where the UE reestablishment is failed in the source eNB, but successful at a target eNB.\nThe figure depicts a scenario for RLF reporting when the UE reestablishment is successful at the target eNB when there is an X2 Link between the target eNB and the source eNB. The figure illustrates the RLF reporting process, which involves the UE reestablishing a connection with the target eNB after a failed attempt. The figure includes a dashed line indicating the path of the X2 Link, which is essential for the RLF reporting process.\nFigure 4.3.1.2 Example scenario for RLF reporting when the UE reestablishment is successful at target eNB when there is X2 Link between target eNB and source eNB\nIf the UE re-establishes the RRC connection successfully at the target eNB the RLF reports are fetched by the target eNB. When there is X2 link between target eNB and source eNB, the target eNB forwards the RLF report in the X2 RLF Indication message. The procedures to be used at eNB to forward the RLF reports towards the management system is the same as the reporting will be done by the source eNB in this case.\nIf the UE re-establishes the RRC connection successfully at the target eNB the RLF reports are fetched by the target eNB. When there is no X2 link between target eNB and source eNB, as shown in Figure 4.3.1.3, the RLF report can’t be forwared to source eNB. In this case the Trace Record containing the Release 10 and aboveRLF reports shall be transferred to the TCE directly by the target eNB.\nIn this scenario, the RLF (Remote Link Failure) reporting is used to detect and report the failure of a link between the target eNB and the source eNB. The figure shows an example scenario where there is no X2 Link between the two eNBs, indicating that the link is not functioning properly. The RLF reporting is used to ensure that the network is functioning correctly and to provide information to the network operators about the failure.\nFigure 4.3.1.3 Example scenario for RLF reporting when there is no X2 Link between target eNB and source eNB\nIf a UE detects a Radio Link Failure event, it collects certain information as described in TS 36.300[37] and TS 36.331 [32]. Once the source eNB retrieved the RLF report from the UE or received it from the target eNB via X2 as defined in TS 36.300[37], or the target eNB retrieved the RLF report from the UE when there is no X2 link between target eNB and source eNB, eNB shall save the RLF report to the Trace Record. The Trace Record containing the RLF reports can be transferred to the TCE in the same mechanism as for normal subscriber and equipment trace or for MDT.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.2\tTrace session deactivation for RLF reporting in E-UTRAN",
                            "text_content": "When the eNB receives the indication from the EM for trace session deactivation with the Job Type \"RLF reporting only\", it shall deactivate the trace session for the indicated Trace Reference of RLF reporting and stop RLF reporting to the TCE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.3\tTrace session activation for RLF reporting in NG-RAN",
                            "text_content": "RLF reporting is activated to the gNB as a special Trace Session where the Job Type indicates RLF reporting only. The detailed procedure is shown in figure 4.3.3.1 where one UE experiences an RLF event and the reestablishment is successful to the source gNB.\nIn this figure, we see a simplified representation of a 5G network, specifically focusing on the signal propagation within a 5G network. The figure depicts the signal path, including the base station (gNB), user equipment (UE), and scatterers. The diagram highlights the use of beamforming techniques to mitigate interference, which is crucial in a 5G network to ensure high-quality communication. The figure also shows the redundancy paths, which are essential for failover reliability in a 5G network. Overall, the figure provides a clear and concise overview of the 5G signal path and its key components.\nFigure 4.3.3.1 Example scenario for RLF reporting when UE reestablishment is successful at source gNB.\nUpon Trace Session activation indicating RLF reporting only, the gNB shall start a Trace Session. This Trace Session shall collect only RLF reports received from the UE. The Trace Session activation information shall contain the following information:\n-\tTrace Reference\n-\tJob Type = RLF reporting only\n-\tTCE IP Address for file based reporting or Trace Reporting Consumer URI for streaming reporting\nFigure 4.3.3.2 shows another example where the UE reestablishment is failed in the source gNB, but successful at a target gNB.\nThe figure depicts a scenario for RLF reporting when the UE reestablishment is successful at the target gNB when there is an X n link between the target gNB and the source gNB. The figure illustrates the RLF reporting process, which involves reporting the successful UE reestablishment at the target gNB. The figure also shows the X n link between the target gNB and the source gNB, indicating the path that the UE will use to reach the target gNB.\nFigure 4.3.3.2 Example scenario for RLF reporting when the UE reestablishment is successful at target gNB when there is Xn Link between target gNB and source gNB\nIf the UE re-establishes the RRC connection successfully at the target gNB the RLF reports are fetched by the target gNB. When there is Xn link between target gNB and source gNB, the target gNB forwards the RLF report in the Xn RLF Indication message. The procedures to be used at gNB to forward the RLF reports towards the management system is the same as the reporting will be done by the source gNB in this case.\nIf the UE re-establishes the RRC connection successfully at the target gNB the RLF reports are fetched by the target gNB. When there is no Xn link between target gNB and source gNB, as shown in Figure 4.3.x.3, the RLF report can’t be forwared to source gNB. In this case the Trace Record containing the RLF reports shall be reported by the target gNB.\nIn this figure, we see a simplified representation of a 3GPP RLF (Remote Link Failure) reporting scenario. The figure depicts a scenario where there is no X n link between the target gNB (groupon base station) and the source gNB (group on board base station). The RLF reporting is necessary to ensure the reliability of the network, as it allows the network to continue functioning even if a link between the two nodes is lost. The figure shows the RLF reporting process, including the steps to be taken when a link failure occurs.\nFigure 4.3.3.3 Example scenario for RLF reporting when there is no Xn Link between target gNB and source gNB\nIf a UE detects a Radio Link Failure event, it collects certain information as described in TS 38.300[42] and TS 38.331 [43]. Once the source gNB retrieved the RLF report from the UE or received it from the target gNB via Xn as defined in TS 38.300[42], or the target gNB retrieved the RLF report from the UE when there is no Xn link between target gNB and source gNB, gNB shall save the RLF report to the Trace Record. The Trace Record containing the RLF reports can be reported in the same mechanism as for normal subscriber and equipment trace or for MDT.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.4\tTrace session deactivation for RLF reporting in NG-RAN",
                            "text_content": "Upon trace session deactivation with the Job Type \"RLF reporting only\", gNB shall deactivate the trace session for the indicated Trace Reference of RLF reporting and stop RLF reporting.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.4\tHandling of MDT Trace sessions at handover for Immediate MDT in UTRAN and E-UTRAN",
                    "description": "",
                    "summary": "",
                    "text_content": "The eNB/RNC shall activate the Immediate MDT in the UE if the area based selection conditions are satisfied or not in the target cell after a handover that is made over X2 or S1 (or over Iur or Iu in case of UMTS). If the management  based selection conditions are not satisfied in the handover target cell, the eNB/ RNC may deactivate the Immediate MDT in the UE. The trace sessions and trace recording sessions are not visible for the UE.\nIn case of signalling based trace activation , the eNB/RNC shall propagate the Trace Session parameters together with the MDT specific parameters to the target cell regardless of whether the source or target cell is part of the configured area scope in case of an Intra-PLMN handover over X2 or S1 (or Iur or Iu in case of UMTS).\nIn case of UTRAN the RNC shall propagate the Trace Session of the UE to the target cell in case of a handover over Iur or Iu. Any trace recording session shall be maintained, stopped or started in the target cell according to the evaluation of the selection criteria.\nFor LTE, the MDT configuration received by signalling based trace messages for a specific UE will propagate during intra-PLMN handover, and may propagate during inter-PLMN handover if the Signalling Based MDT PLMN List is available and includes the target PLMN. This behaviour applies also for MDT configuration that includes area scope, regardless of whether the source or target cell is part of the configured area scope.\nFor UMTS, the MDT configuration received by signalling based trace messages for a specific UE will continue during intra-PLMN handover, and may continue during inter-PLMN handover if the Signalling Based MDT PLMN List is available and includes the target PLMN, except for the case of SRNS relocation. In the case of SRNS relocation, MDT may be reactivated by the Core Network following a successful relocation.\nFor signalling based MDT configuration , when a UE that has been configured with MDT hands over to another eNB (i.e., in connected mode) and the Signalling Based MDT PLMN List conditions mentioned above are satisfied:\n-\twith an X2 handover: the MDT configuraiton shall be passed to the eNB in the X2 handover request for continuity of MDT data collection . The new eNB shall stop the MDT collection if the new conditions are not within the criteria for MDT data collection.\n-\twith an S1 handover and with no MME relocation: with S1 handover the MME shall ensure the MDT configuration is sent to the new eNB.\n-\twith an S1 handover and with MME relocation: MDT configuration shall be passed on to the new MME on MME relocation. During inter-MME handover, the MME shall propagate the MDT configuration parameters to the target MME within an S10- Forward Relocation Request message as part of inter-MME handover procedures. The new MME shall save the information as part of the UE context and forward the MDT configuration to the new eNB.\nThe following MDT configuration shall be passed during handovers (Either intra-eNB, inter-eNB or inter-MME HO):\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tArea Scope\n-\tList of Measurements\n-\tReport Amount\n-\tReporting Trigger\n-\tEvent Threshold\n-\tReport Interval\n-\tTCE IP Address\n-\tJob Type\n-\tMeasurement Period LTE (if either of the measurements M4, M5 is requested)\n-\tPositioning Method\n-\tCollection Period for RRM Measurements LTE (present only if M3 measurement is requested)\n-\tCollection Period M6 in LTE (present only if any of M6 measurements (DL or UL) is requested).\n-\tCollection Period M7 in LTE (present only if any of M7 measurements (DL or UL)is requested).\n-\tMDT PLMN List\nNote that at the same time not all the parameters can be present. The conditions are described in clause 5.10 of the present document.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.5\tHandling of MDT Trace sessions at handover for Logged MDT and Logged MBSFN MDT",
                    "description": "",
                    "summary": "",
                    "text_content": "In logged MDT and Logged MBSFN MDT mode, no propagation of the MDT configuration is performed.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.6\tUser consent handling in MDT for UTRAN and E-UTRAN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.6.1\tSignalling based MDT",
                            "text_content": "In case of signalling based MDT getting user consent before activating the MDT functionality is required because of privacy and legal obligations. It is the Operator responsibility to collect user consent before initiating an MDT for a specific IMSI or IMEI number.\nCollecting the user consent shall be done via customer care process. The user consent information availability should be considered as part of the subscription data and as such this shall be provisioned to the HSS database.\nThe following figure summarizes the functionality.\nThe figure depicts a layered network architecture with core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are shown in dashed lines, ensuring failover reliability. The layered design aligns with SDN principles.\nFigure 4.6.1.1\nWhen the IMSI based MDT is activated it is targeted the HSS. Once the user consent availability information is stored in the HSS database, the HSS can check the user consent availability before starting a Trace Session for the given subscriber. If there is no user consent given by the specific user to network where TCE resides, the HSS should not start a Trace Session for the given subscriber.\nAs the user consent availability information is stored as part of the subscription data it should also be transferred to the MME/SGSN/MSC-S during update location procedure. This is required if the subscription based MDT is started from MME/SGSN/MSC-S. In that case similar checking is required as in the HSS case.\nIt should also be possible to handle user consent revocation. The process of user consent revocation shall be done also via customer care process and the user consent availability information should be updated in the HSS DB when a user consent revocation happens.\nIf the user consent revocation happens during an ongoing Trace Session with MDT, it is not required to stop and deactivate the Trace Recording Session, Trace Session respectively immediately i.e. to stop an ongoing Trace Recording Session in case of Immediate MDT. A notification to the management system should be sent and the management system should deactivate the Trace Session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.6.2\tManagement based MDT",
                            "text_content": "In case of management based MDT getting user consent is required before activating the MDT functionality because of privacy and legal obligations. The same user consent information can be used for management based MDT and for signalling based MDT (i.e. there is no need to differentiate the user consent per MDT type).\nCollecting the user consent shall be done via customer care process. The user consent information availability shall be considered as part of the subscription data and as such this shall be provisioned to the HSS database.\nThe following figure shows an example scenario summarizing the functionality.\nThe figure depicts a user consent information delivery mechanism in a management-based Multi-Dimensional Data Transfer (MDT) system. It illustrates the process of delivering user consent information to the end user, using a combination of XML and JSON formats. The figure includes a user interface for managing the consent process, as well as a visual representation of the data flow and the user consent information.\nFigure 4.6.2.1: Example for delivering user consent information in management  based MDT\nWhen UE attaches to the network, the HSS shall forward the user consent information, stored in the HSS database, to the corresponding MME/SGSN/MSC-S. When the MME/SGSN/MSC-S receives the user consent information it shall store it in its subscriber database.\nThe MME/SGSN/MSC-S shall also check the roaming status of the user. If the user is within his home operator’s PLMNs and the user has given his consent, the MME/ SGSN/MSC-S shall send the Management Based MDT Allowed IE to the eNB/RNC during the UE context setup procedure. Otherwise the MME/ SGSN/MSC-S shall not send the Management Based MDT Allowed IE to the eNB/RNC.\nIf the result of the roaming status check indicates a home subscriber, MME/SGSN/MSC-S shall forward the already stored user consent information to the corresponding eNodeB/RNC as part of Management Based MDT Allowed IE.\nWhen the management based MDT activation is sent to eNodeB/RNC, eNodeB/RNC shall check the availability of the Management Based MDT Allowed IE before making the UE selection. In case the Management Based MDT Allowed IE is not available, the eNodeB/RNC shall not select the UE. In case the Management Based MDT Allowed IE is available, the eNodeB/RNC shall verify if the UE’s RPLMN matches the PLMN where TCE resides – Trace Reference PLMN (PLMN portion of the Trace Reference). In case of a mismatch, the eNodeB/RNC shall not select the UE.The eNB/RNC shall forward the received Management Based MDT Allowed IE during X2/Iur based handovers to the target node. The Management Based MDT Allowed IE is stored in the eNB/RNC as part of the UE context. If the user consent information is updated while a UE context is already set up in the eNB, the changed user consent should be taken into account in the next call/session setup.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.7\tAnonymization of MDT data for management based MDT",
                    "description": "",
                    "summary": "",
                    "text_content": "If the Job Type is either Immediate MDT or Logged MDT or Logged MBSFN MDT or combined Immediate MDT and trace, the anonymization requirements are applicable as described in this clause.\nIn case of UTRAN/E-UTRAN the anonymization of MDT data depends on the configuration parameter received at the MDT configuration. There are two levels of anonymization:\n-\tUsing IMEI-TAC.\n-\tNot sending any identity to the TCE.\nIn case of NG-RAN the anonymization of MDT data depends on the configuration parameter received at the MDT configuration. There are two levels of anonymization:\n-\tUsing IMEI-TAC.\n-\tNot sending any UE and subscriber identity to the TCE.\nIf the anonymization parameter value is not known or the anonymization indicates that no identity should be sent to the TCE:\n-\tFor E-UTRAN the eNB should not send the CELL TRAFFIC TRACE message to the MME.\n-\tFor UTRAN the RNC should not send the UPLINK INFORMATION EXCHANGE REQUEST message to the SGSN/MSC Server.\n-\tFor NG-RAN the gNB should not send the CELL TRAFFIC TRACE message to the AMF.\nIf the anonymization indicates that the IMEI-TAC  is required:\n-\tFor E-UTRAN eNB should send the CELL TRAFFIC TRACE message to the MME and shall put the following in the privacy indicator IE based on Job Type:\n-\t\"immediate MDT\" if the Job Type is \"Immediate MDT only\" and \"Immediate MDT and Trace\"\n-\t\"logged MDT\" if the Job Type is \"Logged MDT Only\".\n-\t\"logged MDT\" if the Job Type is \"Logged MBSFN MDT\".\n-\tThe gNB should send the CELL TRAFFIC TRACE message to the AMF and shall put the following in the privacy indicator IE based on Job Type:\n-\t\"immediate MDT\" if the Job Type is \"Immediate MDT only\" and \"Immediate MDT and Trace\".\n-\t\"logged MDT\" if the Job Type is \"Logged MDT Only\".\nMME shall look up of the IMEI-TAC and send to the TCE if the privacy indicator indicates logged MDT or Immediate MDT\n-\tFor UTRAN the RNC shall send the UPLINK INFORMATION EXCHANGE REQUEST message to the SGSN/MSC Server with IMSI information. SGSN/MSC Server shall find the corresponding IMEI and send the IMEI-TAC to the TCE.\nAMF shall look up the IMEI-TAC and send to the TCE if the privacy indicator indicates logged MDT or immediate MDT.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.8\tRCEF reporting",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.8.1\tTrace session activation for RCEF reporting in E-UTRAN",
                            "text_content": "RCEF reporting is activated to the eNB as a special Trace Session where the Job Type indicates RCEF reporting only. The detailed procedure is shown in figure 4.8.1.1 where a UE experiences an RCEF event and the RRC establishment is successful to the same eNB.\nFigure 4.8.1.1 Example scenario for RCEF reporting when UE RRC establishment is successful to the same eNB.\nWhen the eNB receives the Trace Session activation indicating RCEF reporting only, the eNB shall start a Trace Session. This Trace Session shall collect only RCEF reports received from the UE. The Trace Session activation message received from the  shall contain the following information:\n-\tTrace Reference\n-\tJob Type = RCEF reporting only\n-\tTCE IP Address\nFigure 4.8.1.2 shows another example where the UE RRC Establishment is failed to one eNB, but successful to another eNB.\nIn this figure, we see a simplified representation of a 5G network, with a focus on signal propagation and the role of the Radio Resource Controller (RRC). The figure illustrates the signal path, highlighting the various components such as the base station (gNB), user equipment (UE), and scatterers. The diagram also shows the use of beamforming techniques to mitigate interference, which is crucial in a 5G network to ensure high-quality communication. The figure is labeled as \"Figure 4.8,\" indicating that it is part of a larger set of figures that provide a detailed overview of the optical backbone architecture in a 5G network.\nFigure 4.8.1.2 Example scenario for RCEF reporting when the UE RRC establishment is successful to a different eNB\nIf the UE establishes the RRC connection successfully the RCEF reports are fetched by the eNB. The procedures to be used at eNB to forward the RCEF reports towards the management system are the same regardless of whether RCEF occurred at this eNB or a different eNB.\nIf a UE detects a RRC Connection Establishment Failure event, it collects certain information as described in TS 37.320[30]. Once the eNB retrieved the RCEF report from the UE, as defined in TS 37.320[30], it shall save it to the Trace Record. The Trace Record containing the RCEF reports can be transferred to the TCE in the same mechanism as for normal subscriber and equipment trace or for MDT.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.8.2\tTrace session deactivation for RCEF reporting in E-UTRAN",
                            "text_content": "When the eNB receives the indication from the EM for trace session deactivation with the Job Type \"RCEF reporting only\", it shall deactivate the trace session for the indicated Trace Reference of RCEF reporting and stop RCEF reporting to the TCE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.8.3\tTrace session activation for RCEF reporting in NG-RAN",
                            "text_content": "RCEF reporting is activated to the gNB as a special Trace Session where the Job Type indicates RCEF reporting only. The detailed procedure is shown in figure 4.8.3.1 where a UE experiences an RCEF event and the RRC establishment is successful to the same gNB.\nThe figure depicts a scenario for RCEF reporting when the UE's RRC establishment is successful to the same gNB. It illustrates the process of establishing a reliable connection between the UE and the gNB, which is crucial for ensuring efficient communication in a 5G network.\nFigure 4.8.3.1 Example scenario for RCEF reporting when UE RRC establishment is successful to the same gNB.\nUpon Trace Session activation indicating RCEF reporting only, the gNB shall start a Trace Session. This Trace Session shall collect only RCEF reports received from the UE. The Trace Session activation information shall contain the following information:\n-\tTrace Reference\n-\tJob Type = RCEF reporting only\n-\tTCE IP Address for file based reporting or Trace Reporting Consumer URI for streaming reporting\nFigure 4.8.3.2 shows another example where the UE RRC Establishment is failed to one gNB, but successful to another gNB.\nThe figure depicts a scenario for RCEF reporting when the UE RRC establishment is successful to a different gNB. It illustrates the process of establishing a reliable connection between the UE and the gNB, which is crucial for ensuring reliable communication in a 5G network. The figure includes key components such as the UE, gNB, and the RRC establishment, as well as the RCEF reporting mechanism.\nFigure 4.8.3.2 Example scenario for RCEF reporting when the UE RRC establishment is successful to a different gNB\nIf the UE establishes the RRC connection successfully the RCEF reports are fetched by the gNB. The procedures to be used at gNB to forward the RCEF reports towards the management system are the same regardless of whether RCEF occurred at this gNB or a different gNB.\nIf a UE detects a RRC Connection Establishment Failure event, it collects certain information as described in 3GPP TS 37.320 clause 5.1.6 [30]. Once the gNB retrieved the RCEF report from the UE, as defined in 3GPP TS 37.320 [30], it shall save it to the Trace Record. The Trace Record containing the RCEF reports can be transferred to the TCE for file-based trace reporting or to the Streaming data reporting MnS consumer for streaming reporting in the same mechanism as for normal subscriber and equipment trace or for MDT.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.8.4\tTrace session deactivation for RCEF reporting in NG-RAN",
                            "text_content": "Upon trace session deactivation with the Job Type \"RCEF reporting only\", gNB shall deactivate the trace session for the indicated Trace Reference of RCEF reporting and stop RCEF reporting to the TCE for the file-based reporting or to the Streaming data reporting MnS consumer for the streaming reporting.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.9\tUser consent handling in MDT for NG-RAN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.9.1\tSignalling based MDT",
                            "text_content": "In case of signalling based MDT getting user consent before activating the MDT functionality is required because of privacy and legal obligations. It is the Operator responsibility to collect user consent before initiating an MDT for a specific IMSI, IMEI number or SUPI.\nCollecting the user consent shall be done via customer care process. The user consent information availability should be considered as part of the subscription data and as such this shall be provisioned to the UDM database.\nThe following figure summarizes the functionality.\nThe figure depicts a simplified representation of a signalling-based Multi-Dimensional Time-Sensitive Decoding (MDT) system, which is used to deliver user consent information in a signalling-based Multi-Dimensional Time-Sensitive Decoding (MDT) system. The system includes a user interface (UI) for receiving and processing user consent information, as well as a signalling layer for transmitting the consent information to the network. The figure shows the components of the system, including the user interface, the signalling layer, and the network infrastructure.\nFigure 4.9.1.1: Example for delivering user consent information in signalling based MDT\nWhen the IMSI/IMEI(SV)/SUPI based MDT is activated it is targeted the UDM. Once the user consent availability information is stored in the UDM database, the UDM can check the user consent availability before starting a Trace Session for the given subscriber. If there is no user consent given by the specific user to network where TCE resides, the UDM should not start a Trace Session for the given subscriber.\nAs the user consent availability information is stored as part of the subscription data it should also be transferred to the AMF during update location procedure. This is required if the signalling based MDT is started from AMF. In that case similar checking is required as in the UDM case.\nIt should also be possible to handle user consent revocation. The process of user consent revocation shall be done also via customer care process and the user consent availability information should be updated in the UDM DB when a user consent revocation happens.\nIf the user consent revocation happens during an ongoing Trace Session with MDT, it is not required to stop and deactivate the Trace Recording Session, Trace Session respectively immediately i.e. to stop an ongoing Trace Recording Session in case of Immediate MDT. A notification to the management system should be sent and the management system should deactivate the Trace Session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.9.2\tManagement  based MDT",
                            "text_content": "The following figure summarizes the functionality.\nThe figure depicts a user consent information management (UDIM) system, which is a crucial component of a modern management-based Distributed Management Team (DMT) system. The system is designed to deliver user consent information to the management team, ensuring that the team can make informed decisions and maintain a high level of service quality. The figure includes various components such as user consent information, management team members, and the system's architecture, which is crucial for its functionality and reliability.\nFigure 4.9.2.1: Example for delivering user consent information in management based MDT\nWhen UE attaches to the network, the UDM shall forward the user consent information, stored in the UDM database, to the corresponding AMF. When the AMF receives the user consent information it shall store it in its subscriber database.\nThe AMF shall also check the roaming status of the user. If the user is within its home operator’s PLMNs and the user has given its consent, the AMF shall send the Management based MDT PLMN List IE to the gNB during the UE context setup procedure (INITIAL CONTEXT SETUP REQUEST message, see TS 38.413 [49]). Otherwise the AMF shall not send the Management based MDT PLMN List IE  to the gNB.\nIf the result of the roaming status check indicates a home subscriber, AMF shall forward the already stored user consent information to the corresponding gNB as part of Management based MDT PLMN List IE .\nWhen the management based MDT activation is sent to gNB, gNB shall check the availability of the Management based MDT PLMN List IE before making the UE selection. In case the Management based MDT PLMN List IE is not available, the gNB shall not select the UE. In case the Management based MDT PLMN List IE is available, the gNB shall verify if the UE’s RPLMN matches the PLMN where TCE resides – Trace Reference PLMN (PLMN portion of the Trace Reference). In case of a mismatch, the gNB shall not select the UE. The gNB shall forward the received Management based MDT PLMN List IE during Xn based handovers to the target node. The Management based MDT PLMN List IE is stored in the gNB as part of the UE context. If the user consent information is updated while a UE context is already set up in the gNB, the changed user consent should be taken into account in the next call/session setup.\nThe AMF shall forward the received Management based MDT PLMN List IE during N2 based handovers to the target node in the HANDOVER REQUEST message. Furthermore, in case of path switch request procedure, the AMF shall forward the received Management based MDT PLMN List IE to the corresponding gNB in PATH SWITCH REQUEST ACKNOWLEDGE message, see TS 38.413 [49].\nAMF subscribes to UDM  SDM API to get notification on any changes of the UE AM subscription data, including the changes on MDT user consent information which is part of the UE AM subscription data. When being notified by the UDM about an MDT user consent information change, the AMF shall subsequently signal the updated Management Based MDT PLMN Modification List IE to the gNB in UE CONTEXT MODIFICATION REQUEST message, see TS 38.413 [49].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.10\tHandling of MDT trace sessions at handover for immediate MDT in NG-RAN",
                    "description": "",
                    "summary": "",
                    "text_content": "The gNB shall activate the Immediate MDT in the UE if the area based selection conditions are satisfied or not in the target cell after a handover that is made over Xn or N2. If the area based selection conditions are not satisfied in the handover target cell, the gNB may deactivate the Immediate MDT in the UE. The trace sessions and trace recording sessions are not visible for the UE.\nIn case of signalling based trace activation , the gNB shall propagate the Trace Session parameters together with the MDT specific parameters to the target cell regardless of whether the source or target cell is part of the configured area scope in case of an Intra-PLMN handover over Xn or N2.\nFor NG-RAN, the MDT configuration received by signalling based trace messages for a specific UE will propagate during intra-PLMN handover and may propagate during inter-PLMN handover if the Signalling Based MDT PLMN List is available and includes the target PLMN. This behaviour applies also for MDT configuration that includes area scope, regardless of whether the source or target cell is part of the configured area scope.\nFor signalling based MDT configuration , when a UE that has been configured with MDT hands over to another gNB (i.e. in connected mode) and the Signalling Based MDT PLMN List conditions mentioned above are satisfied:\n-\twith an Xn handover for the case of intra-RAT: the MDT configuration shall be passed to the gNB in the Xn handover request for continuity of MDT data collection. The new gNB shall stop the MDT collection if the new conditions are not within the criteria for MDT data collection.\n-\twith an Xn handover for the case of inter-RAT: the MDT configuraiton shall be passed to the eNB or gNB in the Xn handover request for continuity of MDT data collection.\n-\twith an N2 handover and with no AMF relocation: with N2 handover the AMF shall ensure the MDT configuration is sent to the new gNB.\n-\twith an N2 handover and with AMF relocation: MDT configuration shall be passed on to the new AMF on AMF relocation. During inter-AMF handover, the AMF shall propagate the MDT configuration parameters to the target AMF within an N14- Forward Relocation Request message as part of inter-AMF handover procedures. The new AMF shall save the information as part of the UE context and forward the MDT configuration to the new gNB.\nThe following MDT configuration shall be passed during handovers (Either intra-gNB, inter-gNB or inter-AMF HO):\n-\tTrace Reference\n-\tTrace Recording Session Reference\n-\tArea Scope\n-\tList of Measurements\n-\tReport Amount\n-\tReporting Trigger\n-\tEvent Threshold\n-\tReport Interval\n-\tTCE IP Address\n-\tJob Type\n-\tPositioning Method\n-\tCollection period for RRM measurements NR (present only if any of M4 or M5 measurements are requested)\n-\tCollection Period M6 in NR (present only if any of M6 measurements (DL or UL) is requested).\n-\tCollection Period M7 in NR (present only if any of M7 measurements (DL or UL)is requested).\n-\tMDT PLMN List\n-\tSensor Information\n-\tExcess packet delay thresholds (present only if M6 UL measurements are requested)\nNote that at the same time not all the parameters can be present. The conditions are described in clause 5.10 of the present document.\n\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5\tTrace/UE measurement control and configuration parameters",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tTriggering Events (CM)",
                    "description": "",
                    "summary": "",
                    "text_content": "This conditional mandatory parameter defines when to start a Trace Recording Session and which message shall be recorded first, when to stop a Trace Recording Session and which message shall be recorded last respectively. The messages in the start triggering event tables indicate the transaction to be recorded first and the starting time of the Trace Recording Session within a Trace Session for the traced MS/subscriber in the given NE.\nThe messages in the stop triggering event tables indicate the transaction to be recorded last and the stopping time of the Trace Recording Session.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIf a bit is set to 1 the given event shall be traced, i.e. a Trace Recording Session shall be started for that event.\nIf a bit is set to 0 the given event should not be traced, i.e. Trace Recording Session should not be started.\n",
                    "tables": [
                        {
                            "description": "The messages in the stop triggering event tables indicate the transaction to be recorded last and the stopping time of the Trace Recording Session.",
                            "table number": 1,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 2,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 3,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 4,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 5,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 6,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 7,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 8,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 9,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 10,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 11,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 12,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 13,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 14,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 15,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 16,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 17,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 18,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 19,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 20,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 21,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 22,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 23,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 24,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 25,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 26,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 27,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 28,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 29,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 30,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 31,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 32,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 33,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 34,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.2\tVoid",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.3\tTrace Depth (CM)",
                    "description": "",
                    "summary": "",
                    "text_content": "This conditional mandatory parameter defines how detailed information should be recorded in the Network Element. The Trace Depth is a parameter for Trace Session level, i.e., the Trace Depth is the same for all of the NEs to be traced in the same Trace Session.\nThe following table describes the values of the Trace Depth parameter.\n\nAt least one of Minimum, Medium or Maximum trace depth shall be supported depending on the NE type (see trace record description in TS 32.423 [3] for details).\nTrace depth shall be an enumerated parameter with the following possible values:\nMinimum (0),\nMedium (1)\nMaximum (2)\nMinimumWithoutVendorSpecificExtension (3)\nMediumWithoutVendorSpecificExtension (4)\nMaximumWithoutVendorSpecificExtension (5)\n",
                    "tables": [
                        {
                            "description": "The following table describes the values of the Trace Depth parameter.",
                            "table number": 35,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.4\tList of NE Types (CM)",
                    "description": "",
                    "summary": "",
                    "text_content": "This conditional mandatory parameter defines the Network Element types where Trace Session activation is needed. The condition of this parameter is that signalling based activation mechanism is used except in IMS. This parameter determines whether the Trace Session Activation shall be propagated further to other Network Elements. In the management based activation mechanism, and in the signalling based activation mechanism for IMS, this parameter is not needed.\nThe following list contains the Network Element types:\n-\tMSC Server\n-\tMGW\n-\tRNC\n-\tSGSN\n-\tGGSN\n-\tBM-SC\n-\tMME\n-\tSGW\n-\tPDN GW\n-\teNB\n-\tAMF\n-\tPCF\n-\tSMF\n-\tUPF\n-\tgNB-CU-CP\n-\tgNB-CU-UP\n-\tgNB-DU\n-\tAUSF\n-\tSMSF\n-\tng-eNB\n-\tHSS\n-\tUDM\n\nIf a bit is set to 1, Trace Session to that Network Element shall be activated.\nIf a bit is set to 0, Trace Session is not needed in that Network Element.\n",
                    "tables": [
                        {
                            "description": "-\tUDM",
                            "table number": 36,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.5\tList of Interfaces (CO)",
                    "description": "",
                    "summary": "",
                    "text_content": "This is an optional parameter, which defines the interfaces to be recorded in the Network Element.\nThe following list contains the list of interfaces in each Network Element:\n-\tMSC Server: A, Iu-CS, Mc and MAP (G, B, E, F, D, C) interfaces, CAP.\n-\tMGW: Mc, Nb-UP, Iu-UP.\n-\tRNC: Iu-CS, Iu-PS, Iur, Iub and Uu interfaces.\n-\tSGSN: Gb, Iu-PS, Gn, MAP (Gr, Gd, Gf), CAP (Ge), Gs, S6d, S4, S3, S13' interfaces.\n-\tGGSN: Gn, Gi and Gmb interfaces.\n-\tS-CSCF: Mw, Mg, Mr and Mi interfaces.\n-\tP-CSCF: Gm and Mw interfaces.\n-\tI-CSCF: Cx, Dx, Mg, Mw.\n-\tMRFC: Mp, Mr.\n-\tMGCF: Mg, Mj, Mn.\n-\tIBCF: Ix, Mx.\n-\tE-CSCF: Mw, Ml, Mm, Mi/Mg.\n-\tBGCF: Mi, Mj, Mk.\n-\tAS: Dh, Sh, ISC,\n-\tHSS: MAP (C, D, Gc, Gr), Cx, S6d, S6a, Sh, N70, N71 and NU1 interfaces and location and subscription information.\n-\tEIR: MAP (F), S13, S13’, MAP (Gf)\n-\tBM-SC: Gmb interface.\n-\tMME: S1-MME, S3, S6a, S10, S11, S13\n-\tSGW: S4, S5, S8, S11, Gxc\n-\tPDN GW: S2a, S2b, S2c, S5, S6b, Gx, S8, SGi\n-\teNB/en-gNB: S1-MME, X2, Uu, F1-C, E1\n-\tAMF: N1, N2, N8, N11, N12, N14, N15, N20, N22, N26\n-\tAUSF: N12, N13\n-\tNEF: N29, N30, N33\n-\tNRF: N27\n-\tNSSF: N22, N31\n-\tPCF: N5, N7, N15\n-\tSMF: N4, N7, N10, N11, S5-C, N16, N16a, N38\n-\tSMSF: N20, N21\n-\tUDM: N8, N10, N13, N21, NU1\n-\tUPF: N4\n-\tng-eNB: NG-C, Xn-C, Uu\n-\tgNB-CU-CP: NG-C, Xn-C, Uu, F1-C, E1, X2-C\n-\tgNB-CU-UP: E1\n-\tgNB-DU: F1-C\nNOTE 1:\tFor IMS Network Elements other than P-CSCF and S-CSCF the interfaces included in the Trace Job for a particular type of IMS session are configured in the Management System via the Trace IRP (3GPP TS 32.442 [24]).\nNOTE 2:\tThe logical RAN node.gNB and en-gNB are defined in 3GPP TS 38.401 [44] clause 3.1. Both of these logical nodes are comprised of the following 3 Network Elements or Managed Functions (MFs): gNB-CU-CP, gNB-CU-UP & gNB-DU in either a 3-split, 2-split or non-split deployment scenario, as described in 3GPP TS 28.541 [46] clause 4.2.1 (and 4.3.2.1).\n-\tThe \"List of interfaces\" for these 4 Network Element types are combined into a single bitmap parameter below for the logical NG-RAN node, to be consumed and interpreted by each of these Network Elements irrespective of NR SA deployment scenario i.e.\n(Logical NG-RAN node) ng-eNB/gNB-CU-CP/gNB-CU-UP/gNB-DU: NG-C, Xn-C, Uu, F1-C, E1\n-\tThe \"List of interfaces\" for these 3 Network Element types are combined with the existing eNB Network Element bitmap into a single bitmap parameter below for both eNB & en-gNB node, to be consumed and interpreted by each of these Network Elements irrespective of NR NSA deployment scenario i.e.\n(Logical eNB/en-gNB) eNB/gNB-CU-CP/gNB-CU-UP/gNB-DU: S1-MME, X2, Uu, F1-C, E1\n\n\n\n\n\n\n\n\n\n\n\n\nNOTE 3:\tFor NR NSA, the existing 1 bitmaskis extended to  representation for eNB to additionally include all 3 NEs of the logical en-gNB (relevant interfaces only). The receiving MF entity interprets only the bits that are valid for its interface.\n\n\n\n\n\n\n\n\n\nNOTE 4:\tFor Management Based Activation, only this one NG-RAN bitmask above needs to be used for cell traffic trace functionality (not 2 different bitmasks).\nAs the gNB-CU-CP can be either logical gNB role or logical en-gNB role, then Bits 1 and 2 can be interpreted differently depending on the role and whether it is an NSA user or SA user.\nSA User.\n    - Bit 1 = NG-C\n    - Bit 2 = Xn-C\nNSA User\n    - Bit 1 = N/A\n    - Bit 2 = X2\n\nIf a bit is set to 1, the interface should be traced in the given Network Element.\nIf a bit is set to 0, that interface should not be traced in the given Network Element.\nNOTE 5:\tThe bit significance of the bitmaps defined above for the OAM interface can be different from the bit significance of the  corresponding bitmaps in the signalling interface specifications.\n\n",
                    "tables": [
                        {
                            "description": "",
                            "table number": 37,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 38,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 39,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 40,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 41,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 42,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 43,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 44,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 45,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 46,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 47,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 48,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 49,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 50,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 51,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 52,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 53,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 54,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 55,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.6\tTrace Reference (M)",
                    "description": "",
                    "summary": "",
                    "text_content": "The Trace Reference parameter shall be globally unique, therefore the Trace Reference shall compose as follows:\nMCC+MNC+Trace ID, where the MCC and MNC are coming with the Trace activation request from the management system to identify one PLMN containing the management system, and Trace ID is a 3 byte Octet String.\nNOTE 1: Trace ID referred here is the same as Trace Reference in previous releases.\nNOTE 2:\tThe MCC+MNC being part of the Trace Reference from Rel-8 onwards (e.g. ignored by Rel-6 / Rel-7 UTRAN Network Elements), the uniqueness of the Trace Reference may not be guaranteed with Rel-6 / Rel-7 Network Element(s) involved in the Trace.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.7\tTrace Recording Session Reference (M)",
                    "description": "",
                    "summary": "",
                    "text_content": "This parameter shall be a 2 byte Octet String.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.8\tVoid",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.9\tTrace Collection Entity (TCE) IP Address (CM,CO)",
                    "description": "",
                    "summary": "",
                    "text_content": "For file-based reporting, this is a parameter which defines the IP address to which the Trace records shall be transferred. Either an IPv4 or an IPv6 address shall be signalled.\nThis parameter is mandatory when file based tracing and/or MDT in EPS or 5GS is supported.This parameter is optional when file based tracing in UMTS is supported.\nThis parameter may be present only if the Trace Reporting MnS Consumer URI parameter is not present.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.9a\tJob Type (M)",
                    "description": "",
                    "summary": "",
                    "text_content": "The Job Type is a mandatory parameter. The condition is either MDT or RLF or RCEF data collection functionality is supported. It defines if a single trace job, a combined MDT and trace job or RLF report collection job or RCEF report collection job is activated. This parameter also defines the MDT mode. The Job Type parameter is an enumerated type with the following values:\n-\tImmediate MDT only (0);\n-\tLogged MDT only (1);\n-\tTrace only (2);\n-\tImmediate MDT and Trace (3);\n-\tRLF reports only (4) ;\n-\tRCEF reports only (5).\n-\tLogged MBSFN MDT (6).\nNOTE 1:\tThe Job Type \"RLF reports only\" and \"RCEF reports only\" are applicable only in management based trace activation in E-UTRAN and NG-RAN.\nNOTE 2:\tLogged MBSFN MDT is applicable only for activation in E-UTRAN.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.9b\tPLMN Target (CM)",
                    "description": "",
                    "summary": "",
                    "text_content": "This parameter defines the PLMN for which sessions shall be selected in the Trace Session in case of management based activation when several PLMNs are supported in the RAN (this means that shared cells and not shared cells are allowed for the specified PLMN. Furthermore, several PLMNs can be used for not shared RAN cases as well as for shared RAN cases.). Only the sessions may be selected where the PLMN that the UE reports as selected PLMN is the same as the PLMN Target.\nNote that the PLMN Target might differ from the PLMN specified in the Trace Reference, as that specifies the PLMN that is containing the management system requesting the Trace Session from the NE.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.9c\tTrace Reporting Consumer URI (CM)",
                    "description": "",
                    "summary": "",
                    "text_content": "For streaming reporting, this is a parameter which defines the URI of the Trace Reporting MnS consumer to which the Trace records shall be streamed.\nThe detailed URI structure is defined in clause 4.4 TS 32.158 [53].\nThis parameter is mandatory when streaming trace and/or MDT is supported.The parameter may be present only if the IP address of TCE is not present.\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.10\tMDT specific configuration parameters (CM)",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.10.1\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.2\tArea Scope",
                            "text_content": "The Area Scope optional parameter defines the area in terms of Cells or Tracking Area/Routing Area/Location Area where the MDT data collection shall take place. The area scope specified in an MDT session shall support the PLMNs of the MDT PLMN list (defined in clause 5.10.24). If the parameter is not present the MDT data collection shall be done throughout the PLMNs of the MDT PLMN list. For further details see also TS 37.320 [30].\nThe Area Scope parameter in UMTS is either:\n-\tlist of Cells, identified by CGI. Maximum 32 CGI can be defined.\n-\tList of Routing Area, identified by RAI. Maximum of 8 RAIs can be defined.\n-\tList of Location Area, identified by LAI. Maximum of 8 LAIs can de defined.\nThe Area Scope parameter in LTE and NRcontains one of the followings:\n-\tlist of Cells, identified by E-UTRAN-CGI or NG-RAN CGI. Maximum 32 CGI can be defined.\n-\tList of Tracking Area, identified by TAC. Maximum of 8 TAC can be defined.\n-\tList of Tracking Area Identity, identified by TAC with associated plmn-Identity perTAC-List containing the PLMN identity for each TAC. Maximum of 8 TAI can be defined. For further details see also TS 36.331[32].\nThe Area Scope parameter in NR can also contain:\n-    List of NPN IDs in NR. It is either a list of PNI-NPNs identified by CAG ID with associated plmn-Identity (Maximum 256 PNI-NPNs can be defined) or a list of SNPN by Network ID with associated plmn-Identity (Maximum 16 SNPNs can be defined).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.3\tList of Measurements",
                            "text_content": "This parameter is mandatory if the Job Type is configured for Immediate MDT or combined Immediate MDT and Trace. This parameter defines the measurements that shall be collected. For further details see also TS 37.320 [30]. The parameter is 4 octet long bitmap.\nThe parameter can have the following values in UMTS:\n-\tM1: CPICH RSCP and CPICH Ec/No measurement by UE.\n-\tM2: For 1.28 Mcps TDD, P-CCPCH RSCP and Timeslot ISCP measurement by UE.\n-\tM3: SIR and SIR error (FDD) by NodeB\n-\tM4: UE power headroom (UPH) by the UE, applicable for E-DCH transport channels.\n-\tM5: Received total wideband power (RTWP) by Node B\n-\tM6: Data Volume measurement, separately for DL and UL, by RNC.\n-\tM7: Throughput measurement, separately for DL and UL, per RAB and per UE, by RNC.\n-\tAny combination of the above\nDetailed information for M3, M5, is defined TS 25.215 [54], for M1, M2 in TS 25.331[31] and for M4 in TS 25.321[55].\nThe parameter can have the following values in LTE:\n-\tM1: RSRP, RSRQ and SINR measurement by UE\n-\tM2: Power Headroom (PH) measurement by UE\nNOTE: Available from MAC layer\n-\tM3: Received Interference Power measurement by eNB\n-\tM4: Data Volume measurement separately for DL and UL, per QCI per UE,  by eNB\n-\tM5: Scheduled IP Throughput measurement separately for DL and UL, per RAB per UE and per UE for the DL, per UE for the UL, by eNB\n-\tM6: Packet Delay measurement, separately for DL and UL, per QCI per UE, see UL PDCP Delay, by the UE, and Packet Delay in the DL per QCI, by the eNB\n-\tM7: Packet Loss rate measurement, separately for DL and UL per QCI per UE, by the eNB\n-\tM8: RSSI measurement by UE for WLAN and Bluetooth®\n-\tM9: RTT measurement by UE only for WLAN\n-\tAnd any combination of above.\nDetailed information for M4, M5, M6, M7 is defined TS 36.314 [56], for M1, M3, M8, M9 in TS 36.331[31], for M2 in TS 36.321[57].\nThe parameter can have the following values in NR:\n-\tM1: DL signal quantities measurement results for the serving cell and for intra-frequency/Inter-frequency/inter-RAT neighbour cells, including cell/beam level measurement by UE.\n-\tM2: Power headroom (PH) measurement by UE\n-\tM3 is not supported by this release\n-\tM4: PDCP SDU Data volume measurement separately for DL and UL, per DRB per UE by gNB\n-\tM5: Average UE throughput measurement separately for DL and UL, per DRB per UE and per UE for the DL, per DRB per UE and per UE for the UL, by gNB\n-\tM6: Packet delay measurement, separately for DL and UL, per DRB per UE by gNB\n-\tM7: Packet loss rate measurement, separately for DL and UL, per DRB per UE by gNB\n-\tM8: RSSI measurement by UE for WLAN and Bluetooth®\n-\tM9: RTT measurement by UE for WLAN\n-\tAnd any combination of above\nDetailed information for M4, M5, M6, M7 is defined in TS 28.552 [58] and TS 38.314 [50], for M1, M8, M9 in TS 38.331[43], for M2 in TS 38.321[51].\n\n\n\nNOTE: Value \"1\" indicates \"activate\" and value \"0\" indicates \"do not activate\".\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Detailed information for M4, M5, M6, M7 is defined in TS 28.552 [58] and TS 38.314 [50], for M1, M8, M9 in TS 38.331[43], for M2 in TS 38.321[51].",
                                    "table number": 56,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 57,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 58,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.10.4\tReporting Trigger",
                            "text_content": "This parameter is mandatory if the list of measurements parameter is configured for UE side measurement ( M1 in LTE and NR, and M1/M2 in UMTS) and the jobtype is configured for Immediate MDT or combined Immediate MDT and Trace.\nThe parameter shall not have the combination of periodical, event based and event based periodic reporting at the same time, i.e. :\n-\tFor LTE and NR, only one of the bits 1, 2, and 5 can be set.\n-\tFor UMTS, bit 1 cannot be set at the same time with either bit 3 or bit 4.\nThe parameter is one octet long bitmap and can have the following values in LTE, UMTS, NR (detailed definition of the parameter is in 3GPP TS 37.320 [30]):\n-\tPeriodical,\n-\tEvent A2 for LTE and NR:\n-\tEvent 1f for UMTS,\n-\tEvent 1i for UMTS 1.28 Mcps TDD,\n-\tA2 event triggered periodic for LTE and NR.\n-\tAll configured RRM event triggers for M1 measurement for LTE and NR. See also TS 37.320 [30] clauses 5.2.1.1 and 5.4.1.1.\n-\tAll configured RRM event triggers for M1/M2 measurement for UMTS. See also TS 37.320 [30] clause 5.3.1.1.\n\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 59,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.10.5\tReport Interval",
                            "text_content": "This parameter is mandatory if the Reporting trigger is configured for Periodic UE side measurements (M1 in LTE or NR and M1/M2 in UMTS) and the jobtype is configured for Immediate MDT or combined Immediate MDT and Trace. The parameter indicates the interval between the periodical measurements to be taken when UE is in connected mode.\nThe parameter is enumerated type with the following values in milliseconds in case of UMTS (detailed definition is in 3GPP TS 25.331 [31]:\n-\t250 ms (0),\n-\t500 ms (1),\n-\t1000 ms (2),\n-\t2000 ms (3),\n-\t3000 ms (4),\n-\t4000 ms (5),\n-\t6000 ms (6),\n-\t8000 ms (7),\n-\t12000 ms (8),\n-\t16000 ms (9),\n-\t20000 ms (10),\n-\t24000 ms (11),\n-\t28000 ms (12),\n-\t32000 ms (13),\n-\t64000 ms (14)\nThe parameter can have the following values in LTE (detailed definition is in 3GPP TS 36.331 [32]):\n-\t120 ms (0),\n-\t240 ms (1),\n-\t480 ms (2),\n-\t640 ms (3),\n-\t1024 ms (4),\n-\t2048 ms (5),\n-\t5120 ms (6),\n-\t10240ms (7),\n-\t1 min=60000 ms (8),\n-\t6 min=360000 ms (9),\n-\t12 min=720000 ms (10),\n-\t30 min=1800000 ms (11),\nThe parameter can have the following values in NR (detailed definition is in 3GPP TS 38.331 [43]):\n-\t120 ms (0),\n-\t240 ms (1),\n-\t480 ms (2),\n-\t640 ms (3),\n-\t1024 ms (4),\n-\t2048 ms (5),\n-\t5120 ms (6),\n-\t10240 ms (7),\n-\t20480 ms (8),\n-\t40960 ms (9),\n-\t1 min=60000 ms (10),\n-\t6 min=360000 ms (11),\n-\t12 min=720000 ms (12),\n-\t30 min=1800000 ms (13),\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.6\tReport Amount",
                            "text_content": "The parameter is an enumerated type with the following values for M1 in NR. The detailed definition of this parameter is available in clause 6.3.2 of TS 38.331 [43].\n-\t1 (0),\n-\t2 (1),\n-\t4 (2),\n-\t8 (3),\n-\t16 (4),\n-\t 32 (5),\n-\t 64 (6),\n-\t INFINITY (7)\nThe parameter is an enumerated type with the following values for M4 in NR. The detailed definition of this parameter is available in clause 6.3.2 of TS 38.331 [43].\n-\t1 (0),\n-\t2 (1),\n-\t4 (2),\n-\t8 (3),\n-\t16 (4),\n-\t 32 (5),\n-\t 64 (6),\n-\t INFINITY (7)\nThe parameter is an enumerated type with the following values for M5 in NR. The detailed definition of this parameter is available in clause 6.3.2 of TS 38.331 [43].\n-\t1 (0),\n-\t2 (1),\n-\t4 (2),\n-\t8 (3),\n-\t16 (4),\n-\t 32 (5),\n-\t 64 (6),\n-\t INFINITY (7)\nThe parameter is an enumerated type with the following values for M6 in NR. The detailed definition of this parameter is available in clause 6.3.2 of TS 38.331 [43].\n-\t1 (0),\n-\t2 (1),\n-\t4 (2),\n-\t8 (3),\n-\t16 (4),\n-\t 32 (5),\n-\t 64 (6),\n-\t INFINITY (7)\nThe parameter is an enumerated type with the following values for M7 in NR. The detailed definition of this parameter is available in clause 6.3.2 of TS 38.331 [43].\n-\t1 (0),\n-\t2 (1),\n-\t4 (2),\n-\t8 (3),\n-\t16 (4),\n-\t 32 (5),\n-\t 64 (6),\n-\t INFINITY (7)\nThe parameter is mandatory if the reporting trigger is configured for periodical UE side measurement (M1, M4, M5, M6, M7 in LTE, M1in NR and M1/M2 in UMTS) and the jobtype is configured for Immediate MDT or combined Immediate MDT and Trace. The parameter defines the number of measurement reports that shall be taken for periodical reporting while UE is in connected mode. Detailed definition of the parameter is in  TS 38.331 [43], TS 36.331 [32] and TS 25.331 [31].\nThe parameter is an enumerated type with the following values in UMTS and in NR:\n-\t1 (0),\n-\t2 (1),\n-\t4 (2),\n-\t8 (3),\n-\t16 (4),\n-\t 32 (5),\n-\t 64 (6),\n-\t infinity (7)\nThe parameter is an enumerated type with the following values for M1 in LTE:\n-\t1 (0),\n-\t2 (1),\n-\t4 (2),\n-\t8 (3),\n-\t16 (4),\n-\t 32 (5),\n-\t 64 (6),\n-\t infinity (7)\nThe parameter is an enumerated type with the following values for M4 in LTE:\n-\t1 (0),\n-\t2 (1),\n-\t4 (2),\n-\t8 (3),\n-\t16 (4),\n-\t 32 (5),\n-\t 64 (6),\n-\t infinity (7)\nThe parameter is an enumerated type with the following values for M5 in LTE:\n-\t1 (0),\n-\t2 (1),\n-\t4 (2),\n-\t8 (3),\n-\t16 (4),\n-\t 32 (5),\n-\t 64 (6),\n-\t infinity (7)\nThe parameter is an enumerated type with the following values for M6 in LTE:\n-\t1 (0),\n-\t2 (1),\n-\t4 (2),\n-\t8 (3),\n-\t16 (4),\n-\t 32 (5),\n-\t 64 (6),\n-\t infinity (7)\nThe parameter is an enumerated type with the following values for M7 in LTE:\n-\t1 (0),\n-\t2 (1),\n-\t4 (2),\n-\t8 (3),\n-\t16 (4),\n-\t 32 (5),\n-\t 64 (6),\n-\t infinity (7)\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.7\tEvent Threshold for Event A2",
                            "text_content": "The parameter is mandatory if the report trigger parameter is configured for A2 event reporting or A2 event triggered periodic reporting and the Job Type parameter is configured for Immediate MDT or combined Immediate MDT and Trace.\nFor trigger quantity RSRP:\nDetailed definition of the parameter for LTE is in  TS 36.331 [32].\nThe parameter is an Integer number between 0-97.\nDetailed definition of the parameter for NR is in  TS 38.331 [43].\nThe parameter is an Integer number between 0-127.\nFor trigger quantity RSRQ:\nDetailed definition of the parameter for LTE is in 3GPP TS 36.331 [32].\nThe parameter is an Integer number between 0-34.\nDetailed definition of the parameter for NR is in 3GPP TS 38.331 [43].\nThe parameter is an Integer number between 0-127.\nFor trigger quantity SINR:\nDetailed definition of the parameter for LTE is in 3GPP TS 36.331 [32]\nThe parameter is an Integer number between 0-127.\nDetailed definition of the parameter for NR is in 3GPP TS 38.331 [43].\nThe parameter is an Integer number between 0-127\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.7a\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.8\tLogging Interval",
                            "text_content": "The parameter is mandatory if the Job Type is configured for Logged MDT or Logged MBSFN MDT. The parameter defines the periodicity for logging MDT measurement results for periodic downlink pilot strength measurement when UE is in Idle or Inactive mode.\nDetailed definition of the parameter is in 3GPP TS 37.320 [30].\nThe parameter is an enumerated type with the following values in UMTS, and LTE as per defined in TS 25.331 [31] and TS 36.331 [32] :\n-\t1280 ms (0),\n-\t 2560 ms (1),\n-\t5120 ms (2),\n-\t10240 ms (3),\n-\t 20480 ms (4),\n-\t30720 ms (5),\n-\t 40960 ms (6),\n-\t61440 ms (7)\nThe parameter is an enumerated type with the following values in NR as per defined in 3GPP TS 38.331 [43]:\n-\t1280 ms (0),\n-\t2560 ms (1),\n-\t5120 ms (2),\n-\t10240 ms (3),\n-\t 20480 ms (4),\n-\t30720 ms (5),\n-\t 40960 ms (6),\n-\t61440 ms (7)\n-\t320 ms (8)\n-\t640 ms (9)\n-\tInfinity (10).\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.9\tLogging Duration",
                            "text_content": "The parameter is mandatory if the the Job Type parameter is configured for Logged MDT or Logged MBSFN MDT. The parameter determines the validity of MDT logged configuration for IDLE and INACTIVE mode. The timer starts at time of receiving configuration by the UE, and continues independent of UE state transitions and RAT or RPLMN changes.\nDetailed definition of the parameter is in  TS 37.320 [30],  TS 25.331 [31],  TS 36.331 [32] and TS 38.331[43]:\nThe parameter is an enumerated type with the following values in UMTS, LTE and NR:\n-\t600 sec (0),\n-\t1200 sec (1),\n-\t2400 sec (2),\n-\t3600 sec (3),\n-\t5400 sec (4),\n-\t7200 sec (5)\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.10\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.11\tTrace Collection Entity (TCE) Id",
                            "text_content": "This is a mandatory parameter for Logged MDT which defines the TCE Id which is sent to the UE. The UE returns it to the network together with the logged data. The network has a configured mapping of the TCE Id and the destination to which trace records shall be transferred.\nThe destination is determined considering the PLMN (delivered as part of the Trace Reference) and the IP address of TCE for the file-based trace reporting, or URI of the TCE or MnS trace reporting MnS consumer for the streaming trace reporting. The mapping needs to be unique within the PLMN. The size of the parameter is one byte.\nFor further details on the procedure see clause 4.1.1.2a for UTRAN, clauses 4.1.1.6a and 4.1.1.6b for E-UTRAN and clause 4.1.1.9.2 for NR.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.12\tAnonymization of MDT Data",
                            "text_content": "This is a mandatory parameter for management based MDT when Job Type is\n-\tImmediate MDT only (0);\n-\tLogged MDT only (1);\n-\tImmediate MDT and Trace (3).\n-\tLogged MBSFN MDT (6).\n\nThis configuration parameter provides anonymization of MDT data (Refer to clause 4.7).\nThe parameter is an enumerated type with the following possible values:\nNo Identity (0);\nIMEI-TAC (1)\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.13\tEvent Threshold for Event 1f",
                            "text_content": "The parameter is mandatory if the reporting trigger parameter is configured for 1f event reporting and the job type parameter is configured for Immediate MDT or combined Trace and Immediate MDT.\nThe parameter defines the threshold for reporting UMTS M1 measurements for 1f event based reporting trigger Detailed definition of the parameter is in 3GPP TS 25.331 section 14.1.2.6 [31].\n-\tThe parameter is an Integer number between -120-165\nThe range used depends on the measurement as configured by the parameter \"measurement quantity\":\n-\tCPICH RSCP the range is: -120 – 25 dBm\n-\tFor CPICH Ec/No the range is -24 - 0 dB\n-\tFor Pathloss 30-165 dB.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.14\tEvent Threshold for Event 1i",
                            "text_content": "The parameter is mandatory if the reporting trigger parameter is configured for 1i event reporting and the Job Type parameter is configured for Immediate MDT or combined Trace and Immediate MDT.\nThe parameter defines the threshold for reporting UMTS M2 measurements for 1i event based reporting trigger. Detailed definition of the parameter is in 3GPP TS 25.331 section 14.1.3.3. [31].\n-\tThe parameter is an Integer number between -120 .. -25\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.15\tMeasurement Quantity",
                            "text_content": "The parameter is mandatory if the reporting trigger parameter is configured for 1f event reporting and the Job Type parameter is configured for Immediate MDT or combined Trace and Immediate MDT.\nThe parameter describes for what M1 measurements the Event Threshold 1f parameter is applicable.\nThe parameter is a bitmap with the following values:\n\nNo more than one bit shall be selected at a time.\nThis parameter is only applicable to UMTS.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The parameter is a bitmap with the following values:",
                                    "table number": 60,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.10.16\tvoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.17\tvoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.18\tvoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.19\tPositioning Method",
                            "text_content": "This parameter is optional and is used only if the Job Type is set to Immediate MDT or Immediate MDT and Trace.\nThis parameter defines what positioning method should be used for the MDT job. The parameter is a bitmap, each bit represents a positioning method. The parameter is applicable only for LTE and NR. In LTE the bit1 (GNSS) may be selected only if the M1 measurement is selected in the \"List of measurements\" parameter (defined in Section 5.10.3).\nFor LTE, if the positioning method parameter indicates both E-Cell ID and GNSS positioning, the eNB may use E-Cell ID measurement collection only if the UE does not provide GNSS based location information.\nFor NR, the detailed actions associated with each positioning method are specified in TS 38.305 [52].\n\n\n\nIf the parameter is not present, then best effort positioning method is used (i.e. in worst scenario only cell ID).\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 61,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 62,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.10.20\tCollection Period for RRM Measurements LTE",
                            "text_content": "This parameter is mandatory if the Job Type is set to Immediate MDT or Immediate MDT and Trace and the bit  3 (M3) of the list of measurements parameter (defined in Section 5.10.3) in LTE is set to 1. The parameter is used only in case of RAN side measurements whose configuration is determined by RRM.\nThis measurement parameter defines the collection period that should be used to collect available measurement samples in case of RRM configured measurements. The same collection period should be used for all such measurements that are requested in the same MDT or combined Trace and MDT job.\nThe parameter is an enumerated type with the following values (detailed definition is in 3GPP TS 36.413 [36]):\n-\t100 ms (0)\n-\t1000 ms (1)\n-\t1024 ms (2),\n-\t1280 ms (3),\n-\t2048 ms (4),\n-\t2560 ms (5),\n-\t5120 ms (6),\n-\t10000 ms (7),\n-\t10240 ms (8),\n-\t1 min (9).\nSome values may not be always available e.g., due to the large amount of logging they would generate in a highly loaded network. The selection of a specific subset of supported values at the eNB is vendor-specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.21\tCollection Period for RRM Measurements UMTS",
                            "text_content": "This parameter is mandatory if the Job Type is set to Immediate MDT or Immediate MDT and Trace and any of the bits 4 (M4), 5 (M5) of the list of measurements parameter (defined in Section 5.10.3) in UMTS is set to 1. The parameter is used only in case of RAN side measurements whose configuration is determined by RRM.\nThis measurement parameter defines the collection period that should be used to collect available measurement samples in case of RRM configured measurements. The same collection period should be used for all such measurements that are requested in the same MDT or combined Trace and MDT job.\nThe parameter is an enumerated type with the following values:\n-\t100ms (0)\n-\t250 ms (1)\n-\t500 ms (2)\n-\t1000 ms (3),\n-\t2000 ms (4),\n-\t3000 ms (5),\n-\t4000 ms (6),\n-\t6000 ms (7),\nSome values may not be always available e.g., due to the large amount of logging they would generate in a highly loaded network. The selection of a specific subset of supported values at the RNC is vendor-specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.22\tMeasurement Period UMTS",
                            "text_content": "This parameter is mandatory if the Job Type is set to Immediate MDT or Immediate MDT and Trace and either the bit 6 or bit 7 or bit 8 or bit 9 of list of measurements parameter in UMTS (M6 for DL or M6 for UL or M7 for DL or M7 for UL) is set to 1.\nThis measurement parameter defines the measuremet period that should be used for the Data Volume and Throughput measurements made by the RNC. The same measurement period should be used for the UL and DL.\nThe parameter is an enumerated type with the following values:\n-\t1000 ms (0),\n-\t2000 ms (1),\n-\t3000 ms (2),\n-\t4000 ms (3),\n-\t6000 ms (4),\n-\t8000 ms (5),\n-\t12000 ms (6),\n-\t16000 ms (7),\n-\t20000 ms (8),\n-\t24000 ms (9),\n-\t28000 ms (10),\n-\t32000 ms (11),\n-\t64000 ms (12).\nSome values may not be always available e.g., due to the large amount of logging they would generate in a highly loaded network. The selection of a specific subset of supported values at the RNC is vendor-specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.23\tMeasurement Period LTE",
                            "text_content": "This parameter is mandatory if the Job Type is set to Immediate MDT or Immediate MDT and Trace and either the bit 4 or bit 5 of list of measurements parameter in LTE (M4 or M5) is set to 1.\nThis measurement parameter defines the measuremet period that should be used for the Data Volume and Scheduled IP Throughput measurements made by the eNB. The same measurement period should be used for the UL and DL.\nThe parameter is an enumerated type with the following values:\n-\t1024 ms (0),\n-\t2048 ms (2),\n-\t5120 ms (4),\n-\t10240 ms (5)\n-\t1 min (6).\nSome values may not be always available e.g., due to the large amount of logging they would generate in a highly loaded network. The selection of a specific subset of supported values at the eNB is vendor-specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.24\tMDT PLMN List",
                            "text_content": "This is an optional parameter indicating the PLMNs where measurement collection, status indication and log reporting is allowed. E.g. the UE performs these actions for Logged MDT when the RPLMN is part of this set of PLMNs. Maximum of 16 PLMNs can be defined.\nTo the UE it is communicated as the plmn-IdentityList. Between the NEs it is communicated either as the Management Based MDT PLMN List or as the Signalling Based MDT PLMN List, depending on how the MDT was activated. For further details see also TS 37.320 [30], TS 36.331 [32], TS 38.331 [43], TS 36.413 [36] and TS 38.413 [49].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.25\tMBSFN Area List",
                            "text_content": "MBSFN Area(s) for MBSFN measurement logging. The MBSFN Area consists of a MBSFN Area ID and Carrier Frequency (EARFCN). The target MBSFN area List can have up to 8 entries.\nIf target MBSFN area(s) is configured, UE applies it in addition to other restrictions such as the logging area. The UE will log measurements as long as it receives MBMS service from an indicated target MBSFN area and is within the configured logging area.\nFor further details see also TS 37.320 [30], TS 36.331 [32] and TS 36.413 [36].\nThis parameter is applicable only if the Job Type is Logged MBSFN MDT and for eUTRAN only.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.26\tArea Configuration for Neighbouring Cells",
                            "text_content": "This NR parameter is optional for logged MDT and defines the area for which UE is requested to perform measurement logging for neighbour cells which have a list of carrier frequencies. Each frequency will have one PCI that will list out the neighbouring cell. The maximum number of cell identities to be configured as part of area configuration is 32. If it is not configured, the UE shall perform measurement logging for all the neighbour cells.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.27\tReport Type for Logged MDT",
                            "text_content": "This NR parameter is mandatory and defines report type for logged MDT as:\n- \tperiodical.\n-\tevent triggered.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.28\tEvent List for Event Triggered Measurement",
                            "text_content": "This NR parameter is mandatory for event triggered measurement in the case of logged MDT.  Each trace session shall configure at most one event. The UE shall perform logging of measurements only upon certain condition being fulfilled:\n-\tOut of coverage.\n-\tL1 event.\nDetailed definition of the parameter is in 3GPP TS 38.331 [43].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.29\tSensor Information",
                            "text_content": "This NR parameter is optional and defines which sensor information shall be included in logged MDT and immediate MDT measurement if they are available.  The following sensor measurement can be included or excluded for the UE.\n-\tBarometric pressure.\n-\tUE speed.\n-\tUE orientation.\nDetailed definition of the parameter is in TS 38.331 [43].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.30\tCollection Period for RRM Measurements NR",
                            "text_content": "This parameter is mandatory if the Job Type is set to Immediate MDT or Immediate MDT and Trace and any of the bits 3 (M4) or 4 (M5) of the list of measurements parameter (defined in Section 5.10.3) in NR is set to 1. The parameter is used only in case of RAN side measurements whose configuration is determined by RRM.\nThis measurement parameter defines the collection period that should be used to collect available measurement samples in case of RRM configured measurements. The same collection period should be used for all such measurements that are requested in the same MDT or combined Trace and MDT job.\nThe parameter is an enumerated type with the following values (detailed definition is in 3GPP TS 38.413 [49]:\n-\t1024 ms (0),\n-\t2048 ms (1),\n-\t5120 ms (2),\n-\t10240 ms (3),\n-\t60000 ms (4).\nSome values may not be always available e.g., due to the large amount of logging they would generate in a highly loaded network. The selection of a specific subset of supported values at the gNB is vendor-specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.31\tVoid",
                            "text_content": "",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.32\tCollection Period M6 in LTE",
                            "text_content": "This parameter is mandatory if the Job Type is set to Immediate MDT or Immediate MDT and Trace and any of the bit 7 or bit 11 of list of measurements parameter (defined in Section 5.10.3) in LTE (M6 for DL or M6 for UL) is set to 1.\nThis measurement parameter defines the collection period that should be used for packet delay measurement made by the eNB. The same collection period should be used for the UL and DL.\nThe parameter is an enumerated type with the following values (detailed definition is in 3GPP TS 36.413 [36]):\n-\t1024 ms (0),\n-\t2048 ms (1),\n-\t5120 ms (2),\n-\t10240 ms (3)\nSome values may not be always available e.g., due to the large amount of logging they would generate in a highly loaded network. The selection of a specific subset of supported values at the eNB is vendor-specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.33\tCollection Period M7 in LTE",
                            "text_content": "This parameter is mandatory if the Job Type is set to Immediate MDT or Immediate MDT and Trace and any of the bit 8 or bit 12 of list of measurements parameter (defined in Section 5.10.3) in LTE (M7 for DL or M7 for UL) is set to 1.\nThis measurement parameter defines the collection period that should be used for packet loss rate measurement made by the eNB. The same collection period should be used for the UL and DL.\nThe parameter is an integer type with the following values (detailed definition is in 3GPP TS 36.413 [36]):\n1..60 min\nSome values may not be always available e.g., due to the large amount of logging they would generate in a highly loaded network. The selection of a specific subset of supported values at the eNB is vendor-specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.34\tCollection Period M6 in NR",
                            "text_content": "This parameter is mandatory if the Job Type is set to Immediate MDT or Immediate MDT and Trace and any of the bit 5 or bit 12 of list of measurements parameter (defined in Section 5.10.3) in NR (M6 for DL or M6 for UL) is set to 1.\nThis measurement parameter defines the collection period that should be used for packet delay measurement made by the gNB. The same collection period should be used for the UL and DL.\nThe parameter is an enumerated type with the following values (detailed definition is in 3GPP TS 38.413 [49]):\n-\t120 ms (0),\n-\t240 ms (1),\n-\t480 ms (2),\n-\t640 ms (3)\n-    1024 ms (4),\n-\t2048 ms (5),\n-\t5120 ms (6),\n-\t10240 ms (7)\n-\t20480 ms (8),\n-\t40960 ms (9),\n-\t1 min (10)\n-\t6 min (11).\n-\t12 min (12)\n-\t30 min (13)\n\nSome values may not be always available e.g., due to the large amount of logging they would generate in a highly loaded network. The selection of a specific subset of supported values at the gNB is vendor-specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.35\tCollection Period M7 in NR",
                            "text_content": "This parameter is mandatory if the Job Type is set to Immediate MDT or Immediate MDT and Trace and any of the bit 6 or bit 13 of list of measurements parameter (defined in Section 5.10.3) in NR (M7 for DL or M7 for UL) is set to 1.\nThis measurement parameter defines the collection period that should be used for packet loss rate measurement made by the gNB. The same collection period should be used for the UL and DL.\nThe parameter is an integer type with the following values (detailed definition is in 3GPP TS 38.413 [49]):\n1..60 min\nSome values may not be always available e.g., due to the large amount of logging they would generate in a highly loaded network. The selection of a specific subset of supported values at the gNB is vendor-specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.36\tEvent Threshold for L1 Event",
                            "text_content": "The parameter is mandatory for event triggered measurement in the case of logged MDT in NR and the event type is configured for L1 event.\nThe parameter defines the threshold for reporting measurements in NR Logged MDT for L1 event based reporting trigger. Detailed definition of the parameter is in  TS 38.331 [43] and TS 38.413 [49].\nThe range used depends on the used measurement quantity:\n-\tRSRP range: 0 – 127 (for calculating the actual value see RSRP-Range in TS 38.331 [43])\n-\tRSRQ range: 0 – 127 (for calculating the actual value see RSRQ-Range in TS 38.331 [43]).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.37\tHysteresis for L1 Event",
                            "text_content": "The parameter is mandatory for event triggered measurement in the case of logged MDT in NR and the event type is configured for L1 event.\nThe parameter is used within the entry and leave condition of the L1 event triggered reporting in NR Logged MDT. Detailed definition of the parameter is in  TS 38.331 [43] and TS 38.413 [49].\nThe parameter is an Integer number between 0 .. 30. For calculating the actual value see Hysteresis in TS 38.331 [43]).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.38\tTime to Trigger for L1 Event",
                            "text_content": "The parameter is mandatory for event triggered measurement in the case of logged MDT in NR and the event type is configured for L1 event.\nThe parameter defines the time during which specific criteria for the event needs to be met in order to trigger a measurement report. Detailed definition of the parameter is in  TS 38.331 [43] and TS 38.413 [49].\nThe parameter is an is an enumerated type with the following values:\n-\t0 ms (0),\n-\t40 ms (1),\n-\t64 ms (2),\n-\t80 ms (3)\n-    100 ms (4),\n-\t128 ms (5),\n-\t160 ms (6),\n-\t256 ms (7)\n-    320 ms (8),\n-\t480 ms (9),\n-\t512 ms (10),\n-\t640 ms (11),\n-\t1024 ms (12)\n-    1280 ms (13),\n-\t2560 ms (14),\n-\t5120 ms (15),\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.39\tEvent Threshold for UE Power Headroom (UPH) Measurement UMTS",
                            "text_content": "The parameter is optional for event triggered measurement in the case UMTS Power Headroom Measurement (M4).\nThe parameter defines the threshold for initiating and stopping reporting UE Power Headroom (UPH) measurements (M4) in UMTS. If the UPH value falls below the indicated threshold, reporting is started and is periodically done until UPH value goes above this threhold. Detailed definition of the parameter is in TS 25.331 [31] and TS 25.413 [13].\nThe parameter is an Integer number between 0 .. 31. (for calculating the actual value see Hysteresis in TS 25.123 [59] and TS 25.133 [60].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.40\tBeam level measurement",
                            "text_content": "This NR parameter is mandatory if the Job Type is configured for Immediate MDT or combined Immediate MDT and Trace and the bit 1 (M1) in the list of measurements parameter (defined in Section 5.10.3) for NR is set to 1.\nThe parameter is a Boolean type.\nDetailed definition of the parameter is in clause 6.3.2, TS 38.331 [43].\nNOTE:\tIt is expected that the configurations provided by OAM are hold by gNB. However, gNB has final decision to deviate from the OAM configuration e.g. due to processing limitations.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.41\tExcess packet delay thresholds",
                            "text_content": "This optional parameter defines the excess packet delay thresholds to enable the calculation of the PDCP Excess Packet Delay in the uplink in case of M6 uplink measurements are requested. This parameter is applicable if the Job Type is set to Immediate MDT and combined Trace and Immediate MDT and the bit 12 of list of measurements parameter (defined in Section 5.10.3) in NR (M6 for UL) is set to 1.\nThe parameter can have the following values:\n-\tExcess packet delay threshold.\n-\t5QI value.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.11\tVoid",
                    "description": "",
                    "summary": "",
                    "text_content": "\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.12\tTrace Target (M)",
                    "description": "",
                    "summary": "",
                    "text_content": "The Trace Target is a mandatory parameter.  It specifies the target object of the Trace and MDT. It consists of the ID type and the ID value. The ID type depends on the network element to which the Trace Session is activated.\nThe ID type is an enumerated parameter with the following possible values:\n-\tIMSI,\n- \tIMEI,\n- \tIMEISV,\n- \tSUPI,\n- \tPublic User Identity,\n- \tUTRAN cell,\n- \tE-UTRAN cell,\n- \tNG-RAN cell,\n- \tRNC,\n- \teNB,\n- \tgNB.\nThe ID types are mutually exclusive.\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "6\tMDT Reporting",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.1\tMDT reporting in case of Immediate MDT for UTRAN and E-UTRAN",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure 6.1 illustrates an example of the procedure for Immediate MDT reporting for UTRAN and E-UTRAN.\nThe figure depicts a procedure for immediate MDT reporting, which is a crucial step in the diagnosis and troubleshooting of telecommunication systems. The figure shows a flowchart that outlines the steps involved in reporting an immediate MDT (Machine-to-Machine) issue. The steps include identifying the issue, initiating the report, and following the necessary steps to resolve the problem. The figure is a visual representation of the process, making it easy to understand and follow.\nFigure 6.1: Procedure for Immediate MDT reporting\nIn case of Immediate MDT, the MDT related measurements are sent in RRC as part of the existing RRC measurements. Whenever the eNB/RNC receives the MDT measurements it shall save it to a Trace Record. The Trace Records are sent to the TCE either directly or via EM (where EM can reside in the eNB/RNC).\nThe time and the criteria when the Trace Records are sent to the TCE is vendor specific however if the Trace Session is deactivated, the Trace Records shall be sent to the TCE latest by 2 hours  after the Trace Session deactivation.\nEditor's note: The exact time is FFS.\nFor reporting of MDT data in single operator and participating operator cases, see clause 7.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.2\tMDT reporting in case of Logged MDT for UTRAN and E-UTRAN",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure 6.2 illustrates an example of the MDT reporting in case of Logged MDT for UTRAN and E-UTRAN:\nThe figure depicts a graphical representation of a MDT (Multi-Dimensional Data Trace) reporting system, which is used to monitor and analyze the performance of a network. The system includes various components such as the MDT server, MDT client, and MDT reporting interface. The MDT server is responsible for collecting and storing data from the network, while the MDT client is used to access and analyze the data. The MDT reporting interface allows users to view and analyze the MDT data in a user-friendly format. The figure provides a visual representation of the system's components and their interactions, making it easier to understand and interpret the data being reported.\nFigure 6.2: MDT reporting in case of Logged MDT\nIn case of Logged MDT, the UE collects the measurements while it is in IDLE or INACTIVE mode. Once the UE goes to RRC CONNECTED mode, the UE indicates MDT log availability in the RRCConnectionSetupComplete message or RRCResumeComplete message (E-UTRAN only) to the eNB/RNC. When the eNB/RNC receives this indication it can request the MDT log (if the UE is still in the same RAT type where the MDT configuration was done) by sending the UEInformationRequest message to the UE. The MDT logs are sent to the network in the UEInformationResponse message. At the reception of the UEInformationResponse message the eNB/RNC shall save the received MDT log to the Trace Record. The Trace Records are sent to the TCE either directly or via EM (where EM can reside in the eNB/RNC).\nThe time and criteria when the Trace Records are sent to the TCE is vendor specific however if the Trace Session is deactivated, the Trace Records shall be sent to the TCE latest by 2 hours after the Trace Session deactivation.\nEditor's note: The exact time is FFS.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.3\tMDT reporting in case of Logged MBSFN MDT",
                    "description": "",
                    "summary": "",
                    "text_content": "In case of Logged MBSFN MDT, a UE configured to perform Logged MDT MBSFN measurements indicates the availability of Logged MDT MBSFN measurements, by means of an indicator, in RRCConnectionSetupComplete message during connection establishment. The indicator shall be provided within E-UTRAN also at handover and re-establishment, except when the logged measurement configuration is active in CONNECTED mode.\nWhen the eNB receives this indication it can request the MDT log (if the UE is still in the same RAT type where the MDT configuration was done) by sending the UEInformationRequest message to the UE. The MDT logs are sent to the network in the UEInformationResponse message. At the reception of the UEInformationResponse message the eNB shall saves the received MDT log to the Trace Record. The Trace Records are sent to the TCE either directly or via EM (where EM can reside in the eNB).\nFigure 6.3 illustrates an example of the MDT reporting in case of Logged MBSFN MDT (applicable only for E-UTRAN):\nThe figure depicts a procedure for logging MBSFN MDT reports, which is an essential step in monitoring and managing network performance. The MBSFN MDT report is a detailed log of network events, including packet loss, latency, and throughput, which helps network operators identify and resolve issues quickly. The figure includes a flowchart and a list of steps, guiding the user through the process of logging the report.\nFigure 6.3: Procedure for Logged MBSFN MDT reporting\nThe time and criteria when the Trace Records are sent to the TCE is vendor specific however if the Trace Session is deactivated, the Trace Records shall be sent to the TCE latest by 2 hours ( the exact time is FFS) after the Trace Session deactivation.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.4\tMDT reporting in case of Immediate MDT for NG-RAN",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure 6.4.1 illustrates an example of MDT reporting in the case of Immediate MDT for NG-RAN:\nThe figure depicts a simplified representation of a multi-tiered distributed system (MDS) reporting system in a non-split architecture. It illustrates the immediate reporting of MDTs (Multi-Dimensional Data Tables) in the event of a failure in the primary MDS. The system includes a primary MDS, a secondary MDS, and a reporting MDS. The primary MDS is responsible for processing and storing data, while the secondary MDS and reporting MDS are responsible for reporting the data to the primary MDS. The figure shows the flow of data from the primary MDS to the reporting MDS, with the reporting MDS sending the data to the primary MDS for further processing. The figure also includes a visual representation of the data flow, with arrows indicating the direction of data flow.\nFigure 6.4.1: Immediate MDT reporting in the case of non split architecture\nIn case of Immediate MDT, the MDT related measurements are sent in RRC as part of the existing RRC measurements. Whenever the gNB receives the MDT measurements it shall save it to a Trace Record. The Trace Records are sent to the TCE either directly or via Management System.\nIn a split architecture, the MDT Trace Records shall be sent directly from each node where the MDT session has been activated to TCE or management system. If the management system receives the MDT Trace Records, the management system should send the MDT Trace Records to TCE [44].\nThe time and the criteria when the Trace Records are sent to the TCE is vendor specific however if the Trace Session is deactivated, the Trace Records shall be sent to the TCE latest by 2 hours after the Trace Session deactivation.\nEditor's note: The exact time is FFS.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.5\tMDT reporting in case of Logged MDT for NG-RAN",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure 6.5.1 illustrates an example of the MDT reporting in case of Logged MDT for NG-RAN:\nThe figure depicts a log-based MDT (Multi-Dimensional Data Trace) reporting system in a non-split architecture. It illustrates the process of data trace logging, with various components such as the MDT server, log file, and log viewer. The system is designed to provide a comprehensive view of data trace events, enabling efficient troubleshooting and analysis.\nFigure 6.5.1: Logged MDT reporting in the case of non split architecture\n\nIn case of Logged MDT, the UE collects the measurements while it is in IDLE mode or INACTIVE state. Once the UE goes to RRC CONNECTED mode, the UE indicates MDT log availability in the RRCSetupComplete message or RRCResumeComplete message to the gNB. When the gNB receives this indication, it can request the MDT log (if the UE is still in the same RAT type where the MDT configuration was done) by sending the UEInformationRequest message to the UE. The MDT logs are sent to the network in the UEInformationResponse message. At the reception of the UEInformationResponse message the gNB shall save the received MDT log to the Trace Record. The Trace Records are sent to the TCE either directly or via Management System.\nIn a split architecture, the MDT Trace Records shall be sent directly from each node where the MDT session has been activated to TCE or management system. If the management system receives the MDT Trace Records, the management system should send the MDT Trace Records to TCE [44].\nThe time and criteria when the Trace Records are sent to the TCE is vendor specific however if the Trace Session is deactivated.\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "7\tTrace reporting",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tSingle operator case",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.1.1\tFile-based trace reporting in single operator case",
                            "text_content": "The traced data is recorded in the NE (e.g. RNC, SGSN, eNB, MME, NG-RAN node, AMF). The recorded data is saved to a Trace file. The Trace files are sent to the TCE\n1)\teither directly, or\n2)\tvia the NE’s management system.\nAlternative 1 may be used when supported by implementation and when the operator has no issue to set up and maintain direct connections between the NE and the TCE.\nAlternative 2 may be used when supported by implementation and the operator wants to reuse the already set up and maintained connection between the NE and the management system for transport of the trace files to the TCE.\nFigure 7.1.1-1 illustrates an example of the procedure for transferring the Trace Record from the NE to the TCE for alternative 1.\nThe figure depicts a direct transfer of data from the TCE to the TCE-1, illustrating the efficient communication between the two devices.\nFigure 7.1.1-1 Direct transfer to the TCE\nFigure 7.1.1-2 illustrates an example of the procedure for transferring the Trace file from the NE to the TCE for alternative 2.\n\nThe figure depicts a transfer of data from the TCE (Telecommunication Equipment) to the management system, illustrating the process of data transmission over a network. The figure includes various components such as the TCE, management system, and network infrastructure, highlighting the importance of proper communication and data management in telecommunication systems.\nFigure 7.1-2 Transfer to the TCE via management system\nThe time and the criteria when the Trace files are sent to the TCE is vendor specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.1.2\tStreaming trace reporting in single operator case",
                            "text_content": "The traced data is captured in the NE (e.g. NG-RAN node, AMF). The captured trace data is streamed to the Trace Reporting MnS consumer (see TS 28.532 [x2])\n1)\teither directly (NE plays the role of the Trace Reporting MnS producer), or\n2)\tvia the intermediate management function(s) (playing the roles of Trace Reporting MnS producers and/or consumers).\nAlternative 1 may be used when supported by implementation and when the operator has no issue to set up and maintain direct connections between the NE and the Trace Reporting MnS consumer.\nAlternative 2 may be used when supported by implementation and the operator wants to reuse the already set up and maintained connection between the NE and the management functions for streaming of the trace data to the Trace Reporting MnS consumer.\nFigure 7.1.2-1 illustrates an example of the procedure for streaming the Trace Record from the NE to the Trace Reporting MnS consumer for alternative 1.\nThe figure depicts a direct streaming scenario to the Trace Reporting MnS consumer, illustrating the flow of data from the source to the Trace Reporting MnS consumer. The figure shows the direct streaming path, with the Trace Reporting MnS consumer being the destination. The figure also includes the source, the Trace Reporting MnS consumer, and the Trace Reporting MnS consumer's interface.\nFigure 7.1.2-1 Direct streaming to the Trace Reporting MnS consumer\nFigure 7.1.2-2 illustrates an example of the procedure for transferring the Trace Record from the NE to the Trace Reporting MnS consumer for alternative 2.\nThe figure depicts a scenario where indirect streaming is used to transmit data to the Trace Reporting MnS consumer. The diagram illustrates the communication path, with the Trace Reporting MnS consumer being the receiver. The data is transmitted through a series of intermediate nodes, including the Trace Reporting MnS consumer, and is then relayed to the Trace Reporting MnS consumer. The figure provides a visual representation of the communication process, highlighting the use of indirect streaming to ensure data is delivered to the Trace Reporting MnS consumer.\nFigure 7.1.2-2 Indirect streaming to the Trace Reporting MnS consumer\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.2\tShared network case for Participating Operator",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.2.1\tFile-based trace reporting in shared network case for Participating Operator",
                            "text_content": "The traced data for a Participating Operator are recorded in the NE (e.g. RNC, SGSN, eNB, MME, NG-RAN node, AMF). The recorded data is saved to a Trace file. The Trace files are sent to the TCE:\n1)\teither directly from the Master Operator's NE to the Participating Operator’s TCE, or\n2)\tfrom the Master Operator's NE’s via the Master Operator's management system  to the Participating Operator’s management system. The connection between the two operators may be a secure connection that is used for other (management) purposes. The secure connection is outside the scope of this specification.\nAlternative 1 illustrated in Figure 7.2.1-1 may be used when supported by the implementation and when both operators have no issue to set up and maintain direct connections between the NE and the TCE.\nAlternative 2 illustrated in Figure 7.2.1-2 may be used when supported by the implementation and both operators want to reuse the already set up and maintained connection between the Master Operator management system and the Participating Operation management system.\n\nThe figure depicts a transfer from the Master Operator to the Participating Operator's Terminal Equipment (TCE) in a network. The Master Operator is responsible for managing the network's operations, while the Participating Operator is responsible for managing the network's operations. The figure shows the transfer process, including the steps taken by the Master Operator and the Participating Operator, as well as the network's overall structure.\nFigure 7.2-1 Transfer from the Master Operator NE to the Participating Operator's TCE\nThe figure depicts a transfer from the Master Operator management system to the Participating Operator, illustrating the flow of data and control between the two entities in a telecommunications network.\nFigure 7.2-2 Transfer from the Master Operator management system to the Participating Operator\nThe connection between the operators may be secured. How that is done is outside the scope of this specification.\nThe time and the criteria when the Trace files are sent to the TCE is vendor specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.2\tStreaming trace reporting in shared network case for Participating Operator",
                            "text_content": "The traced data is captured in the NE (e.g. NG-RAN node, AMF). The captured trace data is streamed to the Trace Reporting MnS consumer (see TS 28.532 [47]):\n1)\teither directly from the Master Operator's NE to the Master Operator's EGMF (see TS 28.533 [48]) and then to the Participating Operator’s Trace Reporting MnS consumer, or\n2)\tfrom the Master Operator's NE’s via the Master Operator's intermediate management function(s) (playing the roles of Trace Reporting MnS producers and/or consumers) to the Master Operator's EGMF and then to the Participating Operator’s Trace Reporting MnS consumer. The connection between the two operators may be a secure connection that is used for other (management) purposes. The secure connection is outside the scope of this specification.\nAlternative 1 illustrated in Figure 7.2.2-1 may be used when supported by the implementation and when Master Operator has no issue to set up and maintain direct connections between the NE and the EGMF.\nThe figure depicts a direct streaming scenario to the EGMF with exposure to the Trace Reporting MnS consumer, illustrating the involvement of the Participating Operator in the trace reporting process.\nFigure 7.2.2-1 Direct streaming to the EGMF with exposure to the Trace Reporting MnS consumer of Participating Operator\nAlternative 2 illustrated in Figure 7.2.2-2 may be used when supported by the implementation and when Master Operator wants to reuse the already set up and maintained connection between between the NE and the management functions for streaming of the trace data to the EGMF.\nThe figure depicts a scenario where indirect streaming is used to transmit data to the EGMF, with the consumer of Participating Operator being exposed to the Trace Reporting MnS consumer.\nFigure 7.2.2-2 Indirect streaming to the EGMF with exposure to the Trace Reporting MnS consumer of Participating Operator\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "8\tRLF Reporting",
            "description": "For reporting of RLF data in single operator and Participating Operator cases, see clause 7.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "9\tRCEF Reporting",
            "description": "For reporting of RCEF data in single operator and Participating Operator cases, see clause 7.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "10\tMetric identifier",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "10.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The metric identifiers are a sequence of items separated by \".\". The sequence of items identifying a measurement is organised from the general to the particular. The individual items follow the Lower Camel Case naming convention [61]. There are different sequences for Immediate MDT, Logged MDT, Logged MBSFN MDT, Trace, RLF reports and RCEF reports.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "10.2\tImmediate MDT",
                    "description": "",
                    "summary": "",
                    "text_content": "The measurement names for Immediate MDT measurements consist of the following items:\n-\tThe first item identifies the MDT mode, i.e. \"immediateMdt\".\n-\tThe second item identifies the radio access technology (RAT), i.e. \"nr\", \"lte\" or \"umts\"\n-\tThe third item identifies the name of the measurement itself (e.g. m1, m2), see TS 37.320 [30].\n-\tAn additional item of the measurement attribute name may be present, e.g. \"rsrp\" or \"ueLocation\" or \"ulThpTime\" see TS 32.423 [3].\nPossible examples:\n-\timmediateMdt.nr.m1.rsrp\n-\timmediateMdt.nr.m2\n-\timmediateMdt.nr.m4\n-\timmediateMdt.nr.m5.ulThpTime\n-\timmediateMdt.nr.m6\n-\timmediateMdt.nr.m7\n-\timmediateMdt.nr.m8\n-\timmediateMdt.nr.m9\n-\timmediateMdt.lte.m2\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "10.3\tLogged MDT and Logged MBSFN MDT",
                    "description": "",
                    "summary": "",
                    "text_content": "The measurement names for Logged MDT and Logged MBSFN MDT measurements consist of the following items:\n-\tThe first item identifies the MDT mode, i.e. \"loggedMdt\" or \"loggedMbsfnMdt\".\n-\tThe second item is optional and identifies the measurement attribute name, e.g. \"rsrp\" or \"ueLocation\".\nPossible examples:\n-\tloggedMdt.rsrp\n-\tloggedMbsfnMdt\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "10.4\tTrace",
                    "description": "",
                    "summary": "",
                    "text_content": "The measurement names for Trace messages consist of the following items:\n-\tThe first item identifies the job type, i.e. \"trace\".\n-\tThe second item identifies the network element type (e.g. amf, upf, gnbCuCp,  gnbCuUp, gnbDu), see clause 5.4.\n-\tThe third item is optional and identifies the interface (e.g. n1, n2, n4, ng-c, xn-c, uu, f1-c, e1, x2-c) , see clause 5.5.\n-\tThe fourth item is optional and identifies the message name e.g. \"ueContextReleaseRequest\" or \"handoverFailure\".\n-\tThe fifth item is optional and identifies the IE name e.g. \"cause\".\nPossible examples:\n-\ttrace.amf.n1\n-\ttrace.amf.n1.registrationRequest.requestedNssai\n-\ttrace.amf.n1.serviceRequest.serviceRequestMessageIdentity\n-\ttrace.amf.n1.serviceRequest.ulDataStatus\n-\ttrace.mme.s1-mme.ueContextReleaseRequest.cause\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "10.5\tRLF report and RCEF report",
                    "description": "",
                    "summary": "",
                    "text_content": "The measurement names for RLF reports and RCEF reports consist of the following items:\n-\tThe first item identifies the job type, i.e. \"rlfReport\" or \"rcefReport\".\n-\tThe second item is optional and identifies the measurement attribute name, e.g. \"rsrp\" or \"ueLocation\".\nPossible examples:\n-\trlfReport.rsrp\n- \trcefReport\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.1\tGlobal structure",
            "description": "See 3GPP TS 32.615 [27].\nThe following XML namespaces are potentially used in Trace failure notification XML files:\n-\ttraceFailureNotification.xsd (see A.5)\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.2\tXML elements fileHeader and fileFooter",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.2.1\tXML elements fileHeader",
                    "description": "",
                    "summary": "",
                    "text_content": "See 3GPP TS 32.615 [27]\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.2.2\tXML element fileFooter",
                    "description": "",
                    "summary": "",
                    "text_content": "See 3GPP TS 32.615 [27]\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.3\tTrace failure notification specific XML elements",
            "description": "See A.5.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.4\tTrace IRP XML File Name Conventions",
            "description": "For Trace failure notification XML File Name Conventions the generic file name definitions as specified by the FT IRP apply (see [28]) with the “specificIRP extension” defined below.\n<SenderType>.<SenderName>\nSenderType field is the type of NE defined by IOC attribute managedElementType in 3GPP TS 32.622 [35] that recorded and sent the trace failure notification file; SenderName field is the identifier of the NE that recorded and sent the trace failure notification file.\nSome examples describing the use of the “specificIRP_extension” in Trace failure notification naming:\nspecificIRP_extension: MME.MME04\nmeaning: file produced by MME<MME04>.\nspecificIRP_extension: ENB.ENB122\nmeaning: file produced by ENB<ENB122>.\nfile name: CT201105131405-060012MME.MME04\nmeaning: unique call trace (Trace failure notification) file produced by MME<MME04> on May 13, 2011 at 14:05 local with a time differential of -6 hours against UTC and expiring in 12 hours after creation\nfile name: CT201105131315-060012ENB.ENB122_-_2\nmeaning: second non-unique (RC=”2”) call trace (Trace failure notification) file produced by ENB<ENB122> on May 13, 2011 at 13:15 local with a time differential of -6 hours against UTC and expiring in 12 hours after creation.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.5\tTrace failure notification file XML schema",
            "description": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<!--\n3GPP TS 32.422 Trace\nTrace failure notification file XML schema\ntraceFailureNotification.xsd\n-->\n\n<schema\ntargetNamespace=\n\"http://www.3gpp.org/ftp/specs/archive/32_series/32.422#traceFailureNotification\"\n\n\nelementFormDefault=\"qualified\"\n\nxmlns=\"http://www.w3.org/2001/XMLSchema\"\n\n\nxmlns:tfn=\n\"http://www.3gpp.org/ftp/specs/archive/32_series/32.422#traceFailureNotification\"\n\nxmlns:xe=\n\"http://www.3gpp.org/ftp/specs/archive/32_series/32.305#notification\"\n\n>\n\n\n<import\nnamespace=\n\"http://www.3gpp.org/ftp/specs/archive/32_series/32.305#notification\"\n/>\n\n\n<!-- XML types specific for trace failure notifications -->\n\n<complexType name=\"TraceReference\">\n  <sequence>\n    <element name=\"MCC\" type=\"short\" minOccurs=\"0\"/>\n<element name=\"MNC\" type=\"short\" minOccurs=\"0\"/>\n<element name=\"TRACE_ID\" type=\"integer\"/>\n</sequence>\n</complexType>\n\n<complexType name=\"NotifyTraceRecordingSessionFailure\">\n<complexContent>\n<extension base=\"xe:Notification\">\n<sequence>\n<element name=\"body\">\n<complexType>\n<sequence>\n<element name=\"NeId\" type=\"string\" minOccurs=\"0\"/>\n\n<element name=\"TraceRecordingSessionReference\" type=\"hexBinary\" maxLength=\"4\" minOccurs=\"0\"/>\n<element name=\"TraceReference\" type=\"tfn:TraceReference\"/>\n<element name=\"Reason\" type=\"string\" minOccurs=\"0\"/>\n</sequence>\n</complexType>\n</element>\n</sequence>\n</extension>\n</complexContent>\n</complexType>\n\n<element name=\"NotifyTraceRecordingSessionFailure\" type=\"tr:NotifyTraceRecordingSessionFailure\"/>\n\n</schema>\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.1\tRouting the Trace file directly to the TCE",
            "description": "Routing the Trace file directly to the TCE may be used when the eNBs are located on a network that is under the operator's full control, not requiring secure connection between the NE and the TCE. Minimise the signalling load through the management system. A second reason can be to minimise the signalling load through the management system. A third reason can be that the operator wants to reuse secure connections between the NE and the TCEs.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.2\tRouting the Trace file via the management system",
            "description": "Routing the Trace file via the NE’s management system to the TCE may be used when the NEs are located a network that is outside the operator's control and a secure connection between the NE and the management system is to be reused (via secure gateways etc). Another reason can be that the operator wants to minimise the number of connections from a NE to TCEs. A third reason can be that a Master Operator and Participating Operator want to reuse existing management connections.\n\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "",
                    "table number": 63,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "",
                    "table number": 64,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        }
    ]
}