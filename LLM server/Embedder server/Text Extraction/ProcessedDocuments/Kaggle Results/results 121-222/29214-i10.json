{
    "document_name": "29214-i10.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\nY\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document provides the stage 3 specification of the Rx reference point for the present release. The functional requirements and the stage 2 specifications of the Rx reference point are contained in 3GPP TS 23.203 [2].\nThe Rx reference point lies between the Application Function (AF) and the Policy and Charging Rule Function (PCRF). In the 5GS the Rx reference point resides between the AF and the Policy Control Function (PCF) as specified in 3GPP TS 23.501 [55] and 3GPP TS 23.503 [56].\nNOTE:\tInteractions between the PCF and the AF using the 5GS Npcf_PolicyAuthorization service (the N5 reference point) are defined in 3GPP TS 29.514 [57].\nThe Rx interface which is based on RESTful HTTP and XML is specified in 3GPP TS 29.201 [37].\nWhenever it is possible the present document specifies the requirements for the protocol by reference to specifications produced by the IETF within the scope of Diameter. Where this is not possible, extensions to Diameter are defined within the present document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication and/or edition number or version number) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.203: \"Policy and Charging Control architecture\".\n[3]\tVoid.\n[4]\tVoid.\n[5]\t3GPP TS 29.209: \"Policy control over Gq interface\", latest Rel-6 version.\n[6]\tVoid.\n[7]\t3GPP TS 29.211: \"Rx Interface and Rx/Gx signalling flows\", latest Rel-6 version.\n[8]\t3GPP TS 29.212: \"Policy and Charging Control (PCC); Reference points\".\n[9]\t3GPP TS 29.213: \"Policy and Charging Control signalling flows and Quality of Service (QoS) parameter mapping\".\n[10]\tVoid.\n[11]\tIETF RFC 3556: \"Session Description Protocol (SDP) Bandwidth Modifiers for RTP Control Protocol (RTCP) Bandwidth\".\n[12]\tIETF RFC 4005: \"Diameter Network Access Server Application\".\n[13]\tIETF RFC 4566: \"SDP: Session Description Protocol\".\n[14]\tVoid.\n[15]\tETSI TS 183 017 v3.2.1: \"Telecommunications and Internet Converged Services and Protocols for Advanced Networking (TISPAN); Resource and Admission Control: DIAMETER protocol for session based policy set-up information exchange between the Application Function (AF) and the Service Policy Decision Function (SPDF); Protocol specification\".\n[16]\t3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".\n[17]\t3GPP TS 24.229: \"IP Multimedia Call Control Protocol based on SIP and SDP; Stage 3\".\n[18]\tIETF RFC 3264: \"An Offer/Answer Model with the Session Description Protocol (SDP)\".\n[19]\tVoid.\n[20]\tIETF RFC 3162: \"Radius and IPv6\".\n[21]\tIETF RFC 5031: \"A Uniform Resource Name (URN) for Emergency and Other Well-Known Services\".\n[22]\tVoid.\n[23]\t3GPP TS 32.240: \"Telecommunication management; Charging management; Charging architecture and principles\".\n[24]\t3GPP TS 32.299: \"Telecommunication management; Charging management; Diameter charging applications\".\n[25]\t3GPP TS 29.229: \"Cx and Dx interfaces based on the Diameter protocol; Protocol details\"\n[26]\t3GPP TS 24.292: \"IP Multimedia (IM) Core Network (CN) subsystem Centralized Services (ICS); Stage 3\".\n[27]\tIETF RFC 3959 (December 2004): \"The Early Session Disposition Type for the Session Initiation Protocol (SIP)\".\n[28]\t3GPP TS 23.380: \"IMS Restoration Procedures\".\n[29]\tVoid.\n[30]\tVoid.\n[31]\t3GPP TS 22.153: \"Multimedia Priority Service\".\n[32]\tVoid.\n[33]\t3GPP TS 29.274: \"3GPP Evolved Packet System. Evolved GPRS Tunnelling Protocol for EPS (GTPv2)\".\n[34]\t3GPP TS 29.061: \"Interworking between the Public Land Mobile Network (PLMN) supporting packet based services and Packet Data Networks (PDN)\".\n[35] \tIETF RFC 7683: \"Diameter Overload Indication Conveyance\".\n[36]\t3GPP TS 23.468: \"Group Services and System Aspects; Group Communication System Enablers for LTE (GCSE LTE)\".\n[37]\t3GPP TS 29.201: \"Representational State Transfer (REST) reference point between Application Function (AF) and Protocol Converter (PC)\".\n[38]\t3GPP TS 23.003: \"Numbering, addressing and identification\".\n[39]\t3GPP TS 29.273: \"3GPP EPS AAA interfaces\".\n[40]\t3GPP TS 23.682: \"Architecture enhancements to facilitate communications with packet data networks and applications\".\n[41]\t3GPP TS 26.114: \"IP Multimedia Subsystem (IMS); Multimedia telephony; Media handling and interaction\".\n[42]\tIETF RFC 5761: \"Multiplexing RTP Data and Control Packets on a Single Port\".\n[43]\tIETF RFC 7944: \"Diameter Routing Message Priority\".\n[44]\tVoid.\n[45]\tIETF RFC 8101: \"IANA Registration of New Session Initiation Protocol (SIP) Resource-Priority Namespace for Mission Critical Push To Talk service\".\n[46]\t3GPP TS 23.303: \"Proximity-based services (ProSe); Stage 2\".\n[47]\t3GPP TS 29.154: \"Service capability exposure functionality over Nt reference point\".\n[48]\tIETF RFC 5009: \"Private Header (P-Header) Extension to the Session Initiation Protocol (SIP) for Authorization of Early Media\".\n[49]\tIETF RFC 3948: \"UDP Encapsulation of IPsec ESP Packets\".\n[50]\t3GPP TS 24.302: \"Access to the 3GPP Evolved Packet Core (EPC) via non-3GPP access networks; stage 3\".\n[51]\tIETF RFC 8583: \"Diameter Load Information Conveyance\".\n[52]\tIETF RFC 6733: \"Diameter Base Protocol\".\n[53]\t3GPP TS 23.167: \"IP Multimedia Subsystem (IMS) emergency sessions\".\n[54]\t3GPP TS 23.379: \"Functional architecture and information flows to support Mission Critical Push To Talk (MCPTT); Stage 2\".\n[55]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[56]\t3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System; Stage 2\".\n[57]\t3GPP TS 29.514: \"5G System; Policy Authorization Service; Stage 3\".\n[58]\t3GPP TS 29.512: \"5G System; Session Management Policy Control Service; Stage 3\".\n[59]\t3GPP TS 29.513: \"5G System; Policy and Charging Control signalling flows and QoS parameter mapping; Stage 3\".\n[60]\t3GPP TS 23.280: \"Common functional architecture to support mission critical services; Stage 2\".\n[61]\t3GPP TS 23.281: \"Functional architecture and information flows to support Mission Critical Video (MCVideo); Stage 2\".\n[62]\t3GPP TS 24.182: \"IP Multimedia Subsystem (IMS) Customized Alerting Tones (); Protocol specification\".\n[63]\t3GPP TS 24.147: \"Conferencing using the IP Multimedia (IM) Core Network (CN) subsystem; Stage 3\".\n[64]\t3GPP TS 29.571: \"5G System; Common Data Types for Service Based Interfaces; Stage 3\".\n[65]\t3GPP TS 22.101: \"Service aspects; Service principles\".\n[66]\t3GPP TS 23.221: \"Architectural requirements\".\n[67] \t3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".\n[68]\tIETF RFC 4574: \"The Session Description Protocol (SDP) Label Attribute\".\n[69]\t3GPP TS 26.238: \"Uplink Streaming\".\n[70]\t3GPP TS 24.501: \"Non-Access-Stratum (NAS) Protocol for 5G System (5GS); Stage 3\".\n[71]\t3GPP TS 38.413: \"NG-RAN; NG Application Protocol (NGAP)\".\n[72]\t3GPP TS 23.316: \"Wireless and wireline convergence access support for the 5G System (5GS)\".\n[73]\tCableLabs WR-TR-5WWC-ARCH: \"5G Wireless Wireline Converged Core Architecture\".\n[74]\tBBF WT-470: \"5G FMC Architecture\".\n[75]\tIETF RFC 8506: \"Diameter Credit Control Application\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tDefinitions",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms and definitions given in 3GPP TR 21.905 [1] and the following apply:\nApplication Function (AF): element offering application(s) that use IP bearer resources\nNOTE:\tOne example of an AF is the P-CSCF of the IM CN subsystem.\nAF Session: application level session established by an application level signalling protocol offered by the AF that requires a session set-up with explicit session description before the use of the service.\nNOTE:\tOne example of an application session is an IMS session.\nAttribute-Value Pair (AVP): See ETF RFC 6733 [52], corresponds to an Information Element in a Diameter message.\nBinding: PCRF process of associating IP flows described in AF Service Information with IP-CAN bearers.\nBit rate: The number of bits (denoted in units of bits, kbits, etc.) that are conveyed or processed per unit of time. The bit rate in bit/s can be abbreviated with bps. This specification uses SI (International System of Units) prefixes as unit prefixes, which strictly refer to the power of 10, and shall not be used for the power of 2. For example, 1 kbit/s represents 1000 bit/s or 1 Mbit/s represents 1000 kbit/s and so on.\nIP-CAN bearer: IP transmission path of defined capacity, delay and bit error rate, etc.\nSee 3GPP TR 21.905 [1] for the definition of bearer.\nIP-CAN session: association between a UE and an IP network (for GPRS, APN).\nThe association is identified by one UE Ipv4 address and/or one Ipv6 prefix together with a UE identity information, if available, and a PDN represented by a PDN ID (e.g. an APN). An IP-CAN session incorporates one or more IP-CAN bearers. Support for multiple IP-CAN bearers per IP-CAN session is IP-CAN specific. An IP-CAN session exists as long as the related UE Ipv4 address and/or Ipv6 prefix are assigned and announced to the IP network.\nIP flow: unidirectional flow of IP packets with the same source IP address and port number and the same destination IP address and port number and the same transport protocol\nPort numbers are only applicable if used by the transport protocol.\nMPS session: A session for which priority treatment is applied for allocating and maintaining radio and network resources to support the Multimedia Priority Service (MPS). MPS is defined in 3GPP TS 22.153 [31].\nPacket flow: A specific user data flow carried through the PCEF. A packet flow can be an IP flow.\nPCC rule: set of information enabling the detection of a service data flow and providing parameters for policy control and/or charging control.\nRESTful HTTP: is an architectural style consisting of a coordinated set of architectural constraints applied to components, connectors, and data elements, within a distributed hypermedia system applied to the development of web services.\nRestricted local operator services: communication services provided by an operator that involve either automated or human assistance (e.g. credit card billing, directory assistance, customer care) for which successful authentication is not necessary.\nservice information: set of information conveyed from the AF to the PCRF over the Rx interface to be used as a basis for PCC decisions at the PCRF, including information about the AF session (e.g. application identifier, type of media, bandwidth, IP address and port number).\nservice data flow: An aggregate set of packet flows.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purpose of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply:\n5GMM\t5G Mobility Management protocol\n5GS\t5G System\n5GSM\t5G Session Management protocol\nADC\tApplication Detection and Control\nAF\tApplication Function\nAS\tApplication Server\nASP\tApplication Service Provider\nATSSS\tAccess Traffic Steering, Switching and Splitting\nAVP\tAttribute Value Pair\nBBF\tBroadband Forum\nCHEM\tCoverage and Handoff Enhancements using Multimedia error robustness feature\nCRF\tCharging Rules Function\nDRMP\tDiameter Routing Message Priority\nDSCP\tDifferentiated Services Code Point\nDTS\tData Transport Service\nDSL\tDigital Subscriber Line\nFLUS\tFramework for Live Uplink Streaming\nGCS\tGroup Communication Service\nGCS AS\tGroup Communication Service Application Server\nHFC\tHybrid Fiber Coax\nIP-CAN\tIP Connectivity Access Network\nMA\tMulti-Access\nMPS\tMultimedia Priority Service\nN3IWF\tNon-3GPP Interworking Function\nN5CW\tNon-5G-Capable over WLAN\nNGAP\tNG Application Protocol\nNID\tNetwork Identifier\nPCC\tPolicy and Charging Control\nPCEF\tPolicy and Charging Enforcement Function\nPCF\tPolicy Control Function\nPCRF\tPolicy and Charging Rule Function\nPDF\tPolicy Decision Function\nP-CSCF\tProxy-Call Session Control Function\nPON\tPassive Optical Network\nPSAP\tPublic Safety Answering Point\nQoS\tQuality of Service\nRCAF\tRAN Congestion Awareness Function\nRLOS\tRestricted Local Operator Services\nSCEF\tService Capability Exposure Function\nSCS\tService Capability Server\nSDF\tService Data Flow\nSMF\tSession Management Function\nSNPN\tStand-alone Non-Public Network\nSPR\tSubscriber Profile Repository\nTDF\tTraffic Detection Function\nTNAP\tTrusted Non-3GPP Access Point\nTNGF\tTrusted Non-3GPP Gateway Function\nTWAP\tTrusted WLAN Access Point\nTWIF\tTrusted WLAN Interworking Function\nUDC\tUser Data Convergence\nUE\tUser Equipment\nUDR\tUser Data Repository\nXML\tExtensible Markup Language\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tRx reference point",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tOverview",
                    "description": "",
                    "summary": "",
                    "text_content": "The Rx reference point is used to exchange application level session information:\n-\tand the Application Function (AF); and\n-\tin the 5GS, between the Policy Control Function (PCF) between\nthe Policy and Charging Rules Function (PCRF) and the Application Function (AF). As defined in the stage 2 specifications (3GPP TS 23.203 [2]), this information is part of the input used by the PCRF for the Policy and Charging Control (PCC) decisions. The PCRF exchanges the PCC rules with the Policy and Charging Enforcement Function (PCEF) and QoS rules with the Bearer Binding and Event Reporting Function (BBERF) as specified in 3GPP TS 29.212 [8].\nPolicy and Charging Control over Rx interface in the 5GS is specified in annex E.\nSignalling flows related to the both Rx and Gx interfaces are specified in 3GPP TS 29.213 [9].\nRefer to Annex G of 3GPP TS 29.213 [9] for Diameter overload control procedures over the Rx interface.\nRefer to Annex J of 3GPP TS 29.213 [9] for Diameter message priority mechanism procedures over the Rx interface.\nRefer to Annex K of 3GPP TS 29.213 [9] for Diameter load control procedures over the Rx interface.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tRx reference model",
                    "description": "",
                    "summary": "",
                    "text_content": "The Rx reference point is defined between the PCRF and the AF. The relationships between the different functional entities involved are depicted in figure 4.2.1. The overall PCC architecture is depicted in clause 3a of 3GPP TS 29.213 [9].\nThe figure depicts a simplified model of a wireless communication system, specifically focusing on the role of the radio frequency (RF) signal in a 5G network. It illustrates the signal propagation in a 5G network, highlighting the various paths through which signals can be reflected off buildings and combine at the receiver. Key components of the figure include the base station (gNB), user equipment (UE), and scatterers. The diagram also shows the use of beamforming techniques to mitigate interference.\nFigure 4.2.1: Rx reference model\nFigure 4.2.2: Void\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.3\tFunctional elements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.3.1\tAF",
                            "text_content": "The AF is an element offering applications that require the Policy and Charging Control of traffic plane resources (e.g. UMTS PS domain/GPRS domain resources). One example of an application function is the P-CSCF. The AF shall use the Rx reference point to provide session information to the PCRF.\nNOTE:\tThe AFs may be deployed by the same operator offering the IP-CAN or may be provided by external third party service provider.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.2\tPCRF",
                            "text_content": "The PCRF (Policy Control and Charging Rules Function) is a functional element that encompasses policy control decision and flow based charging control functionalities. These 2 functionalities are the heritage of the release 6 logical entities PDF and CRF respectively. The PCRF provides network control regarding the service data flow detection, gating, QoS and flow based charging (except credit management) towards the PCEF. The PCRF receives session and media related information from the AF and informs AF of traffic plane events.\nThe PCRF may check that the service information provided by the AF is consistent with the operator defined policy rules before storing the service information. The service information shall be used to derive the QoS for the service. The PCRF may reject the request received from the AF and as a result the PCRF shall indicate, in the response to the AF, the service information that can be accepted by the PCRF.\nThe PCRF may temporarily not be able to provide the service delivery that AF requested (e.g. due to RAN user plane congestion). In this case, the PCRF may send a re-try interval information to the AF. The re-try interval indicates when service delivery may be retried by the AF over Rx.\nNOTE 1:\tAdditionally, existing bandwidth limitation parameters (e.g. Max-Requested-Bandwidth-DL AVP, Max-Requested-Bandwidth-UL AVP within the Acceptable-Service-Info AVP) provided by the PCRF to the AF in AA-Answer command during the Rx session establishment are available in order to mitigate RAN user plane congestion.\nThe PCRF may use the subscription information as basis for the policy and charging control decisions. The subscription information may apply for both session based and non-session based services. The subscription specific information for each service may contain e.g. max QoS class and max bit rate.\nIf the AF requests it, the PCRF shall report IP-CAN session events (including bearer events and events on AF signalling transport) to the AF via the Rx reference point.\nThe PCRF PCC/QoS Rule decisions may be based on one or more of the following:\n-\tthe session and media related information obtained from the AF via the Rx reference point;\n-\tthe bearer and subscriber related information obtained from the PCEF over the Gx reference point;\n-\tthe bearer and subscriber related information obtained from the BBERF over the Gxx reference point;\n-\tsubscriber and service related data the PCRF may be aware of by configuration or through the Sp reference point;\n-\tpre-configured information in the PCRF.\nNOTE 2:\tThe details associated with the Sp reference point are not specified in this Release. The SPR’s relation to existing subscriber databases is not specified in this Release.\nThe PCRF shall provision PCC/QoS Rules to the PCEF/BBERF via the Gx/Gxx reference point.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.4\tPCC procedures over Rx reference point",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.4.1\tInitial Provisioning of Session Information",
                            "text_content": "When a new AF session is being established and media information for this AF session is available at the AF and the related media require PCC supervision, the AF shall open an Rx Diameter session with the PCRF for the AF session using an AA-Request command, unless an Rx session has already been established for the AF session (e.g. as per clause 4.4.6.7). If an Rx Diameter session already exists for the AF session, the AF uses the existing Rx Diameter session. The AF shall provide the full IP address of the UE using either Framed-IP-Address AVP or Framed-Ipv6-Prefix AVP, and the corresponding Service Information within Media-Component-Description AVP(s). The AF shall not include circuit-switched bearer related media in the service information sent to the PCRF. The AF shall indicate to the PCRF as part of the Media-Component-Description whether the media IP flow(s) should be enabled or disabled with the Flow-Status AVP.\nNOTE 1:\tThe AF does not need to open an Rx Diameter session with the PCRF, if the SDP payload is only proposing to use a circuit-switched bearer (i.e. \"c=\" line set to \"PSTN\" and an \"m=\" line set to \"PSTN\", refer to 3GPP TS 24.292 [26]).\nNOTE 2:\tThe Rx Diameter session used for an AF session is different from the Rx Diameter session possibly used for the notifications of the status of the AF signalling transmission path. A new Rx Diameter session is established for each new AF session.\nThe AF may include the AF-Application-Identifier AVP into the AA-Request in order to indicate the particular service that the AF session belongs to. This AVP can be provided at both AF session level, and Media-Component-Description level. When provided at both levels, the AF-Application Identifier provided within the Media-Component-Description AVP will have precedence. The AF may also include an AF application identifier within the AF-Application-Identifier AVP at the AF session level to trigger the PCRF to indicate to the PCEF/TDF to perform the application detection based on the operator’s policy as defined in 3GPP TS 29.212 [8].\nThe AF may include the AF-Charging-Identifier AVP into the AA-Request for charging correlation purposes. The AF may also include the Specific-Action AVP to request notification for certain user plane events, e.g. bearer termination.\nThe AF may include the Service-URN AVP in order to indicate that the new AF session relates to emergency or RLOS traffic and additionally it may include the AF-Requested-Data AVP to indicate the information required by the AF. If the PCRF receives the Service-URN AVP indicating an emergency session, the PCRF may apply special policies, for instance prioritising service flows relating to the new AF session or allowing these service flows free of charge. If the Service-URN AVP indicates that the new AF session relates to emergency traffic and the AF-Requested-Data AVP is received, the PCRF shall provide the requested available user information as part of the AA-Answer command.\nThe AF may include the MPS-Identifier AVP in order to indicate that the new AF session relates to an MPS session. If the PCRF receives the MPS-Identifier AVP indicating an MPS session, the PCRF may take specific actions on the corresponding IP-CAN to ensure that the MPS session is prioritized as specified in 3GPP TS 29.212 [8]. For Multimedia Priority Service handling for IMS, see Annex A.9.\nThe AF may include the MCPTT-Identifier AVP in order to indicate that the new AF session relates to an MCPTT session with priority call. If the PCRF receives the MCPTT-Identifier AVP related to that MCPTT session, the PCRF may take specific actions on the corresponding IP-CAN to ensure that the MCPTT session is prioritized. For the handling of MCPTT session with priority call, see Annex A.13.\nThe AF may include the MCVideo-Identifier AVP in order to indicate that the new AF session relates to an MCVideo session with priority call. If the PCRF receives the MCVideo-Identifier AVP related to that MCVideo session, the PCRF may take specific actions on the corresponding IP-CAN to ensure that the MCVideo session is prioritized. For the handling of MCVideo session with priority call, see Annex A.15.\nIf the QoSHint feature is supported by the AF, the AF may include the Desired-Max-Latency AVP and/or Desired-Max-Loss AVP within the Media-Component-Description AVP to indicate to the PCRF that the related application media has specific latency and/or loss demands.\nThe AF may include the FLUS-Identifier AVP within the Media-Component-Description AVP in order to indicate to the PCRF that the media flow(s) correspond to a FLUS media stream. Additional QoS information for the treatment of FLUS media may be provided within Desired-Max-Latency AVP and/or Desired-Max-Loss AVP.\nThe AF may include the Priority-Sharing-Indicator AVP set to PRIORITY_SHARING_ENABLED within the Media-Component-Description AVP in order to indicate to the PCRF that the related media flow is allowed to use the same Allocation and Retention Priority (ARP) as media flows belonging to other AF sessions as described in clause 4.4.8. In this case, if the MCPTT-Preemption is supported, the AF may also include the Pre-emption-Capability AVP containing the suggested pre-emption capability value and the Pre-emption-Vulnerability AVP containing the suggested pre-emption vulnerability value within the Media-Component-Description AVP for the PCRF to determine the ARP values. The AF may also include the Pre-emption-Control-Info AVP containing the pre-emption control information at the AAR command level for the PCRF to perform the pre-emption control as defined in clause 4.5.27 or 4a.5.17 of 3GPP TS 29.212 [8].\nThe AF may include the Sharing-Key-UL and/or Sharing-Key-DL AVP within the Media-Component-Description AVP in order to indicate that the related media of the new AF session may share resources with other media components in the related direction that include the same value for the Sharing-Key-UL AVP and/or Sharing-Key-DL AVP.\nWhen the AF is a GCS AS, it may include the GCS-Identifier AVP at command level and Reservation-Priority AVP at command level or media component level in order to indicate that the new AF session relates to a prioritized Group Communication session. Based on this information, the PCRF may take specific actions on the corresponding IP-CAN to ensure that the Group Communication session is prioritized as specified in 3GPP TS 29.212 [8].\nIf the AF provides service information that has been fully negotiated (e.g. based on the SDP answer), the AF may include the Service-Info-Status AVP set to FINAL_SERVICE_INFORMATION. In this case the PCRF shall authorize the session and provision the corresponding PCC/QoS rules to the PCEF/BBERF.\nThe AF may additionally provide preliminary service information not fully negotiated yet (e.g. based on the SDP offer) at an earlier stage. To do so, the AF shall include the Service-Info-Status AVP with the value set to PRELIMINARY SERVICE INFORMATION. Upon receipt of such preliminary service information, the PCRF shall perform an early authorization check of the service information. For GPRS, the PCRF shall not provision PCC rules towards the PCEF unsolicitedly. However, the PCRF may authorize a PCC/QoS rule request received from the PCEF/BBERF as per 3GPP TS 29.212 [8]. Further, if the AF requests the PCRF to report the access network information together with preliminary service information, the PCRF shall immediately configure the PCEF (or BBERF) to provide the access network information.\nFor sponsored data connectivity and if SponsoredConnectivity is supported, the AF shall provide the application service provider identity and the sponsor identity to the PCRF by including the Application-Service-Provider-Identity AVP and the Sponsor-Identity AVP in the Sponsored-Connectivity-Data AVP in the AA-Request. Additionally if SponsorChange is supported the AF shall provide an indication whether to enable or not enable sponsored data connectivity to the PCRF by including the Sponsoring-Action AVP set to the applicable value.\nNOTE 3:\tThe relationship between the AF and Sponsor is out of scope of this specification. A single AF can serve multiple ASPs and multiple sponsors, An ASP can also be a sponsor.\nTo support the usage monitoring of sponsored data connectivity, the AF may also include the Granted-Service-Unit AVP in the Sponsored-Connectivity-Data AVP and the Specific-Action AVP set to the value USAGE_REPORT in the AA-Request to request notification when the usage threshold has been reached.\nNOTE 4:\tIf the AF is in the user plane, the AF can handle the usage monitoring and therefore it is not required to provide a usage threshold to the PCRF as part of the sponsored data connectivity information.\nWhen SponsoredConnectivity is supported or when SponsorChange is supported and the AF indicated to enable sponsored data connectivity, the following procedures apply:\n-\tIf the UE is roaming with the visited access case and the AF is located in the HPLMN or roaming with the home routed case and operator policies do not allow accessing the sponsored data connectivity with this roaming case, the H-PCRF shall reject the service request indicating UNAUTHORIZED_SPONSORED_DATA_CONNECTIVITY to the AF.\n-\tIf the UE is roaming with the visited access case and the AF is located in the VPLMN, the V-PCRF shall reject the service request indicating UNAUTHORIZED_SPONSORED_DATA_CONNECTIVITY to the AF.\nWhen SponsoredConnectivity is supported or when SponsorChange is supported and the AF indicated to enable sponsored data connectivity, if the UE is in the non-roaming case or roaming with the home routed case and the operator policies allow accessing the sponsored data connectivity with this roaming case, the following procedures apply:\n-\tIf the PCEF/TDF does not support sponsored connectivity and the required reporting level for that service indicates a sponsored connectivity level according to 3GPP TS 29.212 [8], then the PCRF shall reject the request indicating REQUESTED_SERVICE_NOT_AUTHORIZED.\n-\tIf the PCEF/TDF supports sponsored data connectivity feature or the required reporting level is different from sponsored connectivity level as described in 3GPP TS 29.212 [8], then the PCRF, based on operator policies, shall check whether it is required to validate the sponsored connectivity data. If it is required, it shall perform the authorizations based on sponsored data connectivity profiles. If the authorization fails, the PCRF responds to the AF with an AA-Answer including the Experimental-Result-Code AVP set to the value UNAUTHORIZED_SPONSORED_DATA_CONNECTIVITY. The profile may include a list of Application Service Providers and their applications per sponsor.\nNOTE 5:\tIf the AF is in the operator’s network and is based on the OSA/Parlay-X GW, the PCRF is not required to verify that a trust relationship exists between the operator and the sponsors.\nWhen CHEM feature is supported, the AF includes the Max-PLR-DL AVP and/or Max-PLR-UL AVP within the Media-Component-Description AVP, to indicate the downlink maximum packet loss rate and/or uplink maximum packet loss rate for each payload type. For CHEM feature, see Annex A.18.\nWhen the PCRF receives an initial AA-Request from the AF, the PCRF shall perform session binding as described in 3GPP TS 29.213 [9]. To allow the PCRF to identify the IP-CAN session for which this request applies, the AF shall provide either the Framed-IP-Address or the Framed-Ipv6-Prefix containing the full IP address applicable to an IP flow or IP flows towards the UE. In case of private IP address being used, the AF may provide PDN information if available in the Called-Station-Id AVP for session binding. The AF may provide the domain identity in the IP-Domain-Id AVP for session binding.\nNOTE 6:\tThe IP-Domain-Id AVP is helpful in the following scenario: Within a PLMN, there are several separate IP address domains, with PCEF(s) that allocate Ipv4 IP addresses out of the same private address range to UEs. The same IP address can thus be allocated to UEs served by PCEFs in different address domains. If one PCRF controls several PCEFs in different IP address domains, the UE IP address is thus not sufficient for the session binding. An AF can serve UEs in different IP address domains, either by having direct IP interfaces to those domains, or by having interconnections via NATs in the user plane between PCEFs and the AF. If a NAT is used, the AF obtains the IP address allocated to the UE via application level signalling and supplies it for the session binding as Framed-IP-Address to the PCRF. The AF supplies an IP-Domain-Id value denoting the IP address domain behind the NAT in addition. The AF can derive the appropriate value from the source address (allocated by the NAT) of incoming user plane packets. The value provided in the IP-Domain-Id AVP is operator configurable.\nNOTE 7:\tWhen the scenario described in NOTE 6 applies and the AF is a P-CSCF it is assumed that the P-CSCF has direct IP interfaces to the different IP address domains and that no NAT is located between P-GW and P-CSCF. How a non-IMS AF obtains the UE private IP address to be provided to the PCRF is out of scope of the present release; it is unspecified how to support applications that use a protocol that does not retain the original UE’s private IP address.\nIf the PCRF fails in executing session binding, the PCRF responds to the AF with an AA-Answer including the Experimental-Result-Code AVP set to the value IP-CAN_SESSION_NOT_AVAILABLE. Further details on how the PCRF identifies suitable IP-CAN sessions can be found in the binding mechanism described in 3GPP TS 29.213 [9].\nIf the request contains Media-Component-Description Attribute-Value Pair(s) (AVP(s)) the PCRF shall store the received Service Information. The PCRF shall process the received Service Information according to the operator policy and may decide whether the request is accepted or not. The PCRF may take the priority information within the Reservation-Priority AVP into account when making this decision.\nFor an IP-CAN session associated to a dedicated APN for the purpose of offering services to remote UEs via a ProSe UE-to-network relay UE, as defined in 3GPP TS 23.303 [46], the PCRF shall validate the service information based on the service/roaming agreement and the operator policies related to that PDN information.\nNOTE 8:\tThe PCRF is not required to be aware of the remote UE.\nIf the service information provided in the AA-Request command is rejected (e.g. the subscribed guaranteed bandwidth for a particular user is exceeded), the PCRF shall indicate in the AA-Answer command the cause for the rejection with the Experimental-Result-Code AVP set to the value REQUESTED_SERVICE_NOT_AUTHORIZED. If the service information provided in the AA-Request command is rejected by the PCRF due to a temporary condition in the network (e.g. the user plane in the cell the user is located is congested), the PCRF may indicate in the AA-Answer the cause for the rejection with the Experimental-Result-Code AVP set to the value REQUESTED_SERVICE_TEMPORARILY_NOT_AUTHORIZED (4261). The PCRF may also provide a retry-interval within the Retry-Interval AVP in the AA-Answer command to the AF. When the AF receives the re-try interval within the Retry-Interval AVP, the AF shall not send the same service information to the PCRF again (for the same IP-CAN session) until the re-try interval has elapsed. The PCRF may additionally provide the acceptable bandwidth within the Acceptable-Service-Info AVP in AA-Answer command.\nNOTE 9:\tHow the PCRF derives the re-try interval is up to implementation.\nTo allow the PCRF and PCEF to perform PCC rule authorization and bearer binding for the described service IP flows, the AF shall supply both source and destination IP addresses and port numbers within the Flow-Description AVP, if such information is available.\nNOTE 10:\tIn SDP source port information is usually not available.\nThe AF may specify the ToS-Traffic-Class AVP for the described service data flows together with the Flow-Description AVP.\nNOTE 11:\tThe ToS-Traffic-Class AVP can be useful when another packet filter attribute is needed to differentiate between flows. For example, (when EPS bearers are used for group communication services) flows encapsulated and encrypted by a tunneling protocol and thus having their IP five-tuple attributes obscured can be differentiated by the Type of Service (or Traffic Class) value of the outer header.\nNOTE 12:\tThe use of ToS-Traffic-Class AVP by the AF assumes that no DSCP re-marking is applied from the application to the PGW.\nThe AF may specify the Reservation-Priority AVP at request level in the AA-Request in order to assign a priority to the AF Session as well as specify the Reservation-Priority AVP at the media-component-description AVP level to assign a priority to the IP flow. The presence of the Reservation-Priority in both levels does not constitute a conflict as they each represent different types of priority. Specifically the Reservation-Priority at the AA-Request level provides the relative priority for a session while the Reservation-Priority at the media-component-description level provides the relative priority for an IP flow within a session. If the Reservation-Priority AVP is not specified the requested priority is DEFAULT (0).\nThe AF may request notifications of specific IP-CAN session events through the usage of the Specific-Action AVP in the AA-Request command. The PCRF shall make sure to inform the AF of the requested notifications in the event that they take place.\nThe AF may include the Rx-Request-Type AVP set to INITIAL_REQUEST in the .\nThe AF may include a Reference Id within the Reference-Id AVP related to a transfer policy negotiated for background data transfer via the Nt reference point as described in 3GPP TS 29.154 [47]. The PCRF shall retrieve the corresponding transfer policy from the SPR based on the Reference Id. If the PCRF can not retrieve the transfer policy, the PCRF shall include in the AA-Answer the Service-Authorization-Info AVP with the bit 0 set to indicate that the transfer policy is unknown. If the time window of the received transfer policy has expired, the PCRF shall include in the AA-Answer the Service-Authorization-Info AVP with the bit 1set to indicate that the transfer policy has expired. Otherwise, if the time window of the received transfer policy has not yet occurred, the PCRF shall include in the AA-Answer the Service-Authorization-Info AVP with the bit 2 set to indicate that the time window of the transfer policy has not yet occurred.\nNOTE 13:\tIn the case that the PCRF can not retrieve the transfer policy or the transfer policy expired, the PCRF makes the decision without considering the transfer policy.\nNOTE 14:\tWhen receiving the reference id from the 3rd party SCS/AS as described in 3GPP TS 23.682 [40], the SCEF (acting as an AF) can provide the reference id together with the sponsored data connectivity information if SponsorChange is supported as described in this clause.\nThe AF may include the IMS-Content-Type AVP into the AA-Request in order to indicate the type of IMS communication service (e.g. CAT service, 3PTY conference) the AF session refers to.\nThe AF may include the IMS-Content-Identifier AVP into the AA-Request in order to indicate the particular IMS communication service or communication dialogue that the AF session refers to.\nThe AF may include the Calling-Party-Address AVP and the Callee-Information AVP into the AA-Request in order to indicate the caller and the callee information that the AF session refers to.\nThe PCRF shall check whether the received Service Information requires PCC/QoS Rules to be created and provisioned and/or authorized QoS to be provisioned as specified in 3GPP TS 29.213 [9]. Provisioning of PCC/QoS Rules and Authorized QoS to the PCEF/BBERF shall be carried out as specified at 3GPP TS 29.212 [8].\nIf the Sharing-Key-UL AVP and/or Sharing-Key-DL AVP are provided within the Media-Component-Description AVP, the PCRF may apply the mechanisms for resource sharing as specified at 3GPP TS 29.212 [8].\nThe PCRF shall reply with an AA-Answer to the AF. The acknowledgement towards the AF should take place before or in parallel with any required PCC Rule provisioning towards the PCEF and shall include the Access-Network-Charging-Identifier(s) and may include the Access-Network-Charging-Address AVP, if they are available. The AA-Answer message shall also include the AN-GW-Address AVP, if the PCRF has previously requested to be updated with this information in the PCEF. The AA-Answer message shall also include the PLMN identifier within the 3GPP-SGSN-MCC-MNC AVP if the PCRF has previously requested to be updated with this information in the PCEF/BBERF. The AA-Answer message shall also include the IP-CAN-Type AVP. if the PCRF has previously requested to be updated with this information in the PCEF/BBERF. In that case, the AA-Answer message shall also include the RAT type information within the RAT-Type AVP and AN-Trusted AVP when applicable for the specific IP-CAN Type. In addition, if IP flow mobility applies to service data flows as specified in 3GPP TS 29.212 [8], such that a subset of the flows within the AF session are affected, the PCRF shall also include IP-CAN-type and RAT type information (if applicable) to IP flow mobility related flows, if such information is available. The IP flow mobility affected service data flows are included within the Flows AVP at command level. If the PCRF needs to terminate the Rx session before it has sent the AA Answer, the PCRF shall send the AA Answer immediately and before the AS Request.\nThe behaviour when the AF does not receive the AA Answer, or when it arrives after the internal timer waiting for it has expired, or when it arrives with an indication different than DIAMETER_SUCCESS, are outside the scope of this specification and based on operator policy.\nIf the PCRF fails in installing PCC/QoS rules based on the provided service information due to resource allocation failure as specified in 3GPP TS 29.212 [8] and if requested by the AF, the PCRF shall send an RAR command to the AF with the Specific-Action AVP set to the value INDICATION_OF_FAILED_RESOURCES_ALLOCATION to report the resource allocation failure, the Flows AVP containing the service data flows corresponding to the resources that could not be allocated, and the content version within the Content-Version AVP if it was included when the corresponding media component was provisioned. The AF shall send an RAA command to acknowledge the RAR command.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.2\tModification of Session Information",
                            "text_content": "The AF may modify the session information at any time (e.g. due to an AF session modification or internal AF trigger) by sending an AA-Request command to the PCRF containing the Media-Component-Description AVP(s) with the updated Service Information. The AF shall send an AA-Request command to the PCRF, only after the previous AA-Request has been acknowledged.\nIf the AF provides service information that has been fully negotiated (e.g. based on the SDP answer), the AF may include the Service-Info-Status AVP set to FINAL_SERVICE_INFORMATION. In this case the PCRF shall authorize the session and provision the corresponding PCC rules to the PCEF.\nThe AF may additionally provide preliminary service information not fully negotiated yet (e.g. based on the SDP offer) at an earlier stage. To do so, the AF shall include the Service-Info-Status AVP with the value set to PRELIMINARY SERVICE INFORMATION. Upon receipt of such preliminary service information, the PCRF shall perform an early authorization check of the service information. For GPRS, the PCRF shall not provision PCC rules towards the PCEF unsolicitedly. However, the PCRF may authorize a PCC/QoS rule request received from the PCEF/BBERF as per 3GPP TS 29.212 [8]. Further, if the AF requests the PCRF to report the access network information together with preliminary service information, the PCRF shall immediately configure the PCEF (or BBERF) to provide the access network information.\nThe AF may include the Rx-Request-Type AVP set to UPDATE_REQUEST in the .\nThe AF may include a Reference Id within the Reference-Id AVP related to a transfer policy negotiated for background data transfer via the Nt reference point as described in 3GPP TS 29.154 [47]. The AF shall retrieve the corresponding transfer policy from the SPR based on the Reference Id. If the PCRF can not retrieve the transfer policy, the PCRF shall include in the AA-Answer the Service-Authorization-Info AVP with the bit 0 set to indicate that the transfer policy is unknown. If the time window of the received transfer policy has expired, the PCRF shall include in the AA-Answer the Service-Authorization-Info AVP with the bit 1set to indicate that the transfer policy has expired. Otherwise, if the time window of the received transfer policy has not yet occurred, the PCRF shall include in the AA-Answer the Service-Authorization-Info AVP with the bit 2 set to indicate that the time window of the transfer policy has not yet occurred.\nNOTE 1:\tIn the case that the PCRF can not retrieve the transfer policy or the transfer policy expired, the PCRF makes the decision without considering the transfer policy.\nNOTE 2: When receiving the reference id from the 3rd party SCS/AS as described in 3GPP TS 23.682 [40], the SCEF (acting as an AF) can provide the reference id together with the sponsored data connectivity information if SponsorChange is supported as described in this clause.\nThe AF may include the MPS-Identifier AVP in order to indicate that the modified AF session relates to an MPS session. If the PCRF receives the MPS-Identifier AVP, it may take specific actions on the corresponding IP-CAN to ensure that the MPS session is prioritized as defined in 3GPP TS 29.212 [8]. For Multimedia Priority Service handling for IMS, see Annex A.9.\nThe AF may include the MCPTT-Identifier AVP in order to indicate that the modified AF session relates to the priority adjustment of an MCPTT session. If the PCRF receives the MCPTT-Identifier AVP related to that MCPTT session, the PCRF may take specific actions on the corresponding IP-CAN to ensure that the MCPTT session is prioritized. For the handling of MCPTT session with priority call, see Annex A.13.\nThe AF may include the MCVideo-Identifier AVP in order to indicate that the modified AF session relates to the priority adjustment of an MCVideo session. If the PCRF receives the MCVideo-Identifier AVP related to that MCVideo session, the PCRF may take specific actions on the corresponding IP-CAN to ensure that the MCVideo session is prioritized. For the handling of MCVideo session with priority call, see Annex A.15.\nIf the QoSHint feature is supported by the AF, the AF may include the Desired-Max-Latency AVP and/or Desired-Max-Loss AVP within the Media-Component-Description AVP to indicate to the PCRF that the related application media has specific latency and/or loss demands.\nThe AF may include the FLUS-Identifier AVP within the Media-Component-Description AVP in order to indicate to the PCRF that the media flow(s) correspond to a FLUS media stream. Additional QoS information for the treatment of FLUS media may be provided within Desired-Max-Latency AVP and/or Desired-Max-Loss AVP.\nThe AF may include the Priority-Sharing-Indicator AVP set to PRIORITY_SHARING_ENABLED within the Media-Component-Description AVP in order to indicate to the PCRF that the related media flow is allowed to use the same Allocation and Retention Priority (ARP) as media flows belonging to other AF sessions as described in clause 4.4.8. In this case, if the MCPTT-Preemption is supported, the AF may also include the Pre-emption-Capability AVP containing the suggested pre-emption capability value and the Pre-emption-Vulnerability AVP containing the suggested pre-emption vulnerability value within the Media-Component-Description AVP for the PCRF to determine the ARP values. The AF may also include the Pre-emption-Control-Info AVP containing the pre-emption control information at the AAR command level for the PCRF to perform the pre-emption control as defined in clause 4.5.27 or 4a.5.17 of 3GPP TS 29.212 [8].\nThe AF may include the Sharing-Key-UL AVP and/or Sharing-Key-DL AVP within the Media-Component-Description AVP in order to indicate that the related media of the modified AF session may share resources with other media components in the related direction that include the same Sharing-Key-UL and or Sharing-Key-DL AVP. The AF may modify the conditions for resource sharing by including a new value of the Sharing-Key-UL AVP and/or Sharing-Key-DL AVP for that media component.\nWhen the AF is a GCS AS, it may include the GCS-Identifier AVP at command level and Reservation-Priority AVP at command level or media component level in order to modify the priority of an AF session that relates to a prioritized Group Communication session. Based on this information, the PCRF may take specific actions on the corresponding IP-CAN to ensure that the Group Communication session is prioritized as specified in 3GPP TS 29.212 [8].\nFor sponsored data connectivity and if SponsoredConnectivity is supported, the AF shall provide the application service provider identity and the sponsor identity to the PCRF by including Application-Service-Provider-Identity AVP and the Sponsor-Identity AVP in the Sponsored-Connectivity-Data AVP in the AA-Request.\nIf SponsorChange is supported and the AF requests to enable sponsored data connectivity the AF shall provide the application service provider identity, the sponsor identity and an indication to enable sponsored data connectivity to the PCRF by including Application-Service-Provider-Identity AVP, the Sponsor-Identity AVP and the Sponsoring-Action AVP set to the value ENABLE_SPONSORING (1) in the Sponsored-Connectivity-Data AVP in the AA-Request.\nIf the AF requests to disable sponsored data connectivity the AF shall provide an indication to disable sponsored data connectivity to the PCRF by including the Sponsoring-Action AVP set to the value DISABLE_SPONSORING (0) in the Sponsored-Connectivity-Data AVP in the AA-Request.\nTo support the usage monitoring of sponsored data connectivity, the AF may also include the Granted-Service-Unit AVP in the Sponsored-Connectivity-Data AVP in the AA-Request.\nNOTE 3:\tIf the AF is in the user plane, the AF can handle the usage monitoring and therefore it is not required to provide a usage threshold to the PCRF as part of the sponsored data connectivity information.\nWhen sponsored data connectivity is requested to be enabled the following procedures apply:\n-\tIf the UE is roaming with the visited access case and the AF is located in the HPLMN or roaming with the home routed case and operator policies do not allow accessing the sponsored data connectivity with this roaming case, the H-PCRF shall reject the service request indicating UNAUTHORIZED_SPONSORED_DATA_CONNECTIVITY to the AF.\n-\tIf the UE is roaming with the visited access case and the AF is located in the VPLMN, the V-PCRF shall reject the service request indicating UNAUTHORIZED_SPONSORED_DATA_CONNECTIVITY to the AF.\nWhen sponsored data connectivity is requested to be enabled, if the UE is in the non-roaming case or roaming with the home routed case and the operator policies allow accessing the sponsored data connectivity with this roaming case, the following procedures apply:\n-\tIf the PCEF/TDF does not support sponsored connectivity and the required reporting level for that service indicates a sponsored connectivity level according to 3GPP TS 29.212 [8], then the PCRF shall reject the request indicating REQUESTED_SERVICE_NOT_AUTHORIZED.\n-\tIf the PCEF/TDF supports sponsored data connectivity feature or the required reporting level is different from sponsored connectivity level as described in 3GPP TS 29.212 [8], then the PCRF, based on operator policies, shall check whether it is required to validate the sponsored connectivity data. If it is required, it shall perform the authorizations based on sponsored data connectivity profiles. If the authorization fails, the PCRF responds to the AF with an AA-Answer including the Experimental-Result-Code AVP set to the value UNAUTHORIZED_SPONSORED_DATA_CONNECTIVITY. The profile may include a list of Application Service Providers and their applications per sponsor.\nNOTE 4:\tIf the AF is in the operator's network and is based on the OSA/Parlay-X GW, the PCRF is not required to verify that a trust relationship exists between the operator and the sponsors.\nWhen CHEM feature is supported, the AF includes the Max-PLR-DL AVP and/or Max-PLR-UL AVP within the Media-Component-Description AVP, to indicate the downlink maximum packet loss rate and/or uplink maximum packet loss rate for each payload type. For CHEM feature, see Annex A.18.\nThe AF may include an AF application identifier within the AF-Application-Identifier AVP at the session level to trigger the PCRF to indicate to the PCEF/TDF to perform the application detection based on the operator’s policy as defined in 3GPP TS 29.212 [8].\nThe AF may include the IMS-Content-Type AVP into the AA-Request in order to indicate the type of IMS communication service (e.g. CAT service, 3PTY conference) the AF session refers to.\nThe AF may include the IMS-Content-Identifier AVP into the AA-Request in order to indicate the particular IMS communication service or communication dialogue that the AF session refers to.\nThe AF may include the Callee-Information AVP into the AA-Request in order to indicate the callee information that the AF session refers to.\nThe PCRF shall process the received Service Information according the operator policy and may decide whether the request is accepted or not. If the updated Service Information is not acceptable (e.g. subscribed guaranteed bandwidth for a particular user is exceeded), the PCRF shall indicate in the AA-Answer command the cause for the rejection with the Experimental-Result-Code AVP set to the value REQUESTED_SERVICE_NOT_AUTHORIZED. If the service information provided in the AA-Request command is rejected by the PCRF due to a temporary condition in the network (e.g. the user plane in the cell the user is located is congested), the PCRF may indicate in the AA-Answer the cause for the rejection with the Experimental-Result-Code AVP set to the value REQUESTED_SERVICE_TEMPORARILY_NOT_AUTHORIZED (4261). The PCRF may also provide a retry-interval within the Retry-Interval AVP in the AA-Answer command to the AF. When the AF receives the re-try interval within the Retry-Interval AVP, the AF shall not send the same service information to the PCRF again (for the same IP-CAN session) until the re-try interval has elapsed. The PCRF may additionally provide the acceptable bandwidth within the Acceptable-Service-Info AVP in the AA-Answer command.\nNOTE 5:\tHow the PCRF derives the re-try interval is up to implementation.\nIf accepted, the PCRF shall update the Service Information with the new information received. Due to the updated Service Information, the PCRF may need to create, modify or delete the related PCC rules as specified in 3GPP TS 29.213 [9] and provide the updated information towards the PCEF following the corresponding procedures specified at 3GPP TS 29.212 [8]. The procedures to update the Authorized QoS for the affected IP-CAN bearer are also specified at 3GPP TS 29.212 [8].\nIf the Sharing-Key-UL AVP and/or Sharing-Key-DL AVP are provided within the Media-Component-Description AVP, the PCRF may apply the mechanisms for resource sharing as specified at 3GPP TS 29.212 [8].\nThe PCRF shall reply with an AA-Answer to the AF. The acknowledgement towards the AF should take place before or in parallel with any required PCC Rule provisioning towards the PCEF and shall include the Access-Network-Charging-Identifier(s) and may include the Access-Network-Charging-Address AVP, if they are available at this moment and have not been yet supplied earlier to the AF. The AA-Answer message shall include the AN-GW-Address AVP if the PCRF has previously requested to be updated with this information in the PCEF. The AA-Answer message shall also include the PLMN identifier within the 3GPP-SGSN-MCC-MNC AVP if the PCRF has previously requested to be updated with this information in the PCEF/BBERF. The AA-Answer message shall also include the IP-CAN-Type AVP if the PCRF has previously requested to be updated with this information in the PCEF/BBERF . In that case, the AA-Answer message shall also include the RAT type information within the RAT-Type AVP and AN-Trusted AVP when applicable for the specific IP-CAN Type. In addition, if IP flow mobility applies to service data flows as specified in 3GPP TS 29.212 [8], such that a subset of the flows within the AF session are affected, the PCRF shall also include IP-CAN-type and RAT type information (if applicable) to IP flow mobility related flows, if the PCRF has previously requested to be updated with this information in the PCEF. The IP flow mobility affected service data flows are included within the Flows AVP at command level. If the PCRF needs to terminate the Rx session before it has sent the AA Answer, the PCRF shall send the AA Answer immediately and before the AS Request. If the PCRF does not have an existing session for the Rx session being modified (such as after a PCRF failure), the PCRF may reject the request with an AA-Answer with the result code set to DIAMETER_UNKNOWN_SESSION_ID.\nIf the PCRF installs PCC/QoS rules or modifies existing PCC/QoS rules based on the updated service information and the installation or modification fails due to resource allocation failure as specified in 3GPP TS 29.212 [8] and if requested by the AF, the PCRF shall send an RAR command to the AF with the Specific-Action AVP set to the value INDICATION_OF_FAILED_RESOURCES_ALLOCATION to report the modification failure, the Flows AVP containing the service data flows corresponding to the resources that could not be allocated, and the content version(s) within the Content-Version AVP(s) if it was included when the corresponding media component was provisioned. If the modification of the existing PCC/QoS rules fails, the PCRF may also provide the status of the service information within the Media-Component-Status AVP. The AF shall send an RAA command to acknowledge the RAR command.\nNOTE 6:\tThe PCRF will report the Media-Component-Status AVP according to the status reported for the related PCC/QoS rules when the modification fails over the Gx/Gxx reference points as described in 3GPP TS 29.212 [8].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.3\tGate Related Procedures",
                            "text_content": "Depending on the application, in the Service Information provision, the AF may instruct the PCRF when the IP flow(s) are to be enabled or disabled to pass through the IP-CAN. The AF does this by sending the AA-Request message containing the Media-Component- Description AVP(s) that contains the flow status information (in the Flow-Status AVP) for the flows to be enabled or disabled.\nIn response to this action the PCRF shall set the appropriate gate status for the corresponding active PCC rule(s).\nIf a Media-Sub-Component AVP under a Media-Component-Description AVP contains a Flow-Usage AVP with the value RTCP, then the corresponding RTCP IP Flows in both directions shall be enabled even if the Flow-Status AVP under the Media-Sub-Component AVP is set to ENABLED-UPLINK, ENABLED-DOWNLINK, ENABLED, or DISABLED.\nThe PCRF shall reply with an AA-Answer and shall include the Access-Network-Charging-Identifier(s) available at this moment. The PCRF forwards the AF decision to enable or disable the authorized IP flows.\nThe behaviour when the AF does not receive the AAA, or when it arrives after the internal timer waiting for it has expired, or when it arrives with an indication different than DIAMETER_SUCCESS, are outside the scope of this specification and based on operator policy.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.4\tAF Session Termination",
                            "text_content": "When an AF session is terminated, if the AF had received a successful AA-Answer for the initial AA-Request, the AF shall send a Session-Termination-Request command to the PCRF. Otherwise, the AF shall wait for the initial AA-Answer to be received prior to sending the Session-Termination-Request command to the PCRF.\nWhen the PCRF receives a ST-Request from the AF, indicating an AF session termination, it shall acknowledge that request by sending a ST-Answer to the AF. Afterwards, it shall free the resources allocated for the corresponding Service Data Flow(s). In order to do that, the PCRF shall initiate the request for the removal of any related PCC/QoS rules from the PCEF/BBERF and for the update of the Authorized QoS for the affected IP-CAN bearer following the corresponding procedures specified at 3GPP TS 29.212 [8]. However, if the AF requests the reporting of access network information within the ST-Request or if the AF provided a threshold for the sponsored data connectivity, the PCRF shall defer sending the ST-Answer.\nIf the AF session being terminated corresponds to an MPS session, the PCRF may revoke the actions related to the prioritization of the MPS session in the corresponding IP-CAN as defined in 3GPP TS 29.212 [8]. For Multimedia Priority Service handling for IMS, see Annex A.9.\nIf the AF session being terminated corresponds to the last Group Communication session for the IP-CAN session, the PCRF may revoke the actions related to the prioritization of the Group Communication session as specified in 3GPP TS 29.212 [8].\nIf the AF session being terminated corresponds to a session that included the Priority-Sharing-Indicator AVP set to PRIORITY_SHARING_ENABLED within the Media-Component-Description AVP, the PCRF should readjust the Allocation and Retention Priority for the remaining services sharing priority as described in clause 4.4.8.\nFor sponsored data connectivity, and if a usage threshold was provided for the sponsored data connection at initial provisioning of session information (clause 4.4.1) or modification of session information (clause 4.4.2) procedures, the PCRF shall provide the usage consumed to the AF. For such purpose, the PCRF shall initiate the IP-CAN session modification procedure according 3GPP TS 29.212 [8] in order to obtain the consumed usage. The PCRF shall send then the ST-Answer to the AF including the Used-Service-Unit AVP for reporting accumulated usage within the Sponsored-Connectivity-Data AVP.\nIf the AF requires access network information at this step, the AF shall include the Required-Access-Info AVP within the ST-Request command, indicating the required information. In this case, the PCRF shall initiate the IP-CAN session modification procedure according to 3GPP TS 29.212 [8]. The PCRF shall send then the ST-Answer to the AF including the required data within the 3GPP-User-Location-Info AVP (if available), TWAN-Identifier AVP (if available), User-Location-Info-Time AVP (if available), UE-Local-IP-Address AVP (if available), UDP-Source-Port AVP (if available), TCP-Source-Port AVP (if available), 3GPP-SGSN-MCC-MNC AVP (if location info is not available) and/or 3GPP-MS-TimeZone AVP (if available).\nIf the RAN-NAS-Cause feature is supported and the AF initiated the termination of the AF session, upon reception of the ST-Request command, the PCRF shall initiate the IP-CAN session modification procedure according to 3GPP TS 29.212 [8].\nIf the RAN-NAS-Cause feature is supported , in all the AF session termination cases , t he PCRF shall send the ST-Answer to the AF including the access network information within the 3GPP-User-Location-Info AVP (if available), TWAN-Identifier (if available and Netloc-Trusted-WLAN feature is supported) User-Location-Info-Time AVP (if available), 3GPP-SGSN-MCC-MNC AVP (if location info is not available) and/or 3GPP-MS-TimeZone AVP (if available). Additionally, if the PCRF received from the PCEF the RAN cause and/or NAS cause, TWAN cause or untrusted WLAN cause, the PCRF shall provide the received cause(s) in the RAN-NAS-Release-Cause AVP in the ST-Answer command.\nNOTE:\tThe PCRF will apply the procedures described in 3GPP TS 29.212 [8] to get updated about the outcome of the resource release over Gx reference point in order to get the location and failure cause(s) when applicable.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.5\tSubscription to Notification of Signalling Path Status",
                            "text_content": "An AF may subscribe to notifications of the status of the AF Signalling transmission path. To do so, the AF shall open an Rx Diameter session with the PCRF for the AF signalling using an AA-Request command. The AF shall provide the UE’s IP address (using either the Framed-IP-Address AVP or the Framed-Ipv6-Prefix AVP) and the Specific-Action AVP requesting the subscription to \"INDICATION_OF_LOSS_OF BEARER\" and/or \"INDICATION_OF_RELEASE_OF_BEARER\". The AF shall additionally provide a Media-Component-Description AVP including a single Media-Sub-Component AVP with the Flow-Usage AVP set to the value \"AF_SIGNALLING\". The Media-Component-Description AVP shall contain the Media-Component-Number AVP set to \"0\".\nIf the procedures in Clause 4.4.5A are not applied, the Media-Sub-Component AVP shall contain the Flow-Number AVP set to \"0\", and the rest of AVPs within the Media-Component-Description and Media-Sub-Component AVPs shall not be used in this case.\nWhen the PCRF receives an AA-Request as described in the preceding paragraph from the AF, the PCRF shall perform session binding as described in 3GPP TS 29.213 [9] and acknowledges the  command by sending an AA-Answer command to the AF.\nPCC/QoS Rules related to AF Signalling IP Flows should be provisioned to PCEF/BBERF using the corresponding procedures specified at 3GPP TS 29.212 [8] at an earlier stage (e.g. typically at the establishment of the IP-CAN bearer dedicated for AF Signalling IP Flows). The PCRF may install the corresponding dynamic PCC/QoS rule for the AF signalling IP flows if none has been installed before.\nNOTE 1:\tWell-known ports (e.g. 3GPP TS 24.229 [17] for SIP) or wildcard ports can be used by PCRF to derive the dynamic PCC/QoS rule for the AF signalling IP flows.\nIf the Rx Diameter Session is only used for subscription to Notification of Signalling Path Status, the AF may cancel the subscription to notifications of the status of the AF Signalling transmission path. In that case, the AF shall use a Session-Termination-Request (STR) command to the PCRF, which shall be acknowledged with a Session-Termination-Answer (STA) command.\nNOTE 2:\tThe Rx Diameter Session created for the AF signalling can also be used when the AF requests notifications of IP-CAN type change, PLMN change, access network information for SMS over IP and/or when the AF provisions AF Signalling Flow Information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.5A\tProvisioning of AF Signalling Flow Information",
                            "text_content": "This clause is applicable when IMS restoration is supported according to supported feature ProvAFsignalFlow as described in clause 5.4.1.\nAn AF may provision information about the AF signalling IP flows between the UE and the AF. To do so, the AF shall make use of an Rx Diameter session already opened with the PCRF if an Rx Diameter session related to the AF signalling is already established. The AF may modify an already open Rx Diameter session related to the AF signalling (e.g. an Rx Diameter session established for the purpose of subscription to notification of signalling path status as described in 4.4.5) or it may open a new Rx Diameter session related to the AF signalling if none exists.\nTo provision the AF signalling flow information the AF shall provide the UE’s IP address using either Framed-IP-Address AVP or Framed-Ipv6-Prefix AVP. The AF shall additionally provide a Media-Component-Description AVP including one or more Media-Sub-Component AVP(s) representing the AF signalling IP flows. The Media-Component-Description AVP shall contain the Media-Component-Number AVP set to \"0\". Each Media-Sub-Component AVP representing an AF signalling IP flow shall contain the Flow-Number AVP set according to the rules described in Annex B and one or two Flow-Description AVP(s) set to the IP flows of the AF signalling. Additionally, the Media-Sub-Component AVP shall include the Flow-Usage AVP set to the value \"AF_SIGNALLING\", the Flow-Status AVP set to \"ENABLED\" and the AF-Signalling-Protocol AVP set to the value corresponding to the signalling protocol used between the UE and the AF.\nWhen the PCRF receives from the AF an AA-Request as described in the preceding paragraph, the PCRF shall perform session binding as described in 3GPP TS 29.213 [9] and shall acknowledge the  command by sending an AA-Answer command to the AF.\nPCC/QoS Rules related to the AF signalling IP flows could have been provisioned to PCEF/BBERF using the corresponding procedures specified in 3GPP TS 29.212 [8] at an earlier stage (e.g. typically at the establishment of the IP-CAN bearer dedicated for AF Signalling IP Flows). The PCRF shall install the corresponding dynamic PCC/QoS rule for the AF signalling IP flows.\nThe AF may de-provision the information about the AF signalling IP flows at any time. To do that, if the Rx Diameter session is only used to provide information about the AF Signalling IP flows, the AF shall close the Rx Diameter session by sending a Session-Termination-Request (STR) command to the PCRF, which shall be acknowledged with a Session-Termination-Answer (STA) command. Otherwise, the AF shall remove the IP flows within the Media-Sub-Component AVP by supplying the Flow-Status AVP with value \"REMOVED\". In both cases, the PCRF shall remove the corresponding dynamic PCC/QoS rule for the AF signalling IP flows.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.6\tTraffic Plane Events",
                            "text_content": "When an IP-CAN session is terminated, the PCRF shall inform the AF about the IP-CAN session termination by sending an ASR (abort session request) command to the AF on each active Rx Diameter session.\nWhen the AF receives the ASR command, it shall acknowledge the command by sending an ASA (abort session answer) command to the PCRF. After that the AF shall initiate an AF session termination procedure as defined in clause 4.4.4.\nSignalling flows for IP-CAN session termination cases are presented in 3GPP TS 29.213 [9].\nIt may happen that one or more PCC/QoS Rules (i.e. Service Data Flows) are deactivated at the PCEF/BBERF at a certain time, either permanently or temporarily or resource allocation for one or more PCC rules is unsuccessful at the PCEF/BBERF when the PCC rule(s) are installed. When the PCRF gets the knowledge that one or more SDFs have been deactivated, (e.g. due to a bearer release or loss of bearer or out of credit condition), or the resource allocation failed the PCRF shall inform the AF accordingly if the AF has previously subscribed using the Specific-Action AVP in the  command.\nWhen not all the service data flows within the AF session are affected, the PCRF shall inform the AF by sending an RAR (re-authorization request) command. The RAR command shall include the affected IP Flows encoded in the Flows AVP, the cause encoded in the Specific-Action AVP and the content version of a media component within the Content-Version AVP if it was included when the media component was provisioned.\nIf the RAN-NAS-Cause feature is supported and the PCRF received the access network information from the PCEF/BBERF due to bearer termination or unsuccessful bearer establishment/modification, the PCRF shall include in the RAR command the access network information within the 3GPP-User-Location-Info AVP (if available), TWAN-Identifier (if available and Netloc-Trusted-WLAN feature is supported) User-Location-Info-Time AVP (if available), 3GPP-SGSN-MCC-MNC AVP (if location info is not available) and/or 3GPP-MS-TimeZone AVP (if available). Additionally, if the PCRF received from the PCEF the RAN cause and/or NAS cause, TWAN cause or untrusted WLAN cause due to bearer termination, the PCRF shall provide the received cause(s) in the RAN-NAS-Release-Cause AVP in the RAR command.\nWhen the AF receives the RAR command, it shall acknowledge the command by sending an RAA (re-authorization answer) command to the PCRF. The AF may also update the session information by sending an  (AA-request) command to the PCRF.\nIf the PCRF receives the  command, it shall acknowledge the command by sending an AAA (AA-answer) command to the AF.\nWhen all the service data flows within the AF session are affected, the PCRF shall inform the AF by sending an ASR command on the Rx Diameter session related to the AF session. When the AF receives the ASR command, it shall acknowledge the command by sending an ASA (abort session answer) command to the PCRF. After that the AF shall initiate an AF session termination procedure as defined in clause 4.4.4.\nSignalling flows for Service Data Flow Deactivation and Resource Allocation Failure cases are presented in 3GPP TS 29.213 [9].\nIn the event that the PCRF is notified of the loss or release of resources associated to the PCC/QoS Rules corresponding with AF Signalling IP Flows, the PCRF shall inform the AF about the Loss of the Signalling Transmission path by sending a Re-Authorization Request (RAR) command to the AF. The RAR shall include the Specific-Action AVP set to the value \"INDICATION_OF_LOSS_OF_BEARER\" or \"INDICATION_OF_RELEASE_OF_BEARER\" and the deactivated IP Flow encoded in the Flows AVP.\nNOTE:\tAccording to the standardized QCI characteristics as defined in 3GPP TS 23.203 [2], the IMS signalling specific PCC rules include a QCI corresponding to a non-GBR bearer. When these guidelines are followed, the INDICATION_OF_LOSS_OF_BEARER will not be reported.\nIf the RAN-NAS-Cause feature is supported and the PCRF received the access network information from the PCEF/BBERF due to bearer termination, the PCRF shall include in the RAR command the access network information within the 3GPP-User-Location-Info AVP (if available), TWAN-Identifier (if available and Netloc-Trusted-WLAN feature is supported) User-Location-Info-Time AVP (if available), 3GPP-SGSN-MCC-MNC AVP (if location info is not available) and/or 3GPP-MS-TimeZone AVP (if available). Additionally, if the PCRF received from the PCEF the RAN cause and/or NAS cause, TWAN cause or untrusted WLAN cause due to bearer termination, the PCRF shall provide the received cause(s) in the RAN-NAS-Release-Cause AVP in the RAR command.\nWhen the AF receives the RAR command, it shall acknowledge the command by sending an RAA command to the PCRF.\nThe AF may then decide to terminate the Rx Diameter session used for the notification of the status of the AF Signalling transmission path. The AF may also decide to terminate any other active Rx Diameter session with the PCRF related to the AF Signalling which is not available any longer. In that case, the AF shall then initiate the AF Termination procedure towards the PCRF as defined in clause 4.4.4.\nIf the AF has successfully subscribed to change notifications in UE’s IP-CAN type and RAT type, the PCRF shall send an RAR command when the corresponding event occurs, i.e. when the UE’s IP-CAN type or RAT type changes or becomes available. In this case the RAR from the PCRF shall include the Specific-Action AVP for the subscribed event and include the IP-CAN-Type AVP, RAT-Type AVP (if applicable) and AN-Trusted AVP (if applicable) and AN-GW-Address AVP (if applicable) for the UE’s new IP-CAN/RAT. If the PCRF is informed of an IP-CAN type change due to IP flow mobility as specified in 3GPP TS 29.212 [8], where a subset of the flows within the AF session are affected, the PCRF shall include IP-CAN type and RAT type information (if applicable) to IP flow mobility affected service data flows. The IP flow mobility affected service data flows are included within the Flows AVP at command level.\nIf the AF has subscribed to a notification about Access Network Charging Information, the PCRF shall provide the Access Network Charging Information in the response, if already known by the PCRF. If not available, the PCRF shall provide the Access Network Charging Information by sending a Re-Authorization-Request (RAR) command when the Access Network Charging Information is received from the PCEF. If different Access Network Charging Information is applicable to the IP-CAN session, the PCRF shall notify the AF about the Access Network Charging Information that applies to each authorized flow. The RAR shall include the Specific-Action AVP set to the value \"CHARGING_CORRELATION_EXCHANGE\" and shall include the assigned Access-Network-Charging-Identifier(s) and may include the Access-Network-Charging-Address AVP.\nWhen SponsoredConnectivity is supported or when SponsorChange is supported and the AF indicated to enable sponsored data connectivity and the AF provided usage monitoring thresholds for such sponsor to the PCRF when the Rx Diameter session was established or modified, the PCRF shall report accumulated usage to the AF, when\n-\tthe PCRF detects that the usage threshold provided by the AF has been reached; or\n-\tthe AF session is terminated by the AF;\n-\tthe AF disables the sponsored data connectivity; or\n-\tthe AF session is terminated by the PCRF due to the IP-CAN session termination, the termination of all the service data flows of the AF session or the home operator policy disallowing the UE accessing the sponsored data connectivity in the roaming case.\nWhen the PCRF detects that the usage threshold has been reached or the AF disables the sponsored data connectivity, the PCRF shall report the accumulated usage as provided by the PCEF/TDF to the AF in a RA-Request (RAR) command with the Specific-Action AVP set to the value USAGE_REPORT; Otherwise, when the AF session is terminated by the AF or the PCRF, the PCRF shall report the accumulated usage as provided by the PCEF/TDF to the AF in ST-Answer (STA) command. The accumulated usage reported by the PCRF corresponds to the usage since the last report to the AF.\nThe accumulated usage shall be reported in the Used-Service-Unit AVP within the Sponsored-Connectivity-Data AVP.\nIf the AF receives a RAR command indicating the usage threshold is reached, the AF may terminate the AF session or provide a new usage threshold in the Granted-Service-Unit AVP within the Sponsored-Connectivity-Data AVP to the PCRF in the  command. Alternatively, the AF may allow the session to continue without providing new usage threshold in the  command.\nNOTE:\tAfter the PCRF reports the accumulated usage to the AF, the AF can provide a new usage threshold to the PCRF. The monitoring will not start until the PCRF receives the new threshold from the AF and provide it to the PCEF\nIf the AF requests the PCRF to report the access network information (i.e. user location and/or user timezone information), the AF shall subscribe to the \"ACCESS_NETWORK_INFO_REPORT\" within the Specific-Action AVP and shall include the required access network information within the Required-Access-Info AVP. The AF may request the PCRF to report the access network information in conjunction with providing the PCRF with the AF session information, refer to clause 4.4.1. Optionally, the AF may request the PCRF to report the access network information without providing service information (see clause A.10.2). In the latter case the AF establishes an Rx session for the AF session upon requesting the access network information from the PCRF with an AA-Request command, containing information required for the session binding in the Framed-IP-Address AVP, the Framed-Ipv6-Prefix AVP Subscription-Id AVP, the Called-Station-Id AVP and/or the IP-Domain-Id AVP.\nThe AF may also request the PCRF to report the access network information at Rx session termination. To do so, the AF shall include the required access network information within the Required-Access-Info AVP in the corresponding ST-Request.\nWhen the PCRF receives a request to report the access network information from the AF in an AAR command or in an STR command triggered by the AF, if the PCRF determines that the access network does not support the access network information reporting based on the currently used IP-CAN type or the values of the RAT-Type AVP or the PCEF/BBERF does not support the NetLoc feature as described in clause 5.4.1, the PCRF shall respond to AF with an AAA or STA command including the NetLoc-Access-Support AVP set to the value of 0 (NETLOC_ACCESS_NOT_SUPPORTED); otherwise, it shall immediately configure the PCEF or BBERF to provide such access network information.\nWhen the PCRF then receives the access network information from the PCEF/BBERF, the PCRF shall provide the corresponding access network information to the AF within the 3GPP-User-Location-Info AVP (if available), TWAN-Identifier AVP (if available), User-Location-Info-Time AVP (if available), UE-Local-IP-Address AVP (if available), UDP-Source-Port AVP (if available), TCP-Source-Port AVP (if available), 3GPP-SGSN-MCC-MNC AVP (if location info is not available) and/or 3GPP-MS-TimeZone AVP in the RAR command if the Rx session is not being terminated or in the STA command if the Rx session is being terminated. If the information is provided in the RAR command, PCRF shall also provide the ACCESS_NETWORK_INFO_REPORT within Specific-Action AVP.\nNOTE 1:\tThe PCRF receives the access network information from the PCEF/BBERF if it is requested by the AF previously or the IP-CAN bearer/IP-CAN session is terminated.\nWhen the PCRF receives the NetLoc-Access-Support AVP set to the value of 0 (NETLOC_ACCESS_NOT_SUPPORTED) from the PCEF/BBERF, the PCRF shall send a RAR command including the Specific-Action AVP set to INDICATION_OF_ACCESS_NETWORK_INFO_REPORTING_FAILURE and the NetLoc-Access-Support AVP set to the value of 0 (NETLOC_ACCESS_NOT_SUPPORTED) if the AF requested the access network information in an AAR command or send an STA command including the NetLoc-Access-Support AVP set to the value of 0 (NETLOC_ACCESS_NOT_SUPPORTED) if the AF requested the access network information in an STR command.\nNOTE 2:\tThe 3GPP GPRS, 3GPP EPS, Untrusted WLAN and Trusted WLAN support access network information reporting in this release.\nThe PCRF shall not send an RAR command with the ACCESS_NETWORK_INFO_REPORT value within a Specific-Action AVP to report any subsequently received access network information to the AF, unless the AF sends a new request for access network information.\nIf the PCRF detects that a temporary network failure has occurred (e.g. the SGW has failed for 3GPP-EPS access as defined in clause B.3.14 of 3GPP TS 29.212 [8]) and the AF requests an AF session establishment or modification in an AA-Request command, the PCRF shall respond to the AF with an AA-Answer including the Experimental-Result-Code AVP set to the value TEMPORARY_NETWORK_FAILURE.\nIf the PCRF detects that a temporary network failure has occurred (e.g. the SGW has failed for 3GPP-EPS access) and the AF requests an AF session termination in a ST-Request command, the PCRF shall respond with successful Result-Code AVP to the AF.\nNOTE 1:\tIf the AF includes the Required-Access-Info AVP in the ST-Request command to request the access network information, the PCRF will not include the access network information in the ST-Answer command.\nNOTE 2:\tActions over Gx/Gxx reference point when there is a temporary network failure are described in 3GPP TS 29.212 [8]. For example, for S-GW Restoration procedures the PCRF will wait for the SGW recovery before deleting the corresponding PCC/QoS rules,according to clause B.3.14 in that specification.\nIf the PCRF detects that the PCC/QoS rules related to an AF session cannot be installed or modified because there is a temporary network failure (e.g. SGW failed according to clause B.3.14 in 3GPP TS 29.212 [8]) and if requested by the AF, the PCRF shall send a RA-Request command to the AF with the Specific-Action AVP set to INDICATION_OF_FAILED_RESOURCES_ALLOCATION and the content version of a media component within the Content-Version AVP if it was included when the media component was provisioned. If the modification of the PCC/QoS rules fails, the PCRF may provide the status of the related service information within the Media-Component-Status AVP.\nIf the AF has successfully subscribed to PLMN_CHANGE notification, the PCRF shall send an RAR command when the corresponding event occurs, i.e. when the PLMN where the UE is located has been updated or becomes available. In this case the RAR from the PCRF shall include the Specific-Action AVP set to PLMN_CHANGE and include the 3GPP-SGSN-MCC-MNC AVP for the PLMN where the UE is located.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.7\tP-CSCF Restoration Enhancement Support",
                            "text_content": "This clause is applicable when the PCRF-based P-CSCF Restoration Enhancement, as defined in 3GPP TS 23.380 [28], is supported by both P-CSCF and PCRF.\nThe P-CSCF acting as AF shall send an AAR command including the Rx-Request-Type AVP set to the value PCSCF_RESTORATION (2) to the PCRF in the case P-CSCF Restoration needs to be performed. This AAR shall include the following information required by the DRA or PCRF to find the corresponding IP-CAN session:\n-\tThe UE’s IP address as applicable in the Framed-IP-Address AVP or in the Framed-Ipv6-Prefix AVP. If the IP address is not unique (e.g. private IPv4 case), the P-CSCF shall also include the IP-Domain-ID AVP if available.\n-\tIf the IP address is not available or if the IP address is not unique and the IP-Domain-ID is not available, the P-CSCF shall include the IMSI in the Subscription-Id AVP and the APN in the Called-Station-Id AVP.\nThe AF shall also include the Auth-Session-State AVP set to the value NO_STATE_MAINTAINED (1) in the AAR command, as described in IETF RFC 6733 [52]. As a consequence, the PCRF shall not maintain any state information about this session.\nThe PCRF shall acknowledge the AAR command by sending an AAA command to the P-CSCF acting as AF and shall include the Auth-Session-State AVP set to NO_STATE_MAINTAINED (1). The PCRF shall send a request for P-CSCF Restoration to the PCEF for the corresponding IP-CAN session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.8\tPriority Sharing Request",
                            "text_content": "If PrioritySharing feature is supported, the AF may include the Priority-Sharing-Indicator AVP set to PRIORITY_SHARING_ENABLED within the Media-Component-Description AVP in order to indicate to the PCRF that the related media flow is allowed to use the same Allocation and Retention Priority as media flows which are assigned the same QCI in the PCRF belonging to other AF sessions for the same IP-CAN session that also contain the Priority-Sharing-Indicator AVP set to PRIORITY_SHARING_ENABLED. If the MCPTT-Preemption feature is supported, the AF may also include the Pre-emption-Capability AVP containing the suggested pre-emption capability value and the Pre-emption-Vulnerability AVP containing the suggested pre-emption vulnerability value within the Media-Component-Description AVP for the PCRF to determine ARP values and include the Pre-emption-Control-Info AVP containing the pre-emption control information at the AAR command level for the PCRF to perform pre-emption control. The AF may also include the INDICATION_OF_FAILED_RESOURCES_ALLOCATION within Specific-Action AVP to request notification for resource allocation failure. Upon reception of this information, the PCRF shall behave as described in 3GPP TS 29.212 [8], clauses 4.5.27 and 4a.5.17. For the handling of MCPTT sessions, see Annex A.13.\nNOTE 1:\tService data flow deactivation procedures will apply according to clause 4.4.6.2.\nNOTE 2:\tThis enhancement avoids the risk that a bearer establishment request is rejected if the maximum number of active bearers is exceeded.\nIf the AF earlier has indicated a media flow priority sharing to the PCRF by setting the Priority-Sharing-Indicator AVP to PRIORITY_SHARING_ENABLED, the AF may include the Priority-Sharing-Indicator AVP set to PRIORITY_SHARING_DISABLED within the Media-Component-Description AVP in order to indicate to the PCRF that the related media flow shall not be part of the mechanism for sharing the Allocation and Retention Priority with other media flows any longer.\nIf this media flow was in priority sharing with other media flows the PCRF should readjust the Allocation and Retention Priority for the remaining services sharing priority as described in 3GPP TS 29.212 [8], clauses 4.5.27 and4a.5.17 and handle the media flow excluded from priority sharing according to normal PCC/QoS rule provisioning procedures described in 3GPP TS 29.212 [8], clauses 4.5.2 and 4a.5.2.\nIf the AF earlier has indicated media flow priority sharing to the PCRF by setting the Priority-Sharing-Indicator AVP to PRIORITY_SHARING_ENABLED for media flows and the AF indicates to remove one or more of the media flows in priority sharing with other media flows, the PCRF should readjust the Allocation and Retention Priority for the remaining services sharing priority as described in 3GPP TS 29.212 [8], clauses 4.5.27 and 4a.5.17 and handle the media flow removed according to normal PCC/QoS rule provisioning procedures described in 3GPP TS 29.212 [8], clauses 4.5.2 and 4a.5.2.\nIf the AF session being terminated corresponds to a session that included the Priority-Sharing-Indicator AVP set to PRIORITY_SHARING_ENABLED within the Media-Component Description AVP, if the related media flow(s) was in priority sharing with other media flows the PCRF should readjust the Allocation and Retention Priority for the remaining services sharing Allocation and Retention Priority as described in 3GPP TS 29.212 [8] , clauses 4.5.27 and 4a.5.17 and handle the media flow removed according to normal PCC/QoS rule provisioning procedures described in 3GPP TS 29.212 [8], clauses 4.5.2 and 4a.5.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.9\tSupport for media component versioning",
                            "text_content": "The support of the media component versioning is optional. When the MediaComponentVersioning feature is supported, the AF and the PCRF shall comply with the procedures specified in this clause.\nIf required by operator policies, the AF shall assign a content version to the media component related to certain service and provide the PCRF within the Content-Version AVP as part of the Media-Component-Description AVP. Upon each media component modification, if the content version was assigned to a media component, the AF shall assign a new content version. In this case, all the content related to that media component shall be included. The content version shall be unique for the lifetime of the media component.\nNOTE 1:\tThe AF will include all the content of the media component in each media component modification in order to ensure that the media component is installed with the proper information regardless of the outcome of the bearer procedure related to previous interactions that are not reported to the PCRF yet.\nIf the PCRF receives the Content-Version AVP including an content version for certain media component, the PCRF will follow the procedures described in 3GPP TS 29.212 [8], clause 4.5.28 and clause 4a.5.18.\nWhen the PCRF is notified about the outcome of the resource allocation related to one content version of a media component as described in clause 4.5.28 or clause 4a.5.18  in 3GPP TS 29.212 [8] and if the PCRF is required to notify the AF, the PCRF shall provide the content version of the media component within the Content-Version AVP corresponding to the value of content version of the PCC/QoS rule and the status of the media component within the Media-Component-Status AVP corresponding to the status of the PCC/QoS rule to the AF as part of the Flows AVP.\nThe PCRF shall include more than one Content-Version AVPs for the same media component within the Flows AVP in a RAR command if it has received multiple content versions as described in clause 4.5.28 or clause 4a.5.18 in 3GPP TS 29.212 [8].\nNOTE 2:\tThe AF will use the content version to identify the media component version that failed or succeed when multiple provisions of the same media component occur in a short period of time. How the AF handles such situations is not specified.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.10\tExtended bandwidth support for EPC supporting Dual Connectivity (E-UTRAN and 5G NR)",
                            "text_content": "When the Extended-Max-Requested-BW-NR feature, the Extended-Min-Requested-BW-NR feature, and/or the Extended-BW-E2EQOSMTSI-NR features are supported, extended bandwidth AVPs representing bitrates in kbps shall be used to represent bandwidth values higher than 2^32-1 bps instead of the bandwidth AVPs with a maximum value of 2^32-1 bps that represent bitrates in bps.\nFor the Extended-Max-Requested-BW-NR feature:\n-\tExtended-Max-Requested-BW-DL/UL AVPs shall be used instead of Max-Requested-Bandwidth-DL/UL AVPs.\nFor the Extended-BW-E2EQOSMTSI-NR feature:\n-\tExtended-Max-Supported-BW-DL/UL AVPs shall be used instead of Max-Supported-Bandwidth-DL/UL AVPs.\n-\tExtended-Min-Desired-BW-DL/UL AVPs shall be used instead of Min-Desired-Bandwidth-DL/UL AVPs.\nFor the Extended-Min-Requested-BW-NR feature:\n-\tExtended-Min-Requested-BW-DL/UL AVPs shall be used instead of Min-Requested-Bandwidth-DL/UL AVPs.\nFor values lower or equal to 2^32-1 bps AVPs representing bitrates in bps shall be used.\nWhen the Rx session is being established, if the AF supports the corresponding feature (as listed above) and needs to indicate bandwidth values higher than 2^32-1 bps, AVPs representing bitrate in bps shall be provided with value set to 2^32-1 bps and bandwidth AVPs representing bitrate in kbps shall be provided with the actual required bandwidth.\nNOTE:\tWhen the Diameter session is being established, the originator node does not know yet the features supported by the peer node.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.11\tMPS for DTS Control",
                            "text_content": "The support of the MPSforDTS feature is optional. When the MPSforDTS feature is supported as described in clause 5.4.1, the AF and the PCRF shall comply with the procedures specified in this clause.\nMPS for DTS is the means for an AF to invoke/revoke the Priority EPS Bearer Service for the default bearer only, i.e. without designating a particular service data flow for priority service. MPS for DTS applies only to non-IMS APNs.\nTo invoke/revoke MPS for DTS, the AF shall include the MPS-Action AVP in the AAR command. The MPS-Action AVP signals a change to the default bearer and IP flows mapped to the default bearer.\nWhen the MPS-Action AVP is set to ENABLE_MPS_FOR_DTS (1) and included in the AAR command, and if allowed by local policy, the PCRF does not check the user's MPS subscription details and shall upgrade the QoS of the default bearer to MPS, as specified in 3GPP TS 29.212 [8].\nWhen the MPS-Action AVP is set to AUTHORIZE_AND_ENABLE_MPS_FOR_DTS (2) and included in the AAR command, and if allowed by local policy, the PCRF shall check the user's MPS subscription details and if valid, shall upgrade the QoS of the default bearer to MPS, as specified in 3GPP TS 29.212 [8]. If the request is not allowed, the PCRF shall reject the request indicating REQUESTED_SERVICE_NOT_AUTHORIZED.\nWhen the MPS-Action AVP is set to DISABLE_MPS_FOR_DTS (0) and included in the AAR command, and if allowed by local policy, the PCRF does not check the user's MPS subscription details and shall downgrade the QoS of the default bearer to non-MPS priority, as specified in 3GPP TS 29.212 [8].\nNOTE:\tHow the AF authorizes the request is out of scope of the present document.\nThe AF may also include in the AAR command the Specific-Action AVP with the value SUCCESSFUL_QOS_UPDATE to request notification when the PCRF has successfully acted upon the invocation/revocation request indicated in the MPS-Action AVP. The PCRF shall inform the AF of successful MPS for DTS invocation/revocation with a RAR command with the Specific-Action AVP with the value SUCCESSFUL_QOS_UPDATE.\nThe AF may also include in the AAR command the Specific-Action AVP with the value FAILED_QOS_UPDATE to request notification when the invocation/revocation request indicated in the MPS-Action AVP has failed. The PCRF shall inform the AF of the failure of the MPS for DTS invocation/revocation with a RAR command with the Specific-Action AVP with the value FAILED_QOS_UPDATE.\nWhen the PCRF receives from the AF an AA-Request as described in the preceding paragraphs, the PCRF shall perform session binding as described in 3GPP TS 29.213 [9] and shall acknowledge the AAR command by sending an AA-Answer command to the AF.\nThe PCRF shall install the event trigger for the MPS for DTS request using the corresponding procedures specified in 3GPP TS 29.212 [8] if the AF requests the notification.\nThe AF may use the procedure specified in clause 4.4.12 to establish a priority signalling IP flow between the UE and AF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.12\tProvisioning of MPS for DTS AF Signalling Flow Information",
                            "text_content": "This clause is applicable when MPS for DTS is supported according to the supported feature MPSforDTS as described in clause 5.4.1.\nAn AF may provision information about the AF signalling IP flows between the UE and the AF. To do so, the AF may modify an already open Rx Diameter session related to the AF signalling (e.g. an Rx Diameter session established for the purpose of DTS control as described in clause 4.4.11) or it may open a new Rx Diameter session related to the AF signalling if none exists.\nTo provision the AF signalling flow information, the AF shall provide the UE’s IP address using either Framed-IP-Address AVP or Framed-Ipv6-Prefix AVP. The AF shall additionally provide the MPS-Identifier AVP and a Media-Component-Description AVP containing a Media-Component-Number AVP set to \"0\", and including a Media-Sub-Component AVP that contains the Flow-Description AVP set to the AF signalling IP flow. If the AuthorizationForMpsSignalling feature is supported, the AF shall provide the MPS-Action AVP set to value AUTHORIZE_AND_ENABLE_MPS_FOR_AF_SIGNALLING (3). The Media-Sub-Component AVP shall include the Flow-Number AVP set according to the rules described in Annex B and the Flow-Usage AVP set to the value \"AF_SIGNALLING\" and the Flow-Status AVP set to \"ENABLED\".\nWhen the PCRF receives from the AF an AA-Request as described in the preceding paragraph, the PCRF shall determine whether the request is accepted or not. If accepted, the PCRF shall perform session binding as described in 3GPP TS 29.213 [9] and shall acknowledge the  command by sending an AA-Answer command to the AF. If  rejected, the PCRF shall indicate the cause for the rejection with the Experimental-Result-Code AVP set to the value REQUESTED_SERVICE_NOT_AUTHORIZED.\nThe PCRF shall set appropriate QoS values for the AF signalling IP flow and install the corresponding dynamic PCC rule at the PCEF and the QoS rule at BBERF if applicable.\nThe AF may de-provision the information about the AF signalling IP flows at any time. To do that, if the Rx Diameter session is only used to provide information about the AF Signalling IP flows, the AF shall close the Rx Diameter session by sending a Session-Termination-Request (STR) command to the PCRF, which shall be acknowledged with a Session-Termination-Answer (STA) command. Otherwise, the AF shall remove the IP flows within the Media-Sub-Component AVP by supplying the Flow-Status AVP with value \"REMOVED\". In both cases, the PCRF shall remove the corresponding dynamic PCC and QoS rule if applicable for the AF signalling IP flows.\nNOTE:\tCombining the request for the AF signalling flow with an MPS for DTS invocation/revocation request is not supported in this release.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "5\tRx protocol",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tProtocol support",
                    "description": "",
                    "summary": "",
                    "text_content": "The Rx interface in the present release is based on Rx and Gq protocols defined for Release 6 as specified in 3GPP TS 29.211 [7] and 3GPP TS 29.209 [5] respectively. However, to be able to separate the policy and charging rules function (PCRF) of the present release from the policy decision function (PDF) and charging rules function (CRF) of Release 6, the Rx application in the present release has an own vendor specific Diameter application.\nThe Rx application is defined as an IETF vendor specific Diameter application, where the vendor is 3GPP and the Application-ID for the Rx application in the present release is 16777236. The vendor identifier assigned by IANA to 3GPP () is 10415.\nNOTE:\tA route entry can have a different destination based on the application identification AVP of the message. Therefore, Diameter agents (relay, proxy, redirection, translation agents) must be configured appropriately to identify the 3GPP Rx application within the Auth-Application-Id AVP in order to create suitable routeing tables.\nTthe Rx application identification shall be included in the Auth-Application-Id AVP.\nWith regard to the Diameter protocol defined over the Rx reference point, the PCRF acts as a Diameter server, in the sense that it is the network element that handles AF session authorization requests for a particular realm. The AF acts as the Diameter client, in the sense that is the network element requesting the authorization of resources for an AF session.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.2\tInitialization, maintenance and termination of connection and session",
                    "description": "",
                    "summary": "",
                    "text_content": "The initialization and maintenance of the connection between each AF and PCRF pair is defined by the underlying protocol. Establishment and maintenance of connections between Diameter nodes is described in IETF RFC 6733 [52].\nAfter establishing the transport connection, the PCRF and the AF shall advertise the support of the Rx specific Application by including the value of the application identifier in the Auth-Application-Id AVP and the value of the 3GPP (10415) in the Vendor-Id AVP of the Vendor-Specific-Application-Id AVP contained in the Capabilities-Exchange-Request and Capabilities-Exchange-Answer commands. The Capabilities-Exchange-Request and Capabilities-Exchange-Answer commands are specified in the Diameter Base Protocol (IETF RFC 6733 [52]).\nThe termination of the Diameter user session is specified in IETF RFC 6733 [52] in clauses 8.4 and 8.5. The description of how to use of these termination procedures in the normal cases is embedded in the procedures description (clause 4.4).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.3\tRx specific AVPs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.0\tGeneral",
                            "text_content": "Table 5.3.0.1 describes the Diameter AVPs defined for the Rx interface protocol, their AVP Code values, types, possible flag values, whether or not the AVP may be encrypted and which supported feature the AVP is applicable to. The Vendor-Id header of all AVPs defined in the present document shall be set to 3GPP (10415).\nNOTE:\tMost of these AVPs have already been defined in 3GPP TS 29.209 [5] for Rel-6. Their definition is based on the one used for Rel-6 with some possible modifications to be applied to the Rel-7 protocols.\nTable 5.3.0.1: Rx specific Diameter AVPs\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.3.0.1: Rx specific Diameter AVPs",
                                    "table number": 1,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.3.1\tAbort-Cause AVP",
                            "text_content": "The Abort-Cause AVP (AVP code 500) is of type Enumerated, and determines the cause of an abort session request (ASR) or of a RAR indicating a bearer release. The following values are defined:\nBEARER_RELEASED (0)\nThis value is used when the bearer has been deactivated as a result from normal signalling handling. For GPRS the bearer refers to the PDP Context. It is also used when all the resource allocation corresponding to an AF session fails.\nINSUFFICIENT_SERVER_RESOURCES (1)\nThis value is used to indicate that the server is overloaded and needs to abort the session.\nINSUFFICIENT_BEARER_RESOURCES (2)\nThis value is used when the bearer has been deactivated due to insufficient bearer resources at a transport gateway (e.g. GGSN for GPRS).\nPS_TO_CS_HANDOVER (3)\nThis value is used when the PCRF needs to initiate the AF session termination due to PS to CS handover.\nSPONSORED_DATA_CONNECTIVITY_ DISALLOWED (4)\nThis value is used in the ASR when the PCRF needs to initiates the AF session termination due to the operator policy (e.g. disallowing the UE accessing the sponsored data connectivity in the roaming case).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.2\tAccess-Network-Charging-Address AVP",
                            "text_content": "The Access-Network-Charging-Address AVP (AVP code 501) is of type Address, and it indicates the IP Address of the network entity within the access network performing charging (e.g. the GGSN IP address). The Access-Network-Charging-Address AVP should not be forwarded over an inter-operator interface.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.3\tAccess-Network-Charging-Identifier AVP",
                            "text_content": "The Access-Network-Charging-Identifier AVP (AVP code 502) is of type Grouped, and contains a charging identifier (e.g. GCID) within the Access-Network-Charging-Identifier-Value AVP along with information about the flows transported within the corresponding bearer within the Flows AVP. If no Flows AVP is provided, the Access-Network-Charging-Identifier-Value applies for all flows within the AF session.\nThe Access-Network-Charging-Identifier AVP can be sent from the PCRF to the AF. The AF may use this information for charging correlation with session layer.\nAVP Format:\nAccess-Network-Charging-Identifier ::= < AVP Header: 502 >\n{ Access-Network-Charging-Identifier-Value}\n*[ Flows ]\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.4\tAccess-Network-Charging-Identifier-Value AVP",
                            "text_content": "The Access-Network-Charging-Identifier-Value AVP (AVP code 503) is of type OctetString, and contains a charging identifier (e.g. GCID).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.5\tAF-Application-Identifier AVP",
                            "text_content": "The AF-Application-identifier AVP (AVP code 504) is of type OctetString, and it contains information that identifies the particular service that the AF service session belongs to. This information may be used by the PCRF to differentiate QoS for different application services.\nFor example the AF-Application-Identifier may be used as additional information together with the Media-Type AVP when the QoS class for the bearer authorization at the Gx interface is selected. The AF-Application-Identifier may be used also to complete the QoS authorization with application specific default settings in the PCRF if the AF does not provide full service information.\nThe AF-Application-Identifier AVP may also be used to trigger the PCRF to indicate to the PCEF/TDF to perform the application detection based on the operator’s policy.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.6\tAF-Charging-Identifier AVP",
                            "text_content": "The AF-Charging-Identifier AVP (AVP code 505) is of type OctetString, contains the AF Charging Identifier that is sent by the AF. This information may be used for charging correlation with bearer layer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.7\tCodec-Data AVP",
                            "text_content": "The Codec-Data AVP (AVP code 524) is of type OctetString.\nThe Codec-Data AVP shall contain codec related information known at the AF. This information shall be encoded as follows:\n-\tThe first line of the value of the Codec-Data AVP shall consist of either the word \"uplink\" or the word \"downlink\" (in ASCII, without quotes) followed by a new-line character. The semantics of these words are the following:\n-\t\"uplink\" indicates that the SDP was received from the UE and sent to the network.\n-\t\"downlink\" indicates that the SDP was received from the network and sent to the UE.\nNOTE 1:\tThe first line indicates the direction of the source of the SDP used to derive the information. The majority of the information within the Codec-Data AVP indicating \"downlink\" describes properties, for instance receiver capabilities, of the sender of the SDP, the network in this case and is therefore applicable for IP flows in the uplink direction. Similarly, the majority of the information within the Codec-Data AVP indicating \"uplink\" describes properties, for instance receiver capabilities, of the sender of the SDP, the UE in this case and is therefore applicable for IP flows in the downlink direction.\n-\tThe second line of the value of the Codec-Data AVP shall consist of either the word \"offer\" or the word \"answer\", or the word \"description\" (in ASCII, without quotes) followed by a new-line character. The semantics of these words are the following:\n-\t\"offer\" indicates that SDP lines from an SDP offer according to RFC 3264 [18] are being provisioned in the Codec-Data AVP;\n-\t\"answer\" indicates that SDP lines from an SDP answer according to RFC 3264 [18] are being provisioned in the Codec-Data AVP;\n-\t\"description\" indicates that SDP lines from a SDP session description in a scenario where the offer-answer mechanism of RFC 3264 [18] is not being applied are being provisioned in the Codec-Data AVP. For instance, SDP from an RTSP \"Describe\" reply may be provisioned.\n-\tThe rest of the value shall consist of SDP line(s) in ASCII encoding separated by new-line characters, as specified in IETF RFC 4566 [13]. The first of these line(s) shall be an \"m\" line. The remaining lines shall be any available SDP \"a\" and \"b\" lines related to that \"m\" line. However, to avoid duplication of information, the SDP \"a=sendrecv\", \"a=recvonly \", \"a=sendonly\", \"a=inactive\", \"a=bw-info\", \"b:AS\", \"b:RS\" and \"b:RR\" lines do not need to be included.\nNOTE 2:\tFor backwards compatibility, it is expected that the codec algorithms in the PCRF described in 3GPP TS 29.213 [9] allow the introduction of new SDP lines without rejecting the request when Codec-Data AVP is provided as part of the Media-Component-Description AVP. The QoS derivation in that case will not take the new SDP line(s) into account.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.8\tFlow-Description AVP",
                            "text_content": "The Flow-Description AVP (AVP code 507) is of type IPFilterRule, and defines a packet filter for an IP flow with the following information:\n-\tDirection (in or out). The direction \"in\" refers to uplink IP flows, and the direction \"out\" refers to downlink IP flows.\n-\tSource and destination IP address (possibly masked).\n-\tProtocol.\n-\tSource and destination port.\nNOTE 1:\tWhen \"ip\" as key word is used in the protocol, the port(s) are used to describe the port(s) of any protocol if available.\nThe IPFilterRule type shall be used over Rx interface with the following restrictions:\n-\tThe  may be omitted to indicate that any source port is allowed. Lists or ranges shall not be used.\n-\tOnly the Action \"permit\" shall be used.\n-\tNo \"options\" shall be used.\n-\tThe invert modifier \"!\" for addresses shall not be used.\n-\tThe keyword \"assigned\" shall not be used.\nNOTE 2:\tFor TCP protocol, destination port can also be omitted.\nIf any of these restrictions is not observed by the AF, the server shall send an error response to the AF containing the Experimental-Result-Code AVP with value FILTER_RESTRICTIONS.\nFor the Rx interface, the Flow description AVP shall be used to describe a single IP flow.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.9\tFlow-Number AVP",
                            "text_content": "The Flow-Number AVP (AVP code 509) is of type Unsigned32, and it contains the ordinal number of the IP flow(s), assigned according to the rules in Annex B.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.10\tFlows AVP",
                            "text_content": "The Flows AVP (AVP code 510) is of type Grouped, and it indicates IP flows via their flow identifiers.\nWhen reporting an out of credit condition, the Final-Unit-Action AVP indicates the termination action applied to the impacted flows.\nIf no Flow-Number AVP(s) are supplied, the Flows AVP refers to all Flows matching the media component number.\nWhen reporting a resource allocation failure related to the modification of session information, the Media-Component-Status AVP may be included to report the status of the PCC/QoS rules related to the media component.\nThe Content-Version AVP(s) shall be included if it was included in the Media-Component-Description AVP when the corresponding media component was provisioned.\nAVP Format:\nFlows::= < AVP Header: 510 >\n{Media-Component-Number}\n*[Flow-Number]\n*[ Content-Version ]\n[Final-Unit-Action]\n[Media-Component-Status]\n*[AVP]\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.11\tFlow-Status AVP",
                            "text_content": "The Flow-Status AVP (AVP code 511) is of type Enumerated, and describes whether the IP flow(s) are enabled or disabled. The following values are defined:\nENABLED-UPLINK (0)\nThis value shall be used to enable associated uplink IP flow(s) and to disable associated downlink IP flow(s).\nENABLED-DOWNLINK (1)\nThis value shall be used to enable associated downlink IP flow(s) and to disable associated uplink IP flow(s).\nENABLED (2)\nThis value shall be used to enable all associated IP flow(s) in both directions.\nDISABLED (3)\nThis value shall be used to disable all associated IP flow(s) in both directions.\nREMOVED (4)\nThis value shall be used to remove all associated IP flow(s). The IP Filters for the associated IP flow(s) shall be removed. The associated IP flows shall not be taken into account when deriving the authorized QoS.\nNOTE 1:\tThe interpretation of values for the RTCP flows in the Rx interface is described within the procedures in clause 4.4.3.\nNOTE 2: The interpretation of values for IMS flows when SIP Forking is supported is described within the procedures in Annex A.3.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.12\tFlow-Usage AVP",
                            "text_content": "The Flow-Usage AVP (AVP code 512) is of type Enumerated, and provides information about the usage of IP Flows. The following values are defined:\nNO_INFORMATION (0)\nThis value is used to indicate that no information about the usage of the IP flow is being provided.\nRTCP (1)\nThis value is used to indicate that an IP flow is used to transport RTCP.\nAF_SIGNALLING (2)\nThis value is used to indicate that the IP flow is used to transport AF Signalling Protocols (e.g. SIP/SDP).\nNO_INFORMATION is the default value.\nNOTE:\tAn AF may choose not to identify RTCP flows, e.g. in order to avoid that RTCP flows are always enabled by the server.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.13\tSpecific-Action AVP",
                            "text_content": "The Specific-Action AVP (AVP code 513) is of type Enumerated.\nWithin a PCRF initiated Re-Authorization Request, the Specific-Action AVP determines the type of the action.\nWithin an initial AA request the AF may use the Specific-Action AVP to request any specific actions from the server at the bearer events and to limit the contact to such bearer events where specific action is required. If the Specific-Action AVP is omitted within the initial AA request, no notification of any of the events defined below is requested at this time.\nFor one time specific actions, as identified in the value descriptions below, the AF may also provide the Specific-Action AVP with the applicable one-time-specific-action value(s) in subsequent AA-Requests. Non-one-time-specific-action value(s) may only be provided in the initial AA-Request and shall then be applicable for the entire lifetime of the Rx session.\nNOTE 1:\tOne time specific actions are reported once the required action is fulfilled and are not reported again unless the AF sends a new request.\nNOTE 2:\tUnless otherwise stated in the definition of the specific action value, when the AF requests specific actions in the initial AA-Request, the PCRF reports that action whenever new related information is available during the lifetime of the Rx session.\nNOTE 2a:\tWhether the PCRF decides to report INDICATION_OF_RELEASE_OF_BEARER (4) or INDICATION_OF_FAILED_RESOURCES_ALLOCATION (9) upon receipt of a bearer failure from the PCEF is left to the implementation.\nThe following values are defined:\nVoid (0)\nCHARGING_CORRELATION_EXCHANGE (1)\nWithin a RAR, this value shall be used when the server reports the access network charging identifier to the AF. The Access-Network-Charging-Identifier AVP shall be included within the request. In the , this value indicates that the AF requests the server to provide the access network charging identifier to the AF for each authorized flow, when the access network charging identifier becomes known at the PCRF.\nINDICATION_OF_LOSS_OF_BEARER (2)\nWithin a RAR, this value shall be used when the server reports a loss of a bearer (in the case of GPRS PDP context bandwidth modification to 0 kbit for GBR bearers) to the AF. The SDFs that are deactivated as a consequence of this loss of bearer shall be provided within the Flows AVP. In the , this value indicates that the AF requests the server to provide a notification at the loss of a bearer.\nINDICATION_OF_RECOVERY_OF_BEARER (3)\nWithin a RAR, this value shall be used when the server reports a recovery of a bearer (in the case of 3GPP-GPRS or 3GPP-EPS when PGW interoperates with a Gn/Gp SGSN, PDP context bandwidth modification from 0 kbit to another value for GBR bearers) to the AF. The SDFs that are re-activated as a consequence of the recovery of bearer shall be provided within the Flows AVP. In the , this value indicates that the AF requests the server to provide a notification at the recovery of a bearer.\nINDICATION_OF_RELEASE_OF_BEARER (4)\nWithin a RAR, this value shall be used when the server reports the release of a bearer (e.g. PDP context removal for 3GPP-GPRS or bearer/PDP context removal for 3GPP-EPS) to the AF. The SDFs that are deactivated as a consequence of this release of bearer shall be provided within the Flows AVP. In the , this value indicates that the AF requests the server to provide a notification at the removal of a bearer. The content version corresponding to the affected media component may be provided in the Content-Version AVP included within the Flows AVP.\nVoid (5)\nIP-CAN_CHANGE (6)\nThis value shall be used in RAR command by the PCRF to indicate a change in the IP-CAN type or RAT type (if applicable). When used in an  command, this value indicates that the AF is requesting subscription to IP-CAN change and RAT change notification. When used in RAR it indicates that the PCRF generated the request because of an IP-CAN or RAT change. IP-CAN-Type AVP, RAT-Type AVP (if applicable) ,AN-Trusted AVP (if applicable) and AN-GW-Address AVP (if applicable) shall be provided in the same request with the new/valid value(s).\nIf an IP-CAN type or RAT type change is due to IP flow mobility and a subset of the flows within the AF session is affected, the affected service data flows shall be provided in the same request.\nIf ATSSS feature is supported, and the PDU session is a MA PDU session, the PCF may include the MA-Information AVP in the RAR command with the additional/released IP-CAN type and RAT type (if applicable), with the new/valid values as described in clause E.4.\nINDICATION_OF_OUT_OF_CREDIT (7)\nWithin a RAR, this value shall be used when the PCRF reports to the AF that SDFs have run out of credit, and that the termination action indicated by the corresponding Final-Unit-Action AVP applies (3GPP TS 32.240 [23] and 3GPP TS 32.299 [24]. The SDFs that are impacted as a consequence of the out of credit condition shall be provided within the Flows AVP. In the , this value indicates that the AF requests the PCRF to provide a notification of SDFs for which credit is no longer available. Applicable to functionality introduced with the Rel8 feature as described in clause 5.4.1.\nINDICATION_OF_SUCCESSFUL_RESOURCES_ALLOCATION (8)\nWithin a RAR, this value shall be used by the PCRF to indicate that the resources requested for particular service information have been successfully allocated. The SDFs corresponding to the resources successfully allocated shall be provided within the Flows AVP and the content version within the Content-Version AVP as included when the corresponding media component was provisioned.\nIn the , this value indicates that the AF requests the PCRF to provide a notification when the resources associated to the corresponding service information have been allocated.\nApplicable to functionality introduced with the Rel8 feature as described in clause 5.4.1.\nNOTE 3:\tThis value applies to applications for which the successful resource allocation notification is required for their operation since subscription to this value impacts the resource allocation signalling overhead towards the PCEF/BBERF.\nINDICATION_OF_FAILED_RESOURCES_ALLOCATION (9)\nWithin a RAR, this value shall be used by the PCRF to indicate that the resources requested for a particular service information cannot be successfully allocated. The SDFs corresponding to the resources that could not be allocated shall be provided within the Flows AVP. In case of session modification failure, the status of the related service information may be reported in the Media-Component-Status AVP included within the Flows AVP and the content version within the Content-Version AVP as included when the corresponding media component was provisioned.\nIn the , this value indicates that the AF requests the PCRF to provide a notification when the resources associated to the corresponding service information cannot be allocated. Applicable to functionality introduced with the Rel8 feature as described in clause 5.4.1.\nNOTE 4:\tThis value applies to applications for which the unsuccessful resource allocation notification is required for their operation since subscription to this value impacts the resource allocation signalling overhead towards the PCEF/BBERF.\nINDICATION_OF_LIMITED_PCC_DEPLOYMENT (10)\nWithin a RAR, this value shall be used when the PCRF reports the limited PCC deployment (i.e. dynamically allocated resources are not applicable) as specified at Annex K and Annex L in 3GPP TS 23.203 [2] to the AF. In the , this value indicates that the AF requests the PCRF to provide a notification for the limited PCC deployment. Applicable to functionality introduced with the Rel8 feature as described in clause 5.4.1.\nUSAGE_REPORT (11)\nIn the RA-Request (RAR), this value shall be used by the PCRF to report accumulated usage volume and/or time of usage when the usage threshold provided by the AF has been reached.\nIn the AA-Request (AAR), this value indicates that the AF requests PCRF to report accumulated usage volume and /or time of usage when it reaches the threshold.\nApplicable to functionality introduced with the SponsoredConnectivity feature for volume usage reporting and with SCTimeBased UM feature for time usage reporting as described in clause 5.4.1.\nACCESS_NETWORK_INFO_REPORT (12)\nIn the RA-Request (RAR), this value shall be used by the PCRF to report access network information (i.e.user location and/or user timezone information) when the PCRF receiving an Access Network Information report corresponding to the AF session from the PCEF/BBERF.\nIn the AA-Request (AAR), this value indicates that the AF requests PCRF to report one time access network information when the PCRF receives the first Access Network Information report corresponding to the AF session from the PCEF/BBERF after the AF request for the access network information. The required access information is provided within the Required-Access-Info AVP. Applicable to functionality introduced with the NetLoc feature as described in clause 5.4.1.\nThe Specific-Action AVP with this value indicates a one time specific action.\nINDICATION_OF_RECOVERY_FROM_LIMITED_PCC_DEPLOYMENT (13)\nWithin a RAR, this value shall be used when the PCRF reports the recovery from limited PCC deployment (i.e. the UE moves from the VPLMN to the HPLMN as specified at Annex K in 3GPP TS 23.203 [2]) to the AF. In the , this value indicates that the AF requests the PCRF to provide a notification for the recovery from limited PCC deployment. Applicable to functionality introduced with the Rel8 feature as described in clause 5.4.1.\nNOTE 5:\tThis value is optional and only applicable to the scenario where PCC is deployed in the HPLMN but\tnot in the VPLMN and dynamic policy provisioning only occurs in the home routed roaming cases if no BBERF is employed.\nINDICATION_OF_ACCESS_NETWORK_INFO_REPORTING_FAILURE (14)\nIn the RAR, this value shall be used when the PCRF reports the access network information reporting failure. When applicable, the NetLoc-Access-Support AVP may be provided as well to indicate the reason for the access network information reporting failure. This specific action does not require to be provisioned by the AF. Applicable to functionality introduced with the NetLoc feature as described in clause 5.4.1.\nINDICATION_OF_TRANSFER_POLICY_EXPIRED (15)\nIn the RAR, this value shall be used when the PCRF determines that the transfer policy has expired. This specific action does not require to be provisioned by the AF.\nPLMN_CHANGE (16)\nIn the AA-Request (AAR), this value indicates that the AF requests PCRF to report changes of PLMN. In the RA-Request (RAR), this value shall be used by the PCRF to indicate that there was a change of PLMN. 3GPP-SGSN-MCC-MNC AVP shall be provided in the same RAR command with the new value and, if available, the NID AVP. Applicable to functionality introduced with the PLMNInfo feature as described in clause 5.4.1.\nThe NID AVP is only applicable in 5GS when the serving network is an SNPN, as described in Annex E.\nEPS_FALLBACK (17)\nIn the RA-Request (RAR), this value shall be used to report EPS Fallback for the resources requested for a particular service information (media type voice).\nIn the AA-Request (AAR), this value indicates that the AF requests to provide a notification when the access network initiates EPS Fallback for the requested resources associated to service information for voice media type.\nApplicable to functionality introduced with the EPSFallbackReport feature as described in clause 5.4.1.\nThis value is only applicable to 5GS as described in Annex E.\nINDICATION_OF_REALLOCATION_OF_CREDIT (18)\nWithin a RAR, this value shall be used to report to the AF the SDFs for which credit has been reallocated after the former out of credit indication (3GPP TS 32.240 [23] and 3GPP TS 32.299 [24]). The SDFs that are impacted as a consequence of the reallocation of credit condition shall be provided within the Flows AVP. In the AAR, this value indicates the AF requests to provide a notification of SDFs for which credit has been reallocated after the former out of credit indication. Applicable to functionality introduced with the ReallocationOfCredit feature as described in clause 5.4.1.\nThis value is only applicable to 5GS as described in Annex E.\nSUCCESSFUL_QOS_UPDATE (19)\nWithin a RAR, this value shall be used by the PCRF to indicate that the QoS of the default bearer has been successfully updated.\nIn the AAR, this value indicates that the AF requests the PCRF to provide a notification when the QoS of the default bearer has been successfully updated.\nApplicable to functionality introduced with the MPSforDTS feature as described in clause 5.4.1.\nFAILED_QOS_UPDATE (20)\nWithin a RAR, this value shall be used by the PCRF to indicate that the QoS of the default bearer has failed to update.\nIn the AAR, this value indicates that the AF requests the PCRF to provide a notification when the QoS of the default bearer has failed to update.\nApplicable to functionality introduced with the MPSforDTS feature as described in clause 5.4.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.14\tMax-Requested-Bandwidth-DL AVP",
                            "text_content": "The Max-Requested-Bandwidth-DL AVP (AVP code 515) is of type Unsigned32, and it indicates the maximum bandwidth in bits per second for a downlink IP flow. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTP payload.\nWhen provided in an AA-Request, it indicates the maximum requested bandwidth. When provided in an AA-Answer, it indicates the maximum bandwidth acceptable by PCRF.\nWhen the Extended-Max-Requested-BW-NR feature is supported and the value to be transmitted exceeds 2^32-1, the Extended-Max-Requested-Bandwidth-DL AVP shall be used , see clause 4.4.10 and clause 5.3.52.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.15\tMax-Requested-Bandwidth-UL AVP",
                            "text_content": "The Max –Bandwidth-UL AVP (AVP code 516) is of type Unsigned32, and it indicates the maximum requested bandwidth in bits per second for an uplink IP flow. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTP payload.\nWhen provided in an AA-Request, it indicates the maximum requested bandwidth. When provided in an AA-Answer, it indicates the maximum bandwidth acceptable by PCRF.\nWhen the Extended-Max-Requested-BW-NR feature is supported and the value to be transmitted exceeds 2^32-1, the Extended-Max-Requested-Bandwidth-UL AVP shall be used, see clause 4.4.10 and clause 5.3.53.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.16\tMedia-Component-Description AVP",
                            "text_content": "The Media-Component-Description AVP (AVP code 517) is of type Grouped, and it contains service information for a single media component within an AF session or the AF signalling information. The service information may be based on the SDI exchanged between the AF and the AF session client in the UE. The information may be used by the PCRF to determine authorized QoS and IP flow classifiers for bearer authorization and PCC rule selection.\nWithin one Diameter message, a single IP flow shall not be described by more than one Media-Component-Description AVP.\nBandwidth information and Flow-Status information provided within the Media-Component-Description AVP applies to all those IP flows within the media component, for which no corresponding information is being provided within Media-Sub-Component AVP(s). As defined in 3GPP TS 29.213 [9], the bandwidth information within the media component level Max-Requested-Bandwidth-DL and Max-Requested-Bandwidth-UL AVPs applies separately to each media subcomponent except for RTCP media subcomponent.\nThe mapping of bandwidth information for RTCP media subcomponent is defined in 3GPP TS 29.213 [9] clause 6.2.\nIf CHEM feature is supported, Max-PLR-DL AVP and Max-PLR-UL AVP information is provided within the Media-Component-Description AVP as defined in 3GPP TS 29.213 [9].\nIf the QoSHint feature is supported the Desired-Max-Latency AVP and/or Desired-Max-Loss AVP may be provided within the Media-Component-Description AVP as defined in 3GPP TS 29.213 [9].\nIf FLUS feature is supported the FLUS-Identifier AVP may be provided within the Media-Component-Description AVP. Additionally, the Desired-Max-Latency AVP and/or the Desired-Max-Loss AVP may be provided as defined in 3GPP TS 29.213 [9].\nThe Max-Requested-Bandwidth-UL, Max-Requested-Bandwidth-DL, Max-Supported-Bandwidth-UL, Max-Supported-Bandwidth-DL, Min-Desired-Bandwidth-UL, Min-Desired-Bandwidth-DL, Min-Requested-Bandwidth-UL and Min-Requested-Bandwidth-DL AVPs only represent bandwidth values up 2^32-1 bps. To represent higher values, the Extended-Max-Requested-Bandwidth-UL, Extended-Max-Requested-Bandwidth-DL, Extended-Max-Supported-Bandwidth-UL, Extended-Max-Supported-Bandwidth-DL, Extended-Min-Desired-Bandwidth-UL, Extended-Min-Desired-Bandwidth-DL, Extended-Min-Requested-Bandwidth-UL and Extended-Min-Requested-Bandwidth-DL AVPs may be used as described in clause 4.4.10.\nIf a Media-Component-Description AVP is not supplied by the AF, or if optional AVP(s) within a Media-Component-Description AVP are omitted, but corresponding information has been provided in previous Diameter messages, the previous information for the corresponding IP flow(s) remains valid.\nAll IP flows within a Media-Component-Description AVP are permanently disabled by supplying a Flow Status AVP with value \"REMOVED\". The server may delete corresponding filters and state information.\nReservation-Priority provided within the Media-Component-Description AVP in the request from the AF applies to all those IP flows within the media component and describes the relative importance of the IP flow as compared to other IP flows. The PCRF may use this value to implement priority based admission. If the Reservation-Priority AVP is not specified the IP flow priority is DEFAULT (0).\nEach Media-Component-Description AVP shall contain either zero, or one, or two Codec-Data AVPs. In the case of conflicts, information contained in other AVPs either within this Media-Component-Description AVP, or within the corresponding Media-Component-Description AVP in a previous message, shall take precedence over information within the Codec-Data AVP(s). The AF shall provision all the available information in other applicable AVPs in addition to the information in the Codec-Data AVP, if such other AVPs are specified.\nIf the SDP offer-answer procedures of IETF RFC 3264 [18] are applicable for the session negotiation between the two ends taking part in the communication (e.g. for IMS), the following applies:\n-\tThe AF shall provision information derived from an SDP answer and shall also provision information derived from the corresponding SDP offer.\n-\tIf the Media-Component-Description AVP contains two Codec-Data AVPs, one of them shall represent an SDP offer and the other one the corresponding SDP answer.\n-\tIf the Media-Component-Description AVP contains one Codec-Data AVP, and this AVP represents an SDP offer, the AF shall provision the corresponding SDP answer information in a Codec-Data AVP within a subsequent Rx message.\nNOTE 1:\tSome SDP parameters for the same codec in the SDP offer and answer are independent of each other and refer to IP flows in opposite directions, for instance some MIME parameters conveyed within \"a=fmtp\" SDP lines and the packetization time within the \"a=ptime\" line. Other parameters within the SDP answer take precedence over corresponding parameters within the SDP offer.\nIf SDP is applied without using the offer-answer procedures, zero or one Codec-Data AVP shall be provisioned.\nSharing-Key-DL AVP and/or Sharing-Key-UL AVP provided within the Media-Component-Description AVP indicates that the media components that include the same value of the Sharing-Key-UL AVP and/or Sharing-Key-DL AVP may share resources in the related direction.\nNOTE 2: RTCP traffic is not subject to resource sharing.\nThe Content-Version AVP may be included in order to indicate the content version of a media component.\nThe Priority-Sharing-Indicator AVP may be included to indicate that the media component can use the same Allocation and Retention Priority as media flows which are assigned the same QCI in the PCRF belonging to other AF sessions for the same IP-CAN session that also contain the Priority-Sharing-Indicator AVP.\nThe Pre-emption-Capability AVP and Pre-emption-Vulnerability AVP may be included together with Priority-Sharing-Indicator AVP for PCRF Allocation and Retention Priority decision.\nThe PCRF may provide the Media-Component-Description AVP(s) within the Acceptable-Service-Info AVP in the AA-Answer command if the service information received from the AF is rejected. For this usage, the Media-Component-Description AVP shall only include the appropriate Media-Component-Number AVP and the Max-Requested-Bandwidth-UL and/or Max-Requested-Bandwidth-DL AVPs and/ or the Extended-Max-Requested-BW-UL AVP and/or the Extended-Max-Requested-BW-DL AVP (see clause 4.4.10) indicating the maximum acceptable bandwidth.\nAVP format:\nMedia-Component-Description ::= < AVP Header: 517 >\n{ Media-Component-Number } ; Ordinal number of the media comp.\n*[ Media-Sub-Component ]    ; Set of flows for one flow identifier\n[ AF-Application-Identifier ]\n[ FLUS-Identifier ]\n[ Media-Type ]\n[ Max-Requested-Bandwidth-UL ]\n[ Max-Requested-Bandwidth-DL ]\n[ Max-Supported-Bandwidth-UL ]\n[ Max-Supported-Bandwidth-DL ]\n[ Min-Desired-Bandwidth-UL ]\n[ Min-Desired-Bandwidth-DL ]\n[ Min-Requested-Bandwidth-UL ]\n[ Min-Requested-Bandwidth-DL ]\n[ Extended-Max-Requested-BW-UL ]\n[ Extended-Max-Requested-BW-DL ]\n[ Extended-Max-Supported-BW-UL ]\n[ Extended-Max-Supported-BW-DL ]\n[ Extended-Min-Desired-BW-UL ]\n[ Extended-Min-Desired-BW-DL ]\n[ Extended-Min-Requested-BW-UL ]\n[ Extended-Min-Requested-BW-DL ]\n[ Flow-Status ]\n[ Priority-Sharing-Indicator ]\n[ Pre-emption-Capability ]\n[ Pre-emption-Vulnerability ]\n[ Reservation-Priority ]\n[ RS-Bandwidth ]\n[ RR-Bandwidth ]\n0*2[ Codec-Data ]\n[ Sharing-Key-DL ]\n[ Sharing-Key-UL ]\n[ Content-Version ]\n[ Max-PLR-DL ]\n[ Max-PLR-UL ]\n[ Desired-Max-Latency ]\n[ Desired-Max-Loss ]\n*[ AVP ]\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.17\tMedia-Component-Number AVP",
                            "text_content": "The Media-Component-Number AVP (AVP code 518) is of type Unsigned32, and it contains the ordinal number of the media component, assigned according to the rules in Annex B.\nWhen this AVP refers to AF signalling, this is indicated by using the value 0 according to the rules in Annex B.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.18\tMedia-Sub-Component AVP",
                            "text_content": "The Media-Sub-Component AVP (AVP code 519) is of type Grouped, and it contains the requested bitrate and filters for the set of IP flows identified by their common Flow-Identifier. The Flow-Identifier is defined in Annex B.\nPossible Bandwidth information and Flow-Status information provided within the Media-Sub-Component AVP takes precedence over information within the encapsulating Media Component Description AVP. If a Media-Sub-Component- AVP is not supplied, or if optional AVP(s) within a Media-Sub-Component AVP are omitted, but corresponding information has been provided in previous Diameter messages, the previous information for the corresponding IP flow(s) remains valid, unless new information is provided within the encapsulating Media-Component-Description AVP. If Flow-Description AVP(s) are supplied, they replace all previous Flow-Description AVP(s), even if a new Flow-Description AVP has the opposite direction as the previous Flow-Description AVP. The AF may also include the ToS-Traffic-Class AVP for requesting Type of Service or Traffic Class (for IPv4 and IPv6 respectively) based packet filter for the related flow.\nThe AF-Signalling-Protocol AVP may be included only if the Flow-Usage AVP has a value of ‘AF_SIGNALLING’.\nAll IP flows within a Media-Sub-Component- AVP are permanently disabled by supplying a Flow Status AVP with value \"REMOVED\". The server may delete corresponding filters and state information.\nAVP format:\nMedia-Sub-Component ::= < AVP Header: 519 >\n{ Flow-Number }              ; Ordinal number of the IP flow\n0*2 [ Flow-Description ]        ; UL and/or DL\n[ Flow-Status ]\n[ Flow-Usage ]\n[ Max-Requested-Bandwidth-UL ]\n[ Max-Requested-Bandwidth-DL ]\n[ Extended-Max-Requested-BW-UL ]\n[ Extended-Max-Requested-BW-DL ]\n[ AF-Signalling-Protocol ]\n[ ToS-Traffic-Class ]\n*[ AVP ]\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.19\tMedia-Type AVP",
                            "text_content": "The Media-Type AVP (AVP code 520) is of type Enumerated, and it determines the media type of a session component. The media types indicate the type of media in the same way as the SDP media types with the same names defined in RFC 4566 [13]. The following values are defined:\n-\tAUDIO (0)\n-\tVIDEO (1)\n-\tDATA (2)\n-\tAPPLICATION (3)\n-\tCONTROL (4)\n-\tTEXT (5)\n-\tMESSAGE (6)\n-\tOTHER (0xFFFFFFFF)\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.20\tRR-Bandwidth AVP",
                            "text_content": "The RR-Bandwidth AVP (AVP code 521) is of type Unsigned32, and it indicates the maximum required bandwidth in bits per second for RTCP receiver reports within the session component, as specified in IETF RFC 3556 [11]. The bandwidth contains all the overhead coming from the IP-layer and the layers above, i.e. IP, UDP and RTCP.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.21\tRS-Bandwidth AVP",
                            "text_content": "The RS-Bandwidth AVP (AVP code 522) is of type Unsigned32, and it indicates the maximum required bandwidth in bits per second for RTCP sender reports within the session component, as specified in RFC 3556 [11]. The bandwidth contains all the overhead coming from the IP-layer and the layers above, i.e. IP, UDP and RTCP.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.22\tSIP-Forking-Indication AVP",
                            "text_content": "The SIP-Forking-Indication AVP (AVP code 523) is of type Enumerated, and describes if several SIP dialogues are related to one Diameter session:\nSINGLE_DIALOGUE (0)\nThis value is used to indicate that the Diameter session relates to a single SIP dialogue.\nThis is the default value applicable if the AVP is omitted.\nSEVERAL_DIALOGUES (1)\nThis value is used to indicate that the Diameter session relates to several SIP dialogues.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.23\tService-URN AVP",
                            "text_content": "The Service-URN AVP (AVP code 525) is of type OctetString, and it indicates that an AF session is used for emergency or RLOS traffic.\nIt contains values of the service URN and it may include subservices, as defined in [21] for emergency and other well-known services or registered at IANA. The string \"urn:service:\" in the beginning of the URN shall be omitted in the AVP and all subsequent text shall be included. Examples of valid values of the AVP are \"sos\", \"sos.fire\", \"sos.police\" and \"sos.ambulance\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.24\tAcceptable-Service-Info AVP",
                            "text_content": "The Acceptable-Service-Info AVP (AVP code 526) is of type Grouped, and contains the maximum bandwidth for an AF session and/or for specific media components that will be authorized by the PCRF. The Max-Requested-Bandwidth-DL AVP, the Max-Requested-Bandwidth-UL AVP, the Extended-Max-Requested-BW-DL AVP and the Extended-Max-Requested-BW-UL AVP (see clause 4.4.10)directly within the Acceptable-Service-Info AVP indicate the acceptable bandwidth for the entire AF session. The Max-Requested-Bandwidth-DL AVP, Max-Requested-Bandwidth-UL AVP, Extended-Max-Requested-BW-DL AVP and Extended-Max-Requested-BW-UL AVP within a Media-Component-Description AVP included in the Acceptable-Service-Info AVP indicate the acceptable bandwidth for the corresponding media component.\nIf the acceptable bandwidth applies to one or more media components, only the Media-Component-Description AVP will be provided. If the acceptable bandwidth applies to the whole AF session, only the Max-Requested-Bandwidth-DL AVP the Max-Requested-Bandwidth-UL AVP, the Extended-Max-Requested-BW-DL AVP and the Extended-Max-Requested-BW-DL AVP will be included.\nAcceptable-Service-Info::= < AVP Header: 526 >\n*[ Media-Component-Description]\n[ Max-Requested-Bandwidth-DL ]\n[ Max-Requested-Bandwidth-UL ]\n[ Extended-Max-Requested-BW-DL ]\n[ Extended-Max-Requested-BW-UL ]\n*[ AVP ]\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.25\tService-Info-Status-AVP",
                            "text_content": "The Service-Info-Status AVP (AVP code 527) is of type Enumerated, and indicates the status of the service information that the AF is providing to the PCRF. If the Service-Info-Status AVP is not provided in the AA request, the value FINAL SERVICE INFORMATION shall be assumed.\nFINAL SERVICE INFORMATION (0)\nThis value is used to indicate that the service has been fully negotiated between the two ends and service information provided is the result of that negotiation.\nPRELIMINARY SERVICE INFORMATION (1)\nThis value is used to indicate that the service information that the AF has provided to the PCRF is preliminary and needs to be further negotiated between the two ends (e.g. for IMS when the service information is sent based on the SDP offer).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.26\tAF-Signalling-Protocol-AVP",
                            "text_content": "The AF-Signalling-Protocol AVP (AVP code 529) is of type Enumerated, and indicates the protocol used for signalling between the UE and the AF. If the AF-Signalling-Protocol AVP is not provided in the AA-Request, the value NO_INFORMATION shall be assumed.\nNO_INFORMATION (0)\nThis value is used to indicate that no information about the AF signalling protocol is being provided.\nSIP (1)\nThis value is used to indicate that the signalling protocol is Session Initiation Protocol.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.27\tSponsored-Connectivity-Data AVP",
                            "text_content": "The Sponsored-Connectivity-Data AVP (AVP code 530) is of type Grouped, and contains the data associated with the sponsored data connectivity.\nThe Sponsor-Identity AVP identifies the sponsor. It shall be included by the AF in the Sponsored-Connectivity-Data AVP except for the case of disabling sponsored data connectivity.\nThe Application-Service-Provider-Identity AVP identifies the application service provider. It shall be included by the AF in the Sponsored-Connectivity-Data AVP except for the case of disabling sponsored data connectivity.\nThe Granted-Service-Unit AVP shall be used by the AF to provide usage threshold to the PCRF if the volume and/or time of traffic allowed during the sponsored data connectivity is to be monitored.\nThe Used-Service-Unit AVP shall be used by the PCRF to provide the measured usage to the AF. Reporting shall be done, as requested by the AF, in CC-Total-Octets, CC-Input-Octets, CC-Output-Octets or CC-Time of the Used-Service-Unit AVP.\nSponsoring-Action AVP shall be used by the AF to provide the indication to the PCRF if sponsored data connectivity is to be enabled or disabled.\nAVP format:\nSponsored-Connectivity-Data::= < AVP Header: 530 >\n[ Sponsor-Identity ]\n[ Application-Service-Provider-Identity ]\n[ Granted-Service-Unit ]\n[ Used-Service-Unit ]\n[ Sponsoring-Action ]\n*[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.28\tSponsor-Identity AVP",
                            "text_content": "The Sponsor-Identity AVP (AVP code 531) is of type UTF8String and is used for sponsored data connectivity purposes as an identifier of the sponsor.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.29\tApplication-Service-Provider-Identity AVP",
                            "text_content": "The Application-Service-Provider-Identity AVP (AVP code 532) is of type UTF8String and is used for sponsored data connectivity purposes as an identifier of the application service provider.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.30\tMPS-Identifier AVP",
                            "text_content": "The MPS-Identifier AVP (AVP code 528) is of type OctetString, and it indicates that an AF session relates to an MPS session. It contains the national variant for MPS service name (e.g., NGN GETS).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.31\tRx-Request-Type AVP",
                            "text_content": "The Rx-Request-Type AVP (AVP code 533) is of type Enumerated, and contains the reason for sending the AA-Request message.\nThe following values are defined:\nINITIAL_REQUEST (0)\nAn initial request is used to initiate an Rx session and contains information that is relevant to initiation.\nUPDATE_REQUEST (1)\nAn update request is used to update an existing Rx session.\nPCSCF_RESTORATION (2)\nA P-CSCF Restoration is requested. This value is only applicable to the PCSCF-Restoration-Enhancement feature defined in clause 5.4.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.32\tMin-Requested-Bandwidth-DL AVP",
                            "text_content": "The Min-Requested-Bandwidth-DL AVP (AVP code 534) is of type Unsigned32, and it indicates the minimum requested bandwidth in bits per second for a downlink IP flow. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, TCP, UDP, HTTP, RTP and RTP payload.\nWhen provided in an AA-Request, it indicates the minimum requested bandwidth.\nWhen the Extended-Min-Requested-BW-NR feature is supported and the value to be transmitted exceeds 2^32-1, the Extended-Min-Requested-Bandwidth-DL AVP shall be used, see clause 4.4.10 and clause 5.3.58.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.33\tMin-Requested-Bandwidth-UL AVP",
                            "text_content": "The Min-Requested-Bandwidth-UL AVP (AVP code 535) is of type Unsigned32, and it indicates the minimum requested bandwidth in bits per second for an uplink IP flow. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, TCP, UDP, HTTP, RTP and RTP payload.\nWhen provided in an AA-Request, it indicates the minimum requested bandwidth.\nWhen the Extended-Min-Requested-BW-NR feature is supported and the value to be transmitted exceeds 2^32-1, the Extended-Min-Requested-Bandwidth-UL AVP shall be used, see clause 4.4.10 and clause 5.3.59.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.34\tRequired-Access-Info AVP",
                            "text_content": "The Required-Access-Info AVP (AVP code 536) is of type Enumerated, and contains the access network information required for that AF session.\nThe following values are defined:\nUSER_LOCATION (0)\nIndicates that the user location information shall be reported, the PCRF shall report the user location information within the 3GPP-User-Location-Info AVP (if available), the serving network identifier containing PLMN identifier within the 3GPP-SGSN-MCC-MNC AVP (if available) and NID AVP (if available), the user location information within the TWAN-Identifier (if available) , UE-Local-IP-Address AVP (if available) , UDP-Source-Port AVP (if available), TCP-Source-Port AVP (if available) and User-Location-Info-Time AVP (if available).\nThe NID AVP is only applicable in 5GS when the serving network is an SNPN, as described in Annex E.\nMS_TIME_ZONE (1)\nIndicates that the user timezone information shall be reported, the PCRF shall report the user timezone information within the 3GPP-MS-TimeZone AVP.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.35\tIP-Domain-Id AVP",
                            "text_content": "The IP-Domain-Id AVP (AVP code 537) is of type (OctetString), and indicates the domain information which assists session binding.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.36\tGCS-Identifier AVP",
                            "text_content": "The GCS-Identifier AVP (AVP code 538) is of type OctetString, and it indicates that an AF session relates to a Group Communication session that requires prioritization.The values that identify the Group Communication session are not specified.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.37\tSharing-Key-DL AVP",
                            "text_content": "The Sharing-Key-DL AVP (AVP code 539) is of type Unsigned32 and is used to identify what media components may share resource in the downlink direction.\nThe Sharing-Key-DL AVP shall be used as follows:\n-\tIf resource sharing applies between media components across AF sessions for the same user, the same value of the Sharing-Key-DL AVP shall be used;\n-\tIf resource sharing does not apply between media components across AF sessions for the same user, a different value of the Sharing-Key-DL AVP shall be used for each media component.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.38\tSharing-Key-UL AVP",
                            "text_content": "The Sharing-Key-UL AVP (AVP code 540) is of type Unsigned32 and is used to identify what media components may share resource in the uplink direction.\nThe Sharing-Key-UL AVP shall be used as follows:\n-\tIf resource sharing applies between media components across AF sessions for the same user, the same value of the Sharing-Key-UL AVP shall be used;\n-\tIf resource sharing does not apply between media components across AF sessions for the same user, a different value of the Sharing-Key-UL AVP shall be used for each media component.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.39\tRetry-Interval AVP",
                            "text_content": "The Retry-Interval AVP (AVP code 541) is of type Unsigned32, and it indicates a time interval in seconds to wait until which the AF retries to send the same service information to the PCRF (for the same IP-CAN session) when the service information is temporarily rejected by the PCRF (e.g. due to the detected congestion status of the cell the user is located in).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.40\tSponsoring-Action AVP",
                            "text_content": "The Sponsoring-Action AVP (AVP code 542) is of type Enumerated, and contains the indication whether to enable or disable/not enable sponsored data connectivity.\nThe following values are defined:\nDISABLE_SPONSORING (0)\nDisable sponsored data connectivity or not enable sponsored data connectivity\nENABLE_SPONSORING (1)\nEnable sponsored data connectivity.\nNOTE:\tThe use of value DISABLE_SPONSORING (0) to \"not enable\" sponsored data connectivity is used at initial provisioning of session information to provide sponsor information but not enable it at that point in time and to \"disable\" sponsored data connectivity is used at modification of session information when disabling sponsored data connectivity previously enabled.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.41\tMax-Supported-Bandwidth-DL AVP",
                            "text_content": "The Max-Supported-Bandwidth-DL AVP (AVP code 543) is of type Unsigned32, and it indicates the maximum supported bandwidth in bits per second for a downlink IP flow as defined in 3GPP TS 26.114 [41]. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTP payload.\nWhen the Extended-BW-E2EQOSMTSI-NR feature is supported and the value to be transmitted exceeds 2^32-1, the Extended-Max-Supported-Bandwidth-DL AVP shall be used, see clause 4.4.10 and clause 5.3.54.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.42\tMax-Supported-Bandwidth-UL AVP",
                            "text_content": "The Max-Supported-Bandwidth-UL AVP (AVP code 544 is of type Unsigned32, and it indicates the maximum supported bandwidth in bits per second for an uplink IP flow as defined in 3GPP TS 26.114 [41]. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTP payload.\nWhen the Extended-BW-E2EQOSMTSI-NR feature is supported and the value to be transmitted exceeds 2^32-1, the Extended-Max-Supported-Bandwidth-UL AVP shall be used, see clause 4.4.10 and clause 5.3.55.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.43\tMin-Desired-Bandwidth-DL AVP",
                            "text_content": "The Min-Desired-Bandwidth-DL AVP (AVP code 545) is of type Unsigned32, and it indicates the minimum desired bandwidth in bits per second for a downlink IP flow as defined in 3GPP TS 26.114 [41]. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTP payload.\nWhen the Extended-BW-E2EQOSMTSI-NR feature is supported and the value to be transmitted exceeds 2^32-1, the Extended-Min-Desired-Bandwidth-DL AVP shall be used, see clause 4.4.10 and clause 5.3.56.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.44\tMin-Desired-Bandwidth-UL AVP",
                            "text_content": "The Min-Desired-Bandwidth-DL AVP (AVP code 546) is of type Unsigned32, and it indicates the minimum desired bandwidth in bits per second for an uplink IP flow as defined in 3GPP TS 26.114 [41]. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTP payload.\nWhen the Extended-BW-E2EQOSMTSI-NR feature is supported and the value to be transmitted exceeds 2^32-1, the Extended-Min-Desired-Bandwidth-UL AVP shall be used, see clause 4.4.10 and clause 5.3.57.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.45\tMCPTT-Identifier AVP",
                            "text_content": "The MCPTT-Identifier AVP (AVP code 547) is of type OctetString, and it includes either one of the namespace values used for MCPTT (see IETF RFC 8101 [45]) and it may include the name of the MCPTT service provider.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.45A\tMCVideo-Identifier AVP",
                            "text_content": "The MCVideo-Identifier AVP (AVP code 562) is of type OctetString, and it includes the name of the MCVideo service provider.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.46\tService-Authorization-Info AVP",
                            "text_content": "The Service-Authorization-Info AVP (AVP code 548) is of type Unsigned32, it shall contain a bit mask and indicatethe result of the authorization for the service request from the AF. The bit 0 shall be the least significant bit. For example, to get the value of bit 0, a bit mask of 0x0001 should be used. The meaning of the bits shall be as defined below:\nTable 5.3.46: Service-Authorization-Info\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.3.46: Service-Authorization-Info",
                                    "table number": 2,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.3.47\tPriority-Sharing-Indicator AVP",
                            "text_content": "The Priority-Sharing-Indicator AVP (AVP code 550) is of type Enumerated and is used to indicate that the related media component can use the same Allocation and Retention Priority as media component(s) which are assigned the same QCI in the PCRF belonging to other AF sessions for the same IP-CAN session that also contain the Priority-Sharing-Indicator AVP set to PRIORITY_SHARING_ENABLED.\nThe following values are defined:\nPRIORITY_SHARING_ENABLED (0)\nThis value indicates that the related media component is allowed to share the Allocation and Retention Priority with media components belonging to other AF sessions that have also indicated that priority sharing is enabled.\nPRIORITY_SHARING_DISABLED (1)\nThis value indicates that the related media component is not allowed to share the Allocation and Retention Priority with media components belonging to other AF sessions. This is the default value applicable if this AVP is not supplied.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.48\tMedia-Component-Status AVP",
                            "text_content": "The Media-Component-Status AVP (AVP code 549) is of type Unsigned32, and it describes the status of the PCC/QoS rule(s) related to a media component.\nThe following values are defined in this specification:\n0 (ACTIVE):\nThis value shall be used to indicate that the PCC/QoS rule(s) related to certain media component are active.\n1 (INACTIVE):\nThis value shall be used to indicate that the PCC/QoS rule(s) related to certain media component are inactive. This is the default value applicable if this AVP is not supplied.\nNOTE:\tIt is assumed that the AF considers the PCC/QoS rule(s) related to the media component(s) for which the Media-Component-Status AVP(s) are not received as inactive when the Specific-Action AVP set to INDICATION_OF_FAILED_RESOURCES_ALLOCATION (9) is received.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.49\tContent-Version AVP",
                            "text_content": "The Content-Version AVP (AVP code 552) is of type Unsigned64, and it indicates the version of some content, e.g. of the content of a media component included within the Media-Component-Description AVP. The content version shall be unique for the content and for the lifetime of that content.\nNOTE:\tThe method of assigning content versions within the Content-Version AVPs is implementation specific. Example implementations are a monotonically increasing number or a value based on a timestamp.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.50\tAF-Requested-Data AVP",
                            "text_content": "The AF-Requested-Data AVP (AVP code 551) is of type Unsigned32 and indicates the information that the AF requested to be exposed, it shall contain a bit mask. The bit 0 shall be the least significant bit. For example, to get the value of bit 0, a bit mask of 0x0001 should be used. The meaning of the bits shall be as defined below:\nTable 5.3.50.1: AF-Requested-Data\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.3.50.1: AF-Requested-Data",
                                    "table number": 3,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.3.51\tPre-emption-Control-Info AVP",
                            "text_content": "The Pre-emption-Control-Info (AVP code 553) is of type Unsigned32, it shall contain a bit mask and indicate that how the PCRF to perform pre-emption among multiple potential media flow candidates of same priority. Pre-emption-Control-Info AVP is provided at the AAR command level and the latest provided value within the Pre-emption-Control-Info AVP shall be applied to all potential media flow candidates. The bit 0 shall be the least significant bit. For example, to get the value of bit 0, a bit mask of 0x0001 should be used. The meaning of the bits shall be as defined below:\nThe following values are defined, only one bit shall be set at the same time:\nTable 5.3.51: Pre-emption-Control-Info\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.3.51: Pre-emption-Control-Info",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.3.52\tExtended-Max-Requested-BW-DL AVP",
                            "text_content": "The Extended-Max-Requested-BW-DL AVP (AVP code 554) is of type Unsigned32, and it indicates the maximum requested bandwidth in kbit per second for a downlink IP flow. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTP payload.\nWhen provided in an AA-Request, it indicates the maximum requested bandwidth. When provided in an AA-Answer, it indicates the maximum bandwidth acceptable by PCRF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.53\tExtended-Max-Requested-BW-UL AVP",
                            "text_content": "The Extended-Max–Requested-BW-UL AVP (AVP code 555) is of type Unsigned32, and it indicates the maximum requested bandwidth in kbit per second for an uplink IP flow. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTP payload.\nWhen provided in an AA-Request, it indicates the maximum requested bandwidth. When provided in an AA-Answer, it indicates the maximum bandwidth acceptable by PCRF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.54\tExtended-Max-Supported-BW-DL AVP",
                            "text_content": "The Extended-Max-Supported-BW-DL AVP (AVP code 556) is of type Unsigned32, and it indicates the maximum supported bandwidth in kbit per second for a downlink IP flow as defined in 3GPP TS 26.114 [41]. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTP payload.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.55\tExtended-Max-Supported-BW-UL AVP",
                            "text_content": "The Extended-Max-Supported-BW-UL AVP (AVP code 557) is of type Unsigned32, and it indicates the maximum supported bandwidth in kbit per second for an uplink IP flow as defined in 3GPP TS 26.114 [41]. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTP payload.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.56\tExtended-Min-Desired-BW-DL AVP",
                            "text_content": "The Extended-Min-Desired-BW-DL AVP (AVP code 558) is of type Unsigned32, and it indicates the minimum desired bandwidth in kbit per second for a downlink IP flow as defined in 3GPP TS 26.114 [41]. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTP payload.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.57\tExtended-Min-Desired-BW-UL AVP",
                            "text_content": "The Extended-Min-Desired-BW-UL AVP (AVP code 559) is of type Unsigned32, and it indicates the minimum desired bandwidth in kbit per second for an uplink IP flow as defined in 3GPP TS 26.114 [41]. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTP payload.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.58\tExtended-Min-Requested-BW-DL AVP",
                            "text_content": "The Extended-Min-Requested-BW-DL AVP (AVP code 560) is of type Unsigned32, and it indicates the minimum requested bandwidth in kbit per second for a downlink IP flow. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, TCP, UDP, HTTP, RTP and RTP payload.\nWhen provided in an AA-Request, it indicates the minimum requested bandwidth.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.59\tExtended-Min-Requested-BW-UL AVP",
                            "text_content": "The Extended-Min-Requested-Bandwidth-UL AVP (AVP code 561) is of type Unsigned32, and it indicates the minimum requested bandwidth in kbit per second for an uplink IP flow. The bandwidth contains all the overhead coming from the IP-layer and the layers above, e.g. IP, TCP, UDP, HTTP, RTP and RTP payload.\nWhen provided in an AA-Request, it indicates the minimum requested bandwidth.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.60\tIMS-Content-Identifier AVP",
                            "text_content": "The IMS-Content-Identifier AVP (AVP code 563) is of type OctetString, and it contains information that identifies the particular IMS communication service or communication dialogue that the AF service session belongs to. This information may be used by the PCRF, for example, to differentiate Charging for different communication dialogs in the IMS session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.61\tIMS-Content-Type AVP",
                            "text_content": "The IMS-Content-Type AVP (AVP code 564) is of type Enumerated, and it indicates the type of IMS communication service the AF session refers to. The following values are defined:\nNO_CONTENT_DETAIL (0)\nThis value is used to indicate that no information about the type of IMS communication service is being provided\nCAT (1)\nThis value is used to indicate that the type of IMS communication service is Customized Alerting Tones\nCONFERENCE (2)\nThis value is used to indicate that the type of IMS communication service is 3PTY conference\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.62\tCallee-Information AVP",
                            "text_content": "The Callee-Information AVP (AVP code 565) is of type Grouped, and it contains information that identifies the callee information of the AF service session. This information may be used by the PCRF, for example, to provide the callee information in the PCC rule decision for further volume based charging.\nAVP Format:\nCallee-Information::= < AVP Header: 565 >\n[Called-Party-Address]\n*[Requested-Party-Address]\n*[Called-Asserted-Identity]\n*[AVP]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.63\tFLUS-Identifier AVP",
                            "text_content": "The FLUS-Identifier AVP (AVP code 566) is of type OctetString, and it indicates that a media component is used for FLUS media.\nIt is derived from the media level attribute \"a=label:\" (see IETF RFC 4574 [68]) obtained from the SDP body. It contains the string after \"a=label:\" starting with \"flus\" and may be followed by more characters as described in 3GPP TS 26.238 [69].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.64\tDesired-Max-Latency AVP",
                            "text_content": "The Desired-Max-Latency AVP (AVP code 567) is of type Float32 and describes the maximum desirable end to end transport level packet latency in milliseconds as a zero-based integer or as a non-zero real value. The value excludes any application level processing in the sender and receivers, such as e.g. application-level retransmission or encoding/decoding.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.65\tDesired-Max-Loss AVP",
                            "text_content": "The Desired-Max-Loss AVP (AVP code 568) is of type Float32 and describes the maximum desirable end to end transport level packet loss rate in percent (without \"%\" sign) as a zero-based integer or as a non-zero real value.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.66\tMA-Information AVP",
                            "text_content": "The MA-Information AVP (AVP code 570) is of type Grouped, and contains the additional or released IP-CAN type and RAT type for a MA PDU session.\nMA-Information::= < AVP Header: 570 >\n[ IP-CAN-Type ]\n[ RAT-Type ]\n[ MA-Information-Action ]\n*[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.67\tMA-Information-Action AVP",
                            "text_content": "The MA-Information-Action AVP (AVP code 571) is of type Unsigned32, and it indicates the action to apply to the IP-CAN type and RAT type values included in the MA-Information AVP.\nThe following values are defined in this specification:\n0 (ADD):\nThis value shall be used to indicate that the IP-CAN Type/RAT Type included in the MA-Information AVP are available for the MA PDU session.\n1 (RELEASE):\nThis value shall be used to indicate that the IP-CAN Type/RAT Type included in the MA-Information AVP are released and not available for the MA PDU session.\n0 (ADD) is the default value.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.68\tNID AVP",
                            "text_content": "The NID AVP (AVP code 569) is of type OctetString, and it indicates Network Identifier (NID) consisting on 44 bits (11 hexadecimal digits), as specified in 3GPP TS 23.003 [38], clause 12.7.\nThe NID AVP is only applicable in 5GS when the serving network is an SNPN, as described in Annex E.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.69\t5GS-RAN-NAS-Release-Cause AVP (3GPP-5GS and Non-3GPP-5GS access type)",
                            "text_content": "The 5GS-RAN-NAS-Release-Cause AVP (AVP code 572) is of type Grouped, and indicates the RAN or NAS release cause code information in 3GPP-5GS and non-3GPP-5GS access types.\nAVP Format:\n5GS-RAN-NAS-Release-Cause ::= < AVP Header: 572 >\n[5GMM-Cause]\n[5GSM-Cause]\n[NGAP-Cause]\n*[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.70\t5GMM-Cause AVP",
                            "text_content": "The 5GMM-Cause AVP (AVP code 573) is of type Unsigned32 and indicates the 5GMM cause code information. The AVP shall be coded as per the 5GMM Cause in clause 9.11.3.2 of 3GPP TS 24.501 [70].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.71\t5GSM-Cause AVP",
                            "text_content": "The 5GSM-Cause AVP (AVP code 574) is of type Unsigned32 and indicates the 5GSM cause code information. The AVP shall be coded as per the 5GSM Cause in clause 9.11.4.2 of 3GPP TS 24.501 [70].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.72\tNGAP-Cause AVP",
                            "text_content": "The NGAP-Cause AVP (AVP code 575) is of type Grouped and indicates the NG Application Protocol cause value as specified in clause 9.4.5 of 3GPP TS 38.413 [71].\nAVP Format:\nNGAP-Cause ::= < AVP Header: 575 >\n{NGAP-Group}\n{NGAP-Value}\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.73\tNGAP-Group AVP",
                            "text_content": "The NGAP-Group AVP (AVP code 576) is of type Unsigned32, and it indicates the group of the NGAP cause. The value of this IE shall equal to the ASN.1 value of the specified NGAP cause group\nNGAP supports cause groups defined as separate enumerations, as specified in clause 9.4.5 of 3GPP TS 38.413 [71]. The following values are defined in this specification:\n0:\nThis value indicates the NGAP cause group is \"radioNetwork\".\n1:\nThis value indicates the NGAP cause group is \"transport\".\n2:\nThis value indicates the NGAP cause group is \"nas\".\n3:\nThis value indicates the NGAP cause group is \"protocol\".\n4:\nThis value indicates the NGAP cause group is \"misc\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.74\tNGAP-Value AVP",
                            "text_content": "The NGAP-Value AVP (AVP code 577) is of type Unsigned32 and indicates the NG AP cause value in specific cause group identified by the NGAP-Group AVP, as specified in clause 9.4.5 of 3GPP TS 38.413 [71].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.75\tWireline-User-Location-Info AVP",
                            "text_content": "The Wireline-User-Location-Info AVP (AVP code 578) is of type Grouped and contains either wireline Cable or wireline BBF user location information.\nThe HFC-Node-Identifier AVP indicates wireline cable location and contains an HFC Node Identifer.\nThe GLI-Identifier AVP indicates wireline BBF location and contains a Global Line Identifier. The Line-Type AVP indicates the type of line included in the GLI-Identifier AVP.\nAVP Format:\nWireline-User-Location-Info ::= < AVP Header: 578 >\n[ HFC-Node-Identifier ]\n[ GLI-Identifier ]\n[ Line-Type ]\n*[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.76\tHFC-Node-Identifier AVP",
                            "text_content": "The HFC-Node-Identifier AVP (AVP code 579) is of type OctetString and contains an HFC Node Identifier as specified in CableLabs WR-TR-5WWC-ARCH [73].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.77\tGLI-Identifier AVP",
                            "text_content": "The GLI-Identifier AVP (AVP code 580) is of type OctetString and contains a Global Line Identifier (see clause 28.16.3 of 3GPP TS 23.003 [38]) encoded as base64-encoded characters, representing the GLI value (up to 150 bytes) as specified in BBF WT-470 [74].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.78\tLine-Type AVP",
                            "text_content": "The Line-Type AVP (AVP code 581) is of type Unsigned32 and it indicates the type of wireline (DSL or PON) for the wireline BBF access.\nThe following values are defined in this specification:\n0 (DSL):\nThis value shall be used to indicate DSL line.\n1 (PON):\nThis value shall be used to indicate PON line.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.79\tMPS-Action AVP",
                            "text_content": "The MPS-Action AVP (AVP code 582) is of type Enumerated, and contains the indication whether to enable or disable MPS for DTS.\nThe following values are defined:\nDISABLE_MPS_FOR_DTS (0)\nDisable MPS for DTS.\nENABLE_MPS_FOR_DTS (1)\nEnable MPS for DTS.\nAUTHORIZE_AND_ENABLE_MPS_FOR_DTS (2)\nThe PCRF shall check the user's MPS subscription and enable MPS for DTS.\nAUTHORIZE_AND_ENABLE_MPS_FOR_AF_SIGNALLING (3)\nThe PCRF shall check the user's MPS subscription and enable MPS for AF signalling.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.4\tRx re-used AVPs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.4.0\tGeneral",
                            "text_content": "Table 5.4.0.1 lists the Diameter AVPs re-used by the Rx reference point from existing Diameter Applications, including a reference to their respective specifications and when needed, a short description of their usage within the Rx reference point. Other AVPs from existing Diameter Applications, except for the AVPs from Diameter Base Protocol, do not need to be supported. The AVPs from Diameter Base Protocol are not included in table 5.4.0.1, but they are re-used for the Rx protocol. Unless otherwise stated, re-used AVPs shall maintain their ‘M’, ‘P’ and ‘V’ flag settings. Where 3GPP Radius VSAs are re-used, unless otherwise stated, they shall be translated to Diameter AVPs as described in RFC 4005 [12] with the exception that the ‘M’ flag shall be set and the ‘P’ flag may be set.\nTable 5.4.0.1: Rx re-used Diameter AVPs\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.4.0.1: Rx re-used Diameter AVPs",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.4.1\tUse of the Supported-Features AVP on the Rx reference point",
                            "text_content": "The Supported-Features AVP is used during session establishment to inform the destination host about the required and optional features that the origin host supports. The client shall, in the first request of a Diameter session indicate the set of supported features. The server shall, in the first answer within the Diameter session indicate the set of features that it has in common with the client and that the server shall support within the same Diameter session. Any further command messages shall always be compliant with the list of supported features indicated in the Supported-Features AVPs during session establishment. Features that are not advertised as supported shall not be used to construct the command messages for that Diameter session. Unless otherwise stated, the use of the Supported-Features AVP on the Rx reference point shall be compliant with the requirements for dynamic discovery of supported features and associated error handling on the Cx reference point as defined in clause 7.2.1 of 3GPP TS 29.229 [25].\nThe base functionality for the Rx reference point is the 3GPP Rel-7 standard and a feature is an extension to that functionality. If the origin host does not support any features beyond the base functionality, the Supported-Features AVP may be absent from the Rx commands. As defined in clause 7.1.1 of 3GPP TS 29.229 [25], when extending the application by adding new AVPs for a feature, the new AVPs shall have the M bit cleared and the AVP shall not be defined mandatory in the command ABNF.\nAs defined in 3GPP TS 29.229 [25], the Supported-Features AVP is of type grouped and contains the Vendor-Id, Feature-List-ID and Feature-List AVPs. On the Rx reference point, the Supported-Features AVP is used to identify features that have been defined by 3GPP and hence, for features defined in this document, the Vendor-Id AVP shall contain the vendor ID of 3GPP (10415). If there are multiple feature lists defined for the Rx reference point, the Feature-List-ID AVP shall differentiate those lists from one another.\nOn receiving an initial request application message, the destination host shall act as defined in clause 7.2.1 of 3GPP TS 29.229 [25]. The following exceptions apply to the initial and stateless AAR/AAA command pair:\n-\tIf the AF supporting post-Rel-7 Rx functionality is able to interoperate with a PCRF supporting Rel-7, the  shall include the features supported by the AF within Supported-Features AVP(s) with the ‘M’ bit cleared. Otherwise, the  shall include the supported features within the Supported-Features AVP(s) with the M-bit set.\nNOTE 1:\tOne instance of Supported-Features AVP is needed per Feature-List-ID.\n-\tIf the  command does not contain any Supported-Features AVP(s) and the PCRF supports Rel-7 Rx functionality, the AAA command shall not include the Supported-Features AVP. In this case, both AF and PCRF shall behave as specified in the Rel-7 version of this document.\n-\tIf the  command contains the Supported-Features AVP(s), the PCRF shall include the Supported-Features AVP(s) in the AAA command, with the ‘M’ bit cleared, indicating only the features that both the PCRF and AF support. In this case, the PCRF should not use the 'M' bit setting of the Supported-Features AVP(s) to determine if the AAR is accepted or rejected.\nNOTE 2:\tThe client will always declare all features that are supported according to table 5.4.1.1. When more than one feature identifying a release is supported by both AF and PCRF, the AF will work according to the latest common supported release.\nOnce the PCRF and AF have negotiated the set of supported features during session establishment, the set of common features shall be used during the lifetime of the Diameter session.\nThe table below defines the features applicable to the Rx interfaces for the feature list with a Feature-List-ID of 1.\nTable 5.4.1.1: Features of Feature-List-ID 1 used in Rx\n\nTable 5.4.1.2: Features of Feature-List-ID 2 used in Rx\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.4.1.1: Features of Feature-List-ID 1 used in Rx",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.4.1.2: Features of Feature-List-ID 2 used in Rx",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "5.5\tRx specific Experimental-Result-Code AVP values",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.5.1\tPermanent Failures",
                            "text_content": "Errors that fall within the Permanent Failures category shall be used to inform the peer that the request failed, and should not be attempted again.\nIETF RFC 6733 [52] specifies the Experimental-Result AVP containing Vendor-ID AVP and Experimental-Result-Code AVP. The Experimental-Result-Code AVP (AVP Code 298) is of type Unsigned32 and contains a vendor-assigned value representing the result of processing a request. The Vendor-ID AVP shall be set to 3GPP (10415).\nSpecific values of the Rx specific Experimental-Result-Code AVP are:\nINVALID_SERVICE_INFORMATION (5061)\nThe PCRF rejects new or modified service information the service information provided by the AF is invalid or insufficient for the server to perform the requested action.\nFILTER_RESTRICTIONS (5062)\nThe PCRF rejects new or modified service information because the Flow-Description AVP(s) cannot be handled by the server because restrictions defined in clause 5.3.8 are not observed.\nREQUESTED_SERVICE_NOT_AUTHORIZED (5063)\nThe PCRF rejects new or modified service information because the requested service, as described by the service information provided by the AF, is not consistent with either the related subscription information, operator defined policy rules and/or the supported features in the IP-CAN network.\nDUPLICATED_AF_SESSION (5064)\nThe PCRF rejects a new Rx session setup because the new Rx session relates to an AF session with another related active Rx session, e.g. if the AF provided the same AF charging identifier for this new Rx session that is already in use for the other ongoing Rx session.\nIP-CAN_SESSION_NOT_AVAILABLE (5065)\nThe PCRF rejects a new Rx session setup when it fails to associate the described service IP flows within the session information received from the AF to an existing IP-CAN session.\nUNAUTHORIZED_NON_EMERGENCY_SESSION (5066)\nThe PCRF rejects a new Rx session setup because the session binding function associated a non-Emergency IMS session to an IP-CAN session established to an Emergency APN.\nUNAUTHORIZED_SPONSORED_DATA_CONNECTIVITY (5067)\nThe PCRF rejects a new Rx session setup because the PCRF can’t authorize the sponsored data connectivity based on the sponsored data connectivity profile or the operator policy (e.g. the sponsored data connectivity not authorized in the roaming case).\nTEMPORARY_NETWORK_FAILURE (5068)\nThe PCRF rejects new or modified service information because there is a temporary failure in the access network (e.g. the SGW has failed).\nUNAUTHORIZED_NON_RLOS_SESSION (5069)\nThe PCRF rejects a new Rx session setup because the session binding function associated a non-RLOS IMS session to an IP-CAN session established to an RLOS APN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.2\tTransient Failures",
                            "text_content": "Errors that fall within the transient failures category are used to inform a peer that the request could not be satisfied at the time it was received, but may be able to satisfy the request in the future.\nThe Result-Code AVP values defined in Diameter Base IETF RFC 6733 [52] are applicable. Also the following specific Rx Experimental-Result-Code value is defined for transient failures:\nREQUESTED_SERVICE_TEMPORARILY_NOT_AUTHORIZED (4261)\nThe PCRF temporarily rejects new or modified service information because the network is temporarily not able to provide the service delivery that the AF requested, e.g. due to the service information is not consistent with the operator defined policy rules for the congestion status of the user.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.6\tRx messages",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.6.0\tGeneral",
                            "text_content": "Existing Diameter command codes from the Diameter base protocol IETF RFC 6733 [52] and the NASREQ Diameter application (RFC 4005 [12]) are used with the Rx specific AVPs. An Rx specific Auth-Application id is used together with the command code to identify the Rx messages.\nNOTE 1:\tThe notion of NAS (Network Access Server) is not used here, NASREQ is just used for protocol purposes, not for its functional meaning.\nNOTE 2:\tSome of the AVPs included in the messages formats below are in bold to highlight that these AVPs are used by this specific protocol and do not belong to the original Diameter Base Protocol IETF RFC 6733 [52].\nNOTE3:\tMultiple instances of the Subscription-Id AVP in the AAR or RAR command correspond to multiple types of identifier for the same subscriber, for example IMSI and MSISDN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6.1\tAA-Request (AAR) command",
                            "text_content": "The  command, indicated by the Command-Code field set to 265 and the ‘R’ bit set in the Command Flags field, is sent by an AF to the PCRF in order to provide it with the Session Information.\nMessage Format:\n<AA-Request> ::= < Diameter Header: 265, REQ, PXY >\n< Session-Id >\n[ DRMP ]\n{ Auth-Application-Id }\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n[ Destination-Host ]\n[ IP-Domain-Id ]\n[ Auth-Session-State ]\n[ AF-Application-Identifier ]\n*[ Media-Component-Description ]\n[ Service-Info-Status ]\n[ AF-Charging-Identifier ]\n[ SIP-Forking-Indication ]\n*[ Specific-Action ]\n*[ Subscription-Id ]\n[ OC-Supported-Features ]\n*[ Supported-Features ]\n[ Reservation-Priority ]\n[ Framed-IP-Address ]\n[ Framed-Ipv6-Prefix ]\n[ Called-Station-Id ]\n[ Service-URN ]\n[ Sponsored-Connectivity-Data ]\n[ MPS-Identifier ]\n[ GCS-Identifier ]\n[ MCPTT-Identifier ]\n[ MCVideo-Identifier ]\n[ IMS-Content-Identifier ]\n[ IMS-Content-Type ]\n*[ Calling-Party-Address ]\n[ Callee-Information ]\n[ Rx-Request-Type ]\n*[ Required-Access-Info ]\n[AF-Requested-Data ]\n[ Reference-Id ]\n[ Pre-emption-Control-Info ]\n[ MPS-Action ]\n[ Origin-State-Id ]\n*[ Proxy-Info ]\n*[ Route-Record ]\n*[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6.2\tAA-Answer (AAA) command",
                            "text_content": "The AAA command, indicated by the Command-Code field set to 265 and the ‘R’ bit cleared in the Command Flags field, is sent by the PCRF to the AF in response to the  command.\nMessage Format:\n<AA-Answer> ::=  < Diameter Header: 265, PXY >\n< Session-Id >\n[ DRMP ]\n{ Auth-Application-Id }\n{ Origin-Host }\n{ Origin-Realm }\n[ Result-Code ]\n[ Experimental-Result ]\n[ Auth-Session-State ]\n*[ Access-Network-Charging-Identifier ]\n[ Access-Network-Charging-Address ]\n[ Acceptable-Service-Info ]\n0*2[ AN-GW-Address ]\n[ AN-Trusted ]\n[ Service-Authorization-Info ]\n[ IP-CAN-Type ]\n[ MA-Information ]\n[ NetLoc-Access-Support ]\n[ RAT-Type ]\n*[ Flows ]\n[ OC-Supported-Features ]\n[ OC-OLR ]\n*[ Supported-Features ]\n*[ Subscription-Id ]\n[ User-Equipment-Info ]\n[ User-Equipment-Info-Extension ]\n[ 3GPP-SGSN-MCC-MNC ]\n[ NID ]\n*[ Class ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n[ Retry-Interval ]\n[ Origin-State-Id ]\n*[ Redirect-Host ]\n[ Redirect-Host-Usage ]\n[ Redirect-Max-Cache-Time ]\n*[ Proxy-Info ]\n*[ Load ]\n*[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6.3\tRe-Auth-Request (RAR) command",
                            "text_content": "The RAR command, indicated by the Command-Code field set to 258 and the ‘R’ bit set in the Command Flags field, is sent by the PCRF to the AF in order to indicate an Rx specific action.\nMessage Format:\n<RA-Request> ::= < Diameter Header: 258, REQ, PXY >\n< Session-Id >\n[ DRMP ]\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Destination-Host }\n{ Auth-Application-Id }\n*{ Specific-Action }\n[ OC-Supported-Features ]\n*[ Access-Network-Charging-Identifier ]\n[ Access-Network-Charging-Address ]\n0*2[ AN-GW-Address ]\n[ AN-Trusted ]\n*[ Flows ]\n*[ Subscription-Id ]\n[ Abort-Cause ]\n[ IP-CAN-Type ]\n[ MA-Information ]\n[ NetLoc-Access-Support ]\n[ RAT-Type ]\n[ Sponsored-Connectivity-Data ]\n[ 3GPP-User-Location-Info ]\n[ User-Location-Info-Time ]\n[ 3GPP-MS-TimeZone ]\n*[ RAN-NAS-Release-Cause ]\n*[ 5GS-RAN-NAS-Release-Cause ]\n[ 3GPP-SGSN-MCC-MNC ]\n[ NID ]\n[ TWAN-Identifier ]\n[ TCP-Source-Port ]\n[ UDP-Source-Port ]\n[ UE-Local-IP-Address ]\n[ Wireline-User-Location-Info ]\n[ Origin-State-Id ]\n*[ Class ]\n*[ Proxy-Info ]\n*[ Route-Record ]\n*[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6.4\tRe-Auth-Answer (RAA) command",
                            "text_content": "The RAA command, indicated by the Command-Code field set to 258 and the ‘R’ bit cleared in the Command Flags field, is sent by the AF to the PCRF in response to the RAR command.\nMessage Format:\n<RA-Answer> ::=  < Diameter Header: 258, PXY >\n< Session-Id >\n[ DRMP ]\n{ Origin-Host }\n{ Origin-Realm }\n[ Result-Code ]\n[ Experimental-Result ]\n[ OC-Supported-Features ]\n[ OC-OLR ]\n*[ Media-Component-Description ]\n[ Service-URN ]\n[ Origin-State-Id ]\n*[ Class ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n*[ Redirect-Host ]\n[ Redirect-Host-Usage ]\n[ Redirect-Max-Cache-Time ]\n[ Failed-AVP ]\n*[ Proxy-Info ]\n*[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6.5\tSession-Termination-Request (STR) command",
                            "text_content": "The STR command, indicated by the Command-Code field set to 275 and the ‘R’ bit set in the Command Flags field, is sent by the AF to inform the PCRF that an established session shall be terminated.\nMessage Format:\n<ST-Request> ::= < Diameter Header: 275, REQ, PXY >\n< Session-Id >\n[ DRMP ]\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Auth-Application-Id }\n{ Termination-Cause }\n[ Destination-Host ]\n[ OC-Supported-Features ]\n*[ Required-Access-Info ]\n*[ Class ]\n[ Origin-State-Id ]\n*[ Proxy-Info ]\n*[ Route-Record ]\n*[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6.6\tSession-Termination-Answer (STA) command",
                            "text_content": "The STA command, indicated by the Command-Code field set to 275 and the ‘R’ bit cleared in the Command Flags field, is sent by the PCRF to the AF in response to the STR command.\nMessage Format:\n<ST-Answer>  ::= < Diameter Header: 275, PXY >\n< Session-Id >\n[ DRMP ]\n{ Origin-Host }\n{ Origin-Realm }\n[ Result-Code ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ OC-Supported-Features ]\n[ OC-OLR ]\n[ Failed-AVP ]\n[ Sponsored-Connectivity-Data ]\n[ Origin-State-Id ]\n[ 3GPP-User-Location-Info ]\n[ User-Location-Info-Time ]\n[ 3GPP-MS-TimeZone ]\n*[ RAN-NAS-Release-Cause ]\n*[ 5GS-RAN-NAS-Release-Cause ]\n[ 3GPP-SGSN-MCC-MNC ]\n[ NID ]\n[ TWAN-Identifier ]\n[ TCP-Source-Port ]\n[ UDP-Source-Port ]\n[ UE-Local-IP-Address ]\n[ Netloc-Access-Support ]\n[ Wireline-User-Location-Info ]\n*[ Class ]\n*[ Redirect-Host ]\n[ Redirect-Host-Usage ]\n[ Redirect-Max-Cache-Time ]\n*[ Proxy-Info ]\n*[ Load ]\n*[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6.7\tAbort-Session-Request (ASR) command",
                            "text_content": "The ASR command, indicated by the Command-Code field set to 274 and the ‘R’ bit set in the Command Flags field, is sent by the PCRF to inform the AF that bearer for the established session is no longer available.\nMessage Format:\n<AS-Request>  ::= < Diameter Header: 274, REQ, PXY >\n< Session-Id >\n[ DRMP ]\n{ Origin-Host }\n{ Origin-Realm }\n{ Destination-Realm }\n{ Destination-Host }\n{ Auth-Application-Id }\n[ OC-Supported-Features ]\n{ Abort-Cause }\n[ Origin-State-Id ]\n*[ Proxy-Info ]\n*[ Route-Record ]\n*[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6.8\tAbort-Session-Answer (ASA) command",
                            "text_content": "The ASA command, indicated by the Command-Code field set to 274 and the ‘R’ bit cleared in the Command Flags field, is sent by the AF to the PCRF in response to the ASR command.\nMessage Format:\n<AS-Answer>  ::=  < Diameter Header: 274, PXY >\n< Session-Id >\n[ DRMP ]\n{ Origin-Host }\n{ Origin-Realm }\n[ Result-Code ]\n[ OC-Supported-Features ]\n[ OC-OLR ]\n[ Origin-State-Id ]\n[ Error-Message ]\n[ Error-Reporting-Host ]\n[ Failed-AVP ]\n*[ Redirect-Host ]\n[ Redirect-Host-Usage ]\n[ Redirect-Max-Cache-Time ]\n*[ Proxy-Info ]\n*[ AVP ]\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "A.1\tProvision of Service Information at P-CSCF",
            "description": "The P-CSCF shall send service information to the PCRF upon every SIP message that includes an SDP answer payload for the purpose of authorizing the IP flows and the QoS resources required for a negotiated IMS session, unless the SDP payload only relates to a circuit-switched bearer (i.e. \"c=\" line set to \"PSTN\" and an \"m=\" line set to \"PSTN\", refer to 3GPP TS 24.292 [26]). The service information shall be derived both from the SDP offer and the SDP answer. This ensures that the PCRF receives proper information to perform media authorization for all possible IMS session set-up scenarios, and that the PCRF is also capable of handling session modifications. The P-CSCF may include the Service-Info-Status AVP with the value set to FINAL_SERVICE_INFORMATION.\nAdditionally, the P-CSCF may send service information to the PCRF when receiving a SIP message that includes an SDP offer payload for the purpose of performing an early bandwidth authorization check, or for enabling pre-authorization for a UE terminated IMS session establishment or modification with UE initiated resource reservation, or for the retrieval of network provided access network information (see clause A.10.2). The P-CSCF shall send service information to the PCRF when receiving a SIP message that includes an SDP offer payload when the IMS session is an MPS session that requires priority treatment. For a UE terminated session the P-CSCF may send the service information derived from the SDP offer when the SDP offer either does not include any preconditions information or includes preconditions information indicating that the local preconditions (i.e. the preconditions related to the remote peer) are already met. In this case, the P-CSCF shall derive the service information only from the SDP offer and shall include the Service-Info-Status AVP with the value set to PRELIMINARY SERVICE INFORMATION.\nNOTE 1:\tFor a UE terminated session setup, when the SDP offer either does not include any preconditions information or includes preconditions information indicating that the local preconditions (i.e. the preconditions related to the remote peer) are already met, the terminating UE can request a resource modification prior to sending the SDP answer. Even if the IP address and port information in the session information derived from the SDP offer can be insufficient for PCC rule authorization, the policy to handle such UE initiated requests at the PCRF can take into account the fact that an IMS session establishment is ongoing, for instance in deciding whether to authorize the request and in selecting an appropriate charging key and a gating policy.\nThe P-CSCF shall derive Flow-Description AVP within the service information from the SDP as follows:\n-\tAn uplink Flow-Description AVP shall be formed as follows: The destination address shall be taken from the SDP information received by the P-CSCF in downlink direction, while the source IP address may be formed from the address present in the SDP received by the P-CSCF in uplink direction (taking into account only the 64 bit prefix of the Ipv6 address) Source and destination ports shall be derived according to rules provided in 3GPP TS 29.213 [9] clause 6.2.\nEXAMPLE 1:\tAssuming UE A sends an SDP to UE B, the PCRF of UE B uses the address present in this SDP for the destination address of UE B’s uplink Flow-Description AVP, while the PCRF of the UE A uses the 64 bit prefix of the same address for the source address of UE A’s uplink Flow-Description AVP. If the source address is not formed from the 64 bit prefix, the source address shall be wildcarded.\n-\tA downlink Flow-Description AVP shall be formed as follows: The destination address shall be taken from the SDP information received by the P-CSCF in uplink direction, while the source IP address may be formed (in order to reduce the possibilities of bearer misuse) from the destination address in the SDP received by the P-CSCF in downlink direction (taking into account only the 64 bit prefix of the Ipv6 address) Source and destination ports shall be derived according to rules provided in 3GPP TS 29.213 [9] clause 6.2.\nEXAMPLE 2:\tAssuming UE A sends an SDP to UE B, the PCRF of UE A uses the address present in this SDP for the destination address of UE A’s downlink Flow-Description AVP, while the PCRF of UE B uses the 64 bit prefix of the same address for the source address of UE B’s downlink Flow-Description AVP. If the source address is not formed from the 64 bit prefix, the source address shall be wildcarded.\nThe P-CSCF shall derive the bandwidth information within the service information, from the \"b=AS\" SDP parameter and \"a=bw-info\" SDP parameter, if available and if the E2EMTSIQOS feature is supported. If \"a=bw-info\" is used for bandwidth derivation, the P-CSCF shall use the SDP attribute line that contains the bandwidth properties for the IP version used by the UE, as detailed in 3GPP TS 29.213 [9] clause 6.2. If the received \"a=bw-info\" SDP attribute line(s) contain only bandwidth properties for an IP version that is not used by the UE, the P-CSCF shall re-compute the bandwidth properties for the used IP version and use that value for the bandwidth derivation as defined in 3GPP TS 26.114 [41].\nNOTE 2:\tIf no IP version is included for any of the \"a=bw-info\" SDP attribute lines related to a certain payload type and direction then IPv6 is assumed for all bandwidth properties related to the same direction and payload type, on all of the related \"a=bw-info\" SDP attribute lines, see clause 19 of 3GPP TS 26.114 [41].\nIf \"a=bw-info\" is used for bandwidth derivation and it includes both known and unknown bandwidth properties, the P-CSCF shall only consider the known bandwidth properties to derive the bandwidth information and ignore the unknown ones. If the\" a=bw-info\" line is received with an unknown directionality, then the entire \"a=bw-info\" line shall be ignored.\nFor the possibly associated RTCP IP flows, the P-CSCF shall use the SDP \"b=RR\" and \"b=RS\" parameters, if present, as specified in 3GPP TS 29.213 [9] clause 6.2. The \"b=AS\", \"b=RR\" and \"b=RS\" parameters in the SDP contain all the overhead coming from the IP-layer and the layers above, e.g. IP, UDP, RTP and RTCP payload, or IP, UDP and RTCP.\nFor multiplexed RTP/RTCP flows (as negotiated using the\"a=rtcp-mux\" SDP attribute defined in IETF RFC 5761 [42], a P-CSCF supporting RTP/RTCP transport multiplexing shall derive the bandwidth information within the service information as specified in 3GPP TS 29.213 [9] clause 6.2.\nHowever, if service information is received containing the \"b=TIAS\" SDP parameter that corresponds to an SDP answer payload, and if the P-CSCF supports this parameter, the P-CSCF may derive the bandwidth from this parameter rather than from the \"b=AS\" SDP parameter, as detailed in 3GPP TS 29.213 [9] clause 6.2.\nWhen available, the P-CSCF shall also indicate to PCRF, as a complement to the Service Information, the IMS Communication Service Identifier within the AF-Application-Identifier AVP. The originating P-CSCF shall take the IMS Communication Service Identifier value from the SIP response. The terminating P-CSCF shall take the IMS Communication Service Identifier value from the SIP request. Otherwise, the P-CSCF may not be able to provide an IMS Communication Service Identifier value to the PCRF. The format and specific headers where IMS communication service identifiers are transported within SIP are defined in 3GPP TS 24.229 [17].\nNOTE 3:\tIn order to indicate the IMS Communication Service Identifier to the PCRF, the originating P-CSCF sets the AF-Application-Identifier AVP to the ICSI contained in the topmost occurance of the \"+g.3gpp.icsi-ref\" header field parameter of the Feature-Caps header field(s) of 18x or 2xx SIP response (Feature-Caps: *;+g.3gpp.icsi-ref=”urn%Aurn-7%A3gpp-service.ims.icsi.mmtel”) and the terminating P-CSCF sets the AF-Application-Identifier AVP to the ICSI of the P-Asserted-Service header information received in the SIP request (e.g. P-Asserted-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel). Since the headers and the format of the ICSI can vary depending on the case, the PCRF has to be prepared to accept the complete ICSI information received in different formats, as described in clause 7.2A.8.2 in 3GPP TS 24.229 [17].\nAdditionally, the P-CSCF may include the Sharing-Key-DL AVP and/or Sharing-Key-UL AVP within the Media-Component-Description AVP in order to indicate the PCRF that resource sharing should apply for the media components in the related direction with the same value for the Sharing-Key-DL AVP and/or Sharing-Key-UL AVP.\nAdditionally, if PrioritySharing feature is supported, the P-CSCF may provide the Priority-Sharing-Indicator AVP within the Media-Component-Description AVP as described in clause 4.4.47.\nNOTE 4: \tThe P-CSCF obtains this information from the Application Server as described in 3GPP TS 23.228 [16], clause 5.4.7.9.\nNOTE 5:\tRTCP flows are not subject to resource sharing. This requirement cannot be met for multiplexed RTP/RTCP flows as in this case there is no mechanism in the current release to distinguish between RTP and RTCP flows.\nIf the Service-URN AVP does not include an emergency service URN, i.e. a top-level service type of \"sos\" as specified in IETF RFC 5031 [21] and possibly additional sub-service information on the type of the emergency service and the PCRF binds the IMS service session to an IP-CAN session established to an Emergency APN, the PCRF shall return an AAA command with Experimental-Result-Code AVP set to the value UNAUTHORIZED_NON_EMERGENCY_SESSION to the P-CSCF. Upon receiving an AAA with Experimental-Result-Code AVP set to the value UNAUTHORIZED_NON_EMERGENCY_SESSION the P-CSCF shall apply the procedures defined in 3GPP TS 24.229 [17].\nNOTE 6:\tThe PCRF determines whether an IP-CAN session is established to an Emergency APN based on the information received over Gx and operator configuration.\nIf the AF-Requested-Data AVP is provided in the AA-Request command indicating \"EPC-level Identities required\", the PCRF shall provide the available user information for the IP-CAN session within the Subscription-Id AVP (s) and/or User-Equipment-Info AVP or User-Equipment-Info-Extension AVP if the User-Equipment-Info-Extension feature is supported.\nThe PCRF may decide not to authorize requested service information. The PCRF will indicate it to the P-CSCF by sending an AA-Answer with Experimental-Result-Code AVP set to the value REQUESTED_SERVICE_NOT_AUTHORIZED. Upon receiving an AA-Answer with Experimental-Result-Code AVP set to the value REQUESTED_SERVICE_NOT_AUTHORIZED the P-CSCF shall apply the procedures defined in 3GPP TS 24.229 [17].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.2\tEnabling of IP Flows",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.2.0\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Prior to the completion of the SIP session set-up, i.e. until the 2xx response to the INVITE request is received, the P-CSCF may enable or disable media IP flows depending on operator policy, thus allowing or forbidding early media in forward and/or backward direction. The P-CSCF may set the values of the Flow-Status AVPs derived from the SDP direction attributes as defined in 3GPP TS 29.213 [9] clause 6.2 or set the values of the Flow-Status AVPs considering the em-param of the P-Early-Media header field according to clause A.2.1 or downgrade the values of the Flow-Status AVPs derived from the SDP direction attribute based on the configuration in the P-CSCF according to clause A.2.2. However for multiplexed RTP/RTCP flows (as negotiated using the \"a=rtcp-mux\" SDP attribute defined in IETF RFC 5761 [42]), a P-CSCF supporting RTP/RTCP transport multiplexing shall set the Flow-Status set to \"ENABLED\" to prevent that RTCP is blocked. If the P-CSCF chooses to modify the values of the Flow-Status AVPs as received from the SDP direction attribute, the P-CSCF shall store the last received SDP.\nWhen a 2xx response is received, the P-CSCF shall enable all media IP flows according to the direction attribute within the last received SDP, as specified in 3GPP TS 29.213 [9] clause 6.2. When a 2xx response is received and the P-CSCF previously provided the values of the Flow-Status AVPs different from the value derived from the SDP direction attribute in the session information, the P-CSCF shall provide service information with values of the Flow-Status AVPs corresponding to the last received SDP.\nNOTE:\tIn most cases a 2xx response is a 200 (OK) response.\nIf the P-CSCF receives SDP answers after the completion of the SIP session set-up, i.e. after the 2xx response to the INVITE request is received, the P-CSCF shall provide the Flow-Status AVP, based on the last received SDP answer. The Flow-Status AVP shall be derived from the SDP according to 3GPP TS 29.213 [9] clause 6.2.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.2.1\tGate control procedures considering the P-Early-Media header field",
                    "description": "",
                    "summary": "",
                    "text_content": "Prior to the completion of the SIP session set-up, the P-CSCF may use the em-param of the P-Early-Media header field defined in IETF RFC 5009 [48] in order to enable or disable early media in forward and/or backward direction. If the P-CSCF uses the em-param of the P-Early-Media header field for the gate control of early media, the P-CSCF shall perform the following procedures.\nIn the terminating P-CSCF, when a SIP message with the P-Early-Media header field is received from the UE and the policies configured in the P-CSCF indicate that the UE is authorized to send early media, then:\n1)\tthe P-CSCF shall set the Flow-Status AVP to \"ENABLED\" if:\n-\tthe received em-param(s) in the P-Early-Media header field includes \"sendrecv\" and the last received SDP direction attribute from the UE is \"sendrecv\" or no SDP direction attribute has been received; or\n2)\tthe P-CSCF shall set the Flow-Status AVP to \"ENABLED-UPLINK\" if:\n-\tthe received em-param(s) in the P-Early-Media header field includes \"sendrecv\" and the last received SDP direction attribute from the UE is \"sendonly\"; or\n-\tthe received em-param(s) in the P-Early-Media header field includes \"sendonly\" and the last received SDP direction attribute from the UE is \"sendrecv\" or \"sendonly\" or no SDP direction attribute has been received; or\n3)\tthe P-CSCF shall set the Flow-Status AVP to \"ENABLED-DOWNLINK\" if:\n-\tthe received em-param(s) in the P-Early-Media header field includes \"sendrecv\" and the last received SDP direction attribute from the UE is \"recvonly\"; or\n-\tthe received em-param(s) in the P-Early-Media header field includes \"recvonly\" and the last received SDP direction attribute from the UE is \"sendrecv\" or \"recvonly\" or no SDP direction attribute has been received; or\n4)\tthe P-CSCF shall set the Flow-Status AVP to \"DISABLED\" if either the received em-param(s) in the P-Early-Media header field or the last received SDP direction attribute from the UE includes \"inactive\"; or\n5)\tthe P-CSCF may set the Flow-Status AVP to \"DISABLED\" or apply the rules defined in clause A.2.2 if the received em-param(s) in the P-Early-Media header field includes \"sendonly\" or \"recvonly\" and the last received SDP direction attribute from the UE is \"recvonly\" or \"sendonly\" respectively.\nNOTE 1:\tIf the UE is authorized to send early media, the P-CSCF will not remove or modify the P-Early-Media header field according to 3GPP TS 24.229 [17].\nWhen a SIP message with the P-Early-Media header field is received from the functional entity within the trust domain, and if:\n-\tthe P-Early-Media header field includes the \"gated\" parameter, then the P-CSCF may decide not to perform the gate control of early media; or\n-\tthe P-Early-Media header field does not include the \"gated\" parameter, then the P-CSCF shall perform the following procedures:\n1)\tthe P-CSCF shall set the Flow-Status AVP to\"ENABLED\" if:\n-\tthe received em-param(s) in the P-Early-Media header field includes \"sendrecv\" and the last received SDP direction attribute from the functional entity is \"sendrecv\" or no SDP direction attribute has been received; or\n2)\tthe P-CSCF shall set the Flow-Status AVP to \"ENABLED-DOWNLINK\" if:\n-\tthe received em-param(s) in the P-Early-Media header field includes \"sendrecv\" and the last received SDP direction attribute from the functional entity is \"sendonly\"; or\n-\tthe received em-param(s) in the P-Early-Media header field includes \"sendonly\" and the last received SDP direction attribute from the functional entity is \"sendrecv\" or \"sendonly\" or no SDP direction parameter has been received; or\n3)\tthe P-CSCF shall set the Flow-Status AVP to \"ENABLED-UPLINK\" if:\n-\tthe received em-param(s) in the P-Early-Media header field includes \"sendrecv\" and the last received SDP direction attribute from the functional entity is \"recvonly\"; or\n-\tthe received em-param(s) in the P-Early-Media header field includes \"recvonly\"and the last received SDP direction attribute from the functional entity is \"sendrecv\" or \"recvonly\" or no SDP direction parameter has been received ; or\n4)\tthe P-CSCF shall set the Flow-Status AVP to \"DISABLED\" if either the received em-param(s) in the P-Early-Media header field or the last received SDP direction attribute from the functional entity includes \"inactive\"; or\n5)\tthe P-CSCF may set the Flow-Status AVP to \"DISABLED\" or apply the rules defined in clause A.2.2 if the received em-param(s) in the P-Early-Media header field includes \"sendonly\" or \"recvonly\" and the last received SDP direction attribute from the functional entity is \"recvonly\" or \"sendonly\" respectively.\nNOTE 2:\tAccording to IETF RFC 5009 [48], the non-direction parameter \"gated\" can be included after the direction parameter (e.g. \"sendrecv\") in the parameter list. The proxy performing gating of early media can add the parameter before forwarding the SIP message.\nWhen a SIP message without the P-Early-Media header field is received from either the functional entity within the trust domain or the UE that is authorized to send early media, then the P-CSCF may set the Flow-Status AVP to \"DISABLED\" or apply the rules defined in clause A.2.2 or apply the rules defined in 3GPP TS 29.213 [9] clause 6.2.\nNOTE 3:\tAs indicated in IETF RFC 5009 [48] the applicable preconditions need to be met in order to allow early media in a particular direction.\nWhen a SIP message is received from the functional entity other than the functional entity within the trust domain or the UE that is authorized to send early media, then the P-CSCF shall not use the received em-param(s) in the P-Early-Media header field and may apply the rules defined in clause A.2.2 or apply the rules defined in 3GPP TS 29.213 [9] clause 6.2.\nNOTE 4:\tThe P-CSCF will remove or modify the P-Early-Media header field in the above case.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.2.2\tGate control procedures based on the configuration in the P-CSCF",
                    "description": "",
                    "summary": "",
                    "text_content": "Prior to the completion of the SIP session set-up, the P-CSCF may downgrade the values of the Flow-Status AVPs derived from the SDP direction attributes based on the configuration in the P-CSCF. If the P-CSCF has the configuration for the gate control of early media, the P-CSCF shall perform the following procedures.\nNOTE:\tThe gate control of early media can be  configured in the P-CSCF per UE basis.\nWhen the Flow-Status AVP derived from the SDP direction attribute is \"ENABLED\", then the P-CSCF may downgrade the value of the Flow-Status AVP to the value \"DISABLED\", \"ENABLED_UPLINK\", or \"ENABLED_DOWNLINK\" based on the configuration in the P-CSCF.\nWhen the Flow-Status AVP derived from the SDP direction attribute is \"ENABLED_UPLINK\" or \"ENABLED_DOWNLINK\", then the P-CSCF may downgrade the value of the Flow-Status AVP to the value \"DISABLED\" based on the configuration in the P-CSCF.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.3\tSupport for SIP forking",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.3.0\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The P-CSCF shall be able to handle forking when PCC is applied. Forking can occur as specified in 3GPP TS 23.228 [16]. The related UE procedures are described in 3GPP TS 24.229 [17].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.3.1\tPCC rule provisioning for early media for forked responses",
                    "description": "",
                    "summary": "",
                    "text_content": "When a SIP session has been originated by a connected UE, the P-CSCF may receive multiple provisional responses due to forking before the first final answer is received. Multiple early media session may be established during this process.\nThe UE and the P-CSCF become aware of the forking only when a subsequent provisional response arrives for a new early dialogue. After the first early media session is established, for each subsequent provisional response establishing an additional early media session,, the P-CSCF shall use an AA request within the existing Diameter session containing the SIP-Forking-Indication AVP with value SEVERAL_DIALOGUES and include the service information derived from the latest provisional response.\nThe P-CSCF shall also provision the service information derived from any subsequent SDP offer-answer exchange within an early dialogue (e.g. in PRACK and OK(PRACK), or UPDATE and OK(UPDATE) ) using an AA request within the existing Diameter session containing the SIP-Forking-Indication AVP with value SEVERAL_DIALOGUES and the derived service information.\nWhen receiving an AA request containing the SIP-Forking-Indication AVP with value SEVERAL_DIALOGUES, the PCRF shall identify the existing authorization information for that AF session. The PCRF shall send additional PCC Rules or individual service data flow filters to already provide PCC rules as required by the Flow Description AVPs within the session information to the PCEF. The PCRF shall authorize any additional media components and any increased QoS requirements for the previously authorized media components, as requested within the service information. The PCRF shall authorize the maximum bandwidth required by any of the dialogues, but not the sum of the bandwidths required by all dialogues. Thus, the QoS authorized for a media component is equal to the highest QoS requested for that media component by any of the forked responses. The PCRF shall open or close the gates for service flows depending on the flow status that is being provisioned. However, if a flow ID has been enabled in uplink or downlink direction or both way within previous service information, it shall remain enabled even if the PCRF receives service information that disable this flow ID within an AA request containing the SIP-Forking-Indication AVP with value SEVERAL_DIALOGUES.\nIf the P-CSCF provides one or more Media-Component-Description AVP with the Flow-Status AVP set to \"REMOVED\" for previously authorized media component(s) the media component shall remain as authorized and the PCRF shall not take any action on that media component(s).\nNOTE:\tThere can be cases where a forked response could not support some of the media components included in the SDP Offer (e.g. when early session disposition SDP as described in Annex A.7 applies, the forked response related to the early session could include the port set to zero for those media components not related to the early session or when a subsequent SDP Offer-Answer to indicate that some media is disabled). For those cases the P-CSCF will indicate the PCRF about the removal of the corresponding media component. However this media component is already supported by other UEs and the PCRF needs to maintain the corresponding PCC rules until the final SDP answer is received in the P-CSCF in order to avoid the release of resources in the network.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.3.2\tUpdating the provisioned PCC rules at the final answer",
                    "description": "",
                    "summary": "",
                    "text_content": "The P-CSCF shall store the SDP information for each early dialogue separately till the first final SIP answer is received. Then the related early dialogue is progressed to an established dialogue to establish the final SIP session. All the other early dialogues are terminated. The service information for the SIP session is updated to match the requirements of the remaining early dialogue only.\nWhen receiving the first final SIP response, the P-CSCF shall send an AA request without the SIP-Forking-Indication AVP and include the service information derived from the SDP corresponding to the dialogue of the final response. The P-CSCF shall provision the full service information including the applicable Flow-Description AVP(s) and Flow-Status AVP(s).\nWhen receiving an AA request with no SIP-Forking-Indication AVP or with a SIP-Forking-Indication AVP with value SINGLE_DIALOGUE, the PCRF shall update installed PCC Rules information and Authorized-QoS information to match only the requirements of the service information within this AA request. The PCRF should immediately remove PCC Rule(s) or individual service data flow filters not matching IP flow(s) in the updated Service Information, to reduce the risk for initial clipping of the media stream, and to minimize possible misuse of resources. The PCRF shall also open or close the gates for service flows according to the flow status in the received service information.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.4\tNotification of AF Signalling Transmission Path Status",
            "description": "When the P-CSCF receives an initial REGISTER SIP message from an attached UE, the P-CSCF may subscribe to notifications of the status of the AF Signalling transmission path using the procedures specified in clause 4.4.5. Once the P-CSCF has subscribed, the P-CSCF may receive notifications from the PCRF according to clause 4.4.6.3.\nNOTE 1:\tWhen the Standardised QCI characteristics as defined in 3GPP TS 23.203 [2] are followed, the QCI for IMS signalling will correspond to a non-GBR bearer. In this case, the P-CSCF will not receive notifications related to the Specific-Action with value \"INDICATION_OF_LOSS_OF_BEARER\".\nNOTE 2: This procedure is not applicable for IMS registrations for Emergency sessions.\nThe P-CSCF shall cancel the subscription to notification of the status of the AF Signalling transmission path when the AF Signalling to that particular user is terminated (i.e. when the user is de-REGISTERED from the IM CN subsystem).\nWhen the P-CSCF receives a notification of loss of signalling connectivity from the PCRF, the P-CSCF shall behave as defined in 3GPP TS 24.229 [17].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.5\tIndication of Emergency Registration and Session Establishment",
            "description": "When the P-CSCF receives an initial REGISTER SIP message for an IMS emergency registration or an INVITE SIP message for an emergency session and the P-CSCF determines that there are no IMS-level roaming interfaces, the P-CSCF may request the PCRF to provide the EPC-level identities (MSISDN, IMSI, IMEI(SV)) available for that IP-CAN session using the procedure as specified in this clause (for an IMS emergency registration) or A.1 (for an IMS emergency session establishment). An P-CSCF may request the PCRF to provide the EPC-level identities (MSISDN, IMSI, IMEI(SV)) available for that IP-CAN session when no service information is available in the AF.To do so, the P-CSCF shall open an Rx Diameter session with the PCRF for the AF signalling using an AA-Request command. The P-CSCF shall provide the UE’s IP address (using either the Framed-IP-Address AVP or the Framed-Ipv6-Prefix AVP) and the AF-Requested-Data AVP set to \"EPC-level identities required\". The AF shall include the Service-URN AVP set to the value \"sos\", in order to indicate that the new AF session relates to emergency traffic that is not related to a specific emergency service.\nWhen the PCRF receives an AA-Request command as described in the preceding paragraphs from the P-CSCF, the PCRF shall perform session binding as described in 3GPP TS 29.213 [9]. When the PCRF receives the Service-URN AVP indicating an emergency session, the PCRF may apply special policies, for instance prioritising service flows relating to the AF session or allowing these service flows free of charge. When the Service-URN AVP indicates that the AF session relates to emergency traffic and the AF-Requested-Data AVP is received indicating \"EPC-level Identities required\", the PCRF shall provide the requested available user information (MSISDN, IMSI) for the IP-CAN session within the Subscription-Id AVP(s) and/or the IMEI(SV) within the User-Equipment-Info AVP or the User-Equipment-Info-Extension AVP if the User-Equipment-Info-Extension feature is supported, in the AA-Answer command.\nWhen the P-CSCF receives the AA-Answer with the EPC-level identities from the PCRF, the P-CSCF stores the information received within the Subscription-Id AVP(s) and/or User-Equipment-Info AVP or User-Equipment-Info-Extension AVP if the User-Equipment-Info-Extension feature is supported, provided by the PCRF and behaves as defined in 3GPP TS 24.229 [17].\n\nNOTE:  \tThe user information received within the User-Equipment-Info AVP or the User-Equipment-Info-Extension AVP if the User-Equipment-Info-Extension feature is supported, and/or Subscription-Id AVP(s) can be used to support PSAP callback functionality for anonymous IMS emergency sessions. See 3GPP TS 23.167 [53] for further information.\nThe P-CSCF may decide to terminate the Rx session at any time. In that case, the AF shall use a Session-Termination-Request (STR) command to the PCRF, which shall be acknowledged with a Session-Termination-Answer (STA) command.\nA SIP INVITE request can contain a service URN as defined in IETF RFC 5031 [21] within the request URI. If the service within this URN is \"sos\", possibly with additional sub-service information, the P-CSCF shall provision this service and sub-service information within the Service-URN AVP towards the PCRF. The P-CSCF may also provision possible information about other services received within the service URN.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.6\tNotification IP-CAN Type Change",
            "description": "When the P-CSCF receives an initial REGISTER SIP message or an INVITE SIP message from an attached UE, the P-CSCF may request from the PCRF the information about the type of IP-CAN the UE is attached to using the procedure specified in clause 4.4.1.\nNOTE 1:\tThis procedure is not applicable for IMS registrations for Emergency sessions.\nNOTE 2:\tThe P-CSCF can request information about the type of IP-CAN as part of the SIP session setup when it is only interested in the related information when the IMS session is ongoing.\nIf the P-CSCF requests information about the type of IP-CAN, the P-CSCF shall also subscribe within the same  command operation to notifications for changes of the IP-CAN type used by the UE. The P-CSCF shall include a Specific-Action AVP in the  that is set to the value of IP-CAN_CHANGE.\nWhen the P-CSCF receives the AA-Answer or RA-Request from the PCRF, the P-CSCF stores the IP-CAN type information received within the IP-CAN-Type AVP and the RAT type information received within the RAT-Type AVP and AN-Trusted AVP (if also provided by the PCRF) and behaves as defined in 3GPP TS 24.229 [17].\nThe P-CSCF may receive notifications for changes of the IP-CAN type from the PCRF according to clause 4.4.6.4. When the P-CSCF receives a notification of the change of the IP-CAN used by the UE, the P-CSCF stores the new IP-CAN type information and RAT type information and behaves as defined in 3GPP TS 24.229 [17].\nNOTE 3:\tThe subscription to receive information about the type of IP-CAN will be cancelled when the corresponding Rx session is terminated by the AF (i.e. when the UE is de-REGISTERED or the related SIP call is torn down).\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.7\tSupport for Early Session disposition SDP",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.7.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "As a network option, the P-CSCF may support the PCC procedures in the present Clause to handle \"early session\" disposition type SDP, as standardised in IETF RFC 3959 [27].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.7.2\tService Information Provisioning for Early Media",
                    "description": "",
                    "summary": "",
                    "text_content": "The P-CSCF can receive \"early session\" disposition SDP in addition to \"session\" disposition SDP in SIP early dialogues.\nThe P-CSCF shall then provision service information derived both from the \"early session\" disposition SDP and \"session\" disposition SDP applying the procedures in Clauses A.1, A.2, and A.3, and in the present Clause.\nThe P-CSCF shall apply the mapping rules in Annex B.1.2.2.2 to derive the flow identifiers from \"early session\" disposition SDP.\nIf a single media line with one media type (e.g. \"audio\" or \"video\") is contained in \"early session\" disposition SDP and a single media line with the same media type is contained in the \"session\" disposition SDP of the same SIP dialogue, and both media lines describe service flows of the same directionality (uplink, downlink, or bidirectional), the P-CSCF should describe those SDP media lines in the same session information media component (with the same flow ID).\nThe \"early session\" disposition SDP can also contain media lines of a type not included in the \"session\" disposition SDP, or several media lines of the same type. Such media components shall be described in own media components in the service information.\nIf the P-CSCF desires to invoke special policies or separate event notifications for an \"early session\" disposition media line, it may choose to provision a separate session information media component even if a media line with the same media type and directionality is contained in \"session\" disposition SDP.\nNOTE 1:\tA PCRF is then likely to supply separate PCC rules for early media and the corresponding final media. This may lead to an over provisioning of resources during call establishment and a subsequent reconfiguration of the radio bearer, or even to a call failure if the extra resources are not authorized or available.\nIf the P-CSCF receives \"early session\" disposition SDP before any \"session\" disposition SDP and supplies service information derived from the \"early session\" disposition SDP at this point of time, it shall use dedicated media components relating only to the \"early session\" disposition SDP in the service information.\nNOTE 2:\tThe \"session\" disposition SDP offer will frequently occur before the \"early session\" disposition SDP offer, but can also occur in parallel or in exceptional cases afterwards. The \"session\" disposition SDP answer can be contained in the same SIP message as the \"early session\" disposition SDP offer, or can be sent in a 200 OK (INVITE), i.e. after the \"early session\" disposition SDP answer.\nIf the P-CSCF includes any media component relating both to \"early session\" disposition SDP and \"session\" disposition SDP in the service information, the P-CSCF shall:\n-\tprovision the service information derived from \"early session\" disposition SDP and the service information derived from \"session\" disposition SDP in separate Rx AA-Requests, and shall send a new Rx AA-Request only after any previous Rx AA-Request has been acknowledged; and\n-\tprovision the first service information (either derived from \"early session\" disposition SDP or \"session\" disposition SDP) without the SIP-Forking-Indication AVP, or with the SIP-Forking-Indication AVP with value SINGLE_DIALOGUE; and\n-\tprovision all subsequent service information during ongoing call establishment with the SIP-Forking-Indication AVP with value SEVERAL_DIALOGUES; and\n-\tif an SDP answer has been received and Codec-Data AVPs are provisioned within a Media-Component-Description AVP, provision a Codec-Data AVP derived from the corresponding offer together with a Codec-Data AVP derived from the SDP answer.\nNOTE 3:\tThe P-CSCF needs to provision the service information derived from \"early session\" disposition SDP and the service information derived from \"session\" disposition SDP in separate Rx AA-Requests because the encoding of the media-component does not allow for the simultaneous provisioning of two corresponding filters.\nNOTE 4:\tThe PCRF will treat service information containing the SIP-Forking-Indication AVP as described in Clause A.3.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.7.3\tUpdating the Provisioned Service Information when Dialogue is established",
                    "description": "",
                    "summary": "",
                    "text_content": "The P-CSCF shall store the SDP information for the \"session\" disposition type until the first final SIP answer is received. Then the early media described in the \"early session\" disposition type SDP are terminated.\nThe P-CSCF shall then update the service information to match the requirements of the media described in the \"session\" disposition type SDP only:\n-\tIf the P-CSCF included any media component relating both to \"early session\" disposition SDP and \"session\" disposition SDP in the service information, the P-CSCF shall send an AA request without the SIP-Forking-Indication AVP or with a SIP-Forking-Indication AVP with value SINGLE_DIALOGUE and shall include the service information derived from the \"session\" disposition SDP. The P-CSCF shall provision the full service information including the applicable Flow-Description AVP(s) and Flow-Status AVP(s).\n-\tThe P-CSCF shall disable any media component(s) in the service information that relate to early media only by setting their flow status to \"removed\".\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.8\tProvision of Signalling Flow Information at P-CSCF",
            "description": "When the P-CSCF has successfully concluded the initial registration of an attached UE, i.e., when the P-CSCF has sent to the UE a SIP 200 (OK) response to the SIP REGISTER request, the P-CSCF may provision information about the SIP signalling flows between the UE and itself using the procedure specified in clause 4.4.5A. If the P-CSCF already has an open Rx Diameter session with the PCRF related to the signalling with the UE, e.g. one that has been opened according to the procedure described in clause A.6 and/or in clause A.4, the P-CSCF shall reuse the already open session to provision the SIP Signalling IP Flow information.\nNOTE: This procedure is not applicable for IMS registrations for Emergency sessions.\nIf the P-CSCF provisions information about SIP signalling flows, the P-CSCF shall ensure that for each signalling IP flow information it provides, the Flow-Description AVP shall accurately reflect the IP flow information as seen in the IP header ‘on the wire’. The P-CSCF shall set the value of the AF-Signalling-Protocol AVP to ‘SIP’.\nWhen the P-CSCF de-registers the UE and terminates SIP Signalling to the UE, the P-CSCF shall de-provision the SIP Signalling IP flow information from the PCRF as described in clause 4.4.5A.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.9\tHandling of MPS Session",
            "description": "When the P-CSCF receives an authorised Resource-Priority header field or a temporarily authorised Resource-Priority header field containing an appropriate namespace and priority value in SIP signaling, and recognizes the need for priority treatment as specified in 3GPP TS 24.229 [17], the P-CSCF shall include the MPS-Identifier AVP and Reservation-Priority AVP in the  command towards the PCRF. The MPS-Identifier AVP shall contain the national variant for MPS service name indicating an MPS session. The Reservation-Priority AVP shall include the priority value of the related priority service. The Reservation-Priority AVP shall be populated with a default value if the priority value is unknown.\nNOTE 1:\tVarious mechanisms can be applied to recognize the need for priority treatment in the P-CSCF (e.g., based on the dialled digits), according to national regulation and network configuration, as stated in 3GPP TS 24.229 [17].\nNOTE 2:\tLowest user priority value is mapped in the corresponding lowest enumerated value of the Reservation-Priority AVP.\nIf the P-CSCF supports the Diameter message priority mechanism for an MPS session, it shall include the DRMP AVP towards the PCRF as described in 3GPP TS 29.213 [9], Annex J.\nNOTE 3:\tIf the P-CSCF supports the Diameter message priority mechanism for an MPS session, it includes the DRMP AVP with a priority value equivalent to the Reservation-Priority AVP priority value. Highest user priority value is mapped in the corresponding lowest enumerated value of the DRMP AVP.\nUpon reception of a request that requires MPS treatment, the PCRF shall derive the PCC/QoS Rules corresponding to the MPS session, as appropriate. The PCRF shall take specific actions on the corresponding IP-CAN to ensure that the MPS session is prioritized, as described in 3GPP TS 29.212 [8], clause 4.5.19.1.3.\nWhen the P-CSCF terminates the MPS session, the PCRF shall delete the PCC/QoS Rules corresponding to the MPS session. The PCRF shall revoke the actions related to the prioritization of the MPS session in the corresponding IP-CAN, as described in 3GPP TS 29.212 [8], clause 4.5.19.1.3.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.10\tRetrieval of network provided location information",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.10.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "According to Annex E.7 of 3GPP TS 23.228 [16], the P-CSCF can use PCC to retrieve network provided location information. Information flows related to the distribution of network provided location information within the IMS are provided in Annex R of 3GPP TS 23.228 [16].\nThis sublause provides optional PCC procedures to support the retrieval of network provided location information.\nThe originating P-CSCF can, depending on operator policy, retrieve the user location and/or UE Time Zone information either before sending the INVITE or MESSAGE towards the terminating side or upon reception of the SDP answer from the terminating side.\nThe terminating P-CSCF can, depending on operator policy, retrieve the user location and/or UE Time Zone information either upon reception of a SIP INVITE or upon reception of a SIP response.\nThe originating and terminating P-CSCF can, depending on operator policy, retrieve the user location and/or UE Time Zone information at mid call, e.g., when the P-CSCF learns about IP-CAN type change.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.10.2\tRetrieval of network provided location information at originating P-CSCF for inclusion in SIP Request",
                    "description": "",
                    "summary": "",
                    "text_content": "If the originating P-CSCF is required by operator policy to retrieve network provided location information before forwarding a SIP INVITE request, upon reception of an INVITE/UPDATE request, the P-CSCF shall send an AA-Request according to clause 4.4.1 (SIP INVITE request) or 4.4.2 (SIP INVITE/UPDATE request) including:\n-\tthe \"ACCESS_NETWORK_INFO_REPORT\" value within the Specific-Action AVP; and\n-\tthe required access network information within the Required-Access-Info AVP.\nIf the SIP INVITE request is an initial SIP INVITE request, the P-CSCF shall establish an Rx session for the new SIP session with the AA-Request according to clause 4.4.6.7 (if no session information is included) or 4.4.1 (if preliminary session information is included).\nThe P-CSCF will receive the access network information from the PCRF in an RAR, and should include this access network information in the SIP INVITE/UPDATE requests that it forwards. When the retrieved access network information corresponds to the TWAN-Identifier AVP, the P-CSCF may also map the retrieved access network information to a Geographical Identifier for routing, as specified in Annex E.8 of 3GPP TS 23.228 [16].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.10.3\tRetrieval of network provided location information at originating P-CSCF for inclusion in SIP response confirmation",
                    "description": "",
                    "summary": "",
                    "text_content": "If an originating P-CSCF is required by operator policy to retrieve network provided location information before forwarding an SDP answer, the P-CSCF shall apply the following procedures:\nUpon reception of an SDP offer, the P-CSCF may send an AA-Request to the PCRF according to clause A.1 and may include in this AA-request:\n-\tthe \"ACCESS_NETWORK_INFO_REPORT\" value within the Specific-Action AVP; and\n-\tthe required access network information within the Required-Access-Info AVP.\nUpon reception of an SDP answer, the P-CSCF will send an AA-Request to the PCRF according to clause A.1. If the P-CSCF has not requested access network information upon reception of the SDP offer, the P-CSCF shall include in this AA-request:\n-\tthe \"ACCESS_NETWORK_INFO_REPORT\" value within the Specific-Action AVP; and\n-\tthe required access network information within the Required-Access-Info AVP.\nThe P-CSCF will receive the access network information from the PCRF in an RAR, and should include this access network information in the SIP message with the response confirmation before forwarding it. When the retrieved access network information corresponds to the TWAN-Identifier AVP, the P-CSCF may also map the retrieved access network information to a Geographical Identifier for routing, as specified in Annex E.8 of 3GPP TS 23.228 [16].\nIf the originating P-CSCF is required by operator policy to retrieve network provided location information before forwarding a SIP MESSAGE request, upon reception of a MESSAGE request, the P-CSCF shall send an AA-Request including:\n-\tthe UE’s IP address (using either the Framed-IP-Address AVP or the Framed-Ipv6-Prefix AVP);\n-\ta Media-Component-Description AVP including a single Media-Sub-Component AVP with the Flow-Usage AVP set to the value \"AF_SIGNALLING\". The Media-Component-Description AVP shall contain the Media-Component-Number AVP set to \"0\". The Media-Sub-Component AVP shall contain the Flow-Number AVP set to \"0\", and the rest of AVPs within the Media-Component-Description and Media-Sub-Component AVPs shall not be used in this case;\n-\tthe \"ACCESS_NETWORK_INFO_REPORT\" value within the Specific-Action AVP; and\n-\tthe required access network information within the Required-Access-Info AVP.\nThe P-CSCF will receive the access network information from the PCRF in an RAR and should include this access network information in the SIP MESSAGE requests that it forwards. When the retrieved access network information corresponds to the TWAN-Identifier AVP, the P-CSCF may also map the retrieved access network information to a Geographical Identifier for routing, as specified in Annex E.8 of 3GPP TS 23.228 [16].\nIf the Rx Diameter Session is only used for retrieval of network provided location information, at reception of this information, the AF may terminate the AF session sending a Session-Termination-Request (STR) command to the PCRF, which shall be acknowledged with a Session-Termination-Answer (STA) command.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.10.4\tRetrieval of network provided location information at terminating P-CSCF",
                    "description": "",
                    "summary": "",
                    "text_content": "If a terminating P-CSCF is required by operator policy to retrieve network provided location information at session establishment and/or modification, the P-CSCF shall apply the following procedures:\nThe terminating P-CSCF may request network provided location information upon reception of a SIP INVITE request : in the following manner:\n-\tIf the SIP INVITE request is an initial SIP INVITE request, the P-CSCF shall establish an Rx session for the new SIP session with the AA-Request according to clause 4.4.6.7 (if no session information is included) or 4.4.1 (if preliminary session information is included).\n-\tIf the SIP INVITE includes an SDP offer, the P-CSCF shall send an AA-Request including:\n-\tthe \"ACCESS_NETWORK_INFO_REPORT\" value within the Specific-Action AVP;\n-\tthe required access network information within the Required-Access-Info AVP;\n-\tservice information derived from the SDP offer; and\n-\tthe Service-Info-Status AVP with the value set to PRELIMINARY SERVICE INFORMATION.\n-\tIf the SIP INVITE includes no SDP offer, the P-CSCF shall send an AA-Request including:\n-\tthe \"ACCESS_NETWORK_INFO_REPORT\" value within the Specific-Action AVP; and\n-\tthe required access network information within the Required-Access-Info AVP.\nUpon reception of a SIP response that requires the inclusion of access network information, if the P-CSCF has not already requested network provided location information upon reception of the corresponding SIP INVITE, the P-CSCF shall request network provided location information in the following manner:\n-\tIf an Rx session related to service data has not yet been established, the P-CSCF shall establish an Rx session for the new SIP session with the AA-Request according to clause 4.4.6.7 (if no session information is included) or 4.4.1 (if session information is included).\n-\tIf the SIP response includes an SDP answer, the P-CSCF will send an AA-Request to the PCRF according to clause A.1; the P-CSCF shall include in this AA-request:\n-\tthe \"ACCESS_NETWORK_INFO_REPORT\" value within the Specific-Action AVP; and\n-\tthe required access network information within the Required-Access-Info AVP.\n-\tIf the SIP response includes no SDP, the P-CSCF shall send an AA-Request including:\n-\tthe \"ACCESS_NETWORK_INFO_REPORT\" value within the Specific-Action AVP; and\n-\tthe required access network information within the Required-Access-Info AVP.\n-\tIf the SIP reponse includes an SDP offer, the P-CSCF shall send an AA-Request including:\n-\tthe \"ACCESS_NETWORK_INFO_REPORT\" value within the Specific-Action AVP;\n-\tthe required access network information within the Required-Access-Info AVP;\n-\tservice information derived from an SDP offer within the SIP response; and\n-\tthe Service-Info-Status AVP with the value set to PRELIMINARY SERVICE INFORMATION.\nThe P-CSCF will receive the access network information from the PCRF in an RAR, and should include this access network information in the appropriate SIP response before forwarding it. When the retrieved access network information corresponds to the TWAN-Identifier AVP, the P-CSCF may also map the retrieved access network information to a Geographical Identifier for routing, as specified in Annex E.8 of 3GPP TS 23.228 [16].\nIf the terminating P-CSCF is required by operator policy to retrieve network provided location information upon reception of a SIP MESSAGE response, the P-CSCF shall behave according to A.10.2.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.10.5\tProvisioning of network provided location information at SIP session release",
                    "description": "",
                    "summary": "",
                    "text_content": "If a P-CSCF is required by operator policy to include network provided location information in SIP session release signalling, the P-CSCF shall apply the following procedures:\nUpon reception of a SIP session release request that requires the inclusion of network provided location information, the P-CSCF will send an ST-Request and shall include in this request the required access network information within the Required-Access-Info AVP.\nThe P-CSCF will receive the access network information from the PCRF in the corresponding ST-Answer, and should include this access network information either in the SIP session termination request (at the originating side) or a reply to the SIP session termination request (at the terminating side). When the retrieved access network information corresponds to the TWAN-Identifier AVP, the P-CSCF may also map the retrieved access network information to a Geographical Identifier for routing, as specified in Annex E.8 of 3GPP TS 23.228 [16].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.10.6\tProvisioning of network provided location information at mid call",
                    "description": "",
                    "summary": "",
                    "text_content": "If a P-CSCF is required by operator policy to include network provided location information at mid call, the P-CSCF shall apply the following procedures:\nUpon reception of a trigger (e.g., when the P-CSCF learns about the access change) that requires the inclusion of network provided location information in a SIP message, the P-CSCF shall include in the AA-request:\n-\tthe \"ACCESS_NETWORK_INFO_REPORT\" value within the Specific-Action AVP;\n-\tthe required access network information within the Required-Access-Info AVP; and\n-\tthe service information related to the service according to clause 4.4.2.\nThe P-CSCF will receive the access network information from the PCRF in an RAR, and should include this access network information in the appropriate SIP message before forwarding it. When the retrieved access network information corresponds to the TWAN-Identifier AVP, the P-CSCF may also map the retrieved access network information to a Geographical Identifier for routing, as specified in Annex E.8 of 3GPP TS 23.228 [16].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.11\tHandling of RAN/NAS release cause values",
            "description": "If the P-CSCF is required by operator policy to provide the RAN/NAS release cause information, it includes this information in the corresponding SIP message as specified in 3GPP TS 24.229 [17] when received from the PCRF (see clause 4.4.4, 4.4.6.1, 4.4.6.2, 4.4.6.3 and 4.4.6.7).\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.12\tResource Sharing",
            "description": "The P-CSCF may indicate to the PCRF that media of an AF session may share resources with media belonging to other AF sessions according to 3GPP TS 23.228 [16].\nIf the P-CSCF determines that resource sharing is possible, it may at establishment of a new AF session, include the Sharing-Key-UL AVP and/or Sharing-Key-DL AVP indicating that media resources may be shared in the related direction. The P-CSCF shall assign a distinct value for the Sharing-Key-UL AVP and/or Sharing-Key-DL AVP for each media component identified by the Media-Component-Description AVP for the AF session.\nNOTE 1:\tWhen resource sharing applies to both directions for a certain media component, the P-CSCF can assign the same value for Sharing-Key-UL AVP and Sharing-Key-DL AVP within the same media component.\nThe P-CSCF shall not include the Sharing-Key-UL AVP and/or Sharing-Key-DL AVP within the Media-Component-Description AVP when the AF session relates to an Emergency Session.\nThe PCRF shall not include the Sharing-Key-DL AVP and/or Sharing-Key-UL AVP for those PCC/QoS Rules related to the RTCP traffic.\nTrigger conditions that require applying or stopping resource sharing are described in 3GPP TS 24.229 [17].\nNOTE 2:\tWhen P-CSCF needs to stop sharing according to the procedures described in 3GPP TS 24.229 [17], the P-CSCF will provide new values for the Sharing-Key-UL AVP and/or Sharing-Key-DL AVP that are not being used by any other AF sessions for the same user.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.13\tHandling of MCPTT priority call",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.13.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Within the framework of MCPTT, when the SIP Core (3GPP TS 23.379 [54]) is implemented by an IMS core network, if the P-CSCF receives a SIP request message including a Resource-Priority header field with a namespace field and priority value defined for MCPTT for adjusting the priority of an MCPTT session, the P-CSCF shall provide the Reservation-Priority AVP and the MCPTT-Identifier AVP in the AA-Request command as defined in clause A.13.2 to allow the PCRF to set the corresponding PCC rule(s) according to the prioritized MCPTT service. Additionally, if PrioritySharing feature is supported, the P-CSCF may provide the Priority-Sharing-Indicator AVP within the Media-Component-Description AVP as described in clause A.1. For MCPTT the service priority and the priority sharing indicator are defined in 3GPP TS 23.379 [54].\nNOTE 1:\tThe process of adjusting priority may occur several times during the course of one session, e.g. a normal MCPTT group call elevated to an MCPTT emergency group call, returned to a normal priority MCPTT group call, elevated to an MCPTT imminent peril group call and returned to a normal priority MCPTT group call.\nNOTE 2:\tUpon reception of a request that requires the adjustment of the MCPTT priority, the PCRF is expected to derive the PCC Rules corresponding to the this MCPTT session, as appropriate according to operator policies.\nNOTE 3:\tThe PCRF can identify an MCPTT call using the IMS Communication Service Identifier specific to MCPTT, which is provided by the P-CSCF in the AF-Application-Identifier AVP in the AA-Request sent to PCRF.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.13.2\tDetermination of MCPTT priority parameter values",
                    "description": "",
                    "summary": "",
                    "text_content": "When the P-CSCF receives an authorized Resource-Priority header field containing an appropriate namespace and priority value used for MCPTT in SIP signaling, the P-CSCF shall include the MCPTT-Identifier AVP and Reservation-Priority AVP in the AAR command towards the PCRF.\nThe MCPTT-Identifier AVP shall include the namespace defined for MCPTT as received within the Resource-Priority header field.\nNOTE:\tTwo different values are defined for the MCPTT-Identifier AVP, one for each namespace value defined for MCPTT (see  IETF RFC 8101 [45]).\nThe Reservation-Priority AVP shall contain the priority value of the Resource-Priority header; the lowest priority shall be mapped to to DEFAULT (0), the next after the lowest to PRIORITY-ONE (1), and so on up to the highest priority which shall be mapped to PRIORITY-FIFTEEN (15).\nAdditionally, when the P-CSCF receives information about priority sharing from an MCPTT server that supports simultaneous sessions and that needs to share a common priority for several MCPTT sessions and if PrioritySharing feature is supported, the P-CSCF may include the Priority-Sharing-Indicator AVP within the Media-Component-Description AVP in the AAR command. See 3GPP TS 23.379 [54] for further information.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.14\tNotification of PLMN Change",
            "description": "When the P-CSCF receives an initial REGISTER SIP message from an attached UE, the P-CSCF may subscribe to notifications of PLMN ID changes corresponding to the PLMN where the UE is located using the procedure specified in clause 4.4.6.9.\nWhen the P-CSCF receives the AA-Answer or RA-Request from the PCRF, the P-CSCF stores the PLMN identifier received within 3GPP-SGSN-MCC-MNC AVP and behaves as defined in 3GPP TS 24.229 [17].\nThe P-CSCF shall cancel the subscription to notification for changes of the PLMN used by the UE when the user is de-registered from the IM CN subsystem.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.15\tHandling of MCVideo priority call",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.15.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Within the framework of MCVideo, when the SIP Core (3GPP TS 23.281 [61]) is implemented by an IMS core network, if the P-CSCF receives a SIP request message including a Resource-Priority header field with a namespace field and priority value defined for MCVideo for adjusting the priority of an MCVideo session, the P-CSCF shall provide the Reservation-Priority AVP and the MCVideo-Identifier AVP in the AA-Request command as defined in clause A.15.2 to allow the PCRF to set the corresponding PCC rule(s) according to the prioritized MCVideo service.\nNOTE 1:\tThe process of adjusting priority may occur several times during the course of one session, e.g. a normal MCVideo group call elevated to an MCVideo emergency group call and returned to a normal priority MCVideo group call, elevated to an MCVideo imminent peril group call and returned to a normal priority MCVideo group call.\nNOTE 2:\tUpon reception of a request that requires the adjustment of the MCVideo priority, the PCRF is expected to derive the PCC Rules corresponding to the this MCVideo session, as appropriate according to operator policies.\nNOTE 3:\tThe PCRF can identify an MCVideo call using the IMS Communication Service Identifier specific to MCVideo, which is provided by the P-CSCF in the AF-Application-Identifier AVP in the AA-Request sent to PCRF.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.15.2\tDetermination of MCVideo priority parameter values",
                    "description": "",
                    "summary": "",
                    "text_content": "When the P-CSCF receives an authorized Resource-Priority header field containing an appropriate namespace and priority value used for MCVideo in SIP signaling, the P-CSCF shall include the MCVideo-Identifier AVP and Reservation-Priority AVP in the AAR command towards the PCRF.\nThe MCVideo-Identifier AVP shall include the namespace defined for MCVideo as received within the Resource-Priority header field.\nThe Reservation-Priority AVP shall contain the priority value of the Resource-Priority header; the lowest priority shall be mapped to to DEFAULT (0), the next after the lowest to PRIORITY-ONE (1), and so on up to the highest priority which shall be mapped to PRIORITY-FIFTEEN (15).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.16\tSupport for volume based charging of IMS services",
            "description": "As a network option, when VBC feature is supported, the P-CSCF may be able to indicate to the PCRF the establishment and termination of specific IMS communication services (e.g. CAT and voice calls, 3PTY conference) or the establishment and termination of different communication dialogues to separate parties. This enables PCC to apply different Policy and Charging control. During AF session establishment, the P-CSCF may include the IMS-Content-Identifier AVP and the IMS-Content-Type AVP in the AAR command towards the PCRF. The PCRF derives the PCC rules to categorise the service data flows by rating group or combination of rating group and service id.\nDuring AF session modification, the P-CSCF may include the IMS-Content-Identifier AVP and the IMS-Content-Type AVP in the AAR command towards the PCRF. The PCRF updates the PCC rules to categorise the service data flows by rating group or combination of rating group and service id.\nThe IMS-Content-Type AVP indicates the type of IMS content of a session component. The P-CSCF determines the type of IMS content as follows:\n-\tIf the SDP payload refers to the Customized Alerting Tones (CAT) service (i.e. SDP body contains a media-level \"a=content\" SDP attribute with a value \"g.3gpp.cat\" defined in 3GPP TS 24.182 [62]), the P-CSCF sets the IMS-Content-Type AVP with the value \"CAT\".\n-\tIf the SDP payload refers to the 3PTY conference service (i.e. SDP body contains an \"a=content\" media-level attribute line with value of \"g.3gpp.conf\" defined in 3GPP TS 24.147 [63]), the P-CSCF sets the IMS-Content-Type AVP with the value \"CONFERENCE\".\n-\tOtherwise, the P-CSCF sets the IMS-Content-Type AVP with the value \"NO_CONTENT_DETAIL\".\nThe IMS-Content-Identifier AVP contains information that identifies a particular IMS communication service or a particular communication dialogue in the IMS session. This information may be used by the PCRF to apply different charging characteristics to the different parties in a 3PTY conference scenario.\nAs a network option, if VBCLTE feature is further supported, the P-CSCF shall be able to indicate to the PCRF caller and callee information.\nDuring AF session establishment, the P-CSCF may include the Calling-Party-Address AVP and the Callee-Information AVP in the AAR command towards the PCRF. The PCRF derives the PCC rules including the information of caller and callee.\nDuring AF session modification, the P-CSCF may include the Callee-Information AVP in the AAR command towards the PCRF. The PCRF updates the PCC rules to categorise the service data flows by rating group or combination of rating group and service id.\nThe Calling-Party-Address AVP indicates the caller of the IMS service. The P-CSCF determines the caller as defined in clause 7.2.33 of 3GPP TS 32.299 [24].\nThe Callee-Information AVP indicates the callee of the IMS service. The P-CSCF determines the callee as follows:\n-\tThe Called-Party-Address holds the address of the party (Public User ID or Public Service ID) to whom the SIP transaction is posted in the context of an end-to-end SIP transaction as defined in clause 7.2.32 in 3GPP TS 32.299 [24].\n-\tThe Requested-Party-Address holds the address of the party (Public User ID or Public Service ID) to whom the SIP transaction was originally posted as defined in clause 7.2.176 in 3GPP TS 32.299 [24].\nNOTE:\tThis AVP is only applicable when the ATCF is collocated with the P-CSCF.\n-\tThe Called-Asserted-Identity holds the address or addresses (SIP URI and/or Tel URI) of the party (Public User ID or Public Service ID) of the finally asserted called party as defined in clause 7.2.31 of 3GPP TS 32.299 [24].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.17\tIndication of Restricted Local Operator Services Support",
            "description": "RLOS is an optional feature supported in certain countries. Service requirements of RLOS are defined in 3GPP TS 22.101 [65] and the architectural requirements are defined in 3GPP TS 23.221 [66]. The RLOS stage 2 services description for the Evolved Packet System (EPS) is specified in 3GPP TS 23.401 [67]. The policy and charging control architecture is described in 3GPP TS 23.203 [2].\nRLOS may be supported as described in clause A.5 with the following differences:\n-\temergency registration is replaced by RLOS registration;\n-\temergency session is replaced by RLOS session;\n-\temergency traffic is replaced by RLOS traffic;\n-\tvalue \"sos\" is replaced by \"g.3gpp.rlos\";\n-\tUNAUTHORIZED_NON_RLOS_SESSION session is returned when the service-URN AVP does not include an RLOS value, and the PCRF binds the IMS session to an IP-CAN established to an RLOS APN;\n-\tRLOS services are not prioritized services; and\n-\tthe call back functionality is not required.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.18\tCoverage and Handoff Enhancements using Multimedia error robustness feature (CHEM)",
            "description": "As a network option, the P-CSCF may support the PCC procedures in the present clause to handle the Coverage and Handoff Enhancements using Multimedia error robustness feature (CHEM)\nNOTE 1:\tWhen the CHEM feature is supported, improved error robustness can be enabled by packet-loss handling procedures of the codec, codec mode, or codec configuration to avoid, delay, or reduce the need to handoff a terminal due to degradation in the media quality. Communicating the level of robustness of the media to the network enables the eNB to use this information to determine a threshold for when the terminal should be handed off to another cell, domain (circuit-switched vs. packet-switched), or radio access technology.\nWhen a session is initiated or modified the P-CSCF supporting the CHEM feature shall derive the Max-PLR-DL AVP and Max-PLR-UL AVP based on the PLR_adapt and maxe2e-PLR attribute values in both the SDP offer and/or SDP answer to determine the maximum tolerable end-to-end PLR budget distributed across the uplink and downlink in a media transport path as described in 3GPP TS 29.213 [9] clause 6.2.\nUpon reception of SDP offer and answer, P-CSCF should check whether a= PLR_adapt line is present in both SDP offer and answer to derive Max-PLR-DL and Max-PLR-UL AVP in Media-Component-Description AVP else downlink and uplink maximum packet loss are not included by AF.\nThe originating P-CSCF should derive Max-PLR-DL AVP to the maximum value of Max-PLR-DL among all the RTP payload types. For each RTP payload type Max-PLR-DL is computed as described in 3GPP TS 29.213 [9] clause 6.2.\n-\tIf maxe2e-PLR is included in the SDP offer then Max-PLR-DL for a payload type is derived as value of maxe2e-PLR in the SDP offer - maxUL-PLR in the SDP answer if present else the default value is ½ maxe2e-PLR value present in the SDP offer.\n-\tIf maxe2e-PLR is not included in the SDP offer then then Max-PLR-DL for a payload type is derived from the default value in end-to-end Maximum End-to-End Packet Loss Rate for the decoder of the RTP payload type as recommended in 3GPP TS 26.114 [41] clause X.1.2 for application layer redundancy or X.1.1 for partial redundancy - maxUL-PLR in the SDP answer if present else the default value is ½ default value in end-to-end Maximum End-to-End Packet Loss Rate for the decoder of the RTP payload type as recommended in 3GPP TS 26.114 [41].\nThe originating P-CSCF should derive Max-PLR-UL AVP to the maximum value of Max-PLR-UL among all the RTP payload types. For each RTP payload type Max-PLR-UL is computed as described in 3GPP TS 29.213 [9] clause 6.2.\n-\tIf maxe2e-PLR is included in the SDP answer then Max-PLR-UL for a payload type is derived as value of maxe2e-PLR in the SDP answer - maxDL-PLR in the SDP ANSWER if present else the default value is ½ maxe2e-PLR value present in the SDP answer.\n-\tIf maxe2e-PLR is not included in the SDP answer then then Max-PLR-UL for a payload type is derived as the ½ default value in end-to-end Maximum End-to-End Packet Loss Rate for the decoder of the RTP payload type as recommended in 3GPP TS 26.114 [41] clause X.1.2 for application layer redundancy or X.1.1 for partial redundancy.\nThe terminating P-CSCF should derive Max-PLR-DL AVP to the maximum value of Max-PLR-DL among all the RTP payload types. For each RTP payload type Max-PLR-DL is computed as described in 3GPP TS 29.213 [9] clause 6.2.\n-\tIf maxe2e-PLR is included in the SDP answer then Max-PLR-DL for a payload type is derived as value of value of maxDL-PLR in the SDP answer if present else the default value is ½ maxe2e-PLR value present in the SDP answer.\n-\tIf maxe2e-PLR is not included in the SDP answer then then Max-PLR-DL for a payload type is derived as the ½ default value in end-to-end Maximum End-to-End Packet Loss Rate for the decoder of the RTP payload type as recommended in 3GPP TS 26.114 [41] clause X.1.2 for application layer redundancy or X.1.1 for partial redundancy.\nThe terminating P-CSCF should derive Max-PLR-UL AVP to the maximum value of Max-PLR-UL among all the RTP payload types. For each RTP payload type Max-PLR-UL is computed as described in 3GPP TS 29.213 [9] clause 6.2.\n-\tIf maxe2e-PLR is included in the SDP offer then Max-PLR-UL for a payload type is derived as value of value of maxUL-PLR in the SDP answer if present else the default value is ½ maxe2e-PLR value present in the SDP offer.\n-\tIf maxe2e-PLR is not included in the SDP offer then then Max-PLR-UL for a payload type is derived as the ½ default value in end-to-end Maximum End-to-End Packet Loss Rate for the decoder of the RTP payload type as recommended in 3GPP TS 26.114 [41] clause X.1.2 for application layer redundancy or X.1.1 for partial redundancy.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.19\tHandling of a FLUS session",
            "description": "If the P-CSCF receives a SIP request that requires provisioning of service information to the PCRF, the \"FLUS\" feature is supported and an SDP attribute \"a=label:flus…\" is included in one or more of the received SDP media descriptions, the P-CSCF shall provide the string after \"a=label:\" starting with \"flus\" within the FLUS-Identifier AVP within the affected Media-Component-Description AVP(s) in the AA-Request to the PCRF.\nNOTE:\tDuring the first interaction with the PCRF, the P-CSCF does not know if the \"FLUS\" feature is supported by the PCRF. In this case the P-CSCF will include the information as if supported.\nIf additionally the P-CSCF receives the \"a=3gpp-qos-hint\" media-level SDP attribute in the SIP request, the P-CSCF shall provide the PCRF with the Desired-Max-Latency AVP and/or Desired-Max-Loss AVP as described in 3GPP TS 29.213 [9], clause 6.2.\nUpon receiving the information from the P-CSCF and if the \"FLUS\" feature is supported, the PCRF shall derive the QoS information as described in 3GPP TS 29.213 [9], clause 6.3.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.20\tQoS hint support for data channel media",
            "description": "If the P-CSCF receives a SIP request that requires provisioning of a service information to the PCRF, the QoSHint feature is supported and an SDP attribute \"a=3gpp-qos-hint\" is included in one or more of the received data channel media descriptions, the P-CSCF may provide the Desired-Max-Latency AVP and/or Desired-Max-Loss AVP for each affected application media component within the Media-Component-Description AVP(s) in the AA-Request to the PCRF.\nNOTE:\tDuring the first interaction with the PCRF, the P-CSCF does not know if the QoSHint feature is supported by the PCRF. In this case the P-CSCF will include the information as if supported.\nUpon receiving the information from the P-CSCF and if the QoSHint feature is supported, the PCRF shall derive the QoS information as described in 3GPP TS 29.213 [9], clause 6.3.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.1\tFormat of a flow identifier",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "B.1.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "A flow identifier is expressed as a 2-tuple as follows:\n<The ordinal number of the position of the media component description in the SDI , The ordinal number of the IP flow(s) within the media component description assigned in the order of increasing downlink port numbers as detailed below >\nwhere both are numbered starting from 1. The encoding of the flow identifier is as indicated in 3GPP TS 24.008 [12].\nIf UE and AF share an algorithm for a given application, which guarantees that UE and AF assign the same ordinal number to each media component, the ordinal numbers of the IP Flows within a media component shall be assigned according to the following rules:\n-\tAll IP flow(s) or bidirectional combinations of two IP flow(s) within the media component, for which a downlink destination port number is available, shall be assigned ordinal numbers in the order of downlink destination port numbers.\n-\tAll IP flows, where no downlink destination port number is available, shall be assigned the next higher ordinal numbers in the order of uplink destination port numbers.\nThe ordinal number of a media component shall not be changed when the session description information is modified.\nIf no SDI with fixed and unique positions for media components is exchanged between UE and AF, the UE and AF may assign the ordinal numbers of the media components in another application-dependent algorithm which guarantees that UE and AF assign the same ordinal number to each media component.\nIf UE and AF do not share an algorithm for a given application, which guarantees that UE and AF assign the same ordinal number to each media component, the ordinal number of the media component shall be set to zero and the ordinal number of the IP flows shall be assigned according to the following rules:\n1.\tIf ordinal numbers for several IP flows are assigned at the same time, all uplink IP flows shall be assigned lower ordinal number than all downlink IP flows.\n2.\tIf ordinal numbers for several IP flows are assigned at the same time, all uplink and all downlink IP flows shall separately be assigned ordinal numbers according to increasing internet protocol number assigned by IANA (e.g. 6 for TCP and 17 for UDP)\n3.\tIf ordinal numbers for several IP flows are assigned at the same time, for each internet protocol with a port concept, all uplink and all downlink IP flows of this internet protocol shall separately be assigned ordinal numbers according to increasing port numbers.\n4.\tIf IP flows are removed from an existing session, the previously assigned binding info shall remain unmodified for the remaining IP flows.\n5.\tIf IP flows are added to an existing session, the previously assigned binding info shall remain unmodified and the new IP flows shall be assigned ordinal numbers following the rules 1. To 3., starting with the first previously unused ordinal number. The numbers freed in step 4. Shall not be reused.\nIf the IP flows correspond to AF signalling (e.g. SIP signalling IP Flows), and no IP flow information is provided both the ordinal number of the media component and the IP flows shall be set to zero. In the case when the IP flow information of the AF signalling is provided, the ordinal number of the media component will be set to zero, and the ordinal number(s) of the IP flows shall follow the rules set above for the case when the UE and AF do not share an algorithm for a given application.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "B.1.2\tDerivation of Flow Identifiers from SDP",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "B.1.2.1\tStandard Procedure",
                            "text_content": "The procedure in Table B.1.2.1.1 shall be applied for SDP of \"session\" disposition type within SIP and for all SDP outside SIP.\nTable B.1.2.1.1: Standard Procedure to derive Flow Identifiers from SDP\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table B.1.2.1.1: Standard Procedure to derive Flow Identifiers from SDP",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "B.1.2.2\tSDP with \"early session\" disposition type",
                            "text_content": "The procedure in Table B.1.2.2.1 shall be applied for SDP of \"early session\" disposition type within SIP. The \"early session\" disposition type is specified within IETF RFC 3959 [27].\nTable B.1.2.2.1: Procedure to derive Flow Identifiers from \"early session\" disposition SDP\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table B.1.2.2.1: Procedure to derive Flow Identifiers from \"early session\" disposition SDP",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "title": "B.2\tExample 1",
            "description": "An UE, as the offerer, sends a SDP session description, as shown in table B.2.1, to an application server (only relevant SDP parameters are shown):\nTable B.2.1: The values of the SDP parameters sent by the UE in example 1.\n\nand receives the SDP parameters, as shown in table B.2.2, from the application server:\nTable B.2.2: The values of the SDP parameters sent by the application server in example 1.\n\nFrom this offer–answer exchange of SDP parameters the UE and the PCRF each creates a list of flow identifiers comprising the IP flows as shown in table B.2.3:\nTable B.2.3: Flow identifiers in example 1.\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "Table B.2.1: The values of the SDP parameters sent by the UE in example 1.",
                    "table number": 10,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "Table B.2.2: The values of the SDP parameters sent by the application server in example 1.",
                    "table number": 11,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "Table B.2.3: Flow identifiers in example 1.",
                    "table number": 12,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.3\tExample 2",
            "description": "In the general case, multiple ports may be specified with a \"number of ports\" qualifier as follows, RFC 2327 [17]:\nm=<media> <port>/<number of ports> <transport> <fmt list>\nAn UE, as the offerer, sends a SDP session description, as shown in table B.3.1, to an application server (only relevant SDP parameters are shown):\nTable B.3.1: The values of the SDP parameters sent by the UE in example 2.\n\nand receives the SDP parameters, as shown in table B.3.2, from the application server:\nTable B.3.2: The values of the SDP parameters sent by the application server in example 2.\n\nFrom this offer–answer exchange of SDP parameters the UE and the PCRF each creates a list of flow identifiers comprising the IP flows as shown in table B.3.3:\nTable B.3.3: Flow identifiers in example 2.\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "Table B.3.1: The values of the SDP parameters sent by the UE in example 2.",
                    "table number": 13,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "Table B.3.2: The values of the SDP parameters sent by the application server in example 2.",
                    "table number": 14,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "Table B.3.3: Flow identifiers in example 2.",
                    "table number": 15,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.4\tExample 3 without media components.",
            "description": "The UE and AF do not exchange SDP for an application and do not share an algorithm, which guarantees that UE and AF assign the same ordinal number to each media component.\nAt the AF session initiation, the UE and AF agree to set up the following IP flows:\n-\tUplink UDP flow with destination port 100.\n-\tDownlink UDP flow with destination port 100.\n-\tDownlink TCP flow with destination port 100.\n-\tUplink TCP flow with destination port 100.\n-\tUplink UDP flow with destination port 200.\nThe following binding info is assigned to these IP flows.\n-\tUplink UDP flow with destination port 100:\t(0, 2)\n-\tDownlink UDP flow with destination port 100:\t(0, 5)\n-\tDownlink TCP flow with destination port 100:\t(0, 4)\n-\tUplink TCP flow with destination port 100:\t(0, 1)\n-\tUplink UDP flow with destination port 200:\t(0, 3)\nAt a later stage in the session, the TCP IP flows are removed and the following IP flows are added:\n-\tUplink UDP flow with destination port 150.\n-\tDownlink UDP flow with destination port 50.\nThe following binding info is assigned to the IP flows existing at this stage:\n-\tUplink UDP flow with destination port 100:\t(0, 2)\n-\tDownlink UDP flow with destination port 100:\t(0, 5)\n-\tUplink UDP flow with destination port 200:\t(0, 3)\n-\tUplink UDP flow with destination port 150:\t(0, 6)\n-\tDownlink UDP flow with destination port 50:\t(0, 7)\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.5\tExample 4",
            "description": "In this example, the SDP \"a=rtcp\" attribute defined in IETF RFC 3605 is used.\nAn UE, as the offerer, sends a SDP session description, as shown in table B.5.1, to an application server (only relevant SDP parameters are shown):\nTable B.5.1: The values of the SDP parameters sent by the UE in example 1.\n\nand receives the SDP parameters, as shown in table B.5.2, from the application server:\nTable B.5.2: The values of the SDP parameters sent by the application server in example 1.\n\nFrom this offer–answer exchange of SDP parameters the UE and the PCRF each creates a list of flow identifiers comprising the IP flows as shown in table B.5.3:\nTable B.5.3: Flow identifiers in example 4.\n\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "Table B.5.1: The values of the SDP parameters sent by the UE in example 1.",
                    "table number": 16,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "Table B.5.2: The values of the SDP parameters sent by the application server in example 1.",
                    "table number": 17,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "Table B.5.3: Flow identifiers in example 4.",
                    "table number": 18,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "D.1\tMonitoring events support, using SCEF procedures over Rx",
            "description": "If SCS/AS has requested monitoring of events and operator policies in the SCEF indicate that monitoring shall be performed via PCRF, the SCEF shall initiate the applicable Rx procedures acting as an AF as described in 3GPP TS 23.682 [40].\nThe following monitoring events are supported;\n-\tLocation reporting according to the Access Network Information Report procedures described in clause 4.4.6.7. This functionality requires the support of NetLoc, NetLoc-Untrusted-WLAN and/or NetLoc-Trusted-WLAN supported features.\n-\tCommunication Failure reporting as described in clauses 4.4.4, 4.4.6.2 and 4.4.6.3. This functionality requires the support of RAN-NAS-Cause supported feature.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.1\tGeneral",
            "description": "In the 5GS the Rx reference point is defined between the the PCF and the AF. The relationship between the involved functional entities is depicted in figure E.1.1. The overall PCC architecture is depicted in clause 4 of 3GPP TS 29.513 [59].\nThe figure depicts a simplified model of a 5G radio reference signal, illustrating the various components and their interactions. The model includes a transmitter (Tx), a receiver (Rx), and a reference signal (Rx reference). The Tx is represented by a rectangular shape with a rectangular antenna, while the Rx reference is represented by a circular shape with a circular antenna. The Rx reference is connected to the Tx via a coaxial cable, and the Rx is connected to the receiver via a coaxial cable. The Rx reference is also connected to the base station via a coaxial cable, and the Rx is connected to the receiver via a coaxial cable. The Rx reference is connected to the base station via a coaxial cable, and the Rx is connected to the receiver via a coaxial cable. The Rx reference is connected to the base station via a coaxial cable, and the Rx is connected to the receiver via a coaxial cable. The Rx reference is connected to the base station via a coaxial cable, and the Rx is connected to the receiver via a coaxial cable. The Rx reference is connected to the base station via a coaxial cable, and the Rx is connected to the receiver via a coaxial cable. The Rx reference is connected to the base station via\nFigure E.1.1: Rx reference model in 5GS\n5GS supports an interworking with AFs via the Rx interface. Interworking with AFs related to existing IMS services is described in 3GPP TS 23.228 [16]. Interworking with AFs related to existing Mission Critical services is described in TS 23.280 [60]. The PCF in 5GS supports the corresponding Rx procedures and requirements defined in 3GPP TS 23.203 [2]. The stage 2 requirements for 5GS supporting Rx interface are described in 3GPP TS 23.503 [56].\nThe PCF exchanges PCC rules with the SMF over the N7 interface as specified in 3GPP TS 29.512 [57].\nSignalling flows related to the both Rx and N7 interfaces are specified in 3GPP TS 29.513 [59].\nThe generic mechanisms for interaction between the AF and the PCF are described in main clauses in this specification and with the following clarifications:\n-\tdescription of the PCRF and the PCEF applies to the PCF and the SMF respectively;\n-\tdescription of the SPR applies to the UDR;\n-\tBBERF is not applicable in 5GS;\n-\tan IP-CAN bearer in this specification shall be interpreted as a 5GS QoS flow;\n-\tan IP-CAN session in this specification shall be interpreted as a 5GS PDU session of type IP;\n-\tAPN is equivalent to DNN;\n-\tthe following values of the Specific-Action AVP defined in clause 5.3.13 are applicable only to a PCF: EPS_FALLBACK (17) and INDICATION_OF_REALLOCATION_OF_CREDIT (18);\n-\twhen the serving network is an SNPN and the serving network information is provided to the AF, the NID may optionally be part of the serving network identifier, as specified in clause E.5; and\n-\tthe 5G-RAN-NAS-Release-Cause AVP defined in clause 5.3.69 is applicable only to a PCF. When the RAN-NAS-Cause feature is supported, it encodes the 5GS RAN cause and/or NAS cause, when available.\nThe specific mechanisms for the interaction between the AF and the PCF are described in the subclauses below.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.2\tMapping table for IP-CAN types and Access types",
            "description": "Table E.2-1 maps the values of the Access types and RAT types used for N7 interface in 3GPP TS 29.512 [58] with the values of the IP-CAN types and RAT types used in this specification.\nTable E.2-1: Mapping table for IP-CAN types and Access types values\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "Table E.2-1: Mapping table for IP-CAN types and Access types values",
                    "table number": 19,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.3\tReporting EPS Fallback",
            "description": "When the feature \"EPSFallbackReport\" is supported, if the AF requests the PCF to report EPS Fallback, the AF shall subscribe to the \"EPS_FALLBACK\" within the Specific-Action AVP as described in clause 5.3.13. The AF shall request the PCF to report the EPS Fallback in conjuction with providing the PCF with the AF session information as described in clause 4.4.1 for the initial provisioning of session information, and the subscription to \"EPS_FALLBACK\" shall apply for voice media type requests along the AF session lifetime.\nWhen the PCF then receives the EPS Fallback indication from the SMF, the PCF shall provide the corresponding EPS Fallback indication to the AF by sending an RAR (re-authorization request) command. The RAR command shall include the EPS_FALLBACK cause encoded in the Specific-Action AVP.\nWhen the AF receives the RAR command, it shall acknowledge the command by sending an RAA (re-authorization answer) command to the PCF.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.4\tIP-CAN type change Notification for a MA PDU session",
            "description": "If the AF has successfully subscribed to change notifications in UE’s IP-CAN type and RAT type, the ATSSS feature is supported and the PDU session is a MA PDU session:\n-\tif the PCF previously requested to the SMF to be updated with access type changes, the PCF shall include in the AAA command:\ni.\tthe IP-CAN-Type AVP, RAT-Type AVP (if applicable) for the UE’s IP-CAN/RAT type values; and\nii.\tif both, 3GPP and non-3GPP access information is available, the additional IP-CAN type information and RAT type information (if available) in the MA-Information AVP;\n-\totherwise, the PCF shall subscribe to access type changes as described in clause 4.2.6.4 of 3GPP TS 29.512 [57] and shall send an RAR command when the corresponding IP-CAN event occurs, i.e.:\na)\twhen a UE’s IP-CAN type or RAT type (if applicable) changes; or\nb)\ta new IP-CAN type and RAT type (if applicable) become available for the UE and the MA PDU session; or\nc)\tan IP-CAN type and RAT type (if applicable) become unavailable (are released) for the UE and the MA PDU session.\nThe RAR from the PCF shall include the Specific-Action AVP for the subscribed event and:\na.\tif it is the first IP-CAN change report:\ni.\tthe IP-CAN-Type AVP, RAT-Type AVP (if applicable) for the UE’s IP-CAN/RAT type values; and\nii.\tif both, 3GPP and non-3GPP access information is available, the additional IP-CAN type information and RAT type information (if available) in the MA-Information AVP;\nb.\tif it is a subsequent IP-CAN change report:\ni.\tif a new IP-CAN type is added to the MA PDU session, the MA-Information AVP with the added IP-CAN type information encoded in the IP-CAN-Type AVP and the RAT type information encoded within the RAT-Type AVP if applicable;\nii.\tif an IP-CAN type is released in the MA PDU session, the MA-Information AVP with the released IP-CAN type information encoded in the IP-CAN-Type AVP, the RAT type information encoded within the RAT-Type AVP, if applicable, and the MA-Information-Action AVP set to 1 (RELEASE).\nNOTE:\tFor a MA PDU session, if the ATSSS feature is not supported by the AF the PCF includes the IP-CAN-Type AVP and the RAT-Type AVP with a currently active combination of IP-CAN type and RAT type (if applicable for the notifed access type). When both 3GPP and non-3GPP accesses are available, the PCF includes the information corresponding to the 3GPP access.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.5\tReporting serving network identity",
            "description": "When a new AF session is being established as described in clause 4.4.1 or is being modified as described in clause 4.4.2, the AAA command shall also contain the PLMN identifier within the 3GPP-SGSN-MCC-MNC AVP and, if available, the NID within the NID AVP if the PCF has previously requested the SMF to be updated with the serving network identity.\nNOTE:\tThe combination of a PLMN identifier and a NID identifies an SNPN, as specified in 3GPP TS 23.501 [55] clause 5.30.2.\nWhen the AF initiates a session termination, the PCF shall include in the STA command the PLMN identifier within the 3GPP-SGSN-MCC-MNC AVP and, if available, the NID within the NID AVP:\n-\tif the PCF received an ST-Request from the AF, indicating an AF session termination and if location info is not available, as specified in clause 4.4.4; and\n-\tif the AF requested the PCF to report the access network information, the Rx session is being terminated and if location info is not available, as specified in clause 4.4.6.7.\nWhen the PCF needs to inform the AF about a traffic plane event, the PCF shall include in the RAR command the PLMN identifier within the 3GPP-SGSN-MCC-MNC AVP and, if available, the NID within the NID AVP:\n-\twhen the PCF gets the knowledge that one or more SDFs have been deactivated, if the RAN-NAS-Cause feature is supported and if location info is not available, as specified in clause 4.4.6.2;\n-\twhen the PCF is notified of the loss or release of resources associated to the PCC rules corresponding with AF signalling IP flows, if the RAN-NAS-Cause feature is supported and if location info is not available, as specified in clause 4.4.6.3;\n-\tif the AF requested the PCF to report the access network information, the Rx session is not being terminated and if location info is not available, as specified in clause 4.4.6.7; and\n-\twhen the PCF gets the knowledge that the service network where the UE is located has been updated or becomes available and the AF subscribed to PLMN_CHANGE has described in clause 4.4.6.9.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.6\tTrusted non-3GPP Access Network Information",
            "description": "The PCF provides the AF with the access network information as described in clause 4.4.1, with the following differences:\n-\tThe RAT-Type AVP shall be set to \"WLAN\" and AN-Trusted AVP shall be set to \"Trusted\" when over the N7 reference point:\na)\tthe received \"ratType\" attribute is \"TRUSTED_WLAN\"; or\nb)\tthe received \"ratType\" attribute is \"TRUSTED_N3GA\" and the \"Netloc-Trusted-N3GA\" feature is not supported.\n-\tThe RAT-Type AVP shall be set to \"TRUSTED-N3GA\" when the \"Netloc-Trusted-N3GA\" feature is supported and the received \"ratType\" attribute over the N7 reference point is \"TRUSTED_N3GA\".\nIf the NetLoc-Trusted-WLAN is supported, the procedure described in clauses 4.4.4 and 4.4.6.7 shall apply with the exceptions specified in clause E.1 and with the exception of the user location information that is encoded as follows:\na)\tThe TNAP/TWAP Identifier received over the N7 reference point in the \"tnapId\"/\"twapId\" attributes of the \"n3gaLocation\" attribute, if available, is encoded in the TWAN-Identifier AVP.\nNOTE 1:\tThe received SSID, BSSID and Civic Address values, if available, are encoded within the TWAN-Identifier AVP as specified in 3GPP TS 29.061 [34].\nb)\tThe UE/N5CW device local IP address (used to reach the TNGF/TWIF) received over the N7 reference point in the \"ueIpv4Addr\" or \"ueIpv6Addr\" attribute of the \"n3gaLocation\" attribute, if available, is encoded in the UE-Local-IP-Address AVP.\nc)\tThe UDP source port number received over the N7 reference point in the \"portNumber\" attribute if available, is encoded within the UDP-Source-Port AVP\nNOTE 2:\tThe UDP protocol can be used between the UE and TGNF to enable NAT traversalWhen reporting IP-CAN_CHANGE specific action, the PCF shall, in addition to the IP-CAN-Type AVP and RAT-Type AVP, provide the AN-Trusted AVP set to \"Trusted\" when the provided and RAT-Type AVP value is \"WLAN\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.7\tUntrusted non-3GPP Access Network Information",
            "description": "The PCF provides the AF with the access network information as described in clause 4.4.1, with the following differences:\n-\tThe RAT-Type AVP shall be set to \"WLAN\" and AN-Trusted AVP shall be set to \"Untrusted\" when over the N7 reference point the received \"ratType\" attribute is \"WLAN\".\n-\tThe ePDG address used as IPSec tunnel endpoint with the UE, received over the N7 reference point within the \"anGwAddr\" attribute included in the \"servNfId\" attribute, is encoded in the AN-GW-Address AVP.\n-\tThe serving network identifier received over the N7 reference point within the \"servingNetwork\" attribute is encoded in the 3GPP-SGSN-MCC-MNC AVP.\nIf the NetLoc-Untrusted-WLAN feature is supported, reporting access network information procedure described in clauses 4.4.4 and 4.4.6.7 shall apply with the exceptions specified in clause E.1 and with the exception of:\n-\tThe user location information is encoded as follows:\na)\tThe UE local IP address (used to reach the N3IWF or ePDG) received over the N7 reference point in the \"ueIpv4Addr\" or \"ueIpv6Addr\" attribute of the \"n3gaLocation\" attribute, if available, is encoded in the UE-Local-IP-Address AVP.\nb)\tThe UDP source port or the TCP source port received over the N7 reference point in the \"portNumber\" attribute if available, is encoded within the UDP-Source-Port AVP or the TCP-Source-Port AVP as indicated by the \"protocol\" attribute, if available.\nNOTE 1:\tWhen the UE reaches the ePDG via a NAT, the combination of UE local IP address and the UE source port is needed for lawful interception purposes. The UE source port may be either a UDP or a TCP port, and it is indicated in the \"protocol\" attribute received over the N7 reference point.\nc)\tThe WLAN location information received in the \"twapId\" attribute of the \"n3gaLocation\" attribute, if available, is encoded in the TWAN-Identifier AVP.\n-\tThe UE time zone information is included within 3GPP-MS-TimeZone AVP, if available.\nNOTE 2:\tEPC does not support time zone reporting when the access network is untrusted WLAN.\nWhen reporting IP-CAN_CHANGE specific action, the PCF shall, in addition to the IP-CAN-Type AVP and RAT-Type AVP, provide the AN-Trusted AVP set to \"Untrusted\". The PCF provides also the AF with the ePDG IP address used as IPSec tunnel endpoint with the UE, if received, encoded in the AN-GW-Address AVP.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.8\tWireline non-3GPP Access Network Information",
            "description": "The PCF provides the AF with the wireline access network information as described in clause 4.4.1, with the following differences:\n-\tThe RAT-Type AVP shall be set to \"WIRELINE\", \"WIRELINE_CABLE\" or \"WIRELINE_BBF\" according to the received \"ratType\" attribute.\nIf the NetLoc-Wireline is supported, the procedure described in clauses 4.4.4 and 4.4.6.7 shall apply with the exceptions specified in clause E.1 and the exception of the user location information that is encoded as follows:\n-\tThe wireline location is encoded in the Wireline-User-Location-Info AVP, where:\na)\tThe HFC Node Identifer received over NGAP in the \"hfcNodeId\" attribute of the \"n3gaLocation\", if available, is encoded in the HFC-Node-Identifier AVP.\nb)\tThe Global Line Identifier in the \"gli\" attribute of the \"n3gaLocation\", if available, is encoded in the GLI-Identifier AVP.\nc)\tThe type of wireline access in the \"w5gbanLineType\" attribute of the \"n3gaLocation\", if available, is encoded in the Line-Type AVP.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.9\t5GS-Level Identities report",
            "description": "The PCF provides 5GS-Level Identities as defined in annex A.1 and A.5 with the following differences:\n-\tthe IMSI is included within the Subscription-Id AVP if the IMSI is received within the \"supi\" attribute;\n-\tthe MSISDN is included within the Subscription-Id AVP if the MSISDN is received within the \"gpsi\" attribute;\n-\tthe NAI is included within the Subscription-Id AVP if the NAI is received within the \"supi\" attribute;\n-\tthe IMEISV is included with the User-Equipment-Info AVP if the IMEISV is received within the \"pei\" attribute;\n-\tthe IMEI is included with the the User-Equipment-Info-Extension AVP if the User-Equipment-Info-Extension feature is supported and the IMEI is received within the \"pei\" attribute.\nNOTE 1: UE identities for wireless and wireline convergence access are not considered to be used for the IMS.\nNOTE 2: When the UE accesses a PLMN, the PCF provides the IMSI and the MSISDN within the Subscription-Id AVP(s), if available. When the UE accesses a SNPN, the PCF provides the IMSI or the NAI, and the MSISDN within the Subscription-Id AVP(s), if available. For both, SNPN and PLMN accesses, the PCF provides the IMEI(SV) in the concerned AVP(s) as specified above.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.10\tReporting Access Network Information",
            "description": "When the PCF receives the access network information, the PCF shall provide the corresponding access network information to the AF as defined in clause 4.4.6.7,\nWhen the AF requested UE location, the PCF shall forward both, the received 3GPP access (NR or E-UTRA) and non-3GPP access (Trusted, Untrusted, or Wireline network) UE location, if available.\nThe PCF encodes 3GPP UE location received in the \"eutraLocation\" or \"nrLocation\" attribute into the 3GPP-User-Location-Info AVP as described in 3GPP TS 29.061 [34].\nThe PCF encodes the non-3GPP Trusted, Unstrusted or Wireline access UE location as described in clauses E.6, E.7 and E.8. When the PCF received the \"userLocationInfoTime\" attribute, the PCF includes the User-Location-Info-Time AVP in the access network report to the AF to indicate when the UE location was last known.\nNOTE:\tWhen the PCF receives both, the 3GPP and non-3GPP access UE locations, the \"userLocationInfoTime\" attribute, if received, indicates the last known 3GPP access UE location, and consequently, the User-Location-Info-Time AVP also indicates the last known 3GPP access UE location.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.11\tAccess Network Charging Information Notification",
            "description": "When the PCF receives the access network charging information, the PCF shall provide the corresponding access network information to the AF as defined in clause 4.4.6.5.\nIf the PCF received from the SMF both, the IPv4 and IPv6 addresses within the \"anChargIpv4Addr\" and \"anChargIpv6Addr\" attributes respectively, the PCF may select, based on local configuration, one of the received addresses and report it within the Access-Network-Charging-Address AVP.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "E.12\t3GPP Access Network Information",
            "description": "The PCF provides the AF with the access network information as described in clause 4.4.1 by including the mapped RAT Type within the RAT-Type AVP according to Table E.2-1.\nIf the NetLoc is supported, the procedure described in clauses 4.4.4 and 4.4.6.7 shall apply with the exceptions specified in clause E.1 and with the exception of the user location information that is encoded as follows:\na)\tThe TAI and NCGI received over the N7 reference point in the \"tai\" attribute and \"ncgi\" attribute of the \"nrLocation\" attribute respectively, if available, are encoded in the 3GPP-User-Location AVP; or\nb)\tThe TAI and ECGI received over the N7 reference point in the \"tai\" attribute and \"ecgi\" attribute of the \"eutraLocation\" attribute respectively, if available, are encoded in the 3GPP-User-Location AVP.\n\n\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "",
                    "table number": 20,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "",
                    "table number": 21,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        }
    ]
}