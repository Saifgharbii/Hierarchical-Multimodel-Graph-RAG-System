{
    "document_name": "23288-i40.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document defines the Stage 2 architecture enhancements for 5G System (5GS) to support network data analytics services in 5G Core network.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[3]\t3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".\n[4]\t3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System; Stage 2\".\n[5]\tVoid.\n[6]\t3GPP TS 28.532: \"Management and orchestration; Generic management services\".\n[7]\t3GPP TS 28.550: \"Management and orchestration; Performance Assurance\".\n[8]\t3GPP TS 28.552: \"Management and orchestration; 5G performance measurements\".\n[9]\t3GPP TS 28.545: \"Management and orchestration; Fault Supervision (FS)\".\n[10]\t3GPP TS 28.554: \"Management and orchestration; 5G end to end Key Performance Indicators (KPI)\".\n[11]\tITU-T Recommendation P.1203.3: \"Parametric bitstream-based quality assessment of progressive download and adaptive audiovisual streaming services over reliable transport - Quality integration module\".\n[12]\t3GPP TS 38.215: \"NR; Physical layer measurements\".\n[13]\tVoid.\n[14]\t3GPP TS 38.331: \"NR; Radio Resource Control (RRC) protocol specification\".\n[15]\t3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA); Radio Resource Control (RRC); Protocol specification\".\n[16]\t3GPP TS 38.413: \"NG-RAN; NG Application Protocol (NGAP)\".\n[17]\t3GPP TS 29.244: \"Interface between the Control Plane and the User Plane Nodes\".\n[18]\t3GPP TS 29.510: \"5G System; Network function repository services; Stage 3\".\n[19]\t3GPP TS 28.533: \"Management and orchestration; Architecture framework\".\n[20]\t3GPP TS 37.320: \"Radio measurement collection for Minimization of Drive Tests (MDT); Overall description; stage 2\".\n[21]\t3GPP TS 28.201: \"Charging management; Network slice performance and analytics charging in the 5G System (5GS); stage 2\".\n[22]\t3GPP TS 28.541: \"Management and orchestration; 5G Network Resource Model (NRM); Stage 2 and stage 3\".\n[23]\t3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS); Stage 3\".\n[24]\t3GPP TS 28.310: \"Management and orchestration; Energy efficiency of 5G\".\n[25]\t3GPP TS 29.518: \"5G System; Access and Mobility Management Services; Stage 3\".\n[26]\t3GPP TS 29.503: \"Unified Data Management Services; Stage 3\".\n[27]\t3GPP TS 26.114: \"IP Multimedia Subsystem (IMS); Multimedia Telephony; Media handling and interaction\".\n[28]\t3GPP TS 26.247: \"Transparent end-to-end Packet-switched Streaming Service (PSS); Progressive Download and Dynamic Adaptive Streaming over HTTP (3GP-DASH)\".\n[29]\t3GPP TS 26.118: \"Virtual Reality (VR) profiles for streaming applications\".\n[30]\t3GPP TS 26.346: \"Multimedia Broadcast/Multicast Service (MBMS); Protocols and codecs\".\n[31]\t3GPP TS 26.512: \"5G Media Streaming (5GMS); Protocols\".\n[32]\t3GPP TS 26.531: \"Data Collection and Reporting; General Description and Architecture\".\n[33]\t3GPP TS 22.261: \"Service requirements for the 5G system; Stage 1\".\n[34]\t3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".\n[35]\t3GPP TS 22.071: \"Technical Specification Group Systems Aspects; Location Services (LCS)\".\n[36]\t3GPP TS 29.508: \"5G System; Session Management Event Exposure Service; Stage 3\".\n[37]\t3GPP TS 29.572: \"5G System; Location Management Services; Stage 3\".\n[38]\tGSMA TS.06: \"IMEI Allocation and Approval Process\".\n[39]\t3GPP TS 23.273: \"5G System (5GS) Location Services (LCS); Stage 2\".\n[40]\tITU-T Y.1540: \"Internet protocol data communication service - IP packet transfer and availability performance parameters\".\n[41]\t3GPP TS 28.622: \"Telecommunication management; Generic Network Resource Model (NRMs). Integration Reference Point (IRP): Information Service (IS)\".\n[42]\t3GPP TS 32.422: \"Subscriber and equipment trace: Trace control and configuration management\".\n[43]\t3GPP TS 26.532: \"Data Collection and Reporting; Protocols and Formats\".\n[44]\t3GPP TS 38.455: \"NG-RAN; NR Positioning Protocol A (NRPPa)\".\n[45]\t3GPP TS 28.104: \"Management and orchestration; Management Data Analytics (MDA)\".\n[46]\t3GPP TS 28.537: \"Management and orchestration; Management capabilities\".\n[47]\t3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".\n[48]\t3GPP TS 29.515: \"Gateway Mobile Location Services; Stage 3\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tDefinitions",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms and definitions given in TR 21.905 [1], TS 23.501 [2] and TS 23.503 [4]. A term defined in the present document takes precedence over the definition of the same term, if any, in TR 21.905 [1].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in TR 21.905 [1], TS 23.501 [2] and TS 23.503 [4] apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905 [1].\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tReference Architecture for Data Analytics",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The NWDAF (Network Data Analytics Function) is part of the architecture specified in TS 23.501 [2] and uses the mechanisms and interfaces specified for 5GC in TS 23.501 [2] and OAM services (see clause 6.2.3.1).\nThe NWDAF interacts with different entities for different purposes:\n-\tData collection based on subscription to events provided by AMF, SMF, UPF, PCF, UDM, NSACF, AF (directly or via NEF) and OAM;\n-\t[Optionally] Analytics and Data collection using the DCCF (Data Collection Coordination Function);\n-\tRetrieval of information from data repositories (e.g. UDR via UDM for subscriber-related information or via NEF(PFDF) for PFD information);\n-\tData collection of location information using LCS (finer granularity location information determined by LMF);\n-\t[Optionally] Storage and retrieval of information from ADRF (Analytics Data Repository Function);\n-\t[Optionally] Analytics and Data collection from MFAF (Messaging Framework Adaptor Function);\n-\tRetrieval of information about NFs (e.g. from NRF for NF-related information);\n-\tOn demand provision of analytics to consumers, as specified in clause 6.\n-\tProvision of bulked data related to Analytics ID(s).\n-\tProvision of Accuracy information about Analytics ID(s).\n-\tProvision of ML model accuracy information or ML model accuracy degradation about a ML Model.\nA single instance or multiple instances of NWDAF may be deployed in a PLMN. If multiple NWDAF instances are deployed, the architecture supports deploying the NWDAF as a central NF, as a collection of distributed NFs, or as a combination of both. If multiple NWDAF instances are deployed, an NWDAF can act as an aggregate point (i.e. Aggregator NWDAF) and collect analytics information from other NWDAFs, which may have different Serving Areas, to produce the aggregated analytics (per Analytics ID), possibly with Analytics generated by itself.\nNOTE 1:\tWhen multiple NWDAFs exist, not all of them need to be able to provide the same type of analytics results, i.e. some of them can be specialized in providing certain types of analytics. An Analytics ID information element is used to identify the type of supported analytics that NWDAF can generate.\nNOTE 2:\tNWDAF instance(s) can be collocated with a 5GS NF.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tNon-roaming architecture",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.2.0\tGeneral",
                            "text_content": "As depicted in Figure 4.2.0-1, the 5G System architecture allows NWDAF to collect data from any 5GC NF. The NWDAF belongs to the same PLMN as the 5GC NF that provides the data.\nThe figure depicts a data collection architecture from any 5G Core Network (5GC NF), illustrating the various components involved in data collection, including the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (5GC NF), the 5G Core Network (\nFigure 4.2.0-1: Data Collection architecture from any 5GC NF\nThe Nnf interface is defined for the NWDAF to request subscription to data delivery for a particular context, to cancel subscription to data delivery and to request a specific report of data for a particular context.\nThe 5G System architecture allows NWDAF to retrieve the management data from OAM by invoking OAM services.\nThe 5G System architecture allows NWDAF to collect data from any 5GC NF or OAM using a DCCF with associated Ndccf services as specified in clause 8.2.\nThe 5G System architecture allows NWDAF and DCCF to collect data from an NWDAF with associated Nnwdaf_DataManagement services as specified in clause 7.4. The 5G system architecture allows MFAF to fetch data from an NWDAF with associated Nnwdaf_DataManagement service as specified in clause 7.4.\nThe figure depicts a data collection architecture using Data Collection Coordination, illustrating the various components and their interconnections. The architecture includes Data Collection Coordination Points (DCCPs), Data Collection Points (DCPs), and Data Collection Routes (DCRs). The DCCPs are responsible for coordinating data collection, while the DCPs and DCRs are responsible for collecting data. The figure also shows the use of Data Collection Points (DCPs) and Data Collection Routes (DCRs) to ensure data collection efficiency and reliability.\nFigure 4.2.0-1a: Data Collection architecture using Data Collection Coordination\nAs depicted in Figure 4.2.0-1a, the Ndccf interface is defined for the NWDAF to support subscription request(s) for data delivery from a DCCF, to cancel subscription to data delivery and to request a specific report of data. If the data is not already being collected, the DCCF requests the data from the Data Source using Nnf services. The DCCF may collect the data and deliver it to the NWDAF or the DCCF may rely on a messaging framework to collect data from the NF and deliver it to the NWDAF.\nAs depicted in Figure 4.2.0-2, the 5G System architecture allows any 5GC NF to request network analytics information from NWDAF containing Analytics logical function (AnLF). The NWDAF belongs to the same PLMN as the 5GC NF that consumes the analytics information.\nThe given telecommunication figure, labeled as \"Figure 4.2.0 -2: Network Data Analytics Exposure architecture,\" depicts a detailed representation of the network data analytics exposure architecture. The figure illustrates the various components and their interconnections, highlighting the importance of network data analytics in modern telecommunications. Key components include the network data analytics platform, data analytics servers, and data analytics applications. The architecture is designed to ensure data security and privacy, with data encryption and access controls in place. The figure also highlights the importance of network data analytics in enabling real-time decision-making and optimizing network performance.\nFigure 4.2.0-2: Network Data Analytics Exposure architecture\nThe Nnwdaf interface is defined for 5GC NFs, to request subscription to network analytics delivery for a particular context, to cancel subscription to network analytics delivery and to request a specific report of network analytics for a particular context.\nNOTE 1:\tThe 5G System architecture also allows other consumers such as OAM and CEF (Charging Enablement Function) to request network analytics information from NWDAF.\nThe 5G System architecture allows any NF to obtain Analytics from an NWDAF using a DCCF function with associated Ndccf services, as specified in clause 8.2.\nThe 5G System architecture allows NWDAF and DCCF to request historical analytics from an NWDAF with associated Nnwdaf_DataManagement services as specified in clause 7.4. The 5G system architecture allows MFAF to fetch historical analytics from an NWDAF with associated Nnwdaf_DataManagement service as specified in clause 7.4.\nThe given telecommunication figure, labeled as \"Figure 4.2.0-2a: Network Data Analytics Exposure architecture using Data Collection Coordination,\" depicts a network data analytics exposure architecture. This figure illustrates the various components and their interactions within the network data analytics process. The architecture includes data collection coordination, data collection, data processing, data storage, and data analysis. The figure highlights the importance of data collection coordination to ensure data quality and consistency, and the role of data processing in transforming raw data into actionable insights. The figure also emphasizes the importance of data storage to store and manage the collected data, and the role of data analysis in interpreting and interpreting the insights gained from the data. Overall, the figure provides a comprehensive overview of the network data analytics exposure architecture, highlighting the key components and their interdependencies.\nFigure 4.2.0-2a: Network Data Analytics Exposure architecture using Data Collection Coordination\nAs depicted in Figure 4.2.0-2a, the Ndccf interface is defined for any NF to support subscription request(s) to network analytics, to cancel subscription for network analytics and to request a specific report of network analytics. If the analytics is not already being collected, the DCCF requests the analytics from the NWDAF using Nnwdaf services. The DCCF may collect the analytics and deliver it to the NF, or the DCCF may rely on a messaging framework to collect analytics and deliver it to the NF.\nAs depicted in Figure 4.2.0-3, the 5G System architecture allows NWDAF containing Analytics logical function (AnLF) to use trained ML model provisioning services from another NWDAF containing Model Training logical function (MTLF).\nNOTE 2:\tAnalytics logical function and Model Training logical function are described in clause 5.1.\nThe figure depicts a detailed architecture of a machine learning model provisioning system, illustrating the various components and their interconnections. The system includes a data storage system, a model training pipeline, and a model deployment pipeline, all interconnected through a network of servers and storage devices. The system is designed to be scalable and efficient, with a focus on data security and privacy.\nFigure 4.2.0-3: Trained ML Model Provisioning architecture\nThe Nnwdaf interface is used by an NWDAF containing AnLF to request and subscribe to trained ML model provisioning services.\nNOTE 3:\tThe NWDAF trained ML model provisioning services are described in clause 7.5 and clause 7.6.\nNOTE 4:\tThe NWDAF containing AnLF is the only consumer of trained ML model provisioning services in this release of the specification.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.1\tAnalytics Data Repository Function",
                            "text_content": "As depicted in Figure 4.2.1-1, the 5G System architecture allows ADRF to store and retrieve the collected data and analytics. The following options are supported:\n-\tADRF exposes the Nadrf service for storage and retrieval of data by other 5GC NFs (e.g. NWDAF) which access the data using Nadrf services.\n-\tBased on the NF request or configuration on the DCCF, the DCCF may determine the ADRF and interact directly or indirectly with the ADRF to request or store data. The interaction can be:\n-\tDirect: the DCCF requests to store data in the ADRF via an Nadrf service, or via an Ndccf_DataManagement_Notify (e.g. when ADRF requested data collection notification via DCCF). In addition, the DCCF retrieves data from the ADRF via an Nadrf service.\n-\tIndirect: the DCCF requests that the Messaging Framework to store data in the ADRF i.e. via an Nadrf service or via an Nmfaf_3daDataManagement_Configure. The Messaging Framework may contain one or more Adaptors that translate between 3GPP defined protocols.\nNOTE 1:\tThe internal logic of Messaging Framework is outside the scope of 3GPP, only the MFAF and the interface between MFAF and other 3GPP defined NF is under 3GPP scope.\n-\tA Consumer NF may specify in requests to a DCCF that data provided by a Data Source needs to be stored in the ADRF.\n-\tThe ADRF stores data received in an Nadrf_DataManagement_StorageRequest sent directly from an NF, or data received in an Ndccf_DataManagement_Notify / Nmfaf_3caDataManagement_Notify or Nnwdaf_DataManagement_Notify from the DCCF, MFAF or from the NWDAF.\n-\tThe ADRF checks if the Data Consumer is authorized to access ADRF services and provides the requested data using the procedures specified in clause 7.1.4 of TS 23.501 [2].\nThe figure depicts a data storage architecture for analytics and collected data, illustrating the various components and their roles in the data management system. The architecture includes a central data storage server, a data processing server, and a data visualization server, all interconnected through a network of data storage nodes. The data storage server is responsible for storing raw data, while the data processing server processes and analyzes the data, and the data visualization server displays the results in a user-friendly format. The architecture is designed to be scalable and flexible, allowing for easy expansion and modification as the needs of the organization change.\nFigure 4.2.1-1: Data storage architecture for Analytics and Collected Data\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.3\tRoaming architecture",
                    "description": "",
                    "summary": "",
                    "text_content": "Based on operator's policy and local regulations (e.g. privacy), data or analytics may be exchanged between PLMNs (i.e. HPLMN and VPLMN). In a PLMN, an NWDAF is used as exchange point to exchange analytics and to collect input data for analytics with other PLMNs. The NWDAF with roaming exchange capability is called Roaming Exchange NWDAF (RE-NWDAF).\nThe figure depicts a roaming architecture for exchanging input data or data analytics between V-PLMN and H-PLMN. It illustrates the various components involved in the roaming process, including the V-PLMN, H-PLMN, and the data exchange between them. The figure highlights the importance of network virtualization and SDN principles in enabling efficient data exchange and network management.\nFigure 4.3-1: Roaming Architecture to exchange Input Data or Data Analytics between V-PLMN and H-PLMN\nUsing the architecture shown in Figure 4.3-1:\n-\tFor outbound roaming users, the NF consumer in the HPLMN can retrieve analytics from the VPLMN via the H-RE-NWDAF in HPLMN and V-RE-NWDAF in VPLMN.\nNOTE 1:\tThe analytics from the VPLMN may be generated by the V-RE-NWDAF in the VPLMN or by other NWDAFs in the VPLMN.\n-\tFor outbound roaming users, the H-RE-NWDAF in HPLMN can collect data from the VPLMN via V-RE-NWDAF in VPLMN.\n-\tFor inbound roaming users, the NF consumer in the VPLMN can retrieve analytics from the HPLMN via V-RE-NWDAF in VPLMN and H-RE-NWDAF in HPLMN.\nNOTE 2:\tThe analytics from the HPLMN may be generated by H-RE-NWDAF in the HPLMN or other NWDAFs in the HPLMN.\n-\tFor inbound roaming users, the V-RE-NWDAF can collect data from the HPLMN via the H-RE-NWDAF.\nNOTE 3:\tBoth local breakout and home routed roaming architectures support the data or analytics exchanging between PLMNs.\nNOTE 4:\tInteractions between RE-NWDAFs of different PLMNs may be via SEPPs, which are not depicted in the architecture for the sake of clarity.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5\tNetwork Data Analytics Functional Description",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The NWDAF provides analytics to 5GC NFs and OAM as defined in clause 7. An NWDAF may contain the following logical functions:\n-\tAnalytics logical function (AnLF): A logical function in NWDAF, which performs inference, derives analytics information (i.e. derives statistics and/or predictions based on Analytics Consumer request) and exposes analytics service i.e. Nnwdaf_AnalyticsSubscription or Nnwdaf_AnalyticsInfo.\n-\tModel Training logical function (MTLF): A logical function in NWDAF, which trains Machine Learning (ML) models and exposes new training services (e.g. providing trained ML model) as defined in clause 7.5 and clause 7.6.\nNOTE 1:\tNWDAF can contain an MTLF or an AnLF or both logical functions.\nNOTE 2:\tPre-trained ML model storage and provisioning to NWDAF is out of the scope of 3GPP.\nAnalytics information are either statistical information of the past events, or predictive information.\nDifferent NWDAF instances may be present in the 5GC, with possible specializations per type of analytics. The capabilities of a NWDAF instance are described in the NWDAF profile stored in the NRF.\nTo guarantee the accuracy of analytics output for an Analytics ID, based on the UE abnormal behaviour analytics from itself or other NWDAF including abnormal UE list and the observed time window, the NWDAF is to detect and may delete the input data from the abnormal UE(s) and then may generate a new ML model and/or analytics outputs for the Analytics ID without the input data related to abnormal UE list during the observed time window and then send/update the ML Model Information and/or analytics outputs to the subscribed NWDAF service consumer.\nIn order to support NFs to discover and select an NWDAF instance containing MTLF, AnLF, or both, that is able to provide the required service (e.g. analytics exposure or ML model provisioning) for the required type of analytics, each NWDAF instance should provide the list of supported Analytics ID(s) (possibly per supported service) when registering to the NRF, in addition to other NRF registration elements of the NF profile. NFs requiring the discovery of an NWDAF instance that provides support for some specific service(s) for a specific type of analytics may query the NRF for NWDAFs supporting the required service(s) and the required Analytics ID(s).\nThe consumers, i.e. 5GC NFs and OAM, decide how to use the data analytics provided by NWDAF.\nThe interactions between 5GC NF(s) and the NWDAF take place within a PLMN.\nThe NWDAF has no knowledge about NF application logic. The NWDAF may use subscription data but only for statistical purpose.\nThe NWDAF architecture allows for arranging multiple NWDAF instances in a hierarchy/tree with a flexible number of layers/branches. The number and organisation of the hierarchy layers, as well as the capabilities of each NWDAF instance remain deployment choices.\nIn a hierarchical deployment, NWDAFs may provide data collection exposure capability for generating analytics based on the data collected by other NWDAFs, when DCCF, MFAF are not present in the network.\nIn order to make NWDAF discoverable in some network deployments, NWDAF may be configured (e.g. for UE mobility analytics) to register in UDM (Nudm_UECM_Registration service operation) for the UE(s) it is serving and for the related Analytics ID(s). Registration in UDM should take place at the time the NWDAF starts serving the UE(s) or collecting data for the UE(s). Deregistration in UDM takes place when NWDAF deletes the analytics context for the UE(s) (see clause 6.1B.4) for a related Analytics ID.\nNOTE 3:\tThe procedures for data collection for UE related analytics need to take user consent into account. The user consent for analytics is defined in clause 6.2.9.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.2\tNWDAF Discovery and Selection",
                    "description": "",
                    "summary": "",
                    "text_content": "The NWDAF service consumer selects an NWDAF that supports requested analytics information and required analytics capabilities and/or requested ML Model Information by using the NWDAF discovery principles defined in clause 6.3.13 of TS 23.501 [2].\nDifferent deployments may require different discovery and selection parameters. Different ways to perform discovery and selection mechanisms depend on different types of analytics/data (NF related analytics/data and UE related analytics/data). NF related refers to analytics/data that do not require a SUPI nor group of SUPIs (e.g. NF load analytics). UE related refers to analytics/data that requires SUPI or group of SUPIs (e.g. UE mobility analytics).\nIn order to discover an NWDAF containing AnLF using the NRF:\n-\tIf the analytics is related to NF(s) and the NWDAF service consumer (other than an NWDAF) cannot provide an Area of Interest for the requested data analytics, the NWDAF service consumer may select an NWDAF with large serving area from the candidate NWDAFs from discovery response. Alternatively, in case the consumer receives NWDAF(s) with aggregation capability, the consumer preferably selects an NWDAF with aggregation capability with large serving area.\nNOTE 1:\tIf the selected NWDAF cannot provide the requested data analytics, e.g. due to the NF(s) to be contacted being out of serving area of the NWDAF, the selected NWDAF might reject the analytics request/subscription or it might query the NRF with the service area of the NF to be contacted to determine another target NWDAF.\n-\tIf the analytics is related to UE(s) and the NWDAF service consumer (other than an NWDAF) cannot provide an Area of Interest for the requested data analytics, the NWDAF service consumer may select an NWDAF with large serving area from the candidate NWDAFs from discovery response. Alternatively, in case the consumer receives NWDAF(s) with aggregation capability, the consumer preferably selects an NWDAF with aggregation capability with large serving area.\nNOTE 2:\tIf a selected NWDAF cannot provide analytics for the requested UE(s) (e.g. the NWDAF serves a different serving area), the selected NWDAF might reject the analytics request/subscription or it might determine the AMF serving the UE as specified in clause 6.2.2.1, request UE location information from the AMF and query the NRF with the tracking area where the UE is located to discover another target NWDAF serving the area where the UE(s) is located.\n-\tIf the analytics are related to UE(s) and if NWDAF instances indicate weights for TAIs in their profile (see clause 6.3.13 of TS 23.501 [2]), the NWDAF service consumer may use the weights for TAIs to decide which NWDAF to select.\n-\tIf the NWDAF service consumer needs to discover an NWDAF containing an AnLF with Accuracy checking capability, the consumer may query NRF providing also the accuracy checking capability in the discovery request.\nIf the NWDAF service consumer needs to discover an NWDAF that is able to collect data from particular data sources identified by their NF Set IDs or NF types, the consumer may query NRF providing the NF Set IDs or NF types in the discovery request.\nNOTE 3:\tThe NF Set ID or NF Type of a data source serving a particular UE, can be determined as indicated in Table 5A.2-1.\nIn order to discover an NWDAF that has registered in UDM for a given UE:\n-\tNWDAF service consumers or other NWDAFs interested in UE related data or analytics, if supported, may make a query to UDM to discover an NWDAF instance that is already serving the given UE.\nIf an NWDAF service consumer needs to discover NWDAFs with data collection exposure capability, the NWDAF service consumer may discover via NRF the NWDAF(s) that provide the Nnwdaf_DataManagement service and their associated NF type of data sources or their associated NF Set ID of data sources as defined in clause 6.3.13 of TS 23.501 [2].\nIn order to discover an NWDAF containing MTLF via NRF:\n-\tan NWDAF containing MTLF shall include the ML model provisioning services (i.e. Nnwdaf_MLModelProvision, Nnwdaf_MLModelInfo) as one of the supported services during the registration in NRF when trained ML models are available for one or more Analytics ID(s). The NWDAF containing MTLF may provide to the NRF a (list of) Analytics ID(s) corresponding to the trained ML models and possibly the ML Model Filter Information for the trained ML model per Analytics ID(s), if available. In this Release of the specification, only the S-NSSAI(s) and Area(s) of Interest from the ML Model Filter Information for the trained ML model per Analytics ID(s) may be registered into the NRF during the NWDAF containing MTLF registration. For each Analytics ID, if the NWDAF containing MTLF supports ML Model interoperability, the NWDAF containing MTLF may also include, in the registration to the NRF, an ML Model Interoperability indicator.\n-\tThe ML Model Interoperability indicator comprises a list of NWDAF providers (vendors) that are allowed to retrieve ML models from this NWDAF containing MTLF. It also indicates that the NWDAF containing MTLF supports the interoperable ML models requested by the NWDAFs from the vendors in the list.\nNOTE 4:\tThe S-NSSAI(s) and Area(s) of Interest from the ML Model Filter Information are within the indicated S-NSSAI and NWDAF Serving Area information in the NF profile of the NWDAF containing MTLF, respectively.\n-\tDuring the discovery of NWDAF containing MTLF, a consumer (i.e. an NWDAF containing AnLF) may include in the request the target NF type (i.e. NWDAF), the Analytics ID(s), the S-NSSAI(s), Area(s) of Interest of the Trained ML Model required, ML Model Interoperability indicator and NF consumer information. The NRF returns one or more candidate instances of NWDAF containing MTLF to the NF consumer and each candidate instance of NWDAF containing MTLF includes the Analytics ID(s), possibly the ML Model Filter Information for the available trained ML models and ML Model Interoperability indicator, if available.\nNOTE 5:\tNF consumer information such as Vendor ID is defined in stage 3.\n-\tIf the NWDAF service consumer needs to discover an NWDAF containing an MTLF with accuracy checking capability, the consumer may query NRF also providing the accuracy checking capability in the discovery request.\nIn order to discover an NWDAF containing MTLF with Federated Learning (FL) capability via NRF:\n- An NWDAF containing MTLF supporting FL as a server shall additionally include FL capability type (i.e. FL server), Time interval supporting FL as FL capability information during the registration in NRF.\n-\tAn NWDAF containing MTLF supporting FL as a client shall additionally include FL capability type (i.e. FL client), Time interval supporting FL as FL capability information during the registration in NRF, and it may also include, NF type(s) where data can be collected as input for local model training.\nNOTE 6:\tAn NWDAF containing MTLF may indicate to support both FL server and FL client in the FL capability for specific Analytics ID.\n-\tDuring the discovery of NWDAF containing MTLF as FL server, a consumer (e.g. a NWDAF containing MTLF) includes in the request the FL capability type as FL server, Time Period of Interest and ML model Filter information for the trained ML model(s) per Analytics ID(s), if available. The NRF returns one or more candidate instances of NWDAF containing MTLF as FL server to the consumer.\n-\tDuring the discovery of NWDAF containing MTLF as FL client, a consumer (e.g. an FL server) includes in the request FL capability type as FL client, Time Period of Interest, a list of NF type(s). The NRF returns one or more candidate instances of NWDAF containing MTLF as FL client to the consumer.\nNOTE 7:\tThe service consumer to discover an NWDAF containing MTLF with FL capability is limited to NWDAF containing MTLF in this Release.\nA PCF may learn which NWDAFs being used by AMF, SMF and UPF for a specific UE, via signalling described in clause 4.16 of TS 23.502 [3]. This enables a PCF to select the same NWDAF instance that is already being used for a specific UE.\nIn the roaming architecture, the NWDAF with roaming exchange capability (RE-NWDAF) to request analytics or input data is discovered via the NRF. A consumer in the same PLMN as the RE-NWDAF discovers the RE-NWDAF by querying for an NWDAF where the roaming exchange capability is indicated in its NRF profile. A consumer in a peer PLMN (i.e. RE-NWDAF) discovers the RE-NWDAF by querying for an NWDAF in the target PLMN that is supporting the specific services defined for roaming. A RE-NWDAF discovers the RE-NWDAF in a different PLMN (i.e. HPLMN or VPLMN) using the procedure defined in clause 4.17.5 (if delegated discovery is not used) or clause 4.17.10 (if delegated discovery is used) of TS 23.502 [3], where the detailed parameters are determined based on the analytics request or subscription from the consumer 5GC NF, operator policy, user consent and/or local configuration.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.3\tFederated Learning (FL) among multiple NWDAFs",
                    "description": "",
                    "summary": "",
                    "text_content": "Federated learning among multiple NWDAFs is a machine learning technique in core network that trains an ML Model across multiple decentralized entities holding local data set, without exchanging/sharing local data set. This approach stands in contrast to traditional centralized machine learning techniques where all the local datasets are uploaded to one server, thus allowing to address critical issues such as data privacy, data security, data access rights.\nNOTE 1:\tHorizontal Federated Learning is supported among multiple NWDAFs, which means the local data set in different FL client NWDAFs have the same feature space for different samples (e.g. UE IDs).\nFor Federated Learning supported by multiple NWDAFs containing MTLF, there is one NWDAF containing MTLF acting as FL server (called FL server NWDAF for short) and multiple NWDAFs containing MTLF acting as FL client (called FL client NWDAF for short), the main functionality includes:\nFL server NWDAF:\n-\tdiscovers and selects FL client NWDAFs to participant in an FL procedure\n-\trequests FL client NWDAFs to do local model training and to report local model information.\n-\tgenerates global ML model by aggregating local model information from FL client NWDAFs.\n-\tsends the global ML model back to FL client NWDAFs and repeats training iteration if needed.\nFL client NWDAF:\n-\tlocally trains ML model that tasked by the FL server NWDAF with the available local data set, which includes the data that is not allowed to share with others due to e.g. data privacy, data security, data access rights.\n-\treports the trained local ML model information to the FL server NWDAF.\n-\treceives the global ML model feedback from FL server NWDAF and repeats training iteration if needed.\nFL server NWDAF or FL client NWDAF register to NRF with their FL capability information as described in clause 5.2.\nThe NWDAF containing MTLF determines to train an ML model either based on local configuration or when it receives the request from NWDAF containing AnLF. The NWDAF containing MTLF further determines whether the ML model should be trained via FL mechanism based on Analytic ID, Service Area/DNAI or data can not be obtained directly from data producer NF (e.g. due to data privacy, data security). The NWDAF containing AnLF is not aware whether the ML model is trained based on FL or not.\nIf the NWDAF containing MTLF can act as an FL server for the ML model training, then FL procedure is initiated by the NWDAF containing MTLF as FL server NWDAF directly.\nIf the NWDAF containing MTLF determines to train an ML model based on local configuration and the FL mechanism is required, but the NWDAF containing MTLF can't act as an FL server, the NWDAF containing MTLF should discover an FL server NWDAF as described in clause 5.2 and request the FL server NWDAF to provide the trained ML model as described in clause 6.2C.2.2. The FL server NWDAF may determine to initiate FL procedure before providing the ML model.\nIf the ML model training is triggered by the request from NWDAF containing AnLF, the NWDAF containing MTLF determines the FL mechanism is required but it can not act as an FL server, the NWDAF containing MTLF should discover an FL server NWDAF as described in clause 5.2 and request the FL server NWDAF to provide the trained ML model as described in clause 6.2C.2.2. The Notification endpoint of the NWDAF containing AnLF is provided in the request message sent to the FL server NWDAF. The FL server NWDAF may determine to initiate FL procedure before providing the ML model. The FL server NWDAF sends the ML model information to the notification endpoint (e.g. the NWDAF containing AnLF) after the ML model training success.\nNOTE 2:\tHow to authorize an MTLF to request ML models on behalf of an AnLF to another MTLF (e.g., FL server NWDAF) is up to SA WG3.\nBefore FL procedure is initiated by FL server NWDAF, appropriate FL client NWDAFs should be discovered by FL server NWDAF as described in clause 5.2.\nWhen starting an FL procedure, the FL server NWDAF is to provide an initial model to each FL client NWDAF, and then each FL client NWDAF is to perform local model training using their local data set. The detailed procedure for FL among Multiple NWDAFs is described in clause 6.2C.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5A\tData Collection Coordination and Delivery Functional Description",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5A.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Data Collection Coordination and Delivery coordinates the collection and distribution of data requested by NF consumers. It prevents data sources from having to handle multiple subscriptions for the same data and send multiple notifications containing the same information due to uncoordinated requests from data consumers.\nData Collection Coordination and Delivery is supported by a DCCF via Ndccf_DataManagement service or by an NWDAF via Nnwdaf_DataManagement service. Unless otherwise stated, capabilities specified in clause 5A for a DCCF are also applicable to an NWDAF.\nIn this Release of the specification Data Collection Coordination and Delivery is applicable to:\n-\tNWDAFs that request data from a Data Source (e.g. for use in computing analytics).\n-\tNF consumers that request analytics from an NWDAF Data Source.\n-\tNF consumers that request data from an ADRF Data Source.\n-\tADRFs that receive data from an NF Data Source.\nNOTE:\tNnwdaf_DataManagement service can be used to collect historical data or runtime data. For collecting historical and runtime analytics, Nnwdaf_AnalyticsSubscription service is used.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5A.2\tData Collection Coordination",
                    "description": "",
                    "summary": "",
                    "text_content": "Data Collection Coordination is supported by a DCCF or an NWDAF. The Data Consumer may use an NRF to perform NF discovery and selection to find a DCCF that can coordinate data collection (DCCF discovery principles are defined in clause 6.3.19 of TS 23.501 [2]). Data Consumers send requests for data to the DCCF rather than directly to the NF Data Source. Whether the data consumers directly contact the NF Data Source or goes via the DCCF is based on configuration of the data consumers. For the Data Consumer and each notification endpoint in a data request, the Data Consumer may specify Formatting and Processing Instructions that determine how the data is to be provided. Upon receiving a request from a Data Consumer, the selected DCCF determines the NF instance that can be a Data Source if the Data Source is not indicated in the Data Consumer's request. The DCCF may also select an ADRF if the data is to be stored in an ADRF and an ADRF endpoint is not indicated in the Data Consumer's request. To retrieve data for a specific UE, the NRF, UDM or BSF can provide the DCCF with the identity of the Data Source using the services indicated in table 5A.2-1.\nTable 5A.2-1: NF Services consumed by DCCF or NWDAF to determine which NF instances are serving a UE\n\nThe DCCF keeps track of the data actively being collected from the Data Sources it is coordinating. It may do so by maintaining a record of the active prior requests it sends to each Data Source. If a NWDAF subscribes for data directly with a Data Source, or a Data Source has stored data in an ADRF, the NWDAF or ADRF may register the data collection profile with the DCCF. The data collection profile may include the following parameters:\n-\t\"Service Operation\" identifies the service used to collect the data or analytics from a Data Source (e.g. Namf_EventExposure_Subscribe or Nnwdaf_AnalyticsSubscription_Subscribe);\n-\t\"Analytics/Data Specification\" is the \"Service Operation\" specific parameters that identify the collected data (i.e. Analytics ID(s) / Event ID (s), Target of Analytics Reporting or Target of Event Reporting, Analytics Filter or Event Filter, etc.);\n-\tNWDAF ID or ADRF ID specifies the ADRF or NWDAF which registers data collection profile.\nThe DCCF may then determine certain historical data may be available in the NWDAF or ADRF and coordinate collection of data from the NWDAF or ADRF based on the data collection profile.\nWhen the DCCF receives a request for data, it determines the status of data collection from the Data Source. If parameters in a request for data from a Data Consumer match those in a prior request or in a data collection profile registration, the DCCF may determine that the requested data is already being collected from a Data Source or that a prior subscription to a Data Source may be modified to in addition satisfy the requirements of the new data request from a Data Consumer. This status is used in clause 5A.3 to deliver data to the Data Consumer and notification endpoints.\nFor persisting event exposure subscriptions for long-lived data collection, the DCCF may subscribe to the UDM to receive event notifications even if a Data Source that serves a UE changes.\nThe DCCF may subscribe to the NRF to receive event notifications if a Data Source changes (e.g. because of a NF life-cycle event).\nNOTE:\tA DCCF can support multiple Data Sources, Data Consumers and Message Frameworks. However, to avoid duplicate data collection, each Data Source NF or Set of Data Source NF should be associated with only one DCCF instance or DCCF Set.\nA DCCF may use the same mechanisms described in clause 6.2.2.1 to determine AMF and SMF to retrieve data related to \"any UE\".\nIf the data consumer requests to collect data for any UE in an area of interest, the data consumer shall first determine all DCCFs covering the area of interest and then contact these DCCFs to request for data collection.\n",
                    "tables": [
                        {
                            "description": "Table 5A.2-1: NF Services consumed by DCCF or NWDAF to determine which NF instances are serving a UE",
                            "table number": 3,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5A.3\tData Delivery",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5A.3.0\tGeneral",
                            "text_content": "Data is provided to Consumers or notification endpoints according to the Delivery Option configured on the DCCF or NWDAF. Delivery Options are:\n1.\tDelivery via DCCF or NWDAF: Consumers or Notification Endpoints receive the data from the DCCF or NWDAF.\n2.\tDelivery via Messaging Framework: Consumers or Notification Endpoints receive the data from the Messaging Framework via the services offered by the MFAF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5A.3.1\tData Delivery via the DCCF or NWDAF",
                            "text_content": "The figure depicts a simplified representation of data delivery through a Distributed Cognitive Computing (DCCF) network. It illustrates the various data paths and their respective data delivery mechanisms, such as DCCF, DCCF-A, and DCCF-B, which are used to ensure efficient and reliable data transmission. The figure also highlights the use of optical fibers and optical line terminals (OLTs) to facilitate data transmission.\nFigure 5A.3.1-1: Data Delivery via DCCF\nData Delivery via DCCF is shown in Figure 5A.3.1-1. Each Event Notification received from a Data Source NF is sent to the DCCF which propagates it to all Data Consumers / Notification Endpoints specified by the Data Consumers or determined by the DCCF. Each Data Consumer may specify in its request to the DCCF multiple notification endpoints, which may include the requesting Data Consumer, an ADRF or other NFs. The DCCF may also select an ADRF or other notification endpoint based on configuration. The DCCF supports formatting and processing for each Consumer / notification endpoint so notifications comply with the data requests received from each Consumer NF.\nUpon the DCCF determining the status of data collection for a data request (see clause 5A.2):\n-\tIf the requested data is not already being collected from a Data Source, the DCCF sends a new subscription/request towards the Data Source with the notification target specified as the DCCF.\n-\tIf the requested data is partially covered by existing subscriptions with the Data Source, the DCCF sends to the existing Data Source a request to modify the subscription and/or creates new subscription(s) to new Data Source for the newly requested data which cannot be provided by the current Data Source.\n-\tIf the requested data is already being collected from the Data Source, the DCCF determines that no subscriptions to the Data Source need to be created or modified.\nWhen notifications are received by the DCCF, they are processed according to the Formatting and Processing Instructions for each Consumer and notification endpoint. The DCCF subsequently sends notifications to Consumers and notification endpoints via a Ndccf_DataManagement service.\nThe same functionality as described above applies for Data Delivery and bulked data collection via NWDAF with Nnwdaf services replacing corresponding Ndccf services.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5A.3.2\tData Delivery via a Messaging Framework",
                            "text_content": "The figure depicts a messaging framework in a telecommunications network, illustrating the various data delivery methods used. The framework includes a messaging server, a messaging client, and a messaging queue, all interconnected through a messaging protocol. The figure highlights the use of message headers, message body, and message routing, demonstrating the complexity and interdependence of the system.\nFigure 5A.3.2-1: Data Delivery via a Messaging Framework\nData Delivery via a Messaging Framework is shown in figure 5A.3.2-1. The Messaging Framework formats and processes data received from the Data Source NF and sends notifications to all Data Consumers and Notification Endpoints specified by Data Consumers or determined by the DCCF. Each Data Consumer may specify in its request to the DCCF multiple notification endpoints, which may include the requesting Data Consumer, an ADRF or other NFs. The DCCF may also select an ADRF or other notification endpoint based on configuration. While the Messaging Framework is not standardized by 3GPP, a Messaging Framework Adaptor NF (MFAF) offers 3GPP defined services that allow the 5GS to interact with the Messaging Framework. Internally, the Messaging Framework may for example support the pub-sub pattern, where received data are published to the Messaging Framework and requests from 3GPP Consumers result in Messaging Framework specific subscriptions. Alternatively, the Messaging Framework may support other protocols outside of the scope of 3GPP.\nThe Messaging Framework Adaptor NF offers services that enable the 5GS to interact with the Messaging Framework:\n-\t3GPP Consumer Adaptor (3CA) Data Management Service: Nmfaf_3caDataManagement Service delivers data to each Data Consumer or notification endpoint after formatting and processing of data received by the Messaging Framework.\n-\t3GPP DCCF Adaptor (3DA) Data Management Service: Nmfaf_3daDataManagement Service enables the DCCF to convey to the Messaging Framework, information about the data the Messaging Framework will receive from a Data Source, formatting and processing instructions and the Data Consumer and notification endpoints.\nUpon the DCCF determining the status of data collection for a data request (see clause 5A.2):\n-\tIf the requested data is not currently being collected from a Data Source, the DCCF sends a new subscription/request towards the Data Source with the notification target specified as the Messaging Framework.\n-\tIf the requested data is partially covered by existing subscriptions with the Data Source, the DCCF sends a request to the Data Source to modify one or more subscriptions to accommodate both the previous requests for data and the new request for data and/or creates new subscription(s) to new Data Source for the newly requested data which cannot be provided by the current Data Source.\n-\tIf the requested data is already being collected from the Data Source, the DCCF determines that no subscriptions to the Data Source need to be created or modified.\nNOTE:\tThe internal logic of DCCF, e.g. how it decides on what modifications to do, is not specified.\n-\tThe DCCF uses the Nmfaf_3daData Management service to convey information so:\n1.\tthe Messaging Framework can recognize data that are received from a Data Source.\n2.\tthe MFAF can obtain data received by the Messaging Framework, process and format the data according to processing and formatting instructions for each Consumer / notification endpoint and send notifications or responses to the Data Consumers.\nWhen data are received by the Messaging Framework (e.g. because of an event notification) they are processed according the Formatting and Processing Instructions for each Consumer / notification endpoint before notifications are sent to the Data Consumer or Notification Endpoints. Notifications sent via the Nmfaf_3caDataManagement service have the same content as those sent via a Ndccf_DataManagement service for Data Delivery via the DCCF.\nThe same functionality as described above applies for Data Delivery and bulk data collection via NWDAF with Nnwdaf services replacing corresponding Ndccf services.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5A.4\tData Formatting and Processing",
                    "description": "",
                    "summary": "",
                    "text_content": "Formatting and/or Processing instructions may be provided in requests by Data Consumers via the Ndccf_DataManagement service and Nnwdaf_DataManagement service. As an alternative to providing individual events, formatting can be used to aggregate notifications and processing can be used to extract and send summary information from multiple notifications. Data Formatting and Processing are applicable to notifications due to events as they occur at data sources (runtime data or analytics) and historical data as described in clause 5A.5.\nWhen using the Messaging Framework, the DCCF sends the formatting and/or processing instructions to the Messaging Framework via the Nmfaf_3daData_Management Service so the MFAF may format and/or process the data before sending notifications to the Data Consumers / notification endpoints. When using Data Delivery via the DCCF, the DCCF performs formatting and/or processing before sending notifications.\nFormatting determines when a notification is sent to the Consumer. Formatting Instructions may indicate:\n-\tNotification Event clubbing: Buffering and sending of several notifications in one message. The consumer may specify a minimum and/or maximum number of notifications to be clubbed.\n-\tNotification Time Window (example: notifications are buffered and sent between 2 and 3 AM).\n-\tCross event reference-based notification: When a subscribing NF is subscribing to multiple events (e.g. event X and event Y) the notification for an Event-X is buffered and reported only when the Event-Y occurs.\n-\tConsumer triggered Notification: Notifications containing data or analytics are buffered until the consumer requests delivery using Nnwdaf_DataManagement, Ndccf_DataManagement or Nmfaf_3caDataManagement Service. The consumer requests Consumer triggered notification by setting a \"fetch flag\" in its subscription request to the DCCF or NWDAF. When the requested data or analytics is available for retrieval, the DCCF, NWDAF or MFAF sends a notification containing fetch instructions to the consumer. The consumer must then fetch the data or analytics before an expiry time as provided in the fetch instructions.\nNOTE:\tWhen this indication is set by the consumer, DCCF, NWDAF or MFAF notifications to the consumer contain Fetch Instructions (see clauses 8.2.4, 7.4.4 and 9.3.2).\n-\tExact time-based Notification: Notifications are sent to the Consumer at an exact time, irrespective of whether the event occurs (example: every 30 min). Exact time-based notifications may be periodic.\n-\tIncreasing time window based notification: Notifications are sent to the Consumer at an increasing periodicity (example: the first notification is sent immediately, subsequent received notifications are sent after 5 min, then after 10 min, then after 15 min, etc.).\nFor an ADRF endpoint, Formatting Instructions sent to the messaging framework may further specify whether Nmfaf services are used to deliver notifications to an ADRF, or whether the data are sent to the ADRF using a Nadrf service.\nProcessing instructions allow summarizing of notifications to reduce the volume of data reported to the Data Consumer. The processing results in summarizing of information from multiple notifications into a common report. Processing of data for inclusion in each notification sent to consumers occurs over a Processing Interval specified in the Processing Instructions. Notifications sent to consumers may represent partial intervals if formatting instructions or Event Reporting Information (as specified in TS 23.502 [3] table 4.15.1.1-1) require that a notification be sent to the consumer before the end of a processing interval. Processing Instructions are provided per Event ID or Analytics ID and are applied to multiple notifications that result from the same subscription and for the same Event ID or Analytics ID. Processing Instructions, in addition to the Processing Interval, may specify the parameter names, parameter values and the attributes to be determined and reported to the Consumer. Processing Instructions may also specify aggregation level (e.g. per-UEs, per AoIs) or temporal aggregation (e.g. per minute, per hour). The processed notifications may comprise the following depending on the Event and Processing Instructions:\n-\tEvent;\n-\tProcessing Interval;\n-\tList of Event Parameter Name(s) and for each Event Parameter Name, one Event Parameter Values and sets of the following attributes as indicated in the processing instructions:\n-\tEvent Spacing: Average and variance of the time interval separating two consecutive occurrences of the same event and parameter value, or periodicity for periodic reporting;\n-\tEvent Duration: Average and variance of the Time for which the parameter value applies;\n-\tNumber of countable occurrences for the parameter (e.g.: Mobility Registration Update);\n-\tAverage, variance, most frequent value, least frequent value and skew of the parameter (e.g.: number of UEs in an AoI);\n-\tMaximum and minimum parameter values (e.g.: number of UEs in an AoI).\nEvent Parameter Names are Event specific and not all attributes are applicable for all parameter names. Examples of Event Parameter Names and Parameter values are provided in table 5A.4-1.\nTable 5A.4-1: Examples of Event Parameter Names, Parameter values\n\n",
                    "tables": [
                        {
                            "description": "Table 5A.4-1: Examples of Event Parameter Names, Parameter values",
                            "table number": 4,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5A.5\tHistorical Data Handling",
                    "description": "",
                    "summary": "",
                    "text_content": "ADRF or NWDAF as a Data Source:\n-\tWhen the DCCF receives a request for data that includes a period in the past and ADRF is deployed, the DCCF may obtain data from ADRF as the Data Source. The DCCF may also obtain historical data from an NWDAF. The data obtained from the ADRF or NWDAF is delivered to Consumers / Notification Endpoints according to a configured Delivery Option. The DCCF may determine that requested data may be available in an ADRF or NWDAF based on ADRF identification from the consumer, the data collection profile previously registered by the ADRF or NWDAF or by querying the ADRF or NWDAF.\nADRF or NWDAF as a Data Recipient:\n-\tAn ADRF or NWDAF may be a Consumer NF that initiates requests to the DCCF for data, the ADRF or NWDAF may be specified as a notification endpoint by another Consumer NF that wants to have data it requests archived, or the DCCF may be configured to archive certain data in a ADRF (e.g. all data from an AMF instance).\n-\tIf the ADRF or NWDAF instance is not specified in a request for data by a Consumer NF, the DCCF may select the ADRF or NWDAF instance based on provisioned information or information received from the NRF.\n-\tData is delivered to the ADRF or NWDAF according to a configured Delivery Option (via DCCF or Messaging Framework).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5B\tAnalytics Data Repository Functional Description",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5B.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The ADRF offers services that enable a consumer to store and retrieve data and analytics. The analytics are produced by the NWDAF as described in clause 6.1 and data are collected as described in clause 6.2.\nData may be stored in the ADRF by:\n-\ta consumer sending the ADRF an Nadrf_DataManagement_StorageRequest containing the data or analytics to be stored. The ADRF response provides a result indication.\n-\ta consumer sending the ADRF an Nadrf_DataManagement_StorageSubscriptionRequest requesting that the ADRF subscribes to receive data or analytics for storage. The ADRF then subscribes to the NWDAF or DCCF for data or analytics, providing ADRF Notification Address (+Notification Correlation ID). Analytics or Data are subsequently provided as notifications using DCCF, NWDAF or MFAF services (Ndccf_DataManagement Nnwdaf_DataManagement or Nmfaf_3caDataManagement service).\nData may be retrieved from the ADRF by:\n-\ta consumer sending an Nadrf_DataManagement_RetrievalRequest request to the ADRF to retrieve data or analytics for a Storage Transaction Identifier or a Fetch Instructions received from the ADRF in an Nadrf_DataManagement_RetrievalNotify. The ADRF determines the availability of the data or analytics in its repository and sends in the response to the consumer either the data or analytics.\n-\ta consumer sending an Nadrf_DataManagement_RetrievalSubscribe request to the ADRF to retrieve data or analytics for a specified data or analytics collection time window. If the time window includes the future and the ADRF has subscribed to receive the data or analytics, subsequent notifications received by the ADRF are sent by the ADRF to the notification endpoint.\nThe ADRF determines the availability of the data or analytics and sends a success/failure indication in the response to the consumer. The ADRF then sends one or more notifications using an Nadrf_DataManagement_RetrievalNotify to the Notification Address (+Notification Correlation ID) specified by the consumer. The notification(s) either provide the data or analytics or provide instructions to the endpoint to fetch the data or analytics using an Nadrf_DataManagement_RetrievalRequest.\nData may be deleted from the ADRF by:\n-\ta consumer sending an Nadrf_DataManagement_Delete request.\nAn ADRF may be configured to register the data it is collecting with a DCCF. The registration uses the Ndccf_ContextManagement service specified in clause 8.3.2. The registration may subsequently be used by the DCCF to obtain data from the ADRF as described in clause 6.2.6.3.6.\nThe ADRF offers services that enable a consumer to store, delete and retrieve ML models. The ML models are trained by NWDAF containing MTLF as described in clause 5.1.\nML model(s) may be retrieved from the ADRF by:\n-\ta consumer sending the ADRF an Nadrf_MLModelManagement_RetrievalRequest as described in clause 10.3.4, containing one or more tuples of unique ML Model identifier stored in ADRF or Storage Transaction Identifier. The ADRF response provides one or more tuples of unique ML Model identifiers and address (e.g. URL or FQDN) of ML model file stored in ADRF.\nML models may be stored in the ADRF by:\n-\ta consumer sending the ADRF an Nadrf_MLModelManagement_StorageRequest as described in clause 10.3.2, containing the ML model or ML model address to be stored. The ADRF response provides a result indication.\nML model may be deleted from the ADRF by:\n-\ta consumer sending an Nadrf_MLModelManagement_Delete request as described in clause 10.3.3. The ADRF response provides a result indication.\nWhen a consumer requests data or analytics be stored in an ADRF, it may specify Storage Handling information requesting:\n-\ta lifetime for how long the data or analytics should be stored; and\n-\tthat a notification alerting the consumer be sent prior to data deletion from the ADRF.\nThe ADRF, DCCF or NWDAF may be configured with default operator storage policies. The policies specify how long data or analytics are to be stored and conditions when the default policy supersedes Storage Handling Information provided in a request from the Data or Analytics Consumer. Based on the default operator policy and the Storage Handling information, the ADRF, DCCF or NWDAF determines the Storage Approach that will be applied for the data or analytics.\nThe Storage Approach is comprised of the life-time for how long the data or analytics will be stored and the notification requirement to be applied when data or analytics are to be deleted from the ADRF.\nWhen more than one consumer requests a storage life-time for the same data or analytics, the Storage Approach should be based on the longest requested storage life-time.\nThe response to the consumer request for data or analytics includes the Storage Approach.\nNOTE:\tThe default operator policy for how long data or analytics are to be stored may be longer or shorter than the life-time requested by the consumer. A default operator policy may for example accept only consumer requested life-times that are shorter or longer than the default policy.\nThe ADRF, DCCF or NWDAF determines when the data or analytics life-time has expired. When data or analytics is to be removed from the ADRF, an alert is sent to the Consumer that the data is about to be deleted. The alert contains a Storage Transaction Identifier that can be used by the consumer to retrieve the data or analytics.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5C\tAnalytics/ML Model Accuracy Monitoring Functional Description",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5C.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "A NWDAF may have the accuracy checking capability for Analytics and/or ML Models. The NWDAF may provide the accuracy information to consumers when requested or use it for its internal processes.\nInput data is collected from Data Producer NF(s) when there is a request for inference/prediction per analytics ID in NWDAF for a specific time period in future. Ground truth data are collected from those Data Producer NF corresponding to the requested analytic ID at the time to which the prediction refers.\nThe ground truth data is the actual measured data observed at the time which the prediction refers to.\nNOTE 1:\tThe ground truth data can be impacted when Analytics Feedback Information shows that an action is triggered by the analytics output in the consumer.\nAnalytics/ML Model Accuracy Monitoring is to be achieved by comparing the predictions using the current trained ML model and its corresponding ground truth data i.e. the corresponding true observed events.\nAnalytics/ML Model Accuracy information is to represent general performance measurements for analytics and ML Model respectively, which are composed of the number of correct predictions out of all predictions and the corresponding number of samples.\nNOTE 2:\tHow an MTLF/AnLF determines whether a prediction is correct is up to implementation.\nThe NWDAF (containing AnLF/MTLF) with accuracy checking capability decides to initiate analytics accuracy monitoring based on:\n-\tA request from an analytics accuracy consumer. The analytics accuracy consumer may be an NWDAF containing AnLF, NWDAF containing MTLF or an analytics consumer NF.\n-\tAnalytics Feedback Information which may be provided by an Analytics Consumer NF.\nThe AnLF with analytics accuracy checking capability as defined in clause 6.2D is able to provide or notify the accuracy information of Analytics IDs to the analytics consumers of such service and when the analytics accuracy does not meet the analytics consumer's requirements, the analytics consumer may stop using analytics for a period of time or obtain new analytics. In addition, updated analytics for the provided Analytics IDs may be provided to analytics consumers as requested, if the updated analytics is able to be generated within the correction time period. The AnLF with analytics accuracy checking capability is as defined in clause 6.2D.1 is able to determine analytics accuracy information based on e.g.:\n-\tComparing predictions and its corresponding ground truth data, which are collected corresponding to the requested analytic ID at the time which the prediction refers to.\nNOTE 3:\tThe ground truth data and the corresponding prediction is to be defined per Analytics ID.\n-\tComparing changes in internal configuration for the analytics ID generation (e.g. change of data collection parameters, change in data distribution from a Data Source).\n-\tPrevious existent records of analytics accuracy information.\n-\tAccuracy feedback information provided by an NF consumer.\n-\tDetermining analytics accuracy by comparing analytics accuracy using multiple ML models.\nThe MTLF with ML Model accuracy checking capability as defined in clause 6.2E is able to determine ML Model degradation based on e.g.:\n-\tcomparing/evaluating the data: including input data, analytics output and the ground truth data either collected from various data source NFs, DCCF, AnLF, ADRF or configured by OAM;\n-\tor AnLF providing notifications of the analytics accuracy information; or\n-\tAnLF providing analytics feedback information of the analytics generated by the ML model.\nThe NWDAF containing MTLF may reselect a new ML model or retrain the existing ML model and consequently notify the ML model accuracy degradation to the ML Model consumer(s). In addition, the NWDAF containing MTLF may consider the rating of untrusted AF(s) when used as data sources.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "6\tProcedures to Support Network Data Analytics",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.0\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause specifies procedures to support network data analytics function.\nClause 6.1 and clause 6.2 specify generic procedures which apply to all type of analytics, while clause 6.3 and onwards specify procedures specific to some type of analytics.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.1\tProcedures for analytics exposure",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1.1\tAnalytics Subscribe/Unsubscribe",
                            "text_content": "This procedure is used by any NWDAF service consumer (e.g. including NFs/OAM) to subscribe/unsubscribe at NWDAF to be notified on analytics information, using Nnwdaf_AnalyticsSubscription service defined in clause 7.2. This service is also used by an NWDAF service consumer to modify existing analytics subscription(s). Any entity can consume this service as defined in clause 7.2.\nThe figure depicts a network data analytics subscription/unsubscription process, illustrating the flow of data between subscribers and service providers. It shows the steps involved in managing subscriptions and unsubscriptions, including the creation of subscription records, the process of unsubscribing, and the deletion of subscription records. The figure is a visual representation of the complex process of managing network data analytics subscriptions and unsubscriptions, highlighting the importance of data management in ensuring network reliability and efficiency.\nFigure 6.1.1.1-1: Network data analytics Subscribe/unsubscribe\n1.\tThe NWDAF service consumer subscribes to or cancels subscription to analytics information by invoking the Nnwdaf_AnalyticsSubscription_Subscribe/ Nnwdaf_AnalyticsSubscription_Unsubscribe service operation. The parameters that can be provided by the NWDAF service consumer are listed in clause 6.1.3.\nWhen a subscription to analytics information is received, the NWDAF determines whether triggering new data collection is needed.\nIf the service invocation is for a subscription modification, the NF service consumer includes an identifier (Subscription Correlation ID) to be modified in the invocation of Nnwdaf_AnalyticsSubscription_Subscribe. In addition, if the NWDAF service consumer has taken an action(s) influenced by the previously received analytics information at step 2, which may or may not affect the ground truth data corresponding to Analytics ID requested at the time which the prediction refers to, the NWDAF service consumer may include Analytics feedback information in the invocation of Nnwdaf_AnalyticsSubscription_Subscribe.\nIf the subscription relates to outbound roaming users, the NWDAF in the HPLMN may decide to retrieve or to subscribe to input data or analytics from the VPLMN and the detailed procedure is described in clause 6.1.5.3 for analytics retrieval and in clause 6.2.10 for data retrieval.\nIf the subscription relates to inbound roaming users, the NWDAF in the VPLMN may decide to retrieve or to subscribe to input data or analytics from the HPLMN and the detailed procedure is described in clause 6.1.5.2 for analytics retrieval and in clause 6.2.11 for data retrieval.\n2.\tIf NWDAF service consumer is subscribed to analytics information, the NWDAF notifies the NWDAF service consumer with the analytics information by invoking Nnwdaf_AnalyticsSubscription_Notify service operation, based on the request from the NWDAF service consumer, e.g. Analytics Reporting Parameters. If the NWDAF provides a Termination Request, then the consumer cancels subscription to analytics information by invoking the Nnwdaf_AnalyticsSubscription_Unsubscribe service operation.\nWhen calculating the analytics/ML model accuracy information with the retrieved Analytics feedback information, in addition to comparing predictions of ML model and its corresponding ground truth data, the NWDAF may additionally determine/take into account whether the action(s) taken by the NWDAF service consumer affects the ground truth data corresponding to Analytics ID requested at the time which the prediction refers to as described in clauses 6.2D and 6.2E, which may affect the ML Model Accuracy monitoring.\nThe analytics exposure to AFs may be performed via NEF by using analytics subscription to NWDAF.\nFigure 6.1.1.2-1 illustrates the interaction between AF and NWDAF performed via the NEF.\nThe figure depicts a procedure for analytics subscribe/unsubscribe by AFs (Access Facilitators) via NEF (Network Enabler Function). It illustrates the steps involved in managing analytics subscriptions and unsubscriptions, including the use of NEF to manage the flow of data between the analytics service and the AFs. The figure provides a clear and concise visual representation of the process, making it easy for users to understand and follow.\nFigure 6.1.1.2-1: Procedure for analytics subscribe/unsubscribe by AFs via NEF\n0.\tNEF controls the analytics exposure mapping among the AF identifier with allowed Analytics ID and associated inbound restrictions (i.e, applied to subscription of the Analytics ID for an AF) and/or outbound restrictions (i.e. applied to notification of Analytics ID to an AF).\nIn this Release, AF is configured with the appropriated NEF to subscribe to analytics information, the allowed Analytics ID(s) and with allowed inbound restrictions (i.e. parameters and/or parameter values) for subscription to each Analytics ID.\n1.\tThe AF subscribes to or cancels subscription to analytics information via NEF by invoking the Nnef_AnalyticsExposure_Subscribe/ Nnef_AnalyticsExposure_Unsubscribe service operation defined in TS 23.502 [3]. If the AF wants to modify an existing analytics subscription at NEF, it includes an identifier (Subscription Correlation ID) to be modified in the invocation of Nnef_AnalyticsExposure_Subscribe, in addition, if the AF has taken an action(s) influenced by the previously received analytics information at step 4, which may or may not affect the ground truth data corresponding to Analytics ID requested at the time which the prediction refers to, the AF may include Analytics feedback information in the invocation of Nnef_AnalyticsExposure_Subscribe. If the analytics information subscription is authorized by the NEF, the NEF proceeds with the steps below.\n2.\tBased on the request from the AF, the NEF subscribes to or cancels subscription to analytics information by invoking the Nnwdaf_AnalyticsSubscription_Subscribe/ Nnwdaf_AnalyticsSubscription_Unsubscribe service operation.\nIf the parameters and/or parameters values of the AF request comply with the inbound restriction in the analytics exposure mapping, NEF forwards in the subscription to NWDAF service the Analytics ID, parameters and/or parameters values from the AF request.\nIf the request from AF does not comply with the restrictions in the analytics exposure mapping, NEF may apply restrictions to the subscription request to NWDAF (e.g. restrictions to parameters or parameter values of the Nnwdaf_AnalyticsSubscription_Subscribe service operations), based on operator configuration and/or may apply parameter mapping (e.g. geo coordinate mapping to TA(s)/Cell-id(s)).\nThe NEF records the association of the analytics request from the AF and the analytics request sent to the NWDAF.\nThe NEF selects an NWDAF that supports analytics information requested by the AF using the NWDAF discovery procedure defined in TS 23.501 [2].\nIf the subscription relates to outbound roaming users, the NWDAF in the HPLMN may decide to retrieve or to subscribe to input data or analytics from the VPLMN and the detailed procedure is described in clause 6.1.5.3 for analytics retrieval and in clause 6.2.10 for data retrieval.\nIf the AF request is for a modification of the existing analytics subscription(s), the NEF invokes Nnwdaf_AnalyticsSubscription_Subscribe to modify the analytics subscription identified by an identifier (Subscription Correlation ID) associated with the AF.\n3.\tIf the NEF has subscribed to analytics information, the NWDAF notifies the NEF with the analytics information or Termination Request by invoking Nnwdaf_AnalyticsSubscription_Notify service operation.\n4.\tIf the NEF receives the notification from the NWDAF, the NEF notifies the AF with the analytics information or Termination Request by invoking Nnef_AnalyticsExposure_Notify service operation defined in TS 23.502 [3]. NEF may apply outbound restrictions to the notifications to AFs (e.g. restrictions to parameters or parameter values of the Nnef_AnalyticsExposure_Notify service operation) based on analytics exposure mapping and may apply parameter mapping for external usage (e.g. TA(s), Cell-id(s) to geo coordinate). The AF checks if a Termination Request is present in the Nnef_AnalyticsExposure_Notify as defined in step 2 in clause 6.1.1.1.\nWhen calculating the analytics/ML model accuracy information with the retrieved Analytics feedback information, in addition to comparing predictions of ML model and its corresponding ground truth data, the NWDAF may determine/take into account whether the action(s) taken by the AF, when AF provides analytics feedback information, affects the ground truth data corresponding to Analytics ID requested at the time which the prediction refers to or start rating AF(s) used as data sources, as described in clauses 6.2D, 6.2E and 6.2.13, which may affect the ML Model Accuracy monitoring.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.2\tAnalytics Request",
                            "text_content": "This procedure is used by the NWDAF service consumer (e.g. including NFs/OAM) to request and get from NWDAF analytics information, using Nnwdaf_AnalyticsInfo service defined in clause 7.3.\nThe figure depicts a network data analytics request, illustrating the various data sources and their respective data types, such as network traffic, application logs, and system metrics. The request is structured with a clear structure, including the requestor, the recipient, the data source, and the data type. The request is sent to the network data analytics service, which processes the request and provides the requested data.\nFigure 6.1.2.1-1: Network data analytics Request\n1.\tThe NWDAF service consumer requests analytics information by invoking Nnwdaf_AnalyticsInfo_Request service operation. The parameters that can be provided by the NWDAF service consumer are listed in clause 6.1.3.\nWhen a request for analytics information is received, the NWDAF determines whether triggering new data collection is needed.\nIf the analytics request relates to outbound roaming users, the NWDAF in the H-PLMN may decide to retrieve input data or analytics from the related V-PLMN and the detailed procedure is described in clause 6.1.5.3 for analytics retrieval and in clause 6.2.10 for data retrieval.\nIf the analytics request relates to inbound roaming users, the NWDAF in the V-PLMN may decide to retrieve input data or analytics, from the related H-PLMN and the detailed procedure is described in clause 6.1.5.2 for analytics retrieval and in clause 6.2.11 for data retrieval.\n2.\tThe NWDAF responds with analytics information to the NWDAF service consumer. The NWDAF checks if a Termination Request is indicated as defined in step 2 in clause 6.1.1.1.\nThe analytics exposure to AFs may be performed via NEF by using analytics request to NWDAF.\nFigure 6.1.2.2-1 illustrates the interaction between AF and NWDAF performed via the NEF.\nThe figure depicts a procedure for analytics requests by AFs (Access Facilitators) via NEF (Network Enabler Framework), which is a framework for managing network access and performance. The figure shows the steps involved in requesting analytics, including the request form, the request process, and the response from the network. The figure is important for understanding the process of requesting analytics and the response from the network.\nFigure 6.1.2.2-1: Procedure for analytics request by AFs via NEF\n0.\tNEF controls the analytics exposure mapping among the AF identifier with allowed Analytics ID(s) and associated inbound restrictions (i.e. applied to the Analytics ID requested by AF and/or outbound restrictions (i.e. applied to the response of Analytics ID to AF).\nIn this Release, AF is configured, e.g. via static OAM configuration, with the appropriated NEF to subscribe to analytics information, the allowed Analytics ID(s) and with allowed inbound restrictions (i.e. parameters and/or parameter values) for requesting each Analytics ID.\n1.\tThe AF requests to receive analytics information via NEF by invoking the Nnef_AnalyticsExposure_Fetch service operation defined in TS 23.502 [3]. If the analytics information request is authorized by the NEF, the NEF proceeds with the steps below.\n2.\tBased on the request from the AF, the NEF requests analytics information by invoking the Nnwdaf_AnalyticsInfo_Request service operation.\nIf the parameters and/or parameters values of the AF request comply with the restriction in the analytics exposure mapping, NEF forwards in the subscription to NWDAF service the Analytics ID, parameters and/or parameters values from AF in the request to NWDAF.\nIf the request from AF does not comply with the restrictions in the analytics exposure mapping, NEF may apply restrictions to the request to NWDAF (e.g. restrictions to parameters or parameter values of the Nnwdaf_AnalyticsInfo_Request service operations) based on operator configuration and/or may apply parameter mapping (e.g. geo coordinate mapping to TA(s), Cell-id(s)).\nThe NEF records the association of the analytics request from the AF and the analytics request sent to the NWDAF.\nThe NEF selects an NWDAF that supports analytics information requested by the AF using the NWDAF discovery procedure defined in TS 23.501 [2].\nIf the analytics request relates to outbound roaming users, the NWDAF in the H-PLMN may decide to retrieve input data or analytics from the related V-PLMN and the detailed procedure is described in clause 6.1.5.3 for analytics retrieval and in clause 6.2.10 for data retrieval.\n3.\tThe NWDAF responds with the analytics information to the NEF.\n4.\tThe NEF responds with the analytics information to the AF. NEF may apply restrictions to the response to AFs (e.g. restrictions to parameters or parameter values of the Nnef_AnalyticsExposure_Fetch response service operation) based on operator configuration. The AF checks if a Termination Request is present and then follows as defined in step 2 in clause 6.1.1.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.3\tContents of Analytics Exposure",
                            "text_content": "The consumers of the Nnwdaf_AnalyticsSubscription_Subscribe or Nnwdaf_AnalyticsInfo_Request service operations described in clause 7 provide the input parameters listed below.\n-\tA list of Analytics ID(s): identifies the requested analytics.\n-\tAnalytics Filter Information: indicates the conditions to be fulfilled for reporting Analytics Information. This set of optional parameter types and values enables to select which type of analytics information is requested. Analytics Filter Information is defined in the analytics related clauses.\n-\tTarget of Analytics Reporting: indicates the object(s) for which Analytics information is requested, entities such as specific UEs, a group of UE(s) or any UE (i.e. all UEs).\n-\t(Only for Nnwdaf_AnalyticsSubscription_Subscribe) A Notification Target Address (+ Notification Correlation ID) as defined in clause 4.15.1 of TS 23.502 [3], allowing to correlate notifications received from NWDAF with this subscription.\n-\t(Only for Nnwdaf_AnalyticsSubscription_Subscribe) Subscription Correlation ID: identifies an existing analytics subscription that is to be modified.\n-\tRelated to analytic consumers that aggregate analytics from multiple NWDAF subscriptions:\n-\t[OPTIONAL] (Set of) NWDAF identifiers of NWDAF instances used by the NWDAF service consumer when aggregating multiple analytics subscriptions. See clause 6.1A.\n-\tAnalytics Reporting Information with the following parameters:\n-\t(Only for Nnwdaf_AnalyticsSubscription_Subscribe) Analytics Reporting Parameters as per Event Reporting parameters defined in Table 4.15.1-1 of TS 23.502 [3].\nNOTE 1:\tWhen the Analytics Reporting Parameters indicates a periodic reporting mode and the periodicity of the report is equal to or greater than the Supported Analytics Delay associated with the Analytics ID (if available) defined in clause 6.2.6.2 of TS 23.501 [2], it is expected that the periodic reporting can be provided by the NWDAF as requested.\n-\t(Only for Nnwdaf_AnalyticsSubscription_Subscribe) Reporting Thresholds, which indicate conditions on the level of each requested analytics that when reached shall be notified by the NWDAF.\n-\t[OPTIONAL] Matching direction: A matching direction may be provided such as below, above, or crossed. If no matching direction is provided, the default direction is crossed.\n-\t[OPTIONAL] Acceptable deviation: An acceptable deviation from the threshold level in the non-critical direction (i.e. in which the QoS is improving) may be set to limit the amount of signalling.\n-\tAnalytics target period: time interval [start..end], either in the past (both start time and end time in the past) or in the future (both start time and end time in the future). An Analytics target period in the past is a request or subscription for statistics. An Analytics target period in the future is a request or subscription for predictions. The time interval is expressed with actual start time and actual end time (e.g. via UTC time). When the Analytics Reporting Parameters indicate a periodic reporting mode, the time interval can also be expressed as positive or negative offsets to the reporting time, which indicates a subscription for predictions or statistics respectively. By setting start time and end time to the same value, the consumer of the analytics can request analytics or subscribe to analytics for a specific time rather than for a time interval.\n-\tTime window for historical analytics: time interval [start..end]. The time window for historical analytics indicates the time interval during which the historical analytics was generated. If the time window for historical analytics is included, the NWDAF only needs to provide the existing analytics, and does not need to generate new analytics.\n-\t[OPTIONAL] Data time window: if specified, only events that have been created in the specified time interval are considered for the analytics generation.\n-\t[OPTIONAL] Preferred level of accuracy of the analytics (\"Low\", \"Medium\", \"High\" or \"Highest\").\n-\t[OPTIONAL] Preferred level of accuracy per analytics subset (\"Low\", \"Medium\", \"High\" or \"Highest\"). When a preferred level of accuracy is expressed for a given analytics subset, it takes precedence for this subset over the above preferred level of accuracy of the analytics. Analytics subsets are defined in the \"Output Analytics\" clause of applicable analytics.\n-\t[OPTIONAL] Dataset Statistical Properties: information in order to influence the data selection mechanisms to be used for the generation of an Analytics ID, assuring that the generated Analytics ID reflects the statistical characteristics of the data that are relevant for the NWDAF consumer. The following dataset statistical properties are allowed:\n-\tUniformly distributed datasets, which indicates the use of data samples that are uniformly distributed according to the different aspects of the requested analytics (e.g. equivalent data samples for each UE listed as a Target of Analytics Reporting or for S-NSSAIs included in the Analytics Filter Information).\n-\tDatasets with or without outliers, which indicates that the data samples shall consider or disregard data samples that are at the extreme boundaries of the value range.\n-\tTime when analytics information is needed (if applicable): indicates to the NWDAF the latest time the analytics consumer expects to receive analytics data provided by the NWDAF. It should not be set to a value less than the Supported Analytics Delay of the selected NWDAF if applicable. If the time is reached the consumer does not need to wait for the analytics information any longer, yet the NWDAF may send an error response or error notification to the consumer. \"Time when analytics information is needed\" is a relative time interval as the gap with respect to analytics request /subscription (e.g. \"in 10 minutes\").\nNOTE 2:\tIf the analytics request contains the parameter \"Time when analytics information is needed\" for Analytics ID(s), this parameter takes precedence over the requested periodicity, if a periodic reporting mode is requested.\nNOTE 3:\tIf the Time when analytics information is needed is provided and it is less than the Supported Analytics Delay per Analytics ID (if available) defined in clause 6.2.6.2 of TS 23.501 [2], it is expected that the NWDAF might not be able to treat the Analytics ID on time.\n-\t[OPTIONAL] Maximum number of objects requested by the consumer (max) to limit the number of objects in a list of analytics per Nnwdaf_AnalyticsSubscription_Notify or Nnwdaf_AnalyticsInfo_Request response.\n-\t[OPTIONAL] Preferred granularity of location information: \"TA level\", \"cell level\" or \"longitude and latitude level\".\nNOTE 4:\tAs defined in clause 4 of TS 23.032 [34], longitude and latitude level means the location information is expressed as longitude and latitude in geographical coordinate instead of TA ID or cell ID that is only known in 3GPP system. It also stands for the location information that is expressed as a reference point in local co-ordinate.\n-\t[OPTIONAL] Spatial granularity size: maximum number of TA or cells used to define an area for which analytics are provided. When this parameter is provided, the NWDAF should provide analytics per group of TA of cells accordingly.\n-\t[OPTIONAL] Temporal granularity size: minimum duration of each time slot for which analytics are provide. When this parameter is provided, the NWDAF should provide analytics per elementary time slot accordingly.\nNOTE 5:\tIt is up to NWDAF implementation to determine whether the data is taken into account that the UE locates in an area for a shorter time than the Temporal granularity size.\n-\t[OPTIONAL] Preferred orientation of location information: (\"horizontal\", \"vertical\", \"both\").\n-\t[OPTIONAL] Preferred order of results when a list of analytics is returned, possibly with a criterion for identifying the property of the results to which the preferred ordering is applied.\n-\t[OPTIONAL] Maximum number of SUPIs (SUPImax) requested by the consumer to limit the number of SUPIs in an object. When SUPImax is not provided, the NWDAF shall return all SUPIs concerned by the analytics object. When SUPImax is set to 0, the NWDAF shall not provide any SUPI.\n-\t[OPTIONAL] Output strategy: indicates the relevant factors for determining when the analytics reported. The following values are allowed:\n-\tBinary output strategy: indicates that the analytics shall only be reported when the preferred level of accuracy is reached within a cycle of periodic notification as defined in the Analytics Reporting Parameters.\nNOTE 6:\tIf preferred level of accuracy is more important than providing an output, then the binary strategy is used so that all analytics outputs have equivalent confidence in the prediction.\n-\tGradient output strategy: indicates that the analytics shall be reported according to the periodicity defined in the Analytics Reporting Parameters irrespective if the preferred level of accuracy has been reached.\nNOTE 7:\tIf having an analytics output is more important than reaching the preferred level of accuracy, then the gradient output strategy is used so that each NWDAF will timely provide the output indicating the confidence of the prediction at the moment of the output generation.\nNOTE 8:\tWhen no output strategy is included in the subscription, the analytics output will be generated based on the gradient strategy and includes the confidence of the prediction for the reporting period.\n-\t[OPTIONAL] Analytics metadata request: indicates a request from one NWDAF to another NWDAF to provide the \"analytics metadata information\" related to the produced output analytics. This input parameter indicates which parameters in \"analytics metadata information\" are required to aggregate the output analytics for the requested Analytics ID(s).\n-\t(Only for Nnwdaf_AnalyticsSubscription_Subscribe) Consumer NF's serving area or NF ID. During a pending analytics subscription transfer, this information can be used by the NWDAF to find out if the analytics consumers may change as described in clause 6.1B.2.\n-\t(Only for Nnwdaf_AnalyticsSubscription_Subscribe) Information of previous analytics subscription. When setting up the analytics generation, this information may be used to retrieve analytics context from the previous NWDAF in order to build upon the context that is already related to this subscription as described in clause 6.1B.2.1.\n-\t[OPTIONAL] Use case context: indicates the context of use of the analytics to select the most relevant ML model.\nNOTE 9:\tThe NWDAF can use the parameter \"Use case context\" to select the most relevant ML model, when several ML models are available for the requested Analytics ID(s). NWDAF containing AnLF can additionally provide the parameter \"Use case context\" when requesting an ML model from an NWDAF containing MTLF. The values of this parameter are not standardized. For example, the AMF can use a given value of \"Use case context\" when requesting UE Mobility analytics for optimizing the definition of a Registration Area, and a different value of \"Use case context\" when requesting UE Mobility analytics for determines a paging strategy.\n-\t(Only for Nnwdaf_AnalyticsSubscription_Subscribe) [OPTIONAL] Analytics feedback information: indicates that the consumer NF has taken an action(s) influenced by the previously provided analytics, which may or may not affect the ground truth data corresponding to analytic ID requested at the time which the prediction refers to, and consequently affect the ML Model Accuracy monitoring by the subscription with following parameter(s):\n-\tCorresponding Analytics ID(s) which has been used for taking an action(s);\n-\tIndication whether the action will affect on ground truth data (if available);\n-\tTime stamp(s) of the action(s) taken.\nNOTE 10:\tThe consumer NF cannot include Analytics feedback information in initial subscription request. Analytics feedback information can be included in modification request for the existing analytics subscription.\n-\t[OPTIONAL] Analytics Accuracy Request information with the following parameters:\n-\tAnalytics accuracy request: indicates NWDAF to provide accuracy information to the analytics consumer.\n-\t[OPTIONAL] Analytics accuracy information time window: time interval [start. end], which indicates that analytics consumers only consider the accuracy information which is generated within this time interval.\n-\t[OPTIONAL] Analytics accuracy information periodicity: time period, which indicates periodic reporting of accuracy information for the corresponding Analytics ID(s).\n-\t[OPTIONAL] Analytics Accuracy threshold: a reporting threshold accuracy value, which indicates that:\n-\tThe NWDAF can provide analytics output and optionally analytics accuracy value to the analytics consumer(s) when the accuracy value is above this Analytics Accuracy threshold (i.e. the accuracy is sufficient according to the threshold);\n-\tThe NWDAF can provide \"Stop Analytics Output Consumption indication\", \"Updated Analytics\" or the analytics accuracy information to the analytics consumer(s) when the accuracy value is under this threshold (This indicates the deviation of the predictions from the actual network data does not meet analytics accuracy requirement, i.e. the accuracy is not sufficient according to the threshold).\n-\t[OPTIONAL] Minimal number of analytics output occurrences: determines the minimal number of analytics output provided by NWDAF that have to be considered in the determination of the accuracy information.\n-\t[OPTIONAL] Updated Analytics flag: indicates that the NWDAF can provide updated analytics for provided Analytics ID(s), if updated analytics can be generated within analytics accuracy information time window.\n-\t[OPTIONAL] Correction time period: a relative time interval as the gap with respect to analytics is provided, which is indicated the time interval during which the updated analytics can be accepted by the analytics consumer.\n-\t[OPTIONAL] Pause analytics consumption flag: is a flag indicating to NWDAF to stop sending the notifications of analytics outputs for a subscribed analytics ID, without unsubscribing to such analytics ID.\n-\t[OPTIONAL] Resume Analytics Subscription request: is a flag indicating to NWDAF to resume the notification of analytics outputs for an existing analytics ID(s) subscription(s) that have been previously paused.\nThe NWDAF provides to the consumer of the Nnwdaf_AnalyticsSubscription_Subscribe or Nnwdaf_AnalyticsInfo_Request service operations described in clause 7, the output information listed below, using a Nnwdaf_AnalyticsSubscription_Notify service operation or the Nnwdaf_AnalyticsInfo_Request response, respectively:\n-\t(Only for Nnwdaf_AnalyticsSubscription_Notify) The Notification Correlation Information.\n-\tFor each Analytics ID, the analytics information in the requested Analytics target period. If the analytics subset is subscribed or requested, then the corresponding analytics information shall be provided.\n-\tTimestamp of analytics generation: allows consumers to decide until when the received information shall be used. For instance, an NF can deem a received notification from NWDAF for a given feedback as invalid based on this timestamp;\n-\tValidity period: defines the time period for which the analytics information is valid.\nNOTE 11:\t\tValidity period is determined by NWDAF internal logic and it is a subset of Analytics target period.\n-\tConfidence: probability assertion, i.e. confidence in the prediction.\n-\t[OPTIONAL] For each Analytics ID the Termination Request, which notifies the consumer that the subscription is requested to be cancelled as the NWDAF can no longer serve this subscription, e.g. due to user consent revoked, NWDAF overload, UE moved out of NWDAF serving area, etc.\n-\t[OPTIONAL] Analytics metadata information: additional information required to aggregate the output analytics for the requested Analytics ID(s). This parameter shall be provided if the \"Analytics metadata request\" parameter was provided in the corresponding Nnwdaf_AnalyticsSubscription_Subscribe or Nnwdaf_AnalyticsInfo_Request service operation.\n-\tNumber of data samples used for the generation of the output analytics;\n-\tData time window of the data samples;\n-\tDataset Statistical Properties of the analytics output used for the generation of the analytics;\n-\t[OPTIONAL] Data source(s) of the data used for the generation of the output analytics;\n-\t[OPTIONAL] Data Formatting and Processing applied on the data;\n-\tOutput strategy used for the reporting of the analytics.\n-\t(Only for error response or error notification) Revised waiting time: indicates to the consumer a revised waiting value for \"Time when analytics information is needed\". Each NWDAF may include this as part of error response or error notification to \"Time when analytics information is needed\" as described in clause 6.2.5. Revised waiting time is the minimum time interval recommended by NWDAF to use as \"Time when analytics information is needed\" for similar future analytics requests/subscriptions.\n-\t[OPTIONAL] Analytics accuracy information generated for each analytics ID, including:\n-\tAnalytics accuracy value for requested Analytics ID(s): a value shall be provided if \"Analytics accuracy request\" parameter was provided in the corresponding Nnwdaf_AnalyticsSubscription_Subscribe service operation. This parameter may be provided if the value crosses the analytics accuracy threshold(s) which is indicated in the subscribe request or locally configured, or the analytics accuracy information periodicity indicated in the subscribe request is reached.\n-\t[OPTIONAL] An indication that the determined accuracy value for the analytics ID does not meet the analytics accuracy threshold requested for the analytics ID.\n-\t[OPTIONAL] Updated Analytics: NWDAF provides updated Analytics, which is generated within analytics accuracy information time window, for provided Analytics ID(s), if \"Updated Analytics flag\" parameter was indicated in the corresponding Nnwdaf_AnalyticsSubscription_Subscribe service operation.\n-\t[OPTIONAL] Stop Analytics Output Consumption indication: NWDAF provides to the consumer an indication to stop the consumption of the Analytics ID(s) related to the subscription ID based on NWDAF internal logic or specified analytics accuracy threshold.\n-\t[OPTIONAL] Stop Analytics Output Consumption time window: NWDAF provides to the consumer a time window to stop the consumption of the Analytics ID(s) related to the subscription ID based on NWDAF internal logic or specified analytics accuracy threshold.\n-\t[OPTIONAL] Resume Analytics Output Consumption indication: NWDAF provides to consumer an indication to resume the consumption of analytics output for existing subscription to the analytics ID(s) that was previously paused.\n-\t[OPTIONAL] Accuracy Information Termination: NWDAF notifies the consumer that the subscription to the accuracy information for an analytics ID has been cancelled as the NWDAF does not support the accuracy checking capability, e.g. as an indication that a new target serving NWDAF supporting accuracy checking capability could not have been selected during the analytics transfer procedures.\nNOTE 12:\tIt is left to Stage 3 to decide whether the Accuracy Information Termination is a cause related to the Termination Request or not.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.4\tAnalytics Exposure using DCCF",
                            "text_content": "This clause specifies procedures for analytics exposure using DCCF services, with two options: analytics can be exposed via DCCF, according to clauses 6.1.4.2 and 6.1.4.3, or can be exposed via a messaging framework according to clauses 6.1.4.4 and 6.1.4.5. Which option to use is determined by DCCF configuration.\nThe procedure as depicted in Figure 6.1.4.2-1 is used by analytics consumer(s) (e.g. NFs/OAM) to subscribe/unsubscribe to NWDAF analytics and be notified of analytics information via the DCCF, using Ndccf_DataManagement_Subscribe service operation. Whether a NWDAF service consumer directly contacts the NWDAF or goes via the DCCF is based on NWDAF service consumer configuration.\nThe figure depicts a network data analytics subscription via DCCF, illustrating the various subscription options available to users. The subscription is categorized into different tiers, with the most basic subscription costing $0.001 per month, while the most advanced subscription costing $0.00001 per month. Users can choose from a range of subscription options, including basic, standard, and premium, with each option offering different features and benefits. The figure also includes a visual representation of the subscription options, allowing users to easily compare and select the most suitable subscription for their needs.\nFigure 6.1.4.2-1: Network data analytics subscription via DCCF\n1.\tAnalytics consumer subscribes to analytics information via DCCF by invoking the Ndccf_DataManagement_Subscribe (Nnwdaf service operation, Analytics Specification, Formatting Instructions, Processing Instructions, NWDAF (or NWDAF-Set) ID, ADRF Information) service operation. The analytics consumer may specify one or more notification endpoints. Analytics consumer decides to go via DCCF based on internal configuration. The \"Analytics Specification\" provides Nnwdaf service operation specific parameters, e.g. Analytics IDs, Target of Analytics Reporting and optional parameters used to retrieve the analytics. The analytics consumer may provide the identity of the NWDAF to collect analytics from. The analytics consumer may provide additional information on possible notification endpoints or ADRF information so analytics are archived.\n2.\tIf the NWDAF instance or NWDAF Set is not identified by the analytics Consumer, the DCCF determines the NWDAF instances that can provide analytics. If the consumer requested storage of analytics in an ADRF but an ADRF ID is not provided by the Analytics Consumer, or the collected analytics is to be stored in an ADRF according to configuration on the DCCF, the DCCF selects an ADRF to store the collected data.\n3.\tThe DCCF determines whether the analytics requested in step 1 are already being collected. If the requested analytics are already being collected by an Analytics Consumer, the DCCF adds the new analytics consumer to the list of analytics consumers that are subscribed for these analytics.\n4.\tIf the analytics subscribed in step 1 partially matches an analytics that is already being collected by the DCCF from an NWDAF and a modification of this subscription to the NWDAF would satisfy both the existing analytics subscriptions as well as the newly requested analytics, the DCCF invokes a modification of the previous subscription via Nnwdaf_AnalyticsSubscription_Subscribe service operation (as specified in clause 6.1.1.1) and the DCCF adds the analytics consumer to the list of analytics consumers that are subscribed for these analytics.\nIf the analytics requested at step 1 are not already available or not being collected yet, the DCCF subscribes to analytics from NWDAF using the Nnwdaf_AnalyticsSubscription_Subscribe procedure as specified in clause 6.1.1.1. The DCCF adds the analytics consumer to the list of analytics consumers that are subscribed for these analytics.\n5.\tWhen new output analytics are available, the NWDAF notifies the analytics information to the DCCF by invoking Nnwdaf_AnalyticsSubscription_Notify service operation.\n6.\tThe DCCF uses Ndccf_DataManagement_Notify to send the analytics to all notification endpoints indicated in step 1. Analytics sent to notification endpoints may be processed and formatted by the DCCF so they conform to delivery requirements for each analytics consumer or notification endpoint as specified in clause 5A.4. The DCCF may store the analytics in the ADRF if requested by the consumer or if required by DCCF configuration, using procedure as specified in clause 6.2B.3.\nNOTE:\tAccording to Formatting Instructions provided by the Analytics Consumer, multiple notifications from a NWDAF can be combined in a single Ndccf_DataManagement_Notify so many notifications from an NWDAF results in fewer notifications (or one notification) to the Analytics Consumer. Alternatively, a notification can instruct the analytics notification endpoint to fetch the analytics from the DCCF.\n7.\tIf a Ndccf_DataManagement_Notify contains a fetch instruction, the notification endpoint sends a Ndccf_DataManagement_Fetch request to fetch the analytics from the DCCF before an expiry time.\n8.\tThe DCCF delivers the analytics to the notification endpoint.\n9.\tWhen the Analytics Consumer no longer wants analytics to be collected it invokes Ndccf_DataManagement_Unsubscribe (Subscription Correlation ID), using the Subscription Correlation Id received in response to its subscription in step 1. The DCCF removes the analytics consumer from the list of analytics consumers that are subscribed for these analytics.\n10.\tIf there are no other Analytics Consumers subscribed to the analytics, the DCCF unsubscribes with the NWDAF.\nThe procedure as depicted in Figure 6.1.4.3-1 is used by an analytics consumer (e.g. NFs/OAM) to obtain historical analytics via the DCCF. Historical analytics may be previously computed statistics or predictions stored in an NWDAF or ADRF. Statistics may have been previously computed and stored in the ADRF or NWDAF and can be identified by a \"target period\" in the past (see clause 6.1.3). Requests for previously computed predictions have a \"Time Window\", which specifies an allowable span for when the predictions may have been computed. This allows the Analytics Consumer to request previously computed predictions for a target period.\nThe analytics consumer requests analytics via the DCCF, using Ndccf_DataManagement_Subscribe service operation. Whether the NWDAF service consumer directly contacts the NWDAF/ADRF or goes via the DCCF is based on configuration.\nThe figure depicts a historical analytics exposure via DCCF (Data Center Communication Channel). It illustrates the various communication paths and the corresponding exposure levels for different data center communication channels. The figure is crucial for understanding the network's exposure to data center communication channels and for designing and implementing data center security measures.\nFigure 6.1.4.3-1: Historical Analytics Exposure via DCCF\n1.\tThe analytics consumer requests analytics via DCCF by invoking the Ndccf_DataManagement_Subscribe (Nnwdaf service operation, Analytics Specification, Time Window, Formatting Instructions, Processing Instructions, ADRF ID or NWDAF ID (or ADRF Set ID or NWDAF Set ID) service operation as specified in clause 8.2.2. The analytics consumer may specify one or more notification endpoints to receive the analytics.\nParameter \"Nnwdaf service operation\" is the service operation used to originally acquire the analytics and identifies this as a request for analytics, \"Analytics Specification\" provides Nnwdaf service operation specific parameters, e.g. Analytics IDs, Target of Analytics Reporting and optional parameters used to retrieve the analytics. \"Time Window\" specifies a past time period and comprises a start and stop time indicating when predictions were computed and \"Formatting and Processing Instructions\" are as defined in clause 5A.4. The analytics consumer may optionally include the ADRF or NWDAF instance (or ADRF Set or NWDAF Set) ID where the stored analytics resides.\n2.\tIf an ADRF or NWDAF instance or ADRF or NWDAF Set ID is not provided by the analytics consumer, the DCCF determines if any ADRF or NWDAF instances might provide the analytics as described in clause 5A and clause 5B.\n3.\t(conditional) If the DCCF determines that an ADRF instance might provide the analytics, or an ADRF instance or Set was supplied by the analytics consumer, the DCCF sends a request to the ADRF, using Nadrf_DataManagement_RetrievalSubscribe (Analytics Specification, Notification Target Address=DCCF) service operation, as specified in clause 10.2. The ADRF responds to the DCCF with an Nadrf_DataManagement_RetrievalSubscribe response indicating if the ADRF can supply the analytics. If the analytics can be provided, the procedure continues with step 5.\n4.\t(conditional) If the DCCF determines that an NWDAF instance might provide the analytics or an NWDAF instance or Set was supplied by the Analytics Consumer, the DCCF sends a request to the NWDAF using Nnwdaf_AnalyticsSubscription_Subscribe as specified in clause 7.2.2.\n5.\tThe ADRF uses Nadrf_DataManagement_RetrievalNotify or the NWDAF uses Nnwdaf_AnalyticsSubscription_Notify to send the requested analytics (e.g. one or more stored notifications archived from an NWDAF) to the DCCF. The analytics may be sent in one or more notification messages.\n6.\tThe DCCF uses Ndccf_DataManagement_Notify to send analytics to all notification endpoints indicated in step 1. Notifications are sent to the Notification Target Address(es) using the Analytics Consumer Notification Correlation ID(s) received in step 1. Analytics sent to notification endpoints may be processed and formatted by the DCCF, so they conform to delivery requirements specified by the analytics consumer.\nNOTE:\tAccording to Formatting Instructions provided by the analytics consumer, multiple notifications from an ADRF or NWDAF can be combined in a single Ndccf_DataManagement_Notify so many notifications from the ADRF or NWDAF results in fewer notifications (or one notification) to the Analytics Consumer. Alternatively, a Ndccf_DataManagement_Notify can instruct the analytics notification endpoint to fetch the analytics from the DCCF before an expiry time.\n7.\tIf a notification contains a fetch instruction, the notification endpoint sends a Ndccf_DataManagement_Fetch request as specified in clause 8.2.5 to fetch the analytics from the DCCF.\n8.\tThe DCCF delivers the analytics to the notification endpoint.\n9.\tWhen the analytics consumer no longer wants analytics to be collected or has received all the analytics it needs, it invokes Ndccf_DataManagement_Unsubscribe (Subscription Correlation ID), using the Subscription Correlation Id received in response to its subscription in step 1.\n10.\tIf the analytics are being provided by an ADRF and there are no other analytics consumers subscribed to the analytics, the DCCF unsubscribes with the ADRF using Nadrf_DataManagement_RetrievalUnsubscribe as specified in clause 10.2.7.\n11.\tIf the analytics are being provided by an NWDAF and there are no other analytics consumers subscribed to the analytics, the DCCF unsubscribes with the NWDAF using Nnwdaf_AnalyticsSubscription_Unsubscribe service operation as specified in clause 7.2.3.\nThe procedure as depicted in Figure 6.1.4.4-1 is used by analytics consumer(s) (e.g. NFs/OAM) to subscribe/unsubscribe to NWDAF analytics and be notified of analytics information, using Ndccf_DataManagement_Subscribe service operation. The 3GPP DCCF Adaptor (3da) Data Management service and 3GPP Consumer Adaptor (3ca) Data Management service of the Messaging Framework Adaptor Function (MFAF) are used to interact with the 3GPP Network and the Messaging Framework. Whether a NWDAF service consumer directly contacts the NWDAF or goes via the DCCF is based on NWDAF service consumer configuration.\nThe figure depicts a network data analytics subscription via DCCF, illustrating the various subscription options available to users. The subscription is categorized into different tiers, with the most basic subscription costing $0.001 per month, while the most advanced subscription costing $0.00001 per month. The subscription is available for both residential and commercial users, and can be accessed through a web-based interface or through a mobile application. The subscription includes access to a variety of analytics tools, such as network performance monitoring, network traffic analysis, and network security monitoring. The subscription is designed to provide users with real-time data insights and analytics, helping them make informed decisions about their network usage and performance.\nFigure 6.1.4.4-1: Network data analytics subscription via DCCF\n1.\tAnalytics consumer subscribes to analytics information via DCCF by invoking the Ndccf_DataManagement_Subscribe (Nnwdaf service operation, Analytics Specification, Formatting Instructions, Processing Instructions, NWDAF (or NWDAF-Set) ID, ADRF Information, Analytics Consumer Notification Target Address (+ Notification Correlation ID)) service operation. The analytics consumer may specify one or more notification endpoints. Analytics consumer decides to go via DCCF based on internal configuration. The \"Analytics Specification\" provides Nnwdaf service operation specific parameters, e.g. Analytics IDs, Target of Analytics Reporting and optional parameters used to retrieve the analytics. The analytics consumer may provide the identity of the NWDAF to collect analytics from. The analytics consumer may provide additional information on possible notification endpoints or ADRF information to archive analytics.\n2.\tIf the NWDAF instance or NWDAF Set is not identified by the analytics consumer, the DCCF determines the NWDAF instances that can provide analytics. If the consumer requested storage of analytics in an ADRF but an ADRF ID is not provided by the Analytics Consumer, or the collected analytics is to be stored in an ADRF according to configuration on the DCCF, the DCCF selects an ADRF to store the collected analytics.\n3.\tThe DCCF determines whether the analytics requested in step 1 are already being collected. If the requested analytics are already being collected by an analytics consumer, the DCCF adds the new analytics consumer to the list of analytics consumers that are subscribed for these analytics.\n4.\tThe DCCF sends an Nmfaf_3daDataManagement_Configure (Analytics Consumer Information, MFAF Notification Information, Formatting Conditions, Processing Instructions) to configure the MFAF to map notifications received from the NWDAF to outgoing notifications sent to endpoints and to instruct the MFAF how to format and process the outgoing notifications.\n\"Analytics Consumer Information\" contains for each notification endpoint, the analytics consumer Notification Target Address (+ Analytics Consumer Notification Correlation ID) to be used by the MFAF when sending notifications in step 7.\n\"MFAF Notification Information\" is included if an NWDAF is already sending the analytics to the MFAF. MFAF Notification Information identifies Event Notifications received from the NWDAF and comprises the MFAF Notification Target Address (+ MFAF Notification Correlation ID). If the MFAF does not receive MFAF Notification information from the DCCF, the MFAF selects an MFAF Notification Target Address (+ MFAF Notification Correlation ID) and sends the MFAF Notification Information, containing the MFAF Notification Target Address (+ MFAF Notification Correlation ID), to the DCCF in the Nmfaf_3daDataManagement_Configure Response.\n5.\tIf the analytics subscribed in step 1 partially matches analytics that are already being collected by the DCCF from a NWDAF and a modification of this subscription to the NWDAF would satisfy both the existing analytics subscriptions as well as the newly requested analytics, the DCCF invokes Nnwdaf_AnalyticsSubscription_Subscribe (Subscription Correlation ID) with parameters indicating how to modify the previous subscription (as specified in clause 6.1.1.1). The DCCF adds the analytics consumer to the list of analytics consumers that are subscribed for these analytics.\nIf the analytics requested at step 1 are not already available or not being collected yet, the DCCF subscribes to analytics from the NF using Nnwdaf_AnalyticsSubscription_Subscribe, setting the Notification Target Address (+Notification Correlation ID)) to the MFAF Notification Target Address (+ MFAF Notification Correlation ID) received in step 4. The DCCF adds the analytics consumer to the list of analytics consumers that are subscribed for these analytics.\n6.\tWhen new output analytics are available, the NWDAF uses Nnwdaf_AnalyticsSubscription_Notify to send the analytics to the MFAF. The Notification includes the MFAF Notification Correlation ID.\n7.\tThe MFAF uses Nmfaf_3caDataManagement_Notify to send the analytic to all notification endpoints indicated in step 4. Notifications are sent to the Notification Target Address(es) using the Analytics Consumer Notification Correlation ID(s) received in step 4. Analytics sent to notification endpoints may be processed and formatted by the MFAF, so they conform to delivery requirements specified by the analytics consumer. The MFAF may store the information in the ADRF if requested by consumer or if required by DCCF configuration, using procedure as specified in clause 6.2B.3.\nNOTE:\tAccording to Formatting Instructions provided by the Analytics Consumer, multiple notifications from a NWDAF can be combined in a single Nmfaf_3caDataManagement_Notify, so many notifications from the NWDAF results in fewer notifications (or one notification) to the analytics consumer. Alternatively, a notification can instruct the analytics notification endpoint to fetch the analytics from the MFAF before an expiry time.\n8.\tIf a Nmfaf_3caDataManagement_Notify contains a fetch instruction, the notification endpoint sends a Nmfaf_3caDataManagement_Fetch request to fetch the analytics from the MFAF.\n9.\tThe MFAF delivers the analytics to the notification endpoint.\n10.\tWhen the analytics consumer no longer wants analytics to be collected, it invokes Ndccf_DataManagement_Unsubscribe (Subscription Correlation ID), using the Subscription Correlation Id received in response to its subscription in step 1. The DCCF removes the analytics consumer from the list of analytics consumers that are subscribed for these analytics.\n11.\tIf there are no other analytics consumers subscribed to the analytics, the DCCF unsubscribes with the NWDAF.\n12.\tThe DCCF de-configures the MFAF so it no longer maps notifications received from the NWDAF to the notification endpoints configured in step 4.\nThe procedure as depicted in Figure 6.1.4.5-1 is used by an analytics consumer (e.g. NFs/OAM) to obtain historical analytics via the messaging framework. Historical analytics may be previously computed statistics or predictions stored in an NWDAF or ADRF. Statistics may be previously computed and stored in the ADRF or NWDAF and can be identified by a \"target period\" in the past (see clause 6.1.3). Requests for previously computed predictions have a \"Time Window\", which specifies an allowable span for when the predictions may have been computed. This allows the analytics consumer to request previously computed predictions for a target period.\nThe analytics consumer requests analytics via the DCCF, using Ndccf_DataManagement_Request service operation. Whether the NWDAF service consumer directly contacts the NWDAF/ADRF, or goes via the DCCF is based on configuration.\nThe figure depicts a historical analytics exposure via a messaging framework, illustrating the various stages of data collection, processing, and dissemination. The framework includes data collection points, data processing steps, and data dissemination channels, all of which are crucial for ensuring the accuracy and reliability of historical analytics.\nFigure 6.1.4.5-1: Historical Analytics Exposure via Messaging Framework\n1.\tThe analytics consumer requests analytics via DCCF by invoking the Ndccf_DataManagement_Subscribe (Nnwdaf service operation, Analytics Specification, Time Window, Formatting Instructions, Processing Instructions, ADRF ID or NWDAF ID (or ADRF Set ID or NWDAF Set ID)). The analytics consumer may specify one or more notification endpoints to receive the analytics.\n2.\tIf an ADRF or NWDAF instance or ADRF or NWDAF Set ID is not provided by the Analytics Consumer, the DCCF determines if any ADRF or NWDAF instances might provide the analytics as described in clause 5A and clause 5B.\n3.\tThe DCCF sends an Nmfaf_3daDataManagement_Configure (Analytics Consumer Information, Formatting Conditions, Processing Instructions) to configure the MFAF to map notifications received from the ADRF or NWDAF to outgoing notifications sent to endpoints and to instruct the MFAF how to format and process the outgoing notifications.\n\"Analytics Consumer Information\" contains for each notification endpoint, the analytics consumer Notification Target Address (+ Analytics Consumer Notification Correlation ID) to be used by the MFAF when sending notifications. The MFAF selects an MFAF Notification Target Address (+ MFAF Notification Correlation ID) and sends the MFAF Notification Information, containing the MFAF Notification Target Address (+ MFAF Notification Correlation ID), to the DCCF in the Nmfaf_3daDataManagement_Configure Response.\n4.\t(conditional) If the DCCF determines that an ADRF instance might provide the analytics, or an ADRF instance or Set was supplied by the Analytics Consumer, the DCCF sends a request to the ADRF, using Nadrf_DataManagement_RetrievalSubscribe (Analytics Specification, MFAF Notification Information) as specified in clause 10.2.6. The MFAF Notification information contains the MFAF Notification Target Address (+ MFAF Notification Correlation ID) received in step 3.\n5.\tThe ADRF responds to the DCCF with an Nadrf_DataManagement_RetrievalSubscribe response indicating if the ADRF can supply the analytics. If the analytics can be provided, the procedure continues with step 8.\n6.\t(conditional) If the DCCF determines that an NWDAF instance might provide the analytics or an NWDAF instance or Set was supplied by the Analytics Consumer, the DCCF sends a request to the NWDAF using Nnwdaf_AnalyticsSubscription_Subscribe as specified in clause 7.2.2. The MFAF Notification Information contains the MFAF Notification Target Address (+ MFAF Notification Correlation ID) received in step 3.\n7.\tThe NWDAF responds to the DCCF with an Nnwdaf_AnalyticsSubscription_Subscribe response indicating if the NWDAF can supply the analytics.\n8.\tThe ADRF uses Nadrf_DataManagement_RetrievalNotify or the NWDAF uses Nnwdaf_AnalyticsSubscription_Notify to send the requested analytics (e.g. one or more stored notifications archived from an NWDAF) to the MFAF. The analytics may be sent in one or more notification messages.\n9.\tThe MFAF uses Nmfaf_3caDataManagement_Notify to send analytics to all notification endpoints indicated in step 3. Notifications are sent to the Notification Target Address(es) using the Analytics Consumer Notification Correlation ID(s) received in step 3. Analytics sent to notification endpoints may be processed and formatted by the DCCF, so they conform to delivery requirements specified by the analytics consumer.\nNOTE:\tAccording to Formatting Instructions provided by the Analytics Consumer, multiple notifications from an ADRF or NWDAF can be combined in a single Ndccf_DataManagement_Notify so many notifications from the ADRF or NWDAF results in fewer notifications (or one notification) to the Analytics Consumer. Alternatively, a Nmfaf_3caDataManagement_Notify can instruct the analytics notification endpoint to fetch the analytics from the DCCF before an expiry time.\n10.\tIf a notification contains a fetch instruction, the notification endpoint sends a Nmfaf_3caDataManagement_Fetch request as specified in clause 9.3.3 to fetch the analytics from the MFAF.\n11.\tThe DCCF delivers the analytics to the notification endpoint.\n12.\tWhen the analytics consumer no longer wants analytics to be collected or has received all the analytics it needs, it invokes Ndccf_DataManagement_Unsubscribe (Subscription Correlation ID) as specified in clause 8.2.3, using the Subscription Correlation Id received in response to its subscription in step 1.\n13.\tIf the analytics are being provided by an ADRF and there are no other analytics consumers subscribed to the analytics, the DCCF invokes Nadrf_DataManagement_RetrievalUnsubscribe as specified in clause 10.2.7 to unsubscribe from the ADRF.\n14.\tIf the analytics are being provided by an NWDAF and there are no other analytics consumers subscribed to the analytics, the DCCF invokes Nnwdaf_AnalyticsSubscription_Unsubscribe service operation as specified in clause 7.2.3 to unsubscribe from the NWDAF\n15.\tThe DCCF de-configures the MFAF so it no longer maps notifications received from the NWDAF to the notification endpoints configured in step 3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.5\tAnalytics Exposure in Roaming Case",
                            "text_content": "Based on roaming agreements (e.g. SLA), analytics may be exchanged between PLMNs (i.e. HPLMN and VPLMN of a UE served by the NWDAF analytics consumer). In this case, an NWDAF with roaming exchange capability (RE-NWDAF) is used as entry point in a PLMN to exchange analytics in roaming scenario with other PLMNs. It authorizes the analytics request according to roaming agreements, and filters the information exposed to other PLMNs. The roaming architecture is defined in clause 4.3.\nThe H-RE-NWDAF may provide analytics to the V-RE-NWDAF. The V-RE-NWDAF may provide analytics to the H-NWDAF.\nNOTE 1:\tThe roaming agreements (e.g. SLA) between HPLMN and VPLMN on network analytics and data exchange takes into consideration all relevant regulatory requirements.\nNOTE 2:\tIt depends on the deployment whether analytics exchange between PLMNs is supported, and thus whether H-RE-NWDAF and V-RE-NWDAF are provided in a PLMN.\nThe H-RE-NWDAF or V-RE-NWDAF provides the Nnwdaf_RoamingAnalytics for that purpose. An RE-NWDAF is the only consumer of these services, i.e. both H-NWDAF and V-NWDAF need to have roaming exchange capability when used as entry point to exchange analytics in roaming scenario.\nNOTE 3:\tThe access to the Nnwdaf_AnalyticsSubscription service and the Nnwdaf_AnalyticsInfo service is expected to be restricted by the NRF to NF service consumers within the same PLMN to prevent bypassing checks based on user consent and operator policy\nEditor's note:\tThe user consent check procedure and security aspects will align with SA3 WG's conclusion.\nV-RE-NWDAF may request or subscribe to HPLMN analytics from the H-RE-NWDAF as described in clause 6.1.5.2, and then the analytics can be leveraged by the 5GC NF in the VPLMN, for example:\n-\tIn home routed roaming scenarios, HPLMN analytics (i.e. slice load level analytics, NF load analytics, etc.) can be leveraged by the AMF in the VPLMN for network slice selection and SMF selection for PDU Session management.\n-\tUE-related analytics (e.g.. service experience analytics, etc.) can include statistics or predictions for outbound roaming UEs.\nNOTE 4:\tAnalytics that rely on input data from the VPLMN are preferably not provided from H-RE-NWDAF to V-RE-NWDAF, but generated by a NWDAF in the VPLMN.\nH-RE-NWDAF may request or subscribe to VPLMN analytics from the V-RE-NWDAF as described in clause 6.1.5.3, and then the analytics can be leveraged by the 5GC NF in the HPLMN, for example:\n-\tIn home routed roaming scenarios, analytics information with statistics or predictions for outbound roaming UEs can be leveraged by the H-PCF for QoS control of the PDU Session.\n-\tAnalytics (i.e. service experience analytics, slice load level analytics, etc.) can be leveraged by the H-PCF for decision of NSSP in URSP rules provisioned to the UE roaming in the VPLMN.\nNOTE 5:\tAnalytics that rely on input data from the HPLMN are preferably not provided from V-RE-NWDAF to H-RE-NWDAF, but generated by a NWDAF in the HPLMN.\nFigure 6.1.5.2-1 shows the procedure that the V-RE-NWDAF requests network analytics (i.e. slice load level analytics, NF load analytics, service experience analytics, etc.) in HPLMN from a H-RE-NWDAF, upon receiving an analytics information request/subscription from the NF (e.g. AMF) in VPLMN.\nThe figure depicts a procedure for analytics exposure from HPLMN to VPLMN, illustrating the steps involved in data transmission and analysis.\nFigure 6.1.5.2-1: Procedure for analytics exposure from HPLMN to VPLMN\n1.\tConsumer NF in VPLMN (e.g. AMF) discovers a V-RE-NWDAF as described in clause 5.2 and sends an Analytics request/subscribe (Analytics ID, Analytics Filter Information, Target of Analytics Reporting) to V-RE-NWDAF by invoking a Nnwdaf_AnalyticsInfo_Request or a Nnwdaf_AnalyticsSubscription_Subscribe. For the inbound roaming user(s) indicated in the Target of Analytics Reporting, V-RE-NWDAF determines based on operator configuration and the requested analytics whether analytics or input data from the HPLMN are required, or the analytics can be derived locally. The subsequent steps only apply if analytics from the HPLMN are required. If input data from the HPLMN are required, the procedures in clause 6.2.11 apply.\nNOTE 1:\tIt is possible that the Target of Analytics Reporting sent by the Consumer NF to the V-RE-NWDAF includes both inbound roaming user(s) and non-roaming user(s).\n2.\tV-RE-NWDAF checks the roaming agreements related to analytics from HPLMN to determine if the roaming analytics request/subscribe can be accepted or must be rejected. If the request is rejected, the following steps are skipped.\nV-RE-NWDAF discovers a H-RE-NWDAF as described in clause 5.2. V-RE-NWDAF sends a roaming analytics request/subscribe (Analytics ID, Analytics Filter Information, Target of Analytics Reporting) to H-RE-NWDAF by invoking a Nnwdaf_RoamingAnalytics_Request or a Nnwdaf_RoamingAnalytics_Subscribe, based on the Analytics request/subscribe received from the Consumer NF in VPLMN. The Target of Analytics Reporting sent by the V-RE-NWDAF to the H-RE-NWDAF only contains the inbound roaming user(s).\nNOTE 2:\tThe inbound roaming user(s) are distinguished by the V-RE-NWDAF according to UE ID(s) (i.e. SUPI(s)).\n3a.\tH-RE-NWDAF checks the roaming agreements between the HPLMN and the VPLMN, and user consent for analytics as defined in clause 6.2.9 if needed, to determine if the roaming analytics request/subscribe can be accepted or must be rejected. If the roaming analytics request/subscribe is rejected, the following steps are skipped.\nIf H-RE-NWDAF supports to generate the requested analytics, it collects data from the NF(s) and/or OAM in HPLMN and derives the requested analytics; otherwise steps 3b and 3c are executed.\n3b-3c.\t[Optional] If the H-RE-NWDAF does not support to generate the requested analytics, it may request/subscribe to other NWDAF(s) in the HPLMN (if available) for the analytics and get corresponding response/notification.\nEditor's note:\tThe user consent check procedure and security aspects will align with SA WG3's conclusion.\n4.\tH-RE-NWDAF sends the HPLMN analytics information to the V-RE-NWDAF using either Nnwdaf_RoamingAnalytics_Request response or Nnwdaf_RoamingAnalytics_Notify, depending on the service used in step 2. The H-RE-NWDAF may restrict the exposed analytics information based on HPLMN operator polices.\n5.\t[Optional] If the Consumer NF also indicates request or subscription of analytics information available in the VPLMN (e.g. via Target of Analytics Reporting) in step 1, V-RE-NWDAF collects data from the NF(s) and/or OAM in VPLMN and derives the requested analytics. The V-RE-NWDAF may perform analytics aggregation with the analytics information received from the H-RE-NWDAF and analytics information generated by itself, based on the analytics request or subscription.\n6.\tV-RE-NWDAF sends the HPLMN analytics information received in step 4, or the aggregated analytics information if step 5 are performed, to the Consumer NF in VPLMN using either Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.\nNOTE 3:\tThe present document describes that the RE-NWDAF may perform analytics aggregation for roaming scenario, but whether and how the RE-NWDAF performs analytics aggregation for roaming scenario are up to implementation.\nFigure 6.1.5.3-1 shows the procedure that the H-RE-NWDAF requests network analytics (i.e. service experience analytics, slice load level analytics, etc.) in VPLMN from the V-RE-NWDAF, upon receiving an analytics information request/subscription from the NF (e.g. PCF) in HPLMN.\nThe figure depicts a procedure for analytics exposure from VPLMN to HPLMN, illustrating the steps involved in data transmission and analysis.\nFigure 6.1.5.3-1: Procedure for analytics exposure from VPLMN to HPLMN\n1.\tIf the Consumer NF in HPLMN (e.g. H-PCF) is aware that the UE(s) indicated in Target of Analytics Reporting is/are outbound roaming UE(s) the Consumer NF discovers a H-RE-NWDAF as described in clause 5.2 and sends an Analytics request/subscribe (Analytics ID, Target of Analytics Reporting, Analytics Filter Information) to H-RE-NWDAF by invoking a Nnwdaf_AnalyticsInfo_Request or a Nnwdaf_AnalyticsSubscription_Subscribe. For the outbound roaming user(s) indicated in the Target of Analytics Reporting, H-RE-NWDAF determines based on operator configuration and the requested analytics whether analytics or input data from the VPLMN are required, or the analytics can be derived locally. The subsequent steps only apply if analytics from the VPLMN are required. If input data from the VPLMN are required, the procedures in clause 6.2.10 apply.\nIf the Consumer NF is unaware that the Target of Analytics Reporting includes roaming UE(s) and sends the Analytics request/subscribe to a H-NWDAF which does not support roaming exchange capability, then the H-NWDAF may perform either of the following after determining that the Target of Analytics Reporting includes roaming UE(s) (e.g. by inquiring the AMF(s) serving the UE(s) at the UDM with the Nudm_UECM service):\n-\tforward the Analytics request/subscribe to a H-RE-NWDAF after discovering a H-RE-NWDAF as described in clause 5.2. The H-NWDAF may include the VPLMN ID in the Analytics request/subscribe; or\n-\treject the Analytics request/subscribe with a proper cause value. And the following steps will not be performed.\nNOTE 1:\tIt is possible that the Target of Analytics Reporting sent by the Consumer NF to the H-RE-NWDAF includes both outbound roaming user(s) and non-roaming user(s).\nNOTE 2:\tThe H-NWDAF is not depicted in the flow.\n2.\tIf PLMN ID of the VPLMN is not included in the Analytics request/subscribe, the H-NWDAF inquires it at the UDM for the UEs indicated as Target of Analytics Reporting. The H-RE-NWDAF checks user consent for analytics as defined in clause 6.2.9. H-RE-NWDAF checks the roaming agreements between the HPLMN and the VPLMN to determine if the roaming analytics request/subscription can be accepted or must be rejected. If the request is rejected, the following steps are skipped.\nEditor's note:\tThe user consent check procedure and security aspects will align with SA WG3's conclusion.\nThe H-RE-NWDAF discovers the V-RE-NWDAF as described in clause 5.2.\nH-RE-NWDAF sends a roaming analytics request/subscribe (Analytics ID, Analytics Filter Information, Target of Analytics Reporting, [NF ID(s)]) to V-RE-NWDAF by invoking a Nnwdaf_RoamingAnalytics_Request or a Nnwdaf_RoamingAnalytics_Subscribe, based on the Analytics request/subscribe received from the Consumer NF in HPLMN. The Target of Analytics Reporting sent by the H-RE-NWDAF to the V-RE-NWDAF only contains the outbound roaming user(s). The H-RE-NWDAF may obtain NF ID(s) of the NF(s) serving the roaming UE(s) in the VPLMN, e.g. AMF ID(s), SMF ID(s), from the UDM and include the NF ID(s) in the analytics request/subscribe.\n3a.\tV-RE-NWDAF checks the roaming agreements between the HPLMN and the VPLMN, to determine if the roaming analytics request/subscribe can be accepted or must be rejected. If the roaming analytics request/subscribe is rejected, the following steps are skipped.\nIf V-RE-NWDAF supports to generate the requested analytics, it collects data from the NF(s) serving the roaming UE(s) and/or OAM in VPLMN and derives the analytics; otherwise steps 3b and 3c are executed. The NF(s) serving the roaming UE(s), e.g. AMF(s) or SMF(s), if indicated in step 2, can be used as data source.\n3b-3c.\t[Optional] If the V-RE-NWDAF does not support to generate the requested analytics, it may request/subscribe to other NWDAF(s) in the VPLMN (if available) for the analytics and get corresponding response/notification(s).\n4.\tV-RE-NWDAF sends the VPLMN analytics information to the H-RE-NWDAF using either Nnwdaf_RoamingAnalytics_Request response or Nnwdaf_RoamingAnalytics_Notify, depending on the service used in step 2. The V-RE-NWDAF may restrict the exposed analytics information based on VPLMN operator polices.\n5.\t[Optional] If the Consumer NF also indicates request or subscription of analytics information available in the HPLMN (e.g. via Target of Analytics Reporting) in step 1, H-RE-NWDAF collects data from the NF(s) and/or OAM in HPLMN and derives the analytics. These steps can be executed in parallel with steps 3-4. The H-RE-NWDAF may perform analytics aggregation with the analytics information received from the V-RE-NWDAF and analytics information generated by itself, based on the analytics request or subscription.\n6.\tH-RE-NWDAF sends the VPLMN analytics information received in step 4, or the aggregated analytics information if step 5 are performed, to the Consumer NF in HPLMN using either Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.\nIf the Analytics request/subscribe is forwarded to the H-RE-NWDAF by a H-NWDAF as described in step 1, the H-NWDAF forwards the analytics information received from the H-RE-NWDAF to the Consumer NF using either Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.\nNOTE 3:\tThe present document describes that the RE-NWDAF may perform analytics aggregation for roaming scenario, but whether and how the RE-NWDAF performs analytics aggregation for roaming scenario are up to implementation.\nWhen requesting or subscribing to analytics involving one or more roaming UEs, the Consumer NF shall send the request or subscription to an RE-NWDAF belonging to the same PLMN as the Consumer NF. The Consumer NF may indicate the following parameters in the Nnwdaf_AnalyticsInfo_Request or Nnwdaf_AnalyticsSubscription_Subscribe service operation:\n-\tThe parameters as defined in clause 6.1.3, with the following differences:\n-\tParameters related to analytics aggregation, analytics transfer or ML model selection should not be included;\n-\tif Target of Analytics Reporting is included and indicates specific UEs or a group of UEs, these UEs shall belong to the same HPLMN (if HPLMN analytics are subscribed/requested) or be served by the same VPLMN (if VPLMN analytics are subscribed/requested)\n-\tAdditionally, the following parameters:\n-\tIf the NWDAF service consumer in a VPLMN requests/subscribes to HPLMN analytics, in Analytics Filter Information:\n-\t[OPTIONAL] PLMN ID of the HPLMN;\nNOTE 1:\tIf PLMN ID of the HPLMN is not provided by the NWDAF service consumer, the V-RE-NWDAF derives it from the SUPIs of UEs indicated as Target of Analytics Reporting.\n-\t[OPTIONAL] mapped S-NSSAI of the HPLMN.\n-\t[OPTIONAL] AOI (in the form of geographical area) in the HPLMN\n-\tIf the NWDAF service consumer in a HPLMN requests/subscribes to VPLMN analytics, in Analytics Filter Information:\n-\t[OPTIONAL] PLMN ID of the VPLMN\n-\t[OPTIONAL] AOI (in the form of geographical area) in the VPLMN\nNOTE 2:\tIf PLMN ID of the VPLMN is not provided by the NWDAF service consumer, the H-RE-NWDAF inquires it at the UDM for the UEs indicated as Target of Analytics Reporting.\nNOTE 3:\tIn this release of the specification, only one PLMN ID (of HPLMN or VPLMN) is supported in the Nnwdaf_AnalyticsInfo_Request or Nnwdaf_AnalyticsSubscription_Subscribe service operation.\nBased on the analytics request or subscription from the NWDAF service consumer in the HPLMN, and local configuration, the H-RE-NWDAF may indicate the following parameters in the Nnwdaf_RoamingAnalytics_Request or Nnwdaf_RoamingAnalytics_Subscribe service operation to the V-RE-NWDAF, for requesting/subscribing to analytics in the VPLMN:\n-\tAnalytics ID;\n-\tPLMN ID of the HPLMN;\nNOTE 4:\tIt is up to SA WG3 to decide if a special protection of the PLMN ID of the HPLMN is required.\n-\tAnalytics Filter Information:\n-\t[OPTIONAL] HPLMN S-NSSAI;\nNOTE 5:\tV-NWDAF maps that S-NSSAI to an S-NSSAI of the VPLMN which will be used in the Analytics Filter Information.\n-\tother Analytics Filter Information (e.g. AOI in the form of geographical area in the VPLMN) as provided by NWDAF service consumer in the HPLMN, if applicable in the VPLMN.\n-\t[OPTIONAL] NF ID(s) of the NF(s) (e.g. AMF(s), SMF(s)) serving the roaming UE(s) in the VPLMN;\n-\tother parameters as provided by NWDAF service consumer in the HPLMN, if applicable in the VPLMN.\nBased on the analytics request or subscription from the NWDAF service consumer in the VPLMN, and local configuration, the V-RE-NWDAF may indicate the following parameters in the Nnwdaf_RoamingAnalytics_Request or Nnwdaf_RoamingAnalytics_Subscribe service operation to the H-RE-NWDAF, for requesting/subscribing to analytics in the HPLMN:\n-\tAnalytics ID;\n-\tPLMN ID of the VPLMN;\nNOTE 6:\tIt is up to SA WG3 to decide if a special protection of the PLMN ID of the VPLMN is required.\n-\tAnalytics Filter Information:\n[OPTIONAL] HPLMN S-NSSAI;\nNOTE 7:\tIf an S-NSSAI but no mapped S-NSSAI is provided by the NWDAF service consumer in the Analytics Filter Information, the V-NWDAF maps the S-NSSAI to the S-NSSAI of the HPLMN and provides that mapped S-NSSAI of the HPLM as the Analytics Filter Information.\n-\tother Analytics Filter Information (e.g. AOI in the form of geographical area in the HPLMN) as provided by NWDAF service consumer in the VPLMN, if applicable in the HPLMN.\n-\tother parameters as provided by NWDAF service consumer in the VPLMN, if applicable in the HPLMN.\nThe RE-NWDAF provides the following output information to the consumer RE-NWDAF of the Nnwdaf_RoamingAnalytics_Request or Nnwdaf_RoamingAnalytics_Notify service operation:\n-\tThe output information as defined in clause 6.1.3, with the following differences:\n-\tInformation related to analytics aggregation (i.e. analytics metadata information) should not be included.\nNOTE 8:\tThe output of the analytics depends on the roaming agreements.\nNOTE 9:\tUE specific data and analytics exchange between HPLMN and VPLMN and the possible storage is agreed between the operators bilaterally via roaming agreements (e.g. SLA) and takes into consideration all relevant regulatory requirements.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.1A\tAnalytics aggregation from multiple NWDAFs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1A.1\tGeneral",
                            "text_content": "In a multiple NWDAF deployment scenario, an NWDAF instance may be specialized to provide Analytics for one or more Analytics IDs. Each of the NWDAF instances may serve a certain Area of Interest or TAI(s). Multiple NWDAFs may collectively serve the particular Analytics ID. An NWDAF may have the capability to support the aggregation of Analytics (per Analytics ID) received from other NWDAFs, possibly with Analytics generated by itself.\nThe procedure for analytics aggregation from multiple NWDAFs is as defined in clause 6.1A.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1A.2\tAnalytics Aggregation",
                            "text_content": "The analytics aggregation from multiple NWDAFs is used to address cases where an NWDAF service consumer requests Analytics ID(s) that requires multiple NWDAFs to collectively serve the request. Analytic aggregation applies to scenarios where NWDAF service consumer requests or subscribes to analytics information with or without provisioning Area of Interest.\nAggregator NWDAF or aggregation point:\n-\tIs an NWDAF instance with additional capabilities to aggregate output analytics provided by other NWDAFs. This is in addition to regular NWDAF behaviour such as collecting data from other data sources to be able to generate its own output analytics.\n-\tIs able to divide the area of interest, if received from the consumer, into sub area of interest based on the serving area of each NWDAF to be requested for analytics and then send analytics requests including the sub area of interest as an Analytics Filter to corresponding NWDAFs. The Aggregator NWDAF may maintain information on the discovered NWDAFs, including their supported Analytics IDs, NWDAF Serving Areas, etc.\n-\tHas \"analytics aggregation capability\" registered in its NF Profile within the NRF.\n-\tSupports the requesting and exchange of \"Analytics Metadata Information\" between NWDAFs when required for the aggregation of output analytics. \"Analytics Metadata Information\" is additional information associated with the requested Analytics ID(s) as defined in clause 6.1.3.\n-\tSupports dataset statistical properties, output strategy and data time window parameters per type of analytics (i.e. Analytics ID) as defined in clause 6.1.3.\nNRF:\n-\tStores the NF Profile of the NWDAF instances, including \"analytics aggregation capability\" for Aggregator NWDAFs and \"analytics metadata provisioning capability\" when supported by the NWDAF.\n-\tReturns the NWDAF(s) matching the attributes provided in the Nnrf_NFDiscovery_Request, as specified in clause 5.2.7.3 of TS 23.502 [3].\nNWDAF service consumer:\n-\tRequests or subscribes to receive analytics for one or more Analytics IDs, as specified in clause 6.1 of the present document.\n-\tUses the discovery mechanism from NRF as defined in clause 6.3.13 of TS 23.501 [2] to identify NWDAFs with analytics aggregation capability and other capabilities (e.g. providing data/analytics for specific TAI(s)).\n-\tCan differentiate and select the preferred NWDAF in case multiple NWDAFs are returned in the NWDAF discovery response based on its internal selection criteria (considering the registered NWDAF capabilities and information in NRF or UDM).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1A.3\tProcedure for analytics aggregation",
                            "text_content": "The procedure depicted in figure 6.1A.3-1 is used to address cases where an NWDAF service consumer requests Analytics ID(s) for an Area of Interest that requires multiple NWDAFs that collectively serve the request.\nThe figure depicts a procedure for analytics aggregation, illustrating the steps involved in processing and analyzing data. It includes a flowchart with arrows indicating the sequence of actions, such as data collection, data transformation, and data analysis. The figure is essential for understanding the process of data processing and decision-making in a system.\nFigure 6.1A.3.1-1: Procedure for analytics aggregation\n1a-b.\tNWDAF service consumer discovers the NWDAF as specified in clause 5.2. When NRF is used, NRF may return multiple NWDAF candidates matching the requested capabilities, area of interest and supported Analytics ID(s). NWDAF service consumer selects an NWDAF (e.g. NWDAF1) with analytics aggregation capability (i.e. Aggregator NWDAF), based on its internal selection criteria, considering registered NWDAF capabilities and information in NRF including the Supported Analytics Delay per Analytics ID (if available).\n2.\tNWDAF service consumer invokes Nnwdaf_AnalyticsInfo_Request or Nnwdaf_AnalyticsSubscription_Subscribe service operation from the selected Aggregator NWDAF (e.g. NWDAF1). In the request, NWDAF service consumer provides Analytics ID(s) (e.g. Analytics ID 1) Analytics Filter Information (area of interest, e.g. TAI-1, TAI-2, TAI-n, if known to the NWDAF service consumer), Target of Analytics Reporting (e.g. a single UE, a group of UEs or any UE). It may also provide \"time when analytics information is needed\" (e.g. T1). It is expected that T1 is equal or greater than the Supported Analytics Delay per Analytics ID (if available) of the Aggregator NWDAF. Otherwise, the aggregator NWDAF may reject the analytics request or analytics subscription.\n3.\tOn receiving the request in step 2, Aggregator NWDAF (e.g. NWDAF1), based on e.g. configuration, queries to NRF including the Real-Time Communication Indication per Analytics ID and queries to UDM for checking which NWDAF(s) is serving the Target of Analytics Reporting. Considering the request from the NWDAF service consumer (e.g. Analytics Filter Information, T1, etc.) and Supported Delay per Analytics ID per NWDAF instance (when Real-Time Communication Indication was included), Aggregator NWDAF determines the other NWDAF instances that collectively can cover the area of interest indicated in the request (e.g. TAI-1, TAI-2, TAI-n).\nNOTE 1:\tIn the discovery request sent to NRF, Aggregator NWDAF might indicate \"analytics metadata provisioning capability\" (e.g. as query parameter), thus, requesting to NRF to reply back with, if available, those NWDAF instance(s) which also supports \"analytics metadata provisioning capability\" functionality as indicated during particular NWDAF instance registration procedure.\n4-5.\tAggregator NWDAF (e.g. NWDAF1) invokes Nnwdaf_AnalyticsInfo_Request or Nnwdaf_AnalyticsSubscription_Subscribe service operation from each of the NWDAFs discovered/determined in step 3 (e.g. NWDAF2 and NWDAF3).\nThe request may optionally indicate \"analytics metadata request\" parameter to the determined NWDAFs (e.g. NWDAF-2 and/or NWDAF3), when analytics metadata is supported by these NWDAFs.\nThe request or subscription to the determined NWDAFs (e.g. NWDAF2 and/or NWDAF3) may also include the dataset statistical properties, output strategy and data time window. This indicates to the determined NWDAFs that the Analytics ID output shall be generated based on such parameters when requested.\nIf \"time when analytics information is needed\" (T1) was provided in step 2, the Aggregator NWDAF shall also provide a \"time when analytics information is needed\" to the determined NWDAFs, with a smaller value compared with T1 (e.g. T2).\nNOTE 2:\tT2 in step 4-5 is smaller than T1 accounting for the analytics delay and processing time within the Aggregator NWDAF itself.\n6-7a-b.\tThe determined NWDAFs (e.g. NWDAF-2 and/or NWDAF3) reply or notify with the requested output analytics.\nIf \"analytics metadata request\" was included in the request received by such NWDAF (in steps 4-5), the NWDAF additionally returns the \"analytics metadata information\" used for generating the analytics output as defined in clause 6.1.3.\nIf the determined NWDAFs (e.g. NWDAF 2 and/or NWDAF 3) cannot reply or notify with the requested output analytics before the expiry of T2, they may send an error response or error notification to the Aggregator NWDAF including a \"revised waiting time\".\n8.\tAggregator NWDAF (e.g. NWDAF1) aggregates received Analytics information, i.e. generates a single output analytics based on the multiple analytics outputs and, optionally, the \"analytics metadata information\" received from the determined NWDAFs (e.g. NWDAF2 and NWDAF3).\nThe Aggregator NWDAF (e.g. NWDAF1) may also take its own analytics for TAI-n into account for the analytics aggregation.\n9a-b.\tAggregator NWDAF (e.g. NWDAF1) sends a response or notifies to the NWDAF service consumer the aggregated output analytics for the requested Analytics ID.\nIf the Aggregator NWDAF (e.g. NWDAF 1) cannot reply or notify with the requested output analytics before the expiry of T1 or anticipates that it cannot reply or notify with the requested output analytics before the expiry of T1 (e.g. due to error notification in step 6-7a-b), it may send an error response or error notification to the NWDAF service consumer including a \"revised waiting time\". The NWDAF service consumer may optionally use the \"revised waiting time\" to update the \"time when analytics information is needed\" parameter (i.e. T1) for future analytics requests/subscriptions to the same Aggregator NWDAF as defined in clause 6.2.5.2.\nThe procedure depicted in Figure 6.1A.3.2-1 is used to address cases where an NWDAF service consumer requests Analytics ID(s) without providing an Area of Interest, but requires multiple NWDAFs to collectively serve the request.\nThe figure depicts a procedure for analytics aggregation without the provision of an Area of Interest (AOI), illustrating the steps involved in data aggregation without the need for a specific area of interest.\nFigure 6.1A.3.2-1: Procedure for analytics aggregation without provision of Area of Interest\n1.\tThis step is a NWDAF discovery procedure without providing any area of interest. The service consumer discovers an aggregation NWDAF (e.g. NWDAF1) as specified in clause 5.2. When NRF is used, NRF may return multiple NWDAF candidates matching the requested capabilities and supported Analytics ID(s).\nDepending on the requested Analytics ID, the NWDAF service consumer, e.g. based on internal logic, can be able to determine which NWDAF should be selected for providing the required data analytics. If not, the NWDAF service consumer should select a NWDAF with large serving area from the candidate NWDAFs which supports analytics aggregation, e.g. NWDAF1.\n2.\tNWDAF service consumer sends Analytics information or analytics subscription request to the aggregator NWDAF, i.e. NWDAF1 in the Figure 6.1A.3.2-1. In the request, NWDAF service consumer provides the requested Analytics ID(s), e.g. Analytics ID 1.\nThe NWDAF service consumer may also provide \"time when analytics information is needed\" (e.g. T1). It is expected that T1 is equal or greater than the Supported Analytics Delay per Analytics ID of the Aggregator NWDAF (if available). Otherwise, the aggregator NWDAF may reject the analytics request or analytics subscription.\nOnce receiving the request, the Aggregator NWDAF1 may decide to subscribe data analytics from other NWDAF instances which can provide the requested data analytics. Based on the Analytics ID, there are two cases for the Aggregator NWDAF1 to subscribe data analytics from other NWDAF instances.\n3a.\tIf the data analytics requires UE location information, e.g. for the Analytics IDs \"UE Mobility\", \"Abnormal behaviour\", or \"User Data Congestion\", then:\n-\t3a-1: (optional) The Aggregator NWDAF1 queries UDM to discover the NWDAF serving the UE, if it is supported.\n-\t3a-2: If step 3a-1 is not supported, was not executed, or did not return a suitable NWDAF serving the UE, the Aggregator NWDAF1 determines the AMF serving the UE as specified in the clause 6.2.2.1, then requests UE location information from the AMF to be used in the query to NRF in step 4.\nNOTE:\tIf an Aggregator NWDAF receives an Analytics request for a group of UEs, i.e. the Target of Analytics Reporting set to an Internal Group ID, it performs NWDAF discovery based on location information of all UEs in the group and then requests all discovered NWDAFs to provide the required analytics.\n3b.\tIf the data analytics does not require to collect UE location information, e.g. for the Analytics IDs \"Service Experience\", \"NF load information\", or \"UE Communication\", the Aggregator NWDAF1 can determine the NFs to be contacted for data collection as specified in clause 6.2.2.1 and then it can retrieve NF service area for each of the data source NF from NRF.\n4.\t(conditional) With the data obtained in step 3, the Aggregator NWDAF1 queries the NRF for discovering the required NWDAF, by sending an NF discovery request including UE location (e.g. TAI-1) or NF serving area (e.g. TAI list-1) as a filter to NRF and obtains candidates target NWDAF(s) that can provide the required analytics. This step is skipped if a suitable NWDAF was discovered in step 3a-1. Additionally the Aggregator NWDAF1 may include in the NF discovery request the Real-Time Communication Indication per Analytics ID to request Supported Delay per Analytics ID per NWDAF instance.\nDepending on the discovered NWDAF instance(s), there can be two cases:\n5a.\tIf a single target NWDAF (e.g. NWDAF2) can provide the requested analytics data, the Aggregator NWDAF (e.g. NWDAF1) can redirect the Nnwdaf_AnalyticsInfo_Request to that target NWDAF or request an analytics subscription transfer to that target NWDAF, depending on the type of the analytics request/subscription received by the NWDAF Service Consumer.\n5b.\tIf the Aggregator NWDAF decides to request data analytics from one or more target NWDAFs, the steps 4-9 of the analytics aggregation procedure in clause 6.1A.3.1 are executed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.1B\tTransfer of analytics context and analytics subscription",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1B.1\tGeneral",
                            "text_content": "In a multiple NWDAFs deployment scenario, procedures for transfer of analytics context and analytics subscription can be used to support the target NWDAF to produce the needed analytics.\nWhen the analytics consumer provides the target NWDAF with information on the subscription that could be transferred from the source NWDAF, the target NWDAF may initiate the transfer of analytics context. The analytics consumer provides the information via Nnwdaf_AnalyticsSubscription_Subscribe service operation. When the analytics consumer is an AMF, the old subscription information (if related to a UE) may be provided by the source AMF to the target AMF using a UE context transfer procedure as specified in TS 23.502 [3].\nAn analytics subscription transfer to the target NWDAF may be initiated by the source NWDAF, followed by an analytics context transfer initiated by the target NWDAF. An NWDAF may transfer one or more of its analytics subscriptions to another NWDAF instance due to internal (e.g. load balancing, graceful shutdown) or external triggers (e.g. UE mobility). For external triggers, the NWDAF may subscribe to NF(s) to be notified about the corresponding events. As for UE mobility, upon the UE location change event notified by the AMF subscribed by the NWDAF, the NWDAF determines whether it can continue to provide the analytics service. If the NWDAF cannot continue to serve the consumer, it should either select a target NWDAF and initiate analytics subscription transfer, or notify the analytics consumer that it cannot provide the service anymore, so that the analytics consumer can select a new NWDAF.\nProcedures for analytics subscription transfer allow one NWDAF instance to transfer its ongoing analytics subscriptions to another NWDAF instance. The transfer can be done for all subscriptions or just a selected subset of subscriptions related to specific area(s), specific Analytics ID(s), specific NF(s) and/or specific UE(s).\nThe procedure for prepared analytics subscription transfer can be used if the source NWDAF instance anticipates that it will soon not be able to continue its current analytics tasks.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1B.2\tAnalytics Transfer Procedures",
                            "text_content": "The procedure in Figure 6.1B.2.1-1 is used when an NF decides to select a new NWDAF instance due to internal or external triggers, e.g. the NF starts serving a UE with analytics subscription information received upon UE context transfer procedure as described in TS 23.502 [3], or the NF starts to request NF related analytics, or the NF receives a \"Termination Request\" for an existing analytics subscription from an NWDAF. The NF sends to the target NWDAF information about the NWDAF previously used for analytics subscription, if available, in Nnwdaf_AnalyticsSubscription_Subscribe service operation. The target NWDAF may initiate the transfer of the analytics context, using the Nnwdaf_AnalyticsInfo_ContextTransfer or Nnf_DataManagement_Subscribe service operation.\nThe procedure in Figure 6.1B.2.1-1 is also used when an Aggregator NWDAF decides to select a new NWDAF to request output analytics for analytics aggregation. For example, upon receiving a Termination Request from one of the NWDAFs that are collectively serving a request for analytics subscription as specified in clause 6.1A, the Aggregator NWDAF queries the NRF or UDM to select a target NWDAF as specified in clause 6.1A.3 using information e.g. the UE location, the 5GC NFs (identified by their NF Set IDs or NF types) serving the UE or to be contacted for data collection (if Area of Interest is not provisioned for the requested analytics), or the subset of AoI (if Area of Interest is provisioned for the requested analytics). Then, the Aggregator NWDAF sends information about the NWDAF previously used for analytics subscription, if available, in Nnwdaf_AnalyticsSubscription_Subscribe service operation towards the selected target NWDAF.\nThe figure depicts a network traffic flow scenario, where the target network device (NWDAF) is selected by the network device access (NWDAF) service consumer. The traffic flow is initiated by the target network device, and the analytics context transfer is initiated by the network device access service consumer.\nFigure 6.1B.2.1-1: Analytics context transfer initiated by target NWDAF selected by the NWDAF service consumer\n1.\tThe NWDAF service consumer determines to select an NWDAF instance. The consumer discovers and selects the target NWDAF as specified in clause 5.2.\n2.\tThe consumer sends a request for analytics subscription to the target NWDAF using Nnwdaf_AnalyticsSubscription_Subscribe service operation, including information on the previous analytics subscription (i.e. NWDAF ID, Analytics ID(s), SUPIs, Analytics Filter Information for UE-related Analytics, Subscription Correlation ID, the Analytics Accuracy Request information (as defined in clause 6.1.3) when the Target NWDAF supports accuracy checking capability) which relates to the requested analytics subscription, if available. If the target NWDAF accepts the analytics subscription request, it sends Nnwdaf_AnalyticsSubscription_Subscribe response with a Subscription Correlation ID.\nIf the target NWDAF does not receive information of previous analytics subscription in step 2, for UE related Analytics, the target NWDAF may discover previously used NWDAF in UDM as specified in clause 5.2.\nNOTE 1:\tIf the selected target NWDAF instance is the same as the source NWDAF instance (as received from the other consumer in step 0), the target NWDAF will update the existing analytics subscription to the new analytics consumer. Following steps are skipped.\nNOTE 2:\tThe consumer can provide information on the previous analytics subscription when, e.g. the consumer is an AMF and it received information from the old AMF, see clause 5.2.2.2.2 of TS 23.502 [3].\n3a.\t[Option 1] If the target NWDAF decides to request an analytics context transfer from the previously used NWDAF, it may make use of information sent in step 2 (e.g. the provided Subscription Correlation ID) and use the analytics context transfer procedure as specified in clause 6.1B.3. The target NWDAF may receive an ADRF ID or DCCF ID for collecting the historical data and/or analytics.\nIf the target NWDAF supports the accuracy checking capability and the request received in step 2 contains the Analytics Accuracy Request information, the target NWDAF may include in the Nnwdaf_AnalyticsInfo_ContextTransfer request the field Requested Analytics Context Type with value set to Analytics accuracy related information and ML Model accuracy related information (both defined in clause 6.1B.4) in order to retrieve the necessary information for starting, respectively, the analytics accuracy information generation as well as the registration as provider of ML Model accuracy information for the ML model.\n3b-c.\t[Option 2] If the target NWDAF decides to only request historical data and/or analytics, then it may collect the data and/or analytics via Nnf_DataManagement_Subscribe service, where the NFs may be either the ADRF, NWDAF or DCCF, as described in clauses 10.2.6, 7.4.2 and 8.2.2 respectively.\nTarget NWDAF is now ready to generate analytics information and if applicable, analytics accuracy information, taking into account the information received in step 3. The target NWDAF is also able to perform the registration as a new provider for an existing ML model accuracy information process as defined in clause 6.2E.3.2.\n4.\t[Optional] Source NWDAF may purge analytics context after completion of step 3a, if performed and if not already done, unsubscribes from the data source(s) and/or model source(s) that are no longer needed for the remaining analytics subscriptions.\n5.\t[Optional] Target NWDAF may subscribe to relevant data source(s) and/or model source(s), if it is not yet subscribed to the data source(s) and/or model source(s).\nThe procedure in Figure 6.1B.2.2-1 is used by an NWDAF instance to request the transfer of analytics subscription(s) to another NWDAF instance, using the Nnwdaf_AnalyticsSubscription_Transfer service operation defined in clause 7.2.5.\nIf the source NWDAF discovers that the analytics consumer may change concurrently to this procedure, the source NWDAF should not perform the procedure. In such a case, the source NWDAF may send a message to indicate to the analytics consumer that it will not serve this subscription anymore.\nNOTE 1:\tTo discover the possible change of analytics consumer, if the Analytics ID is UE related, the source NWDAF takes actions responding to external trigger (such as UE mobility), for example, checking if the Target of Analytics Reporting is still within the serving area of the analytics consumer, if the serving area information is available.\nNOTE 2:\tHandling of overload situation or preparation for a graceful shutdown are preferably executed inside an NWDAF Set, when available, therefore, not requiring an analytics subscription transfer as described in this clause. The procedure in Figure 6.1B.2.2-1 is applicable for analytics subscription transfer across NF Sets or if the NWDAF is not deployed in a Set.\nThe figure depicts a subscription transfer initiated by a source NWDAF, with the source being identified as NWDAF. The transfer is initiated by the source, which is a subscription to analytics services. The destination is identified as a source, which is a subscription to analytics services. The transfer is initiated by the source, which is a subscription to analytics services. The destination is identified as a source, which is a subscription to analytics services. The transfer is initiated by the source, which is a subscription to analytics services. The destination is identified as a source, which is a subscription to analytics services. The transfer is initiated by the source, which is a subscription to analytics services. The destination is identified as a source, which is a subscription to analytics services. The transfer is initiated by the source, which is a subscription to analytics services. The destination is identified as a source, which is a subscription to analytics services. The transfer is initiated by the source, which is a subscription to analytics services. The destination is identified as a source, which is a subscription to analytics services. The transfer is initiated by the source, which is a subscription to analytics services. The destination is identified as a source, which is a subscription to analytics services. The transfer is initiated by the source,\nFigure 6.1B.2.2-1: Analytics subscription transfer initiated by source NWDAF\n0.\tThe analytics consumer subscribes to analytics from source NWDAF. The analytics consumer may send its NF ID or serving area, enabling NWDAF to determine whether the following analytics subscription transfer procedure is applicable. Optionally the source NWDAF subscribes to UE mobility events.\n1.\t[Optional] Source NWDAF determines, e.g. triggered by a UE mobility event notification, to prepare an analytics subscription transfer to target NWDAF(s), as specified in the procedure illustrated in clause 6.1B.2.3.\n2.\tSource NWDAF determines, e.g. based on the UE location information received and the analytics consumer's serving area either directly received in step 0 or indirectly received via NRF, to perform an analytics subscription transfer to target NWDAF(s). Therefore, the source NWDAF determines the analytics subscription(s) to be transferred to a target NWDAF.\n3.\tSource NWDAF performs an NWDAF discovery and selects the target NWDAF. NWDAF discovery may be skipped if the target NWDAF had already been discovered as part of a prepared analytics subscription transfer. In the case of aggregated analytics from multiple NWDAFs, the source NWDAF may use the set of NWDAF identifiers related to aggregated analytics (see clause 6.1.3) to preferably select a target NWDAF that is already serving the consumer. If the analytics subscription to be relocated to a target NWDAF also includes the Analytics Accuracy Request information, the source NWDAF selects, if possible, a target NWDAF also with accuracy checking capability. If the source NWDAF does not discover a target NWDAF with accuracy checking capability, the source NWDAF notifies the analytics consumer with Accuracy Information Termination. Therefore, the consumer based on local policy may decide to unsubscribe the analytics ID or to keep using the analytics ID even without receiving the accuracy information.\n4.\tSource NWDAF requests, using Nnwdaf_AnalyticsSubscription_Transfer Request service operation, a transfer of the analytics subscription(s) determined in step 2 to the target NWDAF. The request contains a callback URI of the analytics consumer. The request may also contain active data source ID(s) and ML model related information, which are related to the analytics subscriptions requested to be transferred, if not already provided as part of the prepared analytics subscription transfer in the preparation procedure (see step 1). The ML model related information contains the ID(s) of NWDAF(s) containing MTLF that provided the trained models and may contain the file address(es) of the trained ML model(s), where the file address(es) of the trained ML model(s) is included only when the source NWDAF itself provides the trained ML model(s) for the analytics subscription(s) being transferred. The request message may also include \"analytics context identifier(s)\" indicating the availability of analytics context for particular Analytics ID(s).\n5.\tTarget NWDAF accepts the analytics subscription transfer and takes over the analytics generation and if applicable, the analytics accuracy information generation, based on the information received from the source NWDAF.\nThe target NWDAF may use analytics accuracy request information included in the analytics subscription transfer received in step 4 to start the process of checking and generating analytics accuracy information for the consumer of the transfer analytics subscription.\nTarget NWDAF may use the ML model related information, if provided in the Nnwdaf_AnalyticsSubscription_Transfer request. If the ID(s) of NWDAF(s) containing MTLF is provided in the Nnwdaf_AnalyticsSubscription_Transfer request and the NWDAF(s) containing MTLF is part of the locally configured set of NWDAFs containing MTLF, target NWDAF may request or subscribe to the ML model(s) from the indicated NWDAF(s) containing MTLF as specified in clause 6.2A and use the ML model(s) for the transferred analytics subscription. If the file address(es) of the trained ML model(s) is provided and if the NWDAF containing MTLF is part of the locally configured set of NWDAFs containing MTLF, the target NWDAF may retrieve the ML model using the file address of the trained ML model. If the provided ID(s) of NWDAF(s) containing MTLF are not part of the locally configured set of ID(s) of NWDAFs containing MTLF, the target NWDAF discovers the NWDAF(s) supporting MTLF that can provide trained ML model(s) for the Analytics ID(s) as described in clause 5.2.\nNOTE 3:\tIf not yet done during a prepared analytics subscription transfer, the target NWDAF allocates a new Subscription Correlation ID to the received analytics subscriptions.\nNOTE 4:\tThe target NWDAF might already have received information on some/all of the analytics subscriptions as part of the prepared analytics subscription transfer request received in step 1 and, thus, might already have started to prepare for the analytics generation, e.g. by having already subscribed to relevant event notifications.\n6.\tTarget NWDAF informs the analytics consumer about the successful analytics subscription transfer using a Nnwdaf_AnalyticsSubscription_Notify message. A new Subscription Correlation ID, which was assigned by the target NWDAF, is provided in the Subscription Correlation ID and the old Subscription Correlation Id, which was allocated by the source NWDAF, is provided in the Subscription Change Notification Correlation ID parameter of this message as specified in clause 7.2.4.\nNOTE 5:\tNotification correlation information in the Nnwdaf_AnalyticsSubscription_Notify message allows the analytics consumer to correlate the notifications (of analytics output and if applicable of analytics accuracy information) to the initial subscription request made with the source NWDAF in step 0.\nNOTE 6:\tThe existing Analytics context in the source NWDAF is not deleted directly but will be purged first when it was collected by the target NWDAF.\nNOTE 7:\tIf this subscription is used as input for analytics aggregation by the analytics consumer, the analytics consumer might inform the other NWDAFs instance participating in this analytics aggregation that the Set of NWDAF identifiers of NWDAF instances used by the NWDAF service consumer for this analytics aggregation (see clause 6.1.3) has changed using the Nnwdaf_AnalyticsSubscription_Subscribe service operation.\n7.\t[Conditional] If \"analytics context identifier(s)\" had been included in the Nnwdaf_AnalyticsSubscription_Transfer Request received in step 4, the target NWDAF requests the \"analytics context\". The analytics context transfer procedure is specified in clause 6.1B.3.\nIf the transfer request received by the target NWDAF also includes the Analytics Accuracy Request information, the target NWDAF will include in the Nnwdaf_AnalyticsInfo_ContextTransfer request the field Requested Analytics Context Type with value set to Analytics accuracy related information (as defined in clause 6.1B.4) in order to retrieve the necessary information for generating the analytics accuracy information.\nThe target NWDAF may also retrieve from source NWDAF containing AnLF the ML model accuracy information for the ML Model when ML Model accuracy related information context type is included in the \"analytics context identifier(s)\" in the transfer request. Based on the retrieved ML Model accuracy related information, the target NWDAF containing AnLF registers as provider of ML Model accuracy information for the ML model as defined in clause 6.2E.3.2.\n8.\t[Optional] Target NWDAF subscribes to relevant data source(s), if it is not yet subscribed to the data source(s) for the data required for the Analytics.\n9.\tTarget NWDAF confirms the analytics subscription transfer to the source NWDAF.\n10.\t[Optional] Source NWDAF unsubscribes with the data source(s) that are no longer needed for the remaining analytics subscriptions. In addition, Source NWDAF unsubscribes with the NWDAF(s) containing MTLF, if exist, which are no longer needed for the remaining analytics subscriptions.\nNOTE 8:\tAt this point, the analytics subscription transfer is deemed completed, i.e. the source NWDAF can delete all information related to the successfully transferred analytics subscription.\n11-12.\tTarget NWDAF at some point derives new output analytics and analytics accuracy information (if applicable) based on new input data and notifies the analytics consumer about the new analytics and new analytics accuracy information (if applicable) using a Nnwdaf_AnalyticsSubscription_Notify message as specified in clause 6.1.1.\nThe procedure in Figure 6.1B.2.3-1 is used by an NWDAF instance to request another NWDAF instance for a prepared analytics subscription transfer from the source NWDAF instance, using the Nnwdaf_AnalyticsSubscription_Transfer service operation defined in clause 7.2.5.\nNOTE 1:\tThe source NWDAF might determine that it needs to prepare to transfer analytics to another NWDAF instance, e.g. when the source NWDAF estimates for UE related analytics subscription that the UE might enter an area which is not covered by the source NWDAF (e.g. by subscribing to AMF event exposure service for UE mobility event notifications, by performing UE mobility analytics, or by subscribing to another NWDAF providing UE mobility analytics). If the source NWDAF discovers that the analytics consumer may change concurrently to this procedure, the source NWDAF does not perform the procedure. If the procedure makes use of predictions to determine the candidate NWDAFs, care must be taken with regards to load and signalling cost when sending data to an NWDAF that will not eventually start serving the UE.\nNOTE 2:\tThe source NWDAF might also determine that it needs to prepare to transfer analytics subscriptions to another NWDAF instance, as the source NWDAF wants to resolve an internal load situation or prepare for a graceful shutdown.\nNOTE 3:\tHandling of overload situation or preparation for a graceful shutdown are preferably executed inside an NWDAF Set, when available.\nThe figure depicts a prepared analytics transfer, illustrating the process of data transfer between different systems or applications. The diagram shows the flow of data from the source to the destination, with various stages such as data capture, processing, and transmission. The use of arrows and labels helps to visualize the data flow and identify the different components involved in the transfer process. This figure is crucial for understanding the data transfer process and ensuring that data is processed and transmitted correctly.\nFigure 6.1B.2.3-1: Prepared analytics transfer\n0.\tAnalytics consumer subscribes to the source NWDAF for certain analytics as specified in clause 6.1.1.\n0a.\tSource NWDAF starts data collection from relevant data source(s) (e.g. NFs or OAM) as specified in clause 6.2. Source NWDAF starts generating requested analytics.\n0b.\t[Conditional] (Only if the source NWDAF does not serve the whole PLMN and the requested analytics involves UE related data) The source NWDAF subscribes, using Namf_EventExposure_Subscribe service operation, to receive notifications on UE mobility events from AMF.\n1.\tThe source NWDAF determines that it needs to prepare to transfer analytics to another NWDAF instance.\n2.\tThe source NWDAF discovers candidate target NWDAF instances (e.g. NWDAFy and NWDAFz) supporting the requested analytics information for the predicted target area(s). NWDAF discovery and selection is specified in clause 6.3.13 of TS 23.501 [2]. In the case of aggregated analytics from multiple NWDAFs, the source NWDAF may use the set of NWDAF identifiers related to aggregated analytics (see clause 6.1.3) to preferably select a target NWDAF that is already serving the consumer. In the case of the analytics subscription to be transferred also includes an Analytics Accuracy Request information as defined in clause 6.1.3, the source NWDAF takes into consideration in the selection process whether target NWDAF have the accuracy checking capability.\nNOTE 4:\tIn this procedure, NWDAFy and NWDAFz are examples for target NWDAF instances that are candidates to take over those analytic subscriptions.\n3-4.\tIn the case of a prepared analytics subscription transfer, the source NWDAF requests, using Nnwdaf_AnalyticsSubscription_Transfer Request, to the candidate target NWDAFs (e.g. NWDAFy and NWDAFz) to prepare for an analytics subscription transfer by including a \"prepared analytics subscription transfer indication\" in the request message. The request message includes information on the analytics subscriptions to be transferred. The request message may also include \"analytics context identifier(s)\" indicating the availability of analytics context for particular Analytics ID(s).\nThe candidate target NWDAFs (e.g. NWDAFy and NWDAFz) respond to the request from the source NWDAF using a Nnwdaf_AnalyticsSubscription_Transfer Response message.\n5-6.\t[Conditional] If \"analytics context identifier(s)\" had been included in the Nnwdaf_AnalyticsSubscription_Transfer Request received in step 4, the determined target NWDAFs (e.g. NWDAFy and NWDAFz) may request the \"analytics context\" from the source NWDAF by invoking the \"Nnwdaf_AnalyticsInfo_ContextTransferservice\" operation. The analytics context transfer procedure is specified in clause 6.1B.3.\nIf the target NWDAF supports the accuracy checking capability and the request received in steps 3-4 contains the Analytics Accuracy Request information, the target NWDAF includes in the Nnwdaf_AnalyticsInfo_ContextTransfer request the field Requested Analytics Context Type with value set to Analytics accuracy related information (as defined in clause 6.1B.4) in order to retrieve the necessary information for starting the analytics accuracy information. The target NWDAF may also include in the request the Requested Analytics Context Type with value set to ML Model accuracy related information in order obtain the proper information to register as a new provider of ML Model accuracy information for the ML model as defined in clause 6.2E.3.2.\nNOTE 5:\tThe target NWDAFs (e.g. NWDAFy and NWDAFz) can allocate a new Subscription Correlation ID to the received analytics subscriptions.\n7.\t[Optional] Based on the information received from the source NWDAF, the target NWDAFs (e.g. NWDAFy and NWDAFz) start data collection from NFs or OAM (as specified in clause 6.2), analytics generation for the indicated analytics subscriptions and if applicable the analytics accuracy checking and generation (as specified in clause 6.2D).\nNOTE 6:\tAfter step 7, the source NWDAF initiates the analytics subscription transfer to the target NWDAF as specified in steps 4 to 12 of the analytics subscription transfer procedure illustrated in Figure 6.1B.2.2-1.\n8.\tThe source NWDAF cancels the prepared analytics subscription transfer to a candidate target NWDAF (e.g. NWDAFz), using Nnwdaf_AnalyticsSubscription_Transfer Request include an \"analytics subscription transfer cancel indication\". The target NWDAF (e.g. NWDAFz) confirms the cancelation to the source NWDAF and, if applicable, deletes any analytics data that is no longer needed. If the target NWDAF (e.g. NWDAFz), as part of the analytics subscription preparation, had already subscribed to entities to collect data or acquire ML model, it unsubscribes to those entities if the subscriptions are not needed for other active analytics subscriptions with the target NWDAF. If the candidate NWDAF (e.g. NWDAFz), as part of the analytics subscription preparation, had already started the analytics accuracy generation (as specified in clause 6.2D), it cancels the generation and if any extra data collection has been started, this data collection is also stopped, if not used by any other process in the target NWDAF.\nStep 8 may take place any time after step 4 if the NWDAF determines that the candidate target NWDAF (e.g. NWDAFz) does no longer need to prepare for the analytics subscription transfer. In particular, the source NWDAF shall cancel the prepared analytics subscription transfer to all remaining candidate target NWDAFs after one target NWDAF has accepted the analytics subscription transfer (see NOTE 6).\nIf the source NWDAF is not able to discover a target NWDAF with accuracy checking capability, the source NWDAF notifies the analytics consumer with Accuracy Information Termination. Therefore, the consumer may decide to unsubscribe the analytics ID or to keep using the analytics ID even without receiving the accuracy information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1B.3\tAnalytics Context Transfer",
                            "text_content": "The procedure depicted in Figure 6.1B.3-1 is used by an NWDAF instance to request analytics context from another NWDAF instance, using the Nnwdaf_AnalyticsInfo_ContextTransfer service operation as defined in clause 7.3.3. This procedure, for example, can be invoked in the procedures described in clause 6.1B.2 to request the transfer of relevant analytics context.\nThe figure depicts a complex network architecture, illustrating the transfer of analytics context from one system to another. It shows the flow of data and the interactions between different components, such as the analytics engine, the data source, and the target system. The figure is a visual representation of the data flow, highlighting the importance of data management and the need for efficient data transfer in real-time analytics.\nFigure 6.1B.3-1: Analytics Context Transfer\nThe procedure of analytics context information transfer comprises the following steps:\n1.\tThe consumer NWDAF requests analytics context by invoking Nnwdaf_AnalyticsInfo_ContextTransfer request service operation. The parameters that can be provided in the request are listed in clause 6.1B.4.\n2.\tThe provider NWDAF responds with analytics context to the consumer NWDAF. The analytics context that can be provided in the response is listed in clause 6.1B.4.\nIf the provider NWDAF stores analytics context (i.e. Historical output Analytics and/or Data related to Analytics) in ADRF, the provider NWDAF may include in the response the ADRF ID together with an indication of the Analytics Context Type stored in the ADRF (i.e. Historical output Analytics and/or Data related to Analytics).\nUpon receiving the analytics context, the consumer NWDAF may:\n-\tprovide the pending output analytics or historical analytics information to the analytics consumer per the subscription/request;\n-\tuse the historical data and analytics metadata in the analytics context to generate analytics;\n-\tuse the analytics accuracy related information in the analytics context to activate the checking of analytics accuracy information for the transferred analytics ID, generate and provide the analytics accuracy information for the consumer.\nNOTE:\tThe consumer NWDAF can analyse the timestamps of the historical data included in the analytics context in order to obtain the inference configuration used at the source NWDAF for data collection and may decide to use the same inference configuration for the analytics accuracy generation.\n-\tuse the ML model accuracy related information in the analytics context to determine the need for registration at the NWDAF containing MTLF with the information to enable the NWDAF containing MTLF to reassociated the data of the existing subscription for ML model accuracy information to a new ML model accuracy monitoring process at the target NWDAF containing AnLF, reusing the existing data (as further detailed in clause 6.2E.3).\n-\tsubscribe to data collected for analytics with the data sources indicated in the analytics context;\n-\tif the ID(s) of the NWDAF(s) containing MTLF indicated in the analytics context is part of the locally configured (set of) IDs of NWDAFs containing MTLF, retrieve trained ML model(s) from the indicated NWDAF(s) containing MTLF or based on the file address(es) of the trained ML model(s) and use for analytics; and/or\n-\tsubscribe to output analytics from the indicated NWDAFs that collectively serve the transferred analytics subscription and perform analytics aggregation on the output analytics using the analytics metadata information, based on the analytics subscription aggregation information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1B.4\tContents of Analytics Context",
                            "text_content": "The Nnwdaf_AnalyticsInfo_ContextTransfer service operation is used to transfer analytics context from a source NWDAF instance to a target NWDAF instance, whereby the target NWDAF consumes the Nnwdaf_AnalyticsInfo_ContextTransfer service operation produced by the source NWDAF instance to request the analytics context as depicted in Figure 6.1B.3-1.\nThe consumers of the Nnwdaf_AnalyticsInfo_ContextTransfer service operation (as specified in clause 7.3.3) provide the following input parameters:\n-\tA list of analytics context identifier(s): identify a set of analytics context that are available at the NWDAF instance providing this service and that are requested to be transferred to the consumer NWDAF instance. The analytics context identifier is provided as the following:\n-\tSubscription Correlation ID: identifies the analytics subscription for which the related analytics context is requested; or\n-\tA set of SUPI and associated Analytics ID for UE related Analytics; or\n-\tAn Analytics ID for NF related Analytics.\n-\t[OPTIONAL] Requested Analytics Context Type per analytics context identifier: indicates which part of the analytics context the consumer wishes to receive. Following values are specified:\n-\tPending output Analytics;\n-\tHistorical output Analytics;\n-\tAnalytics subscription aggregation information;\n-\tData related to Analytics;\n-\tAggregation related information;\n-\tML Model related information;\n-\tAnalytics accuracy related information.\n-\tML Model accuracy related information.\nNOTE:\tA list of \"analytics context identifier(s)\" can be provided by the source NWDAF to the target NWDAF in an analytics subscriptions transfer request as described in clause 6.1B.2.2. Information allowing to identify an analytics context can also be provided by the NWDAF consumer to the target NWDAF in the Nnwdaf_AnalyticsSubscription_Subscribe request and based on this information the target NWDAF derives the \"analytics context identifier\", as defined in clause 6.1B.2.1.\nThe producer NWDAF provides to the consumer of the Nnwdaf_AnalyticsInfo_ContextTransfer service operation (as specified in clause 7.3.3), the output information listed below:\n-\t(Set of) Analytics context matching the input parameters of the Nnwdaf_AnalyticsInfo_ContextTransfer request. If no Requested Analytics Context type parameters are available in the request, all available analytics context types are sent. Analytics context includes the following information parts, if available:\n-\tAnalytics related:\n-\tPending output analytics (i.e. not yet notified to the consumer).\n-\tHistorical output analytics information. The content of the output analytics is specified in clause 6.1.3 as output information of the Nnwdaf_AnalyticsSubscription_Notify or Nnwdaf_AnalyticsInfo_Request service operations.\n-\tTimestamp(s) of the last output analytics provided to the analytics consumer(s). Value is set to 0 if no output analytics had been sent yet.\n-\tAnalytics subscription aggregation information (only provided when analytics context is related to analytics aggregation): information about the analytics subscriptions that the source NWDAF has with the NWDAFs that collectively serve the transferred analytics subscription, which includes IDs and analytics metadata information of these NWDAFs for specific Analytics ID(s) and optionally input parameters of analytics exposure as defined in clause 6.1.3.\n-\tData related to Analytics:\n-\tHistorical data that is available at the source NWDAF and that is related to the analytics to be handed over to the target NWDAF. If available, the time period of the collected data, NF ID(s) of the data source(s) and information (e.g. filter and event reporting parameters) on the subscriptions with those data sources which were used to generate this historical data.\n-\tAggregation related information: Related to analytic consumers that aggregate analytics from multiple NWDAF subscriptions:\n-\t(Set of) NWDAF identifiers of NWDAF instances used by the NWDAF service consumer when aggregating multiple analytic subscriptions.\n-\tML Model related information:\n-\tID(s) of NWDAF(s) containing MTLF: Instance/Set ID(s) of the NWDAF(s) containing MTLF from which the source NWDAF currently subscribes to the ML Model Information used for the analytics.\n-\tOptionally, file address(es) of the trained ML model(s), which is included only when the source NWDAF itself provides the trained ML model(s) for the analytics subscription(s) for which the related analytics context is requested.\n-\tAnalytics Accuracy related information: The information is related to the parameters of the Analytics Accuracy Request Information and status of the analytics subscription due to NF consumer and NWDAF interactions pausing or resuming the analytics output. It includes:\n-\tTimestamp(s) of the last analytics accuracy information provided to the analytics consumer(s). Value is set to 0 if no analytics accuracy information had been sent yet;\n-\tIndication whether analytics subscription is paused;\n-\tRemaining time window of paused analytics subscription;\n-\tGround truth information: data types and data sources of the ground truth per analytics used for the accuracy information computation.\n-\tML Model accuracy related information: The information is related to the parameters of the ML Model Accuracy Subscription Information requested by a NWDAF containing MTLF. It includes:\n-\toriginal Subscription Correlation ID for the ML Model accuracy information associated with the ML model and/or analytics ID at the source NWDAF containing AnLF;\n-\tNWDAF containing AnLF NF ID of source NWDAF;\n-\tThe parameters used for the subscription for ML model accuracy information for the given ML Model at the source NWDAF containing AnLF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.1C\tNWDAF Registration/Deregistration in UDM",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1C.1\tGeneral",
                            "text_content": "The procedures in this clause are applicable to UE-related analytics (e.g. UE mobility analytics) for some network deployments, e.g. such with an NWDAF co-located to an AMF or SMF, where the NWDAF is configured to register in UDM for the UEs that it is serving or collecting data for and for the related Analytics ID(s). The procedures in this clause are also applicable to analytics that are not UE-related, when the NWDAF collects UE-related data. This enables NWDAF service consumers to discover the NWDAF instance that is already serving the UE for one or more Analytics ID(s).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1C.2\tNWDAF Registration in UDM",
                            "text_content": "Figure 6.1C.2-1 shows the procedures for registration of the NWDAF in UDM for UE-related analytics or UE-related data collection.\nThe figure depicts a NWDAF registration in UDM, which is a crucial step in the process of network virtualization. NWDAF stands for Network Virtualization Data Association Format, and it is used to establish a connection between virtualized network elements. In this case, the figure shows the registration process for a UDM (Unified Data Management) network, which is a type of network virtualization. The figure illustrates the steps involved in registering the NWDAF, including the use of a registration tool and the process of associating the NWDAF with the UDM network.\nFigure 6.1C.2-1: NWDAF registration in UDM\n1.\tNWDAF triggers a registration in UDM, e.g. based on local configuration in the NWDAF, the reception of a new Analytics subscription request, start of collection of UE related data or an OAM configuration action.\n2.\tThe NWDAF registers into UDM for the served UE, by sending Nudm_UECM_Registration request (UE ID, NWDAF ID, Analytics ID(s)).\n3.\tUDM sends a response to NWDAF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1C.3\tNWDAF De-registration from UDM",
                            "text_content": "Figure 6.1C.3-1 shows the procedures for deregistration of the NWDAF in UDM.\nThe figure depicts a de-registration process from the NWDAF (Non-Wavelength-Division Multiplexing) system, which is a method used in optical communication networks to de-register a wavelength from a multiplexed signal. The NWDAF system is used to de-register a wavelength from a signal that is being transmitted over a fiber-optic backbone. The figure shows the process of de-registering the wavelength from the signal, with the de-registration process being carried out at the optical line terminal (OLT). The figure also includes a visual representation of the de-registration process, with the wavelength de-registered from the signal being highlighted.\nFigure 6.1C.3-1: NWDAF de-registration from UDM\n1.\tNWDAF triggers a de-registration from a previous registration in UDM. This trigger may be that, e.g. the NWDAF has purged the analytics context for the UE (see clause 6.1B.4) for related Analytics ID(s), the NWDAF is no longer collecting data related to the UE, or an administrative action.\n2.\tNWDAF sends Nudm_UECM_Deregistration request (UE ID, NWDAF ID, Analytics ID(s)).\n3.\tUDM sends a response to NWDAF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2\tProcedures for Data Collection",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tGeneral",
                            "text_content": "The Data Collection feature permits NWDAF to retrieve data from various sources (e.g. NF such as AMF, SMF, PCF, NSACF, GMLC and AF; OAM), as a basis of the computation of network analytics.\nAll available data encompass:\n-\tOAM global NF data,\n-\tData available in NFs, e.g. behaviour data related to individual UEs or UE groups (e.g. UE reachability) and pre-computed metrics covering UE populations (e.g. number of UEs present in a geographical area), per spatial and temporal dimensions (e.g. per region for a period of time),\n-\tNF data available in the 5GC (e.g. NRF),\n-\tData available in AF.\nWhen DCCF, ADRF, MFAF or NWDAF hosting DCCF or ADRF are present in the network, the data collection also follows the principles described in clause 6.2.6.\nThe NWDAF shall use at least one of the following services:\n-\tthe Generic management services as defined in TS 28.532 [6], the Performance Management services as defined in TS 28.550 [7] or the Fault Supervision services as defined in TS 28.545 [9], offered by OAM in order to collect OAM global NF data.\n-\tthe Exposure services offered by NFs in order to retrieve data and other non-OAM pre-computed metrics available in the NFs.\n-\tOther NF services in order to collect NF data (e.g. NRF)\n-\tDCCF data management service to retrieve data using DCCF.\nThe NWDAF shall obtain the proper information to perform data collection for a UE, a group of UEs or any UE:\n-\tFor an Analytics ID, NWDAF is configured with the corresponding NF Type(s) and/or event ID(s) and/or OAM measurement types.\n-\tNWDAF shall determine which NF instance(s) of the relevant NF type(s) are serving the UE, the group of UEs or any UE, taking into account the S-NSSAI(s) and area of interest as defined in clause 7.1.3 of TS 23.501 [2].\n-\tNWDAF invokes Nnf_EventExposure_Subscribe services to collect data from the determined NF instance(s) and/or triggers the procedure in clause 6.2.3.2 to subscribe to OAM services to collect the OAM measurement.\nThe NWDAF performs data collection from an AF directly as defined in clause 6.2.2.2 or via NEF as defined in clause 6.2.2.3. According to the data collection request, the AF may further perform data collection from UE (see clause 6.4.2 and clauses 6.5.2-6.5.4) as defined in clause 6.2.8.\nThe NWDAF shall be able to discover the events supported by a NF.\nData collection procedures enables the NWDAF to efficiently obtain the appropriate data with the appropriate granularity.\nWhen a request or subscription for statistics or predictions is received, the NWDAF may not possess the necessary data to perform the service, including:\n-\tData on the monitoring period in the past, which is necessary for the provision of statistics and predictions matching the Analytics target period.\n-\tData on longer monitoring periods in the past, which is necessary for model training.\nTherefore, in order to optimize the service quality, the NWDAF may undertake the following actions:\n-\tThe NWDAF may return a confidence parameter as stated in clause 6.1.3 expressing the confidence in the prediction produced. Prediction may be returned with zero confidence as described below. This confidence is likely to grow in the case of subscriptions.\n-\tThe value of the confidence depends on the level or urgency expressed by the parameter \"preferred level of accuracy\" as listed in clause 6.1.3, the parameter \"time when analytics information is needed\" as listed in clause 6.1.3 and the availability of data. If no sufficient data is collected to provide an estimation for the preferred level of accuracy before the time deadline, the service shall return a zero confidence. Otherwise, the NWDAF may wait until enough data is collected before providing a response or a first notification.\n-\tIn order to be prepared for future requests on analytics from NFs/OAM, the NWDAF, upon operator configuration, may collect data on its own initiative, e.g. on samples of UEs and retain the data collected in the data storage.\nNOTE 1:\tThe NWDAF can send an error response to the analytics consumer to indicate that statistics are unavailable if the NWDAF was not prepared for future requests and did not collect data on its own initiative.\nThe volume and maximum duration of data storage is also subject to operator configuration.\nThe NWDAF may decide to reduce the amount of data collected to reduce signalling load, by either prioritizing requests received from analytics consumers, or reducing the extent (e.g. duration, scope) of data collection, or modifying the sampling ratios. When using sampling ratio, the NWDAF may, depending on the analytics required and based on local configuration, provide additional partitioning criteria to the NFs to allow for a better UEs representation and to request that the NFs first partition the UEs before applying sampling ratio (see Event Reporting Information as specified in TS 23.502 [3]). The NWDAF may provide one or multiple partitioning criteria in its request for data collection from NFs.\nIn order to optimize the performance and accuracy of data collection and reporting and reduce the impact on data producers, the NWDAF may request subscriptions to the NFs with the variable reporting periodicity parameter. Depending on the condition provided as part of this parameter, different reporting periodicity are used. The condition is the load of the NF.\nThe NWDAF may skip data collection phase when the NWDAF already has enough information to provide requested analytics.\nThe data which NWDAF may collect is listed for each analytics in input data clause and is decided by the NWDAF.\nNOTE 2:\tNWDAF can skip data collection phase for some specific input data per the requested analytics e.g. when some of the data is already available at NWDAF for the requested analytics, or when NWDAF considers that some of the data is not needed at all to provide the requested analytics as per the analytics consumer request (e.g. based on preferred level of accuracy or based on the time when analytics are needed).\nEvent exposure subscriptions for data collection from the AMF and the SMF may need to survive after the removal of UE context in the AMF including event exposure subscriptions, or upon the creation of new UE context in AMF or SMF. In order for event exposure subscriptions in AMF and SMF to be (re)created in these cases, the NWDAF may subscribe to the events in AMF and/or SMF via UDM for a UE or group of UEs, as specified in clause 4.15.4.4 of TS 23.502 [3].\nIn hierarchical interactions among NWDAFs, without standalone DCCF, or co-located DCCF, the efficiency of data collection can be achieved by inter-NWDAF instance cooperation among NWDAF instances on different levels of the hierarchy. An efficient data collection means that the same data required for the same Analytics ID or different Analytics IDs should not be collected multiple times by the different NWDAFs of the hierarchy.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tData Collection from NFs",
                            "text_content": "The Data Collection from NFs is used by NWDAF to subscribe/unsubscribe at any 5GC NF to be notified for data on a set of events.\nThe Data Collection from NFs is based on the services of AMF, SMF, UDM, PCF, NRF, NSACF, UPF and AF (possibly via NEF):\n-\tEvent Exposure Service offered by each NF as defined in clause 4.15 and clause 5.2 of TS 23.502 [3].\n-\tother NF services (e.g. Nnrf_NFDiscovery and Nnrf_NFManagement in NRF as defined in clause 4.17 of TS 23.502 [3])\nThis data collection service is used directly in order to retrieve behaviour data for individual UEs or groups of UEs (e.g. UE reachability) and also to retrieve global UE information (e.g. Number of UEs present in a geographical area).\nTable 6.2.2.1-1: NF Services consumed by NWDAF for data collection\n\nNOTE 1:\tThere is no data collected from the PCF by the NWDAF defined in this Release of the specification.\nNOTE 2:\tThe Nudm_EventExposure can be used when NWDAF uses the procedures specified in clause 4.15.4.4 of TS 23.502 [3] to subscribe to AMF or SMF via UDM.\nTo retrieve data related to a specific UE, there are two cases:\n-\tIf no Area of interest is indicated by the consumer, the NWDAF shall first determine which NF instances are serving this UE as stated in table 6.2.2.1-2 unless the NWDAF has already obtained this information due to recent operations related to this UE.\n-\tIf an Area of interest is indicated, the NWDAF can:\n-\tFirst determine the AMF serving the UE and subscribe UE location from the AMF. Once the UE is in or moves into the Area of interest, the NWDAF determines which NF instances are serving this UE as stated in table 6.2.2.1-2 unless the NWDAF has already obtained this information due to recent operations related to this UE; or\n-\tDetermine the NF instances of a given type of network function serving the Area of interest by querying NRF unless the NWDAF has already obtained this information due to recent operations related to this UE.\nTable 6.2.2.1-2: NF Services consumed by NWDAF to determine which NF instances are serving a UE\n\nThe UDM instance should be determined using NRF as described in clause 4.17.4 of TS 23.502 [3] and factors to determine as described in clause 6.3.8 of TS 23.501 [2].\nThe AMF, SMF instances should be determined using a request to UDM providing the SUPI. To determine the SMF serving a PDU session, the NWDAF should in addition provide the DNN and S-NSSAI of this PDU Session; otherwise the NWDAF will obtain a list of possibly multiple SMFs (e.g. one per PDU session).\nThe BSF instance should be discovered using NRF thanks to optional request parameters (e.g. DNN list, IP domain list, IPv4 address range, IPv6 prefix range) as stated in clause 4.17.4 of TS 23.502 [3] or based on local configuration at the NWDAF.\nThe PCF instance serving UE PDU Session(s) should be determined using a request to BSF with the allocated UE address, DNN and S-NSSAI.\nTo collect data (e.g. current number of UEs registered in a network slice or current number of PDU Sessions established in a network slice) from NSACF, the NSACF instance should be discovered using NRF as specified in clause 6.3.22 of TS 23.501 [2] or based on local configuration at the NWDAF.\nWhen NWDAF receives a request addressed to an Internal Group ID from a consumer, NWDAF may need to initiate data collection from several 5GC NFs, such as AMF, SMF, UDM, PCF, AF (e.g. via NEF), etc. If an Area of interest is indicated by the consumer, NWDAF may first discover the instances of the required 5GC NFs deployed in the network, e.g. by querying NRF, otherwise:\n-\tFor discovering the UDM, NWDAF can query the NRF with the Internal Group ID as the target of the query.\n-\tFor discovering AMF, SMF, PCF, NEF and AF, NWDAF may need to discover all instances in the network by using the Nnrf_NFDiscovery service.\nNOTE 3:\tIt is assumed that all members of an Internal Group ID belong to the same UDM Group ID. NWDAF can select a UDM instance supporting the UDM Group ID of the Internal Group ID.\nThen, if data needs to be collected from AMF, SMF, UDM and PCF, NWDAF may initiate the data collection with the Internal Group ID as the target, e.g. subscribing to the event exposure in all the instances of a given type of network function. This subscription to all the instances of required source of event exposure handles, e.g. mobility of UEs across AMFs, or initiation of new PDU sessions with different allocated SMFs.\nFor collecting data from AMF and SMF, NWDAF may collect the data directly from AMF and/or SMF, or indirectly via UDM, according to clause 4.15.4.4 of TS 23.502 [3]. The indirect method may be required if the event exposure subscription from NWDAF, for a UE or group of UEs, needs to survive the removal of UE context in the AMF including event exposure subscriptions, or upon the creation of new UE context in AMF or SMF serving the UE or group of UEs. In this case the UDM is responsible for (re)creating event exposure subscriptions in AMF and SMF, as specified in clause 4.15.4.4 of TS 23.502 [3].\nThe NWDAF determines to collect data from a trusted AF supporting specific Event ID(s) and serving specific application(s) based on internal configuration.\nThe NEF instance that is serving a specific network slices and/or applications of a UE should be determined using NRF using optional request parameters as defined in clause 6.3.14 of TS 23.501 [2]\nIf NWDAF needs to collect data from an AF deployed outside the operator's domain, the NWDAF shall contact NEF with a SUPI or Internal Group ID as the target of the data collection. NEF is responsible for translation of SUPI to GPSI, or internal to external group identifiers, by querying UDM, prior to contacting the AF.\nNOTE 4:\tIt is assumed that an AF is provisioned with the list of UE IDs (GPSIs or SUPIs) belonging to an External or Internal Group ID.\nNWDAF may collect data directly from UPF for a specific UE, a group of UEs or for any UEs as defined in clause 5.8.2 of TS 23.501 [2] and in clause 4.15.4.5 of TS 23.502 [3]. NWDAF may subscribe indirectly via SMF or directly to UPF for UPF data collection. The direct subscription to UPF event exposure service is only for data collection for any UE e.g., to collect user data usage information for NWDAF NF Load analytic, and if the subscription is not including any of the parameters described in Table 4.15.4.5.1-1 of TS 23.502 [3].\nNOTE 5:\tTo avoid causing high UPF load due to extensive reporting related to all traffic flows, the NWDAF can preferably subscribe for reporting for some UEs only.\nTo retrieve required data for any UE, the NWDAF may subscribe to events from the AMF and/or SMF instances or UPF instances it has determined, setting the target of event reporting to \"any UE\" and the event filter(s) according to the Analytics Filter Information. Alternatively, if the required data is communication related and for any UE within an Area of interest, the NWDAF can obtain from the AMF instances it has determined a list of UEs located within the Area of Interest. Based on the obtained UE list, for each UE in the list, the NWDAF retrieves the SMF serving the UE and the NWDAF subscribes to data from the relevant SMF per each specific UE. The indirect event exposure subscription to AMF or SMF via UDM is not available for \"any UE\" or \"any UE within an Area of interest\". If the required data is collected from UE via AF as described in clause 6.2.8 and the Target of Analytics Reporting received from consumer is \"any UE\", the NWDAF may either set the target of event reporting to \"any UE\" in the data collection request to the AF, or may determine a list of UEs from AMF and/or SMF based on the Analytics Filter Information and send the data collection request to the AF for the determined list of UEs.\nNOTE 6:\tIf NWDAF requires collecting data from either AMF or SMF for \"any UE\" or \"any UE within an Area of Interest\", NWDAF can use the direct Event Exposure subscription to AMF or SMF, since subscriptions to \"any UE\" or \"any UE within an Area of Interest\" are persistent by nature in AMF or SMF, due to not being linked to a UE context.\nTo retrieve data related to \"any UE\" based on Analytics Filter Information, the NWDAF shall first determine which NF instances are matching the Analytics Filter Information (see clause 6.7.5.1) as stated in table 6.2.2.1-3 unless the NWDAF has already obtained this information due to recent operations related to this Analytics Filter Information.\nTable 6.2.2.1-3: NF Services consumed by NWDAF to determine which NF instances are matching analytics filters\n\nTo retrieve data related to Analytics IDs for \"any UE\" with Analytics Filter Information defining an area of interest in terms of TA or Cells and/or with specific S-NSSAIs, NWDAF requires the network slice association information to properly determine the AMFs to collect data from as well as the proper queries to OAM for data collection.\nNOTE 7:\tExamples of Analytics ID requiring NWDAF to use network slice association information for data retrieval are: network performance clause 6.6.1; user data congestion clause 6.8.1; QoS Sustainability clause 6.9; Dispersion Analytics clause 6.10.1; observed service experience for a Network Slice clause 6.4.1; and slice load analytics clause 6.3.\nThe network slice association information comprises the TAs associated with each AMF and for each TAI its associated access type, cells and list of supported S-NSSAIs (including indication of S-NSSAIs restricted by AMF). Additionally, the mapping of cells per TAI and supported S-NSSAIs (including indication of S-NSSAIs restricted by AMF) for TAI for each AMF can change and NWDAF shall obtain this accurate information in order to properly retrieve data for analytics generation.\nIn order to derive the network slice association information, NWDAF may be configured with the mapping of cells per TAI and the S-NSSAIs per TAI. NWDAF may subscribe to the \"S-NSSAIs per TAI mapping\" event exposed by AMF. The NWDAF may use the configured information (when the analytics subscription or request is at cell granularity) and the area of interest in the analytics subscription or request to retrieve from AMF the list of supported S-NSSAIs (including indication of S-NSSAIs restricted by AMF) per TAI and access types per TAI for each AMF in the required area of interest. NWDAF consumes the \"S-NSSAIs per TAI mapping\" event exposed by AMF using, as target of event reporting, the list of TAIs based on the area of interest received in the Analytics Filter Information or identified by the mapping of the Cells per TAI matching to the Cell granularity included in the Analytics Filter Information. The AMF \"S-NSSAIs per TAI mapping\" event output contains, for each of the TAIs requested by NWDAF, its associated access type and the list of supported S-NSSAIs (including indication of S-NSSAIs restricted by AMF).\nTo retrieve data from SMFs for Analytics IDs subscription or requests for \"any UE\" including Analytics Filter Information with specific Applications, DNNs, DNAIs and area of interest per TA granularity, NWDAF shall first discover the SMF serving the area of interest via NRF.\nNOTE 8:\tExamples of Analytics ID requiring NWDAF to collect data related to PDU sessions associated with an AoI with TA granularity are: network performance clause 6.6.1; user data congestion clause 6.8.1, QoS Sustainability clause 6.9.\nNWDAF may directly consume events from the discovered SMF using the event target set to \"any PDU session\" and event filters with the same parameters of the Analytics Filter Information, i.e. list of Application IDs and/or DNNs and/or DNAI and the area of interest related to the requested Analytics ID.\n1.\tWhen SMF supports the exchange of UE Location parameter when SMF interacts with AMF via Nsmf_PDUSession_Create/Update/CreateSMContext/UpdateSMContext due to session establishment, modification, or release, service request, or handover procedures (as defined in clause 5.2.8.2 of TS 23.502 [3]), SMF can directly map the PDU sessions to an AoI with TA granularity.\nIf there are any changes in PDU sessions in the area of interest, for the Application ID and/or DNN and/or DNAI subscribed by NWDAF, SMF notifies the detected changes to NWDAF via Nsmf_EventExposure_Notify service operation, enabling NWDAF to keep an updated map of SMF and PDU sessions associated with the Analytics Filter Information in an area of interest.\n2.\tWhen SMF does not support the exchange of UE Location parameter when SMF interacts with AMF but supports the mapping of PDU sessions per TA (as defined in clause 5.6.11 of TS 23.501 [2]), SMF may subscribe to UE mobility event notifications of AMF as described in clause 5.3.4.4 of TS 23.501 [2] using event ID \"UE moving in or out of Area of Interest\" and Event Filters as described in Table 5.2.2.3.1-1 from TS 23.502 [3] to retrieve the list of SUPIs (and GPSIs if available) in the area of interest. Based on the retrieved list of SUPIs in the area of interest, SMF identifies the PDU sessions in the area of interest.\n3.\tWhen SMF does not support the exchange of UE Location parameter when SMF interacts with AMF nor supports the mapping of PDU sessions per TA (as defined in clause 5.6.11 of TS 23.501 [2]), SMF rejects the request from NWDAF. Upon the reject, NWDAF identifies the need to create the mapping of PDU sessions per TA. NWDAF subscribes to UE mobility event notifications of AMF as described in clause 5.3.4.4 of TS 23.501 [2] using event ID \"UE moving in or out of Area of Interest\" and Event Filters as described in Table 5.2.2.3.1-1 from TS 23.502 [3] to retrieve the list of SUPIs (and GPSIs if available) in the area of interest. Based on the retrieved list of SUPIs in the area of interest, NWDAF subscribes to the SMFs serving the UEs in the area of interest and derives the mapping of PDU sessions per TA.\nAn NWDAF may require to discover and select other NWDAFs for UE related analytics. In this case, the NWDAF may discover from UDM if an NWDAF is already collecting data related to the UE, as specified in clauses 5.2 and 6.1C.\nThe procedure in Figure 6.2.2.2-1 is used by NWDAF to subscribe/unsubscribe at NFs in order to be notified for data collection on a related event (s), using Event Exposure Services as listed in Table 6.2.2.1-1. Depending on local regulation requirements, user consent for UE related data collection and usage of collected data may be required. User consent is defined for a specific purpose such as, e.g. analytics or model training. NWDAF checks user consent taking the purpose for data collection and usage of these data into account.\nThe figure depicts a simplified representation of event exposure subscribe/unsubscribe for NF (Network Function) in a network. It shows the event exposure subscription and unsubscription process for NF, which is a crucial component in network management and security. The figure illustrates the flow of events, including the subscription and unsubscription of NF events, and the role of the subscriber and the network function in managing these events.\nFigure 6.2.2.2-1: Event Exposure Subscribe/unsubscribe for NFs\n1.\tThe NWDAF checks if data is to be collected for a user, i.e. SUPI or GPSI, then, depending on local policy and regulations, the NWDAF checks the user consent by retrieving the user consent information from UDM using Nudm_SDM_Get including data type \"User consent\". If user consent is not granted, NWDAF does not subscribe to event exposure for events related to this user and the data collection for this SUPI or GPSI stops here.\n2.\tIf the user consent is granted, the NWDAF subscribes to UDM to notifications of changes on subscription data type \"User consent\" for this user using Nudm_SDM_Subscribe.\n3.\tThe NWDAF subscribes to or cancels subscription for a (set of) Event ID(s) by invoking the Nnf_EventExposure_Subscribe/Nnf_EventExposure_Unsubscribe service operation.\nNOTE 1:\tThe Event ID(s) are defined in TS 23.502 [3].\n4.\tIf NWDAF subscribes to a (set of) Event ID(s), the NFs notify the NWDAF (e.g. with the event report) by invoking Nnf_EventExposure_Notify service operation according to Event Reporting Information in the subscription.\nWhen the Reporting type is provided at step 1, the NWDAF determines that the events are disappeared, if the same events are included in the notification compared to the previous notification. Otherwise, NWDAF determines the events are newly appeared or changed. Also, the NWDAF restores the events that are not included in the notification, but included in the previous notification.\nIf the Granularity of dynamics is applied to the subscription, the NWDAF shall infer the events in the NF from the events in the previous notification with the applied Granularity of dynamics.\nNOTE 2:\tThe Event Reporting Information are defined in TS 23.502 [3].\nNOTE 3:\tThe NWDAF can use the immediate reporting flag as defined in Table 4.15.1-1 of TS 23.502 [3] to meet the request-response model for data collection from NFs.\nNOTE 4:\tThis procedure is also used when the NWDAF subscribes for data from a trusted AF.\n5.\tThe UDM may notify the NWDAF on changes of user consent at any time after step 2.\n6-7.\tIf user consent is no longer granted for a user for which data has been collected, the NWDAF shall unsubscribe to any Event ID to collect data for that SUPI or GPSI. The NWDAF may unsubscribe to be notified of user consent updates from UDM for each SUPI for which data consent has been revoked.\nThe procedure in Figure 6.2.2.3-1 is used by NWDAF to collect information from AFs via the NEF.\nNOTE 1:\tIn this release, AF registers its available data to NWDAF via OAM configuration at NEF.\nThe AF collectable data information includes: AF identification, AF service identification (e.g. endpoint information of Naf_EventExposure), available data to be collected per application (e.g. identified by Event ID(s)).\nThe figure depicts a network infrastructure for data collection from the airfield, with a focus on the use of Near-Field Communication (NFC) technology. The figure shows the various components involved in data collection, including antennas, data collection devices, and the network infrastructure. The figure illustrates the importance of NFC technology in enabling wireless communication between devices, such as mobile phones and drones, to collect data from the airfield.\nFigure 6.2.2.3-1: Data Collection from AF via NEF\n1a.\tAfter the registration of AF available data at the NEF, NEF generates an event exposure with new EventID to be associated with available data to be collected from AF. NEF invokes Nnrf_NFManagement_NFUpdate_request service operation to update its registration information (i.e. NEF Profile) including the generated Event IDs and associated AF identification, Application ID(s) (i.e. internal application ID or Application ID known in the core network).\n1b.\tNRF stores the received NEF registration information including available data to be collected from AF.\n1c.\tNRF sends Nnrf_NFManagement_NFUpdate_response message to NEF.\n1d.\tWhen NWDAF needs to discovery the available data from AFs and the appropriated NEF to collect this data, NWDAF invokes Nnrf_NFDiscovery_Request_request service operation using as parameter the NEF NF Type, a list of Event ID(s) and optionally AF identification, application ID.\n1e.\tNRF matches the requested query for available data in AFs with the registered NEF Profiles and sends this information via Nnrf_NFDiscovery_Request_response message to NWDAF.\nNOTE 2:\tAfter the registration and discovery procedure described in step 1, NWDAF identifies the available data per AF per application and the proper NEF to collect such data.\n2.\tThe NWDAF subscribes to or cancels subscription to data in AF via NEF by invoking the Nnef_EventExposure_Subscribe or Nnef_EventExposure_Unsubscribe service operation. If the event subscription is authorized by the NEF, the NEF records the association of the event trigger and the NWDAF identity.\nNOTE 3:\tUser consent for retrieving user data in AF via NEF is not specified in this Release.\n3.\tBased on the request from the NWDAF, the NEF subscribes to or cancels subscription to data in AF by invoking the Naf_EventExposure_Subscribe/ Naf_EventExposure_Unsubscribe service operation.\n4.\tIf the NEF subscribes to data in AF, the AF notifies the NEF with the data by invoking Naf_EventExposure_Notify service operation according to Event Reporting Information in the subscription.\n5.\tIf the NEF receives the notification from the AF, the NEF notifies the NWDAF with the data by invoking Nnef_EventExposure_Notify service operation.\nWhen the Reporting type is provided at step 2, the NWDAF determines that the events are disappeared, if the same events are included in the notification compared to the previous notification. Otherwise, NWDAF determines the events are newly appeared or changed. Also, the NWDAF restores the events that are not included in the notification, but included in the previous notification.\nIf the Granularity of dynamics is applied to the subscription, the NWDAF shall infer the events in the AF from the events in the previous notification and the applied Granularity of dynamics.\nThe NWDAF may use NRF services and Network Function service framework procedures as defined in clause 5.2.7 and clause 4.17 of TS 23.502 [3]:\n-\tNF/NF service discovery procedures (in clause 4.17.4 of TS 23.502 [3]) and Nnrf_NFDiscovery service (in clause 5.2.7.3 of TS 23.502 [3]) in order to dynamically discover the NF instances and services of the 5GC. Such discovery may be performed on a periodic basis, or under specific circumstances.\n-\tNF/NF service status subscribe/notify procedures (in clause 4.17.7 of TS 23.502 [3]) and Nnrf_NFManagement service (in clause 5.2.7.2 of TS 23.502 [3]) in order to be notified about the change of status of an NF. The service operations for obtaining status information are NFStatusSubscribe and NFStatusNotify, from the Nnrf_NFManagement service.\nThe information provided by the NRF to the NWDAF with the Nnrf_NFDiscovery_Request and the Nnrf_NFManagement_NFStatusNotify service operations are the NF Profiles and the NF services as defined in clause 5.2.7 of TS 23.502 [3]. Such information can be used to set-up and maintain a consistent network map for data collection and also, depending on use cases, to perform analytics (e.g. NF load analytics as defined in clause 6.5).\nIf the NWDAF needs to keep a consistent network map for data collection from AMFs and SMFs associated with a list of TAs, the subscription to NFStatusSubscribe for such type of NFs may include the list of TAs target.\nThe NWDAF shall subscribe (and unsubscribe) to the Event exposure service from NF(s) reusing the framework defined in clause 4.15 of TS 23.502 [3]. This framework supports the possibility for the NWDAF to indicate/request:\n-\tEvents-ID: one or multiple Event ID(s) defined in clause 4.15.1 of TS 23.502 [3].\n-\tTarget of Event Reporting defined in clause 4.15.1 of TS 23.502 [3]: the objects targeted by the Events. Within a subscription, all Event ID(s) are associated with the same target of event reporting. In the case of NWDAF, the objects can be UE(s), UE group(s), any UE.\n-\tEvent Filter Information defined in clause 4.15.1 of TS 23.502 [3]. This provides Event Parameter Types and Event Parameter Value(s) to be matched against.\n-\tA Notification Target Address and a Notification Correlation ID as defined in clause 4.15.1 of TS 23.502 [3], allowing the NWDAF to correlate notifications received from the NF with this subscription.\n-\tEvent Reporting Information described in TS 23.502 [3] Table 4.15.1-1 and the muted stored events exposure as described in clause 6.2.7.\n-\tExpiry time as defined in clause 4.15.1 of TS 23.502 [3].\nThe notifications from NFs/AFs contain on top of the Event being reported (and of dedicated information being reported for this event):\n-\tthe Notification Correlation Information provided by the NWDAF in its request;\n-\t(when applicable to the event) the Target Id e.g. UE ID (SUPI and if available GPSI); and\n-\ta time stamp.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.2.2.1-1: NF Services consumed by NWDAF for data collection",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.1-2: NF Services consumed by NWDAF to determine which NF instances are serving a UE",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.1-3: NF Services consumed by NWDAF to determine which NF instances are matching analytics filters",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.2.3\tData Collection from OAM",
                            "text_content": "The NWDAF may collect relevant management data from the services in the OAM as configured by the PLMN operator.\n‐\tNG RAN or 5GC performance measurements as defined in TS 28.552 [8].\n‐\t5G End to end KPIs as defined in TS 28.554 [10].\nNWDAF shall use the following services to have access to the information provided by OAM:\n-\tGeneric performance assurance and fault supervision management services as defined in TS 28.532 [6].\n‐\tPM (Performance Management) services as defined in TS 28.550 [7].\n‐\tFS (Fault Supervision) services defined in TS 28.545 [9].\nEditor's note:\tThe MDA services are to be defined by SA WG5 and NWDAF could subscribe to them. The reference to SA WG5 specification will be added when defined in SA WG5.\nNWDAF can be configured to invoke the existing OAM services to retrieve the management data that are relevant for analytics generation, which may include NF resources usage information (e.g. usage of virtual resources assigned to NF) and NF resource configuration information (e.g. life cycle changes of NF resource configurations).\nOAM perform the required configuration in order to provide the information requested by NWDAF subscription and perform the tasks, e.g. data collection, data processing, associated with the subscribed request from NWDAF.\nAnother usage of OAM services is when the target of data collection is a specific UE, via MDT based retrieval of information:\n-\tMeasurement collection for MDT as defined in TS 37.320 [20].\nIn addition, NWDAF can be provisioned with Network Slice information (i.e. as defined by the NetworkSliceInfo specified in TS 28.541 [22]) when a slice is created or modified via OAM configuration mechanism as defined in TS 28.541 [22] and TS 28.532 [6].\nThe interactions between NWDAF and OAM for data collection are illustrated in Figure 6.2.3.2-1. The data collected depends on the use cases. This figure is an abstraction of the OAM performance data file report management service that is defined TS 28.532 [6]. The actual OAM services and reporting mechanisms that NWDAF may use are specified in TS 28.532 [6], TS 28.550 [7] or TS 28.545 [9].\nThe flow below assumes the NWDAF is configured on how to subscribe to the relevant OAM services.\nOAM shall setup the required mechanisms to guarantee the continuous data collection requested by NWDAF.\nThe figure depicts a data collection process from an OAM performance data file report management service, illustrating the steps involved in collecting data from various sources. The figure includes a flowchart, which outlines the steps from data collection to report generation, and a table that lists the data sources and their corresponding data points. The figure is essential for understanding the data collection process and ensuring accurate and reliable data reporting.\nFigure 6.2.3.2-1: Data collection from OAM performance data file report management service\n1.\t(Clause 11.6.1.3.2 of TS 28.532 [6]), Subscribe (Input): NWDAF subscribes to the notification(s) related to the services provided by the management service producer.\n2.\t(Clause 11.6.1.3.3 of TS 28.532 [6]), Subscribe (Output): management service producer responses to NWDAF if the subscription is success or not.\n3.\tData processing: management service producer prepares the data.\n4.\t(Clause 11.6.1.1 of TS 28.532 [6]), Notification (notifyFileReady): management service producer notifies the data file is ready.\nAs the final step, NWDAF fetches data by using file transfer protocols as defined in clause 11.6.2 of TS 28.532 [6].\nNOTE 1:\tThe call flow in Figure 6.2.3.2-1 only shows a subscribe/notify model for the simplicity, however both request-response and subscription-notification models are supported.\nNOTE 2:\tNWDAF is configured with the Network Slice information (i.e. NetworkSliceInfo including a DN (Distinguished Name) of the NetworkSlice managed object relating to the network slice instance associated to the S-NSSAI and NSI ID if available as defined in TS 28.541 [22]). Based on the Network Slice information, the NWDAF uses the DN (Distinguished Name) to identify the NetworkSlice managed object relating to the S-NSSAI and NSI ID and consumes the management services to collect the management data of the corresponding NetworkSlice managed object (including the NRF serving the network slice, the NFs associated to the network slice, the NG RAN or 5GC performance measurements defined in TS 28.552 [8], or the 5G end to end KPIs defined in TS 28.554 [10]) provided by OAM.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.4\tCorrelation between network data and service data",
                            "text_content": "The Correlation information in input data which helps NWDAF correlate data from different NFs, OAM and UE application(s) is defined in Table 6.2.4-1, which is subject to all the network data analytics.\nNOTE:\tFor simplicity, the correlation information is not listed in the input data per network data analytics.\nTable 6.2.4-1: Correlation Information\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.2.4-1: Correlation Information",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.2.5\tTime coordination across multiple NWDAF instances",
                            "text_content": "In certain situations, an NWDAF Service Consumer expects to receive analytics by a given time. In particular, when an NWDAF Service Consumer is collecting analytics from multiple NWDAFs it can be necessary to coordinate the timing of the analytics subscriptions/requests from the same NWDAF service consumer.\nThe NWDAF Service Consumer may use \"time when analytics information is needed parameter\" (see clause 6.1.3) as a dynamic timer to indicate the minimum time it is going to wait (i.e. \"expected waiting time\") to receive the analytics collected from multiple NWDAFs.\nThe figure depicts a procedure for time coordination across multiple NWDAFs, illustrating the synchronization of time signals between different nodes in a network.\nFigure 6.2.5.2-1: Procedure for time coordination across multiple NWDAFs\n1a-1b.\tOn analytics request/subscription, the NWDAF Service Consumer indicates the \"expected waiting time\" as \"time when analytics is needed\" parameter to those NWDAFs from which it expects to receive the analytics latest by the \"time when analytics information is needed\", using either the Nnwdaf_AnalyticsInfo_Request or Nnwdaf_AnalyticsSubscription_Subscribe service operation. In this example, NWDAF1 and NWDAF2 are the NWDAFs with tightly related analytics.\n2a-2b.\tEach NWDAF generates the requested analytics based on data from related data sources. In this example, NWDAF1 processes data from NF1 and NWDAF2 processes data from NF2.\n3a-3b.\t[Optional] If the \"time when analytics information is needed\" is reached, but the analytics is not ready, the NWDAF may indicate a \"revised waiting time\" in an error response or error notification, using either the Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify service operation, depending on the service used in step 1.\n4a-4b.\t[Optional] On receiving an indicated \"revised waiting time\" as part of an error response or error notification, the NWDAF Service consumer may use the \"revised waiting time\" to update the \"time when analytics information is needed\" parameter for future analytics requests/subscriptions to the same group of NWDAFs.\n5a-5b.\tIf the value of the \"time when analytics information is needed\" was updated in step 4, the NWDAF Service Consumer, in future requests or within current subscription, indicates the new expected waiting time as \"time when analytics information is needed\" to all NWDAFs with tightly related analytics, using either the Nnwdaf_AnalyticsInfo_Request or Nnwdaf_AnalyticsSubscription_Subscribe service operation.\nNOTE 1:\tSteps 3a-3b and steps 4a-4b may happen in different orders depending on the timing of analytics collection (from other NFs, e.g. NF1 or NF2) or processing.\nNOTE 2:\tParameter \"time when analytics is needed\" as in steps 1a-1b, 3a-3b, 4a-4b and 5a-5b can be per individual Analytics ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.6\tEnhanced Procedures for Data Collection",
                            "text_content": "Data collection may be performed via DCCF, MFAF and ADRF, when such NFs are deployed, or via NWDAF (hosting DCCF and/or ADRF). The NF services used for DCCF, MFAF, ADRF and the NWDAF (hosting DCCF and/or ADRF) are listed in Table 6.2.6.0-1.\nTable 6.2.6.0-1: NF Services for the enhanced data collection procedures\n\nDCCF, MFAF and NWDAF hosting DCCF shall use the same services listed in clause 6.2.1 from OAM and NFs (including AFs directly or via NEF) to collect data. Additionally, the new services for data exposure from DCCF, MFAF, ADRF and NWDAF (hosting DCCF and/or ADRF) as specified in clause 8, 9, 10 and 7.4 may also be used for data collection.\nThe NWDAF, DCCF, ADRF shall obtain the proper information to perform data collection for a UE, a group of UEs or any UE following the principles of clause 6.2.1.\nWhen NWDAF or DCCF need to discover the sources of data collection, they follow the principles defined in clause 6.2.2.1 in the case of data collection from NFs; in clause 5A.2 in the case of DCCF deployed in the network and requiring data from NWDAFs or ARDFs that independently collect data; clause 5.2 in the case of NWDAF (hosting DCCFs) and collecting data from other NWDAFs.\nNWDAFs may provide bulked data to consumers as an alternative to providing individual events (i.e. subscription to multiple event IDs to obtain the data required for an analytics generation).\nThe bulked data is the set of data samples from the collected event notifications to be used for an Analytics ID for a consumer of NWDAF. A data sample may be a notification, in which case the bulked data may comprise a group of received notifications, or a data sample may be information extracted from a notification and processed, in which case the bulked data comprises the processed information. The bulked data can be used for the purpose of analytics inference or ML model training.\nThe bulked data is generated based on the set of data samples from event notifications collected from NFs/OAM and the properties for the selection of such data, Consumers of bulked data or operators may define different rules (e.g. aggregation formats or processes) for generation of bulked data for training or inference.\nNFs capable to expose bulked data have the following capabilities:\n-\tExposing runtime collected data (e.g. data from NFs/AFs/OAM retrieved via notification mechanisms), or historical collected data (e.g. data from NFs/AFs/OAM that were at some point collected, then stored), or both;\n-\tApplying selection processes of data samples or processing mechanisms for the generation of the bulked data according to bulked data formatting and processing instructions provided by consumers of the bulked data or defined by an operator. The bulked data formatting and processing instructions may include the formatting and processing instructions as specified in clause 5A.4 and further instructions as described in clause 6.2.6.1.1. Such instructions define the allowed and/or restricted properties and/or processes to be applied to the set of data from the collected event notifications to be used for the bulked data, the properties and processes being:\n-\tThe properties associated with the Bulked data formatting and processing are filters over the data to be associated with the bulked data. The properties for bulked data are defined as per Data Specification parameters in clause 6.2.6.1.1.\n-\tThe processes associated with the bulked data formatting and processing are mechanisms applied to the data to be associated with the bulked data and are defined according to the Formatting and Processing parameter defined in clause 5A.4 and the further instructions defined in clause 6.2.6.1.1. These processes may comprise: definition if data to be used for composing the bulked data is directly extracted from collected events, or the data is extracted from event notification of the same event type and pre-processed, or both; applying anonymization of data fields in the bulked data to avoid exposing undesired information, aggregation levels (i.e. per cell, per UEs, or temporal, e.g. per hours or days).\nNOTE:\tPre-process data from collected event notifications of the same event type refers to the usage of data manipulation processes in order to aggregate, concatenate, process data from multiple collected event notifications from the same event type that results in a single processed value.\n-\tHaving the mapping of the Service Operation that have to be used for collecting data of the bulked data associated with an Analytics ID.\nNWDAF may expose the Nnwdaf_DataManagement_Subscribe service operation with a request for bulked data including the following input parameters:\n-\tData Specification:\n-\tEvent ID(s) or Analytics ID(s);\n-\tIn the case of Event IDs, the Data Specification fields includes the fields Target of Event Reporting and Event Filter Information as defined in clause 4.15.1 of TS 23.502 [3] and Bulked Data Type parameter, which can be set to ''raw data samples'' (i.e. data is directly extracted from collected events) or ''pre-processed data samples'' (i.e. data from collected events is processed and the processed data is included in the bulked data) or a combination of both;\n-\tIf the Analytics ID(s), the Data Specification fields contain:\n-\tTarget of Reporting including a tuple with Analytics ID; Bulked Data Type, which can be set to ''raw data samples'' (i.e. data is directly extracted from collected events) or ''pre-processed data samples'' (i.e. data from collected events is processed and the processed data is included in the bulked data) or a combination of both;\n-\tFilter Information may include fields related to the Analytics ID such as: Target of Analytics Information (e.g. any UE, list of UEs, groups of UEs); Analytics Filter Information (e.g. area of interest, DNN, Application, S-NSSAI). The Analytics ID also determines the Service Operation from NFs, OAM to be used and type of data (i.e. Event IDs, OAM measurements) to be collected and associated with the bulked data.\n-\tService Operation in the case of Event ID, defines the service operation to be used by NWDAF, DCCF, MFAF, or ADRF to request data (e.g. Namf_EventExposure_Subscribe or OAM Subscribe)\n-\tBulked Data Formatting and Processing: the parameters defined in clause 4.15.1 of TS 23.502 [3] for Event Reporting Information and Formatting and Processing instructions as defined in clause 5A.4.\n-\tA Notification Target Address (+ Notification Correlation ID), where the Notification Correlation ID is the unique identification for the bulked data being generated for the requesting consumer.\n-\tADRF ID or NWDAF ID (or ADRF Set ID or NWDAF Set ID) storing historical data (optional). If known to the consumer, this may be specified to direct a DCCF or an NWDAF to the repository containing historical data.\n-\t(Optional) ADRF information indicating whether the collected data for the generation of the bulked data are to be stored in an ADRF and optionally an ADRF ID.\n-\t(Optional, in case the requested data is Event IDs) Data Source identification to collect the data, e.g. NF Instance (or NF Set) ID from which the data needs to be collected.\nThe output parameter of the Nnwdaf_DataManagement_Subscribe service operation comprise the subscription correlation ID, which identifies the requested bulked data.\nThe input parameters of Nnwdaf_DataManagement_Notify service operation shall contain the Notification Correlation ID and the generated bulked data when the fetch flag = false. When the fetch flag = true the notifications will contain the Notification Correlation ID, the Fetch Correlation ID and a target address where the generated bulked data may be retrieved. In the case of unsuccessful bulked data generation, the notification will contain an indication of an unsuccessful bulked data generation, optionally with expired bulked data deadline.\nThe input parameters for the service operation Nnwdaf_DataManagement_Fetch include: the Notification correlation ID (+list of Fetch Correlation ID), which identifies the requested bulked data.\nThe output parameters for the service operation Nnwdaf_DataManagement_Fetch include:\n-\tthe generated bulked data.\nThe generated bulked data exposed by the above listed service operations comprises:\n-\tthe dataset (i.e. the resulting set of data samples and/or set of pre-processed data samples from the collected event notifications) generated based on the parameters of bulked data request and Bulked Data Formatting and Processing;\n-\ttimestamp when the data sample is associated with a bulked data.\nThe procedure in Figure 6.2.6.2-1 is used by NWDAF service consumer to invoke the data management services at NWDAFs in order to retrieve runtime and historical data.\nThe figure depicts a data collection system from the National Water Data Assimilation Facility (NWDAF) via a Data Management Service. It illustrates the data collection process, including the collection of data from various sources, the transmission of data to the Data Management Service, and the processing and analysis of the data. The figure shows the various components involved in the data collection process, such as the data collection equipment, the data transmission network, and the data management system. The figure also highlights the importance of data quality and accuracy in the data collection process, as well as the need for efficient data management and analysis.\nFigure 6.2.6.2-1: Data Collection from NWDAF via Data Management Service\n1.\tNWDAF service consumer (e.g. NWDAF, DCCF) identifies that further data from an NWDAF is required in order to perform some operation related to Analytics ID. The triggers for further data collection are related to:\na)\tthe local policies of NWDAF or DCCF (e.g. preparation for future requests for Analytics ID as specified in clause 6.2.2.1);\nb)\ta request for analytics generation requiring data not available or not directly reachable via the NWDAF service consumer (e.g. out of the serving area);\nc)\ta request for model training;\nd)\ta request for data collection that NWDAF service consumer cannot provide by itself.\nNOTE 1:\tIf the NWDAF service consumer is a DCCF, the discovery of the proper NWDAF is defined in clause 6.2.6.3.6. If the NWDAF service consumer is a NWDAF, the NWDAF service consumer can discover the appropriate NWDAF(s) as defined in clause 5.2.\n2a.\tNWDAF service consumer invokes Nnwdaf_DataManagement_Subscribe service from NWDAF to request a required data. The request comprises the Data Specification as well as Data Formatting and Processing instructions as defined in clause 5A.4, Notification Target Address (+ Notification Correlation ID).\nWhen the required data is Event IDs, the NWDAF service consumer may include the Data Source, e.g. NF Instance (or NF Set) ID from which the data needs to be collected.\nThe NWDAF service consumer may include ADRF information indicating whether the data are to be stored in an ADRF and optionally an ADRF ID.\nThe NWDAF service consumer may include ADRF ID or NWDAF ID (or ADRF Set ID or NWDAF Set ID) storing historical data (optional), directing NWDAF to the repository containing historical data.\nThe NWDAF checks if required data is related to a user, i.e. SUPI or GPSI, then, depending on local policy and regulations, as described in clause 6.2.9, the NWDAF checks or has checked the user consent by retrieving the user consent information from UDM using Nudm_SDM_Get including data type \"User consent\". If user consent is not granted, NWDAF sends a response to the NWDAF service consumer in step 2b, indicating that user consent for data collection was not granted and the data collection for this SUPI or GPSI stops here. If the user consent is granted, the NWDAF can provide the required data to the NWDAF service consumer by performing the following steps 2b-7 and the NWDAF subscribes to UDM to notifications of changes on subscription data type \"User consent\" for this user using Nudm_SDM_Subscribe. When receiving the notification that user consent has been revoked, the NWDAF shall provide a Termination Request in Nnwdaf_DataManagement_Notify to request the NWDAF service consumer to cancel the subscription to the required data.\n2b.\tBased on the received request, NWDAF creates a new data for the requesting consumer. NWDAF sends Nnwdaf_DataManagement_Subscribe service response with a confirmation of successful request and the subscription correlation ID identifying the requested data.\nNOTE 2:\tSubscription Correlation ID allows the NWDAF service consumer to request to NWDAF any changes in the generation of a requested data.\n3.\tNWDAF determines whether the request data is available at such NWDAF.\nNWDAF maintains a local association of requested Event IDs or Analytics IDs to the list of triggered event subscription identifications from data sources to generate the requested data. Based on this local association, the NWDAF checks if the data to be collected is available at itself. If the data is available, NWDAF uses such data to generate the requested data.\nWhen data sources are NFs, the NWDAF discovers the proper NFs as defined in clause 6.2.2.1.\nWhen the data sources are other NWDAFs, the NWDAF discovers the other NWDAFs as defined in clause 5.2.\nWhen the data source is DCCF, the NWDAF discovers the proper DCCF as defined in clause 6.3.19 of TS 23.501 [2].\n4a.\t(Optional) If NWDAF receives a request for data that is not available or not reachable by such NWDAF (e.g. out of serving area), NWDAF determines the sources for the data that is not available, if the information has not been included in the subscription to the requested data.\n4b.\t(Optional) NWDAF may trigger further data collection using any of the available mechanisms in clause 6.2.2 (e.g. if the data subscribed in step 2a partially matches data that are already being collected by the NWDAF from a data source and a modification of the subscription to the data source would satisfy both the existing data collection as well as the newly requested data) and clause 6.2.6 (e.g. recursively using data collection services from other needed NWDAFs, DCCFs, ADRFs, NFs).\nNWDAF updates its local association of the mapping of the requested data (Event ID or Analytics ID) to the identification of the request/subscription for data collection from the further data sources.\n5.\tBased on the properties of the received request, NWDAF generates the requested data including the available or collected data (e.g. from other NWDAFs, DCCFs or ADRFs, NFs).\n6a.\tIf the fetch flag is set to true in step 2a, NWDAF waits until the requested data is ready and sends a Nnwdaf_DataManagement_Notify service message with fetch instructions.\nThe requested data is ready when the NWDAF has generated the data and completed processing and formatting as described in clause 5A.4.\n6b.\tIf the fetch flag is set to false in step 2a, NWDAF uses the Nnwdaf_DataManagement_Notify service to send the Notification Correlation ID and requested data to the NWDAF service consumer.\n7(a.b).\tAlternatively, if the Nnwdaf_DataManagement_Notify service message with fetch instructions is received in step 6a, the NWDAF service consumer shall fetch the required data from NWDAF via Nnwdaf_DataManagement_Fetch service operation within the fetch deadline specified in the fetch instructions. The NWDAF service consumer invokes the Nnwdaf_DataManagement_Fetch service operation with the input parameters including the Fetch Correlation ID, that identifies the data to be fetched and receives a response with the requested data.\n8.\tThe NWDAF service consumer uses the requested data for performing further processing. If the NWDAF service consumer is an NWDAF the requested data can be used for analytics generation or model training or for further exposing such data to other NWDAFs. If the NWDAF service consumer is a DCCF, the requested data can be provided to a DCCF data consumer.\n9.\tWhen the NWDAF service consumer determines that no more data is required or if receiving a Termination Request from the NWDAF, e.g. due to user consent revocation for the data collection related to a user, it unsubscribes to the requested data from NWDAF. If NWDAF had triggered further data collection in Step 3a and 3b, NWDAF also unsubscribe to all data sources.\nNOTE 3:\tIt is also possible that instead of providing the dataset of the generated data in steps 6a, 6b, 7b, the NWDAF provides a reference to where the dataset can be retrieved by the NWDAF service consumer.\nThis clause specifies procedures for data collection using the DCCF described in clause 5A for cases other than obtaining analytics from an NWDAF (which is specified in clause 6.1.2). Two options are supported: data delivered via the DCCF, according to clauses 6.2.6.3.2 and 6.2.6.3.3 and data delivered via a messaging framework according to clauses 6.2.6.3.4 and 6.2.6.3.5. Which option to be used is determined by DCCF configuration.\nDue to e.g. UE mobility, the source DCCF or MFAF may no longer be able to serve the UE. In such cases, the data consumer may select a new DCCF as described in clause 6.2.6.3.7, or source DCCF may execute the DCCF relocation procedure as described in clause 6.2.6.3.8. The data consumer may indicate in the subscription request whether the DCCF should execute the relocation procedure or send a notification to the data consumer as specified in the reselection procedure. If the data consumer does not send an indicator in the subscription request allowing DCCF relocation initiated by the DCCF the consumer may execute DCCF reselection based on internal logic.\nWhen data is collected for a group of UEs or any UE, the procedure of DCCF relocation initiated by the DCCF is not applicable. In such case, the consumer may select one or more Target DCCFs and initiate a new subscription for the UEs.\nThe procedure depicted in Figure 6.2.6.3.2-1 is used by a data consumer (e.g. NWDAF) to obtain data and be notified of events via the DCCF using Ndccf_DataManagement_Subscribe service operation. Whether the data consumer directly contacts the Data Source or goes via the DCCF is based on configuration of the data consumer.\nThe figure depicts a data collection system using DCCF (Data Collection Communication Channel) technology. It illustrates the various components involved in data collection, including the DCCF transmitter, receiver, and the communication channel. The figure highlights the importance of proper signal transmission and reception to ensure accurate data collection.\nFigure 6.2.6.3.2-1: Data Collection via DCCF\n1.\tThe data consumer subscribes to data via the DCCF by invoking the Ndccf_DataManagement_Subscribe (Service_Operation, Data Specification, Formatting Instructions, Processing Instructions, NF (or NF-Set) ID, ADRF Information) service operation as specified in clause 8.2.2. The data consumer may specify one or more notification endpoints. If data to be collected is subject to user consent: if the data consumer checked user consent, the data consumer shall provide user consent check information (i.e. an indication that it has checked user consent), otherwise, the data consumer shall provide a purpose for the data collection.\nService_Operation is the service operation to be used by the DCCF to request data (e.g. Namf_EventExposure_Subscribe or OAM Subscribe). Data Specification provides Service Operation-specific parameters (e.g. event IDs, UE-ID(s), target of event reporting) used to retrieve the data. Formatting and Processing Instructions are as defined in clause 5A.4. The data consumer may include the Data Source, e.g. NF Instance (or NF Set) ID from which the data needs to be collected. The data consumer may include ADRF information indicating whether the data are to be stored in an ADRF and optionally an ADRF ID.\n2.\tThe DCCF checks if data is to be collected for a user, i.e. SUPI or GPSI, then, depending on local policy and regulations, the DCCF checks the user consent by retrieving the user consent information from UDM using Nudm_SDM_Get including data type \"User consent\" and taking into account purpose for data collection as provided in step 1. If user consent is not granted, DCCF does not subscribe to event exposure for events related to this user, the data collection for this SUPI or GPSI stops here and DCCF sends a response to the data consumer indicating that user consent for data collection was not granted. If the user consent is granted, the DCCF subscribes to UDM to notifications of changes on subscription data type \"User consent\" for this user using Nudm_SDM_Subscribe.\nIf the data consumer is NWDAF and it provides user consent check information (i.e. an indication that it has checked user consent) in Ndccf_DataManagement_Subscribe in step 1, which has been obtained by the NWDAF from UDM before, then the DCCF can do data collection for a user based on the user consent information from the NWDAF and skip retrieving it from UDM.\n3.\tThe DCCF determine the NF type(s) and/or OAM to retrieve the data based on the Service Operation requested in step 1. If the NF instance or NF Set ID is not provided by the data consumer. the DCCF determines the NF instances that can provide data as described in clause 5A.2 and clause 6.2.2.2. If the consumer requested storage of data in an ADRF but the ADRF ID is not provided by the data consumer, or the collected data is to be stored in an ADRF according to configuration on the DCCF, the DCCF selects an ADRF to store the collected data.\n4.\tThe DCCF determines whether the data requested in step 1 are already being collected, as described in clause 5A.2.\nIf the data requested are already being collected from the Data Source by a data consumer, the DCCF adds the data consumer to the list of data consumers that are subscribed for these data, then the DCCF determines that no subscriptions to the Data Source need to be created or modified.\n5.\tIf the data subscribed in step 1 partially matches data that are already being collected by the DCCF from a Data Source and a modification of this subscription to the Data Source would satisfy both the existing data subscriptions as well as the newly requested data, the DCCF invokes Nnf_EventExposure_Subscribe (Subscription Correlation ID) with parameters indicating how to modify the previous subscription (as specified in clause 5A.2). The DCCF adds the data consumer to the list of data consumers that are subscribed for these data. If some of the newly requested data can only be provided by new Data Source, the DCCF creates new subscription(s) to the new Data Source for the newly requested data.\nIf the data requested at step 1 are not already available or not being collected yet, the DCCF subscribes to data from the NF using the Nnf_EventExposure_Subscribe service operation as specified in clause 5A.2 and clause 6.2.2.2, with DCCF indicated as Notification Target Address. The DCCF adds the data consumer to the list of data consumers that are subscribed for these data.\n6.\tWhen new output data are available, the Data Source uses Nnf_EventExposure_Notify to send the data to the DCCF.\n7.\tThe DCCF uses Ndccf_DataManagement_Notify to send the data to all notification endpoints indicated in step 1. Data sent to notification endpoints may be processed and formatted by the DCCF so they conform to delivery requirements for each data consumer or notification endpoint as specified in clause 5A.4. The DCCF may store the information in ADRF if requested by the consumer or if required by DCCF configuration, using procedure as specified in clause 6.2B.3.\nNOTE:\tAccording to Formatting Instructions provided by the data consumer, multiple notifications from a Data Source can be combined in a single Ndccf_DataManagement_Notify so many notifications from the Data Source result in fewer notifications (or one notification) to the data consumer. Alternatively, a notification can instruct the data notification endpoint to fetch the data from the DCCF before an expiry time.\n8a.\tIf DCCF needs to retrieve data from OAM, procedure for data collection from OAM as per steps 1-4 from clause 6.2.3.2 is used.\n8b.\tThe DCCF uses Ndccf_DataManagement_Notify to send the data to all notification endpoints indicated in step 1. Data sent to notification endpoints may be processed and formatted by the DCCF, so they conform to delivery requirements for each data consumer or notification endpoint as specified in clause 5A.4. The DCCF may store the information in ADRF if requested by the consumer or if required by DCCF configuration, using procedure as specified in clause 6.2B.3.\n9.\tIf a Ndccf_DataManagement_Notify contains a fetch instruction, the notification endpoint sends a Ndccf_DataManagement_Fetch request to fetch the data from the DCCF.\n10.\tThe DCCF delivers the data to the notification endpoint\n11.\tThe UDM may notify the DCCF on changes of user consent at any time after step 2. If user consent is no longer granted for a user for which data has been collected and there are no other consumers for the data, the DCCF shall unsubscribe to any Event ID to collect data for that SUPI or GPSI. The DCCF shall further update or terminate affected subscriptions of the Data Consumer. The DCCF may unsubscribe to be notified of user consent updates from UDM for each SUPI for which user consent has been revoked.\n12.\tWhen the data consumer no longer wants data to be collected it invokes Ndccf_DataManagement_Unsubscribe (Subscription Correlation ID), using the Subscription Correlation Id received in response to its subscription in step 1. The DCCF removes the data consumer from the list of data consumers that are subscribed for these data.\n13.\tIf there are no other data consumers subscribed to the data, the DCCF unsubscribes with the Data Source.\nThe procedure depicted in figure 6.2.6.3.3-1 is used by data consumers (e.g. NWDAF) to obtain historical data, i.e. data related to past time period. The data consumer requests data using Ndccf_DataManagement_Subscribe service operation. Whether the data consumer uses this procedure or directly contacts the ADRF or NWDAF is based on configuration.\nThe figure depicts a historical data collection system using DCCF (Data Collection Communication Channel) technology. It illustrates the process of collecting data from various sources, including telecommunication networks, to ensure accurate and reliable data collection. The system uses DCCF to transmit data over a secure and reliable communication channel, ensuring the confidentiality and integrity of the data.\nFigure 6.2.6.3.3-1: Historical Data Collection via DCCF\n1.\tThe data consumer requests data via DCCF by invoking the Ndccf_DataManagement_Subscribe (Service_Operation, Data Specification, Time Window, Formatting Instructions, Processing Instructions, ADRF ID or NWDAF ID (or ADRF Set ID or NWDAF Set ID) service operation as specified in clause 8.2.2. The data consumer may specify one or more notification endpoints to receive the data. If data to be collected is subject to user consent: if the data consumer checked user consent, the data consumer shall provide user consent check information (i.e. an indication that it has checked user consent), otherwise, the data consumer shall provide a purpose for the data collection.\n\"Service_Operation\" is the service operation used to acquire the data from a data source. \"Data Specification\" provides Service_Operation-specific parameters (e.g. event IDs, UE-ID(s)) used to retrieve the data. \"Time Window\" specifies a past time period and comprises a start and stop time. \"Formatting and Processing Instructions\" are as defined in clause 5A4. The data consumer may optionally include the ADRF or NWDAF instance (or ADRF Set or NWDAF Set) ID where the stored data resides.\n2.\tThe DCCF checks if data is to be collected for a user, i.e. SUPI or GPSI, then, depending on local policy and regulations, the DCCF checks the user consent by retrieving the user consent information from UDM using Nudm_SDM_Get including data type \"User consent\" and taking into account purpose for data collection as provided in step 1. If user consent is not granted, DCCF does not subscribe to event exposure for events related to this user, the data collection for this SUPI or GPSI stops here and DCCF sends a response to the data consumer indicating that user consent for data collection was not granted. If the user consent is granted, the DCCF subscribes to UDM to notifications of changes on subscription data type \"User consent\" for this user using Nudm_SDM_Subscribe.\nIf the data consumer is NWDAF and it provides user consent check information (i.e. an indication that it has checked user consent) in Ndccf_DataManagement_Subscribe in step 1, which has been obtained by the NWDAF from UDM before, then the DCCF can do data collection for a user based on the user consent information from the NWDAF and skip retrieving it from UDM.\n3.\tIf an ADRF or NWDAF instance or ADRF Set ID or NWDAF Set ID is not provided by the data consumer, the DCCF determines if any ADRF or NWDAF instances might provide the data as described in clause 5B and 5A.2.\nNOTE 1:\tAn ADRF or NWDAF might have previously registered data it is collecting with the DCCF.\n4.\t(conditional) If the DCCF determines that an ADRF instance might provide the data, or an ADRF instance or Set was supplied by the data consumer, the DCCF sends a request to the ADRF, using Nadrf_DataManagement_RetrievalSubscribe (Data Specification, Notification Target Address=DCCF) service operation as specified in clause 10.2. The ADRF responds to the DCCF with an Nadrf_DataManagement_RetrievalSubscribe response indicating if the ADRF can supply the data. If the data can be provided, the procedure continues with step 5.\n5.\t(conditional) If the DCCF determines that an NWDAF instance might provide the data or an NWDAF instance or Set was supplied by the data consumer, the DCCF sends a request to the NWDAF using Nnwdaf_DataManagement_Subscribe (Data Specification, Notification Target Address=DCCF) as specified in clause 7.4.2.\n6.\tThe ADRF uses Nadrf_DataManagement_RetrievalNotify or the NWDAF uses Nnwdaf_DataManagement_Notify to send the requested data (e.g. one or more stored notifications archived from a data source) to the DCCF. The data may be sent in one or more notification messages.\n7.\tThe DCCF uses Ndccf_DataManagement_Notify to send data to all notification endpoints indicated in step 1. Notifications are sent to the Notification Target Address(es) using the data consumer Notification Correlation ID(s) received in step 1. Data sent to notification endpoints may be processed and formatted by the DCCF, so they conform to delivery requirements specified by the data consumer.\nNOTE 2:\tAccording to Formatting Instructions provided by the data consumer, multiple notifications from an ADRF or NWDAF can be combined in a single Ndccf_DataManagement_Notify so many notifications from the ADRF or NWDAF results in fewer notifications (or one notification) to the data consumer. Alternatively, a Ndccf_DataManagement_Notify can instruct the data notification endpoint to fetch the data from the DCCF before an expiry time.\n8.\tIf a notification contains a fetch instruction, the notification endpoint sends a Ndccf_DataManagement_Fetch request to fetch the data from the DCCF.\n9.\tThe DCCF delivers the data to the notification endpoint.\n10.\tThe UDM may notify the DCCF on changes of user consent at any time after step 2. If user consent is no longer granted for a user for which data has been collected and if there are no other consumers for the data, the DCCF shall unsubscribe to any data collection for that SUPI or GPSI. The DCCF shall further update or terminate affected subscriptions of the Data Consumer. The DCCF may unsubscribe to be notified of user consent updates from UDM for each SUPI for which user consent has been revoked.\n11.\tWhen the data consumer no longer wants data to be collected or has received all the data it needs, it invokes Ndccf_DataManagement_Unsubscribe (Subscription Correlation ID) as specified in clause 8.2.3, using the Subscription Correlation Id received in response to its subscription in step 1.\n12.\tIf the data are being provided by an ADRF and there are no other data consumers subscribed to the data, the DCCF unsubscribes with the ADRF using Nadrf_DataManagement_RetrievalUnsubscribe as specified in clause 10.2.7.\n13.\tIf the data are being provided by an NWDAF and there are no other data consumers subscribed to the data, the DCCF unsubscribes with the NWDAF using Nnwdaf_DataManagement_Unsubscribe as specified in clause 7.4.3.\nThis procedure depicted in Figure 6.2.6.3.4-1 is used by a data consumer (e.g. NWDAF) to obtain data and be notified of events using the DCCF and a Messaging Framework. The 3GPP DCCF Adaptor (3da) Data Management service and 3GPP Consumer Adaptor (3ca) Data Management service of the Messaging Framework Adaptor Function (MFAF) are used to interact with the 3GPP Network and the Messaging Framework. Whether the data consumer directly contacts the Data Source or goes via the DCCF is based on configuration.\nThe figure depicts a messaging framework used for data collection in a telecommunications network. It illustrates the various components involved, such as the messaging server, messaging client, and data collection points. The framework is designed to ensure efficient and secure data transmission, with features like encryption and authentication.\nFigure 6.2.6.3.4-1: Data Collection via Messaging Framework\n1.\tThe data consumer subscribes to data via the DCCF by invoking the Ndccf_DataManagement_Subscribe (Service_Operation, Data Specification, Formatting Instructions, Processing Instructions, NF (or NF-Set) ID, ADRF Information, Data Consumer Notification Target Address (+ Notification Correlation ID)) service operation as specified in clause 8.2.2. The data consumer may specify one or more notification endpoints and the NF or NF set to collect data from. If data to be collected is subject to user consent: if the data consumer checked user consent, the data consumer shall provide user consent check information (i.e. an indication that it has checked user consent), otherwise, the data consumer shall provide a purpose for the data collection.\nService_Operation is the service operation to be used by the DCCF to request data (e.g. Namf_EventExposure_Subscribe or OAM Subscribe). Data Specification provides Service_Operation-specific required parameters (e.g. event IDs, UE-ID(s), target of event reporting) and optional input parameters used to retrieve the data. Formatting and Processing Instructions are as defined in clause 5A.4. The data consumer may optionally include the Data Source NF Instance (or NF Set) ID. The data consumer may include ADRF information indicating whether the data are to be stored in an ADRF and, optionally, an ADRF ID.\nNOTE 1:\tData consumer requesting data to be stored in ADRF allows the collected data to be available to other data consumers in the future.\n2.\tThe DCCF checks if data is to be collected for a user, i.e. SUPI or GPSI, then, depending on local policy and regulations, the NWDAF checks the user consent by retrieving the user consent information from UDM using Nudm_SDM_Get including data type \"User consent\" and taking into account purpose for data collection as provided in step 1. If user consent is not granted, NWDAF does not subscribe to event exposure for events related to this user, the data collection for this SUPI or GPSI stops here and DCCF sends a response to the data consumer indicating that user consent for data collection was not granted. If the user consent is granted, the DCCF subscribes to UDM to notifications of changes on subscription data type \"User consent\" for this user using Nudm_SDM_Subscribe.\nIf the data consumer is NWDAF and it provides user consent check information (i.e. an indication that it has checked user consent) in Ndccf_DataManagement_Subscribe in step 1, which has been obtained by the NWDAF from UDM before, then the DCCF can do data collection for a user based on the user consent information from the NWDAF and skip retrieving it from UDM.\n3.\tIf the NF instance or NF Set ID is not provided by the data consumer, the DCCF determines the NF instances that can provide data as described in clause 5A.2 and clause 6.2.2.2. If the consumer requested storage of data in an ADRF, but the ADRF ID is not provided by the data consumer, or the collected data is to be stored in an ADRF according to configuration on the DCCF, the DCCF selects an ADRF to store the collected data.\n4.\tThe DCCF determines whether the data requested in step 1 are already being collected, as described in clause 5A.2.\nIf the data requested are already being collected from the Data Source by a data consumer, the DCCF adds the data consumer to the list of data consumers that are subscribed for these data, then the DCCF determines that no subscriptions to the Data Source need to be created or modified.\n5.\tThe DCCF sends an Nmfaf_3daDataManagement_Configure (Data Consumer Information, MFAF Notification Information, Formatting Conditions, Processing Instructions) to configure the MFAF to map notifications received from the Data Source to outgoing notifications sent to endpoints and to instruct the MFAF how to format and process the outgoing notifications. The DCCF may also instruct the MFAF to store data into ADRF by providing an ADRF ID, if requested by the data consumer in step 1, together with the NF Id of the data source.\nData Consumer Information contains for each notification endpoint, the data consumer Notification Target Address (+ Data Consumer Notification Correlation ID to be used by the MFAF when sending notifications in step 9.\nMFAF Notification Information is included if a Data Source is already sending the data to the MFAF. MFAF Notification Information identifies Event Notifications received from the Data Sources and comprises the MFAF Notification Target Address (+ MFAF Notification Correlation ID). If the MFAF does not receive MFAF Notification information from the DCCF, the MFAF selects a MFAF Notification Target Address (+ MFAF Notification Correlation ID) and sends the MFAF Notification Information, containing MFAF Notification Target Address (+ MFAF Notification Correlation ID), to the DCCF in the Nmfaf_3daDataManagement_Configure Response.\n6.\tIf the data subscribed in step 1 partially matches data that are already being collected by the DCCF from a Data Source and a modification of this subscription to the Data Source would satisfy both the existing data subscriptions as well as the newly requested data, the DCCF invokes Nnf_EventExposure_Subscribe (Subscription Correlation ID) with parameters indicating how to modify the previous subscription (as specified in clause 5A.2). The DCCF adds the data consumer to the list of data consumers that are subscribed for these data. If some of the newly requested data can only be provided by new Data Source, the DCCF creates new subscription(s) to the new Data Source for the newly requested data.\nIf the data requested at step 1 are not already available or not being collected yet, the DCCF subscribes to data from the NF using the Nnf_EventExposure_Subscribe (Data Specification, MFAF Notification Target Address (+ MFAF Notification Correlation ID)) service operation as specified in clause 5A.2 and clause 6.2.2.2, using the MFAF Notification Target Address (+ MFAF Notification Correlation ID) received in step 5. The DCCF adds the data consumer to the list of data consumers that are subscribed for these data.\n7.\tWhen new output data are available, the Data Source uses Nnf_EventExposure_Notify to send the data to the MFAF. The Notification includes the MFAF Notification Correlation ID.\n8.\tThe MFAF uses Nmfaf_3caDataManagement_Notify to send the data to all notification endpoints indicated in step 6. Notifications are sent to the Notification Target Address(es) using the Data Consumer Notification Correlation ID(s) received in step 6. Data sent to notification endpoints may be processed and formatted by the MFAF, so they conform to delivery requirements specified by the data consumer. The MFAF may store the information in ADRF if requested by consumer or if required by DCCF configuration\nNOTE 2:\tAccording to Formatting Instructions provided by the data consumer, multiple notifications from a Data Source can be combined in a single Nmfaf_3caDataManagement_Notify, so many notifications from the Data Source results in fewer notifications (or one notification) to the data consumer. Alternatively, a notification can instruct the data notification endpoint to fetch the data from the MFAF before an expiry time.\n9.\tIf a Nmfaf_3caDataManagement_Notify contains a fetch instruction, the notification endpoint sends a Nmfaf_3caDataManagement_Fetch request to fetch the data from the MFAF.\n10.\tThe MFAF delivers the data to the notification endpoint.\n11.\tThe UDM may notify the DCCF on changes of user consent at any time after step 2. If user consent is no longer granted for a user for which data has been collected and if there are no other consumers for the data, the DCCF shall unsubscribe to any Event ID to collect data for that SUPI or GPSI. The DCCF shall further update or terminate affected subscriptions of the Data Consumer. The DCCF may unsubscribe to be notified of user consent updates from UDM for each SUPI for which user consent has been revoked.\n12.\tWhen the data consumer no longer wants data to be collected, it invokes Ndccf_DataManagement_Unsubscribe (Subscription Correlation ID), using the Subscription Correlation Id received in response to its subscription in step 1. The DCCF removes the data consumer from the list of data consumers that are subscribed for these data.\n13.\tIf there are no other data consumers subscribed to the data, the DCCF unsubscribes with the Data Source.\n14.\tThe DCCF de-configures the MFAF so it no longer maps notifications received from the Data Source to the notification endpoints configured in step 5.\nThe procedure depicted in figure 6.2.6.3.5-1 is used by data consumers (e.g. NWDAF) to obtain historical data, i.e. data related to past time period. The data consumer obtains data using Ndccf_DataManagement_Subscribe service operation as specified in clause 8.2.2, where the subscription results in one or more notifications depending on how the data is retrieved from the ADRF or NWDAF and how the data is formatted. Whether the data consumer uses this procedure or directly contacts the ADRF or NWDAF is based on configuration.\nThe figure depicts a historical data collection system using a messaging framework, illustrating the process of data collection over time. The system includes various components such as data collection points, data collection methods, and data storage. The figure provides a visual representation of the data collection process, allowing for easy understanding of the system's operation and the steps involved in collecting historical data.\nFigure 6.2.6.3.5-1: Historical Data Collection via Messaging Framework\n1.\tThe data consumer requests data via DCCF by invoking the Ndccf_DataManagement_Subscribe (Service Operation, Data Specification, Time Window, Formatting Instructions, Processing Instructions, ADRF ID or NWDAF ID (or ADRF Set ID or NWDAF Set ID) service operation as specified in clause 8.2.2. The data consumer may specify one or more notification endpoints to receive the data. If data to be collected is subject to user consent: if the data consumer checked user consent, the data consumer shall provide user consent check information (i.e. an indication that it has checked user consent), otherwise, the data consumer shall provide a purpose for the data collection.\nService_Operation is the service operation used to acquire the data from a data source, Data Specification provides Service_Operation-specific required parameters (e.g. event IDs, UE-ID(s) and optional input parameters used to retrieve the data. Time Window specifies a past time period and comprises a start and stop time and Formatting and Processing Instructions are as defined in clause 5A4. The data consumer may optionally include the ADRF or NWDAF instance (or ADRF Set or NWDAF Set) ID where the stored data resides.\n2.\tThe DCCF checks if data is to be collected for a user, i.e. SUPI or GPSI, then, depending on local policy and regulations, the DCCF checks the user consent by retrieving the user consent information from UDM using Nudm_SDM_Get including data type \"User consent\" and taking into account purpose for data collection as provided in step 1. If user consent is not granted, DCCF does not subscribe to event exposure for events related to this user, the data collection for this SUPI or GPSI stops here and DCCF sends a response to the data consumer indicating that user consent for data collection was not granted. If the user consent is granted, the DCCF subscribes to UDM to notifications of changes on subscription data type \"User consent\" for this user using Nudm_SDM_Subscribe.\nIf the data consumer is NWDAF and it provides user consent check information (i.e. an indication that it has checked user consent) in Ndccf_DataManagement_Subscribe in step 1, which has been obtained by the NWDAF from UDM before, then the DCCF can do data collection for a user based on the user consent information from the NWDAF and skip retrieving it from UDM.\n3.\tIf an ADRF or NWDAF instance or ADRF Set ID or NWDAF Set ID is not provided by the data consumer, the DCCF determines if any ADRF or NWDAF instances might provide the data as described in clause 5B and 5A.2.\nNOTE 1:\tAn ADRF or NWDAF might have previously registered data it is collecting with the DCCF.\n4.\tThe DCCF sends an Nmfaf_3daDataManagement_Configure (Data Consumer Information, Formatting Conditions, Processing Instructions) to configure the MFAF to map notifications received from the ADRF or NWDAF to outgoing notifications sent to endpoints and to instruct the MFAF how to format and process the outgoing notifications.\n\"Data Consumer Information\" contains for each notification endpoint, the data consumer Notification Target Address (+ Data Consumer Notification Correlation ID) to be used by the MFAF when sending notifications. The MFAF selects an MFAF Notification Target Address (+ MFAF Notification Correlation ID) and sends the MFAF Notification Information, containing MFAF Notification Target Address (+ MFAF Notification Correlation ID), to the DCCF in the Nmfaf_3daDataManagement_Configure Response.\n5.\t(conditional) If the DCCF determines that an ADRF instance might provide the data, or an ADRF instance or Set was supplied by the data consumer, the DCCF sends a request to the ADRF, using Nadrf_DataManagement_RetrievalSubscribe (Data Specification, MFAF Notification Information) containing the MFAF Notification Target Address (+ MFAF Notification Correlation ID) received in step 4 as specified in clause 10.2.\n6.\tThe ADRF responds to the DCCF with an Nadrf_DataManagement_RetrievalSubscribe response indicating if the ADRF can supply the data. If the data can be provided, the procedure continues with step 9.\n7.\t(conditional) If the DCCF determines that an NWDAF instance might provide the data, or an NWDAF instance or NWDAF Set was supplied by the data consumer, the DCCF sends a request to the NWDAF, using Nnwdaf_DataManagement_Subscribe (Data Specification, MFAF Notification Information) as specified in clause 7.4.2. MFAF Notification Information contains the MFAF Notification Target Address (+ MFAF Notification Correlation ID) received in step 4.\n8.\tThe NWDAF responds to the DCCF with an Nnwdaf_DataManagement_Subscribe response indicating if the NWDAF can supply the data.\n9.\tThe ADRF uses Nadrf_DataManagement_RetrievalNotify or the NWDAF uses Nnwdaf_DataManagement_Notify to send the requested data (e.g. one or more stored notifications archived from a data source) to the MFAF. The data may be sent in one or more notification messages.\n10.\tThe MFAF uses Nmfaf_3caDataManagement_Notify to send data to all notification endpoints indicated in step 4. Notifications are sent to the Notification Target Address(es) using the Data Consumer Notification Correlation ID(s) received in step 4. Data sent to notification endpoints may be processed and formatted by the MFAF, so they conform to delivery requirements specified by the data consumer.\nNOTE 2:\tAccording to Formatting Instructions provided by the data consumer, multiple notifications from an ADRF or NWDAF can be combined in a single Nmfaf_3caDataManagement_Notify so many notifications from the ADRF or NWDAF results in fewer notifications (or one notification) to the data consumer. Alternatively, a Nmfaf_3caDataManagement_Notify can instruct the data notification endpoint to fetch the data from the MFAF before an expiry time.\n11.\tIf a notification contains a fetch instruction, the notification endpoint sends a Nmfaf_3caDataManagement_Fetch request as specified in clause 9.3.3 to fetch the data from the MFAF.\n12.\tThe MFAF delivers the data to the notification endpoint.\n13.\tThe UDM may notify the DCCF on changes of user consent at any time after step 2. If user consent is no longer granted for a user for which data has been collected and if there are no other consumers for the data, the DCCF shall unsubscribe to any data collection for that SUPI or GPSI. The DCCF shall further update or terminate affected subscriptions of the Data Consumer. The DCCF may unsubscribe to be notified of user consent updates from UDM for each SUPI for which user consent has been revoked.\n14.\tWhen the data consumer no longer wants data to be collected or has received all the data it needs, it invokes Ndccf_DataManagement_Unsubscribe (Subscription Correlation ID), using the Subscription Correlation Id received in response to its subscription in step 1.\n15.\tIf the data are being provided by an ADRF and there are no other data consumers subscribed to the data, the DCCF unsubscribes with the ADRF using Nadrf_DataManagement_RetrievalUnsubscribe as specified in clause 10.2.7.\n16.\tIf the data are being provided by an NWDAF and there are no other data consumers subscribed to the data, the DCCF unsubscribes with the NWDAF using Nnwdaf_DataManagement_Unsubscribe as specified in clause 7.4.3.\n17.\tThe DCCF de-configures the MFAF so it no longer maps notifications received from the ADRF or NWDAF to the notification endpoints configured in step 4.\nIn some cases data consumers (e.g. NWDAF or ADRF) collect data from data source NF directly, e.g. when NWDAF is co-located with 5GC NF.\nTo enable data consumers can get the data which has been collected by NWDAF or ADRF directly (i.e. not via DCCF), the NWDAF or ADRF may register/update the data collection profile to the DCCF during/after the procedure of data collection. DCCF can then determine some requested data is available in NWDAF or ADRF and can coordinate data collection based on the data collection profile.\nThe procedure depicted in Figure 6.2.6.3.6-1 is used by data source (e.g. NWDAF or ADRF) to register data profile to DCCF.\nThe figure depicts a procedure for the NWDAF or ADRF register data profile to DCCF, illustrating the steps involved in data exchange between the NWDAF and ADRF registers. The NWDAF register is responsible for managing the data profile, while the ADRF register is responsible for managing the data profile. The procedure outlines the steps to update the data profile, including the selection of the data profile, the selection of the data profile type, and the selection of the data profile value. The figure also includes a legend to help users understand the different data profiles and their corresponding values.\nFigure 6.2.6.3.6-1: Procedure for the NWDAF or ADRF register data profile to DCCF\n1.\tAn ADRF or NWDAF instance is collecting or has collected data directly, e.g. from collocated NF.\n2.\tThe ADRF or NWDAF requests to register/update data collection profile (Service Operation, Analytics/Data Specification, ADRF ID or NWDAF ID) to DCCF by invoking the Ndccf_ContextManagement_Register or Ndccf_ContextManagement_Update. The registration/ update request can be triggered by the acceptation of subscription for data collection responded by the data source (e.g. collocated NF), it can be before the start of data collection or after the completion of data collection. DCCF determines the data collection status of NWDAF or ADRF based on the Analytics/Data Specification, i.e. DCCF determines whether the required data is being collected or has been collected.\n\"Service Operation\" identifies the service used to collect the data or analytics from a Data Source (e.g.: Namf_EventExposure_Subscribe or Nnwdaf_AnalyticsSubscription_Subscribe).\n\"Analytics/Data Specification\" is the \"Service Operation\" specific parameters that identify the collected data (i.e.: Analytics ID(s) / Event ID (s), Target of Analytics Reporting or Target of Event Reporting, Analytics Filter or Event Filter, etc.).\nADRF ID or NWDAF ID specify the ADRF or NWDAF which registers data collection profile.\n3.\tThe DCCF responds to the ADRF or NWDAF with a Ndccf_ContextManagement_Register Response or Ndccf_ContextManagement_Update Response.\n4.\tTo obtain historical data and if the data consumer is configured to collect data via the DCCF using Ndccf_DataManagement_Subscribe service operation, the data consumer uses the procedures described in clause 6.2.6.3.2 or clause 6.2.6.3.3.\n5.\tThe ADRF or NWDAF requests to delete a registration of data collection or analytics collection to the DCCF by invoking the Ndccf_ContextManagement_Deregister, triggered for instance by a request of the service consumer or by a storage life-time expiry of related data.\nThe procedure depicted in Figure 6.2.6.3.7-1 is used by a data consumer (e.g. NWDAF or central DCCF) to obtain UE(s) data, be notified by the DCCF when the DCCF can no longer serve the UE(s) and reselect the DCCF.\nThe figure depicts a procedure for DCCF relocation initiated by a consumer, illustrating the steps involved in the relocation process. The figure includes a diagram of the consumer's location, the location of the DCCF, and the steps to be taken. The figure is labeled with the figure number and the figure name, which helps to identify the specific figure being referred to.\nFigure 6.2.6.3.7-1: Procedure for DCCF relocation initiated by consumer\n0.\tThe data consumer subscribes to source DCCF.\n1.\tSource DCCF may notify the data consumer that it cannot serve the subscription anymore, e.g. when location of UE(s) falls outside the serving area of the DCCF. A cause code is added with the notification (e.g. UE(s) moved outside DCCF serving area). The DCCF may send pending data to the data consumer.\n2.\tThe data consumer for the DCCF determines to select a new instance of DCCF. The data consumer discovers and selects the target DCCF as described in clause 6.3.19 of TS 23.501 [2]. The data consumer may perform the DCCF selection due to internal triggers, notification of a UE mobility event or by receiving the notification from the source DCCF in step 1.\n3.\tThe data consumer sends a subscription request to the target DCCF using Ndccf_DataManagement_Subscribe request.\n4.\tThe data consumer may unsubscribe from the source DCCF.\n5.\tTarget DCCF may subscribe to relevant data source(s), if not yet subscribed.\nThe procedure depicted in Figure 6.2.6.3.8-1 is used by a data consumer (e.g. NWDAF or central DCCF) to obtain UE data and to support DCCF and MFAF reselection when the DCCF or MFAF can no longer serve the UE.\nThe figure depicts a procedure for DCCF relocation initiated by DCCF, illustrating the steps involved in relocating a DCCF (Data Center Communication Facility) to a new location. The figure shows a diagram with various components such as the DCCF, the relocation process, and the necessary equipment and tools required for the relocation. The figure provides a visual representation of the process, making it easier to understand and follow.\nFigure 6.2.6.3.8-1: Procedure for DCCF relocation initiated by DCCF\n0.\tThe data consumer subscribes to source DCCF. The data consumer may indicate in the subscription request with an indicator that the DCCF may execute the relocation procedure.\nNOTE 1:\tIf the source DCCF or target DCCF does not support relocation, the consumer may execute DCCF relocation based on internal logic.\n1.\tSource DCCF subscribes UE mobility events from AMF. The UE ID is provided by the data consumer in step 0.\n2.\tIf UE moves out of the service area of the source DCCF, source DCCF determines UE DCCF subscription context to be transferred to target DCCF, e.g., triggered by a UE mobility event notification from AMF. If UE moves out of the service area of the source MFAF, source DCCF determines UE MFAF data subscription to be transferred to target MFAF.\n3.\tSource DCCF may query the NRF to discover and select the target DCCF and/or MFAF, e.g. based on the UE location information received from AMF.\nConditional on MFAF transfer:\n4.\tSource DCCF uses the Nmfaf_3daDataManagement service to request transfer of UE MFAF data subscription context to the target MFAF.\n5.\tTarget MFAF retrieves MFAF subscription context from Source MFAF.\n6.\tTarget MFAF accepts the data subscription(s) context transfer.\n7.\tTarget MFAF responds to the DCCF indicating the transfer is complete. The response may contain a Transaction Reference ID from the Target MFAF.\nConditional on DCCF transfer:\n8.\tSource DCCF using Ndccf_DataManagement_Transfer Request service operation to transfer of UE data subscription context to the target DCCF.\n9.\tTarget DCCF accepts the data subscription(s) context transfer.\n10.\tIf an MFAF is being used, the Target DCCF uses the Nmfaf_3daDataManagement_Configure service to configure the target MFAF.\n11.\tTarget DCCF confirms UE data subscription context transfer to the source DCCF. The confirmation includes the Subscription Correlation ID used by the Target DCCF.\nFor DCCF or MFAF transfer:\n12.\t[Optional] Target DCCF subscribes to the relevant data source(s), if it is not yet subscribed to the data source(s) for the data required for the data subscription context and repeat step 1 to subscribes for UE mobility events from AMF.\nNOTE 2:\tFor MFAF context transfer without DCCF context transfer, the Target DCCF is also the Source DCCF.\n13.\tSource DCCF informs the data consumer about the successful UE DCCF or MFAF data subscription context transfer using a Ndccf_DataManagement_Notify message. The notification may contain a Subscription Correlation ID provided by the target DCCF.\n14.\t[Optional] Source DCCF unsubscribes with the data source(s) that are no longer needed for the remaining UE data subscriptions.\nNOTE 3:\tAt this point, UE data subscription transfer is deemed completed.\n15-17.\tTarget DCCF or MFAF collects data from the data source(s) and notifies the data consumer using a Ndccf_DataManagement_Notify message.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.2.6.0-1: NF Services for the enhanced data collection procedures",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.2.7\tData Collection with Event Muting Mechanism",
                            "text_content": "Additional mechanisms to limit signalling between Event Producer NF (e.g. AMF, SMF) and Event Consumer NF (NWDAF, DCCF) are provided, with the Event Provider NFs enhanced with the optional capability of muting the notification of the events while storing for a limited time and limited size the events until the Event Consumer NF retrieves such mute stored events.\nThe mute storage of events mechanism in the DCCF, the NWDAF, or NFs (if configured to support event muting mechanism) reuses the Event Reporting Information field of Event Exposure Framework to include the following flags:\n-\tDeactivate notification flag: The event consumer NF includes in the subscription to an event ID the deactivation flag to indicate to the event provider NF to collect, store the requested events but halt the notification to the consumer. The number of stored events may be limited based on Event Producer NF configuration; when this number is reached or another exception occurs (e.g., full buffer), the Event Producer NF performs the actions described later in this clause.\n-\tRetrieval notification flag: The event consumer NF includes in an event subscription modification request the subscription identification and the retrieval notification flag to indicate to the event producer NF to send the past collected events not already sent to this consumer NF. After sending the past collected events the event producer continues to store events without sending notifications to the event consumer.\nWhen an Event Consumer NF requests notification muting from an Event Producer NF using the Deactivation notification flag, the Event Consumer can in addition specify requested Event Producer NF actions to be taken when an exception occurs at the Event Producer NF. The Event Consumer NF may specify the following parameters in the Event Reporting Information field of Event Exposure Framework:\n-\tEvent Producer NF action on buffered notifications: 'Send All', 'Discard All' or 'Drop Old'.\n-\tEvent Producer NF action on subscription: 'close', 'continue with muting', 'continue without muting'.\nThe Event Producer NF evaluates the requested action from the Event Consumer NF according to local policy (if configured) and in the response to the Event Consumer NF provides an accept indication if the request can be satisfied.\nIf the request is accepted, the response from the Event Producer NF may indicate the following:\n-\tThe maximum number of notifications that the Event Producer NF expects to be able to store.\n-\tAn estimate of the duration for which notifications can be buffered.\nUsing the event muting mechanism NWDAF, DCCF can subscribe to events from NFs such as AMF and SMF (if configured to support event muting mechanism), to avoid constant notifications and retrieve the mute stored events when it requires.\nThe procedure in Figure 6.2.7.2-1 is used by Event Consumer NF to control the frequency of data collection from Event Producer NFs (except DCCF and NWDAF) via Event Exposure. For data collection via DCCF and NWDAF, the consumer may mute the notifications by using the formatting instructions as specified in clause 5A.4.\nThe figure depicts a procedure for muting event notification in a system. It shows a graphical representation of the steps involved in muting an event, including the selection of the event type, the selection of the notification method, and the selection of the notification recipient. The figure is useful for understanding the process of muting events in a system and for training users on how to use the system effectively.\nFigure 6.2.7.2-1: Procedure for muting event notification\n0a.\tThe Event Consumer NF, such as NWDAF or DCCF, is configured with local policies that are used to determine when the muted storage of events is triggered and actions to be requested from the Event Producer NF if an exception occurs at the NF Producer (e.g., full buffer). The Event Producer NF is configured with local polices specifying default actions to take should an exception occur and policies for handling Event Consumers requests containing requested actions to be taken by the Event Producer NF if an exception occurs.\n0b.\tThe Event Consumer NF, such as NWDAF or DCCF, may receive a request with the Formatting and Processing parameters indicating Event Clubbing. The DCCF or NWDAF may utilize event muting when collecting data from NFs (if configured to support event muting mechanism).\n1.\tThe Event Consumer NF, DCCF or NWDAF subscribes for a (set of) Event ID(s) by invoking the Nnf_EventExposure_Subscribe service operation including in event reporting information the deactivate notification flag and optionally requested Event Producer NF actions to be taken when an exception occurs at the Event Producer NF.\nIf the Event Producer NF supports the deactivate notification flag and the requested actions to be taken by the Event Producer NF when an exception occurs, the Event Producer NF sends a response back including the Subscription Correlation ID and an indication of successful deactivation of notifications. The Event Consumer NF may request the Event Producer NF to store data related to Event ID(s), or aggregated data related to UE(s). The response from the Event Producer NF may indicates the maximum number of notifications that the Event Producer NF expects to be able to store and / or an estimate of the duration for which notifications can be buffered.\nIf the Event Producer NF does not support the deactivate notification flag or does not accept requested actions to be taken by the Event Producer NF when an exception occurs, the Event Producer NF sends a response back including an indication of failure and cause code. In this case, the Event Consumer NF re-sends the subscription request without including in the event reporting information the deactivate notification flag or with different requested actions to be taken by the Event Producer NF when an exception occurs.\nNOTE:\tIf the Event Producer NF receives a subscription without the deactivate notification flag, the steps 2 - 6 are not executed and the Event Producer NF performs the event notification as defined in clause 4.15 of TS 23.502 [3].\n2.\tBased on the request from Event Consumer NF, DCCF or NWDAF, the Event Producer NF triggers a window of event collection for the Event Consumer NF, DCCF or NWDAF subscription with the indication of \"deactivate notification flag\". The Event Producer NF keeps the association between the Event ID, Subscription Correlation ID (which identifies the consumer of the event), subscriber information (e.g. notification target information) and the status of the transaction between the Event Consumer NF, DCCF or NWDAF and the Event Producer as \"collecting events / non-notification\".\n3.\tBased on local policies or based on the Notification Time Window indicated in the Formatting and Processing parameters of the received request in step 0b, the Event Consumer NF, DCCF or NWDAF decides when to request the muted stored events from the Event Producer NF.\n4.\tEvent Consumer NF invokes the Nnf_EventExposure_Subscribe service operation from the Event Producer NF including, the Event ID, the Subscription Correlation ID and the retrieval notification flag. These parameters denote the identification of the transaction required by the Event Consumer NF, i.e. retrieve muted stored events for a subscribed Event ID and trigger a new time window of muted stored event generation without notification.\n5.\tEvent Producer NF based on the parameters received in the request from Event Consumer NF verifies whether there is a subscription to the requested Event ID with a deactivate notification flag. In positive case, Event Producer NF identifies and sends the past collected events muted during the period between the received retrieval notification flag and the last deactivate flag received from the Event consumer NF for the Event ID, the Subscription Correlation ID.\nIf an exception (e.g. full buffer) occurs, the Event Producer NF performs the actions determined in steps 0a and 1.\n6.\tThe Event Producer NF checks whether overall event reporting information (e.g. the maximum time window for the subscription of such Event ID) has expired. If yes, it does not trigger another round of event muted storage and deactivates the subscription. If not expired, the Event Producer NF trigger another time window for muted stored of produced events, sets back the deactivated notification flag for the Event ID and Subscription Correlation ID.\nIf the Event Consumer NF wants to change an existing subscription to an Event Producer NF using muted stored events into a regular notification of events, it shall invoke Nnf_EventExposure_Subscribe service operation from Event Producer NF without deactivate notification flag.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.8\tData Collection from the UE Application",
                            "text_content": "The NWDAF may interact with an AF to collect data from UE Application(s) as an input for analytics generation and ML model training. The AF can be in the MNO domain or an AF external to MNO domain. The data collection request from NWDAF may trigger the AF to collect data from the UE Application. The AF in this clause is referred as the Data Collection AF which is described in TS 26.531 [32].\nThe UE Application establishes a connection to the AF in the MNO domain or external to MNO domain over user plane via a PDU session. The AF communicates with the UE Application and collects data from UE Application.\nFor both an AF in trusted domain and an AF in untrusted domain (which supports to collect data from a UE Application), the SLA between the operator and the Application Service Provider (i.e. ASP) determines per Application ID in use by the ASP:\n-\tThe AF for the UE Application to connect to (e.g. based on an FQDN).\n-\tThe information that the UE Application shares with the AF, subject to user consent.\n-\tPossible Data Anonymization, Aggregation or Normalization algorithms (if used).\n-\tThe authentication information that enable the AF to verify the authenticity of the UE's Application that provides data.\nNOTE 1:\tThe mutual authentication info that is used by the UE Application and the AF and how user consent is obtained is out of SA WG2's scope.\nThe AF (which supports the data collection) is configured based on the SLA above.\nNOTE 2:\tData Anonymization, Aggregation or Normalization algorithms within the SLA are defined per individual UE.\nA UE Application (which supports to providing data to an AF) is configured by the ASP with the Application ID to use in the communication with the AF and then the UE Application is configured per Application ID with the following information:\n-\tThe address of the AF to contact.\n-\tThe parameters that the UE Application is authorized to provide to the AF.\n-\tThe authentication information to enable the UE Application to verify the authenticity of the AF that requests data.\nNOTE 3:\tThe authentication and authorization info that is used by the UE Application and the AF for collection and how user consent is obtained is out of SA2's scope.\nNOTE 4:\tThe configuration procedure for the above information from the ASP to the UE's Application is out of SA WG2 scope.\nNOTE 5:\tThe Application ID configured in the UE Application can either be an OSAppId as defined in TS 23.503 [4] or an OS independent Application Identifier (e.g. for applications running on a web browser).\nThe Target for Event Reporting in the Naf_EventExposure request may be set to:\n-\tan external UE ID (i.e. GPSI) or an external Group ID, in case the AF is located in the untrusted domain;\n-\ta SUPI or an internal Group ID, in case the AF is located within the trusted domain.\nThe GPSI may be an External Identifier for individual UE as defined in TS 23.501 [2] that includes the domain name. This domain name and the Application ID configured in the UE Application are different from each other.\nThe UE Application receives the data collection configuration from ASP. The configuration information is as described in clause 6.2.8.1.\nThe UE Application establishes a user plane connection to the AF. Data collection procedure from the UE Application is performed via the user plane connection.\nNOTE 1:\tWhether multiple user plane connections are established, or a single user plane connection is established for different applications between each UE Application and AF is based on implementation that is out of 3GPP scope.\nNOTE 2:\tThe Connection establishment procedure from the UE Application to the AF as above is out of scope of the present specification. For the 3GPP defined services, the Connection establishment procedure is in the scope of SA WG4. For the non-3GPP defined services, the Connection establishment procedure is out of 3GPP's scope.\nNOTE 3:\tIn order to preserve resources (e.g. battery, quota) for the end user, a user plane connection to the AF can be established only when the UE has an active PDU Session for the UE Application and it is actively using the network (i.e. the user plane connection to the AF does not need to be established when the UE Application is inactive, or used in an off-line mode).\nBoth direct data collection procedure (from the UE Application to the AF, either in trusted domain or untrusted domain) and indirect data collection procedure (from the UE Application to the Application server and from the Application server to the AF) shall be supported. The data collection procedure is described in TS 26.531 [32].\nThe AF retrieves and stores the IP address of the UE (in the PDU session used) in order to request data collection from the UE Application. The UE IP address is used by the AF to identify the user plane connection.\nNOTE 4:\tAn operator can deploy NAT functionality in the network; Data collection from the UE Application when NAT is deployed is not specified in this release of the specification.\nThe UE Application provides the Application ID configured in the UE Application to the AF as described in TS 26.531 [32].\nThe AF registers its available NF profile to the NRF. The AF in trusted domain registers to the NRF by using the Nnrf_NFManagement service that is defined in clause 5.2.7.2 of TS 23.502 [3]. The AF in untrusted domain registers the available NF profile to the NRF via the NEF as described in clause 6.2.2.3.\nThe AF discovery and selection is described in TS 23.502 [3].\nThe figure depicts a data collection procedure from an UE (User Equipment) in a 5G network. It illustrates the various steps involved in collecting data, including the use of a base station (gNB) and a user equipment (UE) to transmit and receive signals. The figure also highlights the importance of beamforming techniques to mitigate interference and ensure reliable communication.\nFigure 6.2.8.2.3-1: Data Collection Procedure from UE\n1.\tAn NF subscribes to analytics from the NWDAF as described in clause 6.1.1.1, that includes Analytics ID, Analytics Filter Information including e.g. AoI, Internal Application ID(s) and Target of Analytics Reporting. NWDAF may also initiate the data collection prior to this subscription.\nNOTE:\tSubscription to analytics can be triggered directly towards NWDAF or can be done via DCCF using procedure in clause 6.1.4.2.\n2.\tNWDAF discovers the AF that provides data collection (based on the AF profiles registered in NRF) as described in TS 23.502 [3].\nStep 3a is used for the AF in trusted domain while step 3b is used for the AF in untrusted domain.\n3a.\tNWDAF subscribes to the AF in trusted domain for UE data collection (i.e. input data from UE for analytics), by using Naf_EventExposure_Subscribe as defined in clause 5.2.19.2 of TS 23.502 [3]. The NWDAF request contains an Application ID known in the core network and the UE Application provides the Application ID configured in the UE Application. The AF binds the NWDAF request for an Application Id and the UE data collection for an Application Id configured in the UE.\n3b.\tNWDAF subscribes to the AF in untrusted domain for UE data collection (i.e. input data from UE for analytics), by using step 2 and step 3 of the procedure that is described in Figure 6.2.2.3-1.\nNOTE:\tFor steps 3a and 3b, data collection can also be triggered using DCCF, as specified in clause 6.2.6.3.\n4.\tThe AF collects the UE data using either direct or indirect data collection procedure in clause 6.2.8.2.1. The establishment of the connection can be performed at any time prior to this. The AF links the data collection request from step 3 to the user plane connection as described in clause 6.2.8.2.4.\nNOTE 1:\tThe Direct data collection and indirect data collection procedure is described in TS 26.531 [32].\nStep 5a is used for the AF in trusted domain while step 5b is used for the AF in untrusted domain.\n5a.\tThe AF in trusted domain receives the input data from the UE and processes the data (e.g. anonymizes, aggregates and normalizes) according to the SLA that is configured in the AF described in clause 6.2.8.1 and Event ID(s) and Event Filter(s) set during step 3a. The trusted AF then notifies the NWDAF on the processed data according to the NWDAF subscription in step 3a.\n5b.\tThe AF in untrusted domain receives the input data from the UE and processes the data (e.g. anonymizes, aggregates and normalizes) according to the SLA that is configured in the AF described in clause 6.2.8.1 and Event ID(s) and Event Filter(s) set during step 3b. The untrusted AF notifies the NWDAF on the processed data by using step 5b (i.e. Step 4 and step 5 of the procedure that described in Figure 6.2.2.3-1).\nNOTE 2:\tIf NWDAF requests the same data from multiple UEs, i.e. a determined list of UEs or \"any UE\" as the Target of Analytics Reporting, the AF can process (e.g. anonymize, aggregate and normalize) the data from multiple UEs according to the Event ID(s) and Event Filter(s) received from NWDAF during step 3a or 3b before notifying the NWDAF on the processed data in step 5a (if the AF is in trusted domain) or step 5b (if the AF is in untrusted domain).\n6.\tThe NWDAF produces analytics using the UE data received from the AF.\n7.\tThe NWDAF provides analytics to the consumer NF.\nIf the Target of Analytics Reporting that was received from the consumer in step 1 includes an Internal Group ID, NWDAF includes such Internal Group ID in step 3a or step 3b to AF. In the case of step 3b, NEF translates the Internal Group ID to an External Group ID.\nIf the Target of Analytics Reporting that was received from consumer in step 1 is \"any UE\", NWDAF may either set the target of event reporting to \"any UE\" in step 3a or 3b to AF, or may determine a list of SUPIs from AMF and/or SMF based on the Analytics Filter Information and sends the step 3a or 3b to AF for the determined list of UEs.\nNOTE 3:\tIt is assumed that the AF is provisioned with the list of UE IDs (GPSIs or SUPIs) belonging to an External or Internal Group ID.\n6.2.8.2.4.1\tGeneral\nThe UE IP address is used to identify the user plane connection established between the UE application and the AF for data collection, while the AF receives the Naf_EventExposure_Subscribe to request for the specific UE data collection by using SUPI (for AF in trusted domain) or external UE ID (i.e. GPSI) (for AF in untrusted domain). AF is required to correlate the UE IP address to the SUPI or to GPSI.\nIf the AF supports requests addressed to External Group ID (for AF in untrusted domain) or Internal Group ID (for AF in internal trust domain), the AF must correlate the list of external UE ID (i.e. GPSI) or SUPI, respectively, with the group(s) the UE belongs to, so that the AF can further correlate the UE ID (external or internal) to the UE IP address.\nAF may indicate in NF profile and register to NRF in clause 6.2.8.2.2 if it supports to do the mapping itself or ask NWDAF to do it. If the AF is in a trusted domain, it may also indicate the supported list of S-NSSAI, DNN combinations to NRF in NF profile.\nAccordingly, if AF supports the mapping, for AF in trusted domain, it is required to correlate the UE IP address and SUPI as described in clause 6.2.8.2.4.2 after receiving the data collection request from NWDAF and there is no mapping information storage in the AF. For AF in untrusted domain, the procedure to correlate the UE IP address and GPSI is described in clause 6.2.8.2.4.4.\nNWDAF may collect the mapping information as described in clause 6.2.8.2.4.4 before sending request to AF in step 3a or step 3b in Figure 6.2.8.2.3-1.\nIf the user plane session between the UE and the AF is released, the AF / NWDAF shall remove the stored correlation information between UE IP address / prefix and UE SUPI / GPSI.\nFor all procedures defined in this clause 6.2.8.2.4.3, a specific combination of S-NSSAI/DNN shall be corresponding to a single PDU session for a UE to access the AF (either in trusted domain or untrusted domain).\nNOTE:\tBased on implementation, for the UE to access the Data Collection AF, only a single PDU Session is allowed to be established to the Data Collection AF, by configuring a specific S-NSSAI/DNN for the Data Collection AF only.\n6.2.8.2.4.2\tAF in trusted domain correlates UE data collection and NWDAF request\nIf the AF receives the Naf_EventExposure_Subscribe/Request including Target for Event Reporting set to SUPI and not including the UE's IP address and the AF does not locally store the UE's IP address, the AF finds the PDU session(s) serving the SUPI, DNN, S-NSSAI from UDM and the allocated IPv4 address or IPv6 prefix or both from SMF as described in Figure 6.2.8.2.4.2-1.\nThe figure depicts a network architecture with a focus on the trusted domain, where the trusted entity (UE) collects data and the networkwide data aggregation function (NWDAF) requests data from the trusted entity. The figure illustrates the communication paths and the relationships between the different entities involved in the network.\nFigure 6.2.8.2.4.2-1: AF in trusted domain correlates UE data collection and NWDAF request\n0.\tAt the establishment of the user plane connection between the UE Application and the AF, the AF stores the UE IP address (for both direct and indirect reporting) as described clause 6.2.8.2.1.\n1.\tThe AF receives a request to retrieve input data as described in clause 6.2.8.2.3 including a SUPI. The AF finds the SMF serving the PDU session(s) for this SUPI using Nudm_UECM_Get_Request including SUPI, type of requested information set to SMF Registration Info and the S-NSSAI and DNN, as defined in clause 5.3.2.5.7 in TS 29.503 [26].\n2.\tThe UDM provides the SMF id and the corresponding PDU Session id, S-NSSAI, DNN using Nudm_UECM_Get_Response to the AF. Using the AF supported S-NSSAI, DNN and the received information from UDM, AF determines the PDU session used for the user plane connection between UE and AF.\n3.\tThe AF sends Nsmf_EventExposure_Subscribe to the SMF identified in step 2, including the Target for Event Reporting set to the PDU Session id(s) provided in step 2 and the Event ID set to IP address/prefix allocation/change.\n4.\tThe SMF provides the allocated IPv4 address or IPv6 prefix to the AF.\n5.\tThe AF correlates the UE data that includes the UE IP address and the NWDAF request for a SUPI using the retrieved IPv4 address or IP v6 prefix.\nIf the user plane session between the UE and the AF is released, the AF shall remove the stored correlation information between the UE IP address / prefix and SUPI.\n6.2.8.2.4.3\tAF in untrusted domain correlates UE data collection and NWDAF request\nIf the AF receives the Naf_EventExposure_Subscribe from NWDAF, via NEF, including Target for Event Reporting set to GPSI and not including the UE's IP address and the AF does not locally store the UE's IP address, the AF request the NEF to provide the allocated IPv4 address or IPv6 prefix or both as described in Figure 6.2.8.2.4.3-1.\nNOTE 1:\tThe NWDAF can also provide the UE IP address to the AF as described in clause 6.2.8.2.4.1.\nThe figure depicts a network architecture with various components, including a base station (gNB), user equipment (UE), and network elements such as optical line terminals (OLTs) and distributed nodes. The figure illustrates the use of AF (Access Facilitation) in untrusted domains, where UE data collection and NWDAF (Network Wide Data Aggregation) requests are processed. The figure highlights the importance of network security and data protection in this context.\nFigure 6.2.8.2.4.3-1: AF in untrusted domain correlates UE data collection and NWDAF request\n0.\tSame step as step 0 in figure 6.2.8.2.4.3-1.\n1.\tThe AF receives a request to retrieve input data as described in clause 6.2.8.2.3 including a GPSI. The AF requests NEF to provide the IPv4address or IPv6 prefix or both serving the PDU session for this GPSI towards the AF using Nnef_UEAddress_Get_Request.\n2.\tThe NEF is configured with the DNN, S-NSSAI to access this AF. The NEF finds the SMF serving the PDU session(s) for this GPSI, DNN, S-NSSAI using Nudm_UECM_Get_Request including type of requested information set to SMF Registration Info and the S-NSSAI and DNN, as defined in clause 5.3.2.5.7 of TS 29.503 [26].\nNOTE 2:\tIf there are more than one (DNN, S-NSSAI) combination to access this AF, the NEF will find the SMF(s) serving the PDU session(s) to any of these (DNN, S-NSSAI) combinations.\n3.\tThe UDM provides the SMF id(s) and the tuple (PDU Session id (S-NSSAI, DNN) using Nudm_UECM_Get_Response to the NEF. Using the configuration in NEF, as described in step 2, the NEF determines the PDU session used for the user plane connection between UE and AF.\n4.\tThe NEF sends Nsmf_EventExposure_Subscribe to the SMF(s) identified in step 3, including the Target for Event Reporting set to the PDU Session id(s) provided in step 3 and the Event ID set to IP address/prefix allocation/change.\n5.\tThe SMF provides the allocated IPv4 address or IPv6 prefix or both to the NEF.\n6.\tThe NEF provides the allocated IPv4 address or IPv6 prefix or both provided by SMF in step 5 to the AF.\n7.\tThe AF correlates the UE data that includes the UE IP address and the NWDAF request for the GPSI using the retrieved IPv4 address or IP v6 prefix.\nIf the user plane session between the UE and the AF is released, the AF shall remove the stored correlation information between the UE IP address / prefix and GPSI.\n6.2.8.2.4.4\tNWDAF correlates UE data collection and NWDAF request for trusted AF and untrusted AF\nNWDAF receives the analytics subscription from consumer and discover an AF as described in clause 6.2.8.2.3. NWDAF finds the PDU session(s) serving the SUPI, DNN, S-NSSAI from UDM and the allocated IPv4 address or IPv6 prefix from SMF as described in Figure 6.2.8.2.4.4-1.\nThe figure depicts a network-wide data collection and request system, NWDAF, which is crucial for efficient network management and data collection.\nFigure 6.2.8.2.4.4-1: NWDAF correlates UE data collection and NWDAF request\n1.\tThe NWDAF finds the SMF(s) serving the PDU session(s) for this SUPI or GPSI using Nudm_UECM_Get_Request including SUPI or GPSI, type of requested information set to SMF Registration Info and the list of S-NSSAI and DNN combinations, as defined in clause 5.3.2.5.7 in TS 29.503 [26]. The NWDAF acquires the DNN, S-NSSAI used to access the AF using Nnrf_NFDiscovery_Request service operation or is configured with the DNN, S-NSSAI used to access the AF.\n2.\tThe UDM provides the SMF id(s) and the corresponding PDU Session id(s), per S-NSSAI, DNN combination using Nudm_UECM_Get_Response to the NWDAF. Based on the S-NSSAI, DNN used to access the AF in step 1, NWDAF determines the PDU session used for the user plane connection between UE and AF.\n3.\tThe NWDAF sends Nsmf_EventExposure_Subscribe to the SMF identified in step 2, including the Target for Event Reporting set to the PDU Session id(s) provided in step 2 and the Event ID set to IP address/prefix allocation/change.\n4.\tThe SMF provides the allocated IPv4 address or IPv6 prefix to the NWDAF.\n5.\tStep 3a for AF in trusted domain or step 3b for AF in untrusted domain in Figure 6.2.8.2.3-1 is performed with the exception that NWDAF sets the allocated IPv4 address or IPv6 prefix that were received in step 4 as target of event reporting.\nIf NWDAF subscribed for the PDU session used for the user plane connection between the UE and the AF is released notification in step 3, the SMF informs the NWDAF that the UE IP address / prefix is released via Nsmf_EventExposure_Notify. Based on this information, the NWDAF shall remove the stored correlation information between the UE IP address / prefix and SUPI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.9\tUser consent for analytics",
                            "text_content": "Depending on local policy or regulations, to protect the privacy of user data, the data collection, ML model training and analytics generation for a SUPI or GPSI, Internal or External_Group_Id or \"any UE\" may be subject to user consent bound to a purpose, such as analytics or ML model training. The user consent is subscription information stored in the UDM, which includes:\na)\twhether the user authorizes the collection and usage of its data for a particular purpose;\nb)\tthe purpose for data collection, e.g. analytics or model training.\nThe NWDAF retrieves the user consent to data collection and usage from UDM for a user, i.e. SUPI prior to collecting user data from an NF as described in clause 6.2.2 and from a DCCF as described in clause 6.2.6.\nIn roaming scenario, the H-RE-NWDAF is the enforcement point to check user consent. The H-RE-NWDAF retrieves the roaming-related user consent for a user from the UDM.\nNOTE 1:\tThe content of the roaming-related user consent is up to SA WG3.\nIf a request for analytics is for \"any UE\", meaning that the consumer requests analytics for all UEs registered in an area, such as a S-NSSAI or DNN or AoI, then the NWDAF resolves \"any UE\" into a list of SUPIs using the Namf_EventExposure service with EventId \"Number of UEs served by the AMF and located in an area of interest\" and retrieves user consent for each SUPI. If a request for analytics is for an Internal or External Group Id, NWDAF resolves it into a list of SUPIs and retrieves user consent for each SUPI.\nIf user consent for a user is granted, then the NWDAF subscribes to user consent updates in UDM using Nudm_SDM_Subscribe service operation. Otherwise, the NWDAF excludes the corresponding SUPI from the request to collect data and generate analytics or ML model on the other users for which user consent is granted if the request is for a group of UE or \"any UE.\nWhen data is collected from the UE Application, the ASP is responsible to obtain user consent to share data with the MNO.\nIf the UDM notifies that the user consent changed, then the NWDAF checks if the user consent is not granted for the purpose of analytics or model training. If user consent was revoked for a UE, the NWDAF stops data collection for that UE. For analytics subscriptions to UE related analytics with the Target of Analytics Reporting set to that UE, the NWDAF stops generation of new analytics and stops providing affected analytics to consumers. For ML model subscriptions with Target of ML Model Reporting set to that UE, the NWDAF containing MTLF stops (re-)training of ML model(s) using data from the UE and stops providing the ML model(s) to consumers (NWDAF containing AnLF) for analytics. If the Target of Analytics Reporting or Target of ML model Reporting is either an Internal or External Group Id or a list of SUPIs or \"any UE\", the NWDAF skips those SUPIs that do not grant user consent for the purpose of analytics or model training. The NWDAF may unsubscribe to be notified of user consent updates from UDM for users for which data consent has been revoked.\nNOTE 2:\tThe NWDAF can provide analytics or ML model to consumers that request analytics or ML model for an Internal or External Group Id, or for \"any UE\", skipping those users for which consent is not granted or is revoked.\nThe Analytics ID that needs to check user consent before collecting input data are those that collect input data per user, i.e. per SUPI, GPSI, Internal or External Group Id, or those with the Target of Analytics Reporting or Target of ML model Reporting set to a SUPI, GPSI or External or Internal Group Id and are described in clause 6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.10\tData collection by H-RE-NWDAF from V-RE-NWDAF for outbound roaming users",
                            "text_content": "This procedure may be used by the RE-NWDAF in the HPLMN as service consumer to subscribe/unsubscribe to notifications about input data from the VPLMN for outbound roaming users (from the HPLMN perspective). H-RE-NWDAF and V-RE-NWDAF in the procedure are NWDAFs with roaming exchange capability.\nThe figure depicts a network diagram illustrating the data collection process for outbound roaming users. It shows the H-RE-NWDAF and V-RE-NWDAF nodes, which are part of the network's data collection infrastructure. The figure highlights the use of H-RE-NWDAF for data collection, while V-RE-NWDAF is used for outbound roaming users. The diagram illustrates the data collection process, including the use of H-RE-NWDAF for outbound roaming users, and the data is collected from V-RE-NWDAF.\nFigure 6.2.10-1: data collection by H-RE-NWDAF from V-RE-NWDAF for outbound roaming users\n1.\tFor subscription to collected data related to the UE(s), the H-RE-NWDAF checks the user consent of related users.\nNOTE:\tHow the user consent is checked needs to be aligned with SA WG3.\n2.\tThe H-RE.NWDAF of HPLMN discovers V-RE.NWDAF of VPLMN that supports the Nwdaf_RoamingData service using the NRF as specified in Clause 5.2.\nNOTE:\tThe access to the Nnf_EventExposure services is expected to be restricted to NF service consumers within the same PLMN to prevent bypassing checks based on user consent and operator policy.\n3.\tThe H-RE-NWDAF subscribes/unsubscribes to notifications about input data by invoking the Nnwdaf_RoamingData_Subscribe / Nnwdaf_RoamingData_Unsubscribe service operation. It optionally may indicate the IDs of AMFs and for local breakout also SMFs in the VPLMN handling related UEs, as obtained from the UDM.\n4.\tRE-V-NWDAF checks if the HPLMN is authorised to request the input data based on VPLMN operator polices (that may depend on the HPLMN and may indicate permissible or restricted input data and related parameters).\n5.\tThe V-RE-NWDAF triggers new data collection from NF(s ) (as indicated via the AMF ID(s) or SMF ID(s)) if needed and monitors the requested input data using procedures as described in clauses 6.2.1 to 6.2.8.\n6.\tThe V-RE-NWDAF may restrict the exposed input data based on VPLMN operator polices (that may depend on the HPLMN) and may store them for auditing.\n7.\tThe V-RE-NWDAF notifies input data to the H-RE-NWDAF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.11\tData collection by V-RE-NWDAF from H-RE-NWDAF for inbound roaming users",
                            "text_content": "This procedure may be used by an RE-NWDAF in the VPLMN to subscribe/unsubscribe to notifications about input data from the HPLMN for inbound roaming users (from the VPLMN perspective). H-RE-NWDAF and V-RE-NWDAF in the procedure are NWDAFs with roaming exchange capability.\nThe figure depicts a network architecture for inbound roaming users, illustrating the data collection process by V-NWDAF and H-NWDAF. The diagram shows the data collection process, with V-NWDAF collecting data from H-NWDAF for inbound roaming users.\nFigure 6.2.11-1: Data Collection by V-NWDAF from H-NWDAF for inbound roaming users\n1.\tThe V-RE-NWDAF of VPLMN discovers H-RE-NWDAF of HPLMN that supports the Nnwdaf_RoamingData service using the NRF as specified in clause 5.2.\nNOTE:\tThe access to the Nnf_EventExposure services is expected to be restricted to NF service consumers within the same PLMN to prevent bypassing checks based on user consent and operator policy\n2.\tThe V-RE-NWDAF subscribes/unsubscribes to input data information by invoking Nnwdaf_RoamingData_Subscribe / Nnwdaf_RoamingData_Unsubscribe service operation.\n3.\tH-RE-NWDAF checks if the VPLMN is authorised to subscribe to the indicated input data based on HPLMN operator polices (that may depend on the VPLMN and may indicate permissible or restricted input data and related parameters) and user consent of related users.\nNOTE:\tUser consent check needs to be aligned with SA WG3.\n4.\tThe H-RE-NWDAF triggers new data collection if needed and monitors the requested input data, using procedures as described in clauses 6.2.1 to 6.2.8.\n5.\tThe H-RE-NWDAF may restrict the exposed input data based on HPLMN operator polices (that may depend on the VPLMN) and may store them for auditing.\n6.\tThe H-RE-NWDAF notifies input data to the V-RE-NWDAF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.12\tData Collection using LCS",
                            "text_content": "The NWDAF may collect location information for a target UE or a group of target UEs using LCS. The collected location related information can include:\n‐\tLocation estimate of the UE in geographical coordinates and/or local coordinates expressed as a shape as defined in TS 23.032 [34] or local coordinate reference system;\n-\tTime stamp of location estimate;\n-\tVelocity of the UE as defined in TS 23.032 [34];\n-\tInformation about the positioning method used to obtain the location estimate of the UE;\n-\tIndication of area event, when UE enters, is within or leaves the Geographical area;\n-\tIndication of motion event when UE moves by more than some predefined straight line distance from a previous location.\nNOTE:\tThe location information that can be retrieved is defined within the location service response in clause 5.5 of TS 23.273 [39].\nNWDAF shall use Ngmlc service as defined in TS 23.273 [39] to collect the location information using LCS. Only Mobile Terminated Location Request (MT-LR) is supported, including both Immediate Location Request and Deferred Location Request.\nNWDAF may determine to query LCS system instead of AMF to obtain UE's location information based on the following attributes as received from NWDAF consumer:\n-\tAnalytics ID (e.g. UE Mobility, QoS Sustainability, Relative Proximity, Movement Behaviour);\n-\tPreferred granularity of location information.\nThe interactions between NWDAF and LCS for data collection are illustrated in Figure 6.2.12.2-1. The data collected depends on the use cases. This figure is an abstraction of how NWDAF collects location information using LCS. The actual procedures that NWDAF may use are as follows:\n-\tFor a target UE, both 5GC-MT-LR procedure for the commercial location service as specified in clause 6.1.2 and deferred 5GC-MT-LR procedure as specified in clause 6.3 of TS 23.273 [39] can be utilized;\n-\tFor a group of target UEs, bulk operation of LCS Service Request Targeting to Multiple UEs as specified in clause 6.8 of TS 23.273 [39] can be utilized.\nThe figure depicts a data collection system using Local Coarse-Grained Synchronization (LCS), a technique that enables efficient data collection in a distributed network. The system utilizes multiple nodes, each equipped with a local clock synchronization module, to ensure accurate time synchronization. The nodes are interconnected through a network of optical fibers, allowing for high-speed data transmission. The figure illustrates the system's architecture, including the use of local clock synchronization modules, optical line terminals (OLTs), and distributed nodes. The system's design is based on the principles of Local Coarse-Grained Synchronization (LCS), ensuring efficient data collection in a distributed network.\nFigure 6.2.12.2-1: Data collection using LCS\n1.\tNWDAF requests the location information from GMLC about a target UE (that may be identified by a SUPI) or a group of target UEs (identified by a group ID).\n2.\tGMLC interacts within LCS, i.e. with AMF/LMF as described in TS 23.273 [39], to obtain the UE's location information. If privacy verification is required, GLMC will interact with UE via AMF before sending the location information to NWDAF.\n3.1\tIf it is Immediate Location Request, GMLC sends the location service response including the location information for the target UE (or a group of target UEs) within a short time period as specified in clause 4.1a.4 of TS 23.273 [39] to the NWDAF.\n3.2\tIf it is Deferred Location Request, GMLC sends the location service response including the indication of event occurrence and location information if requested for the target UE (or group of target UEs) at some future time (or times) as specified in clause 4.1a.5 of TS 23.273 [39] to the NWDAF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.13\tRating untrusted AF data sources",
                            "text_content": "When using an untrusted AF as data source, NWDAF may consider the data source rating results. The rating of untrusted AF is based on the quality of data collected.\nSuch rating may be triggered when the accuracy check based on the calculation between the predicted and ground-truth data indicates low performance, while the untrusted data source rating may be performed based on NWDAF internal logic. In the selection of the appropriate data sources, the NWDAF may use the rate of untrusted AF data sources as a criterion to calculate the expected confidence degree.\nThe process of rating untrusted AF data sources is depicted in Figure 6.2.13.2. For realizing potential issues, the NWDAF containing AnLF subscribes to the NWDAF containing MTLF, which performs an accuracy calculation based on the predicted and ground-truth data or alternatively the NWDAF containing AnLF can calculate the accuracy locally by comparing the predicted and ground-truth data.\nThe figure depicts a network-wide data flow (NWDAF) with AnLF-based untrusted AF data source rating, illustrating the data flow and rating of the data source.\nFigure 6.2.13.2: NWDAF containing AnLF-based untrusted AF data source rating\n1.\tNWDAF containing AnLF subscribes to NWDAF containing MTLF for obtaining an ML model using the Nnwdaf_ModelProvision_Subscribe service operation. The NWDAF containing AnLF may include a threshold (as described in clause 6.2E.2) to indicate when the NWDAF containing MTLF needs to execute the accuracy monitoring operations.\nOption 1: Accuracy report from NWDAF containing MTLF\n2a.\tNWDAF containing MTLF evaluates the ML model accuracy according to clause 6.2E.2.\n2b.\tAn accuracy report is sent to the NWDAF containing AnLF, e.g. when the reporting threshold is met by invoking Nnwdaf_MLModelProvision_Notify service operation.\nOption 2: NWDAF containing AnLF computes accuracy\n2c.\tNWDAF containing AnLF calculates the accuracy by comparing the predictions with ground truth data.\n2d.\tNWDAF containing AnLF is aware that the ML Model used has a low accuracy either by receiving the accuracy report in step 2b or monitoring the accuracy by itself in step 2c. NWDAF containing AnLF determines that it needs to check further the data sources and compute data source rating. The decision conditions upon which it needs to initiate data source rating for a data source is based on NWDAF containing AnLF implementation.\n3a-3b.\tNWDAF containing AnLF initiates rating of a data source by requesting and receiving supplementary data, i.e. via Nnwdaf_DataManagement_Fetch / Ndccf_DataManagement_Notify, from different data sources (if available) to verify the data source quality or correctness. Such data can be for example performance data from the OAM which are supplementary to the data from untrusted AFs, or data from UPF supplementary to the data from untrusted AFs.\n4.\tNWDAF containing AnLF updates the rating for the sources where untrusted data is deviated from the supplementary trusted data per Event ID.\nNOTE 1:\tAn NWDAF containing AnLF determines the rating of an untrusted AF data source based on internal operations.\n5a.\tNWDAF containing AnLF stores the untrusted AF data source rating locally.\n5b.\tNWDAF containing AnLF may send the untrusted AF data source rating to UDSF, if available. NWDAF containing AnLF uses the Nudsf_ UnstructuredDataManagement_Create service operation.\nNOTE 2:\tTo avoid an untrusted AF to be permanently excluded as a data source, the NWDAF containing AnLF can re-rate the untrusted AF based on its internal logic. For example, it can rate the untrusted AF after some timer expired.\n6.\tA NWDAF consumer subscribes to a certain Analytics ID, using Nnwdaf_AnalyticsSubscription_Subscribe service operation.\nEither step 7a or step 7b is executed, before collecting the data needed for the subscribed Analytic ID.\n7a.\tThe NWDAF containing AnLF retrieves the untrusted AF rating of the data sources locally.\n7b.\tThe NWDAF containing AnLF retrieves the untrusted AF rating of the data sources from the UDSF using the to use Nudsf_ UnstructuredDataManagement_Query service operation.\n8.\tIf the rating of one or more untrusted AF is below a threshold (i.e. that is pre-configured), then the NWDAF containing AnLF can:\n(i)\tselect an alternative untrusted AF (if available) with higher rating; or\n(ii)\trequest supplementary data from other trusted data sources.\n9.\tThe NWDAF containing AnLF subscribes to a new data source to receive alternative or supplementary data if a new data source is selected in step 8.\n10.\tThe NWDAF containing AnLF may use the rate of untrusted AF data sources as a criterion to calculate the confidence level of the respective analytics output.\n11.\tThe NWDAF containing AnLF provides the analytics output to the analytics consumer, using the Nnwdaf_AnalyticsSubscription_Notify service operation.\nIn the case of ML model (re)training, if the NWDAF containing MTLF is the same NWDAF containing AnLF in step 5b, it may also use the rate of untrusted AF data sources by performing steps 7b and 8-9 and then, (re)trains the ML model.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.14\tAnalytics Collection from MDAF",
                            "text_content": "The MDA functional overview and service framework in Figure 5.1 1 as defined in TS 28.104 [45] is used by NWDAF to trigger the MDA MnS to request analytics from the MDA Management Function.\nBefore NWDAF requests analytics from the MDA Management Function, the NWDAF firstly discovers the MDA Management Function via the MnS discovery service producer as defined in clause 5 of TS 28.537 [46].\nThe figure depicts a procedure for collecting analytics from MDAF, which stands for Mobile Data Analytics Framework. The figure illustrates the steps involved in collecting data from mobile devices, such as smartphones and tablets, to analyze their usage patterns and performance. The figure includes a flowchart that outlines the process, from the initial data collection to the analysis and reporting of the results. The use of arrows and labels helps to visually represent the steps and ensure clarity in the process.\nFigure 6.2.14.2-1: Procedure for analytics collection from MDAF\nPrecondition: Initially MDAF(s) or MDA MnS producers register their capabilities, i.e. MnS information or MnS profile as described in clause 5 of TS 28.537 [46] to a MnS discovery service producer. The MnS discovery service producer may contain all or partial information related to the capabilities of MDA MnS producer.\n1.\tAn analytics consumer issues a request or subscription towards the selected NWDAF as described in clause 6.1.\n2.\tNWDAF discovers the MDA Management Function from the MnS discovery service producer by sending a MnS producer discovery service operation. The service operation may include the following parameters:\n-\trequestedMDAType: indicates a specific MDA capability such as Slice coverage analysis, Mobility performance analysis as defined in clause 7.2 of TS 28.104 [45];\n-\tArea of Interest;\n-\tNetwork Slice information (i.e. NetworkSliceInfo including a DN (Distinguished Name) of the NetworkSlice managed object relating to the network slice instance associated to the S-NSSAI and NSI ID if available as defined in TS 28.541 [22]).\n3.\tThe MnS discovery service producer feedback the relevant Mns information of the MDA Management Function.\nNOTE 1:\tMnS information refer to the information used by the consumer to discover the procedure of specific Management Services and to derive the addresses of the Management Services.\n4.\tIf more than one MDAF information is received, NWDAF selects the highest suitable MDAF and gets the address of the MDAF from Mns information. Then NWDAF sends analytics request to the MDA Management Function by triggering a MDARequest service operation as defined in clause 9.3.2 of TS 28.104 [45]. The service operation may include the following parameters:\n-\trequestedMDAOutputs: contains one or multiple MDAOutputPerMDAType, each of which consists of mDAType and optional MDAOutputIEFilters. The mDAType indicates type of analytics such as Slice coverage analysis, Mobility performance analysis, fault prediction analysis as defined in TS 28.104 [45].\n-\treportingMethod: method for analytics output (it can only be notification-based reporting since file-based, and streaming are not supported in NWDAF).\n-\treportingTarget: indicates the reporting target of the MDA outputs (in case the MDA MnS consumer is different from the one that issued the request).\n-\tanalyticsScope: Area of Interest, Network Slice information, NF type information, etc.\n-\tstartTime: indicates the start time of the analytics requested by the MnS consumer.\n-\tstopTime: indicates the stop time of the analytics requested by the MnS consumer.\nNOTE 2:\tThe selection of the most suitable MDAF can be based on MnS information, i.e., MDA type capability, received in combination with other information related to the consumer request, e.g. area of interest and time scheduling.\nEditor's note:\tWhere and how this information coming from the consumer request would be obtained needs to be coordinated with SA WG5.\n5.\tThe MDA Management Function provides the analytics to the NWDAF by triggering an MDAReporting service operation.\n6.\tNWDAF provides the analytics response back to the analytics consumer after processing the MDA Function analytics together with other data receives from NF sources according to the Analytics ID defined in clause 6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2A\tProcedure for ML Model Provisioning",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2A.0\tGeneral",
                            "text_content": "This clause presents the procedure for the ML Model provisioning.\nAn NWDAF containing AnLF may be locally configured with (a set of) IDs of NWDAFs containing MTLF and the Analytics ID(s) supported by each NWDAF containing MTLF to retrieve trained ML models or may use the NWDAF discovery procedure specified in clause 5.2 for discovering NWDAFs containing MTLF. An NWDAF containing MTLF may determine that further training for an existing ML model is needed when it receives the ML model subscription or the ML model request.\nNOTE:\tML Model provisioning/sharing between multiple MTLFs is not supported in this Release of the specification.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2A.1\tML Model Subscribe/Unsubscribe",
                            "text_content": "The procedure in Figure 6.2A.1-1 is used by an NWDAF service consumer, i.e. an NWDAF containing AnLF to subscribe/unsubscribe at another NWDAF, i.e. an NWDAF containing MTLF, to be notified when ML Model Information on the related Analytics becomes available, using Nnwdaf_MLModelProvision services as defined in clause 7.5. The ML Model Information is used by an NWDAF containing AnLF to derive analytics. The service is also used by an NWDAF to modify existing ML Model Subscription(s). An NWDAF can be at the same time a consumer of this service provided by other NWDAF(s) and a provider of this service to other NWDAF(s).\nThe figure depicts a machine learning model for analytics subscriptions and unsubscriptions, illustrating the process of data analysis and user interaction. The model is designed to predict user behavior based on historical data, allowing for more efficient and personalized service provision.\nFigure 6.2A.1-1: ML Model for analytics subscribe/unsubscribe\n1.\tThe NWDAF service consumer (i.e. an NWDAF containing AnLF) subscribes to, modifies, or cancels subscription for a (set of) trained ML Model(s) associated with a/an (set of) Analytics ID(s) by invoking the Nnwdaf_MLModelProvision_Subscribe / Nnwdaf_MLModelProvision_Unsubscribe service operation. The parameters that can be provided by the NWDAF service consumer are listed in clause 6.2A.2. The service consumer optionally indicates its support for multiple ML models if available.\nWhen a subscription for a trained ML model associated with an Analytics ID is received, the NWDAF containing MTLF may:\n-\tdetermine whether existing trained ML Model(s) can be used for the subscription; or\n-\tdetermine whether triggering further training for the existing trained ML models is needed for the subscription.\nIf the NWDAF containing MTLF determines that further training is needed, this NWDAF may initiate data collection from NFs, (e.g. AMF/DCCF/ADRF), UE Application (via AF) or OAM as described in clause 6.2, to generate the ML model.\nIf the service invocation is for a subscription modification or subscription cancelation, the NWDAF service consumer includes an identifier (Subscription Correlation ID) to be modified in the invocation of Nnwdaf_MLModelProvision_Subscribe.\n2.\tIf the NWDAF service consumer subscribes to a (set of) trained ML model(s) associated to a (set of) Analytics ID(s), the NWDAF containing MTLF notifies the NWDAF service consumer with:\n-\ta set of pair(s) of unique ML Model Identifier and ML Model Information associated with each Analytics ID requested by the service consumer.\nNOTE 1:\tThe structure and format of the ML Model identifier and its uniqueness are up to stage 3.\nNOTE 2:\tParameters defined for Multiple ML models are for Analytics accuracy enhancement.\nby invoking Nnwdaf_MLModelProvision_Notify service operation. The content of trained ML Model Information that can be provided by the NWDAF containing MTLF is specified in clause 6.2A.2.\nThe NWDAF containing MTLF also invokes the Nnwdaf_MLModelProvision_Notify service operation to notify an available re-trained ML model when the NWDAF containing MTLF determines that the previously provided trained ML Model required re-training at step 1.\nWhen the step 1 is for a subscription modification (i.e. including Subscription Correlation ID), the NWDAF containing MTLF may provide either a new trained ML model different to the previously provided one, or re-trained ML model by invoking Nnwdaf_MLModelProvision_Notify service operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2A.2\tContents of ML Model Provisioning",
                            "text_content": "The consumers of the ML model provisioning services (i.e. an NWDAF containing AnLF) as described in clause 7.5 and clause 7.6 may provide the input parameters as listed below:\n-\tInformation of the analytics for which the requested ML model is to be used, including:\n-\tA list of Analytics ID(s): identifies the analytics for which the ML model is used.\n-\t[OPTIONAL] NF consumer information: identifies the vendor of NWDAF containing AnLF.\nNOTE 1:\tNF consumer information such as Vendor ID is defined in Stage 3.\n-\t[OPTIONAL] Use case context: indicates the context of use of the analytics to select the most relevant ML model ML model.\nNOTE 2:\tThe NWDAF containing MTLF can use the parameter \"Use case context\" to select the most relevant ML model, when several ML models are available for the requested Analytics ID(s). The values of this parameter are not standardized.\n-\t[OPTIONAL] ML Model Interoperability Information. This is vendor-specific information that conveys, e.g., requested model file format, model execution environment, etc. The encoding, format, and value of ML Model Interoperable Information is not specified since it is vendor specific information, and is agreed between vendors, if necessary for sharing purposes.\n-\t[OPTIONAL] ML Model Filter Information: enables the NWDAF containing MTLF to select which ML model for the analytics is requested, e.g. S-NSSAI, Area of Interest. Parameter types in the ML Model Filter Information are the same as parameter types in the Analytics Filter Information which are defined in procedures.\n-\t[OPTIONAL] Target of ML Model Reporting: indicates the object(s) for which ML model is requested, e.g. specific UEs, a group of UE(s) or any UE (i.e. all UEs).\n-\t[OPTIONAL] Requested representative ratio: a minimum percentage of UEs in the group whose data is a non-empty set and can be used in the model training when the Target of ML Model Reporting is a group of UEs.\n-\tML Model Reporting Information with the following parameters:\n-\t(Only for Nnwdaf_MLModelProvision_Subscribe) ML Model Reporting Information Parameters as per Event Reporting Information Parameter defined in Table 4.15.1-1, TS 23.502 [3].\n-\t[OPTIONAL] ML Model Target Period: indicates time interval [start, end] for which ML model for the Analytics is requested. The time interval is expressed with actual start time and actual end time (e.g. via UTC time).\n-\t[OPTIONAL] Inference Input Data information: contains information about various settings that are expected to be used by AnLF during inferences such as:\n-\tthe \"Input Data\" that are expected be used, each of them optionally accompanied by metrics that show the granularity with which this data will be used (i.e., a sampling ratio, the maximum number of input values, and/or a maximum time interval between the samples of this input data).\nNOTE 3:\tThis can be a subset of the possible Input Data specified for a certain analytics type.\n-\tthe data sources that are expected to be used as a list of NF instance (or NF set) identifiers.\n-\tA Notification Target Address (+ Notification Correlation ID) as defined in clause 4.15.1 of TS 23.502 [3], allowing to correlate notifications received from the NWDAF containing MTLF with this subscription.\n-\t[OPTIONAL] Indication of supporting multiple ML models.\n-\t[OPTIONAL] Accuracy level(s) of Interest.\n-\t[OPTIONAL] Number of ML model(s), indicating the maximum number of ML models that the NWDAF containing MTLF could provide to the NWDAF containing AnLF.\nNOTE 4:\tMultiple ML models Filter Information are composed by Accuracy level(s) of Interest and Number of ML model(s).\n-\t[OPTIONAL] Time when model is needed: indicates the latest time when the consumer expects to receive the ML model(s).\n-\t[OPTIONAL] ML Model Monitoring Information:\n-\t[OPTIONAL] ML Model metric: i.e. ML Model Accuracy.\n-\t[OPTIONAL] ML model monitoring reporting mode: such as Accuracy reporting interval or pre-determined status. Depending on the reporting mode, the NWDAF containing MTLF reports the model accuracy to NWDAF containing AnLF either periodically or when the ML model accuracy is crossing an ML Model Accuracy threshold, i.e. the accuracy either becomes higher or lower than the ML Model Accuracy threshold.\n-\t[OPTIONAL] ML Model Accuracy Threshold: indicating the accuracy threshold of the ML Model requested by the consumer (as a kind of pre-determined status). It also can be used as an indication that the MTLF is triggered to execute the accuracy monitoring operations for the ML Model provisioned to AnLF.\n-\t[OPTIONAL] DataSetTag and ADRF ID if available: indicates the inference data (including input data, prediction and the ground truth data at the time which the prediction refers to) stored in ADRF which can be used by MTLF to retrain or reprovision of the ML model.\n-\t[OPTIONAL] ML Model Identifier: indicates the Model that the data corresponding to the DataSetTag is related to (in the case of subscription modification).\nThe NWDAF containing MTLF provides to the consumer of the ML model provisioning service operations as described in clause 7.5 and 7.6, the output information as listed below:\n-\t(Only for Nnwdaf_MLModelProvision_Notify) The Notification Correlation Information.\n-\tFor each Analytics ID requested by the service consumer, a set of pair (s) of unique ML Model identifier and the following information.\n-\tML Model Information, which includes:\n-\tthe ML model file address (e.g. URL or FQDN); or\n-\tADRF (Set) ID.\nWhen ADRF (Set) ID is provisioned, a Storage Transaction ID may also be provisioned.\n-\t[OPTIONAL] ML model degradation indicator: indicates whether the provided ML model is degraded.\n-\t[OPTIONAL] Validity period: indicates time period when the provided ML Model Information applies.\n-\t[OPTIONAL] Spatial validity: indicates Area where the provided ML Model Information applies.\nNOTE 5:\tSpatial validity and Validity period are determined by MTLF internal logic and it is a subset of AoI if provided in ML Model Filter Information and of ML Model Target Period, respectively.\n-\t[OPTIONAL] ML model representative ratio: indicating the percentage of UEs in the group whose data is used in the ML model training when the Target of ML Model Reporting is a group of UEs.\n-\t[OPTIONAL] Training Input Data Information: contains information about various settings that have been used by MTLF during training, such as:\n-\tthe \"Input Data\" that have been used, each of them optionally accompanied by metrics that show the data characteristics and granularity with which this data has been used (i.e. a sampling ratio, the maximum number of input values and/or a maximum time interval between the samples of this input data, data range including maximum and minimum values, mean and standard deviation and data distribution when applicable) and the time, i.e. timestamp and duration, when this data was obtained.\n-\tthe data sources related to the \"Input Data\" that were used for ML model training, which have been identified by a list of NF instance (or NF set) identifiers.\nNOTE 6:\tThis can be a subset of the possible Input Data specified for a certain analytics type.\nNOTE 7:\tData source information enables ML Model selection when different models are available for an Analytics ID, or it enables a consumer to avoid selecting a ML model that used data from a specific data source at a particular time or used data characterized by specific data characteristics.\n-\t[OPTIONAL]ML Model Accuracy Information: indicates the accuracy of the ML model if ML Model accuracy threshold is requested, which includes:\n-\tthe accuracy value of the ML model.\n-\t[OPTIONAL] ML model metric (i.e. ML Model Accuracy).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2A.3\tML Model request",
                            "text_content": "The procedure in Figure 6.2A.3-1 is used by an NWDAF service consumer, i.e. an NWDAF containing AnLF to request and get from another NWDAF, i.e. an NWDAF containing MTLF ML Model Information, using Nnwdaf_MLModelInfo services as defined in clause 7.6. The ML Model Information is used by an NWDAF containing AnLF to derive analytics. An NWDAF can be at the same time a consumer of this service provided by other NWDAF(s) and a provider of this service to other NWDAF(s).\nThe figure depicts a machine learning model request, with various components such as the request form, data input, and output. The request form includes fields for the model name, dataset, and parameters, while the data input includes the training data and the model's parameters. The output is a prediction or result of the model's performance.\nFigure 6.2A.3-1: ML model Request\n1.\tThe NWDAF service consumer (i.e. an NWDAF containing AnLF) requests a (set of) ML Model(s) associated with a/an (set of) Analytics ID(s) by invoking Nnwdaf_MLModelInfo_Request service operation. The parameters that can be provided by the NWDAF Service Consumer are listed in clause 6.2A.2. The service consumer optionally indicates its support for multiple ML models if available.\nWhen a request to an ML Model Information for the Analytics is received, the NWDAF containing MTLF may:\n-\tdetermine whether existing trained ML Model(s) can be used for the request; or\n-\tdetermine whether triggering further training for the existing trained ML models is needed for the request.\nIf the NWDAF containing MTLF determines that further training is needed, this NWDAF may initiate data collection from NFs, (e.g. AMF/DCCF/ADRF), UE Application (via AF) or OAM as described in clause 6.2, to generate the ML model.\n2.\tThe NWDAF containing MTLF responds to the NWDAF service consumer by invoking Nnwdaf_MLModelInfo_Request response service operation including:\n-\ta set of pair(s) of unique ML Model identifier and the ML Model Information for each Analytics ID that the NWDAF service consumer requests.\nThe content of ML Model Information that can be provided by the NWDAF containing MTLF is specified in clause 6.2A.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2B\tAnalytics Data and ML Model Repository procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2B.1\tGeneral",
                            "text_content": "Collected data and analytics may be stored in ADRF, using procedure as specified in clause 6.2B.2 and clause 6.2B.3. Collected data and analytics may be deleted from ADRF, using procedure as specified in clause 6.2B.4.\nML model may be stored in ADRF, using procedure as specified in clause 6.2B.5. ML model may be deleted from ADRF, using procedure as specified in clause 6.2B.6. ML model(s) may be retrieved from ADRF, using procedure as specified in clause 6.2B.7.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2B.2\tHistorical Data and Analytics storage",
                            "text_content": "The procedure depicted in figure 6.2B.2-1 is used by consumers (e.g. NWDAF, DCCF or MFAF) to store historical data and/or analytics, i.e. data and/or analytics related to past time period that has been obtained by the consumer. After the consumer obtains data and/or analytics, consumer may store historical data and/or analytics in an ADRF. Whether the consumer directly contacts the ADRF or goes via the DCCF or via the Messaging Framework is based on configuration.\nThe consumer may include in the storage request the DataSetTag attribute which the data records are to be associated to when stored by ADRF. The DataSetTag attribute is defined in Table 6.2B-1. Data records can be associated to multiple DataSetTag attributes.\nTable 6.2B-1: DataSetTag attribute\n\nThe consumer may include in the storage request the Data Synthesis and Compression (DSC) information. The detail of DSC information is up to implementation, which is out of 3GPP scope.\nNOTE:\tDCS information can include the following information:\n-\tindication that the data have been generated using a data synthesis tool;\n-\tindication that the data have been generated using a data compression tool;\n-\tthe information about the data synthesis and/or compression technique.\n\nThe figure depicts a storage system with various components, including a main storage unit, a backup storage unit, and a data processing unit. The main storage unit is designed to store historical data and analytics, while the backup storage unit is used to store data in case of system failure. The data processing unit is responsible for processing and analyzing the data stored in the main storage unit and backup storage unit. The figure illustrates the importance of data storage and data processing in ensuring the reliability and efficiency of the system.\nFigure 6.2B.2-1: Historical Data and Analytics storage\n0a-c.\tNWDAF, DCCF or ADRF are configured with default operator storage policies as described in clause 5B.1.\n1.\tThe consumer sends data and/or analytics to the ADRF by invoking the Nadrf_DataManagement_StorageRequest (collected data with timestamp, analytics with timestamp, Service Operation, Analytics Specification or Data Specification, Storage Handling information, optionally DataSetTag, optionally DSC information) service operation. The NWDAF or DCCF may provide notification endpoint information to the ADRF for use by the ADRF to send notifications (implicit subscription) alerting the DCCF or NWDAF that data are about to be deleted (see step 6).\n2.a-c\tBased on Storage Handling information (if available) and Storage Policy, the ADRF, DCCF or NWDAF determines the Storage Approach (life-time for storing data and whether consumer is notified prior to data deletion).\n3.\tThe ADRF stores the data and/or analytics sent by the consumer. The ADRF may, based on implementation, determine whether the same data and/or analytics is already stored or being stored based on the information sent in step 1 by the consumer NF and, if the data and/or analytics is already stored or being stored in the ADRF, the ADRF decides to not store again the data and/or analytics sent by the consumer. If the DataSetTag attribute is included for data and/or analytics already stored or being stored, then ADRF associates the data records with such DataSetTag.\n4.\tThe ADRF sends Nadrf_DataManagement_StorageRequest Response message to the consumer indicating that data and/or analytics is stored, whether the ADRF determined at step 3 that data or analytics is already stored and the Storage Approach.\nConditional on ADRF Managing the Storage Approach\n5\tThe ADRF determines that the life-time of the stored data or analytics has expired (according to the Storage Approach).\n6\tIf indicated by the Storage Approach, the ADRF sends a notification alerting the DCCF or NWDAF that data are about to be deleted.\nNOTE:\tThis is an implicit subscription.\n7.\tThe DCCF or NWDAF indicate in the response to the ADRF whether they will retrieve the Data or Analytics\n8\tThe DCCF or NWDAF may retrieve the Data or Analytics from the ADRF\nConditional on the DCCF or NWDAF Managing the Storage Approach\n9\tThe NWDAF or DCCF determine that the life-time of the stored data or analytics has expired (according to the Storage Approach).\n10. The NWDAF or DCCF optionally retrieve the data or analytics from the ADRF\n11.\tThe NWDAF or DCCF request that the data or analytics be deleted from the ADRF\n12.\tThe ADRF deletes the data or analytics if:\n-\tthe Storage Approach in the ADRF indicates alerting the consumer is not required prior to data or analytics deletion;\n-\tin step 7 the DCCF or NWDAF indicated data or analytics will not be retrieved prior to deletion;\n-\tdata or analytics retrieval in step 8 has completed; or\n-\tA request to delete data or analytics was received in step 11.\nIf the ADRF received a response from the NWDAF or DCCF in step 7 indicating data or analytics will be retrieved but retrieval is not initiated before an adequate fixed time has elapsed, the ADRF may autonomously delete the data or analytics.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.2B-1: DataSetTag attribute",
                                    "table number": 10,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.2B.3\tHistorical Data and Analytics Storage via Notifications",
                            "text_content": "The procedure depicted in figure 6.2B.3-1 is used by consumers (NWDAF, DCCF) to store received notifications in the ADRF. The consumer requests the ADRF to initiate a subscription for data and/or analytics. Data and/or analytics provided in notifications as a result of the subsequent subscription by the ADRF are stored in the ADRF.\nThe consumer may include in the subscription request the DataSetTag attribute defined in Table 6.2B-1.\nThe figure depicts a historical data and analytics storage system, illustrating the various storage methods used, such as block storage, object storage, and file storage, along with their respective advantages and disadvantages. The system is designed to provide real-time notifications to users, ensuring that they are aware of any changes or updates to the data.\nFigure 6.2B.3-1: Historical Data and Analytics Storage via Notifications\n0a-c\tNWDAF, DCCF or ADRF are configured with default operator storage policies as described in clause 5B.1.\n1a-d.\tBased on provisioning or based on reception of a DataManagement subscription request (e.g. see clause 6.2.6.3.2), the DCCF or the NWDAF determines that notifications are to be stored in an ADRF. The subscription request may contain Storage Handling information with a requested ADRF storage lifetime and a request to be notified before data are deleted from the ADRF.\n2a-b.\tThe DCCF or the NWDAF determines the ADRF where data and/or analytics needs to be stored and requests that the ADRF subscribes to receive notifications. The determination may be made based on configuration or information supplied by the data consumer as described in clauses 6.1.4 and 6.2.6.3. The request to the ADRF specifies the data and/or analytics to which the ADRF will subscribe by invoking the Nadrf_DataManagement_StorageSubscriptionRequest service operation. The request may include the DataSetTag attribute which the data records are to be associated to when stored by ADRF. If the Storage Policy is not configured on the NWDAF or DCCF, the NWDAF or DCCF sends the Storage Handling Request to the ADRF. The NWDAF or DCCF may provide notification endpoint information to the ADRF for use by the ADRF to send notifications (implicit subscription) alerting the DCCF or NWDAF that data are about to be deleted (see step 12).\n3.\t[Optional] The ADRF may, based on implementation, determine whether the same data and/or analytics is already stored or being stored, based on the information sent in step 2 by the consumer. If the DataSetTag attribute is included for data and/or analytics already stored or being stored, then ADRF associates the data records with such DataSetTag.\n3a-c.\t[Optional] Based on Storage Handling information and Storage Policy, the ADRF, DCCF or NWDAF determines the Storage Approach (life-time for storing data and whether consumer is notified prior to data deletion).\n4.\t[Optional] If the data and/or analytics is already stored and/or being stored in the ADRF, the ADRF sends Nadrf_DataManagement_StorageSubscriptionRequest Response message to the consumer indicating that data and/or analytics is stored. The ADRF includes the Storage Approach if determined in step 3c.\n5a-b.\tThe DCCF or NWDAF sends a subscription response to the Data or Analytics Consumer. The response may contain the Storage Approach determined by the ADRF, NWDAF or DCCF.\n6a-b.\tADRF subscribes to the DCCF or the NWDAF to receive notifications, providing its notification endpoint address and a notification correlation ID.\n7.\tThe DCCF, the MFAF or the NWDAF sends Analytics or Data notifications containing the notification correlation ID provided by the ADRF to ADRF notification endpoint address. The Analytics or Data notifications shall contain timestamp. The ADRF stores the notifications.\nConditional on DCCF or NWDAF determining to stop storing data or analytics\n8a-b.\tThe DCCF or the NWDAF determines to stop storing notifications in the ADRF.\n9a-b.\tThe DCCF or the NWDAF requests that the ADRF unsubscribes to receive notifications.\n10a-b.\tThe ADRF sends a request to the DCCF or the NWDAF to unsubscribe to data notifications.\nThe NWDAF may interact with the Data Source and the DCCF may interact with the Data Source and/or MFAF. Delivery of notifications from the DCCF/MFAF or NWDAF to the ADRF are subsequently halted.\nConditional on ADRF Managing the Storage Approach\n11.\tThe ADRF determines that the life-time of the stored data or analytics has expired (according to the Storage Approach).\n12.\tIf indicated by the Storage Approach, the ADRF sends a notification alerting the DCCF or NWDAF that data are about to be deleted.\nNOTE:\tThis is an implicit subscription.\nConditional if the Storage Appoach is based on Default Operator Policies provisioned on the NWDAF or DCCF (see step 3a-c and clause 5B.1)\n13.\tThe DCCF or NWDAF indicate in the response to the ADRF whether they will retrieve the Data or Analytics\n14.\tThe DCCF or NWDAF may retrieve the Data or Analytics from the ADRF\nConditional if the Storage Appoach is based on a Storage Handling Request received from the Data or Analytics Consumer (see step 3a-c and clause 5B.1)\n15a-b. The NWDAF or DCCF sends a notification to the Data or Analytics Consumer alerting it that the data or analytics are about to be deleted.\n16a-b. The Data or Analytics Consumer indicates in the response to the NWDAF or DCCF whether it will retrieve the Data or Analytics\n17. The DCCF or NWDAF indicate in the response to the ADRF whether the consumer will retrieve the Data or Analytics\n18.\tThe Data or Analytics Consumer retrieves the stored data or analytics\nConditional on DCCF or NWDAF Managing the Storage Approach\n19a-b.\tThe NWDAF or DCCF determines that the life-time of the stored data has expired (according to the Storage Approach).\nConditional if the Storage Appoach is based on Default Operator Policies provisioned on the NWDAF or DCCF (see step 3a-c and clause 5B.1)\n20.\tThe NWDAF or DCCF optionally retrieve the data or analytics from the ADRF\n21.\tThe NWDAF or DCCF request that the data or analytics be deleted from the ADRF\nConditional if the Storage Appoach is based on a Storage Handling Request received from the Data or Analytics Consumer (see step 3a-c and clause 5B.1)\n22a-b.\tThe NWDAF or DCCF sends a notification to the Data or Analytics Consumer alerting it that the data or analytics are about to be deleted.\n23a-b.\tThe Data or Analytics Consumer indicates in the response to the NWDAF or DCCF whether it will retrieve the Data or Analytics\n24.\tThe Data or Analytics Consumer retrieves the stored data or analytics\n25.\tThe NWDAF or DCCF request that the data or analytics be deleted from the ADRF\n26.\tThe ADRF deletes the data or analytics if:\n-\tthe Storage Approach in the ADRF indicates alerting the consumer is not required prior to data or analytics deletion;\n-\tin Steps 13 or 17 the DCCF or NWDAF indicated data or analytics will not be retrieved prior to deletion;\n-\tdata or analytics retrieval in steps 14 or 18 has completed or\n-\tA request to delete data or analytics was received in steps 21 or 25.\nIf the ADRF received a response from the NWDAF or DCCF in steps 14 or 17 indicating data or analytics will be retrieved but retrieval is not initiated before an adequate fixed time has elapsed, the ADRF may autonomously delete the data or analytics.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2B.4\tData removal from an ADRF",
                            "text_content": "The procedure depicted in figure 6.2B.4-1 is used by consumers (DCCF, NWDAF) to remove data previously stored in an ADRF.\nThe figure depicts a data removal process from an ADRF (Analog-to-Digital Converter) in a telecommunications system. The ADRF is a crucial component in the data processing chain, responsible for converting analog signals into digital ones. The figure shows the process of removing data from the ADRF, which is essential for maintaining the integrity of the data and ensuring that it is transmitted correctly. The process involves the use of a data removal module, which is a critical part of the ADRF's functionality. The figure also illustrates the importance of data removal in maintaining the accuracy and reliability of the telecommunications system.\nFigure 6.2B.4-1: Data Removal from an ADRF\n1.\tA consumer requests that specified data be deleted from the ADRF using Nadrf_DataManagement_Delete request service operations. The request may include the DataSetTag attribute which the stored data records are associated to.\n2.\tThe ADRF deletes all copies of the stored data.\n3.\tThe ADRF indicates the result (i.e. data deleted, data not found, data found but not deleted) using Nadrf_DataManagement_Delete response service operations.\nNOTE:\tAs described in clauses 6.2B.2 and 6.2B.3, data or analytics may be removed from an ADRF when a storage life-time expires. The NWDAF, DCCF or ADRF can provide an alert to the consumer and the consumer may retrieve data or analytics prior to deletion by the ADRF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2B.5\tML Model Storage in ADRF",
                            "text_content": "The procedure depicted in figure 6.2B.5-1 is used by NWDAF containing MTLF to store ML model in an ADRF.\nThe figure depicts a storage system in an ADRF (Adaptive Data Rate Forwarding) network, illustrating the storage architecture and its role in managing data traffic. The system includes multiple storage nodes, each equipped with a storage controller, and a network interface controller (NIC). The storage nodes are interconnected via a network of optical fibers, enabling high-speed data transfer. The figure also highlights the use of a multi-level cache to improve data caching efficiency and the use of a network-wide cache to ensure data availability across the network.\nFigure 6.2B.5-1: ML Model Storage in ADRF\n0.\tNWDAF containing MTLF determines to store ML model in ADRF based on MTLF policy.\n1.\tNWDAF containing MTLF requests to store a (set of) ML model(s) to the ADRF by invoking Nadrf_MLModelManagement_StorageRequest service.\n2.\t[Optional] If instead of the ML model(s), the ML model address(es) is/are included in request, ADRF downloads the ML model(s) based on the ML model address(es) and locally stores the ML model(s).\n3.\tThe ADRF sends Nadrf_MLModelManagement_StorageRequest Response message to the consumer including the ML Model storage result indication.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2B.6\tML Model removal from ADRF",
                            "text_content": "The procedure depicted in figure 6.2B.6-1 is used by NWDAF containing MTLF to delete ML model from an ADRF.\nThe figure depicts a removal process of a machine learning (ML) model from an Automatic Data Reconstruction (ADRF) system. The figure shows the removal of the model from the ADRF system, which is a crucial step in the data reconstruction process. The removal of the model ensures that the system can continue to function properly and accurately reconstruct the data. The figure also includes a visual representation of the ADRF system, highlighting the various components and their connections.\nFigure 6.2B.6-1: ML Model removal from ADRF\n1.\tNWDAF containing MTLF requests to delete the ML model(s) previously stored in the ADRF using Nadrf_MLModelManagement_Delete request service operation.\n2.\tThe ADRF deletes both the stored ML model(s) and related ML model information.\n3.\tThe ADRF indicates the result (i.e. ML model deleted, ML model not found, ML model found but not deleted) using Nadrf_MLModelManagement_Delete response service operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2B.7\tML model retrieval from ADRF",
                            "text_content": "The procedure depicted in Figure 6.2B.7-1 is used by consumers (NWDAF containing MTLF and NWDAF containing AnLF) to retrieve ML models from an ADRF.\nThe figure depicts a procedure for retrieving machine learning (ML) models from an Application Data Repository (ADRF), which is a central repository for storing and retrieving machine learning models. The figure shows a step-by-step process for accessing and retrieving the models, including the steps for retrieving the models from the ADRF, retrieving the models from the ADRF, and retrieving the models from the ADRF. The figure also includes a visual representation of the ADRF, which is a database that stores machine learning models. The figure is important for understanding the process of retrieving machine learning models from an ADRF and for ensuring that the models are retrieved correctly and efficiently.\nFigure 6.2B.7-1: Procedure for ML model(s) retrieval from ADRF\n1.\tThe NWDAF service consumer (NWDAF containing AnLF or NWDAF containing MTLF) subscribes/requests for a (set of) trained ML Model(s) associated with a/an (set of) Analytics ID(s) by invoking the Nnwdaf_MLModelProvision_Subscribe / Nnwdaf_MLModelInfo_Request service (if consumer is NWDAF containing AnLF) or by invoking the Nnwdaf_MLModelTraining_Subscribe service / Nnwdaf_MLModelTrainingInfo_Request (if consumer is NWDAF containing MTLF) operation.\n2.\tThe NWDAF containing MTLF determines whether the set of ML Model(s) associated with a/an (set of) Analytics ID(s) should be retrieved from the ADRF.\nWhen NWDAF containing MTLF authorizes the NF consumer to retrieve the ML model(s) stored in the ADRF directly, steps 3 and 4 is skipped.\nIf NWDAF containing MTLF determines that the set of ML Model(s) corresponding Analytics ID(s) requested in step 1 needs to be retrieved from ADRF and the NF consumer is agnostic to where the ML model(s) is stored, then Steps 3 and 4 is performed.\nNOTE:\tHow NWDAF containing MTLF and ADRF authorizes the NF Consumer is in scope of SA WG3.\n3.\tThe ADRF service consumer (NWDAF containing MTLF) requests for the ML model stored in ADRF by invoking the Nadrf_MLModelManagement_Retrieval request (Storage Transaction Identifier or one or more unique ML model Identifier(s)) service operation.\n4.\tThe ADRF sends Nadrf_MLModelManagement_Retrieval response (address(es) e.g., URL or FQDN of Model file(s) stored in ADRF) service operation.\n5.\tThe NWDAF containing MTLF notifies/ response to the NWDAF service consumer with the tuple Analytics ID, one or more tuples of unique ML Model identifier and ML Model Information. The ML model information may contain the ML model file address (e.g. URL or FQDN) or ADRF (Set) ID. When ADRF (Set) ID is provided, a Storage Transaction Identifier may be provided. The ADRF(Set) ID is included only when the NWDAF containing MTLF authorizes the NF consumer to retrieve the ML model(s) stored in the ADRF in step 2.\n6.\tIf in step 5, the NWDAF service consumer (NWDAF containing AnLF or NWDAF containing MTLF) received ADRF (Set) ID (where the ML model(s) requested in step 1 is stored), then the NWDAF service consumer may invoke the Nadrf_MLModelManagement_Retrieval Subscribe/Request (Storage Transaction Identifier or one or more unique ML Model identifier(s)) service operation to get the ML model stored in ADRF.\n7.\tThe ADRF sends Nadrf_MLModelManagement_Retrieval notify/ response (ML Model identifier(s) and address(es) of Model file(s) stored in ADRF to the NWDAF service consumer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2C\tFederated Learning among Multiple NWDAFs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2C.1\tGeneral",
                            "text_content": "This clause specifies how NWDAF containing MTLF can leverage Federated Learning technique to train an ML model.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2C.2\tProcedures",
                            "text_content": "The figure depicts the registration and discovery procedure for Federated Learning, a collaborative learning algorithm that enables multiple parties to train a model jointly without sharing their data. The figure illustrates the process of registering and discovering participants, as well as the steps involved in establishing a secure communication channel for data exchange.\nFigure 6.2C.2.1-1: Registration and Discovery procedure for Federated Learning\nSteps 1 to 3 are the NWDAF registration procedure.\n1-3.\tNWDAF containing MTLF as FL Server NWDAF or FL Client NWDAF registers to NRF with its NF profile, which includes NWDAF NF Type (see clause 5.2.7.2.2 of TS 23.502 [3]), Analytics ID(s), Address information of NWDAF, Service Area, FL capability type information (i.e. FL server or FL client) and Time interval supporting FL as described in clause 5.2.\nSteps 4 to 6 are the NWDAF Discovery procedure.\n4-6.\tNWDAF containing MTLF determines ML model requires FL based on operator policy (e.g. pre-configured list of ML models), Analytic ID, Service Area/DNAI or data can not be obtained directly from data producer NF (e.g. due to privacy reasons).\nIf the NWDAF containing MTLF can not perform as FL Server NWDAF, the MTLF first discovers and selects FL Server NWDAF from NRF by invoking the Nnrf_NFDiscovery_Request service operation. The following criteria might be used: Analytic ID of the ML model required, Model filter information as defined in TS 23.288 [5], FL capability Type (i.e. FL server), Time Period of Interest, Service Area.\nOnce the FL Server NWDAF (the requested or the selected one) is determined, the FL Server NWDAF discovers and selects other NWDAF(s) containing MTLF as FL Client NWDAF(s) from NRF by invoking the Nnrf_NFDiscovery_Request service operation. The following criteria might be used: Analytic ID of the ML model required, FL capability Type (i.e. FL client), Service Area, NF type(s) of data sources from which the FL Client NWDAF is able to collect data for local model training, Time Period of Interest, ML Model Interoperability Indicator.\n7.\tFL Server NWDAF sends Federated Learning preparation request to the FL Client NWDAF(s), using Nnwdaf_MLModelTraining_Subscribe or Nnwdaf_MLModelTrainingInfo_Request service with the ML Preparation Flag, to check if the FL Client NWDAF(s) can meet the ML model training requirement (e.g. Analytics ID, ML Model Interoperability information, Available data requirement, Availability time requirement (time span needed for the FL process), etc.). Available data requirement includes a list of Event IDs of the local data for training, and may also include the dataset statistical properties, the time window of the data samples and the minimum number of data samples.\nNOTE:\tFederated Learning preparation procedure (i.e. steps 7-9) can be skipped if the FL Server NWDAF can decide that the FL Client NWDAF(s) supports the FL procedure to be performed, e.g. based on information acquired from previous FL procedures or from the NRF, or based on local configuration.\n8.\tFL Client NWDAF(s) checks if it can meet the ML model training requirement and/or can successfully download the model if the model information is provided in the request and decides whether to join the Federated Learning process based on operator policy (e.g. pre-configured list of ML models) and/or implementation. Example criteria used by FL Client NWDAF(s) may be based on its data availability and time availability, computation and communication capability and ML Model Interoperability information.\n9.\tFL Client NWDAF(s) invokes Nnwdaf_MLModelTraining_Notify or Nnwdaf_MLModelTraining_Subscribe response service operation or Nnwdaf_MLModelTrainingInfo_Request response service operation to indicate to the FL Server NWDAF whether it will join the FL procedure and may include the reason in the response message if it cannot join the FL process.\n10.\tFL Server NWDAF determines the final list of FL Client NWDAF(s) to be involved in the FL procedures based on the information received in step 6 and other information received in step 9 (if available).\nThe figure depicts a general procedure for Federated Learning among Multiple NWDAF (Network Wide Distributed Active Learning Federated Learning) in a wireless network. It illustrates the steps involved in training a model, including data collection, model selection, and model training. The figure also highlights the importance of network-wide distributed active learning and the use of NWDAF for improving the performance of the model.\nFigure 6.2C.2.2-1: General procedure for Federated Learning among Multiple NWDAF\n0.\tThe consumer (NWDAF containing AnLF or NWDAF containing MTLF) sends a subscription request to FL server NWDAF to retrieve an ML model, using Nnwdaf_MLModelProvision service as defined in clause 7.5 including Analytics ID, ML model metric (e.g., ML model Accuracy), Accuracy reporting interval, pre-determined status (ML model Accuracy threshold or Time when the ML model is needed).\nNOTE 1:\tThe ML model Accuracy threshold can be used to indicate the target ML Model Accuracy of the training process and the FL server NWDAF may stop the training process when the ML model Accuracy threshold is achieved during the training process.\nIf the consumer (i.e. the NWDAF containing AnLF or NWDAF containing MTLF) provides the Time when the ML model is needed, the FL Server NWDAF can take this information into account to decide the maximum response time for its FL Client NWDAF(s).\n1.\tFL Server NWDAF selects NWDAF(s) containing MTLF (FL Client NWDAF(s)) as described in clause 6.2C.2.1.\n2.\tFL Server NWDAF sends a Nnwdaf_MLModelTraining_Subscribe or Nnwdaf_MLModelTrainingInfo_Request to the selected NWDAF containing MTLF (FL Client NWDAF(s)), which participates in the Federated learning to perform the local model training and determine the interim local ML model information based on the input parameter in the request from FL Server NWDAF. The request includes ML model metric and initial ML model and also includes the maximum response time, the FL Client NWDAF has to report the interim local ML model information to the FL Server NWDAF before the maximum response time elapses.\n3.\t[Optional] Each FL Client NWDAF collects its local data by using the current mechanism in clause 6.2 if the Client NWDAF has not local data available already.\n4.\tDuring Federated Learning training procedure, each FL Client NWDAF further trains the ML model provided by the FL Server NWDAF based on its own data and reports the interim local ML model information to the FL Server NWDAF in Nnwdaf_MLModelTraining_Notify or Nnwdaf_MLModelTrainingInfo_Request response. The Nnwdaf_MLModelTraining_Notify or Nnwdaf_MLModelTrainingInfo_Request response may also include the Status report of FL training that includes local ML model metric computed by the FL Client NWDAF and Training Input Data Information (e.g. areas covered by the data set, sampling ratio, maximum/minimum of value of each dimension of data, etc.) in the FL Client NWDAF. The Nnwdaf_MLModelTraining_Notify or Nnwdaf_MLModelTrainingInfo_Response also includes the global ML Model Accuracy when the ML Model Accuracy Check Flag was included in the Nnwdaf_MLModelTraining_Subscribe or Nnwdaf_MLModelTrainingInfo_Request (as described in step 7), the global ML Model Accuracy is calculated by the FL Client NWDAF using the local training data as the testing dataset.\nNOTE 2:\tThe parameters in characteristics of local training dataset are up to the implementation.\nThe local ML model, which is sent from the FL Client NWDAF(s) to the FL Server NWDAF during the FL training process, is the information needed by the FL Server NWDAF to build the aggregated model.\nIf the FL Client NWDAF is not able to complete the training of the interim local ML model within the maximum response time provided by the FL Server NWDAF, the FL Client NWDAF shall send the Delay Event Notification that include the delay event indication, an optional cause code (e.g. local ML model training failure, more time necessary for local ML model training) and the expected time to complete the training if available to the FL Server NWDAF before the maximum response time elapses.\n4a.\t[Optional]If FL Server NWDAF receives notification/response that the FL Client NWDAF is not able to complete the training within the maximum response time, the FL Server NWDAF may send to the FL Client NWDAF a new maximum response time in Nnwdaf_MLModelTraining_Subscribe or Nnwdaf_MLModelTrainingInfo_Request, before which the FL Client NWDAF has to report the interim local ML model information to the FL Server NWDAF. Otherwise, the FL Server NWDAF may indicate FL Client NWDAF to skip reporting for this iteration. FL Server NWDAF includes the current iteration round ID in the message to indicate that the request is to modify the training parameters of the current iteration round.\nAlternatively, the FL Server NWDAF may inform the FL Client NWDAF to cease the ML model training by sending termination request and to report back the current local ML model updates.\n5.\tThe FL Server NWDAF aggregates all the local ML model information retrieved at step 4, to update the global ML model. The FL Server NWDAF may also compute the global ML model metric, e.g. based on the local ML model metric(s) or by applying the global model on the validation dataset (if available). The FL Server NWDAF may update the global ML model each time a FL Client NWDAF provides updated local ML model information, or the FL Server NWDAF may decide to wait for local ML model information from all FL Client NWDAFs before updating the global ML model.\nIf the FL Server NWDAF provides the maximum response time for the FL Client NWDAF(s) to provide the interim local ML model information in step 2, or the new maximum response time in step 4a, the FL Server NWDAF decides either to wait for the FL Client NWDAF(s) which have not yet provided their interim local ML model within the new maximum response time or to aggregate only the retrieved local ML model information instances to update global ML model. The FL Server NWDAF makes this decision, considering the notification/response from the FL Client NWDAF or, if the notification is not received, based on local configuration.\n6a.\t[Optional] Based on the consumer request in step 0, the FL Server NWDAF sends a Nnwdaf_MLModelProvision_Notify message to update the ML model metric to the consumer periodically (e.g. a certain number of training rounds or every 10 min) or dynamically when some pre-determined status is achieved (e.g. the ML Model Accuracy threshold is achieved or training time expires).\n6b.\t[Optional] The consumer decides whether the current model can fulfil the requirement, e.g. global ML model metric is satisfactory for the consumer and determines to stop or continue the training process. The consumer re-invokes Nnwdaf_MLModelProvision_Subscribe service operation as used in step 0 to continue the training process or invokes Nnwdaf_MLModelProvision_Unsubscribe service operation to stop the training process.\n6c.\t[Optional] Based on the subscription request sent from the consumer in step 6b, the FL Server NWDAF updates or terminates the current FL training process.\nIf the FL Server NWDAF received a request in step 6b to stop the Federated Training process, steps 7 and 8 are skipped.\n7.\tIf the FL procedure continues, FL Server NWDAF may determine FL Client NWDAF as described in clause 6.2C.2.3 and sends Nnwdaf_MLModelTraining_Subscribe or Nnwdaf_MLModelTrainingInfo_Request that includes the aggregated ML model information to selected FL Client NWDAF(s) for next round of Federated Training. The request may also include the ML Model Accuracy Check Flag, that indicates the FL Client NWDAF(s) to use the local training data as the testing dataset to calculate the Model Accuracy of the global ML model provided by the FL Server NWDAF.\n8.\tEach FL Client NWDAF updates its own ML model based on the aggregated ML model information distributed by the FL Server NWDAF at step 7.\nNOTE 3:\tThe steps 3-8 should be repeated until the training termination condition (e.g. maximum number of iterations, or the result of loss function is lower than a threshold) is reached.\nWhen the Federated Training procedure is complete, the FL Server NWDAF requests the FL client NWDAF(s) to terminate the FL procedure by invoking Nnwdaf_MLModelTraining_Unsubscribe service with a cause code that the FL process has finished and optionally with the final aggregated ML model information. Then the FL client NWDAF(s) terminate the local model training and if the final aggregated ML model information is received from the FL server NWDAF, the FL client NWDAF(s) can store it for further use.\n9.\tAfter the training process is complete, the FL Server NWDAF may send Nnwdaf_MLModelProvision_Notify that includes the globally optimal ML model information to the consumer.\nThis clause specifies how to maintain a Federation Learning process in FL execution phase, including FL Server NWDAF triggers reselection, addition, or removal of FL Client NWDAF(s), discovers new FL Client NWDAF(s) via NRF and FL Client NWDAF(s) joins or leaves Federated Learning process dynamically.\nIn Federated Learning execution phase, FL Server NWDAF monitors the status changes of FL Client NWDAF(s) and may reselects FL Client NWDAF(s) based on the updated status, availability and/or capability, etc.\nNOTE 1:\tFL Server NWDAF checks if there is a need to carry on the FL execution phase and then reselects FL members for the next iteration if needed.\nThe figure depicts the procedure of FL Server NWDAF reselecting FL Client NWDAF(s) in the Federated Learning execution phase, dynamically joining or leaving the process based on the client's participation in the learning process.\nFigure 6.2C.2.3-1: Procedure of FL Server NWDAF reselects FL Client NWDAF(s), FL Client NWDAF(s) Join or Leave Federated Learning Process Dynamically in Federated Learning execution phase\nThe procedure for FL Server NWDAF reselecting FL Client NWDAF(s), FL Client NWDAF(s) joining or leaving Federated Learning process dynamically is as follows:\n1a.\tFL Server NWDAF may get the updated status of current FL Client NWDAF(s) via NRF by using Nnrf_NFManagement service (as in clause 5.2.7.2 of TS 23.502 [3]) in the Federated Learning execution phase.\nFL Server NWDAF may subscribe to NRF for notifications of status changes of the current NWDAF(s) (FL Client NWDAFs 1…N) by invoking an Nnrf_NFManagement_NFStatusSubscribe service operation. NRF notifies the FL Server NWDAF the status changes of the current FL Client NWDAF(s) by invoking Nnrf_NFManagement_NFStatusNotify service operation(s).\nThe status of a current FL Client NWDAF could be availability changes, capability changes (e.g. it will not support FL anymore, etc.).\n1b.\tThe current FL Client NWDAF(s) may inform FL Server NWDAF that it is leaving the Federated Learning process by invoking Nnwdaf_MLModelTraining_Notify service operation with Termination Request and cause code (reason for leaving, e.g. high NF load, time availability changes).\n1c.\tFL Server NWDAF may get the information of the new FL Client NWDAF(s) dynamically via NRF by subscribing to the event that a new FL Client NWDAF registers (Nnrf_NFManagement_NFStatusSubscribe service as in clause 5.2.7.2 of TS 23.502 [3]).\n1d.\tNWDAF may subscribe for NF load analytics of the FL Client NWDAF(s).\n1e.\tFL Client NWDAF(s) may send Status report of FL training and Global ML Model Accuracy Information by invoking Nnwdaf_MLModelTraining_Notify service.\n2.\tFL Server NWDAF checks FL Client NWDAF(s) status based on the received information and may determine whether reselection of FL Client NWDAF(s) for the next round(s) of Federated Learning is needed based on the received information from step 1.\nNOTE 2:\tSeveral examples of the factors that the FL Server NWDAF can consider to reselect the FL Client NWDAF(s) are updated status of FL Client NWDAF reported by NRF is different than the criteria were initially used for selecting the client; characteristics of local training dataset is different than global validation dataset owned by FL Server NWDAF and/or the accuracy of the global model calculated using the local training dataset is much different from that calculated by other FL Client NWDAFs; the accuracy of the global model calculated using the local training dataset is lower than the accuracy calculated using the global validation dataset owned by FL Server NWDAF; the accuracy of the global model calculated using the local training dataset is lower than ML Model accuracy information received in Nnwdaf_MLModelMonitor_Notify when FL Server NWDAF using AnLF-assisted MTLF ML Models Accuracy Monitoring; the load of the FL Client NWDAF (from the NF load Analytics or from the FL Client NWDAF directly) is high; the FL Server NWDAF receives leave request from the FL Client NWDAF; the FL Client NWDAF did not report the status of FL Training within the maximum response time.\n3.\t[If re-selection is needed as judged in step 2] If step 1c is not performed, FL Server NWDAF may discover new candidate FL Client NWDAF(s) via NRF by using Nnrf_NFDiscovery services as in clause 5.2.7.3 of TS 23.502 [3]. FL Server NWDAF reselects FL Client NWDAF(s) from the current FL Client NWDAF(s) and the new candidate FL Client NWDAF(s) (found in steps 1c or 3). For the new candidate FL Client NWDAF(s), the interaction between FL Server NWDAF and FL Client NWDAF(s) is same as the selection procedure described in clause 6.2C.2.1. The adding / deleting FL Client NWDAF(s) may happen at the end of each iteration.\n4.\tFL Server NWDAF sends termination request by invoking Nnwdaf_MLModelTraining_Unsubscribe service operation or Nnwdaf_MLModelTrainingInfo_Request service operation with Correlation Termination Flag to the FL Client NWDAF(s), optionally indicating the reason, e.g. FL Client NWDAF is unselected by the FL Server NWDAF for the FL process, or the FL process is suspended, etc. And FL server may also send the updated global ML model information to the unselected FL client NWDAF. FL Client NWDAF(s) terminates operations for the Federated Learning process if receive termination request from the FL Server NWDAF and may perform further action to be qualified in participation of FL training in the next cycles.\nNOTE 3:\tIn the case of high load, the FL Client NWDAF can e.g. decline new service request. In the case of low accuracy, the FL Client NWDAF can gather new local training data.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2D\tAnLF Analytics Accuracy Monitoring Procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2D.1\tGeneral",
                            "text_content": "The Analytics Accuracy Information comprises a set of parameters as defined in clause 6.1.3.\nWhen multiple NWDAFs are deployed, some NWDAFs may be specialized with the analytics accuracy checking capability. When an NWDAF containing AnLF has the accuracy checking capability, such an NWDAF is able to:\n-\tReceive a subscription or a request for analytics IDs via Nnwdaf_AnalyticsSubscription_Subscribe or Nnwdaf_AnalyticsInfo_Request service operation with the indication for activating the mechanisms for checking the accuracy of such analytics ID as defined in clause 6.1.3.\n-\tProvide the accuracy information to the consumer via Nnwdaf_AnalyticsSubscription_Notify or Nnwdaf_AnalyticsInfo_Request response service operation.\nNOTE 1:\tIn this version of the specification, NWDAF containing AnLF can provide accuracy information to an NF consumer that subscribes or requests for the analytics.\nNOTE 2:\tWhen receiving a subscription from an NF consumer that includes a request for accuracy information, the analytics output and the accuracy information can be provided by NWDAF containing AnLF in a single notification or via separate notifications.\nNOTE 3:\tWhen receiving a request from an NF consumer that includes a request for accuracy information, the analytics and the accuracy information can be provided by NWDAF containing AnLF within the single response.\nNOTE 4:\tIn this version of the specification, the subscription or request for accuracy information independently from requesting an analytics output is not supported.\nBased on the triggers described in clause 5C.1, NWDAF containing AnLF starts the accuracy monitoring and generation of analytics accuracy information for an Analytics ID.\nThe Analytics accuracy information may be requested per Analytics ID and scoped using the same parameters as those defined in the Target of Analytics Reporting (i.e. UEs, any UE, group of UEs) and Analytics Filter Information (e.g. for a specific area, specific slice) of the requested Analytics ID.\nWhen the accuracy checking is activated in an NWDAF containing the AnLF, the NWDAF may store for a period of time the necessary information to determine the analytics accuracy and provide the accuracy information to consumers when requested or use it for its internal processes.\nNWDAF containing AnLF generates the accuracy information as described in clause 5C.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2D.2\tProcedures for Analytics Accuracy Information Subscription",
                            "text_content": "This procedure is used by NF consumers of analytics ID to subscribe to receive analytics output and analytics accuracy information related to the requested analytics ID for NF consumer. Figure 6.2D.2-1 shows the procedure for accuracy information subscription and provisioning.\nThe figure depicts a 2D map with various analytics accuracy information subscriptions, including the number of subscribers, the number of active subscribers, and the number of inactive subscribers. The map is color-coded to indicate the status of each subscription, with green indicating active, yellow indicating inactive, and red indicating terminated. The map is annotated with the name of each subscription, providing a clear and concise overview of the subscriber base.\nFigure 6.2D.2-1: Analytics Accuracy Information Subscribe\n1.\tThe NWDAF service consumer selects the appropriated NWDAF containing AnLF according to clause 5.2 and subscribes or modifies the subscription for analytics accuracy information by invoking the Nnwdaf_AnalyticsSubscription_Subscribe service operation. The parameters that can be included in the subscription to trigger the accuracy information checking and provisioning are listed in clause 6.1.3.\nIf the subscription is not the initial subscription request, it may include Analytics feedback information as described in clause 6.1.1.\n2.\tWhen a subscription request is received, the NWDAF containing AnLF verifies the parameters of the Analytics Accuracy Request information received from the NWDAF service consumer in step 1.\nThe NWDAF containing AnLF starts the analytics accuracy monitoring and generation of the analytics accuracy information related to the analytics ID indicated in the subscription according to the parameters defined in Analytics Accuracy Request Information in clause 6.1.3. The NWDAF containing AnLF is to compute analytics accuracy information according to the methods in clause 6.2D.1. If the NWDAF containing AnLF does not have enough necessary data, it will perform step 3b to collect ground truth data before computing analytics accuracy information.\nThe NWDAF containing AnLF may have started to perform the analytics accuracy monitoring and analytics accuracy information generation, triggered by other NWDAF service consumer(s) before. Upon receiving a new request from the NWDAF service consumer, the NWDAF containing AnLF determines whether new data collection is needed for analytics accuracy information generation based on the corresponding analytics subscription.\nIn addition to the received request from the NWDAF service consumer, based on local policy, the NWDAF containing AnLF may determine to start the analytics accuracy monitoring and analytics accuracy information generation.\n3a.\tThe NWDAF containing AnLF performs the data collection for the subscribed analytics ID and generates the analytics output.\n3b.\tThe NWDAF containing AnLF performs the data collection (e.g., ground truth data collection) for accuracy information generation for the subscribed analytics ID and generates the associated analytics accuracy information. If Analytics feedback information is included in step 1, the NWDAF containing AnLF may take it into account and determine whether it affects the ground truth data by the internal logic to generate analytics accuracy information.\n4a.\tThe NWDAF containing AnLF provides the analytics output according to the parameters defined in Analytics Reporting Information included in the subscription request when there is no Analytics Accuracy Request Information included in the subscription in step 1.\nNOTE:\tSteps 3b and 4a can occur in any order.\n4b.\tThe NWDAF containing AnLF provides the analytics accuracy information together with the analytics output for the analytics ID according to the parameters defined in the Analytics Accuracy Request Information included in the subscription request.\n4c.\tThe NWDAF containing AnLF provides only the analytics accuracy information for the analytics ID according to the parameters defined in the Analytics Accuracy Request Information included in the subscription request. The analytics accuracy information is provided in a separated notification when the periodicity for providing the analytics accuracy information indicated in the Analytics Accuracy Request Information is different from the periodicity for providing the analytics output indicated in the subscription request, or the accuracy value is under the analytics accuracy threshold which is indicated in the subscription request or locally configured.\n5.\tWhen determining the low or insufficient accuracy for an analytics ID, i.e. the deviation of the analytics output using the trained ML model from the ground truth data (which are collected from Data Producer NF corresponding to the requested analytic ID at the time which the prediction refers to) does not meet analytics accuracy requirement, which indicates the accuracy value is under the analytics accuracy threshold(s) (which are locally configured or received in the subscribe request), the NWDAF containing AnLF may notify the NWDAF Service consumer with the Stop Analytics Output Consumption indication and the Stop Analytics Output Consumption time window.\n6.\t(Optional) The NWDAF Service Consumer may decide to stop the consumption of analytics output without unsubscribing to the analytics ID, based on its own logic or based on a received notification from NWDAF with the Stop Analytics Output Consumption indication. The NWDAF Service Consumer invokes the Nnwdaf_AnalyticsSubscription_Subscribe service operation including the Subscription Correlation ID to modify an existing subscription and provides the parameter Pause analytics consumption flag in the Analytics Accuracy Request Information.\n7.\tWhen the NWDAF determines an improvement in the accuracy of an analytics ID (e.g. meet the accuracy requirement of the analytics consumer) or when the Stop Analytics Output Consumption time window set by itself is finished, the NWDAF notifies the NWDAF Service Consumer of the accuracy information for the analytics ID to resume the consumption of the analytics output, therefore reactivating an existing analytics ID subscription that has been previously stopped.\n8.\t(Optional) The NWDAF Service Consumer based on its own logic can notify the NWDAF to resume the notification of analytics output, therefore reactivating an existing subscription to analytics ID that has been paused either by NWDAF Service Consumer request (step 6) or by NWDAF indication (step 5). The NWDAF Service Consumer invokes the Nnwdaf_AnalyticsSubscription_Subscribe service operation including the Subscription Correlation ID to modify an existing subscription and provides the parameter Resume Analytics Subscription request in the Analytics Accuracy Request Information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2D.3\tProcedures for Analytics Accuracy Information Request",
                            "text_content": "This procedure is used by NF consumers of analytics ID to request analytics accuracy information related to the requested analytics ID for NF consumer. Figure 6.2D.3-1 shows the procedure for accuracy information request and response.\nThe figure depicts a 3D representation of analytics accuracy information request, with various data points and axes indicating different aspects of the request. The axes include \"Accuracy Level,\" \"Data Type,\" \"Data Source,\" \"Data Format,\" \"Data Volume,\" and \"Data Processing.\" The figure provides a comprehensive overview of the request, allowing users to understand the scope and requirements of the analytics process.\nFigure 6.2D.3-1: Analytics Accuracy Information Request\n1.\tThe NWDAF service consumer selects the appropriated NWDAF containing AnLF according to Clause 5.2 and requests for analytics accuracy information by invoking the Nnwdaf_AnalyticsInfo_Request service operation. The parameters that can be included in the request to trigger the accuracy information checking and provisioning are listed in clause 6.1.3.\n2.\tWhen a request is received, the NWDAF containing AnLF determines whether the request is only for analytics output generation or if it includes the Analytics Accuracy request.\nIf the Analytics Accuracy request is included, the NWDAF containing AnLF starts the analytics accuracy monitoring and generation of the analytics accuracy information related to the analytics ID indicated in the request and according to the parameters defined in Analytics Accuracy Request Information in clause 6.1.3. The NWDAF containing AnLF is to compute analytics accuracy information according to the methods in Clause 6.2D.1. If the NWDAF containing AnLF does not have enough necessary data, it will perform step 3b to collect ground truth data before computing analytics accuracy information.\nThe NWDAF containing AnLF may have started to perform the analytics accuracy monitoring and analytics accuracy information generation, triggered by other NWDAF service consumer(s) before. Upon receiving a new request from the NWDAF service consumer, the NWDAF containing AnLF determines whether new data collection is needed for analytics accuracy information generation based on the corresponding analytics request.\nIn addition to the received request from the NWDAF service consumer, based on local policy, the NWDAF containing AnLF may determine to start the analytics accuracy monitoring and analytics accuracy information generation.\n3a.\tThe NWDAF containing AnLF performs the data collection for the requested analytics ID and generates the analytics output.\n3b.\tThe NWDAF containing AnLF performs the data collection (e.g., ground truth data collection) for accuracy information generation for the requested analytics ID and generates the associated analytics accuracy information.\n4a.\tThe NWDAF containing AnLF provides the analytics output according to the parameters defined in Analytics Reporting Information included in the request, when no Analytics Accuracy Request Information is included in the request in step 1.\nNOTE:\tStep 3b, 4a can occur in any order.\n4b.\tThe NWDAF containing AnLF provides the requested analytics output and analytics accuracy information for the analytics ID according to the parameters defined in the Analytics Accuracy Request Information included in the request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2E\tMTLF-based ML Model Accuracy Monitoring",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2E.1\tGeneral",
                            "text_content": "MTLF-based ML Model Accuracy Monitoring procedure is where an NWDAF containing MTLF determines ML Model degradation based on newly collected test data and retrain or reprovisioning the existing ML Model.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2E.2\tProcedure for MTLF-based ML Model Accuracy Monitoring",
                            "text_content": "Figure 6.2E.2-1 illustrates the procedure for monitoring the accuracy of the provisioned ML model using newly collected data. NWDAF containing AnLF may provide inference data to NWDAF containing MTLF for model accuracy monitoring and the NWDAF containing MTLF determines retraining or re-provisioning of the ML model.\nThe figure depicts a procedure for monitoring the accuracy of a machine learning (ML) model using Multi-Layer Perceptron (MLP) based techniques. The figure illustrates the steps involved in the process, including data collection, feature extraction, model training, and model evaluation. The figure also includes a legend to help understand the different components and their functions.\nFigure 6.2E.2-1: Procedure for MTLF-based ML Model Accuracy Monitoring\n1.\tAn analytics consumer initiates a subscription for analytics exposure services towards an NWDAF containing AnLF.\n2.\tThe NWDAF containing AnLF requests an ML model from the appropriate NWDAF containing MTLF, using the Nnwdaf_MLModelProvision_Subscribe service operation. The NWDAF containing AnLF may include an ML Model accuracy threshold which is used as an indicator to execute the accuracy monitoring operations as defined in clause 6.2A.2. NWDAF containing AnLF may include a DataSetTag (see clause 6.2B.1) and/or ADRF ID, which is used to store and fetch the inference data (including input data, prediction and the ground truth data at the time which the prediction refers to) from ADRF which are relevant for the accuracy monitoring and re-training/re-provisioning of ML model.\nIf the NWDAF containing AnLF receives ML model(s), the NWDAF containing AnLF sends set of tuples (unique ML model identifier and the DataSetTag and/or ADRF ID) to the NWDAF containing MTLF by invoking Nnwdaf_MLModelProvision_Subscribe service operation for subscription modification.\n3.\tThe NWDAF containing MTLF provides trained ML model(s) to the NWDAF containing AnLF. The NWDAF containing MTLF may include an accuracy information which is used to indicate the accuracy of ML model during the training.\nWhen the step 1 is for a subscription modification (i.e. including Subscription Correlation ID) and contains the set of tuples (unique ML model identifier and the DataSetTag and/or ADRF ID), the NWDAF containing MTLF determines the relationship between the ML model and the DataSetTag.\n4.\tThe NWDAF containing AnLF registers the use of the ML model with the NWDAF containing MTLF to indicate its capability of sending Analytics feedback information and/or ML model accuracy information from the analytics consumers for the ML model.\n5.\tDue to the registration in the previous step, the NWDAF containing MTLF may subscribe to the NWDAF containing AnLF to get Analytics feedback information and/or ML model accuracy information from the analytics consumers for the provisioned ML model by invoking Nnwdaf_MLModelMonitor_Subscribe service operation, if the service operation is supported by the NWDAF containing AnLF.\n6.\tThe Analytics consumer may send Analytics feedback information in an Nnwdaf_AnalyticsSubscription_Subscribe message as described in clause 6.1.1.\n7.\tThe NWDAF containing AnLF may send the Analytics feedback information and/or ML model accuracy information received from the analytics consumer for the provisioned ML model by invoking Nnwdaf_MLModelMonitor_Notify service operation as requested in step 5. When the NWDAF containing MTLF receives Analytics feedback information and/or ML model accuracy information, the NWDAF containing MTLF may trigger step from 8 to 13 to enhance the ML model accuracy.\n8a-8f.\tThe NWDAF containing MTLF, based on the request(s) from one or more NWDAF containing AnLF or its local policy, determines whether to perform ML model accuracy monitoring and re-training/re-provisioning of ML model by collecting new data from various data sources:\n-\tThe NWDAF containing MTLF may collect new data for ML Model Accuracy monitoring, re-training and re-provisioning from the data source NFs and DCCF by invoking Nnf_EventExposure_Subscribe and Ndccf_DataManagement_Susbscribe service operation, respectively.\n-\tWhen ADRF ID and/or DataSetTag is given by step 2, the NWDAF containing MTLF may retrieve historical data from the ADRF indicated by the NWDAF containing AnLF at step 2. by invoking Nadrf_DataManagementRetrievalRequest or Nadrf_DataManagementRetrieval_Subscribe service operation. Otherwise, the NWDAF containing MTLF may retrieves the historical data from the DCCF or the NWDAF containing AnLF by invoking Ndccf_DataManagement_Subscribe or Nnwdaf_DataManagement_Subscribe service operation, respectively.\n-\tIf the NWDAF containing AnLF does not include a DataSetTag with ADRF ID at step 2, the NWDAF containing MLTF may request ADRF to subscribe for the collection of the analytics and data that correspond to the analytics generated by the ML model provisioned in step 3, using the procedures defined in clause 6.2B.3.\n-\tThe NWDAF containing MTLF may subscribe to UDM to get notification on change in the subscription data for Target of ML Model Reporting by invoking Nudm_SDM_Subscribe service operation and the UDM subscribes to the UDR to get notifications of the modification on UE subscription data by invoking Nudr_DM_Subscribe service operation.\n-\tThe NWDAF containing MTLF may consider the data quality into the accuracy monitoring by collecting fault prediction analytics data from MDAS to determine the status of Data Source NFs, using MDA Request.\nIf the NWDAF containing MTLF has already collected new test data and performed ML model accuracy monitoring and retraining which is triggered by other NWDAF containing AnLF(s) (for ML model accuracy monitoring and retraining), the NWDAF containing MTLF, based on its internal logic, determines whether to use the data for the subscription or not.\n9a-9f.\tThe NWDAF containing MTLF receives the requested data from various sources as requested in steps 8a-8f.\n10.\tBased on the collected analytics and data from steps 9a-9f, the NWDAF containing MTLF computes the accuracy using the methods described in clause 5C.1. The NWDAF containing MTLF may discard data from data sources if it detects the data quality of that source is not good. The NWDAF containing MTLF may generate prediction with the collected input data to calculate the accuracy if only input data and ground truth data are available.\nNOTE:\tHow the NWDAF containing MTLF determines whether the data from the data source is of good quality or needs to be discarded is up to the NWDAF implementation and configuration.\n11.\tAn accuracy report is sent to the NWDAF containing AnLF, e.g. when the reporting threshold is met by invoking Nnwdaf_MLModelProvision_Notify service operation.\n12.\tBased on the computed accuracy, the NWDAF containing MTLF may decide to re-train/re-provision the ML model.\n13.\tWhen the newly generated or re-trained ML model is ready, the NWDAF containing MTLF sends new or re-trained ML model to the NWDAF containing AnLF by invoking Nnwdaf_MLModelProvision_Notify service operation. The NWDAF containing MTLF may send the accuracy report of the new or re-trained ML model to the NWDAF containing AnLF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2E.3\tProcedure for AnLF-assisted MTLF ML Models Accuracy Monitoring",
                            "text_content": "The procedures described in this clause enable the following functionality:\n-\tAn NWDAF containing AnLF may register with an NWDAF containing MTLF when it starts using an ML model and monitoring the accuracy of analytics generated by that ML Model for a given Analytics ID. It is assumed that the NWDAF containing AnLF obtained the ML model in a previous interaction with the NWDAF containing MTLF, e.g. using the Nnwdaf_MLModelInfo_Request or Nnwdaf_MLModelProvision services. This registration enables the NWDAF containing MTLF to become aware of NWDAF containing AnLF that are using a given ML model for certain Analytics ID and that the NWDAF containing AnLF supports the capability of monitoring the accuracy of the corresponding analytics.\n-\tAn NWDAF containing MTLF may subscribe to an NWDAF containing AnLF where an existing Nnwdaf_MLModelMonitor service is established for receiving notifications of the accuracy of analytics generated by a given ML model for a certain Analytics ID. NWDAF containing AnLF can generate the accuracy information in many ways: e.g. comparing predictions of ML model and its corresponding ground truth data, comparing changes in internal configuration for the analytics ID generation, previous existent records of analytics accuracy information etc.\nWhen an NWDAF containing AnLF starts making use of an ML model and it has the ability either to monitor the analytics accuracy of the ML model, or to deliver Analytics feedback information for the analytics generated by the ML model, it registers with the NWDAF containing MTLF, that is responsible for training/updating this ML model.\nWhen the NWDAF containing AnLF is no longer using the ML model or monitoring the accuracy of the analytics generated by that ML model for the Analytics ID, it de-registers it with the responsible NWDAF containing MTLF.\nFigure 6.2E.3.2-1 illustrates the procedure by which an NWDAF containing AnLF registers with an NWDAF containing MTLF that it is starting to make use and monitor the analytics accuracy of an ML model. A new Nnwdaf_MLModelMonitor_Register service operation is used for that purpose.\nThe figure depicts a procedure for monitoring and registering machine learning models in an ML model monitoring system. It illustrates the steps involved in the registration process, including data collection, model evaluation, and model maintenance. The figure is crucial for ensuring the accuracy and reliability of the ML model, as it provides a visual representation of the process.\nFigure 6.2E.3.2-1: Procedure for ML Model monitoring registration\nAn NWDAF containing AnLF may start monitoring the accuracy of an ML model based on local policy or request from its service consumer.\n1-2.\tThe NWDAF containing AnLF sends an Nnwdaf_MLModelMonitor_Register request to an NWDAF containing MTLF (NWDAF containing AnLF NF ID, unique identifier of the ML model, optionally: subscription endpoint of the Nnwdaf_MLModelMonitor_Subscribe service operation at the NWDAF containing AnLF). The NWDAF containing MTLF is now aware of the NF ID of the NWDAF containing AnLF that is monitoring the accuracy of that ML model.\nIf the NWDAF containing AnLF is a target NWDAF in analytics transfer procedure (as defined in clause 6.1B), based on the ML Model accuracy information received from source NWDAF containing AnLF, the NWDAF containing AnLF also includes in the Nnwdaf_MLModelMonitor_Register service request the ML Model accuracy transfer indication, which includes the original Subscription Correlation ID for the ML model accuracy information provided by the source NWDAF containing AnLF and the source NF ID of the NWDAF containing AnLF.\nNOTE 1:\tThese parameters support the NWDAF containing MTLF to map the registration of a new NWDAF containing AnLF with an existing subscription for consumption of ML model accuracy information from a previous NWDAF containing AnLF (i.e. source NWDAF containing AnLF which as described in steps 3-4 may provide a termination indication), enabling NWDAF containing MTLF to reassociate the data from the previous subscription to the new the subscription for ML Model accuracy provisioning at the new NWDAF containing AnLF.\n3-4.\tWhen the NWDAF containing AnLF is no longer using the ML model, it sends an Nnwdaf_MLModelMontior_Deregister service operation.\nIf NWDAF containing AnLF is registered with a NWDAF containing MTLF, is a source NWDAF containing AnLF in an analytics transfer procedure (as defined in clause 6.1B) and is no longer using the ML model, the NWDAF containing AnLF sends Nnwdaf_MLModelMontior_Deregister service operation request including the ML Model accuracy provisioning termination information, which includes: a termination indication, the termination cause set to analytics transfer and optionally the NWDAF containing AnLF NF ID of the target NWDAF.\nNOTE 2:\tThe ML Model accuracy termination information is used by the NWDAF containing MTLF to determine whether the termination request is from the source NWDAF containing AnLF. If so, the NWDAF containing MTLF will not delete any data immediately upon receiving of a de-registration request. Then the NWDAF containing MTLF is able to associate the data from the source NWDAF containing AnLF to the target NWDAF containing AnLF.\nAn NWDAF containing MTLF, due to the registration of monitoring of the analytics accuracy of an ML model received from NWDAF containing AnLF and local policies, subscribes to the NWDAF containing AnLF for receiving notifications of either the accuracy of the ML Model, or Analytics feedback information of the ML model. The NWDAF containing MTLF may get the Subscription endpoint address of the NWDAF containing AnLF from the information received in a previous registration or through a service discovery procedure at the NRF.\nFigure 6.2E.3.3-1 illustrates the procedure either for monitoring the analytics accuracy of an ML model or for delivery of Analytics feedback information of an ML model. Nnwdaf_MLModelMonitor_Subscribe and Nnwdaf_MLModelMonitor_Notify service operations are used for the purposes. A service consumer, i.e. an NWDAF containing MTLF, subscribes at a service producer, i.e. an NWDAF containing AnLF, to be notified when either the analytics accuracy of the previously provisioned ML model is not sufficient, or Analytics feedback information is retrieved from analytics consumer NF.\nThe figure depicts a procedure for monitoring the analytics accuracy of an ML model, illustrating the steps involved in assessing the model's performance. It includes a flowchart that outlines the process, with key steps such as data collection, model training, model evaluation, and model tuning. The figure also includes a legend to clarify the different stages of the process.\nFigure 6.2E.3.3-1: Procedure for monitoring the analytics accuracy of an ML model\n0.\tUpon the reception of an Nnwdaf_MLModelMonitor_Register request and based on local policy, the NWDAF containing MTLF determines to subscribe to the analytics accuracy monitoring for the ML model as defined in clause 5C.1.\n1.\tThe NWDAF containing MTLF sends an Nnwdaf_MLModelMonitor_Subscribe request (Analytics ID(s), unique identifier(s) of the ML model(s) to be monitored, accuracy metrics to be monitored, optionally Reporting Threshold(s) or Reporting Period) to an NWDAF containing AnLF subscription endpoint.\nWhen the NWDAF containing MTLF determines during the registration process described in clause 6.2E.3.2 that a subscription request for ML model accuracy monitoring to an NWDAF containing AnLF is related to a previous subscription for ML model accuracy information to a different NWDAF containing AnLF (due to changes in the provider of the ML accuracy monitoring for a given ML model, as an effect of analytics transfer among NWDAFs containing AnLF), the NWDAF containing MTLF may use as base for the new subscription request at the new NWDAF containing AnLF the parameters associated with the original subscription identification for the ML model accuracy information that was received in the registration request of the new NWDAF containing AnLF, as described in steps 1-2 of clause 6.2E.3.2.\n2.\tThe NWDAF containing AnLF sends a response to the NWDAF containing MTLF.\n3.\tThe analytics consumer NF may send Analytics feedback information to the NWDAF containing AnLF as described in clause 6.1.1.\n4.\tWhen step 1 is triggered, the NWDAF containing AnLF may start monitoring the analytics accuracy of the ML model(s), if it not started yet.\nNOTE 1:\tThe NWDAF containing AnLF can monitor the analytics accuracy in many ways: e.g. comparing predictions of ML model and its corresponding ground truth data, comparing changes in internal configuration for the analytics ID generation, previous existent records of analytics accuracy information etc.\n5.\tThe NWDAF containing AnLF determines whether the analytics accuracy of the ML model is insufficient, i.e. deviation of the output analytics using the trained ML model from ground truth data (which are collected from Data Producer NF corresponding to analytic ID requested at the time which the prediction refers to) is greater than the Reporting Threshold(s) (which are locally configured or received in the Subscribe request), or the Reporting Period indicated in the Subscribe request is reached.\n6.\tEither the Analytics feedback information is retrieved at step 3 or the NWDAF containing AnLF detects the analytics accuracy of ML model is insufficient at step 5, the NWDAF containing AnLF sends an Nnwdaf_MLModelMonitor_Notify request to the notification endpoint (e.g. the NWDAF containing MTLF). The Notify request includes either Analytics feedback information, or the monitored ML model accuracy information of the ML model (e.g. a Deviation value which indicates the deviation of the predictions generated using the ML model(s) from the ground truth data and the network data when the deviation occurs (which can be used by the NWDAF containing MTLF for possible ML model retraining) and the number of inferences that were performed during the time interval between Nnwdaf_MLModelMonitor_Register request and the Notify request or between the time of last Notification message and the time of the current Notification message and optionally an indication that the analytics accuracy of the ML model does not meet the requirement of accuracy for the ML model.\n7.\tThe NWDAF containing MTLF sends a response.\n8.\tThe NWDAF containing MTLF determines whether the ML model is degraded or not based on the notification at step 6. If the notification contains Analytics feedback information, the NWDAF containing MTLF may determine ML model degradation based on the procedures as described in clause 6.2E.2. Otherwise when the NWDAF containing MTLF has received the multiple analytics accuracy information, from one or more NWDAFs containing AnLF, it may consider that the ML model is degraded/to be updated (i.e. enough number analytics accuracy information received from one or more NWDAFs containing AnLF, indicating insufficient analytics accuracy).\nNOTE 2:\tThe actual mechanism for the NWDAF containing MTLF for determining the degradation of the ML model degradation is an internal procedure of the NWDAF containing MTLF, e.g. the NWDAF containing MTLF calculate a global accuracy based on the analytics accuracy information and the number of inferences received from multiple NWDAFs containing AnLF.\n9.\tWhen an ML model is considered degraded / to be updated at step 8, the NWDAF containing MTLF re-trains the existing ML model or selects a new ML model. If the network data was not included in the Nnwdaf_MLModelMonitor_Notify request of step 5, the NWDAF containing MTLF may request data from the NWDAF containing AnLF, ADRF and/or other 5GS entities as specified in clause 6.2 and use the collected data for ML model retraining. The NWDAF containing MTLF notifies the NWDAF(s) containing AnLF with the updated trained ML Model Information by invoking Nnwdaf_MLModelProvision_Notify service operation, as described in clause 6.2A.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2F\tProcedure for ML Model Training",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2F.1\tML Model Training Subscribe/Unsubscribe",
                            "text_content": "The procedure in Figure 6.2F.1-1 is used by an NWDAF service consumer, i.e. an NWDAF containing MTLF to subscribe to another NWDAF, i.e. an NWDAF containing MTLF, for a trained ML model based on the ML model file or ML Model information as described in clause 6.2F.2 provided by the NWDAF service consumer. The service may be used by an NWDAF containing MTLF to enable e.g. Federated Learning or to update ML model. The service is also used by an NWDAF service consumer to request an NWDAF containing MTLF to prepare training ML model or modify existing ML Model training subscription.\nThe figure depicts a step-by-step procedure for training a machine learning model, specifically for subscribing and unsubscribing from a service. The figure includes a flowchart with arrows indicating the sequence of actions, such as selecting the service, subscribing, and unsubscribing. The steps are labeled with corresponding labels, such as \"subscribe\" and \"unsubscribe,\" and the corresponding buttons are labeled with \"subscribe\" and \"unsubscribe.\" The figure also includes a legend that explains the symbols used in the flowchart, such as \"subscribe\" and \"unsubscribe,\" and the corresponding labels. The figure is a visual representation of the process, making it easy to understand and follow.\nFigure 6.2F.1-1: Procedure for ML Model Training subscribe/unsubscribe\n1.\tThe NWDAF service consumer may subscribe or unsubscribe for training an ML model by invoking the Nnwdaf_MLModelTraining_Subscribe/ Nnwdaf_MLModelTraining_Unsubscribe service operation. The parameters that can be provided by the NWDAF service consumer are listed in clause 6.2F.2.\nIn order to enable Federated Learning, NWDAF Service consumer act as FL Server NWDAF can subscribe to multiple NWDAFs containing MTLF act as FL Client NWDAFs, which are selected by the FL Server NWDAF.\nThe FL server NWDAF may use the request to check if an NWDAF can meet the ML model training requirement (e.g. ML Model Interoperability information, Analytics ID, Serving Area and/or availability of data and time). In such case, the FL server NWDAF includes an ML Preparation Flag. When the ML Preparation Flag presents in the request, the service provider NWDAF only checks if it can meet the ML model training requirement (e.g. ML Model Interoperability information, Analytics ID, Serving Area and/or availability of data and time) and / or can successfully download the model if the model information is provided.\nThe FL server NWDAF may use the request to get the Model Accuracy of the global ML Model calculated by the FL Client NWDAFs. In such cases, the service consumer NWDAF includes a Model Accuracy Check Flag. When the Model Accuracy Check Flag is present in the request, the service provider NWDAF uses the local training data as the testing dataset to calculate the Model Accuracy of the ML model provided by the service consumer NWDAF.\nWhen NWDAF service consumer determine to further update the ML model, NWDAF service consumer modifies the subscription by invoking Nnwdaf_MLModelTraining_Subscribe service operation including Subscription Correlation ID with ML Model Information (as defined in clause 6.2A.2).\n2.\tThe NWDAF containing MTLF trains ML model provided at step 1 by collecting new data or re-use the data that it owns. If the ML model file is not provided in step 1, the NWDAF containing MTLF shall first get the ML model using the information indicated at step 1.\n3.\tWhen the NWDAF containing MTLF completes ML model training, the NWDAF containing MTLF notifies the NWDAF service consumer with ML Model Information (as defined in clause 6.2A.2) of updated ML Model) by invoking the Nnwdaf_MLModelTraining_Notify service operation. The parameters that can be provided by the NWDAF containing MTLF as service provider is specified in clause 6.2F.2.\nIf the NWDAF containing MTLF determines to terminate the ML model training, i.e. NWDAF containing MTLF will not provide further notifications related to this request, then the NWDAF containing MTLF may notify the NWDAF Service consumer a Terminate Request indication with cause code (e.g. NWDAF overload, not available for the FL process anymore, etc.) by invoking the Nnwdaf_MLModelTraining_Notify service operation.\nIn order to enable Federated Learning, NWDAF containing MTLF acting as FL Client NWDAF can notify NWDAF Service consumer acting as FL Server NWDAF the local ML model information and status report of FL training including accuracy of local model and Training Input Data Information (e.g. areas covered by the data set, sampling ratio, maximum/minimum of value of each dimension, etc.).\nIf the Model Accuracy Check Flag is present in the Nnwdaf_MLModelTraining_Subscribe, the service provider NWDAF acting as FL Client NWDAF may notify the NWDAF Service consumer acting as FL Server NWDAF the Model Accuracy of the global ML Model.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2F.2\tContents of ML Model Training",
                            "text_content": "The consumers of the ML model training services (i.e. an NWDAF containing MTLF) may provide the input parameters in Nnwdaf_MLModelTraining_Subscribe or Nnwdaf_MLModelTrainingInfo_Request service operations as listed below:\n-\tAnalytics ID: identifies the analytics for which the ML model is requested to be trained.\n-\tML Model Interoperability Information as defined in clause 6.2A.2.\n-\t(Only for Nnwdaf_MLModelTraining_Subscribe) A Notification Target Address (+ Notification Correlation ID) as defined in TS 23.502 [3] clause 4.15.1, allowing to correlate notifications received from the NWDAF containing MTLF with the subscription.\n-\t[OPTIONAL] ML Model Information (as defined in clause 6.2A.2).\n-\t[OPTIONAL] ML Model file.\nNOTE 1:\tIt is up to NWDAF implementation to determine whether to include ML Model file in input parameters considering ML Model file size, etc.\n-\t[OPTIONAL] ML Model ID: identifies the provided ML model.\n-\t[OPTIONAL] ML Preparation Flag: identifies whether the request is for preparing Federated Learning or executing Federated Learning.\n-\t[OPTIONAL] ML Model Accuracy Check Flag: identifies that the request is for using the local training data as the testing dataset to calculate the Model Accuracy of the global ML model provided by the NWDAF service consumer acting as the FL Server NWDAF.\n-\t[OPTIONAL] ML Correlation ID: identifies the Federated Learning procedure for training the ML model. This parameter is included when the service is used for Federated Learning.\n-\t[OPTIONAL] Available data requirement. This is for informing the requirement on available data for the ML model training. e.g. FL Server NWDAF sends the requirement in preparation request to a FL Client NWDAF for selecting the FL Client NWDAF which can meet the available data requirement. The following available data requirements can be included:\n-\tEvent ID list to be collected for local model training.\n-\tDataset statistical properties as defined in clause 6.1.3.\n-\tTime window of the data samples.\n-\tMinimum number of data samples.\n-\t[OPTIONAL] Availability time requirement. This is for informing the requirement on availability time for the ML model training, e.g. FL Server NWDAF sends the requirement in preparation request to FL Client NWDAF for selecting the FL Client NWDAF which is available in the required time for training ML model.\n-\t[OPTIONAL] Training Filter Information: enables to select which data for the ML model training is requested, e.g. S-NSSAI, Area of Interest. Parameter types in the Training Filter Information are the same as or subset of parameter types in the ML Model Filter Information which are defined in procedure 6.2A.1.\n-\t[OPTIONAL] Target of Training Reporting: indicates the object(s) for which data for ML model training is requested, i.e. a group of UEs or any UE (i.e. all UEs).\n-\t[OPTIONAL] Use case context: indicates the context of use of ML model.\n-\t[OPTIONAL] Training Reporting Information with the following parameters:\n-\tMaximum response time: indicates maximum time for waiting notifications (i.e. model training results).\n-\t[OPTIONAL] Iteration round ID: indicates the iteration round number of current ML model training.\n-\t[OPTIONAL] Expiry time.\nThe NWDAF containing MTLF provides to the consumer of the ML model training service operations as described in clause 7.10, the output information in notification as listed below:\n-\tThe Notification Correlation Information.\n-\t[OPTIONAL] ML Model Information (as defined in clause 6.2A.2).\n-\t[OPTIONAL] ML Model ID: identifies the provisioned ML model.\n-\t[OPTIONAL] Model Accuracy: The model accuracy of the global ML model, which is calculate by the FL Client NWDAF using the local training data as the testing dataset.\n[OPTIONAL] Status report of FL training: Accuracy of local model and Training Input Data Information (e.g. areas covered by the data set, sampling ratio, maximum/minimum of value of each dimension , etc.), which are generated by the FL Client NWDAF during FL procedure.\nNOTE 2:\tThe parameters in Training Input Data Information are up to the implementation.\n-\t[OPTIONAL] ML Correlation ID. This parameter may be included when the service is used for Federated Learning.\n-\t[OPTIONAL] Iteration round ID: indicates the iteration round number of ML model training indicated by the FL Server NWDAF.\n-\t[OPTIONAL] Delay Event Notification with the following parameters:\n-\tdelay event indication: this parameter indicates that FL Client NWDAF is not able to complete the training of the interim local ML model within the maximum response time provided by the FL Server NWDAF.\n-\t[OPTIONAL] cause code (e.g. local ML model training failure, more time necessary for local ML model training, etc.).\n-\t[OPTIONAL] Expected time to complete the training: Indicates to the FL Server NWDAF that expected remaining training time and may be provided with Delay Event Notification.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2F.3\tML Model Training Information Request",
                            "text_content": "The procedure in Figure 6.2F.3-1 is used by an NWDAF service consumer, i.e., an NWDAF containing MTLF to request another NWDAF, i.e., an NWDAF containing MTLF, for the information about ML model training based on the ML model file or ML Model information as described in clause 6.2F.2 provided by the NWDAF service consumer. The service may be used by an NWDAF containing MTLF to enable e.g. Federated Learning.\nThe figure depicts a procedure for ML model training information request, with a step-by-step guide for collecting and organizing the necessary data, as well as the steps for data preprocessing, model training, and model evaluation.\nFigure 6.2F.3-1: Procedure for ML Model Training Information Request\n1.\tThe NWDAF service consumer may request the NWDAF containing MTLF to get the information about the ML model training based on the ML model file or ML Model information as described in clause 6.2F.2 provided by the service consumer by invoking the Nnwdaf_MLModelTrainingInfo_Request service operation. The parameters that can be provided by the NWDAF service consumer are listed in clause 6.2F.2.\nIn order to enable Federated Learning, NWDAF Service consumer acting as FL Server NWDAF requests to get ML Model Training Information from an NWDAF containing MTLF acting as FL Client NWDAF, which is selected by the FL Server NWDAF. The details are specified in clause 6.2C.\nThe NWDAF service consumer may use the request to check if an NWDAF can meet the ML model training requirements (e.g. ML Model Interoperability information, Analytics ID, Service Area/DNAI and/or availability of data and time). In such cases, the NWDAF service consumer includes an ML Preparation Flag.\nThe NWDAF service consumer may use the request to get the Model Accuracy of the ML Model provided by the service consumer using local training data in the NWDAF containing MTLF as the testing dataset. In such cases, the service consumer NWDAF includes a Model Accuracy Check Flag.\n2.\tWhen the ML Preparation Flag is present in the request, the NWDAF containing MTLF only checks whether it can meet the ML model training requirement and/or can successfully download the model if the model information is provided. Based on the check result, the NWDAF containing MTLF gets a successful return code or failure cause code (e.g. NWDAF does not meet the ML training requirements) as the information about the ML model training.\nWhen the Model Accuracy Check Flag is present in the request, the NWDAF containing MTLF uses the local training data as the testing dataset to calculate the Model Accuracy of the ML model provided by the service consumer. The NWDAF containing MTLF includes the Model Accuracy into the information about the ML model training.\nWhen the NWDAF containing MTLF is ongoing ML model training based on the ML model file or ML Model information as described in clause 6.2F.2 provided by the NWDAF service consumer, the NWDAF containing MTLF gets a failure cause code (e.g. ML training is not complete) as the information about the ML model training.\nWhen the NWDAF containing MTLF completes ML model training based on the ML model file or ML Model information as described in clause 6.2F.2 provided by the NWDAF service consumer, the NWDAF containing MTLF gets a successful return code and the ML Model Information of the trained ML model as the information about the ML model training.\n3.\tThe NWDAF containing MTLF replies to the NWDAF service consumer with the information about the ML model training by invoking the Nnwdaf_MLModelTrainingInfo_Request response service operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tSlice load level related network data analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tGeneral",
                            "text_content": "The NWDAF provides slice load level information to a consumer NF on a Network Slice level or a Network Slice instance level or both. The NWDAF is not required to be aware of the current subscribers using the slice. The NWDAF notifies slice specific network status analytics information to the consumer NF that is subscribed to it. A consumer NF may collect directly slice specific network status analytics information from NWDAF. This information is not subscriber specific.\nThe NWDAF services as defined in the clause 7.2 and clause 7.3 are used to expose slice load level analytics from the NWDAF to the consumer NF (e.g. PCF, NSSF or AMF).\nThe consumer of these analytics shall indicate in the request or subscription:\n-\tAnalytics ID = \"Load level information\";\n-\tAnalytics Filter Information:\n-\tS-NSSAI and NSI ID;\nNOTE 1:\tThe use of NSI ID in the network is optional and depends on the deployment choices of the operator. If used, the NSI ID is associated with S-NSSAI. NSI ID is only applicable when the consumer of analytics is NSSF or AMF.\n-\toptionally, the list of analytics subsets that are requested among those specified in clause 6.3.3A;\n-\toptionally, for analytics exposure in roaming case (see clause 6.1.5), the PLMN ID identifying the target PLMN (i.e. PLMN of which the roaming analytics is requested); and\n-\toptionally, for analytics exposure in roaming case (see clause 6.1.5), mapped S-NSSAI of the HPLMN if the consumer NF is in the VPLMN.\nNOTE 2:\tThe terms \"HPLMN\" and \"VPLMN\" here refer to a roaming case in which at least one UE served by the NWDAF analytics consumer is involved.\n-\tan optional Area of Interest;\n-\tan optional list of NF types;\n-\toptionally, Load Level Threshold value;\n-\toptionally, \"maximum number of objects\" indicating the maximum number of Network Slice instances expected in output, when the Analytics Filter Information does not indicate an NSI ID; and\n-\tan Analytics target period indicating the time period over which the statistics or predictions are requested.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tVoid",
                            "text_content": "\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2A\tInput data",
                            "text_content": "The detailed information collected by the NWDAF is listed in Table 6.3.2A-1 and Table 6.3.2A-2.\nTable 6.3.2A-1: OAM Input data for slice load analytics\n\nTable 6.3.2A-2: 5GC NF Input data for slice load analytics\n\nNWDAF collects input data on the number of UEs registered in a S-NSSAI or S-NSSAI and NSI ID combination using one of the following options:\n-\tTotal number of UE registered to a S-NSSAI or to a S-NSSAI and NSI ID from each AMF(s) and/or from NSCAF serving the slice:\n-\tNamf_EventExposure_Subscribe (Target for Event Reporting = \"any UE\", Event ID = \"Number of UEs served by the AMF and located in \"Area of Interest\"\", Event Filter information = S-NSSAI(s) or one or more of the tuple (S-NSSAI, NSI ID), Event reporting mode = periodic along with periodicity) as defined in clause 5.2.2.3.1 of TS 23.502 [3]; or\n-\tNnsacf_SliceEventExposure_Subscribe (EventID = \"Number of UE registered\", EventFilter = \"S-NSSAI\", Event reporting mode = periodic along with periodicity) as defined in clause 5.2.21.4.2 of TS 23.502 [3].\n-\tIndividual UE registration/deregistration to a S-NSSAI or to a S-NSSAI and NSI ID reported by AMF(s):\n-\tNamf_EventExposure_Subscribe (Target for Event Reporting = \"any UE\", Event ID = \"UE moving in or out of a subscribed \"Area of Interest\", Event Filter information = S-NSSAI(s) or one or more of the tuples (S-NSSAI, NSI ID), Event reporting mode = reporting to a maximum number or a maximum duration) as defined in clause 5.2.2.3.1 of TS 23.502 [3].\nNWDAF collects input data on the number of PDU Sessions established in a S-NSSAI using one of the following options:\n-\tTotal number of PDU Sessions established in a S-NSSAI from each NSACF serving the slice:\n-\tNnsacf_SliceEventExposure_Subscribe (EventID = \"Number of PDU sessions established\", EventFilter = \"S-NSSAI(s)\", Event reporting mode = periodic along with periodicity) as defined in clause 5.2.21.4.2 of TS 23.502 [3].\n-\tIndividual PDU Session Established or PDU Session Released in a S-NSSAI from SMF:\n-\tNsmf_EventExposure_Subscribe (Target for Event Reporting = \"any UE\", Event ID = \"PDU Session Establishment and/or PDU Session Release\", Event Filter information = S-NSSAI(s), Event reporting mode = reporting to a maximum number or a maximum duration) as defined in clause 5.2.8.3.1 of TS 23.502 [3].\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.3.2A-1: OAM Input data for slice load analytics",
                                    "table number": 11,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2A-2: 5GC NF Input data for slice load analytics",
                                    "table number": 12,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.3.3\tVoid",
                            "text_content": "\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.3A\tOutput analytics",
                            "text_content": "The NWDAF services as defined in the clause 7.2 and 7.3 are used to expose the following analytics:\n-\tNetwork Slice instance load statistics information as defined in Table 6.3.3A-1.\n-\tNetwork Slice load statistics information as defined in Table 6.3.3A-2.\n-\tNetwork Slice instance load predictions information as defined in Table 6.3.3A-3.\n-\tNetwork Slice load predictions information as defined in Table 6.3.3A-4.\nTable 6.3.3A-1: Network Slice instance load statistics\n\nTable 6.3.3A-2: Network Slice load statistics\n\nTable 6.3.3A-3: Network Slice instance load predictions\n\nTable 6.3.3A-4: Network Slice load predictions\n\nNOTE:\tIf no NSI ID is provided as Analytics Filter, slice load level related output analytics are provided according to Tables 6.3.3A-2 and 6.3.3A-4. Otherwise slice instance load level related output analytics are provided according to Tables 6.3.3A-1 and 6.3.3A-3.\nThe predictions are provided with a Validity Period, as defined in clause 6.1.3.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.3.3A-1: Network Slice instance load statistics",
                                    "table number": 13,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3A-2: Network Slice load statistics",
                                    "table number": 14,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3A-3: Network Slice instance load predictions",
                                    "table number": 15,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3A-4: Network Slice load predictions",
                                    "table number": 16,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.3.4\tProcedures",
                            "text_content": "The figure depicts a network slice load analytics provided by NWDAF, illustrating the load distribution across different network slices. The network slice load is represented by the horizontal axis, which shows the number of network slices, and the vertical axis, which represents the load. The load is depicted by the different colors and shapes, with different colors representing different network slices and shapes representing different load levels. The figure provides a visual representation of the network slice load distribution, allowing network operators to understand the performance of their network slices and make informed decisions about network optimization.\nFigure 6.3.4-1: Network Slice load analytics provided by NWDAF\nFigure 6.3.4-1 shows the procedure for NWDAF to derive slice load analytics. The steps are described as follows:\n1.\tA consumer NF subscribes to/requests a NWDAF using Nnwdaf_AnalyticsSubscription_Subscribe or Nnwdaf_AnalyticsInfo_Request service operation (Analytics ID = Load level information and a set of Analytics Filters (e.g. S-NSSAI, NSI ID, Area of Interest)).\n2.\t[OPTIONAL] If the NWDAF does not have already the slice information, it gains the slice information from OAM (as described in clause 6.2.3) and discovers from NRF the AMF, SMF and NSSF instance(s) relevant to the Analytics Filters provided in the analytics subscription.\n3.\t[OPTIONAL] If the NSI ID(s) are not provided in the analytics subscription by the consumer NF, the NWDAF invokes Nnssf_NSSelection_Get service operation from NSSF to obtain the NSI ID(s) corresponding to the S-NSSAI in the subscription.\nNOTE:\tStep 4a to step 7 are conditional depending on the NWDAF internal logic that determines the source(s) of data collection.\n4a.\t[CONDITIONAL] The NWDAF may subscribe to input data in Table 6.3.2A-1 from the OAM according to the data collection principles from the OAM described in clause 6.2.3.\n4b.\t[CONDITIONAL] The NWDAF may collect input data from the NRF (see clause 6.5) to derive slice instance resource usage statistics and predictions for a Network Slice instance.\n5.\t[CONDITIONAL] The NWDAF may subscribe to the AMF(s) event exposure service to collect data on the number of UEs currently registered on certain Network Slice and, if available, its constituent Network Slice instance(s) as defined in clause 6.3.2A. If required, the NWDAF may also collect the corresponding UE IDs.\n6.\t[CONDITIONAL] The NWDAF may subscribe to the SMF(s) event exposure service to collect data on the number of PDU sessions established and/or released at the SMF on currently registered on certain Network Slice as defined in clause 6.3.2A. NWDAF can then use such collected data to determine the number of PDU sessions established on i) a Network Slice; and ii) if available, on a Network Slice instance by leveraging the data collected in step 5.\n7.\t[CONDITIONAL] The NWDAF may subscribe to one or multiple NSACFs to collect data on either the number of UE registered in a S-NSSAI or the number of PDU sessions established in a S-NSSAI as defined in clause 6.3.2A. When multiple NSACFs are selected by the NWDAF for the S-NSSAI, the NWDAF aggregates the reports from the NSACFs to derive the number of UEs registered in the S-NSSAI or the number of PDU sessions established in the S-NSSAI.\n8.\tThe NWDAF derives slice load analytics.\n9.\tThe NWDAF delivers analytics to the consumer NF by invoking Nnwdaf_AnalyticsSubscription_Notify or Nnwdaf_AnalyticsInfo_Request response service operations.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tObserved Service Experience related network data analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4.1\tGeneral",
                            "text_content": "This clause specifies how NWDAF can provide Observed Service Experience (i.e. average of observed Service MoS and/or variance of observed Service MoS indicating service MOS distribution for services such as audio-visual streaming as well as services that are not audio-visual streaming such as V2X and Web Browsing services) analytics, in the form of statistics or predictions, to a service consumer.\nThe Observed Service Experience analytics may provide one or more of the following outputs:\n-\tService Experience for a Network Slice: Service Experience for a UE or a group of UEs or any UE in a Network Slice;\n-\tService Experience for an Application: Service Experience for a UE or a group of UEs or any UE in an Application or a set of Applications;\n-\tService Experience for an Edge Application over a UP path: Service experience for a UE or a group UEs or any UE in an Application or a set of Applications over a specific UP path (UPF, DNAI and EC server);\n-\tService Experience for an Application over a RAT Type or Frequency or both: Service experience for a UE or a group of UEs in an Application or a set of Applications over a RAT Type or over a Frequency or both as defined in Table 6.4.1-1.\n-\tService Experience for an Application transferring data over a PDU Session: Service experience for a UE or a group of UEs or any UEs in an Application or a set of Applications transferring data over a PDU Session with PDU Session parameters i.e. S-NSSAI, DNN, PDU Session Type , SSC mode and optionally an Access Type or with combination of PDU Session parameters such as a list of the tuple (PDU Session Type, SSC mode) optionally per Access Type.\nTherefore, Observed Service experience may be provided as defined in clause 6.4.3. For example, individually per UE or group of UEs, or globally, averaged per Application or averaged across a set of Applications on a Network Slice.\nThe service consumer may be an NF (e.g. PCF, NSSF, AMF, NEF), AF, or the OAM.\nThe consumer of these analytics shall indicate in the request or subscription:\n-\tAnalytics ID = \"Service Experience\";\n-\tTarget of Analytics Reporting: one or more SUPI(s) or Internal Group Identifier(s), or \"any UE\";\n-\tAnalytics Filter Information as defined in Table 6.4.1-1 and optionally a list of analytics subsets that are requested (see clause 6.4.3);\n-\toptionally, maximum number of objects and maximum number of SUPIs;\n-\toptionally, preferred level of accuracy of the analytics;\n-\toptionally, preferred level of accuracy per analytics subset;\n-\toptionally, preferred order of results for the list of Application Service Experiences and/or Slice instance service experiences: \"ascending\" or \"descending\";\n-\toptionally, preferred granularity of location information: TA level or cell level or \"longitude and latitude level\";\n-\tAnalytics target period that indicates the time window for which the statistics or predictions are requested;\n-\tin a subscription, the Notification Correlation Id and the Notification Target Address; and\n-\toptionally, Reporting Thresholds, which apply only for subscriptions and indicate conditions on the Service Experience to be reached in order to be notified by the NWDAF (see Table 6.4.3-1 and Table 6.4.3-2).\nNOTE:\tDefinition of \"longitude and latitude level\" is described in clause 6.1.3.\nTable 6.4.1-1: Analytics Filter Information related to the observed service experience\n\nNOTE 1:\tA service consumer can use the Area of Interest in order to reduce the amount of signalling that the analytics subscription or request generates.\nThe NWDAF shall notify the result of the analytics to the consumer as specified in clause 6.4.3.\nNWDAF collects the network data from AF (directly or via NEF) and from other 5GC NF(s) in order to calculate and provide statistics and predictions on the observed service experience to a consumer NF or to OAM. When the AF provides Service Experience Information and the Target of Analytics Reporting is one or more UE ID(s), the AF may also provide a Service Experience Contribution Weight with each UE's Service Experience value. The Service Experience Contribution Weight is determined by the AF and indicates the relative importance of each UE's Service Experience. The NWDAF may use the Service Experience Contribution Weight(s) to calculate and provide statistics, confidence values and predictions on the observed service experience to a consumer NF or to OAM.\nNOTE 2:\tThe relative importance of that is conveyed in the Service Experience Contribution Weights is used to indicate the relative importance of the Service Experience value (i.e. MOS). For example, it might be that one the Service Experience of one UE is not very important because the UE is an infrequent user of the service, or the UE does not use all features that are associated with the service. Whereas another UE might be considered important because the UE is a frequent user of the service or a user who uses many features that are associated with the service.\nBased on the Analytics Filter information in Table 6.4.1-1 and the Target of Analytics Reporting provided by the service consumer in the analytics subscription or request, NWDAF determines whether service experience analytics should be delivered for:\ni)\tApplication(s);\nii)\tNetwork Slice;\niii)\tboth Application(s) and Network Slice;\niv)\tEdge Applications over a UP path;\nv)\tApplication(s) over RAT Type(s) and/or Frequency value(s);\nvi)\tApplication(s) running over a PDU Session using the following PDU Session parameters or combination of them, i.e. S-NSSAI, DNN, PDU Session type, SSC Mode and optionally per Access Type.\nIf NWDAF is unable to differentiate based on the analytics subscription or request, it provides service experience analytics for both Application(s) and Network Slice.\nIf service experience for both Application(s) and Network Slice is desired but the Target of Analytics Reporting or Analytics Filter information values (e.g. Area of Interest) need to be different, separate subscriptions/requests may be provided by the service consumer.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.4.1-1: Analytics Filter Information related to the observed service experience",
                                    "table number": 17,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.4.2\tInput Data",
                            "text_content": "The service data and performance data collected from the AF (including the service data collected from the UE through the AF), the network data from other 5GC NFs and the network data from OAM and MDAS/MDAF for observed service experience are defined in Table 6.4.2-1, 6.4.2-1a, Table 6.4.2-2, Table 6.4.2-3, Table 6.4.2-4 and Table 6.4.2-5 respectively.\nTable 6.4.2-1: Service Data from AF related to the observed service experience\n\nNWDAF subscribes to the service data from AF in the Table 6.4.2-1 either directly for trusted AFs by invoking Naf_EventExposure_Subscribe service (Event ID = Service Experience information, Event Filter information = Area of Interest, Application ID) as defined in TS 23.502 [3], or indirectly for untrusted AFs via NEF by invoking Nnef_EventExposure_Subscribe service (Event ID = Service Experience information, Event Filter information = Area of Interest, Application ID) where NEF translates the Area of Interest into geographic zone identifier(s). For the information whose source is UE (via AF), the AF collects data from the UE as defined in clause 6.2.8.\nNOTE:\tWhen the Service Experience is expressed as a customized MOS, the customized MOS might be defined by the content provider or by the MNO and might be based on the nature of the targeted service type (e.g. web browsing, gaming, augmented reality, V2X, SMS).\nTable 6.4.2-1a: Performance Data from AF\n\nNWDAF subscribes to the performance data from AF in the Table 6.4.2-1a either directly for trusted AFs by invoking Naf_EventExposure_Subscribe service (Event ID = Performance Data, Event Filter information = Area of Interest, Application ID) as defined in TS 23.502 [3], or indirectly for untrusted AFs via NEF by invoking Nnef_EventExposure_Subscribe service (Event ID = Performance Data, Event Filter information = Area of Interest, Application ID) where NEF translates the Area of Interest into geographic zone identifier(s).\nTable 6.4.2-2: QoS flow level Network Data from 5GC NF related to the QoS profile assigned for a particular service (identified by an Application Id or IP filter information)\n\nNOTE:\tCare needs to be taken with regards to load and major signalling caused when requesting Any UE. This could be achieved via utilization of some event filters (e.g. Area of Interest for AMF), Analytics Reporting Information (e.g. SUPImax), or sampling ratio as part of Event Reporting Information.\nNWDAF subscribes to the network data from 5GC NF(s) in the Table 6.4.2-2 by invoking Nnf_EventExposure_Subscribe service operation with the following Event IDs as input parameters:\n-\tAMF Source: Namf_EventExposure_Subscribe (Event IDs = Location Changes, Area of Interest).\n-\tSMF Source: Nsmf_EventExposure_Subscribe (Event ID = QFI allocation).\nTable 6.4.2-3: UE level Network Data from OAM related to the QoS profile\n\nNWDAF subscribes the network data from OAM in the Table 6.4.2-3 by using the services provided by OAM as described in clause 6.2.3.\nTable 6.4.2-4: UE level Network Data from 5G NF related to the Service Experience\n\nThe Event Filters for the service data collection from SMF, AMF and AF are defined in TS 23.502 [3].\nThe timestamps are provided by each NF to allow correlation of QoS and traffic KPIs. The clock reference is able to know the accuracy of the time and correlate the time series of the data retrieved from each NF.\nThe NWDAF collects the following MDAF analysis result listed in Table 6.4.2-5, as defined in clauses 8.4.2.1.3 and 8.4.4.3 of TS 28.104 [45].\nTable 6.4.2-5: Data collection from MDAS/MDAF of service experience and energy saving state analysis\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.4.2-1: Service Data from AF related to the observed service experience",
                                    "table number": 18,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.4.2-1a: Performance Data from AF",
                                    "table number": 19,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.4.2-2: QoS flow level Network Data from 5GC NF related to the QoS profile assigned for a particular service (identified by an Application Id or IP filter information)",
                                    "table number": 20,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.4.2-3: UE level Network Data from OAM related to the QoS profile",
                                    "table number": 21,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.4.2-4: UE level Network Data from 5G NF related to the Service Experience",
                                    "table number": 22,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.4.2-5: Data collection from MDAS/MDAF of service experience and energy saving state analysis",
                                    "table number": 23,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.4.3\tOutput Analytics",
                            "text_content": "The NWDAF services as defined in the clause 7.2 and 7.3 are used to expose the analytics.\n-\tService Experience statistics information is defined in Table 6.4.3-1.\n-\tService Experience predictions information is defined in Table 6.4.3-2.\nTable 6.4.3-1: Service Experience statistics\n\nTable 6.4.3-2: Service Experience predictions\n\nThe number of Service Experiences and SUPIs are limited respectively by the maximum number of objects and the Maximum number of SUPIs provided as part of Analytics Reporting Information by the NWDAF Service Consumer.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.4.3-1: Service Experience statistics",
                                    "table number": 24,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.4.3-2: Service Experience predictions",
                                    "table number": 25,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.4.4\tProcedures to request Service Experience for an Application",
                            "text_content": "The figure depicts a step-by-step procedure for NWDAF (Network Wide Data Access for Applications) providing Service Experience for an application. It outlines the steps involved in configuring the NWDAF, including setting up the network, configuring the NWDAF, and configuring the application. The figure also includes a flowchart to illustrate the process, making it easier to understand the steps and their order.\nFigure 6.4.4-1: Procedure for NWDAF providing Service Experience for an Application\nThis procedure allows the consumer to request Analytics ID \"Service Experience\" for a particular Application. The consumer includes both the Application ID for which the Service Experience is requested and indicates that the Target of Analytics Reporting is \"any UE\". If the Target for Analytics Reporting is either a SUPI or an Internal-Group-Id the procedure in clause 6.4.6 applies. At the same time, for an Application ID, a set of initial QoS parameter combinations per service experience window (e.g. one is for 3<Service MOS<4 and another is for 4<Service MOS<5) is defined in PCF (e.g. by configuration of operator policies) that may be updated based on the Service Experience reported by NWDAF.\n1.\tConsumer NF sends an Analytics request/subscribe (Analytics ID = Service Experience, Target of Analytics Reporting = any UE, Analytics Filter Information that may include one or more of the following as defined in Table 6.4.1-1 (Application ID, S-NSSAI, DNN, Application Server Address(es), Area of Interest, RAT type(s), Frequency value(s)), Analytics Reporting Information=Analytics target period) to NWDAF by invoking a Nnwdaf_AnalyticsInfo_Request or a Nnwdaf_AnalyticsSubscription_Subscribe.\n2a. NWDAF subscribes the service data from AF in the Table 6.4.2-1 by invoking Nnef_EventExposure_Subscribe or Naf_EventExposure_Subscribe service (Event ID = Service Experience information, Application ID, Event Filter information), Target of Event Reporting = Any UE) as defined in TS 23.502 [3].\nNOTE 1:\tIn the case of trusted AF, NWDAF provides the Area of Interest as a list of TAIs to AF. In the case of untrusted AF, NEF translates the requested Area of Interest provided as event filter by NWDAF into geographic zone identifier(s) that act as event filter for AF.\n2b.\tNWDAF subscribes the network data from 5GC NF(s) in the Table 6.4.2-2 by invoking Nnf_EventExposure_Subscribe service operation.\n2c. With these data, the NWDAF estimates the Service experience for the application.\nNOTE 2:\tQoE measurements from the applications are based on outcome of the ongoing SA5 Rel-16 WID \"Management of QoE measurement collection\" which addresses how to collect the QoE measurements from the applications in the UE.\n3.\tThe NWDAF provides the data analytics, i.e. the observed Service Experience (which can be a range of values) to the consumer NF by means of either Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1, indicating how well the used QoS Parameters satisfy the Service MoS agreed between the MNO and the end user or between the MNO and the external ASP.\nNOTE 3:\tThe call flow only shows a request-response model for the interaction of NWDAF and consumer NF for simplicity instead of both request-response model and subscription-notification model.\nNOTE 4:\tThe non-real time data information from AF includes the service experience data (see Table 6.4.2-1), which indicates the service quality during the service lifetime.\nIf the consumer NF is a PCF and it determines that the application SLA is not satisfied, it may take into account the Observed Service Experience and the operator policies including SLA and required Service Experience (which can be a range of values) to determine new QoS parameters to be applied for the service, as defined in clause 6.1.1.3 and clause 6.2.1.2 of TS 23.503 [4].\nIf the consumer NF is an AF (e.g. MEC or other Application Server), it may use the Observed Service Experience related network data analytics to determine whether the user experience can be satisfied. If not, the AF may determine to adjust service parameters, e.g. for a video service this may be bit rate, frame rate, codec format, compression parameter, screen size, etc. to better match the network conditions and achieve better user experience.\nIf the consumer NF is SMF, PCF or AF/Application Server, it may take into account the Observed Service Experience analytics per UP path (i.e. UPF and/or DNAI and/or AS instance address as defined in Table 6.4.3-1) to perform the following procedures:\n-\tThe consumer SMF determines to (re)selects UP paths, including UPF and DNAI, as described in clause 4.3.5 of TS 23.502 [3]. In addition, the SMF may (re)configure traffic steering, updating the UPF regarding the target DNAI with new traffic steering rules.\n-\tThe consumer AF/Application Server determines to adjust service parameters, e.g. service parameters of video for adjustment may be bit rate, frame rate, codec format, compression parameter, screen size, etc. or service parameters for the AI/ML operations described in clause 6.40 of TS 22.261 [33]. In addition, the AF/ Application Server may provide an updated list of DNAI(s) for SMF to perform relocation when appropriate.\n-\tThe consumer PCF may provide an updated list of DNAI(s) for SMF to perform relocation upon AF request.\nIf the consumer NF is a NEF, it may take into account the Observed Service Experience analytics to support Member UE selection as detailed in clause 4.15.13 of TS 23.502 [3].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.5\tProcedures to request Service Experience for a Network Slice",
                            "text_content": "The figure depicts a step-by-step procedure for NWDAF (Network Wide Data Access Facilitation) in a network slice, illustrating the process of providing service experience for a UE or a group of UEs. The figure includes various components such as the network slice, network slice controller, and network slice manager, which are essential for managing and coordinating network slices. NWDAF is a key component in ensuring a seamless and efficient network experience for users.\nFigure 6.4.5-1: Procedure for NWDAF providing Service Experience for a UE or a group of UEs in a Network Slice\nThis procedure is similar to the procedure in clause 6.4.4, with the following differences. The consumer needs to request the Analytics ID \"Service Experience\" for all UEs or a group of UEs or a UE on a Network Slice, identified by an S-NSSAI. If multiple Network Slice instances of the same Network Slice are deployed, associated NSI ID(s) may be used in addition to S-NSSAI. If 'any UE' is the Target of Analytics Reporting, NWDAF may subscribe to UE mobility event notifications of AMF as described in clause 5.3.4.4 of TS 23.501 [2] using event ID \"UE moving in or out of Area of Interest\" and Event Filters as described in Table 5.2.2.3.1-1 of TS 23.502 [3] if it is needed to retrieve the list of SUPIs (and GPSIs if available) in the area of interest. The event exposure service request may also include the immediate reporting flag as Event Reporting Information as described in Table 4.15.1-1 of TS 23.502 [3].\nIn addition, service experience data may need to be collected from multiple Applications. If each Application is hosted in different AFs, NWDAF subscribes the service data in the Table 6.4.2-1 from the different AFs by invoking Nnef_EventExposure_Subscribe or Naf_EventExposure_Subscribe services for each Application (Event ID = Service Experience information, Event Filter information, Application ID) as defined in TS 23.502 [3]. Figure 6.4.5-1 shows an example procedure with two AFs. If one AF provides the service experience data of multiple Applications, the set of Application IDs is provided by NWDAF to the AF with the Naf_EventExposure_Subscribe service operation, as defined TS 23.502 [3].\nThe Observed Service Experience for a Network Slice when consumed by OAM could be used as described in Annex H of TS 28.550 [7].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.6\tProcedures to request Service Experience for a UE",
                            "text_content": "Figure 6.4.6-1 depicts procedure for NWDAF providing Service Experience for an application for a UE or a group of UEs.\nThe figure depicts a step-by-step procedure for NWDAF (Network Wide Data Access for Enhanced Services) providing Service Experience for an application or a group of UEs. It outlines the steps to ensure a seamless and high-quality service experience for users.\nFigure 6.4.6-1: Procedure for NWDAF providing Service Experience for an application for a UE or a group of UEs\nThe procedure in clause 6.4.4 applies with the following additions. The consumer needs to request the Analytics ID \"Service Experience\" for a UE identified by a SUPI or a group of UEs identified by an Internal Group-Id. The consumer includes both the Application ID for which their Service Experience is requested and the Target of Analytics Reporting for a SUPI or an Internal-Group-Id. Analytic Filter Information can be set according to clause 6.4.1. The NWDAF may collect UE location information from the GLMC if the consumer requested fine granularity location information according to clause 6.4.2.1. When NEF is the NF service consumer, the NEF translates a GPSI into a SUPI or an External-Group-Id into an Internal-Group-Id then includes it in the Target of Analytics Reporting.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tNF load analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tGeneral",
                            "text_content": "The clause 6.5 describes how NWDAF can provide NF load analytics, in the form of statistics or predictions or both, to another NF.\nThe service consumer may be an NF, or the OAM.\nThe consumer of these analytics shall indicate in the request:\n-\tAnalytics ID = \"NF load information\";\n-\tTarget of Analytics Reporting: an optional SUPI or any UE;\n-\tAnalytics Filter Information:\n-\toptional S-NSSAI;\n-\tan optional list of NF Instance IDs, NF Set IDs, or NF types;\n-\toptional area of interest;\n-\tan optional list of analytics subsets that are requested (see clause 6.5.3);\n-\tOptional preferred level of accuracy of the analytics;\n-\tOptional preferred level of accuracy per analytics subset (see clause 6.5.3);\n-\tOptional preferred order of results for the list of resource status: ascending or descending NF load;\n-\tOptional Reporting Threshold; the Reporting Threshold is unique for all NFs matching the above Analytics Filter and the reporting applies when the conditions are met for at least one of these NFs;\n-\tAn Analytics target period indicates the time period over which the statistics or predictions are requested;\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\nThe NWDAF shall notify the result of the analytics to the consumer as indicated in clause 6.5.3.\nIf a list of the NF Instance IDs (or respectively of NF Set IDs) is provided, the NWDAF shall provide the analytics for each designated NF instance (or respectively for each NF instance belonging to each designated NF Set). In such case the Target of Analytics Reporting should be ignored.\nOtherwise, if a SUPI is provided, the NWDAF shall use the SUPI to determine which NF instances (AMF and SMF) are serving this specific UE, filter them according to the provided S-NSSAI and NF types using data collected from NRF or OAM and provide analytics for these NF instances.\nNOTE:\tOnly NF instances of type AMF and SMF can be determined using a SUPI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tInput data",
                            "text_content": "For the purpose of NF load analytics, the NWDAF may collect the information as listed in Table 6.5.2-1 for the relevant NF instance(s).\nTable 6.5.2-1: Data collected by NWDAF for NF load analytics\n\nNOTE 1:\tThe OAM information can be used as a complement to NRF information for some or all of the following aspects: resources utilization, NRF information correlation and alternative source of information if NRF information on load is not available.\nNOTE 2:\tNWDAF can request NRF for data related to NF instances, as described in TS 29.510 [18].\nNOTE 3:\tNWDAF can correlate the NF resources configuration with NF resource usage for generating the analytics output.\nIf target NF type is UPF, the NWDAF may collect the information as listed in Table 6.5.2-2, in addition to information listed in Table 6.5.2-1.\nTable 6.5.2-2: Data collected by NWDAF for UPF load analytics\n\nFor the purpose of NF load analytics, the NWDAF may collect the information as listed in Table 6.5.2-3 (from OAM via MDT) and Table 6.5.2-5 via the AF (for trusted AF) or NEF (for untrusted AF) in addition to other information described above.\nTable 6.5.2-3: MDT input data for UE\n\nTable 6.5.2-4: Per UE attribute to be collected and processed by the AF\n\nTable 6.5.2-5: AF input data to the NWDAF for Collective Behaviour of UEs\n\nBased on network configuration, NWDAF may discover the AF from the NRF as defined in 6.2.8.2.2 (based on Collective Behaviour as Event ID or a corresponding Application ID).\nFor AF in trusted domain, the NWDAF invokes step 3a in clause 6.2.8.2.3 by using Naf_EventExposure_Subscribe service (Event ID = Collective Behaviour, Event Filter information, Target of Event Reporting). The collective attribute (see Table 6.5.2-5) can be indicated as part of event filter information as defined in TS 23.502 [3]. Otherwise, the AF notifies for all collective attributes within the area of interest.\nFor AF in untrusted domain, the NWDAF invokes step 3b in clause 6.2.8.2.3 by using Nnef_EventExposure_Subscribe (Event ID = Collective Behaviour, Event Filter information, Target of Event Reporting). The collective attribute (see Table 6.5.2-5) can be indicated as part of event filter information as defined in TS 23.502 [3]. Otherwise, the AF via NEF notifies for all collective attributes within the area of interest.\nFor Collective Behaviour of multiple UEs, NWDAF based on the configuration by MNO may request certain type of data processing from the AF as part of event filter information (e.g. for anonymisation, normalisation, aggregation). The data processing requested by NWDAF is used to anonymise, normalise or aggregate the same UE attribute from multiple UEs at the AF before notifying to the NWDAF.\nFor each UE attribute of a specific UE, whether and how AF is processing the data that is received from the UE depends on the SLA configured in AF (defined in clause 6.2.8.1) and is not known by the NWDAF.\nTo determine NF load (per area of interest), NWDAF may collect and take into account UE trajectory input data from the AF, defined in clause 6.7.2.2, Table 6.7.2.2-2 for UE mobility analytics in addition to MDT input data and /or collective behaviour input data, defined in clause 6.5.2, Table 6.5.2-3 and Table 6.5.2-5, respectively.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.5.2-1: Data collected by NWDAF for NF load analytics",
                                    "table number": 26,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.5.2-2: Data collected by NWDAF for UPF load analytics",
                                    "table number": 27,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.5.2-3: MDT input data for UE",
                                    "table number": 28,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.5.2-4: Per UE attribute to be collected and processed by the AF",
                                    "table number": 29,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.5.2-5: AF input data to the NWDAF for Collective Behaviour of UEs",
                                    "table number": 30,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.5.3\tOutput analytics",
                            "text_content": "The NWDAF services as defined in the clause 7.2 and 7.3 are used to expose the analytics. NF load statistics information are defined in Table 6.5.3-1. NF load predictions information are defined in Table 6.5.3-2.\nTable 6.5.3-1: NF load statistics\n\nTable 6.5.3-2: NF load predictions\n\nNOTE:\tThe variations on per-instance NF load and resource usage could be influenced by the number of running NF instances in addition to the load itself.\nThe predictions are provided with a Validity Period, as defined in clause 6.1.3.\nThe number of resource status is limited by the maximum number of objects provided as part of Analytics Reporting Information.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.5.3-1: NF load statistics",
                                    "table number": 31,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.5.3-2: NF load predictions",
                                    "table number": 32,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.5.4\tProcedures",
                            "text_content": "The procedure depicted in Figure 6.5.4-1 allows a consumer NF to request analytics to NWDAF for NF load of various NF instances as defined in 6.5.1.\nThe figure depicts a NF load analytics dashboard, which provides real-time data on network traffic, latency, and utilization. It includes various metrics such as average, median, and min/max values, as well as a histogram for visualizing the distribution of data. The dashboard is designed to help network operators optimize their network resources and ensure high-quality service delivery.\nFigure 6.5.4-1: NF load analytics provided by NWDAF\n1.\tThe NF sends a request to the NWDAF for analytics for NF load for a specific NF, using either the Nnwdaf_AnalyticsInfo or Nnwdaf_AnalyticsSubscription service. The Analytics ID is set to NF load information, the Target of Analytics Reporting and the Analytics Filter Information are set according to clause 6.5.1. The NF can request statistics or predictions or both and can provide a time window.\n2-5.\tIf the request is authorized and in order to provide the requested analytics, the NWDAF may need for each NF targeted instance to subscribe to OAM services to retrieve the target NF resource usage and NF resources configuration following steps captured in clause 6.2.3.2 for data collection from OAM. The NWDAF may collect MDT input data per individual UE from OAM (see Table 6.5.2-3). Steps 2-5 may be skipped when e.g. the NWDAF already has the requested analytics.\n6.\tFor Collective Behaviour attributes, if the request is authorized and in order to provide the requested analytics, NWDAF may follow the UE Input Data Collection Procedure via the AF as defined in clause 6.2.8 (see Table 6.5.2-4 and Table 6.5.2-5).\nThe NWDAF subscribes to the AF services as above invoking either Nnef_EventExposure_Subscribe or Naf_EventExposure_Subscribe service (Event ID = Collective Behaviour, Event Filter information, Target of Event Reporting) as defined in TS 23.502 [3]. The area of interest is set as part of Event Filter information to specific TAs or AMF region. The UE data is collected from UEs within the area of interest.\nIn the case of trusted AF, the NWDAF provides the Area of Interest as a list of TAIs to the AF. In the case of untrusted AF, NEF translates the requested Area of Interest provided as event filter by the NWDAF into geographic zone identifier(s) that act as event filter for the AF.\nFor collective attributes as defined in Table 6.5.2-5, the AF processes (e.g. anonymize, aggregate and normalize) the data from individual UEs per UE attribute (see Table 6.5.2-4) based on Event Filters indicated by the NWDAF to determine which ones display a collective behaviour within the area of interest before notifying a collective attribute directly (trusted AF) or via NEF (for untrusted AF) to the NWDAF. The AF will provide (per collective attribute) e.g. the number of UEs that fulfil the collective attribute (within an area of interest).\nNOTE 1:\tThe call flow only shows a subscription/notification model for the simplicity, however both request-response and subscription-notification models should be supported.\nNOTE 2:\tIf the target NF type is UPF, the NWDAF can collect the information as listed in Table 6.5.2-2. How the NWDAF collects information is defined in clause 5.8.2.17 of TS 23.501 [2] and in clause 4.15.4 of TS 23.502 [3].\n7a.\tThe NWDAF subscribes to changes on the load and status of NF instances registered in NRF and identified by their NF id from NRF using Nnrf_NFManagement_NFStatusSubscribe service operation for each NF instance.\n7b. NRF notifies NWDAF of changes on the load and status of the requested NF instances by using Nnrf_NFManagement_NFStatusNotify service operation.\n8.\tThe NWDAF derives requested analytics.\n9.\tThe NWDAF provides requested NF load analytics to the NF along with the corresponding Validity Period (only for predictions) or area of interest, using either the Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.\n10-12. If at step 1 the NF has subscribed to receive continuous reporting of NF load analytics, the NWDAF may generate new analytics and, when relevant according to the Analytics target period and Reporting Threshold, provide them along with the corresponding Validity Period (only for predictions) to the NF upon reception of notification of new NF load information from OAM or NRF or UE Input data notification via MDT or the AF (see Table 6.5.2-3 and Table 6.5.2-5).\nNOTE 3:\tIf the target NF type at step 1 is UPF, the NWDAF can generate new analytics when receiving new information as listed in Table 6.5.2-2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.6\tNetwork Performance Analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tGeneral",
                            "text_content": "With Network Performance Analytics, NWDAF provides either statistics or predictions on the gNB status information, gNB resource usage, communication performance and mobility performance in an Area of Interest; in addition, NWDAF it may provide statistics or predictions on the number of UEs located in that Area of Interest.\nThe service consumer may be an NF (e.g. PCF, NEF, AF), or the OAM.\nThe consumer of these analytics may indicate in the request:\n-\tAnalytics ID = \"Network Performance\";\n-\tTarget of Analytics Reporting: either a single UE (SUPI ), or a group of UEs (an Internal Group ID that refers to the group for which the analytics on the number of UEs that are located in the Area of Interest at the time indicated in the Analytics target period is requested) or any UE;\n-\tAnalytics Filter Information:\n-\tArea of Interest (list of TA or Cells) which restricts the area in focus (mandatory if Target of Analytics Reporting is set to \"any UE\", optional otherwise);\n-\tOptionally, Traffic type of interest (overall traffic, GBR traffic or Delay-critical GBR traffic);\nNOTE:\tIf Traffic type of interest is not provided, overall traffic is considered.\n-\tOptionally, a list of analytics subsets that are requested among those specified in clause 6.6.3;\n-\tOptionally, a preferred level of accuracy of the analytics;\n-\tOptionally, preferred level of accuracy per analytics subset (see clause 6.6.3);\n-\tOptionally, preferred order of results for the list of Network Performance information:\n-\tordering criterion: \"number of UEs\", \"communication performance\" or \"mobility performance\";\n-\torder: ascending or descending;\n-\tOptionally, Reporting Thresholds, which apply only for subscriptions and indicate conditions on the level to be reached for respective analytics information (see clause 6.6.3) in order to be notified by the NWDAF;\n-\tAn Analytics target period indicates the time period over which the statistics or prediction are requested; and\n-\tOptionally, maximum number of objects.\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\n-\tOptionally, Spatial granularity size (if an Area of Interest is provided) and Temporal granularity size.\nThe NWDAF notifies the result of the analytics to the consumer as indicated in clause 6.6.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.2\tInput Data",
                            "text_content": "The NWDAF collects Load and Performance information in an Area of Interest from the sources listed in Table 6.6.2-1 and number of UEs within Area of Interest from the sources listed in Table 6.6.2-2.\nTable 6.6.2-1: Load and Performance information collected by NWDAF\n\nTable 6.6.2-2: Number of UEs in Area of Interest information collected by NWDAF\n\nThe NWDAF shall be able to collect UE mobility information as stated in clause 6.7.2.2.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.6.2-1: Load and Performance information collected by NWDAF",
                                    "table number": 33,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.6.2-2: Number of UEs in Area of Interest information collected by NWDAF",
                                    "table number": 34,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.6.3\tOutput Analytics",
                            "text_content": "The NWDAF shall be able to provide both statistics and predictions on Network Performance.\nNetwork performance statistics are defined in Table 6.6.3-1.\nTable 6.6.3-1: Network performance statistics\n\nEditor's note:\tThe possibility to provide the gNB resource usage for GBR traffic and gNB resource usage for Delay-critical GBR traffic based on existing network performance management parameters defined in TS 28.552 [8] is to be confirmed by SA WG5.\nNetwork performance predictions are defined in Table 6.6.3-2.\nTable 6.6.3-2: Network performance predictions\n\nEditor's note:\tThe possibility to provide the gNB resource usage for GBR traffic and gNB resource usage for Delay-critical GBR traffic based on existing network performance management parameters defined in TS 28.552 [8] is to be confirmed by SA WG5.\nNOTE 1:\tThe predictions are provided with a Validity Period, as defined in clause 6.1.3.\nNOTE 2:\tThe analytics on number of UEs are related to the information retrieved from the AMFs.\nThe number of network performance information entries is limited by the maximum number of objects provided as part of Analytics Reporting Information.\nThe NWDAF provides Network Performance Analytics to a consumer at the time requested by the consumer in the Analytics target period:\n-\tAnalytics ID set to \"Network Performance\".\n-\tNotification Target Address including the address of the consumer.\n-\tNotification Correlation ID, for the consumer to correlate notifications from NWDAF if subscription applies.\n-\tAnalytics specific parameters at the time indicated in the Analytics target period.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.6.3-1: Network performance statistics",
                                    "table number": 35,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.6.3-2: Network performance predictions",
                                    "table number": 36,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.6.4\tProcedures",
                            "text_content": "The figure depicts a step-by-step procedure for subscribing to network performance analytics, illustrating the process of obtaining insights and data from a telecommunications network.\nFigure 6.6.4-1: Procedure for subscription to network performance analytics\n1.\tThe NF sends Nnwdaf_AnalyticsSubscription_Subscribe or Nnwdaf_AnalyticsInfo_Request (Analytics ID=\"Network Performance\", Target of Analytics Reporting, Analytics Filter Information = \"Area of Interest\", Analytics Reporting Information = (\"Reporting Thresholds\" and Analytics target Period(s))) to the NWDAF.\n2a-2d.\tThe NWDAF discovers from NRF the AMF(s) belonging to the AMF Region(s) that include(s) the Area of Interest and subscribes to NF load and status information from NRF about these AMF(s).\n3a-3b.\tThe NWDAF subscribes to OAM services to get the status and load information and the resource usage on the Area of Interest in clause 6.6.2, following the procedure captured in Clause 6.2.3.2.\n4a-4b.\tThe NWDAF collects the number of UEs located in the Area of Interest from AMF using Namf_EventExposure_Subscribe service, including the Target of Event Reporting provided as an input parameter (i.e. any UE or Internal Group Identifier).\n5.\tThe NWDAF derives the requested analytics.\n6.\tThe NWDAF sends Nnwdaf_AnalyticsSubscription_Notify or Nnwdaf_AnalyticsInfo_Request response (Network Performance analytics, Subscription Correlation Id, Confidence).\n7-8. A change of network performance information, i.e. change in the gNB status information, gNB resource usage, communication performance and mobility performance in the area of interest at the observed period, is detected by OAM, or a change in the NF load information is reported by NRF and is notified to NWDAF.\n9.\tThe NWDAF derives new analytics taking into account the most recent data collected.\n10.\tWhen relevant according to the Analytics target period and Reporting Thresholds, the NWDAF provides a notification using Nnwdaf_AnalyticsSubscription_Notify (Network Performance analytics, Subscription Correlation Id, Confidence).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tUE related analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.7.1\tGeneral",
                            "text_content": "This clause specifies the UE related analytics which can be provided by NWDAF:\n-\tUE mobility analytics;\n-\tUE communication analytics;\n-\tExpected UE behavioural parameters related network data analytics; and\n-\tAbnormal behaviour related network data analytics.\nThe NWDAF service consumer may request for these analytics separately, or in a combined way. As an example, an NWDAF service consumer may learn from the NWDAF the expected UE behaviour parameters as defined in clause 4.15.6.3 of TS 23.502 [3] for a group of UEs or a specific UE, by requesting analytics for both UE mobility (see clause 6.7.2) and for UE communication (see clause 6.7.3).\nDepending on local regulations, the NWDAF retrieves user consent for the UE with UDM prior to data collection as defined in clause 6.2.2.2 or clause 6.2.2.3. If user consent to collect data is not granted by the UE, the NWDAF rejects/cancels any analytics subscriptions to any of the UE related analytics with target for analytics set to the SUPI or GPSI of that UE. If the target for analytics is either an Internal or External Group Id or a list of SUPIs or \"any UE\", the NWDAF skips those SUPIs that do not grant user consent for the purpose of analytics or model training.\nNOTE:\tPossible uses of such analytics is for the AMF to learn about expected UE behaviour to derive appropriate MICO mode configuration, or for an AF to learn about expected UE behaviour to further provision 5GC with appropriate UE parameters.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.2\tUE mobility analytics",
                            "text_content": "NWDAF supporting UE mobility statistics or predictions shall be able to collect UE mobility related information from NF, OAM and to perform data analytics to provide UE mobility statistics or predictions.\nThe service consumer may be a NF (e.g. AMF, SMF or AF).\nThe consumer of these analytics may indicate in the request:\n-\tAnalytics ID = \"UE Mobility\".\n-\tTarget of Analytics Reporting: a single UE (SUPI) or a group of UEs (an Internal Group ID);\n-\tAnalytics Filter Information optionally containing:\n-\tArea of Interest (AOI): restricts the scope of the UE mobility analytics to the provided area. If the request is for fine granularity location information (i.e. with a finer granularity than cell), the AOI may be described as shown in clause 5.5 of TS 23.273 [39];\nNOTE 1:\tFor LADN service, the consumer (e.g. SMF) provides the LADN DNN to refer the LADN service area as the AOI.\n-\tVisited Area(s) of Interest (visited AOI(s)): additional filter to only consider UEs that are currently (i.e. now) in the \"AOI\" and had previously (i.e. in the \"Analytics target period\") been in at least one of the Visited AOI(s). If this parameter is provided, the Analytics target period shall be in the past (i.e. supported for statistics only);\n-\tLinear distance threshold: An event where the UE moves by more than some predefined straight line distance from a previous location as per TS 23.273 [39]. The consumer can provide more than one value of Linear distance threshold.\n-\tan optional list of analytics subsets that are requested (see clause 6.7.2.3);\n-\tAn Analytics target period indicates the time period over which the statistics or predictions are requested;\nNOTE 2:\tFor regular analytics scenarios, the Analytics target period is associated with the Analytics Filter Information = AOI, while for the scenario that Analytics ID=UE Mobility and Analytics Filter Information = (AOI and visited AOI(s)), as described in this clause, the Analytics target period is associated with the visited AOI(s) and to obtain the statistics for those UEs that currently reside in the AOI and had previously (i.e. in the \"Analytics target period\") been in at least one of the Visited AOI(s).\n-\tOptionally, maximum number of objects;\n-\tPreferred level of accuracy of the analytics;\n-\tOptionally, Preferred level of accuracy per analytics subset (see clause 6.7.2.3);\n-\tPreferred order of results for the time slot entries: ascending or descending time slot start;\n-\tOptionally, preferred granularity of location information: TA level or cell level \"longitude and latitude level\";\nNOTE 3:\tDefinition of \"longitude and latitude level\" is described in clause 6.1.3.\n-\tOptionally, Preferred orientation of location information: (\"horizontal\", \"vertical\", \"both\");\n-\tOptionally, Spatial granularity size and Temporal granularity size;\n-\tUE Location order indicator: indicates the NWDAF should derives and provides the UE Mobility analytics for UE Location in time order; and\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\nThe NWDAF supporting data analytics on UE mobility shall be able to collect UE mobility information from OAM, 5GC and AFs. The detailed information collected by the NWDAF could be MDT data from OAM, network data from 5GC and/or service data from AFs:\n-\tUE mobility information from OAM is UE location carried in MDT data;\n-\tNetwork data related to UE mobility from 5GC is UE location information, UE location trends or UE access behaviour trends, as defined in the Table 6.7.2.2-1;\nTable 6.7.2.2-1: UE Mobility information collected from 5GC\n\n-\tService data related to UE mobility provided by AFs is defined in the Table 6.7.2.2-2;\nTable 6.7.2.2-2: Service Data from AF related to UE mobility\n\nDepending on the requested level of accuracy, data collection may be provided on samples (e.g. spatial subsets of UEs or UE group, temporal subsets of UE location information).\nNOTE:\tReporting current UE location can cause AMF to request NG-RAN to report UE location and consequently extra signalling and load in NG-RAN and AMF. The consumer retrieving data from AMF needs to use current location with care to avoid excessive signalling.\nThe NWDAF supporting data analytics on UE mobility shall be able to provide UE mobility analytics to consumer NFs or AFs. The analytics results provided by the NWDAF could be UE mobility statistics as defined in table 6.7.2.3-1, UE mobility predictions as defined in Table 6.7.2.3-2:\nTable 6.7.2.3-1: UE mobility statistics\n\nTable 6.7.2.3-2: UE mobility predictions\n\nThe results for UE groups address the group globally. The ratio is the proportion of UEs in the group at a given location at a given time.\nThe number of time slots and UE locations is limited by the maximum number of objects provided as part of Analytics Reporting Information.\nThe time slots shall be provided by order of time, possibly overlapping. The locations shall be provided by decreasing value of ratio for a given time slot. The sum of all ratios on a given time slot must be equal or less than 100%. Depending on the list size limitation, the least probable locations on a given Analytics target period may not be provided.\nIf a UE Location order indicator is included in the Analytics Reporting information, the NWDAF does not aggregate the UE locations in a long duration but provides the UE locations one by one in their own time period, i.e. the \"UE location (1..max)\" in the UE Mobility analytics has only one UE location (TA, Cell or a finer granularity UE Location smaller than cell) which indicates the UE is located in this UE location in the duration from the time slot start (i.e. time stamp when the UE enters this location as described in clause 6.7.2.2).\nThe NWDAF can provide UE mobility related analytics, in the form of statistics or predictions or both, directly to another NF. If the NF is an AF and when the AF is untrusted, the AF will request analytics via the NEF and the NEF will then convey the request to NWDAF.\nNOTE:\tIn the case of untrusted AF the Target of Analytics Reporting can be a GPSI or an External Group Identifier that is mapped in the 5GC to a SUPI or an Internal Group Identifier.\nThe figure depicts a UE (User Equipment) mobility analytics service, which provides real-time data on the UE's location and movement patterns. This service is crucial for network operators to optimize network performance and ensure seamless user experience. The figure includes various components such as the UE, network infrastructure, and analytics service, all working together to provide accurate and timely data to the consumer.\nFigure 6.7.2.4-1: UE mobility analytics provided to an Analytics Service Consumer\n1.\tThe NF sends a request (Analytics ID = UE mobility, Target of Analytics Reporting = UE id or Internal Group ID, Analytics Filter Information = AOI, Analytics Reporting Information= Analytics target period and/or UE Location order indicator) to the serving NWDAF for analytics information on a specific UE or a group of UEs, using either the Nnwdaf_AnalyticsInfo or Nnwdaf_AnalyticsSubscription service to derive UE mobility information. The NF can request statistics or predictions or both. For LADN service, the NF (i.e. SMF) provides LADN DNN as AOI in the Analytics Filter Information.\nIf NF wants to obtain the aggregated mobility analytics of those UEs, that currently reside in the AOI and had visited at least one of visited AOI(s) during an Analytics target period, the NF may send a request for UE mobility analytics with Analytics ID = UE mobility, Target of Analytics Reporting = UE group ID or UE ID, Analytics Filter Information = (AOI, visited AOI(s)), Analytics Reporting information = Analytics target period. In this case, the requested mobility analytics is a statistics.\n2.\tIf the request is authorized and in order to provide the requested analytics, the NWDAF may subscribe to events with all the serving AMFs for the requested UE(s), for notification of location changes. This step may be skipped when e.g. the NWDAF already has the requested analytics available.\nThe NWDAF subscribes the service data for the requested UE(s) from AF(s) in the Table 6.7.2.2-2 by invoking Naf_EventExposure_Subscribe service or Nnef_EventExposure_Subscribe (if via NEF) using event ID \"UE Mobility information\" as defined in TS 23.502 [3].\nThe NWDAF collects UE mobility information from OAM for the requested UE(s), following the procedure captured in clause 6.2.3.2.\nThe NWDAF may collect UE location information from the GLMC, which may initiate the UE location service procedure and gets the location of each requested UE(s), if the consumer requested fine granularity location information and/or one or more location requests corresponding to the linear distance threshold values in the analytics request according to clause 6.7.2.1.\nNOTE 1:\tThe NWDAF determines the AMF serving the UE or the group of UEs as described in clause 6.2.2.1.\n3.\tThe NWDAF derives requested analytics.\nIf in step 1 the NWDAF receives analytics subscription/request from NF to obtain the aggregated mobility analytics of those UEs, which currently reside in AOI and had visited at least one of visited AOI(s) during an Analytics target period and if visited AOI(s) and AOI are covered by different NWDAFs, in addition to the data collected in the AOI in step 2, the NWDAF can also obtain UE mobility analytics in one of the visited AOI(s) during the Analytics target period from other NWDAF instance(s) for the requested UE(s). Then the NWDAF supporting analytics aggregation capability derives a UE ID list based on the request from the NF in step 1 and the requested aggregated analytics based on the data collected in the AOI in step 2 and UE mobility analytics in one or more of the visited AOI(s) obtained from the other NWDAF instance(s). UE visited locations in visited AOI(s) and AOI will be included in the aggregated UE mobility analytics.\nNOTE 2:\tIf the visited AOI(s) and AOI are covered by different NWDAFs, then consumer in the AOI firstly discovers a NWDAF supporting analytics aggregation capability in the AOI from the NRF, as defined in clause 6.3.13 of TS 23.501 [2].\n4.\tThe NWDAF provides requested UE mobility analytics to the NF, using either the Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1. The details for UE mobility analytics provided by NWDAF are defined in clause 6.7.2.3.\nIf in step 1 the NF wants to obtain the aggregated mobility analytics of those UEs, that currently reside in the AOI and had visited at least one of visited AOI(s) during an Analytics target period, the NWDAF will provide the requested aggregated analytics for the UE(s) matching this criteria, i.e. the derived mobility analytics can cover a subset of UEs compared to the Target of Analytics Reporting as provided in step 1.\n5-6.\tIf at step 1, the NF has subscribed to receive notifications for UE mobility analytics, after receiving event notification from the AMFs, AFs, GMLC and OAM subscribed by NWDAF in step 2, the NWDAF may generate new analytics and provide them to the NF.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.7.2.2-1: UE Mobility information collected from 5GC",
                                    "table number": 37,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.7.2.2-2: Service Data from AF related to UE mobility",
                                    "table number": 38,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.7.2.3-1: UE mobility statistics",
                                    "table number": 39,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.7.2.3-2: UE mobility predictions",
                                    "table number": 40,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.7.3\tUE Communication Analytics",
                            "text_content": "In order to support some optimized operations, e.g. customized mobility management, traffic routing handling, RFSP Index Management, QoS improvement or Inactivity Timer optimization, in 5GS, an NWDAF may perform data analytics on UE communication pattern and user plane traffic and provide the analytics results (i.e. UE communication statistics or prediction) to NFs in the 5GC or an AF.\nAn NWDAF supporting UE Communication Analytics collects per-application communication description from AFs. If consumer NF provides an Application ID, the NWDAF only considers the data from AF, SMF and UPF that corresponds to this application ID. NWDAF may also collect data from AMF.\nThe consumer of these analytics may indicate in the request:\n-\tAnalytics ID = \"UE Communication\".\n-\tTarget of Analytics Reporting: a single UE (SUPI) or a group of UEs (an Internal Group ID).\n-\tAnalytics Filter Information optionally including:\n-\tS-NSSAI;\n-\tDNN;\n-\tApplication ID;\n-\tArea of Interest.\n-\tan optional list of analytics subsets that are requested (see clause 6.7.3.3);\n-\tAn Analytics target period indicates the time period over which the statistics or predictions are requested.\n-\tPreferred level of accuracy of the analytics.\n-\tOptional Preferred level of accuracy per analytics subset (see clause 6.7.3.3);\n-\tOptional preferred order of results for the list of UE Communications:\n-\tordering criterion: \"start time\" or \"duration\",\n-\torder: ascending or descending;\n-\tOptionally, maximum number of objects;\n-\tOptionally, Spatial granularity size (if an Area of Interest is provided); and\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\nThe NWDAF supporting data analytics on UE communication shall be able to collect communication information for the UE from 5GC. The detailed information collected by the NWDAF includes service data related to UE communication as defined in the Table 6.7.3.2-1.\nTable 6.7.3.2-1: Service Data from 5GC related to UE communication\n\nDepending on the requested level of accuracy, data collection may be provided on samples (e.g. spatial subsets of UEs or UE group, temporal subsets of UE communication information).\nThe application Id is optional. If the application Id is omitted, the collected UE communication information can be applicable to all the applications for the UE.\nThe NWDAF supporting UE Communication Analytics provides the analytics results to consumer NFs. The analytics results provided by the NWDAF include the UE communication statistics as defined in Table 6.7.3.3-1 or predictions as defined in Table 6.7.3.3-2.\nTable 6.7.3.3-1: UE Communication Statistics\n\nTable 6.7.3.3-2: UE Communication Predictions\n\nNOTE:\tWhen Target of Analytics Reporting is an individual UE, one UE ID (i.e. SUPI) will be included, the NWDAF will provide the analytics communication result (i.e. list of (predicted) communication time slots) to NF service consumer(s) for the UE.\nThe results for UE groups address the group globally. The ratio is the proportion of UEs in the group for a given communication at a given time and duration.\nThe number of UE communication entries (1..max) is limited by the maximum number of objects provided as part of Analytics Reporting Information. The communications shall be provided by order of time, possibly overlapping.\nDepending on the list size limitation, the least probable communications on a given Analytics target period may not be provided.\nThe NWDAF can provide UE communication related analytics, in the form of statistics or predictions or both, to a 5GC NF.\nThe figure depicts a procedure for analyzing user equipment (UE) communication analytics in a 4G network. It illustrates the steps involved in collecting data, processing it, and analyzing the results. The figure includes a flowchart and a list of steps, making it easy to understand the process.\nFigure 6.7.3.4-1: Procedure for UE communication analytics\n1.\t5GC NF to NWDAF: Nnwdaf_AnalyticsSubscription_Subscribe (Analytics ID = UE communication, Target of Analytics Reporting=SUPI, Analytics Filter Information = (Application ID, Area of Interest, etc.)).\n5GC NF sends a request to the NWDAF for analytics on a specific UE(s), using either Nnwdaf_AnalyticsInfo or Nnwdaf_AnalyticsSubscription_Subscribe service. The analytics type indicated by \"Analytics ID\" is set to \"UE communication\". The Target of Analytics Reporting is set to SUPI or an Internal Group Identifier and Analytics Filter may include Application ID and Area of Interest.\n2a-b.\tNWDAF to AF (Optional): Naf_EventExposure_Subscribe (Event ID, external UE ID, Application ID, Area of Interest).\nIn order to provide the requested analytics, the NWDAF may subscribe per application communication information, which is identified by Application ID, from AFs for the UE. The Event ID \"UE Communication information\" as defined in TS 23.502 [3] is used, which indicates communication report for the UE which is requested by the 5GC NF in the step 1. The external UE ID is obtained by the NWDAF based on UE internal ID, i.e. SUPI. In the case of external AF, the NEF translates the requested Area of Interest into a list of geographic zone identifier(s) as described in clause 5.6.7.1 of TS 23.501 [2].\nThis step is skipped if the NWDAF already has the requested analytics available or has subscribed to the AF.\n2c.\tNWDAF to SMF: Nsmf_EventExposure_Subscribe (Event ID, SUPI, Application ID).\nIn order to provide the requested analytics, the NWDAF subscribes via SMF to UPF information on SUPI, providing e.g. Indication of UPF Event Exposure Service and Target subscription UPF Event Id, Filter Information such as Application ID and/or Area of Interest. This is specified in clause 5.8.2.17 of TS 23.501 [2] and clause 4.15.4 of TS 23.502 [3].\n2d.\tHow SMF subscribes to on UPF is defined in clause 5.8.2.17 of TS 23.501 [2] and in clause 4.15.4 of TS 23.502 [3].\nNOTE:\tThe NWDAF request does not trigger any N4 session Establishment/Modification procedure. UPF sends N4 session level reports, including PDU session Inactivity to SMF, according to clause 4.4.2.2 of TS 23.502 [3].\n2f.\tThe UPF provides the requested input data to NWDAF. This is specified in clause 4.15.4 of TS 23.502 [3].\n2g-h.\tNWDAF to AMF: Namf_EventExposure_Subscribe (Event ID, SUPI, Area of Interest).\nIn order to provide the requested analytics, the NWDAF retrieves one or more of Type Allocation code, UE connection management state, UE access behaviour trends and UE location trends from AMF.\nNOTE:\tThe NWDAF determines the SMF serving the UE as described in clause 6.2.2.1.\n3.\tThe NWDAF derives requested analytics, in the form of UE communication statistics or predictions or both.\n4.\tNWDAF to 5GC NF: Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify.\nThe NWDAF provides requested UE communication analytics to the NF, using either Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.\n5.\tIf the NF subscribed UE communication analytics at step 1, when, based e.g. on new UPF notifications the NWDAF generates new analytics, the NWDAF notifies the new generated analytics to the 5GC NF.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.7.3.2-1: Service Data from 5GC related to UE communication",
                                    "table number": 41,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.7.3.3-1: UE Communication Statistics",
                                    "table number": 42,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.7.3.3-2: UE Communication Predictions",
                                    "table number": 43,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.7.4\tExpected UE behavioural parameters related network data analytics",
                            "text_content": "The clause 6.7.4 defines how a service consumer learns from the NWDAF the expected UE behaviour parameters as defined in clause 4.15.6.3 of TS 23.502 [3] for a group of UEs or a specific UE.\nThe service consumer may be an NF (e.g. AMF, AF), or the OAM.\nThe consumer of these analytics shall indicate in the request:\n-\tAnalytics ID = \"UE Mobility\" or \"UE Communication\".\n-\tTarget of Analytics Reporting: a single UE (SUPI) or a group of UEs (an Internal Group ID).\nNOTE:\tIn the case of untrusted AF the Target of Analytics Reporting can be a GPSI or an External Group Identifier that is mapped in the 5GC to a SUPI or an Internal Group Identifier\n-\tAn Analytics target period, which indicates the time period over which the statistics or predictions are requested.\n-\tAnalytics Filter Information optionally including:\n-\tArea of Interest (AOI);\n-\tS-NSSAI;\n-\tDNN;\n-\tApplication ID;\n-\tan optional list of analytics subsets that are requested (see clause 6.7.3.3).\n-\tOptional maximum number of objects.\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\nThe NWDAF shall notify the result of the analytics to the consumer as indicated in clause 6.7.4.3.\nIn order to produce \"UE Mobility\" analytics, the NWDAF collects UE mobility information, UE location trends and/or UE access behaviour trends, as defined in clause 6.7.2.2.\nIn order to produce \"UE Communication\" analytics, the NWDAF collects UE communication information, UE communication trends, UE session behaviour trends and/or UE access behaviour trends, as defined in clause 6.7.3.2.\nThe analytics results for \"UE Mobility\" are specified in Table 6.7.2.3-1 and Table 6.7.2.3-2.\nThe analytics results for \"UE Communication\" are specified in Table 6.7.3.3-1 and Table 6.7.3.3-2.\nThe figure depicts a procedure for NWDAF (Non-Wireline Data Aggregation Framework) assisted expected UE (User Equipment) behavioural analytics. It illustrates the steps involved in analyzing the expected UE behavior, including data collection, preprocessing, and analysis. The figure includes a flowchart and a list of steps, providing a clear and concise overview of the procedure.\nFigure 6.7.4.4.1-1: NWDAF assisted expected UE behavioural analytics procedure\n1.\t5GC NF (e.g. AMF, SMF and AF) to NWDAF: Nnwdaf_AnalyticsInfo_Request (Analytics ID, Target of Analytics Reporting, Analytics Filter Information) or Nnwdaf_AnalyticsSubscription_Subscribe (Analytics ID, Target of Analytics Reporting, Analytics Filter Information).\nThe Analytics ID is set to \"UE Mobility\" or to \"UE Communication\",\" and the consumer request analytics.\n2.\tIf Analytics ID is set to \"UE Mobility\", the NWDAF collects data from OAM, AMF and/or AF as specified in clause 6.7.2.4 step 2, unless the information is already available.\nIf Analytics ID is set to \"UE Communication\", the NWDAF collects data from AMF, SMF and/or AF as specified in clause 6.7.3.4 step 2, unless the information is already available.\n3.\tThe NWDAF derives requested analytics.\n4.\tNWDAF to 5GC NF: Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify.\nThe NWDAF provides requested Expected UE behaviour to the NF, using either Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.\n5-6.\tIf the NF subscribed to at step 1, when the NWDAF generates new analytics, it provides the new generated analytics to the NF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.5\tAbnormal behaviour related network data analytics",
                            "text_content": "This clause defines how to identify a group of UEs or a specific UE with abnormal behaviour, e.g. being misused or hijacked, with the help of NWDAF.\nNOTE 1:\tThe misused or hijacked UEs are UEs in which there are malicious applications running or UEs which have been stolen.\nThe consumer of this analytics could be a 5GC NF. The 5GC NF subscribes analytics on abnormal behaviour from a NWDAF based on the UE subscription, network configuration or application layer request.\nThe NWDAF performs data analytics on abnormal behaviour if there is a related subscription and returns exception reports that result from the analysis of the correlations between behavioural variables. The exception reports contain an Exception Level expressed in the form of a scalar value, possibly supplemented by additional measurements.\nThe consumer of this analytics shall indicate in the request:\n-\tAnalytics ID = \"Abnormal behaviour\";\n-\tTarget of Analytics Reporting: a single UE, any UE or an Internal Group Identifier;\n-\tAn Analytics target period indicates the time period over which the statistics or predictions are requested;\n-\tAnalytics Filter Information optionally including:\n-\texpected UE behaviour parameters;\n-\texpected analytics type or list of Exception IDs with associated thresholds for the Exception Level, where the expected analytics type can be mobility related, communication related or both;\n-\tArea of interest;\n-\tApplication ID;\n-\tDNN;\n-\tS-NSSAI.\nNOTE 2:\tThe expected analytics type generally indicates whether mobility or communication related abnormal behaviour analytics or both are expected by the consumer and the list of exception IDs indicates what specific analytics are expected by the consumer. Either the expected analytics type or the list of Exception IDs needs to be indicated, but they are not presented simultaneously. When the expected analytics type is indicated, the NWDAF performs corresponding abnormal behaviour analytics which are supported by the NWDAF. The relation between the expected analytics type and Exception IDs is defined in Table 6.7.5.1-1.\n-\tOptionally, maximum number of objects and maximum number of SUPIs;\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\nTable 6.7.5.1-1: Relation between expected analytics type and Exception IDs\n\nIf the Target of Analytics Reporting is any UE, then the Analytics Filter should at least include:\n-\tArea of Interest or S-NSSAI, if the expected analytics type or the list of Exception IDs is mobility related.\n-\tArea of Interest, application ID, DNN or S-NSSAI, if the expected analytics type or the list of Exception IDs is communication related.\nIf the Target of Analytics Reporting is any UE, the consumer of this analytics shall request either mobility related only or communication related only abnormal behaviour analytics, but not both at the same time.\nThe expected UE behaviour parameters that the consumer can indicate in the request when known depend on the Exception ID that the consumer expects. They may encompass UE behaviour parameters as defined in clause 4.15.6.3 of TS 23.502 [3] and other parameters. Table 6.7.5.1-2 shows the mapping between each Exception ID and UE behaviour parameters.\nTable 6.7.5.1-2: Description of Expected UE Behaviour parameters per Exception ID\n\nWhen the NWDAF detects those UEs that deviate from the expected UE behaviour, e.g. unexpected UE location, abnormal traffic pattern, unexpected transaction dispersion amount, wrong destination address, etc. the NWDAF shall notify the result of the analytics to the consumer as specified in clause 6.7.5.3.\nThe Exceptions information from AF is as specified in Table 6.7.5.2-1.\nOn request of the service consumer, the NWDAF shall collect and analyse UE behavioural information from the 5GC NFs (SMF, AMF, AF), or OAM as specified in clauses 6.7.2.2 and 6.7.3.2 and/or expected UE behavioural parameters from UDM as defined in clause 4.15.6.3, TS 23.502 [3], depending on Exception IDs.\nNOTE:\tCare needs to be taken with regards to load by avoiding to cause major extra signalling when collecting data for any UE.\nTable 6.7.5.2-1: Exceptions information from AF\n\nCorresponding to the \"abnormal behaviour\" Analytics ID, the analytics result provided by the NWDAF is defined in Table 6.7.5.3-1 and Table 6.7.5.3-2. When the level of an exception trespasses above or below the threshold, the NWDAF shall notify the consumer with the exception ID associated with the exception if the exception ID is within the list of exception IDs indicated by the consumer or matches the expected analytics type indicated by the consumer. The NWDAF shall provide the Exception Level and determine which of the other information elements to provide, depending on the observed exception.\nAbnormal behaviour statistics information is defined in Table 6.7.5.3-1.\nTable 6.7.5.3-1: Abnormal behaviour statistics\n\nAbnormal behaviour predictions information is defined in Table 6.7.5.3-2.\nTable 6.7.5.3-2: Abnormal behaviour predictions\n\nThe predictions are provided with a Validity Period, as defined in clause 6.1.3.\nThe UE characteristics may provide a set of features common to all UEs affected with the exception.\nThe number of exceptions and the length of the SUPI list shall respectively be lower than the parameters maximum number of objects and Maximum number of SUPIs provided as part of Analytics Reporting Information.\nIf PCF subscribes to notifications on \"Abnormal behaviour\", the NWDAF shall send the PCF notifications about the risk, which may trigger the PCF to update the AM/SM policies.\nThe NWDAF also sends the notification directly to the AMF or SMF, if the AMF or SMF subscribes to the notification, so that the AMF or SMF may, based on operator local policies defined on a per S-NSSAI basis (for AMF) or on a per S-NSSAI, per DNN, or per (DNN,S-NSSAI) basis (for SMF), take actions for risk solving.\nIf the AF subscribes to notifications on \"Abnormal behaviour\", the NWDAF sends the notifications to the AF so that the AF may take actions for risk solving.\nThe following Table 6.7.5.3-3 gives examples of additional measurement provided by the NWDAF and examples of NF actions for solving each risk.\nTable 6.7.5.3-3: Examples of additional measurements and NF actions for risk solving\n\nThe figure depicts a procedure for identifying misused or hijacked UEs in a network. It shows a step-by-step process to analyze the network traffic and identify any suspicious activity. The figure includes a flowchart and a list of steps, making it easy to understand the steps involved in the identification process.\nFigure 6.7.5.4-1: Procedure for NWDAF assisted misused or hijacked UEs identification\n1a.\tA consumer NF subscribes to/requests NWDAF using Nnwdaf_AnalyticsSubscription_Subscribe/ Nnwdaf_AnalyticsInfo_Request (Analytics ID = Abnormal behaviour, Target of Analytics Reporting = Internal-Group-Identifier, any UE or SUPI, Analytics Filter Information).\nA consumer NF may subscribe to/request abnormal behaviour notification/response from NWDAF for a group of UEs, any UE or a specific UE. The Analytics ID indicates the NWDAF to identify misused or hijacked UEs through abnormal behaviour analytic.\n1b.\tAF to NWDAF: Nnwdaf_AnalyticsSubscription_Subscribe or Nnwdaf_AnalyticsInfo_Request (Analytics ID, Target of Analytics Reporting = External-group identifier, any UE or External UE ID, Analytics Filter Information).\nFor untrusted AFs, the AF sends the subscription via a NEF, where the AF invokes NEF service Nnef_AnalyticsExposure_Subscribe or Nnef_AnalyticsExposure_Fetch (Analytics ID, Target of Analytics Reporting = External-group-identifier, any UE or External UE ID, Analytics Filter Information).\nAn AF may also subscribe to/request abnormal behaviour notification/response from NWDAF for a group of UEs, a specific UE or any UE, where the subscription/request message may contain expected UE behaviour parameters identified on the application layer. If an External-Group-Identifier is provided by the AF, the NEF interrogates UDM to map the External-Group-Identifier to the Internal-Group-Identifier and obtain SUPI list corresponding to the Internal-Group-Identifier.\n2.\t[Conditional] NWDAF to AMF: Namf_EventExposure_Subscribe (Event ID(s), Event Filter(s), Internal-Group-Identifier, any UE or SUPI).\nThe NWDAF sends subscription requests to the related AMF to collect UE behavioural information if it has not subscribed such data.\nNOTE 1:\tThe NWDAF determines the related AMF(s) as described in clause 6.2.2.1.\nThe AMF sends event reports to the NWDAF based on the report requirements contained in the subscription request received from the NWDAF.\nIf requested by NWDAF via Event Filter(s), the AMF checks whether the UE's behaviour matches its expected UE behavioural information. In this case, the AMF sends event reports to the NWDAF only when it detects that the UE's behaviour deviated from its expected UE behaviour.\nDepending on the Exception ID, the NWDAF may in addition perform data collection from OAM as specified in clause 6.2.3.2.\n3.\t[Conditional] NWDAF to SMF: Nsmf_EventExposure_Subscribe (Event ID(s), Event Filter(s), Internal-Group-Identifier, any UE or SUPI).\nThe NWDAF sends subscription requests to the related SMF(s) if it has not subscribed to such data.\nNOTE 2: Besides Analytics Filter Information, other mechanisms such as setting maximum number of SUPIs and/ or using sampling ratio as part of Analytics Reporting Parameters as per Event Reporting Information (clause 4.15.1 of TS 23.502 [3]) can be used by the analytics consumer to limit signalling load, e.g. when the Target of Analytics Reporting is \"any UE\". The NWDAF can also use sampling ratio, possibly with partition criteria, when subscribing towards AMF and SMF.\nNOTE 3:\tThe NWDAF determines the related SMF(s) as described in clause 6.2.2.1.\nThe SMF sends event reports to the NWDAF based on the report requirements contained in the subscription request received from the NWDAF.\nIf requested by NWDAF via Event Filter(s), the SMF checks whether the UE's behaviour matches its expected UE behavioural information. In this case, the SMF sends event reports to the NWDAF only when it detects that the UE's behaviour deviated from its expected UE behaviour.\n4.\tThe NWDAF performs data analytics for misused or hijacked UEs identification. Based on the analytics and operator's policies the NWDAF determines whether to send a notification to the consumer NF or AF.\n5a.\t[Conditional] NWDAF to consumer NF (AMF or PCF or SMF depending on the subscription): Nnwdaf_AnalyticsSubscription_Notify or Nnwdaf_AnalyticsInfo_Request response (Analytics ID, Exception ID, Internal-Group-Identifier or SUPI, Exception level) (which is used depending on the service used in step 1a).\nIf the NWDAF determines to send a notification/response to the consumer 5GC NFs, the NWDAF invokes Nnwdaf_AnalyticsSubscription_Notify or Nnwdaf_AnalyticsInfo_Request response service operations. Based on the notification/response, the 5G NFs adopt configured actions to resolve/mitigate/avoid the risks as described in the Table 6.7.5.3-1.\n5b.\t[Conditional] NWDAF to AF: Nnwdaf_AnalyticsSubscription_Notify or Nnwdaf_AnalyticsInfo_Request response (Analytics ID, Exception ID, External UE ID, Exception level) (which is used depending on the service used in step 1b).\nIf the NWDAF determines to send a notification/response to the consumer AF, the NWDAF needs to include external UE ID of the identified UE into the notification/response message.\nNOTE 3:\tBased on the notification, the AF can adopt corresponding actions, e.g. adjusting recommended TCP Window Size, adjusting recommended Service Start and End.\nNOTE 4:\tThe call flow only shows a subscribe-notify model for the interaction of NWDAF and consumer NF for simplicity instead of both request-response model and subscription-notification model.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.7.5.1-1: Relation between expected analytics type and Exception IDs",
                                    "table number": 44,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.7.5.1-2: Description of Expected UE Behaviour parameters per Exception ID",
                                    "table number": 45,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.7.5.2-1: Exceptions information from AF",
                                    "table number": 46,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.7.5.3-1: Abnormal behaviour statistics",
                                    "table number": 47,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.7.5.3-2: Abnormal behaviour predictions",
                                    "table number": 48,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.7.5.3-3: Examples of additional measurements and NF actions for risk solving",
                                    "table number": 49,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "6.8\tUser Data Congestion Analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tGeneral",
                            "text_content": "The NWDAF can provide user data congestion related analytics, by one-time reporting or continuous reporting, in the form of statistics or predictions or both, to another NF. User Data Congestion related analytics can relate to congestion experienced while transferring user data over the control plane or user plane or both. A request for user data congestion analytics relates to a specific area or to a specific user. If the consumer of these analytics provides a UE ID, the NWDAF determines the area where the UE is located. The NWDAF then collects measurements per cell and uses the measurements to determine user data congestion analytics.\nThe request for user data congestion related analytics indicates the location area information where congestion related analytics is desired or indicates a UE Identity that can be used by the NWDAF to determine the location area information where congestion related analytics is desired. When requesting user data congestion, the consumer may request the identifiers of the applications that contribute the most to the traffic in the area. The consumer may indicate how many applications should be reported by providing the maximum number of applications in the request or subscription.\nWhen the consumer of user data congestion related analytics subscribes to user data congestion related analytics, it may indicate a threshold and the NWDAF will provide analytics to the consumer when the congestion level crosses the threshold. The consumer can indicate an S-NSSAI in the request when congestion analytics are needed on a per slice level.\nThe service consumer may be an NF (e.g. NEF, AF, PCF).\nThe consumer of these analytics may indicate in the request or subscription the following parameters, its content is described in the clause 6.1.3:\n-\tAnalytics ID = \"User Data Congestion\";\n-\tTarget of Analytics Reporting: either a single UE (SUPI), or \"any UE\";\nNOTE:\tThe Target of Analytics Reporting set to \"any UE\" applies when user data congestion analytics relates to a specific Area of Interest.\n-\tAnalytics Filter Information:\n-\tArea of Interest (i.e. list of TAIs or Cell IDs) which restricts the area in focus (mandatory if Target of Analytics Reporting is set to \"any UE\", optional otherwise);\n-\tan optional list of analytics subsets that are requested, (see clause 6.8.3);\n-\tOptional S-NSSAI, in order to obtain congestion analytics only on a given slice;\n-\tOptional Reporting Threshold, which applies only for subscriptions and indicates conditions on the congestion level (Network Status Indication, see clause 6.8.3) to be reached in order to be notified by the NWDAF.\n-\tPreferred level of accuracy of the analytics;\n-\tPreferred order of results for the list of User Data Congestion statistics or predictions:\n-\tordering by Applicable Time Window, chronological or reverse chronological order; or\n-\tordering by Network Status Indication, ascending or descending;\n-\tOptional maximum number of objects;\n-\tAn Analytics target period indicates the time period over which the statistics or prediction are requested, either in the past or in the future;\n-\tOptionally, Temporal granularity size; and\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\nThe NWDAF notifies the result of the analytics to the consumer as indicated in clause 6.8.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tInput data",
                            "text_content": "The detailed information collected by the NWDAF is defined in Table 6.8.2-1.\nNOTE 1:\tPerformance Measurements defined in TS 28.552 [8] represent resource utilisation but do not, by themselves, indicate the event of congestion or congestion levels. The NWDAF collects measurements from the OAM and how the NWDAF derives Network Status Indication (NSI) is not specified.\nTable 6.8.2-1: Data Collected from the NF and OAM related to User Data Congestion Analytics\n\nTable 6.8.2-2: Data Collected from the UPF or from the AF related to User Data Congestion Analytics\n\nNOTE 2:\tCare needs to be taken with regards to load and major signalling caused when requesting \"any UE\". This can be achieved via utilization of event filters (e.g. Area of Interest), Analytics Reporting Information (e.g. maximum number of objects), or preferred sampling ratio provided by NWDAF to the UPF and/or local UPF configuration of data collection for specific application IDs, Packet Filter Sets and/or PFDs.\nAdditionally, NWDAF may use statistics or predictions on service experience as specified in clause 6.4.3 as an input, e.g. for service experience in a given area or service experience for some specific applications such as high bandwidth applications.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.8.2-1: Data Collected from the NF and OAM related to User Data Congestion Analytics",
                                    "table number": 50,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.8.2-2: Data Collected from the UPF or from the AF related to User Data Congestion Analytics",
                                    "table number": 51,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.8.3\tOutput analytics",
                            "text_content": "The NWDAF outputs the user data congestion analytics for transfer over the user plane, for transfer over the control plane, or for both. The output may consist of statistics, predictions, or both. The detailed information provided by the NWDAF is defined in Table 6.8.3-1 for statistics and in Table 6.8.3-2 for predictions.\nTable 6.8.3-1: User Data Congestion statistics\n\nTable 6.8.3-2: User Data Congestion predictions\n\nThe following list shows the applicability of the analytics subsets per consumer:\n-\tAnalytics subset \"List of top applications in UL (0..NU)\" and \"List of top applications in DL (0..ND)\" are applicable to any consumer (e.g. PCF, AF, NEF), The NWDAF decides if these Analytics subset is provided to an AF.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.8.3-1: User Data Congestion statistics",
                                    "table number": 52,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.8.3-2: User Data Congestion predictions",
                                    "table number": 53,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.8.4\tProcedures",
                            "text_content": "The procedure as depicted in Figure 6.8.4.1-1 is used by an NF to retrieve congestion analytics for a specific geographic area. The procedure can be used to request a one-time or continuous reporting of congestion analytics.\nThe figure depicts a procedure for one-time or continuous reporting of analytics for congestion in a geographic area. It illustrates the steps involved in analyzing congestion, including the use of a congestion management system (CMS) and the collection of data from various sources. The figure also highlights the importance of monitoring and managing congestion to ensure the smooth operation of the network.\nFigure 6.8.4.1-1: Procedure for one-time or continuous reporting of analytics for congestion in a geographic area\nFor one-time reporting:\n1.\tThe NF sends Nnwdaf_AnalyticsInfo_Request to NWDAF, indicating request for analytics for congestion in a specific location. The NF can request statistics or predictions or both. The Analytics ID is set to \"User Data Congestion\" for transfer over user plane, control plane, or both, the Target of Analytics Reporting is set to \"any UE\" and Analytics Filter Information set to include a location (e.g. ECGI, TA) and an indication to provide the list of applications that contribute the most to the traffic.\n2-3.\tIf the request is authorized and in order to provide the requested analytics, the NWDAF may request the measurement information for the requested location from OAM services following the data collection from OAM procedure as captured in 6.2.3.2. If the NWDAF already has information about the requested location, these steps are omitted. The NWDAF may obtain measurements by invoking management services that are defined in TS 28.532 [6] and TS 28.550 [7].\nIf the request is to provide the list of applications that contribute the most to the traffic, then the NWDAF collects input data from the AF for the applications being served by AF(s) by invoking Naf_EventExposure_Subscribe service or Nnef_EventExposure_Subscribe (if via NEF) or collected from the UPF or collected from both, AF and UPF.\n4.\tThe NWDAF derives requested analytics.\n5.\tThe NWDAF provides the analytics for congestion to the NF.\nFor continuous reporting:\n6.\tThe NF sends Nnwdaf_AnalyticsSubscription_Subscribe Request to the NWDAF, indicating request for analytics for congestion in a specific location (e.g. ECGI, TA), possibly with thresholds and including an indication to provide the list of applications that contribute the most to the traffic. The NF can request statistics or predictions or both. The type of analytics is set to user data congestion analytics for transfer over user plane, control plane, or both.\n7-8. The NWDAF subscribes to OAM services following the data collection from OAM procedure as captured in 6.2.3.2 to get measurement information for the requested location, possibly providing measurement thresholds for example, data congestion crossing values. The NWDAF may obtain measurements by invoking management services that are defined in TS 28.532 [6] and TS 28.550 [7]. If a request is to provide the list of applications that contribute the most to the traffic, the NWDAF subscribes to the service data from AF by invoking Naf_EventExposure_Subscribe service or Nnef_EventExposure_Subscribe (if via NEF) or from the UPF or from both.\n9.\tThe NWDAF derives requested analytics.\n10.\tThe NWDAF provides the analytics for congestion to the NF.\n11a.\tA change of user data congestion status corresponding to crossing a threshold set by the NWDAF at steps 7-8 is detected by OAM and notified to NWDAF.\n11b.\tThe AF notifies the NWDAF with the input data as defined in table 6.8.2-2.\n11c.\tThe UPF provides the NWDAF with the input data as defined in table 6.8.2-2.\nNOTE:\tHow the data from UPF is retrieved (subscribed to on UPF and notified then by UPF) is defined in clause 5.8.2.17 of 23.501 [2] and in clause 4.15.4 of TS 23.502 [3].\n12.\tThe NWDAF derives new analytics.\n13.\tThe NWDAF provides a notification for analytics for the user data congestion to the NF.\nThe procedure as depicted in Figure 6.8.4.2-1 is used by an NF to retrieve user data congestion analytics for a specific UE. The procedure can be used to request a one-time or continuous reporting of user data congestion analytics.\nThe figure depicts a procedure for one-time or continuous reporting of analytics for congestion for a specific UE, illustrating the steps involved in analyzing the network's performance and identifying congestion points.\nFigure 6.8.4.2-1: Procedure for one-time or continuous reporting of analytics for congestion for a specific UE\nFor one-time reporting:\n1.\tThe NF sends Nnwdaf_AnalyticsInfo_Request to NWDAF, requesting for analytics for user data congestion for a specific UE id. The NF can request statistics or predictions or both. The type of analytics is set to user data congestion analytics for transfer over user plane, control plane, or both, the Target of Analytics Reporting is set to UE id.\n2-5. The NWDAF may already know the UE location. If not, the NWDAF checks the UE location by first retrieving the AMF serving the UE (steps 2-3) and then by interrogating the AMF about the UE location.\nNOTE 1:\tThe NF sends a request for a UE that is registered, so that NWDAF can retrieve the UE location.\n6-7. The NWDAF requests measurement information for the UE location from OAM services (as captured in 6.2.3.2). These steps are omitted if the NWDAF already has the information. The NWDAF may obtain measurements by invoking management services that are defined in TS 28.532 [6] and TS 28.550 [7].\nIf the request is to provide the list of applications that contribute the most to the traffic, then the NWDAF collects the input data from the UPF serving the UE location, or from the AF(s) by invoking Naf_EventExposure_Subscribe service or Nnef_EventExposure_Subscribe (if via NEF) or collects input data from both, AF and UPF. The input data is defined in Table 6.8.2-2.\n8.\tThe NWDAF derives requested analytics.\n9.\tThe NWDAF provides the analytics for congestion to the NF.\nFor continuous reporting:\n10.\tThe NF sends Nnwdaf_AnalyticsSubscription_Subscribe Request to the NWDAF. The NF can request for statistics or for predictions or for both. The type of analytics is set to user data congestion analytics for transfer over user plane, control plane, or both.\n11.\tThe NWDAF determines the UE location, either via internal information or by applying the same steps as steps 2 to 5. The NWDAF then determines an area of interest.\n12-13. The NWDAF subscribes to OAM services (as captured in 6.2.3.2) to get the measurement information for the UE location, possibly providing measurement thresholds. The NWDAF may obtain measurements by invoking management services that are defined in TS 28.532 [6] and TS 28.550 [7].\nIf the request is to provide the list of applications that contribute the most to the traffic, then the NWDAF collects input data from the UPF serving the UE location or from the AF(s) by invoking Naf_EventExposure_Subscribe service or Nnef_EventExposure_Subscribe (if via NEF) or collects from both, AF and UPF. The input data is defined in Table 6.8.2-2.\n14.\tThe NWDAF derives requested analytics.\n15.\tThe NWDAF provides the analytics for user data congestion status information to the NF.\n16-17. The NWDAF subscribes to UE mobility event notification in order to be informed when the UE moves out of the area of interest (in order to define a new area of interest and request new information to OAM if the UE moves to a different area).\n18a.\tA change of user data congestion status corresponding to crossing a threshold set by the NWDAF is detected by OAM and notified to NWDAF.\n18b.\tThe AF notifies the NWDAF with the input data as defined in table 6.8.2-2.\n18c.\tThe UPF provides the NWDAF with the input data as defined in table 6.8.2-2.\nNOTE 2:\tHow the data from UPF is retrieved (subscribed to on UPF and notified then by UPF) is defined in clause 5.8.2.17 of TS 23.501 [2] and in clause 4.15.4 of TS 23.502 [3].\n19.\tThe NWDAF derives new analytics.\n20.\tThe NWDAF provides a notification for analytics for the user data congestion status information to the NF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.9\tQoS Sustainability Analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.9.1\tGeneral",
                            "text_content": "The consumer of QoS Sustainability analytics may request the NWDAF analytics information regarding the QoS change statistics for an Analytics target period in the past in a certain area or the likelihood of a QoS change for an Analytics target period in the future in a certain area. The consumer can request either to subscribe to notifications (i.e. a Subscribe-Notify model) or to a single notification (i.e. a Request-Response model).\nThe service consumer may be a NF (e.g. AF).\nThe request includes the following parameters:\n-\tAnalytics ID = \"QoS Sustainability\";\n-\tTarget of Analytics Reporting: any UE;\n-\tAnalytics Filter Information:\n-\tQoS requirements (mandatory):\n-\t5QI (standardized or pre-configured) and applicable additional QoS parameters and the corresponding values (conditional, i.e. it is needed for GBR 5QIs to know the GFBR); or\n-\tthe QoS Characteristics attributes including Resource Type, PDB, PER and their values;\n-\tLocation information (mandatory): an Area Of Interest or a path of interest. The location information could reflect a list of waypoints:\n-\tif the location information is an Area Of Interest, the area can be either described in a coarse granularity as list of TAIs or Cell IDs, or in a fine granularity as geographical area (that can be smaller than a cell), or both (coarse and fine granularity); if both granularities are provided, the NWDAF understands that the area of interest is the intersection between the fine granularity location and the list of TAIs or Cell IDs.\n-\tif the location information is a path of interest, the area can be either described in a coarse granularity as list of TAIs or Cell IDs, or in a fine granularity as a list of waypoints (expressed as longitude and latitude in geographical coordinates) and combined with a radius value, or both (coarse and fine granularity); if both granularities are provided, the NWDAF understands that the path of interest is the intersection between the fine granularity location and the list of TAIs or Cell IDs.\n-\tThreshold linear distance: The distance travelled by the UE before reporting subsequent location as described in TS 23.273 [39].\nNOTE 1:\tThreshold linear distance is used by the NWDAF when requesting location of the UE from the GMLC using LCS.\nNOTE 2:\tIn this Release, the consumer of the \"QoS Sustainability\" Analytics ID will provide location information in the area of interest format (TAIs or Cell IDs or geographical area) which is understandable by NWDAF.\nNOTE 3:\tWhen location information is described as an area of interest in a fine granularity (i.e. as geographical area that can be smaller than a cell) the Cell ID(s) can already be determined by the NEF based on its local configuration and provided to the NWDAF in addition. This addresses the scenario when Cell ID(s) cannot be determined by the NWDAF based on its local configuration. Alternatively, the NWDAF can also be configured with the Cell ID(s) corresponding to an area of interest in a fine granularity.\n-\tS-NSSAI (optional);\n-\tOptional maximum number of objects;\n-\tOptional UE Device and Context Information: which may contain one or more of the following:\n-\tSpeed range, which is a range of UE speeds for which analytics is requested, where the speed range is indicated as a range of Velocity Estimate, as in clause 6.1.6.2.17 of TS 29.572 [37];\n-\tDevice information, which may contain one of the following:\n-\tList of equipment types, according to clause 8.0 of GSMA TS.06 [38].\n-\tAnalytics target period: relative time interval, either in the past or in the future, that indicates the time period for which the QoS Sustainability analytics is requested;\n-\tOptionally, Spatial granularity size and Temporal granularity size;\n-\tReporting Threshold(s), which apply only for subscriptions and indicate conditions on the level to be reached for the reporting of the analytics, i.e. to discretize the output analytics and to trigger the notification when the threshold(s) provided in the analytics subscription are crossed by the expected QoS KPIs.\n-\tA matching direction may be provided such as crossed (default value), below, or above.\n-\tAn acceptable deviation from the threshold level in the non-critical direction (i.e. in which the QoS is improving) may be set to limit the amount of signalling.\nThe level(s) relate to value(s) of the QoS KPIs defined in TS 28.554 [10], for the relevant 5QI:\n-\tfor a 5QI of GBR resource type, the Reporting Threshold(s) refer to the QoS flow Retainability KPI;\n-\tfor a 5QI of non-GBR resource type, the Reporting Threshold(s) refer to the RAN UE Throughput KPI and/or delay in RAN KPI as defined in TS 28.554 [10].\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address.\nTo derive the QoS Sustainability analytics when the location information is an area of interest with coarse granularity (i.e. TAIs or Cell IDs):\n-\tThe NWDAF collects the corresponding statistics information on the QoS KPI for the relevant 5QI of interests from the OAM, i.e. the QoS flow Retainability or the RAN UE Throughput or delay in RAN as defined in TS 28.554 [10] and average GTP metrics as defined in TS 28.552 [8].\nTo derive the QoS Sustainability analytics when the location information is an area of interest with fine granularity (i.e. geographical area that can be smaller than a cell):\n-\tThe NWDAF derives the UE list for the area of interest with fine granularity by two steps, firstly based on an initial selection of the UE list in the corresponding coarse area from AMF, secondly based on finer granularity location data using LCS as described in clause 6.2.12, e.g. NWDAF can collect finer granularity location data of a UE using LCS and identify whether this UE is inside of the area of interest with fine granularity area, input data as defined in Table 6.9.2-2.\n-\tThe NWDAF can then collect the corresponding UE level information on the QoS KPI for the relevant 5QI of interests from the 5GC NF/OAM, i.e. input data as defined in Table 6.9.2-2.\n-\tNWDAF derives QoS sustainability statistics or predictions for the area of interest with fine granularity by averaging these input data for all the UEs that are in the UE list.\nTo improve QoS Sustainability analytics, the NWDAF may additionally collect GTP metrics defined in Table 6.9.2-3.\nIf the Analytics target period refers to the past:\n-\tThe NWDAF verifies whether the triggering conditions for the notification of QoS change statistics are met and if so, generates for the consumer one or more notifications.\n-\tThe analytics feedback contains the information on the location and the time for the QoS change statistics and the Reporting Threshold(s) that were crossed.\nIf the Analytics target period is in the future:\n-\tThe NWDAF detects the need for notification about a potential QoS change based on comparing the expected values for the KPI of the target 5QI against the Reporting Threshold(s) provided by the consumer in any cell in the requested area for the requested Analytics target period. The expected KPI values are derived from the statistics for the 5QI obtained from OAM. OAM information may also include planned or unplanned outages detection and other information that is not in scope for 3GPP to discuss in detail.\n-\tThe analytics feedback contains the information on the location and the time when a potential QoS change may occur and what Reporting Threshold(s) may be crossed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.2\tInput data",
                            "text_content": "To derive the QoS Sustainability analytics for a path of interest or for an area of interest with coarse granularity (i.e. TAIs or Cell IDs), the input data is listed in Table 6.9.2-1.\nTable 6.9.2-1: Data collection for \"QoS Sustainability\" analytics\n\nNOTE 1:\tThe timeslot is the time interval split according to the time unit of the OAM statistics defined by operator.\nTo derive the QoS Sustainability analytics for an area of interest with fine granularity (i.e. geographical area that can be smaller than a cell), additional input data is listed in Table 6.9.2-2.\nTable 6.9.2-2: UE level data collection for \"QoS Sustainability\" analytics with fine granularity\n\nNOTE 2:\tHow to use the input data from GSMA for QoS Sustainability analytics is up to NWDAF implementation.\nAdditionally, the NWDAF collects the following input (Table 6.9.2-3) according to measurements defined in clause 5.33.3 QoS Monitoring to Assist URLLC Service of TS 23.501 [2] and IP-layer clause capacity and IP-layer available clause capacity definition from ITU-T Y.1540 [40] between UE, NG-RAN and UPF at GTP level.\nTable 6.9.2-3: Data collection for QoS Sustainability analytics at GTP level\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.9.2-1: Data collection for \"QoS Sustainability\" analytics",
                                    "table number": 54,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.9.2-2: UE level data collection for \"QoS Sustainability\" analytics with fine granularity",
                                    "table number": 55,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.9.2-3: Data collection for QoS Sustainability analytics at GTP level",
                                    "table number": 56,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.9.3\tOutput analytics",
                            "text_content": "The NWDAF outputs the QoS Sustainability analytics. Depending on the Analytics target period, the output consists of statistics or predictions. The detailed information provided by the NWDAF is defined in Table 6.9.3-1 for statistics and Table 6.9.3-2 for predictions.\nTable 6.9.3-1: \"QoS Sustainability\" statistics\n\nTable 6.9.3-2: \"QoS Sustainability\" predictions\n\nNOTE 1:\tThe meaning of Confidence is based on the SLA, i.e. the consumer has to understand the meaning of the different values of Confidence.\nNOTE 2:\tThe Analytics can contain multiple sets of the above information if the location information reflected a list of waypoints.\nThe number of QoS sustainability analytics entries is limited by the maximum number of objects provided as part of Analytics Reporting Information.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.9.3-1: \"QoS Sustainability\" statistics",
                                    "table number": 57,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.9.3-2: \"QoS Sustainability\" predictions",
                                    "table number": 58,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.9.4\tProcedures",
                            "text_content": "Figure 6.9.4.1-1 depicts a procedure for \"QoS Sustainability\" analytics in a coarse granularity area provided by NWDAF.\nThe NWDAF shall not activate the measurements for QoS Monitoring. If QoS Monitoring is already activated, the measurements will be triggered according to QoS Monitoring procedures (see clause 5.33.3 of TS 23.501 [2]).\nThe figure depicts a coarse granularity area with various QoS metrics, including packet loss, jitter, and delay, providing analytics for NWDAF in a coarse granularity area.\nFigure 6.9.4.1-1: \"QoS Sustainability\" analytics provided by NWDAF in a coarse granularity area\n1.\tThe consumer requests or subscribes to analytics information on \"QoS Sustainability\" provided by NWDAF. The parameters included in the request are described in clause 6.9.1.\nThe consumer may include multiple sets of parameters in order to provide different combinations of \"Location information\" and \"Analytics target period\" when requesting QoS Sustainability analytics.\n2.\tThe NWDAF collects the data specified in clause 6.9.2 from the OAM, following the procedure captured in clause 6.2.3.2.\n3.\tThe NWDAF verifies whether the triggering conditions are met and derives the requested analytics. The NWDAF can detect the need for notification based on comparing the requested analytics of the target 5QI against the Reporting Threshold(s) provided by consumer in any cell over the requested Analytics target period.\n4.\tThe NWDAF provides response or notification on \"QoS Sustainability\" to the consumer.\nThe figure depicts a procedure for \"QoS Sustainability\" analytics in a fine granularity area, illustrating the steps involved in analyzing and maintaining quality of service (QoS) in a network. The figure includes a flowchart with various stages, such as data collection, analysis, and optimization, to ensure that the network can maintain high QoS levels even in complex scenarios.\nFigure 6.9.4.2-1: Procedure for \"QoS Sustainability\" analytics in a fine granularity area\n1.\tThe NF consumer requests or subscribes to analytics information on \"QoS Sustainability\" provided by the NWDAF. The parameters included in the request are defined in clause 6.9.1 of TS 23.288 [5]. The NF can request statistics or predictions or both.\nThe consumer provides the TAIs or Cell IDs and/or fine granularity area (e.g. below cell via longitude/latitude range etc.) in \"Location information\" when requesting QoS Sustainability analytics. If the AF doesn't provide TAIs or Cell IDs, the NWDAF as an 5GC internal NF is expected to obtain such information, i.e. to determine which cells are related to the fine granularity area.\nThe consumer may optionally provide UE Context or Subscription information such as one or more of the following: device speed or speed range, IMEI or IMEISV or TAC range, equipment type.\n2a.\tIf the request is authorized and in order to provide the requested analytics, the NWDAF decides the AMF(s) based on the TAIs/Cell IDs and obtains the UE list in the TAs/Cells from AMF by invoking Namf_EventExposure_Subscribe service operation using event ID \"Number of UEs present in a geographical area\" as described in TS 23.502 [3].\n2b.\tThe NWDAF invokes Namf_EventExposure_Subscribe service operation to get the update of the UE list using event ID \"UE moving in or out of Area of Interest\" as described in TS 23.502 [3].\n3.\tThe NWDAF obtains location information using LCS by initiating the LCS Service Request to the GMLC to get the location and optionally the speed of UEs from UE list provided by the AMF in step 2.\n4.\tThe GMLC initiates the UE location service procedure and gets the location of the UEs as described in TS 23.273 [39].\n5.\tThe GMLC provides location information for each UE in the UE list to the NWDAF.\n6.\tFrom the list of UE locations returned by the GMLC, the NWDAF identifies the UEs located in fine granularity area by comparing the UEs' locations to the fine granularity area, provided in step 1.\n7.\tThe NWDAF invokes Namf_EventExposure_Subscribe service operation to get the serving SMF for the UE.\n8.\tBased on the serving SMF in step 7, the NWDAF invokes Nsmf_EventExposure_Subscribe service operation to get the UPF information for the UE.\n9.\tThe NWDAF may collect QoS information either from the UPF directly, or subscribe to the UPF via the SMF. The QoS information may include the bandwidth, packet delay for the UE and the information on the serving UPF node id.\nNOTE 1:\tHow the data from UPF is retrieved (subscribed to on UPF and notified then by UPF) is defined in clause 5.8.2.17 of 23.501 [2] and in clause 4.15.4 of TS 23.502 [3].\n10.\tOptionally, the NWDAF may collect additional information for the UE Context or UE Subscription from the UDM such as PEI (if available). PEI may be used to retrieve, from GSMA database, additional information such as IMEI or IMEISV or TAC range, equipment type. Such additional information may be used by NWDAF to add more information to the collected measurements and filter those measurements that are applicable to the UE Device and Context Information for which analytics are requested by the service consumer.\n11.\tThe NWDAF verifies whether the triggering conditions are met and derives the requested analytics. The NWDAF can detect the need for notification based on comparing the requested analytics of the target 5QI against the Reporting Threshold(s) provided by the consumer in any cell over the requested Analytics target period.\n12.\tThe NWDAF provides the response or notification on \"QoS Sustainability\" to the NF consumer.\nNOTE 2:\tNWDAF may decide to ignore some of the filters if collected measurements are not sufficient to derive meaningful analytics.\nNOTE 3:\tIn order to reduce the amount of information collected per measurement point, the additional information from UDM may only be collected for the events of GBR unfulfillment. In this way the additional analytics filter information may only be supported for 5QI of resource type GBR and for events of GBR unfulfillment.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.10\tDispersion Analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.10.1\tGeneral",
                            "text_content": "Dispersion analytics identifies the location (i.e. areas of interest, TAs, cells) or network slice(s) where a UE, or a group of UEs, or any UE disperse most (if not all) of their data volume and sessions transactions (i.e. MM and SM messages).\nThe NWDAF shall be able to provide dispersion statistics or predictions and shall be able to collect UE dispersion related information from NFs.\nDispersion is the percentage of activity that a UE, or group of UEs, or any UE, generates at a location or a slice during a period of interest. This enables the operator to rank hot locations or slices by the various activities and to identify the top contributors (i.e. UEs) for that activity. When heavy UEs at a particular location or slice are detected/predicted and reported to a policy entity, their QoS attributes, or access to an area of interest or a slice can then be limited.\n-\tData volume dispersion - The percentage of data traffic volume that a UE, or a group of UEs, or any UE, generated at a location or in a slice during the period of interest.\n-\tTransactions dispersion - The percentage of MM and SM messages that a UE, or a group of UEs, or any UE, generated at a location or in a slice during the period of interest.\nThe operator may classify and assign one of the three mobility classes per dispersion characteristics for a UE or a group of UEs, or any UE as fixed, camper or traveller. In addition, the operator may classify a UE as a Top-Heavy UE in case its dispersion percentile rating, at a location or a slice, is higher than a threshold value defined by the operator (e.g. 0.9 percentile), see percentile ranking in the output tables, clause 6.10.3. The classification is based on either Data volume dispersion or Transactions dispersion.\n-\tData-Classification - fixed, camper, traveller data-classification per thresholds assigned by the operator.\nEXAMPLE:\tWhen a UE disperses, during the period of observation, most (threshold=95%) of its data at a location or a slice, the dispersion data-classification of the UE at that location or slice is \"fixed\".\n-\tTransaction-Classification - fixed, camper, traveller transactions-classifications per thresholds assigned by the operator.\nEXAMPLE:\tWhen a UE disperses, during the period of observation, (threshold=40%) of its session transactions at a location or a slice, the dispersion transaction-classification of the UE is camper at that location or slice.\nBased on the dispersion analytics, the analytics consumer can determine that a data volume or transactions hot spot is formed when the volume of data or amount of transactions dispersed by most of the UEs at the area of interest or slice exceeds a certain data or transaction threshold established through trend analysis or operator policy.\nThe consumer of dispersion analytics may indicate in its request:\n-\tAnalytics ID = \"Dispersion Analytics\";\n-\tTarget of Analytics Reporting: a single UE (SUPI), or a group of UEs (an Internal Group ID), or any UE. \"Any UE\" is only supported in combination with Analytics Filter Information (S-NSSAI, Area(s) of Interest, Top-Heavy UEs indication, Fixed indication, Camper indication or Traveller indication) and Dispersion Analytics type \"Data Volume Dispersion Analytics\" and/or \"Transaction Dispersion Analytics\";\n-\tAnalytics Filter Information:\n-\toptional list of TA(s), Area(s) of Interest, Cells, or S-NSSAI(s), Application ID(s), Top-Heavy UEs, Fixed UEs, Camper UEs, Dispersion Analytics type (Data Volume Dispersion Analytics (DVDA) or Transactions Dispersion Analytics (TDA) or both); and\n-\toptional list of analytics subsets that are requested (see clause 6.10.3);\n-\tPreferred level of accuracy of the analytics;\n-\tPreferred level of accuracy per analytics subset (see clause 6.10.3);\n-\tPreferred order of results for the list of UE Dispersion Analytics information:\n-\tordering criterion:\n-\tFor DDA, one of the following: \"time slot start\", \"data dispersion\", \"data classification\", \"data ranking\", or \"data percentile ranking\";\n-\tFor TDA, one of the following: \"time slot start\", \"transaction dispersion\", \"transaction classification\", \"transaction ranking\", or \"transaction percentile ranking\"; and\n-\torder: ascending or descending;\n-\tAnalytics target period indicating the time period over which the statistics or predictions are requested;\n-\tOptionally, maximum number of objects and maximum number of SUPIs;\n-\tOptionally, preferred granularity of location information: TA level or cell level;\n-\tOptionally, Spatial granularity size and Temporal granularity size; and\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\nNOTE 1:\tIf one or multiple ID(s) are included in the filter information, the output analytics will be reported per Application ID, otherwise the output analytics is aggregated information per AOI or slice independent of the applications.\nNOTE 2:\tCare needs to be taken with regards to load when requesting analytics for \"Any UE\". This could be achieved by utilizing event filters (e.g. Area of Interest for AMF) and possible analytics filters including Top-Heavy UEs and/or Fixed and/or Camper UEs and/or Analytics Reporting Information (e.g. SUPImax), or sampling ratio as part of Event Reporting Information. The load of analytics for \"Any UE\" can be alleviated by limiting the number of S-NSSAI in the analytics filter.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.2\tInput Data",
                            "text_content": "The NWDAF shall be able to collect UE dispersion information from NF(s) and AFs. The information collected by the NWDAF is network data from 5GC NFs and service data from AFs:\n-\tData related to UE transactions dispersion and bound by location collected from AMF and SMF are defined in the tables 6.10.2-1 and 6.10.2-2. This may include individual transactions or SMF/AMF state transition information stored as UE behaviour trends, which provides aggregated transaction information.\nTable 6.10.2-1: Location based UE transactions dispersion information collected from serving AMF\n\nTable 6.10.2-2: UE transactions dispersion information collected from serving SMF\n\nData volume can be collected from the AF per UE across all the UE applications provided by a particular AF or per UE per application when application IDs are requested.\nData related to UE data volume dispersion, bound by a location or slice, collected from the AF and UPF are defined in tables 6.10.2-3 through 6.10.2-6.\nIf the Target of Analytics Reporting is set to an Internal Group ID and the AF is located in the untrusted domain, NEF translates it into an External Group ID.\nNOTE 1:\tIt is assumed that the AF is provisioned with the list of UE IDs (GPSIs or SUPIs) belonging to an External or Internal Group ID.\n-\tIn table 6.10.2-3, the data volume is collected per UE from the AF. The collected UE information is applicable across all the applications used by the UE during the period.\nTable 6.10.2-3: UE Data volume dispersion information collected from the AF\n\n-\tIn table 6.10.2-4, the AF reports data volume per UE per application in relation to the start and stop of the application as indicated by the application duration.\nTable 6.10.2-4: UE data volume dispersion collected from the AF\n\nData volume can also be collected from the UPF per UE IP address across all applications or per UE for specific application(s).\n-\tIn table 6.10.2-5, the data volume is collected per UE from the UPF. The collected UE information is applicable across all applications used by the UE between start and stop of the PDU session. The UPF reports volume per UE IP address across all applications.\nTable 6.10.2-5: UE data volume dispersion collected from serving UPF\n\n-\tIn table 6.10.2-6, the UPF reports data volume per UE for specific application(s) in relation to the start and stop of the application as indicated by the application duration.\nThere are two modes of data collection:\n-\tNon periodical: A mode where the data volume is requested and consequently provided for the total volume of a PDU session.\n-\tPeriodical: A mode where data volume is provided periodically between the start and stop of a PDU session. The period can be specified in the requested analytic target period or configured as a default value in the UPF.\nFor both modes of data collection, if there are multiple application sessions for the UE PDU session, the NWDAF aggregates (i.e. sums up) the data volume across all applications to obtain per UE information.\nTable 6.10.2-6: UE data volume dispersion collected from serving UPF\n\nThe task of the NWDAF is to calculate the volume of data and amount of transactions dispersed by the UE at each visited location during a period of interest. The entry time and exit time to a location is provided by the AMF.\nCollecting volume per UE and per specific application is optional and such information can be provided by the UPF or AF.\nThe Correlation Information as defined in table 6.2.4-1 is used to correlate the input data from AMF and SMF, the input data from SMF and UPF and the input data from UPF and AF.\n-\tSlice information related to UE transactions dispersion from NF(s) are defined in tables 6.10.2-7 and 6.10.2-8. This may include individual transactions or SMF/AMF state transition information stored as UE behaviour trends, which provides aggregated transaction information.\n-\tThe Slice data volume collection is the same as listed in tables 6.10.2-3 to 6.10.2-6.\nTable 6.10.2-7: Slice based UE transactions dispersion information collected from serving AMF\n\nTable 6.10.2-8: Slice based UE transactions dispersion information collected from serving SMF\n\nThe task of the NWDAF is to calculate the volume of data and amount of transactions dispersed by the UE at each slice during a period of interest. A time stamp of a slice assignment is provided by the AMF.\nThe Correlation Information as defined in table 6.2.4-1 is used to correlate the input data from AMF and SMF, the input data from SMF and UPF and the input data from UPF and AF.\nData collection may be provided on samples (e.g. spatial subsets of UEs or UE group, temporal subsets of UE location information).\nNOTE 2:\tHow the data from UPF is retrieved (subscribed to on UPF and notified then by UPF) is defined in clause 5.8.2.17 of TS 23.501 [2] and in clause 4.15.4 of TS 23.502 [3].\nNOTE 3: The list of monitored transactions (MM and SM messages) is a subset of the messages listed in clauses 8.2 and 8.3 of TS 24.501 [23].\nNOTE 4:\tThe Namf_EventExposure and Nsmf_EventExposure services in clauses 5.2.2.3 and 5.2.8.3 of TS 23.502 [3] provide the required transactions information.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.10.2-1: Location based UE transactions dispersion information collected from serving AMF",
                                    "table number": 59,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.2-2: UE transactions dispersion information collected from serving SMF",
                                    "table number": 60,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.2-3: UE Data volume dispersion information collected from the AF",
                                    "table number": 61,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.2-4: UE data volume dispersion collected from the AF",
                                    "table number": 62,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.2-5: UE data volume dispersion collected from serving UPF",
                                    "table number": 63,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.2-6: UE data volume dispersion collected from serving UPF",
                                    "table number": 64,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.2-7: Slice based UE transactions dispersion information collected from serving AMF",
                                    "table number": 65,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.2-8: Slice based UE transactions dispersion information collected from serving SMF",
                                    "table number": 66,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.10.3\tOutput Analytics",
                            "text_content": "The NWDAF provides UE dispersion analytics, which can be statistics and/or prediction for data volume and/or transactions dispersions, to consumer NFs or AFs.\nThe data volume dispersion analytics results provided by the NWDAF can be for a UE or group of UEs or \"any UE\" data volume dispersion statistics as defined in table 6.10.3.1-1 and/or UE data volume dispersion predictions as defined in table 6.10.3.1-2. If the analytics covers multiple UEs, the Data dispersed, Data ranking and Data percentile ranking parameters are calculated as the aggregated (i.e. summed up) data volume. When the Target of Analytics Reporting is set as \"any UE\" the data volume dispersion analytics results provided by the NWDAF can be for all UEs data volume dispersion statistics at a location and/or the slice and/or data volume dispersion predictions at a location and/or the slice.\nTable 6.10.3.1-1: Data volume dispersion statistics bound by location\n\nTable 6.10.3.1-2: Data volume dispersion prediction bound by location\n\nThe data volume dispersion analytics results provided by the NWDAF can also be for a UE or group of UEs or \"any UE\" data volume dispersion statistics at a given slice as defined in Table 6.10.3.1-3 and/or data volume dispersion predictions as defined in Table 6.10.3.1-4. If the analytics covers multiple UEs, the Data dispersed, Data ranking and Data percentile ranking parameters are calculated as the aggregated (i.e. summed up) data volume. When the Target of Analytics Reporting is set as \"any UE\" the data volume dispersion analytics results provided by the NWDAF can be for all UEs data volume dispersion statistics at a given slice and/or data volume dispersion predictions at a given slice.\nTable 6.10.3.1-3: Data volume dispersion statistics bound by slice\n\nTable 6.10.3.1-4: Data volume dispersion prediction bound by slice\n\nWhen the Target of Analytics Reporting is set as \"any UE\", no filter for Top-Heavy UEs, fixed, camper or traveller is included and the Analytics Filter Information is set to one or several S-NSSAIs and DDVA, the data volume dispersion analytics results provided by the NWDAF can be for all UEs data volume dispersion statistics at a given slice as defined in Table 6.10.3.1-5 and/or data volume dispersion predictions as defined in Table 6.10.3.1-6:\nTable 6.10.3.1-5: Data volume dispersion statistics bound by slice (for any UE)\n\nTable 6.10.3.1-6: Data volume dispersion prediction bound by slice (for any UE)\n\nNOTE:\tThe Application ID in the Data Volume Dispersion Analytics is optional. When the Application ID is missing, the Data Volume Dispersion Analytics is applied across all the applications in an AOI or a slice.\nThe transactions (MM and MS messages) dispersion analytics results provided by the NWDAF can be for a UE or group of UEs or \"any UE\" transactions dispersion statistics as defined in Table 6.10.3.2-1 and/or UE transactions dispersion predications as defined in Table 6.10.3.2-2. If the analytics covers multiple UEs, the Transactions dispersed, Transactions ranking and Transactions percentile ranking parameters are calculated as the aggregated (i.e. summed up) number of transactions. When the Target of Analytics Reporting is set as \"any UE\" the transaction dispersion analytics results provided by the NWDAF can be for all UEs transaction dispersion statistics at a location and/or the slice and/or transaction dispersion predictions at a location and/or the slice.\nTable 6.10.3.2-1: Transactions dispersion statistics bound by location\n\nTable 6.10.3.2-2: Transactions dispersion prediction bound by location\n\nThe transactions dispersion analytics results provided by the NWDAF can be UE or group of UEs or \"any UE\" transactions dispersion statistics at a given slice as defined in table 6.10.3.2-3 and/or transactions dispersion predictions as defined in table 6.10.1.4.2-4. If the analytics covers multiple UEs, the Transactions dispersed, Transactions ranking and Transactions percentile ranking parameters are calculated as the aggregated (i.e. summed up) number of transactions. When the Target of Analytics Reporting is set as \"any UE\" the transaction dispersion analytics results provided by the NWDAF can be for all UEs transaction dispersion statistics at a given slice and/or transaction dispersion predictions at a given slice.\nTable 6.10.3.2-3: Transactions dispersion statistics bound by slice\n\nTable 6.10.3.2-4: Transactions dispersion prediction bound by slice\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.10.3.1-1: Data volume dispersion statistics bound by location",
                                    "table number": 67,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.3.1-2: Data volume dispersion prediction bound by location",
                                    "table number": 68,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.3.1-3: Data volume dispersion statistics bound by slice",
                                    "table number": 69,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.3.1-4: Data volume dispersion prediction bound by slice",
                                    "table number": 70,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.3.1-5: Data volume dispersion statistics bound by slice (for any UE)",
                                    "table number": 71,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.3.1-6: Data volume dispersion prediction bound by slice (for any UE)",
                                    "table number": 72,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.3.2-1: Transactions dispersion statistics bound by location",
                                    "table number": 73,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.3.2-2: Transactions dispersion prediction bound by location",
                                    "table number": 74,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.3.2-3: Transactions dispersion statistics bound by slice",
                                    "table number": 75,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.3.2-4: Transactions dispersion prediction bound by slice",
                                    "table number": 76,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.10.4\tDispersion Analytic Procedure",
                            "text_content": "The NWDAF can provide Dispersion analytics, in the form of statistics or predictions, to an NF or AF.\nThe figure depicts a UE dispersion analytics dashboard, which provides insights into the distribution of users across different areas within a network. The dashboard includes various metrics such as the average distance between users, the number of users in each area, and the average distance between users and the base station (BS). This information can be used to optimize network coverage and improve user experience.\nFigure 6.10.4-1: UE Dispersion Analytics provided to an NF or AF\n1.\tThe NF sends a request or subscription to the NWDAF for dispersion analytics on a specific UE, any UE, or a group of UEs, using either the Nnwdaf_AnalyticsInfo or Nnwdaf_AnalyticsSubscription service. The NF can request statistics or predictions or both. The Analytics ID is set to \"UE Dispersion Analytics\", the Dispersion Analytic (DA) type is set to \"Data Volume Dispersion Analytics\" (DVDA) or \"Transactions Dispersion Analytics\" (TDA) and Analytic Filter Information = (Area of Interest, slice, target period, optional UE class: Top-Heavy, Fixed, or Camper UEs). The NF or AF provides the UE ID or Internal Group ID in the Target of Analytics Reporting.\n2.\tIf the request is authorized and in order to provide the requested analytics, the NWDAF may subscribe to events with all the serving AMFs, SMFs of the requested UE(s) for notification of location changes or a slice change (a slice change can be an additional slice or a deletion), or to obtain UE location trends, UE access behaviour trends and UE session behaviour trends. This step may be skipped when, e.g. the NWDAF already has the requested analytics available.\nThe NWDAF subscribes to application service data from AF(s) by invoking Naf_EventExposure_Subscribe service or Nnef_EventExposure_Subscribe (via NEF).\nThe NWDAF can collect data volume information from the UPF, as listed in tables 6.10.2-5 and 6.10.2-6 and clause 6.2.2.1. How the data from UPF is retrieved (subscribed to on UPF and notified then by UPF) is defined in clause 5.8.2.17 of TS 23.501 [2] and in clause 4.15.4 of TS 23.502 [3].\nNOTE:\tThe NWDAF determines the AMF serving the UE, any UE, or the group of UEs as described in clause 6.2.2.1.\n3.\tThe NWDAF derives requested analytics.\n4.\tThe NWDAF provides requested or subscribed UE dispersion analytics to the NF, using either the Nnwdaf_AnalyticsInfo_Request Response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1. The details for UE dispersion analytics provided by NWDAF are described in clause 6.10.3. The provided analytics enables the consumer to predict changing network conditions such as data volume change at a location or a slice, excessive signalling conditions at a location or a slice, etc.\n5-6. If at step 1, the NF has subscribed to receive notifications for UE dispersion analytics, after receiving event notification from the AMFs (e.g. location change) or SMFs (e.g. slice change add/delete) subscribed by NWDAF in step 2, the NWDAF may generate new dispersion analytics.\n7.\tThe NWDAF provides the newly generated dispersion analytics to the NF. The details for UE dispersion analytics provided by NWDAF are described in clause 6.10.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.11\tWLAN performance analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.11.1\tGeneral",
                            "text_content": "The NWDAF provides WLAN performance analytics to a service consumer NF. The analytics results are generated based on the data from other 5GC NFs and OAM. The analytics results, provided in the form of statistics or predictions, contain quality and performance of WLAN connection of UE according to UE location and SSID. The consumer can request either one-time or continuous reporting.\nThe service consumer may be an NF (e.g. PCF, NEF or AF).\nIf a service consumer is PCF, the WLAN performance analytics can be used to update WLANSP as defined in TS 23.503 [4].\nIf the service consumer is NEF or AF, the WLAN performance analytics per UE granularity can be used to select candidate members for an application layer operation.\nThe consumer of these analytics may indicate in the request or subscription:\n-\tAnalytics ID = \"WLAN performance\";\n-\tTarget of Analytics Reporting: a single UE (SUPI), a group of UEs (an Internal Group ID), or any UE;\n-\tAnalytics Filter Information:\n-\tArea of Interest (list of TA or Cells);\n-\tSSID(s);\n-\tBSSID(s); and\n-\toptional list of analytics subsets that are requested (see clause 6.11.3);\n-\tAn Analytics target period indicates the time period over which the statistics or prediction are requested, either in the past or in the future;\n-\tOptionally, Temporal granularity size;\n-\tOptional maximum number of objects;\n-\tPreferred level of accuracy of the analytics;\n-\tPreferred level of accuracy per analytics subset (see clause 6.11.3);\n-\tPreferred order of results for the list of WLAN performance information:\n-\tordering criterion: \"time slot start\", \"number of UEs\", \"RSSI\", \"RTT\" or \"Traffic information\"; and\n-\torder: ascending or descending; and\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\nIf the Target of Analytics Reporting is any UE, then the Analytics Filter should at least include Area of Interest or SSID(s) or BSSID(s).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.2\tInput Data",
                            "text_content": "For the purpose of generating WLAN performance analytics results, the NWDAF collects the data as listed in Table 6.11.2-1.\nTable 6.11.2-1: Data collected by NWDAF for WLAN performance analytics\n\nNOTE 1:\tWLAN Data from OAM is collected via MDT and aligned with the WLAN measurement reporting list described in clause 5.1.1.3.3 of TS 37.320 [20]. It is assumed that not all UEs support MDT WLAN measurements.\nNOTE 2:\tUE Location from OAM can be used to deduce WLAN location.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.11.2-1: Data collected by NWDAF for WLAN performance analytics",
                                    "table number": 77,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.11.3\tOutput Analytics",
                            "text_content": "The NWDAF generates WLAN performance analytics. Depending on the Analytics Target Period, the output consists of statistics or predictions. The detailed information provided by the NWDAF is defined in Table 6.11.3-1 for statistics and Table 6.11.3-2 for predictions.\nTable 6.11.3-1: WLAN performance statistics\n\nTable 6.11.3-2: WLAN performance predictions\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.11.3-1: WLAN performance statistics",
                                    "table number": 78,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.11.3-2: WLAN performance predictions",
                                    "table number": 79,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.11.4\tProcedures",
                            "text_content": "The figure depicts a step-by-step procedure for WLAN performance analytics, illustrating the process of analyzing WLAN performance. It includes a flowchart that outlines the steps, such as network monitoring, network analysis, and network optimization. The figure is essential for network administrators and engineers to understand the steps involved in analyzing and optimizing wireless network performance.\nFigure 6.11.4-1: Procedure for WLAN performance analytics\n1.\tThe consumer NF sends a request to the NWDAF for WLAN performance analytics using either the Nnwdaf_AnalyticsInfo or Nnwdaf_AnalyticsSubscription service. The Analytics ID is set to \"WLAN performance\", the Target of Analytics Reporting and the Analytics Filter Information are set according to clause 6.11.1. The consumer NF can request statistics or predictions.\nThe analytics can be requested with the filter information (e.g. Area of Interest or specific SSID(s)). When Area of Interest is provided, the analytics results include WLAN performance information of all SSID(s) located in the Area of Interest. When specific SSID(s) is provided, the analytics results include WLAN performance information of a specific UE or all UE(s) connected to the corresponding SSID(s).\n2-3.\tThe NWDAF subscribes to information related to PDU Session for WLAN (i.e. Access Type is Non-3GPP and RAT Type is TRUSTED_WLAN) from SMF.\n4.\tThe NWDAF collects WLAN measurement data for the period of analysis from the OAM, following the procedure captured in clause 6.2.3.2.\nNOTE:\tThe NWDAF collects the data from the UPF as listed in Table 6.11.2.1. How the NWDAF collects the data is defined in clause 5.8.2.17 of TS 23.501 [2] and in clause 4.15.4 of TS 23.502 [3].\n5.\tThe NWDAF derives requested analytics with the collected data. Analytics output parameters are listed in clause 6.11.3.\n6.\tThe NWDAF provides the requested analytics to the NF, using either the Nnwdaf_AnalyticsInfo or Nnwdaf_AnalyticsSubscription service, depending on the service used at step 1.\n7.\tIf the NF subscribed the analytics at step 1, the NWDAF provides a new analytics when it generated the new output.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.12\tSession Management Congestion Control Experience Analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.12.1\tGeneral",
                            "text_content": "According to the Session Management Congestion Control (SMCC) mechanisms, i.e. DNN based congestion control defined in clause 5.19.7.3 of TS 23.501 [2] and S-NSSAI based congestion control defined in clause 5.19.7.4 of TS 23.501 [2], the SMF that is applying or has applied the SMCC mechanism does not store any historical information related to which UEs is/was subject to backoff timer settings. Therefore, fairness to apply the SMCC cannot be considered nor guaranteed. For example, among UEs that use a PDU Session associated with S-NSSAI#1, some of them may have experienced the S-NSSAI based high level of congestion control (e.g. receiving NAS SM reject messages with a long backoff timer) while some of the UEs may have experienced the S-NSSAI based low level congestion control (e.g. receiving NAS SM reject messages with a short backoff timer), within a specific period. The backoff timer provided to each UE can vary, e.g. up to 70 hours.\nThe SMF service consumer may request the NWDAF to provide Session Management Congestion Control Experience (SMCCE) statistical analytics for a specific DNN and/or S-NSSAI. The SMF uses potential congestion condition as a trigger to request the SMCCE analytics from the NWDAF.\nThe request by the SMF includes mainly the following parameters:\n-\tAnalytics ID = \"Session Management Congestion Control Experience\".\n-\tTarget of Analytics Reporting: one or more SUPI(s).\nNOTE 1:\tThe UE(s) contained in the Target of Analytics Reporting. These are UE(s) that have the PDU Session for the DNN and/or S-NSSAI indicated by Analytics Filter Information.\n-\tAnalytics Filter Information:\n-\tDNN and/or S-NSSAI; and\n-\toptional list of analytics subsets that are requested (see clause 6.12.3);\n-\tAnalytics target period: the time window for which the statistics are requested.\nNOTE 2:\tPredictions are not provided as output for the Session Management Congestion Control Experience analytics.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.2\tInput Data",
                            "text_content": "For the purpose of SMCCE analytics, the NWDAF collects the data as listed in Table 6.12.2-1.\nTable 6.12.2-1: Data collected by NWDAF for SMCCE analytics\n\nAs described in Table 6.12.2-1, the NWDAF subscribes to the network data from SMF(s) by invoking Nsmf_EventExposure_Subscribe service (Event ID = Session Management Congestion Control Experience for PDU Session, Target of Event Reporting = one or more SUPI(s), Event Filter information = DNN and/or S-NSSAI and target period).\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.12.2-1: Data collected by NWDAF for SMCCE analytics",
                                    "table number": 80,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.12.3\tOutput Analytics",
                            "text_content": "The NWDAF outputs the SMCCE statistical analytics. The detailed statistical information provided by the NWDAF is defined in Table 6.12.3-1.\nTable 6.12.3-1: SMCCE statistics\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.12.3-1: SMCCE statistics",
                                    "table number": 81,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.12.4\tProcedures",
                            "text_content": "Figure 6.12.4-1 shows the procedure for Session Management Congestion Control Experience Analytics.\nThe figure depicts a procedure for Session Management Congestion Control Experience Analytics, which is a method used to analyze and optimize the performance of session management in a network. The figure shows a flowchart with various steps, such as identifying the root cause of congestion, implementing congestion control algorithms, and monitoring the performance of the system. The use of visual elements like arrows and boxes helps to clearly illustrate the steps and the flow of information.\nFigure 6.12.4-1: Procedure for Session Management Congestion Control Experience Analytics\n1.\tConsumer SMF requests or subscribes to analytics information for \"Session Management Congestion Control Experience\" from the NWDAF using either Nnwdaf_AnalyticsInfo or Nnwdaf_AnalyticsSubscription service when the SMF wants to take the analytics information into account for the Session Management Congestion Control to be applied.\nThe parameters included in the request are described in clause 6.12.1.\nNOTE:\tTo account for SMCCE analytics information, the SMF needs to request the analytics information from the NWDAF before applying Session Management Congestion Control due to potential congestion conditions formation.\n2.\tIf has not already subscribed, the NWDAF sends subscription requests to all the SMFs serving the DNN and/or S-NSSAI as indicated by Analytics Filter Information to collect data related to SMCCE. The SMF that made the request in step 1 can be also one of the data providers.\n3.\tThe SMF(s) provide the collected data to the NWDAF.\n4.\tThe NWDAF derives the requested analytics.\n5.\tThe NWDAF provides the analytics for Session Management Congestion Control Experience to the consumer SMF, using either Nnwdaf_AnalyticsInfo_Request Response or Nnwdaf_AnalyticsSubscription_Notify.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.13\tRedundant Transmission Experience related analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.13.1\tGeneral",
                            "text_content": "This clause describes the Redundant Transmission Experience related analytics. These analytics may be used as follows:\n-\tby the SMF to determine whether redundant transmission on N3/N9 interfaces (see clause 5.33.2.2 of TS 23.501 [2]) shall be performed, or (if it had been activated) shall be stopped;\n-\tby the PCF for the calculation of the Route Selection Components in a URSP Rule for redundant PDU Sessions as described in clause 5.33.2.1 of TS 23.501 [2].\nThe service consumer may be a NF (e.g. SMF, PCF).\nThe consumer of these analytics may indicate in the request:\n-\tAnalytics ID = \"Redundant Transmission Experience\".\n-\tTarget of Analytics Reporting: a single UE (SUPI), any UE, or a group of UEs (an Internal Group ID).\n-\tAnalytics Filter Information optionally containing:\n-\tArea of Interest;\n-\tS-NSSAI;\n-\tDNN;\n-\toptional list of analytics subsets that are requested (i.e. UL/DL packet drop rate GTP-U, UL/DL packet delay GTP-U, see clause 6.13.3).\n-\tAn Analytics target period indicates the time period over which the statistics or predictions are requested.\n-\tOptionally, Temporal granularity size;\n-\tPreferred level of accuracy of the analytics;\n-\tPreferred order of results for the list of Redundant Transmission Experience:\n-\tordering criterion: \"time slot start\"; and\n-\torder: ascending or descending;\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.2\tInput Data",
                            "text_content": "The NWDAF supporting data analytics on Redundant Transmission Experience shall be able to collect UE mobility information from OAM, MDAS/MDAF, 5GC and AFs and service data from AF, as described in clause 6.7.2.2. In addition, NWDAF shall be able to collect the information for PDU session which is established with redundant transmission from the SMF. UE mobility information is specified in Table 6.7.2.2-1 and service data from AF related to UE mobility in Table 6.7.2.2-2. In addition, the NWDAF shall be able to collect performance measurements on user data congestion as specified in Table 6.8.2-1 for user data congestion analytics.\nAdditionally, the NWDAF collects the following input (see Table 6.13.2-1 and Table 6.13.2-2) according to existing measurements defined in clause 5.33.3 QoS Monitoring to Assist URLLC Service of TS 23.501 [2]. The NWDAF also collects the input from MDAS/MDAF of the end to end latency analysis in Table 6.13.2-3, as defined in clause 8.4.2.4.3 of TS 28.104 [45].\nTable 6.13.2-1: Packet drop and/or packet delay measurement per QFI or GTP level\n\nTable 6.13.2-2: The information related to PDU Session established\n\nTable 6.13.2-3: Data collection from MDAS/MDAF of end-to-end latency analysis\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.13.2-1: Packet drop and/or packet delay measurement per QFI or GTP level",
                                    "table number": 82,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.13.2-2: The information related to PDU Session established",
                                    "table number": 83,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.13.2-3: Data collection from MDAS/MDAF of end-to-end latency analysis",
                                    "table number": 84,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.13.3\tOutput Analytics",
                            "text_content": "The NWDAF supporting data analytics on Redundant Transmission Experience shall be able to provide Redundant Transmission Experience analytics as defined in Table 6.13.3-1 and Table 6.13.3-2.\nTable 6.13.3-1: Redundant Transmission Experience statistics\n\nTable 6.13.3-2: Redundant Transmission Experience predictions\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.13.3-1: Redundant Transmission Experience statistics",
                                    "table number": 85,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.13.3-2: Redundant Transmission Experience predictions",
                                    "table number": 86,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.13.4\tProcedures",
                            "text_content": "Figure 6.13.4.1-1 shows the analytics procedure. The NWDAF can provide analytics, in the form of statistics or predictions or both.\nThe figure depicts a detailed representation of the redundant transmission experience analytics provided to an NF (Network Function Unit) in a 5G network. The analytics are crucial for ensuring reliable and efficient communication, as they analyze the performance of the network in terms of redundancy, latency, and packet loss. The figure includes various components such as the NF, the network, and the communication devices, highlighting the importance of these components in the overall network architecture.\nFigure 6.13.4.1-1: Redundant Transmission Experience analytics provided to an NF\n1.\tThe analytics consumer sends a request to the NWDAF for analytics on a specific UE, any UE, or a group of UEs, using either the Nnwdaf_AnalyticsInfo or Nnwdaf_AnalyticsSubscription service. The NF can request statistics or predictions or both. The type of analytics is set to Redundant Transmission Experience. The NF provides the UE id or Internal Group ID in the Target of Analytics Reporting. Analytics Filter Information optionally contains DNN, S-NSSAI, Area of Interest, etc.\n2.\tIf the request is authorized and in order to provide the requested analytics, the NWDAF may subscribe to events with all the serving AMFs for notification of location changes and may subscribe to events with SMFs serving PDU Session on URLLC service for notification of redundant transmission related information.\nThe NWDAF may subscribe the service data from AF(s) by invoking Naf_EventExposure_Subscribe service or Nnef_EventExposure_Subscribe (if via NEF).\nThe NWDAF collects UE mobility information and/or packet measurement information from OAM, following the procedure captured in clause 6.2.3.2. The NWDAF collects redundant transmission status from SMF.\nNOTE:\tThe NWDAF determines the AMF serving the UE, any UE, or the group of UEs as described in clause 6.2.2.1.\nThis step may be skipped when e.g. the NWDAF already has the requested analytics available.\n3.\tThe NWDAF derives requested analytics.\n4.\tThe NWDAF provide requested Redundant Transmission Experience analytics to the NF, using either the Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.\n5-7.\tIf at step 1, the NF has subscribed to receive notifications for Redundant Transmission Experience analytics, after receiving event notification from the AMFs, SMF, AFs and OAM subscribed by NWDAF in step 2, the NWDAF may generate new analytics and provide them to the NF.\nIf a service consumer is SMF, the Redundant Transmission Experience analytics can be used to make decision if that redundant transmission shall be performed or (if activated) shall be stopped regarding the PDU session for URLLC service.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.14\tDN Performance Analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.14.1\tGeneral",
                            "text_content": "This clause specifies how an NWDAF can provide DN Performance Analytics which provides analytics for user plane performance (i.e. average/maximum traffic rate, average/maximum packet delay, average packet loss rate) in the form of statistics or predictions to a service consumer.\nThe DN Performance Analytics may provide one or a combination of the following information:\n-\tUser plane performance analytics for a specific Edge Computing application for a UE, group of UEs, or any UE over a specific serving anchor UPF.\n-\tUser plane performance analytics for a specific Edge Computing application for a UE, group of UEs, or any UE over a specific DNAI.\n-\tUser plane performance analytics for a specific Edge Computing application for a UE, group of UEs, or any UE over a specific Edge Application Server Instance.\nThe service consumer may be an NF (e.g. SMF, PCF) or an AF.\nThe consumer of these analytics shall indicate in the request or subscription:\n-\tAnalytics ID = \"DN Performance\";\n-\tTarget of Analytics Reporting: one or more SUPI(s) or Internal Group Identifier(s), or \"any UE\";\n-\tAnalytics Filter Information as defined in table 6.14.1-1 and optionally a list of analytics subsets that are requested (see clause 6.14.3); and\n-\toptionally, a preferred level of accuracy of the analytics;\n-\toptionally, preferred level of accuracy per analytics subset (see clause 6.14.3);\n-\toptionally, preferred order of results for the list of Network Performance information:\n-\tordering criterion: one of the analytics subset (see clause 6.14.3);\n-\torder: ascending or descending;\n-\toptionally, Reporting Thresholds, which apply only for subscriptions and indicate conditions on the level to be reached for respective analytics subsets (see clause 6.14.3) in order to be notified by the NWDAF;\n-\toptionally, maximum number of objects and maximum number of SUPIs;\n-\tAn Analytics target period indicates the time period over which the statistics or predictions are requested; and\n-\tOptionally, Spatial granularity size and Temporal granularity size.\nTable 6.14.1-1: Analytics Filter Information related to DN Performance Analytics\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.14.1-1: Analytics Filter Information related to DN Performance Analytics",
                                    "table number": 87,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.14.2\tInput Data",
                            "text_content": "The data collected from the AF are defined in table 6.14.2-1\nTable 6.14.2-1: Performance Data from AF\n\nThe data collected by the SMF are described in table 6.4.2-2.\nThe NWDAF subscribes to network data as defined in clause 6.4.2.\nData may be collected from OAM as described in table 6.4.2-3 by using the services provided by OAM as described in clause 6.2.3.\nThe Event Filters for the service data collection from SMF, AMF and AF are defined in TS 23.502 [3].\nThe timestamps are provided by each NF to allow correlation of QoS and traffic KPIs. The clock reference is able to know the accuracy of the time and correlate the time series of the data retrieved from each NF.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.14.2-1: Performance Data from AF",
                                    "table number": 88,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.14.3\tOutput Analytics",
                            "text_content": "The DN performance analytics is shown in table 6.14.3-1 and table 6.14.3-2.\nTable 6.14.3-1: DN service performance statistics\n\nTable 6.14.3-2: DN service performance predictions\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.14.3-1: DN service performance statistics",
                                    "table number": 89,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.14.3-2: DN service performance predictions",
                                    "table number": 90,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.14.4\tProcedures to request DN Performance Analytics for an Application",
                            "text_content": "The figure depicts a procedure for NWDAF (Network Wide Data Analytics for Application Performance) providing DN (Data Network) performance analytics for an application. It illustrates the steps involved in analyzing DN performance, including data collection, data processing, and reporting. The figure is crucial for understanding the process and ensuring that the application's performance is optimized.\nFigure 6.14.4-1: Procedure for NWDAF providing DN Performance analytics for an Application\nThe procedure illustrated in figure 6.14.4-1 allows an analytics consumer to request Analytics ID \"DN Performance\" for a particular Application. The analytics consumer includes the Application ID for which DN Performance is requested. The consumer indicates the Target of Analytics Reporting (e.g. \"any UE\") and may include as Analytic Filter Information the UPF anchor ID, DNAI, or Application Server instance that DN performance analytics are requested.\n1.\tAnalytics consumer sends an Analytics request/subscribe (Analytics ID = DN Performance Target of Analytics Reporting, Analytics Filter Information = (Application ID, S-NSSAI, DNN, Area of Interest, UPF anchor ID, DNAI, Application Server Address(es)), Analytics Reporting Information = Analytics target period) to NWDAF by invoking a Nnwdaf_AnalyticsInfo_Request or a Nnwdaf_AnalyticsSubscription_Subscribe service.\n2a.\tNWDAF subscribes to the performance data from AF defined in table 6.14.2-1 by invoking Nnef_EventExposure_Subscribe or Naf_EventExposure_Subscribe service (Event ID = Performance Data, Application ID, Event Filter information), Target of Event Reporting = Any UE) as defined in TS 23.502 [3].\nNOTE 1:\tIn the case of trusted AF, NWDAF provides the Area of Interest as a list of TAIs to AF. In the case of untrusted AF, NEF translates the requested Area of Interest provided as event filter by NWDAF into geographic zone identifier(s) that act as event filter for AF.\n2b.\tNWDAF subscribes to the network data from 5GC NF(s) defined in table 6.4.2-2 by invoking Nnf_EventExposure_Subscribe service.\n2c.\tWith the collected data, the NWDAF estimates the DN Performance for the application.\n3.\tNWDAF provides the data analytics, to the analytics consumer by means of either Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.\nNOTE 2:\tFor simplicity, the call flow only shows a request-response model for the interaction of NWDAF and analytics consumer instead of both request-response model and subscription-notification model.\nIf the analytics consumer is an SMF, the SMF may use the analytics to determine the UPF and DNAI that offers the best user plane performance.\nIf the analytics consumer is an AF, the AF may use the analytics to determine the DNAI that has the best user plane performance if Application Server relocation is required.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.15\tVoid",
                    "description": "",
                    "summary": "",
                    "text_content": "\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.16\tPFD Determination Analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.16.1\tGeneral",
                            "text_content": "This clause specifies the procedure on how NWDAF can provide NWDAF-assisted PFD Determination analytics, in the form of statistics.\nTo assist determination of PFDs for known application identifiers, if the related Service Level Agreement does not preclude, an NWDAF may perform data analytics on existing PFD information and user plane traffic and provide analytics results in the form of new or updated PFDs, e.g. IP 3-tuple list in PFD is new or updated, to an analytics consumer in the 5GC. The NEF(PFDF) as the consumer may forward new or updated PFD information provided by the NWDAF to the UPF via the SMF to detect a known application, as defined in TS 23.502 [3].\nThe service consumer may be a NEF(PFDF).\nThe consumer of these analytics shall indicate in the request or subscription:\n-\tAnalytics ID = \" PFD Determination\";\n-\tTarget of Analytics Reporting: \"any UE\";\n-\tApplication identifier;\n-\tAnalytics Filter Information optionally containing:\n-\tS-NSSAI;\n-\tDNN;\n-\tAn Analytics target period indicates the time period over which the statistics are requested;\n-\tOptionally, the preferred level of accuracy on the PFD statistics;\n-\tOptionally, maximum number of objects. This refers to the analytic output (i.e. maximum number of new or updated PFDs);\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.16.2\tInput Data",
                            "text_content": "The NWDAF collects information on user data traffic from NF(s) for a specific S-NSSAI, DNN, Application ID and retrieves the existing PFDs from the NEF(PFDF). The detailed input data are described in Table 6.16.2-1.\nTable 6.16.2-1: Input data to detect known application from NFs\n\nNOTE:\tExtensive reporting of all traffic flows may conflict with the requirement to avoid extra UPF load. An NWDAF may subscribe only for reporting for some UEs to limit the load.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.16.2-1: Input data to detect known application from NFs",
                                    "table number": 91,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.16.3\tOutput Analytics",
                            "text_content": "The output analytics of NWDAF is defined in Table 6.16.3-1. The output analysis may be used to provision new or updated PFDs information for known applications. The NWDAF may assign a confidence to the PFD Determination statistics based on the input data provided by UPF.\nTable 6.16.3-1: PFD Determination statistics\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.16.3-1: PFD Determination statistics",
                                    "table number": 92,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.16.4\tProcedures",
                            "text_content": "Figure 6.16.4-1 shows the procedure that a consumer can use to request PFD Determination analytics.\nThe figure depicts a procedure for NWDAF-assisted PFD determination, which is a method used to evaluate the performance of a power distribution unit (PDU) in a power system. The figure shows a step-by-step process for analyzing the PFD data, including the use of NWDAF, which is a nonlinear dynamic analysis technique. The figure also includes a legend to help interpret the data and identify the different components of the PFD.\nFigure 6.16.4-1: A procedure for NWDAF-assisted PFD Determination\n1.\tThe Consumer NF (NEF(PFDF)) requests or subscribes to the NWDAF to request PFD Determination analytics for a known application identifier. The Target of Analytics Reporting is set to Any UE.\nThe Analytics Filter Information may optionally include the S-NSSAI and/or DNN.\n2.\tThe NWDAF fetches currently stored PFD information in use from UDR via NEF(PFDF) for the Application ID provided in step 1, as listed in Table 6.16.2-1.\n3.\tThe NWDAF collects information from the UPF (event \"UserDataUsageMeasures\") as listed in Table 6.16.2-1 either via SMF (Option 1) or directly from UPF (Option 2) as defined in clause 5.8.2.17 of TS 23.501 [2]. NWDAF discovers the SMF (Option 1) or UPF (Option 2) through NRF as defined in clause 4.15.4.5.3 of TS 23.502 [3]. The event \"UserDataUsageMeasures\" is defined in clause 5.2.26.2 of TS 23.502 [3], the subscription to the event may include an Application ID set to a value that allows the NWDAF to retrieve input information to derive PFD Determination Analytics for the Application ID that is provided by the consumer.\nNOTE:\tThe Application ID provided by the consumer and the Application ID provided to the UPF to retrieve input data for PFD Determination Analytics can be different ones.\n4.\tUPF reports the data directly to NWDAF.\n5.\tThe NWDAF derives PFD Determination analytics, e.g. new or updated PFD information for the existing Application ID. When the consumer provides the preferred level of accuracy, the NWDAF provides PFD Determination Analytics that reaches this level to the consumer.\n6.\tIn the case that PFD information for the existing Application ID is new or to be updated, the NWDAF notifies PFD Determination analytics to the consumer NF (i.e. NEF(PFDF)) with PFD Information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.17\tLocation Accuracy Analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.17.1\tGeneral",
                            "text_content": "This clause specifies how an NWDAF can provide Location Accuracy Analytics which provides analytics for LCS QoS accuracy to an analytics consumer such as LMF.\nWith different input data to NWDAF, the Location Accuracy Analytics provides one or a combination of the following information:\n-\twhen the input data is location:\n-\tlocation accuracy (i.e. Horizontal Accuracy (see clause 4.3.1 of TS 22.071 [35]) and optionally Vertical Accuracy (see clause 4.3.2 of TS 22.071 [35]) of applicable positioning method at indicated location;\n-\tIndication on whether a UE is indoor or outdoor when a location measurement is made (optional);\n-\tIndication on whether a UE location is measured with NLOS or LOS (optional);\n-\twhen the input data is area:\n-\taverage location accuracy (i.e. Horizontal Accuracy (see clause 4.3.1 of TS 22.071 [35]) and optionally Vertical Accuracy (see clause 4.3.2 of TS 22.071 [35]) of applicable positioning method at indicated area;\n-\tpercentage of indoor/outdoor measurement for an applicable area (optional);\n-\tpercentage of NLOS/LOS measurement for an applicable area (optional);\n-\trequested Confidence of location accuracy prediction (optional).\nThe consumer of these analytics shall indicate in the request or subscription:\n-\tAnalytics ID = \"Location Accuracy\";\n-\tTarget of Analytics Reporting: \"any UE\";\n-\tAnalytics Filter Information:\n-\tOptionally, the Positioning methods used as defined in clause 4.2b of TS 23.273 [39];\n-\tLocation information (horizontal and optional vertical); or\n-\tArea of Interest: restricts the scope of the LCS accuracy analytics to the provided area. The AOI is TA and/or cell list as defined in TS 23.502 [3]. Depends on the NWDAF consumer, there can be more than one AOIs in one request;\n-\tOptionally, the list of analytics subsets that are requested among those specified in clause 6.17.3;\n-\toptionally, a preferred level of accuracy of the analytics;\n-\toptionally, preferred level of accuracy per analytics subset (see clause 6.17.3);\n-\toptionally, Reporting Thresholds, which apply only for subscriptions and indicate conditions on the level to be reached for respective analytics subsets (see clause 6.17.3) in order to be notified by the NWDAF;\n-\toptionally, maximum number of objects; and\n-\tan Analytics target period indicates the time period over which the statistics or predictions are requested.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.2\tInput Data",
                            "text_content": "A training should be first performed with correlated positioning estimates obtained by two positioning methods, one of them (e.g. GPS information) used as ground truth to evaluate the accuracy of the other, see Table 6.17.2-1.\nTable 6.17.2-1: Data Collected by NWDAF for Location Accuracy Analytics\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.17.2-1: Data Collected by NWDAF for Location Accuracy Analytics",
                                    "table number": 93,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.17.3\tOutput Analytics",
                            "text_content": "The Location Accuracy analytics are shown in table 6.17.3-1.\nTable 6.17.3-1: Location Accuracy statistics\n\nTable 6.17.3-2: Location Accuracy predictions\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.17.3-1: Location Accuracy statistics",
                                    "table number": 94,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.17.3-2: Location Accuracy predictions",
                                    "table number": 95,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.17.4\tProcedures to request Location Accuracy Analytics",
                            "text_content": "The figure depicts a location accuracy analytics retrieval system, illustrating the process of retrieving location data from a database. The system utilizes a combination of machine learning algorithms and spatial data analysis techniques to accurately identify and retrieve location data. The figure includes a database, a search interface, and a visualization tool, allowing users to easily access and analyze location data.\nFigure 6.17.4-1: Location accuracy analytics retrieval\nPre-condition: NWDAF has a trained supervised ML model for predicting location accuracy. In the training phase, the NWDAF consumes input data as listed in listed in clause 6.17.2. To pretrain the ML model, NWDAF may collect input data based on area of interest (AoI). The AoI is determined by NWDAF.\n0-1.\tNWDAF collects UE IDs from AMF as defined in Table 6.17.2 via the AMF event exposure service with AoI as filtering criteria.\n0-2.\tNWDAF collects the UE location information using LCS (location estimate, Position Methods Used, Indoor/Outdoor indication, NLOS/LOS indication) as described in clause 6.2.12 and Table 6.17.2 with UE ID as filtering criteria.\n0-3.\tNWDAF collects ground truth UE location information and assistance information that relates to the positioning method from OAM.\n0-4.\tNWDAF prepares the analytics for statistics and/or pre-trains the ML model for prediction.\n1.\tThe Analytics consumer, e.g. LMF, requests from NWDAF location accuracy statistics or predictions, giving as inputs the corresponding Analytics ID and UE location estimate (in the form of horizontal and/or vertical location) or corresponding area (cell ID/TAI). The analytics request to the NWDAF may be a one time or a subscription request. Other inputs such as UE positioning method, applicable period can be assistance data.\nNOTE 1:\tIt is assumed that the analytics consumer determines a location. For instance, the LMF can be triggered by LCS client request to determine a location and then use location accuracy analytics to inquire the accuracy of the determined location.\nNOTE 2:\tBoth Nnwdaf_AnalyticsSubscription or Nnwdaf_AnalyticsInfo services can be used for step 1. above. The Nnwdaf_AnalyticsSubscription service can be used by a service consumer to receive notifications about location accuracy, e.g. when a change is detected.\n2.\tThe NWDAF uses the trained ML model and provides the location accuracy as output to the analytics consumer.\nNOTE 3:\tThe NWDAF can derive the accuracy based on the model without further input data.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.18\tEnd-to-end data volume transfer time analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.18.1\tGeneral",
                            "text_content": "Clause 6.18 describes how NWDAF can provide E2E data volume transfer time analytics, in the form of statistics or predictions or both, to a service consumer. NWDAF collects E2E data volume transfer time related input data from 5GC NFs, OAM and AF. The consumer can either subscribe to analytics notifications (i.e. a Subscribe-Notify model) or request a single notification (i.e. a Request-Response model).\nThe E2E data volume transfer time refers to a time delay for completing the transmission of a specific data volume from UE to AF, or from AF to UE. If a target repetition number of data transmissions or a target time interval between data transmissions is given, the E2E data volume transfer time can be provided as an average value of the data volume transfer times within the Analytics target period. The E2E data volume transfer time analytics may be used to assist an AF or NEF with AI/ML-based services, e.g. for member UE selection of federated learning.\nThe E2E data volume transfer time analytics may be provided as defined in clause 6.18.3 for a single UE or a list of UEs.\nMore than one E2E data volume transfer time classes might be assigned by operator or AF to a list of UEs. The UEs might be classified into high-, medium- and low-transfer time classes with respect to the threshold(s) of the corresponding class.\nThe service consumer may be an NF (e.g. AF, or NEF).\nThe consumer of these analytics indicates in the request or subscription:\n-\tAnalytics ID = \"E2E data volume transfer time \".\n-\tTarget of Analytics Reporting: a single UE (SUPI/GPSI) or a group of UEs (a list of SUPIs/GPSIs).\n-\tAnalytics Filter Information, including:\n-\tOptionally, DNN;\n-\tOptionally, S-NSSAI;\n-\tOptionally, Application ID;\n-\tOptionally, Area of Interest (AOI(s)): restricts the scope of the E2E data volume transfer time analytics to the provided area;\n-\tOptionally, a list of analytics subsets that are requested (see clause 6.18.3);\n-\tQoS requirements (e.g. 5QI, QoS Characteristics);\n-\tOptionally, either a target number of repeating data transmissions or a target time interval between data transmissions within the Analytics target period;\n-\tData Volume UL/DL: indicates a specific data volume transmitted once from UE to AF and/or from AF to UE;\n-\tA request for geographical distribution (i.e. the AoIs) of the UEs.\nAn Analytics target period indicates the time period over which the statistics or predictions are requested.\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\n-\tOptionally, preferred level of accuracy of the analytics.\n-\tOptionally, preferred level of accuracy per analytics subset (see clause 6.18.3).\n-\tOptionally, preferred order of results for the list of E2E data volume transfer time:\n-\tordering criterion: \"E2E data volume transfer time\",\n-\torder: ascending or descending.\n-\tOptionally, Reporting Thresholds, which apply only for subscriptions and indicate conditions on the levels to be reached for the respective analytics subsets (see clause 6.18.3)\n-\tOptionally, maximum number of UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.18.2\tInput Data",
                            "text_content": "The NWDAF supporting analytics on E2E data volume transfer time shall be able to collect information from AF, OAM and 5GC NFs.\nThe information collected by the NWDAF from the OAM is defined in the Table 6.18.2-1, from relevant 5GC NFs (i.e. UPF, SMF, AMF) is defined in Table 6.18.2-2 and from AF is defined in Table 6.18.2-3.\nTable 6.18.2-1: Input data from OAM related to E2E data volume transfer time\n\nNOTE 1:\tThe inclusion of the following OAM inputs: per UE RAN part delay and per UE Average UL/DL packet delay between UPF and UE, is subject to SA WG5 work.\nNWDAF subscribes to the input data from OAM as defined in the Table 6.18.2-1 by using the services provided by OAM as described in clause 6.2.3.\nNOTE 2:\tWhether the UE(s) is supporting a Slice or not can be checked by retrieving the registered AMF details from UDM or by asking AMF about what Slice is used by the UE(s) at the current registration (Alternatively, if NSACF is deployed, NSACF can provide a report on what slices are used by the UE(s)).\nNOTE 3:\tUser consent checking from UDM can apply to these analytics.\nTable 6.18.2-2: Service Data from 5GC NFs for E2E data volume transfer time analytics\n\nTable 6.18.2-3: Service Data from AF for E2E data volume transfer time analytics\n\nNOTE 3:\tHow to derive the time delay for sending a specific data volume between UPF and AF on N6 interface is out of scope of the present specification.\nFor calculation of the E2E data volume transfer time, the NWDAF uses mainly the Data Volume DL/UL provided by the analytics consumer (see clause 6.18.1) and the Average DL/UL UE throughput in gNB of the NG-RAN serving the UE or in the AoI (if an AoI is provided by the analytics consumer). Per UE input parameters if available may also be taken into account by the NWDAF.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.18.2-1: Input data from OAM related to E2E data volume transfer time",
                                    "table number": 96,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.18.2-2: Service Data from 5GC NFs for E2E data volume transfer time analytics",
                                    "table number": 97,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.18.2-3: Service Data from AF for E2E data volume transfer time analytics",
                                    "table number": 98,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.18.3\tOutput Analytics",
                            "text_content": "The NWDAF supporting E2E data volume transfer time analytics provides the analytics results to consumer NFs, e.g. AF, or NEF. The analytics results provided by the NWDAF could be E2E data volume transfer time statistics as defined in Table 6.18.3-1 or predictions as defined in table 6.18.3-2.\nTable 6.18.3-1: E2E data volume transfer time statistics\n\nTable 6.18.3-2: E2E data volume transfer time predictions\n\nNOTE:\tWhen Target of Analytics Reporting is an individual UE, one UE ID (i.e. SUPI) will be included, the NWDAF will provide the analytics transfer time result (i.e. list of (predicted) time slots) to NF service consumer(s) for the UE.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.18.3-1: E2E data volume transfer time statistics",
                                    "table number": 99,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.18.3-2: E2E data volume transfer time predictions",
                                    "table number": 100,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.18.4\tProcedures",
                            "text_content": "The NWDAF may provide E2E data volume transfer time analytics to a 5GC NF (e.g. AF, or NEF).\nThe figure depicts a procedure for E2E data volume transfer time analytics, illustrating the steps involved in analyzing the time it takes for data to travel from source to destination. The figure includes a flow chart with arrows indicating the sequence of steps, such as data collection, data processing, and data analysis. The use of color-coded arrows and labels helps to visually represent the different stages of the process, making it easier to understand and follow. The figure is a valuable tool for understanding the complexity of data transfer time analytics and can be used in various industries to optimize data transfer processes.\nFigure 6.18.4-1: Procedure for E2E data volume transfer time analytics\n1.\tThe Consumer NF, e.g. AF or NEF, requests or subscribes to analytics for E2E data volume transfer time analytics from NWDAF (possibly via NEF in case the consumer NF is an untrusted AF) and provides the input information as specified in clause 6.18.1 to 5GC.\n2a-b.\tThe NWDAF subscribes the service data from AMF in Table 6.18.2-2 using Namf_EventExposure_Subscribe service for collecting UE location(s) for a UE or a group of UEs.\nNOTE:\tIf NWDAF requires UE location information with finer granularity than TA/cell level, then NWDAF collects the location data from GMLC instead of AMF.\n2c.\tNWDAF subscribes to service data from SMF in Table 6.18.2-2 by invoking Nsmf_EventExposure_Subscribe (Event ID, SUPI(s) or Application ID).\nIn order to provide the requested analytics, the NWDAF subscribes to information of the UE and may subscribe to N4 Session related input data from SMFs as defined in Table 6.18.2-2.\n2d-e.\tN4 related input data is provided by UPF to SMF.\n2f.\tSMF provides the requested input data to NWDAF.\n2g-h.\tThe NWDAF may subscribe to the input data from the OAM as defined in the Table 6.18.2-1 according to the data collection principles described in clause 6.2.3.\n2i-j.\tThe NWDAF may subscribe to the service data from as defined AF in the Table 6.18-3 by invoking Nnef_EventExposure_Subscribe or Naf_EventExposure_Subscribe (Event ID = E2E data volume transfer time information, Application ID, Event Filter information, Target of Event Reporting = UE ID(s)) service as defined in TS 23.502 [3].\n3.\tThe NWDAF derives the requested analytics, in the form of E2E data volume transfer time statistics and/or predictions.\n4.\tThe NWDAF provides the requested E2E data volume transfer time analytics to the consumer NF, using either Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.\n5-7.\tIf the consumer NF subscribed to E2E data volume transfer time analytics in step 1, once the NWDAF generates new analytics for E2E data volume transfer time, it provides a notification using Nnwdaf_AnalyticsSubscription_Notify to the Consumer NF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.19\tRelative Proximity Analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.19.1\tGeneral",
                            "text_content": "Relative Proximity Analytics among UEs provided by NWDAF can be used to assist a consumer NF to more accurately localize a cluster (or a set) of UEs via provisioning statistics or prediction information related to their relative proximity. This analytics type may help the consumer improve the location estimation accuracy of a UE by using proximity information from nearby UEs, or it may help the consumer identify UEs in the vicinity of another UE. Relative proximity information can also be leveraged by NWDAF to provide location information with finer granularity than TA/cell.\nThe NWDAF provides relativity proximity analytics to a NF (e.g. NEF or AF).\nThe consumer of these analytics shall indicate in the request or subscription:\n-\tAnalytics ID = \"Relative Proximity\";\n-\tTarget of Analytics Reporting: a UE, a group of UEs;\n-\tAnalytics Filter Information:\n-\toptionally, S-NSSAI and/or DNN\n-\tan optional Area of Interest;\n-\tan optional individual or set of direction(s) of interest;\n-\tan optional number of UEs to be accounted for relative proximity (i.e. the number of UEs for which one UE may report proximity information);\n-\toptionally, one or several attributes to be accounted for relative proximity (i.e. additional information that can be provided in addition to distance between two UEs): velocity, average speed, orientation, mobility trajectory;\n-\tOptionally, the list of analytics subsets that are requested among those specified in clause 6.19.3;\n-\tOptionally, preferred level of accuracy of the analytics;\n-\tOptionally, preferred level of accuracy per analytics subset (see clause 6.19.3);\n-\tOptionally, \"maximum number of objects\" indicating the maximum number of UEs\n-\tAn Analytics target period indicating the time period over which the statistics or predictions are requested.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.19.2\tInput data",
                            "text_content": "The detailed input data collected by the NWDAF for relative proximity analytics is listed in Table 6.19.2-1, Table 6.19.2-2 and Table 6.19.2-3.\nTable 6.19.2-1: OAM input data for relative proximity analytics\n\nNOTE 1:\tTo collect the input data in Table 6.19.2-1, NWDAF can invoke TraceJob with the UE ID (e.g. SUPI) of the UE as described in clause 4.3.30 of TS 28.622 [41] using Generic Provisioning Management Service as described in clause 11.1 of TS 28.532 [6] to get Sensor Information as part of MDT data collection mechanism. The UE sensor information includes Barometric pressure, UE speed and UE orientation as described in clause 5.10.29 of TS 32.422 [42].\nTable 6.19.2-2: Proximity related input data collected via DCAF/NEF\n\nNOTE 2:\tThe list of UE IDs that fulfil a proximity criterion can be determined by NWDAF based on the input information collected from the UE application via DCAF. The UE does not need to determine proximity information related to other UEs.\nNOTE 3:\tWhen DCAF is deployed in untrusted domain, NEF is employed to mediate the interactions between NWDAF and DCAF via the Naf_EventExposure_Subscribe service specified in clause 5.2.19.2 of TS 23.502 [3], as described in clause 6.2.8.2.3.\nTable 6.19.2-3: Proximity related input data from 5GC/AF\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.19.2-1: OAM input data for relative proximity analytics",
                                    "table number": 101,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.19.2-2: Proximity related input data collected via DCAF/NEF",
                                    "table number": 102,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.19.2-3: Proximity related input data from 5GC/AF",
                                    "table number": 103,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.19.3\tOutput analytics",
                            "text_content": "The NWDAF services as defined in the clause 7.2 and 7.3 are used to expose the analytics.\n-\tRelative proximity statistics information is defined in Table 6.19.3-1.\n-\tRelative proximity predictions information is defined in Table 6.19.3-2.\nTable 6.19.3-1: Relative proximity statistics\n\nTable 6.19.3-2: Relative proximity predictions\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.19.3-1: Relative proximity statistics",
                                    "table number": 104,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.19.3-2: Relative proximity predictions",
                                    "table number": 105,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.19.4\tProcedures",
                            "text_content": "The figure depicts a procedure for NWDAF (Near-Wall Data Analytics) providing relative proximity analytics. It illustrates the steps involved in analyzing the proximity of objects to a wall, which is crucial for various applications such as security, surveillance, and energy management. The figure includes a schematic representation of the system components, such as sensors, data processing units, and communication links, as well as a flowchart to guide the process. The NWDAF system is designed to provide real-time analytics, enabling efficient decision-making and improving overall system performance.\nFigure 6.19.4-1: Procedure for NWDAF providing relative proximity analytics\nFigure 6.19.4-1 shows the procedure for NWDAF to derive relative proximity analytics. The steps are described as follows:\n1.\tThe Consumer NF/AF sends a request to the NWDAF for analytics related to relative proximity, using either the Nnwdaf_AnalyticsInfo or Nnwdaf_AnalyticsSubscription service.\nThe Analytics ID is set to \"Relative Proximity\". The target for analytics reporting can be a single UE, group of UEs or any UE. Analytic filters may be provided as shown in clause 6.19.1.\nThe Consumer NF/AF can request statistics or predictions or both for a given Analytics target period.\n2-5.\tIf the request is authorized and in order to provide the requested analytics, the NWDAF may subscribe to OAM services to retrieve relevant information to proximity analytics. The NWDAF may collect MDT input data per individual UE from OAM as defined in Table 6.19.2-1.\n6-7.\tFor relative proximity information, if the request is authorized and in order to provide the requested analytics, NWDAF may follow the UE Input Data Collection Procedure via the DCAF. DCAF may collect proximity related input data directly from the UE Application, for NWDAF to determine a list of UEs fulfilling certain proximity criterion.\nNOTE 1:\tThe UE data collection procedure should be based on clause 6.2.8.\nNOTE 2:\tDifferent Application IDs of the same DCAF or different DCAFs may be selected for different UEs, since each DCAF can only collect the proximity information for the UEs that have PDU session between UE and DCAF.\nThe NWDAF subscribes to the AF services as above invoking either Nnef_EventExposure_Subscribe for untrusted DCAF or Naf_EventExposure_Subscribe service for trusted DCAF with (Event ID = Relative Proximity, Event Filter information, Target of Event Reporting). The target of event reporting and / or Event Filter information is set according to the target of analytics reporting and / or analytics filters set during the step 1 of the procedure.\nEvent filters can be defined for relative proximity to indicate to NWDAF on how to process the data from individual UEs to determine the set of UEs to be accounted for relative proximity.\nIn the case of a trusted DCAF, the NWDAF may provide the Area of Interest, proximity range, predefined geographical area, or other criteria to the DCAF on the resolution of TAIs or any other finer resolution recognizable by the 5GC. In the case of an untrusted DCAF, NEF translates the requested criteria provided as event filter by the NWDAF into geographic zone identifier(s) or other geographic range identifier(s) or geographic direction identifier(s) that act as event filter(s) for the DCAF.\nThe DCAF may collect the data from individual UEs based on Event Filters indicated by the NWDAF to determine the set of UEs to be accounted for relative proximity before notifying that directly (for trusted DCAF) or via NEF (for untrusted DCAF) to the NWDAF. Input data that may be collected from DCAF can be found in Table 6.19.2-2.\nNOTE 3:\tDetails of DCAF and its data processing can be found in TS 26.531 [32] and TS 26.532 [43]].\n8.\tThe NWDAF collects input data from AMF as defined in Table 6.19.2-3 via the AMF event exposure service as defined in TS 23.502 [3].\nNOTE 4:\tStep 8 could be performed before step 6 when DCAF cannot determine the set of UEs fulfilling a proximity criterion.\n9.\tThe NWDAF collects input data from GMLC as defined in Table 6.19.2-3 using the Ngmlc_Location service as defined in TS 23.273 [39] and TS 29.515 [48].\n10.\tThe NWDAF collects input data from AF as defined in Table 6.19.2-3 via the AF event exposure service as defined in TS 23.502 [3].\n11.\tThe NWDAF derives requested analytics.\n12.\tThe NWDAF provides requested relative proximity and TTC information as defined in Table 6.19.3-1 and Table 6.19.3-2 to the consumer NF or AF along with the corresponding Validity Period or any Validity Area, Validity Direction of interest or ranging distance, using either the Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Subscribe response, depending on the service used in step 1.\n13-15.\tIf at step 1 the consumer NF or AF has subscribed to receive continuous reporting of relative proximity information, the NWDAF may generate new analytics and, when relevant according to the Analytics target period and Reporting Threshold, provide them along with the corresponding Validity Period (or any Validity Area, Validity Direction of interest or ranging distance) to the consumer NF or AF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.20\tPDU Session traffic analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.20.1\tGeneral",
                            "text_content": "This clause specifies the procedure for an NWDAF to provide statistics on whether traffic of UEs via one or multiple PDU sessions is according to the information provide by the service consumer.\nThe NWDAF collects traffic flow information of UE traffic via PDU session(s) established for a specific S-NSSAI and/or DNN and provides statistics of UEs that route traffic according to the information provided by the service consumer (e.g., Traffic Descriptor, S-NSSAI, DNN) and UEs that route traffic which is not expected according to the information provided by the service consumer (e.g., Traffic Descriptor, S-NSSAI, DNN).\nThe assumption is that Traffic Descriptors are known (e.g. known flow description), so that there are associated Packet Detection Rule(s) for the known traffic configured in the UPF.\nNOTE 1:\tHow traffic from different applications over the same S-NSSAI/DNN and/or PDU session is discerned is implementation-specific.\nThe service consumer may be a PCF.\nThe consumer of these analytics includes in the request:\n-\tAnalytics ID = \"PDU Session traffic\".\n-\tTarget of Analytics Reporting: a SUPI or a list of SUPIs or an Internal-Group-Id or any UE.\n-\tTraffic Descriptor: Application Identifier, IP Descriptions or Domain Descriptors are applicable.\nNOTE 2:\tThe Application Id provided by the consumer is known by the network, i.e. corresponds to an Application Id known at the UPF.\n-\tAnalytics Filter Information containing:\n-\tArea of Interest (i.e. the location of UEs where PDU Session traffic is monitored);\n-\tS-NSSAI;\n-\tDNN;\n-\tan optional list of analytics subsets that are requested (see clause 6.20.3);\n-\tOptionally, preferred level of accuracy of the analytics.\n-\tOptionally, preferred level of accuracy per analytics subset (see clause 6.20.3);\n-\tAn Analytics target period indicates the time period over which the analytics are requested.\n-\tOptionally, maximum number of objects.\n-\tIn a subscription, the Notification Correlation Id and the Notification Target Address are included.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.20.2\tInput Data",
                            "text_content": "NWDAF collects input data from the SMF and/or UPF. The detailed data are described in Table 6.20.2-1.\nTable 6.20.2-1: Collected PDU Session User Plane Traffic Information\n\nNOTE:\tCare needs to be taken with regards to load and major signalling caused when requesting Any UE. This could be achieved via utilization of some event filters (e.g. Area of Interest), a specific DNN, S-NSSAI or sampling ratio as part of Event Reporting Information.\nThe NWDAF collects input data from the UPF either indirectly via the SMF, or directly from the UPF using the \"UserDataUsageMeasures\" event exposure event as described in clause 4.15.4.5 of TS 23.502 [3]. Further details about input parameters are described in Table 4.15.4.5.1 of TS 23.502 [3].\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.20.2-1: Collected PDU Session User Plane Traffic Information",
                                    "table number": 106,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.20.3\tOutput Analytics",
                            "text_content": "The NWDAF collects input data from the UPF, via SMF when the request is for a UE or a group of UEs or directly from the UPF when possible (see clause 5.8.2.17 of TS 23.501 [2]) if the request applies for any UE and NWDAF provides analytics of UEs about the traffic they route over a PDU session of specific S-NSSAI/DNN according to the Traffic Descriptor provided by the consumer and traffic they route over a PDU Session that is not according to the Traffic Descriptor provided by the consumer and information about that traffic.\nThe output analytics is shown in Table 6.20.3-1.\nTable 6.20.3-1: PDU Session traffic statistics\n\nNOTE:\tPredictions are not provided.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.20.3-1: PDU Session traffic statistics",
                                    "table number": 107,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.20.4\tProcedures",
                            "text_content": "The procedure for deriving PDU Session traffic is shown below.\nThe figure depicts a network-wide data analytics solution, NWDAF, which provides session traffic analytics for PDU sessions. It illustrates the data flow and analytics capabilities of NWDAF, which is designed to analyze and optimize network performance.\nFigure 6.20.4-1: NWDAF providing PDU Session traffic analytics\n1.\tThe Consumer NF (e.g. the PCF) requests or subscribes to the NWDAF to request PDU Session Traffic analytics. The consumer includes within analytics filter the expected traffic via a PDU session according to the Traffic Descriptors and the SUPI or list of SUPIs, the S-NSSAI and DNN of the PDU session. It is assumed that there are associated Packet Detection Rule(s) for the expected traffic listed in the analytics request, i.e. the expected traffic is known.\n2.\tThe NWDAF determines to collect data, either directly from the UPF or indirectly via the SMF and identifies the SMF(s) and/or UPF(s) to retrieve input data according to the S-NSSAI/DNN and SUPI or list of SUPIs in the analytics request.\n3.\tThe NWDAF collects input information using the procedure for subscription to UPF event exposure for certain UEs via SMF as described in clause 4.15.4.5.2 of TS 23.502 [3]; the Target of Event Reporting is set to each of the tuple (SUPI, DNN and S-NSSAI) that has a PDU Session in the same SMF, the Target Subscription Information is set to \"UserDataUsageMeasures\", the Target service data flows is absent to indicate that the UPF reports any detected service data flow in the PDU Session.\nThe UPF reports volume measurements for the PDU Session with per application granularity, the report includes volume measurements and provide the application related information, i.e. URLs and Domain names.\n4.\tThe NWDAF derives analytics indicating a list of UEs and the traffic they route according to the provided information provided by the consumer (i.e. Traffic Descriptor, S-NSSAI and DNN), including its volume and the traffic they route and a list of UEs which route traffic that it is not expected according to the information provided by the consumer (i.e. Traffic Descriptor, S-NSSAI and DNN) including its volume.\n5.\tThe NWDAF notifies URSP enforcement analytics.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.21\tMovement Behaviour Analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.21.1\tGeneral",
                            "text_content": "The movement behaviour analytics provides analytics information (statistics or predictions) regarding e.g. the number, direction and velocity of UEs during an analytics target period in a target area. The analytics of movement behaviour requires to collect UE movements in a certain region in a certain period of time. In addition, the consumers can further derive the congestion situation in the target area through analytics.\nThe NWDAF provides movement behaviour analytics to a NF (e.g. NEF, AF).\nThe consumer of these analytics shall indicate in the request or subscription:\n-\tAnalytics ID = \"movement behaviour\";\n-\tTarget of Analytics Reporting: any UE;\n-\tAnalytics Filter Information:\n-\tArea of Interest (AOI): restricts the scope of the movement behaviour analytics to the provided area. The AOI may be described as shown in clause 5.5 of TS 23.273 [39];\n-\tOptionally, the list of analytics subsets that are requested among those specified in clause 6.21.3;\n-\tAn Analytics target period indicates the time period over which the statistics or predictions are requested;\n-\tOptionally, preferred level of accuracy of the analytics;\n-\tOptionally, preferred level of accuracy per analytics subset (see clause 6.21.3);\n-\tOptionally, preferred granularity of location information: \"longitude and latitude level\";\n-\tOptionally, preferred orientation of location information: (\"horizontal\", \"vertical\", \"both\")\"; and\n-\tOptionally, maximum number of objects.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.2\tInput data",
                            "text_content": "The NWDAF collects the UE location and velocity information within the area of interest from the sources listed in Table 6.21.2-1.\nTable 6.21.2-1: Data collection by NWDAF for \"movement behaviour\" analytics\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.21.2-1: Data collection by NWDAF for \"movement behaviour\" analytics",
                                    "table number": 108,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.21.3\tOutput analytics",
                            "text_content": "The output for analytics of movement behaviour provided by NWDAF is defined in Table 6.21.3-1 and Table 6.21.3-2.\nTable 6.21.3-1: movement behaviour statistics\n\nTable 6.21.3-2: movement behaviour predictions\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.21.3-1: movement behaviour statistics",
                                    "table number": 109,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.21.3-2: movement behaviour predictions",
                                    "table number": 110,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.21.4\tProcedures",
                            "text_content": "Figure 6.21.4-1 depicts the procedure for movement behaviour analytics provided by NWDAF.\nThe figure depicts a complex network of nodes and links, illustrating the movement behavior of data packets in a wireless communication system. The analysis provided by NWDAF (Network Wide Data Analytics Framework) reveals insights into the network's performance, identifying areas of improvement and potential bottlenecks.\nFigure 6.21.4-1: \"Movement Behaviour\" analytics provided by NWDAF\n1.\tThe NWDAF receives an analytics request from the NWDAF service consumer (as defined in clause 6.1.1.1) or from an AF via NEF (as defined in clause 6.1.1.2) to request movement behaviour analytics within a target area for any UE.\nThe Analytics ID is set to \"Movement Behaviour\". The target for analytics reporting is set to be any UE. Analytic filters may be provided as shown in clause 6.21.1. The Area of Interest is the target area that may be defined as a geographical area or as a geopolitical name of an area, in such case, the NEF will translate it as the identities of one or more radio cells or tracking areas.\nThe NWDAF service consumer NF can request statistics or predictions or both for a given Analytics target period.\n2.\tThe NWDAF collects input data from AMF as defined in Table 6.21.2-1 via the AMF event exposure service.\nThe collected UE location information from AMF is optional and may assist in the statistics/prediction of UE moving direction and speed in step 4.\n3.\tThe NWDAF collects the UE location information using LCS as defined in Table 6.21.2-1 and clause 6.2.12.\nBased on the analytics target period, the NWDAF may trigger the immediate 5GC-MT-LR procedure as defined in clause 6.1.2 or the deferred 5GC-MT-LR procedure in clause 6.3.1 of TS 23.273 [39] to obtain UE's location information.\n4.\tThe NWDAF derives requested analytics.\n5.\tThe NWDAF provides the analytics as defined in Table 6.21.3-1 and Table 6.21.3-2 using either the Nnwdaf_AnalyticsInfo_Request response or Nnwdaf_AnalyticsSubscription_Notify, depending on the service used in step 1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tNnwdaf Services Description",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 7.1-1 illustrates the NWDAF Services.\nTable 7.1-1: NF services provided by NWDAF\n\nTable 7.1-2 shows the analytics information provided by NWDAF service.\nTable 7.1-2: Analytics information provided by NWDAF\n\n",
                    "tables": [
                        {
                            "description": "Table 7.1-1: NF services provided by NWDAF",
                            "table number": 111,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "Table 7.1-2: Analytics information provided by NWDAF",
                            "table number": 112,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tNnwdaf_AnalyticsSubscription Service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.2.1\tGeneral",
                            "text_content": "Service Description: This service enables the consumer to subscribe/unsubscribe for network data analytics and optionally its corresponding analytics accuracy information.\nWhen the subscription for network data analytics and optionally analytics accuracy information is accepted by the NWDAF containing AnLF, the consumer receives from the NWDAF an identifier (Subscription Correlation ID) allowing to further manage (modify, delete) this subscription. The modification of Analytics and optionally analytics accuracy information subscription can be enforced by NWDAF based on operator policy and configuration.\nThis service also enables the consumer to transfer analytics subscriptions to another NWDAF using the Nnwdaf_AnalyticsSubscription_Transfer service operation. Using this service operation, a consumer can request to the NWDAF to prepare for or take over analytics subscription(s), indicating also if and where analytics context is available.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.2\tNnwdaf_AnalyticsSubscription_Subscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_AnalyticsSubscription_Subscribe.\nDescription: Subscribes to NWDAF analytics and optionally analytics accuracy information with specific parameters.\nInputs, Required:\n-\t(Set of) Analytics ID(s) as defined in Table 7.1-2;\n-\tTarget of Analytics Reporting;\n-\tNotification Target Address (+ Notification Correlation ID);\n-\tAnalytics Reporting Parameters (including Analytics target period, etc.).\nNOTE 1:\tTarget of Analytics Reporting can be provided per individual Analytics ID.\nInputs, Optional:\n-\tAnalytics Filter Information;\n-\tTime window for historical analytics;\n-\tSubscription Correlation ID (in the case of modification of the analytics subscription);\n-\tPreferred level of accuracy of the analytics;\n-\tPreferred level of accuracy per analytics subset;\n-\tReporting Thresholds;\n-\tMaximum number of objects requested (max);\n-\tPreferred order of results;\n-\tMaximum number of SUPIs requested (SUPImax);\n-\tTime when analytics information is needed;\n-\tAnalytics Metadata Request;\n-\t(Set of) NWDAF identifiers used by the NWDAF service consumer when aggregating multiple analytic subscriptions;\n-\tDataset Statistical Properties;\n-\tOutput strategy;\n-\tData time window;\n-\tConsumer NF's serving area or NF ID;\n-\tInformation of previous analytics subscription, i.e. NWDAF identifier (i.e. Instance ID or Set ID), Analytics ID(s) (including SUPIs and Analytics Filter Information for UE-related Analytics) and Subscription Correlation ID;\n-\tUse case context.\n-\tAnalytics Accuracy Request information.\n-\tAnalytics feedback information.\nNOTE 2:\tAnalytics Filter Information, Reporting Thresholds, maximum number of objects requested (max), maximum number of SUPIs requested (SUPImax), Analytics Metadata Request, Dataset Statistical Properties, Output strategy, Data time window and time when analytics information is needed can be provided per individual Analytics ID.\nNOTE 3:\tAnalytics feedback information only can be included in modification request for the existing analytics subscription.\nNOTE 4:\tOther input parameters specific for different analytics ID can be also needed, as specified in the corresponding clause for each analytics ID.\nOutputs Required: When the subscription is accepted: Subscription Correlation ID (required for management of this subscription). When the subscription is not accepted, an error response.\nOutputs, Optional: First corresponding Analytics report is included, if available and if analytics consumer requested immediate reporting (see clause 4.15.1 of TS 23.502 [3]).\nNOTE 5:\tWhen the Target of Analytics Reporting is a SUPI or a GPSI then the subscription may not be accepted, e.g. user consent is not granted and an error is sent to the consumer. When the Target of Analytics Reporting is an Internal Group Id, or a list of SUPIs/GPSI(s) or any UE, no error is sent, but a SUPI or GPSI is skipped if user consent is not granted.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.3\tNnwdaf_AnalyticsSubscription_Unsubscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_AnalyticsSubscription_Unsubscribe.\nDescription: Unsubscribe to NWDAF analytics.\nInputs, Required: Subscription Correlation ID.\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.4\tNnwdaf_AnalyticsSubscription_Notify service operation",
                            "text_content": "Service operation name: Nnwdaf_AnalyticsSubscription_Notify.\nDescription: NWDAF notifies the consumer instance of the analytics and optionally analytics accuracy information that has subscribed to the specific NWDAF service. See also clause 6.1.3 for contents of the Analytics Exposure.\nInputs, Required: Notification Correlation Information: this parameter indicates the Notification Correlation ID that has been assigned by the consumer during analytics subscription.\nInputs, Optional:\n-\tSet of the tuple (Analytics ID, Analytics specific parameters): this parameter shall be present if output analytics are reported.\n-\tTimestamp of analytics generation (required when ADRF is deployed).\n-\tValidity period.\n-\tConfidence\n-\tRevised waiting time.\n-\tAnalytics Metadata Information.\n-\tAnalytics Accuracy information.\n-\tStop Analytics Output Consumption indication.\n-\tStop Analytics Output Consumption time window.\n-\tResume Analytics Output Consumption indication.\n-\tTermination Request: this parameter indicates that NWDAF requests to terminate the analytics subscription, i.e. NWDAF will not provide further notifications related to this subscription, with cause value (e.g. user consent revoked, NWDAF overload, UE moved out of NWDAF serving area, etc.).\n-\tAccuracy Information Termination.\nNOTE 1:\tValidity period can also be provided as part of Analytics specific parameters for some NWDAF output analytics.\n-\tSubscription Change Notification Correlation ID: this parameter shall be present if the notification is for informing the assignment of a new Subscription Correlation Id by the NWDAF. It is set to the old Subscription Correlation ID.\n-\tSubscription Correlation ID: this parameter shall be present if the notification is for informing the assignment of a new Subscription Correlation Id by the NWDAF. It is set to a new Subscription Correlation ID assigned by the NWDAF.\nNOTE 2:\tOther input parameters specific for different analytics ID can be also needed, as specified in the corresponding clause of each analytics ID.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.5\tNnwdaf_AnalyticsSubscription_Transfer service operation",
                            "text_content": "Service operation name: Nnwdaf_AnalyticsSubscription_Transfer.\nDescription: Requests to NWDAF for transferring analytics subscription(s) from the consumer NWDAF.\nInputs, Required:\n-\tTransfer type: indicates the type of the transfer request. The following values are supported:\n-\tAnalytics subscription transfer preparation: requests the NWDAF to prepare for taking over the analytics subscription(s) and/or prepare for collecting Analytics Context(s).\n-\tAnalytics subscription transfer: requests the NWDAF to take over the analytics subscription(s).\n-\tAnalytics subscription transfer cancel: cancels a prepared analytics subscription request.\nInputs, Optional:\n-\tIf this service operation is for \"analytics subscription transfer preparation\", the following parameter shall be provided:\n-\t(Set of) analytics subscription information with the following parameters:\n-\tAll input parameters for the analytics exposure as specified in clause 6.1.3.\n-\t[OPTIONAL] Active data source ID(s): Instance ID or Set ID of the active data source(s) the consumer NWDAF is currently using for the analytics of this analytics subscription.\n-\t[OPTIONAL] ML Model related information, i.e. information related to the ML model(s) that the NWDAF is currently using for the analytics:\n-\tID(s) of NWDAF(s) containing MTLF: Instance ID(s) of the NWDAF(s) containing MTLF from which the consumer NWDAF currently subscribes to the ML model information used for the analytics.\n-\t[OPTIONAL] File address of the ML model(s).\n-\tID of the analytics consumer, e.g. NF, AF or OAM, that is subscribed to receive analytics.\n-\t[OPTIONAL] (Set of) analytics context identifier(s): identifies analytics context available at the consumer NWDAF as defined in clause 6.1B.4.\n-\tIf this service operation is to request analytics subscriptions transfer and if analytics subscription transfer preparation is not performed, the same parameters as those for transfer type \"Analytics subscription transfer preparation\" shall be provided.\n-\tIf this service operation is to request analytics subscriptions transfer and if analytics subscription transfer preparation is performed, the same parameters as those for transfer type \"Analytics subscription transfer preparation\" can be provided with updated parameter values.\n-\tIf this service operation is to request analytics subscriptions transfer cancel, the following parameter shall be provided:\n-\tSubscription Correlation ID.\nOutputs Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.3\tNnwdaf_AnalyticsInfo service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.3.1\tGeneral",
                            "text_content": "Service description: this service enables the consumer to request and get from NWDAF network data analytics, analytics accuracy information or enables NWDAF to request transfer of analytics context from another NWDAF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.2\tNnwdaf_AnalyticsInfo_Request service operation",
                            "text_content": "Service operation name: Nnwdaf_AnalyticsInfo_Request.\nDescription: The consumer requests NWDAF operator specific analytics and optionally analytics accuracy information.\nInputs, Required: (Set of) Analytics ID(s) as defined in Table 7.1-2, Target of Analytics Reporting, Analytics Reporting Parameters (including Analytics target period, etc.).\nNOTE 1:\tTarget of Analytics Reporting can be provided per individual Analytics ID.\nInputs, Optional: Analytics Filter Information, preferred level of accuracy of the analytics, preferred level of accuracy per analytics subset, time when analytics information is needed, maximum number of objects requested (max), preferred order of results, maximum number of SUPIs requested (SUPImax), Analytics Metadata Request, Dataset Statistical Properties, Output strategy, Data time window, Use case context, Time window for historical analytics and Analytics Accuracy Request information.\nNOTE 2:\tAnalytics Filter Information, Maximum number of objects requested (max), Maximum number of SUPIs requested (SUPImax), Analytics Metadata Request, Dataset Statistical Properties, Output strategy, Data time window and time when analytics information is needed can be provided per individual Analytics ID.\nOutputs, Required: If the request is accepted, then set of the tuple (Analytics ID, Analytics specific parameters). When the request is not accepted, an error response.\nOutputs, Optional: Timestamp of analytics generation (required when ADRF is deployed), validity period, confidence, revised waiting time, Analytics Metadata Information, Analytics Accuracy information. See clause 6.1.3.\nNOTE 3:\tValidity period can also be provided as part of Analytics specific parameters for some NWDAF output analytics.\nNOTE 4:\tWhen the Target of Analytics Reporting is a SUPI or a GPSI then the request may not be accepted, e.g. user consent is not granted and an error is sent to the consumer. When the Target of Analytics Reporting is an Internal Group Id, or a list of SUPIs/GPSI(s) or any UE, no error is sent, but a SUPI or GPSI is skipped if user consent is not granted.\nNOTE 5:\tOther input or output parameters specific for different analytics ID can be also needed, as specified in the corresponding clause of each analytics ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.3.3\tNnwdaf_AnalyticsInfo_ContextTransfer service operation",
                            "text_content": "Service operation name: Nnwdaf_AnalyticsInfo_ContextTransfer.\nDescription: Requests to NWDAF to transfer context information related to analytics subscriptions.\nInputs, Required: (Set of) Analytics context identifier(s).\nInputs, Optional: Requested Analytics Context per analytics context identifier.\nOutputs Required: (Set of) Analytics Context as specified in clause 6.1B.4.\nOutputs, Optional: ADRF ID with Analytics Context Type stored in the ADRF (i.e. Historical output Analytics and/or Data related to Analytics).\nNOTE:\tFor the Requested Analytics Context, the NWDAF can return a combination of Analytics Context and reference to ADRF ID from where Historical output Analytics and/or Data related to Analytics can be retrieved.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.4\tNnwdaf_DataManagement Service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.4.1\tGeneral",
                            "text_content": "Service Description: This service enables the consumer to subscribe/unsubscribe for data exposed by an NWDAF, fetch the subscribed data. Historical data or runtime data may be obtained using this service.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.2\tNnwdaf_DataManagement_Subscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_DataManagement_Subscribe.\nDescription: The consumer subscribes to receive data, or if the data is already requested from the NWDAF, then the subscription is updated. The subscription includes service operation specific parameters that identify the data to be provided and may include formatting and processing instructions that specify how the data is to be delivered to the consumer. The consumer may request bulked data related to Analytics, as an alternative to asking individual events (i.e. subscription to multiple event IDs to obtain the data required for an analytics generation). The consumer may also request that data be stored in an ADRF. When historical data is being obtained, the consumer may specify the ID of the ADRF or NWDAF containing the data.\nInputs, Required: Data Specification, Notification Target Address(es) (+ Notification Correlation ID(s)).\nWhen the required data is data for Event IDs received from NFs, the Data Specification includes set of Event IDs, Event Filter Information, Target of Event Reporting.\nWhen the required data is a bulked data for an Analytics ID, the Data Specification includes Target of Reporting with the Analytics ID to generate bulked data, Target of Analytics reporting and Analytics Filter.\nInputs, Optional: Service Operation, Time Window, NF (or NF-Set) ID, ADRF or NWDAF hosting ADRF information where data are to be stored, ADRF ID where historical data are stored, Formatting Instructions, Processing Instructions, user consent check information (i.e. an indication that the data consumer has checked user consent), purpose for data collection, Storage Handling Information.\nNOTE 1:\tSee clause 8.2.2 for further description of the Input Parameters.\nOutputs Required: When the subscription is accepted: Subscription Correlation ID (required for management of the requested subscription). When the subscription is not accepted, an error response.\nOutputs, Optional: First corresponding event report is included, if available (see clause 4.15.1 of TS 23.502 [3]), Requested data, Storage Approach (see clause 5B.1).\nNOTE 2:\tWhen the Target of Event Reporting or Target of Reporting is a SUPI or a GPSI then the subscription may not be accepted, e.g. for user consent is not granted and an error is sent to the consumer. When the Target of Event Reporting or Target of Reporting is an Internal Group Id, or a list of SUPIs/GPSI(s) or any UE, no error is sent, but a SUPI or GPSI is skipped if user consent is not granted.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.3\tNnwdaf_DataManagement_Unsubscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_DataManagement_Unsubscribe.\nDescription: The NF consumer unsubscribes to the NWDAF for data.\nInputs, Required: Subscription Correlation ID.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: The pending data that have not been sent to the consumer yet.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.4\tNnwdaf_DataManagement_Notify service operation",
                            "text_content": "Service operation name: Nnwdaf_DataManagement_Notify.\nDescription: NWDAF notifies the consumer instance of the requested data, or notifies of the availability of previously subscribed Data when delivery is via an NWDAF. The NWDAF may also notify the consumer instance when Data or Analytics is to be deleted.\nInputs, Required: Notification Correlation ID, time stamp representing time when NWDAF completed preparation of the requested data.\nInputs, Optional:\n-\tRequested Data with timestamp;\n-\tFetch Instructions;\n-\tTermination Request;\n-\tData or Analytics Deletion Alert.\nNOTE 1:\tIf the NWDAF has received the notifications from another source without a timestamp, then the NWDAF adds itself a timestamp based on the time it received the notification.\nFetch Instructions indicate whether the data are to be fetched by the Consumer. If the data are to be fetched, the fetch instructions include an address from which the data may be fetched, one or more Fetch Correlation IDs and a deadline to fetch the data (Fetch Deadline).\nTermination Request indicates that NWDAF requests to terminate the data management subscription, i.e. NWDAF will not provide further notifications related to this subscription.\nPending Notification Cause indicates the cause of the pending notification of the stored unsent data, e.g., the data cannot be collected any more due to UE moved out of NWDAF serving area.\nEditor's note:\tIt is FFS to determine additional causes of the Pending Notification Cause.\nData or Analytics Deletion Alert is described in clause 5B.1.\nNOTE 2:\tData provided in notifications are processed and formatted according to the Processing and Formatting Instructions provided by the Consumer in Nnwdaf_DataManagement_Subscribe.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: Data or Analytics Retrieval Indication.\nThe Data or Analytics Retrieval Indication may be sent if the notification contains a Data or Analytics Deletion Alert. The Data or Analytics Retrieval Indication indicates if the consumer will retrieve stored data or analytics prior to deletion (see clause 6.2B.3)\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.5\tNnwdaf_DataManagement_Fetch service operation",
                            "text_content": "Service operation name: Nnwdaf_DataManagement_Fetch.\nDescription: Consumer retrieves from the NWDAF subscribed data (which is regarded as a kind of data), as indicated by Fetch Instructions from Nnwdaf_DataManagement_Notify.\nInputs, Required: Set of Fetch Correlation ID(s).\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: Requested data.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.5\tNnwdaf_MLModelProvision services",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.5.1\tGeneral",
                            "text_content": "Service Description: This service enables the consumer to receive a notification when an ML model matching the subscription parameters becomes available.\nWhen the subscription is accepted by the NWDAF containing MTLF, the consumer NF, i.e. the NWDAF containing Analytics Logical Function, receives from the NWDAF an identifier (Subscription Correlation ID) allowing to further manage (modify, delete) this subscription. The modification of ML model subscription can be enforced by NWDAF based on operator policy and configuration.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.5.2\tNnwdaf_MLModelProvision_Subscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_MLModelProvision_Subscribe.\nDescription: Subscribes to NWDAF ML model provision with specific parameters.\nInputs, Required: (set of) Analytics ID(s) defined in Table 7.1-2, Notification Target Address (+ Notification Correlation ID).\nInputs, Optional: Subscription Correlation ID (in the case of modification of the ML model subscription), ML Model Filter Information to indicate the conditions for which ML model for the analytics is requested and Target of ML Model Reporting to indicate the object(s) for which ML model is requested (e.g. specific UEs, a group of UE(s) or any UE (i.e. all UEs)), NF consumer information, Requested representative ratio, ML Model Reporting Information (including e.g. ML Model Target Period), Expiry time, Use case context, Inference Input Data information, indication of support for multiple ML models, multiple ML models Filter Information to indicate the conditions for which multiple ML models are requested, ML Model Interoperability Information, Time when model is needed, ML Model Monitoring Information (including e.g. ML Model metric, ML model monitoring reporting mode, ML Model Accuracy Threshold, DataSetTag and ADRF ID, ML Model Identifier).\nOutputs Required: When the subscription is accepted: Subscription Correlation ID (required for management of this subscription), Expiry time (required if the subscription can be expired based on the operator's policy).\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.5.3\tNnwdaf_MLModelProvision_Unsubscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_MLModelProvision_Unsubscribe.\nDescription: unsubscribe to NWDAF ML model provision.\nInputs, Required: Subscription Correlation ID.\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.5.4\tNnwdaf_MLModelProvision_Notify service operation",
                            "text_content": "Service operation name: Nnwdaf_MLModelProvision_Notify.\nDescription: NWDAF notifies the ML model information to the consumer instance which has subscribed to the specific NWDAF service.\nInputs, Required: Notification Correlation Information, Set of:\n-\tthe tuple (Analytics ID, one or more tuples of unique ML Model identifier and ML Model Information as defined in clause 6.2A.2).\nInputs, Optional: ML Model Accuracy Information.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.6\tNnwdaf_MLModelInfo service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.6.1\tGeneral",
                            "text_content": "Service description: this service enables the consumer to request and get from NWDAF containing MTLF ML Model Information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.2\tNnwdaf_MLModelInfo_Request service operation",
                            "text_content": "Service operation name: Nnwdaf_MLModelInfo_Request\nDescription: The consumer requests NWDAF ML Model Information.\nInputs, Required: (Set of) Analytics ID(s) defined in Table 7.1-2.\nInputs, Optional: ML Model Filter Information to indicate the conditions for which ML model for the analytics is requested and Target of ML Model Reporting to indicate the object(s) for which ML model is requested (e.g. specific UEs, a group of UE(s) or any UE (i.e. all UEs)), NF consumer information, Requested representative ratio, ML Model Reporting Information (including e.g. ML Model Target Period), Use case context, Inference Input Data Information, indication of support for multiple ML models, multiple ML models Filter Information to indicate the conditions for which multiple ML models are requested, ML Model Interoperability Information, ML Model Accuracy Monitoring Information.\nOutputs, Required: Set of:\n-\tthe tuple (Analytics ID, one or more tuples of unique ML Model identifier and ML Model Information as defined in clause 6.2A.2.\nOutputs, Optional: ML Model Accuracy Information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.7\tNnwdaf_RoamingAnalytics Service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.7.1\tGeneral",
                            "text_content": "Service Description: This service enables the consumer to request or to subscribe/unsubscribe for network data analytics related to roaming UE(s).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.2\tNnwdaf_RoamingAnalytics_Subscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_RoamingAnalytics_Subscribe\nDescription: Subscribes to NWDAF analytics related to roaming UE(s).\nInputs, Required:\n-\t(Set of) Analytics ID(s).\n-\tPLMN ID of the consumer NWDAF.\n-\tTarget of Analytics Reporting.\n-\tNotification Target Address (+ Notification Correlation ID).\n-\tAnalytics Reporting Parameters (including Analytics target period, etc.).\nNOTE 1:\tTarget of Analytics Reporting can be provided per individual Analytics ID.\nNOTE 2:\tTarget of Analytics Reporting sent by the V-RE-NWDAF to the H-RE-NWDAF only contains the inbound roaming UE(s), and the Target of Analytics Reporting sent by the H-RE-NWDAF to the V-RE-NWDAF only contains the outbound roaming UE(s).\nInputs, Optional:\n-\tAnalytics Filter Information.\n-\tTime window for historical analytics.\n-\tSubscription Correlation ID (in the case of modification of the analytics subscription).\n-\tpreferred level of accuracy of the analytics.\n-\tpreferred level of accuracy per analytics subset.\n-\tReporting Thresholds.\n-\tmaximum number of objects requested (max).\n-\tpreferred order of results, maximum number of SUPIs requested (SUPImax).\n-\ttime when analytics information is needed.\n-\tOutput strategy.\n-\tNF (or NF-Set) ID(s) of NFs in VPLMN serving the UE(s) in Target of Analytics Reporting.\nNOTE 3:\tAnalytics Filter Information, Reporting Thresholds, maximum number of objects requested (max), maximum number of SUPIs requested (SUPImax) and time when analytics information is needed can be provided per individual Analytics ID.\nOutputs Required: When the subscription is accepted: Subscription Correlation ID (required for management of this subscription). When the subscription is not accepted, an error response.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.3\tNnwdaf_RoamingAnalytics_Unsubscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_RoamingAnalytics_Unsubscribe\nDescription: Unsubscribe to NWDAF analytics related to roaming UE(s).\nInputs, Required: Subscription Correlation ID.\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.4\tNnwdaf_RoamingAnalytics_Notify service operation",
                            "text_content": "Service operation name: Nnwdaf_RoamingAnalytics_Notify\nDescription: NWDAF notifies the consumer instance of the analytics related to roaming UE(s) that the consumer has subscribed to.\nInputs, Required: Notification Correlation Information: this parameter indicates the Notification Correlation Id that has been assigned by the consumer during analytics subscription.\nInputs, Optional:\n-\tSet of the tuple (Analytics ID, Analytics specific parameters): this parameter shall be present if output analytics are reported.\n-\tTimestamp of analytics generation.\n-\tValidity period.\n-\tConfidence\n-\tRevised waiting time.\n-\tTermination Request: this parameter indicates that NWDAF requests to terminate the analytics subscription, i.e. NWDAF will not provide further notifications related to this subscription, with cause value (e.g. user consent revoked, NWDAF overload, UE moved out of NWDAF serving area, etc.).\nNOTE:\tValidity period can also be provided as part of Analytics specific parameters for some NWDAF output analytics.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.5\tNnwdaf_RoamingAnalytics_Request service operation",
                            "text_content": "Service operation name: Nnwdaf_RoamingAnalytics_Request\nDescription: The consumer requests analytics related to roaming UE(s).\nInputs, Required:\n-\t(Set of) Analytics ID(s).\n-\tPLMN ID of the consumer NWDAF.\n-\tTarget of Analytics Reporting.\n-\tAnalytics Reporting Parameters (including Analytics target period, etc.).\nNOTE 1:\tTarget of Analytics Reporting can be provided per individual Analytics ID.\nNOTE 2:\tTarget of Analytics Reporting sent by the V-RE-NWDAF to the H-RE-NWDAF only contains the inbound roaming UE(s), and the Target of Analytics Reporting sent by the H-RE-NWDAF to the V-RE-NWDAF only contains the outbound roaming UE(s).\nInputs, Optional:\n-\tAnalytics Filter Information.\n-\tTime window for historical analytics.\n-\tpreferred level of accuracy of the analytics.\n-\tpreferred level of accuracy per analytics subset.\n-\tReporting Thresholds.\n-\tmaximum number of objects requested (max).\n-\tpreferred order of results, maximum number of SUPIs requested (SUPImax).\n-\ttime when analytics information is needed.\n-\tOutput strategy.\n-\tNF (or NF-Set) ID(s) of NFs in VPLMN serving the UE(s) in Target of Analytics Reporting.\nNOTE 3:\tAnalytics Filter Information, Reporting Thresholds, maximum number of objects requested (max), maximum number of SUPIs requested (SUPImax) and time when analytics information is needed can be provided per individual Analytics ID.\nOutputs, Required: If the request is accepted, then set of the tuple (Analytics ID, Analytics specific parameters). When the request is not accepted, an error response.\nOutputs, Optional: Timestamp of analytics generation, validity period, confidence, revised waiting time.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.8\tNnwdaf_RoamingData Service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.8.1\tGeneral",
                            "text_content": "Service Description: This service enables the consumer to subscribe/unsubscribe for input data related to roaming UE(s) for NWDAF analytics.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.8.2\tNnwdaf_RoamingData_Subscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_RoamingData_Subscribe\nDescription: Subscribe to input data related to roaming UE(s). The consumer subscribes to receive data, or if the data is already requested from the RE-NWDAF, then the subscription is updated. The subscription includes service operation specific parameters that identify the data to be provided and may include formatting and processing instructions that specify how the data is to be delivered to the consumer. The consumer may request bulked data related to Analytics, as an alternative to asking individual events (i.e. subscription to multiple event IDs to obtain the data required for an analytics generation).\nInputs, Required: PLMN ID of the consumer NWDAF, Data Specification, Notification Target Address(es) (+ Notification Correlation ID(s)).\nWhen the required data is data for Event IDs received from NFs, the Data Specification includes set of Event IDs, Event Filter Information, Target of Event Reporting.\nWhen the required data is a bulked data for an Analytics ID, the Data Specification includes Target of Reporting with the Analytics ID to generate bulked data, Target of Analytics reporting and Analytics Filter.\nInputs, Optional: Service Operation, Time Window, NF (or NF-Set) ID of data source (e.g. AMF, SMF), Formatting Instructions, Processing Instructions.\nOutputs Required: When the subscription is accepted: Subscription Correlation ID (required for management of this subscription). When the subscription is not accepted, an error response.\nOutputs, Optional: First corresponding event report is included, if available (see clause 4.15.1 of TS 23.502 [3]), Requested data.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.8.3\tNnwdaf_RoamingData_Unsubscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_RoamingData_Unsubscribe\nDescription: Unsubscribe to input data related to roaming UE(s).\nInputs, Required: Subscription Correlation ID.\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: The pending data that have not been sent to the consumer yet.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.8.4\tNnwdaf_RoamingData_Notify service operation",
                            "text_content": "Service operation name: Nnwdaf_RoamingData_Notify\nDescription: NWDAF notifies the consumer about input data related to roaming UE(s) that the consumer has subscribed to.\nInputs, Required: Notification Correlation Information: this parameter indicates the Notification Correlation Id that has been assigned by the consumer during analytics subscription. Time stamp representing time when NWDAF completed preparation of the requested data.\nInputs, Optional:\n-\tRequested Data with timestamp;\n-\tTermination Request.\nNOTE 1:\tIf the NWDAF has received the notifications from another source without a timestamp, then the NWDAF adds itself a timestamp based on the time it received the notification.\nTermination Request indicates that NWDAF requests to terminate the data subscription, i.e. NWDAF will not provide further notifications related to this subscription.\nNOTE 2:\tData provided in notifications are processed and formatted according to the Processing and Formatting Instructions provided by the Consumer in Nnwdaf_RoamingData_Subscribe.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.9\tNnwdaf_MLModelMonitor Service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.9.1\tGeneral",
                            "text_content": "Service Description: This service enables the consumer to subscribe/unsubscribe for ML model accuracy (i.e. Analytics accuracy for an ML model as described in clause 6.2E.3.3) information monitored. The service can additionally provide Analytics feedback information for the analytics generated by an NWDAF (i.e. NWDAF containing AnLF). The service also enables the NWDAF containing AnLF registers the use and monitoring capability for an ML model into the model provider NWDAF, i.e. NWDAF containing MTLF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.9.2\tNnwdaf_MLModelMonitor_Subscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_MLModelMonitor_Subscribe\nDescription: Subscribes to NWDAF for the monitored ML model accuracy (i.e. Analytics accuracy for an ML model as described in clause 6.2E.3.3) information and Analytics feedback information for the analytics generated by the NWDAF with specific parameters.\nInputs, Required: (set of) Unique ML Model identifier(s), Notification Target Address (+ Notification Correlation ID).\nInputs, Optional: Subscription Correlation ID (in the case of modification of the ML model monitor subscription), Accuracy metrics to indicate the metrics to calculate the accuracy information, reporting period to indicate the reporting periodicity in which the monitored ML Model accuracy information shall be reported, Accuracy reporting threshold to indicate the reporting condition above which the accuracy information shall be reported.\nOutputs Required: When the subscription is accepted: Subscription Correlation ID (required for management of this subscription), Expiry time (required if the subscription can be expired based on the operator's policy).\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.9.3\tNnwdaf_MLModelMonitor_Unsubscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_MLModelMonitor_Unsubscribe\nDescription: The NF consumer unsubscribes to the NWDAF for the monitored ML model accuracy (i.e. Analytics accuracy for an ML model as described in clause 6.2E.3.3) information and Analytics feedback information for the analytics generated by the NWDAF.\nInputs, Required: Subscription Correlation ID.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.9.4\tNnwdaf_MLModelMonitor_Notify service operation",
                            "text_content": "Service operation name: Nnwdaf_MLModelMonitor_Notify.\nDescription: NWDAF notifies the monitored ML model accuracy (i.e. Analytics accuracy for an ML model as described in clause 6.2E.3.3) information and Analytics feedback information for the analytics generated by the NWDAF to the consumer instance which has subscribed to the specific NWDAF service.\nInputs, Required: Notification Correlation Information, at least one of the following:\n-\tthe monitored ML model accuracy information which includes:\n-\tUnique ML model identifier;\n-\tMonitoring interval: time interval during which the ML model accuracy monitoring was conducted;\n-\tMonitored Analytics accuracy of the ML Model and a deviation value which indicates the deviation of the predictions generated using the ML model(s) from the ground truth data;\n-\tNumber of inferences that were performed during the monitoring interval;\n-\tAccuracy metrics as requested in Subscribe service operation.\n-\tAnalytics feedback information: indicates that the consumer NF of the analytics generated by the provisioned ML model has taken an action(s) influenced by the analytics and includes the following parameter(s):\n-\tCorresponding Analytics ID(s) which has been used for taking an action(s);\n-\tCorresponding ML Model identifier(s) which has been used for generating Analytics;\n-\tIndication whether the action will affect on ground truth data (if available);\n-\tTime stamp(s) when the action(s) are taken.\nInputs, Optional:\n-\tInput data used for inferencing indicated by DataSetTag with ADRF ID when the prediction generated from the ML Model is not correct (which can be used by the NWDAF containing MTLF for possible ML model retraining);\nNOTE:\tHow MTLF/AnLF determines whether the prediction is correct one is up to implementation.\n-\tAn indication that the analytics accuracy of the ML model does not meet the requirement of accuracy for the ML model.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.9.5\tNnwdaf_MLModelMonitor_Register",
                            "text_content": "Service operation name: Nnwdaf_MLModelMonitor_Register\nDescription: The consumer registers the use and monitoring capability for an ML model at an NWDAF containing MTLF.\nInputs, Required: Consumer NF ID, Unique ML Model identifier.\nInputs, Optional: Endpoint address of the Nnwdaf_MLModelMonitor_Subscribe service operation. ML Model accuracy transfer indication as defined in clause 6.2E.3.2\nOutputs, Required: ML model monitoring registration ID.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.9.6\tNnwdaf_MLModelMonitor_Deregister",
                            "text_content": "Service operation name: Nnwdaf_MLModelMonitor_Deregister\nDescription: The consumer deregisters, from an NWDAF containing MTLF, a previous MLModelMonitor registration, e.g. when the consumer is no longer using or monitoring the accuracy of the analytics generated using the ML model.\nInputs, Required: ML model monitoring registration ID.\nInputs, Optional: A termination indication, a termination cause, the NWDAF containing AnLF NF ID of the target NWDAF (in the case that the termination cause is due to analytics transfer).\nOutputs, Required: None.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.10\tNnwdaf_MLModelTraining Service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.10.1\tGeneral",
                            "text_content": "Service Description: This service enables the consumer to subscribe/unsubscribe/notify/modify for ML model training.\nNOTE:\tIn this release of the specification, the service provider and consumer are limited to NWDAF containing MTLF.\nWhen used for Federated Learning, this service enables FL server NWDAF to enable Federated Learning while providing global ML model information to FL Client NWDAF and getting local ML model information and status report of FL training as defined in clause 6.2C.2.3 from the FL Client NWDAF.\nThis service may also be used by the consumer (i.e. FL Server NWDAF) to check if the service provider (i.e. FL Client NWDAF) can meet the ML model training requirement as described in clause 6.2F.1.\nThis service may also be used by the consumer (i.e. FL Server NWDAF) to request the service provider (i.e. FL Client NWDAF) to calculate and provide Model Accuracy of the global ML Model as described in clause 6.2F.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.10.2\tNnwdaf_MLModelTraining_Subscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_MLModelTraining_Subscribe\nDescription: Subscribes to NWDAF ML model training with specific parameters.\nInputs, Required:\n-\tAnalytics ID as defined in Table 7.1-2;\n-\tML Model Interoperability information;\n-\tNotification Target Address (+ Notification Correlation ID).\nInputs, Optional:\n-\tML Model ID: identifies the provided ML model.\n-\tML Model Information (as defined in clause 6.2A.2);\n-\tML model file;\n-\tSubscription Correlation ID (in the case of modification of the ML Model Training subscription);\n-\tML Training Information, i.e. data availability requirement, time availability requirement.\n-\tML Preparation Flag;\n-\tML Model Accuracy Check Flag;\n-\tML Correlation ID;\n-\tTraining Filter Information;\n-\tTarget of Training Reporting;\n-\tTraining Reporting Information as defined in clause 6.2F.2;\n-\tUse case context;\n-\tIteration round ID;\n-\tExpiry time.\nOutputs Required: When the request is accepted: Subscription Correlation ID (required for management of this subscription). When the request is not accepted, an error response with cause code (e.g. NWDAF does not meet the ML training requirements, ML training is not complete, NWDAF overload, not available for the FL process anymore, etc.).\nNOTE:\tThe detail reasons in the cause code are up to Stage 3.\nOutputs, Optional: ML Correlation ID (e.g. confirm of the subscription for this FL process).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.10.3\tNnwdaf_MLModelTraining_Unsubscribe service operation",
                            "text_content": "Service operation name: Nnwdaf_MLModelTraining_Unsubscribe\nDescription: Terminate NWDAF ML model training.\nInputs, Required: Subscription Correlation ID.\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: Cause code (e.g. FL Client NWDAF is unselected by the FL Server NWDAF for the FL process, or the FL process is suspended or finished, etc.). Final aggregated ML model information (if FL has finished) or updated aggregated ML model information (if FL is suspended).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.10.4\tNnwdaf_MLModelTraining_Notify service operation",
                            "text_content": "Service operation name: Nnwdaf_MLModelTraining_Notify\nDescription: NWDAF notifies the consumer instance of the trained ML model that has subscribed to the specific NWDAF service. The NWDAF can also use this service to indicate to consumer it will terminate the ML model training.\nInputs, Required:\n-\tNotification Correlation Information: this parameter indicates the Notification Correlation ID that has been assigned by the consumer during ML model training.\nInputs, Optional:\n-\tSet of the tuple (Analytics ID, ML model Information as defined in clause 6.2F.2;\n-\tML Correlation ID, when for Federated Learning;\n-\tCorresponding Use case context;\n-\tTermination Request: this parameter indicates that NWDAF requests to terminate the ML model training, i.e. NWDAF will not provide further notifications related to this request, with cause code (e.g. NWDAF overload, not available for the FL process anymore, etc.);\n-\tML Model ID: this parameter identifies the provisioned ML model;\n-\tGlobal ML Model Accuracy: The model accuracy of the global ML model, which is calculate by the FL Client NWDAF using the local training data as the testing dataset;\n-\tStatus report of FL training: local ML Model metric and Training Input Data Information (e.g. areas covered by the data set, sampling ratio, maximum/minimum of value of each dimension, etc.), which are generated by the FL Client NWDAF during FL procedure;\n-\tDelay Event Notification: as defined in clause 6.2F.2;\n-\tIteration round ID.\nNOTE:\tThe detail reasons in the cause code are up to stage 3.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.11\tNnwdaf_MLModelTrainingInfo Service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.11.1\tGeneral",
                            "text_content": "Service Description: This service enables the consumer to request for the information about ML model training based on the ML Model file or ML Model information as described in clause 6.2F.2 provided by the consumer.\nNOTE:\tIn this release of the specification, the service provider and consumer are limited to NWDAF containing MTLF.\nWhen used for Federated Learning, this service enables FL server NWDAF to enable Federated Learning while providing global ML model information to FL Client NWDAF and getting local ML model information from the FL Client NWDAF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.11.2\tNnwdaf_MLModelTrainingInfo_Request service operation",
                            "text_content": "Service operation name: Nnwdaf_MLModelTrainingInfo_Request\nDescription: Request information about NWDAF ML model training with specific parameters.\nInputs, Required:\n-\tAnalytics ID as defined in Table 7.1-2.\n-\tML Model Interoperability information.\nInputs, Optional:\n-\tML Model ID: identifies the provided ML model.\n-\tML Model Information (as defined in clause 6.2A.2).\n-\tML Model file.\n-\tML Training Information (i.e. data availability requirement, time availability requirement).\n-\tTraining Reporting Information as defined in clause 6.2F.2.\n-\tML Preparation Flag.\n-\tML Model Accuracy Check Flag.\n-\tML Correlation ID.\n-\tTermination Request, when terminating the Federated Learning identified by the ML Correlation ID and optionally indicating the reason, e.g. FL Client NWDAF is unselected by the FL Server NWDAF for the FL process, or the FL process is suspended, etc.\n-\tTraining Filter Information.\n-\tTarget of Training Reporting.\n-\tUse case context.\nOutputs Required: When the request is accepted: Operation execution result indication. When the request is not accepted, an error response with cause code (e.g. NWDAF does not meet the ML training requirements, ML training is not complete, NWDAF overload, not available for the FL process anymore, etc.).\nNOTE:\tThe detail reasons in the cause code are up to stage 3.\nOutputs, Optional:\n-\tML Model ID.\n-\tSet of the tuple (Analytics ID, ML model Information (as defined in clause 6.2A.2)).\n-\tML Correlation ID, when for Federated Learning.\n-\tCorresponding Use case context.\n-\tGlobal ML Model Accuracy: The model accuracy of the global ML model, which is calculate by the FL Client NWDAF using the local training data as the testing dataset.\n-\tStatus report of FL training: local ML model metric and Training Input Data Information (e.g. areas covered by the data set, sampling ratio, maximum/minimum of value of each dimension of data, etc.), which are generated by the FL Client NWDAF during FL procedure.\n-\tDelay Event Notification as defined in clause 6.2F.2;\n-\tglobal ML model metric.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "8\tDCCF Services",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "8.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 8.1-1 shows the DCCF services and DCCF service operations.\nTable 8.1-1: NF services provided by DCCF\n\n",
                    "tables": [
                        {
                            "description": "Table 8.1-1: NF services provided by DCCF",
                            "table number": 113,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.2\tNdccf_DataManagement service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.2.1\tGeneral",
                            "text_content": "Service Description: This service enables the consumer to subscribe/unsubscribe for data or analytics via the DCCF, be notified about data or analytics exposed by the DCCF, fetch the subscribed data and have data delivered via the DCCF or via a messaging framework. Historical data, or runtime data may be obtained using this service.\nWhen the subscription is accepted by the DCCF, the consumer NF receives from the DCCF an identifier (Subscription Correlation ID) allowing it to further manage (modify, delete) the subscription.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.2.2\tNdccf_DataManagement_Subscribe service operation",
                            "text_content": "Service operation name: Ndccf_DataManagement_Subscribe\nDescription: The consumer subscribes to receive data or analytics (which is regarded as a kind of data), or if the data is already requested from the DCCF, then the subscription is updated. The subscription includes service operation specific parameters that identify the data or analytics to be provided and may include formatting and processing instructions that specify how the data is to be delivered to the consumer. The consumer may also request that data be stored in an ADRF or an NWDAF hosting ADRF functionality. When historical data is being obtained, the consumer may specify the ID of the ADRF or NWDAF containing the data.\nInputs, Required: Service operation, Analytics Specification or Data Specification, Notification Target Address(es) (+ Notification Correlation ID (s)).\nInputs, Optional: Time Window, NF (or NF-Set) ID, ADRF or NWDAF hosting ADRF information where collected data are to be stored, ADRF ID where historical data are stored, Formatting Instructions, Processing Instructions, user consent check information (i.e. an indication that the data consumer has checked user consent), purpose for data collection, Storage Handling Information.\n\"Service Operation\" identifies the service used by the DCCF to request data or analytics from a Data Source (e.g.: Namf_EventExposure_Subscribe or Nnwdaf_AnalyticsSubscription_Subscribe)\n\"Analytics Specification or Data Specification\" is the \"Service Operation\" specific required and optional input parameters that identify the data to be collected (e.g. Analytics ID(s) / Event ID (s), Target of Analytics Reporting or Target of Event Reporting, Analytics Filter or Event Filter, etc.). Service Operations and input parameters are defined in clause 7 for NWDAF and in TS 23.502, clause 5.2 for the other NFs.\n\"Time Window\" is the start and stop time when the requested data or analytics was or will be collected. If the Time Window includes a period in the past, then the data or analytics collection is \"historical\". If the Time Window includes a period in the future, the data or analytics collection is \"runtime\".\nNOTE 1:\tTime Window parameter is different from the \"Analytics target period\" defined in clause 6.1.3.\nNOTE 2:\tWhen Time Window is not provided, the consumer subscribes to runtime data or analytics collection, with no end time specified.\nNF (or NF-Set) ID specifies a data source that may provide the data.\nADRF Information specifies that collected data or analytics is to be stored in an ADRF and optionally an ADRF or NWDAF ID.\nFormatting Instructions and Processing Instructions are as defined in clause 5A.4.\nStorage Handling Information is described in clause 5B.1.\nOutputs Required: When the subscription is accepted: Subscription Correlation ID (required for management of this subscription). When the subscription is not accepted: An error response.\nOutputs, Optional: First corresponding event report is included, if available (see clause 4.15.1 of TS 23.502 [3]), Requested data, Storage Approach (see clause 5B.1).\nNOTE 3:\tWhen the Target of Event Reporting or Target of Reporting is a SUPI or a GPSI then the subscription may not be accepted, e.g. for user consent is not granted and an error is sent to the consumer. When the Target of Event Reporting or Target of Reporting is an Internal Group Id, or a list of SUPIs/GPSI(s) or any UE, no error is sent, but a SUPI or GPSI is skipped if user consent is not granted.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.2.3\tNdccf_DataManagement_Unsubscribe service operation",
                            "text_content": "Service operation name: Ndccf_DataManagement_Unsubscribe\nDescription: The consumer unsubscribes to DCCF for data or analytics.\nInputs, Required: Subscription Correlation ID.\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: The pending (events) data that is not sent to the consumer yet.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.2.4\tNdccf_DataManagement_Notify service operation",
                            "text_content": "Service operation name: Ndccf_DataManagement_Notify\nDescription: DCCF notifies the consumer instance of the requested data or analytics (which is regarded as a kind of data) according to the request, or notifies of the availability of previously subscribed Data or Analytics when data delivery is via the DCCF. The DCCF may also notify the consumer instance when Data or Analytics is to be deleted.\nInputs, Required: Notification Correlation Information, time stamp representing time when DCCF completed preparation of the requested data.\nInputs, Optional: Requested Data with timestamp or Analytics with timestamp, Fetch Instructions, Termination Request, Data or Analytics Deletion Alert.\nNOTE 1:\tIf the DCCF has received the notifications from another source (e.g. NWDAF) without a timestamp, then the DCCF adds itself a timestamp based on the time it received the notification.\nFetch Instructions indicate whether the data or analytics are to be fetched by the Consumer. If the data or analytics are to be fetched, the fetch instructions include an address from which the data may be fetched, one or more Fetch Correlation IDs and a deadline to fetch the data (Fetch Deadline).\nTermination Request indicates that the DCCF requests to terminate the data management subscription, i.e. DCCF will not provide further notifications related to this subscription.\nPending Notification Cause indicates the cause of the pending notification of the stored unsent data, e.g. the data cannot be collected any more due to UE moved out of DCCF serving area.\nEditor's note:\tIt is FFS to determine additional causes of the Pending Notification Cause.\nData or Analytics Deletion Alert is described in clause 5B.1.\nNOTE 2:\tData or Analytics provided in notifications are processed and formatted according to the Processing and Formatting Instructions provided by the Consumer in Ndccf_DataManagement_Subscribe.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: Data or Analytics Retrieval Indication.\nThe Data or Analytics Retrieval Indication may be sent if the notification contains a Data or Analytics Deletion Alert. The Data or Analytics Retrieval Indication indicates if the consumer will retrieve stored data or analytics prior to deletion (see clause 6.2B.3).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.2.5\tNdccf_DataManagement_Fetch service operation",
                            "text_content": "Service operation name: Ndccf_DataManagement_Fetch\nDescription: Consumer retrieves from the DCCF, data or analytics (which is regarded as a kind of data) as indicated by Ndccf_DataManagement_Notify Fetch Instructions.\nInputs, Required: Set of Fetch Correlation ID(s).\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: Requested data or Analytics.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.2.6\tNdccf_DataManagement_Transfer service operation",
                            "text_content": "Service operation name: Ndccf_DataManagement_Transfer\nDescription: Source DCCF transfers UE data subscription context to the target DCCF.\nInputs, Required: UE data subscription context(UE ID，Data Specification, Notification Target Address(es) (+ Notification Correlation ID(s))).\nInputs, Optional: Service Operation, Time Window, NF (or NF-Set) ID, ADRF or NWDAF hosting ADRF information where data are to be stored.\nOutputs Required: Subscription Correlation ID, Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "8.3\tNdccf_ContextManagement service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.3.1\tGeneral",
                            "text_content": "Service Description: This service enables the consumer to register collected data or analytics with the DCCF.\nWhen the DCCF is configured by the consumer NF, the DCCF supplies a Transaction Reference Id. The Consumer NF may use the Transaction Reference Id in subsequent transactions to update or delate the context in the DCCF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.3.2\tNdccf_ContextManagement_Register service operation",
                            "text_content": "Service operation name: Ndccf_ContextManagement_Register\nDescription: The consumer NF uses this service operation to register data or analytics it is collecting to the DCCF. The registration includes a service operation specific Analytics/Data Specification that identifies the data or analytics that are being collected or has been collected.\nInputs, Required: Service Operation, Analytics/Data Specification, NWDAF ID or ADRF ID.\nInputs, Optional: None\nNOTE:\tThe input parameters are defined as:\n-\t\"Service Operation\" identifies the service used to collect the data or analytics from a Data Source (e.g. Namf_EventExposure_Subscribe or Nnwdaf_AnalyticsSubscription_Subscribe).\n-\t\"Analytics/Data Specification\" is the \"Service Operation\" specific required and optional input parameters that identify the collected data (i.e. Analytics ID(s) / Event ID (s), Target of Analytics Reporting or Target of Event Reporting, Analytics Filter or Event Filter, etc.). NF Service Operations and input parameters are defined in clause 7 and clause 5.2 of TS 23.502 [3].\n-\tNWDAF ID or ADRF ID specify the ADRF or NWDAF with the stored data.\nOutputs Required: Transaction Reference ID(s), Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.3.3\tNdccf_ContextManagement_Update service operation",
                            "text_content": "Service operation name: Ndccf_ContextManagement_Update\nDescription: The consumer NF uses this service operation to update a registration of data or analytics to the DCCF. The registration update includes a service operation specific Analytics/Data Specification that identifies the data or analytics that is being collected or has been collected.\nInputs, Required: Transaction Reference ID(s), Service Operation, Analytics/Data Specification\nInputs, Optional: None\nNOTE:\tThe input parameters are defined in clause 8.3.2.\nOutputs Required: Transaction Reference ID(s), Operation execution result indication.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.3.4\tNdccf_ContextManagement_Deregister service operation",
                            "text_content": "Service operation name: Ndccf_ContextManagement_Deregister\nDescription: The consumer NF uses this service operation to delete a registration of data or analytics to the DCCF.\nInputs, Required: Transaction Reference ID(s)\nInputs, Optional: None\nOutputs Required: Transaction Reference ID(s), Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "9\tMFAF Services",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "9.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 9.1-1 shows the MFAF services and MFAF service operations.\nTable 9.1-1: NF services provided by MFAF\n\n",
                    "tables": [
                        {
                            "description": "Table 9.1-1: NF services provided by MFAF",
                            "table number": 114,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "9.2\tNmfaf_3daDataManagement service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "9.2.1\tGeneral",
                            "text_content": "Service Description: The consumer (e.g. DCCF) uses this service to instruct the MFAF to map data or analytics received by the MFAF to out-bound notification endpoints. Configuration of the MFAF by the consumer may include formatting and processing instructions for each notification endpoint as described in clause 5A.4. The sending of historical data or run-time data may be configured/deconfigured using this service.\nWhen the MFAF is configured by the consumer NF, the MFAF provides a Transaction Reference Id. The Consumer NF may use the Transaction Reference Id in subsequent transactions to modify or remove (deconfigure) the sending of data to consumers.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.2.2\tNmfaf_3daDataManagement_Configure service operation",
                            "text_content": "Service operation name: Nmfaf_3daDataManagement_Configure\nDescription: The consumer configures or reconfigures the MFAF to map data or analytics received by the MFAF to out-bound notification endpoints and to format and process the out-bound data or analytics.\nInputs, Required: Data Consumer or Analytics Consumer Information.\n\"Data Consumer or Analytics Consumer Information\" contains for each notification endpoint, the consumer provided Notification Target Address (+ Analytics Consumer Notification Correlation ID) or other endpoint addresses if provisioned on the DCCF to be used by the MFAF when sending notifications.\nInputs, Optional: Formatting Instructions, Processing Instructions, MFAF Notification Information, Transaction Reference Id, ADRF ID.\n\"MFAF Notification Information\" is used to identify Event Notifications received from a Data Source and comprises the MFAF Notification Target Address (+ MFAF Notification Correlation ID). If a Data Source is already supplying the data to the MFAF, the MFAF Notification Information previously provided by the MFAF and used by the DCCF to obtain data from a Data Source is provided as an Input. If a new subscription to a Data Source is needed, the MFAF Notification Information is not specified as an Input and the MFAF provides Notification Information as an output. The MFAF Notification Information may subsequently be used by the DCCF when subscribing to a Data Source. \"ADRF ID\" is used to identify the ADRF when DCCF requests that the Messaging Framework to store historical data and analytics in the ADRF via Nadrf_DataManagement_StorageRequest. When a Notification Correlation ID is provided, MFAF shall use the Nmfaf_3caDataManagement_Notify service with the notification correlation ID to send the data or analytics to the ADRF.\nOutputs Required: Operation execution result indication.\nOutputs, Optional: MFAF Notification Information, Transaction Reference Id.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.2.3\tNmfaf_3daDataManagement_Deconfigure service operation",
                            "text_content": "Service operation name: Nmfaf_3daDataManagement_Deconfigure\nDescription: Description: The consumer configures the MFAF to stop mapping data or analytics received by the MFAF to one or more out-bound notification endpoints.\nInputs, Required: Data Consumer or Analytics Consumer Information, Transaction Reference Id.\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "9.3\tNmfaf_3caDataManagement service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "9.3.1\tGeneral",
                            "text_content": "Service Description: This service is used to supply data or analytics from the MFAF to notification endpoints. Notifications may contain data or analytics, or an indication of availability of data or analytics.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.3.2\tNmfaf_3caDataManagement_Notify service operation",
                            "text_content": "Service operation name: Nmfaf_3caDataManagement_Notify\nDescription: Provides data or analytics or notification of availability of data or analytics to notification endpoints.\nInputs, Required: Notification Correlation Information.\nInputs, Optional: Requested Data with timestamp or Analytics with timestamp, Fetch Instructions.\nNOTE 1:\tIf the MFAF has received the notifications from another source (e.g. NWDAF) without a timestamp, then the MFAF adds itself a timestamp based on the time it received the notification.\nFetch Instructions indicate whether the data or analytics are to be fetched by the Consumer. If the data or analytics are to be fetched, the fetch instructions include an address from which the data may be fetched, one or more Fetch Correlation IDs and a deadline to fetch the data (Fetch Deadline).\nNOTE 2:\tData or Analytics provided in notifications can be processed and formatted according to the Processing and Formatting Instructions provided by the Consumer.\nOutputs, Required: None.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "9.3.3\tNmfaf_3caDataManagement_Fetch service operation",
                            "text_content": "Service operation name: Nmfaf_3caDataManagement_Fetch\nDescription: Consumer retrieves from the MFAF, data or analytics (which is regarded as a kind of data) as indicated by Nmfaf_3caDataManagement_Notify Fetch Instructions.\nInputs, Required: Set of Fetch Correlation ID(s).\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: Requested Data or Analytics.\nNOTE:\tData or Analytics provided in notifications can be processed and formatted according to the Processing and Formatting Instructions provided by the Consumer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "10\tADRF Services",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "10.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 10.1-1 shows the ADRF services and ADRF service operations.\nADRF service operations may be used to store data or analytics in the ADRF, retrieve data or analytics from an ADRF, or delete data or analytics from an ADRF.\nADRF service operations may also be used to store ML Model(s) or ML Model address(es) in the ADRF, retrieve ML model(s) from an ADRF or delete ML Model(s) from an ADRF.\nTable 10.1-1: NF services provided by ADRF\n\n",
                    "tables": [
                        {
                            "description": "Table 10.1-1: NF services provided by ADRF",
                            "table number": 115,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "10.2\tNadrf_DataManagement service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "10.2.1\tGeneral",
                            "text_content": "Service Description: This service enables the consumer to store, retrieve and remove data or analytics from an ADRF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.2\tNadrf_DataManagement_StorageRequest service operation",
                            "text_content": "Service operation name: Nadrf_DataManagement_StorageRequest\nDescription: The consumer NF uses this service operation to request the ADRF to store data or analytics. Data or analytics are provided to the ADRF in the request message.\nInputs, Required: Data with timestamp or Analytics with timestamp to be stored, Service operation, Analytics Specification or Data Specification.\n\"Service Operation\" identifies the service used to obtain the data or analytics from a Data Source (e.g. Namf_EventExposure_Subscribe or Nnwdaf_AnalyticsSubscription_Subscribe).\n\"Analytics Specification or Data Specification\" is the \"Service Operation\" specific required and optional input parameters that identify the data that was stored (e.g. Analytics ID(s) / Event ID (s), Target of Analytics Reporting or Target of Event Reporting, Analytics Filter or Event Filter, etc.). Service Operations and input parameters are defined in clause 7 for NWDAF and in clause 5.2 of TS 23.502 [3] for the other NFs.\nInputs, Optional: DataSetTag, DSC information, Storage Handling Information, Data Deletion Notification Endpoint (see clause 6.2B.2).\nOutputs Required: Result Indication.\nOutputs, Optional: Storage Transaction Identifier, DataSetTag(s), Storage Approach.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.3\tNadrf_DataManagement_StorageSubscriptionRequest service operation",
                            "text_content": "Service operation name: Nadrf_DataManagement_StorageSubscriptionRequest\nDescription: The consumer (NWDAF or DCCF) uses this service operation to request the ADRF to initiate a subscription for data or analytics (see clause 6.2B.3). Data or analytics provided in notifications as a result of the subsequent subscription by the ADRF are stored in the ADRF.\nThis service operation provides parameters needed by the ADRF to initiate the subscription (to a DCCF or NWDAF).\nInputs, Required: Service operation, Analytics Specification or Data Specification, Target NF (or Set) to subscribe to for notifications.\n\"Service Operation\" identifies the service used to request data or analytics from a Data Source (e.g. Namf_EventExposure_Subscribe or Nnwdaf_AnalyticsSubscription_Subscribe)\n\"Analytics Specification or Data Specification\" is the \"Service Operation\" specific required and optional input parameters that identify the data to be collected (e.g. Analytics ID(s) / Event ID (s), Target of Analytics Reporting or Target of Event Reporting, Analytics Filter or Event Filter, etc.). Service Operations and input parameters are defined in clause 7 for NWDAF and in clause 5.2 of TS 23.502 [3] for the other NFs.\n\"Target NF (or Set) to subscribe to for notifications\" may be a DCCF or NWDAF that can provide the data or analytics\nInputs, Optional: Formatting Instructions, Processing Instructions, DataSetTag, Storage Handling Information, Data Deletion Notification Endpoint (see clause 6.2B.3).\nFormatting Instructions and Processing Instructions are as defined in clause 5A.4.\nOutputs Required: Transaction Reference ID, DataSetTag(s) (if any).\nOutputs, Optional: Storage Approach.\nNOTE:\tThe parameters used in this service operation, including Formatting and Processing Instructions (if provided) are used by the ADRF when subscribing to a DCCF or NWDAF for Data or Analytics to be stored.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.4\tNadrf_DataManagement_StorageSubscriptionRemoval service operation",
                            "text_content": "Service operation name: Nadrf_DataManagement_StorageSubscriptionRemoval\nDescription: The consumer NF uses this service operation to request that the ADRF no longer subscribes to data or analytics it is collecting and storing.\nInputs, Required: one of the following:\n-\tTransaction Reference ID provided in the Nadrf_DataManagement_StorageSubscriptionRequest Output; or\n-\tDataSetTag.\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.5\tNadrf_DataManagement_RetrievalRequest service operation",
                            "text_content": "Service operation name: Nadrf_DataManagement_RetrievalRequest\nDescription: The consumer NF uses this service operation to retrieve stored data or analytics from the ADRF. The Nadrf_DataManagement_RetrievalRequest response either contains the data or analytics, or provides instructions for fetching the data or analytics. The Nadrf_DataManagement_RetrievalRequest may be unsolicited (e.g. when the consumer itself has known \"Storage Transaction Identifier\") or sent in response to a Fetch Instructions received from the ADRF in an Nadrf_DataManagement_RetrievalNotify.\nInputs, Required: one of the following:\n-\tStorage Transaction Identifier; or\n-\tFetch Correlation ID(s) if the RetrievalRequest is in response to a Fetch Instruction received from the ADRF in an Nadrf_DataManagement_RetrievalNotify; or\n-\tDataSetTag.\nInputs, Optional: None.\nOutputs Required: Result Indication.\nOutputs, Optional: Data or Analytics, DSC information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.6\tNadrf_DataManagement_RetrievalSubscribe service operation",
                            "text_content": "Service operation name: Nadrf_DataManagement_RetrievalSubscribe\nDescription: The consumer NF uses this service operation to retrieve stored data or analytics from the ADRF and to receive future notifications containing the corresponding data or analytics received by ADRF.\nInputs, Required: one of the following:\n-\tService Operation, Analytics Specification or Data Specification, Time Window; or\n-\tDataSetTag.\n\"Service Operation\" identifies the service used to obtain the data or analytics from a Data Source (e.g. Namf_EventExposure_Subscribe or Nnwdaf_AnalyticsSubscription_Subscribe).\n\"Analytics Specification or Data Specification\" is the \"Service Operation\" specific required and optional input parameters that identify the data that was stored (e.g. Analytics ID(s) / Event ID (s), Target of Analytics Reporting or Target of Event Reporting, Analytics Filter or Event Filter, etc.). Service Operations and input parameters are defined in clause 7 for NWDAF and in clause 5.2 of TS 23.502 [3] for the other NFs.\n\"Time Window\" is the start and stop time when the requested data or analytics was collected. If Time Window includes a period in the future, subsequent notifications containing the requested data or analytics received by the ADRF are sent to the notification endpoint.\n\"DataSetTag\" indicates all data records stored or being collected and stored by ADRF which are associated to that attribute.\nInputs, Optional: Fetch flag.\nOutputs Required: Result Indication.\nOutputs, Optional: Subscription Correlation ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.7\tNadrf_DataManagement_RetrievalUnsubscribe service operation",
                            "text_content": "Service operation name: Nadrf_DataManagement_RetrievalUnsubscribe\nDescription: The consumer NF uses this service operation to request that the ADRF no longer sends data or analytics to a notification endpoint.\nInputs, Required: Subscription Correlation ID.\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.8\tNadrf_DataManagement_RetrievalNotify service operation",
                            "text_content": "Service operation name: Nadrf_DataManagement_RetrievalNotify\nDescription: This service operation provides consumers with either data or analytics from an ADRF, or instructions to fetch the data or analytics from an ADRF. The notifications are provided to consumers that have subscribed using the Nadrf_DataManagement_RetrievalSubscribe service operation. Historical data or analytics may be retrieved from ADRF storage and data received in the future be sent when obtained by the ADRF. The ADRF may also notify the consumer instance when Data or Analytics is to be deleted\nInputs, Required: Notification Correlation Information, time stamp representing time when ADRF completed preparation of the requested data.\nInputs, Optional: Requested Data or Analytics, Fetch Instructions, Termination Request, DSC information, Data or Analytics Deletion Alert.\nFetch Instructions indicate whether the data or analytics are to be fetched from the ADRF by the Consumer. If the data or analytics are to be fetched, the fetch instructions include an address from which the data may be fetched, one or more Fetch Correlation IDs. and a deadline to fetch the data (Fetch Deadline).\nData or Analytics are fetched using the Nadrf_DataManagement_RetrievalRequest service operation.\nTermination Request indicates that the ADRF requests to terminate the subscription, i.e. ADRF will not provide further notifications related to this subscription, e.g. when all data or analytics requested by the consumer have been provided to the consumer.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: Data or Analytics Retrieval Indication..\nThe Data or Analytics Retrieval Indication may be sent if the notification contains a Data or Analytics Deletion Alert. The Data or Analytics Retrieval Indication indicates if the consumer will retrieve stored data or analytics prior to deletion (see clause 6.2B.3).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.2.9\tNadrf_DataManagement_Delete",
                            "text_content": "Service operation name: Nadrf_DataManagement_Delete\nDescription: This service operation instructs the ADRF to delete stored data.\nInputs, Required: One of the following:\n-\tStorage Transaction Identifier;\n-\tService Operation, Analytics Specification or Data Specification and Time Window; or\n-\tDataSetTag.\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "10.3\tNadrf_MLModelManagement service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "10.3.1\tGeneral",
                            "text_content": "Service Description: This service enables the consumer to store and update, retrieve and remove ML Model(s) or ML Model address(es) from an ADRF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.3.2\tNadrf_MLModelManagement_StorageRequest service operation",
                            "text_content": "Service operation name: Nadrf_MLModelManagement_StorageRequest\nDescription: The consumer NF uses this service operation to request the ADRF to store or update ML Model(s). ML Model(s) or ML Model address(es) stored in NWDAF containing MTLF are provided to the ADRF in the request message.\nInputs, Required: NF instance ID of the NWDAF containing MTLF and set of:\n-\tML model(s); or\n-\tthe tuple (unique ML Model identifier and address (e.g. URL or FQDN) of Model file and Storage size required for each of the ML Model).\nNOTE:\tThe ADRF can download ML Model files based on the ML Model addresses provided by the NWDAF containing MTLF. How the ADRF downloads the ML Model and locally stores the ML Model is left for implementation.\nInputs, Optional: None.\nOutputs Required:\n-\tResult Indication;\n-\t[Conditional] one or more tuples of unique ML Model identifier and address (e.g. URL or FQDN) of Model file stored in ADRF.\nOutputs, Optional: Storage Transaction Identifier.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.3.3\tNadrf_MLModelManagement_Delete service operation",
                            "text_content": "Service operation name: Nadrf_MLModelManagement_Delete\nDescription: This service operation instructs the ADRF to delete stored ML Model file(s) or ML Model address(es).\nInputs, Required:\n-\tStorage Transaction Identifier; or\n-\tone or more unique ML Model identifier(s).\nWhen a Storage Transaction Identifier is given, ADRF shall delete all the models that stored in the corresponding storage transaction.\nInputs, Optional: None.\nOutputs, Required: Operation execution result indication (i.e. ML Model deleted, ML Model not found, ML Model found but not deleted).\nOutputs, Optional: None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "10.3.4\tNadrf_MLModelManagement_RetrievalRequest service operation",
                            "text_content": "Service operation name: Nadrf_MLModelManagement_RetrievalRequest\nDescription: The consumer NF uses this service operation to request the ADRF to get the ML Model(s) stored in ADRF.\nInputs, Required:\n-\tStorage Transaction Identifier; or\n-\tone or more tuples of unique ML Model identifier(s).\nInputs, Optional: None.\nOutputs Required: Result Indication.\n-\t[Conditional] one or more tuples of unique ML Model identifiers and address (e.g. URL or FQDN) of Model file stored in ADRF.\nOutputs, Optional: None.\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 116,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}