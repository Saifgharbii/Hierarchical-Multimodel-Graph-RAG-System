{
    "document_name": "29512-i40.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\nY\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document provides the stage 3 specification of the Session Management Policy Control Service of 5G system. The stage 2 definition and related procedures of the Session Management Policy Control Service are contained in 3GPP TS 23.502 [3] and 3GPP TS 23.503 [6]. The 5G System Architecture is defined in 3GPP TS 23.501 [2].\nStage 3 call flows are provided in 3GPP TS 29.513 [7].\nThe Technical Realization of the Service Based Architecture and the Principles and Guidelines for Services Definition of the 5G System are specified in 3GPP TS 29.500 [4] and 3GPP TS 29.501 [5].\nThe Policy Control Function with session related policies provides the Session Management Policy Control Service to the NF server consumers (e.g. Session Management Function).\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[3]\t3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".\n[4]\t3GPP TS 29.500: \"5G System; Technical Realization of Service Based Architecture; Stage 3\".\n[5]\t3GPP TS 29.501: \"5G System; Principles and Guidelines for Services Definition; Stage 3\".\n[6]\t3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System; Stage 2\".\n[7]\t3GPP TS 29.513: \"5G System; Policy and Charging Control signalling flows and QoS parameter mapping; Stage 3\".\n[8]\tIETF RFC 9113: \"HTTP/2\".\n[9]\tIETF RFC 8259: \"The JavaScript Object Notation (JSON) Data Interchange Format\".\n[10]\tOpenAPI: \"OpenAPI Specification Version 3.0.0\", .\n[11]\t3GPP TS 29.571: \"5G System; Common Data Types for Service Based Interfaces; Stage 3\".\n[12]\t3GPP TS 29.508: \"5G System; Session Management Event Exposure Service; Stage 3\".\n[13]\t3GPP TS 29.244: \"Interface between the Control Plane and the User Plane of EPC Nodes\".\n[14]\tVoid.\n[15]\t3GPP TS 29.519: \"5G System; Usage of the Unified Data Repository service for Policy Control Data, Application Data and Structured Data for Exposure; Stage 3\".\n[16]\t3GPP TS 23.228: \"IP multimedia subsystem; Stage 2\".\n[17]\t3GPP TS 29.514: \"5G System; Policy Authorization Service; Stage 3\".\n[18]\t3GPP TS 29.214: \"Policy and Charging Control over Rx reference point 5\".\n[19]\t3GPP TS 32.291: \"5G System; Charging service; Stage 3\".\n[20]\t3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS); Stage 3\".\n[21]\t3GPP TS 23.380: \"IMS Restoration Procedures\".\n[22]\t3GPP TS 29.502: \"5G System; Session Management Services; Stage 3\".\n[23]\t3GPP TS 29.212: \"Policy and Charging Control (PCC); Reference points\".\n[24]\t3GPP TS 32.422: \"Telecommunication management; Subscriber and equipment trace; Trace control and configuration management\".\n[25]\t3GPP TS 29.507: \"5G System; Access and Mobility Policy Control Service; Stage 3\".\n[26]\t3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service description; Stage 2\".\n[27]\t3GPP TS 33.501: \"Security architecture and procedures for 5G system\".\n[28]\tIETF RFC 6749: \"The OAuth 2.0 Authorization Framework\".\n[29]\t3GPP TS 29.510: \"Network Function Repository Services; Stage 3\".\n[30]\t3GPP TS 32.290: \"5G system; Services, operations and procedures of charging using Service Based Interface (SBI)\".\n[31]\tIETF RFC 9457: \"Problem Details for HTTP APIs\".\n[32]\t3GPP TS 29.122: \"T8 reference point for Northbound APIs\".\n[33]\t3GPP TS 23.527: \"5G System; Restoration Procedures\".\n[34]\t3GPP TS 29.503: \"5G System; Unified Data Management Services; Stage 3\".\n[35]\t3GPP TS 32.255: \"Charging management; 5G data connectivity domain charging; stage 2\".\n[36]\t3GPP TS 29.518: \"5G System; Access and Mobility Management Services; Stage 3\".\n[37]\t3GPP TS 29.274: \"3GPP Evolved Packet System (EPS); Evolved General Packet Radio Service (GPRS) Tunnelling Protocol for Control plane (GTPv2-C); Stage 3\".\n[38]\t3GPP TR 21.900: \"Technical Specification Group working methods\".\n[39]\t3GPP TS 29.521: \"5G System; Binding Support Management Service; Stage 3\".\n[40]\t3GPP TS 29.524: \"Cause codes mapping between 5GC interfaces; Stage 3\".\n[41]\t3GPP TS 24.008: \"Mobile radio interface Layer 3 specification\".\n[42]\t3GPP TS 23.316: \"Wireless and wireline convergence access support for the 5G System (5GS)\".\n[43]\t3GPP TS 24.193: \"Access Traffic Steering, Switching and Splitting (ATSSS); Stage 3\".\n[44]\t3GPP TS 24.519: \"Time-Sensitive Networking (TSN) Application Function (AF) to Device-Side TSN Translator (DS-TT) and Network-Side TSN Translator (NW-TT) protocol aspects; Stage 3\".\n[45]\tIEEE Std 802.1Q-2018: \"IEEE Standard for Local and metropolitan area networks--Bridges and Bridged Networks\".\n[46]\t3GPP TS 29.551: \"5G System; Packet Flow Description Management Service; Stage 3\".\n[47]\tBBF TR-456: \"AGF Functional Requirements\".\n[48]\tCableLabs WR-TR-5WWC-ARCH: \"5G Wireless Wireline Converged Core Architecture\".\n[49]\t3GPP TS 24.539: \"5G System (5GS); Network to TSN translator (TT) protocol aspects; Stage 3\".\n[50]\t3GPP TS 29.564: \"5G System; User Plane Function Services; Stage 3\".\n[51]\t3GPP TS 29.520: \"5G System; Network Data Analytics Services; Stage 3\".\n[52]\t3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet System (EPS); Stage 3\".\n[53]\t3GPP TS 29.565: \"5G System; Time Sensitive Communication and Time Synchronization Function Services; Stage 3\".\n[54]\t3GPP TS 38.413: \"NG Radio Access Network (NG-RAN); NG Application Protocol (NGAP)\".\n[55]\tIETF RFC 8655: \"Deterministic Networking Architecture\".\n[56]\tIETF RFC 8344: \"A YANG Data Model for IP Management\".\n[57]\t3GPP TS 29.525: \"5G System; UE Policy Control Service; Stage 3\".\n[58]\t3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".\n[59]\t3GPP TS 29.522: \"5G System; Network Exposure Function Northbound APIs; Stage 3\".\n[60]\t3GPP TS 32.299: \"Charging management; Diameter charging applications\"\n[61]\t3GPP TS 29.523: \"5G System; Policy Control Event Exposure Service; Stage 3\".\n[62]\t3GPP TS 23.548: \"5G System Enhancements for Edge Computing; Stage 2\".\n[63]\t3GPP TS 29.594: \"5G System; Spending Limit Control Service; Stage 3\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tDefinitions",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms and definitions given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].\n5G QoS Flow: The finest granularity for QoS forwarding treatment in the 5G System. All traffic mapped to the same 5G QoS Flow receive the same forwarding treatment (e.g. scheduling policy, queue management policy, rate shaping policy, RLC configuration, etc.). Providing different QoS forwarding treatment requires separate 5G QoS Flow.\n5G QoS Identifier: A scalar that is used as a reference to a specific QoS forwarding behaviour (e.g. packet loss rate, packet delay budget) to be provided to a 5G QoS Flow. This may be implemented in the access network by the 5QI referencing node specific parameters that control the QoS forwarding treatment (e.g. scheduling weights, admission thresholds, queue management thresholds, link layer protocol configuration, etc.).\nAccess Traffic Steering: The procedure that selects an access network for a new data flow and transfers the traffic of this data flow over the selected access network. Access traffic steering is applicable between one 3GPP access and one non-3GPP access.\nAccess Traffic Switching: The procedure that moves all traffic of an ongoing data flow from one access network to another access network in a way that maintains the continuity of the data flow. Access traffic switching is applicable between one 3GPP access and one non-3GPP access.\nAccess Traffic Splitting: The procedure that splits the traffic of a data flow across multiple access networks. When traffic splitting is applied to a data flow, some traffic of the data flow is transferred via one access and some other traffic of the same data flow is transferred via another access. Access traffic splitting is applicable between one 3GPP access and one non-3GPP access.\nApplication detection filter: A logic used to detect packets generated by an application based on extended inspection of these packets, e.g., header and/or payload information, as well as dynamics of packet flows. The logic is entirely internal to a UPF, and is out of scope of this specification.\nApplication identifier: An identifier, referring to a specific application detection filter.\nApplication service provider: A business entity responsible for the application that is being / will be used by a UE, which may be either an AF operator or has an association with the AF operator.\nBinding: The association between a service data flow and the QoS Flow transporting that service data flow.\nBinding mechanism: The method for creating, modifying and deleting bindings.\nCharging control: The process of associating packets, belonging to a service data flow, to a charging key and applying online charging or offline charging, as appropriate.\nCharging key: information used by the CHF for rating purposes.\nDetected application traffic: An aggregate set of packet flows that are generated by a given application and detected by an application detection filter.\nDynamic PCC Rule: a PCC rule, for which the definition is provided to the SMF by the PCF.\nGating control: The process of blocking or allowing packets, belonging to a service data flow / detected application's traffic, to pass through to the UPF.\nMA PDU Session: A PDU Session that provides a PDU connectivity service, which can use one access network at a time, or simultaneously one 3GPP access network and one non-3GPP access network.\nMonitoring key: information used by the SMF and PCF for usage monitoring control purposes as a reference to a given set of service data flows or application (s), that all share a common allowed usage on a per UE and DNN and S-NSSAI basis.\nOperating System (OS): Collection of UE software that provides common services for applications.\nOperating System Identifier (OSId): An identifier identifying the operating system.\nPCC decision: A PCF decision for policy and charging control provided to the SMF (consisting of PCC rules and PDU Session related attributes), a PCF decision for access and mobility related control provided to the AMF, a PCF decision for UE access selection and PDU Session selection related policy provided to the UE or a PCF decision for background data transfer policy provided to the AF.\nPCC rule: A set of information enabling the detection of a service data flow and providing parameters for policy control and/or charging control and/or other control or support information. The possible information is described in clause 6.3.1.\nPDU Session: Association between the UE and a Data Network that provides a PDU connectivity service.\nPolicy control: The process whereby the PCF indicates to the SMF how to control the QoS Flow. Policy control includes QoS control and/or gating control.\nPolicy Control Request trigger report: a notification, possibly containing additional information, of an event which occurs that corresponds with a Policy Control Request trigger.\nPolicy Control Request trigger: defines a condition when the SMF shall interact again with the PCF.\nPredefined PCC Rule: a PCC rule that has been provisioned directly into the SMF by the operator.\nRedirection: Redirect the detected service traffic to an application server (e.g. redirect to a top-up / service provisioning page).\nService data flow: An aggregate set of packet flows carried through the UPF that matches a service data flow template.\nService data flow filter: A set of packet flow header parameter values/ranges used to identify one or more of the packet flows in the UPF. The possible service data flow filters are defined in clause 6.2.2.2.\nService data flow filter identifier: A scalar that is unique for a specific service data flow (SDF) filter within a PDU session.\nService data flow template: The set of service data flow filters in a PCC Rule or an application identifier in a PCC rule referring to an application detection filter in the SMF or in the UPF, required for defining a service data flow.\nService identifier: An identifier for a service. The service identifier provides the most detailed identification, specified for flow based charging, of a service data flow. A concrete instance of a service may be identified if additional AF information is available (further details to be found in clause 6.3.1).\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.501 [2], subclause 3.1 apply:\nOnboarding Standalone Non-Public Network\nOnboarding Network\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\nADC\tApplication Detection and Control\n5G-RG\t5G Residential Gateway\nAF\tApplication Function\nAMF\tAccess and Mobility Management Function\nAPI\tApplication Programming Interface\nATSSS\tAccess Traffic Steering, Switching, Splitting\nATSSS-LL\tATSSS Low-Layer\nBAT\tBurst Arrival Time\nBBF\tBroadband Forum\nCHEM\tCoverage and Handoff Enhancements using Multimedia error robustness feature\nCHF\tCharging Function\nDCS\tDefault Credentials Server\nDDD\tDownlink Data Delivery\nDDN\tDownlink Data Notification\nDetNet\tDeterministic Networking\nDN-AAA\tData Network Authentication, Authorization and Accounting\nDNN\tData Network Name\nDS-TT\tDevice-side TSN translator\nDTS\tData Transport Service\nEAS\tEdge Application Server\nECN\tExplicit Congestion Notification\nePDG\tevolved Packet Data Gateway\nFN-RG\tFixed Network Residential Gateway\nGEO\tGeosynchronous Orbit\nGFBR\tGuaranteed Flow Bit Rate\nGUAMI\tGlobally Unique AMF Identifier\nHFC\tHybrid Fiber Coax\nHTTP\tHypertext Transfer Protocol\nHR-SBO\tHome Routed-Session BreakOut\nI-SMF\tIntermediate SMF\nL4S\tLow Latency Low Loss Scalable Throughput\nLEO\tLow Earth Orbit\nMA\tMulti-Access\nMEO\tMedium Earth Orbit\nMPQUIC\tMulti-Path QUIC\nMPTCP\tMulti-Path TCP Protocol\nMTU\tMaximum Transmission Unit\nNAS\tNon-Access-Stratum\nNEF\tNetwork Exposure Function\nNF\tNetwork Function\nNID\tNetwork Identifier\nNRF\tNetwork Repository Function\nNWDAF\tNetwork Data Analytics Function\nNW-TT\tNetwork-side TSN translator\nON-SNPN\tOnboarding Standalone Non-Public Network\nONN\tOnboarding Network\nPCC\tPolicy and Charging Control\nPCF\tPolicy Control Function\nPFD\tPacket Flow Description\nPFDF\tPacket Flow Description Function\nPMIC\tPort Management Information Container\nPSA\tPDU Session Anchor\nPSAP\tPublic Safety Answering Point\nQoS\tQuality of Service\nRSN\tRedundancy Session Number\nRTT\tRound-Trip Time\nSDF\tService Data Flow\nSFC\tService Function ChainSMF\tSession Management Function\nSNPN\tStand-alone Non-Public Network\nS-NSSAI\tSingle Network Slice Selection Assistance Information\nSSC\tService and Session Continuity\nSUPL\tSecure User Plane for Location\nTNAN\tTrusted Non-3GPP Access Network\nTWAN\tTrusted WLAN Access Network\nTSC\tTime Sensitive Communication\nTSCAI\tTime Sensitive Communication Assistance Information\nTSCTSF\tTime Sensitive Communication and Time Synchronization Function\nTSN\tTime Sensitive Networking\nTSN GM\tTSN Grand Master\nUDM\tUnified Data Management\nUDR\tUnified Data Repository\nUE\tUser Equipment\nUL CL\tUpLink CLassifier\nUMIC\tUser plane node Management Information Container\nUPF\tUser Plane Function\nURLLC\tUltra Reliable Low Latency Communication\nURSP\tUE Route Selection Policy\nW-5GAN\tWireline 5G Access Network\nW-5GBAN\tWireline BBF Access Network\nW-5GCAN\tWireline 5G Cable Access Network\nW-AGF\tWireline Access Gateway Function\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tNpcf_SMPolicyControl Service",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tService Description",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.1.1\tOverview",
                            "text_content": "The Session Management Policy Control Service performs provisioning, update and removal of session related policies and PCC rules by the Policy Control Function (PCF) to the NF service consumer (e.g. SMF). The Session Management Policy Control Service can be used for charging control, policy control, application detection and control and/or access traffic steering, switching and splitting within a MA PDU Session. Session Management Policy Control Service applies to the cases where the SMF interacts with the PCF in the non-roaming scenario, the SMF interacts with the V-PCF in the local breakout roaming scenario and the H-SMF interacts with the H-PCF in the home-routed scenario.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.1.2\tService Architecture",
                            "text_content": "The Session Management Policy Control Service is provided by the PCF to the consumer and shown in the SBI representation model in figure 4.1.2-1 and in the reference point representation model in figure 4.1.2-2. The overall Policy and Charging Control related 5G architecture is depicted in 3GPP TS 29.513 [7].\nThe only known NF service consumer is the SMF.\nThe figure depicts a reference architecture for the Npcf_SMPolicyControl Service, illustrating the service's components and their interconnections. The Npcf_SMPolicyControl Service is a key component in the Npcf_SMPolicyControl Service, which is a key component in the Npcf_SMPolicyControl Service, which is a key component in the Npcf_SMPolicyControl Service, which is a key component in the Npcf_SMPolicyControl Service, which is a key component in the Npcf_SMPolicyControl Service, which is a key component in the Npcf_SMPolicyControl Service, which is a key component in the Npcf_SMPolicyControl Service, which is a key component in the Npcf_SMPolicyControl Service, which is a key component in the Npcf_SMPolicyControl Service, which is a key component in the Npcf_SMPolicyControl Service, which is a key component in the Npcf_SMPolicyControl Service, which is a key component in the Npcf_SMPolicyControl Service,\nFigure 4.1.2-1: Reference Architecture for the Npcf_SMPolicyControl Service; SBI representation\nThe figure depicts a reference architecture for the Npcf_SMPolicyControl Service, illustrating the reference point representation.\nFigure 4.1.2-2: Reference Architecture for the Npcf_SMPolicyControl Service; reference point representation\nNOTE:\tThe PCF represents the V-PCF in the local breakout scenario. The SMF represents the H-SMF and the PCF represents the H-PCF in the home routed scenario.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.1.3\tNetwork Functions",
                            "text_content": "The PCF is responsible for policy control decisions and flow based charging control functionalities. The PCF provides policies to the SMF, for example:\n-\tpolicies for application and service data flow detection;\n-\tgating;\n-\tQoS;\n-\tflow based charging;\n-\ttraffic steering control;\n-\tusage monitoring control;\n-\taccess traffic steering;\n-\tswitching and steering within a MA PDU Session;\n-\taccess network information report;\n-\tUMIC, PMIC and TSCAI input container; and\n-\tRAN support information to the SMF.\nThe policy decisions made by the PCF may be based on one or more of the following:\n-\tInformation obtained from the AF, e.g. the session, media and subscriber related information;\n-\tInformation obtained from the UDR;\nNOTE:\tFor local breakout roaming, session management policy data for the UE as defined in 3GPP TS 29.519 [15] is not available in the VPLMN and V-PCF uses locally configured information according to the roaming agreement with the HPLMN operator. All interactions to the UDR in this document are subject to this restriction.\n-\tInformation obtained from the AMF, e.g. UE related and access related information;\n-\tInformation obtained from the SMF;\n-\tInformation obtained from the NWDAF;\n-\tInformation obtained from the NEF;\n-\tInformation from the CHF about spending limits control;\n-\tInformation from the TSCTSF or TSN AF; and\n-\tPCF pre-configured policy context.\nThe SMF is responsible for the enforcement of session management related policy decisions from the PCF, related to service flow detection, QoS, charging, gating, traffic usage reporting, traffic steering and access traffic steering, switching and splitting within a MA PDU Session.\nThe SMF shall support:\n-\tsending the PDU session related attributes to the PCF;\n-\trequesting and receiving the PCC rule(s) from the PCF;\n-\tbinding of service data flows to QoS flow as defined in 3GPP TS 29.513 [7];\n-\tderiving rule(s) from the PCC rule(s) and then providing those rules to the user plane function or remove the rule(s) from the user plane as defined in 3GPP TS 29.244 [13];\n-\tderiving the QoS rules towards the UE;\n-\tderiving the QoS profile towards the access network;\n-\tderiving the ATSSS rules towards the UE if applicable;\n-\ttransferring the DS-TT PMIC transparently towards/from the UE/DS-TT and transferring the NW-TT U/PMIC transparently towards/from the UPF/NW-TT, if applicable;\n-\tadapting received TSCAI input information (TSC assistance container) to 5GS GM and transferring the TSCAI to the AN-RAN;\n-\thandling the policy control request trigger; and\n-\thandling the PDU session related policy information.\nNOTE:\tSMF functionality related to event exposure is defined in 3GPP TS 29.508 [12].\nThe SMF is also responsible for forwarding to the PCF the UE Policy information received from the UE in UE Policy Containers (information related to URSP delivery in EPS) and in URSP enforcement reports.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.1.4\tRules",
                            "text_content": "A rule is a set of policy information elements associated with a PDU session, or with service data flows (i.e., with a PCC rule).\nTwo types of rules are defined:\n-\tSession rule; and\n-\tPCC rule.\nBoth Session rules and PCC rules are composed of embedded information elements as well as information elements that are part of the referenced objects (e.g. condition data, or usage monitoring policy data type) by the rule.\nPCC rule is defined in clause 4.1.4.2. Session rule is defined in clause 4.1.4.3.\nA PCC rule is a set of information elements enabling the detection of a service data flow and providing parameters for policy control and/or charging control. There are two different types of PCC rules as defined in 3GPP TS 23.503 [6]:\n-\tDynamic PCC rules: PCC rules that are dynamically provisioned by the PCF to the SMF. These PCC rules may be either predefined or dynamically generated in the PCF. Dynamic PCC rules can be installed, modified and removed at any time.\n-\tPredefined PCC rules: PCC rules that are preconfigured in the SMF. Predefined PCC rules can be activated or deactivated by the PCF at any time. Predefined PCC rules within the PCF may be grouped allowing the PCF to dynamically activate a set of PCC rules.\nAdditionally, predefined PCC rules may be grouped within the SMF as predefined PCC rule bases which allow the PCF to dynamically activate these sets of rules. In this case, the PCC rule identifier is used to hold the predefined PCC rule base identifier.\nNOTE 1:\tWhen the SMF interacts with the PCF for a PCC rule base, the PCF has no way of knowing which individual PCC rule of the PCC rule base caused the interaction. If such knowledge is required for specific PCC rules, then these PCC rules need to be implemented either as dynamic PCC rules or as predefined PCC rules that are not grouped in a PCC rule base. The SMF decision logic for interacting (or not) with the PCF about an event related to a PCC rule base is up to implementation and depends on the specific issue that triggered this interaction.\nNOTE 2:\tThe operator can define a predefined PCC rule, to be activated by the SMF. Such a predefined rule is not explicitly known in the PCF.\nA PCC rule consists of:\nTable 4.1.4.2.1-1: PCC rule information elements\n\nEditor's note:\tFurther adjustments transport mode definition are FFS based on the transport mode definition in TS 23.503.\nThe above information is organized into a set of decision data objects as defined in clause 4.1.4.4. The exact encoding of PCC rules is defined in clause 5.6.2.6.\nFor dynamic PCC rules, the following applies:\n-\tInstallation: to provision the PCC rules.\n-\tModification: to modify the PCC rules.\n-\tRemoval: to remove the PCC rules.\nFor predefined PCC rules, the following operations are available:\n-\tActivation: to activate the PCC rules.\n-\tDeactivation: to deactivate the PCC rules.\nA session rule consists of policy information elements associated with PDU session. A session rule is dynamically provisioned by the PCF to the SMF (i.e., there are only dynamic session rules). The encoding of the SessionRule data type is defined in clause 5.6.2.7.\nA session rule shall include:\n-\tSession Rule Identifer.\nA session rule may include:\n-\tAuthorized Session-AMBR;\n-\tAuthorized Default QoS;\n-\tReference to Usage Monitoring Data;\n-\tReference to Usage Monitoring Data for Non-3GPP access of MA PDU session; and\n-\tReference to Condition Data.\nFor Session rules, the following applies:\n-\tInstallation: to provision the session rules.\n-\tModification: to modify the session rules.\n-\tRemoval: to remove the session rules.\nA policy decision is a grouping of cohesive information elements describing a specific type of decision, e.g. QoS, Charging data, etc. A policy decision can be linked to one or more PCC rules or one or more Session rules. A PCC rule or session rule can at most refer to one instance of the policy decision for each type.\nThe following types of policy decision are defined:\n-\tTraffic control data;\n-\tQoS data;\n-\tCharging data;\n-\tUsage Monitoring data; and\n-\tQoS Monitoring data.\nTraffic control data defines how traffic data flows associated with a rule are treated (e.g. blocked, redirected). The traffic control data encoding table is defined in clause 5.6.2.10.\nTraffic control data shall include:\n-\tTraffic Control Data ID.\nTraffic control data may include:\n-\tFlow status;\n-\tECN marking for L4S support indication;\n-\tRedirect Information;\n-\tMute Notification;\n-\tTraffic Steering Policy ID UL;\n-\tTraffic Steering Policy ID DL;\n-\tMetadata;\n-\tRouting requirements;\n-\tUP path change event subscription from the AF;\n-\tInformation on User Plane Latency requirements;\n-\tEAS IP replacement information;\n-\tIndication of traffic correlation;\n-\tCorrelation information for common EAS and DNAI selection potentially together with the NEF information for the notification related to UE members of the set of UEs identified by traffic correlation ID;\n-\tIndication of simultaneous connectivity temporarily maintained for source and target PSA during edge relocation and guidance about when the connectivity over the source PSA can be removed;\n-\tAccess Traffic Steering Functionality;\n-\tAccess Traffic Steering Mode DL;\n-\tAccess Traffic Steering Mode; and\n-\tOptionally, Access Traffic Steering Mode Indicator or Access Traffic Steering Mode Threshold;\n-\tAccess Traffic Steering Mode UL; and\n-\tAccess Traffic Steering Mode; and\n-\tOptionally, Access Traffic Steering Mode Indicator or Access Traffic Steering Mode Threshold;\n-\tMulticast Access Control; and\n-\tThe data burst end marking indication.\nQoS data defines QoS parameters (e.g. bitrates) associated with a rule. The QoS data encoding table is defined in clause 5.6.2.8.\nQoS data shall include:\n-\tQoS Data ID;\nQoS data may include:\n-\t5QI;\n-\tARP;\n-\tQNC;\n-\tMaximum Packet Loss Rate UL;\n-\tMaximum Packet Loss Rate DL;\n-\tMaximum Bit Rate UL;\n-\tMaximum Bit Rate DL;\n-\tGuaranteed Bit Rate UL;\n-\tGuaranteed Bit Rate DL;\n-\t5QI Priority Level;\n-\tAveraging window;\n-\tMaximum Data Burst Volume;\n-\tBound to default QoS flow indication;\n-\tResource Sharing Key UL;\n-\tResource Sharing Key DL;\n-\tReflective QoS attribute;\n-\tPacket Delay Budget; and\n-\tPacket Error Rate.\nNOTE:\tEither 5QI and ARP combination or Bound to default QoS flow indication is provided.\nCharging data defines charging related parameters (e.g. rating group) associated with a rule. The charging data encoding table is defined in clause 5.6.2.11.\nCharging data shall include:\n-\tCharging Data ID;\n-\tRating Group.\nCharging data may include:\n-\tMetering Method;\n-\tCharging Method;\n-\tService Data flow handling while requesting credit;\n-\tReporting Level;\n-\tService ID;\n-\tSponsor ID;\n-\tApplication Service Provider ID; and\n-\tAF Charging ID.\nUsageMonitoring data defines usage monitoring information associated with a rule. The UsageMonitoring data encoding table is defined in clause 5.6.2.12.\nUsage Monitoring Data shall include:\n-\tUsage Monitoring ID.\nNOTE:\tA Usage Monitoring ID corresponds to a valid Monitoring Key.\nUsage Monitoring Data may include:\n-\tVolume Threshold;\n-\tVolume Threshold UL;\n-\tVolume Threshold DL;\n-\tTime Threshold;\n-\tMonitoring Time;\n-\tNext Volume Threshold;\n-\tNext Volume Threshold UL;\n-\tNext Volume Threshold DL;\n-\tNext Time Threshold;\n-\tInactivity Time; and\n-\tPCC rule identifier(s) corresponding to the service data flow(s) which need to be excluded from PDU session level usage monitoring.\nQoS Monitoring data defines QoS Monitoring related parameters (e.g. request QoS monitoring parameters to be measured) associated with a rule. The QoS Monitoring data encoding table is defined in clause 5.6.2.40.\nQoS Monitoring data shall include:\n-\tQoS Monitoring Data ID;\n-\trequested QoS monitoring parameters to be measured;\n-\treporting frequency.\nQoS monitoring data may include:\n-\treporting thresholds;\n-\twait time;\n-\treporting period;\n-\ttarget of reporting;\n-\tindication of direct event notification; and\n-\tdata collection application identifier.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 4.1.4.2.1-1: PCC rule information elements",
                                    "table number": 1,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "4.1.5\tPolicy control request trigger",
                            "text_content": "A policy control request trigger is a condition pre-configured in the SMF (i.e. always report) or provisioned by the PCF to the SMF, which defines when the SMF shall interact again with PCF for further policy decision related to a PDU session.\nThe policy control request trigger is designed as an Enumeration type defined in clause 5.6.3.6.\nThe PCF can provide an array of policy control request triggers in a policy decision to subscribe to the associated triggers in the SMF.\nWhen the SMF interacts with the PCF when the condition(s) associated with policy control request triggers are met, the SMF shall the corresponding trigger(s) together with the related attribute(s) that have changed if applicable.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.1.6\tRequested rule data",
                            "text_content": "Requested rule data consists of requested information by the PCF associated with one or more PCC rules.\nThe requested rule data is designed as a subresource of the policy decision within an attribute called \"lastReqRuleData\". The PCF only records the last requested rule data.\nWhen requesting rule data, the PCF shall include the types of data requested for the rules within the \"reqData\" array of the \"lastReqRuleData\" and shall also provide the corresponding policy control request triggers if the triggers are not yet set.\nThe encoding of the requested rule data is further specified in clause 5.6.2.24.\nWhen the SMF receives the requested rule data, the SMF shall report the corresponding information to the PCF for the associated PCC rule(s).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.1.7\tRequested usage data",
                            "text_content": "Requested Usage data consists of the requested accumulated usage reports by the PCF for one or more instances of Usage Monitoring data decision.\nThe requested usage data is designed as a sub resource of the policy decision within an attribute called \"lastReqUsageData\". The PCF only records the last requested usage data.\nThe encoding of the requested usage data is further specified in clause 5.6.2.25.\nWhen the SMF receives the requested usage data attribute, the SMF shall report to the PCF the corresponding accumulated usage reports for the corresponding Usage Monitoring data decision(s). Requested usage data shall not be valid anymore for these Usage Monitoring data decision(s) after the reporting.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.1.8\tCondition data",
                            "text_content": "Condition data defines the condition(s) where the PCC rules or session rules are applicable and/or not applicable. The condition data encoding is defined in clause 5.6.2.9.\nCondition data shall include:\n-\tCondition Data ID.\nCondition data may include:\n-\tActivation Time;\n-\tDeactivation Time;\n-\tAccess Type; and\n-\tRAT Type\nNOTE:\tAccess type and RAT type are only applicable to the session rule.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.2\tService Operations",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.2.1\tIntroduction",
                            "text_content": "The service operations defined for Npcf_SMPolicyControl are shown in table 4.2.1-1.\nTable 4.2.1-1: Npcf_SMPolicyControl Operations\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 4.2.1-1: Npcf_SMPolicyControl Operations",
                                    "table number": 2,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "4.2.2\tNpcf_SMPolicyControl_Create Service Operation",
                            "text_content": "The Npcf_SMPolicyControl_Create service operation provides means for the SMF to request the creation of a corresponding SM Policy Association with PCF.\nThe Session Management procedures of the SMF and related policies are defined in 3GPP TS 23.501 [2], 3GPP TS 23.502 [3] and 3GPP TS 23.503 [6].\nThe following procedures using the Npcf_SMPolicyControl_Create service operation are supported:\n-\tRequest the creation of a corresponding SM Policy Association with the PCF.\n-\tProvisioning of PCC rules.\n-\tProvisioning of policy control request triggers.\n-\tProvisioning of charging related information for a PDU session.\n-\tProvisioning of revalidation time.\n-\tPolicy provisioning and enforcement of authorized AMBR per PDU session.\n-\tPolicy provisioning and enforcement of authorized default QoS.\n-\tProvisioning of PCC rule for Application Detection and Control.\n-\t3GPP PS Data Off Support.\n-\tIMS Emergency Session Support.\n-\tRequest Usage Monitoring Control.\n-\tAccess Network Charging Identifier report.\n-\tRequest for the successful resource allocation notification.\n-\tProvisioning of IP Index Information.\n-\tNegotiation of the QoS flow for IMS signalling.\n-\tPCF resource cleanup.\n-\tAccess traffic steering, switching and splitting support.\n-\tDNN Selection Mode Support.\n-\tDetection of the SM Policy Association enabling Time Sensitive Communications, Time Synchronization and Deterministic Networking.\n-\tSupport of Dual Connectivity end to end redundant User Plane paths.\n-\tUser Plane Remote Provisioning of UE SNPN Credentials in Onboarding Network.\n-\tNetwork slice related data rate policy control.\n-\tRequest of Presence Reporting Area Change Report.\n-\tGroup related data rate policy control.\n-\tSupport of Network Slice Usage Control.\nWhen the EMDBV feature defined in clause 5.8 is supported by both the PCF and the SMF, the PCF shall use the extMaxDataBurstVol attribute instead of the maxDataBurstVol attribute to signal maximum data burst volume values higher than 4095 Bytes.\nWhen the EMDBV feature is supported by the PCF but not supported by the SMF and the PCF needs to signal maximum data burst volume values higher than 4095 Bytes, the PCF shall use the maxDataBurstVol attribute set to 4095 Bytes.\nFor values lower than or equal to 4095 Bytes, the PCF shall use the maxDataBurstVol attribute.\nNOTE:\tMaximum data burst volume values are sent by the PCF in responses to the SMF or in an SM Policy Association Update request i.e. after feature negotiation, so the PCF knows whether the SMF supports the EMDBV feature.\n\nThe figure depicts the establishment of a Service Management Policy (SMP) association in a 5G network. It illustrates the process of establishing a connection between a Service Management System (SMS) and a Service Management Policy (SMP) in a 5G network. The figure shows the SMS and SMP as nodes, with the SMS acting as the initiator and the SMP as the responder. The SMS sends a request to the SMP, which then responds with a confirmation message. The figure also includes a visual representation of the network topology, showing the connections between the SMS and SMP nodes.\nFigure 4.2.2.2-1: SM Policy Association establishment\nWhen the NF service consumer receives the Nsmf_PDUSession_CreateSMContext Request as defined in clause 5.2.2.2 of 3GPP TS 29.502 [22], if the NF service consumer was requested not to interact with the PCF, the NF service consumer shall not interact with the PCF. Otherwise, the NF service consumer shall send an HTTP POST request to the PCF to create an \"Individual SM Policy\" resource as described in step 1 of figure 4.2.2.2-1.\nNOTE 1:\tThe decision to not interact with the PCF applies for the entire lifetime of the PDU session.\nNOTE 2:\tThe indicator to not interact with the PCF is configured in the UDM. It is delivered by the UDM to the NF service consumer within the Charging Characteristics using the Session Management Subscription Data Retrieval service operation as described in 3GPP TS 29.503 [34]. The indicator is operator specific, therefore it can only be used in non-roaming and home routed roaming cases.\nThe NF service consumer shall include the \"SmPolicyContextData\" data structure in the content of the HTTP POST request in order to request the creation of a representation of the \"Individual SM Policy\" resource as described below.\nThe NF service consumer shall include (if available) in the \"SmPolicyContextData\" data structure:\n-\tSUPI of the user within the \"supi\" attribute;\n-\tPDU Session Id within the \"pduSessionId\" attribute;\n-\tDNN within the \"dnn\" attribute;\n-\tDNN selection mode within the \"dnnSelMode\" attribute, if the \"DNNSelectionMode\" feature is supported;\n-\tURL identifying the recipient of SM policies update notifications within the \"notificationUri\" attribute;\n-\tPDU Session Type within the \"pduSessionType\" attribute;\n-\tPEI within the \"pei\" attribute;\n-\tInternal Group Id(s) within the \"interGrpIds\" attribute;\n-\ttype of access within the \"accessType\" attribute;\n-\ttype of the radio access technology within the \"ratType\" attribute;\n-\tthe combination of additional access type and RAT type within the \"addAccessInfo\" attribute, if the ATSSS feature is supported;\n-\tthe UE Ipv4 address within the \"ipv4Address\" attribute and/or the UE Ipv6 prefix within the \"ipv6AddressPrefix\" attribute;\n-\tthe UE time zone information within the \"ueTimeZone\" attribute;\n-\tthe UDM subscribed Session-AMBR or, if the \"DN-Authorization\" feature is supported, the DN-AAA authorized Session-AMBR within the \"subsSessAmbr\" attribute;\nNOTE 3:\tWhen both, the UDM subscribed Session-AMBR and the DN-AAA authorized Session-AMBR are available in the NF service consumer, the NF service consumer includes the DN-AAA authorized Session-AMBR.\n-\tif the \"VPLMN-QoS-Control\" feature is supported, the highest Session-AMBR and the default QoS supported in the VPLMN within the \"vplmnQos\" attribute, if available;\nNOTE 4:\tIn home routed roaming, the H-SMF may provide the QoS constraints received from the VPLMN (defined in 3GPP TS 23.502 [3] clause 4.3.2.2.2) to the PCF.\n-\tthe DN-AAA authorization profile index within the \"authProfIndex\" attribute, if the \"DN-Authorization\" feature is supported;\n-\tsubscribed Default QoS Information within the \"subsDefQos\" attribute;\n-\tthe number of supported packet filters for signalled QoS rules within the \"numOfPackFilter\" attribute;\n-\tthe online charging status within the \"online\" attribute;\n-\tthe offline charging status within the \"offline\" attribute;\n-\tthe charging characteristics within the \"chargingCharacteristics\" attribute;\n-\tthe access network charging identifier within the \"accNetChId\" attribute;\n-\tthe address of the network entity performing charging within the \"chargEntityAddr\" attribute;\n-\tthe 3GPP PS data off status within the \"3gppPsDataOffStatus\" attribute, if the \"3GPP-PS-Data-Off\" feature is supported;\n-\tindication of UE support of reflective QoS within the \"refQosIndication\" attribute;\n-\tuser location(s) information within the \"userLocationInfo\" attribute;\nNOTE 5:\tThe SMF encodes both 3GPP and non-3GPP access UE location in the \"userLocationInfo\" attribute when they are both received from the AMF.\n-\tthe S-NSSAI corresponding to the network slice to which the PDU session is allocated within the \"sliceInfo\" attribute;\n-\tthe required QoS flow usage for the default QoS flow within the \"qosFlowUsage\" attribute;\n-\tthe MA PDU session indication within the \"maPduInd\" attribute, if the \"ATSSS\" feature is supported;\n-\tthe ATSSS capability within the \"atsssCapab\" attribute, if the \"ATSSS\" feature is supported;\n-\tthe identifier of the serving network (the PLMN Identifier or the SNPN Identifier) within the \"servingNetwork\" attribute;\nNOTE 6:\tThe SNPN Identifier consists of the PLMN Identifier and the NID.\n-\tone or more framed routes within the \"ipv4FrameRouteList\" attribute for IPv4 and/or one or more framed routes within the \"ipv6FrameRouteList\" attribute;\nNOTE 7:\tWhen both, the UDM subscribed framed routes and the DN-AAA authorized framed routes are available in the NF service consumer, the NF service consumer includes the DN-AAA authorized framed routes. If the UDM or DN-AAA updates the framed routes during the lifetime of the PDU Session, the NF service consumer releases the PDU Session as defined in clause 4.2.5.2.\n-\tthe serving network function identifier within the \"servNfId\" attribute;\n-\twhen the \"PvsSupport\" feature is supported, the onboarding indication within the \"onboardInd\" attribute and the Provisioning Server address(es) within the \"pvsInfo\" attribute;\n-\twhen the \"SatBackhaulCategoryChg\" feature is supported, the satellite backhaul category within the \"satBackhaulCategory\" attribute;\nNOTE 8:\tWhen the \"satBackhaulCategory\" attribute is not present, non-satellite backhaul applies.\n-\twhen the \"AMInfluence\" feature is supported, the PCF for the UE callback URI and, if received, SBA binding information and, when the \"EnSatBackhaulCatChg\" feature is supported, also the dynamic satellite backhaul category, within the \"pcfUeInfo\" attribute;\n-\twhen the \"URSPEnforcement\" feature is supported, the URSP rule enforcement information provided by the UE within the \"urspEnfInfo\" attribute. In this case, the NF service consumer shall also include the SSC mode within the \"sscMode\" attribute, the UE requested DNN (if available and different from the selected DNN) within the \"ueReqDnn\" attribute, and if the PDU session is redundant, the RSN and the PDU session pair ID within the \"redundantPduSessionInfo\" attribute;\n-\ttrace control and configuration parameters information within the \"traceReq\" attribute;\n-\twhen the \"EneNA\" feature is supported, the list of NWDAF instance IDs used for the PDU Session within the \"nwdafInstanceId\" and their associated Analytic ID(s) within \"nwdafEvents\" consumed by the NF service consumer, included within the \"nwdafDatas\" attribute; and\n-\tfor HR-SBO scenario, if the \"HR-SBO\" feature is supported, the HR-SBO support indication within the \"hrsboInd\" attribute in the SM policy association.\nNOTE 9: VPLMN Specific Offloading Policy can be provisioned in HPLMN per each VPLMN based on the service level agreement between HPLMN and VPLMN.\nThe NF service consumer may include in the \"SmPolicyContextData\" data structure the IPv4 address domain identity within the \"ipDomain\" attribute.\nNOTE 10:\tThe \"ipDomain\" attribute is helpful when within a network slice, there are several separate IP address domains, with SMF/UPF(s) that allocate Ipv4 IP addresses out of the same private address range to UE PDU Sessions. The same IP address can thus be allocated to UE PDU sessions served by SMF/UPFs in different IPv4 address domains. If one PCF controls several SMF/UPFs in different IP address domains, the UE IP address is thus not sufficient for the AF session binding procedure, as described in 3GPP TS 29.514 [17]. The SMF assists the PCF in the session binding supplying an \"ipDomain\" attribute denoting the IPv4 address domain identity of the allocated UE IPv4 address.\nWhen the PCF receives the HTTP POST request from the NF service consumer, the PCF shall make a policy authorization based on the information received from the NF service consumer and, if available, information received from the AMF, the CHF, the AF, the UDR and/or the NWDAF and operator policies pre-configured at the PCF. If the policy authorization is successful, the PCF shall create a new resource, which represents a new \"Individual SM Policy\" instance, addressed by a URI as defined in clause 5.3.3.2 and containing a PCF created resource identifier. The PCF shall respond to the NF service consumer with an HTTP 201 Created response, including:\n-\ta Location header field containing the URI of the created resource; and\n-\ta response body providing the session management related policies, e.g. provisioning of PCC rules as defined in clause 4.2.6.2, provisioning of policy control request triggers as defined in clause 4.2.6.4.\nThe NF service consumer shall use the URI received in the Location header in subsequent requests to the PCF to refer to the created \"Individual SM Policy\" resource.\nIf the PCF received the list of NWDAF instance IDs used for the PDU Session in \"nwdafInstanceId\" attribute and their associated Analytic IDs in \"nwdafEvents\" attribute included within the \"nwdafDatas\" attribute the PCF may select those NWDAF instances as described in 3GPP TS 29.513 [7].\nIt the PCF received a \"traceReq\" attribute in the HTTP POST request from the SMF, it shall perform trace procedures as defined in 3GPP TS 32.422 [24].\nIf errors occur when processing the HTTP POST request, the PCF shall apply the error handling procedures specified in clause 5.7.\nIf the user information received within the \"supi\" attribute is unknown, the PCF shall reject the request with an HTTP \"400 Bad Request\" response message including the \"cause\" attribute of the ProblemDetails data structure set to \"USER_UNKNOWN\".\nIf the PCF is not able, due to incomplete, erroneous or missing information (e.g. QoS, RAT type, subscriber information), to provision a policy decision as response to the request for PCC rules from the NF service consumer, the PCF may reject the request with an HTTP \"400 Bad Request\" response message including the \"cause\" attribute of the ProblemDetails data structure set to \"ERROR_INITIAL_PARAMETERS\".\nIf the NF service consumer receives an HTTP response with the above error codes, the NF service consumer shall reject the PDU session establishment procedure that initiated the HTTP POST Request.\nIf the PCF, based on local configuration and/or operator policies, denies the creation of the Individual SM Policy resource, the PCF may reject the request with in an HTTP \"403 Forbidden\" response message including the \"cause\" attribute of the ProblemDetails data structure set to \"POLICY_CONTEXT_DENIED\". At reception of this error code and based on configured failure actions, the NF service consumer may reject or allow, by applying local policies, the PDU session establishment.\nIf the \"SamePcf\" feature as defined in clause 5.8 is supported, when the PCF determines that the same PCF shall be selected for the SM Policy associations to the same UE ID, S-NSSAI and DNN combination in the non-roaming or home-routed scenario and there is no SM Policy association for the UE ID, S-NSSAI and DNN combination, the PCF, after determining whether the BSF supports the \"SamePcf\" or the \"ExtendedSamePcf\" feature as described in 3GPP TS 29.521 [39], shall request the BSF to check if there is an existing PCF binding information for the same UE ID, S-NSSAI and DNN combination registered by other PCF(s) as defined in clause 4.2.2.2 of 3GPP TS 29.521 [39]. If the PCF receives the from the BSF \"403 Forbidden\" status code with the \"cause\" attribute of the ProblemDetails data structure set to \"EXISTING_BINDING_INFO_FOUND\" and the FQDN or description of IP endpoints of the Npcf_SMPolicyControl service of the existing PCF (i.e. that handles SM Policy association(s) to the same UE ID, S-NSSAI and DNN combination) within the \"pcfSmFqdn\" attribute or the \"pcfSmIpEndPoints\" attribute of the BindingResp data structure respectively as defined in clause 4.2.2.2 of 3GPP TS 29.521 [39], the PCF shall reply to the SMF with an HTTP \"308 Permanent Redirect\" error response and the Location header containing a URI as defined in clause 5.3.2.2, with the FQDN or IP endpoint of this PCF's Npcf_SMPolicyControl service as {apiRoot}. Upon reception of the response, the NF service consumer shall initiate a new HTTP POST request based on the returned URI.\nThe forwarding of the Origination Time Stamp parameter shall apply as described hereafter, if the NF service consumer supports the detection and handling of late arriving requests as specified in clause 5.2.3.3 of 3GPP TS 29.502 [22] and the procedure is enabled by the operator. If the NF service consumer receives a request to create an SM Context or a PDU session context, which includes the 3gpp-Sbi-Origination-Timestamp header as defined in clause 5.2.3.2, the NF service consumer shall forward this header to the PCF as HTTP custom header. See also clause 4.2.7 for the handling at the PCF, when the PCF receives the 3gpp-Sbi-Origination-Timestamp header.\nThe PCF may provide the SMF with the charging information, i.e. the CHF address(es), and if available, the associated CHF instance ID(s) and CHF set ID(s), during the initial interaction with the SMF defining the charging function respectively based on the operator policy. In this case, the PCF may retrieve the CHF addresses, and if available,  the associated CHF instance ID(s) and CHF set ID(s) as follows:\n-\tThe PCF receives it from the UDR as part of the Policy Data Subscription information, as defined in clause 5.2.10 of 3GPP TS 29.519 [15].\n-\tIt is locally configured in the PCF based on operator policies.\n-\tThe PCF discovers it by interacting with the NRF, as described in clause 6.1 of 3GPP TS 32.290 [30].\nIn order to provision the CHF information to the SMF, the PCF shall include the \"chargingInfo\" attribute containing the charging information within the SmPolicyDecision data structure.\nWithin the ChargingInformation data structure, both the primary CHF address, within the \"primaryChfAddress\" attribute, and secondary CHF address, within the \"secondaryChfAddress\" attribute, shall be provided simultaneously when the feature \"CHFsetSupport\" is not supported. When the feature \"CHFsetSupport\" is supported, the PCF shall include the \"secondaryChfAddress\" attribute if available (i.e. if previously retrieved from the UDR, locally configured in the PCF or discovered from the NRF).\nWhen the CHF supports redundancy based on NF Set concepts as described in 3GPP TS 29.500 [4], the required charging information consists of CHF address, encoded within the\"primaryChfAddress\" attribute, CHF instance, encoded within the \"primaryChfInstanceId\" attribute, and primary CHF set id, encoded within the \"primaryChfSetId\". The CHF set information may be also complemented by secondary CHF address, encoded within the \"secondaryChfAddress\", for backwards compatibility purposes with the primary/secondary redundancy mechanism.These shall overwrite any predefined CHF addresses and associated CHF instance ID and CHF set ID at the SMF.\nNOTE:\tWhen the feature \"CHFsetSupport\" is supported by the NF service consumer, it indicates the NF service consumer supports CHF redundancy based on NF Set concepts as described in 3GPP TS 29.500 [4], clause 6.5.3.\nProvisioning charging information without PCC rules for charged service data flows shall not be considered as an error, since such PCC rules may be provided later. If the PCF has provided the charging information within the SmPolicyDecision data structure during the initial interaction with the SMF, the PCF shall not modify the charging information in subsequent interactions.\nIf no charging information is provisioned by the PCF, the SMF shall use the charging information obtained via one of the following procedures, with the precedence order highest to lowest (see 3GPP TS 32.255 [35], clause 5.1.8):\n1.\tUDM provided charging characteristics.\n2.\tNRF based discovery.\n3.\tSMF locally configured charging characteristics.\nThe default charging method indicates what charging method shall be used for every PCC rule within which the charging method is omitted, i.e. either both the \"online\" and the \"offline\" attributes are not provided or only one of them is provided and set to \"false\" within the ChargingData data structure to which the PCC rule refers. The SMF may have a pre-configured default charging method.\nUpon the initial interaction with the PCF, the SMF shall provide the pre-configured default charging method, if available, within the \"offline\" attribute and/or the \"online\" attribute, and embedded directly within the SmPolicyContextData data structure of the HTTP POST message sent to the PCF.\nThe PCF may provide in the response to the received HTTP POST message the default charging method which applies to the PDU session. In order to do so, if offline charging applies, the PCF shall include the \"offline\" attribute set to \"true\" within the SmPolicyDecision data structure, or if online charging applies, the PCF shall include the \"online\" attribute set to \"true\" within the SmPolicyDecision data structure. The default charging method provided by the PCF shall overwrite any predefined default charging method available at the SMF. If the PCF has provided the default charging method during the initial interaction with the SMF, it shall not modify the default charging method in subsequent interactions.\nWhen the \"OfflineChOnly\" feature is supported, the PCF may include the \"PDU Session with offline charging only\" indication as specified in clause 4.2.2.3.3.\nNOTE:\tIt is possible that there is no default charging method applied to a PDU session.\n4.2.2.3.3\tProvisioning of the \"PDU Session with offline charging only\" indication\nIf the \"OfflineChOnly\" feature, specified in clause 5.8, is supported, the PCF may provide in the response to the received HTTP POST message from the SMF the \"PDU Session with offline charging only\" indication, within the \"offlineChOnly\" attribute, to signal that the online charging method shall never be configured for any of the PCC Rules activated during the lifetime of the PDU Session, nor provided as the Default Charging Method, as specified in clause 6.4 of 3GPP TS 23.503.\nIf the \"OfflineChOnly\" feature, specified in clause 5.8, is supported and the PCF includes the \"PDU Session with offline charging only\" indication set to \"true\" in the \"offlineChOnly\" attribute within the SmPolicyDecision data structure, then the default charging method for the PDU session is offline charging, and the \"online\" attribute and the \"offline\" attribute shall not be provisioned by the PCF within the SmPolicyDecision data structure.\nNOTE:\tIf the PCF includes the \"PDU Session with offline charging only\" indication set to \"true\" in the \"offlineChOnly\" attribute within the SmPolicyDecision data structure, and the \"online\" attribute and the \"offline\" attribute are also provisioned by the PCF within the SmPolicyDecision data structure, then the SMF could ignore the values of the \"online\" attribute and the \"offline\" attribute.\nThe PCF may provide within the SmPolicyDecision data structure the revalidation time within the \"revalidationTime\" attribute and the \"RE_TIMEOUT\" policy control request trigger within the \"policyCtrlReqTriggers\" attribute to instruct the SMF to trigger an interaction with the PCF to request PCC rule(s).\nThe SMF shall start the timer based on the revalidation time and shall trigger a PCC rule request towards the PCF before the indicated revalidation time.\nThe SMF shall, if available include either the UDM subscribed Session-AMBR or, if the \"DN-Authorization\" feature is supported, the DN-AAA authorized Session-AMBR per PDU session within the \"subsSessAmbr\" attribute in the SmPolicyContextData data structure, as defined in clause 4.2.2.2. When both the UDM subscribed Session-AMBR and the DN-AAA authorized Session-AMBR are available in the SMF, the DN-AAA authorized Session-AMBR shall take precedence over the UDM subscribed Session-AMBR.\nNOTE 1:\tThe SMF always provides either the UDM subscribed Session-AMBR or the DN-AAA authorized Session-AMBR per PDU session during an SM policy association establishment procedure except when the SM policy association corresponds to an emergency PDU session.\nIn home routed roaming, and if the \"VPLMN-QoS-Control\" feature is supported, the SMF shall provide the Session-AMBR constraints received from the VPLMN, if available, within the \"vplmnQos\" attribute.\nWhen the SMF provides the subscribed Session-AMBR to the PCF, the PCF shall authorize the Session-AMBR based on the operator's policy and, in the home routed scenario, shall ensure that the authorized Session-AMBR value does not exceed the Session-AMBR value provided by the VPLMN, if available. For emergency PDU sessions, the PCF shall behave as specified in clause 4.2.2.9.\nNOTE 2:\tIf the SMF does not provide the Session-AMBR constraints in the VPLMN to the PCF, the PCF considers that no Session-AMBR constrains apply unless operator policies define any.\nWhen network slice data rate policy control applies, the PCF shall authorize the Session-AMBR as described in clause 4.2.6.8.\nThe PCF shall provision the authorized Session-AMBR to the SMF in the response to the received HTTP POST message, as defined in clauses 4.2.6.3.1 and 4.2.6.3.2.\nUpon reception of the authorized Session-AMBR from the PCF, the SMF shall apply the corresponding procedures towards the access network, the UE and the UPF for the enforcement of the Session-AMBR for the concerned PDU session.\nDuring PDU session establishment, as defined in clause 4.2.2.2, the SMF shall, if available, include the subscribed default QoS within the \"subsDefQos\" attribute.\nNOTE 1:\tThe SMF always provides the subscribed default QoS during an SM policy association establishment procedure except when the SM policy association corresponds to an emergency PDU session.\nIn home routed roaming, and if the \"VPLMN-QoS-Control\" feature is supported, the SMF shall provide the default QoS constraints received from the VPLMN, if available, within the \"vplmnQos\" attribute.\nWhen the SMF provides the subscribed default QoS to the PCF, the PCF shall authorize the default QoS based on the operator's policy and, in the home routed scenario, shall ensure that the authorized default QoS contains 5QI and ARP values, and MBR/GBR values, if applicable, and if the feature \"VPLMN-5QIPrioLevel\" is supported, a 5QI Priority Level (when the required 5QI Priority Level is different from the standardized Default Priority Level value in the QoS characteristics Table 5.7.4-1 in 3GPP TS 23.501 [2]), supported by the VPLMN, if available. For emergency PDU sessions, the PCF shall behave as specified in clause 4.2.2.9.\nNOTE 2:\tIf the SMF does not provide the default QoS constraints in the VPLMN to the PCF, the PCF considers that no default QoS constrains apply unless operator policies define any.\nThe PCF shall provision the authorized default QoS to the SMF in the response to the received HTTP POST message, as defined in clauses 4.2.6.3.1 and 4.2.6.3.2.\nUpon reception of the authorized default QoS, the SMF enforces it, which may lead to the change of the subscribed default QoS. The SMF shall apply the corresponding procedures towards the access network, the UE and the UPF for this enforcement of the authorized default QoS for the concerned PDU session.\nNOTE 3:\tIf dynamic PCC is not deployed, the SMF can have a DNN based configuration to enable the establishment of a GBR resource type default QoS flow. This configuration contains a standardized GBR 5QI as well as GFBR and MFBR for UL and DL.\nNOTE 4:\tGBR resource type is not applicable to the default QoS flow of a PDU session that is interworking with EPS.\nIf the ADC feature is supported, and the user subscription indicates that application detection and control is required, the PCF may provision PCC rule(s) for application detection and control as defined in clause 4.2.6.2.11 in the response message to the received HTTP POST request from the SMF.\nIf the SMF receives a PCC rule for application detection and control, the SMF shall instruct the UPF to detect the associated application traffic as defined in 3GPP TS 29.244 [13].\nWhen the 3GPP-PS-Data-Off feature, as defined in clause 5.8, is supported, and if the SMF is informed that the 3GPP PS Data Off status of the UE is set to active during the establishment of a PDU session over 3GPP access and/or non-3GPP access, it shall include the \"3gppPsDataOffStatus\" attribute set to true within the SmPolicyContextData data structure in the HTTP POST message that it sends to the PCF, as defined in clause 4.2.2.2.\nIf the PCF receives that HTTP POST message with a SmPolicyContextData data structure containing a \"3gppPsDataOffStatus\" attribute set to true as above and the \"accessType\" attribute indicating \"3GPP_ACCESS\", the PCF shall configure the SMF to block any downlink and optionally uplink IP flows that are not related to a service contained in the list of 3GPP PS Data Off Exempt Services, e.g. by not installing any related dynamic PCC rule(s) or by not activating the related predefined PCC rule(s) such as PCC rule(s) with wild-carded service data flow filters. The PCF may also, subject to its normal policies, provide the PCC rule(s) for the service(s) included in the list of 3GPP PS Data Off Exempt Services, as defined in clause 4.2.6.2.1.\nThe PCF shall subscribe to the \"AC_TY_CH\" policy control request trigger with the SMF, as defined in clause 4.2.6.4, in order to support this feature, if the PCF determines that the UE is allowed to access the network via non-3GPP access.\nNOTE 1:\tThe PCF can be configured with a list of 3GPP PS Data Off Exempt Services per DNN and S-NSSAI. The list of 3GPP PS Data Off Exempt Services for an DNN and S-NSSAI can also be empty, or can allow for any service within that DNN and S-NSSAI, according to operator policy.\nNOTE 2:\tFor the PDU session used for IMS services, the 3GPP Data Off Exempt Services are enforced in the IMS domain as specified in 3GPP TS 23.228 [16]. Policies configured in the PCF need to ensure that IMS services are allowed when the 3GPP Data Off status of the UE is set to active, e.g. by treating any service within a well-known IMS DNN as part of the 3GPP PS Data Off Exempt Services.\nNOTE 3:\tThe packets transferred over non-3GPP access are unaffected by the 3GPP PS Data Off functionality.\nIf the \"ATSSS\" feature, as defined in clause 5.8 is supported, and the PCF receives in the SmPolicyContextData data structure the \"maPduInd\" attribute, the \"3gppPsDataOffStatus\" attribute set to true and the\"accessType\" attribute or the \"addAccInfo\" attribute set to \"3GPP_ACCESS\", the PCF shall configure the SMF in such a way that:\n-\tpackets for services belonging to the 3GPP PS Data Off Exempt services are forwarded over 3GPP access and non-3GPP access as indicated by the policy for ATSSS Control, as specified in clause 4.2.6.2.17; and\n-\tfor downlink and optionally uplink flows not related to a service contained in the list of 3GPP PS Data Off Exempt services, the PCF may configure the SMF to handle the associated traffic only via non-3GPP access, if available, by providing the corresponding ATSSS policy within the related PCC rule, as specified in clause 4.2.6.2.17.\nA SMF that requests PCC Rules at PDU Session Establishment for an IMS emergency session in a PLMN or an SNPN shall send an HTTP POST message to the PCF, as defined in clause 4.2.2.2, including the \"dnn\" attribute containing the Emergency DNN. The SMF may include the SUPI, within the \"supi\" attribute, and if the SUPI is not available or unauthenticated, the SMF shall include the PEI, within the \"pei\" attribute, the \"invalidSupi\" attribute set to \"true\" and an implementation specific value within the \"supi\" attribute. The SMF may include the rest of the attributes described in clause 4.2.2.2. The SMF may also include the GPSI, if available, within the \"gpsi\" attribute.\nNOTE 1:\tThe SMF will not provide subscribed information (e.g. subscribed default QoS or subscribed Session AMBR) to the PCF when the SUPI is not available, unauthenticated or based on local configuration.\nNOTE 2:\tIMS Emergency services are not supported for SNPN when the UE accesses the SNPN over NWu via a PLMN.\nThe PCF shall detect that a PDU session is restricted to IMS Emergency services when the \"dnn\" attribute included in the HTTP POST message received from the SMF includes a data network identifier that matches one of the Emergency DNs from the configurable list. The PCF does not perform in this case subscription check procedures with UDR; it uses instead the locally configured operator policies to make authorization and policy decisions. The PCF:\n-\tshall provision PCC Rules restricting the access to Emergency Services (e.g. P-CSCF(s), DHCP(s), DNS(s) and SUPL(s) addresses), as required by local operator policies, in a response message to the SMF according to the procedures described in clause 4.2.6;\n-\tmay provision the authorized QoS that applies to the default QoS flow in the response message to the SMF within the \"authDefQos\" attribute of a session rule according to the procedures described in clause 4.2.3.6, except for obtaining the authorized QoS upon interaction with the UDR. The value of the \"priorityLevel\" attribute included within the \"arp\" attribute shall be assigned as required by local operator policies (e.g. if an IMS Emergency session is prioritized, the \"priorityLevel\" attribute may contain a value that is reserved for an operator domain use of IMS Emergency sessions). If the \"accessType\" attribute is set to \"3GPP_ACCESS\", the values of the \"preemptCap\" and the \"preemptVuln\" attributes included within the \"arp\" attribute shall be assigned as required by local operator policies,\n-\tmay provision the authorized Session-AMBR in the response message to the SMF, according to the procedures described in clause 4.2.3.5.\nWhen the SMF detects that the provisioning of PCC Rules failed, the PCC rule error handling procedures shall be performed.\nIf the UMC as defined in clause 5.8 is supported, the PCF may provision the usage monitoring control policy to the SMF as defined in clause 4.2.6.5.3.\nDuring the PDU session establishment procedure, if the Access Network Charging Identifier is within the Uint32 value range, the SMF may provide the access network charging identifier information within the \"accNetChId\" attribute of the SmPolicyContextData data structure. Within the associated AccNetChId data structure, the SMF shall include the \"accNetChaIdValue\" attribute containing the Access Network Charging Identifier for the PDU session (i.e., for the default QoS flow) and the \"sessionChScope\" attribute set to true. The SMF may provide the address of the network entity performing the charging functionality within the \"chargEntityAddr\" attribute.\nNOTE:\tAs specified in 3GPP TS 32.255 [35] clause 5.1.4, the SMF assigns a charging identifier per PDU session and is used through the PDU session's lifetime. The report of Access Network Charging Identifier(s) in 5GS and EPS interworking scenarios is described in clause B.3.2.3.\nIf the \"AccNetChargId_String\" feature is supported by the SMF, and the Access Network Charging Identifier value is longer than Uint32:\n-\tif the SMF doesn’t know if the PCF supports the \"AccNetChargId_String\" feature, the SMF shall not provide the access network charging identifier information;\n-\tif the SMF knows the PCF supports the feature \"AccNetChargId_String\", the SMF shall encode the access network charging identifier within \"accNetChargIdString\" attribute.\nThe PCF may request the SMF to confirm that the resources associated to a PCC rule are successfully allocated as defined in clause 4.2.6.5.5.\nIf the PRA or ePRA feature, as defined in clause 5.8, is supported, the PCF may provision the Presence Reporting Area Information to the SMF as defined in clause 4.2.6.5.6.\nIf the PDU session type received within the \"pduSessiontype\" attribute is \"IPV4\" or \"IPV6\" or \"IPV4V6\", and no corresponding IP address/prefix is received, the PCF may include within the SmPolicyDecision data structure the IP index information within the \"ipv4Index\" attribute, for IPv4 address allocation, and/or the \"ipv6Index\" attribute, for IPv6 address allocation, based on the user's subscription information retrieved from the UDR and operator's policy.\nThe SMF may use this IP index information to assist in selecting how the IP address is to be allocated when multiple allocation methods or multiple instances of the same method are supported.\nIf the SMF includes the \"qosFlowUsage\" attribute required for the default QoS flow within the SmPolicyContextData data structure during the PDU session establishment procedure, the PCF shall provide the \"qosFlowUsage\" attribute back in the response with the authorized usage.\nIf during PDU session establishment procedure, the SMF includes the \"IMS_SIG\" value within the \"qosFlowUsage\" attribute and the PCF accepts that default QoS flow is dedicated to IMS signalling, the PCF shall within the SmPolicyDecision data structure include the \"IMS_SIG\" value within the \"qosFlowUsage\" attribute. In this case, the PCF shall restrict the QoS flow to only be used for IMS signalling as specified in 3GPP TS 23.228 [16] by applying the applicable 5QI for IMS signalling.\nIf the SMF include the \"IMS_SIG\" value within the \"qosFlowUsage\" attribute of the SmPolicyContextData data structure, but the PCF does not include the \"IMS_SIG\" within the \"qosFlowUsage\" attribute of SmPolicyDecision data structure, the PCC Rules provided by the PCF shall have a 5QI value different from the 5QI value for the IMS signalling.\nIn the Npcf_SMPolicyControl_Create service operation, the SMF as NF service consumer may provide SMF Id in \"smfId\" attribute and recovery timestamp in \"recoveryTime\" attribute. The PCF may use the \"smfId\" attribute to supervise the status of the SMF as described in clause 5.2 of 3GPP TS 29.510 [29] and perform necessary cleanup upon status change of the SMF later, and/or both the \"smfId\" attribute and the \"recoveryTime\" attribute in cleanup procedure as described in clause 6.4 of 3GPP TS 23.527 [33].\nIf the SMF supports the \"ATSSS\" feature defined in clause 5.8, the SMF shall within the SmPolicyContextData data structure include the ATSSS capability within the \"atsssCapab\" attribute and the MA PDU session Indication within the \"maPduInd\" attribute as defined in clause 4.2.2.2.\nThe SMF determines the ATSSS capability supported for the MA PDU Session based on the ATSSS capabilities provided by the UE and per DNN configuration on SMF, as follows:\na.\tIf the SMF receives the UE's ATSSS capabilities \"MPTCP functionality with any steering mode and ATSSS-LL functionality with only Active-Standby steering mode\" and;\ni.\tif the DNN configuration allows both MPTCP and ATSSS-LL with any steering mode, including RTT measurement without using PMF protocol, the SMF shall set the \"atsssCapab\" attribute to the value \"MPTCP_ATSSS_LL_WITH_ASMODE_UL\", or;\nii.\tif the DNN configuration allows both MPTCP and ATSSS-LL with any steering mode, including RTT measurement without using PMF protocol, but the UPF does not support the RTT measurement without using PMF protocol, the SMF shall set the \"atsssCapab\" attribute to the value \"MPTCP_ATSSS_LL_WITH_EXSDMODE_DL_ASMODE_UL\".\niii.\tif the DNN configuration allows MPTCP with any steering mode and ATSSS-LL with only Active-Standby steering mode, the SMF shall set the \"atsssCapab\" attribute to the value \"MPTCP_ATSSS_LL_WITH_ASMODE_DLUL\".\nb.\tIf the SMF receives the UE's ATSSS capabilities \"ATSSS-LL functionality with any steering mode\" and the DNN configuration allows ATSSS-LL with any steering mode, the SMF shall set the \"atsssCapab\" attribute to the value \"ATSSS_LL\".\nc.\tIf the SMF receives the UE's ATSSS capabilities \"MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode\", and the DNN configuration allows both MPTCP and ATSSS-LL with any steering mode, the SMF shall set the \"atsssCapab\" attribute to the value \"MPTCP_ATSSS_LL\".\nIf the SMF supports the \"EnATSSS_v2\" feature defined in clause 5.8\na.\tIf the SMF receives the UE's ATSSS capabilities \"MPQUIC functionality with any steering mode and ATSSS-LL functionality with only Active-Standby steering mode\" and;\ni.\tif the DNN configuration allows both MPQUIC and ATSSS-LL with any steering mode, including RTT measurement without using PMF protocol, the SMF shall set the \"atsssCapab\" attribute to the value \"MPQUIC_ATSSS_LL_WITH_ASMODE_UL\";\nii.\tif the DNN configuration allows both MPQUIC and ATSSS-LL with any steering mode, including RTT measurement without using PMF protocol, but the UPF does not support the RTT measurement without using PMF protocol, the SMF shall set the \"atsssCapab\" attribute to the value \"MPQUIC_ATSSS_LL_WITH_EXSDMODE_DL_ASMODE_UL\"; or\niii.\tif the DNN configuration allows MPQUIC with any steering mode and ATSSS-LL with only Active-Standby steering mode, the SMF shall set the \"atsssCapab\" attribute to the value \"MPQUIC_ATSSS_LL_WITH_ASMODE_DLUL\".\nb.\tIf the SMF receives the UE's ATSSS capabilities \"MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode\", and the DNN configuration allows both MPQUIC and ATSSS-LL with any steering mode, the SMF shall set the \"atsssCapab\" attribute to the value \"MPQUIC_ATSSS_LL\".\nc.\tIf the SMF receives the UE's ATSSS capabilities \" MPTCP functionality with any steering mode, MPQUIC functionality with any steering mode and ATSSS-LL functionality with only Active-Standby steering mode\" and;\ni.\tif the DNN configuration allows MPTCP, MPQUIC and ATSSS-LL with any steering mode, including RTT measurement without using PMF protocol, the SMF shall set the \"atsssCapab\" attribute to the value \"MPTCP_MPQUIC_ATSSS_LL_WITH_ASMODE_UL\";\nii.\tif the DNN configuration allows MPTCP, MPQUIC and ATSSS-LL with any steering mode, including RTT measurement without using PMF protocol, but the UPF does not support the RTT measurement without using PMF protocol, the SMF shall set the \"atsssCapab\" attribute to the value \"MPTCP_MPQUIC_ATSSS_LL_WITH_EXSDMODE_DL_ASMODE_UL\"; or\niii.\tif the DNN configuration allows MPTCP and MPQUIC with any steering mode and ATSSS-LL with only Active-Standby steering mode, the SMF shall set the \"atsssCapab\" attribute to the value \"MPTCP_MPQUIC_ATSSS_LL_WITH_ASMODE_DLUL\".\nd.\tIf the SMF receives the UE's ATSSS capabilities \"MPTCP functionality with any steering mode, MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode\", and the DNN configuration allows MPTCP, MPQUIC and ATSSS-LL with any steering mode, the SMF shall set the \"atsssCapab\" attribute to the value \"MPTCP_MPQUIC_ATSSS_LL\".\nIf the SMF receives the MA PDU Request Indication from the UE and the SMF determines that the MA PDU session is allowed based on the Session Management subscription data retrieved from the UDM and the operator policy, the SMF shall include the \"MA_PDU_REQUEST\" within the \"maPduInd\" attribute; otherwise if the SMF receives the MA PDU Network-Upgrade Allowed indication from the UE and the SMF determines that the MA PDU session is allowed based on the Session Management subscription data retrieved from the UDM and the operator policy, the SMF shall include the \"MA_PDU_NETWORK_UPGRADE_ALLOWED\" within the \"maPduInd\" attribute.\nIf the PCF supports the \"ATSSS\" feature, the PCF may provide PCC rules and/or session rules of ATSSS policy for the MA PDU session as defined in clause 4.2.6.2.17 and clause 4.2.6.3.4; otherwise the PCF shall not provide any PCC rules and/or session rules of ATSSS policy.\nIf the SMF supports the \"DNNSelectionMode\" feature defined in clause 5.8, when the SMF receives from the AMF the DNN selection mode, the SMF shall send an HTTP POST message as defined in clause 4.2.2.2 and shall include the received information in the \"dnnSelMode\" attribute.\nThe \"dnnSelMode\" attribute indicates whether the DNN suplied in the \"dnn\" attribute is an explicitly subscribed DNN and thus verified by the network against UDM subscription (regardless of whether it was originally provided by the UE or replaced by the network), or if it is a non-subscribed DNN (and provided by the UE, or replaced by the network).\nIf the PCF supports the \"DNNSelectionMode\" feature, when the \"dnnSelMode\" attribute indicates:\n-\tthe DNN is not explicitly subscribed, the PCF may provision PCC rules and Session rules according to the PCF local configuration for the UE provided and/or network provided non-subscribed DNN;\n-\tthe DNN is explicitly subscribed and verified by the network against UDM subscription, the PCF proceeds according to existing specified procedures.\nWhen the feature \"TimeSensitiveNetworking\" is supported, the PCF detects if the Npcf_SMPolicyControl_Create request relates to SM Policy Association enabling Time Sensitive Communications Time Synchronization and/or Deterministic Networking based on the received DNN and S-NSSAI. The PCF then may provide within the SmPolicyDecision data structure the \"TSN_BRIDGE_INFO\" policy control request trigger within the \"policyCtrlReqTriggers\" attribute to instruct the SMF to trigger a PCF interaction when the trigger is met; i.e., new TSC user plane node information (e.g. TSN Bridge or DetNet router information) is available.\nNOTE:\tTime sensitive communication, time synchronization and deterministic networking are not supported in home-routed roaming scenarios, and service continuity is not supported when the UE moves from 5GS to EPS.\nUpon the initial interaction with the PCF, if the \"Dual-Connectivity-redundant-UP-paths\" feature is supported, the PCF shall determine, based on operator's policy (e.g. when some of the allowed services require redundancy), whether the PDU session is a redundant one.\nWhen the PCF determines that the PDU session is a redundant PDU session, the PCF shall provision the \"redSessIndication\" attribute set to true within the SmPolicyDecisionData returned in the response to the HTTP POST request.Upon receiving the indication from the PCF that the PDU session is a redundant PDU session, the SMF shall apply the corresponding procedures towards the access network and the UPF for the establishment of the redundant user plane paths as defined in clause 5.33.2.1 of 3GPP TS 23.501 [2].\nThe PCF shall not modify during the PDU session lifetime the indication of whether the redundant user plane paths are allowed for the PDU session.\nUser Plane Remote Provisioning of UEs SNPN Credentials when in Onboarding Network (ONN) is provided using a PDU session for a DNN and S-NSSAI used for onboarding.\nThe PCF may make authorization and policy decisions to restrict the use of the PDU Session established to the DNN and S-NSSAI used for onboarding in an ONN, e.g., by restricting the traffic to/from Provisioning Server address(es) and DNS server address(es) only. An ONN is either an ON-SNPN or a PLMN/SNPN.\nWhen the ONN is an ON-SNPN and the \"PvsSupport\" feature is supported, during the PDU session establishment procedure related to a PDU session used for User Plane Remote Provisioning, the SMF shall include the indication that the PDU session is used for onboarding with the \"onboardInd\" attribute set to true and provide within \"pvsInfo\" attribute, if available, the information related to the Provisioning Server(s) that provisions the UE with credentials and other data to enable SNPN access.\nNOTE 1:\tWhen an SNPN that provides access to localized services is acting as ON-SNPN, the SMF includes both DCS provided and the locally configured PVS IP address(es) and/or PVS FQDN(s), in the request to the PCF.\nIf the \"onboardInd\" attribute set to true is received during the SM policy association establishment, the PCF deducts that the combination of the received DNN within \"dnn\" attribute and the S-NSSAI within \"sliceInfo\" attribute corresponds to a PDU session used for User Plane Remote Provisioning. In this case, the PCF shall omit the subscription data check with UDR. Instead, the PCF shall use the locally stored Onboarding Configuration Data for this DNN and S-NSSAI combination to make authorization and policy decisions.\nIf the \"pvsInfo\" attribute with the Provisioning Server(s) information is received in the request, the PCF shall use the received information to create the service data flow template of the Provisioning Server(s) in the derived PCC Rule(s). If the \"pvsInfo\" attribute is not received, the PCF shall construct this service data flow template(s) based on the local configuration stored as part of the Onboarding Configuration Data. In addition, the PCF may create service data flow templates for the DNS server address(es) stored as part of the Onboarding Configuration Data. The \"pvsInfo\" attribute provided by the SMF may include, for each provided Provsioning Server, the Provisioning Server IP address(es) and/or FQDN(s).\nNOTE 2:\tHow the PCF resolves a Provisioning Server FQDN to an IP address or IP address range with other mechanism than local configuration in the Onboarding Configuration Data is not specified in this release of the specification\nThe PCF shall select the QoS information of the PCC rule(s) applicable to the User Plane Remote Provisioning service based on policies locally configured at the PCF as part of the Onboarding Configuration Data.\nThe PCF shall install the derived PCC Rule(s) in the response. The installed PCC Rule(s) shall take precedence over the locally stored PCC Rule(s) in the SMF.\nWhen the SMF detects that the provisioning of PCC Rules failed, the PCC rule error handling procedures shall be performed.\nNOTE 3:\tWhen the ONN is a PLMN or a SNPN, the SMF does not provide the \"onboardInd\" attribute and the \"pvsInfo\" attribute. The PCF retrieves policy control subscription profile for this SUPI, DNN, S-NSSAI from UDR, that includes the list of allowed services. If the list of allowed services includes both PVS and DNS services, then the PCF, based on local policies, determines the PVS and DNS address(es) to be used in the SDF template of the PCC Rule(s) and allows traffic to/from these destinations as per currently specified procedures.\nWhen an Npcf_SMPolicyControl_Create request is received, the PCF may check if the S-NSSAI to which the received request relates is subject to network slice data rate policy control. If it is the case, the PCF shall apply network slice data rate control as described in clause 4.2.6.8.\nWhen an Npcf_SMPolicyControl_Create request is received, the PCF may apply group data rate control as described in clause 4.2.6.9.\nWhen the PCF receives a Npcf_SMPolicyControl_Create request and the \"NetSliceUsageCtrl\" feature is supported, the PCF may check whether the S-NSSAI to which the received request relates is subject to network slice usage control. If it is the case, the PCF may provision in the Npcf_SMPolicyControl_Create response the network slice usage control information (e.g., the slice PDU session inactivity timer value) within the \"sliceUsgCtrlInfo\" attribute of the SmPolicyDecision data structure, as specified in clause 5.15.15.3 of 3GPP TS 23.501 [2].\nNOTE:\tIn this release of the specification, network slice usage control information provisioning by the PCF is not supported in roaming scenarios.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.3\tNpcf_SMPolicyControl_UpdateNotify Service Operation",
                            "text_content": "The UpdateNotify service operation provides updated Session Management related policies to the NF service consumer (SMF) or triggers the deletion of the context of SM related policies. The POST method is used for both update and terminate operations.\nThe following procedures using the Npcf_SMPolicyControl_UpdateNotify service operation are supported:\n-\tPCF initiated update of the policies associated with a PDU session.\n-\tPCF initiated deletion of the SM Policy Association of a PDU session.\n-\tProvisioning of PCC rules.\n-\tProvisioning of policy control request triggers.\n-\tProvisioning of revalidation time.\n-\tPolicy provisioning and enforcement of the authorized AMBR per PDU session.\n-\tPolicy provisioning and enforcement of the authorized default QoS.\n-\tProvisioning of PCC rules for Application Detection and Control.\n-\t3GPP PS Data Off Support.\n-\tIMS Emergency Session Support.\n-\tRequest Access Network Information.\n-\tRequest Usage Monitoring Control.\n-\tRequest for the result of PCC rule removal.\n-\tAccess Network Charging Identifier request.\n-\tRequest successful resource allocation notifications.\n-\tIMS Restoration Support.\n-\tP-CSCF Restoration Enhancement Support.\n-\tAccess traffic steering, switching and splitting support.\n-\tPolicy provisioning and enforcement of AF session with required QoS.\n-\tForwarding of TSC user plane node management information and port management information received from the TSN AF or TSCTSF.\n-\tProvisioning of TSCAI input information and TSC QoS related data.\n-\tPolicy provisioning of QoS Monitoring control.\n-\tPolicy decision and condition data error handling.\n-\tNetwork slice related data rate policy control.\n-\tRequest of Presence Reporting Area Change Report.\n-\tPCC Rule Error Report.\n-\tSession Rule Error Report.\n-\tGroup related data rate policy control.\n-\tVPLMN Specific Offloading Policy.\n-\tSupport of Network Slice Usage Control.\nThe figure depicts a network policy update request in a 5G network, illustrating the process of updating the association between network policies and the network's state. The figure shows the network policy update request, the network state, and the network's response to the request.\nFigure 4.2.3.2-1: SM Policy Association Update request\nThe PCF may decide to provision policies related to an Individual SM Policy resource without obtaining a request from the NF service consumer, e.g. in response to information provided to the PCF via the Rx or N5 reference points, or in response to an internal trigger within the PCF, e.g., the activation of a pending policy counter provided via the Nchf_SpendingLimitControl Service (see 3GPP TS 29.594 [63]). The PCF shall send for this purpose a POST request to the NF service consumer (e.g. SMF) using the URI\"{notificationUri}/update\". The content of the message shall contain a SmPolicyNotification data structure that contains:\n-\tthe representation of the updated policies within the \"smPolicyDecision\" attribute; and\n-\tthe resource URI of the Individual SM Policy resource related to the notification within the \"resourceUri\" attribute.\nDetailed procedures related to the provisioning and enforcement of the policy decisions contained within the SmPolicyDecision data structure are provided in clause 4.2.6.\nWhen the PCF has received from an NF service consumer (e.g., an AF) temporal invalidity conditions information for a PDU session of a UE or group of UE(s), the PCF shall evaluate the temporal invalidity conditions of the AF request and may inform the SMF to install, modify or remove the corresponding policy decisions (e.g. PCC rule(s)) according to the evaluation result.\nIn case of a successful update of SM policies:\n-\tif the PCF provisioned policy control request triggers (applicable triggers are as defined in Table 5.6.2.26-1), a \"200 OK\" response code and a response body with the corresponding available information in the \"UeCampingRep\" data structure shall be returned in the response;\n-\totherwise, a \"204 No Content\" response code shall be returned in the response.\nNOTE:\tWhen there is an ongoing procedure that collisions with the update of SM policies (e.g. during handover from 5GS to EPS) the SMF, based on operator policies, can delay the update of SM policies and return a \"204 No Content\" response code. In this case the SMF will process the request when the procedure is finished.\nIf errors occur when processing the HTTP POST request, the NF service consumer shall send an HTTP error response as specified in clause 5.7.\nIf the feature \"ES3XX\" is supported, and the NF service consumer determines the received HTTP POST request needs to be redirected, the NF service consumer shall send an HTTP redirect response as specified in clause 6.10.9 of 3GPP TS 29.500 [4].\nIf the \"SessionRuleErrorHandling\" feature is not supported and the NF service consumer received one or more PCC rules from the PCF, but the validation of all these PCC Rules was unsuccessful, the NF service consumer shall reject the request and include in an HTTP \"400 Bad Request\" response message the ErrorReport data structure. Within the ErrorReport data structure, the NF service consumer shall include the \"error\" attribute containing the \"cause\" attribute of the ProblemDetails data structure set to \"PCC_RULE_EVENT\" or \"PCC_QOS_FLOW_EVENT\" and the \"ruleReports\" attribute to report the PCC rule status of the affected PCC rules as defined in clause 4.2.3.16.\nIf the \"SessionRuleErrorHandling\" feature is supported and the NF service consumer received one or more PCC rules and/or session rules from the PCF but the validation of all these PCC Rules and/or session rules was unsuccessful, the NF service consumer shall reject the request and include in an HTTP \"400 Bad Request\" response message the ErrorReport data structure. Within the ErrorReport data structure, the NF service consumer shall include the \"error\" attribute containing the \"cause\" attribute of the ProblemDetails data structure set to \"RULE_PERMANENT_ERROR\" or \"RULE_TEMPORARY_ERROR\" and the \"ruleReports\" attribute to report the PCC rule status of the affected PCC rules as defined in clause 4.2.3.16 and/or the \"sessRuleReports\" attribute to report the session rule status of the affected session rules as defined in clause 4.2.3.20.\nIf in the cases above, if the \"PolicyDecisionErrorHandling\" feature is supported, the PCF provisioned policy decisions and/or condition data which are not referred by any PCC rules or session rules and, in addition of the report of the faulty PCC rule(s) and/or session rule(s), the NF service consumer needs to report the failed policy decisions and/or condition data, the \"policyDecFailureReports\" attribute shall also be provided as described in clause 4.2.3.26. Additionally, if the \"ExtPolicyDecisionErrorHandling\" feature is supported the NF service consumer may also provide the \"invalidPolicyDecs\" as described in clause 4.2.3.26.2.\nIf the \"Ext2PolicyDecisionErrorHandling\" feature is supported, the NF service consumer did not receive neither PCC rules nor session rules and received policy decision types and/or condition types which are not referred by any PCC rules or session rules, and the storage of all the policy decision types and/or condition data was unsuccessful (e.g. the policy decision could not be successfully stored due to a limitation of resources at the SMF) or there were semantical inconsistencies in the provided data, the NF service consumer shall include in an HTTP \"400 Bad Request\" response message the ErrorReport data structure including the \"error\" attribute containing the \"cause\" attribute of the ProblemDetails data structure set to \"POL_DEC_ERROR\" and shall behave as defined in clause 4.2.3.26.\nIf the \"SessionRuleErrorHandling\" feature is not supported and if the NF service consumer received one or more PCC rules from the PCF but the validation of some of them was unsuccessful, the NF service consumer shall include an HTTP \"200 OK\" status code together with one or more RuleReport data structure(s) to report the PCC rule status of the affected PCC rules as defined in clause 4.2.3.16 in the \"PartialSuccessReport\" data structure included in the response message. The \"failureCause\" attribute of the \"PartialSuccessReport\" shall be set to \"PCC_RULE_EVENT\" or \"PCC_QOS_FLOW_EVENT\".\nIf the \"SessionRuleErrorHandling\" feature is supported and the NF service consumer received one or more PCC rule and/or session rules from the PCF but the validation of some of them was unsuccessful, the NF service consumer shall include an HTTP \"200 OK\" status code together with the \"ruleReports\" attribute to report the PCC rule status of the affected PCC rules as defined in clause 4.2.3.16 and/or the \"sessRuleReports\" attribute to report the session rule status of the affected session rules as defined in clause 4.2.3.20 in the \"PartialSuccessReport\" data structure included in the response message. The \"failureCause\" attribute of the \"PartialSuccessReport\" shall be set to \"RULE_PERMANENT_ERROR\" or \"RULE_TEMPORARY_ERROR\".\nIf the \"PolicyDecisionErrorHandling\" feature is supported, the NF service consumer received policy decision types and/or condition types which are not referred by any PCC rules or session rules, and the storage or validation of not all the policy decision types and/or condition data was unsuccessful, the NF service consumer shall reply with an HTTP \"200 OK\" response message and behave as described in clause 4.2.3.26.\nIf the PCF provisioned policy control request triggers and the NF service consumer needs to report partial success information, the NF service consumer may include in the \"PartialSuccessReport\" data structure the \"ueCampingRep\" attribute with the corresponding available information. When it is required to report multiple instances of the \"PartialSuccessReport\" data structure due to different \"failureCause\" values, the NF service consumer shall use only one instance of the \"PartialSuccessReport\" data structure to include the \"ueCampingRep\" attribute with the corresponding available information.\n\nThe figure depicts a complex network architecture, specifically focusing on the SM Policy Association termination request. It illustrates the various components involved in the termination process, such as the SM Policy Association (SPA), the termination request, and the associated signaling mechanisms. The figure provides a visual representation of the flow of information and the interactions between different components, highlighting the importance of proper signaling and termination in ensuring network reliability and performance.\nFigure 4.2.3.3-1: SM Policy Association termination request\nThe PCF may request PDU session termination and the corresponding deletion of the Individual SM policy resource in the following circumstances:\n-\tIf the PCF decides to terminate a PDU session due to an internal trigger or a trigger from the UDR.\n-\tThe PCF may also decide to terminate a PDU session upon receiving a POST message from the NF service consumer (e.g. when data usage quota is reached).\nThe PCF shall send a POST request to the NF service consumer (e.g. SMF) using the URI {notificationUri}/terminate and include the TerminationNotification data structure in the body of the HTTP POST request. Within the TerminationNotification data structure, the PCF shall include:\n-\tthe resource URI of the Individual SM policy resource related to the termination request within the \"resourceUri\" attribute; and\n-\tthe cause of why the PCF requests the termination of the policy association within the \"cause\" attribute.\nIf the NF service consumer accepts the received POST request, the NF service consumer shall send a \"204 No Content\" response.\nAfter the successful processing of the HTTP POST request, the NF service consumer shall invoke the Npcf_SMPolicyControl_Delete Service Operation defined in clause 4.2.5 to terminate the policy association and initiate the procedure to terminate the PDU session as defined in 3GPP TS 29.502 [22].\nIf errors occur when processing the HTTP POST request, the NF service consumer shall send an HTTP error response as specified in clause 5.7.\nIf the feature \"ES3XX\" is supported, and the NF service consumer determines the received HTTP POST request needs to be redirected, the NF service consumer shall send an HTTP redirect response as specified in clause 6.10.9 of 3GPP TS 29.500 [4].\nDuring the lifetime of a PDU session, within the SmPolicyDecision data structure, the PCF may provide the revalidation time within the \"revalidationTime\" attribute and the \"RE_TIMEOUT\" policy control request trigger within the \"policyCtrlReqTriggers\" attribute to instruct the SMF to trigger an interaction with the PCF to request PCC rule(s) if not provided yet. The PCF may also update the revalidation time by including the new value within the \"revalidationTime\" attribute. The PCF may disable the revalidation function by removing the \"RE_TIMEOUT\" policy control request trigger, if it has been previously provided.\nWhen the SMF receives the revalidation time within the \"revalidationTime\" attribute, the SMF shall store the received value and start the associated timer based on it. Then, the SMF shall trigger a PCC rule request towards the PCF before the indicated revalidation time.\nIf the \"RE_TIMEOUT\" policy control request trigger is removed, the SMF shall stop the associated timer.\nNOTE:\tBy disabling the revalidation function, the revalidation time value previously provided to the SMF is not applicable anymore.\nThe PCF may modify the authorized Session-AMBR at any time during the lifetime of the PDU session and provision it to the SMF by invoking the procedure defined in clause 4.2.3.2.\nIf the \"VPLMN-QoS-Control\" feature is supported, the PCF shall ensure that the authorized Session-AMBR value does not exceed the Session-AMBR supported by the VPLMN, if applicable.\nThe PCF shall provision the new authorized session AMBR to the SMF as defined in clauses 4.2.6.3.1 and 4.2.6.3.2.\nUpon reception of the authorized Session-AMBRR, the SMF shall apply the corresponding procedures towards the access network, the UE and the UPF for the enforcement of the AMBR for the concerned PDU session.\nFor UL Classifier or Multi-homing PDU Sessions, the SMF will provision the policies of session-AMBR for the downlink and uplink directions to the UL Classifier/Branching Point functionality and in addition provision the policies of Session-AMBR for the downlink direction to all the PDU session anchors, as defined in clause 5.4.4 of 3GPP TS 29.244 [13].\nThe PCF may modify the authorized default QoS during the lifetime of the PDU session and provision it to the SMF by invoking the procedure defined in clause 4.2.3.2.\nIf the \"VPLMN-QoS-Control\" feature is supported, the PCF shall ensure that the authorized default QoS contains 5QI and ARP values, and MBR/GBR values, if applicable, and if the feature \"VPLMN-5QIPrioLevel\" is supported, a 5QI Priority Level (when the required 5QI Priority Level is different from the standardized Default Priority Level value in the QoS characteristics Table 5.7.4-1 in 3GPP TS 23.501 [2]), supported by the VPLMN, if applicable.\nThe PCF shall provision the authorized default QoS to the SMF as defined in clauses 4.2.6.3.1 and 4.2.6.3.2.\nUpon reception of the authorized default QoS, the SMF enforces it, which may lead to the change of the subscribed default QoS. The SMF shall apply the corresponding procedures towards the access network, the UE and the UPF for the enforcement of the authorized default QoS for the concerned PDU session.\nIf the ADC feature is supported, the user subscription indicates that application detection and control is enabled, and the PCF determines that application detection is required because of e.g. an internal/external trigger or the PCF has received from an NF service consumer (e.g. another PCF or an AF) a subscription to the event for application start/stop traffic detection (see TS 29.514 [17], clause 4.2.6.9 for PCF subscription to application detection control and TS 29.523 [61], clause 4.2.2 for AF subscription to application detection control), the PCF may provision PCC rule(s) for application detection and control as defined in clause 4.2.6.2.11 in the notification (i.e. HTTP POST) request.\nWhen the PCF provisions PCC rule(s) for application detection and control the PCF update of the mute indication is not allowed during the PDU session lifetime, i.e., if for the PCC rule, the application's start or stop notifications are muted, the PCC rule shall remain with the application's start or stop notifications muted along the PDU session lifetime, and viceversa, if for the PCC rule, the application's start or stop notifications are not muted, the PCC rule shall remain with the application's start or stop notifications not muted along the PDU session lifetime. The SMF shall reject the PCC rule modification as specified in clause 4.2.6.2.11.\nIf the SMF receives PCC rule(s) for application detection and control, the SMF shall instruct the UPF to detect the application traffic as defined in 3GPP TS 29.244 [13].\nWhen the PCF receives service information from the AF while the 3GPP PS Data Off handling functionality is active as described in clause 4.2.2.8 or 4.2.4.8, the PCF shall check:\n-\tfor a non-MA PDU session, whether the corresponding service is a 3GPP PS Data Off Exempt Service and permissible according to the user´s subscription and the policies of the PCF;\n-\tfor a MA PDU session:\na.\twhether the corresponding service is a 3GPP Data Off Exempt Service and permissible according to the user's subscription and the policies of the PCF; or\nb.\twhether the corresponding service does not belong to the 3GPP PS Data Off Exempt Services, but:\n-\tthe non-3GPP access is available; and\n-\tthe PCF policies allow all the traffic of the service to be forwarded using the non-3GPP access.\nIf so, the PCF shall install, modify or delete thecorresponding PCC rules. For a MA PDU session and when theservice does not belong to the 3GPP PS Data Off Exempt Services, the policy for ATSSS Control included in the PCC rule, as specified in clause 4.2.6.2.17, shall enable all the traffic to be forwarded using only the non-3GPP access.\nOtherwise, the PCF shall reject the service information from the AF.\nIf the PCF determines that the 3GPP PS Data Off handling functionality becomes inactive, the PCF shall make the necessary policy control decisions and provision the PCC rules to make sure that services are allowed according to the user's subscription and operator policy (irrespective of whether they belong to the list of 3GPP PS Data Off Exempt Services).\nNOTE:\tThe PCF can then open gates via the \"flowStatus\" attribute for active PCC rules associated to services not contained in the list of 3GPP PS Data Off Exempt Services. The PCF can also install PCC rules or activate predefined PCC rules for some services not belonging to the list of 3GPP PS Data Off Exempt Services. If the PCF activates or installs a PCC rule with wildcarded filters, it can remove or de-activate PCC rules for 3GPP PS Data Off Exempt Services that are redundant to this PCC rule.\nWhen the PCF receives IMS service information from the AF for an Emergency service and derives authorized PCC Rules from the service information, the \"priorityLevel\", the \"preemptCap\" and the \"preemptVuln\" attributes of the Arp data structure within the QoS data decision to which each PCC Rule refers shall be assigned values (i.e. priority and pre-emption level) as required by local operator policies (e.g. if an IMS Emergency session is prioritized, the \"priorityLevel\" attribute may contain a value that is reserved for an operator domain use of IMS Emergency session).\nThe PCF shall immediately initiate the procedures described in clause 4.2.6.2.1 to provision the necessary PCC Rules and the procedures described in clause 4.2.6.2.3 to provision the authorized QoS perPCC rule.\nThe provisioning at the SMF of PCC Rules, which require the establishment of a dedicated QoS flow for emergency services, shall cancel the inactivity timer in the SMF, if it started running as defined in the clause 4.2.3.9.2.\nAny SMF-initiated request for PCC Rules for an IMS Emergency service with the \"repPolicyCtrlReqTriggers\" attribute containing the \"RES_MO_RE\" value (i.e. UE-initiated resource reservation) shall be rejected by the PCF via an HTTP \"403 Forbidden\" response message including the \"cause\" attribute of the ProblemDetails data structure set to \"ERROR_TRAFFIC_MAPPING_INFO_REJECTED\".\nThe SMF shall execute the procedures to ensure that a new QoS flow is established for the Emergency service.\nWhen the SMF detects that the provisioning of PCC Rules failed, the PCC rule error handling procedure shall be performed.\nThe reception by the PCF of a request to terminate an AF session for an IMS Emergency service triggers the removal by the PCF of the PCC Rules assigned to the terminated IMS Emergency Service in the SMF, using the procedure defined in clause 4.2.6.2.1.\nAt reception of an HTTP POST message that removes one or several PCC Rules from a PDU Session restricted to emergency services, the SMF shall:\n-\tinitiate a QoS flow termination procedure, when all the PCC Rules bound to a QoS flow are removed; or\n-\tinitiate a QoS flow modification procedure, when not all the PCC Rules bound to a QoS flow are removed.\nIn addition, the SMF shall initiate an inactivity timer if all PCC Rules with a 5QI other than the 5QI of the default QoS flow or the 5QI used for IMS signalling were removed from the PDU session restricted to Emergency Services (e.g. to enable PSAP Callback session). When the inactivity timer expires, the SMF shall initiate a PDU session termination procedure as defined in clause 4.2.5.\nIf the NetLoc feature defined in clause 5.8 is supported, the PCF may request the SMF to report the access network information as defined in clause 4.2.6.5.4.\nIf the UMC feature defined in clause 5.8 is supported, the PCF may provision the usage monitoring control policy to the SMF, as defined in clause 4.2.6.5.3, to request the activation of usage monitoring control.\nDuring the lifetime of the Multi-homing PDU session, the PCF shall provision the PCC rules and session rules to the SMF. The SMF shall derive the appropriate policies based on the policies provisioned by the PCF and provision them to the appropriate UPF, if applicable, access network, if applicable, and UE, if applicable.\nIf the RAN-NAS-Cause feature is supported, the PCF may request the SMF to inform it of the result of PCC rule(s) removal, when the PCF removes PCC rule(s) as defined in clause 4.2.6.5.2.\nWhen the SMF receives the request, the SMF shall maintain locally the removed PCC rules(s) until it receives the resource release outcome from the network.\nThe PCF may request the SMF to provide the Access Network Charging Identifier associated to the dynamic PCC rules as defined in clause 4.2.6.5.1.\nThe PCF may request the SMF to confirm that the resources associated to a PCC rule are successfully allocated as defined in clause 4.2.6.5.5.\nIf the SMF receives one or more PCC rule(s) as defined in clause 4.2.3.1. but the validation of all the received PCC Rules was unsuccessful, the SMF shall reject the request via an HTTP \"400 Bad Request\" status code and include in the corresponding response message the \"ruleReports\" attribute containing RuleReport data structure(s) to report the failure for the affected PCC rule(s) within the ErrorReport data structure; otherwise, if the validation of only some of the received PCC rules was unsuccessful, the SMF shall reply to the PCF with an HTTP \"200 OK\" status code and include in the corresponding response message one or more RuleReport data structure(s) to report the failure for the affected PCC rule(s) within the PartialSuccessReport data structure.\nWithin each RuleReport instance, the SMF shall identify the failed PCC rule(s) by including their identifiers within the \"pccRuleIds\" attribute, identify the failure reason code by including a \"failureCode\" attribute, and include the PCC rule(s) status within the \"ruleStatus\" attribute containing a value as follows:\n-\tIf the installation/activation of one or more new PCC rules (i.e. rules which were not previously successfully installed) fails, the SMF shall set the \"ruleStatus\" attribute value to \"INACTIVE\".\n-\tIf the modification of a currently active PCC rule fails, the SMF shall retain the existing PCC rule as active without any modification, unless the reason for the failure has an impact also on the existing PCC rule.\nThe removal of a PCC rule shall never fail, even if the related PDU session procedures with the UE fail. The SMF shall the retain information on the removal of the PDU session and conduct the necessary PDU session procedures with the UE when it is possible.\nDepending on the value of the \"failureCode\" attribute, the PCF may decide whether retaining, re-installation, modification or removal of the old PCC rule or any other action applies.\nIf the \"RuleVersioning\" feature is supported and the PCF included the \"contVer\" attribute for a specific PCC rule instance in the \"pccRules\" attribute when provisioning this PCC rule to the SMF, then if the resource allocation for the corresponding PCC rule was unsuccessful, the SMF shall include the \"contVers\" attribute in the corresponding RuleReport instance within the \"ruleReports\" attribute. Depending on the value of the \"failureCode\" attribute, and when applicable, depending also on the value of the \"contVer\" attribute, the PCF may decide whether retaining, re-installation, modification, removal of the old PCC rule or any other action applies.\nIf the ProvAFsignalFlow feature defined in clause 5.8 is supported, and in order to support IMS Restoration procedures (refer to 3GPP TS 23.380 [21]), the PCF needs to convey the AF address to the SMF. In order to do so, in case the AF provisions information about the AF signalling flows between the UE and the AF, as defined in clause 4.4.5a of 3GPP TS 29.214 [18], or in clauses 4.2.2.16 and 4.2.3.17 of 3GPP TS 29.514 [17], the PCF shall install the corresponding dynamic PCC rules (if not installed before) as defined in clause 4.2.6.2.1. The PCF shall include within the associated PccRule instance(s) the signalling flows between the UE and the AF within the \"flowInfos\" attribute and the \"afSigProtocol\" attribute set to the value corresponding to the signalling protocol used between the UE and the AF.\nThe SMF shall respond to the PCF with an HTTP \"204 no content\" and initiate the corresponding QoS flow procedures, if required. The SMF shall extract the AF address from the provisioned PCC rule(s) and use it for the monitoring procedures as defined for the different access types.\nNOTE 1:\tThe SMF can use the extracted AF address from the PCC rule(s) to check if the monitoring procedures have to be started for the corresponding AF.\nIn case the AF de-provisions information about the AF signalling flows between the UE and the AF, as defined in clause 4.4.5a of 3GPP TS 29.214 [18], or in clauses 4.2.2.16 and 4.2.3.17 of 3GPP TS 29.514 [17], the PCF shall remove the corresponding dynamic PCC rule(s) by triggering a notification (i.e. HTTP POST) message towards the SMF. The PCF shall then apply the procedures defined in clause 4.2.6.2.1.\nThe SMF shall send an HTTP response message to the PCF.\nNOTE 2:\tThe SMF can use the AF address associated with the removed PCC rule(s) to check if it can stop monitoring the corresponding AF.\nThis clause is applicable when the PCF-based P-CSCF Restoration Enhancement, as defined in 3GPP TS 23.380 [21] and controlled by the feature \"PCSCF-Restoration-Enhancement\" defined in clause 5.8, is supported by both the PCF and the SMF.\nIf the PCF receives a request for P-CSCF restoration from the P-CSCF as defined in clause 4.4.7 of 3GPP TS 29.214 [18] or in clause 4.2.2.27 of 3GPP TS 29.514 [17], the PCF shall send a notification (i.e. HTTP POST) message to the SMF including the \"pcscfRestIndication\" attribute set to true for the corresponding PDU session.\nThe SMF shall acknowledge the PCF and initiate the corresponding QoS flow procedures for the IMS PDU connection as defined in 3GPP TS 23.380 [21].\nIf the PRA or ePRA feature defined in clause 5.8 is supported, the PCF may provision the Presence Reporting Area Information to the SMF as defined in clause 4.2.6.5.6.\nIf the \"SessionRuleErrorHandling\" feature is supported and the SMF receives one or more session rule(s) as defined in clause 4.2.6.3.1 but the validation of all the received session rules was unsuccessful, the SMF shall reject the request via an HTTP \"400 Bad Request\" status code and include in the corresponding response message the \"sessRuleReports\" attribute containing SessionRuleReport data structure(s) to report the failure for the affected session rule(s) within the ErrorReport data structure; otherwise, if the validation of some of the received session rules was unsuccessful, the SMF shall reply to the PCF with an HTTP \"200 OK\" status code and include in the corresponding response message the \"sessRuleReports\" attribute containing one or more SessionRuleReport data structure(s) to report the failure for the affected session rule(s) within the PartialSuccessReport data structure.\nWithin each SessionRuleReport instance, the SMF shall identify the failed session rule(s) by including their identifier(s) within the \"ruleIds\" attribute, identify the failure reason code by including a \"sessRuleFailureCode\" attribute, and include the session rule(s) status within the \"ruleStatus\" attribute containing a value as follows:\n-\tIf the installation of one or more new session rule(s) (i.e. rules which were not previously successfully installed) fails, the SMF shall set the \"ruleStatus\" attribute value to \"INACTIVE\".\n-\tIf the modification of a currently provisioned session rule fails, the SMF shall retain the existing session rule as provisioned without any modification, unless the reason for the failure has an impact also on the existing session rule. The SMF shall report the modification failure to the PCF.\nThe removal of a session rule shall never fail, even if the related PDU session procedures with the UE fail. The SMF shall then retain information on the removal of the PDU session and conduct the necessary PDU session procedures with the UE when it is possible.\nDepending on the value of the \"sessRuleFailureCode\" attribute, the PCF may decide whether retaining, re-installation, modification or removal of the old session rule, or any other action applies.\nIf the PCF supports the \"ATSSS\" feature, the PCF may provide PCC rules and/or session rules for the MA PDU session as defined in clause 4.2.6.2.17 and clause 4.2.6.3.4.\nIf the PCF receives a QoS reference parameter during the initial provisioning of service information as defined in clause 4.2.2.32 of 3GPP TS 29.514 [17] , or if the PCF receives individual QoS parameters during the initial provisioning of service information as defined in clause 4.2.2.24 of 3GPP TS 29.514 [17], the PCF shall authorize the service information from the AF and derive the QoS parameters of the related PCC rule(s) based on the received service information and the indicated QoS reference parameter or the indicated individual QoS parameters (e.g, Requested Maximum Bitrate and Requested Guaranteed Bitrate).\nNOTE:\tA SLA has to be in place between the operator and the ASP defining the possible QoS levels and their charging rates. For each possible pre-defined QoS information set, the PCF needs to be configured with the corresponding QoS parameters and their values as well as the appropriate Charging key (or receive this information from the UDR).\nIf the PCF receives a different QoS reference parameter or different individual QoS parameters during the modification of service information as defined in clause 4.2.3.30 of 3GPP TS 29.514 [17], the PCF shall update accordingly the related QoS parameters corresponding to the new QoS parameter in the related PCC rule(s).\nIf the AF subscribes to Service Data Flow QoS notification control, the PCF may additionally receive the Alternative Service Requirements during the initial provisioning of service information as defined in clause 4.2.2.32 of 3GPP TS 29.514 [17].\nIn this case, when the PCF authorizes service information based on the indicated QoS reference parameter or individual QoS parameters, and the \"AuthorizationWithRequiredQoS\" feature is supported, the PCF shall additionally derive alternative QoS parameter sets for the concerned PCC rule(s) based on the QoS reference parameters or individual QoS parameters provided in the Alternative Service Requirements. In order to do so, the PCF shall include one or more references to the QosData data structure within the \"refAltQosParams\" attribute of the concerned PCC rule(s) and a \"qosDecs\" attribute containing these QoS data decision(s) within the SmPolicyDecision data structure. In each QoS data decision instance, the PCF shall include the alternative QoS parameter set Id within the \"qosId\" attribute, the alternative packet delay budget within the \"packetDelayBudget\" attribute, the alternative packet error rate within the \"packetErrorRate\" attribute, the alternative guaranteed bandwidth in uplink within the \"gbrUl\" attribute and the alternative guaranteed bandwidth in downlink within the \"gbrDl\" attribute. The \"refAltQosParams\" attribute is an ordered list of alternative QoS parameter sets, where the lower the index of the array for a given entry, the higher the priority.\nIf the AF changes or newly provides the Alternative Service Requirements during the modification of service information as defined in clause 4.2.3.30 of 3GPP TS 29.514 [17], the PCF shall update accordingly or provide the Alternative QoS parameter sets in the related PCC rule(s).\nIf the \"PDUSetHandling\" feature is supported and the PCF receives PDU Set QoS requirements during the initial provisioning of service information as defined in clause 4.2.2.39 of 3GPP TS 29.514 [17], the PCF shall determine the PDU Set QoS parameters based on the received requirements and include them within the \"pduSetQos\" attribute.\nThe PCF shall provision the related PCC rule(s) with alternative QoS parameter set(s) and enable QoS Notification Control, if it has not been enabled yet, as defined in clause 4.2.3.30 of 3GPP TS 29.514 [17].\nIf the \"DisableUENotification\" feature is supported and if the AF indicated to the PCF that the UE does not need to be informed about changes related to Alternative QoS Profiles as as defined in clause 4.2.2.32 or 4.2.3.30 of 3GPP TS 29.514 [17] and the PCF decides to disable the notifications to the UE when changes related to the Alternative QoS Profiles occur, the PCF shall include the \"disUeNotif\" attribute set to true within the corresponding the PCC rule instance.\nWhen the SMF receives PCC rule(s) with alternative QoS parameter sets, the SMF shall enforce these PCC rule(s)  and derive in addition the alternative QoS profile(s) towards the access network based on the received alternative QoS parameter set(s).\nDuring the lifetime of a PDU session enabling Time Sensitive Communications, Time Synchronization and Deterministic Networking the PCF may receive a UMIC and/or, when the DS-TT or the NW-TT functions are used, one or more PMIC(s) from the TSN AF or TSCTSF within the service information and/or, the indication of direct notification for the UPF to report the TSC management information as defined in 3GPP TS 29.514 [17]. A UMIC carries TSC user plane node management information. A PMIC carries port management information for a port located in DS-TT and/or NW-TT.\nNOTE:\tThe 5GS Architecture to support IETF Deterministic Networking (IETF RFC 8655 [55]) does not require the DS-TT functionality to be supported in the device nor require the user plane NW-TT functionality to be supported in the UPF. However, it can co-exist with such functions.\nIf the feature \"TimeSensitiveNetworking\" or \"TimeSensitiveCommunication\" is supported the PCF initiates the Npcf_SMPolicyControl_UpdateNotify request and sends possibly updated policy information about the PDU Session and/or the UMIC and/or the PMIC(s) to the SMF via the SmPolicyDecision structure, in which the UMIC is encoded in the \"tsnBridgeManCont\" attribute, the DS-TT PMIC is encoded in the \"tsnPortManContDstt\" attribute and the one or more NW-TT PMIC(s) are encoded in the \"tsnPortManContNwtts\" attribute.\nThe PMIC(s) are encoded in the \"PortManagementContainer\" data type, that includes the port management information in the \"portManCont\" attribute and the related port number in the \"portNum\" attribute. If the port is on DS-TT the SMF forwards the PMIC(s) to the DS-TT port. If the port is on NW-TT the SMF forwards the PMIC(s) to the NW-TT port.\nThe UMIC is encoded in the \"BridgeManagementContainer\" data type, that includes the TSC user plane node management information in the \"bridgeManCont\" attribute. The SMF always forwards the UMIC to the TSC user plane node functionality of the UPF/NW-TT.\nIf the \"ExposureToTSC\" feature is supported, and the TSCTSF or TSN AF has requested direct UPF notifications, the PCF shall set the notification URI within the \"tscNotifUri\" attribute and the notification correlation id within the \"tscNotifCorreId\" attribute corresponding to values provided by the TSCTSF or TSN AF. In this case, the SMF shall forward the received direct notification information to the UPF.\nEditor’s note:\tIt is FFS whether further adjustments to direct TSC event notification information are needed based on SA2 definition in TS 23.503.\nThe PCF may receive the TSCAI input information in the TSC assistance container and TSC traffic QoS related information from the TSN AF or TSCTSF.\nIf the feature \"TimeSensitiveNetworking\" or \"TimeSensitiveCommunication\" is supported by both the SMF and PCF as described in clause 5.8, the PCF shall provide for the derived PCC rule(s):\n-\tthe 5G QoS parameters and the optional 5G QoS characteristics corresponding to a 5QI for a delay-critical GBR derived from the TSC traffic QoS information received from the TSN AF or TSCTSF encoded within a QosData type referred in the \"refQosData\" of the PCC rule; and\n-\tthe TSCAI input information as received from the TSN AF or TSCTSF, which may contain the periodicity, and burst arrival time encoded in the \"tscaiInputUl\" attribute and/or \"tscaiInputDl\" attribute of the PCC rule, when the feature \"TimeSensitiveCommunication\" is supported, the survival time encoded in the \"tscaiInputUl\" attribute and/or \"tscaiInputDl\" attribute and the (TSN)AF (g)PTP domain encoded in the \"tscaiTimeDom\" attribute, and when the feature \"EnTSCAC\" is supported, the burst arrival time window within the \"burstArrivalTimeWnd\" attribute, or capability for BAT adaptation encoded in the \"capBatAdaptation\" attribute, and either the acceptable periodicity range includes a lower bound encoded in the \"lowerBound\" attribute and an upper bound encoded in the\"upperBound\" attribute or a list of the acceptable periodicity value(s) encoded in the \"periodicVals\" attribute within the \"periodicityRange\" attribute.\nThe values of MDBV and PDB applied to the derived 5QI shall follow principles defined in clause 5.27.3 of 3GPP TS 23.501 [2].\nFor IEEE TSN networks, the value of the MBR, if applicable, and the GBR are derived using the Maximum Bit Rate provided by the TSN AF. For other time sensitive communication networks, the value of the GBR may be derived using the input provided by the TSCTSF (e.g. the Minimum Bit Rate) and applying the QoS mapping procedures as specified in clause 7.3.3 of 3GPP TS 29.513 [7].\nThe ARP is assigned a value preconfigured for TSC services.\nAs specified in clause 4.2.3.22, when the PCF receives a QoS reference from the TSCTSF, the PCF shall derive the above QoS parameters based on pre-defined QoS parameters referenced by the QoS reference.  When the PCF receives individual QoS parameters from the TSCTSF, the PCF shall set derived QoS parameters based on the received individual QoS parameters and applying the QoS mapping procedures as specified in clause 7.3.3 of 3GPP TS 29.513 [7].\nIf the PCF receives Alternative Service Requirements that contain QoS references from the TSCTSF, the PCF shall derive the alternative QoS parameter set(s) based on the pre-defined QoS parameters referenced by the received Alternative Service Requirements as defined in clause 4.2.3.22. If the PCF receives Alternative Service Requirements that contain Requested Alternative QoS Parameter Set(s) from the TSCTSF, the PCF shall set the alternative QoS parameter set(s) based on the Requested Alternative QoS Parameter Set(s) contained in the received Alternative Service Requirements as defined in clause 4.2.3.22.\nThe SMF shall convert the received TSCAI input information from the external GM into the 5G GM based on the time offset and cumulative rateRatio (when available) between external time and 5GS time as measured and reported by the UPF and, forward the derived TSCAI parameters per QoS Flow basis to the AN-RAN as follows:\n-\tFor the traffic in downlink direction, the SMF shall correct the value of the \"burstArrivalTime\" attribute of the \"tscaiInputDl\" attribute based on the latest received time offset measurement from the UPF and set the downlink TSCAI Burst Arrival Time as the sum of the corrected value and the CN PDB as described in clause 5.7.3.4 of 3GPP TS 23.501 [2], representing the latest possible time when the first packet of the data burts arrives at the AN.\n-\tFor the traffic in uplink direction, the SMF shall correct the value of \"burstArrivalTime\" attribute of the \"tscaiInputUl\" attribute based on the latest received time offset measurement from the UPF and set the uplink TSCAI Burst Arrival Time as the sum of corrected value and the UE-DS-TT Residence Time representing the latest possible time when the first packet of the data burst arrives at the egress of the UE. How the SMF corrects the Burst Arrival Time if the UE-DS-TT residence time has not been provided by the UE is up to SMF implementation.\n-\tThe SMF shall correct the value of \"periodicity\" attribute of the \"tscaiInputUl\" and/or \"tscaiInputDl\" using the cumulative rateRatio if the cumulative rateRation measurement was previously received from the UPF and set the TSCAI Periodicity as the corrected value. Otherwise, the SMF shall set the periodicity in the TSCAI Periodicity without any correction.\n-\tIf the \"TimeSensitiveCommunication\" feature is supported and the TSCAI Survival Time Information is received:\n-\twhen the \"surTimeInNumMsg\" attribute is received, the SMF shall convert the value of \"surTimeInNumMsg\" attribute of the \"tscaiInputUl\" and/or \"tscaiInputDl\" attributes into time units by multiplying its value by the corrected uplink TSCAI Periodicity and/or downlink TSCAI Periodicity respectively, and set the TSCAI Survival Time to the calculated value; or\n-\twhen the \"surTimeInTime\" is received, the SMF shall correct the value of \"surTimeInTime\" attribute of the \"tscaiInputUl\" and/or \"tscaiInputDl\" attributes using the cumulative rateRatio if the cumulative rateRatio measurement was previously received from the UPF and set the TSCAI Survival Time to the corrected value. Otherwise, the SMF shall set the TSCAI Survival Time without correction.\n-\tIf the \"EnTSCAC\" feature is supported and the burst arrival time is provided, either the burst arrival time window or the capability for BAT adaptation may be received:\n-\twhen the burst arrival time window is received, for the traffic in downlink direction, the SMF shall correct the value of the \"burstArrivalTimeWnd\" attribute of the \"tscaiInputDl\" attribute in the same ways it is described for the correction of the burst arrival time in downlink as above and for the traffic in uplink direction, the SMF shall correct the value of \"burstArrivalTimeWnd\" attribute of the \"tscaiInputUl\" attribute in the same ways it is described for the correction of the burst arrival time in uplink in this clause; or\nNOTE 1:\tIt is preferred that the range of the \"burstArrivalTimeWnd\" attribute contains the value of the \"burstArrivalTime\".\n-\twhen the capability for BAT adaptation is received, the SMF shall set the value of \"capBatAdaptation\" attribute as the value of capability for BAT adaptation in the TSCAI.\n-\twhen the PCF receives the subscription for the notification on network provided BAT offset from the AF/NEF or TSCTSF, then PCF shall include \"BAT_OFFSET_INFO\" policy control request trigger within the \"policyCtrlReqTriggers\" attribute in the SmPolicyDecision data structure, if it has not been provisioned yet.\n-\twhen the burst arrival time window is received, if the periodicity range (either the acceptable periodicity range or the acceptable periodicity set) is received, the SMF shall correct the value of the \"lowerBound\" attribute and the \"upperBound\" attribute, or the \"periodicVals\" attribute within the \"periodicityRange\" attribute of the \"tscaiInputUl\" and/or \"tscaiInputDl\" using the same way as it is described for the correction of the periodicity in this clause.\n-\tIf the \"EnTSCAC\" feature is supported and the burst arrival time is not provided, only the capability for BAT adaptation may be received:\n-\twhen the value of the \"capBatAdaptation\" attribute as the capability for BAT adaptation is received, the SMF enables notification control for the QoS Flow (if not already enabled) in order to receive the BAT offset along with the \"GFBR can no longer be guaranteed\" notification from the NG-RAN.\nIf the \"TimeSensitiveCommunication\" feature is supported, depending on whether the Time Domain information is included in the \"tscaiTimeDom\" attribute of the PCC rule, SMF may perform the following:\n-\tif the \"tscaiTimeDom\" attribute is not included in the PCC rule, the SMF provisions the UPF/NW-TT to report the clock drifting between 5G clock and the external GM clock for the (g)PTP time domain number that is configured to the NW-TT.\n-\tif the \"tscaiTimeDom\" attribute is included in the PCC rule and does not indicate Time Domain = \"5GS\", the SMF provisions the UPF/NW-TT to report the clock drifting between 5G clock and the external GM clock for the received Time Domain information.\nNOTE 2:\tThe Time Domain value corresponding to \"5GS\" is locally configured in the SMF and in the TSCTSF and indicates that the AF does not provide a Time Domain, as specified in 3GPP TS 29.565 [53], and it is not needed to adjust the TSCAI input information. The omission of the Time Domain within the \"tscaiTimeDom\" attribute of the PCC rule indicates it is needed to apply the TSN AF time domain, configured in the NW-TT, to adjust the TSCAI input information.\nThe SMF shall use the N4 Association Setup or Update procedures as described in 3GPP TS 29.244 [13] to provision the UPF to report the clock drifting.\nIf the SMF receives the clock drifting from the UPF for a Time Domain, and\n-\tif the received Time Domain matches the Time Domain information within the \"tscaiTimeDom\" attribute included in the PCC rule; or\n-\tthe \"tscaiTimeDom\" attribute is not included within the PCC rule,\nthen the SMF may determine the time offset and cumulative rateRatio (when available) based on received Time Domain information and adjust the TSCAI information as described above.\nIf the received clock drifting from the UPF does not match the Time Domain information within the \"tscaiTimeDom\" attribute of the PCC rule or the received \"tscaiTimeDom\" attribute of the PCC rule indicates Time Domain = \"5GS\" then the SMF will not adjust the TSCAI information.\nThe provisioning of TSCAI input information and TSC traffic QoS configuration per PCC Rule shall be performed using the PCC rule provisioning procedure as defined in clause 4.2.6.2.1.\nThe QoS Monitoring control refers to the real time measurement of QoS parameters between the UE and the UPF for a QoS flow.\nNOTE 1:\tThe AF can request measurements for one or more QoS parameters, which can trigger QoS monitoring control for service data flow(s). This clause describes QoS monitoring control for packet delay, congestion, and data rate.\nIf the \"QosMonitoring\" feature is supported, the PCF may generate the authorized QoS Monitoring data decision for the service data flow for packet delay based on the QoS Monitoring request if received from the AF, or when the feature \"EnSatBackhaulCatChg\" is supported, based on PCF local policy or configuration as described in subclause 4.2.3.25.2.\nThe PCF, when the request is received from the AF, may determine whether the QoS monitoring report is sent to the AF/NEF by the SMF bypassing the PCF or by the PCF. When the feature \"ExposureToEAS\" is supported and the AF indication of direct notification is received, the PCF may determine whether duplicate notification by the UPF is required, i.e., whether the QoS monitoring report is directly sent to the local AF/NEF and to the PCF/SMF. When the \"UPEAS\" feature is supported, the PCF may generate a Data Collection Application Identifier based on the AF request or local configuration to be used in the SMF to associate the PCC rule with a QoS monitoring event exposure subscription.\nThe PCF shall include within the SmPolicyDecision data structure one or more QosMonitoringData instances within the \"qosMonDecs\" attribute if not provided yet and, if the PCF determines that the QoS monitoring report shall be sent by the PCF from the SMF, \"QOS_MONITORING\" within the \"policyCtrlReqTriggers\" attribute, if it has not been provisioned yet.\nNOTE 2:\tThe QoS monitoring report can be sent by the SMF to the PCF as described in clause 4.2.4.24. The QoS monitoring report of the PCF to the AF/NEF is described in 3GPP TS 29.514 [17], the QoS monitoring report of the SMF to the AF/NEF bypassing the PCF is described in 3GPP TS 29.508 [12] and the QoS monitoring report to the Local NEF/AF by the UPF is described in 3GPP TS 29.564 [50].\nWhen the features \"QoSMonitoring\" and \" NscSupportedFeatures\" are supported and if the NEF/AF provided information about the support of \"QoSMonitoring\" feature on Nsmf_EventExposure service, the PCF may also include this information within the \"nscSuppFeats\" attribute included within the PccRule data type.\nFor each QosMonitoringData instance, PCF shall include:\n-\tthe requested QoS monitoring parameter(s) to be measured (i.e. DL/UL round trip packet delay and/or, if the \"EnQoSMon\" feature is supported, congestion information and/or data rate) within the \"reqQosMonParams\" attribute;\n-\tthe frequency(s) of reporting (e.g. event triggered and/or periodic) within the \"repFreqs\" attribute;\n-\tfor the case the \"repFreqs\" attribute includes the value \"EVENT_TRIGGERED\":\na.\tfor QoS monitoring for packet delay:\n-\tthe delay threshold for downlink with the \"repThreshDl\" attribute if \"reqQosMonParams\" attribute includes DOWNLINK;\n-\tthe delay threshold for uplink with the \"repThreshUl\" attribute if \"reqQosMonParams\" attribute includes UPLINK; and/or\n-\tthe delay threshold for round trip with the \"repThreshRp\" attribute if \"reqQosMonParams\" attribute includes ROUND_TRIP;\nb.\tfor QoS monitoring for data rate:\n-\tthe data rate threshold for downlink within the \"repThreshDatRateDl\" attribute if the \"reqQosMonParams\" attribute includes DOWNLINK_DATA_RATE; and/or\n-\tthe data rate threshold for uplink within the \"repThreshDatRateUl\" attribute if the \"reqQosMonParams\" attribute includes UPLINK_DATA_RATE;\nc.\tfor QoS monitoring for congestion information:\n-\tthe congestion threshold for downlink within the \"repThreshConDl\" attribute if the \"reqQosMonParams\" attribute includes DOWNLINK_CONGESTION; and/or\n-\tthe data rate threshold for uplink within the \"repThreshConUl\" attribute if the \"reqQosMonParams\" attribute includes UPLINK_CONGESTION; and\nd.\tthe minimum waiting time between subsequent reports within the \"waitTime\" attribute; and\ne.\tif the feature \"PacketDelayFailureReport\" or \"EnQoSMon\" is supported, the maximum period with no QoS measurement results reported within the\"repPeriod\" attribute;\n-\tfor the case the \"repFreqs\" attribute includes \"PERIODIC\", the periodic time for reporting and, if the feature \"PacketDelayFailureReport\" or \"EnQoSMon\" is supported, the maximum period with no QoS measurement results reported within the \"repPeriod\" attribute;\n-\teither the notification URI within the \"notifyUri\" attribute and the notification correlation id within the \"notifyCorreId\" attribute if the PCF determines that the notification shall be sent to the AF directly from the SMF or the notification URI within the \"notifyUri\" attribute, the notification correlation id within the \"notifyCorreId\" attribute corresponding to the Local NEF or AF and the \"directNotifInd\" attribute set to true if the feature \"ExposureToEAS\" and/or the feature \"EnQoSMon\" is supported and the PCF determines that the direct notification by the UPF to the Local NEF or AF is required based on the indication of direct notification received from the AF; and\nEditor’s note:\tIt is FFS whether new data type structure is needed for QoS monitoring control for multi-modal services.\nNOTE 3:\tIf the feature \"ExposureToEAS\" is supported and if the PCF determines to receive QoS Monitoring report while direct UPF notification is also required, the PCF can provision the \"QOS_MONITORING\" policy control request trigger to the SMF together with the \"directNotifInd\" attribute set to true.\nEditor’s note:\tWhether the applicable reporting frequency for the Data Rate QoS monitoring can be event triggered and/or periodic is FFS.\n-\tthe Data Collection Application Identifier within the \"dataCollAppId\" attribute if the \"UPEAS\" feature is supported and if the PCF determines that the SMF has to associate the PCC rule with a QoS monitoring event exposure subscription for that application identifier as described in 3GPP TS 29.508 [12].\nIf the feature \"EnQoSMon\" is supported, and QoS monitoring control is for data rate, may include the averaging window within the \"avrgWndw\" attribute.\nThe PCF shall include the value of QoS Monitoring Data ID of QosMonitoringData instance within the \"refQosMon\" attribute of the corresponding PCC rule and provide the QoS monitoring data decision together with the PCC rule if it has not been provisioned to the SMF. When the SMF receives the PCC rule, the SMF shall send a QoS Monitoring request to the PSA UPF via N4 as defined in 3GPP TS 29.244 [13] and NG-RAN via N2 signalling to request the QoS monitoring between PSA UPF and NG-RAN as defined in 3GPP TS 29.502 [22]. If the feature \"ExposureToEAS\" is supported and if the SMF receives both the \"QOS_MONITORING\" policy control request trigger and the indication of direct notifcation, the SMF shall request the UPF to perform duplicated notification as defined in 3GPP TS 29.244 [13]. If the \"UPEAS\" feature is supported, when the SMF receives the Data Collection Application Identifier within the \"dataCollAppId\" attribute as part of the QoSMonitoringData instance of the PCC rule, the SMF shall associate the PCC rule with the QoS monitoring event exposure subscription related to that application identifier as described in 3GPP TS 29.508 [12].\nIf the PCF receives the request from the local NEF/AF to disable the QoS monitoring from the AF or the Local NEF, the PCF shall update the PCC rule with the \"refQosMon\" attribute set to NULL. The PCF may also remove the corresponding QoS Monitoring Data if no PCC rule is referring to it.\nIf the PCF receives the request to disable the direct event notification to the local NEF or AF by the UPF, the PCF shall determine whether the PCF or the SMF bypassing the PCF sends the QoS monitoring reports to the local AF/NEF:\na.\tif the QoS monitoring reports are sent by the SMF bypassing the PCF:\n-\tupdate the PCC rule with the \"refQosMon\" attribute referring a QosMonitoringData instance which does not include the \"directNotifInd\" attribute set to true and still includes the \"notifyUri\", and the \"notifyCorreId\" attributes; or\n-\tupdate the corresponding QosMonitoringData instance by including the \"directNotifInd\" attribute set to false and still keeping the \"notifyUri\", and the \"notifyCorreId\" attributes;\nb.\tif the QoS monitoring reports are sent by the PCF:\n-\tupdate the PCC rule with the \"refQosMon\" attribute referring a QosMonitoringData instance which does not include the \"directNotifInd\", the \"notifyUri\", and the \"notifyCorreId\" attributes or update the QosMonitoringData instance by removing the \"directNotifInd\", the \"notifyUri\", and the \"notifyCorreId\" attributes; and\n-\tprovision the value \"QOS_MONITORING\" within the \"policyCtrlReqTriggers\" attribute, if not previously provided.\nThe SMF shall request to the UPF to disable the notification to the AF/(Local)NEF via N4 as defined in 3GPP TS 29.244 [13] and shall start sending the related notifications to PCF or to the indicated Notification URI and notification correlation Id, as applicable.\nIf the PCF determines that QoS monitoring report shall be sent to the PCF from the SMF instead of sent from the SMF bypassing the PCF, the PCF shall replace the QosMonitoringData instance with an instance that does not include the \"notifyUri\" and the \"notifyCorreId\" attributes and include \"QOS_MONITORING\" within the \"policyCtrlReqTriggers\" attribute if it has not been provisioned yet. If the PCF determines that QoS monitoring report shall be sent from the SMF bypassing the PCF instead of sent from the SMF to the PCF, the PCF shall update the QosMonitoringData instance by including the the notification URI within the \"notifyUri\" attribute and the notification correlation id within the \"notifyCorreId\" attribute, and remove the value \"QOS_MONITORING\" within the \"policyCtrlReqTriggers\" attribute.\nIf the features \"QosMonitoring\" and \"EnSatBackhaulCatChg\" are supported, and if dynamic satellite backhaul is used, QoS monitoring may be used by the PCF to measure packet delay as specified in clause 4.2.3.25.1.\nIf the PCF has subscribed to backhaul category changes within the \"SAT_CATEGORY_CHG\" policy control request trigger as described on clause 5.6.3.6, and the dynamic satellite backhaul is used to serve the PDU session, the PCF may, based on the local policy or configuration, request QoS Monitoring for the packet delay between UE and PSA UPF and the corresponding QoS Monitoring reports. The PCF shall include within the SmPolicyDecision data structure one or more QosMonitoringData instances within the \"qosMonDecs\" attribute if not provided yet, within the affected PCC rules, a reference to the corresponding QosMonitoringData instance, and the \"QOS_MONITORING\" value within the \"policyCtrlReqTriggers\" attribute, if it has not been provisioned yet The PCF may take the reported packet delay information into account for the policy decision along with other criteria, such as the AF requested QoS requirements.\nIf the \"PolicyDecisionErrorHandling\" feature is supported and the \"ExtPolicyDecisionErrorHandling\" feature is not supported, and the SMF receives one or more policy decision type(s) (as defined in clause 4.1.4.4) and/or condition data (as defined in clause 4.1.8), which are not referred by any provisioned PCC rule or session rule as defined in clause 4.2.3.2, but the storage of the policy decision types and/or condition data was unsuccessful (e.g. the policy decision could not be successfully stored due to a limitation of resources at the SMF) or there are semantical inconsistencies in the provided data, the SMF shall behave as follows:\n-\tInclude an HTTP \"200 OK\" status code and one or more PolicyDecisionFailureCode data types to indicate the type(s) of the failed policy decisions and/or condition data in the response message, if the SMF does not need to report any other information (e.g. the failure reports of the PCC rule(s) or session rule(s) which are provisioned in the same message, are not needed).\n-\tInclude an HTTP \"200 OK\" status code and one or more PartialSuccessReport data structure(s) including the \"policyDecFailureReports\" attribute to indicate the type(s) of the failed policy decisions and/or condition data and the \"failureCause\" attribute set to \"POL_DEC_ERROR\" in the response message, if the SMF needs to report partial success (e.g. some of the PCC rules and/or session rules provisioned by the PCF in the same message were not installed/activated successfully).\n-\tInclude an HTTP \"400 Bad Request\" status code and the ErrorReport data structure including the \"policyDecFailureReports\" attribute to indicate the type(s) of the failed policy decisions and/or condition data in the response message, if the SMF needs to reject the request (e.g. all the PCC rules and/or session rules provisioned by the PCF in the same message were not installed/activated successfully).\nNOTE:\tAn error within a policy decision type and/or condition data not referred by any PCC rules or session rules is encoded within the \"policyDecFailureReports\" attribute as specified in the PolicyDecisionFailureCode data structure defined in clause 5.6.3.28.\nWhen the PCF receives the above reports, the PCF shall consider all the instances of the policy decisions and/or condition data which were provisioned in the request message and indicated in the PolicyDecisionFailureCode data type as removed from the SMF. When the PCF receives a response with HTTP \"400 Bad Request\" status code but the \"policyDecFailureReports\" attribute is not included in the provided ErrorReport data structure, the PCF shall consider all the provisioned instances of the policy decsions and/or condition data in the request message as removed from the SMF.\nThe removal of a policy decision type and/or condition data shall not fail.\nIf the \"ExtPolicyDecisionErrorHandling\" feature is supported and the SMF receives one or more policy decision type(s) (as defined in clause 4.1.4.4) and/or condition data (as defined in clause 4.1.8), which are not referred by any provisioned PCC rule or session rule as defined in clause 4.2.3.2, and/or other SM policy decisions (e.g. the SMF receives policy control request triggers and applicable additional information) and the SMF detects that the received policy decision(s) cannot be enforced (e.g, because of semantical inconsistencies in the provided data):\n-\tIf the SMF does not need to reject the request (e.g. none, or only some but not all, of the PCC rule(s) and/or session rule(s) provisioned by the PCF in the same message are not installed/activated successfully), the SMF shall include one or more PartialSuccessReport data structure(s) in the response message with an HTTP \"200 OK\" status code. In order to report the partial success of policy decision and/or condition data, the SMF shall include in the related PartialSuccessReport data structure(s) the \"failureCause\" attribute set to \"POL_DEC_ERROR\" and the \"policyDecFailureReports\" attribute to indicate the failed policy decision type(s) and/or condition data that are not referred by any provisioned PCC rule or session rule and/or in other SM policy decision(s), and may include the \"invalidPolicyDecs\" attribute to provide more details on these failed policy decision type(s) and/or condition data that are not referred by any provisioned PCC rule or session rule and/or other SM policy decisions.\n-\tIf the SMF needs to reject the request (e.g. all the PCC rules and/or session rules provisioned by the PCF in the same message are not installed/activated successfully), the SMF shall include an ErrorReport data structure within a response message with an HTTP \"400 Bad Request\" status code. The SMF shall include the \"policyDecFailureReports\" attribute to indicate a failed policy decision type(s) and/or condition data that are not referred by any provisioned PCC rule or session rule and/or in other SM policy decisions, and may include the \"invalidPolicyDecs\" attribute to provide more details on these failed policy decision types and/or condition data that are not referred by any provisioned PCC rule or session rule and/or other SM policy decisions. In addition, when \"Ext2PolicyDecisionErrorHandling\" feature is supported and the NF service consumer needs to reject the request because the PCF only provided policy decision/condition data and all of them were faulty, the NF service consumer shall include the ErrorReport data structure with the \"error\" attribute containing the \"cause\" attribute of the ProblemDetails data structure set to \"POL_DEC_ERROR\".\nNOTE 1:\tAn error within a policy decision type and/or condition data not referred by any PCC rules or session rules and/or an error in other policy decisions is encoded within the \"policyDecFailureReports\" attribute as specified in the PolicyDecisionFailureCode data structure defined in clause 5.6.3.28.\nWhen the PCF receives the above reports, the PCF shall behave as follows:\n-\tFor the policy decisions and/or condition data:\na.\tThe PCF shall consider all the instances of the policy decision(s) and/or condition data which are provisioned in the request message and indicated in the PolicyDecisionFailureCode data type as removed from the SMF.\nb.\tWhen the PCF receives a response with HTTP \"400 Bad Request\" status code but the \"policyDecFailureReports\" attribute is not included in the provided ErrorReport data structure, the PCF shall consider all the provisioned instance(s) of the policy decision(s) and/or condition data in the request message as removed from the SMF.\nc.\tThe removal of a policy decision type and/or condition data shall not fail.\n-\tFor the other policy decisions:\na.\tThe PCF shall consider all the new failed policy decisions provisioned in the request message and indicated in the PolicyDecisionFailureCode data type as not installed in the SMF.\nb.\tThe PCF shall consider all the modified policy decisions provisioned in the request message and indicated in the PolicyDecisionFailureCode data type as unmodified in the SMF.\nc.\tThe PCF shall consider all the removed policy decisions provided in the request message as deleted in the SMF.\nNOTE 2:\tThe removal of a policy decision does not fail. Even if there is an inconsistency e.g. between the deletion of a policy control request trigger and the deletion of the applicable additional information, the whole related policy decision is removed.\nAt the time a PCF-initiated change of the authorized Session-AMBR occurs or PCC Rule(s) for GBR service data flow(s) need to be provisioned at the SMF, the PCF may check if the concerned S-NSSAI is subject to network slice data rate policy control. If it is the case, the PCF shall apply network slice data rate control as described in clause 4.2.6.8.\nAt the time a PCF-initiated change of the authorized Session-AMBR occurs or PCC Rule(s) for GBR service data flow(s) need to be provisioned at the SMF, the PCF may apply group data rate control as described in clause 4.2.6.9.\nIf the \"PowerSaving\" feature is supported, the PCF may send the Periodicity information \"periodInfo\" attribute received from the AF or NEF and together with the indication for SMF to request the UPF to perform the Traffic Parameter(s) measurement within the PCC rules. The Traffic Parameter(s) to be measured includes the downlink periodicity associated N6 jitter range and the Uplink and/or downlink periodicity information \"periodInfo\" attribute if the Periodicity information is not received from the AF.\nIf the PCC rule indicates to perform the Traffic Parameter(s) measurement, the SMF requests the UPF to monitor and periodically report the measured Traffic Parameter(s) using the N4 Session Modification procedure. Upon reception of the measured Traffic Parameter(s) from the UPF, the SMF includes the measured N6 jitter range and the associated downlink periodicity in the TSCAI and forwards it to the NG-RAN to assist configuration UE power saving.\nWhen a PCF-initiated change of the SM policies shall be performed by the PCF via the Npcf_SMPolicyControl_UpdateNotify service operation and the \"NetSliceUsageCtrl\" feature is supported, the PCF may check whether the S-NSSAI of the concerned SM Policy Association is subject to network slice usage control. If it is the case, the PCF may provision/update/remove in the Npcf_SMPolicyControl_UpdateNotify request the network slice usage control information (e.g., the slice PDU session inactivity timer value) within the \"sliceUsgCtrlInfo\" attribute of the SmPolicyDecision data structure provided within the \"smPolicyDecision\" attribute of the SmPolicyNotification data structure.\nNOTE:\tIn this release of the specification, network slice usage control information provisioning/update/removal by the PCF is not supported in roaming scenarios.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.4\tNpcf_SMPolicyControl_Update Service Operation",
                            "text_content": "The Npcf_SMPolicyControl_Update service operation provides means for the NF service consumer to inform the PCF that a policy control request trigger condition has been met and for the PCF to inform the NF service consumer of any resulting update of the Session Management related policies.\nThe following procedures using the Npcf_SMPolicyControl_Update service operation are supported:\n-\tProvisioning of PCC rules.\n-\tProvisioning of policy control request triggers.\n-\tRequest the policy based on revalidation time.\n-\tPolicy provisioning and enforcement of authorized AMBR per PDU session.\n-\tPolicy provisioning and enforcement of authorized default QoS.\n-\tApplication detection information reporting.\n-\tIndication of QoS Flow Termination Implications.\n-\t3GPP PS Data Off Support.\n-\tRequest and report Access Network Information.\n-\tRequest Usage Monitoring Control and report Accumulated Usage.\n-\tIpv6 Multi-homing support.\n-\tRequest and report the result of PCC rule removal.\n-\tAccess Network Charging Identifier Request and report.\n-\tRequest and report the successful resource allocation notification.\n-\tNegotiation of the QoS flow for IMS signalling.\n-\tNotification about Service Data Flow QoS target enforcement.\n-\tRequest the termination of SM Policy association.\n-\tReporting of TSC user plane node management information and port management information.\n-\tQoS Monitoring Report.\n-\tPolicy decision and condition data error handling.\n-\tRequest the policy after DDN failure events.\n-\tNetwork slice related data rate policy control.\n-\tPresence Reporting Area Information Report.\n-\tPCC Rule Error Report.\n-\tSession Rule Error Report.\n-\tUE initiates a resource modification support.\n-\tTrace Control.\n-\tGroup related data rate policy control.\n-\tSupport of Network Slice Usage Control.\n\nThe figure depicts a network setup with various components such as base stations (BTS), user equipment (UE), and scatterers. It illustrates the signal propagation in a 5G network, highlighting the importance of beamforming techniques to mitigate interference. The figure also shows the fiber-optic backbone architecture, which is a key component of 5G networks, providing redundancy and failover reliability.\nFigure 4.2.4.2-1: Requesting the update of the Session Management related policies\nWhen the NF service consumer detects that one or more policy control request triggers are met, the NF service consumer shall send a POST request to the PCF to update an Individual SM Policy resource. The {smPolicyId} in the URI identifies the Individual SM Policy resource to be updated. The NF service consumer include SmPolicyUpdateContextData data structure in the content of the HTTP POST to request a update of representation of the \"Individual SM Policy\" resource. The NF service consumer shall include the met policy control request trigger(s) within the \"repPolicyCtrlReqTriggers\" attribute and applicable updated value(s) in the corresponding attribute(s).\nThe NF service consumer shall include (if the corresponding policy control request trigger is met and the applicable information is available) in SmPolicyUpdateContextData data structure:\n-\ttype of access within the \"accessType\" attribute;\n-\ttype of the radio access technology within the \"ratType\" attribute;\n-\tthe new allocated UE Ipv4 address within the \"ipv4Address\" attribute and/or the UE Ipv6 prefix within the \"ipv6AddressPrefix\" attribute;\n-\tan additional new allocated UE Ipv6 prefix within the \"addIpv6AddrPrefixes\" attribute, if the \"MultiIpv6AddrPrefix\" feature is supported;\n-\tmultiple new allocated UE Ipv6 prefixes within the \"multiIpv6Prefixes\" attribute, if the \"UnlimitedMultiIpv6Prefix\" feature is supported;\n-\tthe released UE Ipv4 address within the \"relIpv4Address\" attribute and/or the UE Ipv6 prefix within the \"relIpv6AddressPrefix\" attribute;\n-\tan additional released UE Ipv6 prefix within the \"addRelIpv6AddrPrefixes\" attribute, if the \"MultiIpv6AddrPrefix feature\" is supported;\n-\tmultiple released UE Ipv6 prefixes within the \"multiRelIpv6Prefixes\" attribute, if the \"UnlimitedMultiIpv6Prefix feature\" is supported;\n-\tthe UE MAC address within the \"ueMac\" attribute;\n-\tthe released UE MAC address within the \"relUeMac\" attribute;\n-\tthe indication of UE supporting reflective QoS within the \"refQosIndication\" attribute;\n-\taccess network charging identifier within the \"accNetChIds\" attribute;\n-\tthe 3GPP PS data off status within the \"3gppPsDataOffStatus\" attribute, if the \"3GPP-PS-Data-Off\" feature is supported;\n-\tthe UE time zone information within the \"ueTimeZone\" attribute;\n-\tthe UDM subscribed Session-AMBR or, if the \"DN-Authorization\" feature is supported, the DN-AAA authorized Session-AMBR within the \"subsSessAmbr\" attribute;\nNOTE 1:\tWhen both, the UDM subscribed Session-AMBR and the DN-AAA authorized Session-AMBR are available in the NF service consumer, the NF service consumer includes the DN-AAA authorized Session-AMBR.\n-\tif the \"VPLMN-QoS-Control\" feature is supported, the highest Session-AMBR and the default QoS supported in the VPLMN within the \"vplmnQos\" attribute, if available;\nNOTE 2:\tIn home routed roaming, the H-SMF may provide the QoS constraints received from the VPLMN (defined in 3GPP TS 23.502 [3] clause 4.3.2.2.2) to the PCF.\n-\tif the \"DN-Authorization\" feature is supported, the DN-AAA authorization profile index within the \"authProfIndex\" attribute;\n-\tsubscribed Default QoS Information within the \"subsDefQos\" attribute;\n-\tdetected application information within the \"appDetectionInfos\" attribute;\n-\tif the \"UMC\" feature is supported, the accumulated usage reports within the \"accuUsageReports\" attribute;\n-\tif the \"PRA\" feature is supported, the reported presence reporting area information within the \"repPraInfos\" attribute;\n-\tthe QoS flow usage required of the default QoS flow within the \"qosFlowUsage\" attribute;\n-\tindication whether the QoS targets of one or more SDFs are not guaranteed or guaranteed again within the \"qncReports\" attribute;\n-\tuser location(s) information within the \"userLocationInfo\" attribute;\nNOTE 3:\tThe SMF encodes both 3GPP and non-3GPP access UE location in the \"userLocationInfo\" attribute when they are both received from the AMF.\n-\tif the \"GroupIdListChange\" feature is supported, the Internal Group Identifier(s) of the served UE within the \"interGrpIds \" attribute;\n-\tif the \"SatBackhaulCategoryChg\" feature is supported, the satellite backhaul category or non-satellite backhaul and, when the \"EnSatBackhaulCatChg\" feature is supported, also the dynamic satellite backhaul category, within the \"satBackhaulCategory\" attribute;\n-\tif the \"AMInfluence\" feature is supported, the PCF for the UE callback URI and, if received, SBA binding information within the \"pcfUeInfo\" attribute;\n-\tserving network function identifier within the \"servNfId\" attribute;\n-\tidentifier of the serving network within the \"servingNetwork\" attribute;\n-\twhen the \"URSPEnforcement\" feature is supported, the URSP rule enforcement information provided by the UE within the \"urspEnfInfo\" attribute. In this case, the NF service consumer shall also include, if they were not previously provided, the SSC mode within the \"sscMode\" attribute, the UE requested DNN (if available and different from the selected DNN) within the \"ueReqDnn\" attribute, and/or if the PDU session is redundant, the RSN and the PDU session pair ID within the \"redundantPduSessionInfo\" attribute. The NF service consumer shall also provide the \"accessType\" attribute, if changed compared to the latest reported value;\n-\tif the \"EnTSCAC\" feature is supported, the BAT offset and the optionally adjusted periodicity within the \"batOffsetInfo\" attribute;\n-\twhen the \"EneNA\" feature is supported, the list of NWDAF instance IDs used for the PDU Session within the \"nwdafInstanceId\" and their associated Analytic ID(s) within \"nwdafEvents\" updated with the new values included within the \"nwdafDatas\" attribute;\nNOTE 4:\tThe NF service consumer provides the complete updated list of NWDAF instance IDs and associated Analytic ID(s) used for the PDU session. If all NWDAF data is deleted an empty list is included.\n-\tfor HR-SBO scenario, if the \"HR-SBO\" feature is supported, the H-SMF may include the HR-SBO support indication within the \"hrsboInd\" attribute; and\nNOTE 5:\tThe \"PLMN_CH\" trigger has to be provisioned in order to report this information.\n-\tif the\"NetSliceRepl\" feature is supported and the NF service consumer reports a change from the initial S-NSSAI of the PDU Session to the Alternative S-NSSAI via the \"NET_SLICE_REPL\" PCRT, the Alternative S-NSSAI used to replace the existing S-NSSAI for the PDU Session within the \"sliceInfo\" attribute.\nEditor’s Note: Whether the initial S-NSSAI is provided to the PCF when the NF service consumer reports a change from the Alternative S-NSSAI to the initial S-NSSAI of the PDU Session via the \"NET_SLICE_REPL\" PCRT is FFS and pending stage 2 feedback.\n\nThe NF service consumer may include in \"SmPolicyUpdateContextData\" data structure the IPv4 address domain identity within the \"ipDomain\" attribute.\nIn case of a successful update, \"200 OK\" response shall be returned. The PCF shall include in the \"200 OK\" response the representation of the updated policies within the SmPolicyDecision data structure. Detailed procedures related to the provisioning and enforcement of the policy decisions within the SmPolicyDecision data structure are contained in clause 4.2.6.\nNOTE 6:\tAn empty SmPolicyDecision data structure is included in the \"200 OK\" response when the PCF decides not to update policies.\nIf the PCF received a new list of NWDAF instance IDs used for the PDU Session in \"nwdafInstanceId\" attribute and their associated Analytic IDs in \"nwdafEvents\" attribute included within the \"nwdafDatas\" attribute the PCF may select those NWDAF instances based on this new list as described in 3GPP TS 29.513 [7].\nIf errors occur when processing the HTTP POST request, the PCF shall send an HTTP error response as specified in clause 5.7.\nIf the feature \"ES3XX\" is supported, and the PCF determines the received HTTP POST request needs to be redirected, the PCF shall send an HTTP redirect response as specified in clause 6.10.9 of 3GPP TS 29.500 [4].\nIf the PCF is, due to incomplete, erroneous or missing information (e.g. QoS, RAT type, subscriber information) not able to provision a policy decision as response to the request for PCC rules by the NF service consumer, the PCF may reject the request and include in an HTTP \"400 Bad Request \" response message the \"cause\" attribute of the ProblemDetails data structure set to \"ERROR_INITIAL_PARAMETERS\".\nIf the PCF receives the set of session information which is sent in the message originated due to a trigger being met is incoherent with the previous set of session information for the same session (E.g. trigger met was RAT changed, and the RAT notified is the same as before), the PCF may reject the request and include in an HTTP \"400 Bad Request\" response message the \"cause\" attribute of the ProblemDetails data structure set to \"ERROR_TRIGGER_EVENT\".\nIf the PCF detects that the packet filters in the request for new PCC rules received from the NF service consumer is covered by the packet filters of outstanding PCC rules that the PCF is provisioning to the NF service consumer, the PCF may reject the request and include in an HTTP \"403 Forbidden\" response message the \"cause\" attribute of the ProblemDetails data structure set to \"ERROR_CONFLICTING_REQUEST\".\nIf the PCF does not accept one or more of the traffic mapping filters provided by the NF service consumer in an HTTP POST request (e.g. because the PCF does not allow the UE to request enhanced QoS for services not known to the PCF), the PCF shall reject the request and include in an HTTP \"403 Forbidden\" response message the \"cause\" attribute of the ProblemDetails data structure set to \"ERROR_TRAFFIC_MAPPING_INFO_REJECTED\".\nIf the NF service consumer receives HTTP response with these codes, the NF service consumer shall reject the PDU session modification that initiated the HTTP Request.\nThe PCF shall not combine a rejection with provisioning of PCC rule operations in the same HTTP response message.\nIf the timer for the policy revalidation is started, the SMF shall send the PCC rule request before the indicated revalidation time. The SMF shall within the SmPolicyUpdateContextData data structure include RE_TIMEOUT within the \"repPolicyCtrlReqTriggers\" attribute. The SMF shall stop the timer once the SMF sends the HTTP POST request.\nNOTE 1:\tThe PCF is expected to be prepared to provide a new policy, as desired for the revalidation time, during a preconfigured period before the revalidation time. The preconfigured periods in the SMF and PCF need to be aligned.\nThe PCF may instruct the SMF to revalidate the provided PCC rules by including the \"revalidationTime\" attribute within the SmPolicyDecision in the HTTP POST response.\nNOTE 2:\tIf the PCF omits the \"revalidationTime\" attribute the revalidation function remains enabled, but the timer remains stopped till the PCF provides a revalidation time within the \"revalidationTime\" attribute.\nWhen the SMF receives the HTTP POST response message, the SMF shall start the timer for revalidation based on the received value of revalidation time if the revalidation function is not disabled; otherwise, the SMF shall not start the timer for revalidation.\nThe PCF may disable the revalidation function by removing the RE_TIMEOUT policy control request trigger in the HTTP POST response message. If the revalidation function is disabled, the SMF shall ignore any received value of revalidation time and shall not start the timer for revalidation.\nNOTE 3:\tBy disabling the revalidation function the revalidation time value previously provided to the SMF is not applicable anymore.\nWhen the SMF detects that the Session-AMBR changes, the SMF shall notify of the change to the PCF by invoking the procedure defined in clause 4.2.4.2, and shall include the new Session-AMBR within the \"subsSessAmbr\" attribute and the \"SE_AMBR_CH\" policy control request trigger within the \"repPolicyCtrlReqTriggers\" attribute.\nIf the \"DN-Authorization\" feature is supported, when both, the UDM subscribed Session-AMBR and the DN-AAA authorized Session-AMBR are available in the SMF, the DN-AAA authorized/re-authorized Session-AMBR shall take precedence over the changes on UDM subscribed Session-AMBR.\nIf the \"VPLMN-QoS-Control\" feature is supported,\n-\tin the home routed scenario, when the SMF detects that the Session-AMBR supported in the VPLMN changes (i.e. when the UE moves from the HPLMN to a VPLMN with Session-AMBR constraints or between VPLMNs with different Session-AMBR constraints), the SMF shall notify of the change to the PCF by invoking the procedure defined in clause 4.2.4.2, and shall include the new VPLMN Session-AMBR within the \"vplmnQos\" attribute and the \"VPLMN_QOS_CH\" policy control request trigger within the \"repPolicyCtrlReqTriggers\" attribute.\n-\twhen the SMF detects that the UE moves from a VPLMN with Session-AMBR constraints to a VPLMN where the QoS constraints are not applicable in the home routed scenario or the UE moves back to the non-roaming scenario, the SMF shall notify the PCF that the QoS constraints in the VPLMN are not applicable by invoking the procedure defined in clause 4.2.4.2, and shall include the \"vplmnQosNotApp\" attribute set to true and the \"VPLMN_QOS_CH\" policy control request trigger within the \"repPolicyCtrlReqTriggers\" attribute.\nUpon receiving the change of Session-AMBR, the PCF shall ensure that the authorized Session-AMBR value does not exceed the Session-AMBR supported by the VPLMN, if applicable, and provision the new authorized Session-AMBR to the SMF in the response as defined in clauses 4.2.6.3.1 and 4.2.6.3.2.\nUpon receiving the authorized Session-AMBR from the PCF, the SMF shall apply the corresponding procedures towards the access network, the UE and the UPF for the enforcement of the AMBR per PDU session.\nFor UL Classifier or Multi-homing PDU Session, the SMF will provision the policies of session-AMBR for downlink and uplink direction to the UL Classifier/Branching Point functionality and in addition provision the policies of session-AMBR in the downlink direction to all the PDU session anchors as defined in clause 5.4.4 of 3GPP TS 29.244 [13].\nWhen the SMF detects that the subscribed default QoS change, the SMF shall notify of the PCF by invoking the procedure as defined in clause 4.2.4.2, include the new subscribed default QoS within the \"subsDefQos\" attribute and \"repPolicyCtrlReqTriggers\" set to DEF_QOS_CH.\nIf the \"VPLMN-QoS-Control\" feature is supported,\n-\tin the home routed scenario, when the SMF detects that the default QoS supported in the VPLMN changes (i.e. when the UE moves from the HPLMN to a VPLMN with default QoS constraints or between VPLMNs with different default QoS constraints), the SMF shall notify of the change to the PCF by invoking the procedure defined in clause 4.2.4.2, and shall include the new default QoS value supported in the VPLMN within the \"vplmnQos\" attribute and the \"VPLMN_QOS_CH\" policy control request trigger within the \"repPolicyCtrlReqTriggers\" attribute;\n-\twhen the SMF detects that the UE moves from a VPLMN with default QoS constraints to a VPLMN where the QoS constraints are not applicable in the home routed scenario or the UE moves back to the non-roaming scenario, the SMF shall notify the PCF that the QoS constraints in the VPLMN are not applicable by invoking the procedure defined in clause 4.2.4.2, and shall include the \"vplmnQosNotApp\" attribute set to true and the \"VPLMN_QOS_CH\" policy control request trigger within the \"repPolicyCtrlReqTriggers\" attribute.\nUpon receiving the change of default QoS, the PCF shall ensure that the authorized default QoS contains a 5QI and ARP values supported by the VPLMN, if applicable, and shall provision the authorized default QoS to the SMF in the response of the message as defined in clauses 4.2.6.3.1 and 4.2.6.3.2.\nUpon receiving the authorized default QoS, the SMF enforces it which may lead to the change of the subscribed default QoS. The SMF shall apply the corresponding procedures towards the access network, the UE and the UPF for the enforcement of the authorized default QoS.\nIf the ADC feature is supported and if the SMF receives the PCC rule for application detection and control, the SMF shall instruct the UPF as defined in 3GPP TS 29.244 [13] to:\n-\tDetect the application traffic.\n-\tReport the detected application's traffic start/stop events along with the application instance identifier and service data flow descriptions when service data flow descriptions are deducible.\nWhen the start of the application’s traffic, identified by an application identifier, is received from the UPF, if PCF has previously provisioned the APP_STA/APP_STO policy control request trigger, unless a request to mute such a notification (i.e. the \"muteNotif\" attribute set to true within the Traffic Control Data decision which the PCC rule refers to), the SMF shall report the start of the application to the PCF.\nIn order to do so, the SMF shall perform the procedure as defined in clause 4.2.4.2 by including the information regarding the detected application`s traffic within the \"appDetectionInfos\" attribute and the \"APP_STA\" within the \"repPolicyCtrlReqTriggers\" attribute even if the application traffic is discarded due to enforcement actions of the PCC rule. In this case, within the each AppDetectionInfo instance, the SMF shall include the received application identifier within the \"appId\" attribute, and may include the detected service data flow description within the \"sdfDescriptions\" attribute if deducible and received and an allocated application instance identifier for the detected service data flow descriptions if received within the \"instanceId\". The \"sdfDescriptions\" attribute, if present, shall contain the \"flowDescription\" attribute and \"flowDirection\" attribute. The application instance identifier allows the correlation of APP_STA and APP_STO policy control request trigger to the specific service data flow descriptions.\nWhen the stop of the application's traffic, identified by an application identifier is received from the UPF and the SMF has reported the start of the application to the PCF, the SMF shall report the stop of the application to the PCF. In order to do so, the SMF shall perform the procedure as defined in clause 4.2.4.2 by including the information regarding the detected application`s traffic within the \"appDetectionInfos\" attribute and the \"APP_STO\" within the \"repPolicyCtrlReqTriggers\" attribute. For each AppDetectionInfo instance, the SMF shall include the received application identifier within the \"appId\" attribute and the application instance identifier received from the UPF within the \"instanceId\" if it is provided along with the APP_STA to the PCF.\nThe PCF then may make policy decisions based on the information received and send the corresponding updated PCC rules to the SMF.\nWhen a PFD provisioned by the PFDF as specified in 3GPP TS 29.551 [46] is removed/modified and the removed/modified PFD was used to detect application traffic related to an application identifier in a PCC rule installed or activated for a PDU session, if the removed/modified PFD results in that the stop of an application or an application instance is not able to be detected, and if the SMF has reported the application start as described in this clause to the PCF for the application or application instance represented by this PFD, the SMF shall report the application stop to the PCF for the corresponding application or the corresponding application instance, if the stop of the application's traffic, identified by the corresponding application or the corresponding application instance, is received from the UPF.\nNOTE:\tMultiple PFDs can be associated with the application identifier. When the removed/modified PFD is the last one which is used to detect traffic identified by the \"appId\" attribute, the SMF reports application stop.\nThe PCF is not allowed to update the mute indication of a provisioned PCC rule(s) during the PDU session lifetime, i.e., if for the PCC rule, the application's start or stop notifications are muted, the PCC rule shall remain with the application's start or stop notifications muted along the PDU session lifetime, and viceversa, if for the PCC rule, the application's start or stop notifications are not muted, the PCC rule shall remain with the application's start or stop notifications not muted along the PDU session lifetime. The SMF shall reject the update of the mute indication for a provisioned PCC rule as specified in clause 4.2.6.2.11.\nWhen the SMF detects that a dedicated QoS flow could not be activated or has been terminated it shall remove the affected PCC rules and send an HTTP POST request to the PCF with an SmPolicyUpdateContextData data structure, including the \"ruleReports\" attribute containing the RuleReport data instance which specifies the affected PCC rules within the \"pccRuleIds\" attribute, \"INACTIVE\" as the value within the \"ruleStatus\" attribute and the \"RES_ALLO_FAIL\" as the value of the \"failureCode\" attribute.\nIf the RAN-NAS-Cause feature is supported, the SMF shall provide the available access network information within the \"userLocationInfo\" attribute (if available), \"userLocationInfoTime\" attribute (if available) and \"ueTimezone\" attribute (if available). Additionally, if the SMF receives from the access network the RAN cause and/or the NAS cause due to QoS flow termination the SMF shall provide the received cause(s) in the \"ranNasRelCauses\" attribute included in RuleReport data instance.\nIf the NetLoc feature is supported, and if the identifier of the affected PCC rule was included within the \"refPccRuleIds\" attribute of the RequestedRuleData data structure when the affected PCC rule was installed or modified, the SMF shall provide the access network information to the PCF by including the user location(s) information within the \"userLocationInfo\" attribute (if requested by the PCF and if provided to the SMF), the information on when the UE was last known to be in that location within \"userLocationInfoTime\" attribute (if user location information was requested by the PCF and if the corresponding information was provided to the SMF), the PLMN Identifier or the SNPN Identifier (the PLMN Identifier and the NID) within the \"servingNetwork\" attribute (if the user location information was requested by the PCF but it is not provided to the SMF) and the timezone information within the \"ueTimeZone\" attribute (if requested by the PCF and available).\nNOTE 1:\tThe SMF derives the value of the \"userLocationInfoTime\" attribute from the age of location information received from the AMF at PDU session update as described in 3GPP TS 29.502[22]. Whether the \"userLocationInfo\" attribute also encodes the age of location is implementation specific.\nNOTE 2:\tThe SMF encodes both 3GPP and non-3GPP access UE location in the \"userLocationInfo\" attribute when they are both received from the AMF.\nThis shall be done whenever one of these conditions applies:\n-\tThe SMF is requested by the RAN to initiate the deactivation of a QoS flow.\n-\tPCC rule(s) are removed/deactivated by the SMF without PCF request (e.g. due to unsuccessful reservation of resources to satisfy the QoS flow binding).\nNOTE 3:\tThe SMF will not initiate the deactivation of the QoS flow upon reception of the UE-initiated resource modification procedure indicating packet filter deletion. If all the PCC rules associated to a QoS flow have been deleted as a consequence of the PCF interaction, the SMF will initiate the QoS flow termination procedure towards the RAN.\nSignalling flows for the QoS flow termination and details of the binding mechanism are presented in 3GPP TS 29.513 [7].\nIf the SMF is informed that the 3GPP PS Data Off status of the UE changed, the SMF shall send an HTTP POST message to the PCF, as defined in clause 4.2.4.2, providing the \"PS_DA_OFF\" value within the \"repPolicyCtrlReqTriggers\" attribute and the \"3gppPsDataOffStatus\" attribute set to the value indicated by the UE within the\"SmPolicyUpdateContextData\" data structure.\nUpon reception of this HTTP POST message with the \"repPolicyCtrlReqTriggers\" attribute set to the value \"PS_DA_OFF\" or \"AC_TY_CH\" the PCF shall determine whether the 3GPP PS Data Off handling functionality (as described below) becomes active or inactive. The 3GPP PS Data Off handling functionality is active if, and only if,\n-\tthe latest received \"3gppPsDataOffStatus\" attribute is set to true; and\nNOTE 1:\tIf the PS_DA_OFF policy control request trigger is received, the latest received value is the one received in the HTTP POST message. Otherwise, it corresponds to the stored value.\n-\tthe UE uses 3GPP access, i.e.:\n-\tfor a non MA PDU session, the \"accessType\" attribute is set to \"3GPP_ACCESS\"; and\n-\tfor a MA PDU session, either the \"accessType\" attribute or the \"addAccessInfo\"attribute indicate \"3GPP_ACCESS\", and the \"relAccessInfo\" attribute either is not available or does not indicate \"3GPP_ACCESS\".\nIf the PCF determines that the 3GPP PS Data Off handling functionality becomes active, the PCF shall configure the SMF in such a way that:\n-\tonly packets for services belonging to the list of 3GPP PS Data Off Exempt Services are forwarded over 3GPP access; and\n-\tall other downlink packets and optionally uplink packets are:\n-\tfor a non-MA PDU session or a MA PDU session where non-3GPP access is not available, discarded by modifying or removing any related dynamic PCC rule(s) or by deactivating any related predefined PCC rule(s);\n-\tfor a MA PDU session where non-3GPP access is available, forwarded only via non-3GPP access, if it is ensured by the policy for ATSSS Control as specified in clause 4.2.6.2.17.\nNOTE 2:\tIn order for the UPF to prevent the services that do not belong to the list of 3GPP PS Data Off Exempt Services, if such services are controlled by dynamic PCC rules, the PCF can either close gates for the downlink and optionally the uplink directions via the \"flowStatus\" attribute in the related dynamic PCC rules or remove those dynamic PCC rules. If the services are controlled by predefined PCC rules, the PCF needs to deactivate those PCC rules. PCC rule(s) with wild-carded service data flow filters can be among the PCC rules that are modified, removed or disabled in that manner. It can then be necessary that the PCF at the same time installs or activates PCC rules for PS Data Off Exempt Services. The network configuration can ensure that at least one PCC rule is bound to the default QoS flow when PS Data Off is activated in order to avoid the deletion of an existing PDU session or to not fail a PDU session establishment.\nIf the PCF determines that the 3GPP PS Data Off handling functionality becomes inactive, the PCF shall make the necessary policy control decisions and perform PCC rule operations to make sure that services are allowed according to the user's subscription and operator policy (irrespective of whether they belong to the list of 3GPP PS Data Off Exempt Services or not).\nNOTE 3:\tThe PCF can then open gates via the \"flowStatus\" attribute for active PCC rules associated to services not contained in the list of 3GPP PS Data Off Exempt Services. The PCF can also install PCC rules or activate predefined PCC rules for some services not belonging to the list of 3GPP PS Data Off Exempt Services. If the PCF activates or installs a PCC rule with wildcarded filters, it can remove or de-activate PCC rules for 3GPP PS Data Off Exempt Services that are redundant with this PCC rule.\nIf the NetLoc as defined in clause 5.8 is supported, the PCF may request the SMF to report the access network information as defined in clause 4.2.6.5.4.\nIf the AN_INFO policy control request trigger is set, upon receiving the \"lastReqRuleData\" attribute with the \"reqData\" attribute with the value(s) MS_TIME_ZONE and/or USER_LOC_INFO and the \"refPccRuleIds\" attribute containing the PCC rule identifier(s) corresponding to the PCC rule(s) which is being installed, modified or removed together, the SMF shall apply the Namf_EventExposure service for Time-Zone-Report  and/or Location-Report event with One-Time Report type as defined in clause 5.3.1 and 5.3.2.2.2 of 3GPP TS 29.518 [36] if the related information is not available to obtain this information. When the SMF then receives access network information from the AMF, the SMF shall provide the required access network information to the PCF by as defined in clause 4.2.4.2 and set the corresponding attributes as follows:\n-\tIf the user location(s) information was requested by the PCF and was provided to the SMF, the SMF shall provide the user location information within the \"userLocationInfo\" attribute and the time when it was last known within \"userLocationInfoTime\" attribute (if available).\nNOTE 1:\tThe SMF derives the value of the \"userLocationInfoTime\" attribute from the age of location information received in the Location-Report (defined in clause 5.3.1 of 3GPP TS 29.518 [36]) from the AMF. Whether the \"userLocationInfo\" attribute also encodes the age of location is implementation specific.\nNOTE 2:\tThe SMF encodes both 3GPP and non-3GPP access UE location in the \"userLocationInfo\" attribute when they are both received from the AMF.\n-\tIf the user location information was requested by the PCF and was not provided to the SMF, the SMF shall provide the serving PLMN Identifier or the SNPN Identifier (the PLMN Identifier and the NID) within the \"servingNetwork\" attribute.\n-\tIf the time zone was requested by the PCF, the SMF shall provide it within the \"ueTimeZone\" attribute.\nNOTE 3:\tIf the SMF receives the access network information but receives the rejection of the QoS flow creation or modification, the SMF reports the the enforcement error of the PCC rule to the PCF as defined in clause 4.2.4.15.\nIn addition, the SMF shall provide the AN_INFO policy control request trigger within the \"repPolicyCtrlReqTriggers\" attribute.\nThe SMF shall not report any subsequent access network information updates received from the RAN without any further provisioning or removal of related PCC rules requesting the access network information unless the associated QoS flow or PDU session has been released.\nIf the UMC feature, as defined in clause 5.8 is supported, the PCF may provision the usage monitoring control policy to the SMF, as defined in clause 4.2.6.5.3, to request the usage monitoring control.\nThe SMF shall report the accumulated usage to the PCF in the following conditions:\n-\twhen a usage threshold is reached, as described in this clause;\n-\twhen all PCC rules for which usage monitoring is enabled for a particular usage monitoring key are removed or deactivated, as specified in clause 4.2.4.10.2;\n-\twhen usage monitoring is explicitly disabled by the PCF, as specified in clause 4.2.6.5.3.2;\n-\twhen a PDU session is terminated, as specified in clause 4.2.5.3;\n-\twhen requested by the PCF, as specified in clause 4.2.6.5.3.3.\nThe UPF measures the volume and/or the time of usage of all traffic of a PDU session or the corresponding service data flows. When the SMF receives the accumulated usage report from the UPF as defined in clauses 7.5.5.2, 7.5.7.2 or 7.5.8.3 of 3GPP TS 29.244 [13], the SMF shall send an HTTP POST message as defined in clause 4.2.4.2, including one or more accumulated usage reports within the \"accuUsageReports\" attribute and the \"US_RE\" value within the \"repPolicyCtrlReqTriggers\" attribute. Each AccuUsageReport data structure shall contain the accumulated usage report within one or two Usage Report information element, i.e. the accumulated usage before the monitoring time or the accumulated usage both before and after the monitoring time, corresponding to one usage monitoring control instance as requested by the PCF.\nIf the monitoring time is provided by the PCF for a usage monitoring control instance and:\n-\tif the SMF receives only one Usage Report information elements corresponding to the usage monitoring control instance from the UPF, within the AccuUsageReport data structure, the SMF shall include the accumulated usage before the monitoring time within the \"timeUsage\" attribute, \"volUsage\" attribute, \"volUsageUplink\" attribute and/or \"volUsageDownlink\" attribute, if applicable; otherwise,\n-\tif the SMF receives two Usage Report information elements corresponding to the usage monitoring control instance from the UPF, within the AccuUsageReport data structure, the SMF includes the accumulated usage before the monitoring time within the \"timeUsage\" attribute, \"volUsage\" attribute, \"volUsageUplink\" attribute and/or \"volUsageDownlink\" attribute, if applicable, and the accumulated usage after the monitoring time within the \"nextTimeUsage\" attribute, \"nextVolUsage\" attribute, \"nextVolUsageUplink\" attribute and/or \"nextVolUsageDownlink\" attribute, if applicable.\nWhen the PCF receives the accumulated usage report in the HTTP POST message, the PCF shall indicate to the SMF if usage monitoring shall continue for this usage monitoring control instance as follows:\n-\tif the PCF wishes to continue monitoring for the usage monitoring control instance and:\n-\tif monitoring shall continue for specific level(s), the PCF shall provide in the response to the received HTTP POST message the new threshold(s) corresponding to these level(s) using the same attributes as before (i.e. \"volumeThreshold\", \"volumeThresholdUplink\", \"volumeThresholdDownlink\" and/or \"timeThreshold\"; \"nextVolThreshold\", \"nextVolThresholdUplink\", \"nextVolThresholdDownlink\", and/or \"nextTimeThreshold\" if the \"monitoringTime\" attribute is provided within an entry of the \"umDecs\" attribute); or\n-\tif the PCF wishes to stop monitoring for specific level(s) the PCF shall not include in the response to the received HTTP POST message updated threshold(s) for these specific level(s), i.e. the corresponding \"volumeThreshold\" attribute, \"volumeThresholdUplink\" attribute, \"volumeThresholdDownlink\" attribute, \"timeThreshold\" attribute, \"nextVolThreshold\" attribute, \"nextVolThresholdUplink\" attribute, \"nextVolThresholdDownlink\" attribute, and/or \"nextTimeThreshold\" attribute shall not be included within an entry of the \"umDecs\" attribute.\n-\totherwise, if the PCF wishes to stop monitoring for the usage monitoring control instance, the PCF shall not include any thresholds of this usage monitoring control instance in the response to the HTTP POST message or remove the reference to the usage monitoring control instance from the concerned dynamic PCC rule or session rule.\nIf both volume and time thresholds were provided by the PCF and only one of these two thresholds is reached, the SMF shall report this event to the PCF and the accumulated usage since last report shall be reported for both measurements.\nUpon reception of the reported usage from the SMF, the PCF shall deduct the value of the usage report from the total allowed usage for that PDU session, usage monitoring key, or both as applicable, and the PCF may also derive and update the PCC rules based on the remaining allowed usage or reported usage and provision them to the SMF. If the remaining allowed usage reaches a value zero (or below zero), the PCF may apply other policy decisions and interact with the SMF accordingly.\nNOTE:\tThe PCF can also update the related usage monitoring information in the UDR as defined in 3GPP TS 29.519 [15] according to the received usage report(s).\nWhen the PCF removes or deactivates the last PCC rule associated with a usage monitoring key in an Npcf_SMPolicyControl_UpdateNotify request as described in clause 4.2.3.2 or in an Npcf_SMPolicyControl_Update response as described in clause 4.2.3.4 whose request was not related to reporting usage for the same monitoring key, the SMF shall send a new Npcf_SMPolicyControl_Update request including the \"US_RE\" value within the \"repPolicyCtrlReqTriggers\" attribute and one or more accumulated usage reports within the \"accuUsageReports\" attribute within the SmPolicyUpdateContextData data type of the HTTP POST request using the procedures to report accumulated usage defined in clause 4.2.4.10.\nWhen the SMF reports that the last PCC rule associated with a usage monitoring key is inactive, the SMF shall report the accumulated usage for that monitoring key within the same HTTP POST request if the \"ruleReports\" attribute was included in the SmPolicyUpdateContextData data type; otherwise, if the \"ruleReports\" attribute was included in the HTTP POST response of an Npcf_SMPolicyControl_UpdateNotify request, the SMF shall invoke the Npcf_SMPolicyControl_Update service operation by sending a new HTTP POST request to report accumulated usage for the usage monitoring key.\nThe SMF may insert an additional PDU Session Anchor to an existing PDU session by using Ipv6 multi-homing mechanism. In this case, the SMF shall inform the PCF when one or more new Ipv6 prefix is allocated to the new PDU Session Anchor as defined in clause 4.2.4.2. The SMF shall, within the SmPolicyUpdateContextData data structure, include the \"UE_IP_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and include the new Ipv6 prefix within the \"ipv6AddressPrefix\" attribute, and may include an additional new Ipv6 prefix within the \"addIpv6AddrPrefixes\" attribute, if the \"MultiIpv6AddrPrefix\" feature is supported, or multiple new Ipv6 prefixes within the \"multiIpv6Prefixes\" attribute, if the \"UnlimitedMultiIpv6Prefix\" feature is supported.\nWhen the PCF receives the request from the SMF indicating the addition of one or more new Ipv6 prefixes, the PCF shall determine the impacted PCC rules and/or session rules associated with each new Ipv6 prefix and provision them to the SMF as defined in clauses 5.6.2.6 and 5.6.2.7. The SMF shall derive the appropriate policies based on the policies provisioned by the PCF and provision them to the appropriate UPF, if applicable, access network, if applicable, and UE, if applicable. The PCF shall additionally consider the new Ipv6 prefix, or the  new Ipv6 prefixes if the \"MultiIpv6AddrPrefix\" feature is supported or the \"UnlimitedMultiIpv6Prefix\" feature, during subsequent PCC rules and/or session rules updates.\nWhen the SMF removes a PDU Session anchor from the Multi-homing PDU session, the SMF shall inform the PCF of the released Ipv6 prefix related to the PDU Session anchor as defined in clause 4.2.5.2. The SMF shall, within the SmPolicyUpdateContextData data structure, include the \"UE_IP_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and include the released Ipv6 prefix within the \"relIpv6AddressPrefix\" attribute, and may include an additional released UE Ipv6 prefixes within the \"addRelIpv6AddrPrefixes\" attribute, if the \"MultiIpv6AddrPrefix feature\" is supported, or multiple released UE Ipv6 prefixes within the \"multiRelIpv6Prefixes\" attribute, if the \"UnlimitedMultiIpv6Prefix feature\" is supported.\nWhen the PCF receives the request from the SMF indicating the release of one or more Ipv6 prefixes, the PCF shall determine the previously provisioned PCC rules and/or session rules associated with each released Ipv6 prefix and shall remove and/or update them from the SMF as applicable. The PCF shall remove the released Ipv6 prefix, or the multiple released Ipv6 prefixes if the \"MultiIpv6AddrPrefix\" or the \"UnlimitedMultiIpv6Prefix\" feature is supported.\nIf the RAN-NAS-Cause feature is supported, the PCF may request the SMF to inform it of the result of the PCC rule removal when the PCF removes the PCC rule as defined in clause 4.2.6.5.2.\nWhen the SMF receives the request, the SMF shall maintain locally the removed PCC rules until it receives of the resource release outcome from the network.\nThe SMF shall notify the PCF by include the \"RES_RELEASE\" within the \"repPolicyCtrlReqTriggers\" attribute and the affected rules indicated within one instance of the \"ruleReports\" attribute with the \"ruleStatus\" attribute set to the value INACTIVE.\nIf the QoS flow is terminated as a consequence of the removal of one or more PCC rules, the SMF shall inform the PCF about the completion of the QoS flow procedure related to the removal of PCC rules that indicated resource release notification by including the RequestedRuleData instance containing the \"reqData\" attribute with the RES_RELEASE referring to the PCC rule. If the SMF received from the access network some RAN/NAS release cause(s), the SMF shall also provide the received cause(s) in the \"ruleReports\" attribute. The SMF shall also provide the available access network information within the \"userLocationInfo\" attribute (if available), \"userLocationInfoTime\" attribute (if available) and \"ueTimezone\" attribute (if available).\nIf the \"policyCtrlReqTriggers\" attribute with the value \"AN_CH_COR\" has been provided to the SMF, the SMF shall notify to the PCF the Access Network Charging Identifier that the SMF has assigned to the PDU session for the dynamic PCC Rules which referred from the RequestedRuleData data structure containing the CH_ID within the \"reqData\" attribute by including an \"accNetChIds\" attribute within the SmPolicyUpdateContextData data structure in the HTTP POST message.\nIf the the Access Network Charging Identifier is within the Uint32 value range; the SMF shall include one AccNetChId instance within the \"accNetChIds\" attribute and include the Access Network Charging Identifier within the \"accNetChaIdValue\" attribute and the \"sessionChScope\" attribute set to true; otherwise, if the \"AccNetChargId_String\" feature is supported by the SMF and the PCF, and the Access Network Charging Identifier value is longer than Uint32, the SMF shall include one AccNetChId instance within the \"accNetChIds\" attribute and the Access Network Charging Identifier within the \"accNetChargIdString\" attribute and the \"sessionChScope\" attribute set to true.\nNOTE:\tAs specified in 3GPP TS 32.255 [35] clause 5.1.4, the SMF assigns a charging identifier per PDU session and is used through the PDU session's lifetime. The request of Access Network Charging Identifier(s) in 5GS and EPS interworking scenarios is described in clause B.3.4.11.\nWhen the PCF does not have the access network charging identifier information for the PDU session, the PCF may request the SMF to provide the Access Network Charging Identifier associated to the new dynamic PCC rules as defined in clause 4.2.6.5.1 in the response message.\nThe PCF may request the SMF to confirm that the resources associated to a PCC rule are successfully allocated as defined in clause 4.2.6.5.5.\nIf the \"policyCtrlReqTriggers\" attribute with the value \"SUCC_RES_ALLO\" has been provided to the SMF, the SMF shall notify to the PCF that the resources associated to the PCC rules which were referred from an element of the \"lastReqRuleData\" attribute containing the \"SUCC_RES_ALLO\" within the \"reqData\" attribute are successfully allocated. When the SMF received successful resource allocation response from the access network, the SMF shall within the SmPolicyUpdateContextData data structure include the \"SUCC_RES_ALLO\" within the \"repPolicyCtrlReqTriggers\" attribute and \"ruleReports\" attribute. Within the RuleReport instance, the SMF shall include the corresponding PCC rule identifier(s) within the \"pccRuleIds\" attribute and the \"ruleStatus\" attribute set to value \"ACTIVE\".\nIf the \"AuthorizationWithRequiredQoS\" feature as defined in clause 5.8 is supported and if the SMF additionally receives the reference to the matching Alternative QoS Profile which the NG-RAN can guarantee, the SMF shall also include the reference to the QosData data structure for the Alternative QoS parameter set corresponding to the reference to the matching alternative QoS profile within the \"altQosParamId\" attribute.\nIf the \"RuleVersioning\" feature is supported and the PCF included the \"contVer\" attribute for a specific PCC rule instance, and the resource allocation was successful for this PCC rule, the SMF shall include the rule content version within the \"contVers\" attribute in the corresponding RuleReport instance.\nIf the installation/activation of one or more PCC rules fails using the procedure as defined in clause 4.2.2.1 or 4.2.4.1 or the PCF installed, activated or modified one or more PCC rules as defined in clause 4.2.3.1 but resource allocation for the PCC rule was unsuccessful or the UE was found temporarily unavailable, the SMF shall include the \"ruleReports\" attribute for the affected PCC rules to report the failure within the SmPolicyUpdateContextData data structure. Within each RuleReport instance, the SMF shall identify the failed PCC rule(s) by including the affected PCC rules within the \"pccRuleIds\" attribute, identify the failed reason code by including a \"failureCode\" attribute, and shall include  rule status within the \"ruleStatus\" attribute with the value as described below.\nIf the installation/activation of one or more new PCC rules (i.e., rules which were not previously successfully installed) fails, the SMF shall set the \"ruleStatus\" to INACTIVE.\nThe removal of a PCC rule shall not fail, even if the PDU session procedures with the UE fail. The SMF shall retain information on the removal and conduct the necessary PDU session procedures with the UE when it is possible.\nIf the modification of a currently active PCC rule fails, the SMF shall retain the existing PCC rule as active without any modification unless the reason for the failure has an impact also on the existing PCC rule. The SMF shall report the modification failure to the PCF.\nIf a PCC rule was successfully installed/activated, but can no longer be enforced by the SMF, the SMF shall set the \"ruleStatus\" attribute to INACTIVE.\nNOTE:\tWhen the PCF receives \"ruleStatus\" set to INACTIVE, the PCF does not need request the SMF to remove the inactive PCC rule.\nDepending on the value of the \"failureCode\" attribute, the PCF may decide whether retaining of the old PCC rule, re-installation, modification, removal of the PCC rule or any other action applies.\nIf the feature \"UEUnreachable\" is supported, when the \"failureCode\" indicates \"UE_TEMPORARILY_UNAVAILABLE\" and the \"retryTimer\" is received, the PCF should not reattempt the installation, re-installation or modification of PCC rules until the received retry timer expires.\nIf the RAN-NAS-Cause feature is supported and as part of any of the procedures described in this clause the SMF receives from the access network some RAN/NAS release cause(s), the SMF shall also provide the received cause(s) in the RuleReport instance. If RAN-NAS-Cause feature is supported the SMF shall provide the available access network information within the \"userLocationInfo\" attribute (if available), \"userLocationInfoTime\" attribute (if available) and \"ueTimezone\" attribute (if available).\nIf the \"RuleVersioning\" feature is supported and the PCF included the \"contVer\" attribute for a specific PCC rule instance, and the resource allocation was unsuccessful as for any of the procedures described in this clause the SMF shall include the rule content version within the \"contVers\" attribute for the corresponding RuleReport instance.\nIf the PRA or ePRA feature as defined in clause 5.8 is supported and when the SMF receives the presence reporting area information from the serving node as defined in 3GPP TS 29.518 [36] indicating that the UE is inside or outside of one or more presence reporting areas or any of the presence reporting areas is set to inactive, the SMF shall check if the reported presence reporting area identifier corresponds to a presence reporting area that is relevant for the PCF. In that case, the SMF shall within the SmPolicyUpdateContextData data structure include the \"PRA_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and one or more Presence Reporting Area Information Report within the \"repPraInfos\" attribute. For each PresenceInfo data structure, the SMF shall also include the presence reporting area status within the \"presenceState\" attribute and the presence reporting area identifier within the \"praId\" attribute for each of the presence reporting areas reported by the serving node.\nIf the SMF receives presence reporting area information for a Set of Core Network predefined Presence Reporting Area encoded within the \"praId\" attribute together with the individual PRA Identifier encoded within the \"additionalPraId\" attribute as described in 3GPP TS 29.518 [36], the SMF shall only provide the PCF with the presence reporting area information corresponding to the additional PRA information (i.e. the individual PRA identifier) encoded within the \"praId\" attribute.\nNOTE 1:\tThe SMF will receive additional presence reporting area information when the UE enters or leaves one or more presence reporting areas related to a PRA set. In that case, the additional presence reporting area information corresponds to the actual individual presence reporting area. The received presence reporting area identifier corresponds to the PRA set id and is used to identify the requester (PCF or CHF) of the notification information.\nNOTE 2:\tThe PCF can acquire the necessary data for presence reporting from the UDR.\nNOTE 3:\tHomogeneous support of Presence Area reporting in a network is assumed.\nNOTE 4:\tThe serving node can activate the reporting for the PRAs which are inactive as described in the 3GPP TS 23.501 [2].\nIn the case that the UE initiates a resource modification procedure as defined in clause 6.4.2.2 of 3GPP 3GPP TS 24.501 [20], the SMF shall within the SmPolicyUpdateContextData  data structure include the \"RES_MO_RE\" within the \"repPolicyCtrlReqTriggers\" attribute and shall include the UE request of specific QoS handling for selected SDF within the \"ueInitResReq\" attribute. Within the UeInitiatedResourceRequest data structure, the SMF shall include the \"ruleOp\" attribute, \"packFiltInfo\" attribute and \"reqQos\" attribute if applicable as follows:\n-\tWhen the UE requests to \"Create new QoS rule\", the SMF shall include the \"ruleOp\" attribute set to \"CREATE_PCC_RULE\", the \"packFiltInfo\" attribute and \"reqQos\" attribute containing the requested QoS for the new PCC rule. Each PacketFilterInfo instance shall contain one packet filters requested for creating the new QoS rule. If the PCF authorizes the request, the PCF shall create a new PCC rule by including the new packet filters within the service data flow template of the PCC rule. When the SMF received the PCC rule, the SMF shall derive the QoS rule based on the PCC rule, assign a new QoS rule identifier within the PDU session for the QoS rule. The SMF shall keep the mapping between the PCC rule identifier and the QoS rule identifier.\n-\tWhen the UE requests to \"Modify existing QoS rule and add packet filters\" for the QoS rule created as a result of the UE-initiated resource modification, SMF shall include the \"ruleOp\" attribute set to \"MODIFY_PCC_RULE_AND_ADD_PACKET_FILTERS\", the \"pccRuleId\" attribute including the PCC rule identifier corresponding the QoS rule identifier and the \"packFiltInfo\" attribute. Each PacketFilterInfo instance shall contain one packet filters requested for addition to this QoS Rule. If the UE request includes the modified QoS information the SMF shall also include the \"reqQos\" attribute to indicate the updated QoS for the affected PCC rule(s). If the PCF authorizes the request, the PCF shall update the PCC rule by adding the new packet filters to the service data flow template of the PCC rule.\n-\tWhen the UE requests to \"Modify existing QoS rule and replace all packet filters\" for the QoS rule created as a result of the UE-initiated resource modification, SMF shall include the \"ruleOp\" attribute set to \"MODIFY_ PCC_RULE_AND_REPLACE_PACKET_FILTERS\", the \"pccRuleId\" attribute including the PCC rule identifier corresponding the QoS rule identifier and the \"packFiltInfo\" attribute. Each PacketFilterInfo instance shall contain one packet filters requested for addition to this QoS Rule. If the UE request includes the modified QoS information the SMF shall also include the \"reqQos\" attribute to indicate the updated QoS for the affected PCC rule. If the PCF authorizes the request, the PCF shall update PCC rule by replacing the all existing packet filters within the service data flow template of the PCC rule with the new packet filter(s).\n-\tWhen the UE requests to \"Modify existing QoS rule and delete packet filters\" for the QoS rule created as a result of the UE-initiated resource modification, SMF shall include the \"ruleOp\" attribute set to \"MODIFY_ PCC_RULE_AND_DELETE_PACKET_FILTERS\", the \"pccRuleId\" attribute including the PCC rule identifier corresponding the QoS rule identifier and the \"packFiltInfo\" attribute. Each PacketFilterInfo instance shall within the \"packFiltId\" attribute include the removed packet filter identifier assigned by the PCF corresponding to the packet filter identifier received from the UE. If the UE request includes modified QoS information the SMF shall also include the \"reqQos\" attribute to indicate the updated QoS for the affected PCC rule(s). If the PCF authorizes the request, the PCF shall update PCC rule by removing the corresponding packet filters from the service data flow template of the PCC rule.\n-\tWhen the UE requests to \"Modify existing QoS rule without modifying packet filters\" for the QoS rule created as a result of the UE-initiated resource modification, SMF shall include the \"ruleOp\" attribute set to \"MODIFY_PCC_RULE_WITHOUT_MODIFY_PACKET_FILTERS\", the \"pccRuleId\" attribute including the PCC rule identifier corresponding the QoS rule identifier, the \"packFiltInfo\" attribute and the modified QoS information within the \"reqQos\" attribute. The \"packFiltInfo\" attribute shall include one PacketFilterInfo instance which includes any packet filter identifier assigned by the PCF for the PCC rule within the \"packFiltId\" attribute.\n-\tWhen the UE requests to \"Delete existing QoS rule\" the SMF shall include the \"ruleOp\" attribute set to \"DELETE_PCC_RULE\" for the QoS rule created as a result of the UE-initiated resource modification, the \"pccRuleId\" attribute including the PCC rule identifier corresponding the QoS rule identifier and the \"packFiltInfo\" attribute. The \"packFiltInfo\" attribute shall include one PacketFilterInfo instance which includes any packet filter identifier assigned by the PCF for the PCC rule within the \"packFiltId\" attribute. The PCF shall remove the PCC rule when the PCF receives the request according to the PCC rule identifier.\nNOTE 1:\tThe UE can only modify or delete the packet filters that the UE has introduced and associated resources. The packet filter identifiers contained in the FlowInformation data structure are only used for packet filters created by the UE.\nThe SMF shall calculate the requested GBR, for a GBR 5QI, as the sum of the previously authorized GBR for the affected PCC rule, corresponding to the QoS rule, adjusted with the difference between the requested GBR for the QoS flow and previously negotiated GBR for the QoS flow. For the UE request to create a new QoS Rule, the GBR as requested by the UE for the QoS rule shall be used.\nIf the request covers all the PCC rules with a QoS flow binding to the same QoS flow, then the SMF may request a change to the 5QI for existing PCC rules.\nFor the purpose of creating or modifying a QoS rule with adding, replacing and modifying packet filter, within the UeInitiatedResourceRequest instance, the SMF shall include the precedence information of the QoS rule within the \"precedence\" attribute, and within each PacketFilterInfo instance, the SMF shall include the \"packFiltCont\" attribute, \"tosTrafficClass\" attribute, \"spi\" attribute, \"flowLabel\" attribute and \"flowDirection\" attribute set to the value(s) describing the packet filter provided by the UE.\nNOTE 2:\tThe UE signalling with the network is governed by the applicable NAS signalling TS. The NAS 3GPP TS for a specific access may restrict the UE possibilities to make requests compared to what is stated above.\nUpon receipt of the request from the SMF, the PCF shall check the set of services the user is allowed to access. If the user is not allowed to access AF session based services, the PCF shall check whether the user is allowed to request resources for services not known to the PCF and whether the requested QoS and/or packet filters can be authorized. If the user is not allowed to request resources for services not known to the PCF, the PCF shall reject the request with in an HTTP \"403 Forbidden\" response message including the \"cause\" attribute of the ProblemDetails data structure set to \"POLICY_CONTEXT_DENIED\".\nIf the PCF authorizes the request from the UE, the PCF shall construct a PCC rule(s) based on the UeInitiatedResourceRequest data structure. For the request to add the filter(s), the PCF shall within the FlowInformation data structure include the assigned packet filter identifier within the \"packFiltId\" attribute. When the SMF derives the QoS based on the PCC rule, the SMF shall assign a new packet filter identifier for each added packet filter within the QoS rule and keep the mapping between the packet filter identifier for the packet filter within the PCC rule and QoS rule.\nThe PCF shall perform the QoS authorization for the new created or modified PCC rules if requested by the UE as defined in clause 4.2.6.6.2.\nIf the PCF detects that the packet filters in the request for new PCC rules received from the SMF is covered by the packet filters of outstanding PCC rules that the PCF is provisioning to the SMF, the PCF may reject the request and indicate the cause for the rejection including the \"cause\" attribute of the ProblemDetails data structure set to \"ERROR_CONFLICTING_REQUEST\" in an HTTP \"403 Forbidden\" response message. If the SMF receives a response message with this code, the SMF shall ignore the PDU session modification that initiated the HTTP request as specified in 3GPP TS 24.501[20] clause 6.3.2.5.\nIf the PCF does not accept one or more of the traffic mapping filters provided by the SMF in an HTTP Request (e.g. because the PCF does not allow the UE to request enhanced QoS for services not known to the PCF), the PCF shall reject the request and indicate the cause for the rejection including the \"cause\" attribute of the ProblemDetails data structure set to \"ERROR_TRAFFIC_MAPPING_INFO_REJECTED\" in an HTTP \"403 Forbidden\" response message. If the SMF receives an HTTP response with this code, the SMF shall reject the PDU session modification that initiated the HTTP request.\nThe PCF shall not combine a rejection with provisioning of PCC rule operations in the same HTTP response.\nWhen there is the requirement to activate tracing the SMF may provide trace control parameters within the \"traceReq\" attribute to the PCF via the Npcf_SMPolicyControl_Update service operation. The update service operation may also indicate the update or deactivation of the trace session to the PCF.\nWhen UE initiates a resource modification request, if the SMF includes the \"qosFlowUsage\" attribute containing \"IMS_SIG\" within  SmPolicyUpdateContextData data structure and the PCF accepts that a QoS flow dedicated to IMS signalling shall be used, the PCF shall return the \"qosFlowUsage\" containing \"IMS_SIG\" value within the SmPolicyDecision data structure. The provided PCC rules shall have the 5QI applicable for IMS signalling.\nWhen the SMF gets the knowledge that for one or more QoS Flows:\n-\tthe GBR QoS targets cannot be guaranteed; or\n-\tthe GBR QoS targets can be guaranteed again;\nthe SMF shall inform the PCF that the GBR QoS targets cannot be guaranteed or can be guaranteed again for the PCC rules bound to the QoS flows.\nThe SMF gets the knowledge that the GBR QoS targets cannot be guaranteed or can be guaranteed again for the QoS flow(s) as follows:\n-\tupon receiving a notification from the NG-RAN that the GFBR can no longer be guaranteed or can be guaranteed again as defined clause 5.2.2.3.1 of 3GPP TS 29.502 [22]; or\n-\tduring a handover, a QoS Flow which is listed as transferred QoS Flow received from the AMF as defined clause 5.2.2.3.1 of 3GPP TS 29.502 [22] can be interpreted as a notification that GFBR can be guaranteed again if the SMF has received a notification from the source NG-RAN that the GFBR can no longer be guaranteed but does not receive an explicit notification that the GFBR can no longer be guaranteed for that QoS Flow from the Target NG-RAN within a configured time as previous bullet.\nThe SMF shall send an HTTP POST request to the PCF with an SmPolicyUpdateContextData data structure, including the \"QOS_NOTIF\" within \"repPolicyCtrlReqTriggers\" attribute and the \"qncReports\" attribute. In each QosNotificationControlInfo data structure, the SMF shall include the indication that the GBR QoS targets cannot be guaranteed or the GBR QoS targets can be guaranteed again within the \"notifType\" attribute and affected PCC rule identifiers within the \"refPccRuleIds\" attribute.\nIf the \"AuthorizationWithRequiredQoS\" feature as defined in clause 5.8 is supported, the SMF shall also include the reference to the QosData data structure for the Alternative QoS parameter set corresponding to the reference to the matching alternative QoS profile within the \"altQosParamId\" attribute if the SMF additionally receives the reference to the matching Alternative QoS Profile which the NG-RAN can guarantee when the NG-RAN indicates the GBR QoS targets cannot be guaranteed. When the SMF additionally receives an indication that lowest priority Alternative QoS Profile cannot be fulfilled from the NG-RAN the SMF shall omit the \"altQosParamId\" attribute to indicate that that the lowest priority alternative QoS profile could not be fulfilled either. When the \"DisableUENotification\" feature is supported, if the corresponding PCC rule does not include the \"disUeNotif\" attribute set to true, the SMF shall also send the fulfilled QoS profile or Alternative QoS Profile to the UE as defined in clause 5.2.2.3.1.1 of 3GPP TS 29.518 [36], if applicable.\nIf the affected PCC rule was provisioned with a content version, the SMF shall include the \"contVers\" attribute defined in the QosNotificationControlInfo data structure for those corresponding PCC rules. The SMF may include more than one content version in the \"contVers\" attribute for the same PCC rule within the corresponding QosNotificationControlInfo instance included in the \"qncReports\" attribute (e.g. the SMF has combined multiple PCC rule versions enforcement into one QoS flow operation).\nWhen the \"AuthorizationWithRequiredQoS\" and the \"AltQoSProfilesSupportReport\" features as defined in clause 5.8 are supported, and the PCF included during PCC rule provisioning the \"refAltQosParams\" attribute for the concerned PCC rule(s), if the SMF:\n-\treceives the indication that the GBR QoS targets cannot be guaranteed, as specified in 3GPP TS 38.413 [54]; and\n-\tdoes not receive a matching Alternative QoS Profile the NG-RAN can guarantee or the indication that the lowest priority Alternative QoS profile cannot be fulfilled, as specified in 3GPP TS 38.413 [54];\nthen the SMF may determine that Alternative QoS Profiles are not supported by the NG-RAN where the UE is currently located and include within the QosNotificationControlInfo data structure the \"altQosNotSuppInd\" attribute set to true. When Alternative QoS profiles are supported by the NG-RAN where the UE is currently located, the SMF may omit the \"altQosNotSuppInd\" attribute or set it to false.\nWhen the PCF receives the HTTP POST request, it shall acknowledge the request by sending a \"200 OK\" response to the SMF and then notify the AF as defined in 3GPP TS 29.514 [17], clause 4.2.5.4.\n\nIf the \"SessionRuleErrorHandling\" feature is supported and if the installation of one or more session rules fails using the procedure as defined in clauses 4.2.2.1 or 4.2.4.1 or the PCF provisioned one or more session rules as defined in clause 4.2.3.1 but enforcement of the session Rule was unsuccessful (e.g. session-AMBR is rejected by the AMF in the roaming scenario, and the SMF determines that the PDU session is kept, the SMF shall include the \"sessRuleReports\" attribute for the affected session rules to report the failure within the SmPolicyUpdateContextData data structure. Within each SessionRuleReport instance, the SMF shall identify the failed session rule(s) by including the affected session rules within the \"ruleIds\" attribute, identify the failed reason code by including a \"sessRuleFailureCode\" attribute, and shall include rule status within the \"ruleStatus\" attribute with the value as described below.\nIf the installation of one or more new session rules fails, the SMF shall set the \"ruleStatus\" to INACTIVE.\nThe removal of a session rule shall not fail, even if the PDU session procedures with the UE fail. The SMF shall retain information on the removal and conduct the necessary PDU session procedures with the UE when it is possible.\nIf the modification of a currently provisioned session rule fails, the SMF shall retain the existing session rule as provisioned without any modification unless the reason for the failure has an impact also on the existing session rule. The SMF shall report the modification failure to the PCF.\nIf a session rule was successfully installed, but can no longer be enforced by the SMF:\n-\tIf the \"ImmediateTermination\" feature is supported, and based on operator's policy, the SMF shall evaluate whether the PDU session can be kept. If the SMF determines to terminate the PDU session immediately, the SMF shall trigger the deletion of the SM Policy Association as described in clauses 4.2.5, otherwise the SMF shall set the \"ruleStatus\" attribute to INACTIVE.\n-\tIf the the \"ImmediateTermination\" feature is not supported, the SMF shall set the \"ruleStatus\" attribute to INACTIVE.\nNOTE:\tWhen the PCF receives \"ruleStatus\" set to INACTIVE, the PCF does not need to request the SMF to remove the inactive session rule.\nDepending on the value of the \"sessRuleFailureCode\" attribute, the PCF may decide whether retaining the old session rule, re-installation, modification, removal of the session rule or any other action applies.\nIf \"RespBasedSessionRel\" feature is supported, PCF may request the PDU session termination upon receiving a POST message from the SMF (e.g. when usage quota reached). In this case, the PCF shall include the \"relCause\" attribute within the SmPolicyDecision data structure of the response to the POST message.\nAfter the receipt of a successful HTTP POST response from the PCF containing the \"relCause\" attribute within the SmPolicyDecision data structure, the SMF shall invoke the Npcf_SMPolicyControl_Delete Service Operation defined in clause 4.2.5 to terminate the policy association and initiate the procedure to terminate the PDU session as defined in 3GPP TS 29.502 [22].\nIf the feature \"TimeSensitiveNetworking\" or \"TimeSensitiveCommunication\" is supported and the \"TSN_BRIDGE_INFO\" policy control request trigger is provisioned in the SMF, when new TSC user plane node information is available for TSC or Deterministic Networking PDU sessions, the SMF requests to update the SM Policy Association and provides to the PCF information on the conditions that have been met.\nThe Policy Control Request Trigger condition \"TSN_BRIDGE_INFO\" is met when:\na.\tthe SMF detects new TSC user plane node port (the UE has indicated support of transferring Port Management Information Containers, or SMF local configuration for the given DNN, S-NSSAI indicates support for Deterministic Networking). The SMF shall send to the PCF, if available:\n-\tthe port number for the device side of the PDU session encoded in the \"dsttPortNum\" attribute allocated by the UPF;\nNOTE 1:\tThe port number of the PDU session corresponds to the device side port of the 5GS bridge/router. When the device supports the DS-TT functionality, the port number represents the DS-TT port number corresponding to the given PDU Session.\nNOTE 2:\tPort number can refer either to Ethernet port or PTP port or a port of a DetNet router. In Ethernet type PDU Sessions, it is assumed that the PTP port number is the same as the associated Ethernet port number.\n-\tthe TSC user plane node Id received from the UPF encoded in the \"bridgeId\" attribute;\n-\twhen DS-TT functionality is used:\na.\tthe MAC address of the DS-TT port received from the UE encoded in the \"dsttAddr\" attribute, if received; and\nb.\tthe UE-DS-TT residence time if received from the UE encoded in the \"dsttResidTime\" attribute,\n-\tin case of Deterministic Networking, for the device side port, and when the feature \"MTU_Size\" is supported, the MTU size (as specified in IETF RFC 8344 [56]) for IPv4 and/or IPv6 encoded in the \"mtuIpv4\" and/or \"mtuIpv6\" attributes respectively,\nwithin the SmPolicyUpdateContextData structure encoded in the \"tsnBridgeInfo\" attribute of the TsnBridgeInfo data type; and/or\nb.\tthe SMF receives a UMIC from the TSC user plane node functionality of the UPF/NW-TT and/or, when the DS-TT or the NW-TT functions are used, the SMF receives a PMIC from the DS-TT port and/or one or more PMIC(s) in the corresponding one or more NW-TT ports. The SMF shall transparently forward to the PCF the UMIC encoded within the \"tsnBridgeManCont\" attribute and/or the DS-TT PMIC encoded within the \"tsnPortManContDstt\" attribute and/or the one or more NW-TT PMIC(s) encoded within the \"tsnPortManContNwtts\" attribute within the SmPolicyUpdateContextData structure.\nNOTE 3:\tThe 5GS Architecture to support IETF Deterministic Networking IETF RFC 8655 [55] does not require the DS-TT functionality to be supported in the device nor require the user plane NW-TT functionality to be supported in the UPF. For the reporting of information of network side ports, NW-TT control plane functionality is supported and PMIC(s) carry port management information of NW-TT port(s).\nFor IP type of PDU sessions, the UE IP address of the PDU session received within the \"ipv4Address\" or \"ipv6AddressPrefix\" attribute, as described in clause 4.2.2.2 and 4.2.4.2 (reported with trigger \"UE_IP_CH\") is used as identifier of the PDU session related to the reported TSC user plane node information.\nFor Ethernet type of PDU sessions (IEEE TSN and other time sensitive communications than TSN) the MAC address of the DS-TT port received within the \"dsttAddr\" attribute is used as identifier of the PDU session related to the reported TSC user plane node information.\nWhen the SMF gets the information about real-time measurements of QoS parameters for one or more SDFs from the UPF and the \"QOS_MONITORING\" policy control request trigger was provisioned, then SMF shall inform the PCF for the impacted PCC rules\nWhen the QoS monitoring applies for packet delay, the SMF shall inform the PCF when it gets information about any of the following items for one or more SDFs from the UPF:\n-\tuplink packet delay(s);\n-\tdownlink packet delay(s); and/or\n-\tround trip delay(s); or\n-\tif the feature \"PacketDelayFailureReport\" is supported, indicator of packet delay measurement failure.\nWhen the \"EnQoSMon\" feature is supported and the QoS monitoring applies for congestion information, the SMF shall inform the PCF when it gets information about any of the following items for one or more SDFs from the UPF:\n-\tuplink congestion information; and/or\n-\tdownlink congestion information; or\n-\tindicator of congestion information measurement failure.\nWhen the feature \"EnQoSMon\" is supported, and QoS monitoring applies for data rate measurements, the SMF shall inform about any of the following items for one or more SDFs from the UPF:\n-\tuplink data rate; and/or\n-\tdownlink data rate.\nThe SMF shall send an HTTP POST request to the PCF with an SmPolicyUpdateContextData data structure, including the \"QOS_MONITORING\" within \"repPolicyCtrlReqTriggers\" attribute and the \"qosMonReports\" attribute, and/or if the feature \"XRM_5G\" is supported, and/or the \"qosMonDatRateReps\" attribute. In each QosMonitoringReport data structure, the PCF shall include:\n-\taffected PCC rule identifiers within the \"refPccRuleIds\" attribute; and\nif QoS monitoring is for packet delay, the PCF shall include within the \"qosMonReports\" attribute:\n-\tone or two uplink packet delays within the \"ulDelays\" attribute; and/or\n-\tone or two downlink packet delays within the \"dlDelays\" attribute; and/or\n-\tone or two round trip packet delays within the \"rtDelays\" attribute; and/or\n-\tif the feature \"PacketDelayFailureReport\" is supported, the packet delay measurement failure indicator within \"pdmf\" attribute; or\nand/or, if the feature \"EnQoSMon\" is supported and QoS monitoring is for data rate measurements, the PCF shall include within the \"qosMonDatRateReps\" attribute:\n-\tone data rate measurement for the UL within the \"ulDataRate\" attribute; and/or\n-\tone data rate measurement for the DL within the \"dlDataRate\" attribute.\nEditor’s note:\tWhether the maximum and minimum Data Rate measurements calculated during the waiting time can be reported is FFS.\nand/or, if the feature \"EnQoSMon\" is supported and QoS monitoring for congestion measurement is enabled, the PCF may include within the \"qosMonReports\" attribute:\n-\tthe uplink congestion information within the \"ulCongInfo\" attribute;\n-\tthe downlink congestion information within the \"dlCongInfo\" attribute; or\n-\tthe congestion information measurement failure indicator within \"cimf\" attribute.\nEditor's Note:\t It is FFS whether congestion information measurement failure can occur.\nIf \"ATSSS\" feature defined in clause 5.8 is supported and the PCF has previously provisioned the AC_TY_CH policy control request trigger, when the UE requests to:\n-\tadd an access to an already established MA PDU session (i.e. registers to another acess), the SMF shall, within the SmPolicyUpdateContextData data structure, include the \"AC_TY_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and include the additional Access type and the additional RAT type if available within the \"addAccessInfo\" attribute.\n-\trelease an access from an already established MA PDU session (i.e. deregisters from one access but remains registered on the other access), the SMF shall, within the SmPolicyUpdateContextData data structure, include the \"AC_TY_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and include the released access type and the released RAT type if available within the \"relAccessInfo\" attribute.\nWhen the PCF receives the request from the SMF indicating the addition of Access Type or removal of Access Type, the PCF may provide PCC rules and/or session rules for the MA PDU session as defined in clause 4.2.6.2.17 and clause 4.2.6.3.4.\nIf the \"PolicyDecisionErrorHandling\" feature is supported and the \"ExtPolicyDecisionErrorHandling\" feature is not supported, and one or more policy decision types (as defined in clause 4.1.4.4) and/or condition data (as defined in clause 4.1.8) which are not referred by any PCC rules or session rule is provisioned using the procedure as defined in clauses 4.2.2.1, 4.2.3.1 or 4.2.4.1 but the storage was unsuccessful (e.g. the policy decision could not be successfully stored due to a limitation of resources at the SMF), or because there are semantical inconsistencies in the provided data, the SMF shall include the \"policyDecFailureReports\" attribute to indicate the type(s) of the failed policy decisions and/or condition data within the SmPolicyUpdateContextData data structure.When the PCF receives the above report, the PCF shall consider all the instances of the policy decisions and/or condition data which are not referred by any PCC rule and/or session stored at the SMF and indicated by the PolicyDecisionFailureCode data type are removed from the SMF.\nThe removal of a policy decision type and/or condition data shall not fail.\nIf the \"ExtPolicyDecisionErrorHandling\" feature is supported and one or more policy decision types (as defined in clause 4.1.4.4) and/or condition data (as defined in clause 4.1.8) which are not referred by any PCC rules or session rules is provisioned using the procedure as defined in clauses 4.2.2.1, 4.2.3.1 or 4.2.4.1, and/or other SM policy decisions (e.g. the SMF receives policy control request triggers and applicable additional information) but the SMF detects the received policy decision cannot be enforced (e.g. because semantical inconsistencies in the provided data), and the SMF determines that the PDU session can be kept, the SMF shall within the SmPolicyUpdateContextData data structure include the \"policyDecFailureReports\" attribute to indicate a failure in the provided policy decision types and/or condition data not referred by any PCC rules or session rules and/or in other SM policy decisions, and may include the \"invalidPolicyDecs\" attribute to indicate the failed policy decision types and/or condition data not referred by any PCC rules or session rules and/or other SM policy decisions.\nWhen the PCF receives the above report, the PCF shall consider:\n-\tall the instances of the policy decisions and/or condition data which are not referred by any PCC rule and/or session stored at the SMF and indicated by the PolicyDecisionFailureCode data type are removed from the SMF; and\n-\tfor the other policy decisions:\na.\tAll the new failed policy decisions provisioned are not installed in the SMF.\nb.\tAll the modified policy decisions shall remain unmodified in the SMF.\nc.\tAll the removed policy decisions provided in the request message are deleted in the SMF.\nNOTE:\tThe removal of a policy decision does not fail. Even if there is an inconsistency e.g. between the deletion of a policy control request trigger and the deletion of the applicable additional information, the whole related policy decision is removed.\nIf the feature \"DDNEventPolicyControl\" or \"DDNEventPolicyControl2\" is supported, and if the PCF has previously provisioned \"DDN_FAILURE\" policy control request trigger, the SMF shall send the PCC rule request when it receives an event subscription for DDN Failure event including the traffic descriptors. The SMF shall send an HTTP POST request to the PCF with an SmPolicyUpdateContextData data structure, including the \"DDN_FAILURE\" within \"repPolicyCtrlReqTriggers\" attribute and include one or more traffic descriptor(s) in the \"trafficDescriptors\" attribute within the SmPolicyUpdateContextData structure for policy evaluation. Upon reception of the HTTP POST message:\n-\tif the PCF determines that there is an existing PCC rule for the traffic detection of DDD Status event which has the same traffic descriptor(s) as the new request one, the PCF shall update the existing PCC rule for traffic detection of DDD Status event by including both the \"DDN_FAILURE\" and \"DDD_STATUS\" values within the \"notifCtrlInds\" attribute of the \"ddNotifCtrl\" attribute if the \"DDNEventPolicyControl\" feature is supported or of the \"ddNotifCtrl2\" attribute if the \"DDNEventPolicyControl2\" feature is supported to indicate both the DDN Failure and DDD Status event detection;\n-\tif the PCF determines that there is an existing PCC rule for the policy and charging control which has the same traffic descriptor(s) as the new request one, the PCF shall update the existing PCC rule by including the downlink data notification control information within the \"ddNotifCtrl\" attribute if the \"DDNEventPolicyControl\" feature is supported or within the \"ddNotifCtrl2\" attribute if the \"DDNEventPolicyControl2\" feature is supported to indicate the DDN Failure event detection. Within the DownlinkDataNotificationControl or DownlinkDataNotificationControlRm data type, the PCF shall include the \"DDN_FAILURE\" value within the \"notifCtrlInds\" attribute;\n-\totherwise the PCF shall make a new PCC rule by including the reported traffic descriptors within the \"flowInfos\" attribute, setting a lower value to the \"precedence\" attribute and including the downlink data notification control information within the \"ddNotifCtrl\" attribute if the \"DDNEventPolicyControl\" feature is supported or within the \"ddNotifCtrl2\" attribute if the \"DDNEventPolicyControl2\" feature is supported and setting the other PCC rule information to the same values as in an existing PCC rule that previously matched the traffic. Within the DownlinkDataNotificationControl or DownlinkDataNotificationControlRm data type, the PCF shall include the \"DDN_FAILURE\" value within the \"notifCtrlInds\" attribute to indicate the DDN Failure event detection. When the new PCC rule has to be bound to the default QoS flow, the PCF shall include the \"defQosFlowIndication\" attribute set to true within the QosData data structure to which the PCC rule refers. From now on, the PCF needs to keep new PCC rule for event detection fully synchronized with the existing PCC rule that previously matched the traffic for all other policy and charging control settings to ensure the same user experience and traffic treatment according to the operator policy.\nIf the feature \"DDNEventPolicyControl\" or the \"DDNEventPolicyControl2\" is supported, and if the PCF has previously provisioned \"DDN_DELIVERY_STATUS\" policy control request trigger, the SMF shall send the PCC rule request when it receives an event subscription for DDD Status event including the traffic descriptors. The SMF shall send an HTTP POST request to the PCF with an SmPolicyUpdateContextData data structure, including the \"DDN_DELIVERY_STATUS\" within \"repPolicyCtrlReqTriggers\" attribute, include one or more traffic descriptor(s) in the \"trafficDescriptors\" attribute and the type(s) of notification in the \"typesOfNotif\" attribute within the SmPolicyUpdateContextData structure for policy evaluation. Upon reception of the HTTP POST message:\n-\tif the PCF determines that there is an existing PCC rule for traffic detection of DDN Failure event which has the same traffic descriptor(s) as the new request one, the PCF shall update the existing PCC rule for traffic detection of DDN Failure event by including both the \"DDN_FAILURE\" and \"DDD_STATUS\" values within the \"notifCtrlInds\" attribute and the type(s) of notifications within the \"typesOfNotif\" attribute of the \"ddNotifCtrl\" attribute if the \"DDNEventPolicyControl\" feature is supported or of the \"ddNotifCtrl2\" attribute if the \"DDNEventPolicyControl2\" feature is supported to indicate both the DDN Failure and DDD Status event detection;\n-\tif the PCF determines that there is an existing PCC rule for the policy and charging control which has the same traffic descriptor(s) as the new request one, the PCF shall update the existing PCC rule by including the downlink data notification control information within the \"ddNotifCtrl\" attribute if the \"DDNEventPolicyControl\" feature is supported or within the \"ddNotifCtrl2\" attribute if the \"DDNEventPolicyControl2\" feature is supported to indicate the DDD Status event detection. Within the DownlinkDataNotificationControl or DownlinkDataNotificationControlRm data type, the PCF shall include the \"DDD_STATUS\" value within the \"notifCtrlInds\" attribute and the type(s) of notifications within the \"typesOfNotif\" attribute;otherwise the PCF shall make a PCC rule by including the reported traffic descriptors within the \"flowInfos\" attribute, setting a lower value to the \"precedence\" attribute and including the downlink data notification control information within the \"ddNotifCtrl\" attribute if the \"DDNEventPolicyControl\" feature is supported or within the \"ddNotifCtrl2\" attribute if the \"DDNEventPolicyControl2\" feature is supported to indicate the DDD Status event detection and setting the other PCC rule information to the same values as in an existing PCC rule that previously matched the traffic. Within the DownlinkDataNotificationControl or DownlinkDataNotificationControlRm data type, the PCF shall include the \"DDD_STATUS\" value within the \"notifCtrlInds\" attribute and the type(s) of notifications within the \"typesOfNotif\" attribute to indicate that DDN Status event detection is required. When the new PCC rule has to be bound to the default QoS flow, the PCF shall include the \"defQosFlowIndication\" attribute set to true within the QosData data structure to which the PCC rule refers. From now on, the PCF needs to keep new PCC rule for event detection fully synchronized with the existing PCC rule that previously matched the traffic for all other policy and charging control settings to ensure the same user experience and traffic treatment according to the operator policy.\nIf the feature \"DDNEventPolicyControl2\" is supported, when the SMF receives a request to cancel a subscription of the DDN Failure or DDD status event and if the PCF has previously provisioned  \"DDN_FAILURE_CANCELLATION\" and \"DDN_DELIVERY_STATUS_CANCELLATION policy control request trigger, the SMF shall send an HTTP POST request to the PCF with an SmPolicyUpdateContextData data structure, including the \"DDN_FAILURE_CANCELLATION\" or \"DDN_DELIVERY_STATUS_CANCELLATION\" within \"repPolicyCtrlReqTriggers\" attribute respectively and include the rule identifier of the PCC rule which is used for traffic detection of event within the \"pccRuleId\" attribute. Upon reception of the HTTP POST message:\n-\tIf the PCC rule corresponding to the received PCC rule identifier is only used for the traffic detection of DDN failure or DDD Status respectively, the PCF shall remove the PCC rule locally and request the SMF to remove it too.\n-\tIf the PCC rule corresponding to the received PCC identifier is used for the traffic detection of both DDN failure and DDD status events, the PCF shall update the PCC rule by removing the downlink data notification control information for DDN failure or DDD status respectively from the PCC rule. In order to do that, within the DownlinkDataNotificationControlRm data type of the \"ddNotifCtrl2\" attribute, the PCF shall omit the \"DDN_FAILURE\" or \"DDD_STATUS\" within the \"notifCtrlInds\" attribute respectively. If the data notification control information for the DDD status is omitted, the PCF shall aslo include the \"typesOfNotif\" attribute set to NULL.\n-\tIf the PCC rule corresponding to the receied PCC rule identifier is also used for the policy and charging control to the service data flow besides the traffic detection of the DDN failure or DDD status event, the PCF shall update the PCC rule by removing the downlink data notification control information from the PCC rule. In order to do that, the PCF shall include the \"ddNotifCtrl2\" attribute set to NULL.\nNOTE:\tThe \"ddNotifCtrl\" attribute is used to contain the downlink data notification control information if the \"DDNEventPolicyControl\" feature is supported; while the \"ddNotifCtrl2\" attribute is used to contain the downlink data notification control information if the \"DDNEventPolicyControl2\" feature is supported.\nWhen the SMF receives the new or updated PCC rule within the response message from the PCF, SMF shall perform the DDD Status and/or DDN Failure event based on the downlink data notification control information within the PCC rue as follows:\n-\tIf the downlink data notification control information indicates that the detection of DDD Status event and buffered notification type is required, the SMF shall derive a PDR and a related FAR as defined in clause 5.28 of 3GPP TS 29.244 [13] to request the UPF to report an event of the first buffered downlink data packet identified by the PDR. When the SMF receives the corresponding report, the SMF shall send the notification to the NEF as defined in clause 4.2.2.2 of 3GPP TS 29.508 [12].\n-\tIf the downlink data notification control information indicates that the detection of DDD Status event and transmitted notification type is required, the SMF shall detect event and send the notification as defined in clause 4.2.2.2 of 3GPP TS 29.508 [12].\n-\tIf the downlink data notification control information indicates that the detection of DDN Failure event and/or DDD Status event and discarded notification type is required, the SMF shall derive a PDR and a related FAR as defined in clause 5.28 of 3GPP TS 29.244 [13] to request the UPF to report an event of the first discarded downlink data packet identified by the PDR. When the SMF receives the corresponding report, the SMF shall send the notification to the AMF as defined in clause 5.2.2.5.1 of 3GPP TS 29.502 [22] and/or send the notification to the NEF as defined in clause 4.2.2.2 of 3GPP TS 29.508 [12] respectively.\nWhen an Npcf_SMPolicyControl_Update request that requires a change of the authorized Session-AMBR and/or MBR update(s) for PCC Rule(s) corresponding to GBR service data flow(s) is received, the PCF may check if the S-NSSAI to which the received request relates is subject to network slice data rate policy control. If it is the case, the PCF shall apply network slice data rate control as described in clause 4.2.6.8.\nWhen an Npcf_SMPolicyControl_Update request that requires a change of the authorized Session-AMBR and/or MBR update(s) for PCC Rule(s) corresponding to GBR service data flow(s) is received, the PCF may apply group data rate control as described in clause 4.2.6.9.\nWhen the BAT_OFFSET_INFO policy control request trigger is set, upon receiving the BAT offset and optionally an adjusted periodicity from the NG-RAN, the SMF shall send an HTTP POST request to the PCF with an SmPolicyUpdateContextData data structure, including the \"BAT_OFFSET_INFO\" within the \"repPolicyCtrlReqTriggers\" attribute and the BAT offset within the \"ranBatOffsetNotif\" attribute and optionally the adjusted periodicity within the \"adjPeriod\" attribute.\nThe SMF shall adjust the BAT offset value of \"ranBatOffsetNotif\" attribute received from NG-RAN based on the clock drifting report from UPF. Otherwise, the SMF shall notify the BAT offset value of \"ranBatOffsetNotif\" attribute to PCF without any adjustment.\nWhen the BAT_OFFSET_INFO policy control request trigger is set and the QoS Notification Control is also enabled for the corresponding PCC rule, upon receiving the BAT offset along with the \"GFBR can no longer be guaranteed\" notification from the NG-RAN feedback, the SMF shall, in addition to the provisions of clause 4.2.4.20, include the \"BAT_OFFSET_INFO\" within the \"repPolicyCtrlReqTriggers\" attribute and the BAT offset within the \"ranBatOffsetNotif\" attribute of the SmPolicyUpdateContextData data structure.Editor’s Note: It is FFS how the bat offset is indicated and reported per PCC rule.\nWhen the PCF receives a Npcf_SMPolicyControl_Update request and the \"NetSliceUsageCtrl\" feature is supported, the PCF may check whether the S-NSSAI f the targeted SM Policy Association is subject to network slice usage control. If it is the case, the PCF may provision/update/remove in the Npcf_SMPolicyControl_Update response the network slice usage control information (e.g., the slice PDU session inactivity timer value) within the \"sliceUsgCtrlInfo\" attribute of the SmPolicyDecision data structure.\nNOTE:\tIn this release of the specification, network slice usage control information provisioning/update/removal by the PCF is not supported in roaming scenarios.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.5\tNpcf_SMPolicyControl_Delete Service Operation",
                            "text_content": "The delete service operation provides means for the NF service consumer to delete the policy context associated with a PDU Session.\nThe following procedures using the Npcf_SMPolicyControl_Delete service operation are supported:\n-\tDeletion of the policy context associated with a PDU session.\n-\tReport Accumulated Usage.\n-\tReport Access Network Information.\n-\tNetwork slice related data rate policy control.\n-\tGroup related data rate policy control.\n\nThe figure depicts a simplified representation of a 5G network's signaling architecture, illustrating the various components involved in signal propagation, including base stations (gNB), user equipment (UE), and scatterers. The diagram highlights the use of beamforming techniques to mitigate interference, and the presence of redundancy paths to ensure failover reliability. The layered design of the optical backbone aligns with SDN principles, emphasizing the importance of network virtualization and control plane abstraction.\nFigure 4.2.5.2-1: SM Policy Association termination\nWhen an individual resource of the SM Policy Association collection shall be deleted, the NF service consumer shall invoke the Npcf_SMPolicyControl_Delete service operation towards the PCF using an HTTP POST request, as shown in figure 4.2.5.2-1, step 1.\nThe NF service consumer shall set the request URI to \"{apiRoot}/npcf-smpolicycontrol/v1/sm-policies/{smPolicyId}/delete\". The {smPolicyId} in the URI identifies the \"Individual SM Policy\" to be deleted.\nThe HTTP POST request sent by the NF service consumer (e.g. SMF) shall contain (if available) the SM Policy Association related information within the SmPolicyDeleteData data structure in the request body:\n-\taccumulated usage within the \"accuUsageReports\" attribute as defined in clause 4.2.5.3;\n-\tthe user location(s) information within the \"userLocationInfo\" attribute, the information on when the UE was last known to be in that location within the \"userLocationInfoTime\" attribute, the PLMN Identifier or the SNPN Identifier (the PLMN Identifier and the NID) within the \"servingNetwork\" attribute, the timezone information within the \"ueTimeZone\" attribute and the RAN and/or NAS release cause(s) within the \"ranNasRelCauses\" attribute as defined in clause 4.2.5.4;\nNOTE 1:\tThe SMF derives the value of the \"userLocationInfoTime\" attribute from the age of location information received from the AMF at PDU session termination as described in 3GPP TS 29.502[22]. Whether the \"userLocationInfo\" attribute also encodes the age of location is implementation specific.\nNOTE 2:\tThe SMF encodes both 3GPP and non-3GPP access UE location in the \"userLocationInfo\" attribute when they are both received from the AMF.\n-\tthe \"PS_TO_CS_HO\" value within the \"pduSessRelCause\" attribute, if the PDU session is released due to PS to CS handover and the \"PDUSessionRelCause\" feature defined in clause 5.8 is supported;\n-\tthe \"RULE_ERROR\" value within the \"pduSessRelCause\" attribute, if the PDU session is released due to a failed enforcement of the applied session rule as described in clause 4.2.4.21 and the \"ImmediateTermination\" feature defined in clause 5.8 is supported.\nWhen the PCF receives the HTTP POST request from the NF service consumer and if the PCF successfully processed and accepted the received HTTP POST request from the NF service consumer, the PCF shall acknowledges the request by sending an HTTP response message with the corresponding status code. The PCF acknowledges the delete request by sending a \"204 No Content\" response to the NF service consumer, as shown in figure 4.2.5.2-1, step 2. Further, the PCF shall remove the individual resource linked to the delete request.\nIf errors occur when processing the HTTP POST request, the PCF shall send an HTTP error response as specified in clause 5.7.\nIf the feature \"ES3XX\" is supported, and the PCF determines the received HTTP POST request needs to be redirected, the PCF shall send an HTTP redirect response as specified in clause 6.10.9 of 3GPP TS 29.500 [4].\nIf the UMC feature is supported, at PDU session termination, the SMF shall send the accumulated usage information for all the monitoring keys for which usage monitoring was previously enabled. When the SMF receives the accumulated usage report from the UPF as defined in clause 7.5.7.2 of 3GPP TS 29.244 [13], the SMF shall include one or more received accumulated usage reports in the \"accuUsageReports\" attribute of the SmPolicyDeleteData data structure.\nIf all PDU sessions related to the same DNN and S-NSSAI combination for a user are terminated, the PCF shall store the remaining allowed usage, i.e. the information about the remaining overall amount of resources, in the UDR as defined in 3GPP TS 29.519 [15].\nIf the RAN-NAS-Cause feature is supported or the NetLoc feature is supported, within the SmPolicyDeleteData data structure, the SMF shall provide the available access network information within the \"userLocationInfo\" attribute (if available), the information on when the UE was last known to be in that location within the \"userLocationInfoTime\" attribute (if available), the \"ueTimezone\" attribute (if available). Additionally, for the NetLoc feature, if the user location information is not available, the SMF shall include the PLMN Identifier or the SNPN Identifier (the PLMN Identifier and the NID) within the \"servingNetwork\" attribute; for RAN-NAS-Cause feature, if the SMF received from the access network the RAN cause and/or the NAS cause due to PDU session termination, the SMF shall provide the received cause(s) in the \"ranNasRelCauses\" attribute.\nNOTE 1:\tThe SMF derives the value of the \"userLocationInfoTime\" attribute from the age of location information received in the Location-Report (defined in clause 5.3.1 of 3GPP TS 29.518 [36]) from the AMF. Whether the \"userLocationInfo\" attribute also encodes the age of location is implementation specific.\nNOTE 2:\tThe SMF encodes both 3GPP and non-3GPP access UE location in the \"userLocationInfo\" attribute when they are both received from the AMF.\nWhen an Npcf_SMPolicyControl_Delete request is received, the PCF may check if the S-NSSAI to which the received request relates is subject to network slice data rate policy control. If it is the case, the PCF shall apply network slice data rate control as described in clause 4.2.6.8.\nWhen an Npcf_SMPolicyControl_Delete request is received, the PCF may apply group data rate control as described in clause 4.2.6.9.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.6\tProvisioning and Enforcement of Policy Decisions",
                            "text_content": "Policy Decisions are provided from the PCF to the NF service consumer (SMF) as part of the following service operations:\n-\tthe Npcf_SMPolicyControl_Create Service Operation described in clause 4.2.2;\n-\tthe SM Policy Association Notification request as part of the Npcf_SMPolicyControl_UpdateNotify Service Operation as described in clause 4.2.3.2; and\n-\tthe Npcf_SMPolicyControl_Update service operation as described in clause 4.2.4\nPolicy decisions shall be encoded within the SmPolicyDecision data structure defined in clause 5.6.2.4\nPolicy decisions may include:\n-\tSession Rule(s), as described in clause 4.1.4.3, encoded within the \"sessRules\" attribute;\n-\tPCC Rule(s), as described in clause 4.1.4.2, encoded within the \"pccRules\" attribute;\n-\tQoS decision(s), as described in clause 4.1.4.4.3, which can be referenced from PCC rule(s), encoded within the \"qosDecs\" attribute;\n-\tCharging decision(s), as described in clause 4.1.4.4.4, which can be referenced from PCC rule(s), encoded within the \"chgDecs\" attribute;\n-\tTraffic control decision(s), as described in clause 4.1.4.4.2, which can be referenced from PCC rule(s), encoded within the \"traffContDecs\" attribute;\n-\tUsage monitoring control decision(s), as described in clause 4.1.4.4.5, which can be referenced from PCC rule(s) and session rule(s), encoded within the \"umDecs\" attribute;\n-\tQoS monitoring decision, as described in clause 4.1.4.4.6, which can be referenced from PCC rule(s), encoded within the \"qosMonDecs\" attribute;\n-\tCondition(s) that can be referenced from PCC rule(s) and session rule(s), encoded within the \"conds\" attribute;\n-\tQoS characteristics for non-standard 5QIs and non-preconfigured 5QIs provided within the \"qosChars\" attribute;\n-\tA reflective QoS timer;\n-\tPolicy control request triggers and applicable additional information, e.g. Revalidation Time, PRA information;\n-\tLast requested rule data;\n-\tLast requested usage data;\n-\tDefault charging method of the PDU session;\n-\t\"PDU Session with offline charging only\" indication;\n-\tCharging information;\n-\tP-CSCF Restoration Indication;\n-\tIP index information;\n-\tPresence Reporting Area information;\n-\tTSC user plane node management information;\n-\tport management information for the DS-TT port;\n-\tport management information for the NW-TT port;\n-\tThe request of the PDU session termination;\n-\tUsage of QoS flow;\n-\tRedundant PDU session indication;\n-\tVPLMN Specific Offloading Policy; and\n-\tthe network slice usage control information (e.g. the slice PDU session inactivity timer value), if the \"NetSliceUsageCtrl\" feature is supported.\nNOTE:\tIn this release of the specification, network slice usage control information provisioning/update/removal by the PCF is not supported in roaming scenarios.\nFor the Npcf_SMPolicyControl_Create Service Operation, the SmPolicyDecision data structure shall contain a full description of all policy decision(s) provided by the PCF for the policy association.\nFor the Npcf_SMPolicyControl_UpdateNotify service operation for the SM Policy Association Notification request and for the Npcf_SMPolicyControl_Update service operation, the SmPolicyDecision data structure shall contain a description of the changes to the policy decision(s) with respect to the last provided policy decision(s) for the corresponding policy association. The redundant PDU session indication, the default charging method of the PDU session, the \"PDU Session with offline charging only\" indication, the charging information, the Reflective QoS Timer and the IP index information shall not be updated by the PCF.\nIf no other rule is defined for specific data types within the SmPolicyDecision data structure, the encoding of changes of the policy decision(s) in the SmPolicyDecision data structure shall follow the following principles:\n1)\tTo modify an attribute with a value of type map (e.g. the \"sessRules\" attribute, the \"pccRules\" attribute, the \"qosDecs\" attribute, the \"traffContDecs\" attribute, the \"umDecs\" attribute, the \"conds\" attribute, etc.), this attribute shall be provided with a value containing a map with entries according to the following principles:\n-\tA new entry of the map shall be added by supplying a new identifier (e.g. rule / decision identifier) as the key and the corresponding structured data type instance (e.g. PCC rule) with the complete content as the value.\n-\tAn existing entry of the map shall be modified by supplying the existing identifier as the key and the corresponding structured data type instance as the value, with the same existing identifier (e.g. set the \"qosId\" to the same existing QoS data decision identifier), which shall describe the modifications following bullets 1 to 6.\n-\tAn existing entry of the map shall be deleted by supplying the existing identifier as the key and \"NULL\" as the value.\n-\tFor an unmodified entry of the map, no entry needs to be provided within the map.\n2)\tTo modify an attribute with a structured data type instance as the value, the attribute shall be provided with a value containing a structured data type instance with entries according to bullets 1 to 6.\n3)\tTo modify an attribute with another type than map or structured data type as the value, the attribute shall be provided with a complete representation of its value, which shall replace the previous value.\n4)\tTo create an attribute of any type, the attribute shall be provided with a complete representation of its value.\n5)\tTo delete an attribute of any type, the attribute shall be provided with \"NULL\" as the value.\nNOTE 1:\tAttributes that are allowed to be deleted need to be marked as \"nullable\" within the OpenAPI file in Annex A.\n6)\tAttributes that are not added, modified or deleted do not need to be provided.\nNOTE 2:\tIn the related data structures, no attribute can be marked as mandatory except the attribute containing the identifier (e.g. rule / decision identifier).\nThe PCF shall not remove a provisioned policy decision data or condition data from the SMF when the associated reference(s) from the PCC rule(s) or session rule(s) are still valid except the usage montoring data referred by the pre-defined PCC rule(s) (see clause 4.2.6.5.3.2 for further information). If the PCF determines that the policy decision or condition data shall be used for future PCC or session rule(s), the PCF may keep a policy decision data or condition data valid when the PCF removes all the PCC rule or session rule(s) referring to that policy decision data or condition data; otherwise the PCF shall remove the provisioned policy decision data or condition data when the PCF removes all the PCC or session rule(s) referring to the policy decision data or condition data.\nWhen the NF service consumer (SMF) accepts the notification of policy updates, and/or when after receiving the response to the request of policies the SM Policy association is retained in the NF service consumer (SMF), if the installation/activation of one or more new PCC rule(s) or the installation of one or more session rule(s) (i.e. rules which were not previously successfully installed) fails, although the failed PCC rule(s) or session rule(s) are removed, the policy decision and/or condition data which are referred by the failed PCC rule(s) or session rule(s) may remain applicable in the SMF until the PCF removes them. If the PCF determines that the policy decision or condition data that remain applicable shall be used for future PCC or session rule(s) (e.g. because the PCF reattempts to install the failed PCC rule) the PCF may keep these policy decision data or condition data valid; otherwise the PCF shall immediately remove these policy data or condition data from the SMF.\nNOTE 3:\tDue to internal policies, the SMF could decide to remove the policy decision and/or condition data not referred by any PCC and/or session rule(s) before the PCF decides to remove them. When the PCF decides to remove the policy decision and/or condition data that were silently removed by the SMF, the SMF accepts the removal indication, as specified in clauses 4.2.3.26 and 4.2.4.26. When the PCF decides to reuse the policy decision and/or condition data that were silently removed by the SMF, the SMF reports PCC and/or session rule error as specified in clauses 4.2.3.16, 4.2.4.15, 4.2.3.20 and 4.2.4.21.\nNOTE 4:\tWhen the PCF notification of policy updates is rejected as specified in clauses 4.2.3.16 and 4.2.3.20 with a HTTP \"400 Bad Request\" status code, the whole update is rejected, including the provided policy decision and/or condition data. When the SMF reports PCC and/or session rule(s) error as specified in clauses 4.2.4.15 and 4.2.4.21 for all the provisioned PCC rule and/or session rule(s), the valid policy decision and/or condition data provided in the corresponding update response can remain valid in the SMF until the PCF removes them.\nThe error handling for the policy decision and/or condition data which are not referred by any PCC rule and/or session rule stored at the SMF is defined in clause 4.2.3.26 and 4.2.4.26.\nThe PCF may perform an operation on a single PCC rule or a group of PCC rules. The impacted PCC rule(s) shall be included in the \"pccRules\" map attribute within the SmPolicyDecision data structure with the associated \"pccRuleId\" as the key of the map. For activating a pre-defined PCC rule or installing or modifying a dynamic PCF-provisioned PCC rule, the corresponding PccRule data structure shall be provided as the map entry value. For deactivating or removing a PCC rule, the map entry value shall be set to \"NULL\".\nNOTE 1:\tWhen deactivating a predefined PCC rule that is activated in more than one QoS flow, this predefined PCC rule is deactivated simultaneously in all the QoS flows where it was previously activated.\nIn order to activate a pre-defined PCC rule, the PCF shall include within the PccRule data structure the pre-defined PCC rule identifier within the \"pccRuleId\" attribute and the \"refCondData\" attribute, if applicable, i.e. the PccRule data structure is empty, except for the \"pccRuleId\" attribute and the \"refCondData\" attribute, if applicable. If the \"refCondData\" attribute is applicable, a \"conds\" attribute containing the corresponding ConditionData data structure referred by this PCC rule shall be included in the SmPolicyDecision data structure, if it has not been previously provided.\nIn order to install a new dynamic PCF-provisioned PCC rule, the PCF shall further set other attributes within the PccRule data structure as follows:\n-\tIt may include the precedence of a PCC rule among the other PCC rules of the PDU session, within the \"precedence\" attribute. Within a PDU session, the PCF shall authorize different precedence values for the PCC rules whose packet filters contained within the \"flowDescription\" attribute or the \"ethFlowDescription\" attribute include the \"packetFilterUsage\" attribute set to \"true\".\nNOTE 2:\tThe SMF sets the precedence value of a QoS rule to the precedence value of the PCC rule for which the QoS rule is generated. The UE considers as an error when two or more QoS rules associated with a PDU session have identical precedence values.\n-\tIt shall include either the flow information within the \"flowInfos\" attribute or the application identifier within the \"appId\" attribute.\n-\tIt shall include one reference to the QosData data structure within the \"refQosData\" attribute. In this case, a \"qosDecs\" attribute containing the corresponding QoS data policy decision shall be included in the SmPolicyDecision data structure, if it has not been previously provided.\n-\tIt may include one or more reference(s) to the QosData structure within the \"refAltQosParams\" attribute to refer to the Alternative QoS parameter set(s) of the service data flow. In this case, a \"qosDecs\" attribute containing the corresponding alternative QoS data policy decision(s) shall be included in the SmPolicyDecision data structure, if it has not been previously provided,\n-\tIt shall include one reference to the TrafficControlData data structure within the \"refTcData\" attribute. In this case, a \"traffContDecs\" attribute containing the corresponding Traffic Control data policy decision shall be included in the SmPolicyDecision data structure, if it has not been previously provided.\n-\tIt may include one reference to the ChargingData data structure within the \"refChgData\" attribute. In this case, a \"chgDecs\" attribute containing the corresponding Charging Data policy decision shall be included in the SmPolicyDecision data structure, if it has not been previously provided.\n-\tIt may include one reference to the UsageMonitoringData data structure within the \"refUmData\" attribute. In this case, a \"umDecs\" attribute containing the corresponding Usage Monitoring data policy decision shall be included in the SmPolicyDecision data structure, if it has not been previously provided.\n-\tIt may include one reference to the QosMonitoringData data structure within the \"refQosMon\" attribute. In this case, a \"qosMonDecs\" attribute containing the corresponding QoS Monitoring data policy decision shall be included in the SmPolicyDecision data structure, if it has not been previously provided.\n-\tIt may include one reference to the ConditionData data type within the \"refCondData\" attribute. In this case, a \"conds\" attribute containing the corresponding Condition Data shall be included in the SmPolicyDecision data structure, if it has not been previously provided.\n-\tIf the \"PowerSaving\" feature is supported, it may include the traffic parameter data within the \"traffParaData\" attribute.\nIn order to modify an existing dynamic PCF-provisioned PCC rule, the PCF shall further set other attributes within the PccRule data structure as follows:\n-\tIf the PCF needs to modify attribute(s) within a PCC rule, the PCF shall include the modified attribute(s) with their new value(s) within the associated PccRule data instance in the SmPolicyDecision data structure. Previously supplied attribute(s) not supplied in the modified PCC rule instance shall remain valid.\n-\tIf the PCF only needs to modify the content of the referenced policy decision data (e.g. QosData, ChargingData, etc.) and/or condition data for one or more PCC rule(s), the PCF shall include, within the SmPolicyDecision data structure, the corresponding policy decision data and/or condition data within the corresponding map attribute(s) (e.g. include the QoS data decision(s) within the \"qosDecs\" attribute).\n-\tIn order to modify the content of the referenced condition data for one or more existing pre-defined PCC rule(s), the PCF shall include, within the SmPolicyDecision data structure, the corresponding condition data within the \"conds\" attribute.\nNOTE 3:\tTo update a policy decision data and/or condition data instance, the PCF can provide only the modified attribute(s) with their new value(s) or could provide both, the modified attribute(s) with their new value(s) and the unmodified attributes. When only the modified attribute(s) are provided, the previously supplied attribute(s) not supplied in the modified policy decision data and/or condition data instance remain valid.\n-\tPCF may also perform a full replacement of a policy decision data and/or condition data instance by including the new reference to the policy decision data and/or condition data instance within the associated PCC rule and the corresponding policy decision and/or condition data in the SmPolicyDecision data structure, if it has not been previously provided.\nThe PCF may combine multiple of the above PCC rule operations in a single message.\nThe SMF shall ensure that at least one PCC Rule bound to the default QoS flow is activated for the PDU Session. If the PCF does not provision any PCC rule, the SMF shall activate at least one pre-defined PCC rule which is not known by the PCF and bind it to the default QoS flow.\nIf the authorized default QoS is GBR type or delay critical GBR type as defined in clause 4.2.6.3.3, to ensure that one and only one of the authorized PCC rules is bound to the default QoS flow the PCF shall indicate that one and only one PCC rule is bound to the default QoS flow as defined in clause 4.2.6.2.10. The SMF shall not bind any other PCC rule to the default QoS flow with a GBR or delay critical GBR 5QI.\nThe SMF shall ensure that the packet fitlers signalled to UE reflects the QoS Flow binding of PCC rules, except for those extending the inspection beyond what can be signalled to the UE. The SMF shall explicitly signal the packet filters to the UE if the corresponding \"packetFilterUsage\" attribute is provided and set to true. If the \"packetFilterUsage\" attribute is absent or set to false, it is an SMF decision whether to signal the packe filters that is redundant from a traffic mapping point of view.\nThe default QoS rules shall contain either a Packet Filter Set that allows all UL packets or a Packet Filter Set that is generated from the UL packet filters (and from the DL packet filters if they are available) with the \"packetFilterUsage\" attribute set to true.\nNOTE 1:\tIf multiple PCC rules with the \"packetFilterUsage\" attribute set to true are bound to the QoS Flow associated with the default QoS rule, it is up to SMF implementation which one will be chosen to generate the default QoS rule. If the PCC rule that is chosen to generate the default QoS rule is removed/deactivated, another PCC rule bound to the QoS Flow associated with the default QoS rule will be used instead and the default QoS rule would be updated accordingly.\nNOTE 2:\tFor IP type PDU Session or Ethernet type PDU Session, the default QoS rule is the only QoS rule of a PDU Session which may contain a Packet Filter Set that allows all UL packets, and in this case, the highest precedence value can be used for the QoS rule.\nThe Gate Function is a user plane function that permits to control, i.e. enabling or disabling, the forwarding of data packets belonging to a service data flow. A gate is provisioned by the PCF within a PCC rule, enforced by the SMF and ultimately applied by the UPF.\nIf a PCC rule contains the \"flowInfos\" attribute applicable for uplink service data flow(s), it shall describe a gate for the corresponding uplink service data flow(s). If a PCC rule contains the \"flowInfos\" attribute(s) applicable for downlink service data flow(s), it shall describe a gate for the corresponding downlink service data flow(s). If the PCC rule contains an \"appId\" attribute, it shall describe a gate for the corresponding detected application traffic. In order to do so, the \"flowStatus\" attribute within the TrafficControlData data structure to which the PCC rule refers shall describe if uplink and/or downlink gate(s) is/are open or closed.\nThe commands to open or close a gate shall lead to enabling or disabling the passage of the corresponding data packets. If a gate is closed, all data packets of the related service data flow(s) are dropped by the UPF. If a gate is open, the data packets of the related service data flow(s) are allowed to be forwarded by the UPF.\nThe PCF may provide the authorized QoS for a PCC rule to the SMF. The Provisioning of the authorized QoS per PCC Rule shall be performed using the PCC rule provisioning procedure defined in clause 4.2.6.2.1. For a PCF-provided PCC rule, the authorized QoS shall be encoded using the QosData data structure. The PCF shall include for this purpose a reference to this QosData data structure within the \"refQosData\" attribute of the PCC rule and a \"qosDecs\" attribute containing this QoS data decision within the SmPolicyDecision data structure.\nIf the authorized QoS is provided for a PCC rule, the SMF shall derive the associated QoS profile towards the access network, if applicable, the associated QoS rule towards the UE, if applicable, and the associated QoS information with the PDR(s) towards the UPF.\nWhen the ADC feature is supported, the PCF may provide the redirect instructions for one or several dynamic PCC rule(s) to the SMF. This Provisioning shall be performed using the policy provisioning procedure defined in clause 4.2.6.1.\nThe \"traffContDecs\" attribute within the SmPolicyDecision is used to provide traffic control decision(s). The redirect instructions shall be encoded using the \"redirectInfo\" attribute within the corresponding TrafficControlData data structure, and used to provide a RedirectInformation data structure with the following components:\n-\tThe \"redirectEnabled\" attribute to indicate whether redirect is enabled or not. It shall be included and set to true when the redirect instruction is initially provisioned and may be included in subsequent updates of the RedirectInformation to enable or disable the redirect instruction.\n-\tThe redirect address may be provided using the \"redirectAddressType\" and \"redirectServerAddress\" attributes or it may be preconfigured in the SMF/UPF. A redirect destination provided within the \"redirectServerAddress\" attribute for a dynamic PCC Rule shall override the redirect destination preconfigured in the SMF/UPF.\nNOTE 1:\tThe SMF/UPF uses the preconfigured redirection address only if it can be applied to the application traffic being detected, e.g. the redirection destination address could be preconfigured on a per application identifier basis.\nIf redirect action(s) need to be applied to a dynamic PCC rule, this PCC rule shall reference a traffic control decision with the relevant redirect instructions. If a dynamic PCC rule includes flow information for UE IPv4 address and IPv6 prefix address(es) related to the same application identifier and the ADCmultiRedirection feature is supported, the \"addRedirectInfo\" attribute including more than one RedirectInformation data structure may be provided simultaneously to the redirect instruction.\nIf the \"redirectInfo\" attribute is provided for a dynamic PCC rule, the SMF shall instruct the UPF to perform the requested redirection as defined in 3GPP TS 29.244 [13].\nIf the \"redirectServerAddress\" attribute is not provided in the dynamic PCC rule and the redirection address is not preconfigured in the SMF/UPF for this PCC rule, the SMF shall perform PCC Rule Error Report, as specified in clauses 4.2.3.16 and 4.2.4.15, and set the \"failureCode\" attribute to \"MISS_REDI_SER_ADDR\".\nNOTE 2:\tWhen the redirect server address is not provided by the PCC rule, the SMF determines the \"MISS_REDI_SER_ADDR\" error, e.g. when the SMF determines the redirect destination is not pre-configured at both the SMF and the UPF.\nTo disable the redirect function for one or more already installed PCC Rule(s), the PCF shall:\n-\tupdate the PCC rule to modify the reference to Traffic Control Data decision to point to another (existing or new) Traffic Control Data decision that does not have \"redirectInfo\" instructions; or\n-\tupdate the Traffic Control Data decision that the PCC rule refers to with the \"redirectEnabled\" attribute set to false, if the PCF disables the redirect function for all the PCC rules that refer to this Traffic Control Data decision.\nFor a predefined PCC rule, the redirect information shall be included in the rule definition at the SMF/UPF. Redirect information shall be activated for predefined PCC rules while those rules are active.\nUsage monitoring may be performed for service data flows associated with one or more PCC rules.\nThe provisioning of usage monitoring control per PCC rule shall be performed using the PCC rule provisioning procedure as defined in clause 4.2.6.2.1. For a dynamic PCC rule, the reference to the UsageMonitoringData data structure of the usage monitoring control instance, which is related with the PCC rule, shall be included within the \"refUmData\" attribute of the PccRule data structure of the PCC rule(s). For a predefined PCC rule, the reference to a usage monitoring control instance shall be included in the rule definition at the SMF. Usage monitoring shall be activated for both service data flows associated with predefined PCC rules and dynamic PCC rules, including rules with deferred activation and/or deactivation times while those rules are active.\nIf the TSC feature is supported, the PCF may instruct the SMF to apply a traffic steering control for the purpose of:\n-\tsteering the subscriber's traffic to an appropriate operator or 3rd party service functions (e.g. NAT, antimalware, parental control, DdoS protection) in the N6-LAN or 5G-LAN type of services according to operator policy or, if the SFC feature is supported, according to the information of AF influenced service function chaining, and/or\n-\tenabling the routing of the user traffic to a local Data Network identified by a DNAI per AF request. When the \"CommonEASDNAI\" feature is supported, the procedure is also used by the PCF to request to select a common EAS or a common DNAI for a set of UE associated with the same traffic correlation Id accessing the application identified by the service data flow template as requested by the AF or to provide endpoint information for the NEF to be notified with information related to UE members of the set of UEs identified by traffic correlation ID.\nIf the SFC feature is supported, the PCF may instruct the SMF to apply both traffic steering controls above simultaneously.\nThis procedure is only applicable in non-roaming and home-routed scenarios.\nFor the purpose of steering the subscriber's traffic to an appropriate operator or 3rd party service functions in the N6-LAN or steering the 5G-LAN type of services based on network operator configured policies not related to an AF request to influence service function chaining, the PCF shall include within the PccRule data structure a reference to the relevant Traffic Control Data decision and:\n-\tinclude within the PccRule data structure either the application to be detected identified by the \"appId\" attribute or the service data flow to be detected identified by the \"flowInfos\" attribute; and\n-\tinclude a \"traffContDecs\" attribute containing the corresponding Traffic Control Data decision within the SmPolicyDecision, if it has not been previously provided. In this case, the PCF shall include directly within this Traffic Control Data decision a traffic steering policy identifier for downlink within the \"trafficSteeringPolIdDl\" attribute and/or a traffic steering policy identifier for uplink within the \"trafficSteeringPolIdUl\" attribute.\nWhen the SFC feature is supported, for the purpose of steering the subscriber's traffic to an appropriate operator or 3rd party service functions in the N6-LAN or steering the 5G-LAN type of services related to an AF request to influence service function chaining, the PCF shall determine if the ongoing PDU Session is impacted by the steering of traffic to a Service Function Chain as follows:\n-\tIf the AF request includes the individual IP address/ prefix allocated to a UE or the UE MAC address, the PCF shall store the received traffic steering control information and perform session binding as defined in clause 6.2 of 3GPP TS 29.513 [7] to determine the impacted PDU session.\n-\tOtherwise, the PCF fetches from the UDR, as defined in 3GPP TS 29.519 [15], the traffic steering control information applicable for a UE, any UE or an Internal Group Id (if received in the SMF request).\nThen the PCF authorizes the request for influencing service function chaining. For the impacted PDU Session that corresponds to the AF request, the PCF shall take into account, if available, the service function chaining indication stored in the policy data subscription information in the UDR, as defined in 3GPP TS 29.519 [15], to determine whether it is allowed to generate PCC rules with traffic steering information based on AF request information. When allowed, the PCF shall generate PCC rules with traffic steering control information and provide the corresponding Traffic Control Data decision as described above. In this case the traffic steering policy identifier for downlink and/or uplink traffic may be derived from the SFC ID(s) provided by the AF. Additionally, the Traffic Control Data decision may include metadata if provided by the AF.\nNOTE:\tIn case there are both a network operator configured policy for N6-LAN Traffic Steering in PCF and an AF-provided SFC ID(s) mapping to traffic steering control information, the PCF decides based on local configuration which one takes precedence.\nThe PCF may also provision the traffic steering control information by activating pre-defined PCC rule(s) in the SMF.\nIf traffic steering policy provided in the \"trafficSteeringPolIdUl\" and/or \"trafficSteeringPolIdDl\" attribute are invalid or unknown, or the enforcement of the steering of the traffic failed, the SMF shall return a PCC Rule Error Report, as specified in clauses 4.2.3.16 and 4.2.4.15, and set the \"failureCode\" attribute to \"TRAFFIC_STEERING_ERROR\".\nThis procedure is only applicable in non-roaming and visited access (i.e. LBO) scenarios.\nThe PCF shall determine if the ongoing PDU Session is impacted by the routing of traffic to a local access to a data network as follows:\n-\tIf the AF request includes the individual IP address/ prefix allocated to a UE or the UE MAC address, the PCF shall store the received traffic routing information and perform session binding as defined in clause 6.2 of 3GPP TS 29.513 [7] to determine the impacted PDU session.\n-\tOtherwise, the PCF fetches from the UDR, as defined in 3GPP TS 29.519 [15], the traffic routing data information applicable for a UE, any UE or one or more Internal Group Id(s) (if received in the SMF request) and/or subscriber category(ies).\nNOTE 1:\tIf the UDR provides as part of the traffic routing data information a list of Internal Group Id(s), this information applies to all the PDU sessions related to UEs that belong to every one of these groups, i.e. a single UE needs to be a member of every group in the list of Internal Group Id(s). If the list of subscriber category(ies) is part of the traffic routing data information, this information applies to all the PDU sessions related to the UEs that belong to every one of these Subscriber Categories.\nThen the PCF authorizes the request for influencing SMF routing decisions. For the impacted PDU Session that corresponds to the AF request, the PCF shall take into account, if available, the local routing indication stored in the policy data subscription information in the UDR, as defined in 3GPP TS 29.519 [15], to determine whether it is allowed to generate PCC rules with traffic routing information. When allowed, the PCC rules are generated based on the AF request as follows:\n-\tWhen the request is for influencing SMF routing decisions, based on traffic routing information, operator's policy, etc., the PCF determines the traffic steering policy. The traffic steering policy indicates, for each DNAI, a traffic steering policy identifier configured in the SMF and/or if the N6 routing information associated to the application is explicitly provided by the AF, the N6 routing information (as provided by the AF). The traffic steering policy identifier is derived by the PCF from the routing profile Id provided by the AF and is related to the mechanism enabling traffic steering to the DN. Then:\n-\tThe PCF shall include within each PccRule data structure the necessary information to identify the concerned traffic within either the \"flowInfos\" attribute or the \"appId\" attribute, and include within the TrafficControlData data type that the PCC rule refers to a list of locations that the traffic shall be routed to in the \"routeToLocs\" attribute, and, if the \"AF_latency\" feature is supported, the PCF shall include the maximum allowed user plane latency within the \"maxAllowedUpLat\" attribute if available. If \"EASIPreplacement\" feature is supported, the PCF shall include the EAS IP replacement information within the \"easIpReplaceInfos\" attribute if available.\n-\tWithin each RouteToLocation instance, the PCF shall include a DNAI in the \"dnai\" attribute to indicate the location of the application towards which the traffic routing is applied, and a traffic steering policy identifier in the \"routeProfId\" attribute, to indicate the traffic steering policy that applies to the indicated DNAI, and/ or the explicit N6 traffic routing information in the \"routeInfo\" attribute.\n-\tIf the AF provides both a routing profile Id and N6 routing information for a DNAI, the PCF may include a RouteToLocation instance with the required information or may include two RouteToLocation instances with the same DNAI within the \"dnai\" attribute and a traffic steering policy identifier within the \"routeProfId\" attribute in one instance and explicit routing information within the \"routeInfo\" attribute in the other instance.\nNOTE 2:\tThe N6 traffic routing requirements are related to the mechanism enabling traffic steering in the local access to the DN. The routing profile ID refers to a pre-agreed policy between the AF and the 5GC. This policy may refer to different steering policy identifier(s) sent to the SMF and e.g. based on time of the day, etc.\nNOTE 3:\tWhen per DNAI both, the \"routeProfId\" and the \"routeInfo\"attributes are provided, if the pre-configured traffic steering policy referenced by the \"routeProfId\" attribute contains information that is overlapping with the N6 traffic routing information provided in the \"routeInfo\" attribute, the N6 traffic routing information takes precedence.\nNOTE 4:\tIn this release of the specification, either a traffic steering policy identifier for UL or a traffic steering policy identifier for DL can be defined per DNAI.\n-\tWhen the request is for subscribing to UP path change events of the PDU session, the PCF shall include the information on AF subscription to UP path change events within the PCC rule(s) to request the SMF to create a subscription to such notifications for the AF. In order to do so, the PCF shall include within each PccRule data structure the necessary information to identify the concerned traffic within either the \"flowInfos\" attribute or the \"appId\" attribute, and include within the Traffic Control Data decision that the PCC rule refers to the information on AF subscription to events within the \"upPathChgEvent\" attribute. Within this \"upPathChgEvent\" attribute, the PCF shall include the \"dnaiChgType\" attribute to indicate the type of notification (i.e. early notification, late notification or both), the notification URI within the \"notificationUri\" attribute, the notification correlation Id within the \"notifCorreId\" attribute, and if the URLLC feature is supported, an indication of AF acknowledgement to be expected within the \"afAckInd\" attribute. In order to enable the AF to identify the AF request to which the notification corresponds when the AF receives a UP path change notification from the SMF, as defined in clause 4.2.2.2 of 3GPP TS 29.508 [12], the PCF shall set the values of the \"notificationUri\" attribute and \"notifCorreId\" attribute respectively as follows:\n-\tIf the PCF fetches the traffic routing data information from the UDR, the PCF shall set the value of the \"notificationUri\" attribute to the value of the \"upPathChgNotifUri\" attribute of the TrafficInfluData data structure and set the value of the \"notifCorreId\" attribute to the value of the \"upPathChgNotifCorreId\" attribute of the TrafficInfluData data structure as defined in 3GPP TS 29.519 [15].\n-\tIf the PCF receives the traffic routing data information from the AF via N5 interface, the PCF shall set the values of the \"notificationUri\" attribute and the \"notifCorreId\" attribute according to the \"upPathChgSub\" attribute within the AfRoutingRequirement data structure as defined in 3GPP TS 29.514 [17].\nIf the NEF/AF provided information about the feature support on Nsmf_EventExposure service as described in 3GPP TS 29.514 [17] (AF request applies an individual UE address) or 3GPP TS 29.519[15] (AF request applies to PDU sessions not identified by a UE address), the PCF may also include this information within the \"nscSuppFeats\" attribute included within the PccRule data type.\n-\tIf the AF request includes an indication that application relocation is not possible, the PCF shall include within the PccRule data instance(s) the necessary information to identify the traffic within either the \"flowInfos\" attribute or the \"appId\" attribute and the \"appReloc\" attribute set to true. In this case, the SMF shall ensure that for the traffic related with the concerned application, no DNAI change takes place once selected initially for this application.\n-\tIf the \"EASDiscovery\" feature is supported and the AF request includes an indication that EAS rediscovery is required, the PCF shall include within the PccRule data instance(s) the necessary information to identify the traffic within the \"appId\" attribute and the \"easRedisInd\" attribute set to true.\n-\tIf the URLLC feature is supported and the AF request includes an indication that the UE IP address preservation should be considered, the PCF shall include within the concerned PccRule data instance(s) the \"addrPreserInd\" attribute set to true.\n-\tIf the AF request includes an indication that the PDU session should be correlated via a common DNAI for a given traffic, the PCF shall include within the TrafficControlData data instance provisioned for one or more PCC rule(s), the \"traffCorreInd\" attribute set to true.\nNOTE 5:\tThe indication of traffic correlation can be provided together with the traffic routing information by the AF for all the members of the 5G VN group. Referred to clause 5.29.4 of 3GPP TS 23.501 [2].\n-\tIf the feature \"SimultConnectivity\" is supported and the AF request includes an indication that the simultaneous connectivity may be temporarily maintained for the target and the source PSA during the edge re-location procedure, the PCF may include within the TrafficControlData data instance provisioned for one or more PCC rule(s) the \"simConnInd\" attribute set to true, as indicated by the AF. If the feature \"SimultConnectivity\" is supported and the AF request includes the time interval to be considered for inactivity of the traffic routed through the source PSA after which the simultaneous connectivity can be terminated, the PCF may also include the received duration within the \"simConnTerm\" attribute.\n-\tIf the feature \"CommonEASDNAI\" is supported and AF includes a traffic correlation information within \"tfcCorreInfo\" attribute, and\n-\tif the AF request also includes an indication that the PDU session should be correlated via a common DNAI, the PCF shall include the TrafficControlData data instance provisioned for one or more PCC rule(s), \"COMMON_DNAI\" within the \"corrType\" attribute and the identification of a set of UEs accessing the application identified by the service data flow template within the \"tfcCorrId\" attribute. If the NEF has added its information in the AF request in order to be notified with information related to UE members of the set of UEs identified by traffic correlation ID, then the PCF shall include also the \"notifUri\" and \"notifCorrId\" attributes within the \"tfcCorreInfo\" attribute of the TrafficControlData; or\n-\tif the AF request also includes an indication that a common EAS for the application identified by the service data flow template should be selected, the PCF shall include the TrafficControlData data instance provisioned for one or more PCC rule(s), the \"COMMON_EAS\" within the \"corrType\" attribute, the identification of a set of UEs accessing the application identified by the service data flow template within the \"tfcCorrId\" attribute, the common EAS address(s) within the \"comEasIpv4Addr\" attribute and/or \"comEasIpv6Addr\" attribute and/or the FQDN range corresponding to the application within the \"fqdnRange\" attribute. If the NEF has added its information in the AF request in order to be notified with information related to UE members of the set of UEs identified by traffic correlation ID, then the PCF shall include also the \"notifUri\" and \"notifCorrId\" attributes within the \"tfcCorreInfo\" attribute of the TrafficControlData.\nNOTE 6:\t\tCommon EAS selection means the common DNAI is selected.\nThe PCF shall provide the PCC rule(s) as defined in clause 4.2.6.2.1.\nIf the temporal validity condition is received, the PCF shall evaluate the temporal validity condition of the AF request and inform the SMF to install or remove the corresponding PCC rule(s) according to the evaluation result. When policies specific to the PDU Session and policies general to multiple PDU Sessions exist, the PCF gives precedence to the PDU Session specific policies over the general policies.\nIf the spatial validity condition is received, the PCF considers the latest known UE location to determine the PCC rules provided to the SMF. In order to do that, the PCF shall request the SMF to report the notifications about change of UE location in an area of interest (i.e. Presence Reporting Area) as defined in clauses 4.2.2.13 or 4.2.3.19. The subscribed area of interest may be the same as the one provided in spatial validity condition, or may be a subset of the spatial validity condition (e.g. a list of TAs) based on the latest known UE location. When the SMF detects that the UE entered the area of interest subscribed by the PCF, the SMF notifies the PCF and the PCF provides to the SMF the PCC rule(s) described above. When the SMF becomes aware that the UE left the area subscribed by the PCF, the SMF notifies the PCF and the PCF may remove or provide updated PCC rule(s) to the SMF.\nWhen the PCC rules are installed, the SMF may, based on local policies, take the information in the PCC rule(s) into account to:\n-\tif the PDU Session is of IP type and the \"addrPreserInd\" attribute is included and set to true in the PCC rule(s), the SMF should preserve the UE IP address and, if necessary, not reselect the related PSA UPF for the traffic identified in the PCC rule once the PSA UPF is selected; otherwise, the SMF (re)selects UPF(s) as it might be required for PDU Sessions.\n-\tactivate mechanisms for traffic multi-homing or enforcement of an UL Classifier (UL CL).\n-\tinform the AF of the (re)selection of the UP path (change of DNAI) and/or the candidate DNAI(s) for the PDU Session if the \"CommonEASDNAI\" feature is supported and the \"candDnaiInd\" attribute was set to \"true\".\n-\tdetermine the target DNAI(s) for the current UE location, which may imply I-SMF selection or removal to be requested to the AMF as defined in 3GPP TS 29.502 [22].\n-\tif the \"traffCorreInd\" attribute set to true is included in the TrafficControlData data type referenced by a set of PCC rules, based on SMF implementation and local configuration, the SMF should select a common DNAI from the list of DNAI included in the \"routeToLocs\" attribute for the identified traffic of the PDU session.\n-\tif the \"simConnInd\" attribute set to true is included in the TrafficControlData data type referenced by a set of PCC rules, the SMF may temporarily maintain simultaneous connectivity for the source and target PSA at edge relocation procedure, and may influence the establishment of a temporary N9 forwarding tunnel between the source UL CL and target UL CL. If the \"simConnTerm\" attribute is also included, the SMF may consider the indicated time interval as the minimum one to be considered for inactivity for the described traffic before the connectivity over the source PSA may be removed.\n- \tif the \"maxAllowedUpLat\" attribute is received, SMF may use this value to decide whether edge relocation is needed to ensure that the user plane latency does not exceed the value and whether to relocate the PSA UPF to satisfy the user plane latency.\n-\tif the \"easIpReplaceInfos\" attribute is received, the SMF may instruct the local PSA UPF with the EAS IP replacement information using \"Outer Header Creation\" as defined in 3GPP TS 29.244 [13] clause 8.2.56 and \"Outer Header Removal\" as defined in 3GPP TS 29.244 [13] clause 8.2.64. The PSA UPF shall be configured by the SMF to perform one creation and one removal of the appropriate outer header(s) both in the uplink and in the downlink direction in a way that the address information indicated by the \"source\" attribute (within \"easIpReplaceInfos\") is used in the headers of the packets towards the UE and the address information indicated by the \"target\" attribute (within \"easIpReplaceInfos\") is used in the headers of the packets towards the DN.\n-\tif the \"easRedisInd\" attribute set to true is included, the SMF may indicate the UE to refresh the cached EAS information as defined in clause 6.3.2 of 3GPP TS 24.501 [20].\n-\tif the \"tfcCorreInfo\" attribute is received, and,\n-\tif the \"COMMON_DNAI\" is included within the \"corrType\" attribute in the TrafficControlData data type referenced by a set of PCC rules, based on SMF implementation and local configuration, the SMF should select a common DNAI from the list of DNAI included in the \"routeToLocs\" attribute for the traffic of the PDU session which have the same traffic correlation Id within the \"tfcCorrId\" attribute as defined in clause 6.2.3.2.6 of TS 23.548 [62]. The SMF shall use the provided DNAI as the common DNAI when only one is included in the \"routeToLocs\" attribute; or\n-\tif the \"COMMON_EAS\" is included within the \"corrType\" attribute in the TrafficControlData data type referenced by a set of PCC rules, the SMF should use the value within the \"fqdnRange\" if received to match the FQDN received from the EASDF via the Neasdf_DNSContext_Notify request. If they are matched, the SMF may indicate the UE the common EAS address(s) received within the \"comEasIpv4Addr\" attribute and/or \"comEasIpv6Addr\" attribute.\nNOTE 7:\tIn order for the SMF to initiate the EASDF-based EAS discovery procedure, the SMF will use the FQDN information received within the \"fqdnRange\" attribute for setting traffic route and finding DNAI. The \"flowInfos\" attribute or the \"appId\" attribute will not be considered for that purpose.\n-\tif the \"notifUri\" attribute and \"notifCorrId\" attribute are included, the SMF shall notify the 5GC determined information for a set of UEs identified by Traffic Correlation ID.\nNOTE 8:\tCommon EAS selection means the common DNAI is selected.\nIf routing of traffic to a local access to a data network policy provided in the \"routeToLocs\" attribute is invalid, unknown or not applicable, or the enforcement of the steering of the traffic to the indicated DNAI failed, the SMF shall return a PCC Rule Error Report, as specified in clauses 4.2.3.16 and 4.2.4.15, and set the \"failureCode\" attribute to \"DNAI_STEERING_ERROR\".\nThe PCF may control at what time the status of a PCC rule changes. In order to provision a PCC rule with conditional data, the PCF shall provision a PCC rule as defined in clause 4.2.6.2.1and include within its \"refCondData\" attribute the value of the \"condId\" attribute of the targeted ConditionData instance. The PCF shall also ensure that this referenced ConditionData instance is included in the \"conds\" map attribute within the SmPolicyDecision data structure, following the procedures defined in clause 4.2.6.1.\nWithin the ConditionData instance, the PCF shall include the activation time within the \"activationTime\" attribute and/or the deactivation time within the \"deactivationTime\" attribute.\nWhen the SMF receives a conditioned PCC rule, the SMF shall act as follows:\n1)\tIf only the \"activationTime\" attribute is provided by the PCF and the time specified in it is in the future, then the SMF shall set the PCC rule to inactive state and only change it to active state at  the specified time. If this time specified in the \"activationTime\" attribute is in the past, then the SMF shall immediately set the PCC rule to active state.\n2)\tIf only the \"deactivationTime\" attribute is provided by the PCF and the time specified in it is in the future, then the SMF shall set the PCC rule to active state and only change it to inactive state at the specified time. If this time specified in the \"deactivationTime\" is in the past, then the SMF shall immediately set the PCC rule to inactive state.\n3)\tIf both the \"activationTime\" attribute and the \"deactivationTime\" attribute are provided by the PCF, and the value specified in the \"activationTime\" occurs before the value specified in the \"deactivationTime\" attribute, and also when the PCC rule is provided before or at the value specified in the \"deactivationTime\", the SMF shall handle the PCC rule first as defined in 1) and then as defined in 2).\n4)\tIf both the \"activationTime\" attribute and the \"deactivationTime\" attribute are provided by the PCF, and the value specified in the \"deactivationTime\" attribute occurs before the value specified in the \"activationTime\", and also when the PCC rule is provided before or at the value specified in the \"activationTime\" attribute, the SMF shall handle the PCC rule first as defined in 2) and then as defined in 1).\n5)\tIf both the \"activationTime\" attribute and the \"deactivationTime\" attribute are provided by the PCF and are both in the past, and the value specified in the \"activationTime\" occurs before the value specified in the \"deactivationTime\" attribute, then the SMF shall immediately set the PCC rule to inactive state.\n6)\tIf both the \"activationTime\" attribute and the \"deactivationTime\" attribute are provided by the PCF and are both in the past, and the value specified in the \"deactivationTime\" attribute occurs before the value specified in the \"activationTime\" attribute, then the SMF shall immediately set the PCC rule to active state.\n7)\tIf both \"activationTime\" attribute and \"deactivationTime\" attribute are specified with the same time, the SMF shall report a PCC rule error for the concerned PCC rule(s), as specified in clauses 4.2.3.16 and 4.2.4.15, and set the \"failureCode\" attribute to \"INCORRECT_COND_DATA\".\nThe PCF may modify a currently installed/activated PCC rule, including setting, modifying or deleting its deferred activation and/or deactivation time as follows:\n1)\tWhen modifying a PCC rule by newly setting the deferred activation time and/or deactivation time, the PCF shall update the PCC rule by including the corresponding ConditionData instance 's \"condId\" attribute value within the \"refCondData\" attribute and including within the SmPolicyDecision data structure this ConditionData instance within the \"conds\" map attribute, if not previously provisioned.\n2)\tWhen modifying a PCC rule by modifying the already provisioned deferred activation time and/or deactivation time:\n-\tthe PCF may update the PCC rule by replacing the existing ConditionData instance's \"condId\" attribute value within the \"refCondData\" attribute with a another one pointing to another ConditionData instance and including within the SmPolicyDecision data structure this new ConditionData instance within the \"conds\" attribute, if not previously provisioned; or\n-\tthe PCF may update the condition data decision to which the PCC rule refers by updating the corresponding ConditionData instance in the SmPolicyDecision data structure, as defined in clause 4.2.6.1. The PCF may add an activation time and/or a deactivation time, update the values of the existing activation time and/or deactivation time, or delete either the existing activation time or the existing deactivation time.\n3)\tWhen modifying a PCC rule by deleting the previously provisioned deferred activation time and/or deactivation time:\n-\tthe PCF shall delete the reference to the corresponding ConditionData instance within the PCC rule by updating the \"refCondData\" attribute of the PCC rule to \"NULL\" value; and\n-\tthe PCF may also delete this condition data decision to which the PCC rule refers as defined in clause 4.2.6.1 (i.e. delete the corresponding ConditionData instance within the SmPolicyDecision data structure), if no other PCC rule is referring to this condition data decision.\nTo delete a conditioned PCC rule, the PCF shall run the procedures as defined in clause 4.2.6.2.1.\nThe UE timezone information, if available, may be used by the PCF to construct the values of the \"activationTime\" attribute and/or the \"deactivationTime\" attribute.\nThe PCC rule(s) including a reference to a Condition Data decision which includes an \"activationTime\" attribute and/or a \"deactivationTime\" attribute shall be bound to a QoS flow associated with a default QoS rule that allows all UL packets. If such PCC rule(s) are not bound to a QoS flow associated with a default QoS rule, the SMF shall report a failure to the PCF by including the \"ruleReports\" attribute with the \"failureCode\" attribute set to the value \"NO_QOS_FLOW_BOUND\" for the affected PCC rule(s). Changes of the QoS profile or QoS rule which will initiate signalling towards the access network and/or UE in such PCC rule(s) shall also not be applied.\nNOTE:\tThis limitation prevents dependencies on the signalling of changed traffic mapping information towards the UE.\nIf the ResShare feature is supported by both the SMF and PCF as described in clause 5.8, the PCF may indicate that the SMF should commonly reserve resources for a set of PCC rules. The SMF shall then, for PCC rules bound to the same QoS flow and the same sharing key value , use the highest GBR value among those PCC rules as input for calculating the common GBR value when reserving QoS flow resources. The GBR value for each direction shall be considered separately, so that the uplink and downlink GBR values may originate from different PCC rules.\nThe SMF may, based on internal logic, use the highest MBR value among the provided PCC rules indicated to share resources, when determining the MBR for the QoS flow. Each individual PCC rule is still subject to data rate policing based on its own MBR values.\nThe PCF shall provide the \"sharingKeyDl\" attribute and/or \"sharingKeyUl\" attribute within the QosData data structure which the PCC rules refers to in order to indicate that the related PCC rule may share resources with other PCC rules bound to the same QoS flow.\nThe SMF shall apply resource sharing if at least two PCC rules bound to the same QoS flow share the same value in the \"sharingKeyDl\" attribute and/or \"sharingKeyUl\" attribute.\nWhen modifying the value of \"sharingKeyDl\" attribute and/or \"sharingKeyUl\" attribute of the QosData data structure, which a PCC rule refers to for the PCC rule that is subject to resource sharing the SMF may adjust the resource sharing of the remaining PCC rules.\nNOTE 1:\tA PCC rule that is deleted is also removed from the resource sharing, while the remaining PCC rules continue their sharing relationship.\nNOTE 2:\tThe state of resource sharing ends when less than two of the PCC rules in the set remains.\nWhen the PCF derives PCC Rules corresponding to a service related to an AF that has indicated that priority sharing is allowed for that service over Rx interface or within the Npcf_PolicyAuthorization service, it derives the corresponding PCC Rules according to current procedures as described in 3GPP TS 29.513 [7], clause 7.3. The PCF may additionally take the suggested pre-emption capability and vulnerability values into account if the AF provided them when the PCF determines the ARP pre-emption capability and vulnerability. The ARP derived at this point and the priority sharing indicator provided over Rx reference point (see 3GPP TS 29.214 [18] for further information) or over the Npcf_PolicyAuthorization service (see 3GPP TS 29.514 [17] for further information) related to these derived PCC Rules are stored for later use.\nFor PCC Rules related to the same PDU session with the same assigned 5QI and with the priority sharing indicator enabled (see 3GPP TS 29.214 [18], clause 4.4.8, or 3GPP TS 29.514 [17], clauses 4.2.2.21, 4.2.3.21 and 4.2.4.9), the PCF shall rederive the ARP into a shared ARP for these PCC Rules as follows:\n-\tThe Priority Level shall be set to the lowest value (i.e. highest priority) among the Priority Level values derived for the PCC rules that include the priority sharing indicator.\n-\tThe Pre-emption Capability shall be set to true if any of the original derived PCC Rules have the Pre-emption-Capability value set to true.\n-\tThe Pre-emption Vulnerability shall be set to true if all the original derived PCC Rules have the Pre-emption Vulnerability value set to true.\nNOTE 1:\tHaving the same setting for the ARP parameter in the PCC Rules with the priority sharing indicator set enables the usage of the same QoS flow. Furthermore, a combined modification of the ARP parameter in the PCC rules ensures that a QoS flow modification is triggered when a media flow with higher service priority starts.\nIf the 5QI and/or ARP related to any of the PCC Rules that share priority is changed (e.g. based on local policies), the PCF shall rederive the ARP for the impacted PCC Rules following the same procedure as defined in this clause.\nThe PCF shall provision the PCC Rules according to the rederived ARP information as described in clause 4.2.6.2.1.\nIf the PCF receives a report that a PCC rule provisioning or modification failed due to the resource reservation failure as defined in clauses 4.2.3.1.6 and 4.2.4.15 (PCC Rule Error Report) and if the PCF supports the MCPTT-Preemption feature as defined in clause 5.4.1 of 3GPP TS 29.214 [18] or in clause 5.8 of 3GPP TS 29.514 [17], the PCF shall check if pre-emption control based on the pre-emption control information provided by the AF as defined in clauses 4.4.1 or 4.4.2 of 3GPP TS 29.214 [18] or in clauses 4.2.2.21, 4.2.3.21 or 4.2.4.9 of 3GPP TS 29.514 [17] applies.\nNOTE 2:\tThe PCF determines that pre-emption control applies based on the presence of the Pre-emption-Control-Info AVP received over Rx reference point as defined in 3GPP TS 29.214 [18] or \"preemptControlInfo\" attribute received over N5 reference point as defined in 3GPP TS 29.514 [17] and operator policies.\nIf pre-emption control applies, the PCF shall check the corresponding derived PCC Rules (before applying priority sharing procedures). If the Pre-emption Capability of the derived PCC Rule is disabled the PCF shall notify that resource allocation has failed for this PCC rule to the AF as defined in clauses 4.4.1 or 4.4.2 of 3GPP TS 29.214 [18] or in clauses 4.2.2.21, 4.2.3.21 or 4.2.4.9 of 3GPP TS 29.514 [17]. Otherwise, if the Pre-emption Capability of the derived PCC Rule is enabled, the PCF shall perform the pre-emption control as follows:\n-\tFor all the active PCC rule(s) that applied priority sharing mechanism, the PCF shall identify the PCC Rules that have the Pre-emption Vulnerability enabled. For those selected PCC Rule(s), the PCF shall check the Priority Level value.\n-\tIf there is only one PCC Rule with the Priority Level value higher (i.e. lower priority) than the derived Priority Level value of new or modified PCC Rule, the PCF shall remove this PCC rule. The PCF shall retry the PCC rule provisioning or modification procedure for the PCC rule that failed.\n-\tOtherwise, if there are more than one PCC Rule with the Priority Level value higher (i.e. lower priority) than the derived Priority Level value of new or modified PCC Rule, the PCF shall remove the PCC Rule with the highest Priority Level from the SMF.  The PCF shall retry the PCC rule provisioning or modification procedure for the PCC rule that failed; If more than one PCC Rule have the same highest Priority Level, the PCF shall check the Pre-Emption-Control-Info AVP received over Rx interface as defined in 3GPP TS 29.214 [18], or the \"preemptControlInfo\" attribute received over N5 interface as defined in 3GPP TS 29.514 [17] and remove the PCC Rule that matches the condition.\n-\tOtherwise, if there is at least one PCC Rule with the same Priority Level value than the derived Priority Level value of new or modified PCC Rule, the PCF shall check the Pre-emption-Control-Info AVP received over Rx interface as defined in 3GPP TS 29.214 [18] or the \"preemptControlInfo\" attribute received over N5 interface as defined in 3GPP TS 29.514 [17] for these PCC Rules and remove the PCC Rule that matches the condition.\n-\tOtherwise, the PCF shall notify that resource allocation has failed for this PCC rule to the AF as defined in clauses 4.4.1 or 4.4.2 of 3GPP TS 29.214 [18] or in clauses 4.2.2.21 or 4.2.3.21 of 3GPP TS 29.514 [17].\nIf there is no active PCC Rule with the Pre-emption Vulnerability enabled, the PCF shall notify that resource allocation has failed for this PCC rule to the AF as defined in clauses 4.4.1 or 4.4.2 of 3GPP TS 29.214 [18].\nNOTE 3:\tIf the PCF receives a report that a PCC rule provisioning or modification failed due to the resource reservation failure and the PCF does not support the MCPTT-Preemption feature as defined in clause 5.4.1 of 3GPP TS 29.214 [18] or clause 5.8 of 3GPP TS 29.514 [17], the PCF can apply pre-emption and remove active PCC rules from the SMF and then retry the PCC rule provisioning or modification procedure. Otherwise, the PCF will notify it to the AF as defined in clauses 4.4.1 or 4.4.2 of 3GPP TS 29.214 [18] or in clauses 4.2.2.21 or 4.2.3.21 of 3GPP TS 29.514 [17]. How the PCF applies the pre-emption depends on the implementation.\nThe PCF may indicate to the SMF that a PCC rule shall be bound to the default QoS flow and remain on the default QoS flow. The SMF shall then, for the indicated PCC rule, bind it to the default QoS flow until this PCC rule is removed or until the PCF modifies this PCC rule to set the \"defQosFlowIndication\" attribute to false. For this second case, Tthe SMF case shall evaluate the full QoS information within the QosData data structure to which the PCC rule refers and follow normal policy enforcement procedures for authorized QoS per service data flow as described in clause 4.2.6.2.3.\nNOTE:\t5QI, ARP, QNC (if available), Priority Level (if available), Averaging Window (if available) and Maximum Data Burst Volume (if available) within the QoS Data decision referred by the PCC rule are only used by the SMF for QoS flow binding purposes when the \"defQosFlowIndication\" attribute is not included in the QoS Data decision or it is included and set to false.\nThe PCF shall provide the \"defQosFlowIndication\" attribute set to true in order to indicate that the related PCC rule shall be bound to the default QoS flow.\nIf the \"defQosFlowIndication\" attribute is provided and set to true within the QosData data structure to which the PCC rule refers, the SMF shall bind the related PCC rule to the default QoS flow. This binding remains valid until the related PCC rule is removed or if the PCF indicates to the SMF that the binding to the default QoS flow for this PCC rule no longer applies.\nThe SMF shall ignore the values of the other attributes, including 5QI, ARP, QNC (if available), Priority Level (if available), Averaging Window (if available) and Maximum Data Burst Volume (if available), provided within the QosData data structure if the \"defQosFlowIndication\" attribute is provided by the PCF and set to true. If the PCF has previously indicated to the SMF that a PCC rule shall be bound to the default QoS flow, and desires to indicate that this binding no longer applies the PCF shall update this PCC rule by including the \"defQosFlowIndication\" attribute set to false. The SMF shall in this case evaluate the full QoS information within the QosData data structure to which the PCC rule refers and follow normal policy enforcement procedures for authorized QoS per service data flow as described in clause 4.2.6.2.3.\nIf the PCF has not previously indicated to the SMF that a PCC rule shall be bound to the default QoS flow (i.e. it may be bound to another QoS flow), in order to indicate that the binding to the default QoS flow shall now apply for this PCC rule, the PCF shall update the PCC rule by including (or updating) the \"defQosFlowIndication\" attribute and set it to true. The SMF shall in this case follow the procedures described in this clause.\nIf the ADC feature is supported, the user subscription indicates that application detection and control is enabled, and the PCF determines that application detection is required because of e.g. an internal/external trigger or the PCF has received from an NF service consumer (e.g. another PCF or an AF) a subscription to the event for application start/stop traffic detection (see TS 29.514 [17], clause 4.2.6.9 subscription to application detection control and TS 29.523 [61], clause 4.2.2 for AF subscription to application detection control), the PCF may instruct the SMF to detect application(s) by installing or activating PCC rule(s).\nNOTE:\tWhen the NF service consumer is an AF, the PCF will identify all the affected PDU sessions based on the received information as specified in TS 29.523 [61] and generate the PCC Rules with instructions to detect application(s) for each affected PDU session.\nAn application to be detected is identified by an application identifier, which shall be provided within the \"appId\" attribute for dynamic PCC rules or pre-provisioned for predefined PCC rules. If the PCF requires to be notified when application start/stop is detected, it shall also provide the APP_STA and APP_STO policy control request triggers to the SMF as defined in clause 4.2.4.6. For dynamic PCC rules, the PCF may also mute such notifications for a specific detected application by including a \"traffContDecs\" attribute to contain a Traffic Control Data decision which contains the \"muteNotif\" attribute set to true and including a \"refTcData\" attribute referring to this Traffic Control Data decision within the concerned PCC rule.\nIf the application identifier provided in the \"appId\" attribute is invalid, unknown or not applicable, the SMF shall return a PCC Rule Error Report, as specified in clauses 4.2.3.16 and 4.2.4.15, and set the \"failureCode\" attribute to \"APP_ID_ERR\".\nThe SMF shall reject the update of the mute indication for a provisioned PCC rule as specified in clause 4.2.3.16 and 4.2.4.15, and set the \"failureCode\" attribute to \"MUTE_CHG_NOT_ALLOWED\".\nWhen the application detection control was initiated by an NF service consumer and it unsubscribes to receive these notifications, the PCF shall unsubscribe to the related policy control request triggers as described in clause 4.2.6.4 unless they are used for other purposes.\nIn this release of the specification Application Detection and Control applies only to the IP PDU session type.\nThe provision of PCC Rules corresponding to both MPS and non-MPS service shall be performed as described in clause 4.2.6.2.1 \"Provisioning of PCC rules\".\nWhen the PCF derives PCC Rules corresponding to MPS service, the ARP and 5QI shall be set as appropriate for the prioritized service, e.g. an IMS Multimedia Priority Service. The PCF may authorize a standardized 5QI or a standardized 5QI with a specific 5QI priority level as defined in clause 4.2.6.6.2. The PCF may also authorize a non-standardized 5QI with explicitly signalled QoS characteristics as defined in clause 4.2.6.6.3.\nWhen the PCF derives PCC Rules corresponding to non-MPS service, the PCF shall generate the PCC Rules as per normal procedures. At the time the Priority PDU connectivity services is invoked based on the subscription profile stored in the UDR (i.e. Indication for support of Priority PDU connectivity service and MPS Priority Level are set in the UDR) or by the AF (e.g., MPS for DTS is invoked as described in 3GPP TS 29.214 [18] and 3GPP TS 29.514 [17]), the PCF shall upgrade the ARP and/or change 5QI for the PCC Rules to appropriate values as needed for MPS. The PCF shall change the ARP and/or 5QI (also associated QoS characteristics if applicable) modified for the Priority PDU connectivity service to an appropriate value according to PCF decision.\nWhen the PCF receives an HTTP POST message as defined in clause 4.2.2.1, the PCF shall check whether any of these parameters is stored in the UDR: indication for support of Priority PDU connectivity service, MPS Priority Level and/or indication of IMS priority service support. The PCF shall derive the applicable PCC rules and default QoS flow QoS based on that information. If the indication of IMS priority service support is set and the \"dnn\" attribute corresponds to a DNN dedicated for IMS, the PCF shall assign an ARP corresponding to MPS for the default QoS flow and for the PCC Rules corresponding to the IMS signalling QoS flow. If the \"dnn\" does not correspond to a DNN dedicated for IMS, the ARP shall be derived without considering IMS Signalling Priority.\nNOTE 1:\tSubscription data for MPS is provided to PCF through the Nudr service.\nOnce the PCF receives a notification of a change in Priority PDU connectivity services support, MPS Priority Level and/or IMS priority service support from the UDR, the PCF shall make the corresponding policy decisions (i.e. ARP and/or 5QI (also associated QoS characteristics if applicable) change) and, if applicable, shall initiate an HTTP POST message as defined in clause 4.2.3.2 to provision the modified data.\nNOTE 2:\tThe details associated with the UDR service are specified in 3GPP TS 29.519 [15].\nNOTE 3:\tThe MPS Priority Level is one among other input data such as operator policy for the PCF to set the ARP.\nWhenever one or more AF sessions of an MPS service are active within the same PDU session, the PCF shall ensure that the ARP priority level of the default QoS flow is at least as high as the highest ARP priority level used by any authorized PCC rules belonging to an MPS service. If the ARP pre-emption capability is enabled for any of the authorized PCC rules belonging to an MPS service, the PCF shall also enable the ARP pre-emption capability for the default QoS Flow.\nNOTE 4:\tThis ensures that services using dedicated QoS flows are not terminated because of a default QoS flow with a lower ARP priority level or disabled ARP pre-emption capability being dropped during mobility events.\nNOTE 5:\tThis PCF capability does not cover interactions with services other than MPS services.\nWhen a Priority PDU connectivity services is invoked, the PCF shall:\n-\tDerive the corresponding PCC Rules with the ARP and 5QI (also associated QoS characteristics if applicable) set as appropriate for a prioritized service.\n-\tSet the ARP of the default QoS flow as appropriate for a Priority PDU connectivity services under consideration of the requirement described in clause 4.2.6.2.12.1.\n-\tSet the 5QI (also associated QoS characteristics if applicable) of the default QoS flow as appropriate for the Priority PDU connectivity services.\n-\tSet the ARP of PCC Rules installed before the activation of the Priority PDU connectivity services to the ARP as appropriate for the Priority PDU connectivity services under the consideration of the requirements described in clause 4.2.6.2.12.1.\n-\tSet the 5QI of the PCC Rules installed before the activation of the Priority PDU connectivity services to the 5QI (also associated QoS characteristics if applicable) as appropriate for the Priority PDU connectivity services if modification of the 5QI of the PCC Rules is required.\nWhen a Priority PDU connectivity services is revoked, the PCF shall:\n-\tDelete the PCC Rules corresponding to the Priority PDU connectivity services if they were previously provided.\n-\tSet the ARP of the default QoS flow to the normal ARP under the consideration of the requirements described in clause 4.2.6.2.12.1.\n-\tSet the 5QI of the default QoS flow as appropriate for PCF decision.\n-\tSet the ARP of all active PCC Rules as appropriate for the PCF under the consideration of the requirements described in clause 4.2.6.2.12.1.\n-\tSet the 5QI to an appropriate value according to PCF decision if modification of the 5QI of PCC Rules is required.\nNOTE:\tPriority PDU connectivity services can be explicitly invoked/revoked via UDR MPS user profile (Indication of Priority PDU connectivity services, MPS Priority Level). An AF for MPS Priority Service can also be used to provide Priority PDU connectivity services using network-initiated resource allocation procedures (via interaction with PCC) for originating accesses.\nThe PCF shall provision the SMF with the applicable PCC Rules upon Priority PDU connectivity services activation and deactivation as described above. The provision of the QoS information applicable for the PCC Rules shall be performed as described in clause 4.5.6.2. The provision of QoS information for the default QoS flow shall be performed as described in clause 4.2.6.3.\nIf the PCF receives service information including an MPS session indication and the service priority level from the P-CSCF or at reception of the indication that IMS priority service is active for the PDU session, the PCF shall under consideration of the requirements described in clause 4.2.6.2.12.1:\n-\tif required, set the ARP and 5QI (also associated QoS characteristics if applicable) of the default QoS flow as appropriate for the prioritized service;\n-\tif required, set the ARP and 5QI (also associated QoS characteristics if applicable) of all PCC rules assigned to the IMS signalling QoS flow as appropriate for IMS Multimedia Priority Services;\n-\tderive the PCC Rules corresponding to the IMS Multimedia Priority Service and set the ARP and 5QI (also associated QoS characteristics if applicable) of these PCC Rules based on the information received over N5/Rx.\nIf the PCF detects that the P-CSCF released all the MPS session and the IMS priority service has been deactivated for the PDU session the PCF shall under consideration of the requirements described in clause 4.2.6.2.12.1:\n-\tdelete the PCC Rules corresponding to the IMS Multimedia Priority Service;\n-\tif required, set the ARP and 5QI of the default QoS flow as appropriate for the IMS Multimedia Priority set to inactive;\n-\treplace the ARP and 5QI of all PCC Rules assigned to the IMS signalling QoS flow as appropriate when the IMS Multimedia Priority is inactive.\nWhen the PCF receives from the AF an indication of invocation/revocation of MPS for DTS as specified in 3GPP TS 29.514 [17] or 3GPP TS 29.214[10], and if the \"MPSforDTS\" feature is supported, the PCF shall make the corresponding policy decisions (i.e. ARP and/or 5QI change for the default QoS) and, if applicable, shall initiate an Npcf_SMPolicyControl_UpdateNotify to provision the modified data.\nFor the invocation of MPS for DTS, the PCF shall:\n-\tSet the ARP of the default QoS flow as appropriate for MPS for DTS.\n-\tSet the 5QI (also associated QoS characteristics if applicable) of the default QoS flow as appropriate for MPS for DTS.\nNOTE 1:\tFor PCC Rules that had the same ARP and 5QI as the original default QoS flow: the PCF indicates to the SMF that the PCC rule is to be bound to the default QoS flow by setting the \"defQosFlowIndication\" attribute within the QosData data structure to true; or sets the ARP as appropriate for MPS for DTS and the 5QI (also associated QoS characteristics if applicable) as appropriate for MPS for DTS.\nFor the revocation of MPS for DTS, to revert the MPS for DTS values of the default QoS flow and the PCC rules bound to the default QoS flow, the PCF shall set the ARP and the 5QI of the default QoS flow as appropriate for PCF decision.\nNOTE 2:\tFor PCC Rules that had the same ARP and 5QI as the default QoS flow, or had the \"defQosFlowIndication\" attribute set to true: the PCF sets the ARP; and the 5QI (also associated QoS characteristics if applicable) as appropriate for PCF decision. The provision of the QoS information applicable for the PCC Rules is performed as described in clause 4.2.6.6.\nNOTE 3:\tRevocation may require more complex logic on the part of the PCF beyond simply restoring the prior ARP and 5QI values as set prior to invocation of MPS for DTS, if these values and/or the defQosFlowIndication were modified by another service during the time that MPS for DTS was enabled.  The corresponding logic is dependent on the identification of particular services that may be deployed and the desired interactions between MPS for DTS and any such services. These aspects are not considered in the present specification.\nThe PCF shall provision the SMF upon MPS for DTS invocation and revocation as described above for the default QoS flow as described in clause 4.2.3.6.\nOn receipt from an AF of a request to report the successful outcome of the MPS for DTS invocation/revocation of priority handling for the default QoS flow (see 3GPP TS 29.214 [18] and 3GPP TS 29.514 [17]), the PCF shall request the SMF to confirm that the resources associated to the MPS for DTS invocation/revocation are successfully allocated. The PCF does this by setting the \"policyCtrlReqTriggers\" attribute in the \"SmPolicyDecision\" data structure to the value \"SUCC_QOS_UPDATE\". On receipt of the \"repPolicyCtrlReqTriggers\" attribute in the SmPolicyUpdateContextData data structure set to the value \"SUCC_QOS_UPDATE\" from the SMF, the PCF shall inform the AF that it successfully acted upon the \"mpsAction\" attribute as defined in 3GPP TS 29.514 [17] or the MPS-Action AVP as defined in 3GPP TS 29.214 [18].\nThe SMF shall report MPS for DTS invocation/revocation failure to the PCF according to clause 4.2.4.21 if requested to do so by the AF as described in 3GPP TS 29.214 [18], clause 4.4.11 or as described in 3GPP TS 29.514 [17], clause 4.2.2.12.2.\nSponsored data connectivity may be performed for service data flows associated with one or more PCC rules if the information about the sponsor, the application service provider and optionally the threshold values are provided by the AF and if the AF has not indicated to disable/not enable sponsored data connectivity as described in 3GPP TS 29.214 [18] clauses 4.4.1 and 4.4.2 or 3GPP TS 29.514 [17] clauses 4.2.2.5 and 4.2.3.5.\nThe provisioning of sponsored data connectivity per PCC rule shall be performed using the PCC rule provisioning procedure as defined in clause 4.2.6.2.1. The sponsor identity shall be set using the \"sponsorId\" attribute within the ChargingData data type which the PCC rule refers to. The application service provider identity shall be set using the \"appSvcProvId\" attribute within the ChargingData data type which the PCC rule refers to. The \"sponsorId\" attribute and \"appSvcProvId\" shall be set if the \"reportingLevel\" attribute within the ChargingData data type which the PCC rule refers to is set to the value \"SPON_CON_LEVEL\".\nWhen receiving the usage thresholds from the AF, the PCF shall use the sponsor identity to generate a value of \"umId\" attribute of the UsageMonitoringData data type which the PCC rule refers to and request usage monitoring control for the sponsored data connectivity by following the procedures specified in clauses 4.2.6.2.5.\nWhen the AF disables sponsoring a service (See 3GPP TS 29.214 [18] clause 4.4.2 or 3GPP TS 29.514 [17] clause 4.2.3.5), the PCF\n-\tmay modify the PCC rules in order to set the \"reportingLevel\" attribute to \"SER_ID_LEVEL\" or \"RAT_GR_LEVEL\" within the ChargingData data type which the PCC rule refers to and not include the \"sponsorId\" attribute and \"appSvcProvId\" attribute if they were included previously.\n-\tmay modify the PCC rules to update the charging key by setting the new value of the \"ratingGroup\" attribute within the ChargingData data type which the PCC rule refers to.\nNOTE:\tA specific charging key can be applied to the sponsored data connectivity for online charging.\n-\tshall disable the usage monitoring for the sponsored data connectivity according to clause 4.2.6.2.5 if it was enabled previously. As a result, PCF gets the accumulated usage of the sponsored data connectivity.\nThe support of PCC rule versioning is optional. When the \"RuleVersioning\" feature is supported, the SMF and the PCF shall comply with the procedures specified in this clause.\nIf required by operator policies, the PCF shall assign a content version for each generated PCC rule and shall include the assigned version in the \"contVer\" attribute included within the PccRule data structure. Upon each PCC rule modification, if the content version was previously assigned to a PCC rule, the PCF shall assign a new content version. In this case, all the content related to that PCC rule shall be included. If the PCF needs to modify the attribute(s) within the PCC rule, the PCF shall include the new content version within the \"contVer\" attribute together with all modified and unmodified applicable attribute(s) within the PccRule data structure. If the PCF only needs to modify the content of referenced policy decision data and/or condition data for one or more PCC rules, the PCF shall additionally provide the PCC rule(s) which is referring to the modified policy decision data and/or condition data. Within each PCC rule instance, the PCF shall include all unmodified applicable attribute(s) and the new assigned version in the \"contVer\" attribute. The content version is unique for the lifetime of the PCC rule.\nNOTE 1:\tThe PCF will include all the content of the PCC rule in each modification of the PCC rule in order to ensure that the rule is installed with the proper information regardless of the outcome of the QoS flow procedure related to previous rule provisioning versions that are not reported yet.\nNOTE 2:\tThe operation policies can take into account whether the AF provides the related content version information over Rx reference point (see clause 4.4.9 in 3GPP TS 29.214 [18]), or over Npcf_PolicyAuthorization service (see clauses 4.2.2.13 and 4.2.3.13 in 3GPP TS 29.514 [17]).\nWhenever the SMF provides a PCC rule report for rules that were provisioned with a content version, the SMF shall include the \"contVers\" attribute defined in the RuleReport data structure for those corresponding PCC rules. In case it is required to report the content version of multiple PCC rules, the SMF shall use one instance of RuleReport data structure per PCC rule, and shall include in the \"pccRuleIds\" attribute only the identifier of the corresponding PCC rule. The SMF may include more than one content version in the \"contVers\" attribute for the same PCC rule within the corresponding RuleReport instance included in the \"ruleReports\" attribute (e.g. the SMF has combined multiple PCC rule versions enforcement into one QoS flow operation). In this case, the \"ruleStatus\" attribute shall indicate the final status of the PCC rule.\nNOTE 3:\tThe PCF will use the content version to identify the PCC rule version that failed or succeeded when multiple provisions of the same PCC rule occur in a short period of time. If required by the AF, the PCF will inform the AF according to 3GPP TS 29.214 [18], clause 4.4.9, or according to 3GPP TS 29.514 [17], clause 4.2.5.8 about the failure or success for the media component version associated to the PCC rule version.\nIf the PCF receives Reference Id within the service information from the AF as defined in 3GPP TS 29.514 [17] or 3GPP TS 29.214 [18] or if \"EnhancedBackgroundDataTransfer\" feature as defined in clause 5.8 is supported and the PCF receives the Reference Id(s) within the PDU session related subscription information from the UDR as defined in 3GPP TS 29.519 [15], the PCF shall retrieve the corresponding transfer policy from the UDR based on the Reference Id(s) as defined in 3GPP TS 29.519 [15]. The PCF shall use the retrieved transfer policy as input for policy decisions (e.g. setting the charging key equal to the charging key of the transfer policy, rule activation/deactivation time according to the time window).\nDuring PDU session establishment, if \"EnhancedBackgroundDataTransfer\" feature as defined in clause 5.8 is supported and if validation conditions (i.e. Time Window and/or Location Criteria) of the transfer policy are not satisfied then the PCF may reject corresponding SM Policy Association as defined in clause 4.2.2.2 and include in an HTTP \"403 Forbidden\" response message the \"cause\" attribute of the ProblemDetails data structure set to \"VALIDATION_CONDITION_NOT_MET\". And based on this feedback, the SMF shall reject the PDU session setup.\nAfter successful PDU session establishment, if \"EnhancedBackgroundDataTransfer\" feature as defined in clause 5.8 is supported, PCF may request the PDU session termination if the validation conditions become not satisfied as defined in clause 4.2.3.3. Within the TerminationNotification, the PCF shall include the \"cause\" attribute set to \"VALIDATION_CONDITION_NOT_MET\".\nIf \"BDTPolicyRenegotiation\" feature as defined in clause 5.8 is supported and if the PCF retrieves the BDT policy and corresponding related information (e.g. network area information, the volume of data to be transferred per UE, etc.) within the BdtData data type, and with the \"bdtpStatus\" attribute within the BdtData data type set to value \"INVALID\", the PCF may reject the SM Policy Association establishment or defer to make the policy decisions until the PCF is informed of the result of BDT policy re-negotiation finally. If the PCF determines to reject the SM Policy Association establishment based on the invalid BDT policy, the PCF shall include in an HTTP \"403 Forbidden\" response message the \"cause\" attribute of the ProblemDetails data structure set to \"INVALID_BDT_POLICY\". If the PCF defers to make the policy decisions, then based on the result of the BDT policy renegotiation, the PCF may make the policy decisions or terminate the SM Policy Association as defined in this clause.\nIf the PCF includes the flow information within the \"flowInfos\" attribute and if the number of supported packet filter for signalled QoS rules within the \"numOfPackFilter\" attribute is received from the SMF during the PDU session establishment, the PCF shall ensure that for all the dynamic PCC rules of a PDU session, the number of packet filters contained within the \"flowDescription\" attribute or the \"ethFlowDescripiont\" attribute with the \"packetFilterUsage\" set to true does not exceed the value of the \"numOfPackFilter\" attribute.\nNOTE:\tThe maximum number of packet filters sent to the UE per QoS rule is additionally limited by the access type. When the UE is camping in 5GS the number of packet filters is limited as specified in 3GPP TS 24.501[20].\nIf the PCF determines that there is a possibility to run into a restriction regarding the number of TFT packet filters that can be allocated for the PDU Session, interworking with N26 deployment is supported and \"PackFiltAllocPrecedence\" feature is supported, the PCF may behave as described in Annex B.3.2.0, B.3.3.0 and B.3.4.0.\nIf both the SMF and the PCF support the \"ATSSS\" feature as defined in clause 5.8, the PCF may enable the control of traffic steering, switching and splitting for a detected service data flow by including MA PDU Session control information within the PCC rule. In order to do so, within the PccRule data structure the PCF:\n-\tmay include one reference to the ChargingData data structure within the \"refChgN3gData\" attribute if the PCF determines that the specific charging parameters used for packets carried via Non-3GPP access. In this case, a \"chgDecs\" attribute containing the corresponding Charging Data policy decisions shall be included in the SmPolicyDecision data structure if it has not been provided;\n-\tmay include one reference to the UsageMonitoringData data structure within the \"refUmN3gData\" attribute if the PCF determines that the specific usage monitoring parameters used for packets carried via Non-3GPP access. In this case, a \"umDecs\" attribute containing the corresponding Usage Monitoring Data policy decisions shall be included in the SmPolicyDecision data structure if it has not been provided;\n-\tmay include the ATSSS rule application descriptor within \"appDescriptor\" attribute if the SDF template included in the PCC rule contains an Application Identifier in the \"appId\" attribute (see clause 4.2.6.2.1). The PCF may retrieve the OS Id(s) from the \"UEPolicySet\" resource in the UDR as described in 3GPP TS 29.519 [15] to determine, by internal configuration, the OS Application Identifier supported by the OS Id that corresponds to the application identifier included in the SDF template. If no OS Id is available in the UDR, the PCF may use the PEI to determine the OS Id supported by the UE;\nNOTE 1:\tIf the PCF does not take into account the received PEI and/or the retrieved OSid(s) to derive the application descriptor, then the PCF can include in the PCC rule multiple application descriptors associated to multiple operating systems.\nNOTE 2:\tIf only one UE OSid is stored in the UDR and the PCF takes it into account to derive the application descriptor, then the PCF can omit the OS Id in the application descriptor included in the PCC rule.\n-\tmay include the ATSSS policies within the Traffic Control Data decision which the PCC rule refers to. Within the TrafficControlData data structure, based on the ATSSS capability supported for the MA PDU Session, the PCF shall include:\n-\tthe applicable access traffic steering method, \"ATSSS_LL\",  \"MPTCP\" or, if the EnATSSS_v2 feature is supported, \"MPQUIC\", for the UL and DL traffic, encoded in the \"steerFun\" attribute; and\nNOTE:\tWhen the feature EnATSSS_v2 is supported, the ATSSS-LL functionality is not supported together with the \"REDUNDANT\" steering mode. When the UE indicates it supports the ATSSS-LL functionality with any steering mode, it is implied that the UE supports the ATSSS-LL functionality with any steering mode except the \"REDUNDANT\" steering mode.\n-\t the steering rule for access traffic distribution across the 3GPP and Non-3GPP accesses encoded in a \"SteeringMode\" data structure within the \"steerModeDl\" attribute for the DL traffic and within the \"steerModeUl\" attribute for the UL traffic.\nThe \"SteeringMode\" data structure shall include:\n-\tthe steering mode value determined by the PCF within the \"steerModeValue\" attribute as follows:\na.\t\"ACTIVE_STANDBY\" indicates the traffic of a SDF is steered on one access (the Active access), when this access is available, and switched to the other access (the Standby access), when Active access becomes unavailable. When the Active access becomes available again, the SDF is switched back to this access. If the Standby access is not defined, then the SDF is only allowed on the Active access and cannot be transferred on another access.\nb.\t\"LOAD_BALANCING\" indicates that the traffic of an SDF is split percentually between the 3GPP and Non-3GPP accesses.\nc.\t\"SMALLEST_DELAY\" indicates that the traffic of an SDF is steered and/or switched to the access that has the smallest delay (e.g. smallest RTT).\nd.\t\"PRIORITY_BASED\" indicates that the traffic of an SDF is steered to the high priority access until the access is determined to be congested. In this case, the traffic of the SDF is also sent to the low priority access, i.e. the SDF traffic is split over the two accesses. When the high priority access becomes unavailable, all SDF traffic is switched to the low priority access. How UE and UPF determine when a congestion occurs on an access is implementation dependent.\ne.\tIf both the SMF and the PCF support the \"EnATSSS_v2\" feature, \"REDUNDANT\" indicates that the traffic of an SDF may be duplicated on the 3GPP and Non-3GPP accesses.\n-\tWhen the access traffic steering mode in the \"steerModeValue\" attribute is \"ACTIVE_STANDBY\", the active access encoded within the \"active\" attribute, and the standby access, if defined, in the \"standby\" attribute; or\n-\tWhen the access traffic steering mode in the \"steerModeValue\" attribute is \"LOAD_BALANCING\", the traffic load distributed across 3GPP and Non-3GPP accesses encoded within the \"3gLoad\" attribute as the 3GPP access traffic weight percentage. The sum of the Non-3GPP access traffic weight percentage and the 3GPP access traffic weight percentage must be 100; or\n-\tWhen the access traffic steering mode in the \"steerModeValue\" attribute is \"PRIORITY_BASED\", the high priority access type encoded within the \"prioAcc\" attribute.\nIf the EnATSSS_v2 feature is supported, when the access traffic steerning mode in the \"steerModeValue\" attribute is \"REDUNDANT\", the \"SteeringMode\" data structure may include the primary access encoded within the \"primary\" attribute.\nIf the EnATSSS feature is supported, the PCF may provide either the steering mode indicator or the authorized threshold values for RTT and/or Packet Loss Rate within the \"SteeringMode\" data structure as follows:\na.\twhen the access traffic steering mode within the \"steerModeValue\" attribute is \"LOAD_BALANCING\" with fixed split percentages or \"PRIORITY_BASED\" or, when the EnATSSS_v2 feature is supported, \"REDUNDANT\", the PCF may provide, within the \"thresValue\" attribute, the authorized threshold value of RTT encoded in the \"rttThres\" attribute and/or the authorized threshold value of Packet Loss Rate encoded in the \"plrThres\" attribute.\n-\tFor \"LOAD_BALANCING\" steering mode with fixed split percentages (i.e., without the \"AUTO_LOAD_BALANCE\" or \"UE_ASSISTANCE\" steering mode indicator), the traffic load distributed across accesses indicated in\"3gLoad\" attribute shall only apply when the measurement of RTT and/or Packet Loss Rate on both accesses do not exceed the values for RTT and/or Packet Loss Rate provided respectively in the \"rttThres\" and/or \"plrThres\" attributes. When at least one measured parameter on one access exceeds the provided threshold value, the UE and UPF may stop sending traffic on this access, or may continue sending traffic on this access, but should reduce the traffic on this access and shall send the amount of reduced traffic on the other access. How UE and UPF adjust the traffic load distributed across accesses is implementation dependent.\n-\tFor \"PRIORITY_BASED\" steering mode, when the measurement of RTT and/or Packet Loss Rate on the high priority access type exceeds the values for RTT and/or Packet Loss Rate provided respectively in the \"rttThres\" and/or \"plrThres\" attributes, this access may be considered as congested by the UE and the UPF. In this case, the traffic of the SDF is also sent to the low priority access.\n-\tFor \"REDUNDANT\" steering mode, and when the feature EnATSSS_v2 is supported:\ni.\tWhen a threshold value is not provided (i.e., when RTT and Packet Loss Rate are not provided), the traffic of an SDF is duplicated on both accesses if both accesses are available. If a primary access is provided, the UE and the UPF send all data packets of the SDF on the primary access and may duplicate data packets of the SDF on the other access. If a primary access is not provided to the UE and UPF, the UE and UPF send all data packets of the SDF on both accesses.\nii.\tWhen a threshold value is provided, the duplication of the traffic of the SDF, by the UE and UPF, on both accesses shall only apply when the measurement of RTT or Packet Loss Rate on both accesses exceeds the values for RTT or Packet Loss Rate provided respectively in the \"rttThres\" or \"plrThres\" attributes. When the measured parameter (i.e., either RTT or Packet Loss Rate) exceeds the provided threshold value on one access only, the UE and UPF shall send the traffic of the SDF only over the other access. When the measured parameter (i.e., either RTT or Packet Loss Rate) does not exceed the provided threshold value on any access, the UE and UPF shall send the traffic of the SDF only over the primary access. If the primary access is not provided to the UE and UPF, UE and UPF select a primary access based on their own implementation (e.g., using the lowest RTT access or the lowest Packet Loss Rate acces). If measurement results on an access are not available for a parameter, it is considered that the measured parameter for this access has not exceeded the provided threshold value. When a threshold value is provided, the \"REDUNDANT\" steering mode is only used for Non-GBR SDF.\nb.\twhen the access traffic steering mode in the \"steerModeValue\" attribute is \"LOAD_BALANCING\", the PCF may provide within the \"steerModeInd\" attribute:\n-\t\"AUTO_LOAD_BALANCE\", when the UE and UPF are allowed to autonomously determine the traffic load of an SDF distributed across accesses; or\n-\t\"UE_ASSISTANCE\", when the UE is allowed to decide how to distribute the UL traffic of an SDF and the UE may inform the UPF how it decided to distribute the UL traffic. In the normal cases, although with this indicator provided, the UE shall apply the Steering Mode provided by the network.\nWhen the \"steerModeInd\" attribute is provided, the traffic load distributed across accesses indicated in \"3gLoad\" attribute may be ignored by the UE and UPF.\nIf the value of \"atsssCapab\" attribute received from the SMF is \"MPTCP_ATSSS_LL_WITH_EXSDMODE_DL_ASMODE_UL\", \"MPQUIC_ATSSS_LL_WITH_EXSDMODE_DL_ASMODE_UL\" or \"MPTCP_MPQUIC_ATSSS_LL_WITH_EXSDMODE_DL_ASMODE_UL\", the PCF shall provide a PCC Rule for non-MPTCP/non-MPQUIC traffic. To enable non-MPTCP traffic/non-MPQUIC, the PCF shall include a \"match all\" packet filter within the \"flowInfos\" attribute, the highest value within the \"precedence\" attribute of the PCC rule, and within the TrafficControlData data structure referred by the PCC rule, set the \"steerFun\" attribute to the \"ATSSS_LL\", the \"steerModeValue\"attribute of the \"steerModeUl\" attribute to \"ACTIVE_STANDBY\", and the \"steerModeValue\"attribute of the \"steerModeDl\" attribute to any supported steering mode except the \"SMALLEST_DELAY\" and, when the EnATSSS_v2 feature is supported, \"REDUNDANT\" steering mode. How PCF assigns precedence value in packet filters for MPTCP and MPQUIC traffic, when both are supported, is implementation dependant.\nIf the value of \"atsssCapab\" received from the SMF is \"MPTCP_ATSSS_LL_WITH_ASMODE_UL\", \"MPQUIC_ATSSS_LL_WITH_ASMODE_UL\" or \"MPTCP_MPQUIC_ATSSS_LL_WITH_ASMODE_UL\", the PCF shall provide a PCC rule for non-MPTCP/non-MPQUIC traffic. To enable non-MPTCP/non-MPQUIC traffic, the PCF shall include a \"match all\" packet filter within the \"flowInfos\" attribute, the highest value within the \"precedence\" attribute of the PCC rule, and within the TrafficControlData data structure referred by the PCC rule, set the \"steerFun\" attribute to the \"ATSSS_LL\", the \"steerModeValue\"attribute of the \"steerModeUl\" attribute to \"ACTIVE_STANDBY\", and the \"steerModeValue\"attribute of the \"steerModeDl\" attribute to any supported steering mode except, when the feature EnATSSS_v2 is supported, the \"REDUNDANT\" steering mode. How PCF assigns precedence value in packet filters for MPTCP and MPQUIC traffic, when both are supported, is implementation dependant.\nIf the value of \"atsssCapab\" received from the SMF is \"MPTCP_ATSSS_LL_WITH_ASMODE_DLUL\", \"MPQUIC_ATSSS_LL_WITH_ASMODE_DLUL\" or \"MPTCP_MPQUIC_ATSSS_LL_WITH_ASMODE_DLUL\", the PCF shall provide a PCC rule for non-MPTCP/non-MPQUIC traffic. To enable non-MPTCP/non-MPQUIC traffic, the PCF shall include a \"match all\" packet filter within the \"flowInfos\" attribute, the highest value within the \"precedence\" attribute of the PCC rule, and within the TrafficControlData data structure referred by the PCC rule, set the \"steerFun\" attribute to the \"ATSSS_LL\", the \"steerModeValue\"attribute of the \"steerModeUl\" attribute and the \"steerModeDl\" attribute to \"ACTIVE_STANDBY. How PCF assigns precedence value in packet filters for MPTCP and MPQUIC traffic, when both are supported, is implementation dependant.\nIf the value of \"atsssCapab\" received from the SMF is \"MPTCP_ATSSS_LL\", \"MPQUIC_ATSSS_LL\" or \"MPTCP_MPQUIC_ATSSS_LL\", the PCF shall provide a PCC rule for non-MPTCP/non-MPQUIC traffic. To enable non-MPTCP/non-MPQUIC traffic, the PCF may include a \"match all\" packet filter within the \"flowInfos\" attribute, the highest value within the \"precedence\" attribute of the PCC rule, and within the TrafficControlData data structure referred by the PCC rule, set the \"steerFun\" attribute to the \"ATSSS_LL\", the \"steerModeValue\"attribute of the \"steerModeUl\" attribute and the \"steerModeDl\" attribute to any supported steering mode except, when the feature EnATSSS_v2 is supported, the \"REDUNDANT\" steering mode. How PCF assigns precedence value in packet filters for MPTCP and MPQUIC traffic, when both are supported, is implementation dependant.\nUpon receipt of the PCC rule with the MA PDU Session control information, the SMF shall:\n-\tderive the ATSSS rules to deliver to the UE for UL traffic steering as defined in 3GPP TS 29.502 [22]. When the EnATSSS feature is supported and the SMF received for UL traffic steering either the steering mode indicator within the \"steerModeInd\" attribute or the threshold value(s) within the \"thresValue\" attribute, the SMF includes the received steering mode indication or the received threshold value(s) in the derived ATSSS Rule sent to the UE as defined in 3GPP TS 29.502 [22]. When the EnATSSS_v2 feature is supported and the SMF received the primary access within the \"primary\" attribute, the SMF includes the received primary access in the derived ATSSS Rule sent to the UE as defined in 3GPP TS 29.502 [22];\nNOTE 3:\tThe Traffic Descriptor in the ATSSS rule is genereated by the SMF from the SDF template of the PCC rule. If the PccRule data structure contains the \"flowInfos\" attribute, the SMF uses the UL SDF filters for the generation of the IP descriptors or Non-IP descriptors. If the PccRule data structure contains the \"appId\" attribute, the SMF includes the application descriptors received from the PCF in the \"appDescriptor\" attribute of the PCC rule.\n-\tderive the QoS profile and provide it to the access network(s) as follows:\n-\tfor a Non-GBR QoS flow,\na)\tthe SMF shall provide the QoS profile to both access networks if the UE is registered over both accesses during MA PDU Session Establishment procedure;\nb)\tthe SMF shall provide the QoS profile to the access networks over which the user plane resources are activated during MA PDU Session Modification procedure.\n-\tfor a GBR QoS flow,\na)\tif the Multi Access policies of the PCC rule indicate the GBR SDF is handled only in one access (i.e. , the SMF shall provide the QoS profile to the access network indicated by the PCC rule;\nb)\tif the Multi Access policies of the PCC rule indicate the GBR SDF is handled in both accesses, the SMF shall decide to which access network to provide the QoS profile for the GBR SDF based on its local policy (e.g. the local policy is configured the access where the traffic is ongoing according to the Multi Access policies of the PCC rule).\nc)\tfor a GBR QoS flow, traffic splitting is not supported because the QoS profile is provided to a single access network at a given time, and the traffic can be steered or switched as indicated by the \"ACTIVE_STANDBY\" steering mode. If the SMF receives the report that the current active access is not available from the UPF, the SMF shall perform as follows:\n-\tif the corresponding PCC rule allows the GBR QoS flow only on this access or if the corresponding PCC rule allows the GBR QoS flow on both accesses but the other access is not available, the SMF shall release the resources for the GBR QoS flow and report to the PCF about the removal of the PCC rule as defined in clause 4.2.4.15.\n-\tif the corresponding PCC rule allows the GBR QoS flow on both accesses and the other access is available, the SMF shall try to move the GBR QoS flow to the other access. The SMF may trigger a PDU session modification procedure to provide the QoS profile to the other access and release the resources for the GBR QoS flow in the current access.\n-\tif the QoS notification control is not enabled for the corresponding PCC rule and the other access does not accept the QoS profile, the SMF shall release the resources for the GBR QoS flow and report to the PCF about the removal of the PCC rule as defined in clause 4.2.4.15.\n-\tif the QoS notification control is enabled for the corresponding PCC rule, the SMF shall notify the PCF within the \"qncReports\" attribute that the QoS targets of the SDFs are not guaranteed. After the other access accepts the QoS profile, the SMF shall notify the PCF within the \"qncReports\" attribute that the QoS targets of the SDFs are guaranteed again. If the other access does not accept the QoS profile, the SMF shall delete the GBR QoS flow and report to the PCF about the removal of the PCC rule as defined in clause 4.2.4.15.\n-\tinstruct the UPF for DL access traffic steering as defined in 3GPP TS 29.244 [13]. When the EnATSSS feature is supported and the SMF received for DL traffic steering either the steering mode indicator within the \"steerModeInd\" attribute or the threshold value(s) within the \"thresValue\" attribute, the SMF includes the received steering mode indication or the received threshold value(s) in the derived the multi-access rule sent to the UPF as defined in 3GPP TS 29.244 [13]. When the EnATSSS_v2 feature is supported and the SMF received the primary access within the \"primary\" attribute, the SMF includes the received primary access in the derived multi-access rule sent to the UPF as defined in 3GPP TS 29.244 [13];\n-\tapply charging information depending on the used access type if indicated in the PCC rule; and\n-\tapply usage monitoring control depending on the used access type if indicated in the PCC rule.\nThe PCF may update the steering rule for access traffic distribution across the 3GPP and Non-3GPP accesses for a PCC rule. In order to do so, the PCF may:\n-\twithin the corresponding PccRule data structure, include a new reference of a Traffic Control Data decision and provide the Traffic Control Data decision if not provided yet.\n-\tupdate the Traffic Control Data decision by including the appropriate attribute value(s) within the \"steerFun\" attribute, \"steerModeDl\" attribute and/or \"steerModeUl\" attribute.\nThe provision of PCC Rules corresponding to both MCS and non-MCS service shall be performed as described in clause 4.2.6.2.1 \"Provisioning of PCC rules\".\nWhen the PCF derives PCC Rules corresponding to MCS service, the ARP and 5QI shall be set as appropriate for the prioritized service, e.g. an IMS Mission Critical Service. The PCF may authorize a standardized 5QI or a standardized 5QI with a specific 5QI priority level as defined in clause 4.2.6.6.2. The PCF may also authorize a non-standardized 5QI with explicitly signalled QoS characteristics as defined in clause 4.2.6.6.3.\nAt the time the Priority PDU connectivity services is invoked (i.e. Indication for support of priority PDU connectivity service and MCS Priority Level are set), the PCF shall upgrade the ARP and/or change 5QI for the PCC Rules to appropriate values as needed for MCS. The PCF shall change the ARP and/or 5QI (also associated QoS characteristics if applicable) modified for the priority PDU connectivity service to an appropriate value according to PCF decision.\nWhen the PCF receives an HTTP POST message as defined in clause 4.2.2.1, the PCF shall check whether any of these parameters is stored in the UDR: indication for support of priority PDU connectivity service, indication for support of MCS Priority Level. The PCF shall derive the applicable PCC rules and default QoS flow QoS based on that information. If the indication of IMS priority service support is set and the \"dnn\" attribute corresponds to a DNN dedicated for IMS, the PCF shall assign an ARP corresponding to MCS for the default QoS flow and for the PCC Rules corresponding to the IMS signalling QoS flow. If the \"dnn\" does not correspond to a DNN dedicated for IMS, the ARP shall be derived without considering IMS Signalling Priority.\nNOTE 1:\tSubscription data for MCS is provided to the PCF through the Nudr service.\nOnce the PCF receives a notification of a change in Priority PDU connectivity services support, MCS Priority Level and/or IMS priority service support from the UDR, the PCF shall make the corresponding policy decisions (i.e. ARP and/or 5QI (also associated QoS characteristics if applicable) change) and, if applicable, shall initiate an HTTP POST message as defined in clause 4.2.3.2 to provision the modified data.\nNOTE 2:\tThe details associated with the UDR service are specified in 3GPP TS 29.519 [15].\nNOTE 3:\tThe MCS Priority Level is one among other input data such as operator policy for the PCF to set the ARP.\nWhenever one or more AF sessions of an MCS service are active within the same PDU session, the PCF shall ensure that the ARP priority level of the default QoS flow is at least as high as the highest ARP priority level used by any authorized PCC rules belonging to an MCS service. If the ARP pre-emption capability is enabled for any of the authorized PCC rules belonging to an MCS service, the PCF shall also enable the ARP pre-emption capability for the default QoS Flow.\nNOTE 4:\tThis ensures that services using dedicated QoS flows are not terminated because of a default QoS flow with a lower ARP priority level or disabled ARP pre-emption capability being dropped during mobility events.\nNOTE 5:\tThis PCF capability does not cover interactions with services other than MCS services.\nWhen a Priority PDU connectivity services is invoked, the PCF shall:\n-\tDerive the corresponding PCC Rules with the ARP and 5QI (also associated QoS characteristics if applicable) set as appropriate for a prioritized service.\n-\tSet the ARP of the default QoS flow as appropriate for a Priority PDU connectivity services under consideration of the requirement described in clause 4.2.6.2.19.1.\n-\tSet the 5QI (also associated QoS characteristics if applicable) of the default QoS flow as appropriate for the Priority PDU connectivity services.\n-\tSet the ARP of PCC Rules installed before the activation of the Priority PDU connectivity services to the ARP as appropriate for the Priority PDU connectivity services under the consideration of the requirements described in clause 4.2.6.2.19.1.\n-\tSet the 5QI of the PCC Rules installed before the activation of the Priority PDU connectivity services to the 5QI (also associated QoS characteristics if applicable) as appropriate for the Priority PDU connectivity services if modification of the 5QI of the PCC Rules is required.\nWhen a Priority PDU connectivity services is revoked, the PCF shall:\n-\tDelete the PCC Rules corresponding to the Priority PDU connectivity services if they were previously provided.\n-\tSet the ARP of the default QoS flow to the normal ARP under the consideration of the requirements described in clause 4.2.6.2.19.1.\n-\tSet the 5QI of the default QoS flow as appropriate for PCF decision.\n-\tSet the ARP of all active PCC Rules as appropriate for the PCF under the consideration of the requirements described in clause 4.2.6.2.19.1.\n-\tSet the 5QI to an appropriate value according to PCF decision if modification of the 5QI of PCC Rules is required.\nNOTE:\tPriority PDU connectivity services can be explicitly invoked/revoked via UDR MCS user profile (Indication of Priority PDU connectivity services, MCS Priority Level). An AF for MCS Priority Service can also be used to provide Priority PDU connectivity services using network-initiated resource allocation procedures (via interaction with PCC) for originating accesses.\nThe PCF shall provision the SMF with the applicable PCC Rules upon Priority PDU connectivity services activation and deactivation as described above. The provision of the QoS information applicable for the PCC Rules shall be performed as described in clause 4.5.6.2. The provision of QoS information for the default QoS flow shall be performed as described in clause 4.2.6.3.\nIf the PCF receives service information including an MCS session indication and the service priority level from the P-CSCF or at reception of the indication that IMS priority service is active for the PDU session, the PCF shall under consideration of the requirements described in clause 4.2.6.2.19.1:\n-\tif required, set the ARP and 5QI (also associated QoS characteristics if applicable) of the default QoS flow as appropriate for the prioritized service;\n-\tif required, set the ARP and 5QI (also associated QoS characteristics if applicable) of all PCC rules assigned to the IMS signalling QoS flow as appropriate for IMS Mission Critical Services;\n-\tderive the PCC Rules corresponding to the IMS Mission Critical Service and set the ARP and 5QI (also associated QoS characteristics if applicable) of these PCC Rules based on the information received over N5/Rx.\nIf the PCF detects that the P-CSCF released all the MCS session and the IMS priority service has been deactivated for the PDU session the PCF shall under consideration of the requirements described in clause 4.2.6.2.19.1:\n-\tdelete the PCC Rules corresponding to the IMS Mission Critical Service;\n-\tif required, set the ARP and 5QI of the default QoS flow as appropriate for the IMS Mission Critical set to inactive;\n-\treplace the ARP and 5QI of all PCC Rules assigned to the IMS signalling QoS flow as appropriate when the IMS Mission Critical Service is inactive.\nIf the PCF receives a request for PCC rules for a PDU session from the SMF, while no suitable authorized PCC rules are configured in the PCF or can be derived from service information provisioned by an AF, but the user is allowed to access AF session based services, the PCF may, depending e.g. on the user's subscription details or operator policy, authorise the requested QoS for a timer supervised grace period (the timer started by the PCF by the request from the SMF) to wait for AF service information. If an AF session bound to the same PDU session is ongoing and only preliminary service information was received within this AF session, the PCF shall base the authorization of the requested QoS on the preliminary service information.\nNOTE 1:\tThis scenario can for instance be encountered for a UE terminated IMS session establishment or modification with UE initiated resource reservation, refer to 3GPP TS 29.214 [18] or 3GPP TS 29.514 [17]. If the PCF does not authorize a request for PCC rules in this scenario, the IMS session setup can fail.\nNOTE 2:\tDuring the grace period, the QoS and packet filters requested by the UE need to be authorized even if the user is not allowed to request for resources for services not known to the PCF or if the requested 5QI is not allowed for services not known to the PCF as it is not clear at this point in time whether the UE resource request belongs to an AF session or to a service not known to the PCF.\nIf the preliminary service information is insufficient to construct appropriate PCC rules or no preliminary service information is available, the PCF shall provide preliminary PCC rules to authorize the UE requested QoS and packet filters. Therefore, the preliminary PCC rules shall contain wildcarded flow description or flow description derived from possible packet filters received as part of the request for PCC rules. The PCF may apply a dedicated charging key value to indicate to the charging subsystem that the charging key is preliminary and may be corrected later on.\nNOTE 3:\tWith the dedicated charging key, the PCF instructs the charging subsystem to recalculate the applicable charge for the time when the dedicated charging key value was applied once the dedicated charging key value is replaced with some other value in a new provisioning of PCC rules. For example, if online charging applies, Session Charging with Unit Reservation (SCUR) can be used .When the charging key changes, the SMF will return initially reserved credit units and the CHF then can recalculate the consumed credit units applying the rate derived from the new other charging key value and update the user's credit accordingly.\nNOTE 4:\tA preliminary PCC rule is a normal PCC rule containing preliminary information.\nIf the PCF receives AF service information while the timer-supervised grace period is running, the PCF shall stop the timer and may derive authorized PCC rules from this service information and update or replace the preliminary PCC rules that were previously provided for the UE requested QoS and packet filters, for instance by choosing service specific QoS parameters and charging keys.\nNOTE 5:\tThe dedicated preliminary charging key value that was previously provided by the PCF instructs the charging subsystem to recalculate the applicable charge when the new service specific charging key is provided. The recalculation covers the time when the previous dedicated charging key value was active. The new service specific charging key is applied from that time onwards.\nIf the timer expires and the PCF has not received any AF service information, the PCF should apply the policy for services not known to the PCF and may downgrade or revoke the authorization for the preliminary PCC rules (previously provided for the UE requested QoS and packet filters) in accordance with the policy for services not known to the PCF. The PCF should adjust the charging keys within the PCC rules and should downgrade the authorized QoS to the allowed value for the services not known to the PCF, if required.\nWhen the \"L4S\" feature is supported, and the PCF is configured to provide an explicit indicator to the SMF to enable ECN marking for L4S, this procedure is used by the PCF to explicitly indicate that the UL and/or DL traffic identified by SDF template supports ECN marking for L4S support.\nIf the AF provides an explicit indication that the UL and/or DL service data flow supports ECN marking for L4S as defined in 3GPP TS 29.514 [17], or the PCF determines, based on locally configured policies, that the UL and/or DL traffic of the SDF template support ECN marking for L4S, then the PCF may explicitly or implicitly (based on local configuration), indicate to the SMF to enable ECN marking for L4S.\nThe PCF shall provide to the SMF the explicit indication of support of ECN marking for L4S by installing PCC rules and the implicit indication by installing or activating PCC rule(s).\nThe provisioning of the explicit indication of ECN marking for L4S support per PCC rule shall be performed using the PCC rule provisioning procedure as defined in clause 4.2.6.2.1 and shall be provided using the \"l4sInd\" attribute within the TrafficControlData the PCC rule refers to. The \"l4sInd\" attribute shall be set to \"UL\", \"DL\" or \"UL_DL\" to indicate respectively whether the UL, the DL, or both, UL and DL, service data flow(s) of the SDF template of the PCC rule support ECN marking for L4S.\nWhen the SMF receives the indication that ECN marking for L4S is supported for the UL and/or DL traffic of the PCC rule, may decide, based on operator's network configuration and policies, to enable for the QoS flow the ECN marking for L4S in either the NG-RAN, as specified in 3GPP TS 29.502 [22], or in the PSA UPF as specified in 3GPP TS 29.244 [13].\nNOTE:\tWhen the ECN marking for L4S is performed by UPF, the NG-RAN is instructed to perform congestion information monitoring, as specified in 3GPP TS 29.502 [22].\nIn case of inter NG-RAN UE mobility, if the ECN marking for L4S has been enabled on source NG-RAN, but the target NG-RAN does not support ECN marking for L4S, then the SMF may enable ECN marking for L4S in PSA UPF.\nWhen serving PSA UPF or NG-RAN is changed e.g., due to inter-NG-RAN handover or PSA UPF relocation, target NG-RAN and PSA UPF should keep the current congestion exposure method. However, if not available (e.g., ECN marking for L4S is not used anymore in 5GS), the PCF provisioned the \"L4S_SUPP\" policy control request trigger, the SMF may notify the PCF about ECN marking not supported. At a subsequent PSA UPF or NG-RAN change, the SMF may determine the target NG-RAN and/or PSA UPF may support the congestion exposure method again and may notify the PCF about ECN marking is supported again. In these cases, the SMF shall invoke the Npcf_SMPolicyControl_Update procedure and shall include within the SmPolicyUpdateContextData, including the \"L4S_SUPP\" within \"repPolicyCtrlReqTriggers\" attribute and the \"l4sReports\" attribute. In each L4sSupportInfo data structure, the SMF shall include the indication that ECN marking for L4S is not available or is available again within the \"notifType\" attribute and affected PCC rule identifiers within the \"refPccRuleIds\" attribute. The PCF may notify the affected AF(s) as specified 3GPP TS 29.514 [17].\nIf the \"RTLatency\" feature is supported, the Round-Trip (RT) latency indication indicates the service data flow needs to meet the RT latency requirement of the service may be provided by the AF, which is twice the single direction delay requirement between the UE and the PSA UPF described by the received QoS reference parameter or the received individual QoS parameter.\nIf the AF provided the RT latency indication as defined in 3GPP TS 29.514 [17], the PCF may split the RT latency requirement, i.e. the twice of the single direction delay, into two PDBs of two PCC rules, one for UL service data flow and the other for DL service data flow. The two PDBs can be unequal, but their sum shall not exceed the RT latency requirement.\nNOTE:\tRT latency requirement may also be locally configured in the PCF together with delay requirement.\nTo enable RT latency tracking, the PCF shall generate associated QoS monitoring policies for the two correlated PCC rules as described in clause 4.2.3.25. The uplink and downlink delay for the two PCC rules shall be tracked by PCF independently with same reporting period. When the QoS monitoring results are reported to PCF, the PCF may update the two PCC rules to adjust the UL PDB and DL PDB.\nWhen the AF requested QoS for a UE or group UE(s), the requested QoS data may be either provisioned by the AF/NEF to the TSCTSCF, and later to the PCF for the related active PDU sessions, as specified in 3GPP TS 29.565 [53] and 3GPP TS 29.514 [17], or stored by the AF/NEF at the UDR and later retrieved by the PCF for the related active PDU sessions, as defined in 3GPP TS 29.519 [15].\nWhen the PCF needs to make Policy Decision(s) and derive PCC Rule(s) for a PDU session corresponding to the concerned UE or group of UE(s), the PCF shall take into consideration the received AF requested QoS data, if applicable, and mayprovide to the SMF the policy control triggers corresponding to the AF subscribed event(s) as defined in clause 4.2.6.4, or activate/modify/remove PCC rule(s) as defined in clause 4.2.3.2.\nWhen the SMF notifies the PCF about a met policy control request trigger corresponding to the AF subscribed event(s), the PCF may notify either the TSCTSF or the AF/NEF, as defined in 3GPP TS 29.514 [17], based on whether the requested QoS data was provisioned via the TSCTSF or the UDR.\nThe PCF may perform operations on session rules. The impacted rules shall be included in the \"sessRules\" map attribute within the SmPolicyDecision data structure with the \"sessRuleId\" as a key. For installing or modifying a session rule, the corresponding SessionRule data instance shall be provided as the map entry value. For removing a session rule, the map entry value shall be set to NULL.\nIn order to install a new session rule, the PCF shall further set other attributes within the SessionRule data structure as follows:\n-\tif the \"subsSessAmbr\" has been previously received by the PCF, it shall include the authorized Session-AMBR within the \"authSessAmbr\" attribute;\n-\twhen the \"subsDefQos\" has been previously received by the PCF, it shall include the authorized default QoS within the \"authDefQos\" attribute using the procedure as defined in clause 4.2.6.3.3;\n-\tit may include one reference to the UsageMonitoringData data structure within the \"refUmData\" attribute. In this case, a \"umDecs\" attribute containing the corresponding Usage Monitoring data policy decisions shall be included in SmPolicyDecision data structure if it has not been previously provided;\n-\tif the \"ATSSS\" feature is supported, it may include one reference to the UsageMonitoringData data structure to apply for the Non-3GPP access within the \"refUmN3gData\" attribute. In this case, a \"umDecs\" attribute containing the corresponding Usage Monitoring data policy decisions shall be included in SmPolicyDecision data structure if it has not been previously provided; and\n-\tit may include one reference to the ConditionData data structure within the \"refCondData\" attribute. In this case, a \"conds\" attribute containing the corresponding Condition Data decision shall be included in SmPolicyDecision data structure if it has not been previously provided.\nIn order to modify an existing session rule, the PCF shall further set other attributes within the SessionRule data structure as follows:\n-\tIf the PCF needs to modify the attribute(s) within a session rule, the PCF shall include the modified attribute(s) with the new value(s) within the SessionRule data instance. Previously supplied attributes not supplied in the modified PCC rule instance shall remain valid.\n-\tIf the PCF only needs to modify the content of referenced policy decision data (e.g. UsageMonitoringData, etc.) and/or condition data for one or more session rules, the PCF shall, within the SmPolicyDecision data structure, include the corresponding policy decision data and/or condition data within the corresponding map attributes (e.g. include the usage monitoring data decision within the \"umDecs\" attribute).\nThe PCF may combine multiple of the above session rule operations in a single message, but the PCF shall ensure that one and only one session rule is enforced in the SMF at a certain point in time.\nNOTE:\tEither there is always an unconditional session rule provisioned in the NF service consumer (SMF), or there is always a conditioned session rule applicable in the NF service consumer (SMF).\nUp to four conditioned session rules (i.e. authorized Session-AMBR and authorized default QoS) may be provisioned by the PCF. In order to provision a session rule with conditional data, the PCF shall provision a session rule as defined in clause 4.2.6.3.1 and include within its \"refCondData\" attribute the corresponding ConditionData's \"condId\" attribute value. The PCF shall also ensure that the referenced ConditionData instance is included in the \"conds\" map within the SmPolicyDecision data structure following the procedures defined in clause 4.2.6.1 and that the referenced usage monitoring data is the same for all the provisioned conditioned and non-conditioned session rule(s).\nWithin the ConditionData instance, the PCF shall include the activation time within the \"activationTime\" attribute for the time conditioned authorized Session-AMBR and authorized default QoS (deactivation time does not apply for a session rule). If the \"AccessTypeCondition\" feature as defined in clause 5.8 is supported, the PCF may include for the access type conditioned session rule the access type within the \"accessType\" attribute and RAT type within the \"ratType\" attribute if applicable for the access type conditioned authorized Session-AMBR.\nNOTE 1:\tThe SMF retains remaining time conditioned session rules that have an execution time in the future.\nNOTE 2:\tTime condition and access type condition can both apply to authorize the Session-AMBR within a session rule.\nThe PCF shall ensure that a time conditioned session rule and a session rule without time condition for the same session differ only in the authorized session-AMBR and authorized default QoS properties.\nWhen the SMF detects that the referenced usage monitoring data of the enforced session rule is not the same for all the provisioned session rule(s) the SMF shall report the session rule error for the not enforced session rule(s) as defined in clauses 4.2.3.20 and 4.2.4.21, and shall set the \"failureCode\" attribute to \"INCORRECT_UM\".\nIf the SMF receives the conditioned session rule, when the condition indicated in the related attribute(s) within the Condition Data decision (e.g. at the time indicated in the \"activationTime\" attribute) is met, the SMF shall perform the conditional policy without interaction with the PCF. If the Condition Data decision includes more than one type of conditions and all the types of conditions are met, the SMF shall perform the conditional policy.\nIf time conditioned session rule(s) to change the non-conditioned session rule are received by the SMF and the earliest Activation Time is in the past, then the SMF shall immediately enforce the most recent time conditioned instance that is not in the future.\nThe PCF may modify a currently installed session rule, including setting, modifying or deleting its condition(s) as follows:\n1)\tWhen modifying a session rule by setting the condition(s), the PCF shall update the session rule by including the corresponding ConditionData's \"condId\" attribute value within the \"refCondData\" attribute and within the SmPolicyDecision data structure include the ConditionData instance within the \"conds\" attribute if not provisioned yet.\n2)\tWhen modifying a session rule by modifying the condition(s):\n-\tthe PCF may update the session rule by replacing the existing ConditionData instance's \"condId\" attribute value within the \"refCondData\" attribute with a new one and within the SmPolicyDecision data structure include the new ConditionData instance within the \"conds\" attribute if not provisioned yet; or\n-\tthe PCF may update the condition data decision which the session rule refers to by updating the corresponding ConditionData instance as defined in clause 4.2.6.1. The PCF may update the value of the condition within the related attribute (e.g. the value of the existing deferred activation time within the \"activationTime\" attribute).\n3)\tWhen modifying a session rule by deleting the condition(s):\n-\tthe PCF shall delete the reference to the ConditionData instance within the session rule by updating session rule with the \"refCondData\" attribute set to NULL; and\n-\tthe PCF may delete the condition data decision which the session rule refers to as defined in clause 4.2.6.1 if no other session rules are referring to the condition data decision.\nTo delete a conditioned session rule, the PCF shall perform the deletion of session rule as defined in clause 4.2.6.3.1. The \"ueTimeZone\" attribute, if available, may be used by the PCF to derive the value for the \"activationTime\" attribute.\nNOTE 3:\tConditioned Session-AMBR and default QoS change helps reducing the signalling load over N7. However, the Session-AMBR and default QoS change needs to be communicated to the UE. Consequently a simultaneous change of the Session-AMBR and default QoS for many UE(s) may introduce a signalling storm in the 5GC (e.g. over N1/N2/N4/N11). The PCF can avoid this simultaneous change of the Session-AMBRSession-AMBR and default QoS (e.g. spread the time conditioned change over time for many UEs).\nNOTE 4:\tFor services that depend on specific Session-AMBR and/or default QoS change (e.g. an MPS session), the PCF is responsible to ensure that no conditioned session rules interfere with the service (e.g., ensure proper MPS operation by removing time conditioned settings that would later impact MPS).\nThe procedures in clause 4.2.6.3.2.1 apply with clarifications in the present clause.\nEach instance of the session rule shall include authorized Session-AMBR within the \"authSessAmbr\" attribute.\nIf the \"VPLMN-QoS-Control\" feature is supported and the PCF receives the session AMBR constraints from the SMF, the PCF shall ensure that the authorized session AMBR value within each instance of the session rule does not exceed the session AMBR supported by the VPLMN, if applicable.\nThe SMF shall, after applying a time conditioned instruction to change the authorized AMBR, apply the corresponding procedures towards to the access network, the UE and the UPF for the enforcement of the AMBR per PDU session.\nThe procedures in clause 4.2.6.3.2.1 apply with clarifications in the present clause.\nEach instance of the session rule shall include authorized default QoS within the \"authDefQos\" attribute.\nIf the \"VPLMN-QoS-Control\" feature is supported and the PCF receives the default QoS constraints from the SMF, the PCF shall ensure that the authorized default QoS containing 5QI, ARP and, if the feature \"VPLMN-5QIPrioLevel\" is supported, 5qiPriorityLevel (when the required 5QI Priority Level is different from the standardized Default Priority Level value in the QoS characteristics Table 5.7.4-1 in 3GPP TS 23.501 [2]), values within each instance of the session rule is supported by the VPLMN, if applicable.\nThe SMF shall, after applying a time conditioned instruction to change the authorized default QoS, apply the corresponding procedures towards to the access network, the UE and the UPF for the enforcement of the authorized default QoS. All PCC rule(s) with the \"defQosFlowIndication\" attribute set to true shall remain bound to the default QoS flow. For any other PCC rule previously bound to the default QoS flow, SMF shall then perform the QoS flow binding according to clause 6.4 in 3GPP TS 29.513 [7].\nThe SMF shall enforce the Session-AMBR values corresponding to the session rule whose referred ConditionData instance contains the \"accessType\" attribute and \"ratType\" attribute matching the current access type and RAT type of the UE for the given PDU session. If the \"VPLMN-QoS-Control\" feature is supported and the PCF receives the session AMBR constraints from the SMF, the PCF shall ensure that the authorized session AMBR value within each instance of the session rule does not exceed the session AMBR supported by the VPLMN, if applicable.\nThe PCF shall ensure that an access type conditioned session rule and a session rule without any access type condition for the same session differ only in the authorized session-AMBR property. If more than one access type conditioned session rules are provisioned, and if there is no session rule without any access type condition provisioned in the SMF, the PCF shall ensure that any two access type conditioned session rules for the same session differ only in the authorized session-AMBR property.\nNOTE:\tAccess type conditions are only applicable to the authorized session-AMBR.\nIf there is a session rule whose authorized Session-AMBR does not depend on any access type condition provided and there is also a session rule with an access type conditioned authorized Session-AMBR provided, then the access type conditioned session rule where the conditions specified within the Condition Data decision are met shall be enforced. Otherwise, the session rule with the authorized Session-AMBR without any access type condition shall be enforced.\nIf conditions from multiple access type conditioned the session rule with authorized Session-AMBR are met at the same time then the session rule related to the most strict matching condition is enforced, e.g. Policy1 specifies access type only and Policy2 specifies access type (with the value same as in Policy1) and an RAT Type, both, then the Policy2 shall be enforced when the UE's current access type and RAT type matches with the condition specified by Policy2.\nIf conditions from multiple access type conditioned the session rule with authorized Session-AMBR are met at the same time and all of these policies are equally applicable, e.g. Policy1 specifies access type only and Policy2 specifies RAT type only and if the UE's current access type matches with Policy1 and the UE's current RAT type matches with Policy2, then the SMF should apply the Session-AMBR with Policy2.\nAn access type conditioned session rule does not apply to a MA PDU session. When the \"ATSSS\" feature is supported, and the PDU session is a MA PDU session, the PCF shall not provide to the SMF access type conditioned session rules. If access type conditioned session rules are provisioned in the SMF for a MA PDU session (e.g. because of error in the PCF or EPS to 5GS handover) they shall be ignored.\nThe PCF can provide the authorized default QoS for a session rule to the SMF. The provisioning of authorized default QoS for a session rule shall be performed using the session rule provisioning procedure as defined in clause 4.2.6.3.1. The authorized default QoS shall be encoded using an AuthorizedDefaultQos data structure.\nIn order to provision authorized default QoS for a new session rule, the PCF shall include the assigned 5QI value within the \"5qi\" attribute and the assigned ARP value within the \"arp\" attribute in the AuthorizedDefaultQos data structure. The PCF may include the \"priorityLevel\" attribute in the AuthorizedDefaultQos data structure to authorize the particular 5QI priority level to override the default value for a standardized or pre-configured 5QI. The PCF may include a \"QosCharacteristics\" entry in the \"qosChars\" attribute map to provide explicitly signalled QoS characteristics associated with a 5QI that is neither standardized nor pre-configured. When the authorized default QoS applies to explicitly signalled QoS Characteristics, it shall be provisioned as defined in clause 4.2.6.6.3. For 5QI of GBR type or delay critical GBR type, the PCF shall additionally include max bandwidth in uplink within the \"maxbrUl\" attribute and/or max bandwidth in downlink within the \"maxbrDl\" attribute, the guaranteed bandwidth in uplink within the \"gbrUl\" attribute and/or the guaranteed bandwidth in downlink within the \"gbrDl\" attribute and may include the particular averaging window within the \"averWindow\" attribute and/or particular maximum data burst volume within the \"maxDataBurstVol\" or \"extMaxDataBurstVol\" (if supported, see clause 4.2.2.1) attribute to override the default values for a standardized or pre-configured 5QI.\nIn order to modify authorized default QoS for an existing session rule, the PCF shall include the modified attribute(s) with the new value(s) within the AuthorizedDefaultQos data structure and provision a new QoS Characteristics if applicable. Previously supplied attributes not supplied in the AuthorizedDefaultQos data structure shall remain valid.\nIf both the SMF and the PCF support the \"ATSSS\" feature, the PCF may enable the control of the PDU session level Usage Monitoring information depending on what access type is used to carry service data flows.\nWhen the PCF determines that at PDU session level different usage monitoring data shall be defined for the 3GPP and the Non-3GPP access, the PCF shall include within the SessionRule data structure one reference to the UsageMonitoringData policy decision to apply for the Non-3GPP access within the \"refUmN3gData\" attribute, and a \"umDecs\" attribute containing the corresponding Usage Monitoring Data policy decisions if it has not been previously provided. When the \"refUmN3gData\" is omitted, the attribute \"refUmData\" contains the reference to the UsageMonitoringData policy decision to apply for both, 3GPP and Non-3GPP, accesses.\nNOTE:\tTo ensure that the traffic of a set of service data flows is excluded for both, the 3GPP access and Non-3GPP access, from the PDU session level usage monitoring, the \"exUsagePccRuleIds\" attribute is set to the same value within the Usage Monitoring Control decision referred by the \"refUmN3gData\" attribute and within the Usage Monitoring Control decision referred by the \"refUmData\" attribute.\nUsage monitoring may be performed for all the traffic of a PDU session in the SMF or for all the traffic of a PDU session excluding the traffic of a service data flow or a group of service data flows.\nThe provisioning of usage monitoring control for the traffic of a PDU session shall be performed using the session rule provisioning procedure as defined in clause 4.2.6.3.1. When the traffic of a service data flow or a group of service data flows is excluded from the traffic of the PDU session, the UsageMonitoringData policy decision referred within the \"refUmData\" attribute, and/or the UsageMonitoringData policy decision referred within the \"refUmN3gData\" attribute when the \"ATSSS\" feature is supported, shall include the \"exUsagePccRuleIds\" attribute as defined in clause 4.2.6.5.3.1.\nUsage monitoring for all the session rules (conditioned and non-conditioned) shall refer to the same UsageMonitoringData policy decision(s), i.e., the monitoring key that applies to all the traffic of a PDU session, or to all the traffic of a PDU session except certain service data flow(s), shall not change because of the activation of a conditioned session rule.\nThe PCF may provide one or several policy control request trigger(s) to the SMF. In order to do so, the PCF shall include one or several policy control request trigger(s) within the \"policyCtrlReqTriggers\" attribute within the SmPolicyDecision data structure.\nDuring the lifetime of the PDU session, the PCF may update or remove the policy control request triggers. In order to update the policy control request trigger, the PCF shall provide the new complete list of applicable policy control request triggers by including one or several policy control request trigger(s) within the \"policyCtrlReqTriggers\" attribute within the SmPolicyDecision data structure.\nThe PCF may remove all previously provided policy control request triggers by providing a \"policyCtrlReqTriggers\" attribute set to the value NULL. Upon reception of a  policy control request trigger with this value, the SMF shall not inform PCF of any trigger except for those triggers that are always reported and do not require provisioning from the PCF.\nWhenever the PCF provisions one or several policy control request trigger(s) by using an HTTP POST message as defined in clause 4.2.3.2, unless otherwise specified in a policy control request trigger's value definition, the SMF shall send the corresponding currently applicable values (e.g. access type, RAT type, user location information, etc.) to the PCF within the UeCampingRep data structure in the response of the HTTP POST message, and in this case, the \"repPolicyCtrlReqTriggers\" attribute shall not be included.\nWhen the Access Network Charging Identifier is unknown for an AF session to the PCF, the PCF may request the SMF to provide the Access Network Charging Identifier associated to the dynamic PCC rules. To do so, the PCF shall within SmPolicyDecision data structure provide the \"policyCtrlReqTriggers\" attribute with the value \"AN_CH_COR\" if the policy control request trigger is not previously set and the \"lastReqRuleData\" attribute. For the RequestedRuleData instance, the PCF shall include the CH_ID within the \"reqData\" attribute and reference of the PCC rule within the \"refPccRuleIds\" attribute.\nThe PCF shall interpret that the Access Network Charging Identifier is known when the PCF receives an \"accNetChId\" attribute with the \"sessionChScope\" attribute included and set to true as defined in clause 4.2.2.11 and 4.2.4.13.\nWhen the RAN-NAS-Cause feature is supported, the PCF may request the SMF to inform it of the result of PCC rule(s) removal, when the PCF removes PCC rule(s). In order to do so, the PCF shall additionally include the \"policyCtrlReqTriggers\" attribute containing the \"RES_RELEASE\" value if this policy control request trigger was not previously set, and the \"lastReqRuleData\" attribute. Within the RequestedRuleData instance, the PCF shall include the \"RES_RELEASE\" value within the \"reqData\" attribute and reference the removed PCC rule within the \"refPccRuleIds\" attribute.\nNOTE:\tThis is done to allow the PCF to notify the AF when there is an abnormal termination of the QoS flow. The PCF does not have to retry the removal of these PCC Rules.\nThe PCF may indicate the need to apply monitoring control of the accumulated usage of network resources on a per PDU session basis. Usage is defined as volume or time of user plane traffic. Monitoring for traffic volume and traffic time can be performed in parallel. The data collection for usage monitoring control shall be performed per monitoring key, which may apply to a single service data flow, a set of service data flows or all the traffic in a PDU session. If usage monitoring at PDU session level is enabled, the PCF may request the SMF to exclude a single service data flow or a set of service data flows from usage monitoring at PDU session level.\nDuring PDU session establishment, the PCF may receive information from the UDR about total the allowed usage per DNN / S-NSSAI combination and UE, i.e. the overall amount of allowed traffic volume and/or time of usage that are to be monitored per DNN / S-NSSAI combination and UE and/or the total allowed usage for Monitoring key(s) per DNN / S-NSSAI combination and UE.\nNOTE 1:\tIt depends on the implementation of UDR whether to provide the total allowed usage per DNN / S-NSSAI combination and UE to different PCFs if these different PCFs are serving PDU sessions with the same value of DNN / S-NSSAI combination and UE.\nIf the SMF supports the UMC feature, the PCF may request usage monitoring control for a PDU session. If at that time the PCF has not provided \"US_RE\" policy control request trigger to the SMF, the PCF shall include the \"policyCtrlReqTriggers\" attribute with the value \"US_RE\" and provide it to the SMF as defined in clause 4.2.6.4. The PCF shall not remove the \"US_RE\" policy control request trigger while usage monitoring is still active in the SMF.\nAt PDU session establishment and modification, the PCF may provide to the SMF, for each usage monitoring control instance, the applicable threshold(s), i.e. volume threshold, time threshold or both volume threshold and time threshold. To provide the initial threshold(s) for each usage monitoring control instance, the PCF shall include these threshold(s) within the \"umDecs\" attribute within the SmPolicyDecision data structure.\nThe PCF may provide a monitoring time to the SMF for the usage monitoring control instance(s) and optionally specify a subsequent threshold value for the usage after the monitoring time.\nNOTE 2:\tThe PCF can provide only one threshold or one threshold and one subsequent threshold in the case that monitoring time is provided. When only the threshold is provided, the UPF resets the usage threshold to the remaining value of the threshold at the monitoring time; when the threshold and subsequent threshold are provided, the UPF resets the usage threshold to the value of the subsequent threshold at the monitoring time as defined in 3GPP 29.244 [13].\nThreshold levels may be defined for:\n-\tthe total volume only; or\n-\tthe uplink volume only; or\n-\tthe downlink volume only; or\n-\tthe uplink and downlink volume; and/or\n-\tthe time.\nThreshold levels, monitoring time, if applicable, and inactive time, if applicable, for each usage monitoring control instance may be provisioned within an entry of the \"umDecs\" attribute as follows:\n-\tthe total volume threshold, if applicable, within the \"volumeThreshold\" attribute;\n-\tthe uplink volume threshold, if applicable, within the \"volumeThresholdUplink\" attribute;\n-\tthe downlink volume threshold, if applicable, within the \"volumeThresholdDownlink\" attribute;\n-\tthe time threshold, if applicable, within the \"timeThreshold\" attribute;\n.\tthe total volume threshold after the monitoring time, if applicable, within the \"nextVolThreshold\" attribute;\n-\tthe uplink volume threshold after the monitoring time, if applicable, within the \"nextVolThresholdUplink\" attribute;\n-\tthe downlink volume threshold after the monitoring time, if applicable, within the \"nextVolThresholdDownlink\" attribute;\n-\tthe time threshold after the monitoring time, if applicable, within the \"nextTimeThreshold\" attribute;\n-\tthe monitoring time, if applicable, within the \"monitoringTime\" attribute;\n-\tthe inactive time, if applicable, within the \"inactivityTime\" attribute.\nIf the SMF reports usage before the monitoring time is reached, the monitoring time is not retained by the SMF. Therefore, the PCF may again provide in the response a monitoring time and optionally the subsequent threshold value(s) for the usage after the monitoring time.\nThe \"inactivityTime\" attribute represents the time interval after which the time measurement shall stop for the Monitoring Key, if no packets belonging to the corresponding Monitoring Key are received. Time measurement shall resume again on receipt of a further packet belonging to the Monitoring Key. Time measurement for a Monitoring key shall also be stopped when time based usage monitoring is disabled, if this happens before the Inactivity Detection Time is reached. If an \"inactivityTime\" attribute with value of zero is provided, or if no \"inactivityTime\" attribute is present within the usage monitoring control instance provided by the PCF, the time measurement shall be performed continuously from the point the first packet is received matching the applicable Monitoring Key is received and until time based usage monitoring is disabled.\nIf the usage monitoring control instance applies to the PDU session level, the PCF shall include the reference to the Usage Monitoring Data decision within the \"refUmData\" attribute of the related session rule.\nIf the usage monitoring control instance applies to a service data flow or a group of service data flows, the PCF shall include the reference to the Usage Monitoring Data decision within the \"refUmData\" attribute of the related PCC rule(s).\nThe PCF may provide one usage monitoring control instance applicable at PDU session level and one or more usage monitoring control instances applicable at PCC Rule(s) level.\nIf the PDU session level usage monitoring is enabled and service data flow(s) need to be excluded from this PDU session level usage monitoring, the PCF shall include the corresponding PCC rule identifier(s) within the \"exUsagePccRuleIds\" attribute of the UsageMonitoringData instance of PDU session level usage monitoring. If the exclusion is enabled, the PCF may disable the exclusion again for service data flow(s) by removing the corresponding PCC rule identifier(s) from \"exUsagePccRuleIds\" attribute.\nThe PCF may provide new volume threshold(s) and/or a new time threshold to the SMF. The new threshold value(s) override the existing value(s) in the SMF.\nWhen the SMF receives above the usage monitoring control request from the PCF, the SMF shall initiate the PFCP Session Establishment procedure as defined in clause 7.5.2, or the PFCP Session Modification procedure, as defined in clause 7.5.4 of 3GPP TS 29.244 [13], to request the UPF to perform the usage monitoring control.\nIf the reset time of the usage monitoring related information (see clause 5.4.2.7 of 3GPP TS 29.519 [15]) is reached, the PCF shall reset the remaining allowed usage to the value(s) indicated in the usage monitoring related information and shall then interact with the SMF to undo any previously applied policy decisions related to remaining allowed usage of zero (or below zero).\nNOTE 2:\tThe PCF can also update the related usage monitoring information in the UDR as defined in 3GPP TS 29.519 [15] according to the performed reset action.\nAfter usage monitoring is enabled, the PCF may explicitly disable usage monitoring as a result of receiving an SM Policy association update from the SMF which is not related to reporting usage, but to other external triggers (e.g., receiving an AF request, subscriber profile update), or a PCF internal trigger. When the PCF disables usage monitoring, the SMF shall report the accumulated usage which has occurred while usage monitoring was enabled since the last report.\nTo disable usage monitoring for a monitoring key, the PCF shall provide either the SMF with the corresponding applicable attributes of the usage monitoring control instance containing a NULL value (e.g. the previous provided  \"volumeThreshold\" is set to NULL\"), or:\n-\tfor dynamic PCC rule(s) or session rule(s), remove the reference to the corresponding usage monitoring control instance from all the dynamic PCC rule(s) or session rule(s) referencing it;\nNOTE:\tThe PCF could keep the UsageMonitoringData policy decision valid in the SMF.\n-\tfor predefined PCC rule(s), remove the UsageMonitoringData policy decision referred from all the activated predefined PCC rule(s).\nWhen the PCF disables usage monitoring for usage monitoring key(s) via a Npcf_SMPolicyControl_UpdateNotify or a Npcf_SMPolicyControl_Update service operation, the SMF shall trigger a new Npcf_SMPolicyControl_Update service operation using the procedures specified in clause 4.2.4.10 to report accumulated usage for the disabled usage monitoring key(s).\nWhen usage monitoring is enabled, the PCF may request the SMF to report the accumulated usage for one or more enabled usage monitoring control instance(s) regardless of whether associated usage threshold(s) have been reached or not. In order do so, the PCF shall include the \"lastReqUsageData\" attribute containing one or more reference(s) to usage monitoring data decision(s) within the \"refUmIds\" attribute or the \"allUmIds\" attribute set to true in an HTTP POST request or in the response of an HTTP POST request from the SMF. The PCF shall require the SMF to report accumulated usage for one or more enabled usage monitoring control instance(s) only in a response to received HTTP POST request from the SMF when the SMF has not provided accumulated usage in this HTTP POST request for the same usage monitoring control instance(s).\nWhen the NetLoc feature is supported, if the AF requests the PCF to report the access network information as described in clauses 4.2.2, 4.2.3 or 4.2.4 of 3GPP TS 29.514 [17] or in clauses 4.1 and 4.2 of 3GPP TS 29.214 [18], the PCF shall perform the PCC rule provisioning procedure as defined in clause 4.2.6.2.1 and additionally provide the requested access network information indication (e.g. user location and/or user timezone information) to the SMF as follows:\n-\tit shall include the \"lastReqRuleData\" attribute to contain the \"reqData\" attribute with the value(s) MS_TIME_ZONE and/or USER_LOC_INFO and the \"refPccRuleIds\" attribute to contain the related installed/modified/removed PCC rule identifier(s).\n-\tit shall provide the AN_INFO policy control request rigger within the \"policyCtrlReqTriggers\" attribute (if not yet set).\nFor those PCC Rule(s) based on preliminary service information as described in 3GPP TS 29.514 [17] or in 3GPP TS 29.214 [18], the PCF may assign the 5QI and ARP of the default QoS flow to avoid signalling to the UE. These PCC Rules shall not include the \"packetFilterUsage\" attribute set to true within the \"flowInfos\" attribute.\nFor those PCC Rule(s) based on AF signalling as described in 3GPP TS 29.514 [17] or in 3GPP TS 29.214 [18], the PCF may use 5QI and ARP for AF signalling to avoid signalling to the UE. These PCC Rules shall not include the \"packetFilterUsage\" attribute set to true within the \"flowInfos\" attribute.\nNOTE:\tSimilarly, for predefined PCC rules based on AF signalling, these PCC Rule(s) could be defined with the 5QI and ARP for AF signalling, and cannot include packet filter usage information.\nThe PCF may request the SMF to confirm that the resources associated to a PCC rule are successfully allocated. To do so, the PCF shall provide within the \"policyCtrlReqTriggers\" attribute of the SmPolicyDecision data structure the value \"SUCC_RES_ALLO \", if this policy control request trigger was not previously set, and provide the \"lastReqRuleData\" attribute as well. For the associated RequestedRuleData instance, the PCF shall include the value \"SUCC_RES_ALLO\" within the \"reqData\" attribute and the reference to the PCC rule within the \"refPccRuleIds\" attribute.\nWhen the PRA or ePRA feature is supported, the PCF may determine during the lifetime of the PDU session whether reports on the change of UE presence in Presence Reporting Area(s) are desired for this PDU session based on the subscriber's profile configuration. If such reporting is desired for a PDU session, the PCF shall provide the \"praInfos\" attribute within the SmPolicyDecision data structure. Within each associated PresenceInfoRm data structure, the PCF shall include the Presence Reporting Area Identifier within the \"praId\" attribute, and, for a UE-dedicated Presence Reporting Area, the list of elements composing the presence reporting area within the \"trackingAreaList\" attribute, the \"ecgiList\" attribute, the \"ncgiList\" attribute, the \"globaleNbIdList\" attribute and/or the \"globalRanNodeIdList\" attribute. The PCF shall also activate the reporting of the changes of UE presence in the provided Presence Reporting Area(s) by provisioning the \"PRA_CH\" policy control request trigger to the SMF, within the \"policyCtrlReqTriggers\" attribute.\nNOTE 1:\tIf this feature is not supported, the PCF can instead activate location change reporting that enables to receive reports of the actual location of the UE. Due to the potential increase in signalling load, careful consideration of the network load is necessary for such reporting, e.g. by limiting the number of subscribers subject to such reporting.\nIf the PCF is configured with a Presence Reporting Area identifier referring to a list of Presence Reporting Area Identifier(s) within a Set of Core Network predefined Presence Reporting Areas as defined in 3GPP TS 23.501 [2], the PCF shall include only the identifier of the Presence Reporting Area Set within the \"praId\" attribute.\nNOTE 2:\tThe Presence Reporting Area Identifier can correspond to a list of Presence Reporting Area Identifier(s) within a Set of Core Network predefined Presence Reporting Areas (PRA set identifier) as defined in 3GPP TS 23.501 [2].\nThe PCF may modify the list of PRA Identifier(s) by providing new Presence Reporting Area(s) or removing existing Presence Reporting Area(s), or modify the list of Presence Reporting Area element(s) by providing the updated Presence Reporting Area(s). In order to do that,\n-\twhen the PRA feature is supported, the PCF shall follow the general procedure defined in clause 4.2.6.1 and supply the Presence Reporting Area identifier(s) as key(s) of \"praInfos\" the map attribute; or\n-\twhen the ePRA feature is supported, the PCF shall follow the general procedure defined in clause 4.2.6.1 and supply the Presence Reporting Area identifier(s) as key(s) of \"praInfos\" map, with the exception that for the modification of the list of the Presence Reporting Area element(s) the PCF shall fully replace the Presence Reporting Areas(s) previously provided with the new complete list of Presence Reporting Area element(s).\nNOTE 3:\tWhen the PRA feature is supported, the PCF cannot indicate the SMF to remove an existing Presence Reporting Area element(s) from a Presence Reporting Area by providing the updated Presence Reporting Area as defined in clause 4.2.6.1. How to support it depends on implementation.\nWhen PRA or ePRA feature is supported, the PCF may remove the associated policy control request trigger (i.e. \"PRA_CH\") as defined in clause 4.2.6.4, if previously activated.\nIf the NF service consumer and the PCF support both PRA and ePRA features, the NF service consumer and PCF shall perform the behaviours as the ePRA feature defined.\nIf the \"PRA_CH\" policy control request trigger is provisioned, when the PCF provides a list of presence reporting areas as described above, the PCF shall ensure that the maximum number of provisioned Presence Reporting Area Identifiers is not exceeded. The maximum number of PRAs may be configured in the PCF. The PCF may have independent configuration of the maximum number for Core Network pre-configured PRAs and UE-dedicated PRAs.\nNOTE 4:\tFor all the Presence Reporting Area(s) provided by the PCF, the SMF can store the Presence Reporting Area Identifier(s) together with an indication that states that it relates to PCF requested PRA status changes.\nNOTE 5:\tThis information is needed so that if both the PCF and the CHF request the reporting of PRA status changes, the SMF is able to differentiate whether the reported PRA changes are relevant to the PCF or the CHF.\nThe SMF shall invoke the Namf_EventExposure service in the AMF to handle the subscription to the presence state of a UE in an area of interest as specified in 3GPP TS 29.518 [36].\nThe PCF may be notified during the lifetime of a PDU session that the targeted UE is located in an access network where local configuration indicates that reporting changes of UE presence in Presence Reporting Area(s) is not supported. The PCF may then remove the associated policy control request trigger (i.e. \"PRA_CH\"), if previously activated. In this case, the PCF shall also remove the provisioned Presence Reporting Area(s) by including the \"praInfos\" attribute set to NULL within the SmPolicyDecision data structure.\nThe SMF shall remove the Namf_EventExposure service subscription with the AMF for the reporting of Changes of UE presence in Presence Reporting Area(s), when the PCF and CHF remove the associated request triggers.\nIf the PCF receives the \"refQosIndication\" attribute set to true as defined in clauses 4.2.2.2 or 4.2.4.2, and if the PCF determines that Reflective QoS Control will be enabled for the PDU session based on the operator's policy and user subscriptions, the PCF may provision the Reflective QoS Timer by including the \"reflectiveQoSTimer\" attribute within the SmPolicyDecision data structure in the response message.\nThe provisioning of reflective QoS may be performed for service data flows associated with one or more PCC rules, and shall be performed using the PCC rule provisioning procedure. The PCF may within a QoS data decision which a PCC rule refer to include the \"reflectiveQos\" attribute set to true to enable the Reflective QoS control to a non-GBR downlink service data flow when the PCF authorizes the QoS for the service data flow as defined in clause 4.2.6.6.2.\nThe PCF shall ensure that both, uplink and downlink traffic for such non-GBR service data flow are allowed.\nNOTE 1:\tThe PCF can allow both uplink and downlink traffic for the non-GBR service data flow in several ways, e.g. by installing a PCC rule with uplink and downlink flow information, or by installing separate PCC rules for the uplink flows and downlink flows, or by installing a PCC rule with only the application identifier.\nThe PCF shall activate the reporting changes of reflective QoS indication by provisioning the \"REF_QOS_IND_CH\" policy control request trigger to the SMF.\nNOTE 2:\tWhile the UE applies a standardized value for the precedence of all UE derived QoS rules, PCC rules precedence values can vary and PCF configuration has to ensure that there is a large enough value range for the precedence of PCC rules corresponding to UE derived QoS rules. To avoid that the precedence of network provided QoS rules need to be changed when Reflective QoS is activated and filters are overlapping, the PCF will take the standardized value for the precedence of UE derived QoS rules into account and will setting the precedence value of PCC rules subject to Reflective QoS to a value in the range from 70 to 99 (decimal), as specified in 3GPP TS 24.501 [20], clause 6.2.5.1.1.3.\nThe SMF shall apply reflective QoS control for the downlink traffic of the service data flows of the PCC rules that reference a QosData decision that includes \"reflectiveQos\" attribute set to true.\nThe PCF shall not include the \"reflectiveQos\" attribute set to true within the QoS data decision which the PCC rule with match-all SDF template refers to. If a PCC rule with match-all SDF template has been provisioned to the SMF, the PCF shall not include the \"reflectiveQos\" attribute within the QoS data decision which contains the \"defQosFlowIndication\" attribute, either.\nIf the PCF receives the \"refQosIndication\" attribute set to false as defined in clause 4.2.4.2, the PCF shall disable the reflective QoS Control for the PDU session. In order to do so, the PCF shall within the QoS data decision which affected PCC rule refer to include the \"reflectiveQos\" attribute set to false and may update other QoS parameters within the QoS data decision and/or update the flow information of PCC rule by including the \"packetFilterUsage\" attribute set to true.\nThe PCF shall provision the authorized QoS. The authorized QoS may apply to a PCC rule or to a PDU session.\n-\tWhen the authorized QoS applies to a PCC rule, it shall be provisioned within the corresponding PCC rule as defined in clause 4.2.6.6.2.\n-\tWhen the authorized QoS for a PCC rule with a GBR QCI is candidate for resource sharing an instruction on the allowed sharing may be provisioned as defined in clause 4.2.6.2.8.\n-\tWhen the authorized QoS applies to a PDU session, it shall be provisioned as defined in clause 4.2.6.3.1.\n-\tWhen the authorized QoS applies to the default QoS flow, it shall be provisioned as defined in clause 4.2.6.3.1.\n-\tWhen the authorized QoS applies to an explicitly signalled QoS Characteristics, it shall be provisioned as defined in clause 4.2.6.6.3.\n-\tWhen the authorized QoS applies to the Reflective QoS, it shall be provisioned as defined in clause 4.2.6.5.7.\nThe authorized QoS provides appropriate values for the resources to be enforced. The authorized QoS for a PCC rule is a request for allocating the corresponding resources. The Provisioning of authorized QoS per PCC rule is a part of PCC rule provisioning procedure.\nIf the SMF cannot allocate any of the resources as authorized by the PCF, the SMF informs the PCF and acts as described in clauses 4.2.3.16 and 4.2.4.15.\nThe SMF shall interact with the (R)AN, UPF and UE for enforcing the policy based authorization.\nQoS authorization information may be dynamically provisioned by the PCF or it may be a pre-defined PCC rule in the SMF. Moreover, all the parameters of the authorized QoS may be changed.\nNOTE 1:\tA change of 5QIs cannot be described as an upgrade or downgrade and also no 5QI can be referred to as the higher or lower. Whether the 5QI is permitted to be changed or not is subject to both operator policies and normal restrictions on changing from a non-GBR 5QI value to GBR 5QI value on an IP flow.\nNOTE 2:\tAll attributes of the ARP QoS parameter can be changed but only the ARP priority level represents an ordered range of values. The ARP priority level attribute represents the actual priority for the service/user with the value 1 as the highest and can thus be upgraded and downgraded.\nIf the PCF is unable to make a decision for the response to the HTTP POST message by the SMF, the PCF may reject the request as described in clause 5.7.\nThe Provisioning of authorized QoS per service data flow is a part of PCC rule provisioning procedure, as described in clause 4.2.6.2.1.\nThe authorized QoS per service data flow shall be provisioned within a QosData data structure. The PCF shall include a \"qosDecs\" attribute containing the corresponding QoS data decision within the SmPolicyDecision data structure and include the reference to this QoS data decision within the \"refQosData\" attribute of the PccRule data instance.\nWhen network slice data rate policy control applies and the authorized QoS per service data flow refers to a 5QI of GBR type, the PCF shall derive the authorized QoS per service data flow as described in clause 4.2.6.8.\nWithin the QoS data decision, for 5QI of GBR type or delay critical GBR type, the PCF shall include the authorized GBR 5QI or delay critical GBR 5QI respectively within the \"5qi\" attribute, the ARP within the \"arp\" attribute, and max bandwidth in uplink within the \"maxbrUl\" attribute and/or max bandwidth in downlink within the \"maxbrDl\" attribute, the guaranteed bandwidth in uplink within the \"gbrUl\" attribute and/or the guaranteed bandwidth in downlink within the \"gbrDl\" attribute. If the PCF determines that the application traffic can be adapted to the change in the QoS based on the configuration (e.g. if the AF is capable to trigger rate adaptation), the PCF may request a notification when authorized GBR or delay critical GBR cannot be guaranteed or can be guaranteed again by including the \"qnc\" attribute set to true.\nWithin the QoS data decision, for 5QI of non-GBR type, the PCF shall include the authorized non-GBR 5QI within the \"5qi\" attribute and the ARP within the \"arp\" attribute. The PCF may authorize the max bandwidth in uplink within the \"maxbrUl\" attribute and/or max bandwidth in downlink within the \"maxbrDl\" attribute.\nWhen the PCF authorizes a standardized 5QI but a Priority Level, an Averaging Window and/or a Maximum Data Burst Volume which are different from the standardized value in the table 5.7.4-1 of 3GPP TS 23.501 [2] are required, the PCF shall include the Priority Level within the \"priorityLevel\" attribute, the Averaging Window within the \"averWindow\" attribute and/or the Maximum Data Burst Volume within the \"maxDataBurstVol\" attribute or the \"extMaxDataBurstVol\" attribute (if supported, see clause 4.2.2.1).\nNOTE 1:\tFor the non-standardized or non-configured 5QI, the PCF needs to authorize explicitly signalled QoS Characteristics associated with the 5QI if the PCF has not provisioned it.\nIf the configured policy allows at reception of the service information from the AF and the application of the rules of the QoS mapping procedures defined in 3GPP TS 29.513 [7] clause 7.3.2 for the received service information result in a 5QI of 1 associated with the corresponding flows, and the RAN-Support-Info feature as defined clause 5.8 is supported, the PCF shall determine the Maximum Packet Loss Rate for UL and DL for those flows associated within 5QI of 1. In this case, the PCF shall include the value of Maximum Packet Loss Rate for UL within the \"maxPacketLossRateUl\" attribute and/or the value of Maximum Packet Loss Rate for DL within the \"maxPacketLossRateDl\" attribute.\nNOTE 2:\tIf CHEM feature is supported, then PCF as described in clause 7.2.3 of 3GPP TS 29.513 [7] or based on local configuration, the PCF sets the downlink and uplink maximum packet loss rates corresponding to either the most robust codec mode or the least robust codec mode of the negotiated set in each direction.\nIf the PCF wants to ensure that a PCC Rule is always bound to the default QoS flow, the policy provisioning for the related authorized QoS shall be done as described in clause 4.2.6.2.10.\nThe SMF shall perform a QoS flow binding based on the QoS information within the Qos data decision as defined in clause 6.4 of 3GPP TS 29.513 [7] after the SMF installs or activates the PCC rules.\nThe SMF shall reserve the resources necessary for the guaranteed bitrate for the PCC rule upon receipt of a PCC rule provisioning including QoS information. For GBR QoS flows the SMF should set the QoS flow's GBR to the sum of the GBRs of all PCC rules that are active/installed and bound to that GBR QoS flow. For GBR QoS flow the SMF should set the QoS flow's MBR to the sum of the MBRs of all PCC rules that are active/installed and bound to that GBR QoS flow.\nNOTE 3:\tSince the PCF controls the GBR value in the PCC rule, the PCF can prevent that uplink GBR resources are reserved by providing an uplink GBR value of zero for that PCC rule. This may be useful e.g. for a PCC rule with application identifier as the uplink traffic can be received in other QoS flow than the one the PCC rule is bound to.\nThe SMF shall assign a QFI if a new QoS flow needs to be established and shall derive, if applicable, the QoS profile required towards the Access Network,  the QoS rule required towards the UE and the QoS information with PDRs towards to the UPF. If multiple PCC rules with the Maximum Packet Loss Rate for UL and DL are bound to the same QoS flow, the SMF shall choose the lowest value per direction related to the PCC rules within the QoS profile towards to the access network.\nFor PIN scenarios (defined in 3GPP TS 23.501 [2], clause 5.44), the SMF may, for a (S-NSSAI, DNN) combination of the PDU Session, increase the CN PDB in the derived QoS profile corresponding to a GBR flow if the UE requested non-3GPP delay budget as part of a UE-initiated resource modification procedure based on operator policy and implementation.\nNOTE 4:\tThe non-3GPP delay budget does not impact the QoS flow binding as defined in clause 6.4 in 3GPP TS 29.513 [7].\nIf one or more of the 5QI, ARP, QNC, Priority level, Averaging Window and Maximum Data Burst Volume attributes of a PCC rule are modified to the same updated values for all the PCC rules bound to the same QoS flow, then the SMF should modify the corresponding attributes for that impacted QoS flow.\nUpon deactivation or removal of a PCC rule, the SMF shall free the resources reserved for that PCC rule, and initiate the corresponding procedure with access network, UE and UPF to remove the resources.\nThe PCF may provision a dynamically assigned 5QI value (from the non-standardized and non-preconfigured value range) and the associated 5G QoS characteristics to the SMF. In order to do so, the PCF shall include within the SmPolicyDecision data structure the \"qosChars\" attribute to contain one or more authorized signalled QosCharacteristics instance(s). For each QosCharacteristics instance, the PCF shall include the assigned 5QI value within the \"5qi\" attribute, the resource type value within the \"resourceType\" attribute, the 5QI Priority Level value within the \"priorityLevel\" attribute, the Packet Delay Budget value within the \"packetDelayBudget\" attribute, the Packet Error Rate value within the \"packetErrorRate\" attribute, the Averaging Window value within the \"averagingWindow\" attribute, if applicable, and the Maximum Data Burst Volume value within the \"maxDataBurstVol\" attribute or the \"extMaxDataBurstVol\" attribute (if supported, see clause 4.2.2.1), if applicable. If the PCF has provisioned an authorized signalled QosCharacteristics instance to the SMF, the PCF shall not update nor remove it during the lifetime of the policy association.\nUpon receiving the authorized explicitly signalled QoS characteristics, the SMF shall derive the QoS profile for the access network and provide it to the access network by invoking the corresponding procedure.\nNOTE 1:\tThe SMF can increase the Packet Delay Budget in the QoS profile in PIN scenarios as a result of a UE-requested PDU session modification procedure for certain (S-NSSAI, DNN) combination and signal it to the access network(defined in 3GPP TS 23.501 [2], clause 5.44.3.4).\nNOTE 2:\tOperator configuration is assumed to ensure that the assigned dynamic 5QI value is unique and references the same set of QoS characteristics within the whole PLMN at a given time.\nThe PCF can support monitoring of data rate per S-NSSAI for a UE.\nDuring PDU session establishment, if the PCF supports monitoring of the data rate per S-NSSAI for a UE, the PCF may retrieve for the UE and S-NSSAI to which the PDU session is allocated the Subscribed UE-Slice-MBR (i.e. the aggregate data rate that can be expected to be provided across all GBR and Non-GBR QoS Flows of a UE for a network slice identified by an S-NSSAI) from the UDR as defined in clause 5.4.2.14 of 3GPP TS 29.519 [15]. The PCF shall monitor the data rate for this S-NSSAI and UE by deriving the utilized data rate based on the authorized Session-AMBR and/or the authorized QoS per service data flow in all PDU session(s) established for the UE in the concerned S-NSSAI and checking the derived value against the UE-Slice-MBR set by the PCF based on the Subscribed UE-Slice-MBR value retrieved from the UDR and operator policies available at the PCF.\nAs part of the PDU session modification procedure(s) targeting the PDU session(s) established for the UE in the concerned S-NSSAI, whenever the PCF needs to provide the associated authorized Session-AMBR(s), install new or updated PCC Rule(s) and/or delete PCC Rule(s) related to GBR service data flow(s), the PCF shall calculate the utilized data rate as described in clause 4.2.6.8.2.\nAt the termination of a PDU session established for the UE in the concerned S-NSSAI, the PCF shall adjust the utilized data rate for the UE based on the release of the Session-AMBR and the removal of all the PCC Rule(s) related to GBR service data flow(s) associated to that PDU session.\nTo enable this monitoring, the SMF shall select the same PCF instance for all PDU sessions of the UE to the S-NSSAI that is subject to this monitoring as defined in clause 8.3 of 3GPP TS 29.513 [7].\nWhen the calculated utilized data rate for the S-NSSAI and UE reaches a certain percentage of the Subscribed UE-Slice-MBR value, the PCF may apply a policy decision to strengthen the traffic restrictions for individual PDU session(s) or PCC rule(s) (e.g. change the authorized Session-AMBR as defined in clause 4.2.6.3.1, change the authorized QoS per service data flow as defined in clause 4.2.6.6.2, or change the charging keys) within individual PDU session(s) established for the UE in the concerned S-NSSAI. When the calculated utilized data rate per S-NSSAI for a UE falls below that percentage of the Subscribed UE-Slice-MBR value, the PCF may relax the traffic restrictions for individual PDU session(s) or PCC rule(s) within individual PDU session(s) established for the UE in the concerned S-NSSAI.\nAs part of the policy decision to strengthen the traffic restrictions for individual PDU session(s), the PCF may reject the establishment or SMF-initiated modification of the associated SM Policy Association(s) with an HTTP \"403 Forbidden\" response message including the \"cause\" attribute of the ProblemDetails data structure set to \"EXCEEDED_UE_SLICE_DATA_RATE\".\nNOTE:\tIt is recommended to avoid frequent policy decisions which trigger a signalling with the UE (like change of the authorized Session-AMBR or change of the authorized QoS per service data flow).\nA PCF that supports network slice related data rate policy control shall be able to control and manage the network slice data rate.\nA Maximum Slice Data Rate may be configured by the operator (e.g. based on an SLA related to the associated network slice identified by an S-NSSAI).\nNOTE 1:\tThe Maximum Slice Data Rate defines the maximum allowed aggregate data rate across all GBR and Non-GBR QoS Flows within the network slice identified by an S-NSSAI as defined in 3GPP TS 29.519 [15].\nNOTE 2:\tThe maximum data rate of Non-GBR QoS Flow(s) is controlled via the authorized Session-AMBR, while the maximum data rate of a GBR QoS Flow is controlled via the authorized MBR value of the associated PCC rule.\nThe PCF shall determine, based on local configuration, if the network slice data rate is controlled via PCF-based monitoring by using QoS parameters or with assistance of the NWDAF.\nThe PCF shall monitor the data rate of the network slice and ensure that it does not exceed the Maximum Slice Data Rate for that network slice by e.g. rejecting new SM Policy Associations, changing the authorized Session-AMBR values (if allowed by the HPLMN), changing the MBR values in PCC rules belonging to GBR service data flows or other actions depending on operator's policies.\nNOTE 3:\tBased on operator's policies, it is also possible for the PCF to accept that new PDU session(s) or PCC rule(s) belonging to GBR service data flow(s) lead to exceeding the Maximum Slice Data Rate and apply a different charging for them. Once the Maximum Slice Data Rate is no longer exceeded, the PCF can decide to go back to applying the previous charging.\nNOTE 4:\tSubject to operator policy and national/regional regulations, prioritised services and emergency services may be exempted from network slice data rate policy control.\nNOTE 5:\tA single PCF can be used for the monitoring and limitation of the network slice related data rate. To enable this, the SMF has to select the same PCF instance for all PDU Sessions of the UE to the S-NSSAI.\nIf the NWDAF is not deployed or not used for network slice data rate policy control and PCF-based monitoring of network slice data rate by using QoS parameters applies, the UDR shall maintain the Remaining Maximum Slice Data Rate per S-NSSAI as part of the network slice specific policy control data as defined in 3GPP TS 29.519 [15].\nWhenever the PCF needs to calculate the data rate related to authorized Session-AMBR and/or the MBR(s) of the GBR Service Data Flow(s), the PCF shall obtain the Remaining Maximum Slice Data Rate by interacting with the UDR as defined in 3GPP TS 29.519 [15]. When the PCF interacts with the UDR may be based on operator policies.\nWhen the PCF needs to provide the authorized Session-AMBR and/or install new or updated PCC Rule(s) and/or delete PCC Rule(s) related to GBR service data flow(s), the PCF shall:\n-\tcalculate the difference between the previously authorized Session-AMBR, if applicable, and the new authorized Session-AMBR; and/or\n-\tcalculate the difference between the previously authorized MBR and the new authorized MBR(s) for the authorized PCC Rule(s) related to GBR service data flow(s);\nAnd then:\n-\tCalculate the utilized data rate, i.e. the sum of the previously calculated differences, which is to be substracted from the Remaining Maximum Slice Data rate.\nNOTE 1:\tFor example, when the PCF modifies as part of the same operation the MBR of PCC Rule A from 100 to 150 and the MBR of PCC Rule B from 30 to 20, deletes PCC Rule C with an MBR of 50 and adds a PCC Rule D of MBR 75, the final calculated value will be +50-10-50+75, i.e. 65. If the authorized Session-AMBR is also updated from 1000 to 2000, the final derived value will be 1065.\nNOTE 2:\tThe utilized data rate can be a negative value. In this case, the final Remaining Maximum Slice Data Rate is increased.\nTherefore, the PCF shall behave as follows:\n-\tAt PDU session establishment, the PCF shall check whether the Remaining Maximum Slice Data Rate is higher than the calculated utilized data rate (e.g. based on the authorized Session-AMBR). If it is the case, the PCF shall deduct the value of the utilized data rate from the Remaining Maximum Slice Data Rate for the concerned S-NSSAI in the UDR. If however the Remaining Maximum Slice Data Rate is not sufficient, the PCF may reject the establishment of the SM Policy Association with an HTTP \"403 Forbidden\" response message including the \"cause\" attribute of the ProblemDetails data structure set to \"EXCEEDED_SLICE_DATA_RATE\".\n-\tAt PDU session modification initiated by the SMF, the PCF shall check whether the Remaining Maximum Slice Data Rate is higher than the calculated utilized data rate (e.g. based on the authorized Session-AMBR). If it is the case, the PCF shall deduct the value of the utilized data rate from the Remaining Maximum Slice Data Rate for the concerned S-NSSAI in the UDR. If however the Remaining Maximum Slice Data Rate is not sufficient, the PCF may reject the modification of the SM Policy Association with an HTTP \"403 Forbidden\" response message including the \"cause\" attribute of the ProblemDetails data structure set to \"EXCEEDED_SLICE_DATA_RATE\".\n-\tWhen a PCC rule of a GBR service data flow is installed, modified, removed, activated or deactivated in the SMF,\n-\tthe PCF shall derive the authorized QoS for the service data flow and the associated utilized data rate and update the Remaining Maximum Slice Data Rate for the concerned S-NSSAI in the UDR accordingly;\n-\tthe PCF may request the SMF to confirm that the resources associated to that PCC rule are successfully allocated as defined in clause 4.2.6.5.5 or released as defined in clauses 4.2.3.13 and 4.2.4.12;\n-\tif the SMF reports that some of or all the resources cannot be successfully allocated, the PCF shall recalculate the authorized QoS for the service data flow and the associated utilized data rate and update the Remaining Maximum Slice Data Rate for the concerned S-NSSAI in the UDR accordingly.\n-\tWhen the authorized Session-AMBR changes and/or one or several PCC Rule(s) of a GBR service data flow(s) are installed, removed or modified, the PCF shall calculate the new utilized data rate and update the Remaining Maximum Slice Data Rate for that S-NSSAI in the UDR accordingly.\n-\tAt PDU session termination, the PCF shall add the value of the related previously utilized data rate (i.e. based on the authorized Session-AMBR allocated to the PDU session and the previously utilized data rate by the removed PCC Rule(s) related to GBR service data flow(s)) to the Remaining Maximum Slice Data Rate for the concerned S-NSSAI in the UDR.\n-\tIf the Remaining Maximum Slice Data Rate for that S-NSSAI reaches a (operator defined) threshold that indicates that it is closer or equal to zero, the PCF may apply policy decision(s) to strengthen the traffic restrictions for the concerned PDU Session(s).\n-\tIf the Remaining Maximum Slice Data Rate for that S-NSSAI returns to a value below the (operator defined) threshold, the PCF may apply policy decision(s) to recover the initially derived value(s) for the concerned PDU Session(s).\nNOTE 3:\tWhile the Remaining Maximum Slice Data Rate is relatively high, the PCF can be configured to maintain a local Remaining Maximum Slice Data Rate and to only interact with the UDR to update the Remaining Maximum Slice Data Rate when a certain threshold is reached, or a certain time window has passed. The higher the configured values are the lower the chances for an accurate limitation of the slice data rate becomes. When multiple PCFs for the same S-NSSAI are deployed, each PCF can also subscribe to the change of the Network slice specific policy control data in the UDR. The UDR will then send a notification to each subscribed PCF when the Remaining Maximum Slice Data Rate per S-NSSAI changes.\nNOTE 4:\tMultiple PCFs responsible for PDU Sessions of UEs to the same S-NSSAI can read and update the Remaining Maximum Slice Data Rate for the S-NSSAI in the UDR using the conditional requests with preconditions for the update of the Remaining Maximum Slice Data Rate, this mechanism using Etags is defined in Table 5.2.2.2-2 of 3GPP TS 29.500 [4] to ensure a proper update of the UDR data in case of simultaneous access from different PCFs.\nIf the NWDAF is used for network slice data rate policy control, the PCF uses the Data Volume Dispersion Analytics provided by the NWDAF. For this purpose, the PCF subscribes to the NWDAF for periodic reporting of the Data Volume Dispersion Analytics statistics for all the UEs using the concerned network slice. The PCF subscribes to the NWDAF for Data Volume Dispersion Analytics reporting at the establishment of the first PDU session within the concerned S-NSSAI (subject to network slice data rate limitation) and cancels this subscription at the termination of the last PDU session within the concerned S-NSSAI as described in 3GPP TS 29.520 [51].\nThe PCF calculates the utilized data rate of the S-NSSAI by using the Data Volume Dispersion Analytics statistics reported by the NWDAF. When the utilized data rate of the S-NSSAI in UL and/or DL is getting close to or exceeding respectively the value of the \"mbrUl\" attribute and/or the value of the \"mbrDl\" attribute of the SlicePolicyData data structure as defined in 3GPP TS 29.519 [15], based on operator policy, the PCF may apply policy decision(s) to strengthen the traffic restrictions for individual PDU sessions and/or PCC rules. For example:\n-\tThe PCF may reject the creation or modification of SM Policy Associations that require the increase of the utilized data rate for the S-NSSAI with an HTTP \"403 Forbidden\" response message including the \"cause\" attribute of the ProblemDetails data structure set to \"EXCEEDED_SLICE_DATA_RATE\".\n-\tThe PCF may refrain from sending new and/or updated PCC Rules that require the increase of the utilized data rate.\nWhen the utilized data rate of the S-NSSAI in UL and/or DL falls below respectively the value of the \"mbrUl\" attribute and/or the value of the \"mbrDl\" attribute of the SlicePolicyData data structure, the PCF may relax the traffic restrictions for individual PDU sessions and/or PCC rules.\nWhen multiple PCFs for the same S-NSSAI are deployed, each PCF subscribes to the analytics from the NWDAF separately.\nNOTE:\tWhen multiple PCFs are used for the concerned S-NSSAI, the NWDAF triggers Data Volume Dispersion Analytics notifications towards all these PCFs, but their policy decisions can be different.4.2.7\tDetection and handling of late arriving requests\nA PCF that supports group related data rate policy control shall be able to control and manage the group data rate for 5G VN groups. In order to do so, the PCF shall perform the same procedures as the ones defined for network slice related data rate policy control defined in clauses 4.2.6.8 for the PDU session(s) of the UE(s) belonging to a 5G VN group, with the following differences:\n-\tOnly the PCF-based method shall be applicable for group related data rate policy control, i.e., the provisions of clause 4.2.6.8.3 shall not apply for group related data rate policy control.\n-\tThe provisions related to slice related data rate policy control for an S-NSSAI shall apply for group related data rate policy control for a 5G VN Group.\n-\tInstead of configuring the Maximum Slice Date Rate per S-NSSAI by the operator, the Maximum Group Data Rate per 5G VN Group is either provisioned by the AF to the UDR (for \"Subscription Data\") via the NEF/UDM as part of the 5G VN group subscription data using the procedures defined in 3GPP TS 29.522 [59] and 3GPP TS 29.503 [34] and/or configured by the operator. When the Maximum Group Data Rate is provisioned by the AF, the PCF shall retrieve it from the UDR (for \"Subscription Data\").\n-\tInstead of handling the Remaining Maximum Slice Data Rate per S-NSSAI, the UDR and PCF shall handle the Remaining Maximum Group Data Rate per 5G VN Group.\n-\tInstead of calculating the utilized data rate based on the value(s) of the authorized Session-AMBR and the MBR of every GBR SDF for every PDU Session of a network slice identified by an S-NSSA, the PCF shall calculate the utilized data rate based on the value(s) of the authorized Session-AMBR and the MBR of every GBR SDF for every PDU Session of the concerned 5G VN Group.\n-\tInstead of returning the \"EXCEEDED_SLICE_DATA_RATE\" application error, the PCF shall return the \"EXCEEDED_GROUP_DATA_RATE\" application error within the \"403 Forbidden\" error response.\nMulti-modal services consist of several data flows (named as multi-modal flows) that relate to each other and may come from different sources. Each data flow (single-modal data) may be seen as one type of data (for example audio, video, positioning, haptic data) associated with the same communication service.\nThe provision of PCC Rules corresponding to multi-modal services shall be performed as described in clause 4.2.6.2.1 \"Provisioning of PCC rules\".\nFor the delivery of multi-modal services, the PCF shall:\n-\tderive the applicable PCC rule(s) and apply the required QoS as described in clause 4.2.3.22. The PCF may use the multi-modal Id received from the AF (either directly or via NEF), as specified in 3GPP TS 29.514 [17], to derive the correct PCC rules and apply QoS policies; and\n-\twhen the received multi-modal service requirements include QoS monitoring rquirements, generate the authorized QoS Monitoring policy for each flow as described in clause 4.2.3.25. The PCF shall use the QoS monitoring requirement received from the AF (either directly or via NEF), as specified in 3GPP TS 29.514 [17].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.7\tHandling of requests which collide with an existing SM Policy Association",
                            "text_content": "The PCF may receive an Originating Time Stamp parameter within the 3gpp-Sbi-Origination-Timestamp header, which is set by the AMF, by the Npcf_SMPolicyControl_Create service request.\nNOTE 1:\tThe SMF forwards the Origination Time Stamp to the PCF, when received from the AMF to allow the handling of colliding requests at the PCF based on network conditions.\nUpon receipt of a Npcf_SMPolicyControl_Create service request which collides with an existing SM Policy Association for the same UE (i.e. same values of \"supi\" attribute) and the same PDU session Id (i.e. same values of \"pduSessionId\" attribute), the PCF shall accept the new request only if it contains a more recent timestamp within the 3gpp-Sbi-Origination-Timestamp header than the origination timestamp stored for the existing SM Policy Association. An incoming Npcf_SMPolicyControl_Create service request shall be considered as more recent than an existing SM Policy Association and be accepted if no 3gpp-Sbi-Origination-Timestamp header was provided for at least one of the two SM Policy Associations. The PCF shall reject an incoming request whose timestamp is less recent than the timestamp of the existing SM Policy Association with the HTTP status code \"403 Forbidden\" and the application error \"LATE_OVERLAPPING_REQUEST\".\nNOTE 2:\tWhen the PCF accepts the new request that contains a more recent timestamp within the 3gpp-Sbi-Origination-Timestamp header than the timestamp stored for the SM Policy Association, the PCF performs implementation specific, e.g. locally deletes the existing Individual SM Policy Association.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.8\tUE IP address support",
                            "text_content": "As specified in 3GPP TS 23.501 [2], the following types of UE IP addresses may be assigned to a PDU session and may be received by the PCF:\n-\tIPv4 address; and/or\n-\t/64 IPv6 Prefix; or\n-\tIPv6 prefix shorter than the default /64 prefix when IPv6 Prefix Delegation applies.\nMore than one UE IP addresses may be assigned to a PDU session, as specified in clause 4.2.4.11.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "5\tNpcf_SMPolicyControl Service API",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "The Npcf_SMPolicyControl Service shall use the Npcf_SMPolicyControl API.\nThe API URI of the Npcf_SMPolicyControl API shall be:\n{apiRoot}/<apiName>/<apiVersion>\nThe request URIs used in HTTP request from the NF service consumer towards the PCF shall have the Resource URI structure defined in clause 4.4.1 of 3GPP TS 29.501 [5], i.e.:\n{apiRoot}/<apiName>/<apiVersion>/<apiSpecificResourceUriPart>\nwith the following components:\n-\tThe {apiRoot} shall be set as described in 3GPP TS 29.501 [5].\n-\tThe <apiName> shall be \"npcf-smpolicycontrol\".\n-\tThe <apiVersion> shall be \"v1\".\n-\tThe <apiSpecificResourceUriPart> shall be set as described in clause 5.3.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.2\tUsage of HTTP",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tGeneral",
                            "text_content": "HTTP/2, IETF RFC 9113 [8], shall be used as specified in clause 5 of 3GPP TS 29.500 [4].\nHTTP/2, shall be transported as specified in clause 5.3 of 3GPP TS 29.500 [4].\nAn OpenAPI [10] specification of HTTP messages and content bodies for the Npcf_SMPolicyControl is contained in Annex A.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tHTTP standard headers",
                            "text_content": "See clause 5.2.2 of 3GPP TS 29.500 [4] for the usage of HTTP standard headers.\nJSON, IETF RFC 8259 [9], shall be used as content type of the HTTP bodies specified in the present specification as specified in clause 5.4 of 3GPP TS 29.500 [4]. The use of the JSON format shall be signalled by the content type \"application/json\".\n\"Problem Details\" JSON object shall be used to indicate additional details of the error in a HTTP response body and shall be signalled by the content type \"application/problem+json\", as defined in IETF RFC 9457 [31].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.3\tHTTP custom headers",
                            "text_content": "The Npcf_SMPolicyControl API shall support HTTP custom header fields specified in clause 5.2.3.2 of 3GPP TS 29.500 [4] and may support HTTP custom header fields specified in clause 5.2.3.3 of 3GPP TS 29.500 [4].\nThe header contains the date and time (with a millisecond granularity) when the originating entity initiated the request as specified in clause 6.1.2.3.2 of 3GPP TS 29.502 [22].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tResources",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tResource Structure",
                            "text_content": "The figure depicts the resource URI structure of the Npcf_SMPolicyControl API, which is used to manage policy control in a network. The structure includes the resource URI, which is a unique identifier for the policy control resource, and the policy control resource itself, which is a set of policies that can be applied to the network. The figure provides a visual representation of the API's structure, making it easier to understand and use.\nFigure 5.3.1-1: Resource URI structure of the Npcf_SMPolicyControl API\nTable 5.3.1-1 provides an overview of the resources and applicable HTTP methods.\nTable 5.3.1-1: Resources and methods overview\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.3.1-1: Resources and methods overview",
                                    "table number": 3,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.3.2\tResource: SM Policies",
                            "text_content": "This resource represents the collection of the individual SM Policies created in the PCF.\nResource URI: {apiRoot}/npcf-smpolicycontrol/v1/sm-policies\nThis resource shall support the resource URI variables defined in table 5.3.2.2-1.\nTable 5.3.2.2-1: Resource URI variables for this resource\n\nThis method shall support the URI query parameters specified in table 5.3.2.3.1-1.\nTable 5.3.2.3.1-1: URI query parameters supported by the POST method on this resource\n\nThis method shall support the request data structures specified in table 5.3.2.3.1-2 and the response data structures and response codes specified in table 5.3.2.3.1-3.\nTable 5.3.2.3.1-2: Data structures supported by the POST Request Body on this resource\n\nTable 5.3.2.3.1-3: Data structures supported by the POST Response Body on this resource\n\nTable 5.3.2.3.1-4: Headers supported by the 201 Response Code on this resource\n\nTable 5.3.2.3.1-5: Headers supported by the 308 Response Code on this resource\n\nNone.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.3.2.2-1: Resource URI variables for this resource",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.2.3.1-1: URI query parameters supported by the POST method on this resource",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.2.3.1-2: Data structures supported by the POST Request Body on this resource",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.2.3.1-3: Data structures supported by the POST Response Body on this resource",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.2.3.1-4: Headers supported by the 201 Response Code on this resource",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.2.3.1-5: Headers supported by the 308 Response Code on this resource",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.3.3\tResource: Individual SM Policy",
                            "text_content": "The individual SM Policy resource represents an individual SM Policy created in the PCF and associated with the SUPI and PDU session ID.\nResource URI: {apiRoot}/npcf-smpolicycontrol/v1/sm-policies/{smPolicyId}\nThis resource shall support the resource URI variables defined in table 5.3.3.2-1.\nTable 5.3.3.2-1: Resource URI variables for this resource\n\nThis method shall support the URI query parameters specified in table 5.3.3.3.1-1.\nTable 5.3.3.3.1-1: URI query parameters supported by the GET method on this resource\n\nThis method shall support the request data structures specified in table 5.3.3.3.1-2 and the response data structures and response codes specified in table 5.3.3.3.1-3.\nTable 5.3.3.3.1-2: Data structures supported by the GET Request Body on this resource\n\nTable 5.3.3.3.1-3: Data structures supported by the GET Response Body on this resource\n\nTable 5.3.3.3.1-4: Headers supported by the 307 Response Code on this resource\n\nTable 5.3.3.3.1-5: Headers supported by the 308 Response Code on this resource\n\nTable 5.3.3.4.1-1: Custom operations\n\nThis custom operation deletes an individual SM Policy resource in the PCF.\nThis operation shall support the request data structures specified in table 5.3.3.4.2.2-1 and the response data structure and response codes specified in table 5.3.3.4.2.2-2.\nTable 5.3.3.4.2.2-1: Data structures supported by the POST Request Body on this resource\n\nTable 5.3.3.4.2.2-2: Data structures supported by the POST Response Body on this resource\n\nTable 5.3.3.4.2.2-3: Headers supported by the 307 Response Code on this resource\n\nTable 5.3.3.4.2.2-4: Headers supported by the 308 Response Code on this resource\n\nThis custom operation updates an individual SM Policy resource in the PCF.\nThis operation shall support the request data structures specified in table 5.3.3.4.3.2-1 and the response data structure and response codes specified in table 5.3.3.4.3.2-2.\nTable 5.3.3.4.3.2-1: Data structures supported by the POST Request Body on this resource\n\nTable 5.3.3.4.3.2-2: Data structures supported by the POST Response Body on this resource\n\nTable 5.3.3.4.3.2-3: Headers supported by the 307 Response Code on this resource\n\nTable 5.3.3.4.3.2-4: Headers supported by the 308 Response Code on this resource\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.3.3.2-1: Resource URI variables for this resource",
                                    "table number": 10,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.3.1-1: URI query parameters supported by the GET method on this resource",
                                    "table number": 11,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.3.1-2: Data structures supported by the GET Request Body on this resource",
                                    "table number": 12,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.3.1-3: Data structures supported by the GET Response Body on this resource",
                                    "table number": 13,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.3.1-4: Headers supported by the 307 Response Code on this resource",
                                    "table number": 14,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.3.1-5: Headers supported by the 308 Response Code on this resource",
                                    "table number": 15,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.4.1-1: Custom operations",
                                    "table number": 16,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.4.2.2-1: Data structures supported by the POST Request Body on this resource",
                                    "table number": 17,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.4.2.2-2: Data structures supported by the POST Response Body on this resource",
                                    "table number": 18,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.4.2.2-3: Headers supported by the 307 Response Code on this resource",
                                    "table number": 19,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.4.2.2-4: Headers supported by the 308 Response Code on this resource",
                                    "table number": 20,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.4.3.2-1: Data structures supported by the POST Request Body on this resource",
                                    "table number": 21,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.4.3.2-2: Data structures supported by the POST Response Body on this resource",
                                    "table number": 22,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.4.3.2-3: Headers supported by the 307 Response Code on this resource",
                                    "table number": 23,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.3.3.4.3.2-4: Headers supported by the 308 Response Code on this resource",
                                    "table number": 24,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "5.4\tCustom Operations without associated resources",
                    "description": "",
                    "summary": "",
                    "text_content": "None.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.5\tNotifications",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.5.1\tGeneral",
                            "text_content": "Table 5.5.1-1: Notifications\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.5.1-1: Notifications",
                                    "table number": 25,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.5.2\tPolicy Update Notification",
                            "text_content": "This notification is used by the PCF to update the policy.\nThis operation shall support the request data structures specified in table 5.5.2.2-1 and the response data structure and response codes specified in table 5.5.2.2-2.\nTable 5.5.2.2-1: Data structures supported by the POST Request Body on this resource\n\nTable 5.5.2.2-2: Data structures supported by the POST Response Body on this resource\n\nTable 5.5.2.2-3: Headers supported by the 307 Response Code on this resource\n\nTable 5.5.2.2-4: Headers supported by the 308 Response Code on this resource\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.5.2.2-1: Data structures supported by the POST Request Body on this resource",
                                    "table number": 26,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.5.2.2-2: Data structures supported by the POST Response Body on this resource",
                                    "table number": 27,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.5.2.2-3: Headers supported by the 307 Response Code on this resource",
                                    "table number": 28,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.5.2.2-4: Headers supported by the 308 Response Code on this resource",
                                    "table number": 29,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.5.3\tRequest for termination of the policy association",
                            "text_content": "This notification is used by the PCF to request the termination of a policy association.\nThis operation shall support the request data structures specified in table 5.5.3.2-1 and the response data structure and response codes specified in table 5.5.3.2-2.\nTable 5.5.3.2-1: Data structures supported by the POST Request Body on this resource\n\nTable 5.5.3.2-2: Data structures supported by the POST Response Body on this resource\n\nTable 5.5.3.2-3: Headers supported by the 307 Response Code on this resource\n\nTable 5.5.3.2-4: Headers supported by the 308 Response Code on this resource\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.5.3.2-1: Data structures supported by the POST Request Body on this resource",
                                    "table number": 30,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.5.3.2-2: Data structures supported by the POST Response Body on this resource",
                                    "table number": 31,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.5.3.2-3: Headers supported by the 307 Response Code on this resource",
                                    "table number": 32,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.5.3.2-4: Headers supported by the 308 Response Code on this resource",
                                    "table number": 33,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "5.6\tData Model",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.6.1\tGeneral",
                            "text_content": "This clause specifies the application data model supported by the API.\nThe Npcf_SMPolicyControl API allows the NF service consumer to retrieve the session management related policy from the PCF as defined in 3GPP TS 23.503 [6].\nTable 5.6.1-1 specifies the data types defined for the Npcf_SMPolicyControl service based interface protocol.\nTable 5.6.1-1: Npcf_SMPolicyControl specific Data Types\n\nTable 5.6.1-2 specifies data types re-used by the Npcf_SMPolicyControl service based interface protocol from other specifications, including a reference to their respective specifications and when needed, a short description of their use within the Npcf_SMPolicyControl service based interface.\nTable 5.6.1-2: Npcf_SMPolicyControl re-used Data Types\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.6.1-1: Npcf_SMPolicyControl specific Data Types",
                                    "table number": 34,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.1-2: Npcf_SMPolicyControl re-used Data Types",
                                    "table number": 35,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.6.2\tStructured data types",
                            "text_content": "This clause defines the structures to be used in resource representations.\nTable 5.6.2.2-1: Definition of type SmPolicyControl\n\nTable 5.6.2.3-1: Definition of type SmPolicyContextData\n\nTable 5.6.2.4-1: Definition of type SmPolicyDecision\n\nTable 5.6.2.5-1: Definition of type SmPolicyNotification\n\nTable 5.6.2.6-1: Definition of type PccRule\n\nTable 5.6.2.7-1: Definition of type SessionRule\n\nTable 5.6.2.8-1: Definition of type QosData\n\nEditor's note:\tBased on the progress of SA2, it is FFS whether PDU Set QoS parameters are defined within PccRule data type instead of within QosData.\nTable 5.6.2.9-1: Definition of type ConditionData\n\nTable 5.6.2.10-1: Definition of type TrafficControlData\n\nTable 5.6.2.11-1: Definition of type ChargingData\n\n\nTable 5.6.2.12-1: Definition of type UsageMonitoringData\n\nTable 5.6.2.13-1: Definition of type RedirectInformation\n\nTable 5.6.2.14-1: Definition of type FlowInformation\n\nTable 5.6.2.15-1: Definition of type SmPolicyDeleteData\n\nTable 5.6.2.16-1: Definition of type QosCharacteristics\n\nTable 5.6.2.17-1: Definition of type ChargingInformation\n\nTable 5.6.2.18-1: Definition of type AccuUsageReport\n\nTable 5.6.2.19-1: Definition of type SmPolicyUpdateContextData\n\nEditor’s Note: The content of the \"sliceInfo\" attribute for the case where the NF service consumer reports a change from the Alternative S-NSSAI to the initial S-NSSAI of the PDU Session via the \"NET_SLICE_REPL\" PCRT is FFS and pending stage 2 feedback.\nEditor’s Note: It is FFS how the bat offset is indicated and reported per PCC rule.\nEditor’s Note: Whether existing QoS monitoring data types and attributes are reused or new ones are added is to be discussed.\nTable 5.6.2.20-1: Definition of type UpPathChgEvent\n\nTable 5.6.2.21-1: Definition of type TerminationNotification\n\nTable 5.6.2.22-1: Definition of type AppDetectionInfo\n\nTable 5.6.2.23-1: Definition of type AccNetChId\n\nTable 5.6.2.24-1: Definition of type RequestedRuleData\n\nTable 5.6.2.25-1: Definition of type RequestedUsageData\n\nTable 5.6.2.26-1: Definition of type UeCampingRep\n\nTable 5.6.2.27-1: Definition of type RuleReport\n\nTable 5.6.2.28-1: Definition of type RanNasRelCause\n\nTable 5.6.2.29-1: Definition of type UeInitiatedResourceRequest\n\nTable 5.6.2.30-1: Definition of type PacketFilterInfo\n\nTable 5.6.2.31-1: Definition of type RequestedQos\n\nTable 5.6.2.32-1: Definition of type QosNotificationControlInfo\n\nTable 5.6.2.33-1: Definition of type PartialSuccessReport\n\nTable 5.6.2.34-1: Definition of type AuthorizedDefaultQos\n\nTable 5.6.2.35-1: Definition of type AccNetChargingAddress\n\nTable 5.6.2.36-1: Definition of type ErrorReport\n\nTable 5.6.2.37-1: Definition of type SessionRuleReport\n\nTable 5.6.2.38-1: Definition of type ServingNfIdentity\n\nTable 5.6.2.39-1: Definition of type SteeringMode\n\n\nTable 5.6.2.40-1: Definition of type QosMonitoringData\n\nTable 5.6.2.41-1: Definition of type TsnBridgeInfo\n\nTable 5.6.2.42-1: Definition of type QosMonitoringReport\n\nEditor's note:\tWhether the \"ulCongInfo\" and \"dlCongInfo\" attributes are single or plural is FFS.\nEditor's note:\tIt is FFS whether the \"cimf\" attribute is needed.\nEditor’s Note: It is FFS whether the QoS monitoring requirements for congestion measurements are different than the ones for packet delay, i.e., it is FFS whether reporting period and reporting frequency apply, or different criteria needs to be applied.\n\nTable 5.6.2.43-1: Definition of type AdditionalAccessInfo\n\n\nTable 5.6.2.45-1: Definition of type PortManagementContainer\n\nTable 5.6.2.46-1: IpMulticastAddressInfo\n\nTable 5.6.2.47-1: Definition of type BridgeManagementContainer\n\nTable 5.6.2.48-1: Definition of type DownlinkDataNotificationControl\n\nThis data type is defined in the same way as the \"DownlinkDataNotificationControl\" data type, but:\n-\twith the OpenAPI \"nullable: true\" property;\n-\tthe removable attributes \"notifCtrlInds\", and \" typesOfNotif \" attribute are defined as nullable in the OpenAPI.\nTable 5.6.2.50-1: Definition of type SgsnAddress\n\n\n\nTable 5.6.2.52 -1: Definition of type ThresholdValue\n\nTable 5.6.2.53-1: Definition of type NwdafData\n\n\nTable 5.6.2.54-1: Definition of type CallInfo\n\nTable 5.6.2.55-1: Definition of type CalleeInfo\n\nTable 5.6.2.56-1: Definition of type TrafficParaData\n\nTable 5.6.2.57-1: Definition of type L4sSupportlInfo\n\n\nTable 5.6.2.59-1: Definition of type SliceUsgCtrlInfo\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.6.2.2-1: Definition of type SmPolicyControl",
                                    "table number": 36,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.3-1: Definition of type SmPolicyContextData",
                                    "table number": 37,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.4-1: Definition of type SmPolicyDecision",
                                    "table number": 38,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.5-1: Definition of type SmPolicyNotification",
                                    "table number": 39,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.6-1: Definition of type PccRule",
                                    "table number": 40,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.7-1: Definition of type SessionRule",
                                    "table number": 41,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.8-1: Definition of type QosData",
                                    "table number": 42,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.9-1: Definition of type ConditionData",
                                    "table number": 43,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.10-1: Definition of type TrafficControlData",
                                    "table number": 44,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.11-1: Definition of type ChargingData",
                                    "table number": 45,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.12-1: Definition of type UsageMonitoringData",
                                    "table number": 46,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.13-1: Definition of type RedirectInformation",
                                    "table number": 47,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.14-1: Definition of type FlowInformation",
                                    "table number": 48,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.15-1: Definition of type SmPolicyDeleteData",
                                    "table number": 49,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.16-1: Definition of type QosCharacteristics",
                                    "table number": 50,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.17-1: Definition of type ChargingInformation",
                                    "table number": 51,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.18-1: Definition of type AccuUsageReport",
                                    "table number": 52,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.19-1: Definition of type SmPolicyUpdateContextData",
                                    "table number": 53,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.20-1: Definition of type UpPathChgEvent",
                                    "table number": 54,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.21-1: Definition of type TerminationNotification",
                                    "table number": 55,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.22-1: Definition of type AppDetectionInfo",
                                    "table number": 56,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.23-1: Definition of type AccNetChId",
                                    "table number": 57,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.24-1: Definition of type RequestedRuleData",
                                    "table number": 58,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.25-1: Definition of type RequestedUsageData",
                                    "table number": 59,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.26-1: Definition of type UeCampingRep",
                                    "table number": 60,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.27-1: Definition of type RuleReport",
                                    "table number": 61,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.28-1: Definition of type RanNasRelCause",
                                    "table number": 62,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.29-1: Definition of type UeInitiatedResourceRequest",
                                    "table number": 63,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.30-1: Definition of type PacketFilterInfo",
                                    "table number": 64,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.31-1: Definition of type RequestedQos",
                                    "table number": 65,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.32-1: Definition of type QosNotificationControlInfo",
                                    "table number": 66,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.33-1: Definition of type PartialSuccessReport",
                                    "table number": 67,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.34-1: Definition of type AuthorizedDefaultQos",
                                    "table number": 68,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.35-1: Definition of type AccNetChargingAddress",
                                    "table number": 69,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.36-1: Definition of type ErrorReport",
                                    "table number": 70,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.37-1: Definition of type SessionRuleReport",
                                    "table number": 71,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.38-1: Definition of type ServingNfIdentity",
                                    "table number": 72,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.39-1: Definition of type SteeringMode",
                                    "table number": 73,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.40-1: Definition of type QosMonitoringData",
                                    "table number": 74,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.41-1: Definition of type TsnBridgeInfo",
                                    "table number": 75,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.42-1: Definition of type QosMonitoringReport",
                                    "table number": 76,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.43-1: Definition of type AdditionalAccessInfo",
                                    "table number": 77,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.45-1: Definition of type PortManagementContainer",
                                    "table number": 78,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.46-1: IpMulticastAddressInfo",
                                    "table number": 79,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.47-1: Definition of type BridgeManagementContainer",
                                    "table number": 80,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.48-1: Definition of type DownlinkDataNotificationControl",
                                    "table number": 81,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.50-1: Definition of type SgsnAddress",
                                    "table number": 82,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.52 -1: Definition of type ThresholdValue",
                                    "table number": 83,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.53-1: Definition of type NwdafData",
                                    "table number": 84,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.54-1: Definition of type CallInfo",
                                    "table number": 85,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.55-1: Definition of type CalleeInfo",
                                    "table number": 86,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.56-1: Definition of type TrafficParaData",
                                    "table number": 87,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.57-1: Definition of type L4sSupportlInfo",
                                    "table number": 88,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.2.59-1: Definition of type SliceUsgCtrlInfo",
                                    "table number": 89,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.6.3\tSimple data types and enumerations",
                            "text_content": "This clause defines simple data types and enumerations that can be referenced from data structures defined in the previous clauses.\nThe simple data types defined in table 5.6.3.2-1 shall be supported. For additional simple data types see 3GPP TS 29.571 [11].\nTable 5.6.3.2-1: Simple data types\n\nTable 5.6.3.3-1: Enumeration FlowDirection\n\nTable 5.6.3.4-1: Enumeration ReportingLevel\n\nTable 5.6.3.5-1: Enumeration MeteringMethod\n\nTable 5.6.3.6-1: Enumeration PolicyControlRequestTrigger\n\nThe PCF may provision the values of policy control request trigger which are not always reported by the NF service consumer as defined in clause 4.2.6.4.\nWhen the NF service consumer detects the corresponding policy control request trigger(s), the NF service consumer shall report the detected trigger(s) to the PCF as defined in clause 4.2.4.1 with the additional information for different independent policy control request triggers as follows:\nIf the \"PLMN_CH\" is provisioned, when the NF service consumer detects a change of the serving network (a PLMN or an SNPN), the NF service consumer shall include the \"PLMN_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the current identifier of the serving network within the \"servingNetwork\" attribute.\nNOTE 1:\tHandover between non-equivalent SNPNs, and between SNPN and PLMN is not supported. When the UE is operating in SNPN access mode, the trigger reports changes of equivalent SNPNs.\nWhen the NF service consumer receives the resource modification request from the UE, the NF service consumer shall include the \"RES_MO_RE\" within the \"repPolicyCtrlReqTriggers\" attribute and the information for requesting the PCC rule as defined in clause 4.2.4.17.\nIf the \"AC_TY_CH\" is provisioned, when the NF service consumer detects a change of access type, the NF service consumer shall include the \"AC_TY_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the current access type within the \"accessType\" attribute. The RAT type encoded in the \"ratType\" attribute shall also be provided when applicable to the specific access type. Specific attributes for the EPC interworking case are described in Annex B. If the ATSSS feature is supported, when the NF service consumer detects an access is added or released for MA PDU session, the NF service consumer shall include the added Access Type or released Access type encoded as \"accessType\" attribute within the AdditionalAccessInfo data structure. The RAT type encoded in the \"ratType\" attribute shall also be provided within the AdditionalAccessInfo data structure when applicable to the added access type or released access type.\nWhen the NF service consumer detects an IPv4 address and/or an IPv6 prefix is allocated or released, the NF service consumer shall include the \"UE_IP_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and new allocated UE Ipv4 address within the \"ipv4Address\" attribute and/or the UE Ipv6 prefix within the \"ipv6AddressPrefix\" attribute or the released UE Ipv4 address within the \"relIpv4Address\" attribute and/or the UE Ipv6 prefix within the \"relIpv6AddressPrefix\" attribute. If the \"MultiIpv6AddrPrefix\" feature is supported, and if an additional allocated or released IPv6 prefix is detected, the NF service consumer shall include the new allocated UE Ipv6 prefix within the \"addIpv6AddrPrefixes\" attribute and the released UE Ipv6 prefix within the \"addRelIpv6AddrPrefixes\" attribute. If the \"UnlimitedMultiIpv6Prefix\" feature is supported, and if multiple allocated or released IPv6 prefixes are detected, the NF service consumer shall include the new allocated UE Ipv6 prefixes within the \"multiIpv6Prefixes\" attribute and the released UE Ipv6 prefixes within the \"mutliRelIpv6Prefixes\" attribute.\nWhen the NF service consumer detects a new UE MAC address or a used UE MAC address is not used any more, the NF service consumer shall include the \"UE_MAC_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and new detected UE MAC address within the \"ueMac\" attribute or the not used UE MAC address within the \"relUeMac\" attribute.\nIf the \"AN_CH_COR\" is provisioned, when the NF service consumer is provisioned with the PCC rule as defined in clause 4.2.6.5.1, the NF service consumer shall notify the PCF of access network charging identifier associated with the PCC rules as defined in clause 4.2.4.13.\nIf the \"US_RE\" is provisioned, when the NF service consumer receives the usage report from the UPF, the NF service consumer shall notify the PCF of the accumulated usage as defined in clause 4.2.4.10. Applicable to functionality introduced with the UMC feature as described in clause 5.8.\nIf the \"APP_STA\" is provisioned, when the NF service consumer receives the application start report from the UPF, the NF service consumer shall notify the PCF of the application start report as defined in clause 4.2.4.6. Applicable to functionality introduced with the ADC feature as described in clause 5.8.\nIf the \"APP_STO\" is provisioned, when the NF service consumer receives the application stop report from the UPF, the NF service consumer shall notify the PCF of the application stop report as defined in clause 4.2.4.6. Applicable to functionality introduced with the ADC feature as described in clause 5.8.\nIf the \"AN_INFO\" is provisioned, when the NF service consumer receives the reported access network information from the access network, the NF service consumer shall notify the PCF of the access network information as defined in clause 4.2.4.9. Applicable to functionality introduced with the NetLoc feature as described in clause 5.8.\nIf the \"CM_SES_FAIL\" is provisioned, when the NF service consumer receives a detected transient/permanent failure from the CHF, the NF service consumer shall include the \"CM_SES_FAIL\" within the \"repPolicyCtrlReqTriggers\" attribute. If the failure does not apply to all PCC Rules, the affected PCC Rules are indicated within the \"ruleReports\" attribute, with the \"ruleStatus\" attribute set to value ACTIVE and the \"failureCode\" attribute set to the corresponding value as reported by the CHF; otherwise if the failure applies to the session, the \"creditManageStatus\" shall be set to the corresponding value as reported by the CHF.\nIf the \"PS_DA_OFF\" is provisioned, when the NF service consumer receives a change of 3GPP PS Data Off status from the UE, the NF service consumer shall notify the PCF as defined in clause 4.2.4.8. Applicable to functionality introduced with the 3GPP-PS-Data-Off feature as described in clause 5.8.\nWhen the NF service consumer detects a change of subscribed default QoS, the NF service consumer shall include the \"DEF_QOS_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the new subscribed default QoS within the \"subsDefQos\" attribute.\nWhen the NF service consumer detects a change of Session-AMBR, the NF service consumer shall include the \"SE_AMBR_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the new Session-AMBR within the \"subsSessAmbr\" attribute.\nIf the \"QOS_NOTIF\" is provisioned, when the NF service consumer receives a notification from access network that QoS targets of the QoS Flow cannot be guaranteed or can be guaranteed again, the NF service consumer shall send the notification as defined in clause 4.2.4.20.\nIf the \"NO_CREDIT\" is provisioned, when the NF service consumer detects the credit for the PCC rule(s) is no longer available, the NF service consumer shall include the \"NO_CREDIT\" within the \"repPolicyCtrlReqTriggers\" attribute, the termination action the NF service consumer applies to the PCC rules as instructed by the CHF within the \"finUnitAct\" attribute and the affected PCC rules within the \"ruleReports\" attribute.\nWhen the \"ReallocationOfCredit\" feature is supported, if the \"REALLO_OF_CREDIT\" is provisioned, when the NF service consumer detects the credit for the PCC rule(s) is reallocated, the NF service consumer shall include the \"REALLO_OF_CREDIT\" within the \"repPolicyCtrlReqTriggers\" attribute and include the affected PCC rules for which credit has been reallocated after credit was no longer available and the \"ruleStatus\" attribute set to value ACTIVE within the \"ruleReports\" attribute.\nIf the \"PRA_CH\" is provisioned, to detect when the UE enters/leaves certain presence reporting areas, the NF service consumer is provisioned the presence reporting area information as defined in clause 4.2.6.5.6. When the NF service consumer receives the presence reporting area information from the serving node, the NF service consumer shall notify the PCF of the reported presence area information as defined in clause 4.2.4.16. This report includes reporting the initial status at the time the request for reports is initiated. Applicable to the functionality introduced by the PRA or ePRA feature as described in clause 5.8.\nIf the \"SAREA_CH\" is provisioned, when the NF service consumer detects a change of serving area (i.e. tracking area, or if the feature \"2G3GIWK\" is supported routing area), the NF service consumer shall include the \"SAREA_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the current TAI within the \"userLocationInfo\" attribute in either the \"eutraLocation\" or \"nrLocation\", or the current Routing Area within the \"userLocationInfo\" attribute in the \"utraLocation\" attribute when UTRAN access, or in the \"geraLocation\" attribute when GERAN access, as applicable. Non-3GPP access user location is reported in the \"n3gaLocation\" attribute when applicable. The attributes used in case of EPC interworking are described in Annex B.\nIf the \"SCNN_CH\" is provisioned, when the NF service consumer detects a change of serving Network Function (i.e. the AMF, ePDG, S-GW or if the feature \"2G3GIWK\" is supported SGSN), the NF service consumer shall include the \"SCNN_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the current serving Network Function in the \"servNfId\" attribute if available. When the serving Network Function is an AMF, the NF service consumer shall include the AMF Network Function Instance Identifier within the \"servNfInstId\" attribute and the Globally Unique AMF Identifier within the \"guami\" attribute. The attributes included in case of EPC interworking are described in Annex B.\nNOTE 1:\tIn the home-routed roaming case, if the AMF change is unknown to the H-SMF, then the AMF change is not reported.\nIf the \"RE_TIMEOUT\" is provisioned, when the NF service consumer is provisioned with the revalidation time by the PCF, the NF service consumer shall request the policy before the indicated revalidation time is reached as defined in clause 4.2.4.3.\nIf the \"RES_RELEASE\" is provisioned, when the NF service consumer receives the request of PCC rule removal as defined in clause 4.2.6.5.2, the NF service consumer shall report the outcome of resource release as defined in clause 4.2.4.12. Applicable to functionality introduced with the RAN-NAS-Cause feature as described in clause 5.8.\nWhen \"SUCC_RES_ALLO\" is provisioned and PCC rules are provisioned according to clause 4.2.6.5.5, the NF service consumer shall inform the PCF of the successful resource allocation as defined in clause 4.2.4.14.\nIf the feature \"2G3GIWK\" is supported, and if the \"RAI_CH\" is provisioned, when the NF service consumer detects a change of routing area, the NF service consumer shall include the \"RAI_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the current RAI within the \"userLocationInfo\" attribute as described in Annex B.\nIf the \"RAT_TY_CH\" is provisioned, when the NF service consumer detects a change of the RAT type, the NF service consumer shall include the \"RAT_TY_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the current RAT type within the \"ratType\" attribute. For MA PDU session, the NF service consumer shall include the current RAT type at the SmPolicyUpdateContextData data type level or AdditionalAccessInfo data type level. If the RAT type is provided at the SmPolicyUpdateContextData data type level, the NF service consumer shall also provide the associated access type within the SmPolicyUpdateContextData data structure.\nIf the \"REF_QOS_IND_CH\" is provisioned, when the NF service consumer receives a change of reflective QoS indication from the UE, the NF service consumer shall include the \"REF_QOS_IND_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the indication within the \"refQosIndication\" attribute.\nWhen the NF service consumer receives the number of supported packet filter for signalled QoS rules for the PDU session from the UE during the PDU Session Modification procedure after the first inter-system change from EPS to 5GS for a PDU Session established in EPS and transferred from EPS with N26 interface, the NF service consumer shall include the \"NUM_OF_PACKET_FILTER\" within the \"repPolicyCtrlReqTriggers\" attribute and the number of supported packet filter for signalled QoS rules within the \"numOfPackFilter\" attribute. Only applicable to the interworking scenario as defined in Annex B.\nIf the \"UE_STATUS_RESUME\" is provisioned, when the NF service consumer detected the UE's status is resumed from suspend state, the NF service consumer shall inform the PCF of the UE status including the \"UE_STATUS_RESUME\" within \"repPolicyCtrlReqTriggers\" attribute. The PCF shall after this update the NF service consumer with PCC Rules or session rules if necessary. Applicable to functionality introduced with the PolicyUpdateWhenUESuspends feature as described in clause 5.8.\nIf the \"UE_TZ_CH\" is provisioned, when the NF service consumer detects a change of the UE Time Zone, the NF service consumer shall include the \"UE_TZ_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the current UE Time Zone within the \"ueTimeZone\" attribute.\nIf the \"DN-Authorization\" feature is supported, when the NF service consumer detects a change of DN-AAA authorization profile index, the NF service consumer shall include the \"AUTH_PROF_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the new DN-AAA authorization profile index within the \"authProfIndex\" attribute.\nIf the \"TimeSensitiveNetworking\" or \"TimeSensitiveCommunication\" feature is supported and \"TSN_BRIDGE_INFO\" is provisioned, when the NF service consumer detects:\n-\tthere is information about new TSC user plane node port(s), e.g. a new manageable Ethernet port, the NF service consumer shall include the \"TSN_BRIDGE_INFO\" within the \"repPolicyCtrlReqTriggers\" attribute and the updated TSC user plane node information within the \"tsnBridgeInfo\" attribute; and/or\n-\tthe NF service consumer detects a UMIC or PMIC, the NF service consumer shall include the \"TSN_BRIDGE_INFO\" within the \"repPolicyCtrlReqTriggers\" attribute and the UMIC, if available, within the \"tsnBridgeManCont\" attribute, and/or the PMIC(s), if available, within the \"tsnPortManContDstt\" and the \"tsnPortManContNwtts\" attributes.\nNOTE 2:\tWhen the NF service consumer detects updated Port Management Information of the NW-TT ports, the NF service consumer includes the PMIC within the \"tsnPortManContNwtts\" attribute of SmPolicyUpdateContextData data type.\nIf the \"QoSMonitoring\" feature and/or the \"EnQoSMon\" is supported and if the \"QOS_MONITORING\" is provisioned, upon receiving the QoS Monitoring report from the UPF, the NF service consumer shall send the QoS monitoring report(s) for the concerned PCC rules to the PCF as defined in clause 4.2.4.24.\nIf the \"SCELL_CH\" is provisioned, when the NF service consumer detects a change of serving cell, the NF service consumer shall include the \"SCELL_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the current cell Id within the \"userLocationInfo\" attribute either in the \"eutraLocation\" attribute when EPC/E-UTRAN access or \"nrLocation\" attribute when NR access or \"geraLocation\" attribute when GERAN access or \"utraLocation\" attribute when UTRAN access, as applicable.\nNOTE 3:\tLocation change of serving cell can increase signalling load on multiple interfaces. Hence, it is recommended that any such serving cell changes event trigger subscription is only applied for a limited number of subscribers.\nIf the \"AggregatedUELocChanges\" feature is supported and the \"USER_LOCATION_CH\" is provisioned, when the NF service consumer detects a change of serving cell and/or a change of serving area (i.e. tracking area), the NF service consumer shall include the \"USER_LOCATION_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the current serving area and/or cell Id within the \"userLocationInfo\" attribute in the \"eutraLocation\" attribute or \"nrLocation\" attribute or \"geraLocation\" attribute or \"utraLocation\" attribute, as applicable.\nNOTE 4:\tThe access network can be configured to report location changes only when transmission resources are established in the radio access network.\nIf the \"EPSFallbackReport\" feature is supported and the \"EPS_FALLBACK\" is provisioned and there is a PCC rule installed that required the reporting, when the NF service consumer receives a PDU session modification response indicating the rejection of the establishment of the QoS flow with 5QI=1, the NF service consumer shall notify the PCF of EPS fallback as defined in clause B.3.4.6.\nWhen the NF service consumer receives the MA PDU Request Indication or MA PDU Network-Upgrade Allowed Indication and ATSSS Capability from the UE during the PDU Session Modification procedure after the first inter-system change from EPS to 5GS for a PDU Session established in EPS and transferred from EPS with N26 interface, the NF service consumer shall include the \"MA_PDU\" within the \"repPolicyCtrlReqTriggers\" attribute, the MA PDU session Indication in the \"maPduInd\" attribute, the ATSSS capability of the MA PDU session within the \"atsssCapab\" attribute. Only applicable to the interworking scenario as defined in Annex B.\nIf the \"WWC\" feature is supported and \"5G_RG_JOIN\" is provisioned and when the NF service consumer detects a 5G-RG has joined to an IP Multicast Group, the NF service consumer shall include the \"5G_RG_JOIN\" within the \"repPolicyCtrlReqTriggers\" attribute and the IP multicast addressing information within the \"mulAddrInfos\" attribute.\nIf the \"WWC\" feature is supported and \"5G_RG_LEAVE\" is provisioned and when the NF service consumer detects a 5G-RG has left an IP Multicast Group, the NF service consumer shall include the \"5G_RG_LEAVE\" within the \"repPolicyCtrlReqTriggers\" attribute and the IP multicast addressing information within the \"mulAddrInfos\" attribute.\nIf \"DDNEventPolicyControl\" feature is supported, and if \"DDN_FAILURE\" is provisioned, when the NF service consumer receives an event subscription for DDN Failure event including the traffic descriptors, the NF service consumer shall include the \"DDN_FAILURE\" within the \"repPolicyCtrlReqTriggers\" attribute and traffic descriptor(s) within the \"trafficDescriptors\" attribute.\nIf \"DDNEventPolicyControl\" feature is supported, and if \"DDN_DELIVERY_STATUS\" is provisioned, when the NF service consumer receives an event subscription for DDD Status event including the traffic descriptors, the NF service consumer shall include the \"DDN_DELIVERY_STATUS\" within the \"repPolicyCtrlReqTriggers\" attribute and traffic descriptor(s) within the \"trafficDescriptors\" attribute and the requested type(s) of notifications (notifications about downlink packets being buffered, and/or discarded).\nIf \"GroupIdListChange\" feature is supported, when the SMF receives the updated Internal Group Identifier(s) from the UDM, the SMF shall include the \"GROUP_ID_LIST_CHG\" within the \"repPolicyCtrlReqTriggers\" attribute and the Internal Group Identifier(s) of the served UE within the \"interGrpIds\" attribute.\nIf \"DDNEventPolicyControl2\" feature is supported, and if \"DDN_FAILURE_CANCELLATION\" is provisioned, when the SMF receives a cancellation of event subscription for DDN Failure event, the SMF shall include the \"DDN_FAILURE_CANCELLATION\" within the \"repPolicyCtrlReqTriggers\" attribute and the PCC rule identifier of the PCC rule which is used for traffic detection of DDN failure event within the \"pccRuleId\" attribute.\nIf \"DDNEventPolicyControl2\" feature is supported, and if \"DDN_DELIVERY_STATUS_CANCELLATION\" is provisioned, when the SMF receives a cancellation of event subscription for DDD Status event, the SMF shall include the \"DDN_DELIVERY_STATUS_CANCELLATION\" within the \"repPolicyCtrlReqTriggers\" attribute and the PCC rule identifier of the PCC rule which is used for traffic detection of DDD status event within the \"pccRuleId\" attribute.\nWhen the \"VPLMN-QoS-Control\" feature is supported and if the NF service consumer receives a new QoS value supported in the VPLMN, the NF service consumer shall include the \"VPLMN_QOS_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the received QoS constraints within the \"vplmnQos\" attribute; if the NF service consumer detects that the UE moves from a VPLMN with QoS constraints to the HPLMN or to a VPLMN without QoS constraints, the NF service consumer shall include the \"VPLMN_QOS_CH\" within the \"repPolicyCtrlReqTriggers\" attribute and the \"vplmnQosNotApp\" attribute set to true.\nIf the \"MPSforDTS\" feature is supported, and if \"SUCC_QOS_UPDATE\" is provisioned, when the resources for the MPS for DTS invocation/revocation are successfully allocated for MPS for DTS, the NF service consumer shall include the \"SUCC_QOS_UPDATE\" within the \"repPolicyCtrlReqTriggers\" attribute.\nIf \"SatBackhaulCategoryChg\" is supported, and if \"SAT_CATEGORY_CHG\" is provisioned, the NF service consumer notifies the PCF when there is a change of the backhaul which is used for the PDU session between different satellite backhaul categories or between a satellite backhaul and a non-satellite backhaul. When the \"EnSatBackhaulCatChg\" feature is supported, the different dynamic satellite backhaul categories may also be reported. The NF service consumer shall include the satellite backhaul category or dynamic satellite backhaul category or non-satellite backhaul within the \"satBackhaulCategory\" attribute together with the \"SAT_CATEGORY_CHG\" policy control request trigger within the \"repPolicyCtrlReqTriggers\" attribute.\nNOTE 5:\tOnly a single backhaul category can be indicated.\nIf the \"AMInfluence\" feature is supported, the NF service consumer notifies the PCF about the PCF for the UE request to be notified of PDU session established/terminated events and if applicable, about the PCF for the UE binding information in the initial reporting and when the PCF for the UE changes by forwarding within the \"pcfUeInfo\" attribute, the received PCF for the UE callback URI within the \"callbackUri\" attribute and, if received, SBA binding information within the \"bindingInfo\" attribute, together with the \"PCF_UE_NOTIF_IND\" policy control request trigger within the \"repPolicyCtrlReqTriggers\" attribute. The NF service consumer notifies the PCF about the PCF for the UE request to stop being notified about the PDU session established/terminated events by sending the \"pcfUeInfo\" attribute set to NULL together with the \"PCF_UE_NOTIF_IND\" policy control request trigger within the \"repPolicyCtrlReqTriggers\" attribute.\nIf \"EneNA\" feature is supported, the NF service consumer notifies the PCF when there is a change in the list of NWDAF Instance IDs used for the PDU Session and/or associated Analytics IDs. The NF service consumer shall include within the \"nwdafDatas\" attribute the list of NWDAF instance IDs used for the PDU Session within the \"nwdafInstanceId\" attribute and their associated Analytic ID(s) within the \"nwdafEvents\" attribute, and the \"NWDAF_DATA_CHG\" within the \"repPolicyCtrlReqTriggers\" attribute.\nIf the \"EpsUrsp\" feature is supported, when the NF service consumer receives a new UE policy container from the UE in EPC over a PDN connection, the NF service consumer shall include the \"UE_POL_CONT_IND\" within the \"repPolicyCtrlReqTriggers\" attribute and the received UE policy container within the \"uePolCont\" attribute. Only applicable to the interworking scenario as defined in Annex B.\nIf the \"URSPEnforcement\" feature is supported and \"URSP_ENFORCEMENT_INFO\" is provisioned, when the NF service consumer detects the UE includes URSP enforcement information in the PDU session modification request, the NF service consumer shall include the \"URSP_ENFORCEMENT_INFO\" within the \"repPolicyCtrlReqTriggers\" attribute and shall forward the received information from the UE within the \"urspEnfInfo\" attribute. In this case, the NF service consumer shall also include, if they were not previously provided, the SSC mode within the \"sscMode\" attribute, the UE requested DNN (if available and different from the selected DNN) within the \"ueReqDnn\" attribute, and if the PDU session is redundant, the RSN and the PDU session pair ID within the \"redundantPduSessionInfo\" attribute. The NF service consumer shall also include the access type within the \"accessType\" attribute, if changed compared with the latest provided value.\nIf \"HR-SBO\" feature is supported, the NF service consumer notifies the PCF when the HR-SBO support indication has changed. The NF service consumer shall include the \"hrsboInd\" attribute and set it to \"true\" if the HR-SBO is supported, otherwise set it to \"false\", and the \"HR_SBO_IND_CHG\" within the \"repPolicyCtrlReqTriggers\" attribute.\nWhen the \"L4S\" feature is supported and the \"L4S_SUPP\" is provisioned, when the PCC rules are provisioned with the explicit indication of ECN marking for L4S according to clause 4.2.6.21.3, the NF service consumer shall inform the PCF of the unavailability or availability again in 5GS for ECN marking for L4S support as defined in clause 4.2.6.2.21.\nIf \"NetSliceRepl\" feature is supported, the NF service consumer notifies the PCF about network slice replacement, i.e., when there is a change between the initial S-NSSAI of the PDU Session and the Alternative S-NSSAI by including the \"NET_SLICE_REPL\" PCRT within the \"repPolicyCtrlReqTriggers\" attribute. When the NF service consumer reports a change from the initial S-NSSAI of the PDU Session to the Alternative S-NSSAI, it shall additionally include the Alternative S-NSSAI within the \"sliceInfo\" attribute.\nEditor’s Note: Whether the initial S-NSSAI is provided to the PCF when the NF service consumer reports a change from the Alternative S-NSSAI to the initial S-NSSAI of the PDU Session via the \"NET_SLICE_REPL\" PCRT is FFS and pending stage 2 feedback.\nIf \"EnTSCAC\" feature is supported, and if \"BAT_OFFSET_INFO\" is provisioned, when the SMF receives the notification on BAT offset and optionally adjusted periodicity, the SMF shall include the \"BAT_OFFSET_INFO\" within the \"repPolicyCtrlReqTriggers\" attribute and the BAT offset and optionally adjusted periodicity within the \"batOffsetInfo\" attribute.\nEditor’s Note: It is FFS how the bat offset is indicated and reported per PCC rule.\n\nTable 5.6.3.7-1: Enumeration RequestedRuleDataType\n\nTable 5.6.3.8-1: Enumeration RuleStatus\n\nTable 5.6.3.9-1: Enumeration FailureCode\n\nTable 5.6.3.10-1: Enumeration AfSigProtocol\n\nTable 5.6.3.11-1: Enumeration RuleOperation\n\nTable 5.6.3.12-1: Enumeration RedirectAddressType\n\nTable 5.6.3.13-1: Enumeration QosFlowUsage\n\nTable 5.6.3.14-1: Enumeration FailureCause\n\nThis data type is defined in the same way as the \"FlowDirection\" data type, but also allows null value (specified as \"NullValue\" data type).\nTable 5.6.3.16-1: Enumeration CreditManagementStatus\n\nTable 5.6.3.17-1: Enumeration SessionRuleFailureCode\n\nTable 5.6.3.18-1: Enumeration SteeringFunctionality\n\nTable 5.6.3.19-1: Enumeration SteerModeValue\n\nTable 5.6.3.20-1: Enumeration MulticastAccessControl\n\nTable 5.6.3.21-1: Enumeration RequestedQosMonitoringParameter\n\nTable 5.6.3.22-1: Enumeration ReportingFrequency\n\nThe enumeration SmPolicyAssociationReleaseCause represents the cause why the PCF requests the termination of the policy association. It shall comply with the provisions defined in table 5.6.3.23-1.\nTable 5.6.3.23-1: Enumeration SmPolicyAssociationReleaseCause\n\nTable 5.6.3.24-1: Enumeration PduSessionRelCause\n\nTable 5.6.3.25-1: Enumeration MaPduIndication\n\nTable 5.6.3.26-1: Enumeration AtsssCapability\n\nTable 5.6.3.27-1: Enumeration NetLocAccessSupport\n\nTable 5.6.3.28-1: PolicyDecisionFailureCode\n\nTable 5.6.3.29-1: Enumeration NotificationControlIndication\n\n5.6.3.30\tVoid\n\nTable 5.6.3.31-1: Enumeration SteerModeIndicator\n\nTable 5.6.3.32-1: Enumeration TrafficParameterMeas\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.6.3.2-1: Simple data types",
                                    "table number": 90,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.3-1: Enumeration FlowDirection",
                                    "table number": 91,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.4-1: Enumeration ReportingLevel",
                                    "table number": 92,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.5-1: Enumeration MeteringMethod",
                                    "table number": 93,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.6-1: Enumeration PolicyControlRequestTrigger",
                                    "table number": 94,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.7-1: Enumeration RequestedRuleDataType",
                                    "table number": 95,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.8-1: Enumeration RuleStatus",
                                    "table number": 96,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.9-1: Enumeration FailureCode",
                                    "table number": 97,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.10-1: Enumeration AfSigProtocol",
                                    "table number": 98,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.11-1: Enumeration RuleOperation",
                                    "table number": 99,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.12-1: Enumeration RedirectAddressType",
                                    "table number": 100,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.13-1: Enumeration QosFlowUsage",
                                    "table number": 101,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.14-1: Enumeration FailureCause",
                                    "table number": 102,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.16-1: Enumeration CreditManagementStatus",
                                    "table number": 103,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.17-1: Enumeration SessionRuleFailureCode",
                                    "table number": 104,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.18-1: Enumeration SteeringFunctionality",
                                    "table number": 105,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.19-1: Enumeration SteerModeValue",
                                    "table number": 106,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.20-1: Enumeration MulticastAccessControl",
                                    "table number": 107,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.21-1: Enumeration RequestedQosMonitoringParameter",
                                    "table number": 108,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.22-1: Enumeration ReportingFrequency",
                                    "table number": 109,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.23-1: Enumeration SmPolicyAssociationReleaseCause",
                                    "table number": 110,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.24-1: Enumeration PduSessionRelCause",
                                    "table number": 111,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.25-1: Enumeration MaPduIndication",
                                    "table number": 112,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.26-1: Enumeration AtsssCapability",
                                    "table number": 113,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.27-1: Enumeration NetLocAccessSupport",
                                    "table number": 114,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.28-1: PolicyDecisionFailureCode",
                                    "table number": 115,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.29-1: Enumeration NotificationControlIndication",
                                    "table number": 116,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.31-1: Enumeration SteerModeIndicator",
                                    "table number": 117,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.6.3.32-1: Enumeration TrafficParameterMeas",
                                    "table number": 118,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "5.7\tError handling",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.7.1\tGeneral",
                            "text_content": "HTTP error handling shall be supported as specified in clause 5.2.4 of 3GPP TS 29.500 [4].\nFor the Npcf_SMPolicyControl API, HTTP error responses shall be supported as specified in clause 4.8 of 3GPP TS 29.501 [5].\nProtocol errors and application errors specified in table 5.2.7.2-1 of 3GPP TS 29.500 [4] shall be supported for an HTTP method if the corresponding HTTP status codes are specified as mandatory for that HTTP method in table 5.2.7.1-1 of 3GPP TS 29.500 [4].\nIn addition, the requirements in the following clauses shall apply.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.2\tProtocol Errors",
                            "text_content": "In this Release of the specification, there are no additional protocol errors applicable for the Npcf_SMPolicyControl API.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.3\tApplication Errors",
                            "text_content": "The application errors defined for the Npcf_SMPolicyControl API are listed in table 5.7.3-1 and 5.7.3-2.\nTable 5.7.3-1: Application errors when PCF acts as a server\n\n\nTable 5.7.3-2: Application errors when NF service consumer acts as a server to receive a notification\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.7.3-1: Application errors when PCF acts as a server",
                                    "table number": 119,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.7.3-2: Application errors when NF service consumer acts as a server to receive a notification",
                                    "table number": 120,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "5.8\tFeature negotiation",
                    "description": "",
                    "summary": "",
                    "text_content": "The optional features in table 5.8-1 are defined for the Npcf_SMPolicyControl API. They shall be negotiated using the extensibility mechanism defined in clause 6.6 of 3GPP TS 29.500 [4].\nTable 5.8-1: Supported Features\n\nEditor's note:\tWhether and/how to indicate the support of end of burst indication, and provision the flow periodicity information within the Power Saving feature is FFS.\n",
                    "tables": [
                        {
                            "description": "Table 5.8-1: Supported Features",
                            "table number": 121,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.9\tSecurity",
                    "description": "",
                    "summary": "",
                    "text_content": "As indicated in 3GPP TS 33.501 [27], the access to the Npcf_SMPolicyControl API shall be authorized by means of the OAuth2 protocol (see IETF RFC 6749 [28]), using the \"Client Credentials\" authorization grant, where the NRF (see 3GPP TS 29.510 [29]) plays the role of the authorization server.\nAn NF service consumer, prior to consuming services offered by the Npcf_SMPolicyControl API, shall obtain a \"token\" from the authorization server, by invoking the Access Token Request service, as described in 3GPP TS 29.510 [29], clause 5.4.2.2.\nNOTE:\tWhen multiple NRFs are deployed in a network, the NRF used as authorization server is the same NRF that the NF service consumer used for discovering the Npcf_SMPolicyControl service.\nThe Npcf_SMPolicyControl API defines a single scope \"npcf-smpolicycontrol\" for OAuth2 authorization (as specified in 3GPP TS 33.501 [27]) for the entire API, and it does not define any additional scopes at resource or operation level.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.1\tGeneral",
            "description": "The present Annex contains an OpenAPI [10] specification of HTTP messages and content bodies used by the Npcf_SMPolicyControl API.\nThis Annex shall take precedence when being discrepant to other parts of the specification with respect to the encoding of information elements and methods within the API.\nNOTE 1:\tThe semantics and procedures, as well as conditions, e.g. for the applicability and allowed combinations of attributes or values, not expressed in the OpenAPI definitions but defined in other parts of the specification also apply.\nInformative copies of the OpenAPI specification file contained in this 3GPP Technical Specification are available on a Git-based repository, that uses the GitLab software version control system (see clause 5B of the 3GPP TR 21.900 [38] and clause 5.3.1 of the 3GPP TS 29.501 [5] for further information).\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.2\tNpcf_SMPolicyControl API",
            "description": "openapi: 3.0.0\n\ninfo:\ntitle: Npcf_SMPolicyControl API\nversion: 1.3.0-alpha.5\ndescription: |\nSession Management Policy Control Service\n© 2023, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC).\nAll rights reserved.\n\nexternalDocs:\ndescription: 3GPP TS 29.512 V18.4.0; 5G System; Session Management Policy Control Service.\nurl: 'https://www.3gpp.org/ftp/Specs/archive/29_series/29.512/'\n\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- npcf-smpolicycontrol\n\nservers:\n- url: '{apiRoot}/npcf-smpolicycontrol/v1'\nvariables:\napiRoot:\ndefault: https://example.com\ndescription: apiRoot as defined in clause 4.4 of 3GPP TS 29.501\n\npaths:\n/sm-policies:\npost:\nsummary: Create a new Individual SM Policy.\noperationId: CreateSMPolicy\ntags:\n- SM Policies (Collection)\nrequestBody:\nrequired: true\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/SmPolicyContextData'\nresponses:\n'201':\ndescription: Created\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/SmPolicyDecision'\nheaders:\nLocation:\ndescription: Contains the URI of the newly created resource.\nrequired: true\nschema:\ntype: string\n'308':\ndescription: Permanent Redirect\nheaders:\nLocation:\ndescription: >\nContains the URI of the PCF within the existing PCF binding information stored in\nthe BSF for the same UE ID, S-NSSAI and DNN combination.\nrequired: true\nschema:\ntype: string\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\n$ref: 'TS29571_CommonData.yaml#/components/responses/default'\ncallbacks:\nSmPolicyUpdateNotification:\n'{$request.body#/notificationUri}/update':\npost:\nrequestBody:\nrequired: true\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/SmPolicyNotification'\nresponses:\n'200':\ndescription: >\nOK. The current applicable values corresponding to the policy control request\ntrigger is reported.\ncontent:\napplication/json:\nschema:\noneOf:\n- $ref: '#/components/schemas/UeCampingRep'\n- type: array\nitems:\n$ref: '#/components/schemas/PartialSuccessReport'\nminItems: 1\n- type: array\nitems:\n$ref: '#/components/schemas/PolicyDecisionFailureCode'\nminItems: 1\n'204':\ndescription: No Content, Notification was succesfull\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\ndescription: Bad Request.\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/ErrorReport'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\n$ref: 'TS29571_CommonData.yaml#/components/responses/default'\nSmPolicyControlTerminationRequestNotification:\n'{$request.body#/notificationUri}/terminate':\npost:\nrequestBody:\nrequired: true\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/TerminationNotification'\nresponses:\n'204':\ndescription: No Content, Notification was successful\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\n$ref: 'TS29571_CommonData.yaml#/components/responses/default'\n/sm-policies/{smPolicyId}:\nget:\nsummary: Read an Individual SM Policy\noperationId: GetSMPolicy\ntags:\n- Individual SM Policy (Document)\nparameters:\n- name: smPolicyId\nin: path\ndescription: Identifier of a policy association.\nrequired: true\nschema:\ntype: string\nresponses:\n'200':\ndescription: OK. Resource representation is returned.\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/SmPolicyControl'\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'406':\n$ref: 'TS29571_CommonData.yaml#/components/responses/406'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\n$ref: 'TS29571_CommonData.yaml#/components/responses/default'\n/sm-policies/{smPolicyId}/update:\npost:\nsummary: Update an existing Individual SM Policy\noperationId: UpdateSMPolicy\ntags:\n- Individual SM Policy (Document)\nrequestBody:\nrequired: true\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/SmPolicyUpdateContextData'\nparameters:\n- name: smPolicyId\nin: path\ndescription: Identifier of a policy association.\nrequired: true\nschema:\ntype: string\nresponses:\n'200':\ndescription: OK. Updated policies are returned\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/SmPolicyDecision'\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\n$ref: 'TS29571_CommonData.yaml#/components/responses/default'\n/sm-policies/{smPolicyId}/delete:\npost:\nsummary: Delete an existing Individual SM Policy.\noperationId: DeleteSMPolicy\ntags:\n- Individual SM Policy (Document)\nrequestBody:\nrequired: true\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/SmPolicyDeleteData'\nparameters:\n- name: smPolicyId\nin: path\ndescription: Identifier of a policy association.\nrequired: true\nschema:\ntype: string\nresponses:\n'204':\ndescription: No content\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\n$ref: 'TS29571_CommonData.yaml#/components/responses/default'\n\ncomponents:\nsecuritySchemes:\noAuth2ClientCredentials:\ntype: oauth2\nflows:\nclientCredentials:\ntokenUrl: '{nrfApiRoot}/oauth2/token'\nscopes:\nnpcf-smpolicycontrol: Access to the Npcf_SMPolicyControl API\n\nschemas:\nSmPolicyControl:\ndescription: >\nContains the parameters used to request the SM policies and the SM policies authorized by\nthe PCF.\ntype: object\nproperties:\ncontext:\n$ref: '#/components/schemas/SmPolicyContextData'\npolicy:\n$ref: '#/components/schemas/SmPolicyDecision'\nrequired:\n- context\n- policy\n\nSmPolicyContextData:\ndescription: Contains the parameters used to create an Individual SM policy resource.\ntype: object\nproperties:\naccNetChId:\n$ref: '#/components/schemas/AccNetChId'\nchargEntityAddr:\n$ref: '#/components/schemas/AccNetChargingAddress'\ngpsi:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Gpsi'\nsupi:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'\ninvalidSupi:\ntype: boolean\ndescription: >\nWhen this attribute is included and set to true, it indicates that the supi attribute\ncontains an invalid value.This attribute shall be present if the SUPI is not available\nin the SMF or the SUPI is unauthenticated. When present it shall be set to true for an\ninvalid SUPI and false (default) for a valid SUPI.\ninterGrpIds:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/GroupId'\nminItems: 1\npduSessionId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PduSessionId'\npduSessionType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PduSessionType'\nchargingcharacteristics:\ntype: string\ndnn:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Dnn'\ndnnSelMode:\n$ref: 'TS29502_Nsmf_PDUSession.yaml#/components/schemas/DnnSelectionMode'\nnotificationUri:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'\naccessType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'\nratType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/RatType'\naddAccessInfo:\n$ref: '#/components/schemas/AdditionalAccessInfo'\nservingNetwork:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PlmnIdNid'\nuserLocationInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/UserLocation'\nueTimeZone:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/TimeZone'\npei:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Pei'\nipv4Address:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr'\nipv6AddressPrefix:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix'\nipDomain:\ntype: string\ndescription: Indicates the IPv4 address domain\nsubsSessAmbr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ambr'\nauthProfIndex:\ntype: string\ndescription: Indicates the DN-AAA authorization profile index\nsubsDefQos:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SubscribedDefaultQos'\nvplmnQos:\n$ref: 'TS29502_Nsmf_PDUSession.yaml#/components/schemas/VplmnQos'\nnumOfPackFilter:\ntype: integer\ndescription: Contains the number of supported packet filter for signalled QoS rules.\nonline:\ntype: boolean\ndescription: >\nIf it is included and set to true, the online charging is applied to the PDU session.\noffline:\ntype: boolean\ndescription: >\nIf it is included and set to true, the offline charging is applied to the PDU session.\n3gppPsDataOffStatus:\ntype: boolean\ndescription: >\nIf it is included and set to true, the 3GPP PS Data Off is activated by the UE.\nrefQosIndication:\ntype: boolean\ndescription: If it is included and set to true, the reflective QoS is supported by the UE.\ntraceReq:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/TraceData'\nsliceInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Snssai'\nqosFlowUsage:\n$ref: '#/components/schemas/QosFlowUsage'\nservNfId:\n$ref: '#/components/schemas/ServingNfIdentity'\nsuppFeat:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\nsmfId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'\nrecoveryTime:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DateTime'\nmaPduInd:\n$ref: '#/components/schemas/MaPduIndication'\natsssCapab:\n$ref: '#/components/schemas/AtsssCapability'\nipv4FrameRouteList:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv4AddrMask'\nminItems: 1\nipv6FrameRouteList:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix'\nminItems: 1\nsatBackhaulCategory:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SatelliteBackhaulCategory'\npcfUeInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PcfUeCallbackInfo'\npvsInfo:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ServerAddressingInfo'\nminItems: 1\nonboardInd:\ntype: boolean\ndescription: >\nIf it is included and set to true, it indicates that the PDU session is used for\nUE Onboarding.\nnwdafDatas:\ntype: array\nitems:\n$ref: '#/components/schemas/NwdafData'\nminItems: 1\nurspEnfInfo:\n$ref: '#/components/schemas/UrspEnforcementInfo'\nsscMode:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SscMode'\nueReqDnn:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Dnn'\nredundantPduSessionInfo:\n$ref: 'TS29502_Nsmf_PDUSession.yaml#/components/schemas/RedundantPduSessionInformation'\nhrsboInd:\ntype: boolean\ndescription: >\nHR-SBO support indication. If present and set to \"true\", it indicates that the HR-SBO is\nsupported. Default value is \"false\" if omitted.\nrequired:\n- supi\n- pduSessionId\n- pduSessionType\n- dnn\n- notificationUri\n- sliceInfo\n\nSmPolicyDecision:\ndescription: Contains the SM policies authorized by the PCF.\ntype: object\nproperties:\nsessRules:\ntype: object\nadditionalProperties:\n$ref: '#/components/schemas/SessionRule'\nminProperties: 1\ndescription: >\nA map of Sessionrules with the content being the SessionRule as described in\nclause 5.6.2.7. The key used in this map for each entry is the sessRuleId\nattribute of the corresponding SessionRule.\npccRules:\ntype: object\nadditionalProperties:\n$ref: '#/components/schemas/PccRule'\nminProperties: 1\ndescription: >\nA map of PCC rules with the content being the PCCRule as described in\nclause 5.6.2.6. The key used in this map for each entry is the pccRuleId\nattribute of the corresponding PccRule.\nnullable: true\npcscfRestIndication:\ntype: boolean\ndescription: >\nIf it is included and set to true, it indicates the P-CSCF Restoration is requested.\nqosDecs:\ntype: object\nadditionalProperties:\n$ref: '#/components/schemas/QosData'\nminProperties: 1\ndescription: >\nMap of QoS data policy decisions. The key used in this map for each entry is the qosId\nattribute of the corresponding QosData.\nchgDecs:\ntype: object\nadditionalProperties:\n$ref: '#/components/schemas/ChargingData'\nminProperties: 1\ndescription: >\nMap of Charging data policy decisions. The key used in this map for each entry\nis the chgId attribute of the corresponding ChargingData.\nnullable: true\nchargingInfo:\n$ref: '#/components/schemas/ChargingInformation'\ntraffContDecs:\ntype: object\nadditionalProperties:\n$ref: '#/components/schemas/TrafficControlData'\nminProperties: 1\ndescription: >\nMap of Traffic Control data policy decisions. The key used in this map for each entry\nis the tcId attribute of the corresponding TrafficControlData.\numDecs:\ntype: object\nadditionalProperties:\n$ref: '#/components/schemas/UsageMonitoringData'\nminProperties: 1\ndescription: >\nMap of Usage Monitoring data policy decisions. The key used in this map for each entry\nis the umId attribute of the corresponding UsageMonitoringData.\nnullable: true\nqosChars:\ntype: object\nadditionalProperties:\n$ref: '#/components/schemas/QosCharacteristics'\nminProperties: 1\ndescription: >\nMap of QoS characteristics for non standard 5QIs. This map uses the 5QI values as keys.\nqosMonDecs:\ntype: object\nadditionalProperties:\n$ref: '#/components/schemas/QosMonitoringData'\nminProperties: 1\ndescription: >\nMap of QoS Monitoring data policy decisions. The key used in this map for each entry\nis the qmId attribute of the corresponding QosMonitoringData.\nnullable: true\nreflectiveQoSTimer:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSec'\nconds:\ntype: object\nadditionalProperties:\n$ref: '#/components/schemas/ConditionData'\nminProperties: 1\ndescription: >\nA map of condition data with the content being as described in clause 5.6.2.9. The key\nused in this map for each entry is the condId attribute of the corresponding\nConditionData.\nnullable: true\nrevalidationTime:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DateTime'\noffline:\ntype: boolean\ndescription: >\nIndicates the offline charging is applicable to the PDU session when it is included and\nset to true.\nonline:\ntype: boolean\ndescription: >\nIndicates the online charging is applicable to the PDU session when it is included and\nset to true.\nofflineChOnly:\ntype: boolean\ndefault: false\ndescription: >\nIndicates that the online charging method shall never be used for any PCC rule activated\nduring the lifetime of the PDU session.\npolicyCtrlReqTriggers:\ntype: array\nitems:\n$ref: '#/components/schemas/PolicyControlRequestTrigger'\nminItems: 1\ndescription: Defines the policy control request triggers subscribed by the PCF.\nnullable: true\nlastReqRuleData:\ntype: array\nitems:\n$ref: '#/components/schemas/RequestedRuleData'\nminItems: 1\ndescription: Defines the last list of rule control data requested by the PCF.\nlastReqUsageData:\n$ref: '#/components/schemas/RequestedUsageData'\npraInfos:\ntype: object\nadditionalProperties:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PresenceInfoRm'\nminProperties: 1\ndescription: >\nMap of PRA information. The praId attribute within the PresenceInfo data type is the key\nof the map.\nnullable: true\nipv4Index:\n$ref: 'TS29519_Policy_Data.yaml#/components/schemas/IpIndex'\nipv6Index:\n$ref: 'TS29519_Policy_Data.yaml#/components/schemas/IpIndex'\nqosFlowUsage:\n$ref: '#/components/schemas/QosFlowUsage'\nrelCause:\n$ref: '#/components/schemas/SmPolicyAssociationReleaseCause'\nsuppFeat:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\ntsnBridgeManCont:\n$ref: '#/components/schemas/BridgeManagementContainer'\ntsnPortManContDstt:\n$ref: '#/components/schemas/PortManagementContainer'\ntsnPortManContNwtts:\ntype: array\nitems:\n$ref: '#/components/schemas/PortManagementContainer'\nminItems: 1\ntscNotifUri:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'\ntscNotifCorreId:\ntype: string\ndescription: >\nCorrelation identifier for TSC management information notifications.\nredSessIndication:\ntype: boolean\ndescription: >\nIndicates whether the PDU session is a redundant PDU session. If absent it means the PDU\nsession is not a redundant PDU session.\nuePolCont:\n$ref: '#/components/schemas/UePolicyContainer'\nsliceUsgCtrlInfo:\n$ref: '#/components/schemas/SliceUsgCtrlInfo'\nvplmnOffload:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/VplmnOffloadingInfo'\n\nSmPolicyNotification:\ndescription: Represents a notification on the update of the SM policies.\ntype: object\nproperties:\nresourceUri:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'\nsmPolicyDecision:\n$ref: '#/components/schemas/SmPolicyDecision'\n\nPccRule:\ndescription: Contains a PCC rule information.\ntype: object\nproperties:\nflowInfos:\ntype: array\nitems:\n$ref: '#/components/schemas/FlowInformation'\nminItems: 1\ndescription: An array of IP flow packet filter information.\nappId:\ntype: string\ndescription: A reference to the application detection filter configured at the UPF.\nappDescriptor:\n$ref: '#/components/schemas/ApplicationDescriptor'\ncontVer:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/ContentVersion'\nprotoDesc:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/ProtoDesc'\npccRuleId:\ntype: string\ndescription: Univocally identifies the PCC rule within a PDU session.\nprecedence:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\nafSigProtocol:\n$ref: '#/components/schemas/AfSigProtocol'\nappReloc:\ntype: boolean\ndescription: Indication of application relocation possibility.\neasRedisInd:\ntype: boolean\ndescription: Indicates the EAS rediscovery is required.\nrefQosData:\ntype: array\nitems:\ntype: string\nminItems: 1\nmaxItems: 1\ndescription: >\nA reference to the QosData policy decision type. It is the qosId described in\nclause 5.6.2.8.\nrefAltQosParams:\ntype: array\nitems:\ntype: string\nminItems: 1\ndescription: >\nA Reference to the QosData policy decision type for the Alternative QoS parameter sets\nof the service data flow.\nrefTcData:\ntype: array\nitems:\ntype: string\nminItems: 1\nmaxItems: 1\ndescription: >\nA reference to the TrafficControlData policy decision type. It is the tcId described in\nclause 5.6.2.10.\nrefChgData:\ntype: array\nitems:\ntype: string\nminItems: 1\nmaxItems: 1\ndescription: >\nA reference to the ChargingData policy decision type. It is the chgId described in\nclause 5.6.2.11.\nnullable: true\nrefChgN3gData:\ntype: array\nitems:\ntype: string\nminItems: 1\nmaxItems: 1\ndescription: >\nA reference to the ChargingData policy decision type only applicable to Non-3GPP access\nif \"ATSSS\" feature is supported. It is the chgId described in clause 5.6.2.11.\nnullable: true\nrefUmData:\ntype: array\nitems:\ntype: string\nminItems: 1\nmaxItems: 1\ndescription: >\nA reference to UsageMonitoringData policy decision type. It is the umId described in\nclause 5.6.2.12.\nnullable: true\nrefUmN3gData:\ntype: array\nitems:\ntype: string\nminItems: 1\nmaxItems: 1\ndescription: >\nA reference to UsageMonitoringData policy decision type only applicable to Non-3GPP\naccess if \"ATSSS\" feature is supported. It is the umId described in clause 5.6.2.12.\nnullable: true\nrefCondData:\ntype: string\ndescription: >\nA reference to the condition data. It is the condId described in clause 5.6.2.9.\nnullable: true\nrefQosMon:\ntype: array\nitems:\ntype: string\nminItems: 1\nmaxItems: 1\ndescription: >\nA reference to the QosMonitoringData policy decision type. It is the qmId described in\nclause 5.6.2.40.\nnullable: true\naddrPreserInd:\ntype: boolean\nnullable: true\ntscaiInputDl:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/TscaiInputContainer'\ntscaiInputUl:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/TscaiInputContainer'\ntscaiTimeDom:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\ncapBatAdaptation:\ntype: boolean\ndescription: >\nIndicates the capability for AF to adjust the burst sending time, when it is provided\nand set to \"true\". The default value is \"false\" if omitted.\nddNotifCtrl:\n$ref: '#/components/schemas/DownlinkDataNotificationControl'\nddNotifCtrl2:\n$ref: '#/components/schemas/DownlinkDataNotificationControlRm'\ndisUeNotif:\ntype: boolean\nnullable: true\npackFiltAllPrec:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\nnscSuppFeats:\ntype: object\nadditionalProperties:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\nminProperties: 1\ndescription: >\nIdentifies a list of Network Function Service Consumer supported per service. The key\nused in this map for each entry is the ServiceName value as defined in\n3GPP TS 29.510[29].\ncallInfo:\n$ref: '#/components/schemas/CallInfo'\ntraffParaData:\n$ref: '#/components/schemas/TrafficParaData'\nrequired:\n- pccRuleId\nnullable: true\n\nSessionRule:\ndescription: Contains session level policy information.\ntype: object\nproperties:\nauthSessAmbr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ambr'\nauthDefQos:\n$ref: '#/components/schemas/AuthorizedDefaultQos'\nsessRuleId:\ntype: string\ndescription: Univocally identifies the session rule within a PDU session.\nrefUmData:\ntype: string\ndescription: >\nA reference to UsageMonitoringData policy decision type. It is the umId described in\nclause 5.6.2.12.\nnullable: true\nrefUmN3gData:\ntype: string\ndescription: >\nA reference to UsageMonitoringData policy decision type to apply for Non-3GPP access. It\nis the umId described in clause 5.6.2.12.\nnullable: true\nrefCondData:\ntype: string\ndescription: >\nA reference to the condition data. It is the condId described in clause 5.6.2.9.\nnullable: true\nrequired:\n- sessRuleId\nnullable: true\n\nQosData:\ndescription: Contains the QoS parameters.\ntype: object\nproperties:\nqosId:\ntype: string\ndescription: Univocally identifies the QoS control policy data within a PDU session.\n5qi:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/5Qi'\nmaxbrUl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRateRm'\nmaxbrDl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRateRm'\ngbrUl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRateRm'\ngbrDl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRateRm'\narp:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Arp'\nqnc:\ntype: boolean\ndescription: >\nIndicates whether notifications are requested from 3GPP NG-RAN when the GFBR can no longer\n(or again) be guaranteed for a QoS Flow during the lifetime of the QoS Flow.\npriorityLevel:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/5QiPriorityLevelRm'\naverWindow:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AverWindowRm'\nmaxDataBurstVol:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/MaxDataBurstVolRm'\nreflectiveQos:\ntype: boolean\ndescription: >\nIndicates whether the QoS information is reflective for the corresponding service data\nflow.\nsharingKeyDl:\ntype: string\ndescription: >\nIndicates, by containing the same value, what PCC rules may share resource in downlink\ndirection.\nsharingKeyUl:\ntype: string\ndescription: >\nIndicates, by containing the same value, what PCC rules may share resource in uplink\ndirection.\nmaxPacketLossRateDl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PacketLossRateRm'\nmaxPacketLossRateUl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PacketLossRateRm'\ndefQosFlowIndication:\ntype: boolean\ndescription: >\nIndicates that the dynamic PCC rule shall always have its binding with the QoS Flow\nassociated with the default QoS rule\nextMaxDataBurstVol:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ExtMaxDataBurstVolRm'\npacketDelayBudget:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PacketDelBudget'\npacketErrorRate:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PacketErrRate'\npduSetQos:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PduSetQosParaRm'\nrequired:\n- qosId\nnullable: true\n\nConditionData:\ndescription: Contains conditions of applicability for a rule.\ntype: object\nproperties:\ncondId:\ntype: string\ndescription: Uniquely identifies the condition data within a PDU session.\nactivationTime:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DateTimeRm'\ndeactivationTime:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DateTimeRm'\naccessType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'\nratType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/RatType'\nrequired:\n- condId\nnullable: true\n\nTrafficControlData:\ndescription: >\nContains parameters determining how flows associated with a PCC Rule are treated (e.g.\nblocked, redirected, etc).\ntype: object\nproperties:\ntcId:\ntype: string\ndescription: Univocally identifies the traffic control policy data within a PDU session.\nl4sInd:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/UplinkDownlinkSupport'\nflowStatus:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/FlowStatus'\nredirectInfo:\n$ref: '#/components/schemas/RedirectInformation'\naddRedirectInfo:\ntype: array\nitems:\n$ref: '#/components/schemas/RedirectInformation'\nminItems: 1\nmuteNotif:\ntype: boolean\ndescription: Indicates whether applicat'on's start or stop notification is to be muted.\ntrafficSteeringPolIdDl:\ntype: string\ndescription: >\nReference to a pre-configured traffic steering policy for downlink traffic at the SMF.\nnullable: true\ntrafficSteeringPolIdUl:\ntype: string\ndescription: >\nReference to a pre-configured traffic steering policy for uplink traffic at the SMF.\nnullable: true\nmetadata:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Metadata'\nrouteToLocs:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/RouteToLocation'\nminItems: 1\ndescription: A list of location which the traffic shall be routed to for the AF request\nnullable: true\nmaxAllowedUpLat:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/UintegerRm'\neasIpReplaceInfos:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/EasIpReplacementInfo'\nminItems: 1\ndescription: Contains EAS IP replacement information.\nnullable: true\ntraffCorreInd:\ntype: boolean\ntfcCorreInfo:\n$ref: 'TS29519_Application_Data.yaml#/components/schemas/TrafficCorrelationInfo'\nsimConnInd:\ntype: boolean\ndescription: >\nIndicates whether simultaneous connectivity should be temporarily maintained for the\nsource and target PSA.\nsimConnTerm:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSec'\nupPathChgEvent:\n$ref: '#/components/schemas/UpPathChgEvent'\nsteerFun:\n$ref: '#/components/schemas/SteeringFunctionality'\nsteerModeDl:\n$ref: '#/components/schemas/SteeringMode'\nsteerModeUl:\n$ref: '#/components/schemas/SteeringMode'\nmulAccCtrl:\n$ref: '#/components/schemas/MulticastAccessControl'\ncandDnaiInd:\ntype: boolean\ndescription: >\nIndication of reporting candidate DNAI(s). If it is included and set to \"true\", the\ncandidate DNAI(s) for the PDU session need to be reported. Otherwise set to \"false\" or\nomitted.\ndatEndMarkInd:\ntype: boolean\ndescription: >\nThe data burst end marking is enabled if it is set to \"true\". Default value is \"false\" if\nomitted.\nrequired:\n- tcId\nnullable: true\n\nChargingData:\ndescription: Contains charging related parameters.\ntype: object\nproperties:\nchgId:\ntype: string\ndescription: Univocally identifies the charging control policy data within a PDU session.\nmeteringMethod:\n$ref: '#/components/schemas/MeteringMethod'\noffline:\ntype: boolean\ndescription: >\nIndicates the offline charging is applicable to the PCC rule when it is included and set\nto true.\nonline:\ntype: boolean\ndescription: >\nIndicates the online charging is applicable to the PCC rule when it is included and set\nto true.\nsdfHandl:\ntype: boolean\ndescription: >\nIndicates whether the service data flow is allowed to start while the SMF is waiting for\nthe response to the credit request.\nratingGroup:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/RatingGroup'\nreportingLevel:\n$ref: '#/components/schemas/ReportingLevel'\nserviceId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ServiceId'\nsponsorId:\ntype: string\ndescription: Indicates the sponsor identity.\nappSvcProvId:\ntype: string\ndescription: Indicates the application service provider identity.\nafChargingIdentifier:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ChargingId'\nafChargId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ApplicationChargingId'\nrequired:\n- chgId\nnullable: true\n\nUsageMonitoringData:\ndescription: Contains usage monitoring related control information.\ntype: object\nproperties:\numId:\ntype: string\ndescription: Univocally identifies the usage monitoring policy data within a PDU session.\nvolumeThreshold:\n$ref: 'TS29122_CommonData.yaml#/components/schemas/VolumeRm'\nvolumeThresholdUplink:\n$ref: 'TS29122_CommonData.yaml#/components/schemas/VolumeRm'\nvolumeThresholdDownlink:\n$ref: 'TS29122_CommonData.yaml#/components/schemas/VolumeRm'\ntimeThreshold:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSecRm'\nmonitoringTime:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DateTimeRm'\nnextVolThreshold:\n$ref: 'TS29122_CommonData.yaml#/components/schemas/VolumeRm'\nnextVolThresholdUplink:\n$ref: 'TS29122_CommonData.yaml#/components/schemas/VolumeRm'\nnextVolThresholdDownlink:\n$ref: 'TS29122_CommonData.yaml#/components/schemas/VolumeRm'\nnextTimeThreshold:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSecRm'\ninactivityTime:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSecRm'\nexUsagePccRuleIds:\ntype: array\nitems:\ntype: string\nminItems: 1\ndescription: >\nContains the PCC rule identifier(s) which corresponding service data flow(s) shall be\nexcluded from PDU Session usage monitoring. It is only included in the\nUsageMonitoringData instance for session level usage monitoring.\nnullable: true\nrequired:\n- umId\nnullable: true\n\nRedirectInformation:\ndescription: Contains the redirect information.\ntype: object\nproperties:\nredirectEnabled:\ntype: boolean\ndescription: Indicates the redirect is enable.\nredirectAddressType:\n$ref: '#/components/schemas/RedirectAddressType'\nredirectServerAddress:\ntype: string\ndescription: >\nIndicates the address of the redirect server. If \"redirectAddressType\" attribute\nindicates the IPV4_ADDR, the encoding is the same as the Ipv4Addr data type defined in\n3GPP TS 29.571.If \"redirectAddressType\" attribute indicates the IPV6_ADDR, the encoding\nis the same as the Ipv6Addr data type defined in 3GPP TS 29.571.If \"redirectAddressType\"\nattribute indicates the URL or SIP_URI, the encoding is the same as the Uri data type\ndefined in 3GPP TS 29.571.\n\nFlowInformation:\ndescription: Contains the flow information.\ntype: object\nproperties:\nflowDescription:\n$ref: '#/components/schemas/FlowDescription'\nethFlowDescription:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/EthFlowDescription'\npackFiltId:\ntype: string\ndescription: An identifier of packet filter.\npacketFilterUsage:\ntype: boolean\ndescription: The packet shall be sent to the UE.\ntosTrafficClass:\ntype: string\ndescription: >\nContains the Ipv4 Type-of-Service and mask field or the Ipv6 Traffic-Class field and\nmask field.\nnullable: true\nspi:\ntype: string\ndescription: the security parameter index of the IPSec packet.\nnullable: true\nflowLabel:\ntype: string\ndescription: the Ipv6 flow label header field.\nnullable: true\nflowDirection:\n$ref: '#/components/schemas/FlowDirectionRm'\n\nSmPolicyDeleteData:\ndescription: >\nContains the parameters to be sent to the PCF when an individual SM policy is deleted.\ntype: object\nproperties:\nuserLocationInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/UserLocation'\nueTimeZone:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/TimeZone'\nservingNetwork:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PlmnIdNid'\nuserLocationInfoTime:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DateTime'\nranNasRelCauses:\ntype: array\nitems:\n$ref: '#/components/schemas/RanNasRelCause'\nminItems: 1\ndescription: Contains the RAN and/or NAS release cause.\naccuUsageReports:\ntype: array\nitems:\n$ref: '#/components/schemas/AccuUsageReport'\nminItems: 1\ndescription: Contains the usage report\npduSessRelCause:\n$ref: '#/components/schemas/PduSessionRelCause'\n\nQosCharacteristics:\ndescription: Contains QoS characteristics for a non-standardized or a non-configured 5QI.\ntype: object\nproperties:\n5qi:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/5Qi'\nresourceType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/QosResourceType'\npriorityLevel:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/5QiPriorityLevel'\npacketDelayBudget:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PacketDelBudget'\npacketErrorRate:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PacketErrRate'\naveragingWindow:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AverWindow'\nmaxDataBurstVol:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/MaxDataBurstVol'\nextMaxDataBurstVol:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ExtMaxDataBurstVol'\nrequired:\n- 5qi\n- resourceType\n- priorityLevel\n- packetDelayBudget\n- packetErrorRate\n\nChargingInformation:\ndescription: Contains the addresses of the charging functions.\ntype: object\nproperties:\nprimaryChfAddress:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'\nsecondaryChfAddress:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'\nprimaryChfSetId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/NfSetId'\nprimaryChfInstanceId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'\nsecondaryChfSetId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/NfSetId'\nsecondaryChfInstanceId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'\nrequired:\n- primaryChfAddress\n\nAccuUsageReport:\ndescription: Contains the accumulated usage report information.\ntype: object\nproperties:\nrefUmIds:\ntype: string\ndescription: >\nAn id referencing UsageMonitoringData objects associated with this usage report.\nvolUsage:\n$ref: 'TS29122_CommonData.yaml#/components/schemas/Volume'\nvolUsageUplink:\n$ref: 'TS29122_CommonData.yaml#/components/schemas/Volume'\nvolUsageDownlink:\n$ref: 'TS29122_CommonData.yaml#/components/schemas/Volume'\ntimeUsage:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSec'\nnextVolUsage:\n$ref: 'TS29122_CommonData.yaml#/components/schemas/Volume'\nnextVolUsageUplink:\n$ref: 'TS29122_CommonData.yaml#/components/schemas/Volume'\nnextVolUsageDownlink:\n$ref: 'TS29122_CommonData.yaml#/components/schemas/Volume'\nnextTimeUsage:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSec'\nrequired:\n- refUmIds\n\nSmPolicyUpdateContextData:\ndescription: >\nContains the policy control request trigger(s) that were met and the corresponding new\nvalue(s) or the error report of the policy enforcement.\ntype: object\nproperties:\nrepPolicyCtrlReqTriggers:\ntype: array\nitems:\n$ref: '#/components/schemas/PolicyControlRequestTrigger'\nminItems: 1\ndescription: The policy control reqeust trigges which are met.\naccNetChIds:\ntype: array\nitems:\n$ref: '#/components/schemas/AccNetChId'\nminItems: 1\ndescription: >\nIndicates the access network charging identifier for the PCC rule(s) or whole PDU\nsession.\naccessType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'\nratType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/RatType'\naddAccessInfo:\n$ref: '#/components/schemas/AdditionalAccessInfo'\nrelAccessInfo:\n$ref: '#/components/schemas/AdditionalAccessInfo'\nservingNetwork:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PlmnIdNid'\nuserLocationInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/UserLocation'\nueTimeZone:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/TimeZone'\nrelIpv4Address:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr'\nipv4Address:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr'\nipDomain:\ntype: string\ndescription: Indicates the IPv4 address domain\nipv6AddressPrefix:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix'\nrelIpv6AddressPrefix:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix'\naddIpv6AddrPrefixes:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix'\naddRelIpv6AddrPrefixes:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix'\nmultiIpv6Prefixes:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix'\nminItems: 1\ndescription: The multiple allocated IPv6 prefixes of the served UE.\nmultiRelIpv6Prefixes:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Prefix'\nminItems: 1\ndescription: The multiple released IPv6 prefixes of the served UE.\nrelUeMac:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/MacAddr48'\nueMac:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/MacAddr48'\nsubsSessAmbr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ambr'\nauthProfIndex:\ntype: string\ndescription: Indicates the DN-AAA authorization profile index\nsubsDefQos:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SubscribedDefaultQos'\nvplmnQos:\n$ref: 'TS29502_Nsmf_PDUSession.yaml#/components/schemas/VplmnQos'\nvplmnQosNotApp:\ntype: boolean\ndescription: >\nIf it is included and set to true, indicates that the QoS constraints in the VPLMN are\nnot applicable.\nnumOfPackFilter:\ntype: integer\ndescription: Contains the number of supported packet filter for signalled QoS rules.\naccuUsageReports:\ntype: array\nitems:\n$ref: '#/components/schemas/AccuUsageReport'\nminItems: 1\ndescription: Contains the usage report\n3gppPsDataOffStatus:\ntype: boolean\ndescription: >\nIf it is included and set to true, the 3GPP PS Data Off is activated by the UE.\nappDetectionInfos:\ntype: array\nitems:\n$ref: '#/components/schemas/AppDetectionInfo'\nminItems: 1\ndescription: >\nReport the start/stop of the application traffic and detected SDF descriptions\nif applicable.\nruleReports:\ntype: array\nitems:\n$ref: '#/components/schemas/RuleReport'\nminItems: 1\ndescription: Used to report the PCC rule failure.\nsessRuleReports:\ntype: array\nitems:\n$ref: '#/components/schemas/SessionRuleReport'\nminItems: 1\ndescription: Used to report the session rule failure.\nqncReports:\ntype: array\nitems:\n$ref: '#/components/schemas/QosNotificationControlInfo'\nminItems: 1\ndescription: QoS Notification Control information.\nqosMonReports:\ntype: array\nitems:\n$ref: '#/components/schemas/QosMonitoringReport'\nminItems: 1\nqosMonDatRateReps:\ntype: array\nitems:\n$ref: '#/components/schemas/QosMonitoringReport'\nminItems: 1\nuserLocationInfoTime:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DateTime'\nrepPraInfos:\ntype: object\nadditionalProperties:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PresenceInfo'\nminProperties: 1\ndescription: >\nReports the changes of presence reporting area. The praId attribute within the\nPresenceInfo data type is the key of the map.\nueInitResReq:\n$ref: '#/components/schemas/UeInitiatedResourceRequest'\nrefQosIndication:\ntype: boolean\ndescription: >\nIf it is included and set to true, the reflective QoS is supported by the UE. If it is\nincluded and set to false, the reflective QoS is revoked by the UE.\nqosFlowUsage:\n$ref: '#/components/schemas/QosFlowUsage'\ncreditManageStatus:\n$ref: '#/components/schemas/CreditManagementStatus'\nservNfId:\n$ref: '#/components/schemas/ServingNfIdentity'\ntraceReq:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/TraceData'\nmaPduInd:\n$ref: '#/components/schemas/MaPduIndication'\natsssCapab:\n$ref: '#/components/schemas/AtsssCapability'\ntsnBridgeInfo:\n$ref: '#/components/schemas/TsnBridgeInfo'\ntsnBridgeManCont:\n$ref: '#/components/schemas/BridgeManagementContainer'\ntsnPortManContDstt:\n$ref: '#/components/schemas/PortManagementContainer'\ntsnPortManContNwtts:\ntype: array\nitems:\n$ref: '#/components/schemas/PortManagementContainer'\nminItems: 1\ntscNotifUri:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'\ntscNotifCorreId:\ntype: string\ndescription: >\nCorrelation identifier for TSC management information notifications.\nmulAddrInfos:\ntype: array\nitems:\n$ref: '#/components/schemas/IpMulticastAddressInfo'\nminItems: 1\npolicyDecFailureReports:\ntype: array\nitems:\n$ref: '#/components/schemas/PolicyDecisionFailureCode'\nminItems: 1\ndescription: Contains the type(s) of failed policy decision and/or condition data.\ninvalidPolicyDecs:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/InvalidParam'\nminItems: 1\ndescription: >\nIndicates the invalid parameters for the reported type(s) of the failed policy decision\nand/or condition data.\ntrafficDescriptors:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DddTrafficDescriptor'\nminItems: 1\npccRuleId:\ntype: string\ndescription: >\nContains the identifier of the PCC rule which is used for traffic detection of event.\ntypesOfNotif:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DlDataDeliveryStatus'\nminItems: 1\ninterGrpIds:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/GroupId'\nminItems: 1\nsatBackhaulCategory:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SatelliteBackhaulCategory'\npcfUeInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PcfUeCallbackInfo'\nnwdafDatas:\ntype: array\nitems:\n$ref: '#/components/schemas/NwdafData'\nminItems: 1\nnullable: true\nanGwStatus:\ntype: boolean\ndescription: >\nWhen it is included and set to true, it indicates that the AN-Gateway has failed and\nthat the PCF should refrain from sending policy decisions to the SMF until it is\ninformed that the AN-Gateway has been recovered.\nuePolCont:\n$ref: '#/components/schemas/UePolicyContainer'\nurspEnfInfo:\n$ref: '#/components/schemas/UrspEnforcementInfo'\nsscMode:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SscMode'\nueReqDnn:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Dnn'\nredundantPduSessionInfo:\n$ref: 'TS29502_Nsmf_PDUSession.yaml#/components/schemas/RedundantPduSessionInformation'\nl4sReports:\ntype: array\nitems:\n$ref: '#/components/schemas/L4sSupportInfo'\nminItems: 1\ndescription: ECN marking for L4S support availability in 5GS.\nsliceInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Snssai'\nbatOffsetInfo:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/BatOffsetInfo'\nhrsboInd:\ntype: boolean\ndescription: >\nHR-SBO support indication. If present and set to \"true\", it indicates that the HR-SBO is\nsupported. If present and set to \"false\", it indicates that the HR-SBO is not supported.\nallOf:\n- not:\nrequired: [multiIpv6Prefixes, ipv6AddressPrefix]\n- not:\nrequired: [multiIpv6Prefixes, addIpv6AddrPrefixes]\n- not:\nrequired: [multiRelIpv6Prefixes, relIpv6AddressPrefix]\n- not:\nrequired: [multiRelIpv6Prefixes, relAddIpv6AddrPrefixes]\n\nUpPathChgEvent:\ndescription: Contains the UP path change event subscription from the AF.\ntype: object\nproperties:\nnotificationUri:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'\nnotifCorreId:\ntype: string\ndescription: >\nIt is used to set the value of Notification Correlation ID in the notification sent by\nthe SMF.\ndnaiChgType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DnaiChangeType'\nafAckInd:\ntype: boolean\nrequired:\n- notificationUri\n- notifCorreId\n- dnaiChgType\nnullable: true\n\nTerminationNotification:\ndescription: Represents a Termination Notification.\ntype: object\nproperties:\nresourceUri:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'\ncause:\n$ref: '#/components/schemas/SmPolicyAssociationReleaseCause'\nrequired:\n- resourceUri\n- cause\n\nAppDetectionInfo:\ndescription: Contains the detected application's traffic information.\ntype: object\nproperties:\nappId:\ntype: string\ndescription: A reference to the application detection filter configured at the UPF\ninstanceId:\ntype: string\ndescription: >\nIdentifier sent by the SMF in order to allow correlation of application Start and Stop\nevents to the specific service data flow description, if service data flow descriptions\nare deducible.\nsdfDescriptions:\ntype: array\nitems:\n$ref: '#/components/schemas/FlowInformation'\nminItems: 1\ndescription: Contains the detected service data flow descriptions if they are deducible.\nrequired:\n- appId\n\nAccNetChId:\ndescription: >\nContains the access network charging identifier for the PCC rule(s) or for the whole\nPDU session.\ntype: object\nproperties:\naccNetChaIdValue:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ChargingId'\naccNetChargId:\ntype: string\ndescription: A character string containing the access network charging id.\nrefPccRuleIds:\ntype: array\nitems:\ntype: string\nminItems: 1\ndescription: >\nContains the identifier of the PCC rule(s) associated to the provided Access Network\nCharging Identifier.\nsessionChScope:\ntype: boolean\ndescription: >\nWhen it is included and set to true, indicates the Access Network Charging Identifier\napplies to the whole PDU Session\noneOf:\n- required: [accNetChaIdValue]\n- required: [accNetChargId]\n\nAccNetChargingAddress:\ndescription: Describes the network entity within the access network performing charging\ntype: object\nanyOf:\n- required: [anChargIpv4Addr]\n- required: [anChargIpv6Addr]\nproperties:\nanChargIpv4Addr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr'\nanChargIpv6Addr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Addr'\n\nRequestedRuleData:\ndescription: >\nContains rule data requested by the PCF to receive information associated with PCC rule(s).\ntype: object\nproperties:\nrefPccRuleIds:\ntype: array\nitems:\ntype: string\nminItems: 1\ndescription: >\nAn array of PCC rule id references to the PCC rules associated with the control data.\nreqData:\ntype: array\nitems:\n$ref: '#/components/schemas/RequestedRuleDataType'\nminItems: 1\ndescription: >\nArray of requested rule data type elements indicating what type of rule data is\nrequested for the corresponding referenced PCC rules.\nrequired:\n- refPccRuleIds\n- reqData\n\nRequestedUsageData:\ndescription: >\nContains usage data requested by the PCF requesting usage reports for the corresponding\nusage monitoring data instances.\ntype: object\nproperties:\nrefUmIds:\ntype: array\nitems:\ntype: string\nminItems: 1\ndescription: >\nAn array of usage monitoring data id references to the usage monitoring data instances\nfor which the PCF is requesting a usage report. This attribute shall only be provided\nwhen allUmIds is not set to true.\nallUmIds:\ntype: boolean\ndescription: >\nThis boolean indicates whether requested usage data applies to all usage monitoring data\ninstances. When it's not included, it means requested usage data shall only apply to the\nusage monitoring data instances referenced by the refUmIds attribute.\n\nUeCampingRep:\ndescription: >\nContains the current applicable values corresponding to the policy control request triggers.\ntype: object\nproperties:\naccessType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'\nratType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/RatType'\nservNfId:\n$ref: '#/components/schemas/ServingNfIdentity'\nservingNetwork:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PlmnIdNid'\nuserLocationInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/UserLocation'\nueTimeZone:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/TimeZone'\nnetLocAccSupp:\n$ref: '#/components/schemas/NetLocAccessSupport'\nsatBackhaulCategory:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SatelliteBackhaulCategory'\nurspEnfInfo:\n$ref: '#/components/schemas/UrspEnforcementInfo'\nsscMode:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SscMode'\nueReqDnn:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Dnn'\nredundantPduSessionInfo:\n$ref: 'TS29502_Nsmf_PDUSession.yaml#/components/schemas/RedundantPduSessionInformation'\n\nRuleReport:\ndescription: Reports the status of PCC.\ntype: object\nproperties:\npccRuleIds:\ntype: array\nitems:\ntype: string\nminItems: 1\ndescription: Contains the identifier of the affected PCC rule(s).\nruleStatus:\n$ref: '#/components/schemas/RuleStatus'\ncontVers:\ntype: array\nitems:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/ContentVersion'\nminItems: 1\ndescription: Indicates the version of a PCC rule.\nfailureCode:\n$ref: '#/components/schemas/FailureCode'\nretryAfter:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\nfinUnitAct:\n$ref: 'TS32291_Nchf_ConvergedCharging.yaml#/components/schemas/FinalUnitAction'\nranNasRelCauses:\ntype: array\nitems:\n$ref: '#/components/schemas/RanNasRelCause'\nminItems: 1\ndescription: indicates the RAN or NAS release cause code information.\naltQosParamId:\ntype: string\ndescription: >\nIndicates the alternative QoS parameter set that the NG-RAN can guarantee. It is\nincluded during the report of successfull resource allocation and indicates that NG-RAN\nused an alternative QoS profile because the requested QoS could not be allocated..\nrequired:\n- pccRuleIds\n- ruleStatus\n\nRanNasRelCause:\ndescription: Contains the RAN/NAS release cause.\ntype: object\nproperties:\nngApCause:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/NgApCause'\n5gMmCause:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/5GMmCause'\n5gSmCause:\n$ref: '#/components/schemas/5GSmCause'\nepsCause:\n$ref: '#/components/schemas/EpsRanNasRelCause'\n\nUeInitiatedResourceRequest:\ndescription: Indicates that a UE requests specific QoS handling for the selected SDF.\ntype: object\nproperties:\npccRuleId:\ntype: string\nruleOp:\n$ref: '#/components/schemas/RuleOperation'\nprecedence:\ntype: integer\npackFiltInfo:\ntype: array\nitems:\n$ref: '#/components/schemas/PacketFilterInfo'\nminItems: 1\nreqQos:\n$ref: '#/components/schemas/RequestedQos'\nrequired:\n- ruleOp\n- packFiltInfo\n\nPacketFilterInfo:\ndescription: >\nContains the information from a single packet filter sent from the SMF to the PCF.\ntype: object\nproperties:\npackFiltId:\ntype: string\ndescription: An identifier of packet filter.\npackFiltCont:\n$ref: '#/components/schemas/PacketFilterContent'\ntosTrafficClass:\ntype: string\ndescription: >\nContains the Ipv4 Type-of-Service and mask field or the Ipv6 Traffic-Class field and\nmask field.\nspi:\ntype: string\ndescription: The security parameter index of the IPSec packet.\nflowLabel:\ntype: string\ndescription: The Ipv6 flow label header field.\nflowDirection:\n$ref: '#/components/schemas/FlowDirection'\n\nRequestedQos:\ndescription: Contains the QoS information requested by the UE.\ntype: object\nproperties:\n5qi:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/5Qi'\ngbrUl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRate'\ngbrDl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRate'\nrequired:\n- 5qi\n\nQosNotificationControlInfo:\ndescription: Contains the QoS Notification Control Information.\ntype: object\nproperties:\nrefPccRuleIds:\ntype: array\nitems:\ntype: string\nminItems: 1\ndescription: >\nAn array of PCC rule id references to the PCC rules associated with the QoS notification\ncontrol info.\nnotifType:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/QosNotifType'\ncontVer:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/ContentVersion'\naltQosParamId:\ntype: string\ndescription: >\nIndicates the alternative QoS parameter set the NG-RAN can guarantee. When it is omitted\nand the notifType attribute is set to NOT_GUAARANTEED it indicates that the lowest\npriority alternative QoS profile could not be fulfilled.\naltQosNotSuppInd:\ntype: boolean\ndescription: >\nWhen present and set to true it indicates that the Alternative QoS profiles are not\nsupported by NG-RAN.\nrequired:\n- refPccRuleIds\n- notifType\n\nPartialSuccessReport:\ndescription: >\nIncludes the information reported by the SMF when some of the PCC rules and/or session rules\nand/or policy decision and/or condition data are not successfully installed/activated or\nstored.\ntype: object\nproperties:\nfailureCause:\n$ref: '#/components/schemas/FailureCause'\nruleReports:\ntype: array\nitems:\n$ref: '#/components/schemas/RuleReport'\nminItems: 1\ndescription: >\nInformation about the PCC rules provisioned by the PCF not successfully\ninstalled/activated.\nsessRuleReports:\ntype: array\nitems:\n$ref: '#/components/schemas/SessionRuleReport'\nminItems: 1\ndescription: >\nInformation about the session rules provisioned by the PCF not successfully installed.\nueCampingRep:\n$ref: '#/components/schemas/UeCampingRep'\npolicyDecFailureReports:\ntype: array\nitems:\n$ref: '#/components/schemas/PolicyDecisionFailureCode'\nminItems: 1\ndescription: Contains the type(s) of failed policy decision and/or condition data.\ninvalidPolicyDecs:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/InvalidParam'\nminItems: 1\ndescription: >\nIndicates the invalid parameters for the reported type(s) of the failed policy decision\nand/or condition data.\nrequired:\n- failureCause\n\nAuthorizedDefaultQos:\ndescription: Represents the Authorized Default QoS.\ntype: object\nproperties:\n5qi:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/5Qi'\narp:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Arp'\npriorityLevel:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/5QiPriorityLevelRm'\naverWindow:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AverWindowRm'\nmaxDataBurstVol:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/MaxDataBurstVolRm'\nmaxbrUl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRateRm'\nmaxbrDl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRateRm'\ngbrUl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRateRm'\ngbrDl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRateRm'\nextMaxDataBurstVol:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ExtMaxDataBurstVolRm'\n\nErrorReport:\ndescription: Contains the rule,policy decision and/or condition data error reports.\ntype: object\nproperties:\nerror:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\nruleReports:\ntype: array\nitems:\n$ref: '#/components/schemas/RuleReport'\nminItems: 1\ndescription: Used to report the PCC rule failure.\nsessRuleReports:\ntype: array\nitems:\n$ref: '#/components/schemas/SessionRuleReport'\nminItems: 1\ndescription: Used to report the session rule failure.\npolDecFailureReports:\ntype: array\nitems:\n$ref: '#/components/schemas/PolicyDecisionFailureCode'\nminItems: 1\ndescription: Used to report failure of the policy decision and/or condition data.\ninvalidPolicyDecs:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/InvalidParam'\nminItems: 1\ndescription: >\nIndicates the invalid parameters for the reported type(s) of the failed policy decision\nand/or condition data.\n\nSessionRuleReport:\ndescription: Represents reporting of the status of a session rule.\ntype: object\nproperties:\nruleIds:\ntype: array\nitems:\ntype: string\nminItems: 1\ndescription: Contains the identifier of the affected session rule(s).\nruleStatus:\n$ref: '#/components/schemas/RuleStatus'\nsessRuleFailureCode:\n$ref: '#/components/schemas/SessionRuleFailureCode'\npolicyDecFailureReports:\ntype: array\nitems:\n$ref: '#/components/schemas/PolicyDecisionFailureCode'\nminItems: 1\ndescription: Contains the type(s) of failed policy decision and/or condition data.\nrequired:\n- ruleIds\n- ruleStatus\n\nServingNfIdentity:\ndescription: Contains the serving Network Function identity.\ntype: object\nproperties:\nservNfInstId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'\nguami:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Guami'\nanGwAddr:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/AnGwAddress'\nsgsnAddr:\n$ref: '#/components/schemas/SgsnAddress'\n\nSteeringMode:\ndescription: Contains the steering mode value and parameters determined by the PCF.\ntype: object\nproperties:\nsteerModeValue:\n$ref: '#/components/schemas/SteerModeValue'\nactive:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'\nstandby:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AccessTypeRm'\n3gLoad:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\nprioAcc:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'\nthresValue:\n$ref: '#/components/schemas/ThresholdValue'\nsteerModeInd:\n$ref: '#/components/schemas/SteerModeIndicator'\nprimary:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AccessTypeRm'\n\nrequired:\n- steerModeValue\n\nAdditionalAccessInfo:\ndescription: >\nIndicates the combination of additional Access Type and RAT Type for a MA PDU session.\ntype: object\nproperties:\naccessType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'\nratType:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/RatType'\nrequired:\n- accessType\n\nQosMonitoringData:\ndescription: Contains QoS monitoring related control information.\ntype: object\nproperties:\nqmId:\ntype: string\ndescription: Univocally identifies the QoS monitoring policy data within a PDU session.\nreqQosMonParams:\ntype: array\nitems:\n$ref: '#/components/schemas/RequestedQosMonitoringParameter'\nminItems: 1\ndescription: >\nindicates the QoS information to be monitored when the QoS Monitoring is enabled for\nthe service data flow.\nrepFreqs:\ntype: array\nitems:\n$ref: '#/components/schemas/ReportingFrequency'\nminItems: 1\nrepThreshDl:\ntype: integer\ndescription: Indicates the period of time in units of miliiseconds for DL packet delay.\nnullable: true\nrepThreshUl:\ntype: integer\ndescription: Indicates the period of time in units of miliiseconds for UL packet delay.\nnullable: true\nrepThreshRp:\ntype: integer\ndescription: >\nIndicates the period of time in units of miliiseconds for round trip packet delay.\nnullable: true\nconThreshDl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\nnullable: true\nconThreshUl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\nnullable: true\nwaitTime:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSecRm'\nrepPeriod:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSecRm'\nnotifyUri:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/UriRm'\nnotifyCorreId:\ntype: string\nnullable: true\ndirectNotifInd:\ntype: boolean\ndescription: >\nIndicates that the direct event notification sent by UPF to the Local NEF or AF is\nrequested if it is included and set to true.\navrgWndw:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/AverWindowRm'\nrepThreshDatRateUl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRateRm'\nrepThreshDatRateDl:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRateRm'\ndataCollAppId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ApplicationId'\nrequired:\n- qmId\n- reqQosMonParams\n- repFreqs\nnullable: true\n\nQosMonitoringReport:\ndescription: Contains reporting information on QoS monitoring.\ntype: object\nproperties:\nrefPccRuleIds:\ntype: array\nitems:\ntype: string\nminItems: 1\ndescription: >\nAn array of PCC rule id references to the PCC rules associated with the QoS monitoring\nreport.\nulDelays:\ntype: array\nitems:\ntype: integer\nminItems: 1\ndlDelays:\ntype: array\nitems:\ntype: integer\nminItems: 1\nrtDelays:\ntype: array\nitems:\ntype: integer\nminItems: 1\npdmf:\ntype: boolean\ndescription: Represents the packet delay measurement failure indicator.\nulDataRate:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRate'\ndlDataRate:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/BitRate'\nulCongInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\ndlCongInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\ncimf:\ntype: boolean\ndescription: >\nCongestion information measurement failure indicator. When set to true, it indicates\nthat a congestion information failure has occurred.Default value is false if omitted.\nrequired:\n- refPccRuleIds\n#\nTsnBridgeInfo:\ndescription: Contains parameters that describe and identify the TSC user plane node.\ntype: object\nproperties:\nbridgeId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uint64'\ndsttAddr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/MacAddr48'\ndsttPortNum:\n$ref: '#/components/schemas/TsnPortNumber'\ndsttResidTime:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\nmtuIpv4:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uint16'\nmtuIpv6:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uint32'\n#\nPortManagementContainer:\ndescription: Contains the port management information container for a port.\ntype: object\nproperties:\nportManCont:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'\nportNum:\n$ref: '#/components/schemas/TsnPortNumber'\nrequired:\n- portManCont\n- portNum\nBridgeManagementContainer:\ndescription: Contains the UMIC.\ntype: object\nproperties:\nbridgeManCont:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'\nrequired:\n- bridgeManCont\nIpMulticastAddressInfo:\ndescription: Contains the IP multicast addressing information.\ntype: object\nproperties:\nsrcIpv4Addr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr'\nipv4MulAddr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr'\nsrcIpv6Addr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Addr'\nipv6MulAddr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Addr'\nDownlinkDataNotificationControl:\ndescription: Contains the downlink data notification control information.\ntype: object\nproperties:\nnotifCtrlInds:\ntype: array\nitems:\n$ref: '#/components/schemas/NotificationControlIndication'\nminItems: 1\ntypesOfNotif:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DlDataDeliveryStatus'\nminItems: 1\nDownlinkDataNotificationControlRm:\ndescription: >\nThis data type is defined in the same way as the DownlinkDataNotificationControl data type,\nbut with the nullable:true property.\ntype: object\nproperties:\nnotifCtrlInds:\ntype: array\nitems:\n$ref: '#/components/schemas/NotificationControlIndication'\nminItems: 1\nnullable: true\ntypesOfNotif:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DlDataDeliveryStatus'\nminItems: 1\nnullable: true\nnullable: true\nThresholdValue:\ndescription: Indicates the threshold value(s) for RTT and/or Packet Loss Rate.\ntype: object\nproperties:\nrttThres:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/UintegerRm'\nplrThres:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PacketLossRateRm'\nnullable: true\nNwdafData:\ndescription: >\nIndicates the list of Analytic ID(s) per NWDAF instance ID used for the PDU Session consumed\nby the SMF.\ntype: object\nproperties:\nnwdafInstanceId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'\nnwdafEvents:\ntype: array\nitems:\n$ref: 'TS29520_Nnwdaf_EventsSubscription.yaml#/components/schemas/NwdafEvent'\nminItems: 1\nrequired:\n- nwdafInstanceId\n\nCallInfo:\ndescription: Identifies the caller and callee information.\ntype: object\nproperties:\ncallingPartyAddrs:\ntype: array\nitems:\ntype: string\nminItems: 1\ncalleeInfo:\n$ref: '#/components/schemas/CalleeInfo'\nnullable: true\n\nCalleeInfo:\ndescription: Identifies the callee information.\ntype: object\nproperties:\ncalledPartyAddr:\ntype: string\nrequestPartyAddrs:\ntype: array\nitems:\ntype: string\nminItems: 1\ncalledAssertIds:\ntype: array\nitems:\ntype: string\nminItems: 1\nnullable: true\n\n#\nTrafficParaData:\ndescription: Contains Traffic Parameter(s) related control information.\ntype: object\nproperties:\nperiodInfo:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/PeriodicityInfo'\nreqTrafficParas:\ntype: array\nitems:\n$ref: '#/components/schemas/TrafficParameterMeas'\nminItems: 1\ndescription: Indicates the traffic parameters to be measured.\nrepFreqs:\ntype: array\nitems:\n$ref: '#/components/schemas/ReportingFrequency'\nminItems: 1\ndescription: Represents the notification method (periodic or on event detection).\ndlN6JitterThr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\nrepPeriod:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSecRm'\nrequired:\n- reqTrafficParas\n\nL4sSupportInfo:\ndescription: Contains the ECN marking for L4S support in 5GS information.\ntype: object\nproperties:\nrefPccRuleIds:\ntype: array\nitems:\ntype: string\nminItems: 1\ndescription: >\nAn array of PCC rule id references to the PCC rules associated with the ECN marking\nfor L4S support info.\nnotifType:\n$ref: 'TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/L4sNotifType'\nrequired:\n- refPccRuleIds\n- notifType\n\n\nSliceUsgCtrlInfo:\ndescription: Represents network slice usage control information.\ntype: object\nproperties:\npduSessInactivTimer:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSecRm'\n\n5GSmCause:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\nEpsRanNasRelCause:\ntype: string\ndescription: Defines the EPS RAN/NAS release cause.\nPacketFilterContent:\ntype: string\ndescription: Defines a packet filter for an IP flow.\nFlowDescription:\ntype: string\ndescription: Defines a packet filter for an IP flow.\nTsnPortNumber:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'\nApplicationDescriptor:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'\nUePolicyContainer:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'\nUrspEnforcementInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'\n\nFlowDirection:\nanyOf:\n- type: string\nenum:\n- DOWNLINK\n- UPLINK\n- BIDIRECTIONAL\n- UNSPECIFIED\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates the direction of the service data flow.\nPossible values are:\n- DOWNLINK: The corresponding filter applies for traffic to the UE.\n- UPLINK: The corresponding filter applies for traffic from the UE.\n- BIDIRECTIONAL: The corresponding filter applies for traffic both to and from the UE.\n- UNSPECIFIED: The corresponding filter applies for traffic to the UE (downlink), but has no\nspecific direction declared. The service data flow detection shall apply the filter for\nuplink traffic as if the filter was bidirectional. The PCF shall not use the value\nUNSPECIFIED in filters created by the network in NW-initiated procedures. The PCF shall only\ninclude the value UNSPECIFIED in filters in UE-initiated procedures if the same value is\nreceived from the SMF.\n\nFlowDirectionRm:\ndescription: >\nThis data type is defined in the same way as the \"FlowDirection\" data type, with the only\ndifference that it allows null value.\nanyOf:\n- $ref: '#/components/schemas/FlowDirection'\n- $ref: 'TS29571_CommonData.yaml#/components/schemas/NullValue'\n\nReportingLevel:\nanyOf:\n- type: string\nenum:\n- SER_ID_LEVEL\n- RAT_GR_LEVEL\n- SPON_CON_LEVEL\n- $ref: 'TS29571_CommonData.yaml#/components/schemas/NullValue'\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates the reporting level.\nPossible values are:\n- SER_ID_LEVEL: Indicates that the usage shall be reported on service id and rating group\ncombination level.\n- RAT_GR_LEVEL: Indicates that the usage shall be reported on rating group level.\n- SPON_CON_LEVEL: Indicates that the usage shall be reported on sponsor identity and rating\ngroup combination level.\n\nMeteringMethod:\nanyOf:\n- type: string\nenum:\n- DURATION\n- VOLUME\n- DURATION_VOLUME\n- EVENT\n- $ref: 'TS29571_CommonData.yaml#/components/schemas/NullValue'\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates the metering method.\nPossible values are:\n- DURATION: Indicates that the duration of the service data flow traffic shall be metered.\n- VOLUME: Indicates that volume of the service data flow traffic shall be metered.\n- DURATION_VOLUME: Indicates that the duration and the volume of the service data flow\ntraffic shall be metered.\n- EVENT: Indicates that events of the service data flow traffic shall be metered.\n\nPolicyControlRequestTrigger:\nanyOf:\n- type: string\nenum:\n- PLMN_CH\n- RES_MO_RE\n- AC_TY_CH\n- UE_IP_CH\n- UE_MAC_CH\n- AN_CH_COR\n- US_RE\n- APP_STA\n- APP_STO\n- AN_INFO\n- CM_SES_FAIL\n- PS_DA_OFF\n- DEF_QOS_CH\n- SE_AMBR_CH\n- QOS_NOTIF\n- NO_CREDIT\n- REALLO_OF_CREDIT\n- PRA_CH\n- SAREA_CH\n- SCNN_CH\n- RE_TIMEOUT\n- RES_RELEASE\n- SUCC_RES_ALLO\n- RAI_CH\n- RAT_TY_CH\n- REF_QOS_IND_CH\n- NUM_OF_PACKET_FILTER\n- UE_STATUS_RESUME\n- UE_TZ_CH\n- AUTH_PROF_CH\n- QOS_MONITORING\n- SCELL_CH\n- USER_LOCATION_CH\n- EPS_FALLBACK\n- MA_PDU\n- TSN_BRIDGE_INFO\n- 5G_RG_JOIN\n- 5G_RG_LEAVE\n- DDN_FAILURE\n- DDN_DELIVERY_STATUS\n- GROUP_ID_LIST_CHG\n- DDN_FAILURE_CANCELLATION\n- DDN_DELIVERY_STATUS_CANCELLATION\n- VPLMN_QOS_CH\n- SUCC_QOS_UPDATE\n- SAT_CATEGORY_CHG\n- PCF_UE_NOTIF_IND\n- NWDAF_DATA_CHG\n- UE_POL_CONT_IND\n- URSP_ENFORCEMENT_INFO\n- HR_SBO_IND_CHG\n- L4S_SUPP\n- NET_SLICE_REPL\n- BAT_OFFSET_INFO\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates the policy control request trigger(s).\nPossible values are:\n- PLMN_CH: PLMN Change\n- RES_MO_RE: A request for resource modification has been received by the SMF. The SMF\nalways reports to the PCF.\n- AC_TY_CH: Access Type Change.\n- UE_IP_CH: UE IP address change. The SMF always reports to the PCF.\n- UE_MAC_CH: A new UE MAC address is detected or a used UE MAC address is inactive for a\nspecific period.\n- AN_CH_COR: Access Network Charging Correlation Information\n- US_RE: The PDU Session or the Monitoring key specific resources consumed by a UE either\nreached the threshold or needs to be reported for other reasons.\n- APP_STA: The start of application traffic has been detected.\n- APP_STO: The stop of application traffic has been detected.\n- AN_INFO: Access Network Information report.\n- CM_SES_FAIL: Credit management session failure.\n- PS_DA_OFF: The SMF reports when the 3GPP PS Data Off status changes. The SMF always\nreports to the PCF.\n- DEF_QOS_CH: Default QoS Change. The SMF always reports to the PCF.\n- SE_AMBR_CH: Session-AMBR Change. The SMF always reports to the PCF.\n- QOS_NOTIF: The SMF notify the PCF when receiving notification from RAN that QoS targets of\nthe QoS Flow cannot be guranteed or gurateed again.\n- NO_CREDIT: Out of credit.\n- REALLO_OF_CREDIT: Reallocation of credit.\n- PRA_CH: Change of UE presence in Presence Reporting Area.\n- SAREA_CH: Location Change with respect to the Serving Area.\n- SCNN_CH: Location Change with respect to the Serving CN node.\n- RE_TIMEOUT: Indicates the SMF generated the request because there has been a PCC\nrevalidation timeout.\n- RES_RELEASE: Indicate that the SMF can inform the PCF of the outcome of the release of\nresources for those rules that require so.\n- SUCC_RES_ALLO: Indicates that the requested rule data is the successful resource\nallocation.\n- RAI_CH: Location Change with respect to the RAI of GERAN and UTRAN.\n- RAT_TY_CH: RAT Type Change.\n- REF_QOS_IND_CH: Reflective QoS indication Change\n- NUM_OF_PACKET_FILTER: Indicates that the SMF shall report the number of supported packet\nfilter for signalled QoS rules.\n- UE_STATUS_RESUME: Indicates that the UE's status is resumed.\n- UE_TZ_CH: UE Time Zone Change.\n- AUTH_PROF_CH: The DN-AAA authorization profile index has changed.\n- QOS_MONITORING: Indicate that the SMF notifies the PCF of the QoS Monitoring information.\n- SCELL_CH: Location Change with respect to the Serving Cell.\n- USER_LOCATION_CH: Indicate that user location has been changed, applicable to serving area\nchange and serving cell change.\n- EPS_FALLBACK: EPS Fallback report is enabled in the SMF.\n- MA_PDU: UE Indicates that the SMF notifies the PCF of the MA PDU session request.\n- TSN_BRIDGE_INFO: TSC user plane node information available.\n- 5G_RG_JOIN: The 5G-RG has joined to an IP Multicast Group.\n- 5G_RG_LEAVE: The 5G-RG has left an IP Multicast Group.\n- DDN_FAILURE: Event subscription for DDN Failure event received.\n- DDN_DELIVERY_STATUS: Event subscription for DDN Delivery Status received.\n- GROUP_ID_LIST_CHG: UE Internal Group Identifier(s) has changed: the SMF reports that UDM\nprovided list of group Ids has changed.\n- DDN_FAILURE_CANCELLATION: The event subscription for DDN Failure event is cancelled.\n- DDN_DELIVERY_STATUS_CANCELLATION: The event subscription for DDD STATUS is cancelled.\n- VPLMN_QOS_CH: Change of the QoS supported in the VPLMN.\n- SUCC_QOS_UPDATE: Indicates that the requested MPS Action is successful.\n- SAT_CATEGORY_CHG: Indicates that the SMF has detected a change between different satellite\nbackhaul categories, or between a satellite backhaul and a non-satellite backhaul.\n- PCF_UE_NOTIF_IND: Indicates the SMF has detected the AMF forwarded the PCF for the UE\nindication to receive/stop receiving notifications of SM Policy association\nestablished/terminated events.\n- NWDAF_DATA_CHG: Indicates that the NWDAF instance IDs used for the PDU session and/or\nassociated Analytics IDs used for the PDU session and available in the SMF have changed.\n- UE_POL_CONT_IND: Indicates that a UE policy container is received from the UE\nin EPC over a PDN connection.\n- URSP_ENFORCEMENT_INFO: Indicates a report of URSP rule enforcement information.\n- HR_SBO_IND_CHG: Indicates the HR-SBO support indication has changed.\n- L4S_SUPP: Indicates whether ECN marking for L4S is not available or available again\nin 5GS.\n- NET_SLICE_REPL: Indicates network slice replacement, i.e., a change between the initial\nS-NSSAI of the PDU Session and the Alternative S-NSSAI\n- BAT_OFFSET_INFO: Indicates that the SMF has detected the BAT offset and optionally\nadjusted periodicity.\n\nRequestedRuleDataType:\nanyOf:\n- type: string\nenum:\n- CH_ID\n- MS_TIME_ZONE\n- USER_LOC_INFO\n- RES_RELEASE\n- SUCC_RES_ALLO\n- EPS_FALLBACK\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates the type of rule data requested by the PCF.\nPossible values are:\n- CH_ID: Indicates that the requested rule data is the charging identifier.\n- MS_TIME_ZONE: Indicates that the requested access network info type is the UE's timezone.\n- USER_LOC_INFO: Indicates that the requested access network info type is the UE's location.\n- RES_RELEASE: Indicates that the requested rule data is the result of the release of\nresource.\n- SUCC_RES_ALLO: Indicates that the requested rule data is the successful resource\nallocation.\n- EPS_FALLBACK: Indicates that the requested rule data is the report of QoS flow rejection\ndue to EPS fallback.\n\nRuleStatus:\nanyOf:\n- type: string\nenum:\n- ACTIVE\n- INACTIVE\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates the status of PCC or session rule.\nPossible values are\n- ACTIVE: Indicates that the PCC rule(s) are successfully installed (for those provisioned\nfrom PCF) or activated (for those pre-defined in SMF), or the session rule(s) are\nsuccessfully installed\n- INACTIVE: Indicates that the PCC rule(s) are removed (for those provisioned from PCF) or\ninactive (for those pre-defined in SMF) or the session rule(s) are removed.\n\nFailureCode:\nanyOf:\n- type: string\nenum:\n- UNK_RULE_ID\n- RA_GR_ERR\n- SER_ID_ERR\n- NF_MAL\n- RES_LIM\n- MAX_NR_QoS_FLOW\n- MISS_FLOW_INFO\n- RES_ALLO_FAIL\n- UNSUCC_QOS_VAL\n- INCOR_FLOW_INFO\n- PS_TO_CS_HAN\n- APP_ID_ERR\n- NO_QOS_FLOW_BOUND\n- FILTER_RES\n- MISS_REDI_SER_ADDR\n- CM_END_USER_SER_DENIED\n- CM_CREDIT_CON_NOT_APP\n- CM_AUTH_REJ\n- CM_USER_UNK\n- CM_RAT_FAILED\n- UE_STA_SUSP\n- UNKNOWN_REF_ID\n- INCORRECT_COND_DATA\n- REF_ID_COLLISION\n- TRAFFIC_STEERING_ERROR\n- DNAI_STEERING_ERROR\n- AN_GW_FAILE\n- MAX_NR_PACKET_FILTERS_EXCEEDED\n- PACKET_FILTER_TFT_ALLOCATION_EXCEEDED\n- MUTE_CHG_NOT_ALLOWED\n- UE_TEMPORARILY_UNAVAILABLE\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates the reason of the PCC rule failure.\nPossible values are\n- UNK_RULE_ID: Indicates that the pre-provisioned PCC rule could not be successfully\nactivated because the PCC rule identifier is unknown to the SMF.\n- RA_GR_ERR: Indicate that the PCC rule could not be successfully installed or enforced\nbecause the Rating Group specified within the Charging Data policy decision which the PCC\nrule refers to is unknown or, invalid.\n- SER_ID_ERR: Indicate that the PCC rule could not be successfully installed or enforced\nbecause the Service Identifier specified within the Charging Data policy decision which the\nPCC rule refers to is invalid, unknown, or not applicable to the service being charged.\n- NF_MAL: Indicate that the PCC rule could not be successfully installed (for those\nprovisioned from the PCF) or activated (for those pre-defined in SMF) or enforced (for those\nalready successfully installed) due to SMF/UPF malfunction.\n- RES_LIM: Indicate that the PCC rule could not be successfully installed (for those\nprovisioned from PCF) or activated (for those pre-defined in SMF) or enforced (for those\nalready successfully installed) due to a limitation of resources at the SMF/UPF.\n- MAX_NR_QoS_FLOW: Indicate that the PCC rule could not be successfully installed (for those\nprovisioned from PCF) or activated (for those pre-defined in SMF) or enforced (for those\nalready successfully installed) due to the fact that the maximum number of QoS flows has\nbeen reached for the PDU session.\n- MISS_FLOW_INFO: Indicate that the PCC rule could not be successfully installed or enforced\nbecause neither the \"flowInfos\" attribute nor the \"appId\" attribute is specified within the\nPccRule data structure by the PCF during the first install request of the PCC rule.\n- RES_ALLO_FAIL: Indicate that the PCC rule could not be successfully installed or\nmaintained since the QoS flow establishment/modification failed, or the QoS flow was\nreleased.\n- UNSUCC_QOS_VAL: indicate that the QoS validation has failed or when Guaranteed Bandwidth >\nMax-Requested-Bandwidth.\n- INCOR_FLOW_INFO: Indicate that the PCC rule could not be successfully installed or\nmodified at the SMF because the provided flow information is not supported by the network\n(e.g. the provided IP address(es) or Ipv6 prefix(es) do not correspond to an IP version\napplicable for the PDU session).\n- PS_TO_CS_HAN: Indicate that the PCC rule could not be maintained because of PS to CS\nhandover.\n- APP_ID_ERR: Indicate that the rule could not be successfully installed or enforced because\nthe Application Identifier is invalid, unknown, or not applicable to the application\nrequired for detection.\n- NO_QOS_FLOW_BOUND: Indicate that there is no QoS flow which the SMF can bind the PCC\nrule(s) to.\n- FILTER_RES: Indicate that the Flow Information within the \"flowInfos\" attribute cannot be\nhandled by the SMF because any of the restrictions defined in clause 5.4.2 of 3GPP TS 29.212\nwas not met.\n- MISS_REDI_SER_ADDR: Indicate that the PCC rule could not be successfully installed or\nenforced at the SMF because there is no valid Redirect Server Address within the Traffic\nControl Data policy decision which the PCC rule refers to provided by the PCF and no\npreconfigured redirection address for this PCC rule at the SMF.\n- CM_END_USER_SER_DENIED: Indicate that the charging system denied the service request due\nto service restrictions (e.g. terminate rating group) or limitations related to the\nend-user, for example the end-user's account could not cover the requested service.\n- CM_CREDIT_CON_NOT_APP: Indicate that the charging system determined that the service can\nbe granted to the end user but no further credit control is needed for the service (e.g.\nservice is free of charge or is treated for offline charging).\n- CM_AUTH_REJ: Indicate that the charging system denied the service request in order to\nterminate the service for which credit is requested.\n- CM_USER_UNK: Indicate that the specified end user could not be found in the charging\nsystem.\n- CM_RAT_FAILED: Indicate that the charging system cannot rate the service request due to\ninsufficient rating input, incorrect AVP combination or due to an attribute or an attribute\nvalue that is not recognized or supported in the rating.\n- UE_STA_SUSP: Indicates that the UE is in suspend state.\n- UNKNOWN_REF_ID: Indicates that the PCC rule could not be successfully installed/modified\nbecause the referenced identifier to a Policy Decision Data or to a Condition Data is\nunknown to the SMF.\n- INCORRECT_COND_DATA: Indicates that the PCC rule could not be successfully\ninstalled/modified because the referenced Condition data are incorrect.\n- REF_ID_COLLISION: Indicates that PCC rule could not be successfully installed/modified\nbecause the same Policy Decision is referenced by a session rule (e.g. the session rule and         the PCC rule refer to the same Usage Monitoring decision data).\n- TRAFFIC_STEERING_ERROR: Indicates that enforcement of the steering of traffic to the\nN6-LAN or 5G-LAN failed; or the dynamic PCC rule could not be successfully installed or\nmodified at the NF service consumer because there are invalid traffic steering policy\nidentifier(s) within the provided Traffic Control Data policy decision to which the PCC\nrule refers.\n- DNAI_STEERING_ERROR: Indicates that the enforcement of the steering of traffic to the\nindicated DNAI failed; or the dynamic PCC rule could not be successfully installed or\nmodified at the NF service consumer because there is invalid route information for a DNAI(s)\n(e.g. routing profile id is not configured) within the provided Traffic Control Data policy\ndecision to which the PCC rule refers.\n- AN_GW_FAILED: This value is used to indicate that the AN-Gateway has failed and that the\nPCF should refrain from sending policy decisions to the SMF until it is informed that the\nS-GW has been recovered. This value shall not be used if the SM Policy association\nmodification procedure is initiated for PCC rule removal only.\n- MAX_NR_PACKET_FILTERS_EXCEEDED: This value is used to indicate that the PCC rule could not\nbe successfully installed, modified or enforced at the NF service consumer because the\nnumber of supported packet filters for signalled QoS rules for the PDU session has been\nreached.\n- PACKET_FILTER_TFT_ALLOCATION_EXCEEDED: This value is used to indicate that the PCC rule is\nremoved at 5GS to EPS mobility because TFT allocation was not possible since the number of\nactive packet filters in the EPC bearer is exceeded.\n- MUTE_CHG_NOT_ALLOWED: Indicates that the PCC rule could not be successfully modified\nbecause the mute condition for application detection report cannot be changed. Applicable\nwhen the functionality introduced with the ADC feature applies.\n\nAfSigProtocol:\nanyOf:\n- type: string\nenum:\n- NO_INFORMATION\n- SIP\n- $ref: 'TS29571_CommonData.yaml#/components/schemas/NullValue'\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates the protocol used for signalling between the UE and the AF.\nPossible values are\n- NO_INFORMATION: Indicate that no information about the AF signalling protocol is being\nprovided.\n- SIP: Indicate that the signalling protocol is Session Initiation Protocol.\n\nRuleOperation:\nanyOf:\n- type: string\nenum:\n- CREATE_PCC_RULE\n- DELETE_PCC_RULE\n- MODIFY_PCC_RULE_AND_ADD_PACKET_FILTERS\n- MODIFY_ PCC_RULE_AND_REPLACE_PACKET_FILTERS\n- MODIFY_ PCC_RULE_AND_DELETE_PACKET_FILTERS\n- MODIFY_PCC_RULE_WITHOUT_MODIFY_PACKET_FILTERS\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration but is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates a UE initiated resource operation that causes a request for PCC rules.\nPossible values are\n- CREATE_PCC_RULE: Indicates to create a new PCC rule to reserve the resource requested by\nthe UE.\n- DELETE_PCC_RULE: Indicates to delete a PCC rule corresponding to reserve the resource\nrequested by the UE.\n- MODIFY_PCC_RULE_AND_ADD_PACKET_FILTERS: Indicates to modify the PCC rule by adding new\npacket filter(s).\n- MODIFY_ PCC_RULE_AND_REPLACE_PACKET_FILTERS: Indicates to modify the PCC rule by replacing\nthe existing packet filter(s).\n- MODIFY_ PCC_RULE_AND_DELETE_PACKET_FILTERS: Indicates to modify the PCC rule by deleting\nthe existing packet filter(s).\n- MODIFY_PCC_RULE_WITHOUT_MODIFY_PACKET_FILTERS: Indicates to modify the PCC rule by\nmodifying the QoS of the PCC rule.\n\nRedirectAddressType:\nanyOf:\n- type: string\nenum:\n- IPV4_ADDR\n- IPV6_ADDR\n- URL\n- SIP_URI\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates the redirect address type.\nPossible values are\n- IPV4_ADDR: Indicates that the address type is in the form of \"dotted-decimal\" IPv4\naddress.\n- IPV6_ADDR: Indicates that the address type is in the form of IPv6 address.\n- URL: Indicates that the address type is in the form of Uniform Resource Locator.\n- SIP_URI: Indicates that the address type is in the form of SIP Uniform Resource\nIdentifier.\n\nQosFlowUsage:\nanyOf:\n- type: string\nenum:\n- GENERAL\n- IMS_SIG\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates a QoS flow usage information.\nPossible values are\n- GENERAL: Indicate no specific QoS flow usage information is available.\n- IMS_SIG: Indicate that the QoS flow is used for IMS signalling only.\n\nFailureCause:\ndescription: Indicates the cause of the failure in a Partial Success Report.\nanyOf:\n- type: string\nenum:\n- PCC_RULE_EVENT\n- PCC_QOS_FLOW_EVENT\n- RULE_PERMANENT_ERROR\n- RULE_TEMPORARY_ERROR\n- POL_DEC_ERROR\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n\nCreditManagementStatus:\ndescription: Indicates the reason of the credit management session failure.\nanyOf:\n- type: string\nenum:\n- END_USER_SER_DENIED\n- CREDIT_CTRL_NOT_APP\n- AUTH_REJECTED\n- USER_UNKNOWN\n- RATING_FAILED\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n\nSessionRuleFailureCode:\nanyOf:\n- type: string\nenum:\n- NF_MAL\n- RES_LIM\n- SESSION_RESOURCE_ALLOCATION_FAILURE\n- UNSUCC_QOS_VAL\n- INCORRECT_UM\n- UE_STA_SUSP\n- UNKNOWN_REF_ID\n- INCORRECT_COND_DATA\n- REF_ID_COLLISION\n- AN_GW_FAILED\n- DEFAULT_QOS_MODIFICATION_FAILURE\n- SESSION_AMBR_MODIFICATION_FAILURE\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates the reason of the session rule failure.\nPossible values are\n- NF_MAL: Indicates that the PCC rule could not be successfully installed (for those\nprovisioned from the PCF) or activated (for those pre-defined in SMF) or enforced (for those\nalready successfully installed) due to SMF/UPF malfunction.\n- RES_LIM: Indicates that the PCC rule could not be successfully installed (for those\nprovisioned from PCF) or activated (for those pre-defined in SMF) or enforced (for those\nalready successfully installed) due to a limitation of resources at the SMF/UPF.\n- SESSION_RESOURCE_ALLOCATION_FAILURE: Indicates the session rule could not be successfully\nenforced due to failure during the allocation of resources for the PDU session in the UE,\nRAN or AMF.\n- UNSUCC_QOS_VAL: indicates that the QoS validation has failed.\n- INCORRECT_UM: The usage monitoring data of the enforced session rule is not the same for\nall the provisioned session rule(s).\n- UE_STA_SUSP: Indicates that the UE is in suspend state.\n- UNKNOWN_REF_ID: Indicates that the session rule could not be successfully\ninstalled/modified because the referenced identifier to a Policy Decision Data or to a\nCondition Data is unknown to the SMF.\n- INCORRECT_COND_DATA: Indicates that the session rule could not be successfully\ninstalled/modified because the referenced Condition data are incorrect.\n- REF_ID_COLLISION: Indicates that the session rule could not be successfully\ninstalled/modified because the same Policy Decision is referenced by a PCC rule (e.g. the\nsession rule and the PCC rule refer to the same Usage Monitoring decision data).\n- AN_GW_FAILED: Indicates that the AN-Gateway has failed and that the PCF should refrain\nfrom sending policy decisions to the SMF until it is informed that the S-GW has been\nrecovered. This value shall not be used if the SM Policy association modification procedure\nis initiated for session rule removal only.\n- DEFAULT_QOS_MODIFICATION_FAILURE: Indicates that the enforcement of the default QoS\nmodification failed. The SMF shall use this value to indicate to the PCF that the default\nQoS modification has failed.\n- SESSION_AMBR_MODIFICATION_FAILURE: Indicates that the enforcement of the session-AMBR\nmodification failed. The SMF shall use this value to indicate to the PCF that the\nsession-AMBR modification has failed.\n\nSteeringFunctionality:\nanyOf:\n- type: string\nenum:\n- MPTCP\n- MPQUIC\n- ATSSS_LL\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates functionality to support traffic steering, switching and splitting determined\nby the PCF.\nPossible values are\n- MPTCP: Indicates that PCF authorizes the MPTCP functionality to support traffic\nsteering, switching and splitting.\n- ATSSS_LL: Indicates that PCF authorizes the ATSSS-LL functionality to support traffic\nsteering, switching and splitting.\n\nSteerModeValue:\ndescription: Indicates the steering mode value determined by the PCF.\nanyOf:\n- type: string\nenum:\n- ACTIVE_STANDBY\n- LOAD_BALANCING\n- SMALLEST_DELAY\n- PRIORITY_BASED\n- REDUNDANT\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n\nMulticastAccessControl:\ndescription: >\nIndicates whether the service data flow, corresponding to the service data flow template, is\nallowed or not allowed.\nanyOf:\n- type: string\nenum:\n- ALLOWED\n- NOT_ALLOWED\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n\nRequestedQosMonitoringParameter:\ndescription: Indicates the requested QoS monitoring parameters to be measured.\nanyOf:\n- type: string\nenum:\n- DOWNLINK\n- UPLINK\n- ROUND_TRIP\n\n- DOWNLINK_DATA_RATE\n- UPLINK_DATA_RATE\n- DOWNLINK_CONGESTION\n- UPLINK_CONGESTION\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n\nReportingFrequency:\ndescription: Indicates the frequency for the reporting.\nanyOf:\n- type: string\nenum:\n- EVENT_TRIGGERED\n- PERIODIC\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n\nSgsnAddress:\ndescription: describes the address of the SGSN\ntype: object\nanyOf:\n- required: [sgsnIpv4Addr]\n- required: [sgsnIpv6Addr]\nproperties:\nsgsnIpv4Addr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr'\nsgsnIpv6Addr:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Addr'\n\nSmPolicyAssociationReleaseCause:\ndescription: >\nRepresents the cause due to which the PCF requests the termination of the SM policy\nassociation.\nanyOf:\n- type: string\nenum:\n- UNSPECIFIED\n- UE_SUBSCRIPTION\n- INSUFFICIENT_RES\n- VALIDATION_CONDITION_NOT_MET\n- REACTIVATION_REQUESTED\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n\nPduSessionRelCause:\ndescription: Contains the SMF PDU Session release cause.\nanyOf:\n- type: string\nenum:\n- PS_TO_CS_HO\n- RULE_ERROR\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n\nMaPduIndication:\ndescription: >\nContains the MA PDU session indication, i.e., MA PDU Request or MA PDU Network-Upgrade\nAllowed.\nanyOf:\n- type: string\nenum:\n- MA_PDU_REQUEST\n- MA_PDU_NETWORK_UPGRADE_ALLOWED\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n\nAtsssCapability:\ndescription: Contains the ATSSS capability supported for the MA PDU Session.\nanyOf:\n- type: string\nenum:\n- MPTCP_ATSSS_LL_WITH_ASMODE_UL\n- MPTCP_ATSSS_LL_WITH_EXSDMODE_DL_ASMODE_UL\n- MPTCP_ATSSS_LL_WITH_ASMODE_DLUL\n- ATSSS_LL\n- MPTCP_ATSSS_LL\n- MPQUIC_ATSSS_LL_WITH_ASMODE_UL\n- MPQUIC_ATSSS_LL_WITH_EXSDMODE_DL_ASMODE_UL\n- MPQUIC_ATSSS_LL_WITH_ASMODE_DLUL\n- MPQUIC_ATSSS_LL\n- MPTCP_MPQUIC_ATSSS_LL_WITH_ASMODE_UL\n- MPTCP_MPQUIC_ATSSS_LL_WITH_EXSDMODE_DL_ASMODE_UL\n- MPTCP_MPQUIC_ATSSS_LL_WITH_ASMODE_DLUL\n- MPTCP_MPQUIC_ATSSS_LL\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n#\nNetLocAccessSupport:\nanyOf:\n- type: string\nenum:\n- ANR_NOT_SUPPORTED\n- TZR_NOT_SUPPORTED\n- LOC_NOT_SUPPORTED\n- type: string\ndescription: >\nThis string provides forward-compatibility with future\nextensions to the enumeration and is not used to encode\ncontent defined in the present version of this API.\ndescription: |\nIndicates the access network support of the report of the requested access network\ninformation.\nPossible values are\n- ANR_NOT_SUPPORTED: Indicates that the access network does not support the report of access\nnetwork information.\n- TZR_NOT_SUPPORTED: Indicates that the access network does not support the report of UE\ntime zone.\n- LOC_NOT_SUPPORTED: Indicates that the access network does not support the report of UE\nLocation (or PLMN Id).\n\nPolicyDecisionFailureCode:\ndescription: Indicates the type of the failed policy decision and/or condition data.\nanyOf:\n- type: string\nenum:\n- TRA_CTRL_DECS_ERR\n- QOS_DECS_ERR\n- CHG_DECS_ERR\n- USA_MON_DECS_ERR\n- QOS_MON_DECS_ERR\n- CON_DATA_ERR\n- POLICY_PARAM_ERR\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n#\nNotificationControlIndication:\ndescription: >\nIndicates that the notification of DDD Status is requested and/or that the notification of\nDDN Failure is requested.\nanyOf:\n- type: string\nenum:\n- DDN_FAILURE\n- DDD_STATUS\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n#\nSteerModeIndicator:\ndescription: Contains Autonomous load-balance indicator or UE-assistance indicator.\nanyOf:\n- type: string\nenum:\n- AUTO_LOAD_BALANCE\n- UE_ASSISTANCE\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n#\nTrafficParameterMeas:\ndescription: Indicates the traffic parameters to be measured.\nanyOf:\n- type: string\nenum:\n- DL_N6_JITTER\n- DL_PERIOD\n- UL_PERIOD\n- type: string\ndescription: >\nThis string provides forward-compatibility with future extensions to the enumeration\nand is not used to encode content defined in the present version of this API.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.1\tScope",
            "description": "This annex defines procedures for 5GC and EPC interworking, which contains the following scenarios:\n-\tEPS and 5GS interworking (i.e. 3GPP access connected to EPC and 3GPP access connected to 5GC).\n-\tEPC/ePDG and 5GS interworking (i.e. ePDG connected to EPC and 3GPP access connected to 5GC).\n-\tEPS and 5GC/N3IWF interworking (i.e. 3GPP access connected to EPC and N3IWF connected to 5GC).\n-\tEPS and 5GC/TNAN/TWAN interworking (i.e. 3GPP access connected to EPC and TNAN/TWAN connected to 5GC).\nNOTE:\tIn this Release 5GC and EPC interworking is not supported for SNPN.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.2\tNpcf_SMPolicyControl Service",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "B.2.1\tService Description",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "B.2.1.1\tOverview",
                            "text_content": "Session Management Policy Control Service applies to the cases where the SMF+PGW-C interacts with the PCF in the non-roaming scenario, the SMF+PGW-C interacts with the V-PCF in the local breakout roaming scenario and the H-SMF+H-PGW-C interacts with the H-PCF in the home-routed scenario.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.2.1.2\tService Architecture",
                            "text_content": "The Session Management Policy Control Service is provided by the PCF as shown in the SBI representation model in figure B.2.1.2-1 and in the reference point representation model in figure B.2.1.2.2.\nIn this scenario the NF Service Consumer is a combined SMF and PGW-C.\nThe figure depicts a reference architecture for the Npcf_SMPolicyControl Service for 5GC and EPC interworking scenario, illustrating the 1.2.1.2-1 SBI representation. It includes various components such as the Npcf_SMPolicyControl Service, the Npcf_SMPolicyControl Service Interface, and the Npcf_SMPolicyControl Service Interface Definition. The figure also includes a diagram of the Npcf_SMPolicyControl Service Interface, which is a key component of the Npcf_SMPolicyControl Service. The figure provides a clear and concise representation of the Npcf_SMPolicyControl Service and its components, making it useful for understanding the architecture and functionality of the service.\nFigure B.2.1.2-1: Reference Architecture for the Npcf_SMPolicyControl Service for 5GC and\nEPC interworking scenario; SBI representation\n\nThe figure depicts a reference architecture for the Npcf_SMPolicyControl Service or 5GC and EPC interworking scenario, illustrating the reference point representation.\nFigure B.2.1.2-2: Reference Architecture for the Npcf_SMPolicyControl Service or 5GC and\nEPC interworking scenario; reference point representation\nNOTE:\tThe PCF represents the V-PCF in the local breakout scenario. The SMF+PGW-C represents the H-SMF+H-PGW-C and the PCF represents the H-PCF in the home routed scenario.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "B.3\tService Operation",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "B.3.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause defines the specific service operations for the 5GC and EPC interworking scenario. In addition, the service operations defined in clause 4.2 shall be applicable.\nNOTE:\tFor brevity reason, the combined SMF and PGW-C is denoted as SMF in what follows.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "B.3.2\tNpcf_SMPolicyControl_Create Service Operation",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "B.3.2.0\tGeneral",
                            "text_content": "When the UE establishes the PDN connection through the EPC network and the SMF+PGW-C receives the Create Session Request message as defined in 3GPP TS 29.274 [37], the SMF+PGW-C shall behave as defined in clause 4.2.2.2 with the differences that the SMF+PGW-C shall include (if available) in SmPolicyContextData data structure:\n-\tthe IMSI of the user within the \"supi\" attribute;\n-\tthe MSISDN of the user within the \"gpsi\" attribute;\n-\tAPN within the \"dnn\" attribute;\n-\tPDU Session Id determined by the SMF+PGW-C within \"pduSessionId\" attribute for a UE that has an EPS subscription that allows 5GC interworking but does not support 5GC NAS.\nNOTE 1:\tFor a PDN connection established via the MME or ePDG, the PDU Session ID value is assigned from a reserved range as specified in Table 5.4.2-1 of 3GPP TS 29.571 [11]. The PDU session ID value assigned at PDN connection establishment remains unchanged along the PDN connection, i.e., it does not change when the UE handovers between EPS and EPC/ePDG. In the scenarios where UE handover between EPS and EPC/ePDG is enabled, to ensure uniqueness of the assigned PDU Session ID value, the SMF+PGW-C can retrieve from UDM the already assigned PDU Session ID values, allocate a non-colliding PDU Session ID value, and register in UDM the allocated PDU session ID;\n-\tPDN Type within the \"pduSessionType\" attribute;\n-\tIMEI-SV within the \"pei\" attribute;\n-\tIP-CAN type within the \"accessType\" attribute;\n-\tRAT type within the \"ratType\" attribute;\nNOTE 2:\tSee Annex B.3.2.2 for further information.\n-\tsubscribed APN-AMBR within \"subsSessAmbr\" attribute;\n-\tsubscribed Default EPS bearer QoS within \"subsDefQos\" attribute;\nNOTE 3:\tSubscribed APN-AMBR and the QCI within the subscribed default EPS bearer QoS are mapped to subscribed Session-AMBR and 5QI as defined in Annex B.3.6.1 respectively.\n-\tuser location information within the \"userLocationInfo\" attribute;\nNOTE 4:\tSee Annex B.3.2.1 for further information.\n-\tthe S-NSSAI determined by the SMF+PGW-C within the \"sliceInfo\" attribute;\n-\tthe bearer usage required of the default bearer within the \"qosFlowUsage\" attribute;\n-\tthe UE time zone information within \"ueTimeZone\" attribute, if available.\nNOTE 5:\tThe UE time zone is not available in EPC untrusted WLAN.\nWhen the UE establishes the PDN connection in an 5GS-EPC interworking deployment, the SMF+PGW-C shall behave as defined in clause 4.2.2.2 (access through 5GS network) or this clause (access through the EPC network) and additionally, if the feature \"PackFiltAllocPrecedence\" is supported and there is a possibility to run into a restriction regarding the number of TFT packet filters that can be allocated when interworking with EPS with N26 is supported (see clause 4.11.1 of TS 23.502 [3]), the PCF may provide, as part of the PccRule data type(s) for the PCC Rules to be installed, the \"packFiltAllPrec\" attribute to indicate the order of the PCC Rules in the allocation of TFT packet filter(s) by the SMF+PGW-C.\nNOTE 6:\tPCF can know that interworking with EPS with N26 is supported based on the received DNN and S-NSSAI of the PDU Session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.2.1\tUE Location related information",
                            "text_content": "When the UE establishes the PDN connection through the EPC/E-UTRAN network, the SMF+PGW-C shall include, if available, the following user location information:\n-\tuser location information within the \"eutraLocation\" attribute included in the \"userLocationInfo\" attribute; and\n-\tS-GW address, if available, within the \"anGwAddr\" attribute included in the \"servNfId\" attribute.\nWhen the UE establishes the PDN connection through the EPC/UTRAN network and the feature \"2G3GIWK\" is supported, the SMF+PGW-C shall include, if available, the following user location information:\n-\tuser location information within the \"utraLocationInfo\" attribute included in the \"userLocationInfo\" attribute; and\n-\tSGSN address, if available, within the \"sgsnAddr\" attribute included in the \"servNfId\" attribute.\nWhen the UE establishes the PDN connection through the EPC/GERAN network and the feature \"2G3GIWK\" is supported, the SMF+PGW-C shall include, if available, the following user location information:\n-\tuser location information within the \"geraLocationInfo\" attribute included in the \"userLocationInfo\" attribute; and\n-\tSGSN address, if available, within the \"sgsnAddr\" attribute included in the \"servNfId\" attribute.\nWhen the UE establishes the PDN connection through the EPC/ePDG network, the SMF+PGW-C shall include, if available, the following user location information:\n-\tuser location information within the \"n3gaLocation\" attribute included in the \"userLocationInfo\" attribute. The \"n3gaLocation\" attribute includes the \"ueIpv4Addr\" or \"ueIpv6Addr\" attributes, and, if available the \"portNumber\" and \"protocol\" attributes and, if the feature \"WLAN_Location\" is supported, the \"twapId\" attribute encoding the WLAN location information, if available; and\n-\tePDG identification within the \"anGwAddr\" attribute included in the \"servNfId\" attribute.\nNOTE:\tThe \"n3gaLocation\" attribute does not include the \"n3gppTai\" and \"n3IwfId\" attributes in EPC interworking scenarios.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.2.2\tAccess Type related information",
                            "text_content": "When the UE establishes the PDN connection through the EPC/E-UTRAN network, the SMF+PGW shall include, if available, the following access type information:\n-\tthe \"3GPP_ACCESS\" value within the \"accessType\" attribute; and\n-\tthe \"EUTRA\" value within the \"ratType\" attribute.\nWhen the UE establishes the PDN connection through the EPC/UTRAN network and the feature \"2G3GIWK\" is supported, the SMF+PGW shall include, if available, the following access type information:\n-\tthe \"3GPP_ACCESS\" value within the \"accessType\" attribute; and\n-\tthe \"UTRA\" value within the \"ratType\" attribute.\nWhen the UE establishes the PDN connection through the EPC/GERAN network and the feature \"2G3GIWK\" is supported, the SMF+PGW shall include, if available, the following access type information:\n-\tthe \"3GPP_ACCESS\" value within the \"accessType\" attribute; and\n-\tthe \"GERA\" value within the \"ratType\" attribute.\nWhen the UE establishes the PDN connection through the EPC/ePDG network, the SMF+PGW shall include, if available, the following access type information:\n-\tthe \"NON_3GPP_ACCESS\" value within the \"accessType\" attribute;\n-\tthe \"WLAN\" or \"VIRTUAL\" value within the \"ratType\" attribute, as applicable; and\n-\tthe ePDG address in the \"servNfId\" attribute within the \"anGwAddr\" attribute.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.2.3\tAccess Network Charging Identifier report",
                            "text_content": "During PDU session establishment procedure, the SMF+PGW-C may provide the Access Network Charging Identifier for the PDU session (i.e., for the default QoS flow or the default EPS bearer) as specified in clause 4.2.2.11, or may provide the Access Network Charging Identifier for the default EPS bearer and indicate that there is a separate access network charging identifier for each EPS bearer/QoS flow by omitting or setting to false the \"sessionChScope\" attribute.\nIn both cases above, the Access Network Charging Identifier value and the address of the network entity performing the charging are provided as specified in clause 4.2.2.11.\nNOTE:\tDuring the PDU Session Establishment procedure, when there are different charging identifiers for each EPS bearer (or QoS flow), the \"refPccRuleIds\" attribute is not provided within the AccNetChId data structure, since the PCC Rules are not yet authorized at this stage.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "B.3.3\tNpcf_SMPolicyControl_UpdateNotify Service Operation",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "B.3.3.0\tGeneral",
                            "text_content": "When the UE has an established PDN connection through the EPC/E-UTRAN network and the PCF provisions the policy to the SMF+PGW-C as defined in clause 4.2.3. The SMF+ PGW-C shall behave as defined in clause 4.2.3 with the differences that the SMF+PGW-C shall map the QoS information within the PCC rule and/or session rule into EPS QoS information as defined in Annex B.3.6.1.\nWhen the UE has an established PDN connection in an 5GS-EPC interworking deployment, the SMF+PGW-C shall behave as defined in clause 4.2.3 (access through the 5GS network) or this clause (access through the EPC network) and additionally, if the feature \"PackFiltAllocPrecedence\" is supported and there is a possibility to run into a restriction regarding the number of TFT packet filters that can be allocated when interworking with EPS with N26 is supported as described in Annex B.3.2.0, the PCF may provide, as part of the PccRule data type for the new PCC Rules to be installed, the \"packFiltAllPrec\" attribute to indicate the order of the PCC Rules in the allocation of TFT packet filter(s) by the SMF+PGW-C.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.3.1\tPolicy Update When UE suspends",
                            "text_content": "If the PolicyUpdateWhenUESuspends feature as defined in clause 5.8 is supported the PCF and the SMF shall comply with the procedures specified in this clause. During PDU session/PDN connection establishment or modification procedure, the PCF shall subscribe to the \"UE_STATUS_RESUME\" policy control request trigger if not subscribed yet, as described in clause 4.2.6.4. When the SMF receives the policy decision from the PCF as defined in clause 4.2.3.1 for a PDN connection maintained when the UE's status is suspend state, the SMF shall reject the request and include an HTTP \"400 Bad Request\" status code together with an ErrorReport structure. Within the ErrorReport data structure, the SMF shall include the \"error\" attribute containing the \"cause\" attribute of the ProblemDetails data structure set to \"UE_STATUS_SUSPEND\" which indicates the failure to enforce the corresponding policy decision, except if the policy decision is for the PCC rule removal only and/or session rule removal only, and further include the information as follows:\n-\tIf the policy decision includes the installation of one or more PCC rules, the SMF shall invoke the procedure as defined in clause 4.2.3.16 with the \"failureCode\" attribute set to \"UE_STA_SUSP\" and \"ruleStatus\" attribute set to INACTIVE to indicate the failure to enforce those PCC rules.\n-\tIf the policy decision includes the modification of one or more PCC rules, the SMF shall invoke the procedure as defined in clause 4.2.3.16 with the \"failureCode\" attribute set to \"UE_STA_SUSP\" and \"ruleStatus\" attribute set to ACTIVE to indicate the failure to enforce those PCC rules.\n-\tIf the policy decision includes the modification of one or more session rules, the SMF shall within a RuleReport data structure include the \"sessRuleReports\" attribute. Within each SessionRuleReport data structure, the SMF shall include the affected session rules within the \"ruleIds\" attribute(s), the \"sessRuleFailureCode\" attribute set to \"UE_STA_SUSP\" and \"ruleStatus\" attribute set to ACTIVE to indicate the failure to enforce those session rules.\nUpon reception of the \"failureCode\" attribute and/or \"sessRuleFailureCode\" attribute set to \"UE_STA_SUSP\" or the ProblemDetails data structure set to \"UE_STATUS_SUSPEND\", the PCF shall not initiate any PDU Session Modification procedure, except if it is initiated for the PCC rule removal only or the session rule removal only, for the given PDU session over N7 until the UE's status is resumed. When the SMF detected the UE's status is resumed from suspend state, the SMF shall inform the PCF of the UE status as defined in Annex B.3.4.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.3.2\tRequest report of EPS Fallback",
                            "text_content": "When the \"EPSFallbackReport\" feature is supported, if the AF requests the PCF to report the EPS fallback for voice media type as described in clauses 4.2.2.30 or 4.2.3.29 of 3GPP TS 29.514 [17] or in clause E.3 of 3GPP TS 29.214 [18], the PCF shall perform the PCC rule provisioning procedure as defined in clause 4.2.6.2.1 and additionally provide the request of EPS fallback report to the SMF as follows:\n-\tit shall include the \"lastReqRuleData\" attribute to contain the \"reqData\" attribute with the value \"EPS_FALLBACK\" and the \"refPccRuleIds\" attribute to contain the related installed/modified PCC rule identifier(s) with 5QI=1.\n-\tit shall provide the \"EPS_FALLBACK\" policy control request rigger within the \"policyCtrlReqTriggers\" attribute, if not provided before.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.3.3\tS-GW Restoration Support",
                            "text_content": "If the SGWRest feature as defined in clause 5.8 is supported, the PCF and the SMF shall comply with the procedures specified in this clause. During PDU session/PDN connection establishment or modification procedure, the PCF shall subscribe to the \"SCNN_CH\" policy control request trigger if not subscribed yet, as described in clause 4.2.6.4.\nWhen the SMF+PGW receives the policy decision from the PCF as defined in clause 4.2.3.1 for a PDN connection maintained during a S-GW failure, the SMF+PGW shall act as follows:\n-\tFor MME/S4-SGSN triggered S-GW Restoration scenarios:\n-\tthe SMF+PGW shall reject the request and include an HTTP \"400 Bad Request\" status code together with an ErrorReport structure. Within the ErrorReport data structure, the SMF shall include the \"error\" attribute containing the \"cause\" attribute of the ProblemDetails data structure set to \"AN_GW_FAILED\" which indicates the failure to enforce the corresponding policy decision, except if the policy decision is for the PCC rule removal only and/or session rule removal only, and further include the information as follows:\n-\tIf the policy decision is related to one or more PCC rules, the SMF+PGW shall behave as defined in clause 4.2.3.16 with the \"failureCode\" attribute set to \"AN_GW_FAILED\".\n-\tIf the policy decision is related to one or more session rules, the SMF+PGW shall behave as defined in clause 4.2.3.20 with the \"sessRuleFailureCode\" attribute set to \"AN_GW_FAILED\".\n-\tFor SMF+PGW triggered S-GW Restoration scenarios, the SMF+PGW shall accept the procedure as per normal procedures. In the case, the PDN connection is not restored during an operator configured time period, the SMF+PGW shall behave as follows as defined in annex B.3.4.9.\nUpon reception of the \"cause\" attribute of the ProblemDetails data structure set to \"AN_GW_FAILED\" or the \"failureCode\" attribute set to \"AN_GW_FAILED\" and/or the \"sessRuleFailureCode\" attribute set to \"AN_GW_FAILED\", the PCF shall not initiate any SM Policy association modification procedure, except if the I SM Policy association modification procedure is initiated for the PCC rule removal only, for the given SM Policy association over N7 until the S-GW has recovered.\nThe SMF+PGW shall maintain the PDN connections affected by the S-GW failure and eligible for restoration for an operator configurable time period. Upon expiry of that time period, the SMF+PGW shall release the PDN connection and inform the PCF about the SM Policy association termination as specified in clause 4.2.5.2.\nThe SMF+PGW should maintain the GBR bearers of the PDN connections eligible for restoration for an operator configurable time period. Upon expiry of that time period, the SMF+PGW shall release GBR bearers that have not yet been restored and inform the PCF about the PCC rule removal as specified in clause 4.2.4.7.\nThe SMF+PGW shall discard downlink packets received for a PDN connection maintained during a S-GW failure that has not yet been restored.\nThe SMF+PGW shall delete the PDN connection locally when it receives an SM Policy association termination from the PCF as described in clause 4.2.4.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.3.4\tRequest of Access Network Charging Identifier",
                            "text_content": "When the PCF received from the SMF+PGW-C the indication that the Access Network Charging Identifier is different per EPS bearer/QoS flow (see clause B.3.2.3), or the Access Network Charging identifier is unknown for an AF session to the PCF, and the PCF received from the AF the request of access network information as specified in 3GPP TS 29.514 [17] or 3GPP TS 29.214 [18], the PCF shall request the access network charging identifier associated to the dynamic PCC rulesas specified in clause 4.2.6.5.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.3.5\tForwarding of UE policy container for URSP provisioning in EPS",
                            "text_content": "The PCF may receive a UE policy container and/or policy control triggers from the PCF for the UE during the lifetime of the PDU session and forward it to the SMF+PGW-C by invoking the procedure defined in clause 4.2.3.2.\nIf the feature \"EpsUrsp\" is supported the PCF initiates the Npcf_SMPolicyControl_UpdateNotify request and transparently forwards the the UE policy container to the SMF+PGW-C via the SmPolicyDecision structure, in which the UE policy container is encoded in the \"uePolCont\" attribute.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "B.3.4\tNpcf_SMPolicyControl_Update Service Operation",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "B.3.4.0\tGeneral",
                            "text_content": "When the established PDN connection through the EPC/E-UTRAN network is modified and SMF+PGW-C receives Modify Bearer Request, Modify Bearer or Delete Bearer Command message and if the SMF detects the policy control request trigger(s) is met or the error(s) needs to be reported or when the UE handed over from the 5GS to the EPS and the SMF detects the policy control request trigger(s) is met, the SMF+PGW-C shall behave as defined in clause 4.2.4.2 with the differences that the SMF+PGW-C shall include (if available) in the SmPolicyUpdateContextData data structure:\n-\tIP-CAN type within the \"accessType\" attribute;\n-\tRAT type within the \"ratType\" attribute;\nNOTE 1:\tSee Annex B.3.4.5 for further information.\n-\tsubscribed APN-AMBR within the \"subsSessAmbr\" attribute;\n-\tsubscribed Default EPS bearer QoS Information within the \"subsDefQos\" attribute;\nNOTE 2:\tSubscribed APN-AMBR and the QCI within the subscribed default EPS bearer QoS are mapped to subscribed Session-AMBR and 5QI as defined in Annex B.3.6.1 respectively.\n-\tthe bearer usage required for the dedicated bearer within the \"qosFlowUsage\" attribute if the UE initiates a resource modification request procedure and the bearer usage request was present in the Bearer Resource Command;\n-\tuser location information of EPC within the \"userLocationInfo\" attribute; and\nNOTE 3:\tSee Annex B.3.4.3 for further information.\n-\tUE policy container within \"uePolCont\" attribute, if available.\nThe policy control request trigger \"RES_MO_RE\" is not supported when the PDN connection is established through the EPC/E-UTRAN network. The SMF+PGW shall reject the PDU session modification that initiated the UE's resource modification.\nDuring interworking from 5GS to EPS, if the feature \"PackFiltAllocPrecedence\" is supported, for QoS Flows without EPS bearer ID(s) assigned or for QoS Flows related to PCC Rules that do not have allocated TFT packet filters, the SMF+PGW-C shall delete those PCC Rules and inform the PCF. The SMF+PGW-C shall include the \"ruleReports\" attribute containing the RuleReport data instance which specifies the affected PCC rules within the \"pccRuleIds\" attribute, set to \"INACTIVE\" the value within the \"ruleStatus\" attribute and the \"PACKET_FILTER_TFT_ALLOCATION_EXCEEDED\" as the value of the \"failureCode\" attribute.\nIf the feature \"PackFiltAllocPrecedence\" is supported, the PCF may provide, as part of the PccRule data type for the new PCC Rules to be installed the \"packFiltAllPrec\" attribute to indicate the order of the PCC Rules in the allocation of TFT packet filter(s) by the SMF+PGW-C. The PCF may include this parameter if the feature \"PackFiltAllocPrecedence\" is supported and there is a possibility to run into a restriction regarding the number of TFT packet filters that can be allocated for the PDU Session and interworking with EPS with N26 deployment is supported as described in Annex B.3.2.0.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.1\tNumber of Supported Packet Filters Report",
                            "text_content": "When the UE handed over from the EPC/E-UTRAN to the 5GS and the number of supported packet filters for signalled QoS rules is received from the UE, the SMF shall include the \"NUM_OF_PACKET_FILTER\" within the \"repPolicyCtrlReqTriggers\" attribute and the number of supported packet filters for signalled QoS rules within the \"numOfPackFilter\". In this case, the PCF shall behave as defined in clause 4.2.6.2.16.\nNOTE:\tThe maximum number of packet filters sent to the UE per QoS rule is additionally limited as specified in 3GPP TS 24.501 [20] when the UE is camping in 5GS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.2\tPolicy Update When UE suspends",
                            "text_content": "If the PolicyUpdateWhenUESuspends feature as defined in clause 5.8 is supported, the PCF and the SMF shall comply with the procedures specified in this clause. During PDU session/PDN connection establishment or modification procedure, the PCF shall subscribe to the \"UE_STATUS_RESUME\" policy control request trigger if not subscribed yet, as described in clause 4.2.6.4. When the SMF receives the policy decision from the PCF as defined in clause 4.2.4.1 for a PDN connection maintained when the UE's status is suspend state, the SMF shall include the \"ruleReports\" attribute for the affected PCC rules and/or session rules to report the failure within the SmPolicyUpdateContextData data structure. Within the ErrorReport data structure, the SMF shall include the \"error\" attribute containing the \"cause\" attribute of the ProblemDetails data structure set to \"UE_STATUS_SUSPEND\" which indicates the failure to enforce the corresponding policy decision, except if the policy decision is for the PCC rule removal only and/or session rule removal only, and further include the information as follows:\n-\tif the policy decision includes the modification of one or more session rules, within an RuleReport instance, the SMF shall include the \"sessRuleReports\" attribute. Within each SessionRuleReport data structure, the SMF shall include the affected session rules within the \"ruleIds\" attribute, the \"sessRuleFailureCode\" attribute set to \"UE_STA_SUSP\" and the \"ruleStatus\" attribute set to ACTIVE to indicate the failure to enforce those session rules.\n-\tif the policy decision includes the installation  of one or more PCC rules, the SMF shall invoke the procedure as defined in clause 4.2.4.15 with the \"failureCode\" attribute set to \"UE_STA_SUSP\" and \"ruleStatus\" attribute set to INACTIVE to indicate the failure to enforce those PCC rules.\n-\tif the policy decision includes the modification  of one or more PCC rules, the SMF shall invoke the procedure as defined in clause 4.2.4.15 with the \"failureCode\" attribute set to \"UE_STA_SUSP\" and \"ruleStatus\" attribute set to ACTIVE to indicate the failure to enforce those PCC rules.\nUpon reception of the \"failureCode\" attribute and/or \"sessRuleFailureCode\" attribute set to \"UE_STA_SUSP\", the PCF shall not initiate any PDU Session Modification procedure, except if it is initiated for the PCC rule removal only and/or session rule removal only, for the given PDU session over N7 until the UE's status is resumed.\nIf the SMF detected the UE's status is resumed from suspend state, the SMF shall inform the PCF of the UE status including the \"UE_STATUS_RESUME\" within \"repPolicyCtrlReqTriggers\" attribute. The PCF shall after this update the SMF with PCC Rules or session rules if necessary.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.3\tUE Location related information",
                            "text_content": "When the UE handed over from the EPC/GERAN or EPC/UTRAN and the feature \"2G3GIWK\" is supported, or 5GS to EPC/E-UTRAN the SMF+PGW-C shall include, together with the policy control request triggers met, the following user location information:\n-\tIf the \"SAREA_CH\" or \"SCELL_CH\" policy control request trigger is provisioned and met, the user location information within the \"eutraLocation\" attribute included in the \"userLocationInfo\" attribute.\n-\tIf the \"SCNN_CH\" policy control request trigger is provisioned and met, the \"servNfId\" attribute including the S-GW identification within the \"anGwAddr\" attribute.\n-\tIf the \"AN_INFO\" policy control request trigger is met, the user location was requested by the PCF and provided to the SMF+PGW-C, the SMF shall provide the user location information within the \"eutraLocation\" attribute included in the \"userLocationInfo\" attribute and the time when it was last known in the 3GPP access within \"userLocationInfoTime\" attribute (if available).\nWhen the UE handed over from the EPC/E-UTRAN to the EPC/GERAN or EPC/UTRAN and the feature \"2G3GIWK\" is supported the SMF+PGW-C shall include, together with the policy control request triggers met, the following user location information:\n-\tIf the \"SAREA_CH\" or \"SCELL_CH\" policy control request trigger is provisioned and met, the user location information within the \"geraLocation\" attribute or \"utraLocation\" attribute included in the \"userLocationInfo\" attribute.\n-\tIf the \"SCNN_CH\" policy control request trigger is provisioned and met, the \"servNfId\" attribute including the SGSN identification within the \"sgsnAddr\" attribute.\nWhen the UE handed over from the 5GS to EPC non-3GPP access, the SMF+PGW-C shall include, together with the applicable provisioned policy control request triggers, the following user location information:\n-\tIf the \"SAREA_CH\" policy control request trigger is provisioned and met, and the hand over is to EPC untrusted non-3GPP access, the user location information within the \"n3gaLocation\" attribute included in the \"userLocationInfo\" attribute as specified in clause B.3.2.1.\n-\tIf the \"SCNN_CH\" policy control request trigger is provisioned and met, the ePDG identification within the \"anGwAddr\" attribute included in the \"servNfId\" attribute.\n-\tIf the \"AN_INFO\" policy control request trigger is met, the user location was requested by the PCF and provided to the SMF+PGW-C, the SMF shall provide the user location information within the \"n3gaLocation\" attribute included in the \"userLocationInfo\" attribute and the time when it was last known in the non-3GPP access within \"userLocationInfoTime\" attribute (if available). The \"n3gaLocation\" attribute includes the \"ueIpv4Addr\" or \"ueIpv6Addr\" attributes, and, if available the \"portNumber\" and \"protocol\" attributes and, if the feature \"WLAN_Location\" is supported, the \"twapId\" attribute encoding the WLAN location information, if available.\nNOTE 1:\tThe \"n3gaLocation\" attribute does not include the \"n3gppTai\" and \"n3IwfId\" attributes in EPC interworking scenarios.\nNOTE 2:\tSCELL_CH policy control request trigger is not supported in EPC Non-3GPP access. The PCF will not receive user location information related to this trigger in this case.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.4\tPresence Reporting Area Information Report",
                            "text_content": "When the UE is connected through the EPC/E-UTRAN network, the SMF+PGW-C receives the presence reporting area information as defined in 3GPP TS 29.274 [37]. When the PRA or ePRA feature is supported, the SMF+PGW-C provides presence reporting area to the PCF as specified in clause 4.2.4.16.\nIf the SMF+PGW-C receives from the MME presence reporting information corresponding to the Set of Core Network predefined Presence Reporting Areas, and the individual presence reporting area as specified in 3GPP TS 29.274 [37], the SMF+PGW shall only provide the PCF with the individual presence reporting area within the \"praId\" attribute of the PresenceInfo data type.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.5\tAccess Type related information",
                            "text_content": "The SMF+PGW shall include, when the policy control request trigger \"AC_TY_CH\" is met, the following access type information:\n-\tIf after handover the new access type is EPC/E-UTRAN:\na)\tthe \"3GPP_ACCESS\" value within the \"accessType\" attribute; and\nb)\tthe \"EUTRA\" value within the \"ratType\" attribute.\n-\tIf after handover the new access type is EPC/UTRAN and the feature \"2G3GIWK\" is supported:\na)\tthe \"3GPP_ACCESS\" value within the \"accessType\" attribute; and\nb)\tthe \"UTRA\" value within the \"ratType\" attribute.\n-\tIf after handover the new access type is EPC/GERAN and the feature \"2G3GIWK\" is supported:\na)\tthe \"3GPP_ACCESS\" value within the \"accessType\" attribute; and\nb)\tthe \"GERA\" value within the \"ratType\" attribute.\n-\tIf after handover the new access type is EPC/ePDG:\na)\tthe \"NON_3GPP_ACCESS\" value within the \"accessType\" attribute;\nb)\tthe \"WLAN\" or \"VIRTUAL\" value within the \"ratType\" attribute, as applicable; and\nc)\tthe ePDG address in the \"servNfId\" attribute within the \"anGwAddr\" attribute.\nNOTE 1:\tIn the interworking scenario, \"AC_TY_CH\" is met when the UE handed over from the 5GC/N3IWF or 5GC/TNAN/TWAN to the EPC/E-UTRAN, or when the UE handed over from the 5GS to the EPC/ePDG.\nThe SMF+PGW shall include, when the policy control request trigger \"RAT_TY_CH\" is met, the following RAT type information:\n-\tIf after handover the new RAT type is the E-UTRA, the \"EUTRA\" value within the \"ratType\" attribute.\n-\tIf after handover the new RAT type is the WLAN, the \"WLAN\" or \"VIRTUAL\" value within the \"ratType\" attribute, as applicable.\nNOTE 2:\tIn the interworking scenario, \"RAT_TY_CH\" is met when the UE handed over from the NR to the E-UTRA or when the UE handed over from the NR to the WLAN (untrusted) and from E-UTRA to WLAN (trusted/untrusted) or from E-UTRA to N3GA.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.6\tReport of EPS Fallback",
                            "text_content": "When the \"EPSFallbackReport\" feature is supported, if the \"policyCtrlReqTriggers\" attribute with the value \"EPS_FALLBACK\" has been provided to the SMF, the SMF shall notify to the PCF of EPS fallback when a PCC rule referred from the \"lastReqRuleData\" attribute required the EPS fallback report within the \"reqData\" attribute.\nWhen the SMF received a PDU session modification response from the access network indicating the establishment of the QoS flow with 5QI=1 is rejected due to EPS fallback, the SMF shall within the SmPolicyUpdateContextData data structure include:\n-\tthe \"EPS_FALLBACK\" value within the \"repPolicyCtrlReqTriggers\" attribute; and\n-\tthe affected PCC rules within the \"pccRuleIds\" attribute included in the \"ruleReports\" attribute, where the \"ruleStatus\" attribute is set to ACTIVE.\nThe PCF shall identify the AF session that requested the voice media type that triggered the EPS fallback and shall notify the AF as described in clauses 4.2.5.15 of 3GPP TS 29.514 [17] or in clause E.3 of 3GPP TS 29.214 [18].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.7\tMA PDU Session",
                            "text_content": "If the UE or the network does not support MA PDU Session with 3GPP access connected to EPC, when the UE handed over from the EPC/E-UTRAN to the 5GS and the MA PDU Request Indication or MA PDU Network-Upgrade Allowed Indication and ATSSS Capability are received from the UE, if the \"ATSSS\" feature defined in clause 5.8 is supported, the SMF shall include the \"MA_PDU\" within the \"repPolicyCtrlReqTriggers\" attribute, and, as defined in clause 4.2.2.17, the SMF shall include the MA PDU session Indication within the \"maPduInd\" attribute and the ATSSS capability of the MA PDU session within the \"atsssCapab\" attribute. In this case, the PCF shall behave as defined in clause 4.2.2.17.\nNOTE:\tIf the UE and the network support MA PDU Sessions with 3GPP access connected to EPC, the MA PDU Session can be simultaneously associated with user-plane resources on 3GPP access network connected to EPC and with non-3GPP access network connected to 5GC as specified in clause B.3.6.4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.8\tEPS RAN NAS Cause Support",
                            "text_content": "If the RAN-NAS-Cause feature as defined in clause 5.8 is supported, and the PDN connection is established through the EPC network, the SMF shall report the RAN/NAS release cause(s) as specified in clauses 4.2.4.7, 4.2.4.12 and 4.2.4.15, with the exception that the received EPS RAN/NAS cause(s) are encoded within the \"epsCause\" attribute included in the RanNasRelCause data type. In this Release of the specification, the EPS release cause code information may include RAN/NAS release cause(s), a TWAN release cause or an untrusted WLAN release cause.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.9\tS-GW Restoration Support",
                            "text_content": "If the SGWRest feature as defined in clause 5.8 is supported, the PCF and the SMF shall comply with the procedures specified in this clause. During PDU session/PDN connection establishment or modification procedure, the PCF shall subscribe to the \"SCNN_CH\" policy control request trigger if not subscribed yet, as described in clause 4.2.6.4.\nWhen the SMF+PGW receives the policy decision from the PCF as defined in clause 4.2.4.1 or  for a PDN connection maintained during a S-GW failure for a policy decision received as defined in clause 4.2.3.1 or 4.2.4.1, the SMF+PGW shall act as follows:\n-\tFor MME/S4-SGSN triggered S-GW Restoration scenarios:\n-\tWhen the SMF receives the policy decision from the PCF as defined in clause 4.2.4.1 for a PDN connection maintained during a S-GW failure, the SMF shall include the \"ruleReports\" attribute for the affected PCC rules and/or the \"sessRuleReports\" attribute for the affected session rules to report the failure within the SmPolicyUpdateContextData data structure and further include the information as follows.\n-\tif the policy decision is related to one or more PCC rules, the SMF+PGW shall behave as defined in clause 4.2.4.15 with the \"failureCode\" attribute set to set to \"AN_GW_FAILED\".\n-\tif the policy decision is related to one or more session rules the SMF+PGW shall behave as defined in clause 4.2.4.21 with the \"sessRuleFailureCode\" attribute set to \"AN_GW_FAILED\".\n-\tFor SMF+PGW triggered S-GW Restoration scenarios, if the SMF+PGW has accepted the procedure as per normal procedures but the PDN connection is not restored during an operator configured time period, the SMF+PGW shall behave as follows when the related timer expires:\n-\tif the policy decision is related to the PCC rule(s), the SMF+PGW shall behave as defined in clause 4.2.4.15 with the \"failureCode\" attribute set to \"RESOURCE_ALLOCATION_FAILURE\"\n-\tif the policy decision is related to the session rule(s), and the \"SessQoSModEnforcementFailure\" feature is not supported the SMF+PGW shall behave as defined in clause 4.2.4.21 with the \"sessRuleFailureCode\" attribute set to \"SESSION_RESOURCE_ALLOCATION_FAILURE\". If the \"SessQoSModEnforcementFailure\" feature is supported, the \"sessRuleFailureCode\" attribute shall be set to \"DEFAULT_QOS_MODIFICATION_FAILURE\" or \"SESSION_AMBR_MODIFICATION_FAILURE\" based on the failure to enforce the corresponding policy decision.\nFor MME/S4-SGSN triggered S-GW Restoration scenarios, while the S-GW restoration is in progress, if the SMF+PGW sends a request towards the PCF that is triggered by a different event (e.g. internal event at SMF+PGW), the SMF+PGW shall include the \"anGwStatus\" attribute set to \"AN_GW_FAILED\".\nUpon reception of the \"failureCode\" attribute set to \"AN_GW_FAILED\" and/or the \"sessRuleFailureCode\" attribute set to \"AN_GW_FAILED\" or the \"anGwStatus\" attribute set to \"AN_GW_FAILED\", the PCF shall not initiate any SM Policy association modification procedure, except if the SM Policy association modification procedure is initiated for the PCC rule removal only, for the given SM Policy association over N7 until the S-GW has recovered.\nIf the SMF+PGW indicated AN_GW_FAILED previously according to the procedures described above or in annex B.3.3.3, the SMF+PGW shall inform the PCF when the S-GW has recovered by including \"repPolicyCtrlReqTriggers\" attribute set to the \"SCNN_CH\" and the \"servNfId\" attribute including the S-GW identification within the \"anGwAddr\" attribute related to the restored or new S-GW. The PCF may after this update the SMF+PGW if necessary.\nNOTE 1:\tThe PCF could reject requests from the AF and UDR when the \"cause\" attribute of the ProblemDetails data structure set to \"AN_GW_FAILED\", the \"failureCode\" attribute set to \"AN_GW_FAILED\" and/or the \"sessRuleFailureCode\" attribute set to \"AN_GW_FAILED\" or the \"anGwStatus\" attribute set to \"AN_GW_FAILED\" is received until the \"repPolicyCtrlReqTriggers\" attribute set to the \"SCNN_CH\" is received.\nThe SMF+PGW shall maintain the PDN connections affected by the S-GW failure and eligible for restoration for an operator configurable time period. Upon expiry of that time period, the SMF+PGW shall release the PDN connection and inform the PCF about the SM Policy association termination as specified in clause 4.2.5.2.\nNOTE 2:\tThe PCF is not aware of which PDN connections are eligible for restoration. When the SMF+PGW detects a S-GW failure, the SMF+PGW requests the PCF to terminate SM Policy associations associated to PDN connections affected by the S-GW failure and not eligible for restoration.\nThe SMF+PGW should maintain the GBR bearers of the PDN connections eligible for restoration for an operator configurable time period. Upon expiry of that time period, the SMF+PGW shall release GBR bearers that have not yet been restored and inform the PCF about the PCC rule removal as specified in clause 4.2.4.7.\nThe SMF+PGW shall discard downlink packets received for a PDN connection maintained during a S-GW failure that has not yet been restored.\nThe SMF+PGW shall delete the PDN connection locally when it receives an SM Policy association termination from the PCF as described in clause 4.2.4.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.10\tUE initiates a resource modification support",
                            "text_content": "In the case that the UE initiates a resource allocation procedure as defined in clause 6.5.3 or UE initiates a resource modification procedure as defined in clause 6.5.4 of 3GPP 3GPP TS 24.301 [52], the SMF+PGW shall within the SmPolicyUpdateContextData data structure include the \"RES_MO_RE\" within the \"repPolicyCtrlReqTriggers\" attribute and shall include the UE request of specific QoS handling for selected SDF within the \"ueInitResReq\" attribute. Within the UeInitiatedResourceRequest data structure, the SMF+PGW shall include the \"ruleOp\" attribute, \"packFiltInfo\" attribute and \"reqQos\" attribute if applicable as follows:\n-\tWhen the UE requests to \"Create new TFT\", the SMF+PGW shall include the \"ruleOp\" attribute set to \"CREATE_PCC_RULE\", the \"packFiltInfo\" attribute and \"reqQos\" attribute containing the requested QoS for the new PCC rule. Each PacketFilterInfo instance shall contain one packet filter provided by the UE. If the PCF authorizes the request, the PCF shall create a new PCC rule by including the new packet filters within the service data flow template of the PCC rule.\n-\tWhen the UE requests to \"Add packet filters to existing TFT\", SMF+PGW shall include the \"ruleOp\" attribute set to \"MODIFY_PCC_RULE_AND_ADD_PACKET_FILTERS\", the \"pccRuleId\" attribute including the PCC rule identifier corresponding the packet filter identifier provided by the UE and the \"packFiltInfo\" attribute. Each PacketFilterInfo instance shall contain one packet filter requested for addition. If the UE request includes the modified QoS information the SMF+PGW shall also include the \"reqQos\" attribute to indicate the updated QoS for the affected PCC rule(s). If the PCF authorizes the request, the PCF shall update the PCC rule by adding the new packet filters to the service data flow template of the PCC rule.\n-\tWhen the UE requests to \"Replace packet filters in existing TFT\", SMF+PGW shall include the \"ruleOp\" attribute set to \"MODIFY_PCC_RULE_AND_REPLACE_PACKET_FILTERS\", the \"pccRuleId\" attribute including the PCC rule identifier corresponding the packet filter identifier provided by the UE and the \"packFiltInfo\" attribute. Each PacketFilterInfo instance shall within the \"packFiltId\" attribute include the replaced packet filter identifier assigned by the PCF corresponding to the packet filter identifier received from the UE and one packet filter requested for addition. If the UE request includes the modified QoS information the SMF+PGW shall also include the \"reqQos\" attribute to indicate the updated QoS for the affected PCC rule. If the PCF authorizes the request, the PCF shall update PCC rule by replacing the existing packet filter with the new packet filter within the service data flow template of the PCC rule.\n-\tWhen the UE requests to \"Delete packet filters from existing TFT\", SMF+PGW shall include the \"ruleOp\" attribute set to \"MODIFY_PCC_RULE_AND_DELETE_PACKET_FILTERS\", the \"pccRuleId\" attribute including the PCC rule identifier corresponding the paceket filter identifier provided by the UE and the \"packFiltInfo\" attribute. Each PacketFilterInfo instance shall within the \"packFiltId\" attribute include the removed packet filter identifier assigned by the PCF corresponding to the packet filter identifier received from the UE. If the UE request includes modified QoS information the SMF+PGW shall also include the \"reqQos\" attribute to indicate the updated QoS for the affected PCC rule(s). If the PCF authorizes the request, the PCF shall update PCC rule by removing the corresponding packet filters from the service data flow template of the PCC rule.\n-\tWhen the UE requests to \"No TFT operation\", SMF+PGW shall include the \"ruleOp\" attribute set to \"MODIFY_PCC_RULE_WITHOUT_MODIFY_PACKET_FILTERS\", the \"pccRuleId\" attribute including the PCC rule identifier corresponding the paceket filter identifier provided by the UE and the modified QoS information within the \"reqQos\" attribute.\n-\tWhen the UE requests to \"Delete existing TFT\", the SMF+PGW shall include the \"ruleOp\" attribute set to \"DELETE_PCC_RULE\", the \"pccRuleId\" attribute including the PCC rule identifier corresponding the packet filter identifier provided by the UE and the \"packFiltInfo\" attribute. The PCF shall remove the PCC rule when the PCF receives the request according to the PCC rule identifier.\nNOTE 1:\tThe UE can only modify or delete packet filters that the UE has introduced and associated resources. The packet filter identifiers contained in the FlowInformation data structure are only used for packet filters created by the UE.\nThe SMF+PGW shall calculate the requested GBR, for a GBR QCI, as the sum of the previously authorized GBR for the affected PCC rule, adjusted with the difference between the requested GBR for the EPS bearer and previously negotiated GBR for the EPS bearer. For the UE request to \"Create new TFT\", the GBR as requested by the UE for those filters shall be used.\nIf the request covers all the PCC rules with a bearer binding to the same bearer, then the SMF+PGW may request a change to the QCI for existing packet filters.\nFor the purpose of creating or modifying a packet filter, replacing and modifying packet filter, within the UeInitiatedResourceRequest instance, the SMF+PGW shall include the precedence information of the packet filter within the \"precedence\" attribute, and within each PacketFilterInfo instance, the SMF+PGW shall include the \"packFiltCont\" attribute, \"tosTrafficClass\" attribute, \"spi\" attribute, \"flowLabel\" attribute and \"flowDirection\" attribute set to the value(s) describing the packet filter provided by the UE.\nNOTE 2:\tThe UE signalling with the network is governed by the applicable NAS signalling TS. The NAS 3GPP TS for a specific access may restrict the UE possibilities to make requests compared to what is stated above.\nIf the PCF authorizes the request from the UE, the PCF shall construct a PCC rule(s) based on the UeInitiatedResourceRequest data structure. For \"CREATE_PCC_RULE\" or \"MODIFY_PCC_RULE_AND_ADD_PACKET_FILTERS\" operation, the PCF shall within the FlowInformation data structure include the assigned packet filter identifier within the \"packFiltId\" attribute. When the SMF+PGW derives the TFT based on the PCC rule, the SMF+PGW shall assign a new packet filter identifier for each added packet filter and keep the mapping between the packet filter identifier for the packet filter within the PCC rule and TFT sento the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.11\tReport of Access Charging Network Identifier",
                            "text_content": "The report of the Access Network Charging Identifier(s) is as specified in clause 4.2.4.13, with the difference that when the SMF assigns an Access Network Charging Identifier per EPS bearer/QoS flow, the SMF shall additionally include, within each AccNetChId instance, all the PCC rule identifier(s) associated to the provided Access Network Charging Identifier within the \"refPccRuleIds\" attribute.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.11a\tDetection of the SM Policy Association enabling URSP provisioning in EPS",
                            "text_content": "During UE Initial Attach with default PDN connection establishment in EPS, the UE and the SMF+PGW-C perform ePCO capability negotiation as defined in 3GPP TS 24.301 [52] to ensure that both, the network and the UE support URSP provisioning in EPS PCO. The SMF+PGW-C, when receives from the UE the Indication of URSP Provisioning Support in EPS PCO in the PDN connectivity request, and supports the feature \"EpsUrsp\" as defined in clause 5.8, the SMF+PGW-C shall select a PCF that supports the feature \"EpsUrsp\", shall create the SM Policy Association as described in clause B.3.2 and shall provide to the UE the Indication of URSP Provisioning Support in EPS PCO in the PDN Connectivity Accept message as defined in 3GPP TS 24.301 [52].\nWhen the UE determines the URSP provisioning in EPS PCO is supported by the network, then the UE intiates the UE requested bearer modification procedure and includes the UE Policy Container ePCO, which will be further forwarded by the MME to the SMF+PGW-C. When the feature \"EpsUrsp\" is supported and the SMF+PGW-C receives the UE Policy Container ePCO, the SMF+PGW-C shall include the \"UE_POL_CONT_IND\" within the \"repPolicyCtrlReqTriggers\" attribute and shall forward transparently the UE Policy Container to the PCF for the PDU session within the \"uePolCon\" attribute.\nThe PCF for the PDU session then detects that the SM Policy Association enables the URSP provisioning in EPS and establishes a UE Policy Association with the PCF for the UE as described in 3GPP TS 29.525 [57] to transparently forward the received UE policy container. The PCF for the PDU session shall subscribe to RAT Type and/or Access-Type changes if not previously subscribed.\nTo detect the 5GS to EPS handover or 5GS to EPS Idle Mode mobility (both referred as 5GS to EPS mobility with N26 in the present document) and if the \"EpsUrsp\" feature described in clause 5.8 is supported, the PCF for the PDU session shall subscribe to RAT Type and/or Access Type changes, if not previously subscribed. During 5GS to EPS mobility with N26, and if the \"EpsUrsp\" feature described in clause 5.8 is supported, the PCF for the PDU session associated with the SMF+PGW-C serving the PDN connection(s) determines whether 5GS to EPS mobility applies based on the received RAT and/or Access-Type change event. When the reported RAT and Access-Type change event indicates the UE is moving from 5GS to EPS, the PCF for the PDU session then determines that the SM Policy Association(s) enables the URSP provisioning in EPS and establishes a UE Policy Association with the PCF for the UE, if applicable, as described in 3GPP TS 29.525 [57].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.4.12\tReporting of UE Policy container for URSP provisioning in EPS",
                            "text_content": "When the feature \"EpsUrsp\" is supported and a UE policy container is received from the UE in EPC over a PDN connection, the SMF+PGW-C requests to update the SM Policy Association and provides to the PCFthe received UE policy container.\nThe Policy Control Request Trigger condition \"UE_POL_CONT_IND\" is met when the SMF+PGW-C receives a UE policy container from the UE. The SMF+PGW-C shall include the \"UE_POL_CONT_IND\" within the \"repPolicyCtrlReqTriggers\" attribute and shall transparently forward to the PCF the UE policy container encoded within the \"uePolCont\" attribute. The PCF shall transparently forward the UE policy container to the PCF for the UE in Npcf_UEPolicyControl_Update/Create Request as described in 3GPP TS 29.525 [57].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "B.3.5\tNpcf_SMPolicyControl_Delete Service Operation",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "B.3.5.1\tGeneral",
                            "text_content": "When the UE deletes the PDN connection through the EPC network and the SMF+PGW-C shall behave as defined in clause 4.2.5.2 with the difference that the SMF+PGW-C shall include the information elements contained in the Delete Session Request message within the SmPolicyDeleteData data structure.\nNOTE:\tSee Annex B.3.2.1 for location information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.5.2\tEPS RAN NAS Cause Support",
                            "text_content": "If the RAN-NAS-Cause feature as defined in clause 5.8 is supported, and the PDN connection is established through the EPC network, the SMF shall report the RAN/NAS release cause(s) as specified in clause 4.2.5.4.7, with the exception that the received EPS RAN/NAS cause(s) are encoded within the \"epsCause\" attribute included in the RanNasRelCause data type. In this Release of the specification, the EPS release cause code information may include RAN/NAS release cause(s), a TWAN release cause or an untrusted WLAN release cause.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "B.3.6\tProvisioning and Enforcement of Policy Decisions",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "B.3.6.1\tQoS mapping perfomed by the SMF+PGW-C",
                            "text_content": "When the UE is served by the 5GC, during PDU Session establishment and GBR QoS flow establishment, SMF+ PGW-C performs EPS QoS mappings, from the 5G QoS parameters obtained from the PCF, and allocates TFT with the PCC rules obtained from the PCF. If a TFT is to be allocated for a downlink unidirectional EPS bearer mapped from a downlink only QoS Flow, the SMF+ PGW-C shall allocate a TFT packet filter that effectively disallows any useful uplink packet as described in clause 15.3.3.4 of 3GPP TS 23.060 [26]. The SMF+PGW-C sends the mapped QoS parameters and TFT to the UE via PCO.\nWhen the UE is served by the EPC, during PDN Connection establishment and dedicated bearer establishment/modification, SMF+ PGW-C performs EPS QoS mappings, from the 5G QoS parameters obtained from the PCF, and allocates TFT with the PCC rules obtained from the PCF. Other 5G QoS parameters corresponding to the PDN connection, e.g. Session-AMBR, and QoS rules and QoS Flow level QoS parameters if needed for the QoS Flow(s) associated with the QoS rule(s), are sent to UE in PCO.\nThe SMF+PGW-C shall perform EPS QoS mappings as defined in clause 4.11.1.1 and Annex C in 3GPP TS 23.502 [3] as follows:\n-\tignore the QNC and reflective QoS indication if received;\n-\tfor standardized 5QIs, the authorized 5QI is one to one mapped to the QCI;\nNOTE:\tThe delay critical 5QI mapping to QCI is unspecified in the present specification.\n-\tfor non-standardized 5QI,derive the authorized QCI based on the authorized 5QI and operator policy;\n-\tone to one map the subscribed default QCI to the subscribed default 5QI;\n-\tset the subscribed Session-AMBR according to operator policy (e.g. taking the value of subscribed APN-AMBR into account); and\n-\tset the authorized APN-AMBR according to operator policy (e.g. taking the value of authorized Session-AMBR into account).\nWhen SMF+PGW-C is used for GERAN/UTRAN access during PDN Connection establishment, dedicated bearer establishment/modification and the feature \"2G3GIWK\" is supported, SMF+ PGW-C maps R99 QoS to/from EPS parameters as defined in Annex E of TS 23.401 [58]. The EPS and 5G QoS mapping is performed as defined in this clause.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.6.2\tProvisioning of Presence Reporting Area Information",
                            "text_content": "When the PRA or ePRA feature is supported, the PCF provides the SMF with Presence Reporting Area(s) information as specified in clause 4.2.6.5.6. When the UE is connected through the EPC/E-UTRAN network, the SMF+PGW-C initiates the appropriate PDN connection specific procedures specified in 3GPP TS 29.274 [37] to obtain or to deactivate the report of the presence state of a UE in a presence reporting area.\nNOTE:\tHomogeneous support of Presence Area reporting in EPC and 5GC networks is assumed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.6.3\tRequest and Report of Access Network information",
                            "text_content": "If the NetLoc feature as defined in clause 5.8 is supported, the PCF may request the SMF+PGW-C to report the access network information as defined in clause 4.2.6.5.4.\nIf the AN_INFO policy control request trigger is set, upon receiving the \"lastReqRuleData\" attribute with the \"reqData\" attribute with the value(s) MS_TIME_ZONE and/or USER_LOC_INFO and the \"refPccRuleIds\" attribute containing the PCC rule identifier(s) corresponding to the PCC rule(s) being installed, modified or removed:\n-\tIf the \"reqData\" attribute indicates MS_TIME_ZONE and USER_LOC_INFO and the SMF+PGW-C determines that the access network does not support the access network information reporting, the SMF+PGW-C shall immediately inform the PCF by including the \"netLocAccSupp\" attribute set to \"ANR_NOT_SUPPORTED\" value in the \"UeCampingRep\" data structure returned in the \"200 OK\" response to the policy update notification request.\n-\tIf the \"reqData\" attribute only includes the MS_TIME_ZONE value and the SMF+PGW-C determines that the access network does not support the report of the UE time zone, the SMF+PGW-C shall immediately inform the PCF by including the \"netLocAccSupp\" attribute set to \"TZR_NOT_SUPPORTED\" value in the \"UeCampingRep\" data structure returned in the \"200 OK\" response to the policy update notification request.\n-\t If the \"reqData\" attribute only includes the USER_LOC_INFO value and the SMF+PGW-C determines that the access network does not support the report of the UE location, the SMF+PGW-C shall immediately inform the PCF by including the \"netLocAccSupp\" attribute set to \"LOC_NOT_SUPPORTED\" value in the \"UeCampingRep\" data structure returned in the \"200 OK\" response to the policy update notification request.\n-\tIf the \"reqData\" attribute includes the USER_LOC_INFO value and the MS_TIME_ZONE value, and the SMF+PGW-C determines the access network supports the report of UE location and/or UE time zone, the SMF+PGW-C shall apply appropriate procedures to the EPC access network to obtain the requested and supported access network information and shall report the available information as specified in clause 4.2.4.9.\nNOTE:\tThe SMF+PGW determines whether the access network supports access network information reporting based on access type, RAT type and trusted/untrusted type of the access network.\nWhen the request to report access network information occurs within an EPS Fallback for IMS voice procedure, the SMF shall delay the report of access network information till the handover to EPS has been completed, as specified in 3GPP TS 23.502 [3], clause 4.13.6.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.6.4\tMA PDU sessions with connectivity over E-UTRAN/EPC and non-3GPP access to 5GC",
                            "text_content": "If the \"EnATSSS\" feature defined in clause 5.8 is supported by both the SMF and the PCF, this scenario uses the Access Traffic Steering, Switching and Splitting functionality as described in clauses 4.2.2.17, 4.2.3.21, and 4.2.4.2 with the following specifics:\n-\tMulti access connectivity is provided using EUTRAN/EPC as 3GPP access and non-3GPP/5GC system as non-3GPP access.\n-\tThe ATSSS rules are derived from PCC rules and provided from the PGW-C+SMF to the UE over the non-3GPP access in 5GC system.\n-\tWhen the UE requests a PDN connection in EPC indicating the association with a MA PDU session, the PDN connection may be handed over to 3GPP access in 5GC without affecting the ATSSS control.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.6.5\tMA PDU sessions with connectivity over 5GC and non-3GPP access to EPC",
                            "text_content": "If the \"EnATSSS_v2\" feature defined in clause 5.8 is supported by both the SMF and the PCF, this scenario uses the Access Traffic Steering, Switching and Splitting functionality as described in clauses 4.2.2.17, 4.2.3.21, and 4.2.4.2 with the following specifics:\n-\tMulti access connectivity is provided using 5GS as 3GPP access and ePDG/EPC system as non-3GPP access.\n-\tThe ATSSS rules are derived from PCC rules and provided from the PGW-C+SMF to the UE over the 3GPP access in 5GC system. ATSSS rules may be provided to the UE via ePDG/EPC.\n-\tWhen the UE requests a PDU session in 5GS indicating the association with a MA PDU session, the PDU session may be handed over to 3GPP access in EPC without affecting the ATSSS control.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "B.3.7\tDetection and handling of late arriving requests for interworking scenario",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "B.3.7.1\tHandling of requests which collide with an existing SM Policy Association",
                            "text_content": "When the UE is served by the EPC and the SMF+PGW-C receives the origination time stamp from the originating entity (see clause 13.2 of 3GPP TS 29.274 [37]) during the PDN connection establishment, the SMF+PGW-C shall include the origination time stamp parameter within 3gpp-Sbi-Origination-Timestamp header in the HTTP POST request sent to the PCF, the PCF shall perform the behaviour as defined in clause 4.2.7.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "B.3.7.2\tDetection and handling of requests which have timed out at the originating entity",
                            "text_content": "When the UE is served by the EPC and the SMF+PGW-C receives the origination time stamp and the maximum wait time from the originating entity (see clause 13.3 of 3GPP TS 29.274 [37]), the SMF+PGW-C shall behave as defined in annex B.3.2 with the differences that the SMF+PGW-C:\n-\tshall include a 3gpp-Sbi-Sender-Timestamp header set to the value of the received origination time stamp;\n-\tshall include a 3gpp-Sbi-Max-Rsp-Time header set to the value of the received maximum wait time.\nWhen the PCF receives the request from the SMF+PGW-C, the PCF shall behave as defined in clause 6.11.2 of 3GPP TS 29.500 [4].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "C.1\tScope",
            "description": "This annex defines procedures for wireless and wireline convergence access support for 5GS. The specific stage 2 definition and related procedures are contained in 3GPP TS 23.316 [42]. The System Architecture for wireless and wireline convergence access is defined in 3GPP TS 23.501 [2].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "C.2\tNpcf_SMPolicyControl Service",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "C.2.1\tService Description",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "C.2.1.1\tOverview",
                            "text_content": "Clause 4.1.1 applies with the exception that the UE is replaced by the 5G-RG and the W-AGF, which is acting as a UE towards the 5GC on behalf of the FN-RG.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "C.2.1.2\tService Architecture",
                            "text_content": "Clause 4.1.2 applies with the exception that roaming functionality does not apply for session policy control in this Release of the specification for 5G-RG users connecting to the 5GC via W-5GAN and FN-RG users. Roaming architecture is only applicable to a 5G-RG connecting to the 5GC via NG RAN.\nThe 5G-RG may support LTE access connected to EPC and EPC interworking as defined in Annex B.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "C.2.1.3\tNetwork Functions",
                            "text_content": "The PCF functionality defined in clause 4.1.3.1 shall apply with the exceptions described in this Annex.\nThe functionality defined in clause 4.1.3.2 shall apply.\nThe enforcement of the policy decisions applies for a single access PDU session over wireline access and multiaccess PDU sessions over wireline access and 3GPP with the exceptions described in this Annex.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "C.2.1.4\tRules",
                            "text_content": "Functionality as described in clause 4.1.4.2 applies with the following exceptions for the traffic of a PDU session over wireline access:\n-\tUL/DL Maximum Packet Loss Rate information does not apply.\n-\tQoS Notification Control Information does not apply.\nFunctionality as described in clause 4.2.6.2.2 applies with the following exceptions for the traffic of a PDU session over wireline access:\n-\tfor the IPTV service, the \"mulAccCtrl\" attribute within the TrafficControlData data structure to which the PCC rule refers shall be used to describe if the gate is open or closed instead of the \"flowStatus\" attribute.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "C.2.1.5\tPolicy control request trigger",
                            "text_content": "The Policy Control Request Triggers defined in clause 5.6.3.6 and related procedures are supported for a 5G-RG connecting to the 5GC via NG-RAN.\nThe Policy Control Request Triggers defined in clause 5.6.3.6 are supported for a 5G-RG or FN-RG connecting to the 5GC via W-5GAN with the following not supporting ones:\n-\tPLMN_CH\n-\tSAREA_CH\n-\tSCNN_CH\n-\tPRA_CH\n-\tPS_DA_OFF\n-\tQOS_NOTIF\n-\tRES_RELEASE\n-\tUE_STATUS_RESUME\n-\tTSN_BRIDGE_INFO\n-\tQOS_MONITORING\n-\tSCELL_CH\n-\tEPS_FALLBACK\n-\tDDN_FAILURE\n-\tDDN_DELIVERY_STATUS\n-\tDDN_FAILURE_CANCELLATION\n-\tDDN_DELIVERY_STATUS_CANCELLATION\n-\tUSER_LOCATION_CH\n-\tUE_POL_CONT_IND\nConsequently, the procedures related to above policy control request triggers are not supported in the corresponding service operations.\nThe PS_DA_OFF Policy Control Request Trigger may apply for the 5G-RG connecting to the 5GC via W-5GAN (see clause 4.2.2.8 and 4.2.4.8) in an hybrid access scenario (see clause C.3.6.2).\nThe RES_MO_RE Policy Control Request trigger is not supported for a FN-RG as described in BBF TR-456 [47] and CableLabs WR-TR-5WWC-ARCH [48] specification.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "C.2.1.6\tUE IP address support",
                            "text_content": "The UE IP address support defined in clause 4.2.8 applies with the following additions, as specified in 3GPP TS 23.316 [57]:\n-\tIPv6 prefix other than default /64, including individual /128 IPv6 address, for IPv6 address allocation using DHCPv6;\n-\tMore than one UE IP addresses may be assigned to a PDU session and may be received by the PCF, where the UE IP addresses may correspond, to:\na.\tmultiple /128 IPv6 addresses; or\nb.\tan /64 default prefix used for IPv6 stateless autoconfiguration and IPv6 prefix(es) shorter than the default /64 prefix for IPv6 Prefix Delegation not including the /64 IPv6 Prefix (i.e. when the total IPv6 address space available for the PDU session cannot be aggregated into one single IPv6 prefix).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "C.3\tService Operation",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "C.3.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "Clause 4.2.1 applies.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "C.3.2\tNpcf_SMPolicyControl_Create Service Operation",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "C.3.2.1\tGeneral",
                            "text_content": "Clause 4.2.2.2 is applied with the following differences:\n-\tThe allocated /128 IPv6 address or IPv6 /64 prefix or IPv6 prefix shorter than /64 is included within the \"ipv6AddressPrefix\" attribute.\n-\tRequest of Presence Reporting Area Change Report is not applicable when the 5G-RG or FN-RG connects to the 5GC via W-5GAN.\n-\tGlobal Line ID including the line Id and either PLMN Id or operator Id is encoded within the \"gli\" attribute of the \"n3gaLocation\" attribute included in the \"userLoc\" attribute within the PolicyAssociationRequest data structure when the 5G-RG or FN-RG registers via W-5GBAN.\n-\tThe HFC Node Identifier is encoded in the \"hfcNodeId\" attribute of the \"n3gaLocation\" attribute included in the \"userLocationInfo\" attribute within the SmPolicyContextData data structure when the 5G-CRG or FN-CRG connects to the 5GC via W-5GCAN.\n-\tThe PEI that may be included within the \"pei\" attribute shall have one of the following representations:\ni.\tWhen the UE supports only wireline access, the PEI shall be a MAC address.\nNOTE:\tWhen the PEI includes an indication that the MAC address cannot be used as Equipment identifier, the PEI cannot be trusted for regulatory purposes and cannot be used for equipment based policy evaluation.\nii.\tWhen the UE supports at least one 3GPP access technology, the PEI shall be the allocated IMEI or IMEISV.\n-\tTo support of Hybrid Access for a 5G-RG with a single PDU session as described in clause C.3.6.2.2, EPC interworking specific attributes and procedures apply as described in clause B.3.2;\n-\tAccess Traffic Steering, Switching and Splitting as defined in clause 4.2.2.17 is only applicable to the case that the 5G-RG establishes:\na)\tHybrid Access with a multi-access PDU Session connectivity via NG-RAN and W-5GAN, as described in clause C.3.6.2.3; or\nb)\tHybrid Access with a multi-access PDU Session connectivity via EPC/E-UTRAN and W-5GAN, as described in clause C.3.6.2.4.\n-\tThe access network transmission technology for the wireline access may be encoded:\ni.\twithin the \"ratType\" attribute of the SmPolicyContextData type; or\nii.\twhen Access Traffic Steering, Switching and Splitting is supported, within the \"ratType\" attribute of the SmPolicyContextData type, or within the \"ratType\" attribute of the AdditionalAccessInfo type.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "C.3.2.2\tIPTV service support",
                            "text_content": "If the PCF fetches the Multicast Access Control information from the UDR as defined in 3GPP TS 29.519 [15], the PCF shall authorize a PCC rule as defined in Annex C.3.6.1 and provision it to the SMF in the HTTP response message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "C.3.3\tNpcf_SMPolicyControl_UpdateNotify Service Operation",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "C.3.3.1\tGeneral",
                            "text_content": "The descriptions in clause 4.2.3.1 are applied with the following differences:\n-\tTo support Hybrid Access for a 5G-RG with a single PDU session as described in clause C.3.6.2.2, EPC interworking specific attributes and procedures apply as described in B.3.3;\n-\tAccess traffic steering, switching and splitting support as described in clause 4.2.3.21 is only applicable to the case that 5G-RG establishes:\na)\tHybrid Access with a multi-access PDU Session connectivity via NG-RAN and W-5GAN, as described in clause C.3.6.2.3; or\nb)\tHybrid Access with a multi-access PDU Session connectivity via EPC/E-UTRAN and W-5GAN, as described in clause C.3.6.2.4.\n-\tRequest for the result of PCC rule removal is not applicable when the 5G-RG or FN-RG connects to the 5GC via W-5GAN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "C.3.3.2\tIPTV service support",
                            "text_content": "If the PCF fetches the Multicast Access Control information from the UDR as defined in 3GPP TS 29.519 [15], for each impacted PDU session, the PCF shall authorize a PCC rule as defined in Annex C.3.6.1 and provision it to the SMF in the HTTP POST message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "C.3.4\tNpcf_SMPolicyControl_Update Service Operation",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "C.3.4.1\tGeneral",
                            "text_content": "Clause 4.2.4.2 is applied with the following differences:\n-\tThe released /128 IPv6 address or IPv6 /64 prefix or IPv6 prefix shorter than /64 is included within the \"relIpv6AddressPrefix\" attribute.\n-\tIf the feature \"MultiIpv6AddrPrefix\" is supported, the additionally allocated IPv6 prefix may be included within the \"addIpv6AddrPrefixes\" attribute and the additional released IPv6 prefix may be included within the \"addRelIpv6AddrPrefixes\" attribute. If the \"UnlimitedMultiIpv6Prefix\" feature is supported, and if multiple allocated or released IPv6 prefixes are detected, the NF service consumer shall include the new allocated UE Ipv6 prefixes within the \"multiIpv6Prefixes\" attribute and the released UE Ipv6 prefixes within the \"mutliRelIpv6Prefixes\" attribute.\n-\tRAN cause and/or the NAS cause information is not applicable when the 5G-RG or FN-RG connects the 5GC via W-5GAN.\n-\tTo support Hybrid Access for a 5G-RG with a single PDU session as described in clause C.3.6.2.2, EPC interworking specific attributes and procedures apply as described in B.3.4;\n-\tWhen the report of access network information described in clause 4.2.4.9 includes the user location information, the \"n3gaLocation\" attribute shall be included in the \"userLocationInfo\" attribute and:\na)\tif the UE connects via W-5GBAN access:\n-\tGlobal Line Identifier shall be encoded in the \"gli\" attribute; and\n-\tthe \"w5gbanLineType\" attribute to indicate whether the W-5GBAN access is DSL or PON may be included; or\nb)\tif the UE connects via W-5GCAN access, the HFC Node Identifier shall be encoded in the \"hfcNodeId\" attribute.\n-\tAccess traffic steering, switching and splitting support as described in clause 4.2.4.25 is only applicable to the case that 5G-RG establishes:\na)\tHybrid Access with a multi-access PDU Session connectivity via NG-RAN and W-5GAN, as described in clause C.3.6.2.3; or\nb)\tHybrid Access with a multi-access PDU Session connectivity via EPC/E-UTRAN and W-5GAN, as described in clause C.3.6.2.4.\n-\tThe access network transmission technology for the wireline access may be encoded:\ni.\twithin the \"ratType\" attribute of the SmPolicyUpdateContextData type; or\nii.\twhen Access Traffic Steering, Switching and Splitting is supported, within the \"ratType\" attribute of the SmPolicyContextUpdateData type, or within the \"ratType\" attribute of the AdditionalAccessInfo type.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "C.3.4.2\tIPTV service support",
                            "text_content": "If the \"WWC\" feature is supported and \"5G_RG_JOIN\" and/or \"5G_RG_LEAVE\" are provisioned and when the SMF detects a 5G-RG has joined or left to an IP Multicast Group, the SMF shall send an HTTP POST message as defined in clause 4.2.4.2 and include the \"5G_RG_JOIN\" or \"5G_RG_LEAVE\" within the \"repPolicyCtrlReqTriggers\" attribute respectively and the received one or more IP multicast addressing information within the \"mulAddrInfos\" attribute. Within each IpMulticastAddressInfo data structure, the SMF shall include the destination IPv4 multicast address of the DL multicast flow within the \"ipv4MulAddr\" attribute and the source IPv4 address of the DL multicast flow within the \"srcIpv4Addr\" attribute if available or the destination IPv6 multicast address of the DL multicast flow within the \"ipv6MulAddr\" attribute and the source IPv6 address of the DL multicast flow within the \"srcIpv6Addr\" attribute if available.\nNOTE:\tThe corresponding notification can be used by the PCF to manage Preview Rights related with an IP multicast flow corresponding to an IPTV channel by provisioning the corresponding PCC rule. In this case the PCF is responsible to remove the provisioned PCC rule when the preview duration has elapsed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "C.3.5\tNpcf_SMPolicyControl_Delete Service Operation",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "C.3.5.1\tGeneral",
                            "text_content": "Clause 4.2.5.1 is applied with the following differences and limitations:\n-\tthe \"n3gaLocation\" attribute shall be included in the \"userLocationInfo\" attribute and:\na)\tif the UE connects via W-5GBAN access:\n-\tGlobal Line Identifier shall be encoded in the \"gli\" attribute; and\n-\tthe \"w5gbanLineType\" attribute to indicate whether the W-5GBAN access is DSL or PON may be included; or\nb)\tif the UE connects via W-5GCAN access,\n-\tthe HFC Node Identifier shall be encoded in the \"hfcNodeId\" attribute; and\n-\tthe Global Cable Identifier may be encoded within the \"gci\" attribute.\n-\tRAN cause and/or the NAS cause information is not applicable when the 5G-RG or FN-RG connects the 5GC via W-5GAN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "C.3.6\tProvisioning and Enforcement of Policy Decisions",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "C.3.6.0\tGeneral",
                            "text_content": "Clause 4.2.6 applies with the following exceptions for the traffic of a PDU session over wireline access:\n-\tPolicy provisioning and enforcement of authorized QoS per service data flow as described in clause 4.2.6.6.2 applies with the following differences:\na)\tDetermination of Maximum Packet Loss Rate for UL/DL does not apply.\nb)\tPCF does not request a notification when authorized GBR or delay critical GBR cannot be guaranteed or can be guaranteed again, i.e. \"qnc\" attribute does not apply.\n-\tProvisioning of PCC Rules for Multimedia Priority Services is not supported. Clause 4.2.6.2.12 does not apply.\n-\tProvisioning of PCC Rules for Mission Critical Services is not supported. Clause 4.2.6.2.19 does not apply.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "C.3.6.1\tIPTV service support",
                            "text_content": "If the \"WWC\" feature is supported by the SMF and PCF as defined in clause 5.8, when the PCF fetches the Multicast Access Control information from the UDR as defined in 3GPP TS 29.519 [15] applicable for a SUPI or Internal Group Id during the PDU session establishment or receives the notification of the Multicast Access Control information from the UDR as defined in 3GPP TS 29.519 [15] applicable for a SUPI(s) and/or Internal Group Id(s) and/or DNN/S-NSSAI combination(s) during the PDU session modification, the PCF authorizes the Multicast Access Control information. For each impacted PDU Session that corresponds to the Multicast Access Control information, the PCF shall determine the PCC rule(s) that are generated based on the Multicast Access Control information as follows:\n-\tfor the multicast channel(s) which is allowed indicated in the Multicast Access Control information, the PCF shall include the corresponding multicast address(es) within the \"flowInfos\" attribute of the PCC rule and include the \"mulAccCtrl\" attribute set to \"ALLOWED\" within a Traffic Control Data instance which the PCC rule refers to.\n-\tfor the multicast channel(s) which is not allowed indicated in the Multicast Access Control information, the PCF shall include the corresponding multicast address(es) within the \"flowInfos\" attribute of the PCC rule and include the \"mulAccCtrl\" attribute set to \"NOT_ALLOWED\" within a Traffic Control Data instance which the PCC rule refers to.\nNOTE 1:\tThe \"flowStatus\" attribute is not included in this Traffic Control Data instance. The gate fuction is not applicable to IPTV service, and the control is done with the \"mulAccCtrl\" attribute.\nNOTE 2:\tSeparate PCC Rules are used to convey the information related to allowed and not allowed multicast channel(s).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "C.3.6.2\tHybrid Access support",
                            "text_content": "This clause specifies the support of policy control for Hybrid Access considering both, the support of single access PDU sessions and MA PDU sessions.\nHybrid Access applies to a 5G-RG capable of connecting to:\n-\tboth, NG-RAN and wireline access; and/or\n-\tboth, wireline access and EPC/E-UTRAN using EPC interworking as described in Annex B.\nHybrid Access does not apply to FN-RG.\nHybrid Access scenarios with single PDU sessions shall only use one of the two accesses, but the PDU session can be handover over between the two accesses.\nWhen the \"WWC\" feature is supported by the SMF and the PCF as defined in clause 5.8:\n-\tfor a 5G-RG capable of connecting to the NG-RAN and the wireline access, the procedures specified in the main body of this specification apply, except:\ni.\tthe UE is replaced by the 5G-RG; and\nii.\tthe non-3GPP access is replaced by the wireline access, as specified in this annex;\n-\tfor a 5G-RG capable of connecting to the wireline access and the EPC/E-UTRAN access, the procedures specified in the Annex B of this specification apply, except:\ni.\tthe UE is replaced by the 5G-RG; and\nii.\tthe non-3GPP access is replaced by the wireline access.\nIf the \"WWC\" and the \"ATSSS\" features are supported by the SMF and the PCF as defined in clause 5.8, this scenario uses the Access Traffic Steering, Switching and Splitting functionality as described in clauses 4.2.2.17, 4.2.3.21, and 4.2.4.25.8 with the following differences:\n-\tUE is replaced by 5G-RG.\n-\tNon-3GPP access(es) is replaced by wireline access.\nIf the \"WWC\" and the \"ATSSS\" features are supported by the SMF and the PCF as defined in clause 5.8, this scenario uses the Access Traffic Steering, Switching and Splitting functionality as described in clauses 4.2.2.17, 4.2.3.21, and 4.2.4.2 with the following specifics:\n-\tUE is replaced by 5G-RG.\n-\tNon-3GPP access(es) is replaced by wireline access.\n-\tMulti access connectivity is provided using ATSSS using both, EPC (as 3GPP access) and wireline access/5GC system (as non-3GPP access), where:\ni.\tthe ATSSS rules are derived from PCC rules and provided from the PGW-C+SMF to the 5G-RG over wireline access/5GC system;\nii.\twhen the 5G-RG requests a PDN connection in EPC indicating the association with a MA PDU session, the PDN connection may be handed over to 3GPP access in 5GC without affecting the ATSSS control.\n-\tMA PDU Sessions of Ethernet PDU Session type where the 3GPP access corresponds to EPC/E-UTRAN are not applicable for 5G-RG.\nC.3.6.3\tLocation Dependent Policies for trusted non-3GPP access\nTo support location dependent policies when a UE connects using trusted non-3GPP access procedures via TNAP collocated with a 5G-RG, the PCF may retrieve/be notified by the UDR of the AF provided list of TNAP(s) in Service Parameter Data and/or the list of TNAP(s) provided within Session Management Policy Data as defined in 3GPP TS 29.519 [15]. In this case, the PCF may compare the TNAP ID(s) received from the UDR with the TNAP ID received in the user location information (if available) and may apply different policies depending on whether the UE is at a TNAP ID obtained from UDR or not. In case the PCF receives from the UDR TNAP ID(s) both in the Policy Data and in the Service Parameter Data, the PCF decides based on configuration whether to apply both or one of them.\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 122,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}