{
    "document_name": "33128-i60.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "Introduction",
            "description": "The present document has been produced by the 3GPP TSG SA to standardise Lawful Interception of telecommunications. The present document describes protocols and procedures for Lawful Interception based on 3GPP specifications. These protocols and procedures cover both internal 3GPP interfaces (those required to intercept communications and manage interception within a 3GPP network) and external handover interfaces (those used for delivery of intercepted communications to Law Enforcement, or handling of warrants).\nLawful Interception needs to be done in accordance with the applicable national or regional laws and technical regulations. Such national laws and regulations define the extent to which capabilities in the present document are applicable in specific jurisdictions.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document specifies the protocols and procedures required to perform Lawful Interception within a 3GPP network. The present document addresses both internal interfaces used internally with a 3GPP network and external handover interfaces used to handover intercepted communications to law enforcement.\nThe present document describes the detailed targeting of communications in each point of interception within a 3GPP network and the information that a point of interception needs to be able to capture. Furthermore, the detailed data formats for both the internal and external interfaces are also defined.\nNational regulations determine the applicable set of information that needs to be handed over or excluded from handover to law enforcement for a given 3GPP operator service.\n\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.501: \"System Architecture for the 5G System\".\n[3]\t3GPP TS 33.126: \"Lawful Interception Requirements\".\n[4]\t3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".\n[5]\t3GPP TS 33.127: \"Lawful Interception (LI) Architecture and Functions\".\n[6]\tETSI TS 103 120: \"Lawful Interception (LI); Interface for warrant information\".\n[7]\tETSI TS 103 221-1: \"Lawful Interception (LI); Internal Network Interfaces; Part 1: X1\".\n[8]\tETSI TS 103 221-2: \"Lawful Interception (LI); Internal Network Interfaces; Part 2: X2/X3\".\n[9]\tETSI TS 102 232-1: \"Lawful Interception (LI); Handover Interface and Service-Specific Details (SSD) for IP delivery; Part 1: Handover specification for IP delivery\".\n[10]\tETSI TS 102 232-7: \"Lawful Interception (LI); Handover Interface and Service-Specific Details (SSD) for IP delivery; Part 7: Service-specific details for Mobile Services\".\n[11]\t3GPP TS 33.501: \"Security Architecture and Procedures for the 5G System\".\n[12]\t3GPP TS 33.108: \"3G security; Handover interface for Lawful Interception (LI)\".\n[13]\t3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS)\".\n[14]\t3GPP TS 24.007: \"Mobile radio interface signalling layer 3; General Aspects\".\n[15]\t3GPP TS 29.244: \"Interface between the Control Plane and the User Plane nodes\".\n[16]\t3GPP TS 29.502: \"5G System; Session Management Services; Stage 3\".\n[17]\t3GPP TS 29.571: \"5G System; Common Data Types for Service Based Interfaces; Stage 3\".\n[18]\t3GPP TS 23.040: \"Technical realization of the Short Message Service (SMS)\".\n[19]\t3GPP TS 23.003: \"Numbering, addressing and identification \".\n[20]\tOMA-TS-MLP-V3_5-20181211-C: \"Open Mobile Alliance; Mobile Location Protocol, Candidate Version 3.5\", .\n[21]\t3GPP TS 29.540: \"5G System; SMS Services; Stage 3\".\n[22]\t3GPP TS 29.518: \"5G System; Access and Mobility Management Services; Stage 3\".\n[23]\t3GPP TS 38.413: \"NG Application Protocol (NGAP)\".\n[24]\t3GPP TS 29.572: \"Location Management Services; Stage 3\".\n[25]\t3GPP TS 29.503: \"5G System; Unified Data Management Services\".\n[26]\tIETF RFC 815: \"IP datagram reassembly algorithms\".\n[27]\tIETF RFC 2460: \"Internet Protocol, Version 6 (IPv6) Specification\".\n[28]\tIETF RFC 793: \"Transmission Control Protocol\".\n[29]\tIETF RFC 768: \"User Datagram Protocol\".\n[30]\tIETF RFC 4340: \"Datagram Congestion Control Protocol (DCCP)\".\n[31]\tIETF RFC 4960: \"Stream Control Transmission Protocol\".\n[32]\tIANA (www.iana.org): Assigned Internet Protocol Numbers, \"Protocol Numbers\".\n[33]\tIETF RFC 6437: \"IPv6 Flow Label Specification\".\n[34]\tIETF RFC 791: \"Internet Protocol\".\n[35]\tOpen Geospatial Consortium OGC 05-010: \"URNs of definitions in ogc namespace\".\n[36]\t3GPP TS 33.107: \"3G security; Lawful interception architecture and functions\".\n[37]\t3GPP TS 37.340: \"Evolved Universal Radio Access (E-UTRA) and NR-Multi-connectivity; Stage 2\".\n[38]\t3GPP TS 36.413: \"S1 Application Protocol (S1AP)\".\n[39]\tOMA-TS-MMS_ENC-V1_3-20110913-A: \"Multimedia Messaging Service Encapsulation Protocol\".\n[40]\t3GPP TS 23.140: \"Multimedia Messaging Protocol. Functional Description. Stage 2\".\n[41]\t3GPP TS 38.415: \"NG-RAN; PDU Session User Plane Protocol\".\n[42]\t3GPP TS 23.273: \"5G System (5GS) Location Services (LCS); Stage 2\".\n[43]\tIETF RFC 4566: \"SDP: Session Description Protocol\".\n[44]\t3GPP TS 24.193: \"Stage 3: Access Traffic Steering, Switching and Splitting (ATSSS)\".\n[45]\t3GPP TS 29.509: \"5G System; Authentication Server Services; Stage 3\".\n[46]\t3GPP TS 24.011: \"Point-to-Point (PP) Short Message Service (SMS) support on mobile radio interface\".\n[47]\t3GPP TS 29.002: \"Mobile Application Part (MAP) specification\".\n[48]\t3GPP TS 29.504: \"5G System; Unified Data Repository Services; Stage 3\".\n[49]\t3GPP TS 29.505: \"5G System; Usage of the Unified Data Repository services for Subscription Data; Stage 3\".\n[50]\t3GPP TS 23.401 \"General Packet Radio Service (GPRS) enhancements for Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".\n[51]\t3GPP TS 24.301 \"Non-Access-Stratum (NAS) protocol for Evolved Packet System (EPS), Stage 3\".\n[52]\t3GPP TS 23.271 \"Functional stage 2 description of Location Services (LCS)\".\n[53]\t3GPP TS 29.172 \"Evolved Packet Core (EPC) LCS Protocol (ELP) between the Gateway Mobile Location Centre (GMLC) and the Mobile Management Entity (MME); SLg interface\".\n[54]\t3GPP TS 29.171 \"LCS Application Protocol (LCS-AP) between the Mobile Management Entity (MME) and Evolved Serving Mobile Location Centre (E-SMLC); SLs interface\".\n[55]\t3GPP TS 24.379: \"Mission Critical Push to Talk (MCPTT) call control; protocol specification\".\n[56]\tOMA-TS-PoC-System_Description-V2_1-20110802-A: \"OMA PoC System Description\".\n[57]\t3GPP TS 29.541: \"5G System; Network Exposure (NE) function services for Non-IP Data Delivery (NIDD); Stage 3\".\n[58]\t3GPP TS 29.522: \"5G System; Network Exposure Function Northbound APIs; Stage 3\".\n[59]\t3GPP TS 29.338: \"Diameter based protocols to support Short Message Service (SMS) capable Mobile Management Entities (MMEs); Stage 3\".\n[60]\t3GPP TS 29.337: \"Diameter-based T4 interface for communications with packet data networks and applications\".\n[61]\t3GPP TS 24.250: \"Protocol for Reliable Data Service; Stage 3\".\n[62]\t3GPP TS 29.128: \"Mobility Management Entity (MME) and Serving GPRS Support Node (SGSN) interfaces for interworking with packet data networks and applications\".\n[63]\t3GPP TS 29.122: \"T8 reference point for Northbound APIs\".\n[64]\t3GPP TS 29.598: \"5G System; Unstructured Data Storage Services; Stage3\".\n[65]\t3GPP TS 33.535: \"Authentication and Key Management for Applications (AKMA) based on 3GPP credentials in the 5G System (5GS)\".\n[66]\tIETF RFC 5246: \"The Transport Layer Security (TLS) Protocol Version 1.2\".\n[67]\tGSMA IR.88: \"IR.88 LTE and EPC Roaming Guidelines\".\n[68]\tGSMA NG.114 \"IMS Profile for Voice, Video and Messaging over 5GS\".\n[69]\tIETF RFC 8225: \"PASSporT: Personal Assertion Token\".\n[70]\tIETF RFC 8224: \"Authenticated Identity Management in the Session Initiation Protocol (SIP)\".\n[71]\tIETF RFC 8588: \"Personal Assertion Token (PaSSporT) Extension for Signature-based Handling of Asserted information using toKENs (SHAKEN)\".\n[72]\t3GPP TS 24.196: \"Enhanced Calling Name (eCNAM)\".\n[73]\tIETF draft-ietf-stir-passport-rcd-17: \"PASSporT Extension for Rich Call Data\".\nNOTE:\tThe above document cannot be formally referenced until it is published as an RFC.\n[74]\t3GPP TS 24.229: \"IP multimedia call control protocol based on Session Initiation Protocol (SIP)and Session Description Protocol (SDP); Stage 3\".\n[75]\tIANA Session Initiation Protocol (SIP) Parameters:\n[76]\tIETF RFC 8946: \"Personal Assertion Token (PASSporT) Extension for Diverted Calls\".\n[77]\t3GPP TS 23.204: \"3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; Support of Short Message Service (SMS) over generic 3GPP Internet Protocol (IP) access; Stage 2\".\n[78]\tGSMA RCC.07: \"Rich Communication Suite – Advanced Communications Services and Client Specification\".\n[79]\tIETF RFC 4975: \"The Message Session Relay Protocol (MSRP)\".\n[80]\tIETF RFC 3862: \"Common Presence and Instant Messaging (CPIM): Message Format\".\n[81]\tIETF RFC 5438: \"Instant Message Disposition Notification (IMDN)\".\n[82]\tOMA-TS-CPM_System_Description-V2_2-20170926-C: \"OMA Converged IP Messaging System Description\".\n[83]\tVoid.\n[84]\t3GPP TS 36.455: \"Evolved Universal Terrestrial Radio Access (E-UTRA); LTE Positioning Protocol A (LPPa) \".\n[85]\t3GPP TS 37.355: \"LTE Positioning Protocol (LPP)\".\n[86]\t3GPP TS 38.455: \"NG-RAN; NR Positioning Protocol A (NRPPa)\".\n[87]\t3GPP TS 29.274: \"3GPP Evolved Packet System (EPS); Evolved General Packet Radio Service (GPRS) Tunnelling Protocol for Control plane (GTPv2-C); Stage 3\".\n[88]\t3GPP TS 29.513: \"5G System; Policy and Charging Control signalling flows and QoS parameter mapping\".\n[89]\t3GPP TS 29.512: \"5G System; Session Management Policy Control Service; Stage 3\".\n[90]\t3GPP TS 29.508: \"5G System; Session Management Event Exposure Service; Stage 3\".\n[91]\t3GPP TS 29.514: \"5G System; Policy Authorization Service; Stage 3\".\n[92]\t3GPP TS 29.214: \"Policy and Charging Control over Rx reference point\".\n[93]\t3GPP TS 24.558: \"Enabling Edge Applications; Protocol specification\".\n[94]\t3GPP TS 29.558: \"Enabling Edge Applications; Application Programming Interface (API) specification\".\n[95]\t3GPP TS 24.008: \"Mobile radio interface Layer 3 specification; Core network protocols; Stage 3\".\n[96]\t3GPP TS 29.551: \"5G System; Packet Flow Description Management Service; Stage 3\".\n[97]\tETSI TS 103 280: \"Lawful Interception (LI); Dictionary for common parameters\".\n[98]\t3GPP TS 26.512: \"5G Media Streaming (5GMS); Protocols\".\n[99]\t3GPP TS 26.247: \"Transparent end-to-end Packet-switched Streaming Service (PSS); Progressive Download and Dynamic Adaptive Streaming over HTTP (3GP-DASH)\".\n[100]\t3GPP TS 29.563: \"5G System; Home Subscriber Server (HSS) services for interworking with Unified Data Management (UDM); Stage 3\".\n[101]\t3GPP TS 29.562: \"5G System; Home Subscriber Server (HSS) Services; Stage 3\".\n[102]\t3GPP TS 24.341 \"Support of SMS over IP networks, Stage 3\".\n[103]\t3GPP TS 38.473 \"NG-RAN;F1 application protocol (F1AP)\".\n[104]\t3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".\n[105]\tITU-T Recommendation Q.763 (1999): \"Specifications of Signalling System No.7; Formats and codes\".\n[106]\t3GPP TS 29.272: \"Mobility Management Entity (MME) and Serving GPRS Support Node (SGSN) related interfaces based on Diameter protocol\".\n[107]\tIETF RFC 6442: \"Location Conveyance for the Session Initiation Protocol\".\n[108]\tVoid.\n[109]\tOMA-TS-CPM_Conv_Function: \"OMA CPM Conversation Functions\".\n[110]\tIETF RFC 2045: \"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies\".\n[111]\t3GPP TS 32.299: \" Telecommunication management; Charging management; Diameter charging applications\".\n[112]\t3GPP TS 32.423: \"Telecommunication management; Subscriber and equipment trace; Trace data definition and management\".\n[113]\t3GPP TS 38.414: \"NG-RAN; NG data transport\".\n[114]\tIETF RFC 2045: \"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies\".\n[115]\tIETF RFC 5322: \"Internet Message Format\".\n[116]\tIETF RFC 4975: \"The Message Session Relay Protocol (MSRP)\".\n[117]\tIETF RFC 6901: \"JavaScript Object Notation (JSON) Pointer\".\n[118]\tIETF RFC 3261: \"SIP: Session Initiation Protocol\".\n[119]\tW3C Recommendation: \"XML Path Language (XPath)\".\n[120]\tIETF RFC 2046: \"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types\".\n[121]\t3GPP TR 33.928: \"ADMF Logic for Provisioning Lawful Interception (LI) \".\n[122]\t3GPP TS 23.316: \"Wireless and wireline convergence access support for the 5G System\".\n[123]\t3GPP TS 23.038: \"Alphabets and language-specific information\".\n[124]\tITU-T Recommendation X.680 (2021): \"Information technology—Abstract Syntax Notation One (ASN.1): Specification of basic notation\".\n[125]\tIETF RFC 4282: \"The Network Access Identifier\".\n[126]\tIETF RFC 7042: \"IANA Considerations and IETF Protocol and Documentation Usage for IEEE 802 Parameters\".\n[127]\tIEEE \"Guidelines for Use of Extended Unique Identifier (EUI), Organizationally Unique Identifier (OUI), and Company ID (CID)\",\n[128]\t3GPP TS 24.502: \"Access to the 3GPP 5G Core Network (5GCN) via Non-3GPP Access Networks (N3AN)\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tDefinitions",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms and definitions given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tSymbols",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the following symbols apply:\n<symbol>\t<Explanation>\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.3\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\n\nADMF\tLI Administration Function\nCC\tContent of Communication\nCSP\tCommunication Service Provider\nCUPS\tControl and User Plane Separation\nDNAI\tData Network Access Identifier\nICF\tIdentity Caching Function\nIEF\tIdentity Event Function\nIQF\tIdentity Query Function\nIRI\tIntercept Related Information\nLAF\tLocation Acquisition Function\nLALS \tLawful Access Location Services\nLARF\tLocation Acquisition Requesting Function\nLEA\tLaw Enforcement Agency\nLEMF\tLaw Enforcement Monitoring Facility\nLI\tLawful Interception\nLICF\tLawful Interception Control Function\nLI_HI1\tLI_Handover Interface 1\nLI_HI2\tLI_Handover Interface 2\nLI_HI3\tLI_Handover Interface 3\nLI_HI4\tLI_Handover Interface 4\nLI_HILA\tLawful Interception Handover Interface Location Acquisition\nLI_HIQR\tLawful Interception Handover Interface Query Response\nLIPF\tLawful Interception Provisioning Function\nLIR\tLocation Immediate Request\nLI_SI\tLawful Interception System Information Interface\nLISSF\tLawful Interception State Storage Function\nLI_ST\tLawful Interception State Transfer Interface\nLI_X1\tLawful Interception Internal Interface 1\nLI_X2\tLawful Interception Internal Interface 2\nLI_X2_LA\tLawful Interception Internal Interface 2 Location Acquisition\nLI_X3\tLawful Interception Internal Interface 3\nLI_XEM1\tLawful Interception Internal Interface Event Management Interface 1\nLI_XER\tLawful Interception Internal Interface Event Record\nLI_XLA\tLawful Interception Internal Interface Location Acquisition\nLI_XQR\tLawful Interception Internal Interface Query Response\nLTF\tLocation Triggering Function\nMDF\tMediation and Delivery Function\nMDF2\tMediation and Delivery Function 2\nMDF3\tMediation and Delivery Function 3\nMDT\tMinimization of Drive Test\nMM\tMultimedia Message\nMMS\tMultimedia Message Service\nN3AEC\tNon-3GPP Access Establishment Cause\nN3AF\tNon-3GPP Access Function\nNAT\tNetwork Address Translation\nNPLI\tNetwork Provided Location Information\nO&M\tOperations and Management\nPOI\tPoint Of Interception\nRCS\tRich Communication Suite\nSDP\tSession Description Protocol\nSIP\tSession Initiation Protocol\nSIRF\tSystem Information Retrieval Function\nSOI\tStart Of Interception\nTF\tTriggering Function\nTNGF\tTrusted Non-3GPP Gateway Function\nTWIF\tTrusted WLAN Interworking Function\nxCC\tLI_X3 Communications Content.\nxIRI\tLI_X2 Intercept Related Information\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tGeneral",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "The present document provides details of the internal and external interfaces required for a network operator, access provider and/or service provider to provide the necessary information to a Law Enforcement Agency (LEA) required to meet LI requirements. LI requirements for 3GPP networks and services are given in TS 33.126 [3].\nThe high-level architecture that defines the necessary interfaces is specified in TS 33.127 [5]. The generic high-level interception architecture is as follows:\nThe figure depicts a high-level interception architecture diagram with key point-to-point (P2P) interfaces. It illustrates the interception process, including the use of point-to-point (P2P) interfaces, which are essential for transmitting and receiving data. The diagram highlights the importance of these interfaces in ensuring the security and integrity of the interception process.\nFigure 4.1-1: High-level interception architecture diagram with key point-to-point LI interfaces\nThe generic high-level acquisition architecture is as follows:\nThe figure depicts a high-level architecture diagram of the optical backbone, illustrating key point-to-point LI interfaces. It highlights the use of redundant paths to ensure failover reliability and the layered design, which aligns with SDN principles.\nFigure 4.1-2: High-level acquisition architecture diagram with key point-to-point LI interfaces\nThe specification of the interfaces is split into two parts:\n-\tInternal interfaces used between an operator’s network functions are described in clause 4.2.\n-\tExternal interfaces used in communicating with a LEA are described in clause 4.3.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tBasic principles for internal interfaces",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause lists the internal interfaces shown in clause 4.1, indicates the protocol used to realise each interface, and gives a reference to the relevant clauses of the present document that specify how the protocol is to be used for the given interface.\nTable 4.2-1: Internal interfaces and related protocols\n\n",
                    "tables": [
                        {
                            "description": "Table 4.2-1: Internal interfaces and related protocols",
                            "table number": 1,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.3\tBasic principles for external handover interfaces",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause lists the external handover interfaces shown in clause 4.1, indicates the protocol used to realise each interface, and gives a reference to the relevant clauses of the present document that specify how the protocol is to be used for the given interface.\nTable 4.3-1: External handover interfaces and related protocols\n\n",
                    "tables": [
                        {
                            "description": "Table 4.3-1: External handover interfaces and related protocols",
                            "table number": 2,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.4\tService scoping",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.4.1\tGeneral",
                            "text_content": "The interception product shall be delivered to the LEMF over LI_HI2 and LI_HI3, observing the service scoping described in the following clauses.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.2\tCSP service type",
                            "text_content": "The LIPF shall be able to provision the POIs, TFs and MDF2/MDF3 according to the requirements of the warrant with the following CSP service type(s):\n-\tVoice.\n-\tData.\n-\tMessaging (e.g. SMS/MMS).\n-\tPush-to-Talk (including MCPTT).\n-\tLALS (the Target Positioning service, per TS 33.127 [5], clause 7.3.3.2).\n-\tRCS.\nWhen multiple service types are applicable to a target due to multiple warrants, the MDF2/MDF3 shall be able to deliver interception product to each LEMF based on the CSP service type(s) of the respective warrant.\nWhen no service type is provisioned, the POIs shall generate and deliver applicable interception product for all services specified for the NF where the POI is located.\nWhen no service type is provisioned, the MDF2/MDF3 shall deliver all interception product it receives from the POIs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.3\tDelivery type",
                            "text_content": "-\tIRI.\n-\tCC.\n-\tIRI and CC.\nThe LIPF shall be able to provision the POI, TF and the MDF2/MDF3 according the delivery type(s) applicable to a warrant.\nWhen different delivery types are applicable to a target due to multiple warrants, the MDF2/MDF3 shall be able to deliver IRI/CC to each LEMF based on the delivery type(s) of the respective warrant.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.4\tLocation Reporting",
                            "text_content": "The LIPF shall be able to provision the POIs and MDF2 according to the requirements of the warrant with the following location reporting types:\n-\tReport location only at the beginning and end of a session.\n-\tDo not report location.\nWhen no location reporting type is provisioned, the POIs and MDF2/MDF3 shall report location every time the target location information is received at the POI (including location update with no physical change of location).\nWhen different location reporting types are applicable to a target due to multiple warrants, then POI may be provisioned as if the reporting of all location information occurrences at the POI is required, with MDF2 restricting the delivery of location to the LEMF as per the provisioned information for a warrant.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.5\tLALS Triggering",
                            "text_content": "-\tThis option is used to activate the LALS triggered location service (TS 33.127 [5], clause 7.3.3.3) for the target.\nThe LIPF shall be able to provision the LTF associated with a POI or MDF2 with the LALS triggered location service parameters provided in the warrant or use a default set of parameters.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.6\tRoaming Interception",
                            "text_content": "-\tStop interception when the target is roaming outbound internationally.\nNOTE 1: \tThe definition of international roaming for LI purposes could vary per jurisdiction.\nNOTE 2:\tThe method used to achieve the roaming related service scoping is not described in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "5\tTransport and Communications Protocol",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes the protocols used for each of the interfaces at a level which is agnostic of the subject service or network. Additional specific fields or behaviours are given in the relevant parts of clauses 6 and 7.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.2\tProtocols for LI_X1 and LI_T interfaces",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tGeneral usage of ETSI TS 103 221-1",
                            "text_content": "Functions having an LI_X1, LI_T2 or LI_T3 interface shall support the use of ETSI TS 103 221-1 [7] to realise the interface.\nIn the event of a conflict between ETSI TS 103 221-1 [7] and the present document, the terms of the present document shall apply.\nThe LIPF and MDF2/MDF3 shall maintain a mapping between internal interception identifiers (XIDs) and external interception identifiers (LIIDs), as defined by ETSI TS 103 221-1 [7] clause 5.1.2. In case of multiple interceptions for a single target identifier, it is an implementation decision for the LIPF/TF whether multiple XIDs are used (i.e. a one-to-one mapping between XID and LIID is maintained) or whether the single XID is used and mapped to multiple LIIDs at the MDF2/MDF3. Clauses 6 and 7 give further details for specific networks or services (e.g. minimum supported target identifier formats).\nIn the event of a request issued over the interface fails, or an error is reported, the LIPF should raise an alert in the appropriate LI Operations and Management (O&M) system. Further procedures (e.g. retrying a failed request) are left to CSP policy to define.\nA failure of LI shall not impact the target's or other users' services.\nIn general, and unless otherwise specified, the function playing the role of the NE (i.e. IRI-POI, IRI-TF, CC-TF, CC-POI, MDF2 or MDF3) shall:\n-\tAccept CreateDestination and ModifyDestination messages regardless of the DeliveryType.\n-\tReject ActivateTask/ModifyTask messages that contain destination identifiers (DIDs) that reference Destinations that have not been created via a CreateDestination message; Destinations shall be created before they are used.\n-\tReject ActivateTask/ModifyTask messages that do not result in at least one valid DID for their DeliveryType (e.g. at least one valid DID for an X2 delivery destination for an \"X2Only\" Task). Additional DIDs for Destinations of other DeliveryTypes (e.g. a DID for an X3 Destination for an \"X2Only\" Task) shall be accepted, but a ReportTaskIssue message may be sent to indicate the mismatch.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tUsage for realising LI_X1",
                            "text_content": "For the purposes of realising LI_X1 between the LIPF and a POI, MDF or TF, the LIPF plays the role of the ADMF as defined in ETSI TS 103 221-1 [7] reference model (clause 4.2), and the POI, MDF or TF plays the role of the NE.\nIn general, and unless otherwise specified, the ADMF shall:\n-\tWhen the provisioning of an IRI-POI/IRI-TF/MDF2 is needed to meet the requirements of the warrant, send an ActivateTask (and subsequent ModifyTask if/as needed) with the DeliveryType set to \"X2Only\" and the ListOfDIDs containing at least one DID for an X2 or LI_HI2 delivery destination over LI_X1 to each of the relevant functions.\n-\tWhen the provisioning of a CC-POI/CC-TF/MDF3 is needed to meet the requirements of the warrant, send an ActivateTask (and subsequent ModifyTask if/as needed) with the DeliveryType set to \"X3Only\" and the ListOfDIDs containing at least one DID for X3 or LI_HI3 delivery destination over LI_X1 to each of the relevant functions.\nWhen both the above are required to meet the requirements of the warrant, the ADMF shall send each independently to each relevant function.\nWhen it is required to cease interception, the ADMF shall send a DeactivateTask message to each relevant function, unless the Task has already been removed by other means (e.g. by the use of the ImplicitDeactivationAllowed flag, see ETSI TS 103 221-1 [7] clause 6.2.1.2).\nOther deployments compliant with ETSI TS 103 221-1 [7] may be used subject to local agreement.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.3\tUsage for realising LI_X1 (management)",
                            "text_content": "For the purposes of realising LI_X1 between the LIPF and a triggered POI, the LIPF plays the role of the “ADMF” as defined in ETSI TS 103 221-1 [7] reference model (clause 4.2), and the triggered POI plays the role of the “NE”.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.4\tService scoping",
                            "text_content": "The LIPF shall be able to provision the POI, TFs and the MDF2/MDF3 according to the service scoping (see clause 4.4) applicable to a warrant as described in clause 6.2.1.2 and Annex C of ETSI TS 103 221-1 [7].\nIf there is a need to explicitly identify specific CSP service types to be intercepted by the task, the LIPF shall include the ListOfServiceTypes parameter in the TaskDetails of the provisioning message sent to the POIs/TFs. If no service type is provisioned, the POIs shall generate and deliver applicable interception product for all services specified for the NF where the POI is located as described in clause 4.4.2.\nIf there is a need to explicitly identify specific CSP service types to be delivered by the task, the LIPF shall populate the ServiceType in the ServiceScoping parameter in the MediationDetails of the provisioning message sent to the MDF2/MDF3. If the LIPF includes the ListOfServiceTypes parameter in the TaskDetails of the provisioning message sent to the MDF2/MDF3, the MDF2/MDF3 shall ignore this parameter.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.5\tUsage for realising LI_T2",
                            "text_content": "For the purposes of realising LI_T2 between an IRI-TF and a triggered IRI-POI, the IRI-TF plays the role of the \"ADMF\" as defined in the ETSI TS 103 221-1 [7] reference model (clause 4.2), and the triggered IRI-POI plays the role of the \"NE\".\nIn case the IRI-TF receives from the triggered IRI-POI an error in the answer to a triggering message, the IRI-TF shall send a ReportTaskIssue message to the LIPF. In such case, the failure of LI shall not impact the target's or other users' services.\nUnless otherwise specified, an IRI-TF shall set the ProductID field in any ActivateTask or ModifyTask message issued to a triggered IRI-POI (see ETSI TS 103 221-1 [7] clause 6.2.1.2). The IRI-TF shall set the ProductID to the XID of the Task object associated with the interception at the IRI-TF in order to allow correlation of LI product at the MDF2.\nUnless otherwise specified, the TF shall include the MDF2 as the X2 delivery destination in the trigger sent using the ActivateTask/ModifyTask with \"X2Only\".\nWhen the IRI-TF determines that it is required to remove a Task at a particular IRI-POI (e.g. having detected the end of a session) it shall send a DeactivateTask message for the relevant Task to that IRI-POI, unless the Task has already been removed by other means (e.g. by the use of the ImplicitDeactivationAllowed flag, see ETSI TS 103 221-1 [7] clause 6.2.12).\nWhen the IRI-TF receives a DeactivateTask message or ModifyTask message from the LIPF, the IRI-TF shall send DeactivateTask or ModifyTask messages to all applicable triggered IRI-POIs for all tasks associated to the Task object in the message from the LIPF.\nWhen the IRI-TF reports the status of a Task via a GetTaskDetailsResponse or GetAllDetailsResponse, the IRI-TF shall also report the details of each 'delegated' Task that the IRI-TF is maintaining at an IRI-POI as a result of that Task. The details are given using the DelegatedTaskStatus structure described in Table 5.2.5-1 below, which is placed in the TaskStatusExtensions element of the TaskStatus structure in the response (see ETSI TS 103 221-1 [7] clause 6.4.2.2).\nTable 5.2.5-1: DelegatedTaskStatus definition\n\nTable 5.2.5-2: DelegatedTask definition\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.2.5-1: DelegatedTaskStatus definition",
                                    "table number": 3,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.2.5-2: DelegatedTask definition",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.2.6\tUsage for realising LI_T3",
                            "text_content": "For the purposes of realising LI_T3 between a CC-TF and a triggered CC-POI, the CC-TF plays the role of the \"ADMF\" as defined in the ETSI TS 103 221-1 [7] reference model (clause 4.2), and the triggered CC-POI plays the role of the \"NE\".\nIn case the CC-TF receives from the triggered CC-POI an error in the answer to a triggering message, the CC-TF shall send a ReportTaskIssue message to the LIPF. In such case, the failure of LI shall not impact the target's or other users' services.\nUnless otherwise specified, a CC-TF shall set the ProductID field in any ActivateTask or ModifyTask message issued to a triggered CC-POI (see ETSI TS 103 221-1 [7] clause 6.2.1.2). The CC-TF shall set the ProductID to the XID of the Task object associated with the interception at the CC-TF in order to allow correlation of LI product at the MDF3.\nUnless otherwise specified, the TF shall include MDF3 as the X3 delivery destination in the trigger sent using the ActivateTask/ModifyTask with \"X3Only\".\nWhen the CC-TF determines that it is required to remove a Task at a particular CC-POI (e.g. having detected the end of a session) it shall send a DeactivateTask message for the relevant Task to that CC-POI, unless the Task has already been removed by other means (e.g. by the use of the ImplicitDeactivationAllowed flag, see ETSI TS 103 221-1 [7] clause 6.2.12).\nWhen the CC-TF receives a DeactivateTask message or ModifyTask message from the LIPF, the CC-TF shall send DeactivateTask or ModifyTask messages to all applicable triggered CC-POIs for all tasks associated to the Task object in the message from the LIPF.\nWhen the CC-TF reports the status of a Task via a GetTaskDetailsResponse or GetAllDetailsResponse, the CC-TF shall also report the details of each 'delegated' Task that the CC-TF is maintaining at an CC-POI as a result of that Task, using the mechanism described in clause 5.2.5.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.7\tUsage for realising LI_XEM1",
                            "text_content": "For the purposes of realising LI_XEM1 between the LIPF and an IEF, the LIPF plays the role of the ADMF as defined in ETSI TS 103 221-1 [7] reference model (clause 4.2), and the IEF plays the role of the NE.\nThe IEF shall be enabled by sending the following ActivateTask message from the LIPF.\nNOTE:\tThe terms identifier and identity are used interchangeably in clause 5.2.7.\nTable 5.2.7-1: ActivateTask message for activating an IEF\n\nThe following Target Identifier Type is defined for the use of LI_XEM1. Unless otherwise specified, use of any other Target Identifier Type (including adding a target identifier more than once) shall result in the ActivateTask message being rejected with the appropriate error.\nTable 5.2.7-2: Target Identifier Type for LI_XEM1\n\nThe IEF may be reconfigured to send identity associations to a different ICF using a ModifyTask message to modify the delivery destinations.\nThe IEF shall be disabled by sending the following DeactivateTask message from the LIPF.\nTable 5.2.7-3: DeactivateTask message for de-activating an IEF\n\nThe LIPF should send one ActivateTask command to each IEF.\nNOTE:\tThe IEF may receive multiple ActivateTask messages conforming to table 5.2.7-1, each of which can be independently deactivated. The IEF shall remain active as long as at least one valid Task remains active.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.2.7-1: ActivateTask message for activating an IEF",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.2.7-2: Target Identifier Type for LI_XEM1",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.2.7-3: DeactivateTask message for de-activating an IEF",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "5.3\tProtocols for LI_X2 and LI_X3",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tGeneral usage of ETSI TS 103 221-2",
                            "text_content": "Functions having an LI_X2 or LI_X3 interface shall support the use of ETSI TS 103 221-2 [8] to realise the interface.\nIn the event of a conflict between ETSI TS 103 221-2 [8] and the present document, the terms of the present document shall apply.\nThe xIRI and the xCC sent using ETSI TS 103 221-2 [8] shall contain the appropriate XID as received in the relevant LI_X1 provisioning message (or LI_T2/LI_T3 triggering message, as appropriate), noting that the appropriate XID may be given in the ProductID field.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.2\tUsage for realising LI_X2",
                            "text_content": "The POI sending xIRI over the LI_X2 interface shall set the PDU type field within the xIRI to \"X2 PDU\". (see ETSI TS 103 221-2 [8] clause 5.1).\nWhere a single xIRI is sent as a result of a network procedure (i.e. as result of several signaling messages exchanged between the target UE and the network), the POI sending the xIRI shall set the Payload Direction field (see ETSI TS 103 221-2 [8] clause 5.2.6) based on the initiator of the network procedure.\nUnless otherwise specified by the relevant clause, the payload shall consist of a BER-encoded TS33128Payloads.XIRIPayload structure. The payload format (see ETSI TS 103 221-2 [8] clause 5.4) shall be set according to the relevant clause of the present document (the value 2 is used for TS 33128Payloads.XIRIPayload).The TLS transport profile (see ETSI TS 103 221-2 [8] clause 6) shall be supported and used by default.\nUnless otherwise specified, xIRI shall include the timestamp and sequence number conditional attribute fields, with the timestamp value set to the time at which the event occurred.\nUnless otherwise specified, the \"Matched Target Identifier\" conditional attribute shall be set to indicate what target identity was matched to generate the xIRI (see ETSI TS 103 221-2 [8] clause 5.3.18).\nUnless otherwise specified, the \"Other Target Identifier\" conditional attribute shall be set with all other target identities present at the NF that contains the POI (see ETSI TS 103 221-2 [8] clause 5.3.19).\nUnless otherwise specified, the NFID conditional attribute (see ETSI TS 103 221-2 [8] clause 5.3.7) shall be set to indicate the NF that contains the POI. The NFID is defined as a unique identifier assigned to the NF by the network (e.g. FQDN) per carrier implementation and referred to in the following clauses.\nUnless otherwise specified, the IPID conditional attribute (see ETSI TS 103 221-2 [8] clause 5.3.8) shall be set to indicate the POI (within the NF) that generated the xIRI for the conditional attribute field.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.3\tUsage for realising LI_X3",
                            "text_content": "The POI sending xCC over the LI_X3 interface shall set the PDU type field in the xCC to \"X3 PDU\" (see ETSI TS 103 221-2 [8] clause 5.1).\nThe payload format shall be specified according to the relevant clause of the present document.\nUnless otherwise specified, the NFID conditional attribute (see ETSI TS 103 221-2 [8] clause 5.3.7) shall be set to indicate the NF that contains the POI. The NFID is defined as a unique identifier assigned to the NF by the network (e.g. FQDN) per carrier implementation and referred to in the following clauses.\nUnless otherwise specified, the IPID conditional attribute (see ETSI TS 103 221-2 [8] clause 5.3.8) shall be set to indicate the POI (within the NF) that generated the xCC for the conditional attribute field.\nIf defined by LI for a specific 3GPP-defined-network deployment (see clause 6) or a specific 3GPP-defined service (see clause 7), the POI may use the Additional XID Related Information attributes to facilitate efficient delivery of xCC, as specified in ETSI TS 103 221-2 [8] clause 5.3.22.\nNOTE:\tETSI TS 103 221-2 [8] specifies in clause 6 a default profile which is mandatory to support, but allows further profiles to be defined. In scenarios where it may not be possible to achieve the necessary LI data rates based on the default profile, alternative profiles may be considered (e.g. based on UDP, multi path TCP or other protocols). Any alternative profile needs to ensure that LI reliability, security and completeness requirements as specified in TS 33.126 [3] are met.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.4\tService scoping",
                            "text_content": "When applicable, the POIs shall deliver the xIRIs/xCC to MDF2/MDF3 over LI_X2/LI_X3 according to the service scoping as provisioned by the LIPF to them (see clause 5.2.4).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.5\tUsage for realising LI_X2_LA",
                            "text_content": "Functions having an LI_X2_LA interface shall use the protocols for LI_X2 as defined in clause 5.3.2 to realise the interface with the following additions.\nThe LI function sending the message over LI_X2_LA shall set the Payload Direction field in the PDU header to not applicable (Direction Value 5, see ETSI TS 103 221-2 [8] clause 5.2.6).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.4\tProtocols for LI_HI1",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.4.1\tGeneral",
                            "text_content": "Functions having an LI_HI1 interface shall support the use of ETSI TS 103 120 [6] to realise the interface.\nIn the event of a conflict between ETSI TS 103 120 [6] and the present document, the terms of the present document shall apply.\nThe representation of tasking requests shall be as specified in the present clause.\nEach request to intercept a particular identifier shall be represented as an LITaskObject (see ETSI TS 103 120 [6] clause 8.2). Table 5.4.1-1 shows the minimum details required for the LITaskObject to be valid.\nTable 5.4.1-1: LITaskObject details\n\nTable 5.4.1-2: LITaskObject TargetIdentifier details\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.4.1-1: LITaskObject details",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.4.1-2: LITaskObject TargetIdentifier details",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.4.2\tService scoping",
                            "text_content": "Functions having an LI_HI1 interface (i.e. the ADMF) shall be able to receive the service scoping as applicable to the warrant from the LEA over the LI_HI1 interface (see clause 4.4).\nWhere TS 103 120 [6] is used to realise LI_HI1, and where the details in clause 5.4.1 apply, the ServiceType field of the TargetIdentifier in a given LITaskObject shall be used to identify the appropriate service scoping. For each service scoping type defined in clause 4.4.2 that is required, the appropriate dictionary entry defined in table 5.4.2-1 below shall be included in the ServiceType field. If no service type is required to be provisioned, the ServiceType field shall be omitted.\nTable 5.4.2-1: ServiceType Dictionary\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.4.2-1: ServiceType Dictionary",
                                    "table number": 10,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.4.3\tLocation acquisition",
                            "text_content": "When required for location acquisition, the warrant sent over the LI_HI1 interface will specify the delivery method using task flags populated as shown in table 5.4.3-1. If the delivery method is HI2Delivery (via MDF2), the LIPF shall ensure that the MDF2 (clause 7.3.5.6.1) is provisioned. Subsequently, the LAF will use this information while processing location acquisition requests received over the LI_HILA interface.\nTable 5.4.3-1: LATaskFlag Dictionary for LI_HI1\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.4.3-1: LATaskFlag Dictionary for LI_HI1",
                                    "table number": 11,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "5.5\tProtocols for LI_HI2 and LI_HI3",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.5.1\tGeneral",
                            "text_content": "Functions having an LI_HI2 or LI_HI3 interface shall support the use of ETSI TS 102 232-1 [9] and ETSI TS 102 232-7 [10] to realise the interface.\nIn the event of a conflict between either specification and the present document, the terms of the present document shall apply.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.2\tUsage for realising LI_HI2",
                            "text_content": "The IRI messages sent over LI_HI2 are structured as a header and a payload. The header contains general information like LIID, timestamp, correlation information (as for example defined in ETSI TS 102 232-1 [9]). The payload contains intercept related information based on information that the MDF2 has received from sources in the network, such as the IRI-POI as described in clauses 6 and 7 of the present document. Details of the IRI messages can be found in Annex A of the present document. Messages defined as passing over the LI_HI2 interface shall be passed as the payload of the threeGPP33128DefinedIRI field (see TS ETSI 102 232 -7 [10] clause 15).\nIf the LI_X2 contains the NFID conditional attribute (see ETSI TS 103 221-2 [8] clause 5.3.7), this shall be mapped into the PSHeader networkFunctionIdentifier (see ETSI TS 102 232-1 [9] clause 5.2.14 and ETSI TS 102 232-7 [10] clause 15.3).\nIf the LI_X2 contains the IPID conditional attribute (see ETSI TS 103 221-2 [8]), the EIPID parameter (see ETSI TS 102 232-1 [9] clause 5.2.13) shall be populated by the MDF2 with the IPID value.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.3\tUsage for realising LI_HI3",
                            "text_content": "The CC sent over LI_HI3 is structured as a header and a payload. The header contains general information like LIID, timestamp, correlation information (as for example defined in ETSI TS 102 232-1 [9]). The payload contains content of communication based on information that the MDF3 has received from sources in the network, such as the CC-POI as described in clauses 6 and 7 of the present document. Details of the CC can be found in Annex A of the present document. CC defined as passing over the LI_HI3 interface shall be passed as the payload of the threeGPP33128DefinedCC field (see ETSI TS 102 232-7 [10] clause 15).\nIf the LI_X3 contains the NFID conditional attribute (see ETSI TS 103 221-2 [8] clause 5.3.7), this shall be mapped into the PSHeader networkFunctionIdentifier (see ETSI Ts 102 232-1 [9] clause 5.2.14 and ETSI TS 102 232-7 [10] clause 15.3).\nIf the LI_X3 contains the IPID conditional attribute (see ETSI TS 103 221-2 [8]), the EIPID parameter (see ETSI TS 102 232-1 [9] clause 5.2.13) shall be populated by the MDF3 with the IPID value.\nNOTE:\tETSI TS 102 232-1 [9] specifies in clause 6.4 a transport layer based on TCP. However, based on agreement between network operator and LEA, in scenarios where it may not be possible to achieve the necessary LI data rates based on the transport layer based on single TCP connection, alternative profiles may be considered (e.g. based on UDP, multi path TCP or other protocols). Any alternative profile needs to ensure that LI reliability, security and completeness requirements as specified in TS 33.126 [3] are met.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.4\tService scoping",
                            "text_content": "The MDF2 and MDF3 shall be able to deliver the IRI messages and the CC to the LEMF over LI_HI2 and LI_HI3 respectively, according to the provisioned service scoping (see clause 5.2.4).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.5\tIRI Target Identifiers",
                            "text_content": "The MDF shall populate the TargetIdentifiers field of the IRIPayload defined in Annex A with all Target Identifiers available at the MDF. For all Identifiers received in the LI_X2 \"Matched Target Identifier\" conditional attribute (see clause 5.3.2), the MDF shall include the relevant Identifier with the provenance set to \"matchedOn\". For all Identifiers received in the the LI_X2 \"Other Target Identifier\" conditional attribute (see clause 5.3.2), the MDF shall include the relevant Identifier with the provenance set to \"other\". For all Identifiers present in the xIRI payload, the MDF shall include the relevant Identifier with the provenance set to \"observed\". For all Identifiers present in the provisioning message received over X1, the MDF shall include the relevant Identifier with the provenance set to \"lEAProvided\". For all Identifiers present in the MDF that are not reported as other TargetIdentifiers, the MDF shall include the relevant Identifier with the provenance set to \"other\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.6\tProtocols for LI_HI4",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.6.1\tGeneral",
                            "text_content": "Functions having an LI_HI4 shall support the use of ETSI TS 102 232-1 [9] to realise the interface.\nIn the event of a conflict between ETSI TS 102 232-1 [9] and the present document, the terms of the present document shall apply.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6.2\tUsage for realising LI_HI4",
                            "text_content": "The LI Notification messages sent over LI_HI4 are structured as a header and a payload. The header contains general information like LIID, timestamp (as for example defined in ETSI TS 102 232-1 [9]). The payload contains the administrative information such as notification. Details of the LI Notification messages can be found in Annex B of the present document.\nWhere the LI_HI4 interface is present alongside an LI_HI2 interface or LI_HI3 interface, the LI Notification messages shall be transmitted along the same connection as the IRI messages or CC. Where ETSI TS 102 232-1 [9] is used for LI_HI2 or LI_HI3, messages defined as passing over the LI_HI4 interface shall be passed in the hI4Payload sequence.\nThe MDF2/MDF3 shall support generation LI Notification messages for at least the following events:\n-\tActivation of an interception at the MDF2/MDF3 via LI_X1.\n-\tModification of an interception at the MDF2/MDF3 via LI_X1.\n-\tDeactivation of an interception at the MDF2/MDF3 via LI_X1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.7\tProtocols for LI_HIQR",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.7.1\tGeneral",
                            "text_content": "Functions having an LI_HIQR interface shall support the use of ETSI TS 103 120 [6] to realise the interface.\nIn the event of a conflict between ETSI TS 103 120 [6] and the present document, the terms of the present document shall apply.\nNOTE:\tThe terms identifier and identity are used interchangeably in clause 5.7.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.2\tUsage for realising LI_HIQR",
                            "text_content": "LI_HIQR requests are represented by issuing a CREATE request for an LDTaskObject (see ETSI TS 103 120 [6] clause 8.3), populated as follows:\nTable 5.7.2-1: LDTaskObject representation of LI_HIQR request\n\nThe use of any other LDTaskObject parameter is outside the scope of the present document.\nTable 5.7.2-2: RequestDetails structure\n\nNOTE:\tIf the observed time is in the past, providing a successful query response is subject to associations still being available in the cache when the query is made to the ICF.\nTable 5.7.2-3: RequestType Dictionary for LI_HIQR\n\nTable 5.7.2-3 is formatted in accordance with ETSI TS 103 120 [6] Annex F.\nThe RequestValues field shall contain one of the following:\n-\tSUPI, given in either SUPIIMSI or SUPINAI formats as defined in ETSI TS 103 120 [6] clause C.2.\n-\tSUCI, given as defined in table 5.7.2-4 below.\n-\t5G-S-TMSI, given as defined in table 5.7.2-4 below.\n-\t5G-GUTI, given as defined in table 5.7.2-4 below.\nIf the RequestType is \"OngoingIdentityAssociation\" (see table 5.7.2-3), SUPI is the only valid identity type in the RequestValues field. If the RequestType is \"OngoingIdentityAssociation\" and any other identity type is provided, the IQF shall signal the error by setting the LDTaskObject Status to \"Invalid\" (see ETSI TS 103 120 [6] clause 8.3.3).\nIf a temporary identity is provided, the following may also be present as RequestValues:\n-\tNRCellIdentity, given as defined in table 5.7.2-4 below.\nIf a temporary identity is provided, the following shall also be present as RequestValues:\n-\tTrackingAreaCode, given as defined in table 5.7.2-4 below.\nThe following RequestValue FormatTypes (see ETSI TS 103 120 [6] clause 8.3.5.4) are defined (which are not otherwise defined elsewhere).\nTable 5.7.2-4: RequestValue FormatType extensions for LI_HIQR Requests\n\nThe LDTaskObject may also contain the \"IncludeNCGIInResponse\" LDTask flag (see table 5.7.2-4A). If this flag is present for such a query, then the response shall contain the NR Cell Global Identity associated with the SUPI at the time of association (see table 5.7.2-5).\nTable 5.7.2-4A: LDTaskFlags for LI_HIQR Requests\n\nThe LI_HIQR request is used to generate a request to the ICF over LI_XQR (see clause 5.8). The response received over LI_XQR is then transformed into an LI_HIQR response.\nLI_HIQR responses and updates are represented as XML following the IdentityResponseDetails type definition (see Annex E).\nResponses and updates are delivered within a DELIVER Request (see ETSI TS 103 120 [6] clause 6.4.10) containing a DeliveryObject (see ETSI TS 103 120 [6] clause 10).\nIdentityResponseDetails contain IdentityAssociation records. The fields of each IdentityAssociationRecord shall be set as follows:\nTable 5.7.2-5: IdentityAssociationRecord\n\nIf no association is found which matches the criteria provided in the LI_XQR request, then the LI_XQR response contains zero IdentityAssociationRecords. Similarly, the LI_HIQR response contains zero IdentityAssociationRecords.\nFor responses or updates providing a currently valid SUPI to 5G-GUTI identity association, the AssociationEndTime shall be absent. The AssociationStartTime shall indicate when the 5G-GUTI became associated with the SUPI. The SUCI field shall be populated if it was present in the IEF record for the association (see clause 6.2.2A.2.1). The PEI and TAI List fields may be populated as well, see clause 7.6.2.4 for details.\nIn the case of ongoing updates, the presence of the AssociationEndTime indicates the SUPI to 5G-GUTI identity disassociation. Such updates shall only happen when no new association is replacing the outgoing one.\nThe DeliveryObject Reference field (see ETSI TS 103 120 [6] clause 10.2.1) shall be set to the Reference of the LDTaskObject used in the request, to provide correlation between request and response. The DeliveryID, SequenceNumber and LastSequence fields shall be set according to ETSI TS 103 120 [6] clause 10.2.1.\nThe content manifest (see ETSI TS 103 120 [6] clause 10.2.2) shall be set to indicate the present document, using the following Specification Dictionary extension.\nTable 5.7.2-6: Specification Dictionary\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.7.2-1: LDTaskObject representation of LI_HIQR request",
                                    "table number": 12,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.7.2-2: RequestDetails structure",
                                    "table number": 13,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.7.2-3: RequestType Dictionary for LI_HIQR",
                                    "table number": 14,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.7.2-4: RequestValue FormatType extensions for LI_HIQR Requests",
                                    "table number": 15,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.7.2-4A: LDTaskFlags for LI_HIQR Requests",
                                    "table number": 16,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.7.2-5: IdentityAssociationRecord",
                                    "table number": 17,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.7.2-6: Specification Dictionary",
                                    "table number": 18,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "5.8\tProtocols for LI_XQR",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.8.1\tGeneral",
                            "text_content": "LI_XQR requests are realised using ETSI TS 103 221-1 [7] to transport the IdentityAssociationRequest and IdentityAssociationResponse messages (which are derived from the X1RequestMessage and X1ResponseMessage definitions in ETSI TS 103 221-1 [7]) as described in Annex E.\nNOTE:\tThe terms identifier and identity are used interchangeably in clause 5.8.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.8.2\tIdentity association requests",
                            "text_content": "For requests with RequestType \"IdentityAssociation\" (see table 5.7.2-3), the IQF issues an IdentityAssociationRequest message populated with a RequestDetails structure as follows:\nTable 5.8-1: RequestDetails structure for LI_XQR\n\nSuccessful LI_XQR responses are returned using the IdentityAssociationResponse message. Error conditions are reported using the normal error reporting mechanisms described in TS 103 221-1 [7].\nLI_XQR query responses are represented in XML following the IdentityAssociationResponse schema (see Annex E). The fields of the IdentityAssociationResponse record shall be populated as described in Table 5.7.2-5.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.8-1: RequestDetails structure for LI_XQR",
                                    "table number": 19,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.8.3\tOngoing identity association requests",
                            "text_content": "For requests with RequestType \"OngoingIdentityAssociation\", the IQF shall activate a request for ongoing updates at the ICF by sending it an ActivateOngoingIdentityAssociationUpdates message populated as follows:\nTable 5.8-2: ActivateAssociationUpdates message for LI_XQR\n\nThe ICF shall acknowledge the receipt of the ActivateAssociationUpdates message by responding with an ActivateAssociationUpdatesAcknowledgement response (see Annex E) containing an IdentityAssociationRecord representing the association active at the time the ICF receives the ActivateAssociationUpdates message. If no such active association exists, the ActivateAssociationUpdatesAcknowledgement response shall not contain an IdentityAssociationRecord. Error conditions are reported using the normal error reporting mechanisms described in ETSI TS 103 221-1 [7].\nWhen a request with RequestType \"OngoingIdentityAssociation\" is terminated over LI_HIQR (see table 5.7.2-3), the IQF shall issue a DeactivateAssociationUpdates message (see Annex E) with the appropriate OngoingAssociationTaskID populated. On termination of the request, the ICF shall respond with a DeactivateAssociationUpdatesAcknowledgement message.\nWhile a request with RequestType \"OngoingIdentityAssociation\" is active, the ICF shall generate an IdentityAssociationUpdate message every time the ICF receives an IEFAssociationRecord or IEFDeassociationRecord over LI_IEF for the relevant identifier. The message shall contain an IdentityAssociationRecord as described in table 5.7.2-5, and the relevant OngoingAssociationTaskID. The IdentityAssociationUpdate message is sent to the IQF over LI_XQR with the ICF becoming the \"requester\" as defined in ETSI TS 103 221-1 [7] clause 4.2. The IQF shall respond with an IdentityAssociationUpdateAcknowledgement message.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.8-2: ActivateAssociationUpdates message for LI_XQR",
                                    "table number": 20,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "5.9\tProtocols for LI_XER",
                    "description": "",
                    "summary": "",
                    "text_content": "LI_XER records are realised using a TLS connection as defined in clause 6.2.2A.2.3, with records BER-encoded as defined in Annex F.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.10\tProtocols for LI_ST interface",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.10.1\tOverview",
                            "text_content": "LI_ST shall be realised using a dedicated separate instance of the Nudsf_DataRepository service as defined in TS 29.598 [64] subject to the following terms.\nThe LISSF shall adopt the role of the NF Service Provider as described in TS 29.598 [64] clause 5.2.1. The LISSF may be realised as a standalone function or within the ADMF. In either case it shall meet the requirements set out in TS 33.127 [5] clause 6.2.3.8.\nAn LI function may only store state over LI_ST using an LISSF identified by the LIPF via LI_X0. The LIPF shall provide the necessary details for connection, including the relevant apiRoot, apiVersion, realmId and storageId values (see TS 29.598 [64] clause 6.1.3.1) and any necessary keys for authentication.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.2\tStorage",
                            "text_content": "When an LI function wishes to store LI state in the LISSF, it shall perform the Record Create service operation as described in TS 29.598 [64] clause 5.2.2.3.1. Unless otherwise specified, the recordId shall be a randomly-assigned UUID. The record metadata shall include at least the following information as tag value pairs (see TS 29.598 [64] clause 6.1.6.2.3)\nTable 5.10.2-1: Minimum information elements for RecordMeta structure\n\nFurther details on the contents of the Record Blocks is given in the relevant clauses.\nThe LIPF shall always be able to store records in the LISSF.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.10.2-1: Minimum information elements for RecordMeta structure",
                                    "table number": 21,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "5.10.3\tRetrieval",
                            "text_content": "When an LI function wishes to retrieve records from the LISSF and knows the RecordID of the relevant state information, it shall perform a Record Retrieval operation as described in TS 29.598 [64] clause 5.2.2.2.2. If the LI function does not know the RecordID, it shall perform a search as described in TS 29.598 [64] clause 5.2.2.2.6 using appropriate search criteria. The details for choosing search criteria are specific to each LI function and are therefore given in later clauses specific to that LI function.\nThe LIPF shall always be able to retrieve records from the LISSF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.10.4\tRemoval",
                            "text_content": "When an LI function wishes to remove records from the LISSF, it shall perform a Record Delete service operation as described in TS 29.598 [64] clause 5.2.2.5.\nThe LIPF shall always be able to remove records from the LISSF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.11\tProtocols for LI_HILA",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.11.1\tGeneral",
                            "text_content": "Functions having a LI_HILA interface shall support the use of ETSI TS 103 120 [6] to realise the interface.\nIn the event of a conflict between ETSI TS 103 120 [6] and the present document, the terms of the present document shall apply.\nPrior to issuing of location acquisition requests, the LEA shall provide an authorization for these requests This is done by issuing a warrant over the LI_HI1 interface prior to issuing the LI_HILA requests as described in clause 5.4.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.11.2\tUsage for realising LI_HILA",
                            "text_content": "LI_HILA requests are represented by issuing a CREATE request for an LDTaskObject (see ETSI TS 103 120 [6] clause 8.3), populated as follows:\nTable 5.11.2.1-1: LDTaskObject representation of LI_HILA request\n\nThe use of any other LDTaskObject parameter is outside the scope of the present document.\nTable 5.11.2.1-2: RequestDetails structure\n\nTable 5.11.2.1-3: RequestType Dictionary for LI_HILA\n\nThe RequestValues field shall contain at least one of the following:\n-\tIMSI, given in the IMSI format as defined in ETSI TS 103 120 [6] clause C.2.\n-\tMSISDN, given in the E.164 format as defined in ETSI TS 103 120 [6] clause C.2.\n-\tSUPI, given in either SUPIIMSI or SUPINAI formats as defined in ETSI TS 103 120 [6] clause C.2.\n-\tGPSI, given in either GPSIMSISDN or GPSINAI formats as defined in ETSI TS 103 120 [6] clause C.2.\nThe LDTaskObject for a location acquisition request may also contain the \"ReqCurrentLoc\" LDTask flag (see table 5.11.2.2-1). If this flag is present, the LAF shall set the ReqCurrentLoc parameter in the LI_XLA request sent to the LARF to true. If this flag is absent, the LAF shall either set the ReqCurrentLoc parameter in the LI_XLA request sent to the LARF to false or not include this parameter.\nTable 5.11.2.2-1: LDTaskFlags for LI_HILA Requests\n\nIf delivery via the LI_HI2 is required, the LARF will send the acquisition response as either an AMFLocationUpdate (in case of the 5GC) or an MMELocationUpdate (in case of the EPC) xIRI record to the MDF2 via LI_X2_LA. Full details are given in clause 7.3.5.6.\nIf delivery via the LI_HILA is required, the LARF returns the acquisition response as part of the LI_XLA response, which the LAF then transforms into a LI_HILA response given as a LocationResponseDetails structure (see table 5.11.2.3-1). Full details are given in clause 7.3.5. LocationResponseDetails contains LocationOutcome records.\nThe fields of the LocationResponseDetails structure shall be set as follows:\nTable 5.11.2.3-1: LocationResponseDetails\n\nTable 5.11.2.3-2: LocationOutcome\n\nTable 5.11.2.3-3: EPCLocationOutcome\n\nResponses are delivered within a DELIVER Request (see ETSI TS 103 120 [6] clause 6.4.10) containing a DeliveryObject (see ETSI TS 103 120 [6] clause 10).\nThe DeliveryObject Reference field (see ETSI TS 103 120 [6] clause 10.2.1) shall be set to the Reference of the LDTaskObject used in the request to provide a correlation between request and response. The DeliveryID, SequenceNumber, and LastSequence fields shall be set according to ETSI TS 103 120 [6] clause 10.2.1.\nThe content manifest (see ETSI TS 103 120 [6] clause 10.2.2) shall be set to indicate the present document and the type of response using the following Specification Dictionary extension.\nTable 5.11.2.3-4: Specification Dictionary\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.11.2.1-1: LDTaskObject representation of LI_HILA request",
                                    "table number": 22,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.11.2.1-2: RequestDetails structure",
                                    "table number": 23,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.11.2.1-3: RequestType Dictionary for LI_HILA",
                                    "table number": 24,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.11.2.2-1: LDTaskFlags for LI_HILA Requests",
                                    "table number": 25,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.11.2.3-1: LocationResponseDetails",
                                    "table number": 26,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.11.2.3-2: LocationOutcome",
                                    "table number": 27,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.11.2.3-3: EPCLocationOutcome",
                                    "table number": 28,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.11.2.3-4: Specification Dictionary",
                                    "table number": 29,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "5.12\tProtocols for LI_XLA",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.12.1\tGeneral",
                            "text_content": "Functions having a LI_XLA interface shall support the use of ETSI TS 103 221-1 [7] to realise the interface.\nIn the event of a conflict between ETSI TS 103 221-1 [7] and the present document, the terms of the present document shall apply.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.12.2\tUsage for realising LI_XLA",
                            "text_content": "LI_XLA requests are realised using ETSI TS 103 221-1 [7] to transport the LocationAcquisitionRequest and LocationAcquisitionResponse messages (which are derived from X1RequestMessage and X1ResponseMessage respectively, as defined in ETSI TS 103 221-1 [7]), see Annex I. The LocationAcquisitionRequest message is populated as follows:\nTable 5.12.2.1-1: LocationAcquisitionRequest representation for an XLA request\n\nTable 5.12.2.1-2: HI2Delivery structure\n\nSuccessful LI_XLA responses are returned using the LocationAcquisitionResponse message. Error conditions are reported using the normal error reporting mechanisms described in ETSI TS 103 221-1 [7].\nLI_XLA query responses are represented in XML following the LocationAcquisitionResponse schema (see Annex I). If delivery via the LI_HILA was specified, the fields of the LocationAcquisitionResponse record shall be populated as described in clause 5.11.2.3. If delivery via the LI_HI2 was specified in the original request, the LARF shall leave the LocationAcquisitionResponse record field unpopulated.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 5.12.2.1-1: LocationAcquisitionRequest representation for an XLA request",
                                    "table number": 30,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 5.12.2.1-2: HI2Delivery structure",
                                    "table number": 31,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tNetwork Layer Based Interception",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes any remaining fields, behaviours or details necessary to implement the required LI interfaces for specific 3GPP-defined network deployments which are not described in clauses 4 and 5.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.2\t5G",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tGeneral",
                            "text_content": "This clause describes the LI interfaces specific to LI for 5G networks.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tLI at AMF",
                            "text_content": "The IRI-POI present in the AMF is provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nThe POI in the AMF shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):\n-\tSUPIIMSI.\n- \tSUPINAI.\n-\tPEIIMEI.\n-\tPEIIMEISV.\n-\tGPSIMSISDN.\n-\tGPSINAI.\nTable 6.2.2.1-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POI in the AMF.\nTable 6.2.2.1-1: ActivateTask message for the IRI-POI in the AMF\n\nTable 6.2.2.1-2: IdentifierAssociationExtensions Parameters\n\nThe IRI-POI present in the AMF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 6.2.2.4, the details of which are described in the following clauses.\nIf the AMF receives one or more cell IDs in an N2 message (as specified in TS 38.413 [23]), the IRI-POI in the AMF shall report all of them.\nThe IRI-POI in the AMF shall only generate xIRI containing AMFIdentifierAssociation records when the IdentifierAssocationExtensions parameter has been received over LI_X1 (see clause 6.2.2.1). The IRI-POI in the AMF shall generate records according to the value of the EventsGenerated sub-parameter (see table 6.2.2.1-2) as follows:\n-\tIdentifierAssociation: AMFIdentifierAssociation and AMFLocationUpdate records shall be generated. No other record types shall be generated for that target.\n-\tAll: All AMF record types shall be generated.\nTable 6.2.2.2.1A-1: Simple types for AMF\n\nThe IRI-POI in the AMF shall generate an xIRI containing an AMFRegistration record when the IRI-POI present in the AMF detects that a UE matching one of the target identifiers provided via LI_X1 has successfully registered to the 5GS via 3GPP NG-RAN or non-3GPP access. Accordingly, the IRI-POI in the AMF generates the xIRI when the following event is detected:\n-\tAMF sends a N1: REGISTRATION ACCEPT message to the target UE and the UE 5G Mobility Management (5GMM) state for the access type (3GPP NG-RAN or non-3GPP access) within the AMF is changed to 5GMM-REGISTERED.\nTable 6.2.2.2.2-1: Payload for AMFRegistration record\n\nTable 6.2.2.2.2-2: Payload for UEAreaIndication\n\nThe IRI-POI in the AMF shall generate an xIRI containing an AMFDeregistration record when the IRI-POI present in the AMF detects that a UE matching one of the target identifiers provided via LI_X1 has deregistered from the 5GS over at least one access type. Accordingly, the IRI-POI in AMF generates the xIRI when any of the following events is detected:\n-\tFor network initiated de-registration, when the AMF receives the N1: DEREGISTRATION ACCEPT message from the target UE or when implicit deregistration timer expires; and in both cases the UE 5GMN state for the access type (3GPP NG-RAN or non-3GPP access) within the AMF is changed to 5GMM-DEREGISTERED.\n-\tFor UE initiated de-registration, when the AMF sends the N1: DEREGISTRATION ACCEPT message to the target UE or when the AMF receives the N1: DEREGISTRATION REQUEST message from the target UE with deregistration type value of “switch off”; and in both cases the UE 5GMN state for the access type (3GPP NG-RAN or non-3GPP access) within the AMF is changed to 5GMM-DEREGISTERED.\n-\tFor network initiated AMF UE relocation, the AMFDeregistration xIRI shall not be sent unless the 5GMM COMMON PROCEDURE INITIATED (see TS 24.501 [13] clause 5.1.3.2.3.3) results in deregistration.\nTable 6.2.2.2.3-1: Payload for AMFDeregistration record\n\nThe IRI-POI in the AMF shall generate an xIRI containing an AMFLocationUpdate record each time the IRI-POI present in an AMF detects that the target’s UE location is updated due to target UE mobility or as a part of an AMF service procedure and the reporting of location information is not restricted by service scoping. The generation of such separate xIRI is not required if the updated UE location information is obtained as a part of a procedure producing some other xIRIs (e.g. mobility registration). In that case the location information is included into the respective xIRI.\nThe UE mobility events resulting in generation of an AMFLocationUpdate xIRI include the N2 Path Switch Request (Xn based inter NG-RAN handover procedure described in TS 23.502 [4] clause 4.9.1.2) and the N2 Handover Notify (Inter NG-RAN node N2 based handover procedure described in TS 23.502 [4] clause 4.9.1.3).\nThe AMFLocationUpdate xIRI is also generated when the AMF receives an NG-RAN NGAP PDU Session Resource Modify Indication message as a result of Dual Connectivity activation/release for the target UE, as described in TS 37.340 [37] clause 10.\nOptionally, based on operator policy, other NG-RAN NGAP messages that do not generate separate xIRI but carry location information (e.g. RRC INACTIVE TRANSITION REPORT) may trigger the generation of an xIRI AMFLocationUpdate record.\nAdditionally, based on regulatory requirements and operator policy, the location information obtained by AMF from NG-RAN or LMF in the course of some service operation (e.g. emergency services, LCS) may generate xIRI AMFLocationUpdate record. The AMF services providing the location information in these cases include the AMF Location Service (ProvideLocInfo, ProvidePosInfo, NotifiedPosInfo and EventNotify service operations) and the AMF Exposure Service (AmfEventReport with LOCATION_REPORT) (see TS 29.518 [22]). Additionally, the AMF Communication Service (Namf_Communication_N1MessageNotify service operation) may be monitored to capture the location information in the scenarios described in TS 23.273 [42] clause 6.3.1. Also, in the case of Mobile Originated LCS service invoked by the target, the location information may be derived from a Nlmf_Location_DetermineLocation Response to AMF (see TS 23.273 [42] clause 6.2).\nThe AMFLocationUpdate record is also used by LARF to deliver Location Acquisition responses to MDF2, as described in clause 7.3.5.6. The IRI-POI in the AMF shall not generate the AMFLocationUpdate xIRI when the location is acquired as the result of a LARF request, as described in TS 33.127 [5], clause 7.3.5.2.\nTable 6.2.2.2.4-1: Payload for AMFLocationUpdate record\n\nThe IRI-POI in the AMF shall generate an xIRI containing an AMFStartOfInterceptionWithRegisteredUE record when the IRI-POI present in the AMF detects that interception is activated on a UE that has already been registered in the 5GS (see clause 6.2.2.4 on identity privacy). A UE is considered already registered to the 5GS when the 5GMM state for the access type (3GPP NG-RAN or non-3GPP access) for that UE is 5GMM-REGISTERED. Therefore, the IRI-POI present in the AMF shall generate the xIRI AMFStartOfInterceptionWithRegisteredUE record when it detects that a new interception for a UE is activated (i.e. provisioned by the LIPF) and the 5G mobility management state for the access type (3GPP NG-RAN or non-3GPP access) within the AMF for that UE is 5GMM-REGISTERED. If the UE is registered over both 3GPP NG-RAN and non-3GPP access, the IRI-POI present in the AMF shall generate an xIRI containing an AMFStartOfInterceptionWithRegisteredUE record for each access type.\nTable 6.2.2.2.5-1: Payload for AMFStartOfInterceptionWithRegisteredUE record\n\nThe IRI-POI present in the AMF generating an xIRI containing an AMFStartOfInterceptionWithRegisteredUE record shall set the Payload Direction field in the PDU header to not applicable (Direction Value 5, see ETSI TS 103 221-2 [8] clause 5.2.6).\nThe IRI-POI in the AMF shall generate an xIRI containing an AMFUnsuccessfulProcedure record when the IRI-POI present in the AMF detects an unsuccessful procedure for a UE matching one of the target identifiers provided via LI_X1.\nAccordingly, the IRI-POI in the AMF generates the xIRI when any of the following events is detected:\n-\tAMF sends a N1: REGISTRATION REJECT message to the target UE and the UE 5G Mobility Management (5GMM) state for the access type (3GPP NG-RAN or non-3GPP access) within the AMF is changed to 5GMM-DEREGISTERED.\n-\tAMF aborts a registration procedure before the UE 5G Mobility Management (5GMM) state for the access type (3GPP NG-RAN or non-3GPP access) within the AMF is changed to 5GMM-REGISTERED.\n-\tAMF sends a SERVICE REJECT message to the target UE including a PDU session establishment reject message type.\n-\tAMF aborts a UE-initiated NAS transport procedure with payload container type IE set to \"SMS\".\nUnsuccessful registration shall be reported only if the target UE has been successfully authenticated.\nTable 6.2.2.2.6-1: Payload for AMFUnsuccessfulProcedure record\n\nThe IRI-POI present in the AMF shall generate an xIRI containing an AMFIdentifierAssociation record when the IRI-POI present in the AMF detects a new identifier association for a UE matching one of the target identifiers provided via LI_X1. Generation of this record is subject to this record type being enabled for a specific target (see clause 6.2.2.2.1).\nTable 6.2.2.2.7-1: Payload for AMFIdentifierAssociation record\n\nThe IRI-POI present in the AMF generating an xIRI containing an AMFIdentifierAssociation record shall set the Payload Direction field in the PDU header to not applicable (Direction Value 5, see ETSI TS 103 221-2 [8] clause 5.2.6).\nThe IRI-POI present in the AMF shall generate an xIRI containing an AMFPositioningInfoTransfer when the IRI-POI present in the AMF detects one of the following events :\n-\tan NRPPa (see TS 38.455 [86]) message related to a target UE has been exchanged between the LMF and NG-RAN via the AMF.\n-\ta LPP (see TS 37.355 [85]) message related to a target UE has been exchanged between the LMF and the target UE via the AMF.\nAccordingly, the IRI-POI in AMF generates the xIRI when any of the following events is detected:\n-\tAMF receives an Namf_Communication_N1N2MessageTransfer (see TS 29.518 [22]) from LMF to request the transfer of a NRPPa request to the serving NG-RAN node for a target UE as part of a UE associated NRPPa positioning activity. The NRPPa request may be E-CID MEASUREMENT INITIATION REQUEST or OTDOA INFORMATION REQUEST.\n-\tAMF sends a Namf_Communication_N2InfoNotify [22] to the LMF to forward the NRPPa response or report received from the NG-RAN for a target UE. The NRPPa response or report may be E-CID MEASUREMENT INITIATION RESPONSE, E-CID MEASUREMENT REPORT or OTDOA INFORMATION RESPONSE.\n-\tAMF receives an Namf_Communication_N1N2MessageTransfer ([22]) from LMF to request the transfer of a LPP message to a target UE as part of a LPP positioning activity.\n-\tAMF sends an Namf_Communication_N1MessageNotify ([22]) to LMF to forward a LPP message received from the target UE.\nTable 6.2.2.2.8-1: Payload for AMFPositioningInfoTransfer record\n\n6.2.2.2.9.1\tGeneral\nThe present clause provides the LI requirements for NG interface-based handovers which occur for a target UE. Such handovers may be intra 5GS (inter-gNB), 5GS to EPS (inter-system), EPS to 5GS (inter-system), or 5GS to UTRA (inter-system).\nThe following xIRI records are used to report handover related events between the AMF and RAN nodes for the target UE when the delivery of location information is not restricted by service scoping:\n-\tAMFRANHandoverCommand.\n-\tAMFRANHandoverRequest.\nThe above xIRIs are used to report handover events and information that are not carried in the AMFLocationUpdate (clause 6.2.2.2.4) record and shall include the information transferred between the AMF and RAN nodes, as a part of handover preparation, resource allocation, and handover notification.\n6.2.2.2.9.2\tHandover command\nThe IRI-POI in the AMF shall generate an xIRI containing an AMFRANHandoverCommand record when the IRI-POI present in the AMF detects that the AMF has sent a HANDOVER COMMAND message to the source RAN node (old RAN node) in response to a HANDOVER REQUIRED message for the target UE and location information is not restricted by service scoping.\nTable 6.2.2.2.9.2-1: Payload for AMFRANHandoverCommand record\n\n6.2.2.2.9.3\tHandover request\nThe IRI-POI in the AMF shall generate an xIRI containing an AMFRANHandoverRequest record when the IRI-POI in the AMF detects that the AMF received a HANDOVER REQUEST ACKNOWLEDGE message from the target RAN node (new RAN node) for the target UE and location information is not restricted by service scoping.\nNOTE:\tThe gaining RAN node sends the HANDOVER REQUEST ACKNOWLEDGE in response to a HANDOVER REQUEST from the AMF.\nTable 6.2.2.2.9.3-1: Payload for AMFRANHandoverRequest record\n\nThe IRI-POI in the AMF shall generate an xIRI containing a AMFUEConfigurationUpdate record when the IRI-POI present in the AMF detects that a UE matching one of the target identifiers provided via LI_X1 has been commanded to update its configuration. Accordingly, the IRI-POI in the AMF generates the xIRI when the following event is detected:\n-\tAMF sends a CONFIGURATION UPDATE COMMAND message to the target UE.\nTable 6.2.2.2.10-1: Payload for AMFUEConfigurationUpdate record\n\nTrace procedures, as defined in TS 32.423 [112], allow for the AMF to request trace sessions, including Minimization of Drive Test (MDT) data gathering for a target using UE-associated signalling.\nThe present clause provides the LI requirements for reporting trace sessions from the IRI-POI in the AMF for a target UE.\nThe following xIRI records are used to report trace related events between the AMF and RAN nodes for the target UE when the delivery of location information is not restricted by service scoping:\n-\tAMFRANTraceReport\nThe IRI-POI in the AMF shall generate an xIRI containing an AMFRANTraceReport record when the IRI-POI present in the AMF has detected any of the following events:\n-\tAMF sent a TRACE START message to the target RAN node (old RAN node) in response to a Trace Session Activation message for the target.\n-\tAMF received a CELL TRAFFIC TRACE message from the NG-RAN for the target.\n-\tAMF sent MDT or trace data to the trace collection entity for the target.\n-\tAMF sent a deactivate trace message to the NG-RAN for the target.\nTable 6.2.2.2.11.2-1: Payload for AMFRANTraceReport record\n\nTable 6.2.2.2.11.2-2: Payload for traceCollectionEntityInfo Parameter\n\nThe IRI-POI present in the AMF shall generate an xIRI containing an AMFUEPolicyTransfer record when the IRI-POI present in the AMF detects one of the following events:\n-\tAMF sends a Namf_Communication_N1MessageNotify Request (See TS 29.518 [22] clause 5.2.2.3) related to the target UE containing the N1 NAS message MANAGE UE POLICY COMPLETE. It confirms that UE policies forwarded by AMF to the target UE in the N1 NAS message MANAGE UE POLICY COMMAND have been accepted by the UE.\nTable 6.2.2.2.12-1: Payload for AMFUEPolicyTransfer record\n\nThe IRI-POI in the AMF shall generate an xIRI containing an or AMFUEServiceAccept record when the IRI-POI in present in the AMF detects that the AMF has sent a service accept in response to a service request or control plane service request from the target. Accordingly, the IRI-POI in the AMF generates the xIRI when any of the following events are detected:\n-\tAMF sends a SERVICE ACCEPT message to the target in response to a SERVICE REQUEST message from the target.\n-\tAMF sends a SERVICE ACCEPT message to the target in response to a CONTROL PLANE SERVICE REQUEST message from the target.\nTable 6.2.2.2.13-1: Payload for AMFUEServiceAccept record\n\nThe purpose of the InitialRANUEContextSetup type is to provide information the AMF sends to the NG-RAN to request the setup of the UE context. Encoded per TS 38.413 [23] clause 9.2.2.1.\nTable 6.2.2.2A.1-1 contains the details for the InitialRANUEContextSetup type.\nTable 6.2.2.2A.1-1: Structure of the InitialRANUEContextSetup type\n\nThe PDUSessionSetupRequestItem identifies a PDU Session for a UE. The PDUSessionSetupRequestItem is derived from the information in the PDU Session Resource Setup Request Item IE defined in TS 38.413 [23] clause 9.2.2.1.\nTable 6.2.2.2A.2-1 contains the details for the PDUSessionSetupRequestItem type.\nTable 6.2.2.2A.2-1: Structure of the PDUSessionSetupRequestItem type\n\nThe UERadioCapability contains the UE radio access capability information. The UERadioCapability type is derived from UE Radio Capability IE defined in TS 38.413 [23] clauses 9.3.1.74, and 9.3.1.74a.\nTable 6.2.2.2A.3-1 contains the details for the UERadioCapability type.\nTable 6.2.2.2A.3-1: Structure of the UERadioCapability type\n\nThe UERadioCapabilityForPaging contains paging specific UE Radio Capability information. The UERadioCapabilityForPaging type is derived from the UE Radio Capability for Paging IE defined in TS 38.413 [23] clause 9.3.1.68.\nTable 6.2.2.2A.4-1 contains the details for the UERadioCapabilityForPaging type.\nTable 6.2.2.2A.4-1: Structure of the UERadioCapabilityForPaging type\n\nThe NRV2XServicesAuthorization provides information on the authorization status of the UE to use the NR sidelink for V2X services. Defined in TS 38.413 [23] clause 9.3.1.146.\nTable 6.2.2.2A.5-1 contains the details for the NRV2XServicesAuthorization type.\nTable 6.2.2.2A.5-1: Structure of the NRV2XServicesAuthorization type\n\nThe LTEV2XServicesAuthorization provides information on the authorization status of the UE to use the LTE sidelink for V2X services. Defined in TS 38.413 [23] clause 9.3.1.147.\nTable 6.2.2.2A.6-1 contains the details for the NRV2XServicesAuthorization type.\nTable 6.2.2.2A.6-1: Structure of the LTEV2XServicesAuthorization type\n\nThe TargetNSSAIInfo contains the Target NSSAI and Index to RAT/Frequency Selection Priority. Derived from Target NSSAI Information IE defined in TS 38.413 [23] clause 9.3.1.229.\nTable 6.2.2.2A.7-1 contains the details for the TargetNSSAIInfo type.\nTable 6.2.2.2A.7-1: Structure of the TargetNSSAIInfo type\n\nThe FiveGProSeAuthorizationIndication provides information on the authorization status of the UE to use the 5G ProSe services. Derived from 5G ProSe Authorized IE defined in TS 38.413 [23] clause 9.3.1.233.\nTable 6.2.2.2A.8-1 contains the details for the FiveGProSeAuthorizationIndication type.\nTable 6.2.2.2A.8-1: Structure of the FiveGProSeAuthorizationIndication type\n\nThe IABAuthorizedIndicator provides information about the authorization status of the IAB node. Defined in TS 38.413 [23] clause 9.3.1.129.\nTable 6.2.2.2A.9-1 contains the details of the IABAuthorizedIndicator type.\nTable 6.2.2.2A.9-1: Enumeration for IABAuthorizedIndicator\n\nThe V2XUEAuthorizationIndicator indicates whether the UE is authorized to use Sidelink for V2X operation. Derived from the IEs defined in TS 38.413 [23] clauses 9.3.1.146 and 9.3.1.147.\nTable 6.2.2.2A.10-1 contains the details of the V2XUEAuthorizationIndicator type.\nTable 6.2.2.2A.10-1: Enumeration for V2XUEAuthorizationIndicator\n\nThe FiveGProSeAuthorizationIndicator indicates authorization status of the UE to use the 5G ProSe services. Derived from the 5G ProSe Authorized IE defined in TS 38.413 [23] clause 9.3.1.233.\nTable 6.2.2.2A.11-1 contains the details of the FiveGProSeAuthorizationIndicator type.\nTable 6.2.2.2A.11-1: Enumeration for FiveGProSeAuthorizationIndicator\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in AMF, the MDF2 shall generate the corresponding IRI message and deliver over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received in the xIRI over LI_X2. This record may be enriched with any additional information available at the MDF (e.g. additional location information).\nThe timestamp field of the PSHeader structure shall be set to the time at which the AMF event was observed (i.e. the timestamp field of the X2 PDU).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 6.2.2-7.\nTable 6.2.2-7: IRI type for IRI messages\n\nThese IRI messages shall omit the CIN (see ETSI TS 102 232-1 [9] clause 5.2.4).\nThe threeGPP33128DefinedIRI field in ETSI TS 102 232-7 [10] clause 15 shall be populated with the BER-encoded IRIPayload.\nWhen an additional warrant is activated on a target UE and the LIPF uses the same XID for the additional warrant, the MDF2 shall be able to generate and deliver the IRI message containing the AMFStartOfInterceptionWithRegisteredUE record to the LEMF associated with the additional warrant without receiving a corresponding xIRI. The payload of the AMFStartOfInterceptionWithRegisteredUE record is specified in table 6.2.2.2.5-1.\nIf the MDF2 did not receive from the IRI-POI the value of timeOfRegistration parameter in a previous corresponding AMFStartOfInterceptionWithRegisteredUE for the same registration, the MDF2 shall include in that parameter the time provided in the timestamp previously received in the header of the related AMFRegistration xIRI.\nThe AMF shall ensure for every registration (including re-registration) that SUPI has been provided by the UDM to the AMF and that the SUCI to SUPI mapping has been verified as defined in TS 33.501 [11]. This shall be performed regardless of whether the SUPI is a target of interception, and whether the null encryption algorithm is used for the SUCI. The AMF shall maintain the SUPI to SUCI mapping for at least the lifetime of the registration in order to allow interception based on SUPI after the initial registration.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.2.2.1-1: ActivateTask message for the IRI-POI in the AMF",
                                    "table number": 32,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.1-2: IdentifierAssociationExtensions Parameters",
                                    "table number": 33,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.1A-1: Simple types for AMF",
                                    "table number": 34,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.2-1: Payload for AMFRegistration record",
                                    "table number": 35,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.2-2: Payload for UEAreaIndication",
                                    "table number": 36,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.3-1: Payload for AMFDeregistration record",
                                    "table number": 37,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.4-1: Payload for AMFLocationUpdate record",
                                    "table number": 38,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.5-1: Payload for AMFStartOfInterceptionWithRegisteredUE record",
                                    "table number": 39,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.6-1: Payload for AMFUnsuccessfulProcedure record",
                                    "table number": 40,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.7-1: Payload for AMFIdentifierAssociation record",
                                    "table number": 41,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.8-1: Payload for AMFPositioningInfoTransfer record",
                                    "table number": 42,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.9.2-1: Payload for AMFRANHandoverCommand record",
                                    "table number": 43,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.9.3-1: Payload for AMFRANHandoverRequest record",
                                    "table number": 44,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.10-1: Payload for AMFUEConfigurationUpdate record",
                                    "table number": 45,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.11.2-1: Payload for AMFRANTraceReport record",
                                    "table number": 46,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.11.2-2: Payload for traceCollectionEntityInfo Parameter",
                                    "table number": 47,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.12-1: Payload for AMFUEPolicyTransfer record",
                                    "table number": 48,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2.13-1: Payload for AMFUEServiceAccept record",
                                    "table number": 49,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2A.1-1: Structure of the InitialRANUEContextSetup type",
                                    "table number": 50,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2A.2-1: Structure of the PDUSessionSetupRequestItem type",
                                    "table number": 51,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2A.3-1: Structure of the UERadioCapability type",
                                    "table number": 52,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2A.4-1: Structure of the UERadioCapabilityForPaging type",
                                    "table number": 53,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2A.5-1: Structure of the NRV2XServicesAuthorization type",
                                    "table number": 54,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2A.6-1: Structure of the LTEV2XServicesAuthorization type",
                                    "table number": 55,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2A.7-1: Structure of the TargetNSSAIInfo type",
                                    "table number": 56,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2A.8-1: Structure of the FiveGProSeAuthorizationIndication type",
                                    "table number": 57,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2A.9-1: Enumeration for IABAuthorizedIndicator",
                                    "table number": 58,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2A.10-1: Enumeration for V2XUEAuthorizationIndicator",
                                    "table number": 59,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2.2A.11-1: Enumeration for FiveGProSeAuthorizationIndicator",
                                    "table number": 60,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2-7: IRI type for IRI messages",
                                    "table number": 61,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.2.2A\tIdentifier Reporting for AMF",
                            "text_content": "The IEF in the AMF is activated and deactivated over LI_XEM1 by the LIPF using the LI_XEM1 protocol described in clause 5.2.7.\nNOTE:\tSince the IEF reports association events for all UEs registered in the IEF’s parent AMF, unlike POIs there is no concept of provisioning an IEF with target identifiers.\nUpon receiving a valid activate task message over LI_XEM1, the IEF shall start generating records as defined in clause 6.2.2A.2.\nUpon receiving a valid deactivate task message over LI_XEM1, the IEF shall stop generating records as defined in clause 6.2.2A.2.\n6.2.2A.2.1\tEvents\nThe IEF in the AMF shall generate an IEFIdentifierAssociation record whenever the IEF present in the AMF detects a change in association between a SUPI and a 5G-GUTI for any UE registered with the AMF. The IEF shall send the IEFIdentifierAssociation records to the ICF over LI_XER as defined in clause 5.9.\nAccordingly, the IEF in the AMF generates IEFIdentifierAssociation records when any of the following events are detected:\n-\tIEFAssociationRecord: Association of a 5G-GUTI to a SUPI, (this may also include SUCI to SUPI association).\n-\tIEFDeassociationRecord: De-association of a 5G-GUTI from a SUPI.\nNOTE1:\tThe de-association of 5G-GUTI from a SUPI event record is only generated if a new 5G-GUTI is not allocated to a SUPI to update a previous association (e.g. at inter-AMF handover).\nNOTE 2:\tAs SUCIs are single use and only valid for a single authentication, they are only valid at the single point in time when the association event is detected and reported to the ICF by the IEF.\nIn addition, when an IEF is activated as per clause 6.2.2A.1, the IEF shall generate associations event for all SUPIs which are registered in the AMF, where those identifier associations allocated prior to IEF activation remain current and are still available in the AMF (See NOTE 2).\nNOTE 3:\tOnly identifier associations which have been maintained by the AMF as part of normal network operations will be available.\nIn the case where the IEF in the AMF detects that a REGISTRATION ACCEPT message or a CONFIGURATION UPDATE (5G-GUTI) message as defined in TS 24.501 [13] has been sent by the AMF towards a UE, the IEF shall immediately generate an IEFIdentifierAssociation record. This record shall be generated regardless of whether the CONFIGURATION UPDATE (5G-GUTI) or REGISTRATION ACCEPT procedure is subsequently successfully completed or not.\nFor each association event, the IEF shall create an IEFAssociationRecord, as defined below.\nTable 6.2.2A-1: Payload for IEFAssociationRecord\n\nFor each de-association event, the IEF shall create an IEFDeassociationRecord, as defined below.\nTable 6.2.2A-2: Payload for IEFDeassociationRecord\n\nWhen activated (see clause 5.2.7), the IEF shall establish a TLS connection to the ICF as given over LI_XEM1. If the IEF fails to establish a TLS connection, it shall report an error over LI_XEM1 using the error reporting mechanisms described in ETSI TS 103 221-1 [7] and attempt to reconnect after a configurable period of time.\nWhen a record has been generated as described in clause 6.2.2A.2.2, the IEF shall encode the IEFAssociationRecord or IEFDeassociationRecord as a BER-encoded IEFMessage structure, following the ASN.1 schema given in Annex F, and transmit it to the ICF over the established TLS connection.\nThe IEF may transmit a keepalive request using the keepalive record defined in Annex F. Upon receiving a keepalive request, the ICF shall respond with a keepaliveResponse record containing the same sequence number used in the request. The circumstances under which the IEF transmits keepalive requests is out of scope of the present document.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.2.2A-1: Payload for IEFAssociationRecord",
                                    "table number": 62,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.2A-2: Payload for IEFDeassociationRecord",
                                    "table number": 63,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.2.3\tLI for SMF/UPF",
                            "text_content": "If the warrant is for IRI and CC, then the IRI-POI and the CC-TF in the SMF shall be provisioned in accordance with clause 6.2.3.1.2, the MDF2 shall be provisioned in accordance with clause 6.2.3.1.3, and the MDF3 shall be provisioned in accordance with clause 6.2.3.1.4.\nIf the warrant is for IRI only, the IRI-POI in the SMF shall be provisioned in accordance with clause 6.2.3.1.2 and the MDF2 shall be provisioned in accordance with clause 6.2.3.1.3.\nIf approach 1 described in clause 6.2.3.9 is used for packet header information reporting, the IRI-TF in the SMF shall be provisioned in accordance with clause 6.2.3.1.2 and the MDF2 shall be provisioned in accordance with clause 6.2.3.1.3. If approach 2 described in clause 6.2.3.9 is used for packet header information reporting, the CC-TF in the SMF shall be provisioned in accordance with clause 6.2.3.1.2, the MDF2 shall be provisioned in accordance with clause 6.2.3.1.3, and the MDF3 shall be provisioned in accordance with clause 6.2.3.1.4.\nIf the SMF is part of a combined SMF+PGW-C, the requirements in clause 6.3.3 shall apply.\nThe IRI-POI, IRI-TF and CC-TF present in the SMF are provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nThe POI/TF in the SMF shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):\n-\tSUPIIMSI.\n-\tSUPINAI.\n-\tPEIIMEI.\n-\tPEIIMEISV.\n-\tGPSIMSISDN.\n-\tGPSINAI.\nTable 6.2.3-0A shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POI, in the SMF.\nTable 6.2.3-0A: ActivateTask message for SMF IRI-POI, CC-TF and IRI-TF\n\nTo enable packet header information reporting, parameters specified in table 6.2.3.9.2-1: PDHRReportingExtensions parameters shall be provided as the TaskDetailsExtensions/HeaderReporting field of the LI_X1 provisioning message.\nThe MDF2 listed as the delivery endpoint for xIRI generated by the IRI-POI in the SMF or the IRI-POI in the UPF shall be provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2. Table 6.2.3-0B shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF2.\nThe MDF2 shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):\n-\tSUPIIMSI.\n-\tSUPINAI.\n-\tPEIIMEI.\n-\tPEIIMEISV.\n-\tGPSIMSISDN.\n-\tGPSINAI.\nTable 6.2.3-0B: ActivateTask message for MDF2\n\nTable 6.2.3-0C: Mediation Details for MDF2\n\nThe MDF3 listed as the delivery endpoint for the xCC generated by the CC-POI in the UPF shall be provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2. Table 6.2.3-0D shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF3. If packet header information reporting is authorised and approach 2 described in clause 6.2.3.9.1 is used, the endpoint for the MDF3 shall be the MDF2 over LI_MDF.\nThe MDF3 shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):\n-\tSUPIIMSI.\n-\tSUPINAI.\n-\tPEIIMEI.\n-\tPEIIMEISV.\n-\tGPSIMSISDN.\n-\tGPSINAI.\nTable 6.2.3-0D: ActivateTask message for MDF3\n\nTable 6.2.3-0E: Mediation Details for MDF3\n\nThe IRI-POI present in the SMF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 6.2.3.3, the details of which are described in the following clauses. In the case where the SMF is part of a combined SMF+PGW-C, the details of the events are specified in clause 6.3.3.2. The IRI-POI present in the SMF shall also send a SeparatedLocationReporting xIRI (as described in clause 7.3.4.1) when the IRI-POI provisioned in the H-SMF detects that the V-SMF has sent location data via the HsmfUpdateData service operation to the H-SMF that does not otherwise trigger an existing SMF record type.\nAs specified in TS 23.501 [2] clause 5.6.1, a PDU session may support either a single-access PDU Connectivity Service (referred to as a single-access PDU Session) or a multi-access PDU Connectivity Service (referred to as a\tMulti-Access PDU (MA PDU) session).\nThe details of the messages for single-access PDU sessions are provided below in clauses 6.2.3.2.2, 6.2.3.2.3, 6.2.3.2.4, 6.2.3.2.5 and 6.2.3.2.6.\nThe details of the messages for multi-access PDU sessions are provided below in clauses 6.2.3.2.7 and 6.2.3.2.8.\nThe IRI-POI in the SMF shall generate an xIRI containing an SMFPDUSessionEstablishment record when the IRI-POI present in the SMF detects that a single-access PDU session has been established for the target UE. The IRI-POI present in the SMF shall generate the xIRI for the following events:\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN), sends the N1 NAS message (via AMF) PDU SESSION ESTABLISHMENT ACCEPT to the UE and the 5G Session Management (5GSM) state within the SMF is changed to PDU SESSION ACTIVE (see TS 24.501 [13], clauses 6.1.3.3 and 6.4.1).\n-\tFor a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) sends the N16: Nsmf_PDU_Session_Create Response message with n1SmInfoToUe IE containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16], clauses 5.2.1, 5.2.2.7, 5.2.3, 6.1.2.4, and 6.1.6.4).\nIf the Npcf_SMPolicyControl_Create response received from the PCF for the target UE in response to Npcf_SMPolicyControl_Create request includes PCC rules in which the traffic control policy data contains either a routeToLocs IE or trafficSteeringPolIdDl IE and/or trafficSteeringPolIdUl IE, then the SMF shall include those PCC rules in the xIRI. These PCC rules correspond to policies that influence the target UE’s traffic flows (see TS 29.513 [88] clause 5.5.3).\nTable 6.2.3-1: Payload for SMFPDUSessionEstablishment record\n\nTable 6.2.3-1A: Payload for ePS5GSComboInfo\n\nTable 6.2.3-1B: gTPTunnelInfo field\n\nTable 6.2.3-1C: fiveGSGTPTunnels field\n\nTable 6.2.3-1D: dLRANTunnelInformation field\n\nEach PCC rule for traffic influence has the payload defined in Table 6.2.3-1E.\nTable 6.2.3-1E: Payload of PCCRule for traffic influence\n\nThe IRI-POI in the SMF shall generate an xIRI containing an SMFPDUSessionModification record when the IRI-POI present in the SMF detects that a single-access PDU session has been modified for the target UE. The IRI-POI present in the SMF shall generate the xIRI for the following events:\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN), receives the N1 NAS message (via AMF) PDU SESSION MODIFICATION COMPLETE from the UE and the 5GSM state within the SMF is returned to PDU SESSION ACTIVE (see TS 24.501 [13], clauses 6.1.3.3, 6.3.2 and 6.4.2). This applies to the following two cases:\n-\tUE initiated PDU session modification (see TS 23.502 [4], clause 4.3.3.2).\n-\tNetwork initiated PDU session modification (see TS 23.502 [4], clause 4.3.3.2).\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN), sends the N1 NAS message (via AMF) PDU SESSION ESTABLISHMENT ACCEPT to the UE and the 5GSM state within the SMF remains in the PDU SESSION ACTIVE (see TS 24.501 [13], clause 6.1.3.3 and 6.4.1). This applies to the following case:\n-\tHandover from one access type to another access type happens (e.g. 3GPP to non-3GPP); see TS 23.502 [4], clauses 4.9.2.1 and 4.9.2.2).\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN), sends the Nsmf_PDUSession_UpdateSMContext response to the AMF when the PDU session modified or SM context is changed. In this case, the Nsmf_PDUSession_UpdateSMContext response may not have an embedded NAS message. This applies to the following case:\n-\tHandover scenarios (5G to 5G, see TS 23.502 [4] clauses 4.9.1.2 and 4.9.1.3).\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN) receives the N4: PFCP Session Establishment Response when a PFCP session is established on a new UPF (or V-UPF in a roaming case) within the existing SM Context without a following Nsmf_PDUSession_Update_Context message being sent to the AMF. This applies to the following case:\n-\tHandover scenarios (5G to 5G, see TS 23.502 [4] clauses 4.9.1.2 and 4.9.1.3).\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN) receives the N4: PFCP Session Modification Response when a new tunnel Identifier (local or remote) is added to the PDU session or removed from the PDU session without a following Nsmf_PDUSession_Update_Context message being sent to the AMF. This applies to the following case:\n-\tHandover scenarios (5G to 5G, see TS 23.502 [4] clauses 4.9.1.2 and 4.9.1.3).\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN) receives the N4: PFCP Session Deletion Response when a PFCP session is deleted from an SM Context that remains active. This applies to the following case:\n-\tHandover scenarios (5G to 5G, see TS 23.502 [4] clauses 4.9.1.2 and 4.9.1.3).\n-\tFor a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) receives the N16: Nsmf_PDU_Session_Update Response message with n1SmInfoFromUe IE containing the PDU SESSION MODIFICATION COMPLETE (see TS 29.502 [16], clauses 5.2.1, 5.2.2.8, 5.2.3, and 6.1.6.4). This applies to the following three cases:\n-\tUE initiated PDU session modification (see TS 23.502 [4], clause 4.3.3.3).\n-\tNetwork (VPLMN) initiated PDU session modification (see TS 23.502 [4], clause 4.3.3.3).\n-\tNetwork (HPLMN) initiated PDU session modification (see TS 23.502 [4], clause 4.3.3.3).\n-\tFor a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) sends the N16: Nsmf_PDU_Session_Create Response message with n1SmInfoToUe IE containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16], clauses 5.2.1, 5.2.2.8, 5.2.3, and 6.1.6.4) while it had received a N16 Nsmf_PDU_Session_Create Request message with an existing PDU Session Id with access type being changed. This applies to the following case:\n-\tHandover from one access type to another access type happens (e.g. 3GPP to non-3GPP); see TS 23.502 [4], clauses 4.9.2.3 and 4.9.2.4) where the V-SMF is used for the PDU session on the new access type only.\n-\tFor a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) sends the N16: Nsmf_PDU_Session_Update Response message with n1SmInfoToUe IE containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16]) while it had received a N16 Nsmf_PDU_Session_Update Request message with an existing PDU Session Id with access type being changed. This applies to the following case:\n-\tHandover from one access type to another access type happens (e.g. 3GPP to non-3GPP) where the same V-SMF is used for the PDU session on both access types.\n-\tFor a non-roaming scenario, SMF sends a Nsmf_EventExposure_Notify request to the NEF or AF for the target UE for the event \"UP Path Change\" related to a corresponding subscription from AF (see TS 29.508 [90] clause 4.2.2).\n-\tFor a non-roaming scenario, SMF sends a Nsmf_EventExposure_AppRelocationInfo response to the NEF or AF for the target UE in response to Nsmf_EventExposure_AppRelocationInfo request sent by NEF or AF to SMF (see TS 29.508 [90] clause 4.2.5).\n-\tFor a non-roaming scenario, SMF receives a Nnef_PFDManagement_Fetch response from the NEF for the target UE in response to Nnef_PFDManagement_Fetch request sent by SMF to NEF (see TS 29.551 [96] clause 4.2.2).\nIf the Npcf_SMPolicyControlUpdateNotify response sent to the PCF for the target UE in response to an Npcf_SMPolicyControlUpdateNotify request includes PCC rules in which the traffic control policy data contains either a routeToLocs IE or trafficSteeringPolIdDl IE and/or trafficSteeringPolIdUl IE, then the SMF shall include those PCC rules in the xIRI. These PCC rules correspond to policies that influence the target UE’s traffic flows (see TS 29.513 [88] clause 5.5.3).\nTable 6.2.3-2: Payload for SMFPDUSessionModification record\n\nTable 6.2.3-2A: Payload of UPPathChange\n\nTable 6.2.3-2B: Payload of PFDDataForApp\n\nTable 6.2.3-2C: Payload of PFD\n\nThe IRI-POI in the SMF shall generate an xIRI containing an SMFPDUSessionRelease record when the IRI-POI present in the SMF detects that a single-access PDU session has been released. The IRI-POI present in the SMF shall generate the xIRI for the following events:\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN), receives the N1 NAS message (via AMF) PDU SESSION RELEASE COMPLETE from the UE and the 5GSM state within the SMF is changed to PDU SESSION INACTIVE (see TS 24.501 [13], clauses 6.1.3.3 and 6.4.3). This applies to the following two cases:\n-\tUE initiated PDU session release (see TS 23.502 [4], clause 4.3.4.2).\n-\tNetwork initiated PDU session release (see TS 23.502 [4], clause 4.3.4.2).\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN), receives the N1 NAS message (via AMF) STATUS from the UE with the cause values listed in TS 24.501 [13], clause 6.5.3 and the 5GSM state within the SMF is changed to PDU SESSION INACTIVE. One of the cases where this applies is of UE finding that the PDU session ID received in a PDU SESSION MODIFICATION COMMAND is invalid.\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, the V-SMF in the VPLMN) sends the Nsmf_PDUSession_ReleaseSMContext Response to the AMF (see TS 29.502 [16], clause 5.2.2.4). This applies to the case where the PDU session is released without any N1 or N2 messages (e.g. AMF initiates the PDU session release when it finds that the PDU session is no longer associated with the UE, see TS 23.502 [4], clause 4.2.2.4).\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenarios, V-SMF in the VPLMN) sends Nsmf_PDUSession_SMContextStatusNotify (see TS 29.502 [16], clause 6.1.6.2.8) with RELEASED in the ResourceStatus IE (see TS 29.502 [16], clause 6.1.6.3.1) to the AMF. This applies to the case where PDU session release is neither initiated by a NAS message nor by Nsmf_PDUSessionReleaseSMContext Request message (see TS 29.502 [16], clause 5.2.2.5).\n-\tFor a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) receives the N16: Nsmf_PDU_Session_Update Response message with n1SmInfoFromUe IE containing the PDU SESSION RELEASE COMPLETE (see TS 29.502 [16], clauses 5.2.1, 5.2.2.8, 5.2.3, and 6.1.6.4) from the V-SMF. This applies to the following three cases:\n-\tUE initiated PDU session release (see TS 23.502 [4], clause 4.3.4.3).\n-\tNetwork (VPLMN) initiated PDU session release (see TS 23.502 [4], clause 4.3.4.3).\n-\tNetwork (HPLMN) initiated PDU session release (see TS 23.502 [4], clause 4.3.4.3).\n-\tFor a roaming scenario, H-SMF in the HPLMN sends the Nsmf_PDUSession_Release Response to the V-SMF (see TS 29.502 [16], clause 5.2.2.9). This applies to the case where the PDU session is released without any N1 or N2 messages (e.g. AMF in the VPLMN initiates the PDU session release when it finds that the PDU session is no longer associated with the UE, see TS 23.502 [4], clause 4.3.4.3).\n-\tFor a roaming scenario, H-SMF in the HPLMN sends a Nsmf_PDUSession_StatusNotify (see TS 29.502, clause 6.1.6.2.17) with RELEASED in the ResourceStatus IE (see TS 29.502 [16], clause 6.1.6.3.1) to the V-SMF. This applies to the case where PDU session release is neither initiated by a NAS message nor by Nsmf_PDUSessionRelease Request message (see TS 29.502 [16], clause 5.2.2.9).\nTable 6.2.3-3: Payload for SMFPDUSessionRelease record\n\nThe IRI-POI in the SMF shall generate an xIRI containing an SMFStartOfInterceptionWithEstablishedPDUSession record when the IRI-POI present in the SMF detects that a single-access PDU session has already been established for the target UE when interception starts.\nIn a non-roaming scenario, the IRI-POI in the SMF (or in a roaming scenario, the IRI-POI in the V-SMF in the VPLMN) shall generate the xIRI containing the SMFStartOfInterceptionWithEstablishedPDUSession record when it detects that a new interception for a UE is activated (i.e. provisioned by the LIPF) for the following case:\n-\tThe 5GSM state within the SMF for that UE is 5GSM: PDU SESSION ACTIVE or PDU SESSION MODIFICATION PENDING.\nNOTE:\tThe above trigger happens when the SMF (V-SMF in VPLMN) had not sent an N1 NAS message PDU SESSION RELEASE COMMAND to the UE for a PDU session and the SMF (V-SMF in the VPLMN) had previously sent an N1 NAS message PDU SESSION ESTABLISHMENT ACCEPT to that UE for the same PDU session.\nIn a home-routed roaming scenario, the IRI-POI in the H-SMF shall generate the xIRI containing the SMFStartOfInterceptionWithEstablishedPDUSession record when it detects that a new interception for a UE is activated (i.e. provisioned by the LIPF) for the following case:\n-\tThe H-SMF had not sent a Nsmf_PDU_Session_Update Request (n1SmInfoToUe: PDU SESSION RELEASE COMMAND) to the V-SMF for a PDU session and H-SMF had previously sent a Nsmf_PDU_Session_Create Response (n1SmInfoToUE: PDU SESSION ESTABLISHMENT ACCEPT) to the V-SMF for that PDU session.\nThe IRI-POI in the SMF shall generate the xIRI containing the SMFStartOfInterceptionWithEstablishedPDUSession record for each of the PDU sessions (that meets the above criteria) associated with the newly identified target UEs.\nTable 6.2.3-4: Payload for SMFStartOfInterceptionWithEstablishedPDUSession record\n\nThe IRI-POI present in the SMF generating an xIRI containing a SMFStartOfInterceptionWithEstablishedPDUSession record shall set the Payload Direction field in the PDU header to not applicable (Direction Value 5, see ETSI TS 103 221-2 [8] clause 5.2.6).\nThe IRI-POI in the SMF shall generate an xIRI containing an SMFUnsuccessfulProcedure record when the IRI-POI present in the SMF detects an unsuccessful procedure or error condition for a UE matching one of the target identifiers provided via LI_X1.\nAccordingly, the IRI-POI in the SMF generates the xIRI when one of the following events are detected:\n-\tSMF sends a PDU SESSION ESTABLISHMENT REJECT message to the target UE.\n-\tSMF sends a PDU SESSION MODIFICATION REJECT message to the target UE.\n-\tSMF sends a PDU SESSION RELEASE REJECT message to the target UE.\n-\tSMF receives a PDU SESSION MODIFICATION COMMAND REJECT message from the target UE.\n-\tAn ongoing SM procedure is aborted at the SMF, due to e.g. a 5GSM STATUS message sent from or received by the SMF.\nTable 6.2.3-5: Payload for SMFUnsuccessfulProcedure record\n\n6.2.3.2.7.1\tGeneral\nIn the present document, an MA PDU session will include two general types of PDU sessions as defined below:\n-\tMA-Confirmed: This is an MA PDU session where the UE signals Upgrade Allowed to MA and the network immediately upgrades the session to an MA PDU session or the UE explicitly requests an MA PDU session (using a Request Type of MA PDU).\n-\tMA-Upgrade-Allowed: This is a PDU session where the UE indicated that upgrade to an MA PDU session is allowed, but the network does not immediately confirm the upgrade. The network may at some later point upgrade the session to an MA PDU session.\nNOTE:\tThe above terms are not defined or used in other 3GPP Stage 2 or Stage 3 specifications, but have been introduced here to clarify and distinguish LI event reporting for the respective situations.\nAn MA-Confirmed MA PDU session may be established over a single access or over multiple accesses. The establishment over multiple accesses may occur concurrently or may occur at different points in time.\nAn MA-Upgrade-Allowed MA PDU session is established over a single access and nearly all aspects appears to be an ordinary non-MA PDU session with the key difference that the network may upgrade the session to an MA-confirmed MA PDU session.\n6.2.3.2.7.2\tMA PDU session establishment\nThe IRI-POI in the SMF shall generate an xIRI containing an SMFMAPDUSessionEstablishment record when the IRI-POI present in the SMF detects that a PDU session has been established for the target UE that is an MA PDU session (Request Type set to MA PDU session or upgraded at establishment), or where the upgrade allowed parameter is set to upgrade allowed and session is established as an ordinary PDU session (not upgraded at establishment, but may occur later on). The IRI-POI present in the SMF shall generate the xIRI for the following events:\n-\tFor a non-roaming scenario , the SMF sends the N1 NAS message (via AMF) PDU SESSION ESTABLISHMENT ACCEPT to the UE for a new PDU session and the 5G Session Management (5GSM) state within the SMF is changed to PDU SESSION ACTIVE (see TS 24.501 [13], clause 6.1.3.3 and 6.4.1) in response to a PDU SESSION ESTABLISHMENT REQUEST received along with:\n-\tPDU Session ID which does not identify an existing PDU session, and\n-\tRequest Type = MA PDU request, or\n-\tRequest Type = initial request and MA PDU session information set to \"MA PDU session network upgrade is allowed\", with either upgrade occuring at establishment or upgrade does not occur at establishment but may occur later.\n-\tFor a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) sends the N16: Nsmf_PDU_Session_Create Response message with n1SmInfoToUe IE containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16], clauses 5.2.1, 5.2.2.7, 5.2.3, and 6.1.6) for a new PDU session in response to a PDU SESSION ESTABLISHMENT REQUEST received along with:\n-\tPDU Session ID which does not identify an existing PDU session, and\n-\tRequest Type = MA PDU request, or\n-\tRequest Type = initial request and MA PDU session information set to \"MA PDU session network upgrade is allowed\", with either upgrade occuring at establishment or upgrade does not occur at establishment but may occur later.\nIf the Npcf_SMPolicyControl_Create response received from the PCF for the target UE in response to Npcf_SMPolicyControl_Create request includes PCC rules in which the traffic control policy data contains either a routeToLocs IE or trafficSteeringPolIdDl IE and/or trafficSteeringPolIdUl IE, then the SMF shall include those PCC rules in the xIRI. These PCC rules correspond to policies that influence the target UE’s traffic flows (see TS 29.513 [88] clause 5.5.3).\nTable 6.2.3-5A: Payload for SMFMAPDUSessionEstablishment record\n\nTable 6.2.3-5B: Contents of Access Info parameter\n\n6.2.3.2.7.3\tMA PDU session modification\nThe IRI-POI in the SMF shall generate an xIRI containing an SMFMAPDUSessionModification record when the IRI-POI present in the SMF detects that an MA PDU session has been modified for the target UE. The IRI-POI present in the SMF shall generate the xIRI for the following events:\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN), receives the N1 NAS message (via AMF) PDU SESSION MODIFICATION COMPLETE from the UE and the 5GSM state within the SMF is returned to PDU SESSION ACTIVE (see TS 24.501 [13], clauses 6.1.3.3 and 6.4.2). This applies to the following cases for an MA-Upgrade-Allowed PDU session:\n-\tUE initiated MA PDU session modification (see TS 23.502 [4], clause 4.22.8.2).\n-\tNetwork initiated MA PDU session modification (see TS 23.502 [4], clause 4.22.8.2).\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN), receives the N1 NAS message (via AMF) PDU SESSION RELEASE COMPLETE from the UE in response to a PDU SESSION RELEASE COMMAND message containing an Access type IE identifying a single access to be released of an MA PDU session which was established over both accesses and the 5GSM state within the SMF remains in the PDU SESSION ACTIVE. This applies to the following case:\n-\tA single access type is released from an MA PDU session, but the MA PDU session continues.\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN), sends the N1 NAS message (via AMF) PDU SESSION ESTABLISHMENT ACCEPT to the UE and the 5GSM state within the SMF remains in the PDU SESSION ACTIVE (see TS 24.501 [13], clauses 6.1.3.3 and 6.4.1). This applies to the following cases:\n-\tHandover from one access type to another access type happens (e.g. 3GPP to non-3GPP) for an MA-Upgrade-Allowed MA PDU session (see TS 23.502 [4], clauses 4.9.2.3 and 4.9.2.4).\n-\tMA PDU Session establishment over second access type.\n-\tFor a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) receives the N16: Nsmf_PDU_Session_Update Response message with n1SmInfoFromUe IE containing the PDU SESSION MODIFICATION COMPLETE (see TS 29.502 [16] , clauses 5.2.1, 5.2.2.8, 5.2.3, and 6.1.6). This applies to the following cases for an MA-Upgrade-Allowed PDU session:\n-\tUE initiated MA PDU session modification (see TS 23.502 [4], clause 4.22.8.3).\n-\tNetwork (VPLMN) initiated MA PDU session modification (see TS 23.502 [4], clause 4.22.8.3).\n-\tNetwork (HPLMN) initiated MA PDU session modification (see TS 23.502 [4], clause 4.22.8.3).\n-\tFor a non-roaming scenario, SMF sends a Nsmf_EventExposure_Notify request to the NEF or AF for the target UE for the event \"UP Path Change\" related to a corresponding subscription from AF (see TS 29.508 [90] clause 4.2.2).\n-\tFor a non-roaming scenario, SMF sends a Nsmf_EventExposure_AppRelocationInfo response to the NEF or AF for the target UE in response to Nsmf_EventExposure_AppRelocationInfo request sent by NEF or AF to SMF (see TS 29.508 [90] clause 4.2.5).\n-\tFor a non-roaming scenario, SMF receives a Nnef_PFDManagement_Fetch response from the NEF for the target UE in response to Nnef_PFDManagement_Fetch request sent by SMF to NEF (see TS 29.551 [96] clause 4.2.2).\n-\tFor a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) receives the N16: Nsmf_PDU_Session_Update Response message with n1SmInfoFromUe IE containing the PDU SESSION RELEASE COMPLETE message, a response to a PDU SESSION RELEASE COMMAND message containing an Access type IE identifying a single access to be released of an MA PDU session which was established over both accesses and the 5GSM state within the SMF remains in the PDU SESSION ACTIVE. This applies to the following cases:\n-\tA single access type is released from an MA PDU session, but the MA PDU session continues.\n-\tFor a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) sends the N16: Nsmf_PDU_Session_Create Response message with n1SmInfoToUe IE containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16], clauses 5.2.1, 5.2.2.8, 5.2.3, and 6.1.6) while it had received an N16 Nsmf_PDU_Session_Create request message with an existing PDU Session Id with access type being changed. This applies to the following cases:\n-\tHandover from one access type to another access type happens (e.g. 3GPP to non-3GPP) for an MA-Upgrade-Allowed PDU session (see TS 23.502 [4], clauses 4.9.2.3 and 4.9.2.4). In this case, the V-SMF is used for the PDU session on the new access type only.\n-\tMA PDU Session establishment over second access type.\n-\tFor a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) sends the N16: Nsmf_PDU_Session_Update Response message with n1SmInfoToUe IE containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16]) while it had received a N16 Nsmf_PDU_Session_Update Request message with an existing PDU Session Id with access type being changed. This applies to the following cases:\n-\tHandover from one access type to another access type happens (e.g. 3GPP to non-3GPP) where the same V-SMF is used for the PDU session on both access types.\n-\tMA PDU Session establishment over second access type.\nFor a non-roaming scenario, SMF sends a Npcf_SMPolicyControlUpdateNotify response to the PCF for the target UE in response to an Npcf_SMPolicyControlUpdateNotify request sent by PCF to SMF including PCC rules which traffic control policy data contains either a routeToLocs IE or trafficSteeringPolIdDl IE and/or trafficSteeringPolIdUl IE. These PCC rules correspond to policies that influence the target UE’s traffic flows (see TS 29.513 [88] clause 5.5.3).\nTable 6.2.3-5C: Payload for SMFMAPDUSessionModification record\n\n6.2.3.2.7.4\tMA PDU session release\nThe IRI-POI in the SMF shall generate an xIRI containing an SMFMAPDUSessionRelease record when the IRI-POI present in the SMF detects that an MA PDU session has been released. The IRI-POI present in the SMF shall generate the xIRI for the following events:\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN), receives the N1 NAS message (via AMF) PDU SESSION RELEASE COMPLETE from the UE and the 5GSM state within the SMF is changed to PDU SESSION INACTIVE (see TS 24.501 [13], clauses 6.1.3.3 and 6.4.3) for a PDU session that is either MA-Confirmed or MA-Upgrade-Allowed. This applies to the following two cases:\n-\tUE initiated MA PDU session release (see TS 23.502 [4], clause 4.22.10.2).\n-\tNetwork initiated MA PDU session release (see TS 23.502 [4], clause 4.22.10.2).\n-\tFor a roaming scenario, V-SMF in the VPLMN receives the N1 NAS message (via AMF) PDU SESSION RELEASE COMPLETE from the UE and the 5GSM state within the V-SMF is changed to PDU SESSION INACTIVE (see TS 24.501 [13], clauses 6.1.3.3 and 6.4.3) for a PDU session that is either MA-Confirmed or MA-Upgrade-Allowed. This applies to the following two cases:\n-\tUE initiated PDU session release of a single access for an MA PDU session; (VPLMN considers MA PDU session fully released while HPLMN considers MA PDU session active).\n-\tNetwork initiated PDU session release of a single access for an MA PDU session; (VPLMN considers MA PDU session fully released while HPLMN considers MA PDU session active).\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in the VPLMN), receives the N1 NAS message (via AMF) STATUS from the UE with the cause values listed in TS 24.501 [13], clause 6.5.3 and the 5GSM state within the SMF is changed to PDU SESSION INACTIVE for a PDU session that is either MA-Confirmed or MA-Upgrade-Allowed. One of the cases where this applies is of UE finding that the PDU session ID received in a PDU SESSION MODIFICATION COMMAND is invalid.\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenario, the V-SMF in the VPLMN) sends the Nsmf_PDUSession_ReleaseSMContext Response to the AMF (see TS 29.502 [16], clause 5.2.2.4) for a PDU session that is either MA-Confirmed or MA-Upgrade-Allowed. This applies to the case where the MA PDU session is released without any N1 or N2 messages (e.g. AMF initiates the PDU session release when it finds that the PDU session is no longer associated with the UE, see TS 23.502 [4], clause 4.2.2.4).\n-\tFor a non-roaming scenario, the SMF (or for a roaming scenarios, V-SMF in the VPLMN) sends Nsmf_PDUSession_SMContextStatusNotify (see TS 29.502, clause 6.1.6.2.8) with RELEASED in the ResourceStatus IE (see TS 29.502 [16], clause 6.1.6.3.1) to the AMF for a PDU session that is either MA-Confirmed or MA-Upgrade-Allowed. This applies to the case where MA PDU session release is neither initiated by a NAS message nor by Nsmf_PDUSessionReleaseContext Request message (see TS 29.502 [16], clause 5.2.2.5).\n-\tFor a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) receives the N16: Nsmf_PDU_Session_Update Response message with n1SmInfoFromUe IE containing the PDU SESSION RELEASE COMPLETE (see TS 29.502 [16], clauses 5.2.1, 5.2.2.8, 5.2.3, and 6.1.6) from the V-SMF. This applies to the following three cases for an MA PDU session that is either MA-Confirmed or MA-Upgrade-Allowed:\n-\tUE initiated PDU session release (see TS 23.502 [4], clause 4.22.10.3).\n-\tNetwork (VPLMN) initiated PDU session release (see TS 23.502 [4], clause 4.22.10.3).\n-\tNetwork (HPLMN) initiated PDU session release (see TS 23.502 [4], clause 4.22.10.3).\n-\tFor a roaming scenario, H-SMF in the HPLMN sends the Nsmf_PDUSession_Release Response to the V-SMF (see TS 29.502 [16], clause 5.2.2.9) for a PDU session that is either MA-Confirmed or MA-Upgrade-Allowed. This applies to the case where the MA PDU session is released without any N1 or N2 messages (e.g. AMF in the VPLMN initiates the PDU session release when it finds that the PDU session is no longer associated with the UE, see TS 23.502 [4], clause 4.3.4.3).\n-\tFor a roaming scenario, H-SMF in the HPLMN Nsmf_PDUSession_StatusNotify (see TS 29.502 [16], clause 6.1.6.2.17) with RELEASED in the ResourceStatus IE (see TS 29.502 [16], clause 6.1.6.3.1) to the V-SMF for a PDU session that is either MA-Confirmed or MA-Upgrade-Allowed. This applies to the case where MA PDU session release is neither initiated by a NAS message nor by Nsmf_PDUSessionRelease Request message (see TS 29.502 [16], clause 5.2.2.9).\nTable 6.2.3-5D: Payload for SMFMAPDUSessionRelease record\n\n6.2.3.2.7.5\tStart of interception with an established MA PDU session\nThe IRI-POI in the SMF shall generate an xIRI containing an SMFStartOfInterceptionWithEstablishedMAPDUSession record when the IRI-POI present in the SMF detects that a MA PDU session has already been established for the target UE when interception starts.\nIn a non-roaming scenario, the IRI-POI in the SMF (or in a roaming scenario, the IRI-POI in the V-SMF in the VPLMN) shall generate the xIRI containing the SMFStartOfInterceptionWithEstablishedMAPDUSession record when it detects that a new interception for a UE is activated (i.e. provisioned by the LIPF) for the following case for an MA PDU session that is either MA-Confirmed or MA-Upgrade-Allowed:\n-\tThe 5GSM state within the SMF for that UE is 5GSM: PDU SESSION ACTIVE or PDU SESSION MODIFICATION PENDING.\nNOTE:\tThe above trigger happens when the SMF (V-SMF in VPLMN) had not sent an N1 NAS message PDU SESSION RELEASE COMMAND to the UE to release the entire MA PDU session and the SMF (V-SMF in the VPLMN) had previously sent an N1 NAS message PDU SESSION ESTABLISHMENT ACCEPT to that UE for the same MA PDU session.\nIn a home-routed roaming scenario, the IRI-POI in the H-SMF shall generate the xIRI containing the SMFStartOfInterceptionWithEstablishedMAPDUSession record when it detects that a new interception for a UE is activated (i.e. provisioned by the LIPF) for the following case for an MA PDU session that is either MA-Confirmed or MA-Upgrade-Allowed:\n-\tThe H-SMF had not sent an Nsmf_PDU_Session_Update Request (n1SmInfoToUe: PDU SESSION RELEASE COMMAND to release the entire MA PDU session) to the V-SMF for a PDU session and H-SMF had previously sent an Nsmf_PDU_Session_Create Response (n1SmInfoToUE: PDU SESSION ESTABLISHMENT ACCEPT) to the V-SMF for that PDU session.\nThe IRI-POI in the SMF shall generate the xIRI containing the SMFStartOfInterceptionWithEstablishedMAPDUSession record for each of the MA PDU sessions (that meets the above criteria) associated with the newly identified target UEs.\nThe IRI-POI present in the SMF generating an xIRI containing a SMFStartOfInterceptionWithEstablishedMAPDUSession record shall set the Payload Direction field in the PDU header to not applicable (Direction Value 5, see ETSI TS 103 221-2 [8] clause 5.2.6).\nTable 6.2.3-5E: Payload for SMFStartOfInterceptionWithEstablishedMAPDUSession record\n\n6.2.3.2.7.6\tSMF MA unsuccessful procedure\nThe IRI-POI in the SMF shall generate an xIRI containing an SMFMAUnsuccessfulProcedure record when the IRI-POI present in the SMF detects an unsuccessful procedure or error condition for a UE matching one of the target identifiers provided via LI_X1.\nAccordingly, the IRI-POI in the SMF generates the xIRI when one of the following events are detected:\n-\tSMF sends a PDU SESSION ESTABLISHMENT REJECT message to the target UE for MA-Confirmed and MA-Upgrade-Allowed MA PDU sessions.\n-\tSMF sends a PDU SESSION MODIFICATION REJECT message to the target UE for MA-Confirmed and MA-Upgrade-Allowed MA PDU sessions.\n-\tSMF sends a PDU SESSION RELEASE REJECT message to the target UE for MA-Confirmed and MA-Upgrade-Allowed MA PDU sessions.\n-\tSMF receives a PDU SESSION MODIFICATION COMMAND REJECT message from the target UE for MA-Confirmed and MA-Upgrade-Allowed MA PDU sessions.\n-\tAn ongoing SM procedure is aborted at the SMF, due to e.g. a 5GSM STATUS message sent from or received by the SMF for MA-Confirmed and MA-Upgrade-Allowed MA PDU sessions.\nTable 6.2.3-5F: Payload for SMFMAUnsuccessfulProcedure record\n\nThe IRI-POI in the SMF shall generate an xIRI containing an SMFPDUtoMAPDUSessionModification record when the IRI-POI present in the SMF detects that an existing PDU session for the target UE has been successfully modified to an MA PDU session using the PDU session modification procedures as described in TS 24.501 [13]. A PDU session is considered to be successfully modified to a MA PDU session, when all of the following are true:\n1.\tThe UE is registered to both 3GPP access and non-3GPP access:\n-\tIn the same PLMN (non-roaming UE).\n-\tIn the different PLMNs (roaming UE).\n2.\tSMF receives the PDU SESSION MODIFICATION REQUEST from the UE (TS 24.501 [13] clause 8.2.10) that includes one of the following:\n-\tmodification request and includes MA PDU session information IE set to MA PDU session network upgrade allowed.\n-\tMA PDU request.\n3.\tSMF sends a PDU SESSION MODIFICATION COMMAND to the UE that includes the ATSSS IE (TS 24.501 [13] clause 6.4.2.3).\n4.\tSMF receives the PDU SESSION MODIFICATION COMPLETE from the UE (TS 24.501 [13] clause 8.3.10.1).\n5.\tThe 5GSM state within the SMF is PDU Session Active.\nOnce the SMFPDUtoMAPDUSessionModification record has been generated by the IRI-POI in the SMF, the IRI-POI shall follow clause 6.2.3.2.7 of the present document for further reporting for this MA PDU session.\nTable 6.2.3-5G: Payload for SMFPDUtoMAPDUSessionModification record\n\nWhen interception of communication contents is authorised or the delivery of packet header information is authorised and approach 2 described in clause 6.2.3.5 is used, the CC-TF present in the SMF sends a trigger to the CC-POI present in the UPF over the LI_T3 interface.\nWhen the CC-TF in the SMF detects that a PDU session is being established (i.e. when the SMF sends the N4: PFCP Session Establishment Request to the UPF, see TS 29.244 [15], clause 6.3.2) for a target UE, it shall send an activation message to the CC-POI in the UPF over the LI_T3 interface. The activation message shall contain the correlation identifiers that the CC-POI in the UPF shall use with the xCC. This can be achieved by sending an ActivateTask message as defined in ETSI TS 103 221-1 [7] clause 6.2.1 with the following details.\nTable 6.2.3-6: ActivateTask message for triggering the CC-POI in the UPF\n\nThe CC-TF in the SMF shall not send the ListOfServiceTypes parameter of the ActivateTask message to the CC-POI in the UPF.\nTable 6.2.3-7: Target Identifier Types for LI_T3\n\nWhen the CC-TF in the SMF detects that a targeted PDU session is changing (i.e. when the SMF sends the N4: PFCP Session Modification Request to the UPF, see TS 29.244 [15], clause 6.3.3) in a way that requires changes to the interception already activated by the CC-POI in the UPF, the CC-TF shall modify the interception at the CC-POI in the UPF over the LI_T3 interface. This is achieved by sending a ModifyTask message as defined in ETSI TS 103 221-1 [7] clause 6.2.2. The ModifyTask message contains the same details as the ActivateTask message with the following fields updated as appropriate.\nTable 6.2.3-8: Parameters that may be changed in a ModifyTask message when updating interception at the CC-POI in the UPF\n\nWhen the CC-TF in the SMF detects that a targeted PDU session is changing (i.e. when the SMF sends the N4: PFCP Session Modification Request to the UPF) for which the interception had not been previously activated in the CC-POI in the UPF (e.g. in case of previous unsuccessful LI activation at the CC-POI in the UPF by the CC-TF in the SMF), the CC-TF shall send an activation message to the CC-POI in the UPF over the LI_T3 interface. The activation message shall contain the correlation identifiers that the CC-POI in the UPF shall use with the xCC. This can be achieved by sending an ActivateTask message as defined in ETSI TS 103 221-1 [7] clause 6.2.1 with the details provided by Table 6.2.3-6.\nWhen the CC-TF in the SMF detects that the PDU session has been released (i.e. when the SMF sends the N4: PFCP Session Deletion Request to the UPF, see TS 29.244 [15], clause 6.3.4) for a target UE, it shall send a deactivation message to the CC-POI in the UPF over the LI_T3 interface. When using ETSI TS 103 221-1 [7] this is achieved by sending a DeactivateTask message with the XID field set to the XID associated with the interception, as described in ETSI TS 103 221-1 [7] clause 6.2.3.\nBy default, interception shall occur at the anchor UPF as described in clause 6.2.3.3.3.\nWhen a warrant that includes the service scoping of CC is activated for a target UE with an established PDU session and when the IRI-POI present in the SMF generates the xIRI containing an SMFStartOfInterceptionWithEstablishedPDUSession record (see clause 6.2.3.2.5), the CC-TF present in the SMF shall send an activation message to the CC-POI present in the UPF to generate the xCC.\nWhen a target UE accesses multiple Data Networks (DNs) via a multi-homed PDU session (see TS 23.501 [2] clause 5.6.4.3), multiple UPFs are involved in providing the PDU Session Anchors, with one UPF providing the Branching Point functionality. The Branching Point UPF may, or may not, be a PDU Session Anchor UPF (see TS 33.127 [5] Annex A3.2). The CC-TF present in the SMF shall send the CC intercept trigger to the CC-POI present in an UPF if and only if that UPF is selected to provide the CC-POI functions.\nWhen the target UE is involved in multi-homed PDU session, the CC-TF present in the SMF (i.e. in the SMF that establishes the PDU session) shall determine which UPF(s) is(are) more suitable to provide the CC-POI functions adhering to the following requirements specified in TS 33.127 [5]:\n-\tAll applicable user plane packets are captured and delivered.\n-\tDuplicate delivery of CC is suppressed to the extent possible.\nThis clause assumes that a PDU session contains only one Branching Point UPF (with N3 reference point toward the target UE) and one PDU Session Anchor UPF for each DN connection.\nSince the present document requires the interception of all DN connections, the SMF may choose either all the PDU Session Anchor UPFs or the Branching Point UPF to provide the CC-POI functions.\nThe Branching Point UPF may be chosen when all user plane packets pass through the Branching Point UPF, and the CC-TF present in the SMF may choose the Branching Point UPF to provide the CC-POI function and accordingly, send the CC interception trigger to the CC-POI present in the Branching Point UPF. The CC intercept trigger shall include the packet detection rules. An example of these rules is:\n-\tGenerate the xCC from all the incoming and outgoing user plane packets to the target UE.\nIn this case, the CC-TF present in the SMF shall not select any of the PDU Session Anchor UPFs to provide the CC-POI functions.\nWhen a Branching Point UPF is chosen to provide the CC-POI functions, and if the Branching Point UPF is removed from the user plane path during a PDU session, then the CC POI functions will have to be moved to the PDU Session Anchor UPFs.\nThe xCC delivered to the MDF3 shall be correlated to the PDU session related xIRI. The use of Correlation Id shall be on a user-plane path basis, which means that the xCC generated at different UPFs that belong to different PDU sessions may need to have separate Correlation IDs, each correlating to their own PDU session related xIRI.\nAn option is to intercept a copy of the packets sent and received on the N6 interface [2] side of the PDU Anchor UPF (for each UL classifier in case of selective routing or Service and Session Continuity mode 3) for all DNs the subject is connected to. In the in-bound roaming case for home-routed roaming, the CSP shall deliver a copy of the packets sent and received on the N9 side of the PDU Anchor UPF towards the serving network.\nWhen interception of packet header information is authorised, if approach 1 described in clause 6.2.3.9.1 is used for packet header information reporting, the IRI-TF in the SMF shall send a trigger to the IRI-POI in the UPF over the LI_T2 interface when the IRI-TF in the SMF detects that a PDU session has been established (i.e. when the SMF sends the N4: PFCP Session Establishment Request to the UPF, see TS 29.244 [15], clause 6.3.2) for a target UE. The activation message shall contain the correlation ID that the IRI-POI in the UPF shall use when generating xIRI. This shall be achieved by sending an ActivateTask message as defined in TS 103 221-1 [7] clause 6.2.1 with the following details.\nTable 6.2.3-9: ActivateTask message for triggering the UPF IRI-POI\n\nThe IRI-TF in the SMF shall not send the ListOfServiceTypes parameter of the ActivateTask message to the IRI-POI in the SMF.\nTable 6.2.3-10: Void\nWhen the IRI-TF in the SMF detects that a targeted PDU session has changed (i.e. when the SMF sends the N4: PFCP Session Modification Request to the UPF, see TS 29.244 [15], clause 6.3.3) in a way which requires changes to the interception by the IRI-POI in the UPF, the IRI-TF in the SMF shall modify the interception at the IRI-POI in the UPF over the LI_T2 interface. This is achieved by sending a ModifyTask message as defined in ETSI TS 103 221-1 [7] clause 6.2.2. The ModifyTask message contains the same details as the ActivateTask message with the following fields updated as appropriate.\nTable 6.2.3-11: Parameters that may be changed in a ModifyTask message when updating interception at the IRI-POI in the UPF\n\nWhen the IRI-TF in the SMF detects that the PDU session has been released (i.e. when the SMF sends the N4: PFCP Session Deletion Request to the UPF, see TS 29.244 [15], clause 6.3.4) for a target UE, it shall send a deactivation message to the IRI-POI in the UPF over the LI_T2 interface. When using ETSI TS 103 221-1 [7] this is achieved by sending a DeactivateTask message with the XID field set to the XID associated with the interception, as described in ETSI TS 103 221-1 [7] clause 6.2.3.\nWhen a PDU session involves multiple UPFs, the selection of UPF to provide the IRI-POI functions shall be done in the same way an UPF is selected to provide the CC-POI functions as described in clauses 6.2.3.3.2 and 6.2.3.3.3.\nWhen interception of packet header information is authorised for a target UE, if approach 1 described in clause 6.2.3.9.1 is used for packet header information reporting, the IRI-TF present in the SMF shall send an activation message to the IRI-POI present in the UPF when the IRI-POI present in the SMF generates the xIRI containing an SMFStartOfInterceptionWithEstablishedPDUSession record to generate the packet header information reporting related xIRIs from the user plane packets of that PDU session.\nWhen packet header information reporting is authorised, packet header information reports are generated either by the IRI-POI in the UPF (if approach 1 from clause 7.12.2.3 of TS 33.127 [5] is used) or by the MDF2 (if approach 2 from clause 7.12.2.3 of TS 33.127 [5] is used). Depending on the requirements of the warrant, the packet header information reports can be in per-packet form, as Packet Data Header Reports (PDHRs), or in summary form, as Packet Data Header Summary Reports (PDSRs).\nIf the IRI-POI in the UPF is placed on a link which fragmented the original IP packet (see IETF RFC 791[34] for basic fragmentation rules, and IETF RFC 815 [26] for more complex re-assembly rules), a situation may occur in which only the first fragment can be sensibly reported in a PDHR, while the subsequent fragments may be missing essential fields that are mandatory, which may cause simplistic implementations to mis-report them, or omit them altogether.\nIn this case, the IRI-POI in the UPF shall report the first fragment of a fragmented IP packet, including the port numbers when they are included within this first fragment, using the length of the fragment to determine if the port numbers are indeed encoded within this first fragment. The subsequent fragments are reported without port information. This technique relieves the IRI-POI in the UPF from having to reassemble the original IP packet (at line speed) at the cost of accuracy of the reported fields.\nIf the per-packet form of packet header information reporting, i.e. PDHR, is authorised, the PDHeaderReport xIRI shall be generated as described in clause 6.2.3.9.3.\nIf the summary form of the packet header information reporting, i.e. PDSR, is authorised, the PDSummaryReport xIRI shall be generated as described in clause 6.2.3.9.4.\nThe CC-POI present in the UPF shall send xCC over LI_X3 for each IP packet matching the criteria specified in the Triggering message (i.e. ActivateTask message) received over LI_T3 from the CC-TF in the SMF.\nNOTE:\tImplementers are reminded of the completeness and non-duplication requirements (see TS 33.127 [5]).\nEach X3 PDU shall contain the contents of the user plane packet given using the GTP-U, IP or Ethernet payload format.\nThe CC-POI present in the UPF shall set the payload format to indicate the appropriate payload type (5 for IPv4 Packet, 6 for IPv6 Packet, 7 for Ethernet frame or 12 for GTP-U Packet as described in ETSI TS 103 221-2 [8] clauses 5.4 and 5.4.13.\nIf handover of the entire GTP-U packet is required over LI_HI3 (see clause 6.2.3.8), then consideration shall be made of the correct choice of LI_X3 payload type to ensure that the MDF3 has the necessary CC information. Support for delivery of LI_X3 as payload type 12 (GTP-U packet) is mandatory.\nThe CC-POI present in the UPF may use the Additional XID Related Information attributes to facilitate efficient delivery of xCC, as specified in ETSI TS 103 221-2 [8] clause 5.3.22.\nWhen an xIRI is received over LI_X2 from the IRI-POI in the SMF or the IRI-POI in the UPF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the SMF event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 6.2.3-14.\nTable 6.2.3-14: IRI type for IRI messages\n\nIRI messages associated with the same PDU Session shall be assigned the same CIN (see ETSI TS 102 232-1 [9] clause 5.2.4).\nThe threeGPP33128DefinedIRI field (see ETSI TS 102 232-7 [10] clause 15) shall be populated with the BER-encoded IRIPayload.\nWhen an additional warrant is activated on a target UE and the LIPF uses the same XID for the additional warrant, the MDF2 shall be able to generate and deliver the IRI message containing the SMFStartOfInterceptionWithEstablishedPDUSession record and the SMFStartOfInterceptionWithEstablishedMAPDUSession record to the LEMF associated with the additional warrant without receiving a corresponding xIRI. The payload of the SMFStartOfInterceptionWithEstablishedPDUSession record is specified in table 6.2.3-4, while the payload of the SMFStartOfInterceptionWithEstablishedMAPDUSession record is specified in table 6.2.3-9. The MDF2 shall generate and deliver the IRI message containing the SMFStartOfInterceptionWithEstablishedPDUSession record for each of the established PDU sessions to the LEMF associated with the new warrant. The MDF2 shall generate and deliver the IRI message containing the SMFStartOfInterceptionWithEstablishedMAPDUSession record for each of the established MA PDU sessions to the LEMF associated with the new warrant.\nIf the MDF2 did not receive from the IRI-POI the value of timeOfSessionEstablishment parameter in a previous corresponding SMFStartOfInterceptionWithEstablishedPDUSession or SMFStartOfInterceptionWithEstablishedMAPDUSession xIRI for the same session, the MDF2, when generating the SMFStartOfInterceptionWithEstablishedPDUSession or the SMFStartOfInterceptionWithEstablishedMAPDUSession IRI shall include in that parameter the time provided in the timestamp previously received in the header of the related SMFPDUSessionEstablishment or SMFMAPDUSessionEstablishment xIRI.\nWhen the delivery of packet header information is authorised and approach 2 described in clause 6.2.3.9.1 is used, the MDF2 shall generate the IRI message and send it over LI_HI2 without undue delay when xCC is received over LI_MDF from the MDF3. The MDF2 shall generate packet header information reporting as described in clause 6.2.3.5.\nWhen the xCC is received over LI_X3, the MDF3 shall emit the CC over LI_HI3 without undue delay.\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time that the UPF observed the data (i.e. the timestamp field of the xCC). The LIID and CID fields shall correctly reflect the target identity and communication session to which the CC belongs.\nThe MDF3 shall populate the threeGPP33128DefinedCC field (see clause 5.5.3 of the present document) with a BER-encoded CCPayload structure containing either:\n1. \tThe uPFCCPDU field containing the GTP-U packet received over LI_X3. It shall only be used if the content of the GTP-U packet is an IPv4 or IPv6 packet.\n2. \tThe extendedUPFCCPDU field as described in table 6.2.3-15.\nThe MDF3 shall support delivery using either option.\nTable 6.2.3-15: ExtendedUPFCCPDU structure\n\nTable 6.2.3-16: UPFCCPDUPayload structure\nAs described in TS 33.127 [5] clause 7.12.2, warrants that do not require the interception of communication contents but do require packet header information reporting will require access to the user plane packets. Packet header information reporting includes the following two IRI messages:\n-\tPacket Data Header Reporting (PDHR) in the form of PDHeaderReport records.\n-\tPacket Data Summary Reporting (PDSR) in the form of PDSummaryReport records.\nTS 33.127 [5] clause 7.12.2 provides two approaches for the generation of such IRI messages.\nIn approach 1, the IRI-POI present in the UP Entityconstructs and delivers the packet header information reporting related xIRIs to the MDF2 as described in clause 6.2.3.4.\nIn approach 2, the CC-POI present in the UP Entity intercepts, constructs and delivers the xCC to the MDF3 as described in clause 6.2.3.6. The MDF3 forwards the xCC to the MDF2 over the LI_MDF interface and the MDF2 generates the IRI messages containing the packet header information reporting related records from the xCC.\nIn both approaches, the payload of the PDHeaderReport and PDSummaryReport records are as described in clauses 6.2.3.9.3, 6.2.3.9.4, tables 6.2.3.9.3-1 and 6.2.3.9.4-1. Note that in approach 2, the MDF2 generates these IRI messages containing PDHeaderReport and PDSummaryReport records without receiving the equivalent xIRI from an IRI-POI. The actions of the MDF2, the MDF3, the CC-TF in the CP Entity in 5GS and CUPS EPS, and the CC-POI in non-CUPS EPS are managed as part of the intercept data provisioned to them over the LI_X1 interface.\nTable 6.2.3.9.2-1 shows the details of the HeaderReporting TaskDetailsExtension used in the LI_X1 ActivateTask message used for provisioning LI functions when packet header information reporting is authorised.\nTable 6.2.3.9.2-1: PDHRReportingExtensions parameters\n\nTable 6.2.3.9.2-2: PDSRParameters\n\nIf the per-packet form of packet header information reporting, i.e. PDHR, is used, the LI function responsible for generating the xIRI extracts the information shown in table 6.2.3.9.3-1 from each packet.\nTable 6.2.3.9.3-1: PDHeaderReport record\n\nIf the summary form of the packet header reporting, i.e. PDSR, is used, the LI function responsible for generating the xIRI extracts the information shown in table 6.2.3.9.4-1 from each packet and aggregates it in summaries according to the pDSRType field defined in the PDHRReportingExtensions parameters of the ActivateTask message used to provision the LI function. In addition, the current summary is sent when the LI function responsible for generating the xIRI receives a DeactivateTask message for the Task that generated the PDSR regardless of whether the trigger in the pDSRType field of the ActivateTask message was met. In this case, the pDSRSummaryTrigger field of the PDSR record shall be set to endOfFlow.\nA PDSR shall be generated each time a flow (Source IP, Source Port, Destination IP, Destination Port, Next Level Protocol, Direction) starts or ends.\nIf the useSessionTriggers flag (see table 6.2.3.9.2-2) is absent or set to false and the provisioned pDSRTriggerType is:\n-\tPacket count, a PDSR shall be generated whenever the number of packets detected as a part of the flow reaches the provisioned trigger value.\n-\tByte count, a PDSR shall be generated whenever the value for the cumulative byte size across all packets belonging to the flow reaches the provisioned trigger value.\n-\tTimer expiry, a separate timer should be used for each flow. A PDSR shall be generated for a flow whenever the timer for that flow expires.\nIf the useSessionTriggers flag (see table 6.2.3.9.2-2) is set to true and the provisioned pDSRTriggerType is:\n-\tPacket count, a PDSR shall be generated for each open flow whenever the number of packets sent and received in the PDU Session/PDN Connection is reaches the provisioned trigger value.\n-\tByte count, a PDSR shall be generated for each open flow whenever the value for the cumulative byte size across all packets belonging to the PDU Session/PDN Connection is reaches the provisioned trigger value.\n-\tTimer expiry, a single timer should be used for each PDU Session/PDN Connection. A PDSR shall be generated for each open flow whenever the timer expires.\nTable 6.2.3.9.4-1: PDSummaryReport record\n\nTFs in SMFs in SMF sets need to share LI state information to avoid losing track of the XIDs and CorrelationIDs used in the tasks activated in the POI in the UPF when the triggered task control is transferred from one TF to another.\nPOIs in SMFs in SMF sets need to share LI state information to avoid losing track of the CorrelationIDs and sequence numbers used in the generation of xIRI and xCC when the interception is moved to another POI in the same SMF set.\nThe LIPF may request, store or remove any LI state records at any moment. The LIPF may revoke the credentials of any LI function to use the LI_ST function via LI_X0.\nThe TF in the SMF shall store the LI state (related to a task active in the UPF POI) in the LISSF whenever the parent SMF stores session state for the relevant PDU session in the UDSF and whenever the parent SMF sends session state for the relevant PDU session to another SMF.\nThe POI in the SMF shall store the LI state (related to a task active in the SMF POI) in the LISSF whenever the parent SMF stores session state for the relevant PDU session in the UDSF and whenever the parent SMF sends session state for the relevant PDU session to another SMF.\nWhen storing state, the LI function in the SMF shall use the state storage procedure specified in clause 5.10.2. During this procedure, the LI function shall add the metadata shown in table 6.2.3.10.2-1 to the RecordMeta for the record.\nTable 6.2.3.10.2-1: Additional metadata for the RecordMeta\n\nThe TF shall store the following information as the first record block (see TS 29.598 [64] clause 6.1.3.3.3.2), encoded as XML following the XSD schema given in Annex H.\nTable 6.2.3.10.2-2: TFLIState structure for storing TF state information in the LISSF\n\nTable 6.2.3.10.2-3: TriggeredTask\n\n\nThe TF shall specify the XID in order to avoid removing the LI state related to the same ProductID but a different task in the UPF POI, for example if there is more than one PDU session.\nThe SMF POI shall store the information shown in table 6.2.3.10.2-4 as the first record block (see TS 29.598 [64] clause 6.1.3.3.3.2), encoded as XML following the XSD schema given in Annex H.\nTable 6.2.3.10.2-4: POILIState structure for storing POI state information in the LISSF\n\nWhen the TF in an SMF in an SMF set is provisioned by the LIPF with a specific XID and access to an LISSF function, the TF shall use the LISSF to retrieve LI state information.\nIf the implementation of the SMF set does not ensure that active SM contexts are always present in some SMF of the SMF set, when a task previously provisioned by the LIPF in the TF is deactivated, the TF shall request the records associated to the XID (received from the LIPF) from the LISSF, by performing a search as described in clause 5.10.3, using the XID as a search criteria. If no records are found, the TF may assume that no previous interception has occurred and proceed accordingly.\nWhen a TF detects that its parent SMF is retrieving state for a targetted PDU session from the UDSF, the TF shall request records associated with that PDU session from the LISSF by performing a search as described in clause 5.10.3 and using the UDSFRecordID used by the SMF as a search criteria. When a TF detects that its parent SMF is receiving state for a targetted PDU session from another SMF, the TF shall request records associated with that PDU session from the LISSF by performing a search as described in clause 5.10.3 and using the XID of the task related to the target of that PDU session. If no records are found, the TF may assume that no previous interception has occurred and proceed accordingly. Implementers should be aware that multiple records may be returned.\nWhen an SMF POI detects that its parent SMF is retrieving state for a targetted PDU session from the UDSF, the POI shall request records associated with that PDU session from the LISSF by performing a search as described in clause 5.10.3 and using the UDSFRecordID used by the SMF as a search criteria. When an SMF POI detects that its parent SMF is receiving state for a targetted PDU session from another SMF, the SMF POI shall request records associated with that target PDU session from the LISSF by performing a search as described in clause 5.10.3 and using the XID of the task related to the target of that PDU session. If no records are found, the SMF POI may assume that no previous interception has occurred and proceed accordingly.\nWhen a task is deactivated successfully in the UPF POI, the TF shall remove the LI state record from the LISSF as described in clause 5.10.4.\nWhen a task is deactivated in the SMF POI, the POI shall remove the LI state record from the LISSF as described in clause 5.10.4.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.2.3-0A: ActivateTask message for SMF IRI-POI, CC-TF and IRI-TF",
                                    "table number": 64,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-0B: ActivateTask message for MDF2",
                                    "table number": 65,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-0C: Mediation Details for MDF2",
                                    "table number": 66,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-0D: ActivateTask message for MDF3",
                                    "table number": 67,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-0E: Mediation Details for MDF3",
                                    "table number": 68,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-1: Payload for SMFPDUSessionEstablishment record",
                                    "table number": 69,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-1A: Payload for ePS5GSComboInfo",
                                    "table number": 70,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-1B: gTPTunnelInfo field",
                                    "table number": 71,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-1C: fiveGSGTPTunnels field",
                                    "table number": 72,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-1D: dLRANTunnelInformation field",
                                    "table number": 73,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-1E: Payload of PCCRule for traffic influence",
                                    "table number": 74,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-2: Payload for SMFPDUSessionModification record",
                                    "table number": 75,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-2A: Payload of UPPathChange",
                                    "table number": 76,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-2B: Payload of PFDDataForApp",
                                    "table number": 77,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-2C: Payload of PFD",
                                    "table number": 78,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-3: Payload for SMFPDUSessionRelease record",
                                    "table number": 79,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-4: Payload for SMFStartOfInterceptionWithEstablishedPDUSession record",
                                    "table number": 80,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-5: Payload for SMFUnsuccessfulProcedure record",
                                    "table number": 81,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-5A: Payload for SMFMAPDUSessionEstablishment record",
                                    "table number": 82,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-5B: Contents of Access Info parameter",
                                    "table number": 83,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-5C: Payload for SMFMAPDUSessionModification record",
                                    "table number": 84,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-5D: Payload for SMFMAPDUSessionRelease record",
                                    "table number": 85,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-5E: Payload for SMFStartOfInterceptionWithEstablishedMAPDUSession record",
                                    "table number": 86,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-5F: Payload for SMFMAUnsuccessfulProcedure record",
                                    "table number": 87,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-5G: Payload for SMFPDUtoMAPDUSessionModification record",
                                    "table number": 88,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-6: ActivateTask message for triggering the CC-POI in the UPF",
                                    "table number": 89,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-7: Target Identifier Types for LI_T3",
                                    "table number": 90,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-8: Parameters that may be changed in a ModifyTask message when updating interception at the CC-POI in the UPF",
                                    "table number": 91,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-9: ActivateTask message for triggering the UPF IRI-POI",
                                    "table number": 92,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-11: Parameters that may be changed in a ModifyTask message when updating interception at the IRI-POI in the UPF",
                                    "table number": 93,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-14: IRI type for IRI messages",
                                    "table number": 94,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-15: ExtendedUPFCCPDU structure",
                                    "table number": 95,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3-16: UPFCCPDUPayload structure",
                                    "table number": 96,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3.9.2-1: PDHRReportingExtensions parameters",
                                    "table number": 97,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3.9.2-2: PDSRParameters",
                                    "table number": 98,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3.9.3-1: PDHeaderReport record",
                                    "table number": 99,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3.9.4-1: PDSummaryReport record",
                                    "table number": 100,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3.10.2-1: Additional metadata for the RecordMeta",
                                    "table number": 101,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3.10.2-2: TFLIState structure for storing TF state information in the LISSF",
                                    "table number": 102,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3.10.2-3: TriggeredTask",
                                    "table number": 103,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.3.10.2-4: POILIState structure for storing POI state information in the LISSF",
                                    "table number": 104,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.2.4\tLI at UDM for 5G",
                            "text_content": "In 5G packet core network, the UDM provides the unified data management for UE. The UDM shall have LI capabilities to generate the target UE’s service area registration related xIRI. See clause 7.2.2 for the details.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.5\tLI at SMSF",
                            "text_content": "The IRI-POI present in the SMSF is provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nThe IRI-POI in the SMSF shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages:\n-\tSUPIIMSI.\n-\tSUPINAI.\n-\tPEIIMEI.\n-\tPEIIMEISV.\n-\tGPSIMSISDN.\n-\tGPSINAI.\nIf service scoping is to be performed at the IRI-POI in the SMSF, the IRI-POI in the SMSF shall support the following CSP service types (see clauses 4.4.2 and 5.2.4):\n-\tMessaging.\nIf the IRI-POI in the SMSF receives an ActivateTask message and the ListOfServiceTypes parameter contains a ServiceType that is not supported, the IRI-POI in the SMSF shall reject the task with an appropriate error as described in ETSI TS 103 221-1 [7] clause 6.2.1.2.\nTable 6.2.5-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POI in the SMSF.\nTable 6.2.5-1: ActivateTask message for the IRI-POI in the SMSF\n\nTable 6.2.5-2: TruncateTPUserData Parameters\n\nIf the TruncateTPUserData field of the LI_X1 ActivateTask message is included, the IRI-POI in the SMSF shall use the truncatedSMSTPDU field in xIRI generated at the IRI-POI in the SMSF for SMS-SUBMIT and SMS-DELIVER TPDUs, otherwise, the sMSTPDU field shall be used.\nThe MDF2 listed as the delivery endpoint for the LI_X2 generated by the IRI-POI in the SMSF shall be provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2. If SMS Content delivery is not authorized, the MDF2 shall be provisioned with the TruncateTPUserData included, otherwise it shall be be left absent.\nTable 6.2.5-3 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF2.\nTable 6.2.5-3: ActivateTask message for MDF2\n\nTable 6.2.5-4: Mediation Details for MDF2\nThe IRI-POI present in the SMSF shall send xIRI over LI_X2 for the event listed in TS 33.127 [5] clause 6.2.5.3, the details of which are described in the following clause.\nThe IRI-POI in the SMSF shall generate an xIRI containing an SMSMessage record for the following cases:\nSMS-MO case:\n-\tWhen a target UE originates an SMS message or when any UE originates an SMS message destined to a target non-local ID.\nSMS-MT case:\n-\tWhen an SMS message delivery to a target UE is attempted or when an SMS message delivery originated from a target non-local ID is attempted to any UE.\n-\tWhen an SMS message is successfully delivered to a target UE or when an SMS message originated from a target non-local ID is successfully delivered to any UE.\nThe SMS-MT case can also apply to the scenario when a receipt of SMS delivery from the far end is delivered successfully to the target UE or when a receipt of SMS delivery from a target non-Local ID is successfully delivered to the originating UE.\nThe IRI-POI present in the SMSF shall generate the xIRI containing the SMSMessage record when it detects following events:\n-\tThe SMSF receives an SMCP message CP-DATA_RP-DATA [SMS-SUBMIT, SMS-COMMAND] (via AMF in Nsmsf_SMService_UplinkSMS message) from a target UE.\n-\tThe SMSF receives an SMCP message CP-DATA_RP-DATA [SMS-SUBMIT] (via AMF in Nsmsf_SMService_UplinkSMS message) from any UE with TP-DA field within the SMS-SUBMIT containing a target non-Local ID and SMSF returns the SMCP: CP-ACK to that originating UE.\n-\tThe SMSF receives an SMCP message CP-DATA_RP-DATA [SMS-COMMAND] (via AMF in Nsmsf_SMService_UplinkSMS message) from any UE with TP-DA field within the SMS-COMMAND containing a target non-Local ID and SMSF returns the SMCP: CP-ACK to that originating UE.\n-\tThe SMSF receives a TCAP message MAP MT-FORWARD-SHORT-MESSAGE Request [SMS-DELIVER, SMS-STATUS-REPORT] destined to a target UE.\n-\tThe SMSF receives a TCAP message MAP MT-FORWARD-SHORT-MESSAGE Request [SMS-DELIVER] destined to any UE with the TP-OA field within the SMS-DELIVER containing a target non-Local ID.\n-\tThe SMSF receives a TCAP message MAP MT-FORWARD-SHORT-MESSAGE Request [SMS-STATUS-REPORT] destined to any UE with the TP-RA field within the SMS-STATUS-REPORT containing a target non-Local ID.\nThe IRI-POI present in the SMSF shall generate the xIRI containing the SMSReport record when it detects following events:\n-\tThe SMSF sends a SMCP message CP-DATA_RP-ACK [SMS-SUBMIT-REPORT] (via AMF in Namf_ Communication_N1N2MessageTransfer message) in response to a previously intercepted CP-DATA_RP-DATA.\n-\tThe SMSF sends a SMCP message CP-DATA_RP-ERROR [SMS-SUBMIT-REPORT] (via AMF in Namf_ Communication_N1N2MessageTransfer message) in response to a previously intercepted CP-DATA_RP-DATA.\n-\tThe SMSF sends a TCAP message MAP MT-FORWARD-SHORT-MESSAGE Response [SMS-DELIVER-REPORT] in response to a previously intercepted MAP MT-FORWARD-SHORT-MESSAGE Request.\nNOTE 1:\tIn the above-mentioned descriptions, the requirements of target Non-Local ID do not apply when both originating and terminating users of an SMS message are served by the same CSP. The method used to identify a target non-Local ID is different from the method used to identify a local target ID.\nIf the IRI-POI is provisioned with the TruncateTPUserData parameter included and the IRI-POI is generating xIRI for the SMS-SUBMIT type (TS 23.040 [18] clause 9.2.2.2) or SMS-DELIVER type (TS 23.040 [18] clause 9.2.2.1) TPDUs, the IRI-POI shall use the truncatedSMSTPDU (as described in table 6.2.5-7), otherwise, the IRI-POI shall use the sMSTPDU.\nTable 6.2.5-5: Payload for SMSMessage record\n\nThe sMSTPDU field shall always be used for the sMSTPDUData field of the SMSReport record.\nTable 6.2.5-6: Payload for SMSReport record\n\nTable 6.2.5-7: Choices for SMSTPDUData field\n\nTable 6.2.5-8: SMSMessageType values\nThe IRI-POI in the SMSF shall populate the messageType field with the values listed in table 6.2.5-8 based on the SMS TPDU message type (see TS 23.040 [18] clause 9.2.2) and the RP Message Type (see TS 24.011 [46] clause 8.2.2) that triggered the generation of the xIRI. The SMS TPDU Message Type is indicated by the value of the TP-Message Type Indicator (TP-MTI) (see TS 23.040 [18] clause 9.2.3.1) as described in TS 23.040 [18] clause 9.2.3.1. The RP Message Type is indicated by the value of the RP MTI (See TS 24.011 [46] clause 8.2.2).\nNOTE 2:\tFor the SMS-MO case, the originating party is the address of the UE from which the SMSF receives the CP-DATA_RP-DATA [SMS-SUBMIT, SMS-COMMAND] message (via AMF in the Nsmsf_SMService_UplinkSMS). The GPSI is one of the data fields used in the Nsmsf related messages (see TS 29.540 [21]). Alternatively, the SMSF may find the originating party address in the same way it finds the address when generating charging records. For SMS-MT case, this is derived from TP-OA field (TS 23.040 [18]) for SMS-DELIVER TPDUs or the TP-RA field (TS 23.040 [18]) for SMS-STATUS-REPORT TPDUs. In cases where the originatingSMSParty is not a GPSI, PEI, or SUPI, the sMSAddress parameter is populated with the octets received in the field used to derive the address (as per TS 23.040 [18] clause 9.1.2.5).\nNOTE 3:\tFor SMS-MT case, the terminating party is the address of the UE to which the SMSF sends the CP-DATA_RP-DATA [SMS-DELIVER, SMS-STATUS-REPORT] message (via AMF in Namf_Communications_N1N2MessageTransfer). The GPSI is one of the data fields used in the Namf related messages (TS 29.518 [22]). Alternatively, the SMSF may find the terminating party address in the same way it finds the address when generating charging records. For SMS-MO case, this is derived from the TP-DA field (TS 23.040 [18]). In cases where the terminatingSMSParty is not a GPSI, PEI, or SUPI, the sMSAddress parameter is populated with the octets received in the field used to derive the address (as per TS 23.040 [18] clause 9.1.2.5).\nNOTE 4:\tFor the SMS-MO case, for SMS originated from the target UE, the value fromTarget is used and for SMS destined to target Non-local ID, the toTarget is used. For SMS-MT case, for SMS terminated to the target UE, the value toTarget is used and for SMS originated from a target Non-local ID, the fromTarget is used.\nNOTE 5:\tThis field is set to transferSucceeded or transferFailed as follows:\n-\tSMS-MO case:\n-\tTo transferSucceeded: when the IRI-POI in the SMSF detects that SMSF sends the MO-FORWARD-SHORT-MESSAGE-Request [SMS-SUBMIT] message to the SMS-IWMSC.\n-\tTo transferFailed: when the IRI-POI in SMSF detects the scenarios where SMSF cannot send the MO-FORWARD-SHORT-MESSAGE-Request [SMS-SUBMIT] to the SMS-IWMSC, but still generates an xIRI containing the SMSMessage record.\n-\tSMS-MT case:\n-\tTo transferSucceeded: when the IRI-POI in the SMSF detects that SMSF sends the MT-FORWARD-SHORT-MESSAGE-Response [SMS-DELIVER-REPORT] message to the SMS-GMSC.\n-\tTo transferFailed: when the IRI-POI in SMSF detects the scenarios where SMSF cannot send the MT-FORWARD-SHORT-MESSAGE-Response [SMS-DELIVER-REPORT] to the SMS-GMSC, but an xIRI containing the SMSMessage record is still generated.\nNOTE 6:\tThis is only applicable to the SMS-MT case and can be derived from the TP-MMS (More Message to Send) field present in the SMS-DELIVER sent to the UE (via AMF in the Namf_Communications_N1N2MessageTransfer).\nNOTE 7:\tThis is derived from the ueLocation field of SmsRecord IE received from the AMF in the Nsmsf_SMService_UplinkSMS message (TS 29.540 [21]). For the SMSMessage record, the SMCP message is CP-DATA_RP-DATA [SMS-SUBMIT, SMS-COMMAND] and for the SMSReport record, the SMCP message is CP-DATA-RP-ACK [SMS-DELIVER-REPORT]. Shall be encoded using the Location.locationInfo.userLocation parameter. If available, other parameters reportable via Location shall be included.\nWhen an xIRI containing the SMSMessage record is received over LI_X2 from the IRI-POI in SMSF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the SMSMessage record received over LI_X2. The SMSMessage record may be enriched by other information available at the MDF (e.g. additional location information).\nIf the MDF2 is provisioned with the TruncateTPUserData parameter included, the truncatedSMSTPDU field shall be used in SMSMessage IRI message, otherwise, the sMSTPDU field shall be used.\nThe threeGPP33128DefinedIRI field (see ETSI TS 102 232-7 [10] clause 15) shall be populated with the BER-encoded IRIPayload.\nThe timestamp field of the PSHeader structure shall be set to the time that the SMSF event was observed (i.e. the timestamp field of the xIRI).\nEach SMSMessage record shall be delivered as an IRI REPORT (see ETSI TS 102 232-1 [9] clause 5.2.10) with a new CIN assigned (see ETSI TS 102 232-1 [9] clause 5.2.4).\nEach SMSReport record shall be delivered as a separate IRI REPORT (see ETSI TS 102 232-1 [9] clause 5.2.10) with the same CIN as the IRI REPORT of the associated SMSMessage record.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.2.5-1: ActivateTask message for the IRI-POI in the SMSF",
                                    "table number": 105,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.5-2: TruncateTPUserData Parameters",
                                    "table number": 106,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.5-3: ActivateTask message for MDF2",
                                    "table number": 107,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.5-4: Mediation Details for MDF2",
                                    "table number": 108,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.5-5: Payload for SMSMessage record",
                                    "table number": 109,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.5-6: Payload for SMSReport record",
                                    "table number": 110,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.5-7: Choices for SMSTPDUData field",
                                    "table number": 111,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.2.5-8: SMSMessageType values",
                                    "table number": 112,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.2.6\tLI support at NRF",
                            "text_content": "The SIRF present within the NRF provides SBA-related information to the LIPF over the LI_SI interface. Details for this interface are not considered in the present document and are for further study.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\t4G",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tGeneral",
                            "text_content": "The present document allows three options for EPC LI stage 3 interfaces for 4G / LTE:\n-\tOption A: Use LI_X1, LI_X2 and LI_X3 interfaces specified below in clauses 6.3.2 and 6.3.3 for the events listed in TS 33.127 [5] clauses 6.3.2.3 and 6.3.3.3, and the events related to SMS over NAS as specified in TS 33.107 [36] clause 18.2.4.\n-\tOption B: Use LI_X1, LI_X2 and LI_X3 interfaces as specified in clause 6.3.2 and 6.3.3 for the events listed in TS 33.107 [36] clause 12.2.1.2 and for the events related to the MMEIdentifierAssociation record described in clause 6.3.2.2.2.\n-\tOption C: Use TS 33.107 [36] clause 12 natively as defined in that document.\nFor implementations that include EPS/5GS interworking, Option A shall be used.\nIn all cases, the present document specifies the stage 3 for the LI_HI1, LI_HI2 and LI_HI3 interfaces.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tLI at MME",
                            "text_content": "The IRI-POI present in the MME is provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nThe POI in the MME shall support the following target identifier formats:\n-\tIMSI (using the IMSI target identifier format from ETSI TS 103 221-1 [7]).\n-\tMSISDN (using the E164Number target identifier format from ETSI TS 103 221-1 [7]).\n-\tME Identity (using the IMEI target identifier format from ETSI TS 103 221-1 [7]).\nTable 6.3.2-0A shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POI in the MME.\nTable 6.3.2-0A: ActivateTask message for the IRI-POI in the MME\n\nTable 6.3.2-0B: IdentifierAssociationExtensions Parameters\n\nIf the MME receives one or more cell IDs in an S1 message (as specified in TS 36.413 [38]), the POI associated with the MME shall report all of them.\nThe IRI-POI in the MME shall only generate xIRI containing the MMEIdentifierAssociation record in the following scenarios:\n-\tIdentifierAssociation: MMEIdentifierAssociation and Tracking Area/EPS Location Update (see TS 33.107 [36] clause 12.2.1.2) records shall be generated. No other record types shall be generated for that target.\n-\tAll: All MME record types shall be generated.\nWhen Option A specified in clause 6.3.1 is used:\n-\tThe IRI-POI present in the MME shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 6.3.2.3, the details of which are described in the following clauses.\n-\tIn addition to the xIRI events listed in TS 33.127 [5] clause 6.3.2.3, the MME shall support xIRI generation in case of SMS over NAS as specified in TS 33.107 [36] clause 18.2.4. For records related to SMS over NAS in EPS:\n-\tThe IRI-POI present in the MME shall set the payload format to EpsHI2Operations.EpsIRIContent (value 14), see clause 5.3 and ETSI TS 103 221-2 [8] clause 5.4. The payload field shall contain an EpsHI2Operations.EpsIRIContent structure encoded according to TS 33.108 [12] clauses 10.5, 15.2 and B.9.\n-\tAs the LIID may be not available at the MME but is mandatory in EpsHI2Operations.EpsIRIContent according to TS 33.108 [12] Annex B.9, its value in the lawfulInterceptionIdentifier field of the encoded PDU shall be set to the fixed string \"LIIDNotPresent\".\nWhen Option B specified in clause 6.3.1 is used:\n-\tThe IRI-POI present in the MME shall send the xIRIs over LI_X2 for each of the events listed in TS 33.107 [36] clause 12.2.1.1, the details of which are specified in clause 12.2.3 of the same TS, and in case of SMS over NAS as specified in TS 33.107 [36] clause 18.2.4.\n-\tFor all records except MMEIdentifierAssociation (see clause 6.3.2.2.2), the IRI-POI present in the MME shall set the payload format to EpsHI2Operations.EpsIRIContent (value 14), see clause 5.3 and ETSI TS 103 221-2 [8] clause 5.4. The payload field shall contain an EpsHI2Operations.EpsIRIContent structure encoded according to TS 33.108 [12] clauses 10.5, 15.2 and B.9.\n-\tAs the LIID may be not available at the MME but is mandatory in EpsHI2Operations.EpsIRIContent according to TS 33.108 [12] Annex B.9, its value in the lawfulInterceptionIdentifier field of the encoded PDU shall be set to the fixed string \"LIIDNotPresent\".\n-\tIn addition to the xIRI events listed in TS 33.107 [36], the MME shall support xIRI containing the MMEIdentiferAssociation record in clause 6.3.2.2.2.\nThe IRI-POI present in the MME shall generate an xIRI containing an MMEIdentifierAssociation record when the IRI-POI present in the MME detects a new identifier association for a UE matching one of the target identifiers provided via LI_X1. Generation of this record is subject to this record type being enabled for a specific target (see clause 6.3.2.2.1).\nTable 6.3.2-1: Payload for MMEIdentifierAssociation record\n\nThe IRI-POI present in the MME generating an xIRI containing an MMEIdentifierAssociation record shall set the Payload Direction field in the PDU header to not applicable (Direction Value 5, see ETSI TS 103 221-2 [8] clause 5.2.6).\nWhen transmitting the xIRI, the IRI-POI present in the MME shall set the payload format to 2, and provide the payload as a BER-encoded TS33128Payloads.XIRIPayloads structure.\nThe IRI-POI in the MME shall generate an xIRI containing an MMEAttach record when the IRI-POI present in the MME detects that a UE matching one of the target identifiers provided via LI_X1 has successfully attached to EPS. Accordingly, the IRI-POI in the MME generates the xIRI when the following event is detected:\n-\tMME sends an S1: ATTACH ACCEPT message to the target UE and the UE EPS Mobility Management (EMM) state within the MME is changed to EMM-REGISTERED.\nTable 6.3.2-2: Payload for MMEAttach record\n\nThe IRI-POI in the MME shall generate an xIRI containing an MMEDetach record when the IRI-POI present in the MME detects that a UE matching one of the target identifiers provided via LI_X1 has deregistered from the EPS. Accordingly, the IRI-POI in the MME generates the xIRI when any of the following events is detected:\n-\tFor network initiated de-registration, when the MME receives the S1: DETACH ACCEPT message from the target UE, when the MME receives an S3: DETACH NOTIFICATION about the target UE from the SGSN or when implicit deregistration timer expires; and in all cases the UE EMM state within the MME is changed to EMM-DEREGISTERED.\n-\tFor UE initiated de-registration, when the MME sends the S1: DETACH ACCEPT message to the target UE or when the MME receives the S1: DETACH REQUEST message from the target UE with deregistration type value of “switch off”; and in both cases the UE EMM state within the MME is changed to EMM-DEREGISTERED.\nTable 6.3.2-3: Payload for MMEDetach record\n\nTable 6.3.2-4: detachType values\n\nThe IRI-POI in the MME shall populate the ePSDetachType field with the values listed in table 6.3.2-4 based on the Detach Type sent in the Detach Request message (see TS 24.301 [51] clause 9.9.3.7) and the direction of the Detach Request associated to the event that triggered the generation of the xIRI.\nIf the Detach Request message associated to the event that triggered the generation of the xIRI has the EMM Cause field populated, the IRI-POI in the MME shall set the value of the cause field of the MMEDetach record to the integer value of the EMM Cause, see TS 24.301 [51] clause 9.9.3.9.\nWhen the reporting of location information is authorised, the IRI-POI in the MME shall generate an xIRI containing an MMELocationUpdate record each time the IRI-POI present in an MME detects that the target UE location is updated due to target UE mobility or as a part of an MME service procedure. The generation of such separate xIRI is not required if the updated UE location information is obtained as a part of a procedure producing some other xIRIs (e.g. mobility registration). In that case the location information is included into the respective xIRI.\nIn addition to the Tracking Area Update described in TS 23.401 [50], clause 5.3.3, the UE mobility events resulting in generation of an MMELocationUpdate xIRI include the S1 Path Switch Request (intra E-UTRAN handover X2 based handover procedure described in TS 23.401 [50] clause 5.5.1.1) and the S1 Handover Notify (Intra E-UTRAN S1 based handover procedure described in TS 23.401 [50] clause 5.5.1.2).\nThe MMELocationUpdate xIRI is also generated when the MME receives an E-UTRAN S1AP ERAB Modification Indication message as a result of Dual Connectivity activation/release for the target UE, as described in TS 37.340 [37] clause 10.\nBased on regulatory requirements and operator policy, the location information obtained by the MME from E-UTRAN or the E-SMLC in the course of some service operations may result in the generation of the MMELocationUpdate xIRI record. Additionally, the IRI-POI in the MME shall capture the location information in the scenarios described in TS 23.271 [52] clause 4.4.2. Also, in the case of Mobile Originated LCS service invoked by the target, the location information may be derived from the Location Service Response sent to the target UE via the MME (see TS 23.271 [52] clause 9.2.6).\nOptionally, based on regulatory and operator policy, other MME messages that do not generate separate xIRI but carry location information such as emergency services or LCS may trigger the generation of an MMELocationUpdate xIRI record.\nThe MMELocationUpdate record is also used by LARF to deliver location acquisition responses to MDF2, as described in clause 7.3.5.6. For the responses to location acquisition requests initiated by LARF, as described in TS 33.127 [5] the MMELocationUpdate xIRIs shall not be generated.\nTable 6.3.2-5: Payload for MMELocationUpdate record\n\nThe IRI-POI in the MME shall generate an xIRI containing an MMEStartOfInterceptionWithEPSAttachedUE record when the IRI-POI present in the MME detects that interception is activated on a UE that has already attached to the EPS. A UE is considered already attached to the EPS when the EMM state for that UE is EMM-REGISTERED. Therefore, the IRI-POI present in the MME shall generate the xIRI MMEStartOfInterceptionWithEPSAttachedUE record when it detects that a new interception for a UE is activated (i.e. provisioned by the LIPF) and the EPS mobility management state within the MME for that UE is EMM-REGISTERED.\nTable 6.3.2-6: Payload for MMEStartOfInterceptionWithEPSAttachedUE record\n\nThe IRI-POI present in the MME generating an xIRI containing an MMEStartOfInterceptionWithEPSAttachedUE record shall set the Payload Direction field in the PDU header to not applicable (see ETSI TS 103 221-2 [8] clause 5.2.6).\nThe IRI-POI in the MME shall generate an xIRI containing an MMEUnsuccessfulProcedure record when the IRI-POI present in the MME detects an unsuccessful procedure for a UE matching one of the target identifiers provided via LI_X1.\nAccordingly, the IRI-POI in the MME generates the xIRI when any of the following events is detected:\n-\tMME sends a reject to any EMM request message to the target UE and the UE EPS Mobility Management (EMM) within the MME is changed to EMM-DEREGISTERED.\n-\tMME aborts a registration procedure before the UE EPS Mobility Management (EMM) state within the MME is changed to EMM-REGISTERED.\n-\tMME sends a reject to any ESM request message to the target UE.\nUnsuccessful attach attempts shall be reported only if the target UE has been successfully authenticated.\nTable 6.3.2-7: Payload for MMEUnsuccessfulProcedure record\n\nThe IRI-POI present in the MME shall generate an xIRI containing an MMEPositioningInfoTransfer when the IRI-POI present in the MME detects one of the following events:\n-\ta LPPa (see TS 36.455 [84]) message related to a target UE has been exchanged between the E-SMLC and the eNB via the MME.\n-\ta LPP (see TS 37.355 [85]) message related to a target UE has been exchanged between the E-SMLC and the target UE via the MME.\nAccordingly, the IRI-POI in MME generates the xIRI when any of the following events is detected:\n-\tMME receives an SLs CONNECTION ORIENTED INFORMATION message (see TS 29.171 [54]) from E-SMLC to request the transfer of a LPPa request to the serving eNB for a target UE as part of a UE associated LPPa positioning activity. The LPPa request may be E-CID MEASUREMENT INITIATION REQUEST or OTDOA INFORMATION REQUEST.\n-\tMME sends an SLs CONNECTION ORIENTED INFORMATION message to the E-SMLC to forward the LPPa response or report received from the eNB for a target UE. The LPPa response or report may be E-CID MEASUREMENT INITIATION RESPONSE, E-CID MEASUREMENT REPORT or OTDOA INFORMATION RESPONSE.\n-\tMME receives an SLs CONNECTION ORIENTED INFORMATION message from E-SMLC to request the transfer of a LPP request to the target UE.\n-\tMME sends an SLs CONNECTION ORIENTED INFORMATION message to E-SMLC to forward a LPP message received from the target UE.\nTable 6.3.2-7A: Payload for MMEPositioningInfoTransfer record\n\n6.3.2.2.9.1\tGeneral\nThe present clause provides the LI requirements for S1 interface-based handovers which occur for a target UE. Such handovers may be intra EPS (inter-eNB), 5GS to EPS (inter-system), EPS to 5GS (inter-system), EPS to UTRA (inter-system) or EPS to GERA (inter-system).\nThe following xIRI records are used to report handover related events between the MME and RAN nodes for the target UE when the delivery of location information is not restricted by service scoping:\n-\tEPSRANHandoverCommand.\n-\tEPSRANHandoverRequest.\nThe above xIRIs are used to report handover events and information that are not carried in the MMELocationUpdate (clause 6.3.2.2.5) record and shall include the information transferred between the MME and RAN nodes, as a part of handover preparation, resource allocation, and handover notification.\n6.3.2.2.9.2\tHandover command\nThe IRI-POI in the MME shall generate an xIRI containing an EPSRANHandoverCommand record when the IRI-POI present in the MME detects that the MME has sent a HANDOVER COMMAND message to the source RAN node (old RAN node) in response to a HANDOVER REQUIRED message for the target UE and location information is not restricted by service scoping.\nTable 6.3.2.2.9.2-1: Payload for EPSRANHandoverCommand record\n\n6.3.2.2.9.3\tHandover request\nThe IRI-POI in the MME shall generate an xIRI containing an EPSRANHandoverRequest record when the IRI-POI in the MME detects that the MME received a HANDOVER REQUEST ACKNOWLEDGE message from the gaining RAN node (new RAN node) for the target UE and location information is not restricted by service scoping.\nNOTE:\tThe gaining RAN node sends the HANDOVER REQUEST ACKNOWLEDGE in response to a HANDOVER REQUEST from the MME.\nTable 6.3.2.2.9.3-1: Payload for EPSRANHandoverRequest record\n\nTrace procedures, as defined in TS 32.423 [112], allow for the MME to request trace sessions, including Minimization of Drive Test (MDT) data gathering for a target using UE-associated signalling.\nThe present clause provides the LI requirements for reporting trace sessions from the IRI-POI in the MME for a target UE.\nThe following xIRI records are used to report trace related events between the MME and RAN nodes for the target UE when the delivery of location information is not restricted by service scoping:\n-\tMMERANTraceReport\nThe IRI-POI in the MME shall generate an xIRI containing an MMERANTraceReport record when the IRI-POI present in the MME has detected any of the following events:\n-\tMME sent a TRACE START message to a RAN node in response to a Trace Session Activation message for the target.\n-\tMME received a CELL TRAFFIC TRACE message from the RAN for the target.\n-\tMME sent MDT or trace data to the trace collection entity for the target.\n-\tMME sent a deactivate trace message to the RAN for the target.\nTable 6.3.2.2.10.2-1: Payload for MMERANTraceReport record\n\nThe IRI-POI in the MME shall generate an xIRI containing an MMEUEServiceAccept record when the IRI-POI in present in the MME detects that the MME considers a service request procedure initiated by the target to be completed successfully (see TS 24.301 [51] clause 5.6.1.4).\nTable 6.3.2.2.11-1: Payload for MMEUEServiceAccept record\n\nTable 6.3.2.2A.1-1: Simple Types for LI reporting of MME Events\n\nThe EPSHandoverType provides information about the type of handover being performed in EPS. Defined in TS 36.413 [38] clause 9.2.1.13.\nTable 6.3.2.2A.2-1 contains the details of the EPSHandoverType type.\nTable 6.3.2.2A.2-1: Details for EPSHandoverType\n\nTable 6.3.2.2A.3-1 contains the details for the ERABContextList type.\nTable 6.3.2.2A.3-1: Structure of the ERABContextList type\n\nTable 6.3.2.2A.4-1 contains the details for the ERABContext type.\nTable 6.3.2.2A.4-1: Structure of the ERABContext type\n\nTable 6.3.2.2A.5-1 contains the details for the ERABReleaseList type.\nTable 6.3.2.2A.5-1: Structure of the ERABReleaseList type\n\nTable 6.3.2.2A.6-1 contains the details for the ERABErrortype.\nTable 6.3.2.2A.6-1: Structure of the ERABErrortype\n\nTable 6.3.2.2A.7-1: Details for EPSRANCause parameter\n\nThis IE is derived from the Handover Restriction List IE defined in TS 36.413 [38] clause 9.2.1.22. This information describes roaming or access restrictions for subsequent mobility of a UE.\nTable 6.3.2.2A.8-1 contains the details for the EPSHandoverRestrictionList.\nTable 6.3.2.2A.8-1: Structure of the EPSHandoverRestrictionList\n\nTable 6.3.2.2A.9-1 contains the details for the EPSCSGInfo type.\nTable 6.3.2.2A.9-1: Structure of the EPSCSGInfo type\n\nTable 6.3.2.2A.10-1 contains the details for the EPSProSeAuthorization type.\nTable 6.3.2.2A.10-1: Details for the EPSProSeAuthorization type\n\nTable 6.3.2.2A.11-1 contains the details for the EPSSubscriptionBasedUEDifferentiationIndication type. This information is derived from the Subscription Based UE Differentiation Information IE defined in TS 36.413 [38] clause 9.2.1.140.\nTable 6.3.2.2A.11-1: Structure of the EPSSubscriptionBasedUEDifferentiationIndication type\n\n\nTable 6.3.2.2A.12-1 contains the details for the S1Information type. This information is derived from the S1 SETUP REQUEST and S1 SETUP RESPONSE. See TS 36.413 [38] clauses 9.1.8.4 and 9.1.8.5.\nTable 6.3.2.2A.12-1: Structure of the S1Information type\n\nTable 6.3.2.2A.13-1 contains the details for the MMEServedGUMMEIList type. This information is derived from the Served GUMMEI List IE of the S1 SETUP RESPONSE. See TS 36.413 [38] clauses 9.1.8.5.\nTable 6.3.2.2A.13-1: Structure of the MMEServedGUMMEIList type\n\nTable 6.3.2.2A.14-1 contains the details for the MMEServedGUMMEI type. This information is derived from the Served GUMMEI List IE of the S1 SETUP RESPONSE. See TS 36.413 [38] clauses 9.1.8.5.\nTable 6.3.2.2A.14-1: Structure of the MMEServedGUMMEI type\n\nTable 6.3.2.2A.15-1 contains the details for the EPSNASTransportInitialInformation type. This information is derived from information present in the INITIAL UE MESSAGE defined in TS 36.413 [38] clauses 9.1.7.1.\nTable 6.3.2.2A.15-1: Structure of the MMEServedGUMMEI type\n\nTable 6.3.2.2A.16-1 contains the details for the BBFTunnelInformation type. This information is derived from information present in the Tunnel Information IE defined in TS 36.413 [38] clauses 9.2.2.3.\nTable 6.3.2.2A.16-1: Structure of the BBFTunnelInformation type\n\nTable 6.3.2.2A.17-1 contains the details for the LTENTNTAIInformation type. This information is derived from information present in the LTE NTN TAI Information IE defined in see TS 36.413 [38] clause 9.2.3.56.\nTable 6.3.2.2A.17-1: Structure of the LTENTNTAIInformation type\n\nTable 6.3.2.2A.18-1 contains the details for the EPSRANUEContext type. This information is derived from information present in the INITIAL UE CONTEXT SETUP REQUEST IE defined in see TS 36.413 [38] clause 9.1.4.1.\nTable 6.3.2.2A.18-1: Structure of the EPSRANUEContext type\n\nThe EPSCSFallbackIndicator indicates that a fallback to the CS domain is required and the type of fallback requested. Derived from the enumerations in TS 36.413 [38] clause 9.2.3.21.\nTable 6.3.2.2A.19-1 contains the details of the EPSCSFallbackIndicator type.\nTable 6.3.2.2A.19-1: Enumeration for EPSCSFallbackIndicator\n\nWhen Option A or Option B specified in clause 6.3.1 are used and an xIRI is received over LI_X2 from the IRI-POI in the MME, the MDF2 shall generate the corresponding IRI message and deliver it over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received in the xIRI over LI_X2.\nWhen Option C specified in clause 6.3.1 is used the MDF2 shall generate IRI messages based on the proprietary information received from the MME and provide it over LI_HI2 without undue delay.\nThe IRI record may be enriched with any additional information available at the MDF (e.g. additional location information).\nThe IRI messages shall be delivered over LI_HI2 according to ETSI TS 102 232-7 [10] clause 10.When Option A specified in clause 6.3.1 is used, LI_HI2 shall be realised as described in clause 6.3.2.3.2.\nWhen Option B or Option C specified in clause 6.3.1 is used, LI_HI2 shall be realised as described in clause 6.3.2.3.3.\nThe IRI message the MDF2 generates shall contain a copy of the relevant record received in the xIRI over LI_X2 and provide it over LI_HI2 without undue delay.\nThe timestamp field of the PSHeader structure shall be set to the time at which the MME event was observed (i.e. the timestamp field of the X2 PDU).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 6.3.2-8.\nTable 6.3.2-8: IRI type for IRI messages\n\nThese IRI messages shall omit the CIN (see ETSI TS 102 232-1 [9] clause 5.2.4).\nThe threeGPP33128DefinedIRI field in ETSI TS 102 232-7 [10] clause 15 shall be populated with the BER-encoded IRIPayload.\nWhen an additional warrant is activated on a target UE and the LIPF uses the same XID for the additional warrant, the MDF2 shall be able to generate and deliver the IRI message containing the MMEStartOfInterceptionWithEPSAttachedUE record to the LEMF associated with the additional warrant without receiving a corresponding xIRI. The payload of the MMEStartOfInterceptionWithEPSAttachedUE record is specified in table 6.3.2-6.\nFor records related to SMS over NAS in EPS, the process detailed in clause 6.3.2.3.3 shall be used.\nFor all messages except MMEIdentifierAssociation, the IRI messages shall include an IRI payload encoded according to TS 33.108 [12] Annex B.9.\nThe MDF2 shall encode the correct value of LIID in the IRI message, replacing the value \"LIIDNotPresent\" given in the xIRI (see clause 6.3.2.2).\nFor MMEIdentifierAssociation messages, the IRI message shall be encoded as an IRIEvent structure according to Annex B and used to populate the threeGPP33128DefinedIRI field in ETSI TS 102 232-7 [10] clause 15.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.3.2-0A: ActivateTask message for the IRI-POI in the MME",
                                    "table number": 113,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2-0B: IdentifierAssociationExtensions Parameters",
                                    "table number": 114,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2-1: Payload for MMEIdentifierAssociation record",
                                    "table number": 115,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2-2: Payload for MMEAttach record",
                                    "table number": 116,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2-3: Payload for MMEDetach record",
                                    "table number": 117,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2-4: detachType values",
                                    "table number": 118,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2-5: Payload for MMELocationUpdate record",
                                    "table number": 119,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2-6: Payload for MMEStartOfInterceptionWithEPSAttachedUE record",
                                    "table number": 120,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2-7: Payload for MMEUnsuccessfulProcedure record",
                                    "table number": 121,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2-7A: Payload for MMEPositioningInfoTransfer record",
                                    "table number": 122,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2.9.2-1: Payload for EPSRANHandoverCommand record",
                                    "table number": 123,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2.9.3-1: Payload for EPSRANHandoverRequest record",
                                    "table number": 124,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2.10.2-1: Payload for MMERANTraceReport record",
                                    "table number": 125,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2.11-1: Payload for MMEUEServiceAccept record",
                                    "table number": 126,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.1-1: Simple Types for LI reporting of MME Events",
                                    "table number": 127,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.2-1: Details for EPSHandoverType",
                                    "table number": 128,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.3-1: Structure of the ERABContextList type",
                                    "table number": 129,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.4-1: Structure of the ERABContext type",
                                    "table number": 130,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.5-1: Structure of the ERABReleaseList type",
                                    "table number": 131,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.6-1: Structure of the ERABErrortype",
                                    "table number": 132,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.7-1: Details for EPSRANCause parameter",
                                    "table number": 133,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.8-1: Structure of the EPSHandoverRestrictionList",
                                    "table number": 134,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.9-1: Structure of the EPSCSGInfo type",
                                    "table number": 135,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.10-1: Details for the EPSProSeAuthorization type",
                                    "table number": 136,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 137,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.12-1: Structure of the S1Information type",
                                    "table number": 138,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.13-1: Structure of the MMEServedGUMMEIList type",
                                    "table number": 139,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.14-1: Structure of the MMEServedGUMMEI type",
                                    "table number": 140,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.15-1: Structure of the MMEServedGUMMEI type",
                                    "table number": 141,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.16-1: Structure of the BBFTunnelInformation type",
                                    "table number": 142,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.17-1: Structure of the LTENTNTAIInformation type",
                                    "table number": 143,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.18-1: Structure of the EPSRANUEContext type",
                                    "table number": 144,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2.2A.19-1: Enumeration for EPSCSFallbackIndicator",
                                    "table number": 145,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.2-8: IRI type for IRI messages",
                                    "table number": 146,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.3.3\tLI at SGW/PGW and ePDG",
                            "text_content": "Unless otherwise specified, the following clauses apply to both CUPS and non-CUPS EPS architectures. When CUPS architecture is used, unless otherwise specified, the term SGW/PGW refers to both the SGW-U/PGW-U and the SGW-C/PGW-C.\nUnless otherwise specified, the following clauses apply in the case of EPC-5GC interworking via combined SMF+PGW-C and UPF+PGW-U.\nIf the warrant is for IRI and CC, then the LI functions in the SGW/PGW shall be provisioned in accordance with clause 6.3.3.1.2 for non-CUPS architecture and clause 6.3.3.1.3 for CUPS architecture, the MDF2 shall be provisioned in accordance with clause 6.3.3.1.4, and the MDF3 shall be provisioned in accordance with clause 6.3.3.1.5.\nIf the warrant is for IRI only, the IRI-POI in the SGW/PGW shall be provisioned in accordance with clause 6.3.3.1.2 for non-CUPS architecture and clause 6.3.3.1.3 for CUPS architecture and the MDF2 shall be provisioned in accordance with clause 6.3.3.1.4.If approach 1 described in clause 6.2.3.9 is used for packet header information reporting:\n-\tFor non-CUPS architecture, the IRI-POI in the SGW/PGW shall be provisioned in accordance with clause 6.3.3.1.2 and the MDF2 shall be provisioned in accordance with clause 6.3.3.1.4.\n-\tFor CUPS architecture, the IRI-TF in the SGW-C/PGW-c shall be provisioned in accordance with clause 6.3.3.1.3 and the MDF2 shall be provisioned in accordance with clause 6.3.3.1.4.\nIf approach 2 described in clause 6.2.3.9 is used for packet header information reporting:\n-\tFor non-CUPS architecture, the CC-POI in the SGW/PGW shall be provisioned in accordance with clause 6.3.3.1.2, the MDF2 shall be provisioned in accordance with clause 6.3.3.1.4, and the MDF3 shall be provisioned in accordance with clause 6.3.3.1.5.\n-\tFor CUPS architecture, the CC-TF in the SGW-C/PGW-C shall be provisioned in accordance with clause 6.3.3.1.3, the MDF2 shall be provisioned in accordance with clause 6.3.3.1.4, and the MDF3 shall be provisioned in accordance with clause 6.3.3.1.5.\nThe LI functions in the SGW/PGW and ePDG, the MDF2 and the MDF3 shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):\n-\tIMSI.\n-\tMSISDN (using the E164Number target identifier format from ETSI TS 103 221-1 [7]).\n-\tIMEI.\nIn the case of EPC-5GC interworking via combined SMF+PGW-C and UPF+PGW-U, the LI functions in the SMF+PGW-C, MDF2 and MDF3 shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivatlent if ETSI TS 103 221-1 [7] is not used):\n-\tSUPINAI.\n-\tSUPIIMSI.\n-\tIMSI.\n-\tGPSINAI.\n-\tGPSIMSISDN.\n-\tMSISDN (using the E164Number target identifier format from ETSI TS 103 221-1 [7]).\n-\tPEIIMEISV.\n-\tPEIIMEI.\n-\tIMEI.\nWhen the target identifier is an IMSI, the LI functions in the SMF+PGW-C shall also trigger when events associated to a SUPI in the form of an IMSI with a value matching the provisioned IMSI target identifier value are detected. Likewise, when the target identifier is a SUPIIMSI, the LI functions in the SMF+PGW-C shall also trigger when events associated to an IMSI with a value matching the provisioned SUPIIMSI target identifier value are detected.\nWhen the target identifier is an MSISDN, the LI functions in the SMF+PGW-C shall also trigger when events associated to a GPSI in the form of an MSISDN with a value matching the provisioned MSISDN target identifier value are detected. Likewise, then the target identifier is a GPSIMSISDN, the LI functions in the SMF+PGW-C shall also trigger when events associated to an MSISDN with a value matching the provisioned GPSIMSISDN target identifier value are detected.\nWhen the target identifier is an IMEI, the LI functions in the SMF+PGW-C shall also trigger when events associated to a PEI in the form of an IMEI with a value matching the provisioned IMEI target identifier value are detected. Likewise, then the target identifier is a PEIIMEI, the LI functions in the SMF+PGW-C shall also trigger when events associated to an IMEI with a value matching the provisioned PEIIMEI target identifier value are detected.\nNOTE:\tWhen both a 4G identifier and its equivalent 5G identifier are provisioned by means of separate tasks in the LI functions present in the SMF+PGW-C, interception will be triggered independently for each of the two identifiers.\nWhen the EPS is implemented using non-CUPS architecture, the IRI-POI and CC-POI present in the SGW/PGW and ePDG are provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2. A single task may be used.\nTable 6.3.3.1-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POI and the CC-POI in the SGW/PGW.\nTable 6.3.3.1-1: ActivateTask message for the IRI-POI and CC-POI in the SGW/PGW and ePDG in non-CUPS architecture\n\nTo enable packet header information reporting, parameters specified in table 6.2.3.9.2-1: PDHRReportingExtensions parameters shall be provided as the TaskDetailsExtensions/HeaderReporting field of the LI_X1 provisioning message.\nWhen the EPS is implemented using CUPS architecture, the IRI-POI, IRI-TF and CC-TF present in the SGW-C/PGW-C and the IRI-POI and CC-POI present in the ePDG are provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nTable 6.3.3.1-2 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POI, CC-TF and IRI-TF in the SGW-C/PGW-C. If the ePDG is used, the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POI and the CC-POI in the ePDG are detailed in Table 6.3.3.1-1.\nTable 6.3.3.1-2: ActivateTask message for the IRI-POI, CC-TF and IRI-TF in the SGW-C/PGW-C in CUPS architecture\n\nTo enable packet header information reporting, parameters specified in table 6.2.3.9.2-1: PDHRReportingExtensions parameters shall be provided as the TaskDetailsExtensions/HeaderReporting field of the LI_X1 provisioning message.\nThe MDF2 listed as the delivery endpoint for xIRI generated by the IRI-POI in the CP entity of the SGW/PGW or ePDG shall be provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2. Table 6.3.3.1-3 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF2.\nTable 6.3.3.1-3: ActivateTask message for MDF2\n\nTable 6.3.3.1-4: Mediation Details for MDF2\n\nThe MDF3 listed as the delivery endpoint for the xCC generated by the CC-POI in the UP entity of the SGW/PGW or ePDG shall be provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2. Table 6.3.3.1-5 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF3. If packet header reporting is authorised and approach 2 described in clause 6.2.3.9 is used, the endpoint for the MDF3 shall be the MDF2 over LI_MDF.\nTable 6.3.3.1-5: ActivateTask message for MDF3\n\nTable 6.3.3.1-6: Mediation Details for MDF3\nWhen Option A specified in clause 6.3.1 is used:\n-\tFor architectures with EPC/5GC interworking:\n-\tFor home routed roaming interception in the visited network, in this version of the specification, the IRI-POI present in the SGW shall be implemented in accordance with Option B or Option C specified in clause 6.3.1.\n-\tFor all other cases, the IRI-POI present in the SMF+PGW-C shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 6.3.3.3.1.2, as described in clause 6.3.1.\n-\tAs described in TS 23.501 [2] clause 5.32.7.1, a PDN Connection in EPS can be one leg of an MA PDU session. The details of the messages for single-access PDU sessions are provided in clauses 6.3.3.2.2, 6.3.3.2.3, 6.3.3.2.4 and 6.3.3.2.5. The details for the messages for MA PDU sessions are provided in clauses 6.3.3.2.6, 6.3.3.2.7, 6.3.3.2.8 and 6.3.3.2.9.\nNOTE:\tThe details of the events triggers used to generate the xIRIs are specified at high-level in support of possible hitherto implementation variations for EPS LI.\nWhen Option B specified in clause 6.3.1 is used:\n-\tThe IRI-POI present in the SGW/PGW and ePDG shall send the xIRIs over LI_X2 for each of the events listed in TS 33.107 [36] clause 12.2.1.2, the details of which are specified in clause 12.2.3 of the same TS.\n-\tThe IRI-POI present in the SGW/PGW and ePDG shall set the payload format to EpsHI2Operations.EpsIRIContent (value 14), see clause 5.3 and ETSI TS 103 221-2 [8] clause 5.4. The payload field shall contain an EpsHI2Operations.EpsIRIContent structure encoded according to TS 33.108 [12] clauses 10.5 and B.9.\n-\tAs the LIID may not be available at the SGW/PGW and ePDG but is mandatory in EpsHI2Operations.EpsIRIContent according to TS 33.108 [12] Annex B.9, its value in the lawfulInterceptionIdentifier field of the encoded PDU shall be set to the fixed string \"LIIDNotPresent\".\nThe IRI-POI in the SMF+PGW-C shall generate an xIRI containing an SMFPDUSessionEstablishment record (see clause 6.2.3.2.2) when the IRI-POI present in the SMF+PGW-C detects that a single-access PDU Session or PDN Connection has been established for the target UE. The IRI-POI present in the SMF+PGW-C shall generate the xIRI for the following events:\n-\tThe SMF+PGW-C creates a new PDN Connection in the target UE context of the SMF+PGW-C (see TS 23.401 [50] clause 5.7.4).\n-\tThe SMF+PGW-C creates a new PDU Session context or SM Context for the target UE (see TS 29.502 [16] clause 5.2.2.2 and clause 5.2.2.7).\nWhen the SMFPDUSessionEstablishment record (see clause 6.2.3.2.2) is used to report the creation of a new PDN Connection:\n-\tThe ePSPDNConnectionEstablishment field shall be populated with the information in Table 6.3.3-1.\n-\tIf there is no SUPI associated to the SM context for the target UE, the SUPI field of the SMFPDUSessionEstablishment record shall be populated with the value of the IMSI from the target UE context.\n-\tIf there is no PDU Session ID present in the PCO of the request or response messages or associated to the context for the PDN connection, the pDUSessionID field of the SMFPDUSessionEstablishment record shall be populated with the EBI of the default bearer for the PDN Connection.\n-\tIf there is no 5G UP tunnel present in the context associated to the PDN Connection, the gTPTunnelID field of the SMFPDUSessionEstablishment record shall be populated with the F-TEID for the PGW S5 or S8 interface for the default bearer of the PDN Connection.\nTable 6.3.3-1: Payload for ePSPDNConnectionEstablishment Field\n\nTable 6.3.3-2: Payload for bearerContextsCreated Field\n\nTable 6.3.3-3: Payload for bearerContextsMarkedForRemoval Field\n\nTable 6.3.3-4: Payload for protocolConfigurationOptions Field\n\nTable 6.3.3-5: Payload for fiveGSInterworkingInfo Field\n\nTable 6.3.3-6: Payload for ePSGTPTunnels Field\n\nTable 6.3.3-7: Payload for bearerQOS Field\n\nThe IRI-POI in the SMF+PGW-C shall generate an xIRI containing an SMFPDUSessionModification record (see clause 6.2.3.2.3) when the IRI-POI present in the SMF+PGW-C detects that a single-access PDU Session or PDN Connection has been modified for the target UE. The IRI-POI present in the SMF+PGW-C shall generate the xIRI for the following events:\n-\tThe SMF+PGW-C modifies an existing PDN Connection in the target UE context of the SMF+PGW-C (see TS 23.401 [50] clause 5.7.4).\n-\tThe SMF+PGW-C modifies an existing PDU Session context or SM Context for the target UE (see TS 29.502 [16] clause 5.2.2.3 and clause 5.2.2.8).\n-\tThe SMF+PGW-C transfers an existing PDU Session to EPS (see TS 23.502 [4] clauses 4.11.1.2.1 and 4.11.2.2).\n-\tThe SMF+PGW-C transfers an existing PDN Connection to 5GS (see TS 23.502 [4] clauses 4.11.1.2.2 and 4.11.2.3).\nWhen the SMFPDUSessionModification record (see clause 6.2.3.2.3) is used to report the modification of a PDN Connection:\n-\tThe ePSPDNConnectionModification field shall be populated with the information in Table 6.3.3-8.\n-\tIf there is no SUPI associated to the SM context for the target UE, the SUPI field of the SMFPDUSessionModification record shall be populated with the value of the IMSI from the target UE context.\n-\tIf there is no PDU Session ID present in the PCO of the request or response messages or associated to the context for the PDN connection, the pDUSessionID field of the SMFPDUSessionModification record shall be populated with the EBI of the default bearer for the PDN Connection.\n-\tIf there is no 5G UP tunnel present in the context associated to the PDN Connection, the gTPTunnelID field of the SMFPDUSessionModification record shall be populated with the F-TEID for the PGW S5 or S8 interface for the default bearer of the PDN Connection.\nTable 6.3.3-8: Payload for ePSPDNConnectionModification parameter\n\nTable 6.3.3-9: Structure of the EPSBearerContextModified type\n\nTable 6.3.3-10: Structure of the EPSBearersDeleted type\n\nTable 6.3.3-11: Structure of the EPSDeleteBearerResponse type\n\nTable 6.3.3-12: Structure of the EPSDeleteBearerContext type\n\nThe IRI-POI in the SMF+PGW-C shall generate an xIRI containing an SMFPDUSessionRelease record (see clause 6.2.3.2.4) when the IRI-POI present in the SMF+PGW-C detects that a single-access PDU Session or PDN Connection has been released for the target UE. The IRI-POI present in the SMF+PGW-C shall generate the xIRI for the following events:\n-\tThe SMF+PGW-C releases an existing PDN Connection in the target UE context of the SMF+PGW-C (see TS 23.401 [50] clause 5.7.4).\n-\tThe SMF+PGW-C releases an existing PDU Session context or SM Context for the target UE (see TS 29.502 [16] clause 5.2.2.4 and clause 5.2.2.9).\nWhen the SMFPDUSessionRelease record (see clause 6.2.3.2.4) is used to report the release of a PDN Connection:\n-\tThe ePSPDNConnectionRelease field shall be populated with the information in Table 6.3.3-13.\n-\tIf there is no SUPI associated to the SM context for the target UE, the SUPI field of the SMFPDUSessionRelease record shall be populated with the value of the IMSI from the target UE context.\n-\tIf there is no PDU Session ID present in the PCO of the request or response messages or associated to the context for the PDN connection, the pDUSessionID field of the SMFPDUSessionRelease record shall be populated with the EBI of the default bearer for the PDN Connection.\n-\tIf there is no 5G UP tunnel present in the context associated to the PDN Connection, the gTPTunnelID field of the SMFPDUSessionRelease record shall be populated with the F-TEID for the PGW S5 or S8 interface for the default bearer of the PDN Connection.\nTable 6.3.3-13: Payload for ePSPDNConnectionRelease field\n\nThe IRI-POI in the SMF+PGW-C shall generate an xIRI containing an SMFStartOfInterceptionWithEstablishedPDUSession record (see clause 6.2.3.2.5) when the IRI-POI present in the SMF+PGW-C detects that a single-access PDU Session or PDN Connection has already been established for the target UE when interception starts. The IRI-POI present in the SMF+PGW-C shall generate the xIRI for the following events:\n-\tThe SMF+PGW-C has an existing PDN Connection in the target UE context of the SMF+PGW-C (see TS 23.401 [50] clause 5.7.4).\n-\tThe SMF+PGW-C has an existing PDU Session context or SM Context for the target UE (see TS 29.502 [16] clause 5.2.2.2 and clause 5.2.2.7).\nWhen the SMFStartOfInterceptionWithEstablishedPDUSession record (see clause 6.2.3.2.5) is used to report an existing PDN Connection:\n-\tThe ePSStartOfInterceptionWithEstablishedPDNConnection field shall be populated with the information in Table 6.3.3-14.\n-\tIf there is no SUPI associated to the SM context for the target UE, the SUPI field of the SMFStartOfInterceptionWithEstablishedPDUSession record shall be populated with the value of the IMSI from the target UE context.\n-\tIf there is no PDU Session ID associated to the context for the PDN connection, the pDUSessionID field of the SMFStartOfInterceptionWithEstablishedPDUSession record shall be populated with the EBI of the default bearer for the PDN Connection.\n-\tIf there is no 5G UP tunnel present in the context associated to the PDN Connection, the gTPTunnelID field of the SMFStartOfInterceptionWithEstablishedPDNConnection record shall be populated with the F-TEID for the PGW S5 or S8 interface for the default bearer of the PDN Connection.\nTable 6.3.3-14: Payload for ePSStartOfInterceptionWithEstablishedPDNConnection field\n\nThe IRI-POI in the SMF+PGW-C shall generate an xIRI containing an SMFMAPDUSessionEstablishment record (see clause 6.2.3.2.7) when the IRI-POI present in the SMF+PGW-C detects that a PDN Connection has been established for the target UE and associated to a multi-access PDU Session. The IRI-POI present in the SMF+PGW-C shall generate the xIRI for the following events:\n-\tThe SMF+PGW-C creates a new PDN Connection in the target UE context of the SMF+PGW-C (see TS 23.401 [50] clause 5.7.4) and it is associated to an MA PDU session as described in TS 23.502 [4] clause 4.22.2.3.\n-\tThe SMF+PGW-C creates a new multi-access PDU Session context or SM Context for the target UE (see TS 29.502 [16] clause 5.2.2.2 and clause 5.2.2.7).\nWhen the SMFMAPDUSessionEstablishment record (see clause 6.2.3.2.7) is used to report the creation of a new PDN Connection:\n-\tThe ePSPDNConnectionEstablishment field shall be populated with the information in table 6.3.3-1.\n-\tIf there is no SUPI associated to the SM context for the target UE, the SUPI field of the SMFMAPDUSessionEstablishment record shall be populated with the value of the IMSI from the target UE context.\n-\tIf there is no PDU Session ID present in the PCO of the request or response messages or associated to the context for the PDN connection, the pDUSessionID field of the SMFMAPDUSessionEstablishment record shall be populated with the EBI of the default bearer for the PDN Connection.\n-\tIf there is no 5G UP tunnel present in the context associated to the PDN Connection, the gTPTunnelID field of the SMFMAPDUSessionEstablishment record shall be populated with the F-TEID for the PGW S5 or S8 interface for the default bearer of the PDN Connection.\nThe IRI-POI in the SMF+PGW-C shall generate an xIRI containing an SMFMAPDUSessionModification record (see clause 6.2.3.2.7) when the IRI-POI present in the SMF+PGW-C detects that an MA PDU Session or PDN Connection associated to an MA PDU Session has been modified for the target UE. The IRI-POI present in the SMF+PGW-C shall generate the xIRI for the following events:\n-\tThe SMF+PGW-C modifies an existing PDN Connection associated to an MA PDU Session in the target UE context of the SMF+PGW-C (see TS 23.401 [50] clause 5.7.4).\n-\tThe SMF+PGW-C modifies an existing MA PDU Session context or SM Context for the target UE (see TS 29.502 [16] clause 5.2.2.3 and clause 5.2.2.8).\n-\tThe SMF+PGW-C transfers the 3GPP Access Leg of an existing MA PDU Session to EPS (see TS 23.502 [4] clause 4.22.6).\n-\tThe SMF+PGW-C transfers an existing PDN Connection associated to an MA PDU Session to 5GS (see TS 23.502 [4] clause 4.22.6).\nWhen the SMFMAPDUSessionModification record (see clause 6.2.3.2.7) is used to report the modification of a PDN Connection:\n-\tThe ePSPDNConnectionModification field shall be populated with the information in table 6.3.3-8.\n-\tIf there is no SUPI associated to the SM context for the target UE, the SUPI field of the SMFMAPDUSessionModification record shall be populated with the value of the IMSI from the target UE context.\n-\tIf there is no PDU Session ID present in the PCO of the request or response messages or associated to the context for the PDN connection, the pDUSessionID field of the SMFMAPDUSessionModification record shall be populated with the EBI of the default bearer for the PDN Connection.\n-\tIf there is no 5G UP tunnel present in the context associated to the PDN Connection, the gTPTunnelID field of the SMFMAPDUSessionModification record shall be populated with the F-TEID for the PGW S5 or S8 interface for the default bearer of the PDN Connection.\nThe IRI-POI in the SMF+PGW-C shall generate an xIRI containing an SMFMAPDUSessionRelease record (see clause 6.2.3.2.7) when the IRI-POI present in the SMF+PGW-C detects that an MA PDU Session or PDN Connection associated to an MA PDU Session has been released for the target UE. The IRI-POI present in the SMF+PGW-C shall generate the xIRI for the following events:\n-\tThe SMF+PGW-C releases an existing PDN Connection associated to an MA PDU Session in the target UE context of the SMF+PGW-C (see TS 23.401 [50] clause 5.7.4).\n-\tThe SMF+PGW-C releases an existing MA PDU Session context or SM Context for the target UE (see TS 29.502 [16] clause 5.2.2.4 and clause 5.2.2.9).\nWhen the SMFMAPDUSessionRelease record (see clause 6.2.3.2.7) is used to report the release of a PDN Connection:\n-\tThe ePSPDNConnectionRelease field shall be populated with the information in table 6.3.3-13.\n-\tIf there is no SUPI associated to the SM context for the target UE, the SUPI field of the SMFMAPDUSessionRelease record shall be populated with the value of the IMSI from the target UE context.\n-\tIf there is no PDU Session ID present in the PCO of the request or response messages or associated to the context for the PDN connection, the pDUSessionID field of the SMFMAPDUSessionRelease record shall be populated with the EBI of the default bearer for the PDN Connection.\n-\tIf there is no 5G UP tunnel present in the context associated to the PDN Connection, the gTPTunnelID field of the SMFMAPDUSessionRelease record shall be populated with the F-TEID for the PGW S5 or S8 interface for the default bearer of the PDN Connection.\nThe IRI-POI in the SMF+PGW-C shall generate an xIRI containing an SMFStartOfInterceptionWithEstablishedMAPDUSession record (see clause 6.2.3.2.7) when the IRI-POI present in the SMF+PGW-C detects that an MA PDU Session or PDN Connection associated to an MA PDU Session has already been established for the target UE when interception starts. The IRI-POI present in the SMF+PGW-C shall generate the xIRI for the following events:\n-\tThe SMF+PGW-C has an existing PDN Connection associated to an MA PDU Session in the target UE context of the SMF+PGW-C (see TS 23.401 [50] clause 5.7.4).\n-\tThe SMF+PGW-C has an existing MA PDU Session context or SM Context for the target UE (see TS 29.502 [16] clause 5.2.2.2 and clause 5.2.2.7).\nWhen the SMFStartOfInterceptionWithEstablishedMAPDUSession record (see clause 6.2.3.2.7) is used to report an existing PDN Connection:\n-\tThe ePSStartOfInterceptionWithEstablishedPDNConnection field shall be populated with the information in Table 6.3.3-14.\n-\tIf there is no SUPI associated to the SM context for the target UE, the SUPI field of the SMFStartOfInterceptionWithEstablishedMAPDUSession record shall be populated with the value of the IMSI from the target UE context.\n-\tIf there is no PDU Session ID associated to the context for the PDN connection, the pDUSessionID field of the SMFStartOfInterceptionWithEstablishedMAPDUSession record shall be populated with the EBI of the default bearer for the PDN Connection.\n-\tIf there is no 5G UP tunnel present in the context associated to the PDN Connection, the gTPTunnelID field of the SMFStartOfInterceptionWithEstablishedMAPDUSession record shall be populated with the F-TEID for the PGW S5 or S8 interface for the default bearer of the PDN Connection.\nWhen CUPS architecture is used and the interception of user plane packets is required, the CC-TF present in the SGW-C/PGW-C sends a trigger to the CC-POI present in the SGW-U/PGW-U over the LI_T3 interface.\nThe CC-POI present in the SGW/PGW and ePDG shall send xCC over LI_X3 for each IP packet belonging to the target’s communication.\nEach X3 PDU shall contain the contents of the user plane packet given using the GTP-U, IP or Ethernet payload format.\nThe CC-POI present in the SGW/PGW and ePDG shall set the payload format to indicate the appropriate payload type (5 for IPv4 Packet, 6 for IPv6 Packet, 7 for Ethernet frame or 12 for GTP-U packet as per ETSI TS 103 221-2 [8] clause 5.4).\nIf it is required to send the ICE-type for the xCC, the CC-POI shall set the NFID attribute (see ETSI TS 103 221-2 [8] clause 5.3.7) to the appropriate value from the ICE-type enumeration in TS 33.108 [12] Annex B.10 as a single octet. As an example, an ICE-type of \"sgw\" is indicated by setting the attribute to value 3.\nWhen CUPS architecture is used, the CC-POI in the SGW-U/PGW-U is provisioned by the CC-TF in the SGW-C/PGW-C using a Triggering message (i.e. ActivateTask message) as described in clause 6.3.3.0.\nThe CC-POI present in the SGW-U/PGW-U shall send xCC over LI_X3 for each IP packet matching the criteria specified in the Triggering message (i.e. ActivateTask message) received over LI_T3 from the CC-TF in the SGW-C/PGW-C.\nNOTE:\tImplementers are reminded of the completeness and non-duplication requirements (see TS 33.127 [5]).\nEach X3 PDU shall contain the contents of the user plane packet given using the GTP-U, IP or Ethernet payload format.\nThe CC-POI present in the SGW-U/PGW-U shall set the payload format to indicate the appropriate payload type (5 for IPv4 Packet, 6 for IPv6 Packet, 7 for Ethernet frame or 12 for GTP-U Packet as described in ETSI TS 103 221-2 [8] clauses 5.4 and 5.4.13.\nIf handover of the entire GTP-U packet is required over LI_HI3 (see clause 6.2.3.8), then consideration shall be made of the correct choice of LI_X3 payload type to ensure that the MDF3 has the necessary CC information. Support for delivery of LI_X3 as payload type 12 (GTP-U packet) is mandatory.\nWhen an xIRI is received over LI_X2 from the IRI-POI in the SGW/PGW or ePDG, the MDF2 shall generate the corresponding IRI message and deliver it over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received in the xIRI over LI_X2.\nWhen option 2 specified in clause 6.3.1 is used, the MDF2 shall generate IRI messages based on the proprietary information received from the SGW/PGW or ePDG and provide it over LI_HI2 without undue delay.\nThe IRI messages shall include an IRI payload encoded according to clause 10.5 and TS 33.108 [12] Annex B.9. The MDF2 shall encode the correct value of LIID in the IRI message, replacing the value \"LIIDNotPresent\" given in the xIRI (see clause 6.3.2.2).\nThe IRI messages shall be delivered over LI_HI2 according to ETSI TS 102 232-7 [10] clause 10.\nWhen xCC is received over LI_X3 from the CC-POI in the SGW/PGW or ePDG, the MDF3 shall generate the corresponding CC and deliver it over LI_HI3 without undue delay. The CC message shall contain a copy of the relevant xCC received over LI_X3.\nWhen option 2 specified in clause 6.3.1 is used, the MDF3 shall generate CC based on the proprietary information received from the SGW/PGW or ePDG and provide it over LI_HI3 without undue delay.\nThe CC shall include a CC payload encoded according to TS 33.108 [12] Annex B.10.\nThe CC shall be delivered over LI_HI3 according to ETSI TS 102 232-7 [10] clause 10.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.3.3.1-1: ActivateTask message for the IRI-POI and CC-POI in the SGW/PGW and ePDG in non-CUPS architecture",
                                    "table number": 147,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3.1-2: ActivateTask message for the IRI-POI, CC-TF and IRI-TF in the SGW-C/PGW-C in CUPS architecture",
                                    "table number": 148,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3.1-3: ActivateTask message for MDF2",
                                    "table number": 149,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3.1-4: Mediation Details for MDF2",
                                    "table number": 150,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3.1-5: ActivateTask message for MDF3",
                                    "table number": 151,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3.1-6: Mediation Details for MDF3",
                                    "table number": 152,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-1: Payload for ePSPDNConnectionEstablishment Field",
                                    "table number": 153,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-2: Payload for bearerContextsCreated Field",
                                    "table number": 154,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-3: Payload for bearerContextsMarkedForRemoval Field",
                                    "table number": 155,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-4: Payload for protocolConfigurationOptions Field",
                                    "table number": 156,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-5: Payload for fiveGSInterworkingInfo Field",
                                    "table number": 157,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-6: Payload for ePSGTPTunnels Field",
                                    "table number": 158,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-7: Payload for bearerQOS Field",
                                    "table number": 159,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-8: Payload for ePSPDNConnectionModification parameter",
                                    "table number": 160,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-9: Structure of the EPSBearerContextModified type",
                                    "table number": 161,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-10: Structure of the EPSBearersDeleted type",
                                    "table number": 162,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-11: Structure of the EPSDeleteBearerResponse type",
                                    "table number": 163,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-12: Structure of the EPSDeleteBearerContext type",
                                    "table number": 164,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-13: Payload for ePSPDNConnectionRelease field",
                                    "table number": 165,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.3.3-14: Payload for ePSStartOfInterceptionWithEstablishedPDNConnection field",
                                    "table number": 166,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "6.4\t3G",
                    "description": "",
                    "summary": "",
                    "text_content": "The Present document does not specify details of the LI interfaces for 3G / UMTS. Details for this release are specified in TS 33.108 [12].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "7\tService Layer Based Interception",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause describes any remaining fields, behaviours or details necessary to implement the required LI interfaces for specific 3GPP-defined services which are not described in clauses 4 and 5.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tCentral Subscriber Management",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.2.1\tGeneral description",
                            "text_content": "This clause describes interception at central subscriber management functions or databases (e.g. UDM and HSS).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.2\tLI at UDM",
                            "text_content": "In 3GPP network, the UDM provides the unified data management for UE. The UDM shall have LI capabilities to generate the target UE’s service area registration and subscription management related xIRI.\nThe IRI-POI present in the UDM is provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nThe POI in the UDM shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages:\n-\tSUPIIMSI.\n-\tSUPINAI.\n-\tPEIIMEI.\n-\tPEIIMEISV.\n-\tGPSIMSISDN.\n-\tGPSINAI.\nThe IRI-POI present in the UDM shall send xIRI over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.2.2.4, the details of which are described in the following clauses.\nThe IRI-POI in the UDM shall generate an xIRI containing the UDMServingSystemMessage record when it detects the following events:\n-\tWhen the UDM receives the amf3GPPAccessRegistration from the AMF as part of the Nudm_UEContextManagement_Registration service operation (see TS 29.503 [25] clause 5.3.2.2.2).\n-\tWhen the UDM receives the amfNon3GPPAccessRegistration from the AMF as part of the Nudm_UEContextManagement_Registration service operation (see TS 29.503 [25] clause 5.3.2.2.3).\nWhen a target UE registers to both 3GPP and non-3GPP access, two separate xIRIs each containing the UDMServingSystemMessage record may be generated by the IRI-POI in the UDM.\nTable 7.2.2.3-1: Payload for UDMServingSystemMessage record\n\nNOTE 1:\tGUAMI is the global unique identifier of an AMF [2] and its format is defined in TS 29.571 [17]. As defined in TS 23.501 [2] clause 5.9.4, GUAMI consists of <MCC> <MNC> <AMF Region ID> <AMF Set ID> <AMF Pointer>. The GUAMI is reported if the UDM receives the same from the AMF.\nNOTE 2:\tGUMMEI is the global unique identifier of an MME and its format is defined in TS 23.003 [19]. As defined in TS 23.003 [19] clause 2.8.1, GUMMEI consists of <MCC> <MNC> <MME Identifier>. The GUMMEI is reported if the UDM has this information (e.g. in a combined UDM/HSS).\nNOTE 3:\tPLMN Id provides the VPLMN Id when the target UE is roaming.\nNOTE 4:\tThis identifies whether the xIRI containing the UDMServingSystemMessage record is generated due to the reception of an amf3GPPAccessRegistration, or an amfNon3GPPAccessRegistration. See TS 29.503 [25].\nTS 29.571 [17] requires that the encoding of 3GPP defined identifiers (e.g. IMSI, NAI) shall be prefixed with its corresponding prefix (e.g. with reference to SUPI it requires 'imsi-','nai-'). However, identifiers and parameters shall be coded over the LI_X2 and LI_HI2 according to Annex A of the present document, so without the prefix specified in TS 29.571 [17].\nThe IRI-POI present in the UDM generating an xIRI containing an UDMServingSystemMessage record shall set the Payload Direction field in the PDU header to not applicable (Direction Value 5, see ETSI TS 103 221-2 [8] clause 5.2.6).\nThe IRI-POI in the UDM shall generate an xIRI containing the UDMSubscriberRecordChangeMessage record when it detects the following events:\n-\tWhen the UDM receives the Amf3GppAccessRegistration from the AMF as part of the Nudm_UEContextManagement Registration service operation (see TS 29.503 [25] clause 5.3.2.2.2) and detects a change in the SUPI/GPSI/PEI association for a target.\n-\tWhen the UDM receives the AmfNon3GppAccessRegistration from the AMF as part of the Nudm_UEContextManagement Registration service operation (see TS 29.503 [25] clause 5.3.2.2.3) and detects a change in the SUPI/GPSI/PEI association for a target.\n-\tWhen the UDM receives the Amf3GppAccessRegistrationModification from the AMF as part of Nudm_UEContextManagement Update service operation (see TS 29.503 [25] clause 5.3.2.6.2) and detects a change in the SUPI/GPSI/PEI association for a target.\n-\tWhen the UDM receives the AmfNon3GppAccessRegistrationModification from the AMF as part of Nudm_UEContextManagement Update service operation (see TS 29.503 [25] clause 5.3.2.6.3) and detects a change in the SUPI/GPSI/PEI association for a target.\n-\tWhen the UDM receives the PeiUpdateInfo from the HSS as part of the Nudm_UEContextManagement PEI Update service operation (see TS 29.503 [25] clause 5.3.2.10.2) and detects a change in the SUPI/GPSI/PEI association for a target.\n-\tUpon detection of modification between SUPI and GPSI association (if UDR is deployed, when UDM receives the DataChangeNotify from the UDR including the modified GPSI as part of the Nudr_DataRepository Notification service operation (see TS 29.504 [48] clause 5.2.2.8.3 and TS 29.505 [49] clause 5.4.2.6); if UDR is not deployed, when the modification is detected as result of UDM provisioning).\n-\tUpon UE de-provisioning (if UDR is deployed, when UDM receives the DataChangeNotify from the UDR including the deleted SUPI as part of the Nudr_DataRepository Notification service operation (see TS 29.504 [48] clause 5.2.2.8.3 and TS 29.505 [49] clause 5.4.2.6); if UDR is not deployed, when the modification is detected as result of UDM deprovisioning).\n-\tWhen a new SUPI is provisioned (if UDR is deployed, when UDM receives the DataChangeNotify from the UDR including the new and the old SUPI as part of the Nudr_DataRepository Notification service operation (see TS 29.504 [48] clause 5.2.2.8.3 and TS 29.505 [49] clause 5.4.2.6); if UDR is not deployed, when the modification is detected as result of UDM provisioning).\n-\tWhen the UDM receives the Amf3GppAccessRegistrationModification from the AMF as part of Nudm_UEContextManagement Update service operation (see TS 29.503 [25] clause 5.3.2.2.2) and detects a change in the ServiceID association for a target.\n-\tUpon detection of modification in the Service ID association (if UDR is deployed, when UDM receives the DataChangeNotify from the UDR including the modified Service ID as part of the Nudr_DataRepository Notification service operation (see TS 29.504 [48] clause 5.2.2.8.3 and TS 29.505 [49] clause 5.4.2.6); if UDR is not deployed, when the modification is detected as a result of UDM provisioning.\nWhen a target UE registers to both 3GPP and non-3GPP access, two separate xIRIs each containing the UDMSubscriberRecordChangeMessage report record may be generated by the IRI-POI in the UDM.\nTable 7.2.2.3-2: Payload for UDMSubscriberRecordChangeMessage record\n\nNOTE 1:\tWhen an identity is changed, both the old one and the current one are reported; the target identity is always reported either as current identity or old identity depending on the change, together with the other current identities (e.g. ServiceIDs), if available. If the target identity is changed, the old identity represents the target otherwise the current identity represents the target (as examples, when SUPI is the target and PEI is changing, SUPI (target), PEI and old PEI, along with GPSI, if available, are reported; when SUPI is the target and SUPI is changed, SUPI and oldSUPI (target), along with PEI and GPSI, if available, are reported).\nNOTE 2:\tThis identifies whether the xIRI containing the UDMSubscriberRecordChangeMessage record is generated due to a PEI change, a GPSI, a SUPI modification or ServiceID change, or a UE de-provisioning.\nThe IRI-POI present in the UDM generating an xIRI containing an UDMSubscriberRecordChangeMessage record shall set the Payload Direction field in the PDU header to not applicable (Direction Value 5, see ETSI TS 103 221-2 [8] clause 5.2.6).\nTS 29.571 [17] requires that the encoding of 3GPP defined identifiers (e.g. IMSI, NAI) shall be prefixed with its corresponding prefix (e.g. with reference to SUPI it requires 'imsi-','nai-'). However, identifiers and parameters shall be coded over the LI_X2 and LI_HI2 according to Annex A of the present document, so without the prefix specified in TS 29.571 [17].\nThe IRI-POI in the UDM shall generate an xIRI containing the UDMCancelLocation record when it detects the following events:\n-\tWhen the UDM sends DeregistrationData to AMF as part of the Nudm_UEContextManagement DeregistrationNotification service operation (see TS 29.503 [25] clause 5.3.2.3.2) (e.g. to cancel location retrieval operations).\n-\tWhen the UDM receives the Amf3GppAccessRegistrationModification with purgeFlag set to true from the AMF as part of Nudm_UEContextManagement Deregistration service operation (see TS 29.503 [25] clause 5.3.2.4.2).\n-\tWhen UDM receives the AmfNon3GppAccessRegistrationModification with purgeFlag set to true from the AMF as part of Nudm_UEContextManagement Deregistration service operation (see TS 29.503 [25] clause 5.3.2.4.3).\nWhen a target UE deregisters from both 3GPP and non-3GPP access, two separate xIRIs each containing the UDMCancelLocation report record may be generated by the IRI-POI in the UDM.\nNOTE:\tInvocation of the Nudm_UEContextManagement Deregistration service operation in the case of UE deregistration is an implementation option (see TS 23.502 [4], clause 4.5.3). Consequently, the UDMCancel Location xIRI in such case is only generated if this option is supported by the serving network.\nTable 7.2.2.3.4-1: Payload for UDMCancelLocationMessage record\n\nNOTE 1:\tGUAMI is the global unique identifier of an AMF [2] and its format is defined in TS 29.571 [17]. As defined in TS 23.501 [2] clause 5.9.4, GUAMI consists of <MCC> <MNC> <AMF Region ID> <AMF Set ID> <AMF Pointer>. The GUAMI is reported if the UDM receives the same from the AMF.\nNOTE 2:\tPLMN ID provides the vPLMN ID when the target UE is roaming.\nNOTE 3:\tThis identifies whether the xIRI containing the UDMCancelLocationMessage record is generated due to the reception of a UDM deregistration, and AMF 3GPP Access deregistration, or an AMF Non 3GPP access deregistration.\nThe IRI-POI present in the UDM generating an xIRI containing an UDMCancelLocationMessage record shall set the Payload Direction field in the PDU header to not applicable (Direction Value 5, see ETSI TS 103 221-2 [8] clause 5.2.6).\nTS 29.571 [17] requires that the encoding of 3GPP defined identifiers (e.g. IMSI, NAI) shall be prefixed with its corresponding prefix (e.g. with reference to SUPI it requires 'imsi-','nai-'). However, identifiers and parameters shall be coded over the LI_X2 and LI_HI2 according to Annex A of the present document, so without the prefix specified in TS 29.571 [17].\nLocation information request is not supported in the present document.\nThe IRI-POI in the UDM shall generate an xIRI containing the UDMLocationInformationResult record when it detects the following events:\n-\tWhen UDM receives the LocationInfoRequest from an NF service consumer (i.e. HSS) as part of Nudm_MT_ProvideLocationInfo service operation (see TS 29.503 [25], clause 6.7.6.2.3) and the UDM sends the LocationInfoResult as part of Nudm_MT_ProvideLocationInfo service operation (see TS 29.503 [25], clause 6.7.6.2.4).\nWhen a target UE is registered to both 3GPP and non-3GPP access, two separate xIRIs each containing the LocationInfoResult report record may be generated by the IRI-POI in the UDM.\nTable 7.2.2.3.6-1: Payload for UDMLocationInformationResult record\n\nTable 7.2.2.3.6-2: Payload for LocationInfoRequest parameter\n\nNOTE:\tThe absence of one or more of the parameters in table 7.2.2.3.6-2 assumes that it was not included in the LocationInfoRequest.\nThe IRI-POI in the UDM shall generate an xIRI containing the UDMUEInfromationResponse record when it detects the following events:\n-\tWhen the UDM receives the ProvideUeInfo GET request from the NF service consumer as part of Nudm_MT_ProvideUeInfo service operation (see TS 29.503 [25], clause 6.7.6.2.2) and the UDM returns a UeInfo response.\nTable 7.2.2.3.7-1: Payload for UDMUEInformationResponse record\n\nThe IRI-POI in the UDM shall generate an xIRI containing the UDMUEAuthenticationResponse record when it detects the following events:\n-\tWhen the UDM receives the AuthenticationInfoRequest from the AUSF as part of Nudm_UEAuthentication service operation (see TS 29.503 [25], clause 6.3.6.2.2) and the UDM sends the AuthenticationInfoResult to the AUSF as part of the Nudm_UEAuthentication service operation (see TS 29.503 [25], clause 6.3.6.2.3).\n-\tWhen the UDM receives the HSSAuthenticationInfoRequest from the HSS as part of the Nudm_UEAuthentication service operation (see TS 29.503 [25], clause 6.3.6.2.10) and the UDM sends the HSSAuthenticationInfoResult to the AUSF as part of the Nudm_UEAuthentication service operation (see TS 29.503 [25], clause 6.3.6.2.11).\nWhen a target UE registers from both 3GPP and non-3GPP access, two separate xIRIs each containing the UDMUEAuthentication report record may be generated by the IRI-POI in the UDM.\nTable 7.2.2.3.8-1: Payload for UDMUEAuthenticationResponse record\n\nTable 7.2.2.3.8-2: Payload for UDMAuthenticationInfoRequest parameter\n\nThe IRI-POI in the UDM shall generate an xIRI containing the UDMStartOfInterceptionWithRegisteredTarget record when the IRI-POI present in the UDM detects that interception is activated for a UE that has already been registered in the UDM. A UE is considered registered in the UDM when the UDM has a current UE context management entry (see TS 29.503 [25], clauses 5.3.2.2 and 6.2), over at least one access type.\nWhen a target UE is registered on both 3GPP and non-3GPP access, a single UDMStartofInterceptionWithRegisteredTarget record including context information from both accesses shall be generated by the IRI-POI in the UDM.\nTable 7.2.2.3.9-1: Payload for UDMStartOfInterceptionWithRegisteredTarget record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in UDM, the MDF2 shall send an IRI message over LI_HI2 without undue delay.\nThe timestamp field of the PSHeader structure shall be set to the time that the UDM event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.2.2-4.\nTable 7.2.2-4: IRI type for IRI messages\n\nThese IRI messages shall omit the CIN (see ETSI TS 102 232-1 [9] clause 5.2.4).\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.2.2.3-1: Payload for UDMServingSystemMessage record",
                                    "table number": 167,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.2.2.3-2: Payload for UDMSubscriberRecordChangeMessage record",
                                    "table number": 168,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.2.2.3.4-1: Payload for UDMCancelLocationMessage record",
                                    "table number": 169,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.2.2.3.6-1: Payload for UDMLocationInformationResult record",
                                    "table number": 170,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.2.2.3.6-2: Payload for LocationInfoRequest parameter",
                                    "table number": 171,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.2.2.3.7-1: Payload for UDMUEInformationResponse record",
                                    "table number": 172,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.2.2.3.8-1: Payload for UDMUEAuthenticationResponse record",
                                    "table number": 173,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.2.2.3.8-2: Payload for UDMAuthenticationInfoRequest parameter",
                                    "table number": 174,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.2.2.3.9-1: Payload for UDMStartOfInterceptionWithRegisteredTarget record",
                                    "table number": 175,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.2.2-4: IRI type for IRI messages",
                                    "table number": 176,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.2.3\tLI at HSS",
                            "text_content": "The HSS provides the support functions in the mobility management, session setup and user authentication and access authorization.\nThe present document allows two options for HSS LI stage 3 interfaces:\n1. \tUse LI_X1 and LI_X2 interfaces specified below in the present document for stage 3.\n2. \tUse TS 33.107 [36] natively as defined in that document in addition to the start of intercept with target already registered at the HSS xIRI defined in clause 7.2.3.3.3 of the present document.\nIn both cases, the present document specifies the stage 3 for the LI_HI1 and LI_HI2 interfaces.\nWhen the HSS is capable of exchanging information related to the target with the UDM (e.g. via the 5G Nhss SBI), the xIRIs defined in clause 7.2.3.3 of the present document are applicable for stage 3 reporting of such events.\nThe IRI-POI present in the HSS is provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2 of the present document.\nThe IRI-POI in the HSS shall support the target identifiers specified in TS 33.107 [36]:\n-\tIMSI (using the IMSI target identifier format from ETSI TS 103 221-1 [7]).\n-\tMSISDN (using the E164Number target identifier format from ETSI TS 103 221-1 [7]).\n-\tIMEI (using the IMEI target identifier format from ETSI TS 103 221-1 [7]).\n-\tIMPU (using the IMPU target identifier format from ETSI TS 103 221-1 [7]).\n-\tIMPI (using the IMPI target identifier format from ETSI TS 103 221-1 [7]).\nThe IRI-POI present in the HSS shall send the xIRIs over LI_X2 for each of the events listed in TS 33.107 [36], the details of which are also specified in TS 33.107 [36].\nThe IRI-POI present in the HSS shall set the payload format to EpsHI2Operations.EpsIRIContent (value 14), see clause 5.3 of the present document and ETSI TS 103 221-2 [8] clause 5.4. The payload field shall contain an EpsHI2Operations.EpsIRIContent structure encoded according to TS 33.108 [12] clause B.9.\nAs the LIID may be not available at the HSS but is mandatory in EpsHI2Operations.EpsIRIContent according to TS 33.108 [12] clause B.9, its value in the lawfulInterceptionIdentifier field of the encoded PDU shall be set to the fixed string \"LIIDNotPresent\".\nWhen the HSS interworks with the UDM via the Nhss service based interfaces, the IRI-POI present in the HSS shall send xIRI over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.2.2.3 the details of which are described in the following clauses.\nThe IRI-POI in the HSS shall generate an xIRI containing the HSSServingSystemMessage record when it detects the following events:\n-\tWhen the HSS receives the Roaming Status Update from the UDM as part of the Nhss_UEContextManagement_RoamingStatusUpdate service operation (see TS 29.563 [100] clause 5.4.2.4).\nTable 7.2.3.3.2-1: Payload for HSSServingSystemMessage record\n\nThe IRI-POI in the HSS shall generate an xIRI containing the HSSStartOfInterceptionWithRegisteredTarget record when the IRI-POI present in the HSS detects that interception is activated for a UE that has already been registered at the HSS.\nThe HSS may have stored target subscription data for both EPC and IMS. In such a case, a single HSS Start of Interception with Registered Target xIRI shall be generated containing the target context.\nTable 7.2.3.3.3-1: Payload for HSSStartOfInterceptionWithRegisteredTarget record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in the HSS, the MDF2 shall generate the corresponding IRI message and deliver it over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received in the xIRI over LI_X2.\nWhen Option 2 specified in clause 7.2.3.1 above is used, the MDF2 shall generate IRI messages based on the proprietary information received from the HSS, except for the HSSStartOfInterceptionWithRegisteredTarget, and provide it over LI_HI2 without undue delay.\nThe IRI messages shall include an IRI payload encoded according to TS 33.108 [12] clause B.9. The MDF2 shall encode the correct value of LIID in the IRI message, replacing the value \"LIIDNotPresent\" given in the xIRI (see clause 7.2.3.3 above).\nThe IRI messages shall omit the CIN (see ETSI TS 102 232-1 [9] clause 5.2.4).\nThe IRI messages shall be delivered over LI_HI2 according to ETSI TS 102 232-7 [10] clause 10.\nTable 7.2.3.4-1: IRI type for IRI messages\n\nWhen an additional warrant is activated on a target and the LIPF uses the same XID for the additional warrant, the MDF2 shall be able to generate and deliver the IRI message containing the HSSStartOfInterceptionWithRegisteredTarget record to the LEMF associated with the additional warrant without receiving a corresponding xIRI. The payload of the HSSStartOfInterceptionWithRegisteredTarget record is specified in table 7.2.3.3.3-1.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.2.3.3.2-1: Payload for HSSServingSystemMessage record",
                                    "table number": 177,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.2.3.3.3-1: Payload for HSSStartOfInterceptionWithRegisteredTarget record",
                                    "table number": 178,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.2.3.4-1: IRI type for IRI messages",
                                    "table number": 179,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "7.3\tLocation",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.3.1\tLawful Access Location Services (LALS)",
                            "text_content": "The LALS architecture and functionality is specified in TS 33.127 [5] clause 7.3.3.\nFor the LALS target positioning service (TS 33.127 [5] clause 7.3.3.2) the IRI-POI provided by the LI-LCS Client is directly provisioned over LI_X1 by the LIPF using the LI_X1 protocol as described in clause 5.2.2 with the TaskDetailsExtensions field of the ActivateTask message specifying the type of the target positioning request, immediate vs. periodic, and, in the latter case, the periodicity of the positioning requests.\nBased on national regulatory requirements and CSP policy, the TaskDetailsExtensions may also include the QoS parameters (specified in OMA-TS-MLP-V3_5-20181211-C [20]) for the use on the Le interface towards the LCS Server/GMLC. Alternatively, the QoS parameters may be statically configured in the LI-LCS Client.\nTable 7.3.1.2-1 shows the details of the LI_X1 ActivateTask message used for the LI-LCS Client provisioning for the target positioning service.\nThe LI_X1 DeactivateTask shall be issued by the LIPF to terminate the target positioning service and withdraw the associated provisioning data, except for the Immediate target positioning service in which case the LI_X1 DeactivateTask is not used.\nTable 7.3.1.2-1: ActivateTask message for LI-LCS Client target positioning provisioning\n\nFor the LALS triggered location service (TS 33.127 [5] clause 7.3.3.3) the LTF, as an IRI-TF, is provisioned by the LIPF using the LI_X1 protocol as described in clause 5.2.2. The “TaskDetailsExtensions” parameter of the ActivateTask message in this case will carry the address of LI-LCS Client to be used for the service and, optionally, the positioning parameters for use on the Le interface, similar to the target positioning provisioning.\nPrior to issuing one or more \"ActivateTask\" requests towards an LTF, the LIPF shall provision the LTF with the LI_X2 destinations by using the \"CreateDestination\" operation(s), as per clause 5.2.2.\nTable 7.3.1.2-2 defines the details of the LI_X1 ActivateTask message used for the LTF provisioning for the Triggered Location service.\nTable 7.3.1.2-2: ActivateTask message for LTF triggered location service provisioning\n\nAn LTF, as an IRI-TF, provisioned as described in clause 7.3.1.2.2, triggers the LI-LCS Client (which plays the role of a triggered IRI-POI) using the LI_T2 protocol as described in clause 5.2.4. The \"TaskDetailsExtensions\" in the LI_T2 \"ActivateTask\" message carries the positioing parameters mapped from information the LTF receives from the ADMF over the LI_X1. The LI_T2 \"ActivateTask\" message header may include a correlation ID from the triggering xIRI, if available.\nPrior to issuing one or more \"ActivateTask\" requests towards an LI-LCS Client, the LTF shall provision the LI-LCS Client with the LI_X2 destinations by using the \"CreateDestination\" operation(s), as per clause 5.2.2. The LI-LCS Client shall deactivate the task on its own upon issuing the final xIRI for the trigger. There is no DeactivateTask operation on the LI_T2 for the LI-LCS Client.\nTable 7.3.1.3-1 shows the details of the LI_T2 ActivateTask message used by the LTF to trigger LI-LCS Client for the triggered location service.\nTable 7.3.1.3-1: ActivateTask message from LTF to LI-LCS Client for the triggered location service triggering\n\nThe IRI-POI provided by the LI-LCS client shall deliver the target location reports to respective MDF(s) as xIRI over the LI_X2 interface.\nTable 7.3.1.4-1: LALSReport record\n\nThe LI-LCS Client generating an xIRI containing an LALSReport record shall set the Payload Direction field in the PDU header to not applicable (Direction Value 5, see ETSI TS 103 221-2 [8] clause 5.2.6).\nThe LI_X2 header (as per clause 5.3.2) of the LALSReport record presented in table 7.3.1.4-1 shall contain the correlation ID (if provided) from a respective LI_T2 ActivationTask message.\nThe LALSReport payload, defined in clause 7.3.1.4, shall be used as the payload of the respective LALSReport record, no payload mediation is required.\nA LALSReport message shall be assigned the same CIN (see ETSI TS 102 232-1 [9] clause 5.2.4) as the IRI message that triggered the LALS reporting, if that triggering IRI message is assigned a CIN. Otherwise, i.e. when the LALSReport is a result of the LALS Target Positioning, or the triggering IRI message has no CIN assigned, the CIN in the LALSReport shall be omitted.\nNOTE:\tIn some specific scenarios the amount of LALS reports data may overload the LI_HI2 and/or LI_X2 interfaces. To prevent the overload, a flow control for LALS triggered location reports may be implemented in MDF and/or LI-LCS client, e.g. by limiting the frequency of the reports for individual targets.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.1.2-1: ActivateTask message for LI-LCS Client target positioning provisioning",
                                    "table number": 180,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.1.2-2: ActivateTask message for LTF triggered location service provisioning",
                                    "table number": 181,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.1.3-1: ActivateTask message from LTF to LI-LCS Client for the triggered location service triggering",
                                    "table number": 182,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.1.4-1: LALSReport record",
                                    "table number": 183,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.2\tCell database information reporting",
                            "text_content": "When the location information present within an xIRI includes the cell identity, the MDF2 that receives the xIRI may retrieve the cell site information and associated cell radio related information for that cell from a CSP database and deliver the same to the LEMF either within the IRI message generated from the received xIRI or in a separate IRI message containing the MDFCellSiteReport record.\nFor each intercept, if the MDF2 reports the cell site information, then it shall provide such information at least on the initial appearance of the cell identity in the related xIRI.\nNOTE:\tThe CSP needs to ensure that the most recent cell site information is reported to the LEA.\nIf the reported cell site information is for a cell with mobility, the MDF2 should report the current information (e.g. physical location of the cell) with every related xIRI.\nThe cell site information is encoded as the cellSiteInformation ASN.1 parameter and delivered either within the location field of an IRI message carrying the respective cell identity, or in a stand-alone IRI message containing the MDFCellSiteReport record.\nThe cell radio related information is encoded as the cellRadioRelatedInformation ASN.1 parameter and delivered with the cell information parameter.\nThe MDF2 shall use the IRI message containing the MDFCellSiteReport record to convey cell site information and cell radio related information retrieved asynchronously with the sending of the IRI message that caused the retrieval. The MDFCellSiteReport record shall be delivered as an IRI REPORT (see ETSI TS 102 232-1 [9] clause 5.2.10) and allocated the same CIN, if any, as the IRI message that caused the retrieval.\nWhen the cell site information and cell radio related information are readily available at MDF2 or are retrieved synchronously (i.e. blocking the sending of the IRI message until the retrieval is complete), the cell site information shall be conveyed within the location field of the IRI message that caused the retrieval.\nThe cell site information and associated cell radio related information for multiple cell identities can be delivered to the LEMF within an IRI message that carries the respective cell identities or within the IRI message containing the MDFCellSiteReport record (see Annex A).\nThe MDF2 generating the IRI message MDFCellSiteReport shall set the Payload Direction field in the PDU header to not applicable (Direction Value 5, see ETSI TS 103 221-2 [8] clause 5.2.6).\nThe MDFCellSiteReport consists of a sequence of cellInformation as described in the following tables.\nTable 7.3.2.2-1: Payload for CellInformation Parameter\n\nTable 7.3.2.2-2: Payload for CellSiteInformation Parameter\n\nTable 7.3.2.2-3: Definition of Choices for CellRadioRelatedInformation Parameter\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.2.2-1: Payload for CellInformation Parameter",
                                    "table number": 184,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.2.2-2: Payload for CellSiteInformation Parameter",
                                    "table number": 185,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.2.2-3: Definition of Choices for CellRadioRelatedInformation Parameter",
                                    "table number": 186,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.3\tUse of the Location structure",
                            "text_content": "The Location structure (see Annex A) is used to convey access network location information and geolocation information. While the data types defined in the clauses below are generally modelled on data types from the Service Based Interfaces (SBIs) defined for specific NFs, the data types defined below shall be used by any POI in order to send all location information available at the NF where the POI is located.\nWhen location information is reported, unless otherwise specified, all location information present at the NF for the target shall be reported. If a single parameter within the Location type is unable to carry all the types of location information available at the NF, multiple parameters within the Location type shall be used.\nTable 7.3.3.2.1-1: Simple Types for Location\n\nTable 7.3.3.2.2-1 contains the details for the Location type.\nTable 7.3.3.2.2-1: Definition of type Location\n\nThe LocationInfo type is derived from the data present in the ProvideLocInfo type (see TS 29.518 [22] clause 6.4.6.2.6). If the NF has locations from multiple RAT types, all appropriate location fields within the userLocation parameter shall be used.\nTable 7.3.3.2.3-1 contains the details for the LocationInfo type.\nTable 7.3.3.2.3-1: Definition of type LocationInfo\n\nThe UserLocation type is derived from the data present in the UserLocation type defined in TS 29.571 [17] clause 5.4.4.7. If the NF has locations from multiple RAT types, all appropriate location fields within the userLocation parameter shall be used.\nTable 7.3.3.2.4-1 contains the details for the UserLocation type.\nTable 7.3.3.2.4-1: Definition of type UserLocation\n\nThe EUTRALocation type is derived from the data present in the EutraLocation type defined in TS 29.571 [17] clause 5.4.4.8.\nTable 7.3.3.2.5-1 contains the details for the EUTRALocation type.\nTable 7.3.3.2.5-1: Definition of type EUTRALocation\n\nThe NRLocation type is derived from the data present in the NrLocation type defined in TS 29.571 [17] clause 5.4.4.9.\nTable 7.3.3.2.6-1 contains the details for the NRLocation type.\nTable 7.3.3.2.6-1: Definition of type NRLocation\n\nThe N3GALocation type is derived from the data present in the N3gaLocation type defined in TS 29.571 [17] clause 5.4.4.10.\nTable 7.3.3.2.7-1 contains the details for the N3GALocation type.\nTable 7.3.3.2.7-1: Definition of type N3GALocation\n\nThe UTRALocation type is derived from the data present in the EutraLocation type defined in TS 29.571 [17] clause 5.4.4.52.\nTable 7.3.3.2.8-1 contains the details for the UTRALocation type.\nTable 7.3.3.2.8-1: Definition of type UTRALocation\n\nThe GERALocation type is derived from the data present in the GeraLocation type defined in TS 29.571 [17] clause 5.4.4.53.\nTable 7.3.3.2.9-1 contains the details for the GERALocation type.\nTable 7.3.3.2.9-1: Definition of type GERALocation\n\nThe GeographicArea type is derived from the data present in the GeographicArea type defined in TS 29.572 [24] clause 6.1.6.2.5.\nTable 7.3.3.2.10-1 contains the details for the GeographicArea type.\nTable 7.3.3.2.10-1: Definition of Choices for GeographicArea\n\nThe Point type is derived from the data present in the Point type defined in TS 29.572 [24] clause 6.1.6.2.6.\nTable 7.3.3.2.11-1 contains the details for the Point type.\nTable 7.3.3.2.11-1: Definition of type Point\n\nThe GeographicalCoordinates type is derived from the data present in the GeographicalCoordinates type defined in TS 29.572 [24] clause 6.1.6.2.4.\nTable 7.3.3.2.12-1 contains the details for the GeographicalCoordinates type.\nTable 7.3.3.2.12-1: Definition of type GeographicalCoordinates\n\nThe PointUncertaintyCircle type is derived from the data present in the PointUncertaintyCircle type defined in TS 29.572 [24] clause 6.1.6.2.7.\nTable 7.3.3.2.13-1 contains the details for the PointUncertaintyCircle type.\nTable 7.3.3.2.13-1: Definition of type PointUncertaintyCircle\n\nThe PointUncertaintyEllipse type is derived from the data present in the PointUncertaintyEllipse type defined in TS 29.572 [24] clause 6.1.6.2.8.\nTable 7.3.3.2.14-1 contains the details for the PointUncertaintyEllipse type.\nTable 7.3.3.2.14-1: Definition of type PointUncertaintyEllipse\n\nThe UncertaintyEllipse type is derived from the data present in the UncertaintyEllipse type defined in TS 29.572 [24] clause 6.1.6.2.22.\nTable 7.3.3.2.15-1 contains the details for the UncertaintyEllipse type.\nTable 7.3.3.2.15-1: Definition of type UncertaintyEllipse\n\nThe Polygon type is derived from the data present in the Polygon type defined in TS 29.572 [24] clause 6.1.6.2.9.\nTable 7.3.3.2.16-1 contains the details for the Polygon type.\nTable 7.3.3.2.16-1: Definition of type Polygon\n\nThe PointAltitude type is derived from the data present in the PointAltitude type defined in TS 29.572 [24] clause 6.1.6.2.10.\nTable 7.3.3.2.17-1 contains the details for the PointAltitude type.\nTable 7.3.3.2.17-1: Definition of type PointAltitude\n\nThe PointAltitudeUncertainty type is derived from the data present in the PointAltitudeUncertainty type defined in TS 29.572 [24] clause 6.1.6.2.11.\nTable 7.3.3.2.18-1 contains the details for the PointAltitudeUncertainty type.\nTable 7.3.3.2.18-1: Definition of type PointAltitudeUncertainty\n\nThe EllipsoidArc type is derived from the data present in the EllipsoidArc type defined in TS 29.572 [24] clause 6.1.6.2.12.\nTable 7.3.3.2.19-1 contains the details for the EllipsoidArc type.\nTable 7.3.3.2.19-1: Definition of type EllipsoidArc\n\nThe RATType type is derived from the data present in the RATType type defined in TS 29.571 [17] clause 5.4.3.2.\nTable 7.3.3.2.20-1 contains the details for the RATType type.\nTable 7.3.3.2.20-1: Enumeration for RATType\n\nTable 7.3.2.2-1 contains the details for the CellInformation type.\nTable 7.3.3.2.21-1: Void\nTable 7.3.3.2.22-1 contains the details for the RANCGI type.\nTable 7.3.3.2.22-1: Definition of Choices for RANCGI\n\nThe TAI type is used to report the Tracking Area Identity. The TAI type is derived from the data present in the EutraLocation type defined in TS 29.571 [17] clause 5.4.4.3.\nTable 7.3.3.2.23-1 contains the details for the TAI type.\nTable 7.3.3.2.23-1: Definition of type TAI\n\nThe ECGI type is used to report the E-UTRA Cell Identity. The ECGI type is derived from the data present in the ECGI type defined in TS 29.571 [17] clause 5.4.4.5.\nTable 7.3.3.2.24-1 contains the details for the ECGI type.\nTable 7.3.3.2.24-1: Definition of type ECGI\n\nThe GlobalRANNodeID type is derived from the data present in the GlobalRANNodeID type defined in TS 29.571 [17] clause 5.4.4.28.\nTable 7.3.3.2.25-1 contains the details for the GlobalRANNodeID type.\nTable 7.3.3.2.25-1: Definition of type GlobalRANNodeID\n\nThe ANNodeID type is derived from the data present in the GlobalRANNodeID type defined in TS 29.571 [17] clause 5.4.4.28.\nTable 7.3.3.2.26-1 contains the details for the ANNodeID type.\nTable 7.3.3.2.26-1: Choices for ANNodeID\n\nThe nGENbID type is derived from the data present in the NgeNbId type defined in TS 29.571 [17] table 5.4.2-1.\nTable 7.3.3.2.27-1 contains the details for the NGENbID type.\nTable 7.3.3.2.27-1: Definition of type NGENbID\n\nThe NCGI type is used to report the NR Cell Identity. The NCGI type is derived from the data present in the NCGI type defined in TS 29.571 [17] clause 5.4.4.6.\nTable 7.3.3.2.28-1 contains the details for the NCGI type.\nTable 7.3.3.2.28-1: Definition of type NCGI\n\nThe IPAddr type is used to report IP Addresses.\nTable 7.3.3.2.29-1 contains the details for the IPAddr type.\nTable 7.3.3.2.29-1: Definition of type IPAddr\n\nThe TNAPID type is used to report the TNAP Identity. The TNAPID type is derived from the data present in the TnapId type defined in TS 29.571 [17] clause 5.4.4.62.\nTable 7.3.3.2.30-1 contains the details for the TNAPID type.\nTable 7.3.3.2.30-1: Definition of type TNAPID\n\nThe TWAPID type is used to report the TWAP Identity. The TWAPID type is derived from the data present in the TwapId type defined in TS 29.571 [17] clause 5.4.4.63.\nTable 7.3.3.2.31-1 contains the details for the TWAPID type.\nTable 7.3.3.2.31-1: Definition of type TWAPID\n\nThe W5GBANLineType indicates the type of wireline access used connect to the 5GS. The W5GBANLineType type is derived from the data present in the LineType type defined in TS 29.571 [17] clause 5.4.3.33.\nTable 7.3.3.2.32-1 contains the details for the W5GBANLineType type.\nTable 7.3.3.2.32-1: Enumeration W5GBANLineType\n\nThe TransportProtocol indicates the transport protocol used to connect to the 5GS. The TransportProtocol type is derived from the data present in the TransportProtocol type defined in TS 29.571 [17] clause 5.4.4.10 and table 5.4.3.38.\nTable 7.3.3.2.33-1 contains the details for the clause TransportProtocol type.\nTable 7.3.3.2.33-1: Enumeration TransportProtocol Type\n\nThe PLMNID type is used to report the PLMN Identity. The PLMNID type is derived from the data present in the PlmnId type defined in TS 29.571 [17] clause 5.4.4.3.\nTable 7.3.3.2.34-1 contains the details for the PLMNID type.\nTable 7.3.3.2.34-1: Definition of type PLMNID\n\nThe ENbID type is used to report the ENb Identity. The ENbID type is derived from the data present in the ENbId type defined in TS 29.571 [17] clause 5.4.2.\nTable 7.3.3.2.35-1 contains the details for the ENbID type.\nTable 7.3.3.2.35-1: Definition of type ENbID\n\n\nThe PositioningInfo type is derived from the data present in the ProvidePosInfo type defined in TS 29.518 [22] clause 6.4.6.2.3.\nTable 7.3.3.2.36-1 contains the details for the PositioningInfo type.\nTable 7.3.3.2.36-1: Definition of type PositioningInfo\n\nThe LocationData type is derived from the data present in the LocationData type defined in TS 29.572 [24] clause 6.1.6.2.3.\nTable 7.3.3.2.37-1 contains the details for the LocationData type.\nTable 7.3.3.2.37-1: Definition of type LocationData\n\n\nThe RawMLPResponse type is derived from the data present in the slia MLP message described in OMA-TS-MLP-V3_5-20181211-C [20], clause 5.2.3.2.2 or the slirep MLP message described in OMA-TS-MLP-V3_5-20181211-C [20], clause 5.2.3.2.3 along with the OMA MLP result id defined in OMA-TS-MLP-V3_5-20181211-C [20], Clause 5.4\nTable 7.3.3.2.38-1 contains the details for the RawMLPResponse type.\nTable 7.3.3.2.38-1: Choices for type RawMLPResponse\n\nThe VelocityEstimate type is derived from the data present in VelocityEstimate type in TS 29.572 [24] clause 6.1.6.2.17\nTable 7.3.3.2.39-1 contains the details for the VelocityEstimate type.\nTable 7.3.3.2.39-1: Definition of type VelocityEstimate\n\nThe CivicAddress type is derived from the data present in the CivicAddress type defined in TS 29.572 [24] clause 6.1.6.2.14.\nTable 7.3.3.2.40-1 contains the details for the CivicAddress type.\nTable 7.3.3.2.40-1: Definition of type CivicAddress\n\nThe PositioningMethodAndUsage type is derived from the data present in the PositioningMethodAndUsage type defined in TS 29.572 [24] clause 6.1.6.2.15.\nTable 7.3.3.2.41-1 contains the details for the PositioningMethodAndUsage type.\nTable 7.3.3.2.41-1: Definition of type PositioningMethodAndUsage\n\nThe GNSSPositioningMethodAndUsage type is derived from the data present in the GNSSPositioningMethodAndUsage type defined in TS 29.572 [24] clause 6.1.6.2.16.\nTable 7.3.3.2.42-1 contains the details for the GNSSPositioningMethodAndUsage type.\nTable 7.3.3.2.42-1: Definition of type GNSSPositioningMethodAndUsage\n\nThe HorizontalVelocity type is derived from the data present in the HorizontalVelocity type defined in TS 29.572 [24] clause 6.1.6.2.18.\nTable 7.3.3.2.43-1 contains the details for the HorizontalVelocity type.\nTable 7.3.3.2.43-1: Definition of type HorizontalVelocity\n\nThe HorizontalWithVerticalVelocity type is derived from the data present in the HorizontalWithVerticalVelocity type defined in TS 29.572 [24] clause 6.1.6.2.19.\nTable 7.3.3.2.44-1 contains the details for the HorizontalWithVerticalVelocity type.\nTable 7.3.3.2.44-1: Definition of type HorizontalWithVerticalVelocity\n\nThe HorizontalVelocityWithUncertainty type is derived from the data present in the HorizontalVelocityWithUncertainty type defined in TS 29.572 [24] clause 6.1.6.2.20.\nTable 7.3.3.2.45-1 contains the details for the HorizontalVelocityWithUncertainty type.\nTable 7.3.3.2.45-1: Definition of type HorizontalVelocityWithUncertainty\n\nThe HorizontalWithVerticalVelocityAndUncertainty type is derived from the data present in the HorizontalWithVerticalVelocityAndUncertainty type defined in TS 29.572 [24] clause 6.1.6.2.21.\nTable 7.3.3.2.46-1 contains the details for the HorizontalWithVerticalVelocityAndUncertainty type.\nTable 7.3.3.2.46-1: Definition of type HorizontalWithVerticalVelocityAndUncertainty\n\nThe LocationPresenceReport type is used in the case the information is obtained from an AmfEventReport (TS 29.518 [22] clause 6.2.6.2.5) with event type Location_Report or Presence_In_AOI_Report.\nTable 7.3.3.2.47-1 contains the details for the LocationPresenceReport type.\nTable 7.3.3.2.47-1: Definition of type LocationPresenceReport\n\nThe AMFEventArea type is derived from the data present in the AMFEventArea type defined in TS 29.518 [22] clause 6.2.6.2.16.\nTable 7.3.3.2.48-1 contains the details for the AMFEventArea type.\nTable 7.3.3.2.48-1: Definition of type AMFEventArea\n\nThe RMInfo type is derived from the data present in the RMInfo type defined in TS 29.518 [22] clause 6.2.6.2.8.\nTable 7.3.3.2.49-1 contains the details for the RMInfo type.\nTable 7.3.3.2.49-1: Definition of type RMInfo\n\nThe CMInfo type is derived from the data present in the CMInfo type defined in TS 29.518 [22] clause 6.2.6.2.9.\nTable 7.3.3.2.50-1 contains the details for the CMInfo type.\nTable 7.3.3.2.50-1: Definition of type CMInfo\n\nThe AccuracyFulfilmentIndicator indicates wheather the requested accuracy was fulfilled or not the AccuracyFulfilmentIndicator is derived from the data present in the AccuracyFulfilmentIndicator type defined in TS 29.572 [24] clause 6.1.6.3.12.\nTable 7.3.3.2.51-1 contains the details of the AccuracyFulfilmentIndicator type.\nTable 7.3.3.2.51-1: Enumeration for AccuracyFulfilmentIndicator\n\nThe PositioningMethod represents the method used to determine the location of the UE, the PositioningMethod is derived from the data present in the PositioningMethod type defined in TS 29.572 [24] clause 6.1.6.3.6.\nTable 7.3.3.2.52-1 contains the details of the PositioningMethod type.\nTable 7.3.3.2.52-1: Enumeration for PositioningMethod\n\nThe PositioningMode represents the mode used to determine the location of the UE when a certain positioning method is used, the PositioningMode is derived from the data present in the PositioningMode type defined in TS 29.572 [24] clause 6.1.6.3.7.\nTable 7.3.3.2.53-1 contains the details of the PositioningMode type.\nTable 7.3.3.2.53-1: Enumeration for PositioningMode\n\n\nThe GNSSID represents the different global navigation satellite systems, the GNSSID is derived from the data present in the GNSSID type defined in TS 29.572 [24] clause 6.1.6.3.8.\nTable 7.3.3.2.54-1 contains the details of the GNSSID type.\nTable 7.3.3.2.54-1: Enumeration for GNSSID\n\nThe Usage represents the type of usage made of the location measurement from the UE, the Usage is derived from the data present in the Usage type defined in TS 29.572 [24] clause 6.1.6.3.9.\nTable 7.3.3.2.55-1 contains the details of the Usage type.\nTable 7.3.3.2.55-1: Enumeration for GNSSID\n\nThe VerticalDirection represents the direction (upward/downward) of the vertical speed, the VerticalDirection is derived from the data present in the VerticalDirection type defined in TS 29.572 [24] clause 6.1.6.3.13.\nTable 7.3.3.2.56-1 contains the details of the VerticalDirection type.\nTable 7.3.3.2.56-1: Enumeration for VerticalDirection\nThe IMSLocation type is used to report information derived from the IMS.\nTable 7.3.3.2.57-1: Structure of the IMSLocation type\n\nThe PANIHeaderInfo type is used to report information derived from the P-Access-Network-Information header field of the SIP Message (see TS 24.229 [74] clauses 7.2A.4.2 and 7.2A.4.3).\nTable 7.3.3.2.58-1: Structure of the PANIHeaderInfo type\n\nThe SIPGeolocationHeaderInfo type is used to report information derived from the Geolocation-header of a SIP message.\nTable 7.3.3.2.59-1: Structure of the SIPGeolocationHeader type\n\nThe SIPLocationInfo type is used to report location information derived from the P-Access-Network-Information or Cellular-Network-Info header of a SIP message.\nTable 7.3.3.2.60-1: Structure of the SIPLocationInfo type\n\nThe SIPCellularLocationInfo type is used to report cellular access network information derived from the Cellular-Network-Info (CNI) header of a SIP message (see TS 24.229 [74] clause 7.2.15.7).\nTable 7.3.3.2.60-1: Structure of the SIPCNIHeaderInfo type\n\nThe PresenceInfo type is derived from the data present in the PresenceInfo type defined in TS 29.571 [17] clause 5.4.4.27.\nTable 7.3.3.2.62-1 contains the details for the PresenceInfo type.\nTable 7.3.3.2.62-1: Definition of type PresenceInfo\n\nThe LADNInfo type is used to report information derived from the LadnInfo type defined in TS 29.518 [22] clause 6.2.6.2.17.\nTable 7.3.3.2.63-1 contains the details for the LADNInfo type.\nTable 7.3.3.2.63-1: Structure of the LADNInfo type\n\nThe AMFEventType represents the AmfEventReport IE (TS 29.518 [22] clause 6.2.6.2.5) which triggered the LocationPresenceReport (clause 7.3.3.2.47).\nTable 7.3.3.2.64-1 contains the details of the AMFEventType type.\nTable 7.3.3.2.64-1: Enumeration for AMFEventType\n\nThe AccessType indicates the access types of which the signalling or user data is transmitted.\nTable 7.3.3.2.65-1 contains the details of the AccessType type.\nTable 7.3.3.2.65-1: Enumeration for AccessType\n\nThe UEReachability indicates the reachability of the UE. UEReachability is derived from the UeReachability type defined in TS 29.518 [22] clause 6.2.6.3.7.\nTable 7.3.3.2.66-1 contains the details of the UEReachability type.\nTable 7.3.3.2.66-1: Enumeration for UEReachability\n\nThe RMState indicates the registration management state of the UE. RMState is derived from the RmState type defined in TS 29.518 [22] clause 6.2.6.3.9.\nTable 7.3.3.2.67-1 contains the details of the RMState type.\nTable 7.3.3.2.67-1: Enumeration for RMState\n\nThe CMState indicates the connection management state of the UE. CMState is derived from the CmState type defined in TS 29.518 [22] clause 6.2.6.3.10.\nTable 7.3.3.2.68-1 contains the details of the CMState type.\nTable 7.3.3.2.68-1: Enumeration for CMState\n\nThe PresenceState indicates whether the UE is inside or outside of the area of interest (e.g presence reporting area or the LADN area), or if the presence reporting area is inactive in the serving node. PresenceState is derived from the PresenceState type defined in TS 29.571 [17] clause 5.4.3.20.\nTable 7.3.3.2.69-1 contains the details of the PresenceState type.\nTable 7.3.3.2.69-1: Enumeration for PresenceState\n\nThe FourGPositioningInfo type is used to report EPS Location, The FourGPositioningInfo type is derived from the data present in the Provide Subscriber Location Answer Table defined in TS 29.172 [53] table 6.2.2.2.3-1.\nTable 7.3.3.2.70-1 contains the details for the FourGPositioningInfo type.\nTable 7.3.3.2.70-1: Structure of the FourGPositioningInfo type\n\nThe FourGLocationInfo type is derived from the data present in EPS-Location-Information type defined in TS 29.272 [106] clause 7.3.111 and the data present in User Location Information (ULI) IE, defined in TS 29.274 [87] clause 8.21.\nTable 7.3.3.2.71-1 contains the details for the FourGLocationInfo type.\nTable 7.3.3.2.71-1: Choices for type FourGLocationInfo\n\nThe Cell Global Identification (CGI) type is used to report base station identification. The CGI type is derived from the data present in the CGI information element defined in TS 23.003 [19] clause 4.3.1.\nTable 7.3.3.2.72-1 contains the details for the CGI type.\nTable 7.3.3.2.72-1: Structure of the CGI type\n\nThe Service Area Identifier (SAI) is used to identify an area consisting of one or more cells belonging to the same Location Area. Such an area is called a Service Area and can be used for indicating the location of a UE to the Core Network. The SAI is derived from the data present in the SAI information element defined in TS 23.003[19] clause 12.5.\nTable 7.3.3.2.73-1 contains the details for the SAI type.\nTable 7.3.3.2.73-1: Structure of the SAI type\n\nThe ESMLCCelInfo type is used to identify the current cell information of the target UE as known by E-SMLC. Derived from the information found in TS 29.172 [53] table 6.2.2.2.3-1.\nTable 7.3.3.2.74-1 contains the details for the ESMLCCellInfo type.\nTable 7.3.3.2.74-1: Structure of the ESMLCCellInfo type\n\nThe GERANPositioningInfo type is used to indicate the usage of each positioning method that was attempted to determine the location estimate, either successfully or unsuccessfully. This Information Element is applicable only when the UE is attached to GERAN access and when the message is sent by the SGSN or combined MME/SGSN. Derived from the data found in TS 29.172 [53] clause 7.4.29.\nTable 7.3.3.2.75-1 contains the details for the GERANPositioningInfo type.\nTable 7.3.3.2.75-1: Structure of the GERANPositioningInfo type\n\nThe UTRANPositioningInfo type is used to indicate the usage of each positioning method that was attempted to determine the location estimate, either successfully or unsuccessfully. This Information Element is applicable only when the UE is attached to UTRAN access and when the message is sent by the SGSN or the SGSN part of the combined MME/SGSN. Derived from the data found in TS 29.172 [53] clause 7.4.32.\nTable 7.3.3.2.76-1 contains the details for the UTRANPositioningInfo type.\nTable 7.3.3.2.76-1: Structure of the UTRANPositioningInfo type\n\nThe EPSLocationInformation type contains the information related to the user location relevant for EPS. Derived from the data found in EPS-Location-Information parameter from TS 29.272 [106] clause 7.3.111.\nTable 7.3.3.2.77-1 contains the details for the EPSLocationInformation type.\nTable 7.3.3.2.77-1: Structure of the EPSLocationInformation type\n\nThe MMELocationInformation type contains the information related to the user location relevant for the MME. Derived from the data found in MME-Location-Information parameter from TS 29.272 [106] clause 7.3.115.\nTable 7.3.3.2.78-1 contains the details for the MMELocationInformation type.\nTable 7.3.3.2.78-1: Structure of the MMELocationInformation type\n\nThe SGSNLocationInformation type contains the information related to the user location relevant for the MME. Derived from the data found in MME-Location-Information parameter from TS 29.272 [106] clause 7.3.115.\nTable 7.3.3.2.79-1 contains the details for the SGSNLocationInformation type.\nTable 7.3.3.2.79-1: Structure of the SGSNLocationInformation type\n\nThe UserCSGInformation type holds the user \"Closed Subscriber Group\" information associated to CSG cell access: it comprises CSG ID within the PLMN, access mode and indication on CSG membership for the user when hybrid access applies. Derived from the data found in User-CSG-Information parameter from TS 32.299 [111] clause 7.2.240a.\nTable 7.3.3.2.80-1 contains the details for the UserCSGInformation type.\nTable 7.3.3.2.80-1: Structure of the UserCSGInformation type\n\nThe LAI type is composed of the PLMNID and the Location Area Code. LAI is derived from the data found in LAI parameter from TS 23.003 [19] clause 4.1.\nTable 7.3.3.2.81-1 contains the details for the LAI type.\nTable 7.3.3.2.81-1: Structure of the LAI type\n\nThe RAI type is composed of the PLMNID and the Location Area Code and the Routing Area Code. RAI is derived from the data found in RAI parameter from TS 23.003 [19] clause 4.2.\nTable 7.3.3.2.82-1 contains the details for the RAI type.\nTable 7.3.3.2.82-1: Structure of the RAI type\n\nThe CSGAccessMode indicates the mode in which the CSG cell User is accessing to operate. CSGAccessMode is derived from the CSG-Access-Mode type defined in TS 32.299. [111] clause 7.2.46A.\nTable 7.3.3.2.83-1 contains the details of the CSGAccessMode type.\nTable 7.3.3.2.83-1: Enumeration for CSGAccessMode\n\nThe CSGMemebershipIndication indicates the UE is a member of the accessing CSG cell. CSGMemebershipIndication is derived from the CSG-Membership-Indication type defined in TS 32.299 [111] clause 7.2.46B.\nTable 7.3.3.2.84-1 contains the details of the CSGMembershipIndication type.\nTable 7.3.3.2.84-1: Enumeration for CSGMembershipIndication\n\nWhen the reference datum used for a latitude and longitude given in the GeographicalCoordinates structure is known by the operator, the reference datum shall be identified in the mapDatumInformation field. The reference datum identity shall be specified as an Open Geospatial Consortium URN, as defined in OGC 05-010 [35].\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.3.2.1-1: Simple Types for Location",
                                    "table number": 187,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.2-1: Definition of type Location",
                                    "table number": 188,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.3-1: Definition of type LocationInfo",
                                    "table number": 189,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.4-1: Definition of type UserLocation",
                                    "table number": 190,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.5-1: Definition of type EUTRALocation",
                                    "table number": 191,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.6-1: Definition of type NRLocation",
                                    "table number": 192,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.7-1: Definition of type N3GALocation",
                                    "table number": 193,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.8-1: Definition of type UTRALocation",
                                    "table number": 194,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.9-1: Definition of type GERALocation",
                                    "table number": 195,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.10-1: Definition of Choices for GeographicArea",
                                    "table number": 196,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.11-1: Definition of type Point",
                                    "table number": 197,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.12-1: Definition of type GeographicalCoordinates",
                                    "table number": 198,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.13-1: Definition of type PointUncertaintyCircle",
                                    "table number": 199,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.14-1: Definition of type PointUncertaintyEllipse",
                                    "table number": 200,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.15-1: Definition of type UncertaintyEllipse",
                                    "table number": 201,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.16-1: Definition of type Polygon",
                                    "table number": 202,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.17-1: Definition of type PointAltitude",
                                    "table number": 203,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.18-1: Definition of type PointAltitudeUncertainty",
                                    "table number": 204,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.19-1: Definition of type EllipsoidArc",
                                    "table number": 205,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.20-1: Enumeration for RATType",
                                    "table number": 206,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.22-1: Definition of Choices for RANCGI",
                                    "table number": 207,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.23-1: Definition of type TAI",
                                    "table number": 208,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.24-1: Definition of type ECGI",
                                    "table number": 209,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.25-1: Definition of type GlobalRANNodeID",
                                    "table number": 210,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.26-1: Choices for ANNodeID",
                                    "table number": 211,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.27-1: Definition of type NGENbID",
                                    "table number": 212,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.28-1: Definition of type NCGI",
                                    "table number": 213,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.29-1: Definition of type IPAddr",
                                    "table number": 214,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.30-1: Definition of type TNAPID",
                                    "table number": 215,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.31-1: Definition of type TWAPID",
                                    "table number": 216,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.32-1: Enumeration W5GBANLineType",
                                    "table number": 217,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.33-1: Enumeration TransportProtocol Type",
                                    "table number": 218,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.34-1: Definition of type PLMNID",
                                    "table number": 219,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.35-1: Definition of type ENbID",
                                    "table number": 220,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.36-1: Definition of type PositioningInfo",
                                    "table number": 221,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.37-1: Definition of type LocationData",
                                    "table number": 222,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.38-1: Choices for type RawMLPResponse",
                                    "table number": 223,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.39-1: Definition of type VelocityEstimate",
                                    "table number": 224,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.40-1: Definition of type CivicAddress",
                                    "table number": 225,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.41-1: Definition of type PositioningMethodAndUsage",
                                    "table number": 226,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.42-1: Definition of type GNSSPositioningMethodAndUsage",
                                    "table number": 227,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.43-1: Definition of type HorizontalVelocity",
                                    "table number": 228,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.44-1: Definition of type HorizontalWithVerticalVelocity",
                                    "table number": 229,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.45-1: Definition of type HorizontalVelocityWithUncertainty",
                                    "table number": 230,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.46-1: Definition of type HorizontalWithVerticalVelocityAndUncertainty",
                                    "table number": 231,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.47-1: Definition of type LocationPresenceReport",
                                    "table number": 232,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.48-1: Definition of type AMFEventArea",
                                    "table number": 233,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.49-1: Definition of type RMInfo",
                                    "table number": 234,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.50-1: Definition of type CMInfo",
                                    "table number": 235,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.51-1: Enumeration for AccuracyFulfilmentIndicator",
                                    "table number": 236,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.52-1: Enumeration for PositioningMethod",
                                    "table number": 237,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.53-1: Enumeration for PositioningMode",
                                    "table number": 238,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.54-1: Enumeration for GNSSID",
                                    "table number": 239,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.55-1: Enumeration for GNSSID",
                                    "table number": 240,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.56-1: Enumeration for VerticalDirection",
                                    "table number": 241,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.57-1: Structure of the IMSLocation type",
                                    "table number": 242,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.58-1: Structure of the PANIHeaderInfo type",
                                    "table number": 243,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.59-1: Structure of the SIPGeolocationHeader type",
                                    "table number": 244,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.60-1: Structure of the SIPLocationInfo type",
                                    "table number": 245,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.60-1: Structure of the SIPCNIHeaderInfo type",
                                    "table number": 246,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.62-1: Definition of type PresenceInfo",
                                    "table number": 247,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.63-1: Structure of the LADNInfo type",
                                    "table number": 248,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.64-1: Enumeration for AMFEventType",
                                    "table number": 249,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.65-1: Enumeration for AccessType",
                                    "table number": 250,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.66-1: Enumeration for UEReachability",
                                    "table number": 251,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.67-1: Enumeration for RMState",
                                    "table number": 252,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.68-1: Enumeration for CMState",
                                    "table number": 253,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.69-1: Enumeration for PresenceState",
                                    "table number": 254,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.70-1: Structure of the FourGPositioningInfo type",
                                    "table number": 255,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.71-1: Choices for type FourGLocationInfo",
                                    "table number": 256,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.72-1: Structure of the CGI type",
                                    "table number": 257,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.73-1: Structure of the SAI type",
                                    "table number": 258,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.74-1: Structure of the ESMLCCellInfo type",
                                    "table number": 259,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.75-1: Structure of the GERANPositioningInfo type",
                                    "table number": 260,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.76-1: Structure of the UTRANPositioningInfo type",
                                    "table number": 261,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.77-1: Structure of the EPSLocationInformation type",
                                    "table number": 262,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.78-1: Structure of the MMELocationInformation type",
                                    "table number": 263,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.79-1: Structure of the SGSNLocationInformation type",
                                    "table number": 264,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.80-1: Structure of the UserCSGInformation type",
                                    "table number": 265,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.81-1: Structure of the LAI type",
                                    "table number": 266,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.82-1: Structure of the RAI type",
                                    "table number": 267,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.83-1: Enumeration for CSGAccessMode",
                                    "table number": 268,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.3.2.84-1: Enumeration for CSGMembershipIndication",
                                    "table number": 269,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.4\tSeparated location reporting",
                            "text_content": "When location information cannot be reported via an existing message generation at the IRI-POI, a separate xIRI may be generated from any provisioned IRI-POI that has access to location information and included in the SeparatedLocationReporting record.\nThe following information needs to be transferred from the IRI-POI to the MDF2 to enable a MDF2 to perform its functionality:\n-\tTarget identity.\n-\tEvent date/time.\n-\tTarget location(s).\n-\tDate/time of UE location(s).\n-\tNature and identity of the POI.\n-\tLocation source(s).\nDetails of how the IRI-POI in the SMF generates this record can be found in clause 6.2.3.2.1.\nDetails of how the IRI-POI in the NEF generates this record can be found in clause 7.7.2.1.1.\nDetails for Location Only reporting using this record can be found in clause 7.3.6.\nTable 7.3.4.1-1: Payload for SeparatedLocationReporting record\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.4.1-1: Payload for SeparatedLocationReporting record",
                                    "table number": 270,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.5\tLocation acquisition",
                            "text_content": "The architecture for location acquisition is specified in TS 33.127 [5], clause 7.3.5.\nThe LAF is responsible for receiving acquisition requests from the LEA over the LI_HILA interface. Further details of LI_HILA messages are defined in clause 5.11.\nLI_HILA requests are used to generate a LI_XLA request to the LARF over the LI_XLA interface. Further details of LI_XLA messages are defined in clause 5.12.\nUpon the receipt of a location acquisition request over LI_XLA, the LARF shall first check that the UE is registered at the MME/AMF. If it is registered the LARF will check the UE context at the MME/AMF to see if the current location for the UE is known.\nThe LARF/MME/AMF shall override any user consent, privacy and paging restrictions concerned with location acquisition that may apply to the target UE. The LARF/MME/AMF shall ensure that overriding these restrictions does not result in additional detectability issues.\nIf delivery via the LI_HI2 is required, the LARF will send the acquisition response as either an AMFLocationUpdate (in case of the 5GC) or an MMELocationUpdate (in case of the EPC) xIRI record to the MDF2 via LI_X2_LA. Full details are given in clause 7.3.5.6.\nIf delivery via the LI_HILA is required, the LARF returns the acquisition response as part of the LI_XLA response, which the LAF then transforms into a LI_HILA response given as a LocationResponseDetails structure (see table 5.11.2.3-1). Full details are given in clause 7.3.5.5 and clause 5.11.2.3.\nThe procedure is as follows:\n-\tIf the ReqCurrentLoc parameter (see table 5.12.2.1-1) is set to true in the location acquisition request message received over LI_XLA, the LARF shall invoke the Insert Subscriber Data procedure, with the IDR-Flags with the \"EPS Location Information Request\" bit and the \"Current Location Request\" bit set (TS 29.272 [108] clause 5.2.2.1.2) using the information received in the location acquistion request message.\n-\tIf the ReqCurrentLoc parameter (see table 5.12.2.1-1) is set to false in the location acquisition request message received over LI_XLA, the LARF shall use the location information in the UE context at the MME to generate and deliver a location acquisition response based on the provisioned delivery method as described in clauses 7.3.5.5 and 7.3.5.6.\nThe procedure is as follows:\n-\tIf the ReqCurrentLoc parameter (see table 5.12.2.1-1) is set to true in the location acquisition request message received over LI_XLA, the LARF shall invoke a ProvideLocationInfo service operation in the AMF (see TS 29.518 [22] clause 5.5.2.4) using the information received in the location acquistion request message to generate the RequestLocInfo parameters. The LARF shall set the reqCurrentLoc parameter of the RequestLocInfo IE to true (see TS 29.518 [22] clause 5.5.2.4).\n-\tIf the ReqCurrentLoc parameter (see table 5.12.2.1-1) is set to false in the location acquisition request message received over LI_XLA, the LARF shall use the location information in the UE context at the AMF to generate and deliver a location acquisition response based on the provisioned delivery method as described in clauses 7.3.5.5 and 7.3.5.6.\nThe LARF shall populate the LocationResponseDetails field in the LocationAcquisitionResponse message as specified in clause 5.11.2.3.\nOn receiving a LocationAcquisitionResponse message containing a LocationResponseDetails field, the LAF shall return the results to the LEA over the LI_HILA interface. The LI_HILA response is represented as XML following the LocationResponseDetails type definition (see Annex I) as described in clause 5.11.2.3.\nTable 7.3.5.5.2-1: Void\n\nThe MDF2 listed as the delivery endpoint for xIRI generated by the LARF in the MME/AMF shall be provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2 prior to issuing of LI_XLA requests for the given target. Table 7.3.5.6.2-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF2.\nThe MDF2 shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):\n-\tSUPIIMSI.\n-\tSUPINAI.\n-\tGPSIMSISDN.\n-\tGPSINAI.\n-\tIMSI.\n-\tMSISDN.\nTable 7.3.5.6.1-1: ActivateTask message for MDF2\n\nTable 7.3.5.6.1-2: Mediation Details for MDF2\n\nThe LARF shall generate the MMELocationUpdate xIRI in case of the EPC or the AMFLocationUpdate xIRI in case of the 5GC only when it detects that MME/AMF returns the location for the corresponding LARF transaction.\nIn case of the 5GC, the acquisition response shall be given as a AMFLocationUpdate xIRI record. In case of the EPC, the acquisition response shall be given as an MMELocationUpdate xIRI record. The XID of the xIRI record shall be set to the XID specified in the original request (see clause 5.12.2).\nThe MDF2 shall generate the IRI message based on the AMFLocationUpdate xIRI record from the LARF and deliver it to the LEMF over LI_HI2.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.5.6.1-1: ActivateTask message for MDF2",
                                    "table number": 271,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.3.5.6.1-2: Mediation Details for MDF2",
                                    "table number": 272,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.3.6\tLocation Only Reporting",
                            "text_content": "In some cases, it may be required to deliver only location information associated to a target.\nFor a warrant authorizing only location reporting, all other IRI information not associated with Location shall not be delivered. For example, when a target places a voice call, the new location information available as part of the call handling, shall be reported, but nothing else. LocationOnly reporting may be provisioned using one of the following methods:\n-\tUsing a specific Location Only task provisioned at the IRI-POI.\n-\tUsing the Mediation Details at the MDF2.\nThe LocationOnlyProvisioning parameter may be included:\n-\tAs a TaskDetailsExtension of an ActivateTask message sent to an IRI-POI.\n-\tAs a MediationDetailsExtension of an ActivateTask message sent to an MDF2.\nTable 7.3.6-1 shows the details of the LocationOnlyProvisioning parameter for TaskDetailsExtension and MediationDetailsExtension.\nTable 7.3.6-1: LocationOnlyProvisioning parameters\n\nIf the LocationOnly flag is set in the TaskDetailsExtension of an ActivateTask message sent to an IRI-POI that task is considered a Location Only task.\nFor a Location Only task at the IRI-POI in the AMF, whenever any trigger specified for the IRI-POI in the AMF is met for the generation of an xIRI (see clause 6.2.2.2), instead of generating that xIRI, the IRI-POI in AMF shall generate an xIRI containing an AMFLocationUpdate record if there is any location information in the triggering event and send it to the MDF2 over LI_X2. If there is no location information in the triggering event, no xIRI shall be generated.\nFor a Location Only task at an IRI-POI not in the AMF, whenever any trigger specified for that IRI-POI is met, instead of generating that xIRI, the IRI-POI shall genereate an xIRI containing a SeparatedLocationReport record if there is any location information in the triggering event and send it over to the MDF2 over LI_X2 the xIRI is listed in below in this clause.\nThe IRI-POI in the UDM shall generate the following xIRIs when the appropriate triggers are met and and send them over LI_X2 for Location Only tasks:\n-\tUDMServingSystemMessage.\nFor a Location Only task at the IRI-POI in the MME, whenever any trigger specified for the IRI-POI in the MME is met for the generation of an xIRI (see clause 6.3.2.2.2), instead of generating that xIRI, the IRI-POI in MME shall generate an xIRI containing an MMELocationUpdate record if there is any location information in the triggering event and send it to the MDF2 over LI_X2. If there is no location information in the triggering event, no xIRI shall be generated.\nFor a Location Only task at an IRI-POI not in the MME, whenever any trigger specified for that IRI-POI is met, instead of generating that xIRI, the IRI-POI shall genereate an xIRI containing a SeparatedLocationReport record if there is any location information in the triggering event and send it over to the MDF2 over LI_X2 the xIRI is listed in below in this clause.\nThe IRI-POI in the HSS shall generate the following xIRIs when the appropriate triggers are met and and send them over LI_X2 for Location Only tasks:\n-\tHSSServingSystemMessage.\nIf the LocationOnly flag is set in the MediationDetailsExtension of an ActivateTask message sent to an MDF2 that task is considered a Location Only task only in the context of this specific MediationDetails set. The MDF2 shall generate IRIs for the following xIRIs for Location Only tasks and send them over LI_HI2:\n-\tUDMServingSystemMessage.\n-\tAMFLocationUpdate.\n-\tLALSReport.\n-\tSeparatedLocationReport.\n-\tHSSServingSystemMessage\n-\tMMELocationUpdate.\nIn addition, whenever any xIRI for a Location Only task is received over LI_X2 from any IRI-POI, if the xIRI is not included in the list below and has location information, the MDF2 shall generate an IRI message containing a SeparatedLocationReport record and send it over LI_HI2 to the provisioned destinations without delay instead of the IRI message containing a copy of the relevant record received over LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe MDF2 shall ignore the LocationOnlyProvisioning parameter if it is present in the TaskDetailsExtension of the ActivateTask message.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.3.6-1: LocationOnlyProvisioning parameters",
                                    "table number": 273,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "7.4\tMessaging",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.4.1\tIntroduction",
                            "text_content": "Stage 3 intercept capabilities for SMS at an SMSF are defined in clause 6.2.5. Details on how to remove unauthorised content from SMS messages are defined in clause 7.4.5.2.\nStage 3 for MMS interception follows in clause 7.4.3.\nStage 3 intercept capabilities for RCS are defined in clause 7.13. Details on how to remove unauthorised content from encapsulated RCS messages are defined in clause 7.13.5.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.2\tLI at the MMS Proxy-Relay",
                            "text_content": "The IRI-POI present in the MMS Proxy-Relay is provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nThe POI in the MMS Proxy-Relay shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages:\n-\tE164Number.\n-\tEmailAddress.\n-\tGPSIMSISDN.\n-\tIMPI.\n-\tIMPU.\n-\tIMSI.\n-\tSUPIIMSI.\n-\tNAI.\n-\tSUPINAI.\nThe IRI-POI present in the MMS Proxy-Relay shall send xIRI over LI_X2 for the events listed in TS 33.127 [5] clause 7.5.2.3, which is further expanded in the present document in clause 7.4.2.4 below.\nThe CC-POI present in the MMS Proxy-Relay shall send xCC over LI_X3 for any MMS event where CC is available and authorized for reporting for the events listed in clause TS 33.127 [5] 7.5.2.3.\nThe xCC payload shall consist of the MMS contents given as a MIME encoded document (RFC 2045) according to OMA-TS-MMS_ENC [39]. The payload format shall be set to \"MIME document\" (value 15).\nThe triggers for MMS record generation are detailed in each of clauses 7.4.3.1 through 7.4.3.20. All triggers are defined by the detection of messages at the local MMS Proxy-Relay. They belong to one of two following high-level categories:\n-\tat the local MMS Proxy-Relay, the sending or arrival of a message, either to or from the local target UE, using OMA-TS-MMS_ENC [39] definitions, or\n-\tat the local MMS Proxy-Relay, the sending or arrival of a message to or from a non-local MMS Proxy-Relay, pertaining to messages either to or from a non-local target UE served by that non-local MMS Proxy-Relay, using the inter-proxy MM4 reference point, TS 23.140 [40] clause 8.4 definitions.\nThe present document assumes that the intercepted MMS complies with version 1.3 of OMA-TS-MMS_ENC [39]. If the intercepted messages do not comply fully, or the version is other than 1.3, parameters are required to be provided only if available.\nIn the following tables, the acronym Multimedia Message (MM) refers to a message in particular, while Multimedia Message Service (MMS) refers to the service in general.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.3\tMMS Records",
                            "text_content": "The IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an MMSSend record when the MMS Proxy-Relay sends m-send-conf (as defined in OMA-TS-MMS_ENC [39] clause 6.1.1) to local target UE.\nTable 7.4.3-1 contains parameters generated by the IRI-POI, along with parameters derived from the m-send-req message (from the local target UE to the MMS Proxy-Relay), and the m-send-conf message (from MMS Proxy-Relay to the local target UE).\nTable 7.4.3-1: Payload for MMSSend\n\n\nThe IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an MMSSendByNonLocalTarget record when the MMS Proxy-Relay receives MM4_forward.REQ (as defined in TS 23.140 [40] clause 8.4.1) from the non-local MMS Proxy-Relay, that contains a non-local target ID.\nTable 7.4.3-2 contains parameters generated by the IRI-POI, along with parameters derived from the MM4_forward.REQ message (from the non-local MMS Proxy-Relay to the local MMS Proxy-Relay).\nTable 7.4.3-2: Payload for MMSSendByNonLocalTarget\n\nThe IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an MMSNotification record when the MMS Proxy-Relay sends a m-notification-ind (as defined in OMA-TS-MMS_ENC [39] clause 6.2) to the MMS client in the local target UE.\nTable 7.4.3-3 contains parameters generated by the IRI-POI, along with parameters derived from the m-notification-ind message (from the local MMS Proxy-Relay to the local target).\nTable 7.4.3-3: Payload for MMSNotification\n\nThe IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an MMSSendToNonLocalTarget record when the local MMS Proxy-Relay sends a MM4_forward.REQ (as defined in TS 23.140 [40] clause 8.4.1) to the non-local MMS Proxy-Relay, that contains a non-local target ID.\nTable 7.4.3-4 contains parameters generated by the IRI-POI, along with parameters derived from the MM4_forward.REQ message (from the non-local MMS Proxy-Relay to the local MMS Proxy-Relay).\nTable 7.4.3-4: Payload for MMSSendToNonLocalTarget\n\n\nThe IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an MMSNotificationResponse record when the MMS Proxy-Relay receives a m-notifyresp-ind (as defined in OMA-TS-MMS_ENC [39] clause 6.2, table 4) from the MMS client in the target UE for the deferred retrieval case only. The immediate retrieval trigger on m-notifyresp-ind is in clause 7.4.3.7.\nTable 7.4.3-5 contains parameters generated by the IRI-POI, along with parameters derived from the m-notifyresp-ind message (from the local target UE to the MMS Proxy-Relay).\nTable 7.4.3-5: Payload for MMSNotificationResponse\n\nThe IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an MMSRetrieval record when the MMS Proxy-Relay sends a m-retrieve-conf (as defined in OMA-TS-MMS_ENC [39] clause 6.3) to the MMS client in the target UE.\nTable 7.4.3-6 contains parameters generated by the IRI-POI, along with parameters derived from the m-retrieve-conf message (from the MMS Proxy-Relay to the local target UE).\nTable 7.4.3-6: Payload for MMSRetrieval\n\n\nThe IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an MMSDeliveryAck record when:\n-\tthe MMS Proxy-Relay receives an m-acknowledge-ind (as defined in OMA-TS-MMS_ENC [39] clause 6.4) from the MMS client in the target UE (for deferred retrieval), or\n-\tthe MMS Proxy-Relay receives an m-notifyresp-ind (as defined in OMA-TS-MMS_ENC [39] clause 6.4) from the MMS client in the target UE (for immediate retrieval).\nTable 7.4.3-7 contains parameters generated by the IRI-POI, along with parameters derived from the m-acknowledge-ind message (from the local target UE to the MMS Proxy-Relay), and the m-notifyresp-ind message (from the local target UE to the MMS Proxy-Relay).\nTable 7.4.3-7: Payload for MMSDeliveryAck\n\nThe IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an MMSForward record when the MMS Proxy-Relay sends an m-forward-conf (as defined in OMA-TS-MMS_ENC [39] clause 6.5.2) to the MMS client in the target UE.\nTable 7.4.3-8 contains parameters generated by the IRI-POI, along with parameters derived from the m-forward-req message (from the local target UE to the MMS Proxy-Relay), and the m-forward-conf message (from the MMS Proxy-Relay to the local target UE).\nTable 7.4.3-8: Payload for MMSForward\n\n\nThe IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing an MMSDeleteFromRelay record when the MMS Proxy-Relay sends a m-delete-conf (defined in OMA-TS-MMS_ENC [39]) to the MMS client in the target UE.\n\nTable 7.4.3-9 contains parameters generated by the IRI-POI, along with parameters derived from the m-delete-req message (from the local target UE to the MMS Proxy-Relay), and the m-delete-conf message (from the MMS Proxy-Relay to the local target UE).\nTable 7.4.3-9: Payload for MMSDeleteFromRelay\n\nThe IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an MMSMBoxStore record when the MMS Proxy-Relay sends a m-mbox-store-conf (defined in OMA-TS-MMS_ENC [39] clause 6.8) to the MMS client in the target UE.\n\nTable 7.4.3-10 contains parameters generated by the IRI-POI, along with parameters derived from the m-mbox-store-req message (from the local target UE to the MMS Proxy-Relay), and from the m-mbox-store-conf message (from the MMS Proxy-Relay to the local target UE).\nTable 7.4.3-10: Payload for MMSMBoxStore\n\nThe IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing an MMSMBoxUpload record when the MMS Proxy-Relay sends a m-mbox-upload-conf (defined in OMA-TS-MMS_ENC [39] clause 6.10) to the MMS client in the target UE.\nTable 7.4.3-11 contains parameters generated by the IRI-POI, along with parameters derived from the m-mbox-upload-req message (from the local target UE to the MMS Proxy-Relay), and from the m-mbox-upload-conf message (from the MMS Proxy-Relay to the local target UE).\nTable 7.4.3-11: Payload for MMSMBoxUpload\n\nThe IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing an MMSMBoxDelete record when the MMS Proxy-Relay sends a m-mbox-delete.conf (defined in OMA-TS-MMS_ENC [39]) to the MMS client in the target UE.\nTable 7.4.3-12 contains parameters generated by the IRI-POI, along with parameters derived from the m-mbox-delete-req message (from the local target UE to the MMS Proxy-Relay), and from the m-mbox-delete-conf message (from the MMS Proxy-Relay to the local target UE).\nTable 7.4.3-12: Payload for MMSMBoxDelete\n\nThe IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing an MMSDeliveryReport record when the MMS Proxy-Relay sends an m-delivery-ind (as defined in OMA-TS-MMS_ENC [39] clause 6.11) to the MMS client in the target UE.\nTable 7.4.3-13 contains parameters generated by the IRI-POI, along with parameters derived from the m-delivery-ind message (from the MMS Proxy-Relay to the local target UE).\nTable 7.4.3-13: Payload for MMSDeliveryReport\n\nThe IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an MMSDeliveryReportNonLocalTarget record when the MMS Proxy-Relay:\n-\tsends MM4_delivery_report.REQ (as defined in TS 23.140 [40] clause 8.4.2), that contains a non-local target ID, to the non-local MMS Proxy-Relay, or\n-\treceives MM4_delivery_report.REQ, that contains a non-local target ID, from the non-local MMS Proxy-Relay.\nTable 7.4.3-14 contains parameters generated by the IRI-POI, along with parameters derived from the MM4_delivery_report.REQ message (from the local MMS Proxy-Relay to the non-local MMS Proxy-Relay, or inversely).\nTable 7.4.3-14: Payload for MMSDeliveryReportNonLocalTarget\n\nThe IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing an MMSReadReport record when the MMS Proxy-Relay:\n-\tsends a m-read-orig-ind (as defined in OMA-TS-MMS_ENC [39] clause 6.7.2) to the MMS client in the target UE, or\n-\treceives a m-read-rec-ind (as defined in OMA-TS-MMS_ENC [39] clause 6.7.2) from the MMS client in the target UE.\nTable 7.4.3-15 contains parameters generated by the IRI-POI, along with parameters derived from the m-read-orig-ind message (from the MMS Proxy-Relay to the local target UE), and from the m-read-rec-ind message (from the local target UE to the MMS Proxy-Relay).\nTable 7.4.3-15: Payload for MMSReadReport\n\nThe IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing an MMSReadReportNonLocalTarget record when the MMS Proxy-Relay:\n-\tsends a MM4_read_reply_report.REQ (as defined in TS 23.140 [40] clause 8.4.3), that contains a non-local target ID, to the non-local MMS Proxy-Relay, or\n-\treceives a MM4_read_reply_report.REQ (as defined in TS 23.140 [40] clause 8.4.3), that contains a non-local target ID, from the non-local MMS Proxy-Relay.\nTable 7.4.3-16 contains parameters generated by the IRI-POI, along with parameters derived from the MM4_read_reply_report.REQ message (from the local MMS Proxy-Relay to the non-local MMS Proxy-Relay, or inversely).\nTable 7.4.3-16: Payload for MMSReadReportNonLocalTarget\n\nThe IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing an MMSCancel record when the MMS Proxy-Relay sends a m-cancel-req (as defined in OMA-TS-MMS_ENC [39] clause 6.13) to the MMS client in the target UE.\nTable 7.4.3-17 contains parameters generated by the IRI-POI, along with parameters derived from the m-cancel-req message (from the MMS Proxy-Relay to the local target UE).\nTable 7.4.3-17: Payload for MMSCancel\n\nThe IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing an MMSViewRequest record when the MMS Proxy-Relay receives a m-mbox-view-req (as defined in OMA-TS-MMS_ENC [39] clause 6.9) from the MMS client in the target UE.\nTable 7.4.3-18 contains parameters generated by the IRI-POI, along with parameters derived from the m-mbox-vew-req message (from the local target UE to the MMS Proxy-Relay).\nTable 7.4.3-18: Payload for MMSMBoxViewRequest\n\nThe IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing an MMSViewConfirm record when the MMS Proxy-Relay sends a m-mbox-view.conf (as defined in OMA-TS-MMS_ENC [39] clause 6.9) to the MMS client in the target UE.\nTable 7.4.3-19 contains parameters generated by the IRI-POI, along with parameters derived from the m-mbox-vew-conf message (from the local target UE to the MMS Proxy-Relay).\nTable 7.4.3-19: Payload for MMSMBoxViewResponse\n\nThe MMBoxDescription used in MMSMBoxViewResponse and MMSMBoxUpload records is defined in table 7.4.3-20.\nTable 7.4.3-20: Payload for MMBoxDescription\n\n\nIf content delivery is authorized, the CC-POI in the MMS Proxy-Relay shall generate an xCC as per clause 7.4.2.3 when any of the events in clauses 7.4.3.1 through 7.4.3.19 are detected.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.4.3-1: Payload for MMSSend",
                                    "table number": 274,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 275,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-2: Payload for MMSSendByNonLocalTarget",
                                    "table number": 276,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-3: Payload for MMSNotification",
                                    "table number": 277,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-4: Payload for MMSSendToNonLocalTarget",
                                    "table number": 278,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 279,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-5: Payload for MMSNotificationResponse",
                                    "table number": 280,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-6: Payload for MMSRetrieval",
                                    "table number": 281,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 282,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-7: Payload for MMSDeliveryAck",
                                    "table number": 283,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-8: Payload for MMSForward",
                                    "table number": 284,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 285,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-9: Payload for MMSDeleteFromRelay",
                                    "table number": 286,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-10: Payload for MMSMBoxStore",
                                    "table number": 287,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-11: Payload for MMSMBoxUpload",
                                    "table number": 288,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-12: Payload for MMSMBoxDelete",
                                    "table number": 289,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-13: Payload for MMSDeliveryReport",
                                    "table number": 290,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-14: Payload for MMSDeliveryReportNonLocalTarget",
                                    "table number": 291,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-15: Payload for MMSReadReport",
                                    "table number": 292,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-16: Payload for MMSReadReportNonLocalTarget",
                                    "table number": 293,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-17: Payload for MMSCancel",
                                    "table number": 294,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-18: Payload for MMSMBoxViewRequest",
                                    "table number": 295,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-19: Payload for MMSMBoxViewResponse",
                                    "table number": 296,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.4.3-20: Payload for MMBoxDescription",
                                    "table number": 297,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 298,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.4.4\tIRI and CC Generation",
                            "text_content": "When an IRI-POI in the MMS Proxy-Relay generated xIRI is received over LI_X2, the MDF2 shall send an xIRI over LI_HI2 without undue delay. The xIRI shall contain a copy of the record received over LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe threeGPP33128DefinedCC field (see ETSI TS 102 232-7 [10] clause 15) shall be populated with the BER-encoded IRIPayload.\nThe timestamp field of the PSHeader structure shall be set to the time that the MMS event was observed (i.e. the timestamp field of the xIRI). The LIID and CID fields shall correctly reflect the target identity and communication session to which the IRI belongs.\nWhen a CC-POI in the MMS Proxy-Relay generated xCC message is received over LI_X3, the MDF3 shall send a CC message over LI_HI3 without undue delay. The CC message shall contain a copy of the MMS received over LI_X3. The record may be enriched with other information available at the MDF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.5\tRedaction of unauthorised information from encapsulated messages",
                            "text_content": "The details on the removal of unauthorised information from encapsulated messages are detailed in the following clauses.\nWhen the removal of the short message (SM) portion of an SMS message is required, the SM portion of the TP-User-Data (TS 23.040 [18] clause 9.2.3.24) shall be replaced by the equivalent of \"Space\" in the original encoding for the total length of the SM portion as determined by the TP-User-Data-Length field (TS 23.040 [18] clause 9.2.3.16), and accounting for the Length of the User Data Header (UDHL) field (TS 23.040 [18] clause 9.2.3.24) if the latter is present as indicated by the TP-User-Data-Header-Indicator field (TS 23.040 [18] clause 9.2.3.23). While replacing the SM data, the Data Coding Scheme (TS 23.038 [123] clause 4) shall be considered.\nIf the TP-User-Data-Header-Indicator indicates the TP-User-Data Header is present, the Header shall be rewritten so that each of the Information Elements that are not classified as \"SMS Control\" in TS 23.040 [18] clause 9.2.3.24 shall be converted to a Filler Information Element per TS 23.040 [18] clause 9.2.3.24.17.\nIn any case, the overall length of the TP-User-Data, and if present, the overall length of the TP-User-Data Header, shall not be changed.\nWhen content is not authorised, the unauthorised information shall be redacted from the encapsulated payload reported within an RCS related IRI record prior to its delivery over LI_HI2.\nWhen location is not authorised the unauthorised information shall be redacted from the encapsulated payload reported within an RCS related IRI record prior to its delivery over LI_HI2.\nSee clause 7.13.5 for additional details on redacting unauthorised information from RCS records.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.5\tPTC service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.5.1\tIntroduction",
                            "text_content": "The Stage 3 intercept capabilities defined in this clause for the Push to Talk over Cellular (PTC) service apply when supported by a CSP. The term PTC represents either a Push to Talk over Cellular (PoC) or Mission Critical Push to Talk (MCPTT) type service. The use of the term PTC server represents either a MCPTT function or PoC server.\nThe IRI-POI present in the PTC server is provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2 of the present document.\nThe POI in the PTC Server shall support the identifier types given in table 7.5.1-1.\nTable 7.5.1-1: TargetIdentifier Types for PTC service\n\nThe IRI-POI present in the PTC server shall send xIRI over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.6.3, each of which is described in the following clauses. The IRI events are based on the use of 3GPP MCPTT features as defined in TS 24.379 [55] and OMA PoC features as defined in OMA-TS-PoC_System_Description-V2_1-20110802-A [56].\nThe CC-POI present in the PTC server shall send xCC over LI_X3.\nThe CC-POI shall set the payload format to indicate the appropriate payload type (5 for IPv4 Packet, 6 for IPv6 Packet) per clause 6.2.3.6 of the present document.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.5.1-1: TargetIdentifier Types for PTC service",
                                    "table number": 299,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.5.2\tIRI events",
                            "text_content": "The IRI-POI present in the PTC server shall generate an xIRI containing a PTCRegistration record when the IRI-POI present in the PTC server detects that a PTC target matching one of the PTC target identifiers, referenced in clause 7.5.1.1, provided via LI_X1 has registered, re-registered, or de-registered for PTC services , regardless of whether it is successful or unsuccessful. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following event is detected:\n-\twhen the PTC server receives a SIP REGISTER from a PTC target.\nTable 7.5.2-1: Payload for PTCRegistration record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCSessionInitiation record when the IRI-POI present in the PTC server detects that the PTC target initiates an on-demand session or the target receives an invitation to join an on-demand session regardless of the success or the final disposition of the invitation. The PTCSessionIniation record shall also be reported when a chat group is the PTC target. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following events are detected:\n-\twhen the PTC server receives a SIP INVITE from a PTC target.\n-\twhen the PTC Server sends a SIP INVITE to the PTC target.\n-\twhen the PTC Server hosting a PTC chat group session, where the PTC chat group is the target, receives a SIP INVITE from a participating PTC server to initiate a PTC chat group session.\nTable 7.5.2-2: Payload for PTCSessionInitiation record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCSessionAbandon record when the IRI-POI present in the PTC server detects that the PTC Session is not established and the request is abandoned before the PTC session starts. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following events are detected:\n-\twhen the PTC server serving the PTC target receives a SIP CANCEL from the PTC target or sends a SIP CANCEL to the PTC target.\nTable 7.5.2-3: Payload for PTCSessionAbandonAttempt record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCSessionStart record when the IRI-POI present in the PTC server detects that the PTC Session is initiated and communication begins for both an on-demand and pre-established PTC session. The PTCSessionStart record shall also be reported when a chat group is the PTC target. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following events are detected:\n-\twhen the PTC server sends a SIP 200 OK to the PTC target in response to a SIP INVITE from the PTC target for an on-demand PTC session where the PTC target originates the PTC session.\n-\twhen the PTC server receives a SIP 200 OK from the PTC target in response to a SIP INVITE for an on-demand PTC session where the PTC target receives an invitation to join a PTC session.\n-\twhen the PTC server receives a SIP 200 OK from the participant PTC server in response to a SIP INVITE previously sent to that participating PTC server for PTC sessions initiated by the PTC target with a pre-established PTC session (PTC server sends a TBCP Connect to the PTC target with a pre-established session).\n-\twhen the PTC server sends a SIP 200 OK to the participant PTC server in response to a SIP INVITE previously received from that participating PTC server for PTC sessions terminated to the PTC target with a pre-established PTC session (PTC server sends a TBCP Connect to the PTC target with a pre-established session).\n-\twhen the PTC server hosting a PTC chat group session, where PTC chat group is the PTC target, sends a SIP 200 OK in response to a SIP INVITE previously received from the participant PTC server to initiate a PTC chat group session.\nTable 7.5.2-4: Payload for PTCSessionStart record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCSessionEnd record when the IRI-POI present in the PTC server detects that the PTC session is released for any reason (i.e. normal or abnormal release) and voice communications ends. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following events are detected:\n-\twhen the PTC server receives a SIP BYE from the PTC target to end the session.\n-\twhen the PTC server receives a SIP 200 OK from the PTC target in response to a SIP BYE.\n-\twhen the PTC server sends a SIP BYE to the participating PTC server to end the PTC session of a PTC target with a pre-established PTC session (PTC server also sends a TBCP Disconnect to the PTC target with a pre-established PTC session).\n-\twhen the PTC server receives a SIP BYE from the participant PTC server to end the PTC session of a PTC target with a pre-established PTC session (PTC server sends a TBCP Disconnect to the PTC target with a pre-established PTC session).\n-\twhen the PTC server hosting a PTC chat group session, where PTC chat group is the PTC target, sends a SIP 200 OK in response to a SIP BYE received from the participating PTC server of the last participant in the PTC chat group session.\n-\twhen the PTC server sends a SIP 487 to the PTC target in response to a SIP CANCEL to end the session.\nTable 7.5.2-5: Payload for PTCSessionEnd record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCStartOfInterception record when a PTC target or a PTC chat group as a target has an active PTC session in progress. If multiple PTC Sessions are active at the start of interception, a PTCStartOfInterception record is generated for each active session. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following event is detected:\n-\twhen the PTC server detects that LI is enabled on a PTC participant or a PTC chat group with an active PTC session.\nTable 7.5.2-6: Payload for PTCStartOfIntercept record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCPre-EstablishedSession record when the IRI-POI present in the PTC server detects that a pre-established session is setup/modified/released between the PTC target and the PTC server associated with the PTC target. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following events are detected:\n-\twhen the PTC Server receives a SIP INVITE from the PTC target to setup a pre-established session.\n-\twhen the PTC Server receives a SIP BYE from the PTC target to release a pre-established session.\n-\twhen the PTC Server receives a SIP UPDATE or SIP re-INVITE from the PTC target for a pre-established session to modify the current session.\nTable 7.5.2-7: Payload for PTCPre-EstablishedSession record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCInstantPersonalAlert record when the IRI-POI present in the PTC server detects that an Instant Personal Alert (IPA) (i.e. a request for one participant to initiate a one-to-one PTC session) is initiated by or sent to the PTC target. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following events are detected:\n-\twhen the PTC server receives a SIP MESSAGE from a PTC target for an IPA.\n-\twhen the PTC Server sends a SIP MESSAGE to the PTC target for an IPA.\nTable 7.5.2-8: Payload for PTCInstantPersonalAlert record\n\nThe IRI-POI present in the PTC server hosting the PTC chat group session when the PTC chat group is the PTC target, shall generate an xIRI containing a PTCPartyJoin record when the IRI-POI present in that PTC server detects when a PTC participant joins (or re-joins) an on-going PTC chat group session. The PTCPartyJoin record shall also be generated when the IRI-POI present in the participating PTC server of the PTC target detects when a PTC Participant joins (or re-joins) an on-going PTC chat group session. Accordingly, the IRI-POI in the participating PTC server generates the xIRI when the following event is detected:\n-\twhen the PTC server hosting a PTC chat group session sends a SIP 200 OK in response to a SIP INVITE indicating a PTC participant joining the PTC chat group session.\n-\twhen the participating PTC server of a PTC target forwards a SIP NOTIFY (received from the PTC server hosting the PTC chat group session) to the PTC target containing information about a PTC participant joining the PTC chat group session.\nTable 7.5.2-9: Payload for PTCPartyJoin record\n\nThe IRI-POI present in the PTC server hosting the PTC chat group session, when the PTC chat group is the PTC target, shall generate an xIRI containing a PTCPartyDrop record when the IRI-POI present in that PTC server detects that a PTC participant leaves the PTC chat group session that still remains active with other PTC participants. The PTCPartyDrop record shall also be generated when the IRI-POI present in the participating PTC server of the PTC target detects when a PTC Participant leaves an on-going PTC chat group session. Accordingly, the IRI-POI in the participating PTC server generates the xIRI when the following event is detected:\n-\twhen the PTC server hosting a PTC chat group session, where the PTC chat group is the target, sends a SIP 200 OK in response to a SIP BYE with the PTC chat group session remaining active with other PTC participants.\n-\twhen the participating PTC server of a PTC target forwards a SIP NOTIFY (received from the PTC server hosting the PTC chat group session) to the PTC target containing information about a PTC participant leaving the PTC chat group session.\nTable 7.5.2-10: Payload for PTCPartyDrop record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCPartyHold record when the IRI-POI present in the PTC server detects that an on-going PTC session is placed on hold or retrieved from hold by the PTC target or by a PTC participant in a PTC chat group, where the PTC chat group is the PTC target. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following event is detected:\n-\twhen the PTC server receives a SIP UPDATE or SIP re-INVITE from the PTC target and returns a SIP 200 OK to the PTC target for hold/resume operations.\n-\twhen the PTC server hosting a PTC chat group, where PTC chat group is the PTC target, receives a SIP UPDATE or SIP re-INVITE from a PTC participant for hold/resume operations.\nTable 7.5.2-11: Payload for PTCPartyHold record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCMediaModification record when the IRI-POI present in the PTC server detects that a re-negotiation of the media parameters occurs during a PTC session involving the PTC target. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following event is detected:\n-\twhen the PTC server receives a SIP UPDATE or SIP reINVITE to indicate a PTC media modification on a PTC session being intercepted.\nTable 7.5.2-12: Payload for PTCMediaModification record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCGroupAdvertisement record when the IRI-POI present in the PTC server detects when a PTC target sends group advertisement information to a single PTC participant, a list of PTC participants, or to all members of a PTC chat group, as well as when a PTC target receives group advertisement information from a single PTC participant, a list of PTC participants, or from members of a PTC chat group using the group identity. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following events are detected:\n-\twhen the PTC server receives a SIP MESSAGE (containing group advertisement information) from a PTC target.\n-\twhen the PTC server sends a SIP MESSAGE (containing group advertisement information) to the PTC target.\nTable 7.5.2-13: Payload for PTCGroupAdvertisement record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCFloorControl record when the IRI-POI present in the PTC server detects when the PTC target requests floor control (i.e. send media), when floor control is granted to PTC target, when floor control request from the PTC target is rejected/released, when the floor becomes open (e.g. idle), when the floor control request from the PTC target is queued, when the floor control request from the PTC target is dequeued, or when the floor control request is revoked. In addition, when the PTC chat group is the PTC target, the IRI-POI present in the PTC server hosting the PTC chat group shall generate an xIRI containing a PTCFloorControl record when the IRI-POI present in the PTC server detects any of the previously mentioned scenarios for all PTC participants participating in the PTC chat group session. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following events are detected:\n-\twhen the PTC server receives a TBCP Talk Burst Request from the PTC target.\n-\twhen the PTC server hosting the PTC chat group, where the PTC chat group is the PTC target, receives a TBCP Talk Burst Request from a PTC participant.\n-\twhen the PTC server sends a TBCP Talk Burst Granted to a PTC target.\n-\twhen the PTC server hosting the PTC chat group, where the PTC chat group is the PTC target, sends a TBCP Talk Burst Granted to a PTC participant.\n-\twhen the PTC server sends a TBCP Talk Burst Taken to a PTC target.\n-\twhen the PTC server hosting the PTC chat group, where the PTC chat group is the PTC target, sends a TBCP Talk Burst Taken to a PTC participant.\n-\twhen the PTC server sends a TBCP Talk Burst Deny to a PTC target.\n-\twhen the PTC server hosting the PTC chat group, where the PTC chat group is the PTC target, sends a TBCP Talk Burst Deny to a PTC participant.\n-\twhen the PTC server sends a TBCP Talk Burst Release to a PTC target.\n-\twhen the PTC server hosting the PTC chat group, where the PTC chat group is the PTC target, sends a TBCP Talk Burst Release to a PTC participant.\n-\twhen the PTC server sends a TBCP Talk Burst Idle to a PTC target.\n-\twhen the PTC server hosting the PTC chat group, where the PTC chat group is the PTC target, sends a TBCP Talk Burst Idle to a PTC participant.\n-\twhen the PTC server sends a TBCP Talk Burst Request Queue Status Response to a PTC target.\n-\twhen the PTC server hosting the PTC chat group, where the PTC chat group is the PTC target, sends a TBCP Talk Burst Request Queue Status Response to a PTC participant.\n-\twhen the PTC server receives a TBCP Talk Burst Cancel from a PTC target.\n-\twhen the PTC server hosting the PTC chat group, where the PTC chat group is the PTC target, receives a TBCP Talk Burst Cancel from a PTC participant.\n-\twhen the PTC server sends a TBCP Talk Burst Revoke to a PTC target.\n-\twhen the PTC server hosting the PTC chat group, where the PTC chat group is the PTC target, sends a TBCP Talk Burst Revke to a PTC participant.\nTable 7.5.2-14: Payload for PTCFloorControl record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCTargetPresence record when the IRI-POI present in the PTC server detects that the PTC server publishes network presence information to the Presence server on behalf of the PTC target. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following event is detected:\n-\twhen the PTC server sends a SIP PUBLISH message to the Presence server based on the PTC target’s PTC session involvement.\nTable 7.5.2-15: Payload for PTCTargetPresence record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCParticipantPresence record when the IRI-POI present in the PTC server (when it supports the Presence functionality and assumes the role of the Watcher on behalf of the PTC target) detects that the PTC server receives presence status notifications from the Presence servers after having subscribed to the PTC presence status of other PTC participants (i.e. participants in communication with the PTC target). Accordingly, the IRI-POI in the PTC server generates the xIRI when the following event is detected:\n-\twhen the PTC server receives a SIP NOTIFY in response to a SIP SUBSCRIBE updating presence information for a participant.\nTable 7.5.2-16: Payload for PTCParticipantPresence record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCListManagement record when the IRI-POI present in the PTC server detects that the PTC target attempts to change their contact list/group list(s) or those lists are updated by the network. Accordingly, the IRI-POI in the PTC server generates the xIRI when the following events are detected:\n-\twhen the PTC server receives a SIP PUBLISH from a PTC target to change the PTC target’s contact list or group list(s).\n-\twhen the PTC server receives a SIP NOTIFY from other PTC participants updating the PTC target’s contact list or group list(s) (e.g. participant reachability).\n\nTable 7.5.2-17: Payload for PTCListManagement record\n\nThe IRI-POI present in the PTC server shall generate an xIRI containing a PTCAccessPolicy record when the IRI-POI present in the PTC server detects when the PTC target attempts to change the access control lists (e.g. PTC user access policy and PTC group authorization rules) located in the PTC XML Document Management Server (XDMS). Accordingly, the IRI-POI in the PTC server generates the xIRI when the following event is detected:\n-\twhen the PTC server receives a SIP PUBLISH from a PTC target to change the access control lists.\n\nTable 7.5.2-18: Payload for PTCAccessPolicy record\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.5.2-1: Payload for PTCRegistration record",
                                    "table number": 300,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-2: Payload for PTCSessionInitiation record",
                                    "table number": 301,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-3: Payload for PTCSessionAbandonAttempt record",
                                    "table number": 302,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-4: Payload for PTCSessionStart record",
                                    "table number": 303,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-5: Payload for PTCSessionEnd record",
                                    "table number": 304,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-6: Payload for PTCStartOfIntercept record",
                                    "table number": 305,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-7: Payload for PTCPre-EstablishedSession record",
                                    "table number": 306,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-8: Payload for PTCInstantPersonalAlert record",
                                    "table number": 307,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-9: Payload for PTCPartyJoin record",
                                    "table number": 308,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-10: Payload for PTCPartyDrop record",
                                    "table number": 309,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-11: Payload for PTCPartyHold record",
                                    "table number": 310,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-12: Payload for PTCMediaModification record",
                                    "table number": 311,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-13: Payload for PTCGroupAdvertisement record",
                                    "table number": 312,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-14: Payload for PTCFloorControl record",
                                    "table number": 313,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-15: Payload for PTCTargetPresence record",
                                    "table number": 314,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-16: Payload for PTCParticipantPresence record",
                                    "table number": 315,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-17: Payload for PTCListManagement record",
                                    "table number": 316,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.5.2-18: Payload for PTCAccessPolicy record",
                                    "table number": 317,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.5.3\tIRI and CC Generation",
                            "text_content": "When an xIRI is received over LI_X2 from the IRI-POI in the PTC server, the MDF2 shall generate the corresponding IRI message and deliver it over LI_HI2 without undue delay. The IRI shall contain a copy of the record received over LI_X2. This record may be enriched with any additional information available at the MDF2 (e.g. additional location information).\nWhen xCC is received over LI_X3 from the CC-POI in the PTC server, the MDF3 shall populate the threeGPP33128DefinedCC field with a CCPayload structure containing PTCCCPDU and send it over LI_HI3 interface to LEMF without undue delay.\nThe PTC media contents are structured in a CC payload as formatted in clause 5.5.3 of the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.6\tIdentifier Association Reporting",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.6.1\tGeneral",
                            "text_content": "The IEF, ICF and IQF are responsible for detecting, storing and providing to the LEA permanent to temporary identifier associations, requested by the LEA in authorised requests. The IEF as defined in clause 6.2.2A is responsible for detecting and generating identifier associations records. The ICF is responsible for caching identifier associations for short duration and the IQF is responsible for handling requests from the LEA and providing those requests to the ICF in order to identify the matching identifier associations.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.2\tICF",
                            "text_content": "The ICF is responsible for caching identifier associations provided in event records from the IEF over LI_XER and handling queries and subsequent responses from the IQF for responses over LI_XQR.\nWhen the ICF receives an identifier association event record over LI_XER from an IEF (see clause 5.9), the ICF shall use the records to update the identifier associations cached by the ICF. The ICF shall handle the event records as described in clause 7.6.2.4.\nWhen the ICF receives an identifier association query request from the IQF, the ICF shall search the cached identifier associations to establish a match, based on RequestValues received in the request (see clause 5.8), subject to clause 7.6.2.4.\nUpon successful matching of one or more identifier associations which were active at or around (within a pre-defined search time window) the observed time specified in the query, the ICF shall provide a response to the IQF using the IdentityAssociationResponse message as defined in clause 5.8. Where the ICF is not able to provide a single identifier association based on the RequestValues, the IQF is responsible for any subsequent handling of multiple identifier associations in terms of whether to provide all associations to the LEA over LI_HIQR.\nUpon receipt of an Association event as defined in clause 6.2.2A.2, the ICF shall cache the identifier association(s) contained within the record as followings:\n-\tSUPI to 5G-GUTI association received, in an IEFAssociationRecord is stored by ICF as an active association. The previous active association for the same SUPI, if any, is marked as a previously active association and cached until the cache time limit is reached.\n-\tIf the IEFAssociationRecord also contains a SUCI, the SUCI is stored as a part of the received SUPI to 5G-GUTI association, for the lifetime of that association.\n-\tWhere the IEFDeassociationRecord corresponds to an active SUPI to 5G-GUTI association at ICF, the association is marked as a previously active association and cached until the cache time limit is reached.\nThe ICF shall have a CSP defined maximum active association lifetime (upon expiry of which the association is deleted from the ICF).\nNOTE 1:\tThis is needed to prevent an association from not being deleted from ICF under some error conditions (e.g. a loss of IEF message carrying IEFDeassociationRecord caused by the implicit deregistration of an out-of-service UE). The selection of the maximum active association lifetime value needs to ensure that no valid active associations are deleted upon the lifetime expiry, i.e. the longest possible association refresh time supported by CSP’s network needs to be accommodated.\nFor previous associations placed in the cache, the ICF shall store the times of association and disassociation, respectively.\nWhere an IEFAssociationRecord contains a PEI, GPSI, NCGI or a TAI list, the ICF shall store the received values and associate them both the current received SUPI to 5G-GUTI association and any future association until:\n-\tA subsequent IEFAssociationRecord is received which updates the PEI, GPSI, NCGI or TAI list values.\n-\tThe old PEI / GPSI / NCGI / TAI list shall be retained in association with previous SUPI to 5G-GUTI associations until those associations are deleted from cache.\n-\tNew PEI / GPSI / NCGI / TAI list shall be used in association with both the association(s) with which it was received and any subsequent associations until another update is received.\n-\tAll SUPI associations for which the PEI / GPSI / NCGI / TAI list is valid are deleted from the cache.\nWhen the ICF receives a query request from the IQF as defined in clause 7.6.2.3, the ICF shall search available identifier associations (both active associations and those marked for deletion in the cache) for a match. The ICF shall be able to use both time and TAI (as a single TAI and in relation to a TAI list) to identify the correct SUPI to 5G-GUTI association(s). For associations which have been disassociated (and will be deleted once the cache time limit is reached), the time of disassociation is used by the ICF to identify the correct association match (based on observed time in LEA request), where multiple associations are held in the cache.\nNOTE 2:\tUse of nCGI to match associations based on physical location for SUCI / 5G-S-TMSI to SUPI requests, is out of scope of the present document.\nAs the LEA and CSP are unlikely to have synchronised the time of identifier observation / association provided by the LEA in the query request, with NF time of the IEFs, the ICF shall search the cached identifier associations using a short window time duration both before and after (subject to overall cache duration) the observed time provided by the LEA in the RequestValues over LI_XQR.\nNOTE 3:\tWhile the search window duration before and after the LEA provided observed time value is outside the scope of the present document, selection of this value by the CSP needs to take into consideration, among other aspects, the duration of a potential period of recovery from a 5G-GUTI update error, in order to prevent missing of otherwise matching associations due to discrepancies between their stored association/disassociation time and the observed time provided by LEA.\nNOTE 4:\tWhile the value of the short-term caching time is outside the scope of the present document, selection of this value by the CSP needs to take into consideration, among other aspects, the duration of potential period of recovery from a 5G-GUTI update error, in order to prevent previous associations being deleted before they have been fully disassociated by both the UE and AMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.6.3\tIQF",
                            "text_content": "The IQF is responsible for receiving and responding to LEA requests over LI_HIQR. Following receipt of a request over LI_HIQR, the IQF shall validate the request and ensure that the request is within the cache period of associations stored in the ICF. If the request is valid and within the ICF cache period, the IQF shall send an association search request to the ICF over LI_XQR. If the request is not within the ICF cache period or overwise invalid, the IQF shall reject the request and respond to the LEA over LI_HIQR.\nFollowing receipt of an association search request response from the ICF over LI_XQR, the IQF shall forward any matching identifier association(s) to the LEA over LI_HIQR. If the ICF indicates zero matches were found based on the information provided in the initial request over LI_HIQR, the IQF shall respond to the LEA over LI_HIQR indicating that no identifier associations were found based on the request from the LEA.\nIf the ICF responds with multiple associations of 5G-GUTIs / SUCIs to a single SUPI, the IQF shall provide all matched associations to the LEA over LI_HIQR. Handling in the case of multiple SUPIs to a single 5G-GUTI (where the initial request over LI_HIQR is based on 5G-S-TMSI or SUCI) is outside the scope of the present document.\nThe IQF is responsible for receiving query requests from and providing query responses to the LEA over LI_HIQR. Further details of LI_HIQR messages are defined in clause 5.7.\nThe IQF is responsible for generating queries to and receiving query responses requests from the ICF over LI_XQR, based on queries received from the LEA over LI_HIQR. Further details of LI_XQR messages are defined in clause 5.8.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.7\tLI at NEF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.7.1\tProvisioning over LI_X1",
                            "text_content": "For NIDD using NEF:\n-\tIf delivery type for the warrant is \"IRI and CC\", then the IRI-POI and the CC-POI in the NEF, the MDF2 and MDF3 shall be provisioned.\n-\tIf delivery type for the warrant is \"IRI\", then the IRI-POI in the NEF and the MDF2 shall be provisioned.\n-\tDelivery type \"CC\" is not applicable to the warrant.\nFor device triggering, MSISDN-less MO SMS and Parameter Provisioning:\n-\tthe delivery type for the warrant is \"IRI\"; the IRI-POI in the NEF and the MDF2 shall be provisioned.\nThe IRI-POI and CC-POI present in the NEF are provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nThe POI in the NEF shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):\n-\tSUPIIMSI.\n-\tSUPINAI.\n-\tGPSIMSISDN.\n-\tGPSINAI.\nNOTE:\tFor Parameter Provisioning, only GPSIMSISDN and GPSINAI are applicable.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.7.2\tLI for NIDD using NEF",
                            "text_content": "The IRI-POI present in the NEF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.9.2.3, the details of which are described in the following clauses. Each event will be based on PDU session between NEF and target UE, except for Unsuccessful Procedure event. The IRI-POI in the NEF shall also send a SeparatedLocationReporting xIRI (as described in clause 7.3.4.1) when the IRI-POI provisioned in the NEF receives updated UE location information via the Nnef_Location_LocationUpdateNotify service operation destined for an external AF.\nThe IRI-POI in the NEF shall generate an xIRI containing an NEFPDUSessionEstablishment record when the IRI-POI present in the NEF detects that an unstructured PDU session using NEF has been established for the target UE. The IRI-POI present in the NEF shall generate the xIRI for the following event:\n-\tNEF returns Nnef_SMContext_Create Response towards the SMF confirming the establishment of the unstructured PDU session to the NEF for the target UE (as defined in TS 29.541 [57] clause 5.2.2.2) and connection to the AF is established.\nTable 7.7.2-1: NEFPDUSessionEstablishment record\n\nThe IRI-POI in the NEF shall generate an xIRI containing an NEFPDUSessionModification record when the IRI-POI present in the NEF detects that an unstructured PDU session using NEF has been modified for the target UE. The IRI-POI present in the NEF shall generate the xIRI for the following events:\n-\tNEF returns Nnef_SMContext_Update Response to SMF to confirm the modification of the connection between SMF and NEF (see TS 29.541 [57] clause 5.2.2.5).\n-\tNEF returns a RDS MANAGE PORT Response to a UE with a \"Status\" field set to \"Success\" in response to a RDS MANAGE PORT command sent by UE with an \"Action\" field set to \"Reserve port\" to confirm the reservation of a combination of source and destination port numbers for use for a traffic to be sent by the UE to a specific application on an AF (see TS 24.250 [61] clause 5.4.2.6.2).\n-\tNEF receives a RDS MANAGE PORT Response from a UE with a \"Status\" field set to \"Success\" in response to a RDS MANAGE PORT command sent by the NEF with an \"Action\" field set to \"Reserve port” to confirm the reservation of a combination of source and destination port numbers for use for a traffic to be sent by an AF to a specific application on the UE (see TS 24.250 [61] clause 5.4.2.6.2).\n-\tNEF returns a RDS MANAGE PORT Response to a UE with a \"Status\" field set to \"Success\" in response to a RDS MANAGE PORT command sent by UE with an \"Action\" field set to \"Release port\" to confirm the release of a combination of source and destination port numbers for an application on an AF (see TS 24.250 [61] clause 5.4.2.6.3).\n-\tNEF receives a RDS MANAGE PORT Response from a UE with a \"Status\" field set to \"Success\" in response to a RDS MANAGE PORT command sent by the NEF with an \"Action\" field set to \"Release port\" to confirm the release of a combination of source and destination port numbers for an application on the UE (see TS 24.250 [61] clause 5.4.2.6.3).\nTable 7.7.2-2: NEFPDUSessionModification record\n\nThe IRI-POI in the NEF shall generate an xIRI containing an NEFPDUSessionRelease record when the IRI-POI present in the NEF detects that an unstructured PDU session using NEF related to the target UE needs to be released. The IRI-POI present in the NEF shall generate the xIRI for the following events:\n-\tNEF notifies the SMF that the SMF-NEF Connection for NIDD via NEF is no longer valid using Nnef_SMContext_DeleteNotify service operation when NEF receives a notification from the UDM that the NIDD authorization has ended. NEF releases the SM Context for NIDD on NEF as described in TS 29.541 [57] clause 5.2.2.4. This corresponds to NEF Initiated SMF-NEF Connection Release procedure.\n-\tNEF returns Nnef_SMContext_Delete Response towards SMF confirming release of the SMF-NEF session for the target UE. In this scenario, SMF releases the SM Context for NIDD on NEF as specified in TS 29.541 [57] clause 5.2.2.3).\nTable 7.7.2-3: NEFPDUSessionRelease record\n\nThe IRI-POI in the NEF shall generate an xIRI containing an NEFUnsuccessfulProcedure record when the IRI-POI present in the NEF detects an unsuccessful procedure or error condition for a UE matching one of the target identifiers provided via LI_X1.\nAccordingly, the IRI-POI in the NEF generates the xIRI when one of the following events are detected as described in TS 29.541 [57] clause 6.1.7.3 and TS 24.250 [61] clause 5.4.2.6:\n-\tNEF sends a Nnef_SMContext_Create Reject message to the SMF with a reject cause set to \"USER_UNKNOWN\" or \"NIDD_CONFIGURATION_NOT_AVAILABLE\".\n-\tNEF returns a RDS MANAGE PORT Response to a UE with a \"Status\" field set to \"Port not free\" in response to a RDS MANAGE PORT command sent by UE with an \"Action\" field set to \"Reserve port\".\n-\tNEF receives a RDS MANAGE PORT Response from a UE with a \"Status\" field set to \"Port not free\" in response to a RDS MANAGE PORT command sent by NEF with an \"Action\" field set to \"Reserve port\".\n-\tNEF returns a RDS MANAGE PORT Response to a UE with a \"Status\" field set to \"Port not associated with specified application\" in response to a RDS MANAGE PORT command sent by UE with an \"Action\" field set to \"Release port\".\n-\tNEF receives a RDS MANAGE PORT Response from a UE with a \"Status\" field set to \"Port not associated with specified application\" in response to a RDS MANAGE PORT command sent by NEF with an \"Action\" field set to \"Release port\".\nTable 7.7.2-4: NEFUnsuccessfulProcedure record\n\nThe IRI-POI in the NEF shall generate an xIRI containing an NEFStartOfInterceptionWithEstablishedPDUSession record when the IRI-POI present in the NEF detects that an unstructured PDU session using NEF has already been established, at the time the POI on NEF is provisioned with a new target ID.\nThe IRI-POI in the NEF shall generate the xIRI containing the NEFStartOfInterceptionWithEstablishedPDUSession record for each of the PDU sessions for NIDD using NEF associated with the target UE with a different value of correlation information.\nTable 7.7.2-5: NEFStartOfInterceptionWithEstablishedPDUSession record\n\nThe IRI-POI present in the SMF generating an xIRI containing a NEFStartOfInterceptionWithEstablishedPDUSession record shall set the Payload Direction field in the PDU header to not applicable (see ETSI TS 103 221-2 [8] clause 5.2.6).\nThe CC-POI present in the NEF shall send xCC over LI_X3 for each NIDD packet.\nEach X3 PDU shall contain the contents of the user plane packet (i.e. NIDD) using an unstructured payload format.\nThe CC-POI present in the NEF shall set the payload format to indicate the appropriate payload type (i.e. unstructured payload) as described in ETSI TS 103 221-2 [8] clause 5.4.\nWhen an xIRI is received over LI_X2 from the IRI-POI in the NEF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the NEF event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.7.2-6.\nTable 7.7.2-6: IRI type for IRI messages\n\nIRI messages associated with the same PDU Session shall be assigned the same CIN (see ETSI TS 102 232-1 [9] clause 5.2.4).\nThe threeGPP33128DefinedIRI field (see ETSI TS 102 232-7 [10] clause 15) shall be populated with the BER-encoded IRIPayload.\nWhen xCC is received over LI_X3 from the CC-POI in the NEF, the MDF3 shall populate the threeGPP33128DefinedCC field with a CCPayload structure containing NIDDCCPDU and send it over LI_HI3 interface to LEMF without undue delay.\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time that the NEF observed the data (i.e. the timestamp field of the xCC). The LIID and CID fields shall correctly reflect the target identity and communication session to which the CC belongs.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.7.2-1: NEFPDUSessionEstablishment record",
                                    "table number": 318,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.2-2: NEFPDUSessionModification record",
                                    "table number": 319,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.2-3: NEFPDUSessionRelease record",
                                    "table number": 320,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.2-4: NEFUnsuccessfulProcedure record",
                                    "table number": 321,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.2-5: NEFStartOfInterceptionWithEstablishedPDUSession record",
                                    "table number": 322,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.2-6: IRI type for IRI messages",
                                    "table number": 323,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.7.3\tLI for device triggering",
                            "text_content": "The IRI-POI present in the NEF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.9.3.4, the details of which are described in the following clauses.\nThe IRI-POI in the NEF shall generate an xIRI containing a NEFDeviceTrigger record when the IRI-POI present in the NEF detects that an AF has sent a Device trigger to a target UE matching one of the target identifiers.\nAccordingly, the IRI-POI in the NEF generates the xIRI when any of the following events is detected:\n-\tNEF sends a Nnef_Trigger_Delivery Response to the AF to acknowledge the reception of Nnef_Trigger_Delivery Request with GPSI matching the target identifier (see TS 23.502 [4] clause 4.13.2.1 and TS 29.522 [58] clause 4.4.3).\n-\tNEF sends a T4 Device-Trigger-Request (DTR) to SM-SC with Trigger-Action AVP set to TRIGGER and User-Identifier AVP matching the SUPI of the target UE as described in TS 29.337 [60] clause 5.2.1.\nTable 7.7.3-1: NEFDeviceTrigger record\n\nThe IRI-POI in the NEF shall generate an xIRI containing a NEFDeviceTriggerReplace record when the IRI-POI present in the NEF detects that an AF has sent a Device trigger replacement for a previously sent Device trigger to a UE matching one of the target identifiers provided via LI_X1 to the IRI POI in the NEF. It replaces a previously submitted Device trigger message which has not yet been delivered to the UE.\nAccordingly, the IRI-POI in the NEF generates the xIRI when any of the following events is detected:\n-\tNEF receives a Nnef_Trigger_Delivery Request (for a device trigger replacement) from an AF as described in TS 29.522 [58] clause 4.4.3 with GPSI matching the target identifier.\n-\tNEF sends a T4 Device-Trigger-Request (DTR) to SM-SC with Trigger-Action AVP set to REPLACE and User-Identifier AVP matching the SUPI of the target UE as specified in 29.337 [60] clause 5.2.1.\nTable 7.7.3-2: NEFDeviceTriggerReplace record\n\nThe IRI-POI in the NEF shall generate an xIRI containing a NEFDeviceTriggerCancellation record when the IRI-POI present in the NEF detects that an AF has sent a Device trigger cancellation for a previously sent Device trigger to a UE matching one of the target identifiers provided via LI_X1 to the IRI-POI in the NEF. It cancels previously submitted Device trigger message which has not yet been delivered to the target UE.\nAccordingly, the IRI-POI in the NEF generates the xIRI when any of the following events is detected:\n-\tNEF receives a Nnef_Trigger_Delivery Request (for a device trigger cancellation) with GPSI matching the target identifier as described in TS 29.522 [58] clause 4.4.3.\n-\tNEF sends a T4 Device-Trigger-Request (DTR) to SM-SC with Trigger-Action AVP set to RECALL and User-Identifier AVP matching the SUPI of the target UE as specified in TS 29.337 [60] clause 5.2.1.\nTable 7.7.3-3: NEFDeviceTriggerCancellation record\n\nThe IRI-POI in the NEF shall generate an xIRI containing a NEFDeviceTriggerReportNotify record when the IRI-POI present in the NEF detects that the NEF has returned a Device trigger report to the AF with a cause value indicating the trigger delivery outcome (e.g. succeeded, unknown or failed).\nAccordingly, the IRI-POI in the NEF generates the xIRI when any of the following events is detected:\n-\tNEF sends a Nnef_Trigger_DeliveryNotify service operation with the GPSI of the target UE to inform the AF on the delivery outcome of the device trigger as described in TS 29.522 [58] clause 4.4.3.\n-\tSM-SC sends a T4 Delivery-Report-Request (DRR) to the NEF with User-Identifier matching the SUPI of the target UE as specified in 29.337 [60] clause 5.2.2.\nTable 7.7.3-4: NEFDeviceTriggerReportNotify record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in the NEF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the NEF event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.7.3-5.\nTable 7.7.3-5: IRI type for IRI messages\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.7.3-1: NEFDeviceTrigger record",
                                    "table number": 324,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.3-2: NEFDeviceTriggerReplace record",
                                    "table number": 325,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.3-3: NEFDeviceTriggerCancellation record",
                                    "table number": 326,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.3-4: NEFDeviceTriggerReportNotify record",
                                    "table number": 327,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.3-5: IRI type for IRI messages",
                                    "table number": 328,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.7.4\tLI for MSISDN-less MO SMS",
                            "text_content": "The IRI-POI present in the NEF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.9.4.4, the details of which are described in the following clauses.\nThe IRI-POI in the NEF shall generate an xIRI containing a NEFMSISDNLessMOSMS record when the IRI-POI present in the NEF detects that a target UE has sent a MSISDN-less MO SMS to an AF.\nAccordingly, the IRI-POI in the NEF generates the xIRI when any of the following events is detected:\n-\tNEF receives a SGd MO-Forward-Short-Message-Request (OFR) from an SM-SC with SUPI matching the target identifier (see TS 29.338 [59] clause 6.2.1).\n-\tNEF sends a Nnef_MSISDN-less_MO_SMSNotify service operation to the AF with the GPSI of the target UE sending the MSISDN-less SMS as described in TS 29.522 [58] clause 4.4.10.\nTable 7.7.4-1: NEFMSISDNLessMOSMS record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in the NEF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the NEF event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.7.4-2.\nTable 7.7.4-2: IRI type for IRI messages\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.7.4-1: NEFMSISDNLessMOSMS record",
                                    "table number": 329,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.4-2: IRI type for IRI messages",
                                    "table number": 330,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.7.5\tLI for parameter provisioning",
                            "text_content": "The IRI-POI present in the NEF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.9.5.4, the details of which are described in the following clauses.\nThe IRI-POI in the NEF shall generate an xIRI containing an NEFExpectedUEBehaviorUpdate record when the IRI-POI present in the NEF detects that an AF has updated the UE Expected behavior data.\nAccordingly, the IRI-POI in the NEF generates the xIRI when any of the following events is detected (see TS 29.503 [25] clauses 5.6.2.1 and 6.1.6.2.49):\n-\tNEF receives a NEF_ParameterProvision_Create Request or NEF_ParameterProvision_Update Request from an AF, related to the target UE.\n-\tNEF receives a NEF_ParameterProvision_Delete Request from an AF to delete the existing UE Expected Behaviour parameters related to the target UE.\n-\tNEF returns a NEF_ParameterProvision_Get Response containing the UE Expected Behavior of the target UE to the querying AF.\nTable 7.7.5-1: NEFExpectedUEBehaviorUpdate record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in the NEF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the NEF event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.7.5-2.\nTable 7.7.5-2: IRI type for IRI messages\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.7.5-1: NEFExpectedUEBehaviorUpdate record",
                                    "table number": 331,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.5-2: IRI type for IRI messages",
                                    "table number": 332,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.7.6\tLI for AF session with QoS",
                            "text_content": "The IRI-POI present in the NEF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.9.6.4, the details of which are described in the following clauses.\nThe IRI-POI in the NEF shall generate an xIRI containing an NEFAFSessionWithQoSProvision record when the IRI-POI present in the NEF detects that an AF has requested the NEF to provide, update or revoke a specific QoS for an AF session.\nAccordingly, the IRI-POI in the NEF generates the xIRI when any of the following events is detected (see TS 29.522 [58] clause 4.4.9):\n-\tNEF returns a Nnef_AFsessionWithQoS_Create Response in response to Nnef_AFsessionWithQoS_Create Request received from an AF to provide a specific QoS for an AF session related to a target UE.\n-\tNEF returns a Nnef_AFsessionWithQoS_Update Response in response toNnef_ AFsessionWithQoS_Update Request received from an AF to update the QoS for an AF session related to a target UE.\n-\tNEF returns a Nnef_AFsessionWithQoS_Revoke Response in response to Nnef_ AFsessionWithQoS_Revoke Request received from an AF to revoke the QoS for an AF session related to a target UE.\nTable 7.7.6.1.2-1: NEFAFSessionWithQoSProvision record\n\nThe IRI-POI in the NEF shall generate an xIRI containing an NEFAFSessionWithQoSNotification record when the IRI-POI present in the NEF detects that the NEF has notified the AF about the outcome of QoS reservation or update.\nAccordingly, the IRI-POI in the NEF generates the xIRI when any of the following events is detected (see TS 29.522 [58] clauses 4.4.9):\n-\tNEF receives a Nnef_AFsessionWithQoS_Notify Response in response to Nnef_AFsessionWithQoS_Notify Request sent to AF to notify changes in the transmission resource status of an AF session associated with the target UE.\nTable 7.7.6.1.3-1: NEFAFSessionWithQoSNotification record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in the NEF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the NEF event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.7.6.2-1.\nTable 7.7.6.2-1: IRI type for IRI messages\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.7.6.1.2-1: NEFAFSessionWithQoSProvision record",
                                    "table number": 333,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.6.1.3-1: NEFAFSessionWithQoSNotification record",
                                    "table number": 334,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.7.6.2-1: IRI type for IRI messages",
                                    "table number": 335,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "7.8\tLI at SCEF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.8.1\tProvisioning over LI_X1",
                            "text_content": "For NIDD using SCEF:\n-\tIf delivery type for the warrant is \"IRI and CC\", then the IRI-POI and the CC-POI in the SCEF, the MDF2 and MDF3 shall be provisioned.\n-\tIf delivery type for the warrant is \"IRI\", then the IRI-POI in the SCEF and the MDF2 shall be provisioned.\n-\tDelivery type \"CC\" is not applicable to the warrant.\nFor device triggering, MSISDN-less MO SMS and Parameter Provisioning:\n-\tthe delivery type for the warrant is \"IRI\"; the IRI-POI in the SCEF and the MDF2 shall be provisioned.\nThe IRI-POI and CC-POI present in the SCEF are provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nThe POI in the SCEF shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):\n-\tIMSI.\n-\tMSISDN.\n-\tExternal Identifier.\nNOTE:\tFor Parameter Provisioning, only MSISDN and External Identifier are applicable.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.8.2\tLI for NIDD using SCEF",
                            "text_content": "The IRI-POI present in the SCEF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.8.2.3, the details of which are described in the following clauses. Each event will be based on PDN Connection between SCEF and target UE, except in case of Unsucessful Procedure.\nThe IRI-POI in the SCEF/IWK-SCEF shall generate an xIRI containing an SCEFPDNConnectionEstablishment record when the IRI-POI present in the SCEF/IWK-SCEF detects that a Non-IP PDN Connection using SCEF has been established by the target UE. The IRI-POI present in the SCEF/IWK-SCEF shall generate the xIRI for the following events (see TS 29.128 [62], clause 5.8):\n-\tthe SCEF/IWK-SCEF sends a T6a/T6ai Connection Management Answer to MME as a response to a T6a/T6ai Connection Management Request received with User-Identifier AVP including the set of identities of the UE, i.e. IMSI/MSISDN/External Identifier matching the target Identifier and Connection-Action AVP set to CONNECTION_ESTABLISHMENT to confirm the establishment of a Non-IP PDN connection.\n-\tin roaming situation SCEF sends a T7 Connection Management Answer to IWK-SCEF as a confirmation to the T7 Connection Management Request received with User-Identifier AVP including the set of identities of the UE, i.e. IMSI/MSISDN/External Identifier matching the target Identifier and with Connection-Action AVP set to CONNECTION_ESTABLISHMENT.\nTable 7.8.2-1: SCEFPDNConnectionEstablishment record\n\nThe IRI-POI in the SCEF/IWK-SCEF shall generate an xIRI containing an SCEFPDNConnectionUpdate record when the IRI-POI present in the SCEF/IWK-SCF detects that a Non-IP PDN Connection has been updated for the target UE. The IRI-POI present in the SCEF/IWK-SCEF shall generate the xIRI for the following events:\n-\tSCEF/IWK-SCEF sends a T6a/T6ai Connection Management Answer to confirm the T6a/T6ai Connection Management Request received with User-Identifier AVP including the set of identities of the UE, i.e. IMSI/MSISDN/External Identifier matching the target Identifier and with Connection-Action AVP set to CONNECTION_UPDATE as described in TS 29.128 [62] clause 5.7.\n-\tSCEF/IWK-SCEF receives a T6a/T6ai Connection Management Answer from MME which confirms the T6a/T6ai Connection Management Request sent by SCEF/IWK-SCEF with User-Identifier AVP including the set of identities of the UE, i.e. IMSI/MSISDN/External Identifier matching the target Identifier and with Connection-Action AVP set to CONNECTION_UPDATE as described in TS 29.128 [62] clause 5.8.\n-\tin roaming situation SCEF sends a T7 Connection Management Answer to IWK-SCEF to confirm the T7 Connection Management Request received with User-Identifier AVP including the set of identities of the UE, i.e. IMSI/MSISDN/External Identifier matching the target Identifier and with Connection-Action AVP set to CONNECTION_UPDATE as described in TS 29.128 [62] clause 5.7.\n-\tin roaming situation SCEF receives a T7 Connection Management Answer from IWK-SCEF which confirms the T7 Connection Management Request with User-Identifier AVP including the set of identities of the UE, i.e. IMSI/MSISDN/External Identifier matching the target Identifier and with Connection-Action AVP set to CONNECTION_UPDATE as described in TS 29.128 [62] clause 5.8.\n-\tSCEF returns a RDS MANAGE PORT Response to a UE with a \"Status\" field set to \"Success\" in response to a RDS MANAGE PORT command sent by UE with an \"Action\" field set to \"Reserve port\" to confirm the reservation of a combination of source and destination port numbers for use for a traffic to be sent by the UE to a specific application on an SCS/AS (see TS 24.250 [61] clause 5.4.2.6.2).\n-\tSCEF receives a RDS MANAGE PORT Response from a UE with a \"Status\" field set to \"Success\" in response to a RDS MANAGE PORT command sent by the SCEF with an \"Action\" field set to \"Reserve port\" to confirm the reservation of a combination of source and destination port numbers for use for a traffic to be sent by an SCS/AS to a specific application on the UE (see TS 24.250 [61] clause 5.4.2.6.2).\n-\tSCEF returns a RDS MANAGE PORT Response to a UE with a \"Status\" field set to \"Success\" in response to a RDS MANAGE PORT command sent by UE with an \"Action\" field set to \"Release port\" to confirm the release of a combination of source and destination port numbers for an application on an SCS/AS (see TS 24.250 [61] clause 5.4.2.6.3).\n-\tSCEF receives a RDS MANAGE PORT Response from a UE with a \"Status\" field set to \"Success\" in response to a RDS MANAGE PORT command sent by the SCEF with an \"Action\" field set to \"Release port\" to confirm the release of a combination of source and destination port numbers for an application on the UE (see TS 24.250 [61] clause 5.4.2.6.3).\nTable 7.8.2-2: SCEFPDNConnectionUpdate record\n\nThe IRI-POI in the SCEF/IWK-SCEF shall generate an xIRI containing an SCEFPDNConnectionRelease record when the IRI-POI present in the SCEF/IWK-SCEF detects that a Non-IP PDN Connection needs to be released for the target UE. The IRI-POI present in the SCEF/IWK-SCEF shall generate the xIRI for the following events:\n-\tSCEF/IWK-SCEF informs MME that the Non-IP PDN Connection for NIDD is no longer valid using T6a Connection Management Request with User-Identifier AVP including the set of identities of the UE, i.e. IMSI/MSISDN/External Identifier matching the target Identifier and Connection-Action AVP set to CONNECTION_RELEASE. SCEF initiates the release of the Non-IP PDN connection when it is notified by the HSS about the end of NIDD authorization for the target UE (see TS 29.128 [62] clause 5.8).\n-\tSCEF sends a T6a Connection Management Answer to MME to confirm the T6a Connection Management Request received with User-Identifier AVP including the set of identities of the UE, i.e. IMSI/MSISDN/External Identifier matching the target Identifier and with Action-Action AVP set to CONNECTION_RELEASE (see TS 29.128 [62] clause 5.7).\n-\tSCEF informs IWK-SCEF that the Non-IP PDN Connection for NIDD is no longer valid using T6a Connection Management Request with User-Identifier AVP including the set of identities of the UE, i.e. IMSI/MSISDN/External Identifier matching the target Identifier and Connection-Action AVP set to CONNECTION_RELEASE (see TS 29.128 [62] clause 5.8).\n-\tSCEF sends a T7 Connection Management Answer to IWK-SCEF to confirm the T7 Connection Management Request with User-Identifier AVP including the set of identities of the UE, i.e. IMSI/MSISDN/External Identifier matching the target Identifier and with Action AVP set to CONNECTION_RELEASE (see TS 29.128 [62] clause 5.7).\nTable 7.8.2-3: SCEFPDNConnectionRelease record\n\nThe IRI-POI in the SCEF/IWK-SCEF shall generate an xIRI containing an SCEFUnsuccessfulProcedure record when the IRI-POI present in the SCEF/IWK-SCEF detects an unsuccessful procedure or error condition for a target UE matching one of the target identifiers provided via LI_X1.\nAccordingly, the IRI-POI in the SCEF/IWK-SCEF generates the xIRI when any of the following events is detected (see TS 29.128 [62] clause 6.3.3 and TS 24.250 [61] clause 5.4.2.6):\n-\tSCEF sends a T6a Connection Management Answer with Experimental-Result AVP set to DIAMETER_ERROR_USER_UNKNOWN.\n-\tSCEF sends a T6a Connection Management Answer with Experimental-Result AVP set to DIAMETER_ERROR_OPERATION_NOT_ALLOWED when Action AVP of the T6a Connection Management Request received by the SCEF is not set to CONNECTION_ESTABLISHMENT, CONNECTION_UPDATE or CONNECTION_ RELEASE.\n-\tSCEF sends a T6a Connection Management Answer with Experimental-Result AVP set to DIAMETER_ERROR_NIDD_CONFIGURATION_NOT_AVAILABLE when Action AVP of the T6a Connection Management Request received by the SCEF is set to CONNECTION_ESTABLISHMENT and the NIDD configuration for the target UE does not exist or fails at SCEF.\n-\tSCEF sends a T6a Connection Management Answer with Experimental-Result AVP set to DIAMETER_ERROR_INVALID_EPS_BEARER when Action AVP of the T6a Connection Management Request received by the SCEF is set to CONNECTION_UPDATE or CONNECTION_RELEASE and the EPS Bearer Identity does not exist.\n-\tSCEF returns a RDS MANAGE PORT Response to a UE with a \"Status\" field set to \"Port not free\" in response to a RDS MANAGE PORT command sent by UE with an \"Action\" field set to \"Reserve port\".\n-\tSCEF receives a RDS MANAGE PORT Response from a UE with a \"Status\" field set to \"Port not free\" in response to a RDS MANAGE PORT command sent by SCEF with an \"Action\" field set to \"Reserve port\".\n-\tSCEF returns a RDS MANAGE PORT Response to a UE with a \"Status\" field set to \"Port not associated with specified application\" in response to a RDS MANAGE PORT command sent by UE with an \"Action\" field set to \"Release port\".\n-\tSCEF receives a RDS MANAGE PORT Response from a UE with a \"Status\" field set to \"Port not associated with specified application\" in response to a RDS MANAGE PORT command sent by SCEF with an \"Action\" field set to \"Release port\".\nTable 7.8.2-4: SCEFUnsuccessfulProcedure record\n\nThe IRI-POI in the SCEF/IWK-SCEF shall generate an xIRI containing an SCEFStartOfInterceptionWithEstablishedPDNConnection record when the IRI-POI present in the SCEF detects that a Non-IP PDN Connection using SCEF has already been established for the target UE when interception starts.\nIn a non-roaming scenario, the IRI-POI in the SCEF (or in a roaming scenario, the IRI-POI in the IWK-SCEF in the VPLMN) shall generate the xIRI containing the SCEFStartOfInterceptionWithEstablishedPDNConnection record when it detects that a new interception for a UE is activated (i.e. provisioned by the LIPF) for the following case:\n-\tA PDN connection to the SCEF for the target UE exists, uniquely identified by an EPS Bearer Identity, APN, and UE Identity.\nThe IRI-POI in the SCEF/IWK-SCEF shall generate the xIRI containing the SCEFStartOfInterceptionWithEstablishedPDNConnection record for each of the PDN Connections for NIDD using SCEF associated with the target UE.\nTable 7.8.2-5: SCEFStartOfInterceptionWithEstablishedPDNConnection record\n\nThe IRI-POI present in the SMF generating an xIRI containing a SCEFStartOfInterceptionWithEstablishedPDUSession record shall set the Payload Direction field in the PDU header to not applicable (see ETSI TS 103 221-2 [8] clause 5.2.6).\nThe CC-POI present in the SCEF shall send xCC over LI_X3 for each NIDD packet.\nEach X3 PDU shall contain the contents of the user plane packet (i.e. NIDD) using an unstructured payload.\nThe CC-POI present in the SCEF shall set the payload format to indicate the appropriate payload type (i.e. unstructured payload) as described in ETSI TS 103 221-2 [8] clause 5.4.\nWhen an xIRI is received over LI_X2 from the IRI-POI in the SCEF/IWK-SCEF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the SCEF event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.8.2-6.\nTable 7.8.2-6: IRI type for IRI messages\n\nIRI messages associated with the same PDU Session shall be assigned the same CIN (see ETSI TS 102 232-1 [9] clause 5.2.4).\nThe threeGPP33128DefinedIRI field (see ETSI TS 102 232-7 [10] clause 15) shall be populated with the BER-encoded IRIPayload.\nWhen xCC is received over LI_X3 from the CC-POI in the SCEF, the MDF3 shall populate the threeGPP33128DefinedCC field with a CCPayload structure containing NIDDCCPDU and send it over LI_HI3 interface to LEMF without undue delay.\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time that the SCEF observed the data (i.e. the timestamp field of the xCC). The LIID and CID fields shall correctly reflect the target identity and communication session to which the CC belongs.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.8.2-1: SCEFPDNConnectionEstablishment record",
                                    "table number": 336,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.2-2: SCEFPDNConnectionUpdate record",
                                    "table number": 337,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.2-3: SCEFPDNConnectionRelease record",
                                    "table number": 338,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.2-4: SCEFUnsuccessfulProcedure record",
                                    "table number": 339,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.2-5: SCEFStartOfInterceptionWithEstablishedPDNConnection record",
                                    "table number": 340,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.2-6: IRI type for IRI messages",
                                    "table number": 341,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.8.3\tLI for device triggering",
                            "text_content": "The IRI-POI present in the SCEF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.11.3.4, the details of which are described in the following clauses.\nThe IRI-POI in the SCEF shall generate an xIRI containing a SCEFDeviceTrigger record when the IRI-POI present in the SCEF detects that an SCS/AS has sent a Device triggering request to a target UE matching one of the target identifiers.\nAccordingly, the IRI-POI in the SCEF generates the xIRI when any of the following events is detected:\n-\tSCEF sends a Device triggering response to the SCS/AS to acknowledge the reception of a Device triggering request with MSISDN or External Identifier matching the target identifier (See TS 29.122 [63] clause 5.7).\n-\tSCEF sends a T4 Device-Trigger-Request (DTR) to SM-SC with Trigger-Action AVP set to TRIGGER and User-Identifier AVP matching the IMSI of the target UE as specified in TS 29.337 [60] clause 5.2.1.\nTable 7.8.3-1: SCEFDeviceTrigger record\n\nThe IRI-POI in the SCEF shall generate an xIRI containing a SCEFDeviceTriggerReplace record when the IRI-POI present in the SCEF detects that an SCS/AS has sent a Device triggering replacement for a previously sent Device triggering request to a UE matching one of the target identifiers provided via LI_X1 to the IRI POI in the SCEF. It replaces a previously submitted Device triggering request which has not yet been delivered to the UE.\nAccordingly, the IRI-POI in the SCEF generates the xIRI when any of the following events is detected:\n-\tSCEF receives a Device triggering request (for a Device trigger replacement) from an SCS/AS with MSISDN or External Identifier matching the target identifier (See TS 29.122 [63] clause 5.7).\n-\tSCEF sends a T4 Device-Trigger-Request (DTR) to SM-SC with Trigger-Action AVP set to REPLACE and User-Identifier AVP matching the IMSI of the target UE as specified in TS 29.337 [60] clause 5.2.1.\nTable 7.8.3-2: SCEFDeviceTriggerReplace record\n\nThe IRI-POI in the SCEF shall generate an xIRI containing a SCEFDeviceTriggerCancellation record when the IRI-POI present in the SCEF detects that an SCS/AS has sent a Device triggering cancellation for a previously sent Device triggering request to a UE matching one of the target identifiers provided via LI_X1 to the IRI-POI in the SCEF. It cancels previously submitted Device triggering request which has not yet been delivered to the target UE.\nAccordingly, the IRI-POI in the SCEF generates the xIRI when any of the following events is detected:\n-\tSCEF receives a Device triggering request (for a device trigger cancellation) from SCS/AS related to a previously received Device triggering request with MSISDN or External Identifier matching the target identifier (See TS 29.122 [63] clause 5.7).\n-\tSCEF sends a T4 Device-Trigger-Request (DTR) to SM-SC with Trigger-Action AVP set to RECALL and User-Identifier AVP matching the IMSI of the target UE as specified in TS 29.337 [60] clause 5.2.1.\nTable 7.8.3-3: SCEFDeviceTriggerCancellation record\n\nThe IRI-POI in the SCEF shall generate an xIRI containing a SCEFDeviceTriggerReportNotify record when the IRI-POI present in the SCEF detects that the SCEF has returned a Device triggering delivery report notification to the SCS/AS with a cause value indicating the trigger delivery outcome (e.g. succeeded, unknown or failed).\nAccordingly, the IRI-POI in the SCEF generates the xIRI when any of the following events is detected:\n-\tSCEF sends a Device triggering delivery report notification to inform the SCS/AS on the delivery outcome of the device trigger (see TS 29.122 [63] clause 5.7).\n-\tSM-SC sends a T4 Delivery-Report-Request (DRR) to the SCEF with User-Identifier matching the IMSI of the target UE as specified in TS 29.337 [60] clause 5.2.2.\nTable 7.8.3-4: SCEFDeviceTriggerReportNotify record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in the SCEF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the SCEF event was observed (i.e. the timestamp field of the xIRI).\nTable 7.8.3-5 shows the IRI type (see ETSI TS 102 232-1 [9] clause 5.2.10) to be used for each record type.\nTable 7.8.3-5: IRI type for messages\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.8.3-1: SCEFDeviceTrigger record",
                                    "table number": 342,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.3-2: SCEFDeviceTriggerReplace record",
                                    "table number": 343,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.3-3: SCEFDeviceTriggerCancellation record",
                                    "table number": 344,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.3-4: SCEFDeviceTriggerReportNotify record",
                                    "table number": 345,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.3-5: IRI type for messages",
                                    "table number": 346,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.8.4\tLI for MSISDN-less MO SMS",
                            "text_content": "The IRI-POI present in the SCEF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.11.4.4, the details of which are described in the following clauses.\nThe IRI-POI in the SCEF shall generate an xIRI containing a SCEFMSISDNLessMOSMS record when the IRI-POI present in the SCEF detects that a target UE has sent a MSISDN-less MO SMS to an SCS/AS.\nAccordingly, the IRI-POI in the SCEF generates the xIRI when any of the following events is detected:\n-\tSCEF receives a SGd MO-Forward-Short-Message-Request (OFR) from an SM-SC with IMSI matching the target identifier (see TS 29.338 [59] clause 6.2.1).\n-\tSCEF sends a MsisdnLessMoSmsNotification to the SCS/AS with the External Identifier of the UE sending the MSISDN-less SMS (see TS 29.122 [63] clause 5.15).\nTable 7.8.4-1: SCEFMSISDNLessMOSMS record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in the SCEF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the SCEF event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.8.4-2.\nTable 7.8.4-2: IRI type for IRI messages\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.8.4-1: SCEFMSISDNLessMOSMS record",
                                    "table number": 347,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.4-2: IRI type for IRI messages",
                                    "table number": 348,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.8.5\tLI for parameter provisioning",
                            "text_content": "The IRI-POI present in the SCEF shall send the xIRIs over LI_X2 for each of the events listed in corresponding in TS 33.127 [5] clause 7.11.5.4, the details of which are described in the following clauses.\nThe IRI-POI in the SCEF shall generate an xIRI containing an SCEFCommunicationPatternUpdate record when the IRI-POI present in the SCEF detects that an SCS/AS has updated the Communication pattern data.\nAccordingly, the IRI-POI in the SCEF generates the xIRI when any of the following events is detected (See TS 29.122 [63] clause 5.10):\n-\tSCEF receives a request to provision the communication pattern parameters from an SCS/AS related to the target UE (PUT).\n-\tSCEF receives a request to delete the existing communication patterns parameters from an SCS/AS related to the target UE (DELETE).\n-\tSCEF returns a response (200 OK) containing the communication pattern parameters of the target UE to the querying SCS/AS (GET).\nTable 7.8.5-1: SCEFCommunicationPatternUpdate record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in the SCEF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the SCEF event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.8.5-2.\nTable 7.8.5-2: IRI type for IRI messages\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.8.5-1: SCEFCommunicationPatternUpdate record",
                                    "table number": 349,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.5-2: IRI type for IRI messages",
                                    "table number": 350,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.8.6\tLI for AS session with QoS",
                            "text_content": "The IRI-POI present in the SCEF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.11.6.4, the details of which are described in the following clauses.\nThe IRI-POI in the SCEF shall generate an xIRI containing a SCEFASSessionWithQoSProvision record when the IRI-POI present in the SCEF detects that an SCS/AS has requested the SCEF to provide, update or revoke a specific QoS for an AS session.\nAccordingly, the IRI-POI in the SCEF generates the xIRI when any of the following events is detected (see TS 29.122 [63] clauses 5.14):\n-\tSCEF returns an On-demand QoS Response in response to On-demand QoS Request received from an SCS/AS to create (POST)/update (PUT or PATCH)/revoke (DELETE) a specific QoS for an AS session related to a target UE.\nTable 7.8.6.1.2-1: SCEFASSessionWithQoSProvision record\n\nThe IRI-POI in the SCEF shall generate an xIRI containing a SCEFASSessionWithQoSNotification record when the IRI-POI present in the SCEF detects that the SCEF has notified the SCS/AS about changes in the transmission resource status of the AS session.\nAccordingly, the IRI-POI in the SCEF generates the xIRI when any of the following events is detected (see TS 29.122 [63] clauses 5.14):\n-\tSCEF receives a Status information Response in response to Status information Request (POST) sent to SCS/AS to notify changes in the transmission resource status of an AS session associated with the target UE.\nTable 7.8.6.1.3-1: SCEFASSessionWithQoSNotification record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in the SCEF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the SCEF event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.8.6.2-1.\nTable 7.8.6.2-1: IRI type for IRI messages\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.8.6.1.2-1: SCEFASSessionWithQoSProvision record",
                                    "table number": 351,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.6.1.3-1: SCEFASSessionWithQoSNotification record",
                                    "table number": 352,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.8.6.2-1: IRI type for IRI messages",
                                    "table number": 353,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "7.9\tLI for services encrypted by CSP-provided keys",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.9.1\tLI for general AKMA-based service",
                            "text_content": "This clause describes basic IRI-intercept for a generic, encrypted service between a target UE and an application in the CSP network, making use of AKMA-provided cryptographic keys according to TS 33.535 [65].\nThe IRI-POI in the AAnF (AKMA Anchor Function), the IRI-TF in the AAnF, and the MDF2 shall be provisioned.\nDetails of provisioning of an IRI-POI at a network internal AF (Application Function) making use of AKMA services of the AAnF is in general service specific and not part of the present clause. Generally, triggering, rather than provisioning, could in some cases be necessary for the AF. An application independent generic triggering mechanism is defined in clause 7.9.1.2.3.\nProvisioning of CC-intercept at the AF is service specific and not covered in the present document.\nThe IRI-POI and IRI-TF present in the AAnF are provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nThe IRI-POI and IRI-TF in the AAnF shall support the following target identifier formats:\n-\tSUPI, given in either SUPIIMSI or SUPINAI formats as defined in ETSI TS 103 120 [6] clause C.2.\nTable 7.9.1.2-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POI and IRI-TF in the AAnF.\nTable 7.9.1.2-1: ActivateTask message for the IRI-POI and IRI-TF in the AAnF\n\nThe IRI-POI present in the AF shall be triggered by the IRI-TF present in the AAnF over LI_T2 using the X1 protocol as described in clause 5.2.2. An AAnF can provide services for several different types of applications. Triggering could be service/application specific, which can effect whether or not certain conditional fields are included in the xIRI described in clause 7.9.1.4 below.\nFor all AFs a priori known to match the scope of the warrant, when the IRI-TF in the AAnF detects that an A-KID has been associated with a SUPI (see clause 7.9.1.3.2), it shall send an ActivateTask message to the IRI-POI present in the AF. The same shall apply if the AAnF detects that the A-KID of a target changes due to primary authentication. For AFs not a priori known at the AAnF, the ActivateTask message shall instead be sent when the IRI-TF in the AAnF detects that the AF performs an AKMA application key get associated with the A-KID. The ActivateTask message shall contain at least the following information.\nNOTE:\tAFs providing services based on SUPI could, as an alternative to triggering, be directly provisioned by the LIPF as part of service-specific provisioning. This is however outside the scope of the present document.\nTable 7.9.1.2-2: ActivateTask message for triggering the IRI-POI in the AF\n\nTable 7.9.1.2-3: Target Identifier Types for LI_T3\n\nWhen the IRI-POI present in the AF detects that a UE has requested the use of a targeted A-KID, it shall continue to generate xIRI events for that A-KID until it detects that the UE has requested the use of a different A-KID, at which point it shall implicitly deactivate the previous Task. In addition, the AAnF may at any time issue a DeactivateTask message against the Task, at which point the AF shall cease interception of the A-KID and remove the Task as per ETSI TS 103 221-1 [7] clause 6.2.3.\nThe IRI-POI present in the AAnF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.9.3.1, the details of which are described in the following clauses.\nThe IRI-POI in the AAnF shall generate an xIRI containing an AAnFAnchorKeyRegister record when the IRI-POI present in the AAnF detects reception of an AKMA-context, i.e. an (A-KID, KAKMA)-pair associated with a target, from the AUSF, see TS 33.535 [65] clause 7.1.2.\nTable 7.9.1.3-1: AAnFAnchorKeyRegister record\n\nThe IRI-POI in the AAnF shall generate an xIRI containing an AAnFAKMAApplicationKeyGet record when the IRI-POI present in the AAnF detects an AKMA application key get from an AF (directly or via NEF), see TS 33.535 [65], clauses 7.1.3 and 7.3.1.\nTable 7.9.1.3-2: AAnFKAKMAApplicationKeyGet record\n\nTable 7.9.1.3-3: AFKeyInfo structure\n\nThe IRI-POI in the AAnF shall generate an xIRI containing an AAnFStartOfInterceptWithEstablishedAKMAKeyMaterial record when the IRI-POI present in the AAnF detects that interception is activated on a target UE that has already established AKMA key material.\nTable 7.9.1.3-4: AAnFStartOfInterceptWithEstablishedAKMAKeyMaterial record\n\nThe IRI-POI in the AAnF shall generate an xIRI containing an AAnFAKMAContextRemovalRecord when the IRI-POI present in the AAnF receives a request from an NF to delete AKMA context, see TS 33.535 [65] clause 7.1.4.\nTable 7.9.1.3-5: AAnFAKMAContextRemovalRecord record\n\nThe IRI-POI present in the AF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.9.3.1, the details of which are described in the following clauses.\nThe IRI-POI in the AF shall generate an xIRI containing an AFAKMApplicationKeyRefresh record when the IRI-POI present in the AF detects that a KAF-key previously obtained from an AAnF is being locally refreshed by the Ua* security protocol in use, see TS 33.535 [65] clause 6.4.3.\nTable 7.9.1.4-1: AFAKMAApplicationKeyRefresh record\n\nThe IRI-POI in the AF shall generate an xIRI containing an AFStartOfInterceptWithEstablishedAKMAApplicationKey record when the IRI-POI present in the AF detects interception is being triggered on a target UE that has already established AKMA application key.\nTable 7.9.1.4-2: AFStartOfInterceptWithEstablishedAKMAApplicationKey record\n\nTable 7.9.1.4-3: AFSecurityParams structure\n\nThe IRI-POI in the AF shall generate an xIRI containing an AFAuxiliarySecurityParameterEstablishment record when the IRI-POI present in the AF detects that security parameters for the Ua* security protocol in use have been established with the target UE, or, when they have been updated without the associated AKMA application key having been refreshed according to clause 7.9.1.4.3.\nTable 7.9.1.4-4: AFAuxiliarySecurityParameterEstablishment record\n\nThe IRI-POI in the AF shall generate an xIRI containing an AFApplicationKeyRemoval record when the IRI-POI present in the AF detects that an AKMA-derived AF-specific key is deleted or otherwise decommissioned.\nTable 7.9.1.4-5: AFApplicationKeyRemoval record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in the AAnF or AF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF.\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the AAnF/AF event was observed (i.e. the timestamp field of the xIRI).\nTable 7.9.1.5-1 shows the IRI type (see ETSI TS 102 232-1 [9] clause 5.2.10) to be used for each record type.\nTable 7.9.1.5-1: IRI type for AAnF originated messages\n\nIRI messages associated with the same A-KID from the same AAnF shall be assigned the same CIN.\nTable 7.9.1.5-2: IRI type for AF originated messages\n\nIRI messages associated with the same AKID from the same AF shall be assigned the same CIN.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.9.1.2-1: ActivateTask message for the IRI-POI and IRI-TF in the AAnF",
                                    "table number": 354,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.2-2: ActivateTask message for triggering the IRI-POI in the AF",
                                    "table number": 355,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.2-3: Target Identifier Types for LI_T3",
                                    "table number": 356,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.3-1: AAnFAnchorKeyRegister record",
                                    "table number": 357,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.3-2: AAnFKAKMAApplicationKeyGet record",
                                    "table number": 358,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.3-3: AFKeyInfo structure",
                                    "table number": 359,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.3-4: AAnFStartOfInterceptWithEstablishedAKMAKeyMaterial record",
                                    "table number": 360,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.3-5: AAnFAKMAContextRemovalRecord record",
                                    "table number": 361,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.4-1: AFAKMAApplicationKeyRefresh record",
                                    "table number": 362,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.4-2: AFStartOfInterceptWithEstablishedAKMAApplicationKey record",
                                    "table number": 363,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.4-3: AFSecurityParams structure",
                                    "table number": 364,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.4-4: AFAuxiliarySecurityParameterEstablishment record",
                                    "table number": 365,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.4-5: AFApplicationKeyRemoval record",
                                    "table number": 366,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.5-1: IRI type for AAnF originated messages",
                                    "table number": 367,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.9.1.5-2: IRI type for AF originated messages",
                                    "table number": 368,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "7.10\tLI in VPLMN for IMS-based services with home-routed roaming",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.10.1\tBackground",
                            "text_content": "This clause defines protocol and procedures to support the LI in the VPLMN for IMS-based services with home-routed roaming architecture where IMS signaling (e.g. CSCFs) and media functions (e.g. IMS-AGW) are in the HPLMN. The scope of LI functions defined here are the following in the VPLMN:\n-\tIMS-based voice services.\n-\tSMS over IP.\nFor IMS-based voice services and the SMS over IP, the target can be an inbound roaming UE or a non-local ID.\nAs defined in TS 33.127 [5] clause 7.4.7.4.2, LMISF-IRI, LMISF-CC, BBIFF-C and BBIFF-U handle the LI in the VPLMN for IMS-based services with home routed roaming architecture.\nNOTE 1:\tWhen N9 is the interface between the two PLMNs for the user plane data, the LI architecture is referred to as N9HR LI. With N9HR LI, the BBIFF-C is present in the SMF and the BBIFF-U is present in the UPF.\nNOTE 2:\tWhen S8 is the interface between the two PLMNs for the user plane data, the LI architecture is referred to as S8HR LI. With S8HR LI, the BBIFF-C and BBIFF-U are combined into BBIFF and is present in the SGW. When SGW is deployed with CUPS, the S8U is the interface between the two PLMNs for the user plane data and in this case, the BBIFF-C is present in the SGW-C and BBIFF-U is present in the SGW-U.\nThis clause uses the term \"HR LI\" in referring to the common functions associated with the N9HR LI and S8HR LI collectively.\nThe HR LI includes two phases of LI processing with the following scope:\n-\tPhase 1 - Initial configuration and target checking, applies to all in-bound roaming UEs with home-routed roaming and using IMS-based services. No interception is done in this phase.\n-\tPhase 2 - Applies to specific target UEs or UEs in communication with a target non-local ID. Interception is done in this phase.\nThe details of the above two phases of LI processes are described in TS 33.127 [5] clause 7.4.7.4.11.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.10.2\tBackward compatibility",
                            "text_content": "The present document provides two options for stage 3 definitions for implementing S8HR LI:\n-\tUse LI_X1, LI_X2 and LI_X3 interfaces specified below in the present document.\n-\tUse TS 33.107 [36] natively as defined in that document.\nIn both cases, the present document specifies the stage 3 for the LI_HI1 and LI_HI2 interfaces. Only the first option indicated above is used for N9HR LI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.10.3\tHR LI Phase 1",
                            "text_content": "The Phase-1 of HR LI that applies to all inbound roaming UEs with home-routed roaming using the IMS-based services include the functions that revolve around the following interfaces (see TS 33.127 [5]):\n-\tLI_X1: Used by the LIPF to provision the BBIFF-C/BBIFF and optionally, the LMISF-IRI to enable the same for HR LI (aka initial configuration of HR LI).\n-\tLI_T3: Used by the BBIFF-C to instruct the BBIFF-U to capture and deliver the IMS signaling related user plane packets of inbound roaming UEs to the LMISF-IRI.\n-\tLI_X2_LITE: Used by the BBIFF-C/BBIFF to carry the control plane information (e.g. packet data connection related notifications, UE location) to LMISF-IRI for inbound roaming UEs.\n-\tLI_X3_LITE_S: Used by the BBIFF-U/BBIFF to forward the IMS signalling related user plane packets of inbound roaming UEs to the LMISF-IRI.\nThe triggering interface LI_T3 is not used in the case of BBIFF in SGW. The LI_X3_LITE_S is also used in HR LI Phase-2.\nThe LI_X2_LITE shall be realized using the X2 protocol as defined in ETSI TS 103 221-2 [8]. Likewise, the LI_X3_LITE_S and LI_X3_LITE_M shall be realized using the X3 protocol as defined in ETSI TS 103 221-2 [8].\nFor Phase-1 of HR LI, the following LI functions are provisioned over LI_X1 by the LIPF using the X1 protocol defined in ETSI TS 103 221-1 [7] with the LIPF playing the role of ADMF and the following LI functions playing the role of NE as per the reference model depicted in ETSI TS 103 221-1 [7]:\n-\tBBIFF-C present in the SMF.\n-\tBBIFF-C present in the SGW-C.\n-\tBBIFF present in the SGW.\n-\tLMISF-IRI.\nAs described in clause 7.10.1, the Phase-1 of HR LI applies to all inbound roaming UEs that use the IMS-based services with home-routed roaming. The target identities \"HR\" and \"IMSSignaling\" are used for Phase-1 of HR LI.\nThe minimum details of LI_X1 ActivationTask message is shown in table 7.10.3.2-2.\nTable 7.10.3.2-1: Void\n\nTable 7.10.3.2-2: ActivateTask message for activating BBIFF-C and BBIFF\n\nTable 7.10.3.2-3: Target Identifier Type for enabling HR LI\n\nThe LMISF-IRI is listed as the delivery endpoint over LI_X2_LITE for xIRI generated by the BBIFF-C/BBIFF and for the xCC generated by the BBIFF-U/BBIFF.\nThe provisioning of LMISF-IRI is to enable it to receive the xIRIs and xCC sent from the BBIFF-C (SMF, SGW-C), BBIFF-U (UPF, SGW-U) and BBIFF (SGW). As an alternate deployment option, LMISF-IRI may be presumed to be enabled to receive such xIRI/xCC by default. This clause does not apply to such alternate deployment option.\nTable 7.10.3.2-4 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the LMISF-IRI for Phase-1.\nTable 7.10.3.2-4: ActivateTask message for activating the LMISF-IRI for Phase-1\n\nLI_X2_LITE is an interface between the BBIFF-C/BBIFF to the LMISF-IRI. The xIRIs are generated at the BBIFF-C/BBIFF and are sent over LI_X2_LITE interface to the LMISF-IRI. These xIRIs are applicable to HR LI Phase-1 only.\nFor N9HR LI, the BBIFF-C present in the SMF shall generate the xIRIs as described in clause 7.10.3.3.2. For S8HR LI, the BBIFF-C present in the SGW-C and BBIFF present in the SGW shall generate the xIRIs as defined in clause 7.10.3.3.3.\nThe xIRIs are generated only when the following prior conditions are met:\n-\tActivateTask with target identity \"HR\" and \"IMSSignaling\" is received with X2 being included in the delivery type.\n-\tThe MCC + MNC of the Operator Identifier field of the DNN (for N9HR) or APN (for S8HR) is different from the MCC+MNC configured in the SMF (N9HR) or SGW-C/SGW (S8HR) - see TS 29.502 [16], clause 6.1.6.2.2 and 23.003 [19] clause 9.1.2.\n-\tThe Network Identifier field of DNN (for N9HR) or APN (for S8HR) contains \"IMS\" (IMS services) - see GSMA IR.88 [67].\nThe first point is indicating that HR LI is enabled (see clause 7.10.3.2.2). The second point is telling that the UE is an inbound roamer with home-routed based roaming. The third point is telling that the PDU session/PDN connection is for IMS services.\nThe BBIFF-C present in the SMF shall generate the following xIRI when the prior conditions defined in clause 7.10.3.3.1 are met:\n-\tN9HRPDUSessionInfo.\nThe main purpose of the xIRI is to report the UE location, PDU session ID and the SMF identity. The scenarios that result in the above xIRI are listed below and apply to all inbound roaming UEs with home-routed roaming and using IMS services:\n-\tPDU session is established with the creation of a default QoS flow for IMS signaling.\n-\tPDU session is modified with the creation of a dedicated QoS flow used for IMS media.\n-\tPDU session is modified with the updates to the QoS flow.\n-\tPDU session is modified with the deleting of dedicated QoS flow used for IMS media.\n-\tPDU session is deleted.\n-\tMA PDU session is created, modified or deleted.\n-\tSMF relocation.\n-\tNew UE location due to UE requested or network initiated service request.\n-\tNew UE location due to hand-over situations including EPS to 5GS handover.\n-\tNew UE location due to tracking area updates or routing area updates.\n-\tNew SMF from the SMF set is taking over the PDU session.\n-\tHR LI is enabled with an established PDU session.\nThe exact trigger for the xIRI is subject to implementation, however, the following can be used as a general guidance along with observing the prior conditions listed in clause 7.10.3.3.1:\n-\tSMF receives the Nsmf_PDU_Session_Create response message with n1SmInfoToUe IE containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16]) from the H-SMF and sends the NAS message (via AMF) PDU SESSION ESTABLISHMENT ACCEPT to the UE as a part of PDU session establishment procedures. This may also happen with MA PDU session establishment procedures, or during handover procedures with access type change, or as a part of SMF relocation procedures.\n-\tSMF receives an Nsmf_PDUSession_UpdateSMContext request from the AMF with a new UE location. This may happen whenever a PDU session or a MA PDU session is modified with the addition, modification or deletion of a dedicated QoS flow. This may also happen for UE-initiated or network-initiated service request procedures, or as a part of the handover procedures, or as a part of the tracking area update procedures.\n-\tWhen a new SMF (e.g. in the SMF set) takes over the control for the PDU session.\n-\tWhen an ActivateTask is received from the LIPF over LI_X1 (see clause 7.10.3.2.2) to enable the HR LI, the BBIFF-C present in the SMF detects that a PDU session for IMS services is already established for an inbound roaming UE with home-routed roaming.\nNOTE:\tThe sending of xIRI for each already established PDU session may result in a significant number of xIRI messages from the BBIFF-C to the LMISF-IRI.\nThe contents of xIRI N9HRPDUSessionInfo record is shown in table 7.10.3.3-1 below.\nTable 7.10.3.3-1: Payload of N9HRPDUSessionInfo record\n\nTable 7.10.3.3-2: messageCause details\n\nThe xIRIs shall include the Network Function ID (NFID), a conditional attribute field as defined in ETSI TS 103 221-2 [8], with the V-SMF identity.\nHandling of this xIRI within the LMISF-IRI is described in clause 7.10.3.4.\nThe BBIFF-C present in the SGW-C and BBIFF present in the SGW shall generate the following xIRI for the purpose of S8HR LI when the prior conditions defined in clause 7.10.3.3.1 are met:\n-\tS8HRBearerInfo.\nThe main purpose of the xIRI is to report the UE location and the SGW/SGW-C identity to the LMISF-IRI. This xIRI is generated for the following scenarios that apply to all inbound roaming UEs with home-routed roaming and using IMS services:\n-\tPDN connection is established with the creation of a default bearer for IMS signaling.\n-\tDedicated bearer is activated for the for IMS media.\n-\tDedicated bearer is updated for IMS media.\n-\tDedicated bearer is deactivated for IMS media.\n-\tPDN is disconnected.\n-\tSGW-C/SGW relocation.\n-\tNew UE location due to UE requested or network initiated service request.\n-\tNew UE location due to hand-over situations including 5GS to EPS handover.\n-\tNew UE location due to tracking area updates or routing area updates.\n-\tHR LI is enabled with an established PDN connection with the creation of a default bearer.\nThe exact trigger for the xIRI is subject to implementation, however, the following can be used as a general guidance observing the prior conditions listed in clause 7.10.3.3.1:\n-\tSGW-C/SGW receives a Create Session Response from the PGW-C/PGW and forwards the same to the MME as a part of PDN connection establishment procedures that creates the default bearer used for IMS signaling or as a part of the handover procedures that results in the SGW-C/SGW relocation or 5GS to EPS relocation.\n-\tSGW-C/SGW receives a Create Session Response from the MME and forwards the same to the PGW-C/PGW as a part of dedicated bearer activation procedure on a PDN connection used for IMS media.\n-\tSGW-C/SGW receives an Update Bearer Response from MME and forwards the same to the PGW-C/PGW as a part of bearer update procedures with or without the bearer update QoS.\n-\tSGW-C/SGW receives a Delete Bearer Response from MME and forwards the same to the PGW-C/PGW as a part of bearer deactivation procedure.\n-\tSGW-C/SGW receives a Delete Session Request from the MME and forwards the same to the PGW-C/PGW as a part of PDN disconnection procedures. The procedures potentially have the last known UE location.\n-\tSGW-C/SGW receives a Create Session Request from the MME and sends a Modify Bearer Request to the PGW-C/PGW as a part of tracking area/routing area update procedures with a change of SGW-C/SGW. The procedures potentially have a new UE location.\n-\tSGW-C/SGW receives a Modify Bearer Request from the MME and sends the same to the PGW-C/PGW as a part of Service Request handling procedures, or hand-over procedures, or tracking area/routing area update procedures without a change in the SGW-C/SGW. The procedures potentially have a new UE location.\n-\tWhen an ActivateTask is received from the LIPF over LI_X1 (see clause 7.10.3.2.2) to enable the HR LI, the BBIFF-C/BBIFF present in the SGW-C/SGW detects that a PDN connection with a default bearer used for IMS services is already established for an inbound roaming UE with home-routed roaming.\nNOTE:\tThe sending of xIRI for each already established PDN connection may result in a significant number of xIRI messages from the BBIFF-C/BBIFF to the LMISF-IRI.\nThe details of the xIRI S8HRBearerInfo record is defined in table 7.10.3.3-3 below.\nTable 7.10.3.3-3: Payload for S8HRBearerInfo record\n\nTable 7.10.3.3-4: messageCause details\n\nAll of the xIRIs listed above shall also include the Network Function ID (NFID), a conditional attribute field as defined in ETSI TS 103 221-2 [8], with the SGW-C/SGW identity.\nHandling of this xIRI within the LMISF-IRI is described in clause 7.10.3.4.\nThe LMISF-IRI that receives the xIRI, N9HRPDUSessionInfo record shall store or update the record with the information received in the xIRI (e.g. UE location) as applicable, for the future handling.\nThe LMISF-IRI that receives the xIRI, S8HRBearerInfo record shall store or update the record with the information received in the xIRI (e.g. UE location) as applicable, for the future handling.\nThe stored record is referred to LI_X2_LITE record in the present document.\nFor the N9HR LI related LI_X2_LITE records, the LMISF-IRI shall use the SUPI and PDU Session ID to uniquely associate a record with the inbound roaming UE.\nFor S8HR LI related LI_X2_LITE records, the LMISF-IRI shall use the IMSI, Linked Bearer ID or the Bearer ID (when the Linked Bearer ID is not present) to uniquely associate a record with the inbound roaming UE.\nWith HR LI Phase-1, the user plane packets from the IMS signaling channel are delivered to the LMISF-IRI for all inbound roaming UEs with home-routed roaming.\nWhen BBIFF is separated into BBIFF-C and BBIFF-U, these user plane packets are captured at the BBIFF-U. In order to enable the BBIFF-U to do that function, the BBIFF-C triggers the BBIFF-U over the LI_T3 interface.\nThe BBIFF-U delivers the user plane from the IMS signaling channel over the LI_X3_LITE-S interface to the LMISF-IRI.\nWhen the BBIFF-C present in the SMF detects that a PDU session is established with IMS signaling related QoS Flow for an inbound roaming UE with home-routed roaming, it shall send an activation message to the BBIFF-U present in the UPF over the LI_T3 interface with the associated QFI value.\nThe exact point at which the trigger is sent is left to the implementation (preferably, when the SMF receives the N4: PFCP Session Establishment/Modification Response from the UPF, see TS 29.244 [15], clauses 6.3.2 and 6.3.3), however, the BBIFF-C can send the trigger only when the following conditions are met:\n-\tActivateTask with target identity \"HR\" and \"IMSSignaling\" is received with X3 being included in the delivery type.\n-\tThe MCC + MNC of the Operator Identifier field of the DNN is different from the MCC+MNC configured in the SMF - see TS 29.502[16] clause 6.1.6.2.2 and 23.203 [19] clause 9.1.2.\n-\tThe Network Identifier field of DNN contains \"IMS\" (IMS services) - see GSMA IR.88 [67].\n-\tThe 5QI value associated with the QoS Flow is 5 – see GSMA NG.114 [68].\nThe first point is indicating that N9HR LI is enabled (see clause 7.10.3.3.1) with a need to capture and deliver the IMS signaling related user plane packets. The second point is telling that the UE is an inbound roamer with Home Routed based roaming. The third point is telling that the PDU session is established for IMS services. The fourth point is telling that the IMS signaling related QoS Flow is established.\nIf the PDU session for IMS services is already established for an inbound roaming UE with Home-Routed based roaming when the above indicated ActivateTask is received, then the BBIFF-C shall send the trigger at the time Activation Task is received from the LIPF.\nThe details of ActivateTask sent to the BBIFF-U are shown in table 7.10.3.5-1.\nTable 7.10.3.5-1: ActivateTask message for triggering the BBIFF-U in the UPF\n\nWhen the BBIFF-C present in the SMF detects that the PDU session is released (e.g. when SMF receives the N4: PFCP Session Deletion Response from the UPF, see TS 29.244 [15], clause 6.3.4), it shall send a deactivation message to the BBIFF-U present in the UPF over the LI_T3 interface, if the task is still active in the BBIFF-U.\nThe BBIFF-C shall also send the deactivation message to the BBIFF-U when a DeactivateTask is received from the LIPF for the XID if the task is still active in the BBIFF-U.\nWhen the BBIFF-C present in the SGW-C detects that the default bearer used for IMS signaling is activated on the PDN connection for an inbound roaming UE with home-routed roaming, it shall send an activation message to the BBIFF-U present in the SGW-U over the LI_T3 interface.\nThe exact point at which the trigger is sent is left to the implementation (preferably, when the SGW-C receives the Sx: Session Establishment/Modification Response from the SGW-U). However, the BBIFF-C can send the trigger only when the following conditions are met:\n-\tActivateTask with target identity \"HR\" and \"IMSSignaling\" is received with X3 being included in the delivery type.\n-\tThe MCC + MNC of the Operator Identifier field of the APN is different from the MCC+MNC configured in the SGW/SGW-C - see TS 29.502 [16] clause 6.1.6.2.2 and 23.203 [19] clause 9.1.2.\n-\tThe Network Identifier field of APN contains \"IMS\" (IMS services) - see GSMA IR.88 [67].\n-\tThe QCI value associated with the default bearer is 5 – see GSMA NG.114 [68].\nThe first point is indicating that S8HR LI is enabled (see clause 7.10.3.3.1) with a need to capture and deliver the IMS signaling related user plane packets. The second point is telling that the UE is an inbound roamer with Home Routed based roaming. The third point is telling that the PDN connection is established for IMS services. The fourth point is telling that the IMS signaling bearer is activated.\nIf the default bearer (for IMS signaling bearer) on the PDN connection is already established for an inbound roaming UE with Home-Routed based roaming when the above indicated ActivateTask is received, then the BBIFF-C shall send the trigger at the time Activation Task is received from the LIPF.\nThe details of ActivateTask sent to the BBIFF-U present in the SGW-U are shown in table 7.10.3.5-2.\nTable 7.10.3.5-2: ActivateTask message for triggering the BBIFF-U in the SGW-U\n\nWhen the BBIFF-C present in the SGW-C detects that the PDN connection is released (e.g. when SGW-C receives the Sx: Session Release Response from the SGW-U), it shall send a deactivation message to the BBIFF-U present in the SGW-U over the LI_T3 interface, if the task is still active in the BBIFF-U.\nThe BBIFF-C present in the SGW-C shall also send the deactivation message to the BBIFF-U present in the SGW-U when a DeactivateTask is received from the LIPF for the XID if the task is still active in the BBIFF-U.\nThe BBIFF-U in UPF and the BBIFF-U in SGW-U shall send the xCC over LI_X3_LITE_S for each of the packet matching the criteria specified in the Triggering message (i.e. Activate Task message) received over the LI_T3 from the BBIFF-C.\nThe BBIFF present in the SGW shall send the xCC over LI_X3_LITE_S for each of the packet from the default bearer with the QCI value of 5 (GSMA NG.114 [68]) with following other conditions:\n-\tActivateTask with target identity \"HR\" and \"IMSSignaling\" is received with delivery type \"X3Only\".\n-\tThe MCC + MNC of the Operator Identifier field of the APN is different from the MCC+MNC configured in the SGW - see TS 29.502 [16], clause 6.1.6.2.2 and 23.203 [19] clause 9.1.2.\n-\tThe Network Identifier field of APN contains \"IMS\" (IMS services) - see GSMA IR.88 [67].\nThe first point is indicating that S8HR LI is enabled (see clause 7.10.3.2.2) with a need to capture and deliver the IMS signaling related user plane packets. The second point is telling that the UE is an inbound roamer with Home Routed based roaming. The third point is telling that the PDN connection is established for IMS services.\nThe BBIFF in SGW uses the QCI value of 5 (GSMA NG.114 [68]) to identify that the packets are from the IMS signaling bearer.\nEach X3 PDU shall contain the contents of the user plane packet given using the GTP-U, IP or Ethernet payload format.\nThe BBIFF-U/BBIFF shall set the payload format to indicate the appropriate payload type (5 for IPv4 Packet, 6 for IPv6 Packet, 12 for GTP-U Packet as described in ETSI TS 103 221-2 [8] clauses 5.4 and 5.4.13.\nThe LMISF-IRI shall extract the IMS signaling messages (i.e. SIP messages) from the xCC received over the LI_X3_LITE_S from the BBIFF-U/BBIFF.\nThe LMISF-IRI shall examine the extracted SIP message for a target match as described in clause 7.10.4.2. If no match is found, then the LMISF-IRI shall store the extracted SIP message for a later use. If a match is found, then the LMISF-IRI shall proceed according to clause 7.10.4.3.\nThe record that stores the SIP message is referred to as LI_X2_LITE_S record.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.10.3.2-2: ActivateTask message for activating BBIFF-C and BBIFF",
                                    "table number": 369,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.3.2-3: Target Identifier Type for enabling HR LI",
                                    "table number": 370,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.3.2-4: ActivateTask message for activating the LMISF-IRI for Phase-1",
                                    "table number": 371,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.3.3-1: Payload of N9HRPDUSessionInfo record",
                                    "table number": 372,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.3.3-2: messageCause details",
                                    "table number": 373,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.3.3-3: Payload for S8HRBearerInfo record",
                                    "table number": 374,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.3.3-4: messageCause details",
                                    "table number": 375,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.3.5-1: ActivateTask message for triggering the BBIFF-U in the UPF",
                                    "table number": 376,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.3.5-2: ActivateTask message for triggering the BBIFF-U in the SGW-U",
                                    "table number": 377,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.10.4\tHR LI Phase 2",
                            "text_content": "The Phase-2 of HR LI that applies to inbound roaming target UEs that use IMS-based services with home-routed roaming or the inbound roaming UEs that use IMS-based services with home-routed roaming to communicate with the target non-local ID include the functions that revolve around the following interfaces.\n-\tLI_X1: Used by the LIPF to provision the LMISF-IRI, MDF2 and MDF3 with the LI information for a target.\n-\tLI_T1: Used by the LMISF-IRI to instruct the BBIFF-C/BBIFF that IMS media related user plane packets of target's communication need to be captured and delivered to the LMISF-CC.\n-\tLI_T3: Used by the BBIFF-C to instruct the BBIFF-U to capture and deliver the IMS media related user plane packets of target's communication to the LMISF-CC.\n-\tLI_X3_LITE_S: Used by the BBIFF-U/BBIFF to forward the IMS signalling related user plane packets of inbound roaming UEs to the LMISF-IRI.\n-\tLI_X3_LITE_M: Used by the BBIFF-U/BBIFF to forward the IMS media related user plane packets of target's communication to the LMISF-CC.\nThe triggering interface LI_T3 is not used in the case of BBIFF in SGW. The LI_X3_LITE_S is also used for HR LI Phase-1.\nFor Phase-2 of HR LI, the following LI functions are provisioned over LI_X1 by the LIPF using the X1 protocol defined in ETSI TS 103 221-1 [7] with the LIPF playing the role of ADMF and the following LI functions playing the role of NE as per the reference model depicted in ETSI TS 103 221-1 [7].\n-\tLMISF-IRI.\n-\tMDF2.\n-\tMDF3.\nAs described in clause 7.10.1, the Phase-2 of HR LI applies to inbound roaming target UEs that use IMS-based services with home-routed roaming or the inbound roaming UEs that use IMS-based services with home-routed roaming to communicate with the target non-local ID. The following target identities are used for Phase-2 of HR LI:\n-\tIMPU.\n-\tIMPI.\n-\tPEIIMEI.\n-\tIMEI.\nThe target identity in the IMPI format may contain a value derived from a SUPI or an IMSI. The target identity in the IMPU format containing a SIP URI or TEL URI may contain a value derived from a GPSI, MSISDN, an E.164 number, or IMSI. Only IMPU is used for target non-local ID. For triggered LALS, the LTF function associated with LMISF-IRI (see clause 7.3.1 and TR 33.928 [121]) is provisioned with the target identity of IMPU.\nThe LMISF-IRI shall be provisioned over LI_X1 by the LIPF for target based interception of IMS services in the VPLMN with home-routed roaming.\nThe target identities listed in clause 7.10.4.2.1 shall apply for the provisioning of LMISF-IRI with LMISF-IRI playing the combined role of IRI-POI and CC-TF for the interception of IMS-based services in the VPLMN with home-routed roaming.\nThe LMISF-IRI shall support the following service scoping from the structure defined in ETSI TS 103 221-1 [7]:\n-\tThe enumerated value of \"voice\" or \"messaging\" in the service type field.\n-\tWhen location reporting is required, one or both of \"reportBeginingAndEnd\", \"reportUponChange\".\n-\t\"SuspendOnOutboundInternationalRoaming\".\nTable 7.10.4.2-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the LMISF-IRI for Phase-2.\nTable 7.10.4.2-1: ActivateTask message for activating LMISF-IRI for Phase-2\n\nThe MDF2 listed as the delivery endpoint over LI_X2 for xIRI generated by the LMISF-IRI shall be provisioned over LI_X1 by the LIPF.\nThe target identities listed in clause 7.10.4.2.1 shall apply for the provisioning of MDF2.\nThe MDF2 shall support the following service scoping from the structure defined in ETSI TS 103 221-1 [7]:\n-\tThe enumerated value of \"voice\" or \"messaging\" in the service type field.\n-\tWhen location reporting is required, one or both of \"reportBeginingAndEnd\", \"reportUponChange\".\nTable 7.10.4.2-2 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF2.\nTable 7.10.4.2-2 ActivateTask message for MDF2\n\nTable 7.10.4.2-3: Mediation Details for MDF2\n\nThe MDF3 listed as the delivery endpoint over LI_X3 for xCC generated by the LMISF-CC shall be provisioned over LI_X1 by the LIPF.\nThe target identities listed in clause 7.10.4.2.1 shall apply for the provisioning of MDF3.\nThe MDF3 shall support the following service scoping from the structure defined in ETSI TS 103 221-1 [7]:\n-\tThe enumerated value of \"voice\" or \"messaging\" in the service type field.\n-\tWhen location reporting is required, one or both of \"reportBeginingAndEnd\", \"reportUponChange\".\nTable 7.10.4.2-4 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF3.\nTable 7.10.4.2-4 ActivateTask message for MDF3\n\nTable 7.10.4.2-5: Mediation Details for MDF3\n\nThe LMISF-IRI extracts the SIP messages that it receives within the xCC from the BBIFF-U/BBIFF over the LI_X3_LITE_S.\nOn the originating end of a voice session, the LMISF-IRI examines the SIP message, the stored LI_X2_LITE record and the stored LI_X3_LITE_S record to check for the following:\n-\tWhether the calling party identity is a target.\n-\tWhether the called party identity is a target non-local ID.\nOn the terminating end of a voice session, the LMISF-IRI examines the SIP message, the stored LI_X2_LITE record and the stored LI_X3_LITE_S record to check for the following:\n-\tWhether the called party identity is a target.\n-\tWhether the calling party identity is a target non-local ID.\n-\tWhether the redirecting party identity is a target non-local ID.\nThe SIP headers used for identifying a calling party identity, called party identity, redirecting party identity can be same identities used by the IMS signaling functions with the following additions:\n-\tP-Preferred Identity as calling party identity.\nWhen any of the conditions listed above are true, the LMISF-IRI concludes that target is involved in an IMS session that shall be intercepted. Accordingly, the LMISF-IRI generates the xIRIs and delivers the same to the MDF2 over the LI_X2.\nFor IMS-based voice services, if media interception is required, the LMISF-IRI sends a trigger for the same to the BBIFF-C/BBIFF over the LI_T1 interface.\nWhen an IMS UE performs an IMS registration (using SIP REGISTER) request, the LMISF-IRI examines the following for a target match:\n-\tFrom header and To header of the SIP REGISTER when the target identity is IMPU.\n-\tSUPI or IMSI stored in the LI_X2_LITE record when the target identity is IMPI.\n-\t+sip.instance-id of Contact header of the SIP REGISTER when the target identity is PEIIMEI or IMEI.\nThe LMISF-IRI shall store the +sip.instance-id in the LI_X2_LITE_S record for later use.\nWhen an IMS UE originates an IMS session (using SIP INVITE), the LMISF-IRI examines the following to verify for a target match:\n-\tP-Preferred Identity header and From header present in the SIP INVITE when the target identity is IMPU.\n-\tRequest URI header and To header present in the SIP INVITE when the target identity is IMPU and target is non-local ID.\n-\tSUPI or IMSI stored in the LI_X2_LITE record when the target identity is IMPI.\n-\t+sip.instance-id of Contact header received in the SIP REGISTER request when the target identity is PEIIMEI or IMEI.\nWhen an IMS UE receives an incoming IMS session (using SIP INVITE), the LMISF-IRI examines the following to verify for a target match:\n-\tRequest URI and To header present in the SIP INVITE when the target identity is IMPU.\n-\tP-Asserted-Id, From header, History Info header and Diversion header present in the SIP header when the target identity is IMPU and target is non-local ID.\n-\tSUPI or IMSI stored in the LI_X2_LITE record when the target identity is IMPI.\n-\t+sip.instance-id of Contact header received in the SIP REGISTER request when the target identity is PEIIMEI or IMEI.\nLMISF-IRI may use the Via header or the Route header to determine whether the SIP INVITE is for an originating IMS session or a terminating IMS session. LMISF-IRI stores the SIP Call Id to associate the subsequent SIP messages received on the same session for a target match.\nFor subsequent SIP messages, the LMISF-IRI may use the stored LI_X3_LITE_S record to determine for a target match.\nWhen the Service Type received in the LI_X1 provisioning is \"messaging\", the LMISF-IRI examines the SIP MESSAGE for a target match as shown below:\n-\tFor MO-SMS over IP, P-Preferred Identity header and From header present in the SIP MESSAGE when the target identity is IMPU.\n-\tFor MO-SMS over IP, TP-DA field of SMS-SUBMIT within the Message-body of SIP MESSAGE when the target identity IMPU for target non-local ID.\n-\tFor MT-SMS over IP, the Request URI and To header present in the SIP MESSAGE when the target identity is IMPU.\n-\tFor MT-SMS over IP, the TP-OA field or TP-RA field of SMS-SUBMIT within the Message-body SIP MESSAGE when the target identity IMPU for target non-local ID.\n-\tSUPI or IMSI stored in the LI_X2_LITE record when the target identity is IMPI.\n-\t+sip.instance-id of Contact header received in the SIP REGISTER request when the target identity is PEIIMEI or IMEI.\nLMISF-IRI may use the Via header or the Route header to determine whether the SIP MESSAGE is for MO-SMS over IP or MT-SMS over IP.\nThe xIRIs generated at the LMISF-IRI shall be same as the xIRIs generated in the IRI-POIs present in the IMS signaling functions (see clause 7.12.4.12).\nAs defined in TS 33.127 [5] the LMISF-IRI generates the following xIRIs:\n-\tEncapsulated SIP message.\n-\tStart of interception with an established IMS session.\nThe xIRI CC Unavailable defined in TS 33.127 [5] for IMS-based services is not applicable to N9HR LI and S8HR LI. The encapsulated SIP message is sent using the xIRI IMSMessage record.\nFurther details of the xIRIs are defined in clause 7.12.4.12.\nWhen the intercepted IMS-session requires the media interception, the LMISF-IRI sends a trigger to the BBIFF-C/BBIFF over to the LI_T1 interface (see TS 33.127 [5]) with LMISF-CC as the delivery end point.\nThe LMISF-IRI upon discovering through the xIRIs received over the LI_X2_LITE interface that a change in SMF or SGW-C/SGW has occurred for an interception involving an IMS-session shall send the trigger to BBFF-C/BBIFF present in the new SMF or SGW-C/SGW over LI_T1 interface with LMISF-CC as the delivery end point to continue the IMS media interception when required.\nWhen the IMS session is completely released (e.g. all session-legs are released), the LMISF-IRI sends a trigger to the BBIFF-C/BBIFF to stop the media intereption. The LMISF-IRI may also send the trigger to stop the media interception when the target information is deprovisioned in the LMISF-IRI by the LIPF.\nNOTE:\tWhen multiple warrants are active on a target, the activation or deactivation of a warrant may not result in a trigger to BBIFF-C./BBIFF (e.g. if a trigger has already been sent due to other warrants).\nThe present document supports the media interception of IMS voice media.\nThe LI_T1 trigger that the LMISF-IRI sends to the BBIFF-C present in the SMF shall include at least the following information:\n-\tThe XID that LMISF-IRI receives from the LIPF over LI_X1 for the target related activation.\n-\tTarget identity: SUPI, PDU session ID, IMS voice media.\n-\tDelivery end point: LMISF-CC.\nThe details of ActivateTask sent to the BBIFF-C in SMF over LI_T1 are shown in table 7.10.4.4-1.\nTable 7.10.4.4-1: ActivateTask message for triggering the BBIFF-C in the SMF over LI_T1\n\nTable 7.10.4.4-2: Target Identifier Types for LI_T1 (BBIFF-C in SMF)\n\nThe DeactivateTask message that the LMISF-IRI sends to the BBIFF-C present in the SMF shall include the XID of the Task created by the ActivateTask message (see table 7.10.4.4-1).\nThe LI_T1 trigger that the LMISF-IRI sends to the BBIFF-C present in the SGW-C/SGW shall include at least the following information:\n-\tThe XID that LMISF-IRI receives from the LIPF over LI_X1 for the target related activation.\n-\tTarget identity: IMSI, Bearer ID, IMS voice media.\n-\tDelivery end point: LMISF-CC.\nThe details of ActivateTask sent to the BBIFF-C in SGW-C over LI_T1 are shown in table 7.10.4.4-3.\nTable 7.10.4.4-3: ActivateTask message for triggering BBIFF-C/BBIFF in the SGW-C/SGW over LI_T1\n\nTable 7.10.4.4-4: Target Identifier Types for LI_T1 (BBIFF-C/BBIFF in SGW-C/SGW)\n\nThe DeactivateTask message that the LMISF-IRI sends to the BBIFF-C/BBIFF present in the SGW-C/SGW shall include the XID of the Task created by the ActivateTask message (see table 7.10.4.4-3).\nWhen the trigger is received over the LI_T1 for activating the media interception, the BBIFF-C present in the SGW-C shall send a trigger over LI_T3 to the BBIFF-U present in the SGW-U when a dedicated bearer for the IMS media is established on the PDN connection.\nWhen the trigger is received over the LI_T1 for activating the media interception, the BBIFF-C present in the SMF shall  send a trigger over LI_T3 to the BBIFF-U present in the UPF when the PDU session is modified for adding IMS media related QoS flow.\nIf the trigger over LI_T1 is received for activating the media interception after the IMS media related changes has happened (i.e. dedicated bearer is established for IMS media, PDU session is modified for adding the IMS media related QoS flow), then the BBIFF-C shall send the trigger to the BBIFF-U over LI_T3 immediately.\nThe BBIFF-C shall trigger the BBIFF-U to stop the delivery of xCC to the LMISF-CC when it receives the trigger from the LMISF-IRI over LI_T1 for stopping the media interception, independent of whether the IMS media related changes have happened or not.\nThe LI_T3 trigger that the BBIFF-C in SMF sends to the BBIFF-U present in the UPF shall include at least the following information:\n-\tXID assigned locally by the BBIFF-C in the SMF.\n-\tThe ProductID that includes the XID it receives from the LMISF-IRI over LI_T1.\n-\tTarget identity: PFCP Session ID, PDR ID with the QFI associated with the IMS voice media (5Q = 1) related QoS flow.\n-\t Delivery end point: LMISF-CC\nThe details of ActivateTask sent to the BBIFF-U in UPF over LI_T3 are shown in table 7.10.4.5-1.\nTable 7.10.4.5-1: ActivateTask message for triggering the BBIFF-U in the UPF over LI_T3\n\nThe DeactivateTask sent to the BBIFF-U present in the UPF over LI_T3 shall include the XID of the Task created by the ActivateTask message (see table 7.10.4.5-1).\nThe LI_T3 trigger that the BBIFF-C in SGW-C sends to the BBIFF-U present in the SGW-U shall include at least the following information:\n-\tXID assigned locally by the BBIFF-C in the SGW-C.\n-\tThe ProductID that includes the XID it receives from the LMISF-IRI over LI_T1.\n-\tTarget identity: PFCP Session ID, PDR ID with the F-TEID associated with the IMS voice media (QCI = 1) related dedicated bearer.\n-\tDelivery end point: LMISF-CC.\nThe details of ActivateTask sent to the BBIFF-U in SGW-U over LI_T3 are shown in table 7.10.4.5-2.\nTable 7.10.4.5-2: ActivateTask message for triggering the BBIFF-U in the SGW-U\n\nThe DeactivateTask sent to the BBIFF-U present in the SGW-U over LI_T3 shall include the XID of the Task created by the ActivateTask message (see table 7.10.4.5-2).\nThe BBIFF-U in UPF and the BBIFF-U in SGW-U shall send the xCC over LI_X3_LITE_M for each of the packet matching the criteria specified in the Triggering message (i.e. Activate Task message) received over the LI_T3 from the BBIFF-C.\nThe BBIFF in SGW shall identify the IMS voice media (QCI = 1) related dedicated bearer associated with the IMS signaling related bearer as indicated in the trigger received over the LI_T1 from the LMISF-IRI and then send xCC over LI_X3_LITE_M for each of the packet captured from that dedicated bearer.\nThe BBIFF-U/BBIFF shall set the payload format to indicate the appropriate payload type (5 for IPv4 Packet, 6 for IPv6 Packet, or 12 for GTP-U Packet as described in ETSI TS 103 221-2 [8] clauses 5.4 and 5.4.13).\nThe xCC generated at the LMISF-CC shall be same as the xCC generated in the CC-POIs present in the IMS media functions. Further details of this are not specified in the present document.\nThe correlation identifier value included in the xCC of an IMS session can be dependent on the UDP port numbers associated with the voice-media related RTP streams. This is the case when a user is involved in multiple IMS sessions. An illustrated of this is shown in clause 7.10.4.8\nThe xIRIs generated at the LMISF-IRI shall be correlated using the correlation identifier field defined ETSI TS 103 221-2 [8]. This correlation identifier value can be independent of the correlation identifier value received in the xCC from the BBIFF-U/BBIFF over the LI_X3_LITE_S interface.\nFurthermore, the xIRIs generated at the LMISF_IRI shall include the correlation identifier value used in the xCC generated at the LMISF-CC. Any intra-LMISF interactions required to associate the correlation identifier values used by the LMISF-IRI and LMISF-CC are outside the scope of the present document.\nEach session-leg of an IMS session may have to be correlated separately. This is accomplished using the RTP/RTCP port numbers present in the SDP of IMS signaling message and the UDP port numbers present in the IMS voice media related RTP as illustrated in figure 7.10.4.8-1 below.\nThe figure depicts a correlation at the session-leg level, illustrating the correlation between two signals at the session-leg level. This is an important concept in signal processing and communication systems, as it helps in understanding the relationship between two signals and their corresponding paths. The figure provides a visual representation of the correlation, allowing for a better understanding of the signal's behavior and the path it takes through the system.\nFigure 7.10.4.8-1: Correlation at the session-leg level (an illustration)\nFigure 7.10.4.8-1 illustrates an example where an IMS session includes two session-legs.\nSession-leg 1:\n-\tSource IP address: 192.0.2.10 and source port number: 24000 (RTP), 24001 (RTCP).\n-\tDestination IP address: 198.51.100.1 and destination port number: 32000 (RTP), 32001 (RTCP).\nSession-leg 2:\n- \tSource IP address: 192.0.2.10 and source port number: 26000 (RTP), 26001 (RTCP).\n-\tDestination IP address: 198.51.100.1 and destination port number: 36000 (RTP), 36001 (RTCP).\nThe IP address of the two end-points happen to be the same for the two session legs. The RTP port numbers present in the SDP of IMS signaling message and the UDP port numbers of the associated with the IMS voice-media related RTP happen to be the same for a session-leg.\nTherefore, in general, multiple session-legs can be identified using the RTP port numbers present in the SDP of IMS signaling message and the UDP port numbers associated with the IMS voice-media related RTP.\nWhen an xIRI is received over LI_X2 from the LMISF-IRI, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe IRI messages delivered over the LI_HI2 for HR LI are same as the IRI messages delivered over the LI_HI2 for LI IMS-based voice services. Further details of this are outside the scope of the present document.\nWhen the xCC is received over LI_X3 from the LMISF-CC, the MDF3 shall deliver the CC over LI_HI3 without undue delay.\nThe CC delivered over the LI_HI3 for HR LI is the same as the CC delivered over the LI_HI3 for LI IMS-based voice services. Further details of this are outside the scope of the present document.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.10.4.2-1: ActivateTask message for activating LMISF-IRI for Phase-2",
                                    "table number": 378,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.4.2-2 ActivateTask message for MDF2",
                                    "table number": 379,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.4.2-3: Mediation Details for MDF2",
                                    "table number": 380,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.4.2-4 ActivateTask message for MDF3",
                                    "table number": 381,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.4.2-5: Mediation Details for MDF3",
                                    "table number": 382,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.4.4-1: ActivateTask message for triggering the BBIFF-C in the SMF over LI_T1",
                                    "table number": 383,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.4.4-2: Target Identifier Types for LI_T1 (BBIFF-C in SMF)",
                                    "table number": 384,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.4.4-3: ActivateTask message for triggering BBIFF-C/BBIFF in the SGW-C/SGW over LI_T1",
                                    "table number": 385,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.4.4-4: Target Identifier Types for LI_T1 (BBIFF-C/BBIFF in SGW-C/SGW)",
                                    "table number": 386,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.4.5-1: ActivateTask message for triggering the BBIFF-U in the UPF over LI_T3",
                                    "table number": 387,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.10.4.5-2: ActivateTask message for triggering the BBIFF-U in the SGW-U",
                                    "table number": 388,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "7.11\tSTIR/SHAKEN and RCD/eCNAM",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.11.1\tProvisioning over LI_X1",
                            "text_content": "When the interception of STIR/SHAKEN is required, the LIPF shall provision the IRI-POI present in the following IMS NFs for the reporting of signing and verification results, as applicable:\n-\tIBCF.\n-\tTelephony AS.\nIf the IRI-POI functions in IBCF or Telephony AS are already provisioned for IMS-based services, then separate provisioning is not required. However, the \"ReportDiversionPASSporTInfo\" shall be included, as specified in clause 7.11.1.2, as a part of provisioning the IRI-POIs in Telephony AS and IBCF for IMS-based services.\nNOTE:\tThe P-CSCF and LMISF-IRI may also provide IRI-POI functions for reporting of STIR/SHAKEN validation results when the target (or user communicating with the target non-local ID) is roaming (P-CSCF with LBO and LMIF-IRI with home-routed). However, separate provisioning of those IRI-POIs for STIR/SHAKEN is not required.\nThe LIPF provisions the IRI-POIs present in the NFs mentioned in 7.11.1.1 using the X1 protocol as described in clause 5.2.2 with the following target identifier formats as defined in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):\n-\tIMPU.\nThe \"div\" PASSporT information for the redirecting party (ies) when the IMS session is redirected later on the signaling path may have to be reported to some LEAs. To identify the need for such reporting, a parameter \"ReportDiversionPASSporTInfo\" shall be included as part of ActivateTask message.\nTable 7.11.1.2-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POI in the Telephony AS, IBCF, for separate provisioning case, for STIR/SHAKEN and RCD/eCNAM.\nTable 7.11.1.2-1: ActivateTask message for IRI-POI in the IMS Network Functions for STIR/SHAKEN and RCD/eCNAM\n\nTable 7.11.1.2-2: STIRSHAKENProvisioning extension\n\nWhen the IRI-POIs in Telephony AS or IBCF are provisioned for IMS-based services, then the minimal details of LI_X1 ActivateTask message shall be as defined in clause 7.12.3.2.1 (table 7.12.3.2-2) with the addition of \"ReportDiversionPASSporTInfo\" parameter.\nThis clause is applicable when the MDF2 is not provisioned for IMS-based interception.\nThe MDF2 listed as the delivery endpoint for xIRI generated by the IRI-POI in the IMS Network Functions for STIR/SHAKEN and RCD/eCNAM shall be provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2. Table 7.11.1.3-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF2.\nThe MDF2 shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):\n-\tIMPU.\nTable 7.11.1.3-1: ActivateTask message for MDF2\n\nTable 7.11.1.3-2: Mediation Details for MDF2\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.11.1.2-1: ActivateTask message for IRI-POI in the IMS Network Functions for STIR/SHAKEN and RCD/eCNAM",
                                    "table number": 389,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.11.1.2-2: STIRSHAKENProvisioning extension",
                                    "table number": 390,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.11.1.3-1: ActivateTask message for MDF2",
                                    "table number": 391,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.11.1.3-2: Mediation Details for MDF2",
                                    "table number": 392,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.11.2\tGeneration of xIRI at IRI-POI in the IMS Network Functions over LI_X2",
                            "text_content": "The IRI-POI present in the IMS Network Functions for STIR/SHAKEN and RCD/eCNAM shall send xIRI over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.14.3, each of which is described in the following clauses.\nNOTE:\tThe clauses below on signing and verification shall be applied for diverted call based on the RFC 8946 [76]. LI system has to generate xIRI containing all the pASSporT objects of the SIP messages and signature validation or generation results, even those of the History-Info field.\nThe IRI-POI present in the Telephony AS or IBCF, shall generate an xIRI containing a STIRSHAKENSignatureGeneration record under the following conditions:\n-\tTelephony AS or IBCF is interacting with the SIGNING AS. Whether it is the Telephony AS or IBCF for sessions is based on network configuration and local policy of the CSP as described in clause 7.11.2.4.\n-\tWhen P-Asserted Identity or From header of SIP INVITE request received from S-CSCF is a target identity with the conditions mentioned below:\n-\tThe identities in one or both of those headers are used to interact with the SIGNING AS.\n-\tThe \"shaken\" PASSporT is not received in the SIP INVITE request from the S-CSCF.\n-\tThe \"shaken\" PASSporT is received from the SIGNING AS.\n-\tThe \"shaken\" PASSporT is included in the outgoing SIP INVITE.\n-\tWhen the \"ReportDiversionPASSporTInfo\" parameter is set to \"True\" in the ActivateTask with P-Asserted Identity or From header of SIP INVITE request received from S-CSCF is a target identity with the conditions mentioned below:\n-\tThe identities in one or both of those headers are used to interact with the SIGNING AS.\n-\t\tA \"shaken\" PASSporT or a \"div\" PASSporT with those identities are included in the \"orig\" claim of \"shaken\" or \"div\" PASSporT received from the SIGNING AS.\n-\tThe \"shaken\" PASSporT or a \"div\" PASSporT with those identities are included in the \"orig\" claim of \"shaken\" or \"div\" PASSporT in the outgoing SIP INVITE.\n-\tWhen Diversion header or the History Info of SIP INVITE request received from the S-CSCF includes a target identity with the conditions mentioned below:\n-\tThe identities in one or both of those headers are used to interact with the SIGNING AS.\n-\tThe \"div\" PASSporT with those identities in the \"div\" claim is not received in the SIP INVITE request from the S-CSCF.\n-\tThe \"div\" PASSporT with those identities in the \"div\" claim is received from the SIGNING AS.\n-\tThe \"div\" PASSporT with those identities in the \"div\" claim is included in the outgoing SIP INVITE.\n-\tWhen the \"ReportDiversionPASSporTInfo\" parameter is set to \"True\" in the ActivateTask with Diversion or HistoryInfo header of SIP INVITE request received from S-CSCF includes the target identity with the conditions mentioned below:\n-\tThe identities in P-Asserted Identity or From of SIP INVITE received from the S-CSCF are used to interact with the SIGNING AS.\n-\tA \"div\" PASSporT with the identities in P-Asserted Identity or From of SIP INVITE request received from S-CSCF are included in the \"orig\" claim of \"div\" PASSporT received from the SIGNING AS.\n-\tThe \"div\" PASSporT with the identities in P-Asserted Identity or From of SIP INVITE request received from S-CSCF are included in the \"orig\" claim of \"div\" PASSporT in the outgoing SIP INVITE.\n-\tWhen Request URI of outgoing SIP INVITE is a target non-local ID and is present in the \"dest\" claim of \"shaken\" or \"div\" PASSporT received from the SIGNING AS and the same is included in the outgoing SIP INVITE.\n-\tWhen Telephony AS is interacting with the SIGNING AS, and when Request URI of SIP INVITE received from the S-CSCF is a target identity with the conditions mentioned below:\n-\tThe identity is used to interact with the SIGNING AS.\n-\tThe \"div\" PASSporT with that identity in the \"div\" claim is received from the SIGNING AS.\n-\tThe \"div\" PASSporT with that identity in the \"div\" claim is included in the outgoing SIP INVITE.\nWhen the target is not a non-local ID, the STIRSHAKENSignatureGeneration includes only the PASSporT received in the SIGING AS response with the following rules:\n-\tWhen the \"ReportDiversionPASSporTInfo\" parameter is set to \"True\" in the ActivateTask, all of the PASSporT received from the SIGNING AS.\n-\tWhen the \"ReportDiversionPASSporTInfo\" parameter is set to \"False\" in the ActivateTask:\n-\tIf P-Asserted Identity or From header in the SIP INVITE received from the S-CSCF is a target identity, then only \"shaken\" PASSporT received from the SIGNING AS with those identities in the \"orig\" claim of the \"shaken\" PASSporT.\n-\tIf Diversion or HistoryInfo header in the SIP INVITE received from the S-CSCF is a target identity, then only the \"div\" PASSporT received from the SIGNING AS with those identities in the \"div\" claim of \"div\" PASSporT.\n-\tIf REQUEST URI or To header in the SIP INVITE received from the S-CSCF is a target identity, then only the \"div\" PASSporT received from the SIGNING AS with those identities in the \"div\" claim of \"div\" PASSporT.\nWhen the target is non-local ID, STIRSHAKENSignatureGeneration includes all of the PASSporT included in the outgoing SIP message.\nThe following table contains parameters, with IRITargetIdentifier, generated by the IRI-POI.\nTable 7.11.2.2-1: Payload for STIRSHAKENSignatureGeneration record\n\nTable 7.11.2.2-2: Details for PASSporT parameter\n\nTable 7.11.2.2-3: Details for pASSporTHeader parameter\n\nTable 7.11.2.2-4: Details for pASSporTPayload parameter\n\nThe IRI-POI present in the Telephony AS or IBCF, shall generate an xIRI containing a STIRSHAKENSignatureValidation record when the following conditions are met:\n-\tEither IBCF or Telephony AS, is interacting with the VERIFICATION AS. Whether it is the Telephony AS or IBCF for sessions is based on network configuration and local policy of the CSP as described in clause 7.11.2.5.\n-\tWith one or more of the following are true:\n-\tRequest URI and To Headers of SIP INVITE request received from S-CSCF (in the case of Telephony AS) or from the previous IP network (in the case of IBCF) is a target identity.\n-\tOne or more of P-Asserted Identity, From, Diversion, History-Info Headers of SIP INVITE request received from S-CSCF (in the case of Telephony AS) or from the previous IP network (in the case of IBCF) is a target non-local identity without any prior intra-network diversions.\n-\tIf PASSporTs are received in the SIP INVITE request, they are submitted by the IBCF to the VERIFICATION AS for validation and the result is included in an outgoing SIP INVITE request together with possible RCD data or eCNAM data as Call-Info headers.\n-\tIf PASSporTs are received in the SIP INVITE request, they are submitted by the Telephony AS to the VERIFICATION AS for validation and the validation result is received from the Verification AS and the outgoing SIP INVITE possibly includes RCD data or eCNAM data as Call-Info headers.\nNOTE:\tThe IRI-POI may use the Via headers, Record-route headers to determine any prior intra-network diversions.\nThe IRI-POI present in the Telephony AS shall also generate an xIRI containing a STIRSHAKENSignatureValidation record when it detects the following conditions:\n-\tSession is redirected.\n-\tRequest URI header of outgoing SIP INVITE is a target identity.\n-\tValidation result is included in the outgoing SIP INVITE with the possible the RCD data and the eCNAM data as Call-Info headers.\nThe IRI-POI present in the LMISF-IRI or P-CSCF shall generate an xIRI containing a STIRSHAKENSignatureValidation record when the following conditions are met:\n-\tWith one or more of the following are true:\n-\tRequest URI or To header of SIP INVITE request sent to the UE is a target identity.\n-\tOne or more of P-Asserted Identity, From, Diversion, History-Info Headers of SIP INVITE request sent to the UE is a target non-local identity.\n-\tSIP INVITE request sent to the UE includes SIP Call-Info headers containing possible RCD data or eCNAM data, and the result of the PASSporT verification.\nIn the above paragraphs, a validation result (i.e. result of all PASSporT verification) is included means a \"verstat\" parameter within the P-Asserted Identity header is included in the outgoing SIP INVITE.\nThe following table contains parameters, with IRITargetIdentifier, generated by the IRI-POI.\nTable 7.11.2.3-1: Payload for STIRSHAKENSignatureValidation record\n\nWhen the termination network performs SHAKEN verification, one of the following values shall be assigned to the SHAKEN validation result parameter as part of the display information: \"TN-Validation-Passed\", \"TN-Validation-Failed\", or \"No-TN-Validation\". In case of TN-Validation-Failed, the SHAKEN failure status code shall be present and coded as an integer. The SHAKEN failure status codes are at least, according to RFC 8224 and to IANA Session Initiation Protocol (SIP) Parameters [75]:\n-\t403 \"Stale Date\" response code is sent when the verification service receives a request with a Date header field value that is older than the local policy of the CSP for freshness permits. The same response may be used when the \"iat\" has a value older than the local policy of the CSP for freshness permits.\n-\t428 \"Use Identity Header\" response code is sent when the verification service receives a SIP request that lacks an Identity header. This is to indicate that the request should be re-sent with an Identity header.\n-\t436 \"Bad Identity-Info\" response code is used to indicate an inability to acquire the credentials needed by the verification service for validating the signature in an Identity header field.\n-\t437 \"Unsupported Credential\" response code is used when the verification service cannot validate the certificate referenced by the URI of the Identity-Info header, for reasons such as failing to trust the issuing certification authority (CA) or failing to support the algorithm with which the credential was signed.\n-\t438 \"Invalid Identity Header\" response code is used to indicate that of the set of Identity header fields in a request, no header field with a valid and supported Identity token has been received.\nThe Telephony AS interacts with the SIGNING AS when any of the following is true:\n-\tRCD is supported.\n-\tIntra-CSP session signing is required.\n-\tCSP choice for signing is AS.\nThe IBCF interacts with the SIGNING AS when all of the following are true:\n-\tRCD is not supported.\n-\tIntra-CSP session signing is not required.\n-\tCSP choice for signing is IBCF.\nThe IBCF also interacts with the SIGNING AS for an IMS emergency session.\nThe presence of RCD is on a per call basis.\nThe Telephony AS interacts with the VERIFICATION AS when any of the following is true:\n-\tIntra-CSP session verification is required.\n-\tCSP choice for verification is AS.\n-\tCSP choice for emergency session callback verification is AS.\nThe IBCF interacts with the VERIFICATION AS when all of the following are true:\n-\tIntra-CSP session verfication is not required.\n-\tCSP choice for verification is IBCF.\nThe IBCF also interacts with the VERIFICATION AS for an IMS emergency session callback when the CSP choice for verification for emergency callback session is IBCF.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.11.2.2-1: Payload for STIRSHAKENSignatureGeneration record",
                                    "table number": 393,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.11.2.2-2: Details for PASSporT parameter",
                                    "table number": 394,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.11.2.2-3: Details for pASSporTHeader parameter",
                                    "table number": 395,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.11.2.2-4: Details for pASSporTPayload parameter",
                                    "table number": 396,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.11.2.3-1: Payload for STIRSHAKENSignatureValidation record",
                                    "table number": 397,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.11.3\tGeneration of IRI over LI_HI2",
                            "text_content": "When an xIRI is received over LI_X2 from an IRI-POI, the MDF2 shall generate the corresponding IRI message and deliver over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record (STIRSHAKENSignatureGeneration or STIRSHAKENSignatureValidation) received in the xIRI over LI_X2.\nThe MDF2 shall able to remove information regarded as content from RCD or eCNAM parameters in the case of an IRI-only warrant. The details of what needs to be removed and under what circumstances are outside the scope of the present document.\nThe timeStamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time present in the timestamp field of the xIRI.\nThe threeGPP33128DefinedIRI field (see ETSI TS 102 232-7 [10] clause 15) shall be populated with the BER-encoded IRIPayload.\nThe STIRSHAKENSignatureGeneration and STIRSHAKENSignatureValidation IRI messages shall have the same CIN as in the other IRI messages delivered for the IMS session (see ETSI TS 102 232-1 [9] clause 5.2.4).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.11.3-1.\nTable 7.11.3-1: IRI type for IRI messages\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.11.3-1: IRI type for IRI messages",
                                    "table number": 398,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "7.12\tLI for IMS based services",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.12.1\tGeneral",
                            "text_content": "The present document provides two options for stage 3 definitions for implementing IMS LI:\n-\tUse LI_X1, LI_X2 and LI_X3 interfaces specified below in the present document.\n-\tUse TS 33.107 [36] and TS 33.108 [12] natively as defined in that document.\nIn both cases, the present document specifies the stage 3 for the LI_HI1, LI_HI2 and LI_HI3 interfaces.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.12.2\tOverview",
                            "text_content": "This clause defines protocol and procedures to support the LI for IMS-based services. The scope of LI functions defined here are based on the IMS LI architecture defined in TS 33.127 [5] that includes:\n-\tTarget type – local ID, non-local ID.\n-\tRoaming considerations – local break-out (LBO), home-routed (HR).\n-\tService specific aspects - normal sessions, redirected sessions, conferencing, STIR/SHAKEN, RCD/eCNAM.\n-\tLocation reporting.\nThe IMS LI shall apply to all IMS-based services unless restricted by the service scoping as defined in clause 4.4 of the present document. When restricted by the service scoping, the IMS LI applies only to service types listed in table C.2 of ETSI TS 103 221-1 [7]). Clause 7.12.2.5 provides further details of IMS LI with service scoping.\nAs defined in TS 33.127 [5], the NFs that provide the IRI-POI and CC-TF are in the IMS signaling functions that handle the SIP messages and the NFs that provide the CC-POI are in the IMS media functions. The media interception in the packet core network (EPC or 5GC) is outside the scope of the present document.\nFor some of the services listed above, an alternate deployment option in addition to the default option is also specified in TS 33.127 [5]. The NFs that provide the IRI-POI, CC-TF and CC-POI in the alternate deployment option can be different.\nThe LIPF provisioning scenarios for IMS LI is illustrated in TR 33.928 [121].\nAn IMS user served by the CSP can be the target or can be in communication with a target non-local ID. In the former case, the target can also be an outbound roaming IMS user or an inbound roaming IMS user (see clause 7.12.2.3).\nNOTE:\tA target non-local ID is identified distinctly through the provisioning.\nThe following target identifier formats (ETSI TS 103 221-1 [7]) can be used to identify a target for IMS based services:\n-\tIMPU.\n-\tIMPI.\n-\tPEIIMEI.\n-\tIMEI.\nWhen service scoping is applicable, additional target identities may be used in LI for IMS based specific services (e.g. MCPTT ID for PTC). The details of such additional target identities are provided in the service specific clauses of the present document.\nThe target identity in the IMPI format may contain a value derived from a SUPI or an IMSI. The target identity in the IMPU format containing a SIP URI or TEL URI may contain a value derived from a SIP URI, TEL URI, GPSI, MSISDN, an E.164 number or IMSI. Only IMPU is used for target non-local ID.\nAn IMS user who is the target, or in communication with the target non-local ID, can be part of the following roaming scenarios for the LI purpose:\n-\tNon-roaming.\n-\tOutbound roaming with HR.\n-\tOutbound roaming with LBO.\n-\tInbound roaming with HR.\n-\tInbound roaming with LBO.\nThe details of LI functions for the case of inbound roaming with HR are described in clause 7.10.\nThe NFs that provide the IRI-POI, CC-TF and CC-POI functions can be different depending on the IMS session scenarios the target, or the IMS user in communication with a target non-local ID, is involved in.\nAn IMS user shall be considered to be in communications with a target non-local ID even if the session is redirected from that target non-local ID.\nThis includes LI for session originations and session terminations.\nLI for session originations applies when an IMS session is originated by an IMS user whose communications are intercepted either because that originating IMS user happens to be a target or because that originating IMS user happens to be in communications with a target non-local ID. The originating IMS user can also be inbound roaming (LBO or HR) or outbound roaming (LBO or HR).\nLI for session terminations applies when an IMS session is terminated to an IMS user whose communications are intercepted either because that terminating IMS user happens to be a target or because that terminating IMS user happens to be in communications with a target non-local ID. The terminating IMS user can also be inbound roaming (LBO or HR) or outbound roaming (LBO or HR).\nThe other party can be within the same CSP domain (intra-CSP sessions) or in another CSP domain (inter-CSP sessions). In the latter case, the other CSP can be CS-based or IP-based. For target non-local ID, the session is always an inter-CSP session.\nThis includes LI for the incoming IMS sessions that are redirected.\nLI for redirected sessions applies when a terminating session to a target is redirected to (or forwarded to) another user. Either the target (i.e. redirecting party) or the redirected-to party can be outbound roaming (LBO or HR).\nThe redirected-to party can be in the same CSP domain as that of initial terminating party (i.e. redirecting party) or can be a another CSP domain. In the latter case, the other CSP can be CS-based or IP-based. The LI for redirected sessions in the VPLMN are handed as LI for session terminations.\nThis includes the LI for conferencing services.\nLI for conferencing services applies when a target initiates a multi-party conferencing session or when a target joins a \"meet-me\" conferenceing session or when a \"meet me\" conferencing session is established with conferencing URI itself being the target.\nWhen a target happens to be one of the participant of a conference initiated by another IMS user, the LI for normal sessions (see clause 7.12.2.4.2) applies.\nThis includes the LI for STIR/SHAKEN when signature is signed or verified in an IMS session involving a target as described in TS 33.127 [5].\nThe further details of LI for STIR/SHAKEN are described in clause 7.11.\nThis includes the LI for RCD/eCNAM when enhanced calling name is included in a terminating IMS session involving a target as described in TS 33.127 [5].\nThe further details of LI for RCD/eCNAM are described in clause 7.11.\nLI for IMS-based services shall support service scoping with the following specific service types:\n-\tVoice.\n-\tPTC.\n-\tMessaging.\n-\tRCS.\n-\tLALS.\nWhen an NF is involved in the handling of one or more of the above mentioned IMS-based services (e.g. voice, messaging at the S-CSCF), the LI functions within that NF shall limit the interception to the service type to which the warrant applies. However, type of service used by a UE may not be known when an IMS session begins, or if known, may change while, or after, the session is established. Therefore, the present document limits the applicability of service-based interception to the media only.\nThe present document supports service-based interception to signaling as well media when the NF is involved in the handling of a specific service mentioned above (e.g. PTC server for PTC).\nWhen service scoping is not applicable, the delivery of IRI and CC for IMS-based services are done independent of service types. Location reporting aspects that are also part of the service scoping are described in clause 7.12.2.6.\nThis includes the LI for IMS-based voice services.\nLI for IMS-based voice services applies to the interception of IMS-based voice media for the IMS sessions involving the targets if and only if the m-line in the SDP answer includes either one of the following:\n-\tAudio.\n-\tText.\nFor the generation and delivery of IRI for the IMS sessions, the LI for IMS-based voice is handled independent of the m-line in the SDP.\nIf the m-line includes \"audio\" and \"video\" then only audio part of the media is intercepted.\nIt is possible that SDP offer and SDO answer may have different information in m-line. The determination on whether to intercept the voice media is based on the final outcome of SDP offer and answer, which happens to be in the SDP answer.\nThe media associated with an IMS session may also change in the middle of a session using the re-INVITE procedures invoked by either of the parties involved in the session. Accordingly, the interception of voice media may resume or cease in the middle of an IMS session based media type negotiated at the conclusion the related SDP offer and answer.\nNOTE:\tThe present document excludes the m-line values of video, msrp, image, application and other, for Service Type of \"voice\" while determining the media interception (i.e. CC delivery).\nThis includes LI for SMS over IP and MSRP originated from, or terminated to, a target.\nLI for SMS over IP originated from a target applies to the interception of a SIP MESSAGE originated from an IMS user who happens to be a target or happens to be receiving a SIP MESSAGE that has originated from a target non-local ID. That IMS user can also be inbound roaming (LBO or HR) or outbound roaming (LBO or HR).\nLI for SMS over IP terminated to a target applies to the interception of a SIP MESSAGE terminated to an IMS user who happens to be a target or happens to be sending the SIP MESSAGE to a target non-local ID. That IMS user can also be inbound roaming (LBO or HR) or outbound roaming (LBO or HR).\nLI for MSRP applies to the interception of media for the IMS sessions involving the targets if and only if MSRP is included in the m-line of the SDP answer. For the generation and delivery of IRI for the IMS sessions, the LI for messaging is handled independent of the m-line in the SDP.\nWhen service scoping applies, the LI for Messaging (i.e. SMS over IP or MSRP) is provided if and only if the \"messaging\" service type is included as a part of LI provisioning. If no service type is provisioned, service scoping does not apply and the LI for messaging shall be provided (per clause 4.4.2).\nThis includes LI for IMS-based voice services (see clause 7.12.2.5.3) when an incoming voice session to an IMS user who happens to be a target or an incoming voice session to an IMS user from a target non-local ID is redirected to a voice mail server.\nWhen the incoming session happens to be from a target non-local ID to an IMS user, the retrieval of the voice message from the voice mail server is not intercepted. However, when the IMS user who happens to be the target, the retrieval of the voice message from the voice-mail server may be intercepted in the network that handles the IMS session initiated from the target used to retrieve the voice message.\nWhen service scoping applies, LI for voice-mail is provided if and only if \"voice\" service type is included as a part of LI provisioning. If no service type is provisioned, service scoping does not apply and the LI for voice-mail shall be provided (per clause 4.4.2).\nThis includes the LI for RCS services when a target executes one of the RCS related services described in TS 33.127 [5].\nThe further details of LI for RCS are described in clause 7.13.\nThis includes LI for PTC when a target is engaged in a PTC service as described in TS 33.127 [5].\nThe further details of LI for PTC are described in clause 7.5.\nThis includes the reporting of location by the LI-LCS Client triggered by the LTF as described in TS 33.127 [5].\nThe further details of LALS triggering are defined in clause 7.3.\nWhen the location reporting is only required at the beginning and end of an IMS session, the location is reported when an IMS session is originated (SIP INVITE) from a target or terminating session is answered (SIP 200 OK for INVITE) from the target or either of the two sessions are released (SIP BYE from the target or SIP 200 OK for BYE from the target).\nAs described in TS 33.127 [5], some of the service types may have two deployment options denoted as \"default option\" and \"alternate option\".\nAs illustrated in TR 33.928 [121], the LIPF provisions the LI functions in a NF based on the option the CSP has deployed within the network.\nAn IMS based communication is intercepted when one of the following is true:\n-\tThe calling party identity on session originations or SMS originations is a target.\n-\tThe called party identity on session originations is a target non-local ID.\n-\tThe destination party identity in SMS originations is a target non-local ID.\n-\tThe called party identity on session terminations or SMS terminations is a target.\n-\tThe calling party identity on session terminations is a target non-local ID.\n-\tThe origination party identity in SMS terminations is target non-local ID.\n-\tThe redirecting party identity on session terminations is a target non-local ID.\n-\tIn the alternate deployment option for redirected sessions (see TS 33.127 [5]), redirecting party is a target.\n-\tThe redirected-to party identity is a target non-local ID.\n-\tThe conference URI in a conferencing session is a target.\nThe above identities are used to identify that an IMS session is intercepted in the IRI-POI and in the CC-TF, the latter when the LI requires CC interception. In addition, the CC-TF uses the redirecting party identity to trigger the CC-POI even if the target is not a non-local ID.\nWhen an IMS UE performs an IMS registration (using SIP REGISTER) request, the IRI-POI/CC-TF examines the following for a target match:\n-\tFrom header and To header of the SIP REGISTER when the target identity is IMPU.\n-\t+sip.instance-id of Contact header of the SIP REGISTER when the target identity is PEIIMEI or IMEI.\n- \tDigest username of Authorization header of the SIP REGISTER when the target identity is IMPI.\nNOTE:\tThe SIP REGISTER that carries the Authorization header is sent in response when the initial Registration is challenged.\nA target match for SIP REGISTER can only be done when the NF where the IRI-POI resides is in the path of the SIP REGISTER flow (e.g. P-CSCF, S-CSCF).\nThis clause describes the method used to identify a session-based IMS service such as IMS-based voice service.\nWhen an IMS session is originated from an IMS UE (using SIP INVITE), the IRI-POI/CC-TF examines the following to verify for a target match:\n-\tP-Asserted Identity header and From header present in the SIP INVITE when the target identity is IMPU.\n-\tRequest URI header and To header present in the SIP INVITE when the target identity is IMPU and target is non-local ID.\n-\tDigest username of Authorization header of the SIP REGISTER when the target identity is IMPI.\n-\t+sip.instance-id of Contact header received in the SIP REGISTER request when the target identity is PEIIMEI or IMEI.\nThe use of Request URI header and To header present in the SIP INVITE for matching target non-local ID is done on the redirected sessions irrespective of whether the session is originated from an IMS UE.\nWhen an IMS session is terminated at an IMS UE (using SIP INVITE), the IRI-POI/CC-TF examines the following to verify for a target match:\n-\tRequest URI and To header present in the SIP INVITE when the target identity is IMPU.\n-\tP-Asserted-Identity, From header, History Info header and Diversion header present in the SIP INVITE when the target identity is IMPU and target is non-local ID.\n-\tDigest username of Authorization header of the SIP REGISTER when the target identity is IMPI.\n-\t+sip.instance-id of Contact header received in the SIP REGISTER request when the target identity is PEIIMEI or IMEI.\nNOTE:\tIRI-POI/CC-TF that uses the information received in the SIP REGISTER to perform a target match cannot do such a target match unless the NF is on the signaling path of SIP REGISTER flow.\nIn addition, the IRI-POI  in the alternate deployment option (TS 33.127 [5]) and CC-TF, examine the following to verify a target match when an IMS session is terminated to an IMS UE:\n-\tHistory Info header and Diversion header present in the SIP INVITE when the target identity is IMPU and the target is not a non-local ID.\nFor conference sessions, the IRI-POI and CC-TF examine the following to verify a target match:\n-\tP-Asserted-Identity, From header present in the SIP INVITE when a target initiates a conference session or when the target joins a \"meet-me\" conference session.\n-\tConference URI present in the SIP INVITE when the conference URI is the target.\nIRI-POI/CC-TF may use the Via header or the Route header to determine whether the SIP INVITE is for an originating IMS session or a terminating IMS session. IRI-POI/CC-TF stores (locally) the SIP Call Id to associate the subsequent SIP messages received on the same session for a target match.\nThis clause describes the method used to identify a session-independent IMS service (i.e. SMS over IP).\nFor SMS over IP, the SIP MESSAGE includes \"vnd.3gpp.sms\" as the MIME Content Type in the payload with RP-DATA or RP-ACK as the content, see 3GPP TS 24.341 [102].\nFor MSISDN-less SMS over IP (i.e. SIP URI instead of MSISDN), SIP MESSAGE additionally includes \"vnd.3gpp.sms+xml\" as the MIME Content Type in the payload with destination or origination addresses, see 3GPP TS 24.341 [102].\nThe target match for the SIP MESSAGE is done as shown below:\n-\tFor MO-SMS over IP, the P-Asserted Identity header and From header present in the SIP MESSAGE when the target identity is IMPU.\n-\tFor MO-SMS over IP, the TP-DA field of SMS-SUBMIT within the Message-body of SIP MESSAGE when the target identity is IMPU for target non-local ID.\n-\tFor MO-SMS over IP, the <To> field within the XML body of the content type \"vnd.3gpp.sms+xml\" present in the Message-body of SIP MESSAGE when the target identity is IMPU for target non-local ID.  In this case, the TP_DA field of SMS-SUBMIT is be set to dummy MSISDN, see 3GPP TS 24.341 [102].\n-\tFor MT-SMS over IP, the Request URI and To header present in the SIP MESSAGE when the target identity is IMPU.\n-\tFor MT-SMS over IP, the TP-OA field or TP-RA field of SMS-DELIVER or SMS-STATUS-REPORT within the Message-body SIP MESSAGE when the target identity IMPU for target non-local ID.\n-\tFor MSISDN-less MT-SMS over IP, the <From> field within the XML body of the content type \"vnd.3gpp.sms+xml\" present in the Message-body of  SIP MESSAGE when the target identity is IMPU for target non-local ID. In this case, the TP_OA of SMS-DELIVER or TP-RA field of SMS-STATUS-REPORT may be set to dummy MSISDN, see 3GPP TS 24.341 [102].\n-\tDigest username of Authorization header of the SIP REGISTER when the target identity is IMPI.\n-\t+sip.instance-id of Contact header received in the SIP REGISTER request when the target identity is PEIIMEI or IMEI.\nNOTE:\tIRI-POI/CC-TF that uses the information received in the SIP REGISTER to perform a target match cannot do such a target match unless the NF is on the signaling path of SIP REGISTER flow.\nIRI-POI may use the Via header or the Route header to determine whether the SIP MESSAGE is for MO-SMS over IP or MT-SMS over IP.\nThe IRI records delivered to the LEMF over the LI_HI2 and the CC delivered to the LEMF over LI_HI3 shall be correlated.\nAccording to the protocol defined in ETSI TS 103 221-1 [7] and ETSI TS 103 221-2 [8], the xIRI messages and the xCC carry the CorrelationID which enables the MDF2 and MDF3 to provide the needed correlation between the IRI and CC.\nWhen the CC-POI is triggered by a CC-TF, the CC-TF sends the CorrelationID to the CC-POI over the LI_T3 interface in the ActivateTask message. The CC-POI uses that CorrelationID in the xCC sent to the MDF3.\nNOTE:\tThe IRI-POI and CC-POI may be provided within the same NF (e.g. PTC Server, RCS Server). When the CC-POI is triggered from a CC-TF, the IRI-POI and CC-TF may be provided within the same NF (e.g. P-CSCF, AS/MRFC) or in different NFs (e.g. IRI-POI in S-CSCF and CC-TF in P-CSCF).\nWhen the IRI-POI and CC-POI (or CC-TF in a triggerred CC-POI case) are in the same NF, the procedures can be similar to the way the correlation of xIRI and xCC are done in the packet core system (e.g. IRI-POI and CC-TF in the SMF). The details of any needed interactions between those LI functions are not defined in the present document.\nWhen the IRI-POI and CC-TF are in separate NFs, any additional procedures that may be needed are also implementation specific and the details of the same are not described in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.12.3\tProvisioning over LI_X1",
                            "text_content": "The LIPF shall provision the IRI-POIs, CC-TFs, MDF2 and MDF3 over LI_X1 for IMS-based services using the X1 protocol as described in clause 5.2.2.\nThe clause 7.12.2.2 provides a list of target identifiers that shall be supported for IMS based services in a general sense.\nThe target identifiers used during the provisioning over LI_X1 for a specific IMS-based service (e.g. PTC) are listed in the respective service specific clauses.\nThe table 7.12.3.2-1 below shows the applicability of NFs in which the IRI-POIs are provisioned with the target identifiers listed in clause 7.12.2.2 for session based IMS sessions (e.g. voice). See TS 33.127 [5] and TR 33.928 [121].\nWhen the service scoping is applicable, the IRI-POIs in the NFs shown in table 7.12.3.2-1 are provisioned only when the type of service is voice/text or messaging (i.e. MSRP-based).\nTable 7.12.3.2-1: IRI-POIs in the NFs that need to be provisioned for session-based IMS service\n\nTable 7.12.3.2-2 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POIs in the NFs listed in tables7.12.3.2-1 for session based IMS-based services.\nTable 7.12.3.2-2: ActivateTask message for activating IRI-POI for session-based IMS service\nWhen service scoping is required, the IRI-POIs present in the NFs listed in table 7.12.3.2-1 shall support the following service types from the structure defined in ETSI TS 103 221-1 [7]:\n-\tThe enumerated value of \"voice\" or \"messaging\" in the service type field.\nThe ModifyTask and DeactivateTask messages that the LIPF may send to the IRI-POIs present in the NFs listed in table 7.12.3.2-1 shall include the XID of the Task created by the above ActivateTask message.\nTable 7.12.3.2-3 below shows the applicability of NFs in which the IRI-POIs are provisioned with the target identifiers listed in clause 7.12.2.2 for session independent services (e.g. SMS over IP). See TS 33.127 [5] and TR 33.928 [121].\nWhen the service scoping is applicable, the IRI-POIs in the NFs shown in table 7.12.3.2-3 are provisioned only when the service type is messaging (i.e. SMS over IP).\nTable 7.12.3.2-3: IRI-POIs in the NFs that need to be provisioned for session-independent IMS-based service\n\nTable 7.12.3.2-4 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POIs in the NFs listed in table 7.12.3.2-3 for session independent IMS-based voice services.\nTable 7.12.3.2-4: ActivateTask message for activating IRI-POI for session independent IMS-based service\nWhen service scoping is required, the IRI-POIs present in the NFs listed in table 7.12.3.2-3 shall support the following service types from the structure defined in ETSI TS 103 221-1 [7]:\n-\tThe enumerated value of \"messaging\" in the service type field.\nThe ModifyTask and DeactivateTask messages that the LIPF may send to the IRI-POIs present in the NFs listed in table 7.12.3.2-3 shall include the XID of the Task created by the above ActivateTask message.\nThe table 7.12.3.3-1 below shows the applicability of NFs in which the CC-TFs are provisioned with the target identifiers listed in clause 7.12.2.2 for session-based IMS services (e.g. voice). See TS 33.127 [5] and TR 33.928 [121].\nTable 7.12.3.3-1: CC-TFs in the NFs that need to be provisioned for session-based IMS service\n\nTable 7.12.3.3-2 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the CC-TFs in the NFs listed in table 7.12.3.3-1 for session-based IMS services.\nTable 7.12.3.3-2: ActivateTask message for activating CC-TF for session-based IMS services\nWhen service scoping is required, the CC-TF present in the NFs listed in table 7.12.3.3-1 shall support the following service scoping from the structure defined in ETSI TS 103 221-1 [7]:\n-\tThe enumerated value of \"voice\" or \"messaging\" in the service type field.\nThe ModifyTask and DeactivateTask messages that the LIPF may send to the CC-TFs present in the NFs listed in table 7.12.3.3-1 shall include the XID of the Task created by the above ActivateTask message.\nThe MDF2 listed as the delivery endpoint over LI_X2 for xIRI generated by the IRI-POIs shall be provisioned over LI_X1 by the LIPF.\nTable 7.12.3.4-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF2.\nTable 7.12.3.4-1 ActivateTask message for MDF2\n\nTable 7.12.3.4-2: Mediation Details for MDF2\n\nThe MDF2 shall support the following service scoping from the structure defined in ETSI TS 103 221-1 [7]:\n-\tThe enumerated value of \"voice\" or \"messaging\" in the service type field.\n-\tWhen location reporting is required, one or both of \"reportBeginingAndEnd\", \"reportUponChange\".\nThe ModifyTask and DeactivateTask messages that the LIPF may send to the MDF2 present in the NFs listed in table 7.12.3.4-1 shall include the XID of the Task created by the above ActivateTask message.\nThe MDF3 listed as the delivery endpoint over LI_X3 for xCC generated by the IRI-POIs shall be provisioned over LI_X1 by the LIPF.\nTable 7.12.3.5-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF3.\nTable 7.12.3.5-1 ActivateTask message for MDF3\n\nTable 7.12.3.5-2: Mediation Details for MDF3\n\nWhen service scoping is required, the MDF3 shall support the following service scoping from the structure defined in ETSI TS 103 221-1 [7]:\n-\tThe enumerated value of \"voice\" or \"messaging\" in the service type field.\nThe ModifyTask and DeactivateTask messages that the LIPF may send to the MDF3shall include the XID of the Task created by the above ActivateTask message.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.12.3.2-1: IRI-POIs in the NFs that need to be provisioned for session-based IMS service",
                                    "table number": 399,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.3.2-2: ActivateTask message for activating IRI-POI for session-based IMS service",
                                    "table number": 400,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.3.2-3: IRI-POIs in the NFs that need to be provisioned for session-independent IMS-based service",
                                    "table number": 401,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.3.2-4: ActivateTask message for activating IRI-POI for session independent IMS-based service",
                                    "table number": 402,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.3.3-1: CC-TFs in the NFs that need to be provisioned for session-based IMS service",
                                    "table number": 403,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.3.3-2: ActivateTask message for activating CC-TF for session-based IMS services",
                                    "table number": 404,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.3.4-1 ActivateTask message for MDF2",
                                    "table number": 405,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.3.4-2: Mediation Details for MDF2",
                                    "table number": 406,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.3.5-1 ActivateTask message for MDF3",
                                    "table number": 407,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.3.5-2: Mediation Details for MDF3",
                                    "table number": 408,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.12.4\tGeneration of xIRIs over LI_X2",
                            "text_content": "The IRI-POIs present in the NFs provisioned as shown in table 7.12.3.3-1 generate the xIRIs according to the conditions described in TS 33.127 [5] and illustrated in TR 33.928 [121].\nAs described in TS 33.127 [5], clause 7.12.3.2.2 and illustrated in TR 33.928 [121], the present document supports two deployment options:\n-\tDefault option.\n-\tAlternate option.\nThe options used for LI involving a specific IMS service may be different from the option used for LI involving another IMS service. For example, a default option may be used for target non-local ID and an alternate option may be used for a local target ID.\nNOTE:\tOne of the obvious conditions not stated in the subsequent clauses is that an NF can provide an IRI-POI functions if and only if the SIP signaling messages pass through that NF.\nWhen a condition (e.g. inbound roaming with LBO) under which an NF provides the IRI-POI functions is dependent on the handling of SIP REGISTER message, the IRI-POIs may have to scan the SIP REGISTER for all IMS users to address the case when that IMS user engages in a communication with a target non-local ID.\nIn the default deployment option, the P-CSCF provides the IRI-POI functions when any of the following conditions are met:\n-\tThe target is inbound roaming (with LBO) IMS user and is not registered for emergency services. The E-CSCF provides the IRI-POI functions when the target is registered for the emergency services.\n-\tAn inbound roaming (with LBO) IMS user is in communication with a target non-local ID.\nIn the alternate deployment option, the P-CSCF always provides the IRI-POI functions except for the following cases:\n-\tA non-roaming or outbound roaming (with HR) IMS user in communication with a target non-local ID. The S-CSCF provides the IRI-POI functions for such a case.\n-\tAn inbound roaming (with LBO) IMS user is in communication with a target non-local ID when the media is home-routed. The IBCF provides the IRI-POI functions for such a case.\nWith the above conditions met, the IRI-POI present in the P-CSCF identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nIn the default deployment option, the P-CSCF provides the IRI-POI functions when any of the following conditions are met:\n-\tThe target is inbound roaming (with LBO) IMS user and is not registered for emergency services. If applicable, E-CSCF provides the IRI-POI functions when IMS user is registered for emergency services.\n-\tAn inbound roaming (with LBO) IMS user is in communication with a target non-local ID.\nIn the alternate deployment option, the P-CSCF always provides the IRI-POI functions.\nWith the above conditions met, the IRI-POI present in the P-CSCF identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nIn the default deployment option, the S-CSCF always provides the IRI-POI functions except for the following condition:\n-\tThe target is registered for emergency services and E-CSCF provides the IRI-POI for IMS-based emergency services.\n-\tIMS user is in communication with a target non-local ID. The MGCF or IBCF provide the IRI-POI functions for such a case.\n-\tThe S-CSCF is not serving the target.\nIn the alternate deployment option, the S-CSCF provides the IRI-POI functions when any of the following condition is met:\n-\tIMS user is in communication with a target non-local ID.\n-\tThe S-CSCF is serving the IMS user in communication with the target non-local ID.\nWith the above conditions met, the IRI-POI present in the S-CSCF identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nIn the default deployment option, the S-CSCF always provides the IRI-POI functions except for the following condition:\n-\tThe target is registered for emergency services and E-CSCF provides the IRI-POI for IMS-based emergency services.\n-\tThe S-CSCF is neither serving the target nor the IMS user in communication with a target non-local ID.\nIn the alternate deployment option, the S-CSCF does not provide the IRI-POI functions.\nWhen the above conditions are met, the IRI-POI present in the S-CSCF identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nIn the default deployment option, the E-CSCF provides the IRI-POI functions except for the following condition (see TR 33.928 [121]):\n-\tS-CSCF provides the IRI-POI for emergency services.\nIn the alternate deployment option, the E-CSCF does not provide the IRI-POI functions.\nWhen the above conditions are met, the IRI-POI present in the E-CSCF identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nIn the default deployment option, the IBCF provides the IRI-POI functions when any of the following conditions are met (see TR 33.928 [121]):\n-\tA non-roaming IMS user is in communication with a target non-local ID.\n-\tAn outbound roaming IMS user is in communication with a target non-local ID.\nIn the alternate deployment option, the IBCF shall provide the IRI-POI functions when any of the following conditions are met:\n-\tThe target involved is an outbound roaming (with LBO) IMS user.\n-\tThe IMS session to a target is redirected to a user in the IP domain.\n-\tIMS session to a target is redirected to an outbound roaming (with LBO) IMS user.\n-\tAn inbound roaming (with LBO) IMS user is in communication with a target non-local ID on an IMS session that employs home-routed media.\nWhen the above conditions are met, the IRI-POI present in the IBCF identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nIn the default deployment option, the IBCF does not provide the IRI-POI functions.\nIn the alternate deployment option, the IBCF provides the IRI-POI functions except for the following condition:\n-\tThe target is an inbound roaming (with LBO) IMS user. The P-CSCF provides the IRI-POI functions for such a case.\n-\tThe inbound roaming (with LBO) IMS user is in communication with a non-local target. The P-CSCF provides the IRI-POI functions for such a case.\nWhen the above conditions are met, the IRI-POI present in the IBCF identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nIn the default deployment option, the MGCF provides the IRI-POI functions when any of the following conditions are met:\n-\tA non-roaming IMS user is in communication with a target non-local ID.\n-\tAn outbound roaming IMS user is in communication with a target non-local ID.\nFor session-based IMS communications, in the alternate deployment option, the MGCF shall provide the IRI-POI functions when the following condition is met:\n-\tThe IMS session to a target is redirected to a user in the CS domain.\nWhen the above conditions are met, the IRI-POI present in the MGCF identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nFor session-independent IMS communications, the MGCF does not provide the IRI-POI functions.\nIn both default and alternate deployment options, the AS provides the IRI-POI when the interception of IMS sessions involving special services such as conferencing is required.\nThe IRI-POI present in the AS identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nFor session-independent IMS communications, the AS does not provide the IRI-POI functions.\nFor an intercepted IMS based communication (see clause 7.12.2.8), the IRI-POI present in the IMS Signaling Function shall generate the xIRI IMSMessage from the SIP message used to handle that IMS based communication. All SIP messages use the same xIRI record as shown in table 7.12.4.2-1.\nTable 7.12.4.2-1: Payload for IMSMessage record\n\nTable 7.12.4.2-2: Void\nThe IRI-POI present in the IMS signaling function generating an xIRI containing an IMSMessage record shall set:\n-\tThe Payload Direction field in the PDU header to the direction of the signaling message carried in the IRI payload (see ETSI TS 103 221-2 [8] clause 5.2.6). If the signalling message was sent from the target, the Direction Value \"3\" (sent from the target) shall be used, if the signalling message was sent to the target, the Direction Value \"2\" (sent to the target) shall be used; if the direction could not be determined reliably, the Direction Value \"1\" (not known to the POI) shall be used. If the SIP message is sent from and to the target, the Direction Value \"4\" (more than one direction) shall be used. For the SIP messages generated by the network, the Direction Value \"5\" (not applicable) shall be used.\n-\tThe conditional source IPv4 address or source IPv6 address field in the PDU header to the source IP address of the intercepted SIP message (see ETSI TS 103 221-2 [8] clause 5.3). It shall contain the source address of the packet from the 32-bit \"Source Address\" field in IPv4, as defined in IETF RFC 791 [34], or from the 128-bit \"Source Address\" field in IPv6, as defined in IETF RFC 2460 [27].\n-\tThe conditional destination IPv4 address or destination IPv6 address field in the PDU header to the destination IP address of the intercepted SIP message (see ETSI TS 103 221-2 [8] clause 5.3). It shall contain the destination address of the packet from the 32-bit \"Source Address\" field in IPv4, as defined in IETF RFC 791 [34], or from the 128-bit \"Source Address\" field in IPv6, as defined in IETF RFC 2460 [27].\nThe IRI-POI present in the IMS signaling function shall generate the xIRI StartOfInterceptionForActiveIMSSession when all of the following conditions are met:\n- The IRI-POI receives an LI_X1: ActivateTask from the LIPF.\n- The IRI-POI detects the IMS user identified by one or more of the target identifier (s) included in the ActivateTask is on an active IMS session.\n- The-IRI-POI in the IMS signaling functions meets the criteria mentioned in TS 33.127 [5] for providing the IRI-POI functions.\nThe generation of the xIRI shall be independent of the IMS media associated with the session. If multiple IMS sessions are active at the start of interception, a StartOfInterceptionForActiveIMSSession record shall be generated for each active session.\nThe following table contains parameters, with IRITargetIdentifier, generated by the IRI-POI.\nTable 7.12.4.2-3: Payload for StartOfInterceptionForActiveIMSSession record\n\nThe IRI-POI present in the IMS signaling function that also has the CC-TF (which would have triggered the media interception at the CC-POI) shall generate the xIRI IMSCCUnavailable when the media is not available for interception in the CSP's network.\nAccordingly, the IRI-POI present in the IMS signaling function that has the CC-TF shall generate the xIRI IMSCCUnavailable when the following conditions are met:\n-\tThe target of interception is on an IMS session with established SDP offer and answer.\n-\tThe media does not enter the IMS network of the CSP that has received the warrant. In other words, the CC-TF does not send the LI_T3 ActivateTask to the CC-POI.\n-\tThe CSP is required to send a notification to the LEMF when the media interception is required but not available for the interception.\nNOTE:\tThe details of any interactions required between the IRI-POI and CC-TF present in the same IMS Signaling Function (e.g. IBCF) is outside the scope of the present document.\nThe payload of the IMSCCUnavailable xIRI is as shown in table 7.12.4.2-4.\nTable 7.12.4.2-4: Payload for IMSCCUnavailable record\n\nTable 7.12.4.3.1-1 contains the details for the IMSPayload type.\nTable 7.12.4.3.1-1: Definition of Choices for IMSPayload\n\nThe SessionDirection indicates the direction of the SIP session with regards to the target.\nTable 7.12.4.3.2-1 contains the details for the SessionDirection type.\nTable 7.12.4.3.2-1: Enumeration SessionDirection\n\nThe VoIPRoamingIndication indicates the type of roaming in use when the target is in a roaming state.\nTable 7.12.4.3.3-1 contains the details for the VoIPRoaminIndication type.\nTable 7.12.4.3.3-1: Enumeration VoIPRoamingIndication\n\nTable 7.12.4.3.4-1: Structure of the SIPMessage type\n\nTable 7.12.4.3.5-1: Structure of the SIPAccessNetworkInformation type\n\nTable 7.12.4.3.6-1: Structure of the SIPCellularNetworkInformation type\n\nTable 7.12.4.3.7-1: Structure of the ModifiedSIPMessage type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.12.4.2-1: Payload for IMSMessage record",
                                    "table number": 409,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.4.2-3: Payload for StartOfInterceptionForActiveIMSSession record",
                                    "table number": 410,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.4.2-4: Payload for IMSCCUnavailable record",
                                    "table number": 411,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.4.3.1-1: Definition of Choices for IMSPayload",
                                    "table number": 412,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.4.3.2-1: Enumeration SessionDirection",
                                    "table number": 413,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.4.3.3-1: Enumeration VoIPRoamingIndication",
                                    "table number": 414,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.4.3.4-1: Structure of the SIPMessage type",
                                    "table number": 415,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.4.3.5-1: Structure of the SIPAccessNetworkInformation type",
                                    "table number": 416,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.4.3.6-1: Structure of the SIPCellularNetworkInformation type",
                                    "table number": 417,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.4.3.7-1: Structure of the ModifiedSIPMessage type",
                                    "table number": 418,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.12.5\tTriggering of CC-POI by CC-TF over LI_T3",
                            "text_content": "The CC_TFs present in the NFs provisioned as shown in table 7.12.3.3-1 activate the CC-POIs according to the conditions described in TS 33.127 [5] and illustrated in TR 33.928 [121].\nNOTE 1: \tOne of the obvious conditions not stated in the subsequent clauses is that an NF can provide the CC-TF functions if and only if the SIP signaling messages pass through that NF.\nNOTE 2: \tThe CC-TF functions apply only for session-based IMS communications.\nWhen a condition (e.g. inbound roaming with LBO) under which an NF provides the CC-TF functions is dependent on the handling of SIP REGISTER message, the CC-TFs may have to scan the SIP REGISTER for all IMS users to address the case when that IMS user engages in a communication with a target non-local ID.\nThe P-CSCF provides the CC-TF functions when the CC-POI functions are provided at the IMS-AGW.\nThe P-CSCF always provides the CC-TF functions (based on the call direction, of-course) except for the following cases:\n-\tA non-roaming IMS user in communication with a target non-local ID. IBCF or MGCF provide the CC-TF functions for that case.\n-\tAn outbound roaming (with LBO) IMS user is in communication with a target non-local ID. IBCF or MGCF provide the CC-TF functions for that case.\nWhen an inbound roaming (LBO) IMS user is in communication with a target non-local ID, two deployment options are defined (see TS 33.127 [5]) for providing the CC-TFs functions. The P-CSCF provides the CC-TF functions except for the following case:\n-\tAn inbound roaming (with LBO) IMS user is in communication with a target non-local ID when the media is home-routed. IBCF provides the CC-TF functions for that case.\nWith the above conditions met, the CC-TF present in the P-CSCF identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nThe IBCF provides the CC-TF functions when the CC-POI functions are provided at the TrGW.\nThe IBCF provides the CC-TF functions when any of the following conditions are met (see TR 33.928 [121]):\n-\tA non-roaming IMS user is in communication with a target non-local ID in the IP domain.\n-\tAn outbound roaming IMS user is in communication with a target non-local ID in the IP domain.\n-\tIMS session is to an outbound roaming (with LBO) target.\n-\tAn IMS session to a target is redirected to a user in the IP domain.\n-\tAn IMS session to a target is redirected to an outbound roaming (with LBO) IMS user.\n-\tAn inbound roaming (with LBO) IMS user is in communication with a target non-local ID on an IMS session that employs home-routed media and alternate deployment option is used for media interception.\nWhen the above conditions are met, the CC-TF present in the IBCF identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nThe MGCF provides the CC-TF functions when the CC-POI functions are provided at the IM-MGW.\nThe MGCF provides the CC-TF functions when any of the following conditions are met (see TR 33.928 [121]):\n-\tA non-roaming IMS user is in communication with a target non-local ID in the CS domain.\n-\tAn outbound roaming IMS user is in communication with a target non-local ID in the CS domain.\n-\tAn IMS session to a target is redirected to a user in the CS domain.\nWhen the above conditions are met, the CC-TF present in the MGCF identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nThe AS/MRFC provides the CC-TF functions when the CC-POI functions are provided at the MRFP.\nThe AS/MRFC provides the CC-TF functions when the interception of IMS sessions involving special services such as conferencing, music or tones is required.\nThe CC-TF present in the AS/MRFC identifies that an IMS-based communication is to be intercepted according to clause 7.12.2.8.\nAs described in clause 7.12.5.1, the CC-POI may reside in the IMS-AGW, TrGW, IM-MGW or the MRFP. The trigger to perform the media interception is provided by the CC-TF present in the P-CSCF, IBCF, MGCF, AS/MRFC respectively.\nNOTE 1:\tThe present document assumes that the above NFs that have the CC-TF and the NFs that have the CC-POI interact with each other using the H.248 messages.\nWhen the IRI-POI and the CC-TF are provided by two different NFs, the interception of media is performed at the core-network side of the NF that has the CC-POI. This is to align the media interception with the SDP information reported in the xIRI.\nWhen the IRI-POI and the CC-TF are provided by the same NF, based on the deployment option, the interception of media can be done at the access side or core network side of an IMS-AGW, at the peer network side or the core network side of an TrGW. For the IM-MGW, the media interception is always done on the core network side since the peer network is in CS domain. For the MRFP, all sides are core network and therefore, the media interception is always on the core network side.\nThe possibilities of such media interception points are illustrated in figure 7.12.5.2-1.\nThe figure depicts various media interception point options in the context of CC-POIs (Communication Channel Protection Points). It illustrates the different types of interception points, such as point-to-point, point-to-multipoint, and point-to-multipoint with encryption, and their respective security levels. The figure also includes a diagram of the interception point's physical layout, including the interception point itself, the communication channel, and the encryption system.\nFigure 7.12.5.2-1: Media interception point options in the CC-POIs\nNOTE 2:\tEven when the option of access side or peer network side is chosen, for certain session scenarios (e.g. hold), media interception may have to be moved to the core network side.\nThe time at which trigger is sent to the CC-POI has a relationship to the NF (that has the CC-TF) handling of SIP messages that carry the SDP offer and SDP answer as those SIP messages result in the NF (that has the CC-TF) creating/modifying the media contexts at the NF that handles the media.\nThe procedures used to activate (i.e. trigger) the media interception at the CC-POI present in IMS-AGW, TrGW and IM-MGW are the same. The procedures used to activate (i.e. trigger) the media interception at the MRFP can be different due to the nature of media functions provided by the MRFP can be different (e.g. conferencing, announcements).\nThe ActivateTask message over the LI_T3 interface is sent from CC-TF to CC-POI as a trigger to start the media interception at the CC-POI. The details of the ActivateTask are as shown in table 7.12.5.2.2-1:\nTable 7.12.5.2.2-1: ActivateTask message for triggering the CC-POI over LI_T3\n\nAlong with the IP address and UDP port number, a few additional identifiers are needed for the media interception. These are shown as TargetIdentifierExtension in table 7.12.5.2.2-2 and TaskDetailsExtensions in table 7.12.5.2.2-3.\nTable 7.12.5.2.2-2: Target identifiers and extensions for LI_T3\n\nTable 7.12.5.2.2-3: SDP task details extensions for LI_T3\n\nThe IP address and the UDP port number as target identifiers give the destination address at the UDP layer of the to-be intercepted media. For symmetric media, the same IP address and UDP port number give the source address at the UDP layer of the to-be-intercepted media in the reverse direction.\nThe H248ContextID identifies the identity of the media context created at the IMS Media Function using the H.248 Add Context message.\nThe TriggerScope indicates whether IP address and UDP port number included as the target identifiers in the LI_T3 ActivateTask  are to be used for bidirectional media or unidirectional media. In the latter case, a separate trigger shall be sent to intercept media in the reverse direction. \"Bidirectional\" and \"Unidirectional\" are the values that can be set for the TriggerScope by the CC-TF in the ActivateTask message.\nWhen the TriggerScope is \"Unidirectional\", the IP address and UDP port number identify the destination IP address and the UDP port number of the intercepted IMS media stream. When the TriggerScope is \"Bidirectional\", the IP address and UDP port number identify the destination IP address and UDP port number of the incoming intercepted IMS media and the source IP address and UDP port number of the outgoing IMS media.\nThe PayloadDirectionAssignment field indicates the direction of the media stream destined to the IP address and UDP port number (indicated as target identifiers in the ActivateTask) from the perspective of the target. \"FromTarget\", \"ToTarget\" and \"NotDetermined\" are the values that can be set for this by the CC-TF in the ActivateTask message.\nThe LocalSDP provides the SDP information to be sent in a SIP message by the NF that has the CC-TF. The RemoteSDP provides the SDP information received in a SIP message at the NF that has the CC-TF. In some cases, both LocalSDP and RemoteSDP may be included in the ActivateTask message. The CC-POI is expected to use the LocalSDP to populate the SDP Session Description field of the X3 PDUs for the incoming media streams and to use the the RemoteSDP to populate the SDP Session Description field of the X3 PDUs for the outgoing media streams.\nThe CC-TF shall send a trigger to the CC-POI using the ActivateTask message over the LI_T3 interface for an intercepted IMS session (as determined according to the clause 7.12.2.8) that requires the CC interception when the following occur:\n-\tThe NF that has the CC-TF receives the acknowledgement (i.e. H.248 Reply) to the H.248: Add Context from the NF that has the CC-POI. The H.248: Add Context is sent when the SIP message that contains the SDP offer is handled.\n-\tThe CC-TF receives an ActivateTask from the LIPF over LI_X1 with CC interception required for an IMS session with an already established SDP offer and possibly SDP answer as well. This process is part of a mid-session activation of interception.\nWhen the media streams are asymmetric, the CC-TF shall send a second trigger to the CC-POI using the ActivateTask message over the LI_T3 interface to intercept the media in the reverse direction when the following occur:\n-\tWhen the SDP offer is received from the side where the media interception is done, the NF that has the CC-TF receives the acknowledgement (i.e. H.248 Reply) to the H.248: Add Context from the NF that has the CC-POI. The H.248: Add Context is sent when the SIP message that contains the SDP offer is handled. This happens at the same time the first trigger (LI_T3 ActivateTask) is sent.\n-\tWhen the SDP answer is received from the side where the media interception is done, the NF that has the CC-TF receives the acknowledgement (i.e. H.248 Reply) to the H.248 Mod Context from the NF that has the CC-POI. The H.248: Mod Context is sent when the SIP message that contains the SDP answer is handled.\n-\tThe CC-TF receives an ActivateTask from the LIPF over LI_X1 with CC interception required for an IMS session with an already established SDP offer and possibly SDP answer as well. This process is part of a mid-session activation of interception.\nThe details of ActivateTask sent from the CC-TF to the CC-POI over LI_T3 are shown in table 7.12.5.2.2-1.\nFor the trigger (for the asymmetric media case, it is the first trigger):\n-\tThe CC-TF shall use the IP address and UDP port number present in the local descriptor part of the acknowledgement (i.e. H.248 Reply) to an H.248 Add context message. The same IP address and the UDP port numbers are also present in the SIP messages that carry the SDP offer or SDP answer (depending on the SIP message direction and the session scenario).\nNOTE 1:\tThe SDP offer may be present in a forward SIP message (e.g. SIP INVITE) or in a response SIP message (e.g. SIP 200 OK). In the latter case, the trigger to perform media interception is sent when the response SIP message is handled.\nWhen the CC-TF and IRI-POI are present in different NFs, the IP address and the UDP port number are associated with the core network side of the NF that has the CC-POI.\nWhen the CC-TF and the IRI-POI are in the same NF, as a deployment option, the CC-TF may choose the side for media interception and hence, includes the IP address and the UDP port number that correspond to the side at which the media interception is to be done. The sides thus chosen based on the IP address and UDP port number can be the access side or core network side when the CC-POI is in IMS-AGW, the side can be peer network side or core network side when the CC-POI is in TrGW, and the side is always the core network side when the CC-POI is in the IM-MGW (see figure 7.12.5.2-1). The CC-POI is expected to perform the media interception on the side as determined by that IP address and the UDP port number.\nFor the second trigger that applies to asymmetric media case:\n-\tThe CC-TF shall use the IP address and UDP port number present in the remote descriptor part of the of the H.248 transaction that happens between the NF that has the CC-TF and the NF that has the CC-POI. The same IP address and the UDP port numbers are also present in the SIP messages that carry the SDP offer or SDP answer (depending on the SIP message direction and the session scenario).\nThe remote IP address and the UDP port number are on the same side where the local IP address and UDP port number were provided in the first trigger.\nThe values that the CC-TF sets for the PayloadDirectionAssignment and TriggerScope shall be determined as described in tables 7.12.5.2.2-4 and 7.12.5.2.2-5.\nTable 7.12.5.2.2-4: PayloadDirectionAssignment and TriggerScope values (target identifier from local descriptor)\n\nTable 7.12.5.2.2-5: PayloadDirectionAssignment and TriggerScope values (target identifier from remote descriptor)\n\nNOTE 2:\tThe media interception of target non-local ID is done in the IMS-AGW only when the IMS user is in communication with the target non-local ID is an inbound roamer with LBO with the alternate deployment option (see TS 33.127 [5]).\nNOTE 3:\tWhen media is neither sent to nor received from the target (e.g. call waiting scenario, held session), and when the CC-TF is aware of the scenario, the value of \"NotDetermined\" is used as the PayloadDirectionAssignment value. The CC-TF changes the PayloadDirectionAssignment value using a LI_T3 ModifyTask (see clause 7.12.5.2.3) when the media is cross connected to the target (e.g. held session is retrieved).\nThe table 7.12.5.2.2-6 shows how the CC-POI is expected to set the Payload Direction field in the xCC based on the PayloadDirectionAssignment and TriggerScope values received in the LI_T3 ActivateTask message.\nTable 7.12.5.2.2-6: Expected payload direction value in the xCC\n\nNOTE 4:\tWhen the TriggerScope value is \"Unidirectional\", two LI_T3 triggers are sent to the CC-POI and in this case, the CC-POI is expected to set the Payload Direction field separately according to the PayloadDirectionAssignment received in the corresponding LI_T3 trigger.\nThe following paragraphs describe the algorithm the CC-TF shall use for the inclusion of the LocalSDP and Remote SDP in the LI T3 ActivateTask message.\n-\tWhen the TriggerScope value is \"Bidirectional\":\n-\tWhen the SDP offer is received at the NF that has the CC-TF (on the side where the media interception is done) before the sending of a ActivateTask to the CC-POI, the CC-TF shall use the SDP information received in the SDP offer as RemoteSDP and the SDP information that will be sent later in the SDP answer of a SIP message as LocalSDP.\n-\tWhen the SDP offer is sent by the NF that has the CC-TF (on the side where the media interception is done) after the sending of a ActivateTask to the CC-POI, the CC-TF shall use the SDP information that will be included in the SDP offer of a SIP message as LocalSDP. In this case, the RemoteSDP is sent in the LI_T3 ModifyTask when the SDP answer is received in a SIP message (see clause 7.12.5.2.3).\n-\tWhen the TriggerScope value is \"Unidirectional\":\n-\tWhen the SDP offer is received at the NF that has the CC-TF (on the side where the media interception is done) before the sending of a ActivateTask to the CC-POI, the CC-TF shall use the SDP information that will be sent later in the SDP answer of a SIP message as the LocalSDP in the first LI_T3 trigger. The SDP information received in the SDP offer as the RemoteSDP in the second LI_T3 trigger.\n-\tWhen the SDP offer is sent by the NF that has the CC-TF (on the side where the media interception is done) after the sending of a ActivateTask to the CC-POI, the CC-TF shall use the SDP information that will be included in the SDP offer of a SIP message as LocalSDP in the first trigger.\n-\tWhen the SDP answer is received at the NF that has the CC-TF (on the side where the media interception is done), the CC-TF shall use the SDP information received in the SDP answer of SIP message as RemoteSDP of the second LI_T3 trigger.\nFor the mid-session interception case, the CC-TF shall include both the LocalSDP and RemoteSDP in the trigger (LI_T3 ActivateTask) when the TriggerScope is \"Bidirectional\".\nFor mid-session interception case when the TriggerScopeValue is \"Unidirectional\", the CC-TF shall include the LocalSDP in the first trigger (LI_T3 ActivateTask) and the RemoteSDP in the second trigger (LI_T3 ActivateTask).\nThe CC-POI is expected to populate the SDP Session Description field of X3 PDU with the SDP information received in the LocalSDP, for the xCC that represent the incoming media streams destined to the IP address and UDP port number specified as the target identifiers.\nThe CC-POI is expected to populate the SDP Session Description field of X3 PDU with the SDP information received in the RemoteSDP, for the xCC that represent the outgoing media streams. In the case where TriggerScope value is \"Bidirectional\", the outgoing media streams will be from the IP address and UDP port number specified as the target identifiers. In the case where TriggerScope value is \"Unidirectional\", the outgoing media streams will be destined to the IP address and UDP port number specified as the target identifiers.\nThe CC-TF present in the AS/MRFC shall send a trigger to the CC-POI present in the MRFP using the ActivateTask message over the LI_T3 interface for an intercepted IMS session (as determined according to the clause 7.12.2.8) that requires the CC interception when the following occurs:\n-\tThe AS/MRFC that has the CC-TF receives the acknowledgement (i.e. H.248 Reply) to the H248: Add Context from the MRFP.\nWhen the media streams are asymmetric, the CC-TF present in the AS/MRFC shall send a second trigger to the CC-POI present in the MRFP using the ActivateTask message over the LI_T3 interface to intercept the media in the reverse direction when the following occur:\n-\tWhen the SDP offer is received, the AS/MRFC receives the acknowledgement (i.e. H.248 Reply) to the H.248: Add Context from the MRFP. The H.248: Add Context is sent when the SIP message that contains the SDP offer is handled. This happens at the same time the first trigger (LI_T3 ActivateTask) is sent.\n-\tWhen the SDP answer is received, the AS/MRFC receives the acknowledgement (i.e. H.248 Reply) to the H.248 Mod Context from the MRFP. The H.248: Mod Context is sent when the SIP message that contains the SDP answer is handled.\nFor a conferencing scenario, the AS/MRFC is expected to send the H.248: Add Context to the MRFP when it handles a SIP message that includes a Conference Factory URI in the Request URI field. Only one LI_T3 ActivateTask is required to intercept the media for a conference.\nAdditionally, in support of the mid-session interception, the CC-TF present in the AS/MRFC shall send a trigger to the CC-POI present in the MRFP using the ActivateTask message over the LI_T3 interface when the following occur:\n-\tThe CC-TF present in the AS/MRFC receives an ActivateTask from the LIPF over LI_X1 with CC interception required, when an incoming IMS session to the target identifier included in the LI_X1 ActivateTask was redirected to voice mail server with an already established SDP offer and possibly SDP answer as well.\n-\tThe CC-TF present in the AS/MRFC receives an ActivateTask from the LIPF over LI_X1 with CC interception required, when announcement or tones are being applied to the caller of an incoming IMS session to the target identifier included in the LI_X1 ActivateTask message.\n-\tThe CC-TF present in the AS/MRFC receives an ActivateTask from the LIPF over LI_X1 with CC interception required, when the user represented through the target identifier included in the LI_X1 Activate Task is one of the participants in an established conference session.\n-\tThe CC-TF present in the AS/MRFC receives an ActivateTask from the LIPF over LI_X1 with CC interception required, when the Conference URI associated with an established conference session is included as a target identifier in the LI_X1 Activate Task message.\nWhen the media streams are asymmetric, the CC-TF present in the AS/MRFC shall send a second trigger to the CC-POI present in the MRFP using the ActivateTask message over the LI_T3 interface to intercept the media in the reverse direction to any of the events except the last two in the above list occurs.\nThe details of LI_T3 ActivateTask are shown in table 7.12.5.2.2-1.\nFor the trigger (for the asymmetric media case, it is the first trigger):\n-\tThe CC-TF shall use the IP address and UDP port number present in the local descriptor part of the acknowledgement (i.e. H.248 Reply) to an H.248 Add context message. The same IP address and the UDP port numbers are also present in the SIP messages that carry the SDP offer or SDP answer (depending on whether the AS/MRFC receives or sends the SDP offer).\nFor the second trigger that applies to asymmetric media case:\n-\tThe CC-TF shall use the IP address and UDP port number present in the remote descriptor part of the of the H.248 transacation that happens between AS/MRFC and the MRFP.The same IP address and the UDP port numbers are also present in the SIP messages that carry the SDP offer or SDP answer (depending on whether the AS/MRFC receives or sends the SDP offer).\nThe values that the CC-TF sets for the PayloadDirectionAssignment and TriggerScope shall be determined as described in tables 7.12.5.2.2-7 and 7.12.5.2.2-8.\nTable 7.12.5.2.2-7: PayloadDirectionAssignment and TriggerScope values (target identifier from local descriptor)\n\nTable 7.12.5.2.2-8: PayloadDirectionAssignment and TriggerScope values (target identifier from remote descriptor)\n\nTables 7.12.5.2.2-5 and 7.12.5.2.2-6 (clause 7.12.5.2.2) shows how the CC-POI is expected to set the Payload Direction field in the xCC based on the PayloadDirectionAssignment and TriggerScope values received in the LI_T3 ActivateTask message.\nFor an intercepted conference session, the CC-POI shall perform the media interception in a mixed mode including the media from all conference participants. The concept of Payload Direction, therefore, does not apply to the corresponding xCC.\nThe CC-TF present in the in the AS/MRFC shall follow the algorithm described in clause 7.12.5.2.2.2 to populate the LocalSDP and RemoteSDP fields of LI_T3 ActivateTask.\nThis is a special case where the media interception is done at both sides of an IMS Media Function. In this case, the CC-POI would intercept the outgoing media streams on both sides of IMS Media Function as shown in figure 7.12.5.2-2 below.\nThe figure depicts a media interception scenario on both sides of the IMS Media Function, illustrating the various types of media interception techniques used in the network.\nFigure 7.12.5.2.2-2: Media interception on both sides of the IMS Media Function\nThe CC-POI would capture the media streams destined to the remote IP address and UDP port number for the generation of xCC both sides. For this case, even if the media streams are symmetric, the TriggerScope shall be set to \"Unidirectional\". Accordingly, the CC-TF shall send the two triggers to CC-POI using the ActivateTask message over the LI_T3 interface when the following occur:\n-\tWhen the SDP offer is received from the side where the media interception is done, the NF that has the CC-TF receives the acknowledgement (i.e. H.248 Reply) to the H.248: Add Context from the NF that has the CC-POI.\n-\tWhen the SDP answer is received from the side where the media interceptions is done, the NF that has the CC-TF receives the acknowledgement (i.e. H.248 Reply) to the H.248: Mod Context from the NF that has the CC-POI.\n-\tThe CC-TF receives an ActivateTask from the LIPF over LI_X1 with CC interception required for an IMS session with an already established SDP offer and possibly SDP answer as well. This process is part of a mid-session activation of interception.\nThe details of ActivateTask sent from the CC-TF to the CC-POI over LI_T3 are shown in table 7.12.5.2.2-1.\nThe CC-TF shall use the IP address and UDP port number present in the remote descriptor part of the of the H.248 transaction that happens between the NF that has the CC-TF and the NF that has the CC-POI. The same IP address and the UDP port numbers are also present in the SIP messages that carry the SDP offer or SDP answer (depending on the SIP message direction and the session scenario).\nThe CC-TF shall set the PayloadDirectionAssignment value described in table 7.12.5.2.2-9:\nTable 7.12.5.2.2-9: PayloadDirectionAssignment values\n\nNOTE:\tWhen the media is neither sent to nor received from the target (e.g. call waiting scenario, held session), and when the CC-TF is aware of the scenario, the value of \"NotDetermined\" is used as the PayloadDirectionAssignment value. The CC-TF changes the PayloadDirectionAssignment value using a LI_T3 ModifyTask (see clause 7.12.5.2.3) when the media is cross connected to the target (e.g. held session is retrieved).\nFor this case, the CC-TF shall include the SDP information in the RemoteSDP of TaskDetailsExtensions of LI_T3 ActivateTask for both triggers as described below:\n-\tWhen the SDP offer is received at the NF that has the CC-TF (on the side where the media interception is done), the CC-TF shall use the SDP information received in the SDP offer of SIP message as RemoteSDP of the first LI_T3 trigger.\n-\t\tWhen the SDP answer is received at the NF that has the CC-TF (on the side where the media interception is done), the CC-TF shall use the SDP information received in the SDP answer of SIP message as RemoteSDP of the second LI_T3 trigger.\nThe CC-POI is expected to populate the SDP Session Description field of X3 PDU with the SDP information received in the RemoteSDP, for the xCC that represent the outgoing media streams on both sides. The outgoing media streams will be destined to the IP address and UDP port number specified as the target identifiers.\nThe ModifyTask message (s) that a CC-TF may send to a CC-POI shall include the XID of the Task (s) created by the ActivateTask message(s) (see table 7.12.5.2.2-1). The details of the ModifyTask are as shown in the table 7.12.5.2.2-10:\nTable 7.12.5.2.2-10: ModifyTask message to update the previous trigger the CC-POI over LI_T3\n\nThe LI_T3 ModifyTask shall also use the same correlation ID, the same target identifiers as used in the LI_T3 ActivateTask.\nThe examples of few scenarios that may necessitate the sending of a ModifyTask over LI_T3 to the CC-POI are the following:\n-\tWhen the TriggerScope value used in the LI_T3 ActivateTask is \"Bidirectional\", the SDP answer is received in a SIP message on the side where the media interception is done. The SDP information received in the SDP answer of SIP message shall be included as RemoteSDP in the LI_T3 ModifyTask. The LI_T3 ModifyTask shall also include the LocalSDP which was previously sent to the CC-POI in the LI_T3 ActivateTask message.\nNOTE:\tThe same SDP information is sent to the CC-POI when the TriggerScope value is \"Unidirectional\" as RemoteSDP in a second LI_T3 ActivateTask trigger (see clause 7.12.5.2.2.2).\n-\tThe SDP is changed through a new SDP offer and answer during the session establishment phase.\n-\tThe cases such as IP address or UDP port numbers are being changed on an established IMS session (using H.248 Modify Context (which may also include a Add Request to an existing context)).\n-\tWhen a session is placed on hold, if the media interception sides have to be switched (e.g. from access side of IMS-AGW to core network side of IMS-AGW).\n-\tWhen a session is placed on hold or retrieved from hold, if the PayloadDirectionAssignment value for the Target Identifier (associated with a previously sent LI_T3 Activate Task or LI_T3 Modify Task) are to be changed.\n-\tWhen the media interception has to begin only when the media is cross-connected within the NF that has the CC-POI (e.g. call waiting).\nUsually, the LI_T3 ModifyTask is sent when the NF that has the CC-TF sends a H.248: Modify Context (or a H.248 Add Request to an existing context) message to the NF that has the CC-POI, if certain aspects of media interception require to be changed.\nAs an alternate implementation, the CC-TF could use a LI_T3 DeactivateTask (clause 7.12.5.2.4) and LI_T3 ActivateTask (clause 7.12.5.2.1) to handle the held/retrieval scenario. Similarly, as an alternate implementation, the CC-TF could delay the LI_T3 ActivateTask till the media is cut-through within the NF that has the CC-POI in the call waiting scenario.\nIf two LI_T3 ActivateTask messages were used (asymmetric media stream case), then two LI-T3 ModifyTask messages may be required (depending on the scenario).\nThe DeactivateTask message(s) that the CC-TF sends to the CC-POI shall include the XID of the Task created by the associated ActivateTask message (see table 7.12.5.2.2-1).\nAn example that may necessitate the sending of a DeactivateTask over LI_T3 to the CC-POI is:\n-\tMedia interception of an IMS session ends.\nUsually, the LI_T3 DeactivateTask is sent when the NF that has the CC-TF sends a H.248: Subtract Context to the NF that has the CC-POI which in turn normally happens when the SIP BYE is handled. In addition, the CC-TF could send a LI_T3 DeactivateTask when a session is placed on hold and delivery of CC is not required.\nIf two LI_T3 ActivateTask messages were used (asymmetric media stream case), then two LI-T3 DeactivateTask messages are required.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.12.5.2.2-1: ActivateTask message for triggering the CC-POI over LI_T3",
                                    "table number": 419,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.5.2.2-2: Target identifiers and extensions for LI_T3",
                                    "table number": 420,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.5.2.2-3: SDP task details extensions for LI_T3",
                                    "table number": 421,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.5.2.2-4: PayloadDirectionAssignment and TriggerScope values (target identifier from local descriptor)",
                                    "table number": 422,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.5.2.2-5: PayloadDirectionAssignment and TriggerScope values (target identifier from remote descriptor)",
                                    "table number": 423,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.5.2.2-6: Expected payload direction value in the xCC",
                                    "table number": 424,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.5.2.2-7: PayloadDirectionAssignment and TriggerScope values (target identifier from local descriptor)",
                                    "table number": 425,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.5.2.2-8: PayloadDirectionAssignment and TriggerScope values (target identifier from remote descriptor)",
                                    "table number": 426,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.5.2.2-9: PayloadDirectionAssignment values",
                                    "table number": 427,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.12.5.2.2-10: ModifyTask message to update the previous trigger the CC-POI over LI_T3",
                                    "table number": 428,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.12.6\tGeneration of xCC over LI_X3",
                            "text_content": "The CC-POI shall generate the xCC for the IMS media based on the LI_T3 trigger received from the CC-TF. The CC-POI shall then deliver the xCC to the MDF3 (destination end point indicated in the LI_T3 trigger).\nAs described in clause 7.12.5.1, the CC-POI may reside in the IMS-AGW, TrGW, IM-MGW, the MRFP or the LMISF.\nThe CC-POI shall use the H248ContextID received in the LI_T3 ActivateTask trigger to match the Context ID seen in the H.248 transactions with the NF that has the CC-TF.\nIn addition, the CC-POI shall use the IP address and UDP port number received as the target identifiers in the LI_T3 trigger along with the TriggerScope also received in the LI_T3 trigger to identify the media packets to be intercepted for the generation of xCC using the following algorithm:\n-\tWhen the TriggerScope value received in the LI_T3 trigger is \"Unidirectional\", the IP address and UDP port number received in the LI_T3 ActivateTask as target identifiers shall match the destination IP address and UDP port number of the media packets.\n-\tWhen the TriggerScope value received in the LI_T3 trigger is \"Bidirectional\", the IP address and UDP port number received in the LI_T3 ActivateTask as target identifiers shall match the destination IP address and UDP port number of the incoming media packets and shall match the source IP address and UDP port number of outgoing media packets in the reverse direction.\nThe CC-POI shall expect to receive two LI_T3 ActivateTask triggers when the value of TriggerScope is \"Unidirectional\". The two triggers provide the information necessary to identify the media in two directions of the media flow. The H248ContextID in the two triggers are the same. The CorrelationID in the two triggers are the same.\nThe media packets destined to the local IP address and UDP port number are referred to as incoming media packets. The media packets destined to the remote IP address and UDP port number are referred to as outgoing media packets.\nThe CC-POI shall set the payload format to indicate the appropriate payload type (5 for IPv4 packet, 6 for IPv6 packet) as described in ETSI TS 103 221-2 [8] (clauses 5.4 and 5.4.13).\nThe CC-POI shall set the payload direction to indicate the direction of the media packets included in the xCC delivered to the MDF3 as described in ETSI TS 103 221-2 [8] clause 5.2.6 and the following paragraph.\nThe PayloadDirectionAssignment field received in the LI_T3 ActivateTask message instructs the CC-POI how to populate the Payload Direction for each xCC PDU that it generates. If an intercepted media stream (i.e. IP packet) is destined for the IP address and port given in the LI_T3 ActivateTask message, the CC-POI shall set the Payload Direction of the xCC packet to the value that has the same meaning as the value given in the PayloadDirectionAssignment field. For an intercepted IP packet travelling in the other direction, the CC POI should use the opposite direction value. Specific instructions on how to set the xCC Payload Direction field for given combinations of IP packet direction and TriggerScope value are given in table 7.12.6.4-1 below.\n7.12.6.4-1: Payload direction value in the xCC\n\nNOTE:\tWhen the TriggerScope value is \"Unidirectional\", two LI_T3 triggers are received from the CC-TF and in this case, the CC-POI sets the Payload Direction field separately according to the PayloadDirectionAssignment received in the corresponding LI_T3 trigger.\nIn some session scenarios, the media packets destined to the IP address and UDP port number specified as target identifiers in the LI_T3 Activate Task may not be delivered to the intercept target (e.g. call waiting scenario, hold scenario). When the CC-TF is aware of this, it would have used the value \"NotDetermined\" as the PayloadDirectionAssignment field.\nWhen the xCC is delivered in a combined form (e.g. conference), independent of the PayloadDirectionAssignment value received in the LI_T3 Activate Task, the CC-POI shall use the Payload Direction value 4: sent to and received from the target.\nThe CC-POI shall generate the SDP Session Description field (as specified in ETSI TS 103 221-2 [8] clause 5.3.23) of xCC from the the LocalSDP and RemoteSDP received in the LI_T3 trigger from the CC-TF as described below.\nWhen the TriggerScope value is \"Bidirectional\", the CC-POI may receive the Local SDP and RemoteSDP in one LI_T3 trigger or in two separate LI_T3 triggers. When the TriggerScope value is \"Unidirectional\", the Local SDP and RemoteSDP are received in two separate triggers.\nNOTE 1:\tWhen the TriggerScope value in the LI_T3 trigger is \"Unidirectional\", the CC-TF includes LocalSDP in the LI_T3 trigger that has the local IP address and UDP port number as target identifiers and RemoteSDP in the LI_T3 trigger that has the remote IP address and the UDP port number as the target identifiers.\nNOTE 2:\tWhen the media interception is done at two sides of the IMS Media Function, the CC-POI receives RemoteSDP in both LI_T3 triggers with the TriggerScope value set to \"Unidirectional\".\nThe CC-POI shall include the LocalSDP in the SDP Session Description field of the xCC generated from the incoming media packets. The CC-POI shall include the RemoteSDP in the Session Description field of xCC from the outgoing media media packets. Clause 7.12.6.2 describes how the CC-POI identifies the incoming and outgoing media packets.\nNOTE 3:\tThe LocalSDP provides the SDP information (e.g. codec information) expected by the IMS Media Function that has the CC-POI. The media packets sent by the remote end of the media flow are based on this SDP information. Therefore, the LocalSDP is associated to the incoming media packets.\nNOTE 4:\tThe RemoteSDP address provides the SDP information (e.g. codec information) expected by the remote end of the media flow. The media packets sent to that remote end of the media flow are based on this SDP information. Therefore, the RemoteSDP is associated to the outgoing media packets.\nThe SDP Session Description field shall be included in the xCC each time a new LocalSDP or RemoteSDP is received in the LI_T3 trigger from the CC-TF.\nThe CC-POI may use the Additional XID Related Information attribute to facilitate efficient delivery of xCC, as specified in ETSI TS 103 221-2 [8] clause 5.3.22.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "7.12.6.4-1: Payload direction value in the xCC",
                                    "table number": 429,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.12.7\tGeneration of IRI over LI_HI2",
                            "text_content": "When an xIRI is received over LI_X2 from the IRI-POI, the MDF2 shall send the IRI message over LI_HI2 according to clause 5.5.2 of the present document without undue delay.\nThe IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF2 (e.g. additional location information).\nThe timeStamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time present in the timestamp field of the xIRI.\nThe threeGPP33128DefinedIRI field (see ETSI TS 102 232-7 [10] clause 15) shall be populated with the BER-encoded IRIPayload.\nIRI messages associated with the same IMS session shall have the same CIN (see ETSI TS 102 232-1 [9] clause 5.2.4).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.12.7.1-1.\nTable 7.12.7.1-1: IRI type for IRI messages\n\nThe MDF2 may have to deliver IRI messages to more than one LEMFs when more than one instances of ListOfMediationDetails are associated with a task (i.e. XID) provisioned at the MDF2.\nThe MDF2 shall populate the LIID field in the IRI messages delivered over the LI_HI2 accordingly.\nWhen a new warrant is to be activated on a target identity (i.e. the associated IMS user is already the target of interception due to another warrant), the LIPF may use the same XID for the new warrant (e.g. when there is no need to receive two separate copies of xIRI messages over LI_X2). In this case, the LIPF may activate the new warrant only at the MDFs using an LI_X1 ModifyTask message with a new instance of ListOfMediationDetails.\nThe MDF2 that receives a LI_X1 ModifyTask with a new instance of ListOfMediationDetails shall be able to generate and deliver the IRI message containing the StartOfInterceptionForActiveIMSSession record to the LEMF as represented in the new instance of ListOfMediationDetails without receiving a corresponding xIRI from the IRI-POI. The MDF2 shall generate and deliver such an IRI message for each of the established IMS session legs to the LEMF represented within the ListOfMediationDetails.\nThe timeStamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the present time known to the MDF2.\nThe payload of the StartOfInterceptionForActiveIMSSession record is specified in table 7.12.4.2-3 (see also clause 7.12.7.1).\nThe MDF2 shall include the location information in the IRI messages sent over the LI_HI2 according to the service scoping received within the ListOfMediationDetails of the LI_X1 ActivateTask. For example, if service scoping does not allow the reporting of location to an LEMF, then the MDF2 shall not copy the location information if received in an xIRI to the IRI message sent to that LEMF.\nThe MDF2 shall also remove the location information (e.g. PANI header) from the SIP message contents included as a part of the IRI message, when the service scoping does not allow the reporting of location to the LEMF.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.12.7.1-1: IRI type for IRI messages",
                                    "table number": 430,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.12.8\tGeneration of CC over LI_HI3",
                            "text_content": "When xCC is received over LI_X3 from a CC-POI, the MDF3 shall deliver the CC over LI_HI3 to the LEMF according to the clause 5.5.3 of the present document without undue delay.\nThe MDF3 shall populate the threeGPP33128DefinedCC field with a CCPayload structure containing IMSCCPDU. The IMSCCPDUPayload shall contain the IPv4 or IPv6 packet received over LI_X3.\nThe MDF3 shall populate the timeStamp field of the ETSI TS 102 232-1 [9] PSHeader structure of CC with the xCC timeStamp and the Payload Direction of the CCPayload structure to reflect the value received on xCC. The LIID and CID fields shall correctly reflect the target identity and communication session to which the CC belongs.\nThe MDF3 may have to deliver the received xCC to more than one LEMFs when more than one instances of ListOfMediationDetails are associated with a task (i.e. XID) provisioned at the MDF3. The MDF3 shall populate the LIID field in the CC delivered over the LI_HI3 accordingly.\nIn addition to the XID present in the XID field of xCC, the MDF3 shall deliver a copy of the CC to the LEMFs represented in one or more instances of ListOfMediationDetails associated with the XID values present in the Additional XID Related Information received in the xCC.\nThe MDF3 shall deliver the SDP session description received in the xCC over LI_X3 using the SDPInfo element of the IMSCCPDU to the LEMF over LI_HI3. This shall be done each time the SDP Session Description is present on the xCC.\nWhen a new warrant is to be activated on a target identity (i.e. the associated IMS user is already the target of interception due to another warrant), the LIPF may use the same XID for the new warrant (e.g. when there is no need to receive two separate copies of xCC over LI_X3). In this case, the LIPF may activate the new warrant only at the MDFs using an LI_X1 ModifyTask message with a new instance of ListOfMediationDetails.\nThe MDF3 that receives a LI_X1 ModifyTask with a new instance of ListOfMediationDetails, shall deliver the CC to the LEMF represented in this new instance of ListOfMediationDetails upon the reception of next xCC from the CC-POI.\n7.12.8.6\tMedia handling at the MDF and LEMF\nThe MDF and LEMF perform protocol level correlation between intercepted signalling and media. LI_T3 ensures that the SDP in the intercepted SIP signalling or in LI_X3 matches the IP/UDP destination IP-address and port for every intercepted RTP stream.\nIn a scenario where NAT is used, the protocol level correlation may not be possible. In all other scenarios the implementation shall ensure that it is.\nTo support the interception scenario where transmission of CC occurs before the IRI, the LEMF may use SDP Session Description field in the CC to process the media.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.12.9\tRemoval of unauthorised information from IMS record payloads",
                            "text_content": "If the Content-Type of the SIP message is \"multipart\" as defined in RFC 2046 [120] clause 2.4, each part of the SIP message shall be modified as required.\nDepending on the SIP message being reported and the implementation, location information may be present in the SIP Headers, the body of the SIP message, or both. When location is not authorised, all location information shall be removed from the encapsulated SIP message prior to its delivery over LI_HI2. As such, when location is not authorised, the MDF2 and, optionally, the IRI-POIs in the IMS shall be provisioned with the payload modifications detailed in the subclauses below.\nAdditionally, if the location present in the SIP message is the location of the non-target party, the location shall be removed.\nIf an implementation has location information in other portions of the payload, the appropriate modifications shall be made to the encapsulated payload in addition to those specified below prior to the delivery of the message over LI_HI2.\nEach character of each access-info parameter field of the P-Access-Network-Info header shall be over-written with zeros (see TS 24.229 [74] clause 7.2A.4). If multiple P-Access-Network-Info headers are present in the message, each shall be modified.\nEach character of the access-info portion of the Cellular-Network-Info header shall be over-written with zeros. If multiple Cellular-Network-Info headers are present in the message, each shall be modified.\nIf there is a Geolocation header present in the message and the location object is included in the message, the portion of the body of the SIP message that contains the location object shall be modified as described in clause 7.12.9.2.5.\nIf the Content-Type of any body part of the SIP message is \"application/pidf+xml\", and if the presence information contains a geopriv element, the character data of each element within each location-info element shall be overwritten with the zero character such that the length of the element does not change.\nIn some cases portions of a SIP message body may contain communications content. Unless otherwise specified, all communications content shall be removed from the encapsulated SIP message prior to its delivery over LI_HI2. As such, the MDF2 and, optionally, the IRI-POIs in the IMS shall be provisioned with the payload modifications detailed in the subclauses below.\nIf an implementation has location information in other portions of the payload, the appropriate modifications shall be made to the encapsulated payload in addition to those specified below prior to the delivery of the message over LI_HI2.\nIf the Content-Type of any body part of the SIP message is \"application/vnd.3gpp.sms\", the TP-User-Data (TS 23.040 [18] clause 9.2.3.4) of the SMS TPDU shall be modified as described in clause 7.4.5.2.\nIf the Content-Type of the SIP message is \"text\" or any of the subtypes of \"text\", the contents of the body shall be overwritten with spaces such that the length of the body remains unchanged.\nIf the delivery of the Subject header of a SIP message is unauthorised, each character of the field-value of the Subject header shall be replaced with a space.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.13\tRCS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.13.1\tProvisioning over LI_X1",
                            "text_content": "If the warrant is for IRI only, the IRI-POI and IRI-TF in the RCS Servers and the IRI-POI in the HTTP Content Server, File Transfer Localization Function and the S-CSCF shall be provisioned in accordance with clause 7.13.1.2.\nIf the warrant is for IRI and CC, then the IRI-POI, IRI-TF, CC-POI and CC-TF in the RCS Servers defined in TS 33.127 [5] clause 7.13.2.1 (see RCS definition in GSMA RCC.07 [78]) and the IRI-POI and the CC-POI in the HTTP Content Server, File Transfer Localization Function and S-CSCF shall be provisioned in accordance with clause 7.13.1.2.\nIn both cases, the MDF2 shall be provisioned in accordance with clause 7.13.1.3, and the MDF3 shall be provisioned in accordance with clause 7.13.1.4.\nThe POIs in the HTTP Content Server and the File Transfer Localization Function may also be triggered by the TFs in the RCS Server as described in clause 7.13.2.\nThe IRI-POI, CC-POI, IRI-TF and CC-TF present in the RCS Server, the IRI-POI and CC-POI in the HTTP Content Server, and File Transfer Localization Function and the IRI-POI in the S-CSCF, are provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nThe POIs and TFs in the RCS Server and the IRI-POIs in the S-CSCF shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used).\n-\tIMPU.\n-\tIMPI.\n-\tIMEI.\n-\tPEIIMEI.\nThe POIs in the HTTP Content Server and File Transfer Localization Function shall support the following additional target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used).\n-\tSIPURI.\n-\tTELURI.\n-\tGPSIMSISDN.\n-\tGPSINAI.\n-\tIMSI.\n-\tSUPIIMSI.\n-\tSUPINAI.\n-\tEmail Address.\nTable 7.13.1.2-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POI, CC-POI, IRI-TF and CC-TF in the RCS Servers and the IRI-POI and CC-POI in the HTTP Content Server and File Transfer Localization Function and the IRI-POI in S-CSCF.\nTable 7.13.1.2-1: ActivateTask message for the IRI-POI, CC-POI, IRI-TF and CC-TF in the RCS Servers and the IRI-POI and CC-POI in the HTTP Content Server and S-CSCF\n\nThe MDF2 listed as the delivery endpoint for xIRI generated by the IRI-POI in the RCS Servers, the IRI-POI in the HTTP Content Server, the IRI-POI in the File Transfer Localization Function, or the IRI-POI in the S-CSCF shall be provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2. Table 7.13.1.3-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF2.\nThe MDF2 shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):\n-\tIMPU.\n-\tIMPI.\n-\tIMEI.\n-\tGPSIMSISDN.\n-\tGPSINAI.\n-\tIMSI.\n-\tSUPIIMSI.\n-\tSUPINAI.\n-\tEmail Address.\nTable 7.13.1.3-1: ActivateTask message for MDF2\n\nTable 7.13.1.3-2: Mediation Details for MDF2\n\nThe MDF3 listed as the delivery endpoint for the xCC generated by the CC-POI in the RCS Servers, the CC-POI in the HTTP Content Servers and the CC-POI in the File Transfer Localization Function shall be provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2. Table 7.13.1.4-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF3.\nThe MDF3 shall support the following target identifier formats in the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):\n-\tIMPU.\n-\tIMPI.\n-\tIMEI.\n-\tGPSIMSISDN.\n-\tGPSINAI.\n-\tIMSI.\n-\tSUPIIMSI.\n-\tSUPINAI.\n-\tEmailAddress.\nTable 7.13.1.4-1: ActivateTask message for MDF3\n\nTable 7.13.1.4-2: Mediation Details for MDF3\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.13.1.2-1: ActivateTask message for the IRI-POI, CC-POI, IRI-TF and CC-TF in the RCS Servers and the IRI-POI and CC-POI in the HTTP Content Server and S-CSCF",
                                    "table number": 431,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.1.3-1: ActivateTask message for MDF2",
                                    "table number": 432,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.1.3-2: Mediation Details for MDF2",
                                    "table number": 433,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.1.4-1: ActivateTask message for MDF3",
                                    "table number": 434,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.1.4-2: Mediation Details for MDF3",
                                    "table number": 435,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.13.2\tTriggering of the IRI-POI and CC-POI in the HTTP Content Server",
                            "text_content": "In order to allow the IRI-POI in the HTTP content server to detect all events related to files uploaded or downloaded by a target, the IRI-TF in the RCS Server sends a trigger to the IRI-POI present in the HTTP Content Server with the necessary information over the LI_T2 interface.\nWhen the IRI-TF in the RCS Server detects that a file is being uploaded or downloaded by a target UE it shall send an activation message to the IRI-POI in the HTTP Content Server over the LI_T2 interface. The activation message shall contain the correlation identifiers that the IRI-POI in the HTTP Content Server shall use with the xIRI. This can be achieved by sending an ActivateTask message as defined in ETSI TS 103 221-1 [7] clause 6.2.1 with the following details.\nTable 7.13.2.1-1: ActivateTask message from the IRI-TF in the RCS Server for the IRI-POI in the HTTP Content Server\n\nTable 7.13.2.1-2: Target Identifier Types for LI_T2\n\nTo support the use-cases where the IRI-POI in the HTTP Content Server does not get the identity of the user involved in the file-transfer (and therefore, the CC-POI in the HTTP Content Server cannot perform the intereption based on the target identity provisioned by the LIPF), the CC-TF present in the RCS Server sends a trigger to the CC-POI present in the HTTP Content Server. When the CC-TF in the RCS Server detects that a file is being uploaded or downloaded by a target UE, it shall send an activation message to the CC-POI in the HTTP Content Server over the LI_T3 interface. The activation message shall contain the correlation identifiers that the CC-POI in the HTTP Content Server shall use with the xCC. This can be achieved by sending an ActivateTask message as defined in ETSI TS 103 221-1 [7] clause 6.2.1 with the following details.\nTable 7.13.2.2-1: ActivateTask message from the CC-TF in the RCS Server for the CC-POI in the HTTP Content Server\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.13.2.1-1: ActivateTask message from the IRI-TF in the RCS Server for the IRI-POI in the HTTP Content Server",
                                    "table number": 436,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.2.1-2: Target Identifier Types for LI_T2",
                                    "table number": 437,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.2.2-1: ActivateTask message from the CC-TF in the RCS Server for the CC-POI in the HTTP Content Server",
                                    "table number": 438,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.13.3\tGeneration of xIRI at IRI-POI in the RCS Server over LI_X2",
                            "text_content": "The IRI-POI present in the RCS Servers shall send xIRI over LI_X2 for the events listed in 3GPP TS 33.127 [5] clause 7.13.4, the details of which are described in the following clauses.\nIf the RCS implementation uses protocols other than SIP and MSRP, alternative triggers may be used such that the IRI-POI in the RCS Server generates appropriate xIRIs for the events listed in 3GPP TS 33.127 [5] clause 7.13.4.\nTable 7.13.3.1.2.1-1: Simple Types for LI reporting of RCS\n\nTable 7.13.3.1.2.2-1: Choices for RCSIdentity parameter\n\nTable 7.13.3.1.2.3-1: Payload for RCSDestinations parameter\n\nTable 7.13.3.1.2.4-1: Payload for RCSDestination parameter\n\nThe xIRI containing an RCSRegistration record shall be generated when the IRI-POI in the S-CSCF or in an RCS Server detects that an RCS target matching one of the RCS identifiers, provided via LI_X1 has registered, reregistered or deregistered for RCS services. Accordingly, the IRI-POI in the RCS Server generates the xIRI when the following event is detected:\n-\tWhen the IRI-POI is located in the S-CSCF:\n-\tIf the S-CSCF uses third-party registrations to notify the RCS Server when a UE registers, when the S-CSCF receives a 200 OK from the RCS Server in response to a third-party SIP REGISTER request registering, reregistering or deregistering a target with the RCS Server.\n-\tIf the S-CSCF is the NF responsible for handling RCS Registrations:\n-\tWhen the S-CSCF sends a 200 OK to a target in response to a SIP REGISTER request that includes any of the service feature tags listed in GSMA RCC.07 [78] clause 2.4.3, clause 2.4.4 or clause 2.4.4.1 table 3.\n-\tWhen the S-CSCF sends a 200 OK to a target in response to a SIP REGISTER request for deregistration when the service features supported by the target include any of the service features listed in GSMA RCC.07 [78] clause 2.4.3, clause 2.4.4 or clause 2.4.4.1 table 3.\n-\tWhen the IRI-POI is located in the RCS Server:\n-\tWhen the RCS Server sends a 200 OK to a target in response to a SIP REGISTER request that includes any of the service feature tags listed in GSMA RCC.07 [78] clause 2.4.3, clause 2.4.4 or clause 2.4.4.1 table 3.\n-\tWhen the RCS Server sends a 200 OK to a target in response to a SIP REGISTER request for deregistration when the service features supported by the target include any of the service features listed in GSMA RCC.07 [78] clause 2.4.3, clause 2.4.4 or clause 2.4.4.1 table 3.\n-\tWhen the RCS server sends a 200 OK to the S-CSCF in response to a SIP NOTIFY request for a target with an Event header field with a value set to \"reg\" as specified in TS 24.229 [74] clauses 5.1.1.3 and 5.1.1.7.\nTable 7.13.3.2.1-1: Payload for RCSRegistration record\n\nTable 7.13.3.2.2.1-1: Enumeration for RCSRegistrationType parameter\n\nThe IRI-POI present in the RCS Server shall generate an xIRI containing an RCSMessage record when the IRI-POI present in the RCS Server detects that an RCS target has sent or received an RCS message. In this specification, an RCS message refers to any message sent or received in the context of pager mode standalone messaging, large message mode messaging, 1-to-1 chat or group chat. This xIRI is also generated when the target sends or receives a delivery notification or display notification.\nAccordingly, the IRI-POI in the RCS Server shall generate the RCSMessage xIRI when it detects the following events:\n-\tThe RCS Server receives a SIP MESSAGE from the target or destined to the target, determined by the direction attribute present in the CPM Header, and:\n-\tThe \"Contact\" or \"Accept-Contact\" header includes a service feature tag among the feature tags listed in GSMA RCC.07 [78] clause 2.4.4.1 table 3.\n-\tThe SIP \"Content-Type\" header is \"message/cpim\".\n-\tThe RCS Server receives an MSRP packet from the target or destined to the target and:\n-\tThe content of the MSRP packet is a CPIM (Common Presence and Instant Messaging) object (see definition in IETF RFC 3862 [80]).\nTable 7.13.3.3.1-1: Payload for RCSMessage record\n\nTable 7.13.3.3.2.1-1: Enumeration for RCSMessageType parameter\n\nTable 7.13.3.3.2.2-1: Choices for RCSPayload parameter\n\nTable 7.13.3.3.2.3-1: Choices for EncapsulatedRCSPayload parameter\n\nTable 7.13.3.3.2.4-1: Structure of the ModifiedRCSPayload type\n\nThe IRI-POI present in the RCS Server shall generate xIRIs to report the establishment, modification and release of RCS Sessions. There are multiple types of RCS Sessions that shall be reported:\n-\tStandalone SIP Sessions:\n-\tLarge Message Mode CPM Standalone Messages (see clause 7.13.3.4.2).\n-\tCPM Sessions which can be broken down into:\n-\t1-to-1 Chat sessions (see clause 7.13.3.4.3).\n-\tGroup Chat sessions.\nWhen reporting sessions established to transfer a Large Message Mode RCS Standalone Message, the rCSSessionType parameter shall be set to \"LargeMessageStandalone\".\nWhen reporting a CPM 1-to-1 Session, the rCSSessionType parameter shall be set to \"1to1Chat\".\nThe IRI-POI in the RCS Server shall generate an RCSSessionEstablishmentAttempt record when the IRI-POI in the RCS Server detects any of the following:\n-\tA SIP Session has been requested to transfer a Large Message Mode CPM Standalone message to or from a target (see clause 7.13.3.4.2.2).\n-\tA CPM 1-to-1 Chat Session has been requested for the target's communications (see clause 7.13.3.4.2.3).\nTable 7.13.3.4.2-1: Payload for RCSSessionEstablishmentAttempt record\n\nThe IRI-POI in the RCS Server shall generate the RCSSessionEstablishmentAttempt xIRI when it detects the following events:\n-\tThe RCS Server receives a SIP INVITE sent to or from the target with a service feature tag among the feature tags listed in OMA-TS-CPM_Conv_Function [109] Table 7 indicating the Large Message Mode CPM Standalone Message or the Deferred CPM Message features for which a SIP session was not already established.\nThe IRI-POI in the RCS Server shall generate the RCSSessionEstablishmentAttempt xIRI when it detects the following events:\n-\tThe RCS Server receives a SIP INVITE sent to or from the target with a service feature tag among the feature tags listed in OMA-TS-CPM_Conv_Function [109] Table 7 indicating the CPM Session feature for which there is not an existing CPM Session.\nThe IRI-POI in the RCS Server shall generate an RCSSessionModification record when the IRI-POI in the RCS Server detects any of the following:\n-\tA request is sent to request the next leg of a SIP Session or a response is received establishing a SIP Session for the transfer of a Large Message Mode CPM Standalone message or a CPM 1-to-1 Chat Session.\n-\tA previously established SIP session for the transfer of a Large Message Mode CPM Standalone message to or from a target has been modified (see clause 7.13.3.4.3.2).\n-\tA CPM 1-to-1 Chat Session established for the target's communications has been modified (see clause 7.13.3.4.3.3).\nTable 7.13.3.4.3-1: Payload for RCSSessionModification record\n\nThe IRI-POI in the RCS Server shall generate the RCSSessionModification xIRI when it detects the following events:\n-\tThe RCS Server sends a SIP INVITE to or from a target with a service feature tag among the feature tags listed in OMA-TS-CPM_Conv_Function [109] Table 7 indicating the Large Message Mode CPM Standalone Message or the Deferred CPM Message features.\n-\tThe RCS Server sends or receives SIP response within a SIP dialog where the original SIP INVITE had any service feature tag among the feature tags listed in OMA-TS-CPM_Conv_Function [109] Table 7 indicating the Large Message Mode CPM Standalone Message or the Deferred CPM Message features and at least one of the legs of the session known by the RCS Server remain.\nThe IRI-POI in the RCS Server shall generate the RCSSessionModification xIRI when it detects the following events:\n-\tThe RCS Server sends a SIP INVITE to or from a target with a service feature tag among the feature tags listed in OMA-TS-CPM_Conv_Function [109] Table 7 indicating the CPM Session feature.\n-\tThe RCS Server sends or receives SIP response or SIP BYE within a SIP dialog where the original SIP INVITE had any service feature tag among the feature tags listed in OMA-TS-CPM_Conv_Function [109] Table 7 indicating the CPM Session feature.\nThe IRI-POI in the RCS Server shall generate an RCSSessionRelease record when the IRI-POI in the RCS Server detects any of the following:\n-\tA SIP Session for the transfer of a Large Message Mode CPM Standalone message to or from a target has been released (see clause 7.13.3.4.4.2).\n-\tA CPM 1-to-1 Chat Session established for the target's communications has been released (see clause 7.13.3.4.4.3).\nTable 7.13.3.4.4-1: Payload for RCSSessionRelease record\n\nThe IRI-POI in the RCS Server shall generate the RCSSessionRelease xIRI when it detects the following events:\n-\tThe RCS Server returns a SIP 200 OK in response to a SIP BYE sent to or from the target for a SIP session established to transfer a Large Message Mode CPM Standalone Message.\nThe IRI-POI in the RCS Server shall generate the RCSSessionRelease xIRI when it detects the following events:\n-\tThe RCS Server returns a SIP 200 OK in response to a SIP BYE sent to or from the target for the last active leg of a SIP session established for a CPM Session.\nThe RCSSessionType shall be set to indicate the type of RCS Session being reported.\nTable 7.13.3.4.5.1-1: Enumeration for RCSSessionType parameter\n\nThe RCSSessionEndpoints shall be set to indicate whether the RCS Session is currently established between the server and the remote endpoint, between the server and the local client or from the remote endpoint to the local client.\nTable 7.13.3.4.5.2-1: Enumeration for RCSSessionEndpoints parameter\n\nTable 7.13.3.4.5.3-1: Payload for RCSSIPSessionMessage parameter\n\nThe RCSSessionLeg shall be set to indicate whether the SIP Session Exchange is between the server and a remote endpoint or between the server and the local client.\nTable 7.13.3.4.5.4-1: Enumeration for RCSSessionLeg parameter\n\nTable 7.13.3.4.5.5-1: Payload for RCSSIPSessionInfo parameter\n\nThe RCSSessionResult shall be set to indicate whether the addition, removal or modification of the leg has been requested or completed.\nTable 7.13.3.4.5.4-1: Enumeration for RCSSessionResult parameter\n\nThe IRI-POI present in the RCS server shall generate an xIRI containing an RCSCapabilityDiscovery when the IRI-POI present in the RCS server detects that an RCS target has received RCS service capabilities for his contact(s) or has sent capabilities to a contact.\nAccordingly, the IRI-POI in the RCS server generates the xIRI when any of the following events is detected:\n-\tThe RCS server receives a SIP OPTIONS request sent by a target which contains the capabilities of the target in the Contact header.\n-\tThe RCS server returns a SIP response with the response code is 200, 480, 408, 404 or 604 for a SIP OPTIONS request sent by the target.\n-\tThe RCS server receives a SIP OPTIONS request for the target which contains the capabilities of the target’s contact in the Contact header.\n-\tThe RCS server returns a SIP response for a SIP OPTIONS request received from a target’s contact.\n-\tThe RCS server sends a SIP NOTIFY request to the target with the Event header set to \"presence.winfo\". The SIP NOTIFY request contains the RCS state and RCS capabilities of a target’s contact.\n-\tThe RCS server receives a SIP SUBSCRIBE request from a target’s contact with the Event header set to \"presence.winfo\".\n-\tThe RCS server receives a SIP PUBLISH request from the target to initially announce, update and remove RCS capabilities.\nTable 7.13.3.5.1-1: Payload for RCSCapabilityDiscovery record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in the RCS server, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the RCS server event was observed (i.e. the timestamp field of the xIRI).\nTables 7.13.4-1 shows the IRI type (see ETSI TS 102 232-1 [9] clause 5.2.10) to be used for each record type.\nTable 7.13.4-1: IRI type for messages\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.13.3.1.2.1-1: Simple Types for LI reporting of RCS",
                                    "table number": 439,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.1.2.2-1: Choices for RCSIdentity parameter",
                                    "table number": 440,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.1.2.3-1: Payload for RCSDestinations parameter",
                                    "table number": 441,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.1.2.4-1: Payload for RCSDestination parameter",
                                    "table number": 442,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.2.1-1: Payload for RCSRegistration record",
                                    "table number": 443,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.2.2.1-1: Enumeration for RCSRegistrationType parameter",
                                    "table number": 444,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.3.1-1: Payload for RCSMessage record",
                                    "table number": 445,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.3.2.1-1: Enumeration for RCSMessageType parameter",
                                    "table number": 446,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.3.2.2-1: Choices for RCSPayload parameter",
                                    "table number": 447,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.3.2.3-1: Choices for EncapsulatedRCSPayload parameter",
                                    "table number": 448,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.3.2.4-1: Structure of the ModifiedRCSPayload type",
                                    "table number": 449,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.4.2-1: Payload for RCSSessionEstablishmentAttempt record",
                                    "table number": 450,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.4.3-1: Payload for RCSSessionModification record",
                                    "table number": 451,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.4.4-1: Payload for RCSSessionRelease record",
                                    "table number": 452,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.4.5.1-1: Enumeration for RCSSessionType parameter",
                                    "table number": 453,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.4.5.2-1: Enumeration for RCSSessionEndpoints parameter",
                                    "table number": 454,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.4.5.3-1: Payload for RCSSIPSessionMessage parameter",
                                    "table number": 455,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.4.5.4-1: Enumeration for RCSSessionLeg parameter",
                                    "table number": 456,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.4.5.5-1: Payload for RCSSIPSessionInfo parameter",
                                    "table number": 457,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.4.5.4-1: Enumeration for RCSSessionResult parameter",
                                    "table number": 458,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.3.5.1-1: Payload for RCSCapabilityDiscovery record",
                                    "table number": 459,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.13.4-1: IRI type for messages",
                                    "table number": 460,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.13.5\tRedaction of unauthorised information from encapsulated RCS payloads",
                            "text_content": "RCS consists of multiple layers of protocols, each of which may include information that, depending on the warrant, is not authorized for delivery. If the RCS implementation uses protocols other than SIP and MSRP, the modifications specified below shall be adapted as required to redact the unauthorised information and the modifications made shall be described within the IRI delivered to the LEA using the structure described in Annex M clause 2.2.\nAll of the requirements for the redaction of unauthorised information from IMS record payloads (see clause 7.12.9) shall also apply to encapsulated RCS payloads.\nDepending on the RCS event being reported and the implementation, location information may be present in the headers of one or more protocol layers, the body of one or more protocol layers, or both.\nIn all cases, if content is authorised, location information present in the content portion of a user generated payload shall not be redacted.\nWhen location is not authorised, all location information shall be redacted from the encapsulated RCS payload prior to its delivery over LI_HI2. As such, when location is not authorised, the MDF2 and, optionally, the IRI-POIs in the RCS Server, the supporting IMS elements, and any RCS file transfer elements shall be provisioned with the payload modifications detailed in the subclauses below.\nAdditionally, if the location present in the RCS payload is the location of the non-target party, and this information is not authorised, the location shall be redacted.\nIf an implementation has location information in other portions of the payload, when the location is included the appropriate modifications shall be made to the encapsulated payload in addition to those specified below prior to the delivery of the message over LI_HI2.\nIf the geopriv element of presence information is considered to be location, the Content-Type of any body part at any layer of the RCS message is \"application/pidf+xml\", and if the presence information contains a geopriv element, the character data of each element within each location-info element shall be overwritten with the zero character such that the length of the element does not change.\nIn some cases, the information that would normally be present in the P-Access-Network-Info or Cellular-Network-Info headers of a SIP message is sent as implementation specific headers within the CPIM headers. In this case, these headers shall be redacted as described in clause 7.12.9.2 when the delivery of P-Access-Network-Info or Cellular-Network-Info is not authorised.\nIn some cases portions of an encapsulated RCS payload may contain communications content. Unless otherwise specified, all communications content shall be redacted from the encapsulated payload prior to its delivery over LI_HI2. As such, the MDF2 and, optionally, the IRI-POIs in the RCS Server, the supporting IMS elements, and any RCS file transfer elements shall be provisioned with the payload modifications detailed in the subclauses below.\nIf an implementation has communications content in other portions of the payload, the appropriate modifications shall be made to the encapsulated payload in addition to those specified below prior to the delivery of the message over LI_HI2.\nIf the Content-Type of any body part at any layer of the RCS message is \"text\" or any of the subtypes of \"text\", the contents of that body part shall be overwritten with the space character in the original encoding such that the length of the body remains unchanged.\nIf the delivery of the content of the Subject header is unauthorised, each character of the field-value of the Subject header of any body part of any layer of the RCS message shall be replaced with a space.\nIf the delivery of Geolocation PUSH messages is unauthorised, if the Content-Type of any body part at any layer of the RCS message is \"application/vnd.gsma.rcs-ft-http+xml\":\n-\tthe value of the label attribute of the data element of the rcspushlocation element shall be overwritten with the \"space\" character such that the length of the attribute does not change.\n-\tthe value of the id attribute of the data element of the rcspushlocation element shall be overwritten with the \"space\" character such that the length of the attribute does not change.\n-\tthe character data of each element within each location-info element shall be overwritten with the zero character such that the length of the element does not change.\nIf the delivery of the URL of a file being transferred is not authorised, if the Content-Type of any body part at any layer of the RCS message is \"application/vnd.gsma.rcs-ft-http+xml\":\n-\tthe value of any url attribute of the data element of the file-info element shall be overwritten with the \"space\" character such that the length of the attribute does not change.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.14\tLI at EES",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.14.1\tProvisioning over LI_X1",
                            "text_content": "The IRI-POI present in the EES is provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nThe POI in the EES shall support the identifier types given in table 7.14.1-1.\nTable 7.14.1-1: TargetIdentifier Types for Edge Computing\n\nTable 7.14.1-2 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POI in the EES.\nIf the IRI-POI in the EES receives an ActivateTask message and the ListOfServiceTypes parameter contains a ServiceType that is not supported, the IRI-POI in the EES shall reject the task with an appropriate error as described in ETSI TS 103 221-1 [7] clause 6.2.1.2.\nTable 7.14.1-2: ActivateTask message for the IRI-POI in the EES\nThe MDF2 listed as the delivery endpoint over LI_X2 for xIRI generated by the EES shall be provisioned over LI_X1 by the LIPF.\nThe target identities listed in clause 7.14.1.1 shall apply for the provisioning of MDF2.\nTable 7.14.1-3 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF2.\nTable 7.14.1-3 ActivateTask message for MDF2\n\nTable 7.14.1-3: Mediation Details for MDF2\n\nWhen an additional warrant is activated on a target UE and the LIPF uses the same XID for the additional warrant, the MDF2 shall be able to generate and deliver IRI message for each additional warrant without receiving a corresponding xIRI.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.14.1-1: TargetIdentifier Types for Edge Computing",
                                    "table number": 461,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.1-2: ActivateTask message for the IRI-POI in the EES",
                                    "table number": 462,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.1-3 ActivateTask message for MDF2",
                                    "table number": 463,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.1-3: Mediation Details for MDF2",
                                    "table number": 464,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.14.2\tGeneration of xIRI at IRI-POI in EES over LI_X2",
                            "text_content": "The IRI-POI present in the EES shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.14.4, the details of which are described in the following clauses.\nNOTE:\tIf GPSI is the target, then xIRIs shall be generated only if the GPSI is available.\nThe IRI-POI in the EES shall generate an xIRI containing an EESEECRegistration record when the IRI-POI present in the EES detects that an EEC has registered, updated its registration or deregistered. The IRI-POI present in the EES shall generate the xIRI for the following events:\n-\tEES returns Eees_EECRegistration_Request response towards the EEC confirming the registration of the EEC for the target UE to the EES (as defined in TS 24.558 [93] clause 5.2.2.2).\n-\tEES returns Eees_EECRegistration_Update response towards the EEC confirming the update of the registration information of the EEC for the target UE at the EES (as defined in TS 24.558 [93] clause 5.2.2.3).\n-\tEES returns Eees_EECRegistration_Deregister response towards the EEC confirming the deregistration of the EEC for the target UE from a given EES (as defined in TS 24.558 [93] clause 5.2.2.4).\nTable 7.14.2-1: EESEECRegistration record\n\nTable 7.14.2-2: Details of aCProfile parameter\n\nTable 7.14.2-3: Details of eASInfo parameter\n\nTable 7.14.2-4: Details of expectedSvcKPIs and minimumReqSvcKPIs parameters\n\nThe IRI-POI in the EES shall generate an xIRI containing an EESEASDiscovery record when the IRI-POI present in the EES detects that an EEC has requested a one-time EAS discovery information. The IRI-POI present in the EES shall generate the xIRI for the following events:\n-\tEES returns Eees_EASDiscovery_Request response to the EEC containing a one-time EAS discovery information (as defined in TS 24.558 [93] clause 5.3.2.2).\nTable 7.14.2-5: EESEASDiscovery record\n\nTable 7.14.2-6: Details of eASDiscoveryFilter parameterendpoint\n\nTable 7.14.2-7: Details of eASCharacteristics parameter\n\nTable 7.14.2-8: Details of discoveredEAS parameter\n\nTable 7.14.2-9: Details of eASProfile parameter\n\nThe IRI-POI in the EES shall generate an xIRI containing an EESEASDiscoverySubscription record when the IRI-POI present in the EES detects that an EEC has requested to subscribe, update subscription and unsubscribe to EAS discovery information reporting. The IRI-POI present in the EES shall generate the xIRI for the following events:\n-\tEES returns Eees_EASDiscovery_Subscribe response to the EEC confirming its subscription to EAS discovery information reporting (as defined in TS 24.558 [93] clause 5.3.2.3).\n-\tEES returns Eees_EASDiscovery_UpdateSubscription response to the EEC confirming the update of its subscription at the EES for EAS discovery information reporting (as defined in TS 24.558 [93] clause 5.3.2.5).\n-\tEES returns Eees_EASDiscovery_Unsubscribe response to the EEC confirming the deletion of an existing subscription at the EES to EAS discovery information reporting (as defined in TS 24.558 [93] clause 5.3.2.6)\nTable 7.14.2-10: EESEASDiscoverySubscription record\n\nTable 7.14.2-11: Details of eASDynamicInfoFilter parameter\n\nThe IRI-POI in the EES shall generate an xIRI containing an EESEASDiscoveryNotification record when the IRI-POI present in the EES detects that the EES has notified a previously subscribed EEC on EAS discovery information. The IRI-POI present in the EES shall generate the xIRI for the following events:\n-\tEES receives an Eees_EASDiscovery_Notify response from an EEC confirming that the subscribed EEC has received EAS discovey information (as defined in TS 24.558 [93] clause 5.3.2.4).\nNOTE:\tBecause it is HTTP-based transaction the notification request is always supposed to be received by the EEC which needs to answer with the reponse.\nTable 7.14.2-12: EESEASDiscoveryNotification record\n\nThe IRI-POI in the EES shall generate an xIRI containing an EESAppContextRelocation record when the IRI-POI present in the EES detects that an EEC has requested ACR (Application Context Relocation) determination.or ACR initiation. The IRI-POI present in the EES shall generate the xIRI for the following events:\n-\tEES returns Eees_AppContextRelocation_Determine response to the EEC confirming that EEC has carried out ACR determination (as defined in TS 24.558 [93] clause 5.5.2.2). EEC requests that the EES evaluates if ACR is needed and subsequently initiate the ACR procedure if required.\n-\tEES returns Eees_AppContextRelocation_Initiate response to the EEC confirming that EEC has carried out ACR initiation (as defined in TS 24.558 [93] clause 5.5.2.3). EEC requests initiation of an ACR procedure.\nTable 7.14.2-13: EESAppContextRelocation record\n\nTable 7.14.2-14: Details of aCRDetermineReq parameter\n\nTable 7.14.2-15: Details of aCRInitiateReq parameter\n\nThe IRI-POI in the EES shall generate an xIRI containing an EESACRSubscription record when the IRI-POI present in the EES detects that an EEC has requested to subscribe, update subscription and unsubscribe to ACR events. The IRI-POI present in the EES shall generate the xIRI for the following events:\n-\tEES returns Eees_ACREvents_Subscribe response to the EEC confirming its subscription for reporting of ACR information notification (as defined in TS 24.558 [93] clause 5.4.2.2).\n-\tEES returns Eees_ACREvents_UpdateSubscription response to the EEC confirming the update of its subscription for reporting of ACR information notification (as defined in TS 24.558 [93] clause 5.4.2.4).\n-\tEES returns Eees_ACREvents_Unsubscribe response to the EEC confirming the deletion of an existing subscription at the EES to ACR events (as defined in TS 24.558 [93] clause 5.4.2.5)\nTable 7.14.2-16: EESACRSubscription record\n\nThe IRI-POI in the EES shall generate an xIRI containing an EESACRNotification record when the IRI-POI present in the EES detects that the EES has notify a previously subscribed EEC on EAS discovery information. The IRI-POI present in the EES shall generate the xIRI for the following events:\n-\tEES receives an Eees_ACREvents_Notify response from an EEC confirming that the subscribed EEC has received a notification of the ACR information events from EES (as defined in TS 24.558 [93] clause 5.4.2.2).\nTable 7.14.2-17: EESACRNotification record\n\nThe IRI-POI in the EES shall generate an xIRI containing an EESEECContextRelocation record when the IRI-POI present in the EES detects that the EES has sent or received the EEC context relocation information. The IRI-POI present in the EES shall generate the xIRI for the following events according to its new serving EE (referred to as target EES in TS 24.558 [93] or current serving EES (referred to as source EES in TS 24.558 [93]) role:\n-\tTarget EES (T-EES) receives an Eees_EECContextRelocation_Pull response from a Source EES (S-EES) upon request from the T-EES to S-EES (as defined in TS 29.558 [94] clause 5.10.2.2).\n-\tT-EES sends an Eees_EECContextRelocation_Push response to a S-EES upon request from the S-EES to T-EES (as defined in TS 29.558 [94] clause 5.10.2.3).\n-\tS-EES sends an Eees_EECContextRelocation_Pull response to a T-EES.\n-\tS-EES receives an Eees_EECContextRelocation_Push response from a T-EES.\nNOTE : The term target EES is used in TS 29.558[94] referring the new serving EES and the term serving EES is referring to the old serving EES.\nTable 7.14.2-17: EESEECContextRelocation record\n\nThe IRI-POI in the AES shall generate an xIRI containing an EESStartOfInterceptionWithRegisteredEEC record when the IRI-POI present in the EES detects that interception is activated on a UE which EEC has already registered with an EES.\nTable 7.14.2-18: EESStartOfInterceptionWithRegisteredEEC record\n\nWhen an xIRI is received over LI_X2 from the IRI-POI in the EES, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the EES event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter (see ETSI TS 102 232-1 [9] clause 5.2.10) shall be included and coded according to table 7.14.2-19.\nTable 7.14.2-19: IRI type for IRI messages\n\nThe threeGPP33128DefinedIRI field (see ETSI TS 102 232-7 [10] clause 15) shall be populated with the BER-encoded IRIPayload.\nWhen an additional warrant is activated on a target UE and the LIPF uses the same XID for the additional warrant, the MDF2 shall be able to generate and deliver the IRI message containing the EESStartOfInterceptionWithRegisteredEEC record to the LEMF associated with the additional warrant without receiving a corresponding xIRI. The payload of the EESStartOfInterceptionWithRegisteredEEC record is specified in table 7.14.2-18. The MDF2 shall generate and deliver the IRI message containing the EESStartOfInterceptionWithRegistered record for each of the registrations to the LEMF associated with the new warrant.\nMDF2 delivers the IRI to the LEMF with GPSI as the target identity if and only if GPSI is present in the xIRI.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.14.2-1: EESEECRegistration record",
                                    "table number": 465,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-2: Details of aCProfile parameter",
                                    "table number": 466,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-3: Details of eASInfo parameter",
                                    "table number": 467,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-4: Details of expectedSvcKPIs and minimumReqSvcKPIs parameters",
                                    "table number": 468,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-5: EESEASDiscovery record",
                                    "table number": 469,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-6: Details of eASDiscoveryFilter parameterendpoint",
                                    "table number": 470,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-7: Details of eASCharacteristics parameter",
                                    "table number": 471,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-8: Details of discoveredEAS parameter",
                                    "table number": 472,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-9: Details of eASProfile parameter",
                                    "table number": 473,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-10: EESEASDiscoverySubscription record",
                                    "table number": 474,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-11: Details of eASDynamicInfoFilter parameter",
                                    "table number": 475,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-12: EESEASDiscoveryNotification record",
                                    "table number": 476,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-13: EESAppContextRelocation record",
                                    "table number": 477,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-14: Details of aCRDetermineReq parameter",
                                    "table number": 478,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-15: Details of aCRInitiateReq parameter",
                                    "table number": 479,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-16: EESACRSubscription record",
                                    "table number": 480,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-17: EESACRNotification record",
                                    "table number": 481,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-17: EESEECContextRelocation record",
                                    "table number": 482,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-18: EESStartOfInterceptionWithRegisteredEEC record",
                                    "table number": 483,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.14.2-19: IRI type for IRI messages",
                                    "table number": 484,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "7.15\tLI at 5GMS AF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.15.1\tProvisioning over LI_X1",
                            "text_content": "The IRI-POI present in the 5GMS AF is provisioned over LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2.\nThe POI in the 5GMS AF shall support the target identifier types given in table 7.15.1.1-1.\nTable 7.15.1.1-1: TargetIdentifier types for 5G media streaming\n\nTable 7.15.1.1-2 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the IRI-POI in the 5GMS AF.\nIf the IRI-POI in the 5GMS AF receives an ActivateTask message and the ListOfServiceTypes parameter contains a ServiceType that is not supported, the IRI-POI in the 5GMS AF shall reject the task with an appropriate error as described in ETSI TS 103 221-1 [7] clause 6.2.1.2.\nTable 7.15.1.1-2: ActivateTask message for the IRI-POI in the 5GMS AF\n\nThe MDF2 listed as the delivery endpoint over LI_X2 for xIRI generated by the 5GMS AF shall be provisioned over LI_X1 by the LIPF.\nThe target identities listed in clause 7.15.1.1 shall apply for the provisioning of MDF2.\nTable 7.15.1.2-1 shows the minimum details of the LI_X1 ActivateTask message used for provisioning the MDF2.\nTable 7.15.1.2-1 ActivateTask message for MDF2\n\nTable 7.15.1.2-2: Mediation Details for MDF2\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.15.1.1-1: TargetIdentifier types for 5G media streaming",
                                    "table number": 485,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.15.1.1-2: ActivateTask message for the IRI-POI in the 5GMS AF",
                                    "table number": 486,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.15.1.2-1 ActivateTask message for MDF2",
                                    "table number": 487,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.15.1.2-2: Mediation Details for MDF2",
                                    "table number": 488,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.15.2\tGeneration of xIRI over LI_X2",
                            "text_content": "The IRI-POI present in the 5GMS AF shall send the xIRIs over LI_X2 for each of the events listed in TS 33.127 [5] clause 7.15.4, the details of which are described in the following clauses.\nThe IRI-POI in the 5GMS AF shall generate an xIRI containing an 5GMSAFServiceAccessInformation record when the IRI-POI present in the 5GMS AF detects that an 5GMS AF has sent the service access information to the Media Session Handler in the target UE. The IRI-POI present in the 5GMS AF shall generate the xIRI for the following event (as specified in TS 26.512 [98], clause 11.2):\n-\t5GMS AF returns retrieveServiceAccessInformation response (i.e. 200 OK) in response to retrieveServiceAccessInformation request (i.e. GET) received from the Media Session Handler in the target UE which requests Service Access Information.\nTable 7.15.2.2-1: Payload for FiveGMSAFServiceAccessInformation\n\nThe IRI-POI in the 5GMS AF shall generate an xIRI containing an 5GMSAFConsumptionReporting record when the IRI-POI present in the 5GMS AF detects that an 5GMS AF has received a consumption report from the target UE. The IRI-POI present in the 5GMS AF shall generate the xIRI for the following event (as specified in TS 26.512 [98], clause 11.3):\n-\t5GMS AF returns submitConsumptionReport Response (i.e. 204 No Content) in response to a submitConsumptionReport Request (i.e. POST) from the Media Session Handler in the target UE which submits a consumption report.\nTable 7.15.2.3-1: Payload for FiveGMSAFConsumptionReporting\n\nThe IRI-POI in the 5GMS AF shall generate an xIRI containing an 5GMSAFDynamicPolicyInvocation record when the IRI-POI present in the 5GMS AF detects that an 5GMS AF has received a dynamic policy from the target UE. The IRI-POI present in the 5GMS AF shall generate the xIRI for the following events (as specified in TS 26.512 [98], clause 11.5):\n-\t5GMS AF returns a createDynamicPolicy Response (i.e. 201 Created) in response to a createDynamicPolicy Request (i.e. POST) from the Media Session Handler in the target UE which creates a dynamic policy resource.\n-\t5GMS AF returns a retrieveDynamicPolicy Response (i.e. 20O OK) in response to a retrieveDynamicPolicy Request (i.e. GET) from the Media Session Handler in the target UE which retrieves the dynamic policy resource.\n-\t5GMS AF returns an updateDynamicPolicy Response (i.e. 20O OK or 204 No Content) in response to an updateDynamicPolicy Request (i.e. PUT) from the Media Session Handler in the target UE which replaces the dynamic policy resource.\n-\t5GMS AF returns a patchDynamicPolicy Response (i.e. 20O OK or 204 No Content) in response to a patchDynamicPolicy Request (i.e. PATCH) from the Media Session Handler in the target UE which modifies the dynamic policy resource.\n-\t5GMS AF returns a destroyDynamicPolicy Response (i.e. 204 No Content) in response to a destroyDynamicPolicy Request (i.e. DELETE) from the Media Session Handler of the target UE which deletes the dynamic policy resource.\nTable 7.15.2.4-1: Payload for FiveGMSAFDynamicPolicyInvocation\n\nThe IRI-POI in the 5GMS AF shall generate an xIRI containing an 5GMSAFMetricsReporting record when the IRI-POI present in the 5GMS AF detects that an 5GMS AF has received a metrics report from the target UE. The IRI-POI present in the 5GMS AF shall generate the xIRI for the following event (as specified in TS 26.512 [98], clause 11.4):\n-\t5GMS AF returns submitMetricsReport Response (i.e. 204 No Content) in response to a submitMetricsReport Request (i.e. POST) from the Media Session Handler in the target UE which submits a metrics report.\nTable 7.15.2.5-1: Payload for FiveGMSAFMetricsReporting\n\nThe IRI-POI in the 5GMS AF shall generate an xIRI containing an FiveGMSAFNetworkAssistance record when the IRI-POI present in the 5GMS AF detects that an 5GMS AF has received a network assistance from the target UE. The IRI-POI present in the 5GMS AF shall generate the xIRI for the following events (as specified in TS 26.512 [98], clause 11.6):\n-\t5GMS AF returns a createNetworkAssistanceSession Response (i.e. 201 Created) in response to a createNetworkAssistanceSession Request (i.e. POST) from the Media Session Handler in the target UE which creates a network assistance session resource.\n-\t5GMS AF returns a retrieveNetworkAssistanceSession Response (i.e. 200 OK) in response to a retrieveNetworkAssistanceSession Request (i.e. GET) from the Media Session Handler in the target UE which retrieves an existing network assistance session resource.\n-\t5GMS AF returns an updateNetworkAssistanceSession Response (i.e. 200 OK or 204 No Content) in response to an updateNetworkAssistanceSession Request (i.e. PUT) from the Media Session Handler in the target UE which replaces an existing network assistance session resource.\n-\t5GMS AF returns a patchNetworkAssistanceSession Response (i.e. 200 OK or 204 No Content) in response to a patchNetworkAssistanceSession Request (i.e. PATCH) from the Media Session Handler in the target UE which modifies the network assistance session resource.\n-\t5GMS AF returns a destroyNetworkAssistanceSession Response (i.e. 204 No Content) in response to a destroyNetworkAssistanceSession Request (i.e. DELETE) from the Media Session Handler in the target UE which deletes the network assistance session resource.\n-\t5GMS AF returns a requestBitRateRecommendation Response (i.e. 200 OK) in response to a requestBitRateRecommendation Request (i.e. GET) from the Media Session Handler in the target UE which requests a bit rate recommendation for the next recommendation window.\n-\t5GMS AF returns a requestDeliveryBoost Response (i.e. 200 OK) in response to a requestDeliveryBoost Request (i.e. POST) from the Media Session Handler in the target UE which requests a delivery boost.\nTable 7.15.2.6-1: Payload for FiveGMSAFNetworkAssistance\n\nThe IRI-POI in the 5GMS AF shall generate an xIRI containing a FiveGMSAFUnsuccessfulProcedure record when the IRI-POI present in the 5GMS AF detects an unsuccessful procedure or error condition for a target UE. Accordingly, the IRI-POI in the 5GMS AF generates the xIRI when any of the following events are detected:\n-\t5GMS AF returns retrieveServiceAccessInformation response (i.e. 404 Not Found) in response to retrieveServiceAccessInformation request (i.e. GET) from the target UE.\n-\t5GMS AF returns submitConsumptionReport Response (i.e. 400 Bad Request or 415 Unsupported Media Type) in response to a submitConsumptionReport Request (i.e. POST) from the target UE.\n-\t5GMS AF returns submitMetricsReport Response (i.e. 400 Bad Request or 415 Unsupported Media Type) in response to a submitMetricsReport Request (i.e. POST) from the target UE.\n-\t5GMS AF returns a createDynamicPolicy Response (i.e. 400 Bad Request or 401 Unauthorized) in response to a createDynamicPolicy Request (i.e. POST) from the target UE.\n-\t5GMS AF returns a retrieveDynamicPolicy Response (i.e. Either 400 Bad Request or 401 Unauthorized or 404 Not Found) in response to a retrieveDynamicPolicy Request (i.e. GET) from the target UE.\n-\t5GMS AF returns an updateDynamicPolicy Response (i.e. Either 400 Bad Request or 401 Unauthorized or 404 Not Found) in response to an updateDynamicPolicy Request (i.e. PUT) from the target UE.\n-\t5GMS AF returns a patchDynamicPolicy Response (i.e. Either 400 Bad Request or 401 Unauthorized or 404 Not Found) in response to a patchDynamicPolicy Request (i.e. PATCH) from the target UE.\n-\t5GMS AF returns a destroyDynamicPolicy Response (i.e. Either 400 Bad Request or 401 Unauthorized or 404 Not Found) in response to a destroyDynamicPolicy Request (i.e. DELETE) from the target UE.\n-\t5GMS AF returns a createNetworkAssistanceSession Response (i.e. 400 Bad Request or 401 Unauthorized) in response to a createNetworkAssistanceSession Request (i.e. POST) from the target UE.\n-\t5GMS AF returns a retrieveNetworkAssistanceSession Response (i.e. Either 400 Bad Request or 401 Unauthorized or 404 Not Found) in response to a retrieveNetworkAssistanceSession Request (i.e. GET) from the target UE.\n-\t5GMS AF returns an updateNetworkAssistanceSession Response (i.e. Either 400 Bad Request or 401 Unauthorized or 404 Not Found) in response to an updateNetworkAssistanceSession Request (i.e. PUT) from the target UE.\n-\t5GMS AF returns a patchNetworkAssistanceSession Response (i.e. Either 400 Bad Request or 401 Unauthorized or 404 Not Found) in response to a patchNetworkAssistanceSession Request (i.e. PATCH) from the target UE.\n-\t5GMS AF returns a destroyNetworkAssistanceSession Response (i.e. Either 400 Bad Request or 401 Unauthorized or 404 Not Found) in response to a destroyNetworkAssistanceSession Request (i.e. DELETE) from the target UE.\n-\t5GMS AF returns a requestBitRateRecommendation Response (i.e. Either 400 Bad Request or 401 Unauthorized or 404 Not Found) in response to a requestBitRateRecommendation Request (i.e. GET) from the target UE.\n-\t5GMS AF returns a requestDeliveryBoost Response (i.e. Either 400 Bad Request or 401 Unauthorized or 404 Not Found) in response to a requestDeliveryBoost Request (i.e. POST) from the target UE.\nTable 7.15.2.7-1: Payload for FiveGMSAFNetworkAssistance\n\nThe IRI-POI in the 5GMS AF shall generate an xIRI containing an FiveGMSAFStartOfInterceptionWithAlreadyConfiguredUE record when the IRI-POI present in the 5GMS AF detects that interception is activated for a target UE which Media Session Handler has already been configured with the service access information.\nTable 7.15.2.8-1: Payload for FiveGMSAFStartOfInterceptionWithAlreadyConfiguredUE\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.15.2.2-1: Payload for FiveGMSAFServiceAccessInformation",
                                    "table number": 489,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.15.2.3-1: Payload for FiveGMSAFConsumptionReporting",
                                    "table number": 490,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.15.2.4-1: Payload for FiveGMSAFDynamicPolicyInvocation",
                                    "table number": 491,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.15.2.5-1: Payload for FiveGMSAFMetricsReporting",
                                    "table number": 492,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.15.2.6-1: Payload for FiveGMSAFNetworkAssistance",
                                    "table number": 493,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.15.2.7-1: Payload for FiveGMSAFNetworkAssistance",
                                    "table number": 494,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 7.15.2.8-1: Payload for FiveGMSAFStartOfInterceptionWithAlreadyConfiguredUE",
                                    "table number": 495,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.15.3\tGeneration of IRI over LI_HI2",
                            "text_content": "When an xIRI is received over LI_X2 from the IRI-POI in the 5GMS AF, the MDF2 shall send the IRI message over LI_HI2 without undue delay. The IRI message shall contain a copy of the relevant record received from LI_X2. The record may be enriched by other information available at the MDF (e.g. additional location information).\nThe timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be set to the time at which the 5GMS AF event was observed (i.e. the timestamp field of the xIRI).\nThe IRI type parameter shall be included and coded according to table 7.14.2-19 (see ETSI TS 102 232-1 [9] clause 5.2.10).\nTable 7.15.3-1: IRI type for IRI messages\n\nThe threeGPP33128DefinedIRI field (see ETSI TS 102 232-7 [10] clause 15) shall be populated with the BER-encoded IRIPayload.\nMDF2 delivers the IRI to the LEMF with GPSI as the target identity if and only if GPSI is present in the xIRI.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.15.3-1: IRI type for IRI messages",
                                    "table number": 496,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "title": "8\tCommon Parameter Definitions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "8.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The following sub-clauses contain definitions for Types defined in the attached ASN.1 documents that are used by multiple POIs and therefore cannot be placed in a single clause above.\nCommon parameters that are present within the Location structure are defined in clause 7.3.3.2.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.2\tSimple types",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 8.2-1: Common Simple Types for LI reporting\n\nTable 8.2-2 contains the details for types that consist only of a SEQUENCE OF or SET OF.\nTable 8.2-2: Details of SEQUENCE OF Types\n\nTable 8.2-3 contains the details for Types that use the ExternalASNType.\nTable 8.2-3: Details for ExtenalASNType\n\n",
                    "tables": [
                        {
                            "description": "Table 8.2-1: Common Simple Types for LI reporting",
                            "table number": 497,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "Table 8.2-2: Details of SEQUENCE OF Types",
                            "table number": 498,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "Table 8.2-3: Details for ExtenalASNType",
                            "table number": 499,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.3\tIdentifier Types",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.3.1\tGeneral",
                            "text_content": "The following subclauses contain definitions for the identifiers used in the attached ASN.1 documents.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.3.2\tUser identifier lists",
                            "text_content": "As there are often multiple identifiers that may be known at an NF or by the MDF, a single type capable of reporting multiple User Identifiers was defined.\nTable 8.3.2.1-1: Structure of the UserIdentifiers type\n\nTable 8.3.2.2-1 contains the details for types that consist only of a SEQUENCE OF or SET OF.\nTable 8.3.2.2-1: Details of SEQUENCE OF Types\n\nTable 8.3.2.3-1: Structure of the EPSSubscriberIDs type\n\nTable 8.3.2.4-1: Definition of Choices for FiveGSSubscriberID\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.3.2.1-1: Structure of the UserIdentifiers type",
                                    "table number": 500,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.3.2.2-1: Details of SEQUENCE OF Types",
                                    "table number": 501,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.3.2.3-1: Structure of the EPSSubscriberIDs type",
                                    "table number": 502,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.3.2.4-1: Definition of Choices for FiveGSSubscriberID",
                                    "table number": 503,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.3.3\tSimple Types for Identifiers",
                            "text_content": "Table 8.3-1: Common Simple Types for Identifiers\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.3-1: Common Simple Types for Identifiers",
                                    "table number": 504,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.3.4\tType: SUPI",
                            "text_content": "The SUPI type is derived from the data present in the Subscription Permanent Identifier type defined in TS 23.003 [19] clause 2.2A.\nTable 8.3.4-1 contains the details for the SUPI type.\nTable 8.3.4-1: Definition of Choices for SUPI\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.3.4-1: Definition of Choices for SUPI",
                                    "table number": 505,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.3.5\tType: SUCI",
                            "text_content": "The SUCI type is derived from the data present in the Subscription Concealed Identifier type defined in TS 23.003 [19] clause 2.2B.\nTable 8.3.5-1 contains the details for the SUCI type.\nTable 8.3.5-1: Definition of SUCI type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.3.5-1: Definition of SUCI type",
                                    "table number": 506,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.3.6\tType: PEI",
                            "text_content": "The PEI type is derived from the data present in the Permanent Equipment Identifier type defined in TS 23.003 [19] clause 6.4.\nTable 8.3.6-1 contains the details for the PEI type.\nTable 8.3.6-1: Definition of Choices for PEI\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.3.6-1: Definition of Choices for PEI",
                                    "table number": 507,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.3.7\tType: GPSI",
                            "text_content": "The GPSI type is derived from the data present in the Generic Public Subscription Identifier type defined in TS 23.003 [19] clause 28.8.\nTable 8.3.7-1 contains the details for the GPSI type.\nTable 8.3.7-1: Definition of Choices for GPSI\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.3.7-1: Definition of Choices for GPSI",
                                    "table number": 508,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.3.8\tType: GUTI",
                            "text_content": "The GUTI type is derived from the data present in the Globally Unique Temporary User Identity type defined in TS 23.003 [19] clause 2.8.\nTable 8.3.8-1 contains the details for the GUTI type.\nTable 8.3.8-1: Definition of GUTI type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.3.8-1: Definition of GUTI type",
                                    "table number": 509,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.3.9\tType: FiveGGUTI",
                            "text_content": "The FiveGGUTI type is derived from the data present in the 5G Globally Unique Temporary User Identity type defined in TS 23.003 [19] clause 2.10.\nTable 8.3.9-1 contains the details for the FiveGGUTI type.\nTable 8.3.9-1: Definition of FiveGGUTI type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.3.9-1: Definition of FiveGGUTI type",
                                    "table number": 510,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.3.10\tType: EPS5GGUTI",
                            "text_content": "The EPS5GGUTI type is used when a parameter may be either a GUTI or a 5G-GUTI.\nTable 8.3.10-1 contains the details for the EPS5GGUTI type.\nTable 8.3.10-1: Definition of Choices for EPS5GGUTI\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.3.10-1: Definition of Choices for EPS5GGUTI",
                                    "table number": 511,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.3.11\tType: NonIMEISVPEI",
                            "text_content": "The NonIMEISVPEI type is used when IMEI or IMEISV based PEI is not available.\nTable 8.3.11-1 contains the details for the NonIMEISVPEI type.\nTable 8.3.11-1: Definition of Choices for NonIMEISVPEI\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.3.11-1: Definition of Choices for NonIMEISVPEI",
                                    "table number": 512,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "8.4\tComplex types",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.4.1\tType: HandoverCause",
                            "text_content": "The HandoverCause type is derived from the Cause type defined in TS 38.413 [23] clause 9.3.1.2.\nTable 8.4.1-1 contains the details for the HandoverCause type.\nTable 8.3.4-1: Choices for HandoverCause type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.3.4-1: Choices for HandoverCause type",
                                    "table number": 513,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.2\tType: EMM5GMMStatus",
                            "text_content": "Indicates the registration status of the UE in both EPS and 5GS as known at the NF where the POI is located. This type is derived from the UE status IE defined in TS 24.501 [13] clause 9.11.3.56.\nTable 8.4.2-1: Definition of type EMM5GMMStatus\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.4.2-1: Definition of type EMM5GMMStatus",
                                    "table number": 514,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.3\tType: ForbiddenAreaInformation",
                            "text_content": "Contains a list of TACs that are forbidden.\nTable 8.4.3-1: Structure of the ForbiddenAreaInformation type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.4.3-1: Structure of the ForbiddenAreaInformation type",
                                    "table number": 515,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.4\tType: ForbiddenLAInformation",
                            "text_content": "Contains a list of LACs that are forbidden.\nTable 8.4.4-1: Structure of the ForbiddenAreaInformation type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.4.4-1: Structure of the ForbiddenAreaInformation type",
                                    "table number": 516,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.5\tType: RATRestrictionItem",
                            "text_content": "Contains a list of RAT Restrictions.\nTable 8.4.5-1: Structure of the RATRestrictionItem type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.4.5-1: Structure of the RATRestrictionItem type",
                                    "table number": 517,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.6\tType: LTEV2XServiceAuthorization",
                            "text_content": "Table 8.4.6-1 contains the details for the LTEV2XServiceAuthorization type.\nTable 8.4.6-1: Structure of the LTEV2XServiceAuthorization type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.4.6-1: Structure of the LTEV2XServiceAuthorization type",
                                    "table number": 518,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.7\tType: NRV2XServiceAuthorization",
                            "text_content": "Table 8.4.7-1 contains the details for the NRV2XServiceAuthorization type.\nTable 8.4.7-1: Structure of the NRV2XServiceAuthorization type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.4.7-1: Structure of the NRV2XServiceAuthorization type",
                                    "table number": 519,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.8\tType: RRCEstablishmentCause",
                            "text_content": "The RRCEstablishmentCause type is derived from the RRC Establishment Cause type defined in TS 38.413 [23] clause 9.3.1.111. and the RRC Establishment Cause type defined in TS 36.413 [38] clause 9.2.1.3a.\nTable 8.4.8-1 contains the details for the RRCEstablishmentCause type.\nTable 8.4.8-1: Choices for RRCEstablishmentCause type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.4.8-1: Choices for RRCEstablishmentCause type",
                                    "table number": 520,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.9\tType: ConnectedENGNB",
                            "text_content": "Table 8.4.9-1 contains the details for the ConnectedENGNB type. Derived from the Connected en-gNB List type defined in TS 36.413 [38] clause 9.1.8.4.\nTable 8.4.9-1: Structure of the ConnectedENGNB type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.4.9-1: Structure of the ConnectedENGNB type",
                                    "table number": 521,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.4.10\tType: PLMNSupportItem",
                            "text_content": "Contains a PLMN and possibly a NID along with an onboarding support indication.\nTable 8.4.10-1: Structure of the PLMNSupportItem type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.4.10-1: Structure of the PLMNSupportItem type",
                                    "table number": 522,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "8.5\tEnumerations",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.5.1\tEnumeration: EMMRegStatus",
                            "text_content": "The EMMRegStatus type is derived from the EMM registration status portion of the UE status IE defined in TS 24.501 [13] clause 9.11.3.56.\nTable 8.5.1-1 contains the details for the EMMRegStatus type.\nTable 8.5.1-1: Enumeration for the EMMRegStatus type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.5.1-1: Enumeration for the EMMRegStatus type",
                                    "table number": 523,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.5.2\tEnumeration: FiveGMMRegStatus",
                            "text_content": "The FiveGMMRegStatus type is derived from the 5GMM registration status portion of the UE status IE defined in TS 24.501 [13] clause 9.11.3.56.\nTable 8.5.2-1 contains the details for the FiveGMMRegStatus type.\nTable 8.5.2-1: Enumeration for the FiveGMMRegStatus type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.5.2-1: Enumeration for the FiveGMMRegStatus type",
                                    "table number": 524,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.5.3\tEnumeration: SMSOverNASIndicator",
                            "text_content": "The SMSOverNASIndicator type is derived from the SMS over NAS transport allowed portion of the 5GS registration result IE defined in TS 24.501 [13] clause 9.11.3.6.1.\nTable 8.5.3-1 contains the details for the SMSOverNASIndicator type.\nTable 8.5.3-1: Enumeration for the SMSOverNASIndicator type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.5.3-1: Enumeration for the SMSOverNASIndicator type",
                                    "table number": 525,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.5.4\tEnumeration: CSGMembershipIndication",
                            "text_content": "The CSGMembershipIndication indicates whether the user is a member of a CSG.\nTable 8.5.4-1 contains the details for the CSGMembershipIndication type.\nTable 8.5.4-1: Enumeration for the CSGMembershipIndication type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.5.4-1: Enumeration for the CSGMembershipIndication type",
                                    "table number": 526,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.5.5\tEnumeration: EPSAttachType",
                            "text_content": "The EPSAttachType provides information on the attach type used by the UE. Derived from the enumerations in TS 24.301 [51] clause 9.9.3.11.\nTable 8.5.5-1 contains the details of the EPSAttachType type.\nTable 8.5.5-1: Enumeration for EPSAttachType\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.5.5-1: Enumeration for EPSAttachType",
                                    "table number": 527,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.5.6\tEnumeration: EPSAttachResult",
                            "text_content": "The EPSAttachResult provides information on the attach type used by the UE. Derived from the enumerations in TS 24.301 [51] clause 9.9.3.10.\nTable 8.5.6-1 contains the details of the EPSAttachResult type.\nTable 8.5.6-1: Enumeration for EPSAttachResult\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.5.6-1: Enumeration for EPSAttachResult",
                                    "table number": 528,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.5.7\tEnumeration: EPSSMSServiceStatus",
                            "text_content": "The EPSSMSServiceStatus provides information on status of SMS Services. Derived from the enumerations in TS 24.301 [51] clause 9.9.3.4B.\nTable 8.5.7-1 contains the details of the EPSSMSServiceStatus type.\nTable 8.5.7-1: Enumeration for EPSSMSServiceStatus\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.5.7-1: Enumeration for EPSSMSServiceStatus",
                                    "table number": 529,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.5.8\tEnumeration: EstablishmentCause",
                            "text_content": "The EstablishmentCause provides information on reason RRC was established. Derived from the RRC Establishment Cause type defined in TS 38.413 [23] clause 9.3.1.111. and the RRC Establishment Cause type defined in TS 36.413 [38] clause 9.2.1.3a.\nTable 8.5.8-1 contains the details of the EstablishmentCause type.\nTable 8.5.8-1: Enumeration for EstablishmentCause\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.5.8-1: Enumeration for EstablishmentCause",
                                    "table number": 530,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.5.9\tEnumeration: TraceRecordType",
                            "text_content": "The TraceRecordType provides information on the type of Trace record being reported.\nTable 8.5.9-1 contains the details of the TraceRecordType type.\nTable 8.5.9-1: Enumeration for TraceRecordType\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.5.9-1: Enumeration for TraceRecordType",
                                    "table number": 531,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.5.10\tEnumeration: TraceDirection",
                            "text_content": "The TraceDirection provides information on the direction of the trace information being reported.\nTable 8.5.10-1 contains the details of the TraceDirection type.\nTable 8.5.10-1: Enumeration for TraceDirection\n\n\nThe ASN.1 module describing the structures used for LI_X2, LI_X3, LI_HI2 and LI_HI3 (\"TS33128Payloads\") is given in the file TS33128Payloads.asn which accompanies the present document.\nBased on clause 5.6 of the present document, this annex defines a system of management notification of LI system with the LI_HI4 interface.\nThe LI_HI4 interface shall be used to transport specific LI service O&M information (referred to as LI Notification) from the CSP to the LEMF. The individual parameters of the LI Notification message shall be coded using ASN.1 and the basic encoding rules (BER). The delivery of LI Notification shall be performed directly using the same mechanism as used for delivery of IRI messages over LI_HI2 and CC over LI_HI3.\nThe LI Notification shall be used to send electronic notification to the LEMF in the following cases:\n1)\tafter the activation of lawful interception;\n2)\tafter the deactivation of lawful interception;\n3)\tafter the modification of an active lawful interception.\nTable B.1-1: LINotification message\n\nConditional parameters shall be set as follows:\n\n\n\nThe individual notifications parameters shall be sent to the LEMF as soon as possible with the lowest latency at least once (if available).\nThe MDF2/MDF3 will deliver the LINotification message to LEMF.\nThe XSD schema describing the extensions used for LI_X1 is given in the file urn_3GPP_ns_li_3GPPX1Extensions.xsd which accompanies the present document.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.5.10-1: Enumeration for TraceDirection",
                                    "table number": 532,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table B.1-1: LINotification message",
                                    "table number": 533,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Conditional parameters shall be set as follows:",
                                    "table number": 534,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 535,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 536,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "title": "D.1\tIntroduction",
            "description": "This annex provides drafting guidance for contributors wishing to propose changes to the present document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "D.2\tDrafting conventions",
            "description": "Drafting conventions are described in table D.2-1.\nTable D.2-1: Drafting conventions\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "Table D.2-1: Drafting conventions",
                    "table number": 537,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "D.3\tNaming conventions",
            "description": "ASN.1 naming conventions are described in table D.3-1, and examples of naming conventions to avoid are shown in figure 1.\nTable D.3-1: Naming conventions\n\nExampleBadStructure ::= SEQUENCE\n{\nFirstField\t\t[1] FirstFieldType,\t\t-- D.3.1 First letter of field is upper case\nsecondField\t\t[2] secondFieldType,\t-- D.3.2 First letter of type is lower case\n3rdField\t\t[3] 3rdFieldType,\t\t-- D.3.3 Names starts with digit\nfourth-field\t[4]\tFourth_Field_Type,\t-- D.3.4 Names include hyphen and underscore\nfifthfield\t\t[5]\tFifthfieldtype,\t\t-- D.3.5 Names are not camelCased\nmsisdn\t\t\t[6] MSISDN,\t\t\t\t-- D.3.6 Acronyms in field name not wholly upper-cased\nmSISDN\t\t\t[7] Msisdn\t\t\t\t-- D.3.6 Acronyms in type name not wholly upper-cased\n}\nFigure 1 – Naming convention counter-examples\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "Table D.3-1: Naming conventions",
                    "table number": 538,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "D.4\tASN.1 Syntax conventions",
            "description": "ASN.1 syntax conventions are described in table D.4-1, examples of conformant ASN.1 syntax conventions are shown in figure 2, and examples of ASN.1 syntax conventions to avoid are shown in figure 3.\n\nTable D.4-1: ASN.1 Syntax conventions\n\nConformantModule\n{itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) ... }\n\nDEFINITIONS IMPLICIT TAGS EXTENSIBILITY IMPLIED ::=\n\nBEGIN\n\n\nStructure1 ::= SEQUENCE\n{\nfield1  [1] Field1,\nfield2  [2] Field2\n}\n\nField1 ::= ENUMERATED\n{\nchoice1(1),\nchoice2(2),\nchoice3(3)\n}\n\nField2 ::= OCTET STRING\n\nEND\nFigure 2 – Syntax convention examples\n\nNonconformantModule\n{itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) ... }\n\nDEFINITIONS AUTOMATIC TAGS ::=          -- D.4.1 Not declared with EXTENSIBILITY IMPLIED\n-- D.4.2 Declared AUTOMATIC TAGS\nBEGIN\n\nStructure1 ::= SEQUENCE {               -- D.4.11 Braces not given their own line\nfield1  [0] ::= ENUMERATED          -- D.4.3 SEQUENCE tags don’t start at 1\n{                                   -- D.4.5 Anonymous type used\nchoice1(0),                     -- D.4.4 ENUMERATED tag numbers don’t start at 1\nchoice2(2),\nchoice3(3)\n},\nfield2  [2] Field2\n}\n\nField2 ::= OCTET STRING\n\nEND\nFigure 3 – Syntax convention counter-examples\n",
            "summary": "",
            "tables": [
                {
                    "description": "Table D.4-1: ASN.1 Syntax conventions",
                    "table number": 539,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "D.5\tReferencing ASN.1 components",
            "description": "This document utilizes the formal reference notation defined by ITU-T Recommendation X.680 [124] clause 15 to identify specific ASN.1 components. The specific conventions described below only apply to this document. In the event of a conflict between ITU-T Recommendation X.680 [124] and the present document, the terms of the present document shall apply.\nASN.1 references are italicized to aid in their identification.\nRelative references may be used but shall only be used when the root of the path is either explicitly defined or may be definitively determined based on the context.\nUnless otherwise specified, the root of all references in this document is @TS33128Payloads.\nUnless otherwise specified the absolute reference for an xIRI record shall be @TS33128Payloads.XIRIPayload.event.{ComponentID} where the {ComponentID} is the name of the message. When a parameter or type being described is being described in the context of an xIRI message, the absolute reference described above shall be used as the root for any relative references.\nUnless otherwise specified the absolute reference for an IRI record shall be @TS33128Payloads.IRIPayload.event.{ComponentID} where the {ComponentID} is the name of the message. When a parameter or type being described is being described in the context of an IRI message, the absolute reference described above shall be used as the root for any relative references.\nThe XSD schema describing the extensions used for Identity Association is given in the file urn_3GPP_ns_li_3GPPIdentityExtensions.xsd which accompanies the present document.\nThe ASN.1 schema describing the structures used for LI_XER is given in the file TS33128IdentityAssociation.asn which accompanies the present document.\n\nThe XSD schema describing the structures used for state transfer is given in the file urn_3GPP_ns_li_3GPPStateTransfer.xsd which accompanies the present document.\nThe XSD schema describing the structures used for Location Acquisition query extensions is given in the file urn_3GPP_ns_li_3GPPXLAExtensions.xsd which accompanies the present document.\nThe XSD schema describing the structures used for LI queries is given in the file  which accompanies the present document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "M.1\tEncapsulated Information",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "M.1.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The subclauses below define LI structures to allow for the reuse of externally defined structures and schemas.\nThe current version of this specification the following specific encapsulated information types are defined:\n-\tSBIType for carrying messages or parameters defined by 3GPP for use over the Service Based Interfaces (SBIs).\n-\tXMLTypes for carrying messages or parameters in XML.\n-\tMIMEEntity for carrying MIME Entities.\n-\tMSRPMessage for sending information formated in an MSRP Message.\n-\tExternalASNType for sending information encoded using an externally defined ASN.1 schema.\nThe encapsulated information type of the outermost layer of the encapsulated payload shall be used to report the payload.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "M.1.2\tEncapsulated information reporting parameters",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "M.1.2.1\tSimple Types for encapsulate information reporting",
                            "text_content": "Table M.1.2.1-1: Simple Types for LI reporting of encapsulated information\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.1.2.1-1: Simple Types for LI reporting of encapsulated information",
                                    "table number": 540,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.1.2.2\tType: SBIType",
                            "text_content": "Table M.1.2.2-1: Structure of the SBIType type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.1.2.2-1: Structure of the SBIType type",
                                    "table number": 541,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.1.2.3\tType: XMLType",
                            "text_content": "Table M.1.2.3-1: Structure of the XMLType type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.1.2.3-1: Structure of the XMLType type",
                                    "table number": 542,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.1.2.4\tType: MIMEEntity",
                            "text_content": "Table M.1.2.4-1: Structure of the MIMEEntity type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.1.2.4-1: Structure of the MIMEEntity type",
                                    "table number": 543,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.1.2.5\tType: MSRPMessage",
                            "text_content": "Table M.1.2.5-1: Structure of the MSRPMessage type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.1.2.5-1: Structure of the MSRPMessage type",
                                    "table number": 544,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.1.2.6\tType: MIMEPartIdentifier",
                            "text_content": "Table M.1.2.6-1: Structure of the MIMEPartIdentifier type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.1.2.6-1: Structure of the MIMEPartIdentifier type",
                                    "table number": 545,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.1.2.7\tType: ExternalASNType",
                            "text_content": "Table M.1.2.7-1: Structure of the ExternalASNType type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.1.2.7-1: Structure of the ExternalASNType type",
                                    "table number": 546,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.1.2.8\tType: ExternalASNValue",
                            "text_content": "Table M.1.2.8-1: Choices for the ExternalASNValue type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.1.2.8-1: Choices for the ExternalASNValue type",
                                    "table number": 547,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "title": "M.2\tEncapsulated information modification",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "M.2.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "When encapsulated information needs to be modified, the following structures may be used to report that payload in IRI messages.\nIn general, the predefined redactions listed in the PredefinedPayloadModification table below should be used whenever possible. In cases where none of the predefined modifications describe the required redactions, the PayloadModificationDescription may be used.\nWhen an encapsulated payload is modified to redact unauthorised information each type of modification applied shall be reported in the PayloadModifications parameter. If the same type of modification is performed in multiple locations, this PayloadModification shall only be indicated once. Additionally, the indication of a PayloadModification indicates that all instances that match the conditions for that modification profile were modified.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "M.2.2\tPredefined modifications",
                    "description": "",
                    "summary": "",
                    "text_content": "The current document provides details for the following predefined methods for redacting unauthorised information from encapsulated payloads:\n-\tSMS TP-User-Data content redaction as described in clause 7.12.9.3.2.\n-\tIMS location and content information redaction as described in clause 7.12.9.\n-\tRCS location and content information redaction as described in clause 7.13.5.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "M.2.3\tUse of described modifications",
                    "description": "",
                    "summary": "",
                    "text_content": "Each modification is described using a ModificationLocation (see clause M.2.4.6) and a ModificationType (see clause M.2.4.7).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "M.2.4\tEncapsulated information modification parameters",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "M.2.4.1\tSimple Types for encapsulated information modification",
                            "text_content": "Table M.2.4.1-1: Simple Types for LI reporting of encapsulated information with modifications\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.2.4.1-1: Simple Types for LI reporting of encapsulated information with modifications",
                                    "table number": 548,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.2.4.2\tType: PayloadModifications",
                            "text_content": "Table M.2.4.2-1: Structure of the PayloadModifications type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.2.4.2-1: Structure of the PayloadModifications type",
                                    "table number": 549,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.2.4.3\tType: PayloadModification",
                            "text_content": "Table M.2.4.3-1: Choices for the PayloadModification type\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.2.4.3-1: Choices for the PayloadModification type",
                                    "table number": 550,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.2.4.4\tEnumeration: PredefinedPayloadModification",
                            "text_content": "The PredefinedPayloadModification shall be set to indicate which predefined payload modification profile was used on the reported modified payload.\nTable M.2.4.4-1: Enumeration for PredefinedPayloadModification parameter\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.2.4.4-1: Enumeration for PredefinedPayloadModification parameter",
                                    "table number": 551,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.2.4.5\tType: PayloadModificationDescription",
                            "text_content": "The PayloadModificationDescription shall be used to describe redactions performed on a payload.\nTable M.2.4.5-1: Structure of the PayloadModificationDescription type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.2.4.5-1: Structure of the PayloadModificationDescription type",
                                    "table number": 552,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.2.4.6\tType: ModificationLocation",
                            "text_content": "Table M.2.4.6-1: Choices for ModificationLocation Type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.2.4.6-1: Choices for ModificationLocation Type",
                                    "table number": 553,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.2.4.7\tType: ModificationType",
                            "text_content": "Table M.2.4.7-1: Choices for ModificationType Type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.2.4.7-1: Choices for ModificationType Type",
                                    "table number": 554,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.2.4.8\tType: PayloadInformationReplacedWithCharacters",
                            "text_content": "Table M.2.4.8-1: Structure of the PayloadInformationReplacedWithCharacters type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.2.4.8-1: Structure of the PayloadInformationReplacedWithCharacters type",
                                    "table number": 555,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.2.4.9\tType: PayloadInformationRemoved",
                            "text_content": "Table M.2.4.9-1: Choices for PayloadInformationRemoved Type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.2.4.9-1: Choices for PayloadInformationRemoved Type",
                                    "table number": 556,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.2.4.10\tType: MIMEBody",
                            "text_content": "Table M.2.4.10-1: Choices for MIMEBody Type\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.2.4.10-1: Choices for MIMEBody Type",
                                    "table number": 557,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "M.2.4.11\tType: IndexRange",
                            "text_content": "Table M.2.4.11-1: Structure of the IndexRange type\n\n\n\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table M.2.4.11-1: Structure of the IndexRange type",
                                    "table number": 558,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 559,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}