{
    "document_name": "33893-i01.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Report has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\t\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\t\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\t\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\t\tindicates that something is possible\ncannot\t\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\t\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\t\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document investigates the security and privacy aspects of Ranging based services and sidelink positioning in 5G system. The study is based on the architectural and functional requirements on Ranging based services and sidelink positioning services, so as to ensure that the proposed solutions address the security and privacy implications on the architecture enhancements studied in TR 23.700-86 [2]. Specifically, it covers the following:\n-\tThe identified security and privacy issues, threats, and potential requirements for Ranging based services and sidelink positioning.\n-\tThe gap analysis in security and privacy issues between Ranging based services and ProSe/V2X applications.\n-\tThe potential solutions addressing the security and privacy issues specific to Ranging based services and sidelink positioning.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TR 23.700-86: \"Study on Architecture Enhancement to support Ranging based services and sidelink positioning\"\n[3]\t3GPP TS 23.287: \"Architecture enhancements for 5G System (5GS) to support Vehicle-to-Everything (V2X) services\".\n[4]\t3GPP TS 23.304: \"Proximity based Services (ProSe) in the 5G System (5GS)\".\n[5]\t3GPP TS 33.536: \"Security aspects of 3GPP support for advanced Vehicle-to-Everything (V2X) services\".\n[6]\t3GPP TS 33.503: \"Security Aspects of Proximity based Services (ProSe) in the 5G System (5GS)\".\n[7]\t\t3GPP TS 22.261: \"Service requirements for the 5G system\".\n[8]\t\t3GPP TS 33.501: \"Security architecture and procedures for 5G system\".\n[9]\t3GPP TS 23.273: \"5G System (5GS) Location Services (LCS); Stage 2\".\n[10]\t3GPP TR 38.859: \"Study on expanded and improved NR positioning\".\n[11]\t3GPP TS 23.586: \"Architectural Enhancements to support Ranging based services and Sidelink Positioning\".\n[12]\t3GPP TS 38.305: \"NG Radio Access Network (NG-RAN); Stage 2 functional specification of User Equipment (UE) positioning in NG-RAN\".\n[13]\t3GPP TS 37.355: \"LTE Positioning Protocol (LPP)\".\n[14]\t3GPP TS 33.303: \"Proximity-based Services (ProSe); Security aspects\".\n[15]\t3GPP TS 23.502: \"Procedures for the 5G System\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in TR 21.905 [1].\nThe following terms used in the present document are defined in TR 23.700-86 [2]:\nRanging\nSL Reference UE\nTarget UE\nAssistant UE\nLocated UE\nSL Positioning Server UE\nSL Positioning Client UE\nSidelink Positioning\nPositioning\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tSymbols",
                    "description": "",
                    "summary": "",
                    "text_content": "Void.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.3\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905 [1].\nDoS \tDenial of Service\nLMF\tLocation Management Function\nProSe\tProximity based Service\nSL\tSidelink\nV2X\tVehicle-to-Everything\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tArchitecture assumptions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tReference architecture",
                    "description": "",
                    "summary": "",
                    "text_content": "As per TR 23.700-86 [2] clause 4.3, both Ranging-based services and Sidelink Positioning services are based on a common architecture. Such enhanced architecture is able to support Ranging and Sidelink Positioning in-coverage, partial coverage and out of network coverage scenarios.\nThe figure depicts a reference architecture for ranging/SL positioning in a 5G network, illustrating the various components and their interconnections. Key components include the base station (gNB), user equipment (UE), and scatterers. The diagram highlights beamforming techniques to mitigate interference, and the layered design aligns with SDN principles.\nFigure 4.1-1 Reference Architecture for Ranging/SL Positioning\nWith the assumption that all Ranging/SL positioning capable UEs are also ProSe or V2X capable as per TR 23.700-86 [2], for direct communication/discovery related aspects which are already defined for ProSe and V2X, architecture defined in TS 23.287 [3] and TS 23.304 [4] is used as the basis. Therefore, for discovery security and direct communication security, the solutions defined for V2X and ProSe in TS 33.536 [5] and TS 33.503 [6] will be reused as much as possible.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tReference points",
                    "description": "",
                    "summary": "",
                    "text_content": "The reference points over air interface in the architecture involve SR1, SR5, PC5, N1, N2, etc., among which SR1 is out of 3GPP scope. The functional description of these reference points can refer to TR 23.700-86 [2] clause 4.3.2.\nThe service-based interfaces in the architecture involve Nlmf, Nudm, Npcf, Nudr, Namf, etc. The functional description of these reference points can refer to TR 23.700-86 [2] clause 4.3.2.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5\tKey issues",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tKey issue #1: Privacy protection for Ranging/SL Positioning services",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.1.1\tKey issue details",
                            "text_content": "As the information of almost all Ranging/Sidelink Positioning services is related to location, all the UEs participating in Ranging/Sidelink Positioning, including the SL reference UE, target UE, assistant UE, etc., may need to disclose its location information to others. If such privacy sensitive information is not well protected, the UE's privacy could be compromised. Among the requirements defined for Ranging services in clause 6.37.2 of TS 22.261 [7], there are following requirements concerning privacy protection for Ranging services:\nThe 5G system shall be able to protect privacy of a UE and its user, ensuring that no identifiable information can be tracked by undesired entities during ranging.\nThe 5G system shall be able to ensure that user privacy is not violated during ranging, e.g., subject to regional or national regulatory requirements.\nPrivacy protection is also raised in clause 4.1 of TR 23.700-86 [2] as one of the architecture assumptions for Ranging/SL Positioning services and is tasked for SA3 to study. In multiple solutions (e.g. solutions #6, #9, #13, #18, #21, #23, #24, #25) of TR 23.700-86 [2], privacy is considered as an issue to be addressed, either during discovery, or during Ranging/SL positioning procedure, or for service exposure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.2\tSecurity threats",
                            "text_content": "When UE's identifiable information is disclosed to undesired/malicious UEs during discovery or during communication for Ranging/SL positioning, the UE's behaviour will become trackable to others. Hence the UE's privacy could be violated.\nWhen the UE's Ranging/SL positioning information (e.g. distance measurement, direction measurement, or both, or assistant data) and/or the associated UE's identity are disclosed to undesired/malicious UEs or undesired network functions during communication for Ranging/SL positioning, the UE's whereabouts and/or movements will become traceable to others. Hence the UE's privacy could be violated.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.3\tPotential security requirements",
                            "text_content": "The 5G Ranging/SL Positioning system shall provide means to mitigate trackability and linkability attacks of the UE during discovery for Ranging/SL positioning.\nThe 5G Ranging/SL Positioning system shall provide means to mitigate trackability and linkability attacks of the UE during communication for Ranging/SL positioning.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.2\tKey Issue #2: Authorization for Ranging/Sidelink Positioning Service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tKey issue details",
                            "text_content": "Ranging/Sidelink Positioning Service refers to the determination of the distance between two UEs and/or the direction of one UE, i.e. target UE, from the other one, i.e. SL reference UE, via direct device connection. Ranging based services can be used in a variety of verticals, such as consumer, smart home, smart city, smart transportation, smart retail, and industry 4.0. However, Ranging/Sidelink Positioning Service is exposed to various potential security threats such as unauthorized access.\nTo mitigate these security threats, authorization is indispensable. Without proper authorization, unauthorized entities will be able to participate in the position determination or obtain the positioning result, and arbitrarily consume the Ranging/Sidelink Positioning service. Furthermore, if one UE participating in the Ranging/Sidelink Positioning procedure is unauthorized, all the other UEs are subject to active or passive attacks, i.e. DoS attack, traffic analysis, or privacy leakage.\nIn addition, Solutions #17, #21, and #25 in the TR 23.700-86 [2] also describe the security issue on the support of service authorization, i.e.\nNOTE 1:\tHow AMF1 performs service authorization and privacy checking is not addressed in the present document.\nNOTE 2:\tThe security issue, e.g. whether the selected assistant UE is allowed to participate the Ranging/Sidelink positioning between UE1 and UE2 is not addressed in the present document.\nNOTE 3:\tThe security issue, e.g. whether the selected list of network assisted UE is allowed to have the Ranging/SL positioning information of the target UE is not addressed in the present document.\nFrom the security point of view, the system should be able to store the authorization information and determine whether an entity (a UE or network function or 3rd party server) is authorized to use Ranging/Sidelink Positioning service and obtain Ranging/Sidelink Positioning result of UEs. Privacy is UE specific, service authorization without identifying the UE is not able to meet the privacy requirement of the UE. Based on the authorization checking, the access to and exposure of Ranging/Sidelink positioning services can be controlled.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tSecurity threats",
                            "text_content": "An unauthorized UE can claim the role of the target UE, and arbitrarily consume the Ranging/SL positioning services, which may drain the energy of SL reference UE and invalidate the charging mechanism.\nAn unauthorized UE can claim the role of the SL reference UE/assistant UE, which may result in inaccurate position determination or privacy violation.\nAn unauthorized network function or third party server or a third party client UE can obtain the location information by triggering Ranging/SL positioning between the UEs, which may violate the privacy of the UEs involved in the Ranging/SL positioning.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.3\tPotential security requirements",
                            "text_content": "The 5G Ranging/SL positioning system shall be able to support the authorization of the UE as a target UE/reference UE/assistant UE/Located UE/SL Positioning Server UE in the Ranging/Sidelink Positioning service.\nThe 5G Ranging/SL positioning system shall be able to support the authorization of a network function for triggering Ranging/Sidelink Positioning services and obtaining the location information of UEs.\nThe 5G Ranging/SL positioning system shall be able to support the authorization of a third party server for triggering Ranging/Sidelink Positioning services and obtaining the location information of UEs.\nThe 5G Ranging/SL positioning system shall be able to support the authorization of a SL Positioning Client UE for triggering Ranging/Sidelink Positioning services and obtaining the location information of UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tKey issue #3: Protection of discovery procedure",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tKey issue details",
                            "text_content": "As per TR 23.700-86 [2], for discovery related aspects, the architecture and solutions defined for V2X and ProSe will be reused as much as possible. This provides the basis for reusing the direct discovery security defined for ProSe in TS 33.503 [6] to protect the direct discovery for Ranging/ SL Positioning services, which supports either Model A or Model B discovery.\nFor discovery of ProSe/V2X, the UEs can successfully discover each other if both UEs support the same ProSe/V2X service or the discovery filters provisioned to both UEs match and support the same ProSe/V2X service. Different from ProSe/V2X discovery, the discovery for Ranging/SL Positioning services needs to take the role of the UE (i.e. SL reference UE or target UE or assistant UE) into consideration. This means that when a UE discovers another UE for Ranging/SL Positioning service, both UE needs to know its own role and the role of the UE to be discovered.\nIn addition to the discovery initiated by the UE, in solutions #18 and #20 of TR 23.700-86 [2], the discovery for Ranging/SL positioning can also be triggered by the network (e.g. LMF) for discovering the Located UE.\nAnother difference between ProSe/V2X discovery and Ranging/SL Positioning discovery is that, for ProSe/V2X, the discovery message initiated by the announcing/discoverer UE only includes its own identity. While for Ranging/SL positioning, when a UE or the network starts to initiate a discovery procedure, it may already know which UE is to be discovered for Ranging and hence may include the identity of both UEs (the identity of the initiating UE and the identity of the UE to be discovered) in the discovery message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.2\tSecurity threats",
                            "text_content": "During discovery, if the authenticity of the discovery message cannot be verified, an attacker can impersonate the SL reference UE or target UE or assistant UE or Located UE, or even the network function triggering the discovery.\nIf the discovery messages are not integrity protected and anti-replay protected, the discovery parameters can be removed, intercepted, modified, or replayed by an attacker. Consequently, the UE may connect with a UE with an unexpected role (e.g. a SL reference UE connects with a SL reference UE) hence fails the Ranging/SL positioning service; or the UE may not connect with any UE, which is a form of DoS attack; or the UE may connect with a malicious UE which could launch more severe attacks.\nIf the discovery messages are not confidentiality protected, the privacy sensitive parameters (e.g. the identity of the initiating UE, the identity of the UE to be discovered) can be leaked to other irrelevant parties, hence the privacy of the UE(s) may be violated.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.3\tPotential security requirements",
                            "text_content": "The 5G Ranging/SL Positioning system shall be able to support integrity protection and anti-replay protection of discovery messages.\nThe 5G Ranging/SL Positioning system shall be able to support confidentiality protection of discovery messages.\nNOTE: whether verification of source authenticity is required for ranging/sidelink positioning is not addressed in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.4\tKey issue #4: Protection of unicast direct communication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.4.1\tKey issue details",
                            "text_content": "As per TR 23.700-86 [2], for direct communication between the UEs, the architecture and solutions defined for 5G V2X and 5G ProSe will be reused as much as possible. This provides the basis for reusing the direct communication security defined for 5G ProSe in TS 33.503 [6] or for 5G V2X in TS 33.536 [5] to protect the direct communication for Ranging/SL Positioning services.\nAlthough the security mechanisms for direct communication of 5G ProSe or 5G V2X services can be reused for Ranging/SL Positioning services, there are still some scenarios in Ranging/SL Positioning services that are not discussed and studied for 5G ProSe or 5G V2X services. Considering the Ranging/SL Positioning services may have different processing procedures, it's necessary to study the security of direct communication which is dedicated to the Ranging/SL Positioning services scenario.\nIn addition, for Ranging/Sidelink Positioning services, the information exchanged during SR5 direct communication between the UEs is location related, which is security/privacy sensitive. This is also an aspect different from 5G ProSe or 5G V2X services which do not always carry security/privacy sensitive information over PC5.\nMoreover, as per TR 23.700-86 [2], SR5 is defined in the reference architecture to carry control signalling of Ranging/Sidelink Positioning service. Given that all Ranging/SL positioning capable UEs are also ProSe/V2X capable, the security protection of SR5 direct communication can rely on the existing security protection of PC5 direct communication as specified in TS 33.503 [6] and TS 33.536 [5]. There are options discussed in TR 23.700-86 [2] to use PC5-S or PC5-U to carry SR5 control messages. Then how to protect SR5 control messages also needs to be analysed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.2\tSecurity threats",
                            "text_content": "During direct communication establishment for one-to-one communication, if the UE cannot authenticate the peer UE to be the entity it intends to communicate with, it may lead to the impersonation of the peer UE by an attacker.\nFailure to protect the integrity of Ranging/SL Positioning service information during direct communication will open vulnerability for attacks such as fabrication, modification, or removal of the signalling data such as positioning capability, positioning assistance data and location information.\nFailure to protect the confidentiality of Ranging/SL Positioning service information during direct communication will open vulnerability for eavesdropping attacks resulting in privacy violations.\nIn case one UE is communicating with multiple peer UEs for Ranging/SL Positioning service, if there is no security isolation between the PC5 direct links with multiple peer UEs, one compromised peer UE or compromised PC5 link could lead to the compromise of all PC5 links with other peer UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.3\tPotential security requirements",
                            "text_content": "The 5G system shall support a means for the Ranging-capable UEs to mutually authenticate each other during SR5 one-to-one direct communication of Ranging/SL Positioning service.\nThe 5G system shall provide a means to support integrity and replay protection of the information transferred during SR5 direct communication for the Ranging/SL Positioning service.\nThe 5G system shall provide a means to support confidentiality protection of the information transferred during SR5 direct communication for the Ranging/SL Positioning service.\nThe 5G system shall support a means for the Ranging-capable UE to establish cryptographic separation for each PC5 interface and for each peer UE during the SR5 direct communication establishment of Ranging/SL Positioning service.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.5\tKey issue #5: Protection of groupcast/broadcast",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.5.1\tKey issue details",
                            "text_content": "NOTE: This key issue details may need to be updated to align with the conclusion in RAN2.\nIn TR 38.859 [10], it is mentioned that using SLPP unicast messages between UEs is the baseline for SL positioning. In addition, sending part of SLPP positioning signalling among UEs via broadcast/groupcast is also possible:\n\"Unicast/one-to-one operation is assumed as baseline for exchange of SLPP signaling between UEs. Unicast SLPP session-based operation is supported. At least \"centralized\" operation is supported, i.e., operation where one UE performs range and/or position calculations based on measurement/location information relating to itself and/or other UEs. It is feasible to send at least the following positioning signaling for groupcast/broadcast (in addition to unicast) from RAN2's perspective:\n-\tSL positioning capability\n-\tSL positioning assistance data\nLocation information is not excluded and can be further considered in normative work.\"\nFurthermore, in TR 38.859 [10], it is also mentioned that security issues should be considered on how to protect the SL groupcast/broadcast messages:\n\"RAN2 will further discuss in normative work:\n-\tThe security issues (e.g., requirements for ciphering and/or integrity) on specific information of SL positioning capability and assistance data in groupcast/broadcast.\n-\tThe use cases for applying groupcast/broadcast.\"\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.2\tSecurity threats",
                            "text_content": "Failures to protect SL groupcast/broadcast communications will lead to the following threats:\n-\tPassive attackers can eavesdrop on privacy sensitive data exchanged between UEs.\n-\tActive attackers can intercept, modify or replay data packets exchanged between UEs.\n-\tThe broadcasting/groupcasting UE may be impersonated by an attacker.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.3\tPotential security requirements",
                            "text_content": "The 5G System shall support a means to provide confidentiality, integrity and replay protection of SL positioning signalling in groupcast.\nThe 5G System shall support a means to provide confidentiality, integrity and replay protection of SL positioning signalling in broadcast.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tPotential solutions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.0\tMapping of solutions to key issues",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 6.1-1: Mapping of solutions to key issues\n\n",
                    "tables": [
                        {
                            "description": "Table 6.1-1: Mapping of solutions to key issues",
                            "table number": 3,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.1\tSolution #1: Privacy protection for UEs in Ranging",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1.1\tIntroduction",
                            "text_content": "This solution resolves Key Issue #1 for privacy protection for Ranging/SL Positioning services. In particular, this solution tries to acquire the UE's authorization. In addition, configuration information is exchanged between the UEs to decide the entity for result calculation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.2\tSolution details",
                            "text_content": "The high-level procedure as shown in Figure 6.1.2-1 is based on the procedure descripted in solution 3 of TR 23.700-86 [2].\nThe figure depicts a high-level procedure for ranging operation control, illustrating the steps involved in managing the range of a radio communication system. The figure includes a flowchart with arrows indicating the sequence of actions, such as setting the range, adjusting the range, and monitoring the range. The figure also includes a legend to explain the different symbols used in the flowchart, such as \"Set,\" \"Adjust,\" and \"Monitor.\" The figure is a visual representation of the complex process involved in managing the range of a radio communication system, providing a clear and concise overview of the procedure.\nFigure 6.1.2-1: High-level Procedure for Ranging Operation Control\n1.\tUE1 and UE2 may get the ranging parameters from 5GC during registration. UE1 gets the ranging request from the application layer, UE3 or 5GC NF. The ranging request includes the consumer info and/or the purpose of ranging positioning. For example, if the AF wants to acquire the distance between UE1 and UE2 for V2X service. The AF ID and purpose for V2X are included.\n2.\tDiscovery and the connection establishment procedure are performed between UE1 and UE2 based on the concluded procedure of TR 23.700-86 [2].\n3.\tUE1 sends the ranging request in the Ranging/SL Positioning layer to the UE2 and negotiate the ranging parameters. The ranging request includes the ranging parameters, e.g. consumer info, purpose, result calculation entity. For example, UE1 decides to calculate the result and not share with UE2, then the result calculation entity means that \"UE1 will calculate the ranging result\".\n4.\tUE2 checks whether to accept the ranging request in step #3 in the Ranging/SL Positioning layer based on configuration. For example, UE2 checks whether to allow the ranging result to be provided to the consumer for the claimed purpose based on local policy. Based on received result calculation entity info, UE2 confirms whether the result can be acquired by UE1 or not.\nNOTE 2:\tThe configuration for privacy protection in the Ranging/SL Positioning layer is provided from application layer or other means. It is left to implementation.\n5. UE2 sends the ranging response to the UE1. For example, if UE2 does not authorize the ranging positioning for the purpose or the consumer, the reject message with cause will be responded. If UE2 wants to change result calculation entity, for example due to its privacy consideration, result calculation entity is included.\nNOTE 3:\tThe solution assumes that UE1 and UE2 can trust each other on the authorization operations during the ranging parameter negotiation.\n6.\tRanging positioning procedure is performed. The ranging result is calculated based on the negotiation result in step #5.\n7.\tThe ranging results may not be shared between the UEs according to the negotiation result. The result calculation entity will provide the result to the application layer, UE3 or 5GC NF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.3\tEvaluation",
                            "text_content": "The solution fulfilled the requirement in Key Issue #1 for privacy protection for Ranging/SL Positioning services. Result calculation entity and ranging result sharing will be negotiated to limit the entity who can acquire the ranging result. Hence, the ranging result will not be disclosed to undesired UEs. UE will check whether to accept the Ranging request on consumer info, purpose or result calculation entity based on configuration, which may be provided from application layer. The negotiation is performed in the Ranging/SL Positioning layer. The UE determines whether to continue the ranging process according to the authorization and negotiation result.\nAccommodating the signalling elements required for privacy negotiation in the Ranging/SL Positioning layer needs to be coordinated with the radio part.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2\tSolution #2: Authorization of 5GC NF for Ranging/SL positioning service exposure",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #2 on Authorization for Ranging/SL Positioning service. Specifically, it addresses the second requirement in KI#2: \"The 5G Ranging/SL positioning system shall be able to support the authorization of a network function for triggering Ranging/Sidelink Positioning services and obtaining the location information\".\nAccording to TR 23.700-86 [2], 5GC NF is enabled to initiate SL positioning service to obtain the accurate location of a UE or obtain the distance between two UEs, for which the 5GC NF needs to be authorized at two levels:\n-\tThe first level of authorization is for service access, i.e. the 5GC NF should be authorized to request the SL positioning service. This level of authorization could be achieved by existing OAuth token-based authorization defined in TS 33.501 [8].\n-\tThe second level of authorization is for preserving UE privacy. This is because, even if the 5GC NF is authorized to request the SL positioning service, it does not mean that the requested service can always be exposed to the 5GC NF. For example, it is possible that the 5GC NF is allowed to request SL positioning info between UE1 and UE2, but may not be allowed to request SL positioning info between UE3 and UE4. Without further check on the authorization info of the involved UEs, there is still the risk that SL positioning information could be exposed to unauthorized 5GC NF. Therefore, the 5GC NF needs to be further authorized on whether it is allowed to acquire position information of the involved specific UEs.\nThis solution introduces a method for authorizing the 5GC NF which initiates SL positioning service targeting at specific UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tSolution details",
                            "text_content": "The solution proposes that, when the 5GC NF initiates Ranging/SL Positioning service request, it initially interacts with the GMLC to check with the UDM about authorization information of the UEs for acquiring SL positioning information of the UEs, based on e.g. the privacy related parameters in UE's subscription data stored in the UDM/UDR.\nUE1 and UE2 refer to SL Reference UE and Target UE respectively for SL Positioning service.\n0.\tService authorization and policy/parameters provisioning procedure is performed between UE1/UE2 and the network respectively.\n1.\tThe 5GC NF sends the SL positioning service request to the GMLC.\n2.\tThe GMLC check with the UDM about the authorization info of UE1/UE2 via Nudm_SDM_Get service operation.\nNOTE 1:\tRegardless of whether UE1/UE2 are managed by different UDMs, separate Nudm_SDM_Get message needs to be sent as the API applies only for one target UE and for checking that UE's subscription.\n3.\tThe UDM checks the authorization info of UE1 and UE2 against their subscription data respectively based on the UE1 ID and UE2 ID.\n4.\tThe UDM returns the authorization results of the UEs to the GMLC.\n5.\tThe GMLC checks the authorization results of both UEs. Since SL Positioning service concerns location of the UE, it could be possible that the authorization info of the UE is location specific (e.g. the UE allows its location to be exposed in area A but does not allow its location to be exposed in area B).\nIf none of the UE grants or one of the UEs does not grant authorization for Ranging/SL positioning, the GMLC responds with authorization failure to the 5GC NF to abort the Ranging/SL positioning service.\nIf both UEs grant authorization without location restriction, the GMLC proceeds to step #9.\nConditionally, if both UEs grant authorization which is restricted in a certain area, the GMLC proceeds to step #6.\nThe figure depicts a 5G Core Network (5GC) network, illustrating the authorization process for Service Exposure (SE). The figure shows the 5GC NF's authorization process, which involves the authorization of the 5GC NF for Service Exposure. The figure includes various components such as the 5GC NF, the 5GC NF's authorization process, and the authorization of the 5GC NF for Service Exposure. The figure is important for understanding the authorization process in a 5G network and its role in ensuring network security.\nFigure 6.2.2-1: Authorization of the 5GC NF for Service Exposure\n6.\t[Conditional] The GMLC sends the Namf_Location_ProvideLocationInfo Request to the AMF.\nNOTE 2:\tRegardless of whether UE1/UE2 are managed by different or same AMF(s), separate Namf_Location_ProvideLocationInfo Request messages needs to be sent to the AMF as the API applies only for one UE.\n7.\t[Conditional] The AMF of UE1/UE2 responds with the Namf_Location_ProvideLocationInfo Response to the GMLC which contains the coarse location of UE1/UE2 (e.g. TAI or Cell-ID of UE1/UE2).\n8.\t[Conditional] Based on the coarse location of UE1/UE2, the GMLC checks whether the UE1/UE2 is within the area for requesting SL Positioning service.\n9. \tIf both UEs grant authorization in their current locations, the GMLC sends the SL Positioning service request from the 5GC NF to the AMF of one of the UEs (e.g. UE1) based on clause5.6.4 of TS 23.586 [11].\n10~13.\t The AMF selects a SL Positioning capable LMF (not shown in Figure 6.2.2-1) to perform the SL Positioning procedure between the network and the UE.\nNOTE 3:\tThe area granularity could be detailed in the UE privacy profile for SL positioning in UE subscription.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tEvaluation",
                            "text_content": "This solution addresses the second requirement \"The 5G Ranging/SL positioning system shall be able to support the authorization of a network function for triggering Ranging/Sidelink Positioning services and obtaining the location information\" in KI#2.\nOn top of the existing authorization of the 5GC NF on service level, the authorization in this solution is further performed on specific UE level, which ensures the privacy preservation of all involved UEs in a service, as Ranging/SL Positioning services request UE location information which is privacy sensitive.\nThis solution relies on the GMLC to check with the UDM for the authorization information of the involved UEs before forwarding the request from the 5GC NF to the AMF. Therefore, it is aligned with SA2 specification in TS 23.586 [11] which reuses the GMLC in LCS architecture specified in TS 23.273 [9] for Ranging/SL Positioning service exposure to 5GC NF.\nNOTE:\tWhether the authorization is based on existing UE LCS privacy profile in UDM or whether its new data or profile is to be decided in normative work, and needs to be coordinated with stage 2 work.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tSolution #3: Authorization of Application Server for Ranging/SL positioning service exposure",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tIntroduction",
                            "text_content": "The solution addresses Key Issue #2: Authorization for Ranging/SL Positioning Services. It aims to meet one of the potential requirements in Key issue #2 on authorization of a third party server for triggering Ranging/Sidelink Positioning services.\nAs per TR 23.700-86 [2] solution #13, a Ranging/SL Positioning service request may be initiated by an application server. In the AF-initiated Ranging/SL Positioning procedure, the authorization on service permission is indispensable for protecting the UE's privacy, for which the application server needs to be authorized at two levels:\n-\tThe first level of authorization is for service access. That means, when the NEF/GMLC receives the Ranging service request initiated by the Ranging application server (e.g. hosted in an AF), the NEF/GMLC can determine whether the application server/AF is authorized to request the Ranging service from the 5GC, according to clause 12.4 in TS 33.501 [8].\n-\tThe second level of authorization is for preserving UE privacy. This is because, even if the application server/AF is authorized to send requests to the 5GC for Ranging service, it does not mean that the service can always be exposed to the application server/AF. For example, it is possible that the application server/AF is allowed to request Ranging info between UE1 and UE2, but may not be allowed to request Ranging info between UE3 and UE4. Without further check on the authorization info of the involved UEs, there is still the risk that unauthorized Ranging/SL positioning information could be exposed to the application server/AF. Therefore, the application server/AF needs to be further authorized on whether it is allowed to acquire Ranging info of the involved specific UEs.\nThis solution proposes a method to meet the security requirement in AF-initiated procedure by using the existing network function GMLC/NEF. The GMLC/NEF interacts with the UDM to obtain the UE's subscription data and interacts with the AMF to get the network provided location of the UE. Based on the above information, the GMLC/NEF is able to check the authorization of Ranging/SL positioning services and protect the ranging UE's privacy.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tSolution details",
                            "text_content": "The solution proposes that, when the GMLC/NEF checks with the UDM to discover the serving AMF(s) of the UEs, it also needs to check with the UDM to authorize the application server for acquiring Ranging information of the UEs, based on e.g. the privacy related parameters in UE's subscription data stored in the UDM/UDR.\n1.\tService authorization policy/parameters are provisioned to UE1 and UE2.\n2.\tThe AF sends Ranging/SL positioning Service Request to the GMLC/NEF. If the Ranging/SL positioning Service Request is transmitted by the NEF/GMLC, the NEF/GMLC first determines whether the AF is authorized to request Ranging/SL Positioning service as defined in TS 33.501 [8], clause 12.4.\nNOTE 1:\tUE1 can be either the target UE or the reference UE, which can be requested by the AF or can be decided during step #12.\nThe figure depicts a communication network with various components, including a base station (gNB), user equipment (UE), and scatterers. The diagram illustrates the signal propagation in a 5G network, highlighting the role of beamforming techniques to mitigate interference. The fiber-optic backbone architecture is depicted, with core switches, optical line terminals (OLTs), and distributed nodes. The layered design aligns with SDN principles, as it supports redundancy and failover.Figure 6.3.2-1: Authorization of Application Server for Ranging/SL Positioning Service Exposure\n3.\tThe GMLC/NEF invokes a Nudm_SDM_Get service operation towards the UDM of the UE1/UE2 to get the authorization information of the UEs against e.g. their privacy profiles.\nNOTE 2:\tFor step 3a, regardless of whether UE1/UE2 are managed by different UDMs, separate Nudm_SDM_Get message needs to be sent as the API applies only for one target UE and for checking that UE's subscription.\n4.\tThe GMLC/NEF checks the authorization results of both UEs. Since Ranging service concerns location of the UE, it could be possible that the authorization info of the UE is location specific (e.g. the UE allows its location to be exposed in area A but does not allow its location to be exposed in area B).\nIf none of the UE grants or one of the UEs does not grant permission for the requested Ranging/SL positioning service, the GMLC/NEF proceeds to step #10b.\nIf both UEs grant authorization without location restriction, the GMLC/NEF proceeds to step #10a.\nConditionally, if both UEs grant authorization which is restricted in a certain area, the GMLC/NEF proceeds to step #5. In addition, the GMLC/NEF invokes a Nudm_UECM_Get service operation towards the UDM of UE1/UE2. The UDM returns the network addresses of the current serving AMF of UE1/UE2.\nNOTE 3:\tThe area granularity could be detailed in the UE privacy profile for Ranging in UE subscription.\n5.\t[Conditional] If both UEs grant permission which is however restricted in a certain area, the GMLC/NEF invokes the Namf_Location_ProvideLocationInfo service operation towards the AMF to request the Network provided location of the UE. This location request may also carry the result of the privacy check in step #3 which may include the Ranging/SL positioning service code or the identity of Ranging/SL positioning client provided by the AF and an indication of a privacy check related action (i.e. no action, notification, notification and verification, etc.)\nNOTE 4:\tIf UE1 and UE2 are managed by different AMFs, the GMLC/NEF sends messages to the corresponding AMFs respectively.\n6.\t[Conditional] If the indicator of privacy check related action indicates that the UE needs to either be notified or notified with privacy verification and if the UE supports Ranging notification (according to the UE capability information), a notification invoke message is sent by the AMF to the UE1/UE2, indicating the Ranging/SL positioning service code or the identity of Ranging/SL positioning client and whether privacy verification is required. If signalling connection establishment between UE2 and AMF fails, step 6 and step 7 are skipped, and the AMF answers to the GMLC with the last known location of the UE2 (i.e. Cell ID) together with the age of this location.\n7.\t[Conditional] The UE1/UE2 returns a notification result to the AMF indicating, if privacy verification was requested, whether permission is granted or denied for the current Ranging request.\n8.\t[Conditional] The AMF returns the Namf_Location_ProvideLocationInfo Response towards the GMLC/NEF to return the network provided location of the UE.\n9.\t[Conditional] Based on the Network provided location of UE1/UE2, the GMLC/NEF checks whether the UE1/UE2 is within the area for granting service authorization to the application server/AF.\n10a.\tIf the privacy requirements are met, the GMLC/NEF forwards the Ranging/SL Positioning service request to the serving AMF.\n10b.\tIf none of the UEs grants or one of the UEs does not grant authorization in its current location, the GMLC/NEF responds to the application server/AF with a failure cause.\n11~15.\tThe rest of the Ranging service procedure is performed between the UE, the network and the application server/AF. If notification or notification with privacy verification fails in step 6, UE2 will be notified or notified with privacy verification via ranging layer before ranging measurement.\nAlternatively, after the GMLC/NEF checks the authorization info of both UEs in step #4, if both UEs grant authorization which is however restricted in a certain area, the GMLC/NEF sends the Nudm_ParameterProvision_Get Request to the UDM and the UDM sends the Namf_Location_ProvideLocationInfo Request to the AMF. Then the AMF responds the Namf_Location_ProvideLocationInfo Response to the UDM and the UDM responds the Nudm_ParameterProvision_Get Response to the GMLC/NEF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.3\tEvaluation",
                            "text_content": "This consolidated solution addresses the third requirement on the authorization of a third party server for triggering Ranging services.\nOn top of the existing authorization of a third party server on service level, the authorization in this solution is further perform on specific UE level, which ensures the privacy of all involved UEs in a service, as Ranging/SL Positioning services per se request UE location information which is privacy sensitive.\nThis solution requires the GMLC/NEF to interact with the UDM to check the UE's subscription data and interact with the AMF directly or indirectly to get the network provided location of the UE.\nThis solution assumes that the GMLC is involved in Ranging/Sidelink Positioning services if location-based service procedure defined in TS 23.273 [9] is reused.\nThe alternative solution is not aligned with conclusions for KI#5 in TR 23.700-86 [2]. The alternative to use the Nudm_ParameterProvision_Get Request to the UDM and the UDM sends the Namf_Location_ProvideLocationInfo Request to the AMF is not defined in SA2 LCS architecture. All the steps of the alternative solution for authorization in steps 3-5 would be new, with impact on UDM and GMLC/NEF.\nThe main solution is aligned with conclusions in TR 23.700-86 [2]. The steps 4-5 would be new, with impact on GMLC/NEF.\nNOTE:\tWhether the authorization is based on existing UE LCS privacy profile in UDM or whether its new data or profile is to be decided in normative work is not addressed in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tSolution #4: Subscription-based authorization of the role of the UE during discovery",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #2 on Authorization for Ranging/SL Positioning service. Specifically, it addresses the first requirement in KI#2: \"The 5G Ranging/SL positioning system shall be able to support the authorization of the UE as a target UE/reference UE/assistant UE/Located UE in the Ranging/Sidelink Positioning service\".\nAccording to the definitions of various types of UE and their functionalities in Ranging/SL positioning services described in TR 23.700-86 [2], each of the UEs involved in a Ranging/SL positioning service plays a different role (e.g. SL Reference UE, Target UE, Assistant UE, Located UE, SL Positioning Server UE, SL Positioning Client UE). If the role of the UE is not claimed during discovery, the UEs may discover each other but may not be able to perform the requested service (e.g. a SL Reference UE having discovered another SL Reference UE). If the claimed role of the UE is not properly authorized during discovery, a UE can cheat its peer UEs in a service, resulting in service violation, privacy violation or charging invalidation.\nThis solution introduces a method for the network to authorize the role of the UE in a Ranging/SL positioning service during discovery. The authorization is performed in the security procedure for discovery, assuming Ranging/SL Positioning services reuse the discovery security procedure performed by ProSe capable UEs for ProSe services. Only after the role of the UE is successfully authorized, the network will then generate and provision discovery security materials to the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.2\tSolution details",
                            "text_content": "The solution assumes that the role that the UE is allowed to play in a Ranging/SL positioning service could be registered in the UE subscription (for SL positioning service) or in the specific service agreement (for Ranging service). That means, both the UDM and the Ranging Application Server could be the candidate function for authorizing the role of the UE for the requested Ranging/SL positioning service.\nA UE may have the capabilities supporting multiple roles for Ranging/SL positioning services (e.g. SL Reference UE capable of handle position signal and Server SL Positioning UE capable of location calculation). But the role the UE is allowed to play is bound with a specific Ranging/SL positioning service (e.g. the UE is allowed to act as a SL Reference UE in service 1, while the same UE is only allowed to act as a SL Positioning Server UE in service 2).\nThe solution requires that the UE sends its own role in Ranging/SL positioning service to the network during discovery procedure. Then the Ranging Server or the UDM could authorize the UE by checking whether the UE is allowed to act in a specific Ranging/SL positioning service, against the service agreement or the UE subscription. The UE can obtain the discovery security material only after its role is authorized by the Ranging Server or the UDM. In this way, a misbehaving UE announcing an unauthorized role is not able to protect its announcement/solicitation messages, hence not able to cheat the peer UEs, which need to verify the received announcement/solicitation messages and ignore the unprotected messages.\nAuthorization of the Role of the UE during Discovery – Model A\nSteps #1~#5 refer to an Announcing UE (A-UE):\n1.\tA-UE sends a Discovery Request message including its assigned role for the requested service.\nNOTE:\tWhether or not the Ranging capabilities can be used as the Ranging role is to be determined during normative phase.\n2.\tThe 5G DDNMF/PKMF of A-UE sends an Authorization Request to the Ranging Server or the UDM of A-UE for announcing authorization, which contains the UE's role received from A-UE.\n3.\tThe Ranging Server checks against the service agreement or the UDM of A-UE checks against A-UE's subscription, to determine whether A-UE is allowed to play the role(s) (e.g. whether A-UE is allowed to act as a Target/Server UE).\n4.\tIf there is a match between the received role and the allowed role(s) (e.g. A-UE is allowed to act as a Target UE or A-UE is allowed to act as both Target UE and Server UE), the Ranging Server or the UDM returns to the 5G DDNMF/PKMF an Authorization Response which contains the matched role(s) of A-UE. If there is no match between the received role and the allowed role(s) (e.g. A-UE is neither allowed to act as a Target UE nor allowed to act as a Server UE), the Ranging Server or the UDM returns an Authorization Response which contains the failure cause.\n5.\tIf the authorization with the Ranging Server or the UDM of A-UE is successful, the 5G DDNMF/PKMF of A-UE generates Discovery Security Material. The 5G DDNMF/PKMF of A-UE includes the Role(s) of A-UE authorized by the Ranging Server or the UDM and the Discovery Security Material in the Discovery Response. If the authorization with the Ranging Server or the UDM fails, the 5G DDNMF/PKMF of the A-UE does not generate Discovery Security Material and rejects the Discovery Request from the A-UE.\nSteps #6~#15 refer to a Monitoring UE (M-UE):\n6.\tM-UE sends a Discovery Request message including its assigned role for the requested service.\n7.\tThe 5G DDNMF/PKMF of M-UE sends an Authorization Request to the Ranging Server or the UDM of M-UE for monitoring authorization, which contains the UE's role received from M-UE.\nThe figure depicts the authorization process of the UE during discovery, specifically in the context of Model A. It illustrates the role of the UE in determining the authorization level of the network, which is crucial for ensuring secure communication. The figure shows the UE's role in determining the authorization level of the network, which is essential for ensuring secure communication.\nFigure 6.4.2-1: Authorization of the Role of the UE during Discovery – Model A\n8.\tThe Ranging Server checks against the service agreement or the UDM of M-UE checks against M-UE's subscription, to determine whether M-UE is allowed to play the role(s) (e.g. whether M-UE is allowed to act as a SL Reference/Located UE).\n9.\tIf there is a match between the received role and the allowed role(s) (e.g. M-UE is allowed to act as a SL Reference UE or M-UE is allowed to act as both Reference UE and Located UE), the Ranging Server or the UDM returns to the 5G DDNMF/PKMF an Authorization Response which contains the matched role(s) of M-UE. If there is no match between the received role and the allowed role(s) (e.g. M-UE is neither allowed to act as a SL Reference UE nor allowed to act as a Located UE), the Ranging Server or the UDM returns an Authorization Response which contains the failure cause.\n10.\tIf the authorization with the Ranging Server or the UDM of M-UE is successful, the 5G DDNMF/PKMF of M-UE contacts the 5G DDNMF/PKMF of A-UE by sending a Monitor Request message.\n11.\tThe 5G DDNMF/PKMF of A-UE sends an Authorization Request to the Ranging Server or the UDM, which contains the authorized roles of both M-UE and A-UE.\n12.\tThe Ranging Server or the UDM checks whether the authorized roles of M-UE and A-UE match in the requested service (e.g. whether the roles are Target UE and SL Reference UE for a Ranging service, or whether the roles are Located UE and Target UE for a SL positioning service).\n13.\tThe Ranging Server or the UDM returns an Authorization Response indicating whether the authorization is successful.\n14.\tIf the authorization with the Ranging Server or the UDM is successful, the 5G DDNMF/PKMF of A-UE responds to the 5G DDNMF/PKMF of M-UE with a Monitor Response message including the Discovery Security Material. If the authorization with the Ranging Server or the UDM fails, the 5G DDNMF/PKMF of A-UE rejects the Monitor Request from the 5G DDNMF/PKMF of M-UE and the following steps are not performed.\n15.\tThe 5G DDNMF/PKMF of M-UE returns the Discovery Security Material, along with the Role(s) of M-UE authorized by the Ranging Server or the UDM of M-UE in the Discovery Response.\nSteps #16~#18 occur over PC5:\n16.\tA-UE starts announcing. A-UE forms the announcement message containing the authorized role of A-UE and protects it with the discovery security material.\n17.\tM-UE listens for an announcement message and verifies the message with the discovery security material.\n18.\tM-UE determines whether the claimed role of A-UE in the announcement message is the role it monitors for (e.g. if the Role of A-UE is Target UE, then M-UE acting as a Reference UE can determine that it found a match).\nAuthorization of the Role of the UE during Ranging Discovery – Model B\nSteps #1~#15 are the same as the corresponding steps in the procedure for Model A.\nSteps #16~#18 occur over PC5:\n16.\tThe discoverer (R-UE) forms the discovery solicitation message containing the authorized role of the discoverer and protects it with the discovery security material.\n17.\tThe discoveree (E-UE) listens for a discovery solicitation message and verifies the message with the discovery security material, after which the discoveree determines whether the claimed role of the discoverer in the solicitation message is the role it monitors for (e.g. if the Role of the discoverer is Target UE, then the discoveree acting as a Located UE can determine that it found a match).\n18.\tThe discoveree returns a discovery response message to the discoverer, which contains its own authorized role matching the role of the discoverer.\nThe figure depicts the authorization process of the UE during discovery in the model B scenario, showing the UE's role in determining the authorization level of the network. The figure illustrates the UE's role in determining the authorization level of the network, with the UE being the central entity responsible for determining the authorization level of the network.\nFigure 6.4.2-2: Authorization of the Role of the UE during Discovery – Model B\nNOTE:\tThe messages for authorization during discovery request procedure could be security specific messages.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.3\tEvaluation",
                            "text_content": "This solution addresses the key issue #2 requirement on authorization of the UE as a target UE/SL reference UE/assistant UE/ Located UE during discovery procedure of a Ranging/Sidelink Positioning service.\nThe solution is based on ProSe direct discovery security mechanism, which needs to authorize whether the UE is allowed to use the service before provisioning discovery security materials to the UE. This solution enhances the existing mechanism by adding UE role authorization as an additional condition for provisioning discovery security materials to the UE. Only when the role of UE is successfully authorized, the network will then generate and provision discovery security materials. This ensures that unauthorized UE cannot discover other UEs as it is not able to protect discovery messages.\nThe only impact on the network is that the network functions need to authorize the role of the UE in the service after receiving discovery request from the UE and provision discovery security materials only to the UE after successful UE role authorization.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tSolution #5: Use of authorization tokens at PC5 security establishment",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tIntroduction",
                            "text_content": "The solution addresses Key Issue #2: Authorization for Ranging/SL Positioning Services. It aims to meet one of the potential requirements in Key issue #2 the authorization of the UE as a target UE/reference UE/assistant UE/Located UE in the Ranging/Sidelink Positioning service.\nAs per TR 23.700-86 [2] KI#5, when a UE is not able to perform Uu based positioning estimation, the UE may use Sidelink Positioning to obtain relative positioning with a Located UE which is in network coverage. Considering the UE may be out of network coverage or in network coverage, the UE needs to be able to independently check what SL positioning service the peer UE is authorized to use and what role the peer UE is authorized to act.\nIn addition, a Target UE may discover a Reference UE/Assistant UE who is out of network coverage to establish the PC5 link and perform the Ranging procedure. In this case, the UE needs to be able to independently check what Ranging service the peer UE is authorized to use and what role the peer UE is authorized to act.\nThis solution proposes a token based method as in OAuth 2.0 to meet the above requirements. The network may provide a token stating what kind of Ranging/Sidelink Positioning service the UE can use and what role it can act in the service.\nThe token is signed by the network with a private key and can be verified by the UE using the public key. Based on the token, the UE can independently check the authorization of peer UE during the Discovery procedure and the PC5 security establishment procedure.\nThis solution assumes long term credentials are provisioned into the UE(s) and form the root of the security of the PC5 unicast link as specified in TS 33.536 [5].\nNOTE 1:\tThe token for the Ranging/SL Positioning service is based on the Oauth 2.0 token defined in Clause 13.4.1.1 of TS 33.501 [3]. The details of Ranging/SL Positioning token will be decided during normative phase.\nNOTE 2:\tFor the Ranging service triggered by Ranging Application Server, the token and the associated public key can be provisioned by the Ranging Application Server. For the SL Positioning service triggered by 5GC NF, the token and the associated public key can be provisioned by the DDNMF/PKMF.\nThis solution assumes long term credentials are provisioned into the UE(s) and form the root of the security of the PC5 unicast link as specified in TS 33.536 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tSolution details",
                            "text_content": "0.\tThe Target UE/Located UE are provisioned with discovery security materials and authorization tokens when they are in coverage. If the Target UE/Located UE is authorized to use the SL Positioning service under the specific role, the network provides a token claiming the specific SL positioning service it can use and what role it can act in the service. The token is signed by the network and can be verified by the UE.\nThis step can be performed at any step before step #4.\n1.\tThe AMF receives a Sidelink positioning request from any 5GC NF or AF.\n2.\tThe AMF sends the Sidelink positioning request to the selected LMF.\n3.\tThe LMF decides to use the network assisted Sidelink positioning for Target UE. The LMF triggers the discovery of a Located UE for positioning assistance or performs Sidelink positioning capability negotiation with Target UE.\nNOTE:\tWhether or not located UE ID is provided by the LMF is to be aligned with stage 2 work.\nThe figure depicts a security-enabled network assisted sidelink positioning system, with full network coverage and no overage.\nFigure 6.5.2-1: Security for Network Assisted Sidelink Positioning with Full Network Coverage\n4.\tIf the Located UE ID is provided by the LMF, Target UE performs Model B discovery with the selected Located UE. If no located UE ID is provided, Target UE performs Model A discovery by listening to announcement message send by the Located UE.\nThe Located UE provides the Service Code and optionally its token in the discovery message. Once receiving the discovery messages, the Target UE verifies the discovery message and optionally the token.\n5.\tIf the authorization checking is successful, the Target UE responds to LMF with the Located UE ID. If required, the Target UE also responds with the Target UE/Located UE's Sidelink positioning capability.\n6.\tThe LMF determines the Sidelink positioning result calculation mode and the requested info. After that, the LMF sends the Sidelink positioning request to the Target UE\n7.\tThe Target UE establishes a PC5 link with the located UE for the SL positioning measurement as defined in TS 33.503 [6]. The Located UE and Target UE also exchange their tokens during the PC5 link establishment procedure for role authorization of each other. The Target UE performs Sidelink positioning procedure with the Located UE, and obtains the Sidelink positioning measurement data.\n8~10.\tThe rest of the procedure Sidelink Positioning service is performed between the Target UE and the network.\nSteps #0~#1 are the same as steps #0~#1 in clause 6.5.2.1.\n2.\tThe AMF sends the SL positioning service request to the selected LMF which includes Target UE ID and one or multiple Located UE ID(s)\n3.\tWhen both Target UE ID and one or multiple Located UE ID(s) are received in the LCS service request, the LMF sends the Sidelink positioning request to one or multiple Located UE(s) to trigger the Sidelink positioning procedure.\nThe figure depicts a security-enabled network assisted sidelink positioning system, with a physical network overlay and a digital overlay. The physical network overlay is shown in red, while the digital overlay is in blue. The system utilizes a physical network overlay to provide security and redundancy, with a physical network overlay in red and a digital overlay in blue. The system also includes a physical network overlay in red and a digital overlay in blue. The system also includes a physical network overlay in red and a digital overlay in blue.\nFigure 6.5.2-2: Security for Network Assisted Sidelink Positioning with Partial Network Coverage\n4.\tThe selected Located UE(s) performs the Discovery procedure (i.e. Model B discovery) to discover the Target UE which may move out of network coverage, and provides the Service Code and optionally its token to the Target UE. Once receiving the discovery messages, the Target UE verifies the integrity of discovery message and optionally the token.\n5.\tIf the authorization checking is successful, the Target UE establishes a PC5 link with the located UE for the SL positioning measurement as defined in TS 33.503 [6]. The Located UE and Target UE also exchange their tokens during the PC5 link establishment procedure for role authorization of each other.\n6~9. \tThe rest of the procedure of Sidelink Positioning service is performed between the Located UE and the network.\n0. \tThe Reference UE and the Target UE are provisioned with the discovery security materials and request authorization tokens when they are in 3GPP coverage.\n1.\tThe direct discovery procedure is performed by the Reference UE in order to discover the Target UE using the discovery parameters and discovery security material, based on the Ranging Service Code for the Ranging service.\n2.\tIf discovery result indicates the Target UE supports the Ranging service, the Reference UE sends a Direct Communication Request (DCR) that contains the Ranging Service Code (RSC) of the Ranging service and the authorization token of Reference UE which is retrieved from step #0, and also the Key_Est_Info used for direct authentication and key establishment. Protection of authorization token and RSC in DCR can be done in a similar way as described in TS33.503 [6].\n3.\tDirect Auth and Key Establish procedure as specified in TS 33.536 [5] is performed.\n4.\tThe Target UE uses the public key provided by the network to verify the token1 of the Reference UE that the Reference UE is authorized to act as a Reference UE.\nThe figure depicts a high-level procedure for PC5 security between a reference UE and a target UE in a 5G network. It illustrates the steps taken to ensure secure communication, including authentication, encryption, and network segmentation. The figure is crucial for understanding the security measures in a 5G network and their implementation.\nFigure 6.5.2-3: High-level Procedure of PC5 Security between Reference UE and Target UE\n5.\tThe Target UE derives KNRP and other security material as specified in TS 33.536 [5]. The Target UE sends a Direct Security Mode Command message to the Reference UE including the authorization token2 of the Target UE which is retrieved from step #0. The confidentiality protection is applied to the authorization token2.\n6.\tThe Reference UE uses the public key provided by the network to verify the token2 of the Target UE that the Target UE is authorized to act as a Target UE in the Ranging service. The Reference UE derives KNRP and other security material similar as the Target UE in step #5.\n7.\tThe Reference UE sends the Direct Security Mode Complete message to the Target UE.\n8.\tThe Reference UE and Target UE continue with the rest of procedure for the Ranging service over the secure PC5 link.\n0. The Reference UE, the Assistant UE and Target UE are provisioned with the discovery security materials and request authorization tokens when they are in 3GPP coverage.\n1.\tThe direct discovery procedure is performed by the Reference UE in order to discover the Assistant UE using the discovery parameters and discovery security material, based on the Ranging Service Code for the Ranging service.\nThe figure depicts a high-level procedure for PC5 security between reference UE/target UE and associated UE, illustrating the steps taken to ensure secure communication between the two devices.\nFigure 6.5.2-4: High-level Procedure of PC5 Security between Reference UE/Target UE and Assistant UE\n2.\tIf discovery result indicates the Assistant UE supports the Ranging service, the Reference UE sends a Direct Communication Request (DCR) that contains the Ranging Service Code (RSC) of the Ranging service and the authorization token1 of Reference UE which is retrieved from step #0, and also the Key_Est_Info used for direct authentication and key establishment. Protection of authorization token and RSC in DCR can be done in a similar way as described in TS33.503 [6].\n3.\tDirect Auth and Key Establish procedure as specified in TS 33.536 [5] is performed.\n4.\tThe Assistant UE uses the public key provided by the network to verify the token1 of the Reference UE that the Reference UE is authorized to act as a Reference UE.\n5.\tThe Assistant UE derives KNRP and other security material as specified in TS 33.536 [5]. The Assistant UE sends a Direct Security Mode Command message to the Reference UE including the authorization token2 of the Assistant UE which is retrieved from step #0. The confidentiality protection is applied to the authorization token.\n6.\tThe Reference UE uses the public key provided by the network to verify the token2 of the Assistant UE that the Assistant UE is authorized to act as a Assistant UE in the Ranging service. The Reference UE derives KNRP and other security material similar as the Assistant UE in step #5.\n7.\tThe Reference UE sends the Direct Security Mode Complete message to the Assistant UE.\n8.\tThe Reference UE and Assistant UE continue with the rest of procedure for the Ranging service over the secure PC5 link.\n9.\tSteps #1-#8 are repeated for PC5 security establishment between the Assistant UE and Target UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tEvaluation",
                            "text_content": "This solution, based on multiple solutions for KI#2 and KI#5 of TR 23.700-86 [2], addresses the first requirement in KI#2 on the authorization of the UE as a Target UE/Reference UE/Assistant UE/Located UE in the Ranging/Sidelink Positioning service.\nThis solution ensures that the peer UE can authorize the role of each other during Discovery procedure and PC5 link establishment procedure, covering both cases where they are in network coverage and out of network coverage.\nThe solution requires the network to provide the authorization token to the UE.\nThis solution requires the UEs to exchange their authorization tokens during Discovery procedure and PC5 link establishment procedure and verify the role.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.6\tSolution #6: Protection of direct communication for Sidelink Positioning service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #4 on protection of direct communication.\nAs assumed in clause 4.1, for Ranging/SL Positioning services, security protection for direct communication between UEs will reuse the solutions defined for V2X in TS 33.536 [5] and for ProSe in TS 33.503 [6] as much as possible. For V2X and ProSe services, direct communication security is built on the root of security, which is a long-term credential preconfigured in or provisioned to the UE by e.g. the providers of application/service. Such handling of credential configuration or provisioning can also be applied to Ranging based services, which are provided by Ranging application providers.\nHowever, Sidelink Positioning services are primarily requested and used by the 5GC NFs in operator networks, to which the assumption of long-term credentials provisioned into each of the involved UEs in SL Positioning services can no longer apply. This is because the involved UEs (e.g. Located UE, Target UE) are not bound with a specific application and could possibly be selected arbitrarily by the network to act as the required role of UE (e.g. Located UE). In this way, long-term credential configuration in or provisioning to the involved UEs may not be practical. With the lack of long-term credential (the security root), the existing security mechanism for direct communication of V2X services or ProSe services cannot be reused.\nThis solution introduces a security method for protecting the direct communication for SL positioning between the UEs, which have no provisioned long-term credentials dedicated to the SL Positioning service.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.2\tSolution details",
                            "text_content": "Instead of reusing direct communication security for ProSe/V2X services, this solution largely reuses the security mechanism for ProSe UE-to-Network Relay communication defined in TS 33.503 [6]. To support the security for SL Positioning services, there could be a SL Positioning Key Management Function (SLPKMF) deployed in each PLMN for generating and provisioning the security materials to the UE. Once a UE (UE-1) receives a network request to start SL positioning with another UE (UE-2), UE-1 can request a SL Positioning Key (SLPK) from its SLPKMF to be used as a root key for security establishment, before UE-1 sends the Direct Communication Request to UE-2.\n1~3.\tUE-1 is triggered by a Sidelink Positioning Service Request message sent from any AF/5GC NF via the AMF and the LMF, requesting UE-1 to perform SL positioning operation with UE-2. The request message contains UE-1 ID and UE-2 ID.\n4.\tUpon receiving the SL positioning request from the network, UE-1 sends a SL Positioning (SLP) Key Request to its SLPKMF. The message indicates that UE-1 is requesting a SLPK. If UE-1 already has a SLPK from the SLPKMF, the message also contains the ID of the SLPK.\nThe figure depicts a procedure for direct communication security for Sidelink Positioning Service, illustrating the steps involved in ensuring secure communication between the sender and receiver.\nFigure 6.6.2-1: Procedure of Direct Communication Security for Sidelink Positioning Service\n5.\tThe SLPKMF checks whether UE-1 is authorized to use SL Positioning service. If authorized, the SLPKMF sends a SLPK and SLPK ID to UE-1.\nNOTE 1:\tThe details of the generation of SLPK and SLPK ID are up to SLPKMF implementation.\n6.\tThe discovery procedure is performed between UE-1 and UE-2. This step can also be performed right after step #1.\n7.\tUE-1 sends a Direct Communication Request (DCR) to UE-2 that contains the SLPK ID, SL Positioning Code (SLPC) of the SL Positioning Service and KSLP nonce 1.\nNOTE 2:\tIf UE-1 does not have a valid SLPK, UE-1 redoes step 4 to request a new SLPK and SLPK ID before sending the DCR message.\n8.\tUE-2 sends a SLP Key Request message to its SLPKMF that contains SLPK ID, SLPC and KSLP nonce 1.\n9.\tThe SLPKMF of UE-2 checks if UE-2 is authorized to use the SL positioning service indicated by the SLPC. If authorized, the SLPKMF of UE-2 sends the SLP Key Request with the SLPK ID to the SLPKMF of UE-1.\n10.\tThe SLPKMF of UE-1 shall check if UE-1 is authorized to use the SL positioning service indicated by the SLPC after received the SLP Key request from the SLPKMF of UE-2. The SL positioning service authorization check shall be based on the SLPK ID and SLPC included in the Key Request message.\nThe SLPKMF of UE-1 generates KSLP nonce 2 and derive KSLP using the SLPK identified by SLPK ID, SLPC, KSLP nonce 1 and KSLP nonce 2. Then, the SLPKMF of UE-1 returns to the SLPKMF of UE-2 a SLP Key Response message which contains KSLP and KSLP nonce 2.\n11.\tThe SLPKMF of UE-2 returns to UE-2 the SLP Key Response message containing KSLP, KSLP nonce 2, etc.\n12.\tUE-2 derives the session key (KSLP-SESS) from KSLP and then derive the confidentiality key (SLPEK) (if applicable) and integrity key (SLPIK), and then sends a Direct Security Mode Command message including the KSLP nonce 2 to UE-1.\n13.\tWhen receiving KSLP nonce 2, UE-1 derives KSLP using the SLPK, SLPC, KSLP nonce 1 and KSLP nonce 2. Then UE-1 derives the session key (KSLP-SESS) from KSLP and then derive the confidentiality key (SLPEK) (if applicable) and integrity key (SLPIK), and responds with a Direct Security Mode Complete message to UE-2 protected by SLPIK and SLPEK (if derived).\n14.\tUE-2 responds a Direct Communication Accept message to UE-1 to complete the establishment of direct communication.\n15.\tUE-1, UE-2 and the network proceeds the rest of the procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.3\tEvaluation",
                            "text_content": "This solution addresses all the potential requirements in key issue #4 for Sidelink Positioning services by reusing the security mechanisms for 5G ProSe UE-to-Network Relay communication. The solution does not rely on long-term credentials in the UE preconfigured by an application, hence, could support the network to request SL positioning from any Target UE or Located UE.\nThe SL positioning capable UE needs to support 5G ProSe UE-to-Network Relay communication security.\nWhether reusing the PKMF or defining a new function for SLPKMF is to be decided in normative phase.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tSolution #7: Security policy based protection for Ranging/SL positioning service operation",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.7.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #1 on Privacy protection for Ranging/SL Positioning services and Key issue #4 on Protection of direct communication.\nIn clause 8.4 of TR 23.700-86 [2], it is concluded for Key Issue #4 (Control of Operations for Ranging/Sidelink Positioning) that a Ranging/SL Positioning layer is introduced on the UE under application layer and above AS layer to control Ranging/SL Positioning operation. The functionalities supported by the Ranging/SL Positioning layer include discovery of the UE(s) participating in Ranging/SL Positioning service sessions and control signalling between UEs or between UE and LMF to manage Ranging/SL Positioning operations. The reference point for Ranging/SL Positioning layer is SR5 and Ranging/Sidelink Positioning Protocol (RSPP) is introduced for SR5 over the PC5 reference point between the UEs. RSPP supports the procedures for exchanging Ranging/SL Positioning capability, Ranging/SL Positioning assistant data and Ranging/SL positioning measurement data/result.\nThe figure depicts a 7-layer ranging/SL positioning layer for Ranging/SL positioning operations, illustrating the various components and their interconnections. The layers include the Ranging/SL Positioning Layer, the Ranging/SL Positioning Data Processing Layer, the Ranging/SL Positioning Data Transmission Layer, the Ranging/SL Positioning Data Reception Layer, the Ranging/SL Positioning Data Processing Layer, the Ranging/SL Positioning Data Transmission Layer, and the Ranging/SL Positioning Data Reception Layer. The layers are interconnected through various components such as the Ranging/SL Positioning Data Processing Unit, the Ranging/SL Positioning Data Transmission Unit, and the Ranging/SL Positioning Data Reception Unit. The figure also includes a schematic representation of the Ranging/SL Positioning Data Processing Unit, the Ranging/SL Positioning Data Transmission Unit, and the Ranging/SL Positioning Data Reception Unit.\nFigure 6.7.1-1: Ranging/SL Positioning Layer for Ranging/SL Positioning Operations\nAs SR5 is the interface of the Ranging/SL Positioning layer for direct communication between UEs, which carries the key information of Ranging/SL Positioning services (e.g. Ranging/SL positioning measurement data/result, assistant data), this solution introduce SR5 security policies which are used to activate the necessary integrity and confidentiality protection for direct communication between UEs for Ranging/SL Positioning services.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.2\tSolution details",
                            "text_content": "As per clause 8.4 of TR 23.700-86 [2], SR5 direct communication between UEs over PC5 can reuse 5G ProSe Direct Communication procedure or V2X Communication procedure. Hence the security establishment for SR5 direct communication can also reuse the procedures for establishing PC5 direct communication security. According to TS 33.503 [6] and TS 33.536 [5], activation of PC5 link security relies on the PC5 security policies, which are provisioned to the UEs by the network (e.g. PCF) via a configured list of ProSe/V2X services and their corresponding PC5 security policies. Based on the security requirements of ProSe/V2X services run between the UEs, PC5 security policies could have three options of \"REQUIRED\", \"NOT NEEDED\" and \"PREFFERED\".\nAccordingly for SR5 direct communication, it is proposed that the network (e.g. PCF) also configures a separate list of Ranging/Sidelink Positioning services and the corresponding SR5 security policies, and provisions to the UE during Service Authorization and Information Provisioning procedure. Such a list of SR5 security policies is configured separately from the list of PC5 security policies for ProSe/V2X services, because one UE could possibly support Ranging/SL positioning services in addition to ProSe/V2X services, while the security requirements for Ranging/SL positioning services could be different from those for ProSe/V2X services.\nAs the key information of Ranging/SL Positioning services carried between UEs are control plane RSPP/SLPP messages over SR5 reference point, SR5 security policies need to support the security requirements for protecting the RSPP/SLPP signalling, which is mostly location related (e.g. Ranging/SL positioning measurement data/result, assistant data). With such security/privacy sensitive information, integrity and confidentiality should always be activated for Ranging/SL Positioning operations to avoid violation of UE privacy and signalling tampering. Therefore, it is proposed that the SR5 security policies for integrity protection of Ranging/SL Positioning control messages should be set as \"REQUIRED\" only, and confidentiality protection of Ranging/SL Positioning control messages can be set as \"REQUIRED\", \"PREFERRED\" or \"NOT NEEDED\" depending on operator's configuration.\nAlternatively, as SR5 security policies for Ranging/SL Positioning control messages should be set as \"REQUIRED\" which is the only option for security activation, it is possible that the UEs involved in direct communication over SR5 always activate the integrity protection and confidentiality protection for Ranging/SL positioning operation, without the network having to provision SR5 security policies to the UE. Then during SR5 communication security establishment procedure, the UEs only need to negotiate security algorithms but does not need to negotiate the security policies.\nNOTE 1: \tSecurity is enforced on PDCP layer for either SR5 or PC5 reference point, hence security will not be established on both SR5 and PC5 for the same service session.\nNOTE 2: \tThere is only one set of security policies configured for one service (i.e. PC5 security policies for ProSe/V2X service, SR5 security policies for Ranging/SL positioning service).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.3\tEvaluation",
                            "text_content": "The solution addresses the second requirement in KI#1 and the second and third requirements in KI#4.\nIt largely reuses the security policy based protection defined for ProSe/V2X services by configuring and provisioning SR5 security policies, hence has minimum impact on the network and the UE. Using a configuration list of Ranging/SL positioning services and corresponding SR5 security policies separate from the configuration list of ProSe/V2X services and corresponding PC5 security policies can avoid the impact on the existing security policy handling of PC5 direct communication for ProSe/V2X services when supporting the UE capable of running both ProSe/V2X services and Ranging/SL positioning services.\nAs per clause 8.4 of TR 23.700-86 [2], it is not determined yet whether the Ranging/SL Positioning layer is over V2X/ProSe layer or AS layer and whether SR5 is over PC5-S or PC5-U. Using SR5 security policies for Ranging/SL positioning control messages rather than PC5 security policies could ensure that the enforcement of SR5 security policies is independent from the pending conclusion in TR 23.700-86 [2]. Whichever layer or PC5 plane is determined to support Ranging/SL Positioning layer, it is SR5 security policies that should be enforced on PDCP layer for protecting Ranging/SL Positioning service operations.\nDepending on the type of service (Ranging/SL positioning service or ProSe/V2X service) requested, the UE is then able to determine which security policies (SR5 security policies or PC5 security policies) to be enforced on PDCP layer.\nThis solution applies to unicast mode direct communication of Ranging/SL Positioning services.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.8\tSolution #8: Security policy based protection for ranging result sent to SL Positioning Client UE",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #1 on Privacy protection for Ranging/SL Positioning services. Specifically, it addresses the second requirement in KI#1: \"The 5G Ranging/SL Positioning system shall provide means to mitigate trackability and linkability attacks of the UE during communication for Ranging/SL positioning\".\nIn clause 8.6 of TR 23.700-86 [2], it is concluded that SL Positioning Client UE can invoke Ranging/SL positioning service for obtaining the Ranging/SL positioning result between two other UEs. SL Positioning Client UE does not have to support Ranging/SL positioning capability, but the communication between the SL Positioning Client UE and Reference/Target UE has to be established for the transmission of Ranging/SL positioning result, either via PC5 or via 5GC. If the communication can be established directly between the SL Positioning Client UE and Reference/Target UE, the ranging result is carried over PC5 link. If the communication between the SL Positioning Client UE and Reference/Target UE is established via 5GC, the ranging result transmitted from Reference/Target UE to SL Positioning Client UE is carried over the Uu link between Reference/Target UE and the network and the Uu link between SL Positioning Client UE and the network.\nAs ranging result contains UE location information which is security/privacy sensitive, this solution is introduced to ensure that the ranging result sent to the SL Positioning Client UE via PC5/5GC is confidentiality protected by configuring proper security policies.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tSolution details",
                            "text_content": "As per TR 23.700-86 [2], SL Positioning Client UE may not be Ranging/SL positioning capable, but should be ProSe/V2X capable to establish PC5 communication with Reference/Target UE. When ranging result is transmitted to SL Positioning Client UE via PC5, the PC5 link protection is based on PC5 security policies for ProSe/V2X layer, as specified in TS 33.503 [6] and TS 33.536 [5].\nThe figure depicts a range result sent to a Positioning Client UE via PC5, illustrating the communication between the positioning system and the UE. The figure shows the range result in a 2-dimensional format, with the x-axis representing the distance from the UE and the y-axis representing the range in meters. The range result is represented by a red line, indicating the range of the signal. The positioning system sends the range result to the UE, which then uses it to determine the position of the UE relative to the reference position. The figure is a visual representation of the communication process between the positioning system and the UE, providing a clear understanding of the range result sent to the UE.\nFigure 6.8.2-1: Ranging Result sent to SL Positioning Client UE via PC5\nOn ProSe/V2X layer, ranging result should be transmitted as the payload of PC5 direct communication. It means that, for protecting ranging result, integrity and confidentiality protection should always be activated for PC5 user plane. Therefore for ranging result transmission via PC5, the PC5 UP security policies on SL Positioning Client UE and the Reference/Target UE sending ranging result should be configured as \"REQUIRED\" only for both integrity protection and confidentiality protection. The solution could be either 5GC-based or UE-based.\n5GC-based solution:\nFor Ranging/SL positioning service exposed to SL Positioning Client UE, the network (e.g. PCF) sets the PC5 UP security policies as \"REQUIRED\" only for both integrity protection and confidentiality protection, and sets the PC5 CP security policies as \"REQUIRED\" only for integrity protection. The network (e.g. PCF) provisions such security policies to the involve UEs based on the Role of the UEs in the Ranging/SL Positioning Service, i.e. SL Positioning Client UE and Reference/Target UE sending the ranging result.\nUE-based solution:\nIf there is no PC5 security policies provisioned from the network for Ranging/SL Positioning Service exposed to SL Positioning Client UE, the UE sending the ranging result (either Reference or Target UE) and the SL Positioning Client UE should always activate integrity and confidentiality protection on PC5 user plane, and always activate integrity protection on PC5 control plane.\nWhen ranging result is transmitted to SL Positioning Client UE via 5GC, the Uu link between the UE sending ranging result (Reference/Target UE) and the network should be integrity and confidentiality protected and the Uu link between the SL Positioning Client UE and the network should also be integrity and confidentiality protection.\nThe figure depicts a 5G signal ranging result sent to an SL Positioning Client UE via 5GC. The figure shows the signal path, including the base station (gNB), user equipment (UE), and scatterers, with key components such as the 5G core network (5GC), the 5G core network (5GC), and the 5G core network (5GC). The figure highlights the use of beamforming techniques to mitigate interference and the importance of redundancy paths for failover reliability.\nFigure 6.8.2-2: Ranging Result sent to SL Positioning Client UE via 5GC\nRanging result/measurement from the Reference/Target UE to the network is always carried using LCS procedure, hence the integrity and confidentiality protection of ranging result on Uu interface can be ensured by NAS security.\nFor ranging result exposed by the network to the SL Positioning Client UE, either enhanced MO-LR procedure or Application exposure API can be used.\n-\tWhen enhanced MO-LR procedure is used, ranging result is sent to the SL Positioning Client UE by the AMF in NAS signalling, hence the integrity and confidentiality protection of ranging result on Uu interface can be ensured by NAS security.\n-\tWhen Application exposure API is used, ranging result is sent to the SL Positioning Client UE over user plane. Therefore, the integrity and confidentiality protection of ranging result on Uu interface rely on the UP security policies provided to the RAN by the 5GC (e.g. SMF) during PDU session establishment procedure, as specified in TS33.501 [8]. In this case, the SMF should be able to set the UP security policies for integrity protection and confidentiality protection to \"REQUIRED\" when establishing a PDU session for the Ranging/SL Positioning service exposed to SL Positioning Client UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.3\tEvaluation",
                            "text_content": "The solution addresses the following key issue and requirement:\n-\tThe second requirement in KI#1: \"The 5G Ranging/SL Positioning system shall provide means to mitigate trackability and linkability attacks of the UE during communication for Ranging/SL positioning\";\nIt largely reuses the security policy based protection defined for ProSe/V2X services by configuring proper PC5 security policies on the involved UEs, hence has minimum impact on the network and the UE. For ranging result exposed through the network, NAS security is available when using enhanced MO-LR procedure.\nFor PC5 communication established for ranging result transmission, if no PC5 security policies are provisioned by the network to the UE for Ranging/SL Positioning service exposure, the involved UEs simply activate integrity and confidentiality protection on PC5 user plane and integrity protection on PC5 control plane, without negotiation on security policies.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.9\tSolution #9: Ranging/SL Positioning discovery and link establishment procedure for V2X capable UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.9.1\tIntroduction",
                            "text_content": "The solution addresses Key Issue #1: Privacy protection for Ranging/SL Positioning services, Key Issue #3: Protection of discovery procedure and Key Issue #4: Protection of direct communication. It largely reuses the mechanism of Restricted Discovery procedure defined in TS 33.503 [6] and Direct Security Establishment procedure defined in TS 33.536 [5]\nFor V2X capable UEs, Ranging/SL Positioning discovery procedure is integrated into PC5 unicast link establishment procedure. By broadcasting the DCR message, the Reference UE and Target UE can discover each other. However, the broadcast UE identity may compromise the user's privacy information and the missing of discovery procedure may introduce additional security threats, e.g. the unauthorized Assistance UE/Reference UE can arbitrarily initiate Ranging/SL Positioning operations with the Target UE.\nThis solution uses the code security parameters provided by the network to protect the privacy-sensitive information in the DCR message and uses the security materials (i.e. the long term credential) to secure the link establishment. To obtain the code security parameters, the Reference UE/Target UE and/or Assistance UE need to send the Discovery Request to the network. Once receiving the Discovery Request, the network can check the authorization, which reuses the Restricted Discovery procedure specified in TS 33.503 [6]. By authorization checking and direct authentication, the PC5 link can be securely established for Ranging/SL Positioning Service.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.2\tSolution details",
                            "text_content": "The figure depicts a direct communication setup for V2X-capable UEs, illustrating the process of direct discovery and communication. It shows the setup of the communication network, including the use of V2X technology for enhanced safety and efficiency.\nFigure 6.9.2-1:\tDirect discovery and communication for V2X capable UEs\nSteps 1a-3a refer to the Announcing UE:\n1a.\tThe Announcing UE sends a Discovery Request message containing UE ID, the Ranging Service Code, UE security capability, the authorized role to the 5G DDNMF/PKMF in order to get the associated security material.\nNOTE 1:\tThe Announcing UE and Monitoring UE can be seen as the Reference UE, Target UE, and/ or Located UE in the Ranging/SL Positioning Service.\n2a.\tThe 5G DDNMF/PKMF may check for the authorization with the UDM/Ranging Application Server based on the UE ID, Ranging Service Code and the received role. If, based on the permission settings, the UE ID is allowed to access Ranging/SL Positioning service, the Ranging Application Server/UDM returns an authorization response.\n3a.\tThe 5G DDNMF/PKMF in the HPLMN of the Announcing UE returns the corresponding Code Security Parameters. The Code Security Parameters provide the necessary information for the Announcing UE to protect the information in the DCR message. The 5G DDNMF/PKMF of the Announcing UE also includes the chosen ciphering algorithm in the Discovery Response message. The 5G DDNMF/PKMF determines the chosen ciphering algorithm based on the Ranging Service Code and the received UE security capability in step 1a. The UE stores the chosen ciphering algorithm together with the Ranging Service Code.\nSteps 1b-3b refer to the Monitoring UE:\n1b. The Monitoring UE sends a Discovery Request message containing UE ID, Ranging Service Code, the authorized role and the UE security capability to the 5G DDNMF/PKMF in order to be allowed to access Ranging/SL Positioning service.\n2b.\tThe 5G DDNMF/PKMF of Monitoring UE sends an authorization request to the Ranging Application Server/UDM. If, based on the permission settings, the UE ID is allowed to access Ranging/SL Positioning service, the Ranging Application Server/UDM returns an authorization response.\n3b.\tIf the Discovery Request is authorized and the UE security capability in step 1b includes the chosen ciphering algorithm, the 5G DDNMF/PKMF responds with the Discovery Response message including the corresponding Code Security Parameters and the chosen ciphering algorithm (based on the information/keys stored in step 3a).\nSteps 4-9 refer to the direct discovery and communication procedure for V2X capable UEs:\n4. The Announcing UE wants to establish unicast communication with the Monitoring UE to perform Ranging/SL Positioning measurement. Then the Announcing UE broadcasts Direct Communication Request containing UE ID, Ranging Service Code, role, credential ID, nonce 1 and its security capabilities, which is integrity protected as specified in TS 33.503 [6]. The UE ID is protected by the code security parameters based on the chosen ciphering algorithm.\nNOTE 2:\tThe long term credential and long term credential ID could be pre-configured on the V2X capable UE (incl. Announcing UE and Monitoring UE) or provisioned by the network e.g. during Service Authorization and Provisioning procedure.\n5. The Monitoring UE verifies the DCR message by using the code security parameter and check the Ranging Service Code and the role. If the checking is passed, the Monitoring UE may initiate a Direct Auth and Key Establish procedure with Announcing UE to generate the KNRP.\n6. The Monitoring UE derives the session key (KNRP-SESS) from KNRP and then derives the confidentiality key (NRPEK) (if applicable) and integrity key (NRPIK) based on the PC5/SR5 security policies. The Monitoring UE sends a Direct Security Mode Command message to the Announcing UE. This message includes the chosen security algorithm, nonce 2, and is protected as specified in TS 33.536 [5].\n7. The Announcing UE responds with a Direct Security Mode Complete message to the Monitoring UE as specified in TS 33.536 [5].\n8. Once receiving the Direct Security Mode Complete message from the Announcing UE, the Monitoring UE sends the Direct Communication Accept message to the Announcing UE.\n9. The Announcing UE and the Monitoring UE perform the Ranging/SL Positioning measurement.\nThe figure depicts the process of UE discovery and communication for V2X capable UEs, highlighting the importance of network infrastructure for enabling advanced vehicle-to-everything (V2X) communication.\nFigure 6.9.2-2: Assistant UE discovery and communication for V2X capable UEs\nSteps 1a-3a refer to the Discovery Key Request procedure of Assistance UE.\n1a.\tThe Assistance UE sends a Discovery Request message to its 5G DDNMF/PKMF in order to get the associated code security parameters. The Discovery Request may contain the UE ID, its PC5 UE security capability, the role of Ranging/SL Positioning service, and Ranging Service Code, etc.\n2a.\tThe 5G DDNMF/PKMF may check for the authorization with the Ranging Application Server.\n3a.\tThe 5G DDNMF/PKMF returns the corresponding code security parameters, which provide the necessary information for the Assistance UE to protect the information in the broadcast DCR message and are stored with the Ranging Service Code. The 5G DDNMF/PKMF may also include the chosen ciphering algorithm in the Discovery Response message. The Assistance UE stores the chosen ciphering algorithm together with the Ranging Service Code.\nSteps 1b-3b refer to the Discovery Key Request procedure of Reference UE/Target UE. In this solution, UE1 and UE2 refer to Reference UE and Target UE.\n1b. UE1/UE2 sends a Discovery Request message containing its UE ID, its PC5 UE security capability, the role of Ranging/SL Positioning service, and Ranging Service Code to its 5G DDNMF/PKMF in order to get the associated code security parameters.\n2b.\tThe 5G DDNMF/PKMF sends an authorization request to the Ranging Application Server.\n3b.\tIf the Discovery Request is authorized and the PC5 UE security capability in step 1b includes the chosen ciphering algorithm, the 5G DDNMF/PKMF responds with the Discovery Response message including the corresponding code security parameters and the chosen ciphering algorithm (based on the information/keys stored in step 3a). UE1/UE2 stores the code security parameters, the chosen ciphering algorithm together with the Ranging Service Code.\nSteps 4-14 refer to the integrated Ranging/SL Positioning discovery and link establishment procedure for V2X capable UEs over PC5 reference point.\n4.\tUE1 wants to initiate the Ranging/SL Positioning measurement with UE2 via an Assistance UE. Then UE1 broadcasts Direct Communication Request containing UE1 ID and UE2 ID, Ranging Service Code, long term credential ID, nonce 1 and its security capabilities. The message will be received by the Assistance UE-1, Assistance UE-2. The UE1 ID and UE2 ID are protected by the code security parameters.\nNOTE:\tThe long term credential and long term credential ID could be pre-configured on the V2X capable UE (incl. Reference UE, Target UE, Assistance UE) or provisioned by the network e.g. during Service Authorization and Provisioning procedure.\n5.\tThe Assistance UE-1 and Assistance UE-2 receive the DCR message and check the Ranging Service Code. If they are authorized to provide the Ranging/SL Positioning service, then broadcast a new Direct Communication Request message. The new Direct Communication Request message may include UE1 ID, UE2 ID and Assistance UE ID, long term credential ID, nonce 1' and its security capabilities. The UE1 ID, UE2 ID and Assistance UE ID are protected by the code security parameters.\n6. \tUE2 receives the Direct Communication Requests from the Assistance UE-1 and Assistance UE-2. UE2 verifies the DCR message by using the code security parameters and choose one Assistance UE (e.g. Assistance UE-2). UE2 may initiate a Direct Auth and Key Establish procedure with the Assistance UE-2 to generate the KNRP.\n7. \tUE2 derives the session key (KNRP-SESS) from KNRP and then derive the confidentiality key (NRPEK) (if applicable) and integrity key (NRPIK). UE2 sends a Direct Security Mode Command message to the Assistance UE-2. This message includes the chosen PC5 security algorithm, nonce 2', and is protected as specified in TS 33.536 [5].\n8. \tThe Assistance UE-2 responds with a Direct Security Mode Complete message to UE2 as specified in TS 33.536 [5].\n9. \tOnce receiving the Direct Security Mode Complete message from the Assistance UE-2, UE2 sends the Direct Communication Accept message.\n10. The Assistance UE-2 may initiate a Direct Auth and Key Establish procedure with UE1 to generate the KNRP'.\n11. The Assistance UE-2 derives the session key (KNRP-SESS') from KNRP' and then derives the confidentiality key (NRPEK') (if applicable) and integrity key (NRPIK'). The Assistance UE-2 sends a Direct Security Mode Command message to UE1. This message includes the chosen PC5 security algorithm, the nonce 2, and is protected as specified in TS 33.536 [5].\n12. UE1 responds with a Direct Security Mode Complete message.\n13. The Assistance UE-2 sends the Direct Communication Accept message.\n14. The secure PC5 link between UE1 and UE2 via the Assistance UE-2 is established. UE1 and UE2 can perform the Ranging/SL Positioning measurement procedure with the support of Assistance UE-2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.3\tEvaluation",
                            "text_content": "The solution fulfils the security requirements of Key issue #1: Privacy protection for Ranging/SL Positioning services, Key Issue #3: Protection of discovery procedure and Key Issue #4: Protection of unicast direct communication.\nThe solution addresses how the V2X-capable Ranging UEs discover and establish the PC5 link. To secure the link establishment, the security materials (i.e. the long term credentials) are used. By reusing the direct security establishment procedure specified in TS 33.536 [5], the peer Ranging UEs can authenticate each other and protect the Ranging/SL Positioning information.\nIn this solution, the V2X-capable Ranging UEs use the discovery security materials associated with Ranging Service Code to protect the privacy information in DCR messages. The provisioning of discovery security materials reuses the discovery request procedure defined in clause 6.1.3.2 of TS 33.503 [6].\nThe V2X capable UEs may not have a secure connection with the 5G DDNMF to get the security materials.\nThe Ranging Service Code can be seen as the Ranging/SL Positioning Application Identifier specified in TS 23.586 [11].\nNOTE:\tWhich identifier is used in the Ranging/SL Positioning needs to be coordinated with stage 2 work.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.10\tSolution #10: Use of authorization tokens after PC5 security establishment",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.10.1\tIntroduction",
                            "text_content": "This solution addresses Key issue #2: Authorization for Ranging/Sidelink Positioning Service. This solution addresses the authorization of the UE acting as a Target UE/Located UE in the Ranging/Sidelink Positioning service.\nThis solution proposes that the UE's exchange authorization tokens after PC5 link establishment.\nIn the Ranging/Sidelink Positioning service, a Target UE could be out of 3GPP coverage via Uu interface and needs assistance from another UE e.g. a Located UE which is in 3GPP coverage via Uu interface or a Target UE could be in 3GPP coverage via Uu interface but needs assistance from another UE which is out of 3GPP coverage.\nThis solution provides a mechanism for the 5G Ranging/SL positioning system to be able to support the authorization of a UE using a specific Ranging/Sidelink Positioning service or a UE acting as a Target UE or a Located UE.\nThis solution assumes long term credentials are provisioned into the UE(s) and form the root of the security of the PC5 unicast link as specified in TS 33.536 [9].\nThis solution proposes to use authorization tokens as in OAuth 2.0.\nWhen the UE registers in the 3GPP network then the PCF provides the authorization policy to the UE indicating whether the UE is authorized to act as a Target UE/Located UE.\nThe network may also provide a token stating what kind of Ranging/Sidelink Positioning service the UE can use. The token has an expiration time (i.e. a corresponding lifetime) and is signed with a private key. The network also provides the public key to the UEs to be used for verifying the token from other UE's.\nIf the token needs to be revoked due to its lifetime has expired, then the UE needs to connect to the 3GPP network via Uu interface in order to retrieve a new public key from the network.\nNOTE 1: Which network function provides authorization token and how the UEs get the public key of token signing entity is not addressed in the present document.\nNOTE 2: For the token verification, why public key is required is not addressed in the present document.\nNOTE 3: The necessity for the role authorization is not addressed in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.2\tSolution details",
                            "text_content": "Figure 6.10.2-1 illustrates the high-level procedure of the proposed solution.\nThe signalling flow describes the use case when the Target UE is in 3GPP coverage via Uu interface and Located UE is out of 3GPP coverage.\nThe same signalling flow applies also to the use case when the Located UE is in 3GPP coverage via Uu interface and Target UE is out of 3GPP coverage. The Located UE would take the role as Target UE and the Target UE would take the role as the Located UE in this case in the solution below.\nThe figure depicts a high-level procedure of authorization tokens exchange between a Located UE and a Target UE after PC5 security establishment in a 5G network. It illustrates the steps involved in ensuring secure communication between the two devices, including the exchange of authorization tokens, which are essential for data encryption and authentication.\nFigure 6.10.2-1: High-level procedure of exchange of authorization tokens between Located UE and Target UE after PC5 security establishment\n0. \tThe Target UE and the Located UE are provisioned with the discovery security materials and request authorization tokens when they are in 3GPP coverage.\n1.\tThe direct discovery procedure is performed by the Target UE in order to discover the Located UE using the discovery parameters and discovery security material, based on the Relay Service Code for the Ranging service.\n2.\tIf discovery result indicates the Located UE supports the Ranging service, the Target UE sends a Direct Communication Request (DCR) that contains the Relay Service Code (RSC) of the Ranging service which is retrieved from step 0, and also the Key_Est_Info used for direct authentication and key establishment. Protection of RSC in DCR can be done in a similar way as described in TS33.503 [6].\n3.\tDirect Auth and Key Establish procedure as specified in TS 33.536 [9] is performed.\n4. \tThe Located UE derives KNRP and other security material as specified in TS 33.536 [9]. The Located UE sends a Direct Security Mode Command message to the Target UE.\n5.\tThe Target UE sends the Direct Security Mode Complete message to the Located UE.\n6. \tThe Located UE send the Direct Security Mode Accept to the Target UE.\n7. \tThe Target UE and the Located UE exchange the authorization tokens in separate signaling messages.\n7a. \tThe Target UE uses the public key provided by the network to verify the token of the Located UE e.g. whether Located UE is allowed to use the Ranging service and/or whether it's allowed to act as a Located UE etc.\n7a. \tThe Located UE uses the public key provided by the network to verify the token of the Target UE e.g. whether Target UE is allowed to use the Ranging service and/or whether it's allowed to act as a Target UE etc.\n8.\tThe Target UE and the Located releases the PC5 link if the verification of the authorization tokens fails.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.3\tEvaluation",
                            "text_content": "None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.11\tSolution #11: Client UE authorization for service exposure through sidelink",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.11.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #2 on authorization for Ranging/Sidelink Positioning Service. Specifically, it addresses the fourth requirement in KI#2: \"The 5G Ranging/SL positioning system shall be able to support the authorization of a SL Positioning Client UE for triggering Ranging/Sidelink Positioning services and obtaining the location information\".\nIn clause 8.6 of TR 23.700-86 [2], it is concluded that SL Positioning Client UE can invoke Ranging/SL positioning service to be performed between two other UEs. For accessing Ranging/SL positioning service and obtaining the Ranging/SL positioning result of other UEs, SL Positioning Client UE needs to be authorized, so as to avoid privacy violation of the involved UEs and charging invalidation. Authorization of SL Positioning Client UE needs to be performed at different levels:\n-\tThe first level of authorization is for service access, i.e. SL Positioning Client UE should be authorized to request Ranging/SL positioning service. This level of authorization could be achieved with the existing authorization method during direct discovery and communication establishment as defined in TS 33.503 [6].\n-\tThe second level of authorization is for preserving UE privacy. This is because, even if SL Positioning Client UE is authorized to request Ranging/SL positioning service, it does not mean that Ranging/SL positioning result of a pair of any UEs can always be exposed to SL Positioning Client UE. For example, it is possible that SL Positioning Client UE is allowed to request ranging result between UE1 and UE2, but may not be allowed to request ranging result between UE3 and UE4. Without further check on the authorization info of the involved UEs, there is still the risk that ranging result between specific UEs could be exposed to unauthorized SL Positioning Client UE. Therefore, SL Positioning Client UE needs to be further authorized on whether it is allowed to obtain ranging result of the involved UEs.\nAlso as per clause 8.6 of TR 23.700-86 [2], the Ranging/SL positioning service can be exposed to a SL Positioning Client UE either through sidelink or through 5GC network. This solution introduces a method of finer level of authorization for preserving UE privacy before SL Positioning Client UE requests to obtain ranging result between two specific UEs through sidelink.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.2\tSolution details",
                            "text_content": "As per TR 23.700-86 [2], SL Positioning Client UE may not support Ranging/SL positioning operation, but is able to establish PC5 direct communicate with the Reference/Target UE which sends ranging results to the SL Positioning Client UE. During the establishment of direct communication, to prevent the SL Positioning Client UE from requesting ranging results of the UEs it is not allowed to have, the Reference/Target UE should be able to authorize the SL Positioning Client UE based on the information of the involved UEs sent by the SL Positioning Client UE in the Direct Communication Request.\nAs the Reference/Target UE itself may lack the information required to authorize the SL Positioning Client UE, it needs the support from the network for the authorization. The network function which is able to support the authorization could be the network function provisioning the information of Ranging/SL positioning exposure to the UE during Service Authorization and Information Provisioning procedure. Based on the authorization result provided by the network, the Reference/Target UE then determines whether to proceed with security establishment for the PC5 connection or not.\nThe figure depicts a scenario where a SL Positioning Client UE (UE) is authorized to establish a direct link with a base station (BS) during the authorization process. The figure shows the UE's position relative to the BS, the distance between them, and the signal strength. The figure also includes a dashed line indicating the path of the signal, which is essential for the direct link establishment process.\nFigure 6.11.2-1: Authorization of SL Positioning Client UE during Direct Link Establishment\n1.\tSL Positioning Client UE and one of the involved UEs (UE1) discover each other using Model B discovery.\n2.\tSL Positioning Client UE performs direct PC5 link establishment procedure with UE1 by sending the Direct Communication Request (DCR) message. The message contains at least the Source info (Client UE info), the Destination info (UE1 info), the Service info (Ranging Service Code), as well as the target UE info (UE2 info) of which the Client UE intends to request the ranging result.\n3.\tUpon receiving the DCR message from the SL Positioning Client UE, UE1 sends an Authorization Request message to its PKMF/PCF. The message contains at least the Client UE info, the involved UE info (UE1/UE2 info) and the Ranging Service Code.\nNOTE: \tUE1 (the UE that the SL Positioning Client UE communicates with) needs to be in network coverage.\n4.\tBased on the information in the received request, the PKMF/PCF of UE1 sends the Authorization Request message to the PKMF/PCF of the Client UE, which authorizes whether the Client UE is allowed to request ranging result of UE1/UE2 based on its local information. Or the PKMF/PCF of the Client UE further interacts with the Ranging/SL positioning server for authorizing the Client UE. Or the PKMF/PCF of UE1 sends the Authorization Request message directly to the Ranging/SL positioning server for authorizing whether the Client UE is allowed to request ranging result of UE1/UE2. The message contains at least the Client info, the involved UE info (UE1/UE2 info) and the Ranging Service Code. The Ranging/SL positioning server then returns the authorization result to the PKMF/PCF of the UE1 directly or via the PKMF/PCF of the Client UE.\n5.\tThe PKMF/PCF of UE1 returns the authorization result to UE1.\n6a.\tIf the authorization is successful, UE1 performs a Direct Auth & Key Establish procedure with the SL Positioning Client UE. Then UE1 proceeds to step #7.\n6b.\tIf the authorization fails, the UE1 sends a Direct Communication Reject message to the SL Positioning Client UE, which may contain the failure cause. Then the following steps are not performed.\n7.\tUE1 sends Direct Security Mode Command message to the SL Positioning Client UE for establishing PC5 security context.\n8.\tUpon receiving Direct Security Mode Command, the SL Positioning Client UE responds Direct Security Mode Complete message to UE1.\n9.\tUpon receiving Direct Security Mode Complete, UE1 starts to perform the Ranging/SL positioning procedure with the involved UEs (UE1/UE2) respectively.\n10.\tUE1 calculates the ranging result between the involved UEs and responds to the SL Positioning Client UE with Direct Communication Accept message, which contains the ranging result between the involved UEs (UE1/UE2).\nIf the SL Positioning Client UE is Ranging/SL Positioning capable, and if the Ranging/SL Positioning layer is above ProSe/V2X layer (pending on the conclusion in TR 23.700-86 [2]), it is proposed to authorize SL Positioning Client UE after PC5 link establishment, so that the existing PC5 direct communication procedure defined for ProSe/V2X layer will not be impacted. That means the authorization of SL Positioning Client UE is performed during the control operation procedures via SR5 interface over the established PC5 link and probably using RSPP/SLPP protocol.\nThe figure depicts the authorization process of a Positioning Client UE (UE) after direct link establishment in a 5G network. It shows the UE's position after the direct link is established, and the authorization process is initiated. The figure includes the UE's position, the direct link establishment, and the authorization process.\nFigure 6.11.2-2: Authorization of SL Positioning Client UE after Direct Link Establishment\n1.\tSL Positioning Client UE and one of the involved UEs (UE1) discover each other using Model B discovery.\n2.\tSL Positioning Client UE and UE1 establish a PC5 link, which is protected using the PC5 direct communication security mechanism defined in TS 33.503 [6].\n3.\tTo invoke the Ranging/SL positioning between UE1 and UE2, the SL Positioning Client UE sends a ranging service request to UE1 on SR5 interface (e.g. using RSPP protocol) to request ranging result between UE1 and UE2. The SR5 message may include the SL Positioning Client UE info and the involved UE (UE1/UE2) info.\n4.\tUE1 sends an Authorization Request message to its PKMF/PCF. The message contains at least the SL Positioning Client UE info, UE1/UE2 info and the Ranging Service Code.\n5a.\tBased on the information in the received request, the PKMF/PCF of UE1 sends the Authorization Request message to the PKMF/PCF of the Client UE. The PKMF/PCF of the Client UE authorizes whether the Client UE is allowed to request ranging result of UE1/UE2 based on its local information, or the PKMF/PCF of the Client UE further interacts with the Ranging/SL positioning server for authorizing the Client UE. The message contains at least the Client UE info, the involved UE info (UE1/UE2 info) and the Ranging Service Code.\n5b.\tBased on the information in the received request, the PKMF/PCF of UE1 sends an Authorization Request message to the Ranging/SL positioning server to authorize whether the Client UE is allowed to request ranging result of UE1/UE2. The message contains at least the Client UE info, the involved UE info (UE1/UE2 info) and the Ranging Service Code.\n6a.\tThe PKMF/PCF of the Client UE returns the authorization result to the PKMF/PCF of UE1, or the Ranging/SL positioning server returns the authorization result to the PKMF/PCF of UE1 via the PKMF/PCF of the Client UE.\n6b.\tThe Ranging/SL positioning server returns the authorization result to the PKMF/PCF of UE1.\n7.\tThe PKMF/PCF of UE1 returns the authorization result to UE1.\n8a.\tIf the authorization is successful, UE1 starts to perform the Ranging/SL positioning procedure with UE2. Then UE1 proceeds to step #9.\n8b.\tIf the authorization fails, UE1 does not perform ranging with UE2 but responds to the SL Positioning Client UE with the Ranging service response, which may contain the failure cause. Then the following steps are not performed.\n9.\tUE1 calculates the ranging result between the involved UEs and responds to the SL Positioning Client UE with the Ranging service response. The ranging service response includes the ranging result between the involved UEs (UE1/UE2).\nThough SL Positioning Client UE may not support Ranging/SL positioning operation, it still needs to perform direct discovery procedure to discover one of the UEs (Reference/Target UE) performing Ranging/SL positioning operations. If the SL Positioning Client UE already knows the specific UEs from which it expects to obtain the ranging result when performing discovery procedure with the network, it is then able to send the information of the specific UEs to the network, which then could help to authorize the SL Positioning Client UE based on the UE information. Only after the SL Positioning Client UE is successfully authorized (service access authorization + UE privacy authorization), the network will provision the discovery security materials to the SL Positioning Client UE. In this way, the SL Positioning Client UE not allowed to acquire the Ranging result of the expected UEs will not be able to discover the UEs without getting the required discovery security materials.\nThe figure depicts the authorization process of a Positioning Client UE (UE) during the discovery phase of a 5G network. It shows the UE's position and the authorization status of the Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Positioning Position\nFigure 6.11.2-3: Authorization of SL Positioning Client UE during Discovery\n1.\tUE1 sends a Discovery Request message to its PKMF/DDNMF/PCF. The message includes at least the Ranging service code for which the discovery is performed.\n2.\tThe PKMF/DDNMF/PCF of UE1 checks with the Ranging/SL Positioning Server whether UE1 is authorized to use Ranging/SL Positioning service.\n3.\tThe PKMF/DDNMF/PCF of UE1 generates the discovery security materials for UE1 according to TS 33.503 [6] by associating the discovery keys with the Ranging service code.\n4.\tThe PKMF/DDNMF/PCF of UE1 responds to UE1 with discovery security materials.\n5~7.\tUE2 requesting the same Ranging service (with the same Ranging service code) performs the same procedure as UE1 and obtains the discovery security materials associated with the Ranging service code from the PKMF/DDNMF/PCF of UE1.\n8.\tThe Client UE sends a Discovery Request message to its PKMF/DDNMF/PCF. The message includes at least the Ranging service code for which the discovery is performed. If the Client UE already knows the specific UEs of which the Ranging result is requested, the message also contains the list of the UEs, e.g. UE1/UE2.\n9.\tThe PKMF/DDNMF/PCF of the Client UE first checks with the Ranging/SL Positioning Server whether the Client UE is authorized to use Ranging/SL Positioning service against the Ranging service code (i.e. service access authorization). Then it checks whether the Client UE is authorized to request the Ranging result of the specific UEs against the list of the UEs (i.e. UE privacy authorization).\n10a.\tIf the authorization succeeds, the PKMF/DDNMF/PCF of the Client UE sends a Discovery Request to the PKMF/DDNMF/PCF of one of the listed UE (UE1). The request contains at least the Ranging service code, the Client UE info and the list of the UEs.\n10b.\tIf the authorization fails, the PKMF/DDNMF/PCF of the Client UE returns a Discovery Response to the Client UE with a failure cause.\n11.\tThe PKMF/DDNMF/PCF of UE1 may also contact the Ranging/SL Positioning Server to check whether the Client UE is authorized to request Ranging result of the UEs. The check is performed against the Client UE info and the list of the UEs.\n12a.\tIf the check with Ranging/SL Positioning Server succeeds, the PKMF/DDNMF/PCF of UE1 responds to the PKMF/DDNMF/PCF of the Client UE with the discovery security materials.\n12b.\tIf the check with Ranging/SL Positioning Server fails, the PKMF/DDNMF/PCF of UE1 responds to the PKMF/DDNMF/PCF of the Client UE with a failure cause.\n13.\tThe PKMF/DDNMF/PCF of the Client UE provides the discovery security materials to the Client UE.\n14.\tUE1 starts to broadcast announcement messages protected by the discovery security materials. The announcement message includes at least the UE1 info, Ranging service code, etc.\n15.\tThe Client UE and UE2 start to monitor announcement messages broadcast by neighbouring UEs (UE1), and respond to UE1 after verifying the announcement message with the discovery security materials.\n16.\tThe UEs successfully discover each other.\n17.\tDirect link is set up between UE1 and the Client UE.\n18.\tThe Client UE sends a ranging service request to UE1, requesting Ranging estimation between UE1 and UE2.\n19.\tUE1 performs the ranging and positioning procedure with UE2.\n20.\tUE1 calculates the Ranging result of UE1/UE2.\n21.\tUE1 returns to the Client UE the ranging result of UE1/UE2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.3\tEvaluation",
                            "text_content": "This solution fulfils the fourth requirement in KI#2. It also addresses NOTE 1 in clause 8.6 of TR 23.700-86 [2].\nAuthorization through the network during discovery is already supported by the relevant 5GC NFs.\nAuthorization through the network during link establishment or during Ranging/SL positioning operations is a new requirement on the UE, but it has no impact on the procedures of link establishment and Ranging/SL positioning per se. The UE only needs to determine when to request authorization from the network in between the procedure.\nThe detailed check for per UE authorization is done by the Ranging/SL Positioning server. The UE and the relevant 5GC NFs only need to send the info of all involved UEs (Client UE and to-be-measured UEs) to the Ranging/SL Positioning server.\nThe solution can accommodate different conditions with the three options:\n-\tIf the SL Positioning Client UE can already determine the to-be-measured UEs when initiating discovery, the authorization can be performed during discovery.\n-\tIf the SL Positioning Client UE cannot determine the to-be-measured UEs yet when initiating discovery, the authorization needs to be performed after discovery.\na)\tWith Client UE not Ranging/SL positioning capable, the authorization can only be performed during link establishment over PC5.\nb)\tWith Ranging/SL positioning capable Client UE, the authorization can be performed either during link establishment or during Ranging/SL positioning operations. On which stage the authorization should be performed for Ranging/SL positioning capable Client UE is to be determined during normative work.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.12\tSolution #12: Ranging/SL Positioning discovery security for 5G ProSe capable UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.12.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #3 on protection of discovery procedure as well as Key Issue #1 on privacy protection for Ranging/SL Positioning services.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.2\tSolution details",
                            "text_content": "As per clause 8.3 of TR 23.700-86 [2], it is concluded that, for Ranging/Sidelink Positioning device discovery between 5G ProSe capable UEs, 5G ProSe Direct Discovery procedures (including both Model A and Model B) defined in 6.3.1 of TS 23.304 [4] are used. Based on such conclusion, it is proposed in this solution that the following security mechanisms defined in clause 6.1.3.2 of TS 33.503 [6] are reused for Ranging/Sidelink Positioning device discovery between 5G ProSe capable UEs:\n-\tFor Ranging-based services provided by application providers, discovery security materials are provided by the 5G PKMF.-\tFor network assisted SL positioning services provided by operators, assuming the SL positioning service code (similar as RSC) is configured in or provisioned to the UE before discovery, then discovery security materials can be provided in the same way as for 5G ProSe UE-to-Network Relay discovery defined in TS 33.503 [6].\n-\tSecurity materials used by a sending UE to protect discovery messages are provided in the Code-Sending Security Parameters. Security materials used by a UE receiving discovery messages are provided in the Code-Receiving Security Parameters. The security parameters contain the keys for integrity protection, message-specific confidentiality and scrambling of discovery messages based on the configuration by network.-\tThe ciphering algorithm for discovery message confidentiality is configured by the network during discovery request procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.3\tEvaluation",
                            "text_content": "This solution fulfils all potential requirements in key issue #3 for discovery message protection and the first requirement in key issue #1, by reusing the security mechanism defined for restricted 5G ProSe Direct Discovery, hence has no new impact on the UE or the network.\nThe solution applies to both Ranging-based services provided by application providers and network assisted SL positioning services provided by operators.\nThe solution applies to 5G ProSe capable UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.13\tSolution #13: Security of Ranging unicast communication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.13.1\tIntroduction",
                            "text_content": "This solution addresses the protection of direct communication (unicast) for Ranging/SL Positioning service as specified in Key Issue #4. Generally, the solution uses the direct communication security defined for 5G ProSe in TS 33.503 [6] and/or for 5G V2X in TS 33.536 [5] as a baseline and adjusts to the Ranging/SL Positioning scenario.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.2\tSolution details",
                            "text_content": "In this solution, the Ranging/SL positioning capable UEs are provisioned with the list of Ranging/SL Positioning services, with Geographical Area(s) and their PC5 security policies. The definition of the PC5 security policies follows the definition in 5G eV2X in TS 33.536 [5] and/or in ProSe in TS 33.503 [6].\nDuring the establishment of the direct communication for the Ranging/SL positioning service, the UEs use the PC5 security policy to negotiate the final security protection status, as defined in 5G ProSe in TS 33.503 [6] and/or in 5G V2X in TS 33.536 [5]. The Ranging/SL Positioning signalling are protected based on the PC5 UP security policies.\nIf multiple V2X/ProSe services use the same PC5 unicast link, it needs to be checked whether the security in use for the PC5 unicast link satisfies the PC5 signalling and user plane security policies of the to-be added V2X/ProSe services, as specified in TS 33.536 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.3\tEvaluation",
                            "text_content": "This solution addresses the first three security requirements of Key Issue #4. The mutual authentication between two UEs during one-to-one communication is supported by reusing the PC5 security establishment procedure in 5G ProSe in TS 33.503 [6] and/or in 5G V2X in TS 33.536 [5]. If multiple V2X/ProSe services use the same PC5 unicast link, it needs to be checked whether the security in use for the PC5 unicast link satisfies the PC5 signalling and user plane security policies of the to-be-added V2X/ProSe services, as specified in TS 33.536 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.14\tSolution #14: Direct communication security for Ranging-based services",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.14.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #4 on protection of unicast direct communication and Key Issue #1 on privacy protection for Ranging/SL Positioning services.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.14.2\tSolution details",
                            "text_content": "As per clause 8.4 of TR 23.700-86 [2], it is concluded for control of Ranging/SL positioning operations that, Ranging/SL Positioning Protocol (RSPP) is introduced for SR5 over PC5 reference point between UEs. Though whether RSPP is over PC5-U or over PDCP is to be aligned with RAN WG decision, SA2 WG assumes that Ranging/SL Positioning signaling is carried between UEs over PC5-U, for which V2X communication procedures defined in TS 23.287 [3] and 5G ProSe Direct Communication procedures defined in TS 23.304 [4] are reused. Based on such conclusion, it is proposed in this solution that the following security mechanisms for V2X unicast mode communication defined in clause 5.3 of TS 33.536 [5] and for 5G ProSe unicast mode Direct Communication defined in clause 6.2 of TS 33.503 [6] are reused for unicast direct communication of Ranging-based services:\n-\tLong-term credentials are provisioned into the UE to form the root of security for PC5 unicast link. Long-term credentials can be preconfigured in the UE by Ranging application providers or provided by Ranging applications on the UE.\n-\tTriggered by the received Direct Communication Request (DCR) message, Direct Auth and Key Establishment procedure is performed for mutual authentication between the UEs, during which the key KNRP is derived using the long-term credentials. The authentication method is application specific and out of 3GPP scope.\n-\tDirect communication security is established between the UEs through Direct Security Mode Command procedure based on KNRP.\nNOTE 1:\tProcedure details can refer to steps 4~8 of solution #9 in clause 6.9.2.1.\n-\tIf RSPP signalling on SR5 reference point is carried over PC5-U, SR5 security policies are applied for PC5-U security activation.\nNOTE 2:\tProvision and configuration of SR5 security policies can refer to solution #7.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.14.3\tEvaluation",
                            "text_content": "This solution fulfils all potential requirements in key issue #4 for protection of unicast direct communication, by reusing the security mechanisms defined for V2X unicast mode communication in TS 33.536 [5] and for 5G ProSe unicast mode Direct Communication in TS 33.503 [6]. Hence the solution has no new impact on the UE and the network.\nAs confidentiality protection is provided by the reused security mechanism, the solution also fulfils the second requirement in key issue #1 for privacy protection during communication.\nThe solution applies to Ranging-based services provided by application providers.\nThe solution applies to both V2X capable UEs and 5G ProSe capable UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.15\tSolution #15: Protection of information over group communication for Ranging/SL Positioning service",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.15.1\tIntroduction",
                            "text_content": "This solution addresses the Key Issue #1 (second requirement) and #5.\nThis solution provides a security mechanism in SLPP layer to protect the information exchanged between UEs using group communication. The mechanism proposes to provision security materials to the UEs which belong to a particular group for a SL positioning service. By using the provisioned security materials, a UE in the group can send confidentiality and integrity protected messages that include information related to the SL positioning service, and other UEs in the same group can undo the protection of the received messages. Note that this solution supports both in-coverage and out-of-coverage UEs by provisioning multiple sets of security materials associated with different expiry times.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.15.2\tSolution details",
                            "text_content": "The figure depicts a security flow for Sidelink Positioning, a one-to-many communication system. It illustrates the flow of data between the sender and receiver, with the sender sending a message to the receiver, and the receiver receiving the message. The flow includes a security mechanism to ensure data integrity and confidentiality.\nFigure 6.15.2.1-1: Security flows for Sidelink Positioning one-to-many communication\n0a and 0b. The UE is provided with the Ranging/SL positioning application identifier during the parameters/policy provisioning for Ranging/SL positioning service as specified in clause 5.1 of TS 23.586 [11].\nNOTE 1: The SLPP one-to-many communication can use either broadcast or groupcast at the AS layer.\nNOTE 2: For ProSe UEs, the Ranging/SL positioning application identifier is the ProSe identifier as per TS 23.586 [11].\nNOTE 3: For V2X UEs, the Ranging/SL positioning application identifier is the V2X service type as per TS 23.586 [11].\nNOTE 4: Whether to include group ID and group member ID in the SLPP message will be decided during normative work.\nNOTE: whether V2X UEs can support the same procedure would be determined in stage 2 work.\nSteps 1 – 3 refer to a sending UE.\n1a.\tThe UE establishes a secure connection with the Sidelink Positioning Key Management Function (SLPKMF) based on the security procedures specified in clause 5.2.5 of TS 33.503 [6]. The UE sends a Key Request message to Sidelink Positioning Key Management Function (SLPKMF) including the Ranging /SL positioning application identifier.\n1b.\tThe SLPKMF replies with the Key Response message containing the Sidelink Positioning Group Key (SLPGK), the key ID (SLPGK ID), the validity time, and the chosen ciphering and integrity algorithms. In addition, the Key Response message can include multiple SLPGK and SLPGK ID pairs with different validity times. Group member ID can be either assigned by the SLPKMF or generated at the UE. In the former case, the Group member ID is included in the Key Response message. In the latter case, the UE generates a Group member ID randomly so that it is uniquely identified in a group.\nNOTE 5: \tIn case the SLPLMF of a receiving UE is different from the SLPKMF of a sending UE, the provisioning of security materials as specified in clause 6. 1.3.2 in TS 33.503 [6] is reused.\nNOTE 6: \tGroup refers to the Ranging/SL positioning service. Accordingly, Group ID refers to the Ranging/SL positioning application identifier and Group member ID refers to the identifier of the UE that is authorized to receive the Ranging/SL positioning service.\nNOTE 7: \tThe length of a Group member ID will be determined during the normative work. When the Group member ID is randomly generated by the UE, its length should be long enough to avoid collision.\nNOTE 8: Whether group member ID is provisioned by the network or self-selected will be decided during normative work.\n2.\tUpon receiving the Key Request message, the UE derives the Sidelink Positioning Traffic Key (SLPTK) from SLPGK using Group ID, Group member ID, and SLPTK ID. SLPTK ID is a counter set to a unique value in the sending UE that has not been previously used together with the same SLPGK and the associated SLPGK ID. The UE further calculates the Sidelink Positioning Encryption Key (SLPEK) and Sidelink Positioning Integrity Key (SLPIK) from SLPTK using the chosen algorithm IDs, respectively.\n3.\tThe UE protects the messages as described in clause 6.15.2.2.1, and sends the messages to the group.\nSteps 4 – 5 refer to receiving UEs.\n4.\tThe UE performs a Key Request procedure to get security materials from the SLPKMF. This step is same as the step 1.\n5.\tUpon receiving the message from sending UE in the group, the UE calculates SLPTK, SLPEK and SLPIK. The derivation of security keys is same as the step 3 except that the UE takes Group ID, SLPGK ID, SLPTK ID and Group member ID (if it is included) in the received message as input parameters for key derivation. Then, the UE unprotects the message and verifies the integrity of the message as described in clause 6.15.2.2.2.\nThe UE sending a message to the group does the following steps:\n1.\tForm message header that contains Group ID, Group member ID, SLPGK ID, SLPTK ID, and Counter. Then, append the Payload to it as illustrated in figure 6.15.2.2.1-1.\n2.\tIf the network configuration is to use integrity protection, calculate MAC of the message header and the Payload based on the chosen integrity algorithm. The integrity algorithms specified in Annex D in TS 33.501 [8] are used to calculate MAC. If the network configuration is not to use integrity protection, then the sending UE shall set the MAC to all zeroes or a random number in the message header.\nNOTE 2: \tSetting the MAC to all zeroes is less preferred.\n3.\tIf the network configuration is to use confidentiality protection, add confidentiality to the Payload and MAC based on the chosen ciphering algorithm. The ciphering algorithms specified in Annex D in TS 33.501 [8] are used for the confidentiality protection.\nNOTE 2: \tthe details of input parameters to the integrity algorithms and ciphering algorithms will be specified in normative work.\nThe figure depicts a message format for Sidelink Positioning group communication (SPGC) in a 5G network. It illustrates the structure of the message, including the header, payload, and optional data. The format is designed to be efficient and reliable, with a focus on minimizing the number of messages and ensuring data integrity. The figure also includes a visual representation of the SLPP message structure, which helps to understand the data flow and communication patterns in the network.\nFigure 6.15.2.2.1-1: SLPP message format for Sidelink Positioning group communication\nNOTE: privacy for the Group ID and Group member ID is not addressed in the present document.\nThe UE receiving a message does the following steps:\n1.\tIf the network configuration is to use confidentiality protection, undo confidentiality protection based on the chosen ciphering algorithm.\n2.\tIf the network configuration is to use integrity protection, verify the integrity of the received message by checking MAC based on the chosen integrity algorithm.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.15.3\tEvaluation",
                            "text_content": "This solution addresses the second security requirement in Key Issue #1 (privacy protection during communication for Ranging/SL positioning) and all the security requirements in Key Issue #5 (Confidentiality, integrity, and replay protection of SLPP signaling over groupcast and broadcast).\nThis solution supports both in-coverage and out-of-coverage UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.16\tSolution #16: Privacy protection of Located UE during its discovery and selection",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.16.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #1 on Privacy protection for Ranging/SL Positioning services.\nIn clause 5.2.2 of TS 23.586 [11], it is specified that a Target UE may discover and select one or more Located UEs to be used in the Ranging/SL positioning procedures to facilitate the accurate positioning of the Target UE. However, if the Target UE discovers and selects a Located UE which does not allow the exposure of its location information, the privacy of the Located UE is then violated. This solution introduces a method to preserve the privacy of the Located UE when it is being discovered and selected by the Target UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.16.2\tSolution details",
                            "text_content": "According to clause 5.2.2 of TS 23.586 [11], for network assisted Ranging/SL positioning, the Target UE shall discover and select a Located UE that is in the same serving PLMN of the Target UE, and privacy aspects of exposing and sharing the location of the Located UE (e.g. to any Target UE) during discovery needs to be considered. Based on such specification, the privacy requirement of the Located UE needs to be checked during discovery procedure before the Located UE is selected by the Target UE.\nThis solution proposes that, while the Located UE requests discovery keys from the network, the network needs to check the privacy requirements of the Located UE before providing discovery keys to the Located UE. The network function initiating the check of UE privacy could be the network function responsible for generating and provisioning discovery keys. The method of UE privacy profile check specified for LCS in TS 23.273 [9] can be reused.\nIf the Located UE is already preconfigured with the privacy verification information from either the network via e.g. service authorization and information provisioning procedure or from the application layer, the Located UE checks its locally available privacy profile to determine whether it is discoverable or not in terms of privacy.\nThe figure depicts a privacy check of the located UE during the discovery procedure, model A, which is a crucial step in the 5G network. It shows the UE's location and privacy status, ensuring that only authorized devices can access the network.\nFigure 6.16.2-1: Privacy Check of the Located UE during the Discovery Procedure – Model A\nAssuming the Located UE does not have locally available information to determine whether it is discoverable in terms of privacy:\n1.\tThe Located UE sends a Discovery Key Request to the DDNMF/PCF/PKMF, which includes at least the UE ID, SL positioning service code and the role the UE intends to play (i.e. Located UE).\n2.\tThe DDNMF/PCF/PKMF contacts the UDM to check whether the UE is authorized to act as a Located UE for the SL positioning service against its subscription information.\n3.\tIf the authorization is successful, the DDNMF/PCF/PKMF requests to retrieve UE privacy profile from the UDM via Nudm_SDM_Get request.\n4.\tThe UDM returns the privacy profile of the Located UE to the DDNMF/PCF/PKMF via Nudm_SDM_Get response.\n5.\tThe DDNMF/PCF/PKMF checks whether the Located UE allows its location information to be obtained by the network against the UE privacy profile.\n6.\tOptionally, the DDNMF/PCF/PKMF notifies the UE via the AMF for privacy verification by the user, based on the privacy verification procedure defined in TS 23.273 [9].\nNOTE 1:\tDetails on privacy profile additions for Ranging/SL positioning need to be determined in stage 2 work.\n7a.\tIf the privacy check is successful, the DDNMF/PCF/PKMF generates the discovery security materials for the UE and proceeds to step #8.\n7b.\tIf the privacy check fails, the DDNMF/PCF/PKMF returns a Discovery Key Response to the UE with a failure cause, and the Located UE aborts the discovery procedure.\nNOTE 1: LCS profile is supposed to be used by GMLC/NEF to check user authorization information to expose UE's location towards a 3rd party (e.g. LCS client, AF). In this case, Located UE itself can determine whether or not it wants to be discoverable.\nNOTE 2:\tIt is not addressed in the present document why the network needs to reject a discovery key request from the UE itself, who wants to be discoverable.\n8.\tThe DDNMF/PCF/PKMF returns a Discovery Key Response to the UE including the generated discovery security materials.\nNOTE 3:\tThere can be different levels of acceptable exposure for the located UE, e.g., some located UEs may accept sharing its location with the target UE, or some located UEs may only accept sharing its location with LMF. Thus, next to the discovery parameters, also a privacy policy may need to be configured in Target UE / Located UE. Details can be determined during normative work.\n9.\tIf model A is used for discovery, the Located UE starts to broadcast announcement message including its own UE info and the SL positioning service code. The message is protected using the received discovery security materials.\n10.\tThe Target UE monitors the broadcasted announcement messages. If the Located UE info in the announcement message matches the Located UE info provided by the LMF, the Target UE sends a Discovery Key Request to the DDNMF/PCF/PKMF, which includes at least the UE ID, SL positioning service code, the role the UE intends to play (i.e. Target UE) and the role of UE to discover (i.e. Located UE).\n11.\tThe DDNMF/PCF/PKMF interacts the UDM to authorize the role of the Target UE against its subscription information.\n12.\tThe DDNMF/PCF/PKMF returns a Discovery Key Response to the UE including the discovery security materials generated in step #7a.\n13.\tUpon receiving the discovery security materials, the Target UE is able to verify the received announcement message.\n14.\tThe Target UE selects the Located UE by sending a Direct Communication Request (DCR) to the Located UE.\n15. The Located UE returns a Direct Communication Accept (DCA) to the Target UE.\n16.\tThe rest of the SL positioning procedure is performed.\n17.\tUE1 obtains the SL positioning result and sends it to the Client UE via PC5 link.\nIf model B is used for discovery, the Target UE broadcasts a solicitation message which contains the Located UE info provided by the LMF. The Located UE monitors the broadcasted solicitation message to find whether the message contains the Location UE info matching its own UE info. If there is a match, the Located UE verifies the solicitation message and sends a response message. When receiving a response from a Located UE, the Target UE selects the Located UE by sending a DCR message.\nThe figure depicts a privacy check of the located UE during the discovery procedure in Model B, showing the UE's location and the presence of a nearby base station (BS). The figure illustrates the UE's signal strength and the distance from the BS, which is crucial for the discovery process.\nFigure 6.16.2-2: Privacy Check of the Located UE during the Discovery Procedure – Model B\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.16.3\tEvaluation",
                            "text_content": "This solution fulfils the first requirement in KI#1. It also addresses the Editor's Note in clause 5.2.2 of TS 23.586 [11].\nIf the Located UE does not have locally available information to determine whether it is discoverable or not in terms of privacy, the privacy check is triggered by the PCF/DDNMF/PKMF when receiving discovery (key) request, which then interacts with the UDM, in the same way as the GMLC using the mechanism defined in TS 23.273 [9]. Only after successful privacy check of the Located UE, the PCF/DDNMF/PKMF will then generate discovery security materials for the Located UE.\nHence the main impact of the solution is on the network function generating discovery security materials, and the solution has no impact on the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.17\tSolution #17: Client UE authorization for service exposure through 5GC network",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.17.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #2 on Authorization for Ranging/Sidelink Positioning Service. Specifically, it addresses the fourth requirement in KI#2: \"The 5G Ranging/SL positioning system shall be able to support the authorization of a SL Positioning Client UE for triggering Ranging/Sidelink Positioning services and obtaining the location information\". This solution also addresses Key Issue #1 on Privacy protection for Ranging/SL Positioning services.\nBased on the introduction in clause 6.11.1, this solution introduces a method of finer level of authorization for preserving UE privacy before SL Positioning Client UE requests to obtain ranging result between two specific UEs through 5GC network.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.2\tSolution details",
                            "text_content": "As per clause 5.6.2 of TS 23.586 [11], for Ranging/SL positioning service exposure to a SL Positioning Client UE through the network, the Client UE shall first send an enhanced MO-LR request to the AMF, which invokes the Ranging/SL positioning request to the GMLC. The GMLC reuses the procedure as defined (for service exposure to the AF) in clause 5.6.3 of TS 23.586 [11] and sends the Ranging/SL positioning result to the AMF, which returns the result to the SL Positioning Client UE.\nBased on the above procedure, it is proposed that the GMLC, which receives the Ranging/SL positioning request (containing Client UE info and the info of the to-be-measured UEs e.g. UE1/UE2), should initiate the authorization check of SL Positioning Client UE with the UDM, which has the Client UE's subscription data for Ranging/SL positioning service containing e.g. the information on the UEs (e.g. UE1/UE2) from which the Client UE is allowed to request Ranging result.\nAfter checking the Client UE's authorization information, the GMLC also needs to check whether the to-be-measured UEs (UE1/UE2) allow their positions to be exposed. Only after successful authorization check on the Client UE and privacy check on the to-be-measured UEs, the Ranging/SL positioning procedure will then be initiated by the GMLC.\nThe figure depicts a 5G network scenario where a Service Exposure Positioning Client (SL) UE is authorized to access the network. The authorization is based on the SL Positioning Client (SLPC) and is managed through the 5G Core Network (5GC). The figure illustrates the authorization process, including the authorization request, authorization response, and the authorization status. The authorization is managed through the 5GC, ensuring that only authorized devices can access the network.\nFigure 6.17.2-1: Authorization of SL Positioning Client UE for Service Exposure through 5GC Network\n1.\tThe Client UE triggers Ranging/SL Positioning Service by establishing a signalling connection with the AMF.\n2.\tThe UE sends an MO-LR Request message to the AMF included in a UL NAS TRANSPORT message. The MO-LR Request includes at least the info of Client UE and the to-be-measured UEs (UE1/UE2).\n3.\tThe AMF sends a Ranging/SL Positioning Request to the GMLC which also includes the info of Client UE and UE1/UE2.\n4.\tThe GMLC sends an Authorization Request to the UDM with the info of Client UE and UE1/UE2.\n5.\tThe UDM checks whether the Client UE is allowed to obtain the ranging/SL positioning information against the Client UE's subscription data for SL positioning service, which could also contain the information on the to-be-measured UEs (UE1/UE2), from which the Client UE is allowed to request positions.\nNOTE 1:\tThe relevant subscription data could be configured offline in the UDM, or provided and updated in the UDM based on the requests from the AF offering Ranging/SL positioning services.\n6.\tThe UDM returns the authorization result to the GMLC.\n7a~9a.\tIf the authorization succeeds, the GMLC further checks whether UE1 and UE2 allow their location related information to be exposed, against the UE privacy profile in their subscription data.\nNOTE 2:\tThese steps can refer to solution #3 in clause 6.3.\n7b/9b.\tIf the authorization fails, the GMLC returns a Ranging/SL positioning response to the AMF with a failure cause.\n10.\tFollowing step 9a, the rest of Ranging/SL positioning procedure is performed between the GMLC, AMF, LMF and UE1/UE2.\n11.\tThe GMLC sends the UE1/UE2 ranging/SL positioning result to the AMF.\n10.\tThe AMF sends the UE1/UE2 ranging/SL positioning result received from the GMLC to the Client UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.3\tEvaluation",
                            "text_content": "This solution fulfils the fourth requirement in KI#2. It also addresses the Editor's Note in clause 5.6.2.3 of TS 23.586 [11].\nThe authorization is triggered by the GMLC when receiving Ranging/SL positioning request, which then interacts with the UDM for checking UE subscription. The privacy check is also performed by the GMLC by reusing the mechanism defined in TS 23.273 [9].\nThe solution has no impact on the UE.\nIn MO-LR procedure defined in TS 23.273, it is specified that \"The AMF verifies the subscription profile of the UE and decides if the requested service is allowed or not by checking the Mobile Originated data retrieved from UDM\", i.e. AMF is responsible for MO-LR authorization and retrieve subscription for MO-LR from UDM for UE authorization. Authorizing the MO-LR request from Client UE could be done similarly by AMF in step 2, instead of step 5 and 6. It is unclear whether the additional procedure performed by GMLC in this solution is aligned with existing SA2 baseline.\nAlso, configuring UDM with subscription data of the to-be-measured UEs (UE1/UE2), regarding authorization information about from which individual (Client)UEs are allowed to request positions of the to-be-measured UEs, is to be determined by SA2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.18\tSolution #18: Client UE authorization by 5GC for service exposure through PC5",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.18.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #2 on Authorization for Ranging/Sidelink Positioning Service. Specifically, it addresses the fourth requirement in KI#2: \"The 5G Ranging/SL positioning system shall be able to support the authorization of a SL Positioning Client UE for triggering Ranging/Sidelink Positioning services and obtaining the location information\". This solution also addresses Key Issue #1 on Privacy protection for Ranging/SL Positioning services.\nBased on the introduction in clause 6.11.1, this solution introduces another method of finer level of authorization for preserving UE privacy before SL Positioning Client UE obtains ranging result between two UEs. Rather than relying on the Ranging server for authorizing the Client UE in solution #11, this solution relies on the core network to authorize the Client UE by checking the subscription information of the Client UE and the privacy setting of the to-be-measured UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.18.2\tSolution details",
                            "text_content": "As per clause 5.6.2.2 of TS 23.586 [11], for Ranging/SL positioning service exposure to a SL Positioning Client UE through PC5, the Client UE shall first discover one of to-be-measured UE, and then invokes the Ranging/SL Positioning service request to the discovered UE for obtaining the Ranging/SL positioning result of the to-be-measured UEs. The request includes the info of the Client UE and the to-be-measured UEs. The UE providing the exposure service triggers the authorization of the Client UE for service invocation/exposure, based on which returns the Ranging/SL positioning result to the Client UE.\nBased on the above procedure, it is proposed that the UE discovered by the Client UE should initiate the authorization check of the Client UE by sending an authorization request to the core network. The core network check with the UDM, which has the Client UE's subscription data for Ranging/SL positioning service containing e.g. the information on the UEs (e.g. UE1/UE2) from which the Client UE is allowed to request Ranging result.\nAfter checking the Client UE's authorization information, the GMLC also needs to check whether the to-be-measured UEs (UE1/UE2) allow their positions to be exposed. Only after successful authorization check on the Client UE and privacy check on the to-be-measured UEs, the UE discovered by the Client UE will then proceed the subsequent procedures.\nIf the Client UE is not Ranging/SL positioning capable, it can only request and obtain Ranging/SL positioning result using PC5 messages. So when the Client UE sends the Direct Communication Request to the discovered UE, the DCR should include the service code of the requested Ranging/SL positioning service and the info of the to-be-measured UEs. In this case, the discovered UE (UE1) can initiate the Client UE authorization once receiving the DCR from the Client UE.\nThe figure depicts a client UE (User Equipment) initiating a service exposure through PC5 (Physical Channel 5) during PC5 establishment. The authorization process is depicted, with the client UE being authorized to access the service.\nFigure 6.18.2-1: Authorization of the Client UE for Service Exposure through PC5 during PC5 Establishment\n1~2.\tThe Client and UE1 (one of the to-be-measured UEs) discover each other by broadcasting solicitation message, which includes at least the UE1 info and service code for the requested Ranging/SL positioning service, and response message respectively.\n3.\tUpon receiving the response message from UE1, the Client UE performs PC5 link establishment procedure with UE1 by sending the Direct Communication Request (DCR) message. The message contains at least the Source info (Client UE info), the Service info (SL Positioning Service Code), and the to-be-measured UE info (UE1/UE2 info).\n4.\tFor authorizing the Client UE, UE1 sends an Authorization Request message to the AMF via NAS signalling upon receiving the DCR message. The request contains at least the Client UE info, the to-be-measured UEs info (UE1/UE2 info), and the SL Positioning Service Code.\n5.\tThe AMF sends a Ranging/SL Positioning Authorization Request to the GMLC which also includes the info of Client UE and UE1/UE2.\n6.\tThe GMLC sends an Authorization Request to the UDM with the info of Client UE and UE1/UE2.\n7.\tThe UDM checks whether the Client UE is allowed to obtain the Ranging/SL positioning result against the Client UE's subscription data for SL positioning service, which could also contain the information on the to-be-measured UEs (UE1/UE2), from which the Client UE is allowed to request positions.\nNOTE 1:\tThe relevant subscription data could be configured offline in the UDM, or provided and updated in the UDM based on the requests from the AF offering Ranging/SL positioning services.\n8.\tThe UDM returns the authorization result to the GMLC.\n9a~10.\tIf the authorization succeeds, the GMLC further checks whether UE1 and UE2 allow their location related information to be exposed, against the UE privacy profile in their subscription info.\nNOTE 2:\tThese steps can refer to solution #3 in clause 6.3.\n11.\tThe GMLC returns an SL Positioning Authorization Response to the AMF.\n12.\tThe AMF forwards the authorization result to UE1 via NAS message.\n13a. \tIf the authorization is successful, UE1 performs a Direct Auth & Key Establish procedure with the Client UE. Then UE1 proceeds to step #14.\n13b. \tIf the authorization fails, UE1 sends a Direct Communication Reject message to the Client UE, which may contain the failure cause. Then the following steps do not need to be performed.\n14~17.\tThe rest of PC5 link establishment procedure and SL positioning procedure are performed.\nIf the Client UE is Ranging/SL positioning capable, the authorization check of the Client UE may also be performed by UE1 when receiving a Ranging/SL positioning request message from the Client UE on RSPP/SLPP layer over the established PC5 link.\nThe figure depicts a schematic representation of the authorization process for a Client UE (User Equipment) to access Service Exposure through PC5 during the Ranging/SL Positioning Procedure. The figure illustrates the steps involved in obtaining authorization, including the client's request, the authorization server's response, and the client's subsequent action. The figure is crucial for ensuring the security and integrity of the communication process.\nFigure 6.18.2-2: Authorization of the Client UE for Service Exposure through PC5 during Ranging/SL Positioning Procedure\nSteps 1~2 can refer to steps 1~2 in 6.18.2.1.\n3.\tPC5 link is securely established between the Client UE and UE1.\n4.\tThe Client UE sends a Ranging/SL positioning request to UE1 over RSPP/SLPP layer, which contains at least the Source info (Client UE info), the Service info (SL Positioning Service Code), as well as the to-be-measured UE info (UE1/UE2 info).\nSteps 5~13 can refer to steps 4~12 in 6.18.2.1.\n14~15.\tUpon successful authorization, UE1 performs the Ranging/SL positioning procedure with the other to-be-measured UE (i.e. UE2) and then returns the SL positioning result of UE1/UE2 to the Client UE over RSPP/SLPP layer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.18.3\tEvaluation",
                            "text_content": "This solution fulfils the fourth requirement in KI#2. It also addresses the Editor's Note in clause 5.6.2.2 of TS 23.586 [11].\nAuthorization through the network during link establishment or during Ranging/SL positioning operations is a new requirement on the UE, but it has no impact on the procedures of link establishment and Ranging/SL positioning per se. The UE only needs to determine when to request authorization from the network in between the procedure.\nThe authorization is performed by the UDM against UE subscription. The privacy check is performed by the GMLC by reusing the mechanism defined in TS 23.273 [9]. The UE and the involved 5GC NFs only need to send the info of all involved UEs (Client UE and to-be-measured UEs) to the UDM.\nThe solution can accommodate different conditions with two options:\na)\tWith Client UE not Ranging/SL positioning capable, the authorization can be performed during PC5 link establishment.\nb)\tWith Ranging/SL positioning capable Client UE, the authorization can be performed either during link establishment or during Ranging/SL positioning operations. On which stage the authorization should be performed for Ranging/SL positioning capable Client UE is to be determined during normative work.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.19\tSolution #19: Protecting Ranging/SL Positioning discovery out of network coverage",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.19.1\tIntroduction",
                            "text_content": "The solution addresses Key Issue #3: Protection of discovery procedure, in particular, protects Ranging/SL Positioning discovery when UEs are out of network coverage.\nIn Ranging/SL Positioning services, there are use cases in which the UEs can be determined before using the Ranging/SL Positioning services, e.g., public safety, etc. By pre-provisioning shared root key materials for UEs that are to use Ranging/SL Positioning discovery services, UEs are able to discover each other when there is no network coverage. The shared root key materials may be pre-provisioned to the UEs via user settings at the application layer or pre-configured by the 3GPP network or Ranging/SL Positioning application server before the discovery procedure. Discovery request authorization is implicit, i.e., the UEs which are provided the shared root key materials are considered authorized UEs and can initiate discovery requests.\nThe UEs which want to discover others and also want to be discovered use the root key KRSLP to derive the discovery request MIC code, and this code is used to determine whether the discovery is matched or not as well as for integrity protection. In TS 33.503 Prose discovery security [6], the 5G network provides CURRENT_TIME to ensure the UE's local UTC time counter is close to true time to anti-replay attacks. The proposed solution uses a random-nonce-based challenge-response mechanism to anti-replay attacks, since it may be difficult to ensure the UE's local time is not fooled when there is no 5G coverage. Furthermore, the root key can also be used for other purposes, such as Ranging/SL Positioning direct unicast communications.\nThe solution only works for ProSe-capable UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.19.2\tSolution details",
                            "text_content": "The figure depicts a range/SL positioning discovery and protection procedure when UEs are out of coverage. It illustrates the steps taken to ensure the safety of the network by detecting and protecting UEs from potential threats.\nFigure 6.19.2-1: Ranging/SL Positioning discovery protection procedure when UEs are out of coverage\n0)\tThe UEs are pre-provisioned with a shared root key KRSLP and associated valid number of the root key usage times for the specific Ranging/SL Positioning service. The shared root key materials can be pre-provisioned to the UEs via user settings at the application layer or pre-configured by the 3GPP network or Ranging/SL Positioning application server before the discovery procedure. The Ranging/SL Positioning service is identified by Ranging/SL Positioning service code, which is assumed known to UEs prior to the discovery procedure. It can be understood as the real-time Restricted Code and Security Parameters generation process by 5G DDNMF/PKMF in TS 33.503 Security for 5G ProSe Discovery [6] are made as pre-provisioning in this solution.\nNOTE a\t:Whether the network only pre-provisions the root key materials and the Ranging/SL Positioning service code or all of the discovery security materials (code, confidentiality & integrity key materials, etc.) are pre-provisioned from the network is not addressed in the present document.\nNOTE 1: \tIf UEs will use more than Ranging/SL Positioning services when they are out of coverage, UEs are pre-provisioned with independent root keys for each Ranging/SL Positioning service. The root key associated with a specific Ranging/SL Positioning service can be identified by Ranging/SL Positioning service code.\nNOTE 2: \tThe root key KRSLP lifetime is implemented by the valid number of the root key usage times since trusted synchronous time may be not available. When the root key expires (i.e., the valid number of the root key usage times is exhausted), the root key is re-provisioned via certain methods which can be the same as the above-mentioned root key pre-provisioning methods.\n1)\tUE A is a UE which wants to discover other UEs nearby and also wants to be discovered by other UEs. UE A first checks the valid number of the root key usage times is not exhausted. Then UE A chooses a random number nonce 1, and a specific ciphering algorithm. UE A derives Ranging/SL Positioning Discovery Confidentiality Key (RSLPDCK), Ranging/SL Positioning Discovery Integrity Key (RSLPDIK) using the shared root key KRSLP, Ranging/SL Positioning service code, and nonce 1, updates the valid number of the root key usage times as the current valid number of the root key usage times minus 1. UE A encrypts the Ranging/SL Positioning service code using the chosen ciphering algorithm and the RSLPDCK to avoid being tracked by unauthorized parties if UE A constantly sends the same cleartext Ranging/SL Positioning service code. UE A may optionally encrypt its role since the cleartext UE A role may also be considered as privacy. Then UE A generates discovery request message integrity check (DREQ MIC) code using RSLDIK, Ranging/SL Positioning service code, chosen ciphering algorithm identifier, UE A role, and nonce 1.\nNOTE 3: \tHow the RSLPDCK, RSLPDIK, and DREQ MIC code is calculated (e.g., using what ciphering algorithm) is left for normative work.\nNOTE 4: \tUE A and UE B can be Reference UE, Target UE, and/or Located UE in the Ranging/SL Positioning service. The UE's role may be determined by the application layer before the discovery procedures.\n2)\tUE A broadcasts Discovery Request message, including Encrypted Ranging/SL Positioning service code, chosen ciphering algorithm, [Encrypted] UE A role, nonce 1, DREQ MIC code.\n3)\tUE B is a UE in the proximity of UE A. UE B listens for the Discovery Request message, checks the valid number of the root key usage times is not exhausted, derives RSLDCK' and RSLDIK' the same as which in step 1, and updates the valid number of the root key usage times as the valid number of the root key usage times minus 1. UE B decrypts the Ranging/SL Positioning service code and UE A role (if encrypted) using RSLDCK'. UE B checks the received DREQ MIC code according to RSLDIK', the decrypted Ranging/SL Positioning service code, the received ciphering algorithm identifier, UE A role, and the received nonce 1. If checked, the Discovery Request message is pre-considered matched and goes to step 4, otherwise, disregards this Discovery Request and keeps listening to other Discovery Request messages.\nNOTE 4a\t: How could UE B know what service UE A is discovering for if the Ranging/SL Positioning service code was encrypted is not addressed in the present document.\n4)\tUE B chooses a random number nonce 2, and sends Discovery Response message, including UE B role (encrypted using RSLDCK' if needed), nonce 2, and Discovery Resp Message Integrity Check (DRESP MIC) code. The DRESP MIC is generated by RSLDIK', the Ranging/SL Positioning service code, UE B role, nonce1, nonce2.\nNOTE 5: \tHow the DRESP MIC code is calculated is left for normative work.\n5)\tUE A listens for the Discovery Response message. It checks the received DRESP MIC code according to RSLDIK', the Ranging/SL Positioning service code, the decrypted (if it was encrypted) UE B role, nonce1, and the received nonce2. If checked, the Discovery Response message is considered fresh and integral, and goes to step 6, otherwise, disregards this Discovery Response and keeps listening to other Discovery Response.\n6)\tUE A sends Discovery Freshness Proof message, including Discovery Freshness Proof Message Integrity Check (DFP MIC) Code. The DFP MIC code is generated by RSLDIK, the Ranging/SL Positioning service code, and the received nonce2.\nNOTE 6: \tHow the DFP MIC code is calculated is left for normative work. The DREQ MIC code, DRESP MIC code, and DFP MIC code are calculated with different input arguments to avoid replay attacks, e.g., replay DRESP MIC code as DFP MIC code in step 6.\n7)\tUE B listens for Discovery Freshness Proof Message, and checks the received DFP MIC code according to RSLDIK', the Ranging/SL Positioning service code, and the nonce2, if checked, the Discovery Request is considered fresh and matched, otherwise, disregards the Discovery Request and keeps listening to another Discovery Request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.19.3\tEvaluation",
                            "text_content": "None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.20\tSolution #20: Secure groupcast/broadcast of SL positioning data",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.20.1\tIntroduction",
                            "text_content": "This solution addresses KI#5.\nThis solution proposes to protect the groupcast/broadcast of SL positioning data, in particular, SL positioning capability and SL positioning assistance data, by adapting the communication flow and security mechanisms in TS 38.305 [12] (Clause 7.5) and TS 37.355 [13] (Clause 7.5) used for the protection of positioning assistance data.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.20.2\tSolution details",
                            "text_content": "The figure depicts a secure broadcast/groupcast message flow, illustrating the steps taken by the sender to send a message to a group of recipients. The message is encrypted and broadcasted over a secure channel, ensuring confidentiality and integrity. The figure also shows the receiver's response, which is received and decrypted, ensuring the message is received correctly.\nFigure 6.20.2-1: Message flow for secure broadcast/groupcast\nThe overall message flow proposed by this solution is as follows:\n-\tStep 1: UE1 (and UE2) send a request to join a ranging service.\n-\tStep 2: UE 1 (and UE2) are configured with the corresponding security information as applicable to the ranging service, if the UEs are authorized.\nNOTE 1\t: it is not addressed in the present document which entity handles the keys, how UEs are identified and authorized by the CN, and how the ranging service request is protected.\n-\tStep 3: UE 1 / UE 2 determine a ranging trigger that requires the distribution of SL ranging data when in in-coverage (IC) or partial coverage (PC).\n-\tStep 4: UE2 sends a ranging request to retrieve SL positioning data.\n-\tStep 5: CN, e.g., LMF, determines suitable SL positioning data, and protects it as in TS 37.355 [13].\n-\tStep 6: Protected SL positioning data is transferred to UE2 in charge of local groupcast/broadcast.\n-\tStep 7: Optionally, UE2 verifies received SL positioning data before broadcast/groupcast.\n-\tStep 8: UE 1 / UE 2 determine a ranging trigger that requires the distribution of SL positioning data when out of 3GPP coverage.\n-\tStep 9: Optionally, UE2 adds further protection (e.g., scrambling/integrity protection) to SL positioning data.\n-\tStep 10: Protected SL positioning data is sent by means of groupcast/broadcast.\nNOTE 2\t: message fields required for data protection are left for normative phase.\nIn Step 2, UEs may be configured:\n-\twith keys as in TS 37.355 [13] for confidentiality protection when Ues are IC/PC.\n-\twith keys as in TS 37.355 [13] for usage when Ues are OOC. In this case, UE2 uses its key (e.g., as in step 9) for confidentiality protection of SL positioning data.\n-\tWith keys for the computation of a MIC that allows e.g., UE1 to verify SL positioning data transmitted in groupcast/broadcast.\n-\tWith keys for the scrambling of SL positioning data transmitted in groupcast/broadcast to prevent privacy threats.\nIf devices are out of 3GPP coverage, Steps 3-7 are not applicable. Instead, the UE (e.g., UE2) may implement the functionality of server UE thus replacing LMF functionality.\nIf devices are in-coverage / partial coverage, it is preferable to use Steps 3-7, although these steps may be skipped based on a policy/configuration.\nMessage in Step 6 may be securely transferred, e.g., as a NAS message.\nProtection in Step 9 can be based on TS 37.355 [13] for confidentiality and may include further protection (e.g., integrity protection and/or scrambling protection).\nNOTE 3: The choice of specific security algorithms/keys is left to normative phase.\nNOTE 4\t: further clarification about how the solution works in inter-PLMN use cases is not addressed in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.20.3\tEvaluation",
                            "text_content": "None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.21\tSolution #21: Security of ranging/SL positioning groupcast communication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.21.1\tIntroduction",
                            "text_content": "This solution addresses the security requirement of KI #1 and protects the ranging/SL positioning groupcast communication. This solution reuses the existing security mechanism of one-to-many ProSe direct communication defined in clause 6.2 of TS 33.303 [14] along with some modification to set up the security of ranging/SL positioning groupcast communication.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.2\tSolution details",
                            "text_content": "This solution reuses the existing security mechanism of one-to-many ProSe direct communication defined in clause 6.2 of TS 33.303 [14] along with some modification to set up the security of ranging/SL positioning groupcast communication.\nThe security for ranging/SL positioning establishment follows the procedure below:\n-\tConfiguration: The UE participating in the groupcast communication and the PKMF should be pre-configured with the group information for the ranging/SL positioning service, e.g., the Group Identity information including the Group Identity and Group member identity.\n-\tThe member UE and the PKMF should establish a security connection to transmit the key request message and key response message as specified in clause 5.2.5 of TS 33.503 [6]. The UE uses these messages to request keys for particular groups, while the PKMF uses these messages to provide the UE with its Group member identity and the security algorithms to use with the various groups. The Key Response message is used to transport the group security material from the PKMF to the UE, which contains PGK, identifier of the PGK, and the expiry time.\n-\tFor roaming scenario, the PKMF in the HPLMN and VPLMN of the UE exchange the Key Request message and Key Response message to provision the member UE with the group security material.\n-\tThe sending UE should generate a PTK to further generate the PEK and PIK to protect the groupcast traffic between sending UE and receiving UE, the protection of traffic between UEs is specified in clause 6.2.3.6 of 33.303 [14].\nThe Group Identity and Group member identity are carried in the encrypted payload of PDCP packet, thus preventing the attacker to impersonate any UE in a specific group.\nNOTE 1: How to serve these UEs subscribed with different operators is not addressed in the present document.\nNOTE 2: Whether PDCP for LTE ProSe one-to-many communication can be used for 5G-capable/V2X-capable UEs is not addressed in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.3\tEvaluation",
                            "text_content": "None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.22\tSolution #22: Protection of broadcast Sidelink Positioning data in coverage scenario",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.22.1\tIntroduction",
                            "text_content": "This solution addresses Key issue #5: Protection of groupcast/broadcast.\nThe solution proposes a procedure of provisioning broadcast protection keys to Target/Reference UEs when the UEs broadcast/receive Sidelink Positioning data in coverage scenario.\nThis solution proposes to reuse the broadcast protection key provision mechanism defined in clause 6.14.2 of TS 23.273 [9] for provisioning broadcast protection keys to the Target/Reference UEs when the UEs broadcast/receive Sidelink Positioning data in coverage scenario.\nThe key provision procedure is protected by the NAS security.\nThe Target/Reference UE needs to obtain the broadcast protection keys from its HPLMN's AMF and LMF. How to synchronize keys between different LMFs is not addressed by this solution.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.22.2\tSolution details",
                            "text_content": "The broadcast protection key provision procedure is shown in the following figure.\nThe figure depicts a procedure for protecting broadcast sidelink positioning data in a coverage scenario. It illustrates the steps taken to ensure the data is transmitted securely and reliably, even in the event of a potential interference or signal loss. The figure includes a diagram of the communication network, with the broadcast sidelink positioned at the center, and the positioning data transmitted over the network. The steps outlined in the figure include:\n\n1. Identifying the broadcast sidelink position.\n2. Ensuring the broadcast sidelink is within the coverage area.\n3. Securing the broadcast sidelink by using a secure communication protocol.\n4. Transmitting the broadcast sidelink positioning data over the network.\n5. Monitoring the data transmission and ensuring it is secure.\n6. Reversing the process if necessary.\n\nThis procedure ensures that the broadcast sidelink positioning data is transmitted securely and reliably, even in the event of interference or signal loss.\nFigure 6.22.2-1: Procedure of protecting broadcast Sidelink Positioning data in coverage scenario\n1.\tThe LMF invokes the Nlmf_Broadcast_CipheringKeyData Notify service operation towards the AMF carrying one or more SL Positioning broadcast Encryption Key (SPEK) and Integrity Key (SPIK), which are specified with key value, key identifier, validity period, a set of applicable tracking areas and a set of applicable types of SL positioning broadcast data.\nNOTE 1:\tThe LMF may send new ciphering and/or integrity keys (SPEK and/or SPIK) to the AMF at a time T1 if this will start to be used to cipher SL positioning broadcast data at a later time T2 (e.g. will replace a previous ciphering keys which expire at time T2). The value of (T2 - T1) should exceed the longest periodic registration timer of any UE subscribed to receive ciphering keys to ensure that periodic registration can be used to request new ciphering keys as described in NOTE 2.\nNOTE 1: What triggers the LMF to generate and send the ciphering key is not addressed in the present document.\nNOTE 2: The assistant data broadcasted by the UE may not be from the LMF. The necessity of the LMF being involved in the security procedure is FFS.\n2.\tThe AMF stores the ciphering and/or integrity keys including the validity periods, applicable tracking areas and the types of applicable SL positioning broadcast data.\n3.\tThe Target/Reference UE sends a Registration Request to the AMF. The Registration Request may be sent as part of normal mobility management, A Registration Request may also be sent specifically to request and obtain SL positioning broadcast ciphering and/or integrity keys. The UE includes in the Registration Request an indication that SL positioning broadcast ciphering and/or integrity keys are requested. Other details of the Registration Request are as defined in TS 23.502 [15].\nNOTE 2:\tA UE should request new SL positioning broadcast ciphering and/or integrity keys using a Registration Request caused by periodic registration if the remaining validity period for one or more SL positioning broadcast ciphering and/or integrity keys received earlier by the UE is less than the periodic registration timer value. This can help avoid all UEs initiating a Registration procedure at the same time to obtain new ciphering and/or integrity keys when a validity period for a ciphering and/or integrity key is about to expire. A UE should also request new ciphering and/or integrity keys for a Registration Request caused by entering a new tracking area if previous ciphering and/or integrity keys are not applicable to the new tracking area.\n4.\tThe AMF returns a Registration Accept to the Target UE. If the Target UE is subscribed to receive ciphered SL positioning broadcast data, the AMF includes in the Registration Accept one or more SL positioning broadcast ciphering and/or integrity keys applicable to the current tracking area for the UE. The AMF also includes for each ciphering and/or integrity key the ciphering key value, the ciphering key identifier, the validity period, the set of applicable tracking areas and the set of applicable types of SL positioning broadcast data.\nNOTE 3:\tThe AMF does not need to keep a record of SL positioning broadcast ciphering and/or integrity keys delivered to a UE and may instead send all SL positioning broadcast ciphering and/or integrity keys stored at step 2 that are applicable to the current tracking area, for which the UE has a subscription and whose validity period has not yet expired.\nNOTE 4:\tA UE that receives no ciphering keys in response to a request for ciphering keys may assume that the UE does not have a subscription to receive ciphering keys in the serving PLMN.\n5.\tThe Reference UE sends the ciphered SL positioning broadcast data to the UE. The Target UE may start to use each SL positioning broadcast ciphering and/or integrity key to decipher SL positioning broadcast data once the validity period for the ciphering and/or integrity key has started and if the UE is currently in an applicable tracking area. The UE shall cease using a SL positioning broadcast ciphering and/or integrity key when entering a tracking area not applicable to the SL positioning broadcast ciphering and/or integrity key. The UE shall cease using and shall delete a SL positioning broadcast ciphering and/or integrity key when the validity period for the SL positioning broadcast ciphering and/or integrity key has expired.\nHow to protect the confidentiality and integrity of broadcast messages is out of the scope of this solution.\n6.\tThe AMF deletes all information for a SL positioning broadcast ciphering and/or integrity keys when the key validity period has expired.\nNOTE 5: With this solution, a UE only allowed to receive broadcast message can also send fake broadcast message. It is not addressed in the present document how to prevent the receiving UE from sending fake broadcast messages.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.22.3\tEvaluation",
                            "text_content": "This solution addresses the key issue #5.\nThis solution proposes to reuse the broadcast key provision mechanism defined in TS 23.273 [9] for provisioning broadcast protection keys to the Target/Reference UEs when the UEs broadcast/receive Sidelink Positioning data in coverage scenario.\nThis solution does not address how to use ciphering and/or integrity keys to protect broadcast messages. For message protection issue, other solutions in the present document can be considered.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.23\tSolution #23: Provisioning groupcast/broadcast protection key out of coverage",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.23.1\tIntroduction",
                            "text_content": "This solution addresses Key issue #5: Protection of groupcast/broadcast.\nThe solution proposes a key provision mechanism that can securely provide groupcast/broadcast protection keys to Target/Reference UEs when they are out of coverage.\nIn this solution, the groupcast/broadcast protection keys are encapsulated in a key packet, and the Target/Reference UEs are provisioned with a symmetric key for decrypting the key packet, as well as a public key for verifying the signature of the key packet.\nThe Target/Reference UEs need to obtain the key packet decryption keys and signature verification keys when they are in coverage. The Server UEs need to obtain the key packets when they are in coverage. The Server UEs will distribute the key packets to the Target/Reference UEs when these UEs are out of coverage.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.23.2\tSolution details",
                            "text_content": "The groupcast/broadcast protection key provision architecture is shown in the following figure.\nThe figure depicts a key provision architecture for G-bandcast/broadcast protection in an out-of-coverage scenario. It illustrates the various components and their interconnections, including the base station (gNB), user equipment (UE), and the network's protection mechanism. The architecture is designed to ensure reliable communication in the event of a network outage, with redundancy paths and failover mechanisms in place.\nFigure 6.23.2-1: Groupcast/broadcast protection key provision architecture in out of coverage scenario\nThe keys used to protect the groupcast/broadcast messages are generated by LMF or Key Management Function (KMF). The groupcast/broadcast protection keys are encrypted using the key packet encryption key, and then the key packet is signed using a private key by the LMF/KMF. The key packet encryption keys and signature verification public keys are pre-provisioned to Target/Reference UEs when they are in coverage. The encrypted and signed key packets are provisioned to Server UEs when they are in coverage. When Target/Reference/Server UEs are out of coverage, the Target/Reference UEs can download the encrypted and signed key packets from the Server UEs, and then use the signature verification key to verify the signature and then decrypt the encrypted groupcast/broadcast protection keys.\nThis mechanism can be used to provision broadcast protection keys (encryption protection keys and integrate protection keys) or groupcast protection keys (group keys).\nThe groupcast/broadcast protection key provision procedure is shown in the following figure.\nThe figure depicts a key provision procedure for G-bandcast/broadcast protection in an out-of-coverage scenario. It illustrates the steps taken to ensure the protection of G-bandcast/broadcast signals in a network. The figure includes key components such as the G-bandcast/broadcast protection key, the protection key distribution mechanism, and the protection key management system. The figure also highlights the importance of proper network management and the need for regular updates to ensure the protection of G-bandcast/broadcast signals.\nFigure 6.23.2-2: Groupcast/broadcast protection key provision procedure in out of coverage scenario\n0.\tIn the cast where KMF is used to provide encrypted and signed groupcast/broadcast protection key packets, PCF can be used to provide the address of KMF to the Target/Reference/Server UEs.\nIn the case where AMF-LMF is used to provide encrypted and signed groupcast/broadcast protection key packets, this step is not required.\nNOTE 1: Whether LMF can generate and provision the keys needs to be coordinated with stage 2 work.\n1.\tIn the cast where KMF is used to provide encrypted and signed groupcast/broadcast protection key packets, the Target/Reference UE should establish a secure connection with the KMF when it is in coverage. The secure connection relies on Ua security if GBA specified in TS 33.220 [14] is used (see clause 5.2.3.4) or Ua* security if AKMA specified in TS 33.535 [15] is used (see clause 5.2.5.4).\nIn the case where AMF-LMF is used to provide encrypted and signed groupcast/broadcast protection key packets, the data security is provided by the NAS security.\nAfter secure connection is established, the UE sends key packet encryption key and verification key request to the AMF-LMF/KMF.\nNOTE 2: The UE, while in coverage, is able obtain broadcast keys directly from the network or obtain encryption/public keys from the network proposed in this solution. Under which condition the UE should obtain encryption/public keys rather than broadcast keys is not addressed in the present document.\n2.\tThe AMF-LMF/KMF checks whether the Target/Reference UE is authorized to receive key packet decryption key and key packet signature verification public key. If the UE is authorized, AMF-LMF/KMF returns a list of key packet decryption keys and a list of key packet signature verification public keys. Each decryption key or signature verification public key is associated with the key id and key validity time.\nNOTE 2a: \tIn cases where UE comes from different PLMNs and AMF-LMF is used, key synchronization needs to be done between LMFs of different PLMNs. It is out of the scope of this solution.\n3.\tSimilar to the Target/Reference UE, the Server UE needs to establish a secure connection with the AMF-LMF/KMF, and then sends groupcast/broadcast protection key packet request to the AMF-LMF/KMF.\n4.\tThe AMF-LMF/KMF checks whether the Server UE is authorized to distribute the groupcast/broadcast protection key packets to Target/Reference UEs. If the UE is authorized, AMF-LMF/KMF returns a list of groupcast/broadcast protection key packets. Each key packet is associated with the packet id, packet validity time, packet decryption key id, packet signature verification public key id. The structure, encryption algorithm, and signature algorithm of the key packet are left to the normative phase stage.\nNOTE 3: The risk of distributing the same key packet to different Server UEs is not addressed in the present document.\n5.\tThe Target/Reference UE establishes a unicast communication with the Server UE using the security mechanism defined in clause 6.2 of TS 33.503 [3], and then sends a groupcast/broadcast protection key packet download request to the Server UE.\nNote 3a: The solution requires the Server UE to establish unicast links with both Target/Reference UE for distributing the key packet, while SL Positioning service does not require that the Server UE shall establish unicast links with both Target/Reference UE.\nNOTE 4:\tHow to ensure that the key packets can be distributed to both Target/Reference UEs is not addressed in the present document.\n6.\tThe Server UE checks whether the Target/Reference UE is authorized to receive the groupcast/broadcast protection key packets. If the UE is authorized, the Server UE returns a list of applicable key packets to the Target/Reference UE. How the Target/Reference UE is authorized is not addressed in this solution.\n7.\tThe Target/Reference UE uses the public key indicated by the packet signature verification public key id to verify the signature of the key packet, and uses the decryption key indicated by the packet decryption key id to decrypt the key packet.\n8.\tThe Target/Reference UE uses the groupcast/broadcast protection keys to protect groupcast/broadcast messages. This solution does not specify how to use groupcast/broadcast protection keys to protect groupcast/broadcast messages.\nNOTE 5: Whether this solution is applicable to V2X-capble UEs is not addressed in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.23.3\tEvaluation",
                            "text_content": "This solution addresses the key issue #5.\nThis solution proposes a key provision solution that can securely distribute groupcast/broadcast protection keys to Target/Reference UEs when they are out of coverage. The data packet that carries groupcast/broadcast protection keys is encrypted and signed by the key management function. The decryption keys and signature verification keys are securely provisioned to the UEs when they are in coverage. Therefore, only valid UEs can retrieve the groupcast/broadcast protection keys.\nThis solution does not provide a detailed data structure for the key packet, which is left to normative stage.\nThis solution does not address how to use the keys carried in the key packet to protect groupcast/broadcast messages. For message protection issue, other solutions in the present document can be considered.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.24\tSolution #24: Protecting groupcast/broadcast messages",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.24.1\tIntroduction",
                            "text_content": "This solution addresses Key issue #5: Protection of groupcast/broadcast.\nThis solution proposes key hierarchies and message formats for protecting groupcast and broadcast messages.\nNOTE 1: Privacy of group ID and group member ID and group key ID is not addressed in the present document.\nNOTE 2: Setting MIC to zero when integrity is disabled is not addressed in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.24.2\tSolution details",
                            "text_content": "The groupcast security key hierarchy is shown in the following figure.\nThe figure depicts a hierarchical security key hierarchy for a 24 Gbps groupcast network, illustrating the key components and their relationships.\nFigure 6.24.2.1.1-1: Groupcast security key hierarchy\n-\tPositioning Group Key (PGK): A key is provided by a KMF to a group member. This key is used to derive the PTK for a group member in the group.\n-\tPositioning Traffic Key (PTK): This key is bound to a group member. The PTK is derived using the PGK based on Group ID, Group member ID, and Group key ID.\n-\tPositioning Session Key (PSK): This key is generated by a group member using its PTK based on key generation time and a nonce. The key is used to generate PEK and PIK.\n-\tPositioning Encryption Key (PEK): This key is generated using PSK and used for message encryption protection.\n-\tPositioning Integrity Key (PIK): This key is generated using PSK and used for message integrity protection.\nNOTE: Whether the PSK is necessary is not addressed in the present document.\nThe detailed generation method for these keys will be determined in normative work. This solution does not specify how UE obtains PGK.\nThe format of SLPP message for Sidelink Positioning groupcast is shown in the following figure.\nThe figure depicts a message format for Sidelink Positioning group cast, which is a key component in the SLPP protocol used in 5G networks. The message format is structured as a 24-byte message, with 2-byte identifiers for the sender and receiver, and 2-byte identifiers for the message type and message length. The message is then divided into 24-byte segments, each representing a specific data element. The figure also includes a 2-byte identifier for the SLPP group, which is used to identify the group of messages being sent. The message format ensures that the data is transmitted in a consistent and reliable manner, and is a key component of the SLPP protocol in 5G networks.\nFigure 6.24.2.1.2-1: SLPP message format for Sidelink Positioning groupcast\nThe message sending UE performs the following operations:\n-\tConstruct the message as shown in figure 6.24.2.1.2-1.\n-\tSelects a valid PGK stored locally, generate the PTK using the PGK based on Group ID, Group member ID and Group key ID, generate PSK using the PTK based on current time and a nonce, and generate PEK and PIK using the PSK.\n-\tIf message integrity protection is enabled, calculate MAC of the message, otherwise the MAC field will be filled with all zeroes. The integrity algorithms specified in Annex D in TS 33.501 [8] are used to calculate MAC.\n-\tIf message confidentiality protection is enabled, encrypt the Payload and MAC. The ciphering algorithms specified in Annex D in TS 33.501 [8] are used for the confidentiality protection.\nThe message receiving UE performs the following operations:\n-\tSelect a locally stored PGK using the Group key ID carried in the message, calculate PTK, PSK, PEK and PIK in the same way as sending UE based on the parameters carried in the message.\n-\tIf message confidentiality protection is enabled, decrypt the ciphertext.\n-\tIf message integrity protection is enabled, verify integrity protection by checking the MAC of the message.\nThe broadcast security key hierarchy contains the following keys.\n-\tPositioning Encryption Key (PEK): This key is used for message encryption protection. PEK is provided by a KMF.\n-\tPositioning Integrity Key (PIK): This key is used for message integrity protection. PIK is provided by a KMF.\nThis solution does not specify how UE obtains PEK and PIK.\nThe format of SLPP message for Sidelink Positioning broadcast is shown in the following figure.\nThe figure depicts a SLPP message format for Sidelink Positioning broadcast, which is a method used in satellite communication systems to transmit data between satellites. The message format is composed of a header, a payload, and a footer, with the header containing the message identifier, the payload containing the data, and the footer containing the timestamp and other metadata. The figure provides a clear and concise representation of the SLPP message format, making it easy to understand and interpret.\nFigure 6.24.2.2.2-1: SLPP message format for Sidelink Positioning broadcast\nThe message sending UE performs the following operations:\n-\tConstruct the message as shown in figure 6.24.2.2.2-1.\n--\tIf message integrity protection is enabled, calculate MAC of the message, otherwise the MAC field will be filled with all zeroes. The integrity algorithms specified in Annex D in TS 33.501 [8] are used to calculate MAC.\n-\tIf message confidentiality protection is enabled, encrypt the Payload and MAC. The ciphering algorithms specified in Annex D in TS 33.501 [8] are used for the confidentiality protection.\nThe message receiving UE performs the following operations:\n-\tUse the PEK ID and PIK ID carried in the message to select the locally stored PEK and PIK.\n-\tIf message confidentiality protection is enabled, decrypt the ciphertext.\n-\tIf message integrity protection is enabled, verify integrity protection by checking the MAC of the message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.24.3\tEvaluation",
                            "text_content": "This solution addresses the key issue #5.\nThis solution proposes key hierarchies and message formats for protecting groupcast and broadcast messages.\nThis solution does not address how to provision PGK used in groupcast and PEK/PIK use in broadcast to UEs. For key provision issue, other solutions in the present document can be considered.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.25\tSolution #25: Protection for groupcast of SLPP signalling",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.25.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #5 on Protection of groupcast/broadcast and Key Issue #1 on Privacy protection for Ranging/SL Positioning services. Specifically, it addresses the first requirement in KI#5 and the second requirement in KI#1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.25.2\tSolution details",
                            "text_content": "For a group of UEs, when one of the UEs needs to groupcast SLPP signaling and the rest of the group need to receive SLPP signaling, they are normally groupcasting and receiving for the same Ranging/SL positioning Service. Otherwise, the SLPP signaling (e.g. positioning assistant information) groupcasted for service A may not be of any use for the receiving UE of service B, and the information of the groupcasting UE of service A will be unnecessarily exposed to the receiving UE of service B, which leads to privacy issue. In addition, as per TS 23.586 [11], group management can be performed at application layer, which may provide group identifier information to the Ranging/SL Positioning layer. Hence, it is expected that SLPP signaling groupcast is associated with a specific Ranging/SL positioning service. To enable groupcast protection per group and per Ranging/SL positioning service, it is proposed to associate the groupcast keys with group ID (indicating the specific group) and Ranging/SL positioning service code (RSSC) (indicating the specific Ranging/SL positioning service).\nTo set up unicast communication for exchanging SLPP signaling between a pair of UEs, discovery messages are broadcasted/groupcasted by the UE and the security of discovery messages are protected with discovery security materials provided by the network. For a groupcast capable UE, it should be able to groupcast SLPP signaling without having to establish unicast connection hence no need of performing discovery. Still, the procedure of provisioning discovery security materials can be adapted to provisioning security keys for SLPP groupcast protection.\nFurthermore, it is mostly possible that the two or more UEs involved in a Ranging/SL positioning service may not be subscribed with the same operator. Thus, it is proposed that the 5GC NF serving the groupcasting UE (in one PLMN) generates the groupcast keys, and the 5GC NF serving the receiving UE (probably in another PLMN) obtains the groupcast keys from the generating 5GC NF. The 5GC NF of the receiving UE finds the 5GC NF of the groupcasting UE based on the groupcasting UE info (containing the PLMN ID of the groupcasting UE).\nThe groupcast keys obtained by the group members could be symmetric or asymmetric keys. To prevent one receiver in a group from impersonating the groupcaster in the group, asymmetric key pairs can be created for SLPP signaling groupcast, of which the private key is provisioned to the groupcaster and the public key is provisioned to the receiver.\nThe figure depicts a 25.2-1 key provisioning for SLPP groupcast protection, which is a crucial component in ensuring the security and reliability of groupcast communication in a 5G network. Key provisioning involves assigning specific keys to each groupcast group, which are used to encrypt and decrypt data. This ensures that only authorized parties can access the data and prevents unauthorized access. The figure also includes a visual representation of the key provisioning process, including the generation of keys, encryption, and decryption, which is essential for maintaining the security of groupcast communication.\nFigure 6.25.2-1: Key Provisioning for SLPP Groupcast Protection\nIt is assumed that the UEs in a group are all provisioned with a Group ID allocated by the Ranging/SL positioning application and the Group ID contains the service identifier of a specific Ranging/SL positioning service.\n1.\tThe UE intending to groupcast SLPP signaling (G-UE) sends a Key Request message to its PKMF/DDNMF/PCF. The message includes at least the Group ID, G-UE info, an indicator of the UE as a groupcaster.\n2~4.\tThe PKMF/DDNMF/PCF of G-UE checks with the Ranging/SL Positioning Server on whether G-UE is allowed to perform SLPP signaling groupcast for the Group of the Ranging/SL Positioning service indicated by the Group ID.\n5.\tThe PKMF/DDNMF/PCF of G-UE generates the groupcast keys by associating the keys with the Group ID (so that groupcast keys of one group cannot be used by another group). A groupcast key identifier (GKID) is also generated to identify the keys. The PKMF/DDNMF/PCF of G-UE stores the groupcast keys associated with the Group ID. The groupcast keys could be symmetric or asymmetric key pairs (Private/Public keys), of which the Private key is sent to the groupcaster and the Public key is sent to the receivers.\n6.\tThe PKMF/DDNMF/PCF of G-UE responds to G-UE with the groupcast keys (e.g. Private key) and GKID.\n7.\tThe UE intending to receive the groupcast SLPP signaling (R-UE) sends a Key Request message to its PKMF/DDNMF/PCF. The message includes at least the Group ID, R-UE info, an indicator of the UE as a receiver.\n8~10.\tThe PKMF/DDNMF/PCF of R-UE checks with the Ranging/SL Positioning Server on whether R-UE is allowed to receive groupcasted SLPP signaling for the Group of the Ranging/SL Positioning service indicated by the Group ID. In addition to the Authorization Result, the Ranging/SL Positioning Server also provides the G-UE info of the Group to the PKMF/DDNMF/PCF of R-UE.\n11.\tIf the authorization succeeds, the PKMF/DDNMF/PCF of R-UE sends a Key Request to the PKMF/DDNMF/PCF of G-UE. If the G-UE and R-UE are served by the same PKMF/DDNMF/PCF, this step can be skipped. If the G-UE and R-UE are served by different PKMFs/DDNMFs/PCFs, the PKMF/DDNMF/PCF of R-UE finds the PKMF/DDNMF/PCF of G-UE based on the G-UE info (containing PLMN ID of G-UE). The Key Request contains at least the Group ID, R-UE info, the indicator of the UE as a receiver.\n12~14.\tOptionally, the PKMF/DDNMF/PCF of G-UE may check with the Ranging/SL Positioning Server on whether G-UE and R-UE are matching for groupcasting and receiving SLPP signaling for the Group. The request contains at least the Group ID, G-UE info and R-UE info.\n15.\tIf the check with the Ranging/SL Positioning Server succeeds, the PKMF/DDNMF/PCF of G-UE responds to the PKMF/DDNMF/PCF of R-UE with the groupcast keys (e.g. Public key) and GKID. If the G-UE and R-UE are served by the same PKMF/DDNMF/PCF, this step can be skipped.\n16.\tThe PKMF/DDNMF/PCF of R-UE provides the groupcast keys (e.g. Public key) and GKID to R-UE.\n17.\tG-UE starts to groupcast SLPP signaling which is protected by the group keys (e.g. Private key) received from the network. The groupcast message includes at least the Group ID, GKID, SLPP signaling.\n18.\tR-UE starts to monitor the groupcast messages. When receiving the groupcasted signaling from G-UE, R-UE retrieves the groupcast keys using the received GKID and verifies the groupcasted message using the groupcast keys (e.g. Public key).\nFor protecting the groupcast message, G-UE does the following steps:\n1.\tForm SLPP message: SLPP header (incl. GKID) and SLPP payload (SLPP signaling).\n2.\tEncrypt SLPP payload (SLPP signaling) using the group key (encryption key).\n3.\tCalculate the MAC of SLPP message (GKID+SLPP signaling) using the group key (integrity key).\n4.\tForm L2 message by including the protected SLPP message (SLPP message + MAC) as the L2 payload and append the L2 header (incl. Destination/Group ID).\nThe figure depicts an exemplar format of a Protected Short Message Service (PSM) message, which is a crucial component of the 25.2-2 protocol used in 5G networks. The message is encrypted and protected, ensuring secure communication. The figure illustrates the structure of the message, including the header, body, and footer, and provides a visual representation of the encryption process.\nFigure 6.25.2-2: Exemplar Format of Protected SLPP Message\nFor receiving and verifying the protected groupcast message, R-UE does the following steps:\n1.\tReceive the groupcast message for the expected group by identifying the L2 Destination/Group ID, which is mapped from the Group ID allocated by the application layer.\n2.\tRetrieve the groupcast keys for verification by identify the GKID in the received message.\n3.\tVerify the message by checking the MAC of the received message using the groupcast key (integrity key). This is to ensure that the GKID and SLPP signaling are not tampered during groupcasting.\n4.\tDecrypt the encrypted SLPP payload using the groupcast key (encryption key).\nNOTE 1:\tIt is possible that L2 Destination/Group ID may be tampered because the UE cannot protect L2 header which is below PDCP layer. But even if L2 Destination/Group ID is tampered by an attacker, R-UE is able to detect the attack because the integrity protected GKID is associated with Group ID. When R-UE detects that the Group ID associated with GKID is not identical to the Group ID mapped from the L2 Destination ID, R-UE will drop the received message.\nNOTE 2:\tIf the groupcast keys are symmetric keys (groupcaster and receivers in a group sharing the same keys), there is the risk that a receiver in a group can impersonate the groupcaster in the group. If the groupcast keys are asymmetric keys (groupcaster holding private key and receiver holding public key), it is not possible for a receiver in a group to impersonate the groupcast in the group. Therefore, it is recommended to generate asymmetric keys for SLPP signaling groupcast.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.25.3\tEvaluation",
                            "text_content": "This solution fulfils the first requirement in KI#5.\nThe solution largely reuses the mechanism of discovery key provisioning defined in TS 33.503 [6] for provisioning groupcast keys. Such solution ensures that:\n-\tThe multiple UEs involved in a group of Ranging/SL positioning service but subscribed with different operators are provisioned with the same set of groupcast keys generated by a single network function.\n-\tThe groupcasters and receivers are authorized per role by the network before obtaining the groupcast keys.\n-\tThe receivers are able to detect whether the unprotected L2 header (containing L2 Destination/Group ID) of the received groupcast message is tampered or not, based on the integrity protected GKID.\n-\tA receiver in a group cannot impersonate the groupcast in the group if asymmetric keys are generated for SLPP signaling groupcast.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.26\tSolution #26: Protection of SLPP broadcast based on central key management function",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.26.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #5 on Protection of groupcast/broadcast and Key Issue #1 on Privacy protection for Ranging/SL Positioning services. Specifically, it addresses the second requirement in KI#5 and the second requirement in KI#1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.2\tSolution details",
                            "text_content": "According to RAN2, SLPP signalling broadcast could be service independent, e.g. SLPP signalling broadcasted by a UE can be received and used by other UEs in different Ranging/SL positioning services. The UEs do not need to perform discovery procedure and link establishment procedure for broadcasting and/or receiving SLPP signalling. Hence it is proposed to provision the broadcast keys to the UE as earlier as in Registration procedure.\nTo support SLPP signaling broadcast, it is assumed that the information on whether a Ranging/SL positioning capable UE is allowed to broadcast and/or receive SLPP signaling or not is included in the UE subscription. Based on such information in the subscription and UE's capability, the core network can then determine whether broadcast keys need to be provisioned to the UE when it is registering to the network.\nFor Ranging/SL positioning services, it is mostly possible that the broadcasting and receiving UEs may not be subscribed with the same operator. If the involved UEs are subscribed with different operators, it would not be possible for the 5GC NF in one PLMN to create the same broadcast keys for all involved UEs belonging to different PLMNs during Registration. Therefore, it is proposed to use a centralized key management function which could be connected with different PLMNs for creating and providing the broadcast keys to the 5GC NFs in different PLMNs. The 5GC NF then provisions the broadcast keys to the UEs in its own PLMN.\nThe 5GC NF provisioning the broadcast keys could be the PCF which sends the keys to the UE as part of UE security policy configuration information; or could be the LMF which sends the keys to the UE using the existing procedure defined in clause 6.14.2 of TS 23.273 [9]. If the deployment of SLPP signalling broadcast requires that receiving UEs should be subscribed in the same PLMN of the broadcasting UE, the centralized key management function can be collocated with the PCF or the LMF.\nThe figure depicts a key provisioning process for SLPP broadcast protection in a 26 GHz band, illustrating the use of the PCF (Physical Channel Filter) to ensure the efficient transmission of signals.\nFigure 6.26.2-1: Key Provisioning via the PCF for SLPP Broadcast Protection\n1.\tThe UE intending to broadcast SLPP signaling (B-UE) sends a (Periodic) Registration Request message to its AMF, which contains B-UE ID and an indicator of Requesting Broadcast Keys.\n2.\tThe AMF of B-UE checks with the UDM whether B-UE is allowed to broadcast SLPP signaling against the UE subscription information.\n3.\tIf B-UE is allowed to broadcast SLPP signaling, the AMF of B-UE sends e.g. a UE Policy Create Request to the PCF of B-UE with the indicator of Requesting Broadcast Keys for Broadcaster.\n4.\tThe PCF of B-UE sends a Key Request to the Central Key Management Function to request keys for broadcasting SLPP signaling.\n5.\tThe Central Key Management Function generates the keys for broadcasting SLPP signaling. The broadcast keys could be e.g. a pair of asymmetric private/public keys or a pair of symmetric integrity and encryption keys.\n6.\tThe Central Key Management Function returns the broadcast keys (e.g. the private key) in the Key Response to the PCF of B-UE.\n7.\tThe PCF of B-UE returns the broadcast keys to the AMF of B-UE in e.g. the UE Policy Create Response.\n8.\tThe AMF of B-UE sends the broadcast keys to B-UE in the Registration Accept.\n9.\tThe UE intending to receive the broadcast SL positioning signaling (R-UE) sends a (Periodic) Registration Request message to its AMF, which contains R-UE ID and an indicator of Requesting Broadcast Keys.\n10.\tThe AMF of R-UE checks with the UDM whether R-UE is allowed to receive broadcasted SLPP signaling against the UE subscription information.\n11.\tIf R-UE is allowed to receive broadcasted SLPP signaling, the AMF of R-UE sends e.g. a UE Policy Create Request to the PCF of R-UE with the indicator of Requesting Broadcast Keys for Receiver.\n12.\tThe PCF of R-UE sends a Key Request to the Central Key Management Function to request keys for receiving broadcasted SLPP signaling.\n13.\tThe Central Key Management Function returns the keys for receiving broadcasted SLPP signaling in the Key Response to the PCF of R-UE. The keys could be e.g. the public key of the asymmetric private/public keys created in step #5.\n14.\tThe PCF of R-UE returns the keys for receiving broadcasted SLPP signaling to the AMF of R-UE in e.g. the UE Policy Create Response.\n15.\tThe AMF of R-UE sends the keys for receiving broadcasted SLPP signaling to R-UE in the Registration Accept.\n16.\tB-UE starts to broadcast positioning signaling which is protected by the broadcast keys received from the network.\n17.\tR-UE starts to monitor the broadcasted messages. When receiving the broadcast signaling from B-UE, R-UE verifies the broadcast message with the keys received from the network.\nNOTE:\tEach of the keys is assigned with a validity timer. When the timer expires, the UE needs to request new keys by initiating a periodic registration procedure again.\nThe 5GC NF provisioning the broadcast keys to the UE could also be the LMF for reusing the existing procedure of Ciphering Keys Delivery for Broadcast Assistance Data defined in clause 6.14.2 of TS 23.273 [9]. The LMF is used when the broadcasting UE needs to acquire positioning assistant data from the core network. In this case, the UE sends a request to the AMF, which selects a LMF for invoking network assistant data transfer. Before the LMF starts to deliver the network assistant data, it needs to obtain the broadcast keys for protecting the network assistant data.\nThe figure depicts a key provisioning mechanism for SLPP (Single-Level Protected) broadcast protection in a 26 GHz band. It illustrates the process of configuring the radio frequency (RF) signal for broadcast protection, with a focus on the key provisioning process. The figure includes a diagram of the radio frequency (RF) signal, the key provisioning process, and the radio frequency (RF) signal configuration.\nFigure 6.26.2-2: Key Provisioning via the LMF for SLPP Broadcast Protection\n1.\tUpon receiving the request for network assistant data delivery, the LMF of B-UE sends a key request to the Central Key Management Function to request keys for the UE to broadcast SLPP signaling.\n2.\tThe Central Key Management Function returns the broadcast keys for SLPP signaling to the LMF of B-UE.\n3.\tThe LMF of B-UE invokes the Nlmf_Broadcast_CipheringKeyData Notify service operation towards the AMF of B-UE containing the received security keys for SLPP signaling broadcast.\n4.\tThe AMF of B-UE stores the broadcast keys received from the LMF of B-UE.\n5.\tB-UE intending to broadcast SLPP signaling sends a (Periodic) Registration Request message to its AMF, which contains B-UE ID and an indicator of Requesting Broadcast Keys.\n6.\tThe AMF of B-UE checks with the UDM whether B-UE is allowed to broadcast SLPP signaling against the UE subscription information.\n7.\tThe AMF of B-UE sends the stored broadcast keys to B-UE in the Registration Accept.\n8.\tAs in step #1, the LMF of R-UE sends a key request to the Central Key Management Function to request broadcast keys for the UE to receive broadcasted SLPP signaling.\n9.\tThe Central Key Management Function returns the broadcast keys for receiving broadcasted SLPP signaling to the LMF of R-UE.\n10.\tThe LMF of R-UE invokes the Nlmf_Broadcast_CipheringKeyData Notify service operation towards the AMF of R-UE containing the received broadcast keys.\n11.\tThe AMF of R-UE stores the broadcast keys received from the LMF of R-UE.\n12.\tR-UE intending to receive broadcasted SLPP signaling sends a (Periodic) Registration Request message to its AMF, which contains R-UE ID and an indicator of Requesting Broadcast Keys.\n13.\tThe AMF of R-UE checks with the UDM whether R-UE is allowed to receive broadcasted SLPP signaling against the UE subscription information.\n14.\tThe AMF of R-UE sends the stored broadcast keys to R-UE in the Registration Accept.\n15.\tB-UE starts to broadcast positioning signaling which is protected by the broadcast keys received from the network.\n16.\tR-UE start to monitor the broadcasted messages. When receiving the broadcast signaling from B-UE, R-UE verifies the broadcast message with the broadcast keys received from the network.\nNOTE:\tIn case that the LMF requests broadcast keys from the Central Key Management Function, only symmetric keys can be generated, because the LMF does not know whether the requesting UE intends to broadcast or receive SLPP signaling when sending registration request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.3\tEvaluation",
                            "text_content": "This solution fulfils the second requirement in KI#5.\nThe broadcast keys are generated and provisioned by a Centralized Key Management Function during Registration procedure. Such solution ensures that:\n-\tThe UE does not need to be specifically triggered to request broadcast keys.\n-\tThe broadcasting and receiving UEs subscribed with different operators can be provisioned with the same set of broadcast keys generated by a single network function.\n-\tThe broadcasters and receivers are authorized per role by the network before obtaining the broadcast keys.\n-\tThe existing procedure of Ciphering Keys Delivery for Broadcast Assistance Data defined in clause 6.14.2 of TS 23.273 [9] can be partially reused, when the broadcaster needs positioning assistant data from the LMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.27\tSolution #27: Protection of broadcast communication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.27.1\tIntroduction",
                            "text_content": "This solution solves key issue # 5 \"Protection of groupcast/broadcast\". In order to meet the requirements of KI #5, this solution provides a secure Sidelink Positioning broadcast procedure that fulfils confidentiality, integrity, and replay protection for the location information. This solution is summarized into four phases:\n1) The broadcast key request phase of the sending UE-1. The sending UE-1 initiates an SL broadcast key request. After authorization, the corresponding Sidelink Positioning Key Management Function (SLPKMF) selects the Sidelink Positioning Broadcast Key (SLPBK), Sidelink Positioning Secret Key (SLPSK), Sidelink Positioning Public Key (SLPPK), SLPBK-ID, and responds the keys to the UE-1.\n2) The broadcast phase of the sending UE-1. The sending UE-1 broadcasts protected positioning signaling, the SLPBK-ID, and a token associated with this broadcast message. The token is used to enable the receiving UE-x to verify whether the sending UE-1 does have permission to broadcast, preventing UEs that have obtained SLPBK from impersonating UE-1. In broadcast communications, all the UEs subscribed to the same Sidelink Positioning Services in the proximity of UE-1 have permission to receive and decrypt broadcasted positioning signaling, but whether a UE can broadcast positioning signaling should be authorized. Since SLPBK is the key protects broadcast message, all the subscribed UEs in the proximity of UE-1 will obtain SLPBK from 5GC to undo the protection of the broadcast message. These UEs may impersonate UE-1 to send broadcast message.\n3) The key retrieval phase of the receiving UE-x. The receiving UE-x sends an SL broadcast key retrieval request to the corresponding SLPKMF. The SLPKMF of UE-x determines whether the sending UE-1 and receiving UE-x are with the same HPLMN. If they are with the same HPLMN, the SLPKMF of UE-x directly returns a key retrieval response to the UE-x; Otherwise, the SLPKMF of UE-x establishes a secure connection with the SLPKMF of UE-1 to obtain the broadcast key, and then returns a key retrieval response to the UE-x.\n4) The decryption phase of the receiving UE-x. The receiving UE-x verifies the token and decrypts the broadcast message.\nThe solution assumes the receiving UEs are in coverage.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.27.2\tSolution details",
                            "text_content": "The figure depicts a network protection scheme for broadcast information between UEs, highlighting the use of guard bands and guard nodes to ensure the integrity of the communication.\nFigure 6.27.2-1: protection of broadcast information between UEs\nSteps 1-6: The broadcast key request phase of the sending UE-1.\n0)\tThe sending UE-1 wants to send broadcast message, it prepares positioning signaling (e.g., SL positioning assistance data/SL positioning capability) and perhaps other broadcast data in advance.\n1)\t The UE-1 sends SL broadcast key request messages to the serving SLPKMF of UE-1, including the UE-1-ID, the Sidelink Application identifier (SLAPP-ID), and the SL security capabilities.\nNOTE 1: \tThe SLPKMF may be an existing key management NF in 5GC, such as Prose PKMF. Therefore, the communications between UE and SLPKMF are assumed secure.\n2)\t The UE-1's serving SLPKMF sends SL broadcast authorization request to the ranging/SL application server to authorize UE-1's broadcast request, including UE-1-ID.\n3)\t The ranging/SL application server authorizes the request based on UE-1's subscription. If the authorization is successful, continue with step 4, otherwise reject the SL authorization request.\n4)\t The ranging/SL application server provides the SL authorization response to the serving SLPKMF of UE-1.\n5)\t The serving SLPKMF of UE-1 selects the Sidelink Positioning Broadcast Key (SLPBK) and corresponding key identifier (SLPBK-ID), as well as a key pair: Sidelink Positioning Secret Key (SLPSK) and Sidelink Positioning Public Key (SLPPK) for UE-1. In addition, the serving SLPKMF of UE-1 sets an expiration time for the broadcast key materials. Once SLPBK, SLPSK and SLPPK expire, the SLPKMFs and UEs delete the broadcast keys SLPBK, SLPSK and SLPPK.\n6)\tThe serving SLPKMF of UE-1 returns a broadcast key response to UE-1, including SLPBK, SLPBK-ID, SLPSK of UE-1, and expiration time.\nStep 7: The broadcast phase of the sending UE-1.\n7)\tThe sending UE-1 encrypts the UE-1-ID and SL positioning assistance data /SL positioning capability using SLPBK. In addition, the UE-1 generates a token using SLPSK, then sends broadcast message, including SLPBK-ID, token, encrypted UE-1-ID and protected broadcast data (i.e., the positioning signaling).\nNOTE 2: \twhether UE-1-ID and other information encrypted are separate may be implementation-specific, for example, it may depend on whether the encryption algorithms support the decryption of partial ciphertext.\nNOTE 2: how to encrypt and integrity protect the broadcast message is not addressed in the present document.\nSteps 8-13: The key retrieval phase of the receiving UE x.\n8)\tIf the receiving UE-x does not have the SLPBK associated with the received SLPBK-ID or the UE-x has the SLPBK but after decrypts the UE-1-ID, the UE-x find it has no SLPPK of the UE-1, the UE-x sends an SL broadcast key retrieval request to its serving SLPKMF. The SL broadcast key retrieval request message includes UE-x-ID, SLPBK-ID, and encrypted UE-1-ID. If the receiving UE-x has both SLPBK associated with the received SLPBK-ID and SLPPK of the sending UE-1, skip the steps 8~13.\nNOTE 3: \tthe SLPBK-ID contains UE-1's HPLMN ID and necessary routing information to enable UE-x's serving SLPKMF can route to UE-1's serving SLPKMF.\n9)\t The serving SLPKMF of UE-x determines whether the sending UE-1 and receiving UE-x are with the same HPLMN based on SLPBK-ID. If they are with the same HPLMN, skip steps 10~12. Otherwise, the serving SLPKMF of UE-x should send a key query request to the serving SLPKMF of UE-1 based on SLPBK-ID.\n10)\t The serving SLPKMF of UE-x sends a key query request to the serving SLPKMF of UE-1, with SLPBK-ID and encrypted UE-1-ID.\n11)\t\tThe serving SLPKMF of UE-1 checks whether to return the key based on local policy. If checked, go to step 12.\n12)\t\tThe serving SLPKMF of UE-1 decrypts the encrypted UE-1-ID, determines SLPPK of UE-1 chosen in step 5. The serving SLPKMF of UE-1 returns the key query response to the serving SLPKMF of UE-x, including SLPBK, UE-1's SLPPK, SLAPP-ID, and key expiration time.\n13)\tThe serving SLPKMF of UE-x identifies the SL positioning service and the corresponding ranging/SL application server according to the received SLAPP-ID. It sends SL broadcast receiving authorization request which includes UE-x-ID to the ranging/SL application server to authorize UE-x to receive broadcast messages.\n14)\t\tThe ranging/SL application server authorizes the request based on UE-x's subscription. If the authorization is successful, continue with step 15, otherwise reject the SL broadcast receiving authorization request.\n15)\t\tThe ranging/SL application server provides the SL broadcast receiving authorization response to the serving SLPKMF of UE-x.\n16)\t\tThe serving SLPKMF of UE-x sends a key retrieval response to the UE-x, including SLPBK, SLPPKUE-1, key expiration time.\nNOTE 3a: whether it is feasible to provide every public keys of potential senders to all participating UEs is not addressed in the present document.\nStep14: The decryption stage of the receiving UE-x.\n17)\t\tThe receiving UE-x verifies the token using SLPPKUE-1. If the verification is successful, the UE-x decrypt the broadcast message using the SLPBK. Otherwise, the UE-x disregards the broadcast message.\nNOTE 3b: whether token based authorization is needed is not addressed in the present document.\nNOTE 4: \tAfter the above procedures, the UE-x will also get an SLPBK, if now the UE-x wants to send broadcast message and the SLPBK is unexpired, steps 1-14 still need to be carried out for the UE-x. But to avoid the UEs' key management overhead, in step 5, the serving SLPKMF of the UE-x may decide directly to choose the above SLPBK and associated SLPBK-ID for the UE-x to protect its broadcast message, and only choose a new key pair (SLPSKUE-x, SLPPKUE-x) for the UE-x. The serving SLPKMF of the UE-x can realize the UE-x has already got an SLPBK for a specific SLAPP (the step 12 above contains SLAPP-ID).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.27.3\tSolution Evaluation",
                            "text_content": "None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.28\tSolution #28: Protection of broadcast communication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.28.1\tIntroduction",
                            "text_content": "This solution addresses KI#5 \"Protection of groupcast/broadcast\".\nThe solution is based on the nature of broadcast messaging that the initiator UE broadcasts the message unprotected so that all potentially responding UEs can process it. The sensitive information is resulting in the SL Ranging/Positioning procedure and sent from the responding UEs to the initiator UE. Therefore, the responding UEs are grouped to an temporary Ad-Hoc Group only for the time of the procedure, the communication is protected with an assigned group key so that UEs not involved in the communication are not able to access the sensitive information of the ranging/positioning procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.28.2\tSolution details",
                            "text_content": "The requirement on the communication protection is on the responses from the participating UEs of the ranging/positioning action, since the SL positioning capability, SL positioning assistance data and Location information should not be leaked to other UEs not participating in the SLPP procedure. Therefore the UEs responding to the broadcast request from an Initiator UE will form an ad-hoc temporary group only for the requested action, which will be protected with a group key. All UEs participating in the procedure are assumed to be registered successfully in the network.\nThe figure depicts a schematic of an ad-hoc group creation process for Broadcast SL Positioning in a wireless network. The group is created using a combination of radio frequency (RF) and optical signals, with the RF signal being transmitted over a wireless link and the optical signal being transmitted over a fiber-optic link. The figure illustrates the steps involved in creating the ad-hoc group, including selecting the radio frequency (RF) and optical signals, configuring the radio frequency (RF) link, and configuring the optical link. The figure also shows the use of radio frequency (RF) and optical signals to create the ad-hoc group, with the RF signal being transmitted over a wireless link and the optical signal being transmitted over a fiber-optic link. The figure is used to demonstrate the process of creating an ad-hoc group for Broadcast SL Positioning in a wireless network, with the RF and optical signals being used to create the group.\nFigure 6.28.2-1: Ad-Hoc Group creation for Broadcast SL Positioning\n1.\tUE1 wants to initiate SL broadcast authorization request and sends a broadcast authorization request message to the SL Positioning Key Management Function (SLPKMF) including its UE Identity (UE ID) and the Zone ID where it is located. The Zone ID is defined by RAN2 as indicator of UE1's coarse location information. The message is protected by the NAS protocol.\n2.\tThe SLPKMF sends an Authorization Request of the UE1 for broadcast requests to the Ranging Server function including the UE1 ID and its Zone ID.\n3.\tThe Ranging Application Server authorizes the request e.g. based on the UE1 subscription and stores the Zone ID corresponding to the UE1.\n4.\tThe Ranging Application Server provides the authorization result to the SLPKMF.\n5.\tThe SLPKMF assigns a temporary group ID and Option A: generates a group broadcast key KB for the broadcast communication. The SLPKMF sets a validity time for the broadcast procedure, i.e. UEs responding to the broadcast request of UE1 in step 7 have to respond within the validity time, further the group broadcast key KB in the participating UEs should be removed after expiration of the validity time. The validity time should be therefore set carefully to allow the procedure to complete.\nNOTE 1: the need of Ad-Hoc Group for broadcast is not addressed in the present document\n6.\tThe SLPKMF provides the group ID, Group Broadcast Key KB and validity time to the UE1 in the broadcast authorization response message. UE1 deletes the Group Broadcast Key KB after expiration of the validity time. The message is protected by the NAS protocol.\n7.\tThe UE1 sends a SL broadcast message with a requested positioning/ranging action, the UE1 ID and the temporary group ID.\nNOTE 2: the broadcast messages in step7 are not protected. Security and privacy threats of unprotected broadcast message is not addressed in the present document\n8.\tUE2, UE3, UE4 receive the SL broadcast message and send a Broadcast Key Request to the SLPKMF containing the temporary group ID, UE1 ID and the respective UEx ID as well as the Zone ID, indicating the local area where they are located.\n9.\t The SLPKMF checks whether the UEs respond within the validity time of the broadcast request.\n10.\tThe SLPKMF sends an authorization request to the Ranging Server for the received responses with respect to temporary groupd ID. The request contains the UE1 ID, responder UEx ID and respective Zone ID.\n11.\tThe Ranging Server authorizes the request of the participating UEs and may check whether all participating UEs are located in the same Zone (proximity check), i.e. it compares the Zone ID provided by UE1 in step 2 with the ones from UEx. If the Zones of the UE1 and a responding UEx are different, the authorization may be rejected.\n12.\tThe Ranging Server provides the authorization result to the SLPKMF.\n13. The SLPKMF provides the Group Broadcast Key KB generated in step 5 to all responding UEx.\n14.\tAll UEs participate in the requested SL Ranging/Positioning action according to the request in step 7.\n15.\tIf SLPP Session-based operation is used, the UE1 establishes an SLPP session with the participating UEs. The SLPP Session may use the Broadcast Key KB for authentication and establishment. This step may be skipped if SLPP Session-less operation is used.\n16.\tThe participating UEs provide their results from the performed action in step 14, e.g. Assistance Data/Configuration/Location Information to the UE1, protected with the common group broadcast key KB.\nIf SLPP Session-less operation is used, each participating UE broadcasts the information.\nIf SLPP Session-based operation is used, each participating UE sends the information within the established SLPP session.\n17.\tIf SLPP Session-based operation is used, the UE1 terminates the SLPP session with the participating UEs when the SL Ranging/Positioning action has been completed. All UEs delete the Broadcast Key KB.\nNOTE 3: how broadcast messages are confidentiality and integrity protected are not addressed in the present document\nNOTE 4: Whether the solution is aligned with broadcast scenarios is not addressed in the present document\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.28.3\tEvaluation",
                            "text_content": "The solution applies for in-coverage scenario, all UEs involved in the communication need to be able to communicate with the network.\nThe responses may be sent in an SLPP Session-less or SLPP Session-based operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.29\tSolution #29: Discovery security material and SL session root key provisioning for Ranging/SL positioning UE discovery",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.29.1\tIntroduction",
                            "text_content": "This solution addresses Key issue #3: Protection of discovery procedure and Key issue #4: Protection of unicast direct communication.\nTS 23.586 [11] defines the use cases that the LMF may obtain the UE IDs of Located UE(s), Reference UE(s) and provides the UE ID list to the Target UE to assist Ranging/SL positioning UE discovery and/or Ranging/Sidelink Positioning.\nE.g., for selection of Located UE for Network based SL Positioning (e.g. 5GC-MO-LR or 5GC-MT-LR), the LMF may be pre-configured with the list of candidate Located UEs including e.g. the capability, stationary information, and location information of the Located UE(s), e.g. RSU or the operator deployed Located UE. The LMF may provide to the Target UE a list of candidate Located UE(s) as assistance data. For Ranging/SL Positioning service exposure, the request from AF includes one or multiple target UEs and optionally it may include additional information such as the SL reference UE for relative distance/direction. Then LMF triggers a Ranging/Sidelink Positioning session for involved UE accordingly.\nThis solution proposes that security material used for discovery security between Target UE and Located UE/Reference UE are provisioned by the network as part of DL Positioning procedure. Hence, the Target UE and Located/Reference UE can use the provisioned discovery security material to protect the discovery messages.\nThis solution also proposes that security material used for establishing a secure PC5 link for PC5 communication (called SL session Root Key in the present document, which is used as root to derive PC5 session keys) between Target UE and Located UE/Reference UE can also be provisioned by the network as part of DL Positioning procedure. Hence, the Target UE and Located UE/Reference UE can use the provisioned SL session root key to derive PC5 session keys to protect the PC5 link.\nThis solution assumes both Target UE and Located/Reference UE have connectivity to the network, e.g. to retrieve security materials.\nNOTE 1: For mobile terminated operation, UE may not be always in coverage and have connection. How to solve this issue is not addressed in the present document.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.29.2\tSolution details",
                            "text_content": "Figure 6.29.2-1 illustrates the high-level procedure of the proposed solution.\nThe figure depicts a high-level procedure for security material provisioning for Ranging UE, illustrating the steps involved in ensuring the security of the network.\nFigure 6.29.2-1: High-level procedure for security material provisioning for Ranging UE\n1. \tIn case the AMF receives request for SL Ranging/Positioning (e.g. MO-LR, MT-LR), the AMF triggers positioning of Target UE with the LMF and includes Target UE ID in the message. If the received request includes one or multiple SL reference UE ID(s) (e.g. from original request from AF for Ranging/SL Positioning service exposure), the AMF forwards SL reference UE ID(s) in the LCS service request towards LMF.\nNOTE 1: How AMF can trigger the SL positioning or ranging request is not addressed in the present document.\n2. \tLMF determines to trigger the SL positioning or Ranging to the Target UE. If LMF receives SL positioning request from the Target UE/GMLC/AF via AMF, LMF may determine to trigger SL positioning and provide to the Target UE a list of candidate Located UE(s) as assistance data. If LMF receives Ranging request from GMLC/AF via AMF, LMF may get the Target UE information and the Reference UE(s) information from the request.\nNOTE 2: How LMF obtains and determines the candidate Located UEs is out of scope of the present document.\n3. \tThe LMF obtains the security materials of discovery security for each pair of Target UE and Located/Reference UE from 5G PKMF. The LMF can also generate the discovery security material by itself.\nThe security material for discovery security includes e.g. ProSe Restricted Code, ProSe Query Code, ProSe Response Code, Code-Receiving Security Parameters, Code-Sending Security Parameters, Discovery Query Filter(s), CURRENT_TIME and MAX_OFFSET parameters and the chosen PC5 ciphering algorithm etc.\nThe LMF obtains the security materials of PC5 communication security for each pair of Target UE and Located UE/Reference UE from 5G PKMF. The security material for PC5 communication security includes e.g. secrets that can be used as long term credentials as specified in TS 33.536 for the Target UE and Located UE/Reference UE. The LMF can also generate the security material e.g. SL session root key by itself.\nNOTE 3: How a LMF can interact with 5G PKMF to get the security materials of Target UE/Reference UE/Located UE is not addressed in the present document.\nNOTE 4: The reason for LMF providing the security materials is not addressed in the present document.\n4. \tThe LMF maintains a session ID of positioning requests for each pair of Target UE and Located/Reference UE which is associated with the corresponding security material for discovery security and security material for PC5 communication security.\nThe LMF sends the Ranging/Sidelink positioning requests to Target UE and Located/Reference UE to trigger the Ranging/Sidelink positioning procedure via downlink NAS message. The LMF includes in the message with container for discovery security material and/or the container for SL session root key for PC5 communication security and the associated Session ID.\n5. \tThe Target UE and Located/Reference UE initiates either Model A or Model B discovery procedures over PC5 using the discovery key and the associated discovery codes e.g. ProSe Restricted/Query/Response Code provided by the LMF.\n6. \tIf the container for SL session root key for PC5 link establishment is provisioned, then the Target UE and Located UE/Reference UE initiates PC5 link establishment using the security procedure as specified in TS 33.536 [5]. The Target UE and Located UE/Reference UE authenticate each other based on the provisioned PC5 communication security material from the LMF, e.g. using the secrets in PC5 communication security material as long term credentials as specified in TS 33.536 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.29.3\tEvaluation",
                            "text_content": "None.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tConclusions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tConclusions on Key Issue #1",
                    "description": "",
                    "summary": "",
                    "text_content": "To protect UE privacy of Ranging/SL Positioning services, the following conclusions are made:\n-\tFor privacy protection during discovery:\n-\tThe discovery security materials provisioned during the Discovery Key Request procedure are used to protect the privacy sensitive information (e.g. UE identity) in the discovery messages.\nNOTE 1:\tThe privacy protection of the integrated discovery message for V2X capable UEs is to be aligned with the conclusions on key issue #3.\n-\tFor privacy protection during communication:\n-\tFor unicast direct communication over SR5 reference point, security policy configuration for confidentiality protection is used as the basis for normative work. The security procedures defined in clause 5.3.3.2 of TS 33.536 [5] are reused for non-trackability protection.\n-\tFor Ranging/SL positioning result exposure to a Client UE over PC5, the method of PC5-U security policy setting for confidentiality protection (as defined for ProSe/V2X services) is used.\n-\tFor Ranging/SL positioning result exposure to a Client UE over Uu using enhanced MO-LR procedure, NAS security for confidentiality protection is used.\n-\tFor broadcast communication over SR5 reference point, the broadcast mode security mechanism to randomise the UE's source Layer-2 ID and source IP address including IP prefix (if used), as defined in clause 5.5 of TS 33.536 [5], is reused for non-trackability protection.\n-\tFor groupcast communication over SR5 reference point, the groupcast mode security mechanism to randomise the UE's source Layer-2 ID and source IP address including IP prefix (if used), as defined in clause 5.5 of TS 33.536 [5], is reused for non-trackability protection.\nNOTE 2:\tThe conclusions on broadcast and groupcast communication as above should be aligned with the conclusions on key issue #5.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tConclusions on Key Issue #2",
                    "description": "",
                    "summary": "",
                    "text_content": "The following conclusions are made on Key Issue #2:\n-\tTo authorize an application server or a 5GC NF for Ranging/SL Positioning service exposure, the MT-LR procedure specified in TS 23.273 [9] is taken as the baseline. The GMLC interacts with the UDM to check the UE privacy profile and interacts with the AMF for UE privacy verification.\n- \tFor Ranging/SL Positioning service exposure through the network via control plane (i.e. clause 6.7.1.2.3, TS 23.586 [11]), the SL Positioning Client UE authorization is reusing the MO-LR authorization as specified in TS 23.273 [9].\n-\tFor Ranging/SL Positioning service exposure through PC5, the SL Positioning Client UE authorization is triggered by the Reference/Target UE during PC5 link establishment. The authorization can be performed by the network via the PKMF for ProSe capable UEs or by the Reference/Target UE if the authorization information is available in the UE.\nNOTE:\tWhether the authorization is based on the existing UE LCS privacy profile in UDM or whether it's new data or profile is to be decided in normative work, and needs to be coordinated with SA2.\n-\tTo authorize the UE in its role (e.g. as a Target UE/Reference UE/Located UE/SL Positioning Server UE) in a Ranging/Sidelink Positioning service, the authorization is performed as the following:\n-\tWhen the UE role is claimed towards the network, the authorization of UE role is performed through the interaction with the UDM (via e.g. DDNMF/PKMF/PCF or GMLC) by checking the subscription information on the allowed role(s) of the UE as defined in clause 5.8 of TS 23.586 [11]. Only when the role of the UE is successfully authorized, the subsequent procedure (e.g. generating and provisioning discovery security materials to the UE, Ranging/SL positioning procedure) can proceed.\n-\tWhen the UE role is claimed towards the peer UE, the authorization of UE role is performed by the peer UE via checking the locally pre-configured authorization/privacy verification information, which is provisioned either from the application or from the network.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.3\tConclusions on Key Issue #3",
                    "description": "",
                    "summary": "",
                    "text_content": "For protection of discovery procedure, the following conclusions are made:\n-\tFor ProSe capable UEs, the 5G ProSe Restricted Discovery security procedure defined in clause 6.1.3.2 of TS 33.503 [6] is taken as the baseline for discovery security with the following changes:\n-\tThe discovery security materials are provisioned by 5G PKMF or PCF.\n-\tFor V2X capable UEs, the security procedures defined in clause 5.3.3 of TS 33.536 [5] is reused.\nNOTE: \tWhether the DCR message of V2X capable UEs needs to be protected is to be determined during normative work based on the DCR information.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.4\tConclusions on Key Issue #4",
                    "description": "",
                    "summary": "",
                    "text_content": "For protection of unicast direct communication, the following conclusions are made:\n-\tFor security of SR5 direct communication for Ranging/SL Positioning services provided by application providers, the security mechanisms defined for V2X unicast mode communication in TS 33.536 [5] and for 5G ProSe unicast mode Direct Communication in TS 33.503 [6] are reused.\n-\tFor security of SR5 direct communication for network assisted SL positioning services provided by operators, the security mechanisms defined for 5G ProSe UE-to-Network Relay communication in TS 33.503 [6] can be reused.\n-\tTo protect RSPP unicast messages on SR5 reference point, security policies for the Ranging/SL Positioning service are to be enforced on PDCP layer.\n-\tDuring the establishment of the direct communication for the Ranging/SL positioning service, the UEs reuses the security policy negotiation to decide the security protection status of the direct communication for the Ranging/SL positioning service, as defined in 5G ProSe in TS 33.503 [6] and/or in 5G V2X in TS 33.536 [5].\n-\tSecurity policies for PC5-S integrity and confidentiality and PC5-U confidentiality follow the configurations defined in TS 33.536 [5] for V2X capable UEs and TS 33.503 [6] for ProSe capable UEs. Whether the security policy for PC5-U integrity is configured as \"REQUIRED\" is to be determined during normative work.\n\n\n\n\n",
                    "tables": [
                        {
                            "description": "",
                            "table number": 4,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        }
    ]
}