{
    "document_name": "23700-18-i00.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Report has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, certain modal verbs have the following meanings:\nshall\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nNOTE 1:\tThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nNOTE 2:\tThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\tindicates permission to do something\nneed not\tindicates permission not to do something\nNOTE 3:\tThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\tindicates that something is possible\ncannot\tindicates that something is impossible\nNOTE 4:\tThe constructions \"can\" and \"cannot\" shall not to be used as substitutes for \"may\" and \"need not\".\nwill\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nNOTE 5:\tThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The Technical Report studies and performs evaluations of potential architecture enhancements to enhance the support of service function chaining in the 5G Core network (5GC). Specifically, two objectives are included:\nWT#2: Investigate whether traffic steering policy is sufficient to support SA WG1 requirements in TS 22.101 [5], TS 22.261 [6] and TS 22.115 [7], study whether and how to define Service Function Chaining (SFC) policies, and investigate solutions and procedures for the 5G network with SFC capabilities to identify/detect/classify user plane traffic and steer the traffic to a chain of ordered service functions for SFC processing in non-roaming and home routed roaming scenarios.\nWT#3: Depending on the outcome of WT#2, specify possible enhancement to northbound APIs for allowing an AF to request network capability exposure functionalities, e.g. request a service function chain for a certain traffic flow, etc. based on service level agreement with the third party.\nNOTE 1:\tThis study considers only traffic handled over N6 by PSA UPF(s) in 5G network.\nNOTE 2:\tThe definition of terms in RFC 7665 [8] may be re-used when applicable. The study targets the use of traffic steering concept, e.g. defined by 3GPP (FMSS) and SFC mechanisms defined in IETF when applicable. Especially the study aims at reusing user plane mechanisms (e.g. VXLAN, NSH, GENEVE, GRE, VLAN, etc.) defined at IETF to support SFC, as applicable.\nNOTE 3:\tThe study for SFC will ensure that existing (per 3GPP Rel-17) deployments flexibility can be preserved in deployments of SFC in 5G network.\nNOTE 4:\tThe study assumes a Home Routed roaming PDU Session does not have an offloading point in a VPLMN.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[3]\t3GPP TS 23.502: \"Procedures for the 5G system, Stage 2\".\n[4]\t3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System\".\n[5]\t3GPP TS 22.101: \"3rd Generation Partnership Project; Technical Specification Group Services and Systems Aspects; Service aspects; Service principles\".\n[6]\t3GPP TS 22.261: \"Service requirements for next generation new services and markets; Stage 1\".\n[7]\t3GPP TS 22.115: \"Service aspects; Charging and billing\".\n[8]\tIETF RFC 7665: \"Service Function Chaining (SFC) Architecture\".\n[9]\t3GPP TS 29.244: \"Interface between the Control Plane and the User Plane Nodes\".\n[10]\tIETF RFC 7665: \"Service Function Chain (SFC) Architecture\".\n[11]\tIETF RFC 8300: \"Network Service Header (NSH)\".\n[12]\t3GPP TS 22.105: \"Services and service capabilities\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in TR 21.905 [1], in TS 23.501 [2] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in TR 21.905 [1] or in TS 23.501 [2].\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in TR 21.905 [1], in TS 23.501 [2] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905 [1] or in TS 23.501 [2].\nSF\tService Function\nSFC\tService Function Chaining\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tArchitectural Assumptions and Principles",
            "description": "The concept of the SFC is as shown in Figure 4-1 and the following assumptions are applied in this study:\n-\tEach service function (SF) is an opaque processing element in user plane. The SF forwarder, and SF behaviour/control are out of scope of this study that reuses the features defined by IETF for these purposes.\n-\tThe initial classification for the service chain to be applied to traffic flow is performed by 5GC.\n-\tThe management aspects of SFs, service function paths (SFP), and service function chains are out of scope of the present TR.\n-\tSeveral service function chains can be simultaneously applied within 5GC of an operator network to meet various business requirements with third parties based on service level agreements. A traffic flow of a PDU Session is subject to a single SFP at a given time.\n-\tThe definition of terms and mechanisms in RFC 7665 [8] may be re-used when applicable.\n-\tThe study targets the use of traffic steering concept, e.g. defined by 3GPP (FMSS) and SFC mechanisms defined in IETF when applicable. Especially the study aims at reusing user plane mechanisms (e.g. VXLAN, NSH, GENEVE, GRE, VLAN, etc.) defined at IETF to support SFC, as applicable.\nThe figure depicts a simplified representation of service function chaining concepts in a telecommunications network. It illustrates the flow of data from the source to the destination, with each function (e.g., data transmission, network management, and network control) represented by a distinct node. The figure highlights the importance of service chaining in ensuring efficient and reliable communication.\nFigure 4-1: Illustration of the service function chaining concepts\nFor all objectives, the architectural assumptions and principles include:\n-\tSolutions shall build on the 5G System architectural principles as in TS 23.501 [2], including flexibility and modularity for newly introduced functionalities.\n-\tService path (i.e. for traffic handled by the service functions) is traversed over N6 after PSA UPF(s) in 5G network.\n-\tThe case where SFC would apply for a Home Routed roaming PDU Session at an offloading point in a VPLMN is not considered in this study.\n-\tExisting (per 3GPP Rel-17) deployments flexibility should be preserved in deployments of SFC in 5G network.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "5\tKey Issues",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tKey Issue #1: Traffic Steering Policy and SFC Enhancements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.1.1\tDescription",
                            "text_content": "Currently, the SMF may be configured with the traffic steering policy related to the mechanism enabling traffic steering to the N6-LAN, DN and/or DNAIs associated with N6 traffic routing requirements provided by the AF. Also, UPF with SFC capabilities need to support flexible SFC configuration for a PDU session that requires different SFC processing for different applications. Based on architectural assumptions and principles in clause 4 and service requirements in clause 6.35 of TS 22.261 [6], this key issue is for WT2 to study:\n-\tWhether the existing traffic steering policy is enough to fulfil the SA1 requirements or needs to be enhanced for SFC, and if it needs to be enhanced whether SFC policy need to be defined and how it relates to traffic steering policy. If SFC policy is defined, based on the SFC policy definition, what are the required architecture enhancement for the network functions, interfaces, and the procedures to enforce SFC policies and/or traffic steering policies to identify/detect/classify user plane traffic and steer the traffic flows of the UEs requiring SFC processing for their applications in non-roaming scenarios.\n-\tIf SFC policy is defined, based on the SFC policy definition:\n-\tWhether and how the HPLMN can apply traffic steering policies and/or SFC polices for home routed traffic for cases that UE is at VPLMN, UE returns from VPLMN to HPLMN, or UE changes of serving VPLMN.\n-\tWhat are the relationship between traffic steering and SFC processing in the user plane.\n-\tWhat (if any) are the new features that the UPF may support in order to allow improved Rel-18 SFC capabilities.\n-\tWhether and how to enhance interfaces and procedures to support UPF with SFC capability including how such capabilities may be available, discovered, and controlled by the SMF.\nNOTE:\t5GC exposure aspects are addressed in another Key Issue.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.2\tKey Issue #2: Exposure to enable AF to request predefined SFC for traffic flow(s) related with target UE(s)",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tDescription",
                            "text_content": "For allowing an AF, e.g. a third party AF, to request predefined SFC for traffic flow(s), etc. (when the AF belongs to a third party, this is based on service level agreement with the third party), this key issue will study solutions on:\n-\tHow to enable support for AF to request usage of predefined SFC/SFP(s) for traffic flow(s) related with target UE(s).\n-\tWhether and if yes how to enhance network capability exposure functionalities based on solutions of the User plane related Key issue (WT#2). This includes leveraging that Key issue work on whether the existing traffic steering policy is enough to fulfil the SA1 requirements.\n-\tBased on the requests from the AF, what are the solutions and procedures to interact with network functions in the 5GC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tSolutions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.0\tMapping of Solutions to Key Issues",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 6.0-1: Mapping of Solutions to Key Issues\n\n",
                    "tables": [
                        {
                            "description": "Table 6.0-1: Mapping of Solutions to Key Issues",
                            "table number": 3,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.1\tSolution #1: Re-use of existing TSP for N6-LAN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1.1\tDescription",
                            "text_content": "This solution is based on the existing Rel-17 solution for steering the subscriber's traffic to appropriate operator or 3rd party service functions (e.g. NAT, antimalware, parental control, DDoS protection) in the N6-LAN, as described in e.g. TS 23.503 [4]. The solution is also summarized in Annex A.\nThe solution is based on the following key aspects, based on existing standards:\n-\tThe PCF determines a policy per SDF/application for the purpose of steering the subscriber's traffic to appropriated N6 service functions deployed by the operator or a 3rd party service provider. The policy is expressed in a Traffic Steering Policy (TSP) ID that may be separate in UL and DL directions.\n-\tThe TSP ID refers to a traffic steering behaviour that is configured in the SMF/UPF.\n-\tThe PCF provides the TSP ID in the PCC rules to SMF.\n-\tThe UPF indicates its capability to support traffic steering in N4 and in UPF profile in NRF, as described in TS 29.244 [9]. The SMF may take this capability into account when selecting UPF.\n-\tThe SMF instructs the UPF to perform necessary actions to enforce the traffic steering policy referenced by the PCF. This includes the provisioning of corresponding PDRs, FARs, QERs etc. In particular, the SMF creates a FAR with the Forwarding Policy parameters set to the TSP ID.\n-\tThe UPF performs the necessary actions to enforce the forwarding policy referenced by the SMF, e.g. performing packet marking and routing the traffic towards the service functions within the N6-LAN.\nAs referred in clause 6.3.3 of TS 23.501 [2], several parameter(s) and information may be considered by the SMF for UPF selection and re-selection, e.g.:\n-\tCapability of the UPF and the functionality required for the particular UE session: An appropriate UPF can be selected by matching the functionality and features required for a UE.\n-\tHow the SMF determines information about the user plane network topology and what information is considered by the SMF, is based on operator configuration.\nIn this particular context, SMF shall be able to select appropriate UPF regards specific Traffic Steering Policy based on:\n-\tIf UPF indicated that Traffic Steering is supported by the UP function (TRST flag already present in clause 8.2.25 of TS 29.244 [9] and part of association procedure).\n-\tIt is assumed that 5GC configuration is homogeneous for providing the same set of traffic steering policies within same DNAI/ DNN/ S-NSSAI. SMF can select then, UPF based on DNAI / DNN / S-NSSAI.\nBelow the new SA WG1 requirements introduced for SFC in Rel-18 are listed and comparison with the current TSP based solution is provided.\nTable 6.1.1-1: Analysis of Stage 1 requirements\n\nThere are also additional SA WG1 requirements related to service function management and charging (including also clause 5.2.14 of TS 22.105 [12]). These are not explicitly analysed above since:\n-\tSF deployment, management and definition are out of scope of SA WG2.\n-\tSF charging is out of scope of SA2. It could however be noted that the TSP based solution allows differentiated charging per service chain, since the PCF can select Charging Key in the PCC rule based e.g. on TSP ID.\n-\tService Chains are predefined by the operator and then be referenced by TSP ID.\n-\tSteering protocols to be used (e.g. for encapsulation and/or packet marking) are configured at UPF based on SLA, and it is out of scope of 3GPP what is already described in RFC standards.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.1.1-1: Analysis of Stage 1 requirements",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.1.2\tProcedures",
                            "text_content": "The procedure below shows an example with dynamic PCC Rules. It is also possible to activate predefined PCC Rules with traffic steering policy applied by UPF (not shown in the figure).\nThe figure depicts a procedure for traffic steering policy in a network, illustrating the steps involved in managing network traffic. The figure shows a flow chart with various stages, such as traffic steering, traffic prioritization, and traffic rerouting, which are essential for ensuring efficient and reliable network performance.\nFigure 6.1.2-1: Procedure using traffic steering policy\n1.\tThe PCF makes a policy decision and creates a PCC Rule with SDF filter information or Application ID, TSP IDs, Charging Key, etc.\n2.\tThe SMF creates N4 rules based on the PCC Rule content.\n3.\tThe UPF applies the configured forwarding behaviour to steer the traffic to the appropriate Service Chain based on TSP IDs, e.g. encapsulation, packet marking, forwarding.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.3\tImpacts on existing nodes and functionality",
                            "text_content": "No impacts to current standard.\nAssumptions: All UPFs in the operator network serving as PSA for the DNN/S-NSSAI/DNAI that is used for traffic that is potentially subject to SFC controls need to be configured with traffic steering information towards all SFPs supported on that DNN/S-NSSAI/DNAI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2\tSolution #2: AF influence with explicit traffic steering policies per flow",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tDescription",
                            "text_content": "In order to fulfill traffic steering policies using AF routing influence directly, without re-using the existing routing profiles provided by AF, it can be added new elements in the interface so that traffic steering policies can be explicitly requested per flow.\nThe PCF then provides PCC rules including traffic steering policies based on the traffic steering that are explicitly requested from AF (directly or through NEF).\nNote that currently in PCC rule information in 5GC, the traffic routing policies and traffic steering policies are considered mutually exclusive (see NOTE 18 in table 6.3.1 of TS 23.503 [4]). That means that the PCC rule either indicates traffic steering or N6 traffic routing, but not both simultaneously. It is also not clear how the UPF would handle a PCC Rule that contains (potentially conflicting) Routing Profile IDs and Traffic Steering Policy IDs. Therefore, in order to not impact further in PCF, SMF and UPF, the proposal is to add new traffic steering rules ID(s) from AF in mutually exclusive way with current routing info and/or routing profile ID.\nThis solution thus proposes to add Traffic Steering Policy ID(s) to the existing Nnef_TrafficInfluence (and NpcfPolicyAutorization, Nudr_DataNotification). The AF request can either contain AF-TSP-ID(s) (if two Traffic steering policy identifiers are provided, then one is for uplink direction, while the other one is for downlink direction) for Service Chaining or Traffic Routes for steering to a local DN, not both. PCF may use AF-TSP ID(s) directly, or map to locally defined TSP ID(s) provided to the SMF in the PCC Rule to avoid that AF needs to know how TSP ID are set in the 5GC and therefore isolate it from system configuration changes.\nAs referred in clause 6.3.3 of TS 23.501 [2], several parameter(s) and information may be considered by the SMF for UPF selection and re-selection, e.g.:\n-\tCapability of the UPF and the functionality required for the particular UE session: An appropriate UPF can be selected by matching the functionality and features required for a UE.\n-\tHow the SMF determines information about the user plane network topology and what information is considered by the SMF, is based on operator configuration.\nIn this particular context, SMF shall be able to select appropriate UPF regards specific Traffic Steering Policy based on:\n-\tIf UPF indicated that Traffic Steering is supported by the UP function (TRST flag already present in clause 8.2.25 of TS 29.244 [9] and part of association procedure).\n-\tIt is assumed that 5GC configuration is homogeneous for providing the same set of traffic steering policies within same DNAI/ DNN/ S-NSSAI. SMF can then select then, UPF based on DNAI / DNN / S-NSSAI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tProcedures",
                            "text_content": "The procedure below shows an example of AF using the Traffic Influence API to allow an AF to request a predefined SFC.\nThe figure depicts a procedure for traffic steering policy in a 5G network, illustrating the steps involved in managing network traffic. The figure includes a flow chart with arrows indicating the flow of data, a flow chart with arrows indicating the flow of control, and a flow chart with arrows indicating the flow of information. The flow chart is divided into three main sections: traffic steering, traffic steering policy, and traffic steering control. The figure also includes a flow chart with arrows indicating the flow of control, a flow chart with arrows indicating the flow of information, and a flow chart with arrows indicating the flow of data. The figure is a visual representation of the process, making it easy to understand and follow.\nFigure 6.2.2-1: Procedure using traffic steering policy\n1.\tAF uses Nnef_TrafficInfluence API to influence how to route a specific traffic on specific session, by providing the UE IP address together with the request. The AF includes AF Traffic Steering Policy ID(s) in the request. The NEF identifies the PCF serving the PDU Session and triggers a Npcf_PolicyAuthorization Request, as described in clause 4.3.6.4 of TS 23.502 [3].\n2.\tAF uses Nnef_TrafficInfluence API to influence how to route a specific traffic for a UE ID or a group of UEs, by providing UE ID (GPSI) or External Group ID together with the request. The AF includes AF Traffic Steering Policy ID(s) in the request. The NEF stores the information in the UDR, as described in clause 4.3.6.2 of TS 23.502 [3].\n3.\tPCF used the AF TSP ID(s) requested by the AF and creates PCC rule(s) with TSP ID(s).\n4.\tPCF sends PCC rule(s) to the SMF.\n5.\tSMF sends PDRs information to identify the traffic and forwards it accordingly with the TSPs.\n6.\tUPF applies the PDRs with specific forwarding policies based on TSP ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tImpacts on existing nodes and functionality",
                            "text_content": "AF: Support of providing new information in the Nnef_TrafficInfluence API, to provide explicitly traffic steering policy ID(s) (AF-TSPs) in its requests.\nNEF: Support of new information in the Nnef_TrafficInfluence API, and pass it to UDR and PCF.\nUDR: Supports storage AT-TSP IDs in the AF influence in routing parameters.\nPCF: Accepts new information and use it (or maps to local TSP defined) as traffic steering policies associated to the PCC rule(s) impacted.\nNo normative impacts to SMF and UPF. It is assumed that all UPFs in the operator network serving as PSA for the DNN/S-NSSAI/DNAI that is used for traffic that is potentially subject to SFC controls need to be configured with traffic steering information towards all SFPs supported for that DNN/S-NSSAI/DNAI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tSolution #3: AF influencing Service Function Chaining support by 5GC",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tDescription",
                            "text_content": "This solution addresses mostly Key Issue #2.\nAs already specified by IETF in RFC 7665 [10], Service Function Chain (SFC) is defined as a logical representation of an ordered set (sequence) of Service Functions that need to successively handle some traffic, e.g. traffic is first handled by SF1 (e.g. Deep Packet Inspection (DPI)), then SF 2 (e.g. TCP/IP optimization) and lastly by SF 3 (e.g. Firewall). Service Function Path (SFP) is an implementation/instance of an SFC. In other words, an SFC can be implemented as more than one different SFP instances (e.g. different instances/SFP corresponding to different N6 interfaces between 5GS and the DN). In an SFC the next hop SF (Service Function) may be determined based on the result of traffic processing by the previous SF.\nThe solution aims at improving how an AF can better control SFC related traffic classification in 5GC; it does not address SF control / deployment or SFF (Service Flow Forwarding) that are out of scope of the study.\nCurrent traffic steering  allows an AF to refer to abstract traffic steering policies that are predefined in 5GC: the AF cannot control the mapping from these abstract traffic steering policies to the actual user plane actions carried out by the PSA UPF (adding Vxlan/NSH/… headers to the traffic referred to as SFP Id and metadata information in this solution). This is suitable for SFC entirely controlled by the 5GC operators\nThe format of the SFP Id and of metadata (when provided) being referred to refers to existing IETF specifications such as the IETF specifications defining VxLAN and NSH.\nCurrent Traffic steering control includes applying a specific N6 Traffic Steering Policy (TSP) to steer traffic to N6. TSP ID(s) are mapped within the 5GC based on local configuration: in PCF, in SMF or in UPF; this means that AF that can't influence the local configuration for TSP mapping lacks control on service flow classification in 5GC.\nNOTE:\tRel-17 specification (TS 23.501 [2]) e.g. tells \"The PCF, based on information received from the AF, operator's policy, optionally service experience analytics per UP path received from NWDAF, etc. authorizes the request received from the AF and determines for each DNAI, a traffic steering policy ID (derived from the routing profile ID provided by the AF) and/or the N6 traffic routing information (as provided by the AF) to be sent to the SMF as part of the PCC rules. The traffic steering policy IDs are configured in the SMF or in the UPF. The traffic steering policy IDs are related to the mechanism enabling traffic steering to the DN\".\nFor this scenario it is desirable for the AF to be able to discover the SFC(s) made available by the 5GC operator.\nThe SFC information, i.e. the available SFCs and their types, as well as the service path related classification tag (referred to as SFP Id and metadata information in this solution) and DNAI, is available to 5GC so that such information can be exposed to the AF via NEF API, and the AF can therefore associate some traffic with a certain SFC by indicating the SFC ID. This corresponds to Rel-17 specifications where the TSP ID takes the value of the SFC ID.\nNOTE 3:\tWhen the 3RD party can use SFP and SF(s) deployed by the operator following issue can take place: if the operator changes the configuration of the SF(s) then it can change the data service provided to the (3rd party) users of the SFP/SF(s). When as in scenario 2, the 3rd party manages the SFC/SFP/SF(s) and uses just 5GC as traffic classifier (to identify and tag the traffic and send it to the SFP(s)) there is no such issue as the same entity (3rd party) manages the SFP(s) and uses it.\nNEF APIs is used:\n(new) NEF (optional) API allowing the AF to contact 5GC to discover available SFC/SFP. This allows the AF to discover SFC(s) that are deployed by the operator. This is intended for the first scenario.\nNOTE 4:\tThe NEF API allowing the AF to discover available SFC/SFP is just an optional capability to facilitate invocation of the NEF API allowing the AF to associate certain traffic and UE(s) with 5GC defined SFC/SFP(s) identified by traffic steering policies.\nThe AF provides a SFC ID to NEF in Nnef_SFCInfluence.\nNOTE: As soon as a 3RD party use SFP and SF(s) deployed by the operator, if the operator changes the configuration of the SF(s) then the operator may change the data service provided to the (3rd party) users of the SFP/SF(s).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tProcedures",
                            "text_content": "The SFC / SFP configuration (from the AF) aims at providing PCF with information on:\n-\tTraffic classification (SFC classification role of the PSA UPF):\n-\tWhich PDU Session should a SFC apply to, for which UE(s), DNN(s) and or S-NSSAI(s));\n-\tWhich traffic of such PDU Session is to be handled by the SFC.\n-\t(for the second scenario) the How should the UPF \"tag\" (e.g. NSH / VXLAN tag etc.) the classified traffic for each SFP associated with the SFC (SFP Id and metadata information to be used by the UPF).\nThe above information is used by PCF to create PCC rules for PDU Sessions. In order to support the second scenario PCC rules and N4 rules (FAR) need extension to carry the SFP Id and metadata information. For example, the FAR / Outer header creation information needs new values corresponding to NSH / VXLAN tag etc to be added after SFC classification done by the PSA UPF.\nFor the NEF, the following new northbound APIs are introduced:\n-\tNnef_SFCInfluence: This API allows an AF to associate traffic that is identified by traffic filters and UE(s) (e.g. one UE, a group of UEs, a (set of) DNN/SNSSAI pair, etc.) with SFC and SFP(s).\nWhen the solution refers to \"Nnef_SFCInfluence\", updates to Nnef_TrafficInfluence may fulfill the requirements set by the solution.\nWhen SFCInfluence targets multiple UEs the NEF stores the AF policy in an UDR record.\nThe PCF(s) that have subscribed to modifications of AF requests (Data Set = Application Data; Data Subset = SFC or traffic influence request information, Data Key = S-NSSAI and DNN and/or Internal Group Identifier or SUPI) receive(s) a Nudr_DM_Notify notification of data change from the UDR.\nThe keys for these data in UDR are:\n\n\nThis is further defined in clause 6.3.2.1.\n-\tNnef_SFCDefinition: This API allows an AF to discover SFCs for the first scenario. The AF can also subscribe to be notified when new SFCs are deployed or existing SFCs are undeployed or modified. In case of SFC discovery, the NEF returns the Identifier of the available SFC(s) and an ordered list of service functions in each SFC to NEF which forwards the information to the AF.\nNOTE:\tThe name of each service function should be understandable to the AF, (allowing AF to understand that SFC 1 has Parental control first then NAT, then FW); such naming convention may be based on SLA with the AF.\nNOTE:\tNnef_SFCDefinition assume that via SLA the operator and the third party agree on a common understanding on the name of each service function and let's the 5GC operator the possibility to create SFC(s) using these SF without needing to update the SLA.\nUsage of Nnef_SFCDefinition is further defined in clause 6.3.2.3.\nThe figure depicts a network architecture with a SFC (Serving Function Controller) associated with certain traffic and UE (User Equipment) traffic. The SFC is responsible for managing and routing traffic, ensuring efficient and reliable communication. The figure illustrates the various traffic flows and their associated SFCs, providing a clear understanding of the network's structure and functionality.\nFigure 6.3.2.1-1: Associating an SFC with certain traffic and UE(s)\n0.\tThe PCF(s) subscribe to modifications of AF requests with Nudr_DM_Subscribe (Data Set = Application Data; Data Subset = AF SFC influence request information, Data Key = S-NSSAI and DNN and/or Internal Group Identifier or SUPI).\n1.\tThe AF is made aware of the available SFC(s). This may be via mechanisms of Figure 6.3.4-1 or via mechanism out of scope (e.g. SLA).\n2.\tAF issues Nnef_SFCInfluence_Create request. The request may include\n-\ttraffic filters of the traffic to which the SFC applies;\n-\tthe identification of the target UE(s) (one UE a group of UE(s) or any UE), possibly the target DNN, S-NSSAI (if this is not provided by the AF, the NEF determines the target (DNN(s), S-NSSAI(s) based on the AF identifier);\n-\t(for the second scenario) for each SFP associated with the SFC, the SFP Id and metadata information on how should the UPF \"tag\" (e.g. NSH / VXLAN tag etc.) the classified traffic;\n-\tin scenario 1 the AF provides a SFC ID Nnef_SFCInfluence;\n-\tAF Transaction Id.\nTo update or remove an existing request, the AF invokes a Nnef_SFCInfluence_Update or Nnef_SFCInfluence_Delete service operation providing the corresponding AF Transaction Id.\n3.\t(in the case of Nnef_ SFCInfluence_Create or _Update): The NEF stores the AF request information in the UDR (Data Set = Application Data; Data Subset = AF SFC influence request information, Data Key = AF Transaction Internal ID, S-NSSAI and DNN and/or Internal Group Identifier or SUPI).\nNOTE:\tBoth the AF Transaction Internal ID and, S-NSSAI and DNN and/or Internal Group Identifier or SUPI are regarded as Data Key when the AF request information are stored into the UDR.\n(In the case of Nnef_SFCInfluence_Delete): The NEF deletes the AF requirements in the UDR (Data Set = Application Data; Data Subset = AF SFC influence request information, Data Key = AF Transaction Internal ID).\n3b.\tThe NEF responds to the AF.\n4.\tThe PCF(s) that have subscribed to modifications of AF requests (Data Set = Application Data; Data Subset = AF SFC influence request information, Data Key = S-NSSAI and DNN and/or Internal Group Identifier or SUPI) receive(s) a Nudr_DM_Notify notification of data change from the UDR.\n5.\tThe PCF determines if existing PDU Sessions are potentially impacted by the AF request. For each of existing or new PDU Sessions, the PCF updates the SMF with corresponding policy information about the PDU Session by invoking Npcf_SMPolicyControl_UpdateNotify Npcf_SMPolicyControl_Create service operation as described in clause 4.16 of TS 23.502 [3].\n(For the second scenario) policy information indicates for each SFP, how the UPF should \"tag\" (e.g. NSH / VXLAN tag etc.) the classified traffic identified by the PCC rule traffic filters.\n(For the first scenario) The PCF maps the SFC ID to a TSP ID provided in the PCC rules: policy information indicates how the UPF should \"tag\" (e.g. via traffic steering identifiers etc.) the classified traffic identified by the corresponding SF filter(s).\n6.\tWhen policy information about the PDU Session is received from the PCF, the SMF may take appropriate actions to configure the User Plane of the PDU Session (policy information received at PDU Session establishment) or reconfigure the User Plane of the PDU Session (policy information while a PDU Session establishment is already established).\nNOTE:\tHow the 5GC selects the PSA UPF that can support traffic classification and tagging for SFPs corresponding to AF request of the 3rd party is discussed in clause 6.3.2.4.\n(For the second scenario) N4 rules (FAR/ Outer Header creation) indicate how the UPF should \"tag\" (e.g. NSH / VXLAN tag etc.) the classified traffic identified by the corresponding PDR(s).\n(For the first scenario) N4 rules (FAR/ Outer Header creation) indicate how the UPF should \"tag\" (e.g. via traffic steering identifiers etc.) the classified traffic identified by the corresponding PDR(s).\nIf an SFC needs to be associated with an individual UE identified by its address, BSF is involved to select the corresponding PCF.\nThe figure depicts a 3D representation of a 5G network, illustrating the association of an SFC (Serving Function Center) with an individual UE (User Equipment). The figure shows the various components involved in the network, such as the base station (gNB), user equipment (UE), and scatterers. The diagram highlights the importance of beamforming techniques to mitigate interference and ensure reliable communication.\nFigure 6.3.2.2-1: Associating an SFC with an individual UE\n1.\tThe AF sends the AF request via NEF, and the Nnef_SFCInfluence_Create/Update/Delete Request targets an individual UE address. This request corresponds to an AF request to influence the association of an SFC to an individual UE address.\n2.\tNEF consumes Nbsf_Management_Discovery service operation (providing at least the UE address) to find out the address of the relevant PCF if the PCF address is not available on the NEF based on local configuration.\nNOTE:\tThe NEF finds the BSF based on local configuration or using the NRF.\n3.\tBSF provides the PCF address in the Nbsf_Management_Discovery response to NEF.\n4.\tNEF invokes the Npcf_PolicyAuthorization service to the PCF to transfer the AF request.\n5.\tAs in steps 5 and 6 of Figure 6.3.2.1-1.\nThe AF may discover the available SFCs deployed over N6 via NEF with a new Nnef_SFCDefinition service. This is further described in the rest of this clause.\nFigure 6 illustrates the process of discovering available SFC(s) in a 3GPP network. The figure shows a network with multiple SFCs, each representing a different type of service. The SFCs are connected to the base station (gNB) and the user equipment (UE), forming a network of interconnected services. The figure also includes a visual representation of the network topology, showing the paths between the SFCs and the gNB. This helps in understanding the network's structure and the flow of data.\nFigure 6.3.2.3-1: Discovering available SFC(s)\n1.\tThe AF uses Nnef_SFCDefinition_GET to request a catalogue / list of existing SFC(s) matching some criteria (such as SFC involving NFx and NFy; the criteria could also list all existing SFC(s)). The NEF validates the request and forwards it to the O&M together with information on the AF Id and on the allowed (DNN, S-NSSAI) for the request.\n2.\tThe O&M entity responds with a list of SFC(s) that:\n-\tmatch the criteria requested by the AF, or\n-\tare allowed for the AF (for example that apply to the slices and AF Id indicated by the NEF).\nThe O&M entity response contains a list of SFC(s) with at least their SFC ID, the ordered set of NFs of the SFC. This response is forwarded by the NEF using Nnef_SFCDefinition_GET result to the AF.\nAfter the AF selects one SFC based on its own requirement, the AF can procedure to associate certain traffic and UE(s) to the selected SFC, as illustrated in Figure 6.3.2.2-1.\nAt PDU Session establishment (and when it selects a new PSA UPF, e.g. when IPV6 Multi-Homing applies), the SMF needs to ensure that it selects PSA UPF(s) that can support traffic classification and tagging that may be required by PCC rules applying to the PDU Session where these PCC rules correspond to corresponding to SPF related AF requests.\nThe operator can have SLAs with multiple 3rd parties and the predefined SFPs for distinct 3rd parties can be deployed in distinct UPFs or in the same UPF(s).\nWhen a UPF is registered / registers in NRF its capability to support a (DNN, S-NSSAI) this means that it supports the classification capability and traffic tagging capabilities (e.g. support NSH header insertion and/or support VxLAN addressing) required by SFP(s) applicable for this (DNN, S-NSSAI). Thus when the SMF selects a PSA UPF that supports the DNN and slice of the PDU Session this ensures that this PSA UPF can support traffic classification and traffic tagging capabilities that may be needed to support SFP(s) that may be required by an AF request that applies to this PDU Session. When PSA UPF(s) with very specific capabilities are required to handle some traffic the URSP sent to the UE guide the UE to use for this traffic a (DNN, S-NSSAI) leading the SMF to select these PSA UPF(s)\nThis does not mean that all traffic filters values and traffic tagging values are known in advance and defined as part of the SLA between the operator and the Third party. Nnef_SFCInfluence allows the 3rd party to define new set of traffic filters and of traffic tagging values but within predefined capabilities negotiated in the SLA with the third party\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.3.3\tImpacts on existing nodes and functionality",
                            "text_content": "-\tA new NEF API(s) and possibly updates to Nnef_TrafficInfluence.\n-\tPCC rules and N4 rules (FAR) need extension to carry the SFP Id and metadata information (traffic tagging information) to support the second scenario.\n-\tThe format of the SFP Id and of metadata (when provided) being referred to refers to existing IETF specifications such as the IETF specifications defining VxLAN and NSH.\n-\tIt is assumed that all UPFs in the operator network serving as PSA for the DNN/S-NSSAI/DNAI that is used for traffic that is potentially subject to SFC controls need to be configured with traffic steering information towards all SFPs supported for that DNN/S-NSSAI/DNAI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tSolution #4: SFC support in 5GS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4.1\tDescription",
                            "text_content": "This solution addresses Key Issue#1 (Traffic Steering Policy and SFC Enhancements) and Key Issue#2 (Exposure to enable AF to request predefined SFC for traffic flow(s) related with target UE(s)).\nThis solution proposal assumes that there is a service level agreement between the operator and a third party that includes a list of authorized predefined Service Function Paths (SFPs), each SFP being identified by a Service Function Chaining Identifier (SFP ID). Each SFP implements a set of pre-agreed policies (i.e. an ordered set of operations to be applied on the user plane packets) whose definition is outside of SA WG2 scope. By indicating an SFP ID, the third party can request that selected traffic flows be steered towards a specific SFP, either at PDU Session establishment or any time after PDU Session establishment.\nThe service level agreement can also contain a pre-agreed set of Metadata that the third party is allowed to insert into the SFP. Example use of Metadata is to allow the third party to include/exclude specific service operation in/from the SFP (e.g. age verification, denial of using specific application, etc.) for selected users.\nThe solution reuses the following definition from RFC 7665 [8].\n-\tMetadata: Provides the ability to exchange context information between classifiers and SFs, and among SFs.\n-\tService Function Path (SFP): The service function path is a constrained specification of where packets assigned to a certain service function path must go. While it may be so constrained as to identify the exact locations, it can also be less specific. The SFP provides a level of indirection between the fully abstract notion of service chain as a sequence of abstract service functions to be delivered, and the fully specified notion of exactly which SFF/SFs the packet will visit when it actually traverses the network. By allowing the control components to specify this level of indirection, the operator may control the degree of SFF/SF selection authority that is delegated to the network.\n-\tSFC Encapsulation: The SFC encapsulation provides, at a minimum, SFP identification, and is used by the SFC-aware functions, such as the SFF and SFC-aware SFs. The SFC encapsulation is not used for network packet forwarding. In addition to SFP identification, the SFC encapsulation carries metadata including data-plane context information.\nThis solution assumes that there is a user plane function with SFC capability (denoted as UPF-SFC), which interfaces with the PDU Session Anchor (UPF-PSA) over the N6 reference point. The UPF-SFC includes at least the Service Classification Function as defined in IETF RFC 7665 [8]. In addition, the UPF-SFC may include support for SFC Encapsulation, SFC Forwarding Function, etc. as described in IETF RFC 7665 [8]).\nIn the Control Plane the following network functions are impacted for handling of the SFP ID and/or Metadata: NEF, UDR, SMF and PCF.\nFigure 6.4.1-1 shows the 5G system architecture for SFC support.\nThe figure depicts the 5G system architecture for SFC support, illustrating the various components and their roles in the network. The diagram includes a 5G base station (gNB), user equipment (UE), and scatterers, highlighting the importance of beamforming techniques to mitigate interference. The layered design of the optical backbone ensures redundancy and failover reliability.\nFigure 6.4.1-1: 5G system architecture for SFC support (uplink traffic)\nThe 5G system architecture for SFC support (downlink traffic) in Figure 6.4.1-2 illustrates the various components and their interactions, including the base station (gNB), user equipment (UE), and scatterers. The diagram highlights beamforming techniques to mitigate interference, and the layered design aligns with SDN principles.\nFigure 6.4.1-2: 5G system architecture for SFC support (downlink traffic)\nUplink traffic: solid orange line for traffic that is steered to the UPF-SFC; dashed orange line for traffic that goes directly to the Data Network as illustrated in Figure 6.4.1-1.\nDownlink traffic: solid green line for traffic that is steered to the UPF-SFC; dashed green line for traffic that goes directly to the UE as illustrated in Figure 6.4.1-2.\nIn Figure 6.4.1-2, it is assumed that each SFP for downlink traffic enforces the steering of processed traffic flows back into the same UPF-SFC.\nIn pre-Rel-18 3GPP specifications, the AF can provide traffic steering information (TSI) that can contain e.g. targeted traffic descriptor, a list of DNAI(s), a Routing Profile ID and/or N6 routing information. As an example, the traffic steering information can instruct the UPF to select a specific preconfigured tunnel on N6 for the traffic flows matching the traffic descriptor.\nThis solution proposes that the main SFC-specific impact (i.e. SFC service classification, SFP selection, SFC encapsulation etc.) is concentrated in the UPF-SFC. The other impacted functions (PCF, NEF, SMF, UDR) primarily participate in forwarding of the SFC-specific parameters (SFP ID and Metadata) between the AF and the UPF-SFC.\nAn example deployment option would be where the SFC is hosted in a trusted Edge Data Network environment and is operated by a trusted 3rd party. The AF in the trusted Edge Data Network environment can dynamically make decisions for steering of selected traffic flows onto a selected SFP and optionally convey Metadata to the Service Functions on that SFP. Such a deployment corresponds to RFC 8300 [11] Figure 10 (External Metadata and Policy), whereby an external network can provide Metadata containing classification information for policy enforcement and context information for forwarding packets within an SFC.\nThe following are the salient features of this solution:\n-\tThe UPF-PSA uses existing mechanisms for packet data detection (local F-TEID and SDF filters) and forwarding (remote F-TEID) to steer the targeted traffic flows towards the UPF-SFC. There is no specification impact on the UPF-PSA.\n-\tIn the presence of multiple UPF-PSAs and multiple UPF-SFCs, the traffic forwarding between a specific UPF-PSA and a specific UPF-SFC takes place over a pair of N6s tunnels associated with the UPF-PSA and UPF-SFC, one tunnel per traffic direction as illustrated in Figure 6.4.1-1 and Figure 6.4.1-2. This pair of N6s tunnels is set up dynamically by the SMF and is UE-specific. The same pair of tunnels can be used for all traffic flows between UPF-PSA and UPF-SFC for this UE, regardless of the SFP that is used at the UPF-SFC.\n-\tNote that due to the \"hairpin\" forwarding of downlink traffic over N6s, the N6s tunnel for downlink traffic is used in both directions. In contrast, the N6s tunnel for uplink traffic is used in one direction only.\n-\tThe UPF-PSA is the IP anchor point for the PDU sessions. When downlink traffic arrives at the UPF-PSA from the Data Network (see Figure 6.4.1-2), the UPF-PSA detects the traffic that is subject to SFC and steers it towards the UPF-SFC based on the FAR configured in the UPF-PSA. Once the service function processing is applied in UPF-SFC, the DL traffic is sent from the UPF-SFC to the UPF-PSA based on the FAR configuration in the UPF-SFC which is then further forwarded towards the UE by the UPF-PSA.\nNOTE 1:\tWhen the SFP for uplink traffic contains a Network Address Translation (NAT) device, the corresponding downlink traffic will arrive directly at the NAT device. In that case, after performing the network address translation, the NAT device needs to steer the downlink packet towards the N6 interface of the UPF-PSA. The steering is performed via standard IP routing because the new IP address will automatically steer the downlink packet towards the N6 interface of the UPF-PSA.\n-\tUplink traffic that is not subject to SFC can break out directly to the DN via N6 (see Figure 6.4.1-1). Downlink traffic always enters the 5GS at the UPF-PSA and only selected traffic is steered towards SFC (via \"hairpin\" forwarding), while the rest of the traffic is forwarded to N3/N9.\n-\tThe UPF with SFC capability (UPF-SFC) deploys an SFC functionality with several SFPs corresponding to pre-defined SFC polices as indicated in Figure 6.4.1-1 and Figure 6.4.1-2.\n-\tThe AF indicates the SFP ID and optionally Metadata for a selected target (e.g. a traffic flow, a UE, a group of UEs, etc.) per traffic direction.\n-\tThe PCF authorizes the requested SFP ID(s) and Metadata strings (if provided by the AF) e.g. by checking whether it is part of a pre-agreed SFP ID list in the service level agreement. The 5GC may need to parse or interpret the Metadata strings e.g. to check whether the requested Metadata strings is on the agreed SLA list, but it does not make any other use of the Metadata strings apart from forwarding it to the UPF-SFC.\n-\tThe SMF indicates the SFP ID(s) and optionally Metadata to the UPF-SFC via N4 interface in a FAR. The targeted traffic flows description is provided in a PDR.\n-\tThe UPF-SFC steers the targeted traffic flows towards the SFP indicated by the received SFP ID. Additionally it may perform SFC encapsulation as defined in RFC 8300 [11] and include the received Metadata in the SFC encapsulation header.\nNOTE 2:\tIt is also possible to rely on the existing traffic steering information to identify a specific SFP, rather than introducing the new SFP ID parameter. For instance, there can be several pre-defined N6 tunnels between the UPF-PSA and the UPF-SFC, each N6 tunnels corresponding to a distinct SFC path. However, this would create an undesired dependency between the configuration of N6 tunnels and the configuration of SFPs. For instance, every time an SFP is added or removed, this would imply reconfiguration of the N6 tunnels. Moreover, the use of preconfigured N6 tunnels may have scalability issues because the SMF would need to select a specially configured UPF-PSA upon PDU Session establishment, even if there is no SFC-related request from a 3rd party during the lifetime of the PDU Session. In contrast, keeping SFP ID as a distinct parameter allows for changes in the SFP configuration without any impact on the 5GC user plane configuration. It also allows for selecting a generic UPF-PSA during PDU Session establishment with no SFC-related pre-configuration. Note also that N4 is needed to convey the Metadata information to the UPF-SFC.\n-\tThe UPF-SFC can support data usage reporting on per SFP basis to the SMF. The SMF can provision the URR in UPF-SFC and the UPF-SFC can send the report back to SMF when the threshold or trigger condition is met as described in clause 5.2.2 of TS 29.244 [9].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.2\tProcedures",
                            "text_content": "Figure 6.4.2-1 illustrates the enhancements to the procedure for processing AF requests to influence traffic routing for PDU Sessions not identified by a UE address, as described in clause 4.3.6.2 of TS 23.502 [3]. This procedure is used when targeting a group of UE(s), or any UE accessing a combination of DNN and S-NSSAI, or targeting individual UE by a GPSI. The SFP ID and Metadata provided as part of this procedure are applied upon PDU Session establishment, but can also result in modification of already established PDU Sessions that are impacted by the AF request.\nThe figure depicts a procedure for AF-influenced traffic routing in a 5G Core Network (5GC) for PDU sessions not identified by an UE address. It illustrates the steps involved in determining the source of the traffic and routing it accordingly. The figure includes a flow chart with arrows indicating the flow of information, and a legend to explain the different colors and symbols used in the diagram. The figure is important for understanding the complex network architecture and the role of the 5G Core Network in managing traffic and ensuring reliable communication.\nFigure 6.4.2-1: Procedure for AF influenced traffic routing for SFC in 5GC for PDU Sessions not identified by a UE address\n1.\tThe AF creates AF request that includes an SFP ID and, optionally, Metadata corresponding to that SFP ID, in addition to existing parameters (e.g. Traffic descriptor, Application Identifier, to the NEF for requesting traffic routing to a SFP identified by the SFC ID. The Metadata is optional and available only when needed for configuring required application related information at UPF-SFC.\n2.\tThe AF sends the AF request via Nnef_TrafficInfluence_Create/Update/Delete message to NEF.\n3a.\tThe NEF requests to store/update/remove information of PFD(s), SFP ID and Metadata based on Application ID/Traffic descriptor.\n3b.\tThe NEF returns Nnef_TrafficInfluence_Create/Update/Delete response message to AF.\n4.\tThe PCF(s) that have subscribed to modifications of AF requests (Data Set = Application Data; Data Subset = AF traffic influence request information, Data Key = S-NSSAI and DNN and/or Internal Group Identifier or SUPI) receive(s) a Nudr_DM_Notify notification of data change from the UDR including the SFP ID and the Metadata.\n5.\tThe PCF checks if the indicated SFP ID corresponds to an authorized SFC policy for the AF. If the check is successful, the PCF notifies SMF via Npcf_SMPolicyControl_UpdateNotify message including PCC rules. The PCC rules contain SFP ID and Metadata (if available), in addition to existing parameters, such as PFD(s)\n6a.\tThe SMF selects UPF-SFC taking into account specific optional UPF capabilities as described in clause 6.3.3 of TS 23.501 [2] and the SFP ID. In this case the specific capabilities refer to the SFC-related capability and configuration in the UPF.\n6b.\tIn case there is no established tunnel between UPF-PSA and UPF-SFC for this UE, the SMF requests allocation of two tunnel endpoints at the UPF-PSA (one tunnel per traffic direction).\n6c.\tIn case there is no established tunnel between UPF-PSA and UPF-SFC for this UE, the SMF requests allocation of two tunnel endpoints at the UPF-SFC (one tunnel per traffic direction).\n6d.\tBased on the PCC rules received from the PCF, the SMF configures the UPF-PSA via N4 message including PDR and FAR as described in Table 6.4.2-1.\nTable 6.4.2-1: PDR and FAR configuration in UPF-PSA\n\n6e.\tBased on the PCC rules received from the PCF, the SMF configures the UPF-SFC with uplink and downlink PDR and FAR via N4message as described in Table 6.4.2-2.\nTable 6.4.2-2: PDR and FAR configuration in UPF-SFC\n\nFigure 6.4.2-2 illustrates the enhancements to the procedure for processing AF requests to influence traffic routing when targeting a specific UE address, as described in clause 4.3.6.4 of TS 23.502 [3]. The SFP ID and Metadata provided as part of this procedure are applied any time after PDU Session establishment.\nThe figure depicts a procedure for AF-influenced traffic routing in 5G, specifically for SFC (Serving Function Control) in 5GC (5G Core). It illustrates the steps taken to route AF-influenced traffic to an individual UE address, considering the impact of AF on the network. The figure includes key components such as the SFC, UE, and the network infrastructure, highlighting the importance of network design and management in ensuring efficient and reliable communication.\nFigure 6.4.2-2: Procedure for AF influenced traffic routing for SFC in 5GC when targeting an individual UE address\nDepending on the AF deployment (see clause 6.2.10 of TS 23.501 [2]), the AF may send the AF request to PCF directly, in which case step 1 is skipped, or via the NEF.\n4.\tIf step 1 was performed, NEF invokes the Npcf_PolicyAuthorization service to the PCF to transfer the AF request. If an AF sends the AF request directly to the PCF, AF invokes Npcf_PolicyAuthorization service and the PCF responds to the AF. The Npcf_PolicyAuthorization service request includes the SFP ID and (optionally) the Metadata, in addition to existing parameters e.g. UE address and targeted traffic flows description.\n5.\tThe PCF authorizes the AF request and performs the steps 5, 6a and 6b described in Figure 6.4.1-1.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.4.2-1: PDR and FAR configuration in UPF-PSA",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.4.2-2: PDR and FAR configuration in UPF-SFC",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.4.3\tImpacts on existing nodes and functionality",
                            "text_content": "NEF:\n-\tNEF forwards the SFC-specific parameters from the AF to the PCF.\nPCF:\n-\tPCF checks if the indicated SFP ID and Metadata corresponds to an authorized SFC policy for the AF.\n-\tIncludes SFP ID and Metadata (if available).\nUDR:\n-\tThe UDR stores the SFP ID and Metadata based on Application ID/Traffic descriptor.\nSMF:\n-\tThe SMF configures the UPF-SFC with PDR and FAR via N4 message. The FAR includes the SFP ID and the Metadata (if available).\nUPF-SFC:\n-\tThe UPF with SFC capability deploys an SFC functionality (i.e. SFC service classification, SFP selection, SFC encapsulation etc.) with several SFPs corresponding to pre-defined SFC polices.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tSolution #5: UPF enhancement with SFC capability",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tDescription",
                            "text_content": "In this study, the UPF with SFC capabilities need to be enabled to offer flexible SFC configuration for a PDU session that requires different SFC processing for applications. This solution will resolve key issue 1 in order to provide UPF support with SFC capabilities.\n5GS performs classification and SFC encapsulation used by the SFC-aware functions as a traffic classifier (Figure 6.5.1-1). The SFC encapsulation offers, at a minimum, Service Function Path (SFP) identification as defined in IETF RFC 7665 [8], such that SFC-aware functions can use it. The AF supplies predefined SFC ID and optional metadata allowing the 5GS to transport the classified packets along the service path via SFC encapsulation. If the AF does not provide SFC ID, predefined SFC ID referenced by TSP ID is used for SFC encapsulation. This solution explains how SFC capabilities in the 5GS may be made available, identified, and controlled.\nThe figure depicts a 5G signal classifier, illustrating the various traffic classification methods used in 5G networks. The classifier is composed of multiple layers, each representing a different classification technique. The figure highlights the importance of signal strength, channel quality, and user location in determining the classification of traffic.\nFigure 6.5.1-1: 5GS as a traffic classifier\nWhen the AF provides predefined SFC ID, 5GS can employ AF influenced traffic routing to detect application traffic for classification. The information requested by the AF is shown in Table 6.5.1-1. The data can also be used to detect traffic flows in order to perform SFC processing. The SFC encapsulation, however, requires SFC ID and optional metadata. As a result, in the AF influenced traffic routing, SFC ID and optional metadata are newly defined in AF requests. Metadata includes data plane context information which is carried in the SFC encapsulation. In this solution, metadata is an optional addition to the SFC ID, as indicated in Table 6.5.1-1.\nTable 6.5.1-1: AF request in AF influenced traffic routing\n\nAccording to the PCC rule, traffic steering can be handled in one of the following ways in the solution:\n-\tN6-LAN traffic steering (Figure 6.5.2-1).\n-\tAF influenced traffic steering (Figure 6.5.2-2).\nThe PCF decides which traffic steering can be operated in the 5GS between N6-LAN traffic steering and AF influenced traffic steering. Therefore, SFC ID can be decided by the PCF when the AF requests them via the NEF, or they can be pre-configured statically in the PCF. According to the predefined SFC policy, which is agreed upon by PLMN and a third party and specified in a SLA, the 5GS may employ combined N6-LAN traffic steering for downlink traffic and AF influenced traffic steering for uplink traffic.\nWith the addition of SFC ID and optional metadata for the SFC encapsulation in the UPF, the PCC rule can be used to detect and steer traffic flows. SFC ID and metadata are now defined in the PCC rule and the Forwarding Action Rule (FAR), as shown in Tables 6.5.1-2 and 6.5.1-3. The traffic steering policies for all SFCs supported by the DNN/S-NSSAI/DNAI should be set in the UPF with SFC capability, which serves as the PSA for the DNN/S-NSSAI/DNAI. It is believed that the same set of traffic steering policies are configured on the 5GS within the same DNN/S-NSSAI/DNAI. As a result, the UPF can be chosen using DNN/S-NSSAI/DNAI. With the inclusion of SFC ID, the existing traffic steering mechanism is reused. Predefined SFC policy may indicate SFC header (e.g. network service header (NSH)) and transport protocol (e.g. VXLAN, GRE, MPLS, IP-in-IP) for the traffic flow. SFC ID may be used as SFP ID for the traffic flow to provide SFC encapsulation for the traffic flow. Alternatively, UPF may map SFC ID to one of the SFP ID(s) in the predefined SFC policy.\nTable 6.5.1-2: The elements related to traffic steering in the PCC rule information in 5GC\n\nTable 6.5.1-3: Forwarding Action Rule related to traffic steering\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.5.1-1: AF request in AF influenced traffic routing",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.5.1-2: The elements related to traffic steering in the PCC rule information in 5GC",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.5.1-3: Forwarding Action Rule related to traffic steering",
                                    "table number": 10,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.5.2\tProcedures",
                            "text_content": "Traffic steering can be operated in either N6-LAN traffic steering or AF influenced traffic steering, according to the PCC rule.\nThe traffic steering policy identifier(s) are used with N6-LAN traffic steering to direct traffic to the relevant N6 service functions deployed by the operator. Figure 6.5.2-1 depicts the procedure of N6-LAN traffic steering with SFC capabilities.\nThe figure depicts a network setup with multiple layers, including a router, a switch, and a firewall. The router is responsible for routing traffic between the different layers, while the switch is used to forward traffic between the router and the firewall. The firewall is responsible for filtering traffic based on the rules set by the router. The figure also includes a diagram of the network topology, showing the connections between the different layers. The figure is used to illustrate the process of traffic steering with SFC capabilities, which is a technique used to improve the performance of a network by allowing traffic to be routed based on the current state of the network.\nFigure 6.5.2-1: The procedure of N6-LAN traffic steering with SFC capabilities\n1.\tThe PCF provides N6-LAN traffic steering policy with additional SFC ID in the PCC rule to the SMF during SM Policy Association Establishment, SMF initiated SM Policy Association Modification, or PCF initiated SM Policy Association Modification procedure as defined in clauses 4.16.4 and 4.16.5 of TS 23.502 [3].\n2.\tThe SMF is triggered to either provision or remove the traffic steering policy when the PCC rule with SFC ID is provided from the PCF.\n3.\tThe SMF sends N4 Session Establishment/Modification/Release request to the UPF in order for the traffic steering policy with SFC capabilities to be provisioned or removed. Then, the UPF acknowledges with N4 Session Establishment/Modification/Release response message.\nFigure 6.5.2-2 depicts AF influenced traffic steering with SFC capabilities. The procedure for SFC capabilities is summarized here.\nThe figure depicts the procedure of AF (Adaptive Frequency) influenced traffic steering with SFC (Software Defined Networking) capabilities, illustrating how traffic steering is achieved through the use of SFC. The figure shows the steps involved in the process, including the selection of the appropriate SFC algorithm, the selection of the appropriate AF algorithm, and the implementation of the SFC algorithm. The figure also includes a visual representation of the traffic steering process, showing how the SFC algorithm adjusts the frequency of the traffic signals to optimize the performance of the network.\nFigure 6.5.2-2: The procedure of AF influenced traffic steering with SFC capabilities\nThe procedure of Processing AF requests to influence traffic routing for Sessions not identified by an UE address in clause 4.3.6.2-1 of TS 23.502 [3] is performed with the following modifications and clarifications:\n1.\tTo create a new request, the AF invokes a Nnef_TrafficInfluence_Create service operation. The content of this service operation (AF request) is defined in clause 5.2.6.7 of TS 23.502 [3] with additional SFC ID.\n2.\tSFC ID is delivered in AF request from the AF to the NEF.\n3.\tThe NEF stores the AF request information in the UDR including SFC ID.\n5.\tFor PDU Sessions impacted by the AF request, the PCF updates the SMF with corresponding new policy information including SFC ID.\n6.\tWhen the updated policy information about the PDU Session is received from the PCF, the SMF may take appropriate actions to reconfigure the User plane of the PDU Session includingSFC ID, as shown in Table 6.5.1-3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tImpacts on existing nodes and functionality",
                            "text_content": "AF:\n-\tNeeds to support SFC ID for requesting AF influenced traffic routing.\nNEF:\n-\tNeeds to support SFC ID in order to deliver them from the AF to the PCF.\n-\tNeeds to store SFC ID in the UDR.\nPCF:\n-\tNeeds to support SFC ID in the PCC rule, either for N6-LAN traffic steering or for AF influenced traffic steering.\nSMF:\n-\tNeeds to use the N4 interface to provision/remove SFC ID contained in FAR.\nUPF:\n-\tNeeds to support SFC encapsulation with several SFPs corresponding to predefined SFC polices.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.6\tSolution #6: Service Function Chaining Configuration",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tDescription",
                            "text_content": "This solution aims to address KI#2 (i.e. \"How to enable support for AF to request predefined SFC/SFP(s) for traffic flow(s) related with target UE (s)\").\nTo address how to enable support for AF to request predefined SFC/SFP(s) for traffic flow(s) related with target UE (s) i.e. how to enable support for AF to configure pre-defined SFC policy for target UE(s) to 5GS, this solution follows the principles below:\n-\tFrom the SLA, AF already knows the granularities of SFC classification rules and predefined SFC information (SFC IDs)\n-\tAF interacts with NEF to request to apply predefined SFCs for target UE(s) by using new service operations (i.e. Nnef_SFC_ConfigCreate service operation with SFC Configuration Parameter) or extended AF traffic influence service operations (i.e. Nnef_TrafficInfluence_Create service operation with SFC Configuration Parameter).\n-\tThe service operations' request message may contain at least the SFC Configuration Parameter. The following table shows the SFC Configuration Parameter:\nTable 6.6.1-1: SFC Configuration Parameter\n\n-\tThe granularity classification rule in Table 6.6.1-1 should be followed by \"Traffic Description\" that represents the target traffic by the combination of DNN and optionally S-NSSAI, and application identifier or traffic filtering information.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.6.1-1: SFC Configuration Parameter",
                                    "table number": 11,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.6.2\tProcedures",
                            "text_content": "Figure 6.6.2-1 outlines the procedure for configuring SFC policy for target UE(s).\nThe figure depicts a procedure for configuring SFC policy for target UE(s) in a 5G network. It illustrates the steps involved in setting up the SFC policy, including selecting the target UE(s), configuring the policy, and ensuring that the policy is applied correctly. The figure also includes a visual representation of the SFC policy, which is a key component in ensuring network performance and security.\nFigure 6.6.2-2: Procedure for configuring SFC policy for target UE(s)\n1.\tAF requests a SFC policy for the target UE(s) to NEF by invoking Nnef_SFC_ConfigCreate service operation or enhanced Nnef_TrafficInfluence_Create service operation with SFC Configuration Parameter.\nFor instance, if AF wants to use the predefined SFC 1 (e.g. Firewall  DPI) for the traffic from UE1 (IP address: y.y.y.z) to the application server (IP address: X.X.X.2, port number: 80), AF sends the request message with below SFC Configuration Parameter.\n[UE identities: \"y.y.y.z\", [SFC ID: \"SFC 1\", [Classification rules: [Classification rule type: \"IP Packet Filter Set\", [Source IP address: \"y.y.y.z\", Destination IP address: \"x.x.x.2\", Source Port: \"any\", Destination Port: \"80\"]]]].\n2.\tNEF interacts with PCF to configure SFC policy for target UE(s).\n3.\tNEF responds with the Nnef_SFC_ConfigCreate or Nnef_TrafficInfluence_Create response.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.3\tImpacts on existing nodes and functionality",
                            "text_content": "AF:\n-\tNeeds to support SFC Configuration Parameter for requesting SFC policy.\nNEF:\n-\tNeeds to support SFC Configuration Parameter in order to configure SFC policy in the PCF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tSolution #7: Enhancing Application Function influence on traffic routing to an N6-LAN based on pre-defined SFC policies",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.7.1\tDescription",
                            "text_content": "Editor's note:\tThis clause will describe the solution principles and architecture assumptions for corresponding key issue(s) which should be explicitly stated. (Sub) clause(s) may be added to capture details.\nThe present solution addresses the following:\n-\tHow an AF is aware of the available pre-defined SFC policies in a 3GPP network.\n-\tHow an AF influences traffic steering for application traffic to an N6-LAN.\nThe solution supports both scenarios where network operator owns/deploys SFCs that are hosted in the 5GC network (Scenario 1) and SFCs hosted by 3rd party network.\nTwo options are proposed:\nOption 1: AF is aware via SLA agreements the SFC policy identifier(s) that corresponds to a specific Service Function Chaining.\nThis option assumes that AF is aware of the SFC Policy identifier(s) corresponding to a service function chain based on SLA agreements.\nOption 2: AF requesting an SFC policy based on the available /pre-configured  Service Function Chain policies supported by the 5GS network.\nThe AF then requests from the 3GPP network if there are available/pre-configured an SFC policies based on the Service Functions required, via a new SBI interface. The AF request to the 3GPP network (via NEF) can include the following information:\n-\tAn ASP identifier.\n-\tOptionally a UE identifier (or Group identifier).\n-\tA list of one or more SF service identifier. The SF identifier is a scalar value that identifies a particular service of the Service Function, for example, Firewall, Video Transcoding etc. The SF Service Identifiers are negotiated between the 3rd party AF and network operator based on SLA agreements.\nThe 3GPP network authorises the AF request and provides the SFC policies to the AF where each SFC policy is identified by a specific SFC policy identifier.\nWhen the AF requires to enable SFC policies the AF can re-use the Nnef_TrafficInfluence SBI including in the request the target UEs, service data flow information of the traffic to be routed an SFC policy identifier. To address scenario 2 the AF additionally includes:\n-\tDNAI information allowing the SMF to select a UPF capable to interface with a 3rd party SFC.\n-\tMetadata information allowing a UPF to identify how to tag user plane traffic sent to an external 3rd party SFC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.2\tProcedures",
                            "text_content": "Editor's note:\tThis clause describes high-level procedures and information flows for the solution.\nThe procedure for requesting N6-LAN services is as follows:\nThe figure depicts a network scenario where an AF (Access Facilitator) is requesting pre-defined SFC (Service Facilitator) policies. The SFC is responsible for managing the network's service provisioning and policy enforcement. The AF's request is based on the SFC's predefined policies, which dictate the network's service quality and availability. The figure illustrates the interaction between the AF and SFC, highlighting the importance of clear communication and collaboration in managing the network's service provisioning.\nFigure 6.7.2.1-2: AF requesting pre-defined SFC policies\nThe procedure is as follows:\n0.\tOPTION 1: The AF is aware of the available SFCs and corresponding SFC policy identifier(s) in a network. This can be based on SLA agreements.\nOPTION 2: AF requesting SFC policies based on pre-defined SF services available either in the 5GC or hosted by a 3rd party.\n1.\tThe AF is triggered to discover an SFC policy. For example, enable voice transcoding.\n2.\tThe AF invokes an Nnef_SFC_Policy_Get_Request including an identifier of the ASP, optionally external identifiers (GPSI) and a list of SF service ID(s).\n3.\tThe NEF forwards the request to the PCF invoking an Npcf_SFC_Policy_Create request.\n4.\tThe PCF may check in the UDR if there are available SFC policies for the ASP.\n5.\tThe PCF makes a policy decision and determines the SFC policies for the ASP.If there in no SFC policy available for the requested service the PCF rejects the request.\n6.\tThe PCF includes the SFC policy according to the AF request identified by an SFC policy identifier.\n7.\tThe NEF forwards the response to the AF.\nEditor's note:\tWhether Option 1 or Option 2 will be used for configuration of SFC policies when the SFC is hosted by the 5GC operator is to be determined at conclusions phase.\nWhen the AF is triggered to enable an N6-LAN service the AF invokes an Nnef_TrafficInfluence_Create that includes the UE ID or Group ID of the affected UEs and N6-LAN steering information.\nThe N6-LAN steering information includes:\n-\tApplication ID or Traffic Filters of the affected application.\n-\tSFC policy identifier according to the N6-LAN service requested by the AF as described in Figure 6.7.2.1-1.\n-\tApplicable S-NSSAI/DNN information.\nIf S-NSSAI/DNN is included the policy is applicable for all UEs that have established a PDU session at this DNN and/or S-NSSAI.\nThe NEF determines the internal identifier of the UE(s) (i.e. SUPI) and update the subscription in the UDR by invoking an Nnef_DM_Update request service operation. The NEF updates the subscription data in the UDR.\nThe UDR notifies the PCF of the updated subscription information. The PCF determines the affected UEs, PDU sessions and application traffic and determines new or updated PCC rules where the PCC rule includes traffic descriptors of the traffic that needs to be routed to the operator's N6-LAN network and corresponding traffic steering policy identifier of the associated SFC policy (identified by the SFC policy identifier). The PCF then provides updated PCC rules to the SMF. The SMF configures the UPF with the traffic steering policy identifier corresponding to the SFC policy identifier that allows the UPF to route application traffic to the N6-LAN network.\nThe detailed procedure is illustrated below:\nThe figure depicts a network scenario where an AF (Access Facilitator) is requesting to enable an N6-LAN service for a UE (User Equipment). The figure shows the network topology, including the N6-LAN service, the UE, and the access points (APs). The AF is requesting to enable the service, and the APs are responsible for providing the necessary connectivity. The figure also includes the network diagram, showing the paths and connections between the different components.\nFigure 6.7.2.2-1: AF requesting to enable an N6-LAN service for a UE\n1.\tThe AF is triggered to enable an SFC policy for a UE or group of UEs.\n2.\tThe AF invokes an Nnef_TrafficInfluence Create including in the request the external identifier of the UE (or Group of UEs) and in a container SFC steering information that includes, an application id or traffic filters of the application and an SFC policy identifier. The AF may include a DNAI and metadata information for the case where SFC are owned by a 3rd party.\n3.\tThe NEF determines the SUPI of the UE by interfacing with the UDM. The NEF may also determine if the ASP is authorized to use the SFC policy by interfacing with the UDR.\n4.\tThe NEF updates the subscription data in the UDR by invoking an Nudr_DM_Update service operation including SFC steering information as a data subset under the Application Data Set and adding the SUPI of the affected UEs as a Data Key.\n5.\tThe UDR notifies the PCFs that have subscribed to be notified of the changes in the subscription profile\n6.\tThe UDR invokes an Nudr_DM_Notify service operation including the updated subscription information.\n7.\tThe PCF determines the affected UEs, traffic and PDU sessions where the SFC policy needs to be included/updated.\n8.\tThe PCF provides updated PCC rules including the corresponding pre-defined traffic steering policy identifier for N6-LAN to the SMF. If metadata information is provided in step 2 the PCF forwards the information to the SMF.\n9.\tThe SMF selects a UPF based on existing mechanisms and configures the UPF according to the PCC rules. The SMF sends over N4 a Forward Action Rule request including in the request traffic filters and the traffic steering policy identifier. The SMF includes the metadata if provided by the PCF in step 8.\nNOTE:\tSMF selects a UPF based on DNAI if provided by the AF in step 2.\n10.\tThe UPF and routes traffic corresponding to the traffic filters to N6-LAN. If metadata information is provided by the SMF, the UPF classifies the packet, e.g. by adding VxLAN information according to the metadata information, before routing the packet to the SFC function.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.3\tImpacts on services, entities and interfaces",
                            "text_content": "Editor's note:\tThis clause captures impacts on existing 3GPP nodes and functional elements.\n-\tNew SBI supporting an AF to discover the available SFC policies.\n-\tEnhancing Nnef_TrafficInfluence SBI supporting steering of traffic to N6-LAN.\n-\tIf metadata is supported:\nAF including metadata information in traffic influence request;\n-\tNEF, PCF, SMF forwarding metadata information to UPF;\n-\tUPF tagging the packet according to metadata information before routing the packet to the N6-LAN network.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.8\tSolution #8: AF request predefined SFC for traffic flow(s) related with target UE(s)",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tDescription",
                            "text_content": "The AF-influenced traffic steering enforcement control information is used to influence SMF routeing decisions for an identified traffic of PDU Session. It steers the user traffic to a local access to a Data Network (identified by a DNAI) per AF request. The AF-influenced traffic steering enforcement control information can be derived by the PCF based on the N6 Traffic Routing requirements provided by the AF. Until Rel-17 this is supported in non-roaming scenarios and to LBO deployments only.\nThe N6-LAN traffic steering enforcement control steer the identified traffic to appropriate operator 3rd party service functions in the N6-LAN. When the PCF generate the PCC rule for the SMF, the N6-LAN traffic steering enforcement control information is generated based on the operator's policy. This is supported in non-roaming and home-routed scenarios only. However that information is not generated or derived based on AF request.\nThe AF-influenced traffic steering enforcement control is only applied to the uplink traffic in the existing specification. The N6-LAN traffic steering enforcement control can be applied to the downlink traffic, uplink traffic or both. The N6-LAN Traffic steering policy identifiers can be different for uplink and downlink direction.\nTable 6.3.1 of TS 23.503 [4] indicates that either N6-LAN Traffic Steering Enforcement Control or AF influenced Traffic Steering Enforcement Control can be included within a PCC rule. It means that traffic steering and SFC can't be applied to the same application traffic simultaneously.\nFrom above analysis, it can be concluded that the N6-LAN traffic steering control (i.e. SFC policy) is different from the AF-influenced traffic steering enforcement control (i.e. traffic steering policy).\nIt is proposed that SFC policy and traffic steering policy is separated. An Application Function may send a request to influence SFC enforcement for the application traffic. In the request, the AF shall include the N6-LAN traffic steering control information, which includes target UE Identifier(s), DNN, S-NSSAI, SFC identifier (uplink and/or downlink), to the 5GC based on the SLA between the operator and the 3rd party. The PCF authorizes the N6-LAN traffic steering control information received from AF based on the SFC identifier (uplink and/or downlink) and operator's policy when generating the PCC rule. And then the N6-LAN traffic steering enforcement control information provisioning and enforcement defined in clauses 6.1.3.14 and 6.2.2.6 of TS 23.503 [4] can be applied, i.e. installing the related rule at UPF.\nThe figure depicts a complex network architecture, specifically a 5G network, with a focus on signal propagation and traffic steering control flow. It illustrates the various components involved, such as base stations (gNB), user equipment (UE), and scatterers, as well as the use of beamforming techniques to mitigate interference. The figure also highlights the importance of redundancy paths and the use of SDN principles for network management.\nFigure 6.8.1-1: Architecture and traffic steering control flow\nNOTE 1:\tbased on the local configuration, the UPF can differentiate the packet coming from N6-LAN or from N6 interface as described in clause 5.4.8 of TS 29.244 [9]\nIt is possible that N6-LAN traffic steering control and AF-influenced traffic steering control are both applied to the same application traffic simultaneously.\n-\tIf the N6-LAN traffic steering enforcement control in downlink is applied when the AF-influenced traffic steering enforcement control is applied, the PCF include N6-LAN traffic steering policy identifier in downlink, and AF-influenced traffic steering policy identifier or N6 traffic routing information per DNAI within a PCC rule.\n-\tIf the N6-LAN traffic steering enforcement control in uplink is applied simultaneous as the AF-influenced traffic steering enforcement control is applied, the PCF shall include N6-LAN traffic steering policy identifier in uplink and AF-influenced traffic steering policy identifier or N6 traffic routing information per DNAI within a PCC rule.\nSimilar with the AF influenced traffic steering control defined in clause 4.3.6.1 of TS 23.503 [4], the following cases can be distinguished:\n-\tAF requests targeting an individual UE by a UE address; these requests are routed (by the AF or by the NEF) to an individual PCF using the BSF. This is described in clause 6.8.2.1.\n-\tAF requests targeting a group of UE(s), or any UE accessing a combination of DNN and S-NSSAI, or targeting individual UE by a GPSI. This is defined in clause 6.8.2.2.\nSame general handing as described in clause 4.3.6.1 of TS 23.502 [3] are executed, e.g. how the NEF map the AF request to the DNN, S-NSSAI.\nNOTE 2:\tThe solution assumes that the 5GC and the AF have agreed via SLA on the mapping between a SFC identifier and for each DNAI/ N6 interface: the corresponding SFP, the metadata that the UPF should send to the SFP once it has done its SFC related classification.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tProcedures",
                            "text_content": "The figure depicts an AF request targeting an individual UE address, illustrating the process of handling such requests in an 802.11 wireless network. The figure shows the steps involved in the request, including the sender, the destination, the authentication method, and the authentication key. The figure also includes a visual representation of the request, such as the request header and the response header, to provide a clear understanding of the request and response process.\nFigure 6.8.2.1-1: Handling an AF request targeting an individual UE address\n1.\tStep 1 to step 5 of figure 4.3.6.4 of TS 23.502 [3] are performed with following modifications and exceptions:\n-\tIn step 1, the AF provides the N6-LAN traffic steering control information in the request. If the AF-influenced traffic steering control for the same application traffic is required simultaneously, the AF-influenced traffic steering control are provided additionally in the request.\n-\tIn step 4, the AF or the NEF provides the N6-LAN traffic steering control information in the request. If the AF-influenced traffic steering control for the same application traffic is required simultaneously, the AF-influenced traffic steering control are provided additionally in the request.\nIn both cases the N6-LAN traffic steering control information includes SFC identifier (uplink and/or downlink).\n-\tIn step 5, the PCF authorizes the N6-LAN traffic steering enforcement control information based on the received the N6-LAN traffic steering control information and the operator's policy. The N6-LAN traffic steering enforcement control information includes the appropriate N6-LAN Traffic steering policy identifier(s) (uplink and/or downlink), which is derived from the AF provided SFC identifier (uplink and/or downlink). If both the N6-LAN traffic steering control information and AF-influenced traffic steering control information are provided, the PCF authorizes the N6-LAN traffic steering enforcement control information and AF-influenced Traffic Steering Enforcement Control information separately.\n2.\tStep 1 to Step 4 of Figure 6.8.2.3-1 is performed.\nThe figure depicts a network scenario where an AF request is not identified by an UE address, illustrating the challenges faced in network management and addressing issues in real-time.\nFigure 6.8.2.2-1: Handling an AF request not identified by an UE address\n1.\tStep 1 to step 5 of Figure 4.3.6.2 of TS 23.502 [3] are performed with following modifications and exceptions:\n-\tIn step 1, the AF provides the N6-LAN traffic steering control information in the request, which includes SFC identifier (uplink and/or downlink). If the AF-influenced traffic steering control for the same application traffic is required simultaneously, the AF-influenced traffic steering control information are provided additionally in the request.\nNOTE:\tThe AF that issues the AF-influenced traffic steering control information may be different from the AF that issues N6-LAN traffic steering control information. When the PCF receives the kind of information via N5 or via UDR notifications, it is up to the PCF to create PCC results that result from the aggregation of both information.\n-\tIn step 3, the NEF stores the AF request information in the UDR (Data Set = Application Data; Data Subset = N6-LAN traffic steering control information, Data Key = AF Transaction Internal ID, S-NSSAI and DNN and/or Internal Group Identifier or SUPI).\n-\tIn step 4, the PCF(s) that have subscribed to modifications of AF requests (Data Set = Application Data; Data Subset = N6-LAN traffic steering request information, Data Key = S-NSSAI and DNN and/or Internal Group Identifier or SUPI) receive(s) a Nudr_DM_Notify notification of data change from the UDR.\n-\tIn step 5, the PCF authorizes the N6-LAN traffic steering enforcement Control information based on the received N6-LAN traffic steering control information and the operator's policy. The N6-LAN traffic steering enforcement control information includes the appropriate N6-LAN Traffic steering policy identifier(s) (uplink and/or downlink), which is derived from the AF provided SFC identifier (uplink and/or downlink).\n2.\tStep 1 to Step 4 of Figure 6.8.2.3-1 is performed.\nThe figure depicts a traffic steering enforcement control system, which is a crucial component in ensuring traffic safety and efficiency in a network. The system uses a combination of traffic steering algorithms to manage the flow of traffic, preventing congestion and collisions. The figure shows the various components of the system, including traffic sensors, steering algorithms, and control centers, all working together to maintain a smooth flow of traffic.\nFigure 6.8.2.3-1: Traffic steering enforcement control\n1.\tThe PCC rule which include the N6-LAN traffic steering enforcement control information is installed at the SMF as described in clause 6.8.2.1 or clause 6.8.2.2.\n2.\tIf both the N6-LAN traffic steering enforcement control information and AF-influenced traffic steering enforcement control information are provided by the same AF, the SMF may inserts/reselect an I-UPF/L-PSA according to current procedure.\nNOTE 1:\tIt is assumed that 5GC configuration is homogeneous for providing the same set of traffic steering policies within same DNAI/ DNN/ S-NSSAI. SMF can select then, UPF based on DNA/DNN/ S-NSSAI.\n3.\tThe SMF generates the N4 rule based on the received PCC rule as follows:\n-\tif only N6-LAN traffic steering enforcement control is enforced, besides the PDR SMF derives the forwarding policy identifier (uplink and/or downlink) within the FAR based on the authorized the N6-LAN traffic steering enforcement control information.\n-\tif only AF-influenced traffic steering enforcement control is enforced, besides the PDR SMF derives the forwarding policy within the FAR based on the authorized the AF-influenced traffic steering enforcement control information.\n-\tif both N6-LAN traffic steering enforcement control and AF-influenced traffic steering enforcement control are enforced:\n-\tIf the N6-LAN traffic steering enforcement control in downlink is applied when the AF-influenced traffic steering enforcement control is applied, the SMF generates two PDR and FAR pairs. The first PDR and FAR pair is associated the downlink N6-LAN traffic steering policy handing. The second PDR and FAR is associated with the uplink AF influenced traffic steering policy handling.\n-\tIf the N6-LAN traffic steering enforcement control in uplink is applied when the AF-influenced traffic steering enforcement control is applied, the SMF generates two PDR and FAR pairs. The first PDR and FAR pair is associated the N6-LAN traffic steering policy handing. The second PDR and FAR is associated with the AF influenced traffic steering policy handling for traffic after N6-LAN traffic steering handling.\nNOTE 2:\tThe UPF enforce the first PDR and FAR pair to steer the uplink traffic to the N6-LAN and then enforce the second PDR and FAR pair to steering the uplink traffic, which has been processed by the SF(s) and routed back to the UPF, to the local network.\nThe SMF provisions the N4 rule to the UPF (PSA) by initiating the N4 session establishment or modification.\n4.\tPer the received forwarding policy, when the UPF (PSA) detects the related traffic, the UPF steers the corresponding traffic to the service function(s) deployed in the N6-LAN if applicable, and further steer the traffic to the local data network if applicable. How to steering the traffic is out of 3GPP scope.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.3\tImpacts on existing nodes and functionality",
                            "text_content": "The solution has impacts in the following entities:\nAF:\n-\tNeeds to support to include the N6-LAN traffic steering control request information in the request.\nNEF:\n-\tNeeds to support to transfer the N6-LAN traffic steering control request information.\nUDR:\n-\tNeeds to support to store the N6-LAN traffic steering control request information.\nPCF:\n-\tNeeds to support to authorize the N6-LAN traffic steering enforcement control information based on the received the N6-LAN traffic steering control information.\nSMF:\n-\tNeeds to support to derive two PDR and FAR pairs. The first PDR and FAR pair is associated the N6-LAN traffic steering policy handing. The second PDR and FAR is associated with the AF influenced traffic steering policy handling.\nIt is assumed that all UPFs in the operator network serving as PSA for the DNN/S-NSSAI/DNAI that is used for traffic that is potentially subject to SFC controls need to be configured with traffic steering information towards all SFPs supported for that DNN/S-NSSAI/DNAI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tOverall Evaluation",
            "description": "Editor's note:\tThis clause will provide evaluation of different solutions.\nEvaluation of solutions for KI1 and KI#2:\nSolutions are so far split into the following categories:\n-\tAF influencing steering of subscriber traffic to SFC deployed by the 3GPP operator or 3rd party service provider. Solutions propose to re-use the Nnef_TrafficInfluence API where the AF includes an identifier that denotes steering the traffic to specific N6 service functions/Service Function Chain. The solutions can be further categorized into:\n-\tSolutions where the AF includes a new SFC Policy Identifier corresponding to specific Service Function chain based on SLA agreements (Solutions 2, 3, 4, 5, 6, 7, 8). AF is aware of the SFC policy identifier based on SLA agreements between the AF and 3GPP operator.\n-\tIn solution 1 it is assumed that the same existing Traffic Steering Policy identifier can be used.\n-\tSome solutions also propose the AF to include additionally metadata information denoting specific SFC classification. (Solutions 3, 4, 5, 7).\n-\tSolutions where the AF discovers the available Service Function Chain policies (and corresponding SFC Policy Identifier(s) of a 3GPP operator (Solutions 3, 6, 7). A new API is proposed where the AF gets a list of available SFC matching some criteria (e.g. SFC involving specific Service Function) (Solutions 3,6) or the AF requesting configuration of an SFC policy.\n-\tProcedure in the 3GPP network to steer traffic to corresponding Service Function Chain over N6-LAN:\n-\tAll solutions propose the PCF to construct PCC rules taking into account the information in the AF request. The PCC rule includes a SFC Policy Identifier (potentially different for UL and DL traffic). The SMF based on the PCC rule, provides appropriate N4 rules (e.g. FAR, PDR etc) for the application traffic including the SFC policy identifier. The UPF based on the N4 rules and SFC Policy Identifier routes traffic to appropriate SFC in N6-LAN.\n-\tOne solution proposes to re-use the existing Traffic Steering Policy Identifier to steering traffic to N6-LAN (Solution 1).\n-\tThere are different proposals on how to handle UPF selection for SFC. Some solutions propose the SMF to select a UPF based on existing mechanisms (e.g. based on DNN/S-NSSAI, DNN) (Solutions 1, 2, 3, 7, 8), or the SMF ensures that an SFC-capable UPF is selected (Solutions 4). An SFC-capable UPF meaning a UPF that is able to do service classification as defined in IETF specifications. An SFC-capable UPF is able to use metadata information (if provided by the AF) to carry out the service classification.\n-\tSome proposals also denote that if the AF includes metadata information, then the PCC and SMF provide the metadata transparently to the UPF for service classification (Solutions 3, 4, 5, 7).\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "8\tConclusions",
            "description": "Conclusions for KI#1 are as follows:\nIt is recommended to use the following principles and procedures as the basis for the normative work.\n-\t5GC may receive from the AF policies associating for one UE, a group of UE(s) or all UE(s) some traffic (filter) with SFC policy IDs together with optional metadata.\n-\tPCF checks whether the indicated SFC policy IDs and Metadata correspond to an authorized SFC policy.\n-\tBased on AF request, the PCF determines a policy per SDF/application for the purpose of steering the subscriber's traffic to appropriated N6-LAN service functions deployed by the operator or a 3rd party service provider. The policy is expressed in a Traffic Steering Policy (TSP) IDs that may be different in UL and DL directions.\n-\tThe PCF maps the SFC ID(s) into a TSP ID(s) (possibly one per direction) that refers to a traffic steering behaviour that is configured in the SMF/UPF. The SMF/UPF do not need to be aware of SFC IDs.\n-\tThe PCF provides the TSP ID(s) and the metadata (if available) in the PCC rules to SMF. The TSP ID refers to a traffic steering behaviour that is configured in the SMF/UPF.\n-\tThe SMF provisions corresponding PDRs, FARs, QERs to support SFC.\n-\tThe SMF creates a FAR with the Forwarding Policy parameters set to the TSP ID, and the FAR includes the metadata (if available).\n-\tThe UPF serving as PSA uses TSP ID to steer traffic over N6-LAN. The UPF performs the necessary actions to enforce the Forwarding Policy, e.g. performing packet encapsulation, packet marking and routing the traffic towards the service functions in the N6-LAN. The UPF provides the metadata (if available) together with the traffic sent to the N6-LAN service functions.\nNOTE 1:\tHow the UPF transforms the metadata into actual information sent with the traffic (e.g. NSH header, etc.) is based on local policies related with the TSP ID and not specified.\nNOTE 2:\tThe NEF, PCF and SMF do not need to understand the metadata.\n-\tIt is assumed that all UPFs in the operator network serving as PSA for the DNN/S-NSSAI/DNAI subject to SFC control need to be configured with the same traffic steering information for SFC processing.\nConclusions for KI#2 are as follows:\nTo enable the AF to request pre-defined SFC for traffic flow(s) related with target UEs.\n-\tThe Nnef_TrafficInluence API is enhanced to include additionally an SFC policy identifier corresponding to a pre-defined Service Function Chain policy. The request may include separate SFC policy identifiers for Uplink and Downlink traffic of the subscriber traffic.\n-\tOnly following information of Nnef_TrafficInfluence API are reused with N6 Traffic Routing requirements containing the SFC related additions described in this clause.\nTable 8-1\n\n-\tThe AF is aware of SFC policy identifiers based on SLA agreements.\n-\tThe PCF maps the SFC policy identifier to a corresponding identifier within the PCC rule. This mapping is defined in the conclusions of KI1.\n-\tSupport the N6-LAN traffic steering control and AF-influenced traffic steering control to be applicable to the same traffic simultaneously.\n-\tThe procedure for the Nnef_TrafficInluence service in TS 23.502, clause 4.3.6 is re-used, for example, in case the AF is not providing UE address the NEF stores the AF request information in UDR.\nThis Annex provides the excerpts referring to the existing traffic steering control as well as general PCC and edge computing related concepts in TS 23.501 [2], TS 23.502 [3] and TS 23.503 [4].\n1.\tTS 23.503 [4], clause 4.3.7: Traffic steering control.\nTraffic Steering Control refers to the capability to activate/deactivate traffic steering policies from the PCF in the SMF for the purpose of:\n-\tsteering the subscriber's traffic to appropriate operator 3rd party service functions (e.g. NAT, antimalware, parental control, DDoS protection) in the N6-LAN. This is supported in non-roaming and home-routed scenarios only.\n-\tAF influence on traffic routing which enables the routing of the user traffic matching the traffic filters provided in the PCC rule to a local Data Network identified by the DNAI per AF request. This is supported in non-roaming and LBO scenarios only, as described in clause 5.6.7 of TS 23.501 [2].\n2.\tTS 23.503 [4], clause 4.2.4 and 6.1.2.3: PFD management.\nManagement of Packet Flow Descriptions (PFDs) refers to the capability to create, update or remove PFDs in the NEF (PFDF) and the distribution from the NEF (PFDF) to the SMF and finally to the UPF. This feature may be used when the UPF is configured to detect a particular application provided by an ASP.\nThe Management of Packet Flow Descriptions enables the UPF to perform accurate application detection when PFD(s) are provided by an ASP and then to apply enforcement actions as instructed in the PCC Rule.\n3.\tTS 23.503 [4], clause 6.1.3.14: Traffic steering control.\nTraffic steering control is triggered by the PCF initiated request and consists of steering the detected service data flows matching application detection filters or service data flow filter(s) in PCC Rules. The traffic steering control consists in:\n-\tdiverting (at DNAI(s) provided in PCC rules) traffic matching traffic filters provided by the PCF, as described in clause 5.6.7 of TS 23.501 [2].\n-\tapplying a specific N6 traffic steering policy for the purpose of steering the subscriber's traffic to appropriated N6 service functions deployed by the operator, or a 3rd party service provider as described below.\nThe PCF uses one or more pieces of information such as network operator's policies, user subscription, user's current RAT, network load status, application identifier, time of day, UE location, DNN, related to the subscriber session and the application traffic as input for selecting a traffic steering policy.\nThe PCF controls traffic steering by provisioning and modifying traffic steering control information in PCC rules. Traffic steering control information consists of a traffic description and a reference to a traffic steering policy that is configured in the SMF.\nThe SMF instructs the UPF to perform necessary actions to enforce the traffic steering policy referenced by the PCF. The actual traffic steering applies at the UPF. For enforcing the traffic steering policy, the UPF may support traffic steering related functions as defined by other standard organizations. The mechanism used for routing the traffic over N6 is out of 3GPP scope.\n4.\tTS 23.503 [4], clause 6.2.2.6: Traffic steering.\nThe SMF shall support traffic steering control as defined in clause 6.1.3.14 of TS 23.503 [4].\nThe SMF may be configured with the traffic steering policy IDs related to the mechanism enabling traffic steering to the N6-LAN, DN and/or DNAIs associated with N6 traffic routing requirements.\nUpon receiving a PCC rule which contains the traffic steering control information, the SMF shall provide the information to the UPF for the enforcement. The traffic steering control information in the PCC rule may include a set of DNAI(s) and for each DNAI a traffic steering policy ID and/or N6 traffic routing information dynamically provided by the AF.\nNOTE:\tThe UPF can, for example, perform marking packets in order to indicate a certain type of traffic to the DN side of the N6 reference point which enables those packets to be steered in the DN. As another example the UPF can forward, i.e. offload, traffic identified by the traffic descriptor to a local tunnel.\n5.\tTS 23.501 [2], clause 5.8.2.8: for the PCC related functions.\n-\tClause 5.8.2.8.1: Activation/Deactivation of predefined PCC rules which is configured in the SMF.\n-\tThe traffic detection filters, e.g. IP Packet Filter, required in the UP function can be configured either in the SMF and provided to the UPF, as service data flow filter(s), or be configured in the UPF, as the application detection filter identified by an application identifier. For the latter case, the application identifier has to be configured in the SMF and the UPF.\n-\tThe traffic steering policy information can be only configured in the UPF, together with traffic steering policy identifier(s), while the SMF has to be configured with the traffic steering policy identifier(s).\n-\tClause 5.8.2.8.2: Enforcement of Dynamic PCC Rules in which the SMF shall maintain the mapping between a PCC rule received over Npcf and the flow level PDR(s) used on N4 interface.\n-\tThe application detection filters required in the UPF can be configured either in the SMF and provided to the UPF as the service data flow filter, or be configured in the UP function identified by an application identifier.\n-\tWhen receiving a dynamic PCC rule from the PCF which contains an application identifier and/or parameters for traffic handling in the UPF:\n-\tif the application detection filter is configured in the SMF, the SMF shall provide it in the service data flow filter to the UPF, as well as parameters for traffic handling in the UPF received from the dynamic PCC rule;\n-\totherwise, the application detection filters is configured in UPF, the SMF shall provide to UPF with the application identifier and the parameters for traffic handling in the UPF as required based on the dynamic PCC rule.\n-\tClause 5.8.2.8.4: for the Support of PFD Management.\n6.\tTS 23.501 [2], clause 5.6.7.1 and clause 6.3.7.2: for AF influence on traffic routing.\n-\tFor AF influence on traffic routing, the information can be either determined by the PCF when requested by AF via NEF or statically pre-configured in the PCF.\n-\tThe AF request sent by the AF can provide the following information to influence traffic routing towards N6-LAN:\n-\tthe information to identify the traffic.\n-\tPotential Locations of Applications: Indicates potential locations of applications, represented by a list of DNAI(s) or AF-Service-Identifier.\n-\tN6 Traffic Routing requirements: contains Routing profile ID and/or N6 traffic routing information corresponding to each DNAI and an optional indication of traffic correlation.\nNOTE 1:\tThe N6 traffic routing requirements are related to the mechanism enabling traffic steering in the local access to the DN. The routing profile ID refers to a pre-agreed policy between the AF and the 5GC. This policy may refer to different steering policy ID(s) sent to SMF and e.g. based on time of the day, etc.\nNOTE 2:\tThe mechanisms enabling traffic steering in the local access to the DN are not defined.\n7.\tTS 23.502 [3], clause 4.4 and 4.18: for SMF and UPF interactions including N4 session management procedures and N4 PFD management procedures.\n8.\tTS 23.502 [3], clause 5.6.7: Packet Flow Descriptions (PFDs) for application detection and AF request information for multiple UEs.\n-\tWhen a PDR is provided for an application identifier corresponding to the PFD(s), the SMF shall provide either the PFDs retrieved from NEF (PFDF) as described in TS 23.503 [4], or the pre-configured PFDs for an application identifier to the UPF. If the PFDs are managed by local O&M procedures, PFD retrieval is not used; otherwise, the PFDs retrieved from NEF (PFDF) override any PFDs pre-configured in the SMF.\n9.\tTS 23.502 [3], clause 4.3.6: AF influence on traffic routing.\nClause 4.3.6 describes the procedures between an Application Function and the SMF to maintain an efficient user plane path for Application Functions that require it.\nAs described in clause 5.6.7 of TS 23.501 [2], an Application Function may send requests to influence SMF routeing decisions for User Plane traffic of PDU Sessions. The AF requests may influence UPF (re)selection and allow routeing of user traffic to a local access (identified by a DNAI) to a Data Network. The AF may also provide in its request subscriptions to SMF events.\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "Table 8-1",
                    "table number": 12,
                    "summary": "",
                    "name": ""
                },
                {
                    "description": "",
                    "table number": 13,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        }
    ]
}