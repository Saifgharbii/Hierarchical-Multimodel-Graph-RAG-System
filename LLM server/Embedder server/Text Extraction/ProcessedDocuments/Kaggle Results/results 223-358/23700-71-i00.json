{
    "document_name": "23700-71-i00.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Report has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\tindicates that something is possible\ncannot\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The scope of this Technical Report is to study further enhancements to the to the 5GC LoCation Services including the following aspects:\n-\tInvestigate potential architectural enhancements to location service (e.g. in scenarios like edge computing, and other), i.e. support Positioning Signalling via user plane.\n-\tInvestigate potential architectural enhancements to location service (e.g. in scenarios like edge computing, and other), i.e. reduction of location service latency, signalling overhead and location estimate exposure.\n-\tStudy how the location services can benefit from NWDAF reporting and how the NWDAF use cases can benefit from location services, e.g. enhanced accuracy in certain UE location or population flow statistics data that require UE locations smaller than TA/cell\n-\tStudy enhancements to support low power positioning (e.g. for RedCap) including the requirements related to low power high accuracy positioning described in TS 22.104 [7].\n-\tStudy necessary enhancement to support regulatory requirement i.e. the network should not notify the UE by any means during the LCS session.\n-\tStudy enhancement to support the Flexible and Efficient Periodic and Triggered Location for UE power saving purpose.\n-\tIn collaboration with RAN, study specific network functionality related to use of Positioning Reference Units (PRUs) as defined by RAN WGs and study how 5GS to support a specific UE (i.e. Reference UE) to improve the accuracy of positioning, and reduce the signalling:\n-\tStudy enhancements to support the location service continuity for UE mobility, i.e. between EPS and 5GS;\n-\tFor 5G with satellite access, in collaboration with RAN, study LCS architectural enhancement to support network verified UE location, and to meet location services related requirements defined in TS 22.261 [8].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[3]\t3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".\n[4]\t3GPP TS 23.271: \"Functional stage 2 description of Location Services (LCS)\".\n[5]\t3GPP TS 23.273: \"5G System (5GS) Location Services (LCS); Stage 2\".\n[6]\t3GPP TS 38.305: \"Stage 2 functional specification of User Equipment (UE) positioning in NG-RAN\".\n[7]\t3GPP TS 22.104: \"Service requirements for cyber-physical control applications in vertical domains\".\n[8]\t3GPP TS 22.261: \"Service requirements for the 5G system\".\n[9]\t3GPP TS 23.288: \"Architecture enhancements for 5G System (5GS) to support network data analytics services\".\n[10]\t3GPP TS 23.548: \"5G System Enhancements for Edge Computing; Stage 2\".\n[11]\tS3i210282: \"LS OUT on UE location aspects in NTN\" https://www.3gpp.org/ftp/TSG_SA/WG3_Security/TSGS3_LI/2021_81e-a/Docs/s3i210282.zip.\n[12]\tRP-213690: \"New WI: NR NTN (Non-Terrestrial Networks) enhancements\".\n[13]\tOMA-AD-SUPL-V2_0: \"Secure User Plane Location Architecture Approved Version 2.0\".\n[14]\tOMA-TS-ULP-V2_0_6: \"User Plane Location Protocol Approved Version 2.0.6\".\n[15]\t3GPP TS 37.355: \"LTE Positioning Protocol (LPP)\".\n[16]\t3GPP TS 23.503: \"Policy and charging control framework for the 5G System (5GS); Stage 2\".\n[17]\t3GPP TR 23.700-81: \"Study on Enablers for Network Automation for 5G; Phase 3\".\n[18]\t3GPP TS 22.071: \"Location Services (LCS); Service description; Stage 1\".\n[19]\t3GPP TS 23.304: \"Proximity based Services (ProSe) in the 5G System (5GS)\".\n[20]\tIETF RFC 5246: \"The Transport Layer Security (TLS) Protocol Version 1.2\".\n[21]\t3GPP TS 24.080: \"Supplementary services specification; Formats and coding\".\n[22]\t3GPP TS 38.300: \"NR; NR and NG-RAN Overall description; Stage-2\".\n[23]\t3GPP TR 23.700-86: \"Study on Architecture Enhancement to support Ranging based services and sidelink positioning\".\n[24]\t3GPP TS 29.522: \"5G System; Network Exposure Function Northbound APIs; Stage 3\".\n[25]\t3GPP TS 38.423: \"NG-RAN; Xn Application Protocol (XnAP)\".\n[26]\t3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in TR 21.905 [1].\nPositioning Reference Unit (PRU): As defined in TS 38.305 [6].\nReference UE: A UE with a location assumed known to the network that can obtain location related information of one or more target UE(s), which may assist the network to improve the positioning performance of target UE(s). In this technical report, the Reference UE is the PRU and the location related information is the measurements provided by PRU.\nNOTE:\tWithin the FS_eLCS_ph3 study and this TR, the Reference UE has no relationship with other Studies, e.g. FS_Ranging_SL, unless clearly mentioned. If a terminology alignment between studies is required, it will be done before starting normative work.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905 [1].\nEASDF\tEdge Application Server Discovery Function\nEDC\tEdge DNS Client\nFQDN\tFully Qualified Domain Name\nLCS\tLoCation Service\nLCUP\tLCs User Plane\nLMF\tLocation Management Function\nLPP\tLTE Positioning Protocol\nLPPe\tLPP extension\nNPN\tNon-Public Network\nNWDAF\tNetwork Data Analytics Function\nPRU\tPositioning Reference Unit\nTAI\tTracking Area Identity\nULI\tUser Location Information\nURSP\tUE Route Selection Policy\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tArchitectural Assumptions and Requirements",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tArchitecture assumptions",
                    "description": "",
                    "summary": "",
                    "text_content": "The existing 5G LCS architecture is the bases for further enhancement work, with following add on assumption:\n-\tPositioning methods may be Access Network specific, although commonalties should be encouraged between Access Networks.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tArchitecture requirements",
                    "description": "",
                    "summary": "",
                    "text_content": "The following requirements are applicable to further enhance the existing 5GC LCS architecture defined in TS 23.273 [5]:\n-\tThe further enhancement to the 5GC LCS architecture should incorporate flexible modular components with open interfaces that facilitate equipment interoperability and the architectural requirements based on evolution of service providing capabilities.\n-\tThe further enhancement to the 5GC LCS architecture should be future proof.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5\tKey Issues",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tKey Issue #1: Architectural Enhancement to support User Plane positioning",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.1.1\tIntroduction",
                            "text_content": "The key target of this KI is to identify the LCS features and enhancements required to support user plane positioning.\nPositioning Signalling via user plane has several benefits, such as:\n-\tIt has a more efficient communication overload with a direct connection from LCS server to UE.\n-\tIt may not require gNodeB, AMF, LMF signalling processing of RRC, NG-AP and HTTP/2 protocol stacks. A single session may handle all the transactions.\n-\tIt can have multiple choices depending on UE support. For example, both 3GPP LPP and OMA LPPe can be possible in positioning methods' choices.\nTo deploy user plane positioning, it involves the following considerations:\n-\tDifferent use cases like emergency/non-emergency, other regulatory cases like lawful interception and MO-LR cases, etc.\n-\tDifferent deployment options including centrally deployed or local deployment ,i.e, deployed the edge data network.\n-\tWhether the solution is end to end or restricted to only certain entities (e.g. UE and LMF, LMF and LCS Client).\nFor user plane positioning deployment, two options are identified, although other options are also possible:\nOption 1: User plane positioning functionality  (e.g. LMF) in the central network.\nOption 2: The user plane positioning functionality can be deployed \"in scenarios like edge computing\" of the edge data network to provide positioning in the edge and fits into the architecture in TS 23.548 [10].\nThis KI is to address architectural changes allowing user plane positioning deployment, including central deployment or deployment at the edge e.g.:\n-\tDiscovery of user plane capability and configuration and selection of PDU Sessions (if needed) to be used for the communication between UE and user plane positioning.\n-\tWhether and how to enhance existing 5GS LCS architecture or related procedures to support MO-LR, MT-LR, Deferred MT-LR and regulatory-related positioning procedures when user plane positioning is involved.\n-\tInteraction with legacy LCS call flows and security aspect.\n-\tRequirements on transport protocol e.g. if reliable transport and in sequence delivery is required.\n-\tInteraction (if any) between user plane and existing control plane solution.\n-\tUser plane as a possible enhancement to control plane.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.2\tKey Issue #2: enhanced positioning architecture for NPN deployment",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tDescription",
                            "text_content": "For NPN network deployments, the following technical issues will be studied:\n-\tHow to realize low latency positioning procedure under NPN deployment.\n-\tHow to realize low complexity positioning procedure under NPN deployment.\n-\tHow to achieve reliable and secure location result delivery and exposure, e.g. UE location not exposed to the public network.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tKey Issue #3: Local Area Restriction for an LMF and GMLC",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tDescription",
                            "text_content": "In some scenarios, an GMLC and an LMF might be restricted to supporting location services in a local area, i.e. the LMF needs to be selected within the same local area of the GMLC. The objective of this KI is to investigate how to support the local area restriction for GMLC and LMF.\nNOTE:\tThis KI is not applicable to an NPN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.4\tKey Issue #4: Interaction between Location Service and NWDAF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.4.1\tDescription",
                            "text_content": "NWDAF can generate different analytics data, e.g. UE mobility analytics, WLAN performance analytics. 5GC NF (e.g. AMF, PCF) can request analytics data from NWDAF for decision making. But whether and how location service can be benefit from NWDAF is not studied yet. For example, whether the existing analytics generated by NWDAF (e.g. WLAN performance analytics) can be used to improve the location service performance, e.g. to assist the LMF to select the positioning method or decide more accurate assistance data?\nFurthermore, based on Table 6.7.2.2.1 and Table 6.7.2.3.1 of TS 23.288 [9], the UE location collected and included in the analytics data by the NWDAF is TA or cell. But in some use cases, analytics in granularity of TA or cell level is not sufficient. Considering location service can provide more accurate UE location information, it is needed to study how does the location service provides such information to NWDAF.\nTo support the aspects above, this key issue will study:\n-\tHow to provide the NWDAF with location information with finer granularity than TA/cell level, e.g. which NF in the location architecture supports the interface to the NWDAF, whether existing location procedures can be re-used or not;\n-\tWhether the privacy check can be skipped or not when the NWDAF requests location information via LCS services, if not, how to perform the privacy check in LCS;\n-\tWhether existing data analytics generated by the NWDAF can be used to improve location service performance and how, e.g. assist the LMF to select the positioning method, decide more accurate assistance data, reduce signalling cost and delay etc.;\n-\tIdentify use cases where new or existing data analytics from the NWDAF can be used for improving location service performance. Regulatory requirements (e.g. different location accuracy requirements from FCC in different cases) will be taken into account.\nNOTE:\tCoordinated activities between the study FS_eNA_Ph3 and this study are needed. Any new data analytics agreed as part of this Key Issue that need to be provided by NWDAF need to be studied and agreed in FS_eNA_Ph3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.5\tKey Issue #5: Assistance data provisioning for low power high accuracy GNSS positioning",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.5.1\tDescription",
                            "text_content": "The GNSS assistance data could help reduce UE GNSS receivers' power consumption and increase the position accuracy. Nowadays, UE usually gets the assistance data from internet through user-plane. However, using a user plane based way means that UE must active a PDU Session, which leads to higher power consummation. Moreover, it may not apply to Redcap UEs, as some of them may not support to establish a PDU Session.\nThe distance between the UE GNSS receivers and GNSS reference receiver should be sufficiently short to make sure the GNSS assist data provided by the reference receiver are valid and accurate. However, GNSS reference receivers are not widely implemented in some countries, which makes it hard to provide high accuracy GNSS positioning service for UE GNSS receivers in some areas.\nThis key issue aims at studying the possible method to get nearby GNSS assistance data inside 3GPP, to mitigate a lack of implementation of GNSS reference receivers.\nThe following aspects will be studied:\n-\tHow could the core network (i.e. LMF) get the GNSS assistance data of a GNSS reference receiver, either inside 3GPP domain or external to 3GPP domain to select a GNSS reference receiver close to the estimated location of the UE, help reduce power consumption and increase the positioning accuracy?\n-\tWhether and how existing procedures, protocols or interfaces can be re-used or enhanced to make UE get the nearby GNSS assistance data?\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.6\tKey Issue #6: UE Positioning without UE/User Awareness",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.6.1\tDescription",
                            "text_content": "There are regulatory cases (e.g. helping with police enquires), in that UE should not be notified by any means during the LCS session. But how to support the requirement has not been considered.\nFor some IoT or RedCap devices, when power saving is more important than fulfilling the LCS request, how to obtain UE location without notifying the UE especially when UE is in CM-IDLE or RRC_INACTIVE state is also not considered.\nTo support the requirements above, this key issue will study:\n-\tWhich NF and how to decide not to notify UE/User during the LCS session, e.g. what information is considered to make the decision;\n-\tFunctionality and procedure enhancements to guarantee not to notify UE/User during the LCS session when UE is in CM_CONNECTED, CM_IDLE or RRC_INACTIVE state;\n-\tWhat UE location information is provided to LCS Client/ AF to fulfil the LCS QoS when the UE is in CM_IDLE or RRC_INACTIVE state and if the UE is not notified during the LCS procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.7\tKey Issue #7: support of Positioning Reference Units and Reference UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.7.1\tDescription",
                            "text_content": "Based on RAN WG conclusion in Rel-17, positioning reference units (PRUs) with known locations can enhance the positioning performance. PRUs may be used to assist positioning of UEs by e.g. providing measurement information related to RAN nodes. This key issue aims to study the system level impact to support PRUs.\nThe accuracy of positioning heavily relies on the number of Line of Sight (LoS) paths, so positioning in the indoor environment is complex, as there are many factors that reduce the possibility of LoS path. It is resource consuming and complicated to deploy sufficient RAN nodes (e.g. pRRUs or gNBs) to provide enough LoS path, considering the complex environment with possible changes. Consequently, a simplified node, referred to as a Reference UE, is required to provide more potential LoS paths for positioning.\nThe following aspects will be studied for PRUs:\n-\tWhat information of the PRUs needs to be obtained by 5GC and how can the 5GC become aware which PRU(s) are available.\n-\tHow can 5GC determine and enable particular (e.g. candidate) PRU(s) from the available PRU(s).\n-\tHow are the location service procedures performed to improve positioning accuracy using PRU(s). This can include using PRUs to assist positioning of one UE or using PRUs to assist positioning of many or all UEs.\nThe following aspects will be studied for Reference UEs:\n-\tWhether and how the 5GS can assist with the selection of Reference UE supporting the 5G location services provided to a different UE.\n-\tThe specific entities and mechanisms in the 5GC whose functionality need to be updated to account for the Reference UE operation as part of the location service.\nNOTE 1:\tCoordination with RAN WG may be required.\nNOTE 2:\tWhether PRU and Reference UE can be the same entity should be determined during normative phase.\nNOTE 3:\tWithin the FS_eLCS_ph3 study and this TR, the Reference UE has no relationship with other Studies, e.g. FS_Ranging_SL, unless clearly mentioned. If a terminology alignment between studies is required, it will be done before starting normative work.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.8\tKey Issue #8: support of location service continuity in case of UE mobility",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.8.1\tDescription",
                            "text_content": "For commercial location service, in particular the use case on vehicle(V2X) UE, it is very likely that UE moves between EPS and 5GS, and continuous UE positioning (periodical location service/LDR) is required.\nFollowing UE mobility scenarios are considered under this key issue:\n-\tUE mobility between EPS and 5GS (bi-direction).\n-\tUE mobility between NG-RAN node.\nThe following \"Types of Location Request\" should be considered in the scope of WT#6:\n-\tMobile Terminated Location Request, and in detail covers:\n-\tImmediate Location Request (Response Time \"no delay\" and \"low delay\" are excluded).\n-\tDeferred Location Request (both periodic location service, and event based location request).\n-\tMobile Originated Location Request.\nThe following issues will be studied:\n-\tHow to handle the UE location service context in case of UE mobility (e.g. context in the AMF, MME, LMF, E-SMLC).\n-\tConfiguration update of the positioning information/configuration on the source and target RAN nodes in case of UE mobility.\n-\tHow to enhance the cancellation of the existing positioning procedure in case of UE mobility.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.9\tKey Issue #9: Support of Positioning Requirements Related to Satellite Access",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.9.1\tDescription",
                            "text_content": "In Rel-17, the 5GS system has been enhanced to support the service requirements of 5GC with satellite access (in the WID: Architecture aspects for using satellite access in 5G).\nIn Rel-17, when a UE is using NR satellite access, in order to ensure to meet the regulatory requirements, the network will verify whether the PLMN selected by the UE is allowed to operate in the country of the UE location based on the UE location information.\nBesides, the broadcast TAI(s) and the TAI where the UE is geographically located, if known, will be provided as part of ULI by NG-RAN to the AMF. Using UE-generated location information (e.g. GNSS/A-GNSS) to determine the TAI where the UE is geographically located can be accurate but may be unreliable as has been evaluated by SA WG3.\nWhen UE access 5G via satellite access, some services with regulatory requirements, e.g. emergency calls service and lawful interception, require a trusted/reliable methods to determine with sufficient accuracy the UE location. Any method which relies solely on UE-generated location information may not be reliable unless the information provided by the UE can be verified by the network. But how does the network verify the UE location has not been considered, so this key issue will study:\n-\tWhat kind of location information can represent the UE location that meets required accuracy in NR satellite access (e.g. doing verification based on the location information to meet regulatory requirements)?\n-\tIn collaboration with RAN, for the reliability of the location verification by the network for regulated services (LI, emergency) and given SA WG3-LI requirements defined in S3i210282 [11], further study how the 5GC LCS can ensure that network verification of UE location is performed with reliable method, that does not rely solely on UE-generated location information, and the result of such network verification of UE location meets aforementioned requirements;\n-\tIn collaboration with RAN on their work on network verified UE location, study whether existing core network verification mechanisms needs enhancement and conditions (which NF, when, how, etc.);\n-\tHow to further enhance the LCS to verify location services related requirements defined in TS 22.261 [8];\nNOTE:\tThe work of this key issue needs collaboration with RAN. Considering SA WG2 Rel-18 work begins earlier than RAN and RAN will make decision related to the work by RAN#98 as indicated in NR_NTN_enh WID in RP-213690 [12], thus SA WG2 can start discussing solutions first and make conclusion in collaboration with RAN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.10\tKey Issue #10: Support of Reduced Latency",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.10.1\tDescription",
                            "text_content": "Reduction of latency is useful for many user cases and needs to be end-to-end. For example, very low latency for positioning that may be supported by procedures defined by RAN1 and RAN2 would be nullified by extra time in establishing a positioning session with a target UE or in returning a location estimate to an LCS Client or AF.\nThe following aspects will be studied:\n-\tReducing end to end latency for an immediate location request (5GC-MT-LR, 5GC-MO-LR).\n-\tReducing end to end latency for a deferred location request (periodic or triggered 5GC-MT-LR).\nNOTE:\tReducing latency should focus on aspects related to signalling and procedures involving the 5GCN and not on aspects completely within NG-RAN which are under RAN control.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.11\tKey Issue #11: Enhance the Triggered Location for UE power saving purpose",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.11.1\tDescription",
                            "text_content": "Some use cases only need the UE location to be tracked when the UE is within a set of pre-defined areas, e.g. when UE is within one big city or a campus. For power saving purpose, it is beneficial to only allow UE location tracking when the UE enters one such area.\nThis Key Issue will study:\n-\tHow to provide location service only when the UE is within a pre-defined area, including border district and central district in this area;\n-\tHow to define and identify the pre-defined areas; and:\n-\tWhich entity provide such pre-defined areas to the LCS system and how?\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.12\tKey Issue #12: support of low power and/or high accuracy positioning",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.12.1\tDescription",
                            "text_content": "SA WG1 considers low power high accuracy positioning is an integral part of a considerable number of industrial applications. The total energy needed for a specific operation time for such a low power high accuracy positioning optimized IoT-device is a combination of energy for positioning (varies depending on the used positioning method), energy for communication/synchronization and a difficult to predict factor to take additional losses through e.g. security, power management, microcontroller, and self-discharge of batteries into account.\nLow power and/or high accuracy positioning may need specific handing in the system level, depending on the localization requirements of an LCS Client or AF.\nReduction of power consumption can be useful for IIoT and CIoT UEs and is generally preferable for any UE to improve battery lifetime. Reduction of power consumption may or may not be associated with high accuracy.\nFollowing issues are proposed for study:\n-\tHow to identify localization QoS for low power and/or high accuracy positioning;\n-\tWhether new information is needed in subscription data for low power and/or high accuracy positioning;\n-\tWhether LCS QoS should be enhanced to support LPHAP;\n-\tHow to handle UE connection management/mobility management, for power saving purpose, when supporting low power and/or high accuracy positioning;\n-\tPositioning procedure optimization:\n-\tReducing UE power consumption for an immediate location request (5GC-MT-LR, 5GC-MO-LR);\n-\tReducing UE power consumption for a deferred location request (periodic or triggered 5GC-MT-LR);\n-\tReducing UE power consumption in association with high accuracy positioning.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tSolutions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.0\tMapping Solutions to Key Issues",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 6.0-1: Mapping Solutions to Key Issues\n\n",
                    "tables": [
                        {
                            "description": "Table 6.0-1: Mapping Solutions to Key Issues",
                            "table number": 4,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.1\tSolution #1: Positioning protocol transport over User Plane",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #1 on Architectural Enhancement to support User Plane positioning and also provides option to reduce latency for Key Issue #10.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.2\tFunctional Description",
                            "text_content": "The AMF, UE and LMF are enhanced to initiate setup of a User Plane connection between a selected LMF and UE and to provide LMF and UE with needed information to establish a secure connection. The information includes e.g. IP address of LMF to be used for the connection, temporary UE identifier (not the same as used N2 or other reference points), and security credentials. The AMF, UE and LMF are enhanced to transport LPP over a UP protocol. Once the LCS-UP connection is established the LMF selects either to use the LCS-UP procedure according to clause 6.1.3.3 or to use CP procedure according to clause 6.11.1 of TS 23.273 [5]. Within one LPP session the same transport shall be used.\nSince LCS-UP connection is maintained during the lifetime of the PDU session, the procedure also reduces the latency if LMF selects LCS-UP over CP for certain positioning requests.\nCurrent solution considers UE has only one LCS-UP connection with the selected LMF.\nMultiple LCS-UP connection establishment could be also considered from a single or multiple LMF to separate different traffic type (emergency, LI or commercial).\nNOTE:\tIf and what security mechanism is used and subject to SA WG3 conclusion.\nIt is proposed to define a protocol stack that includes a lightweight LPP transfer protocol that is limited services aligned to what CP transport provides (e.g. identification of UE and positioning session). A potential stack is shown in Figure 6.1.2.-1 (TCP is shown as example of a transport layer and security details are omitted). Details of protocol stack will be determined in the normative work.\nThe figure depicts a protocol layering diagram for user plane transfer of LPP, illustrating the various layers and their respective functions.\nFigure 6.1.2.-1: Protocol Layering for User Plane Transfer of LPP\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.3\tProcedures",
                            "text_content": "The flow below shows how a secure LCS-UP connection between UE and LMF is established.\nThe figure depicts the connection establishment between an UE (User Equipment) and a Local Multipoint Focal Point (LMF) in a 5G network. The LMF is a key component in the network, responsible for relaying signals to the base station (gNB) and other nodes. The figure illustrates the various stages of the connection process, including the establishment of the connection, the transmission of the signal, and the reception of the signal by the UE. The figure also highlights the importance of redundancy in the network, as shown by the dashed lines connecting different paths. Overall, the figure provides a clear and concise representation of the connection establishment process in a 5G network.\nFigure 6.1.3.1-1: Connection establishment between UE and LMF\n1.\tAt applicable Registration events  or when an LCS procedure is initiated, AMF may decide to select an LMF and request the UE and the selected LMF to establish an LCS-UP connection to be used for transfer of LPP signalling. The decision may be based on e.g. UE capabilities, UE location, subscription information, LMF load and LMF capabilities. It can be an operator decision whether LCS-UP connection is established at Registration events or when an LCS procedure is initiated.\nLatency sensitive use-cases would require LCS-UP connection established at Registration events. Emergency traffic might not require pre-established LCS-UP connection.\n1.b.\tWhen a new LCS procedure is initiated for the UE which already has LCS-UP connection, the AMF may detect a need to reselect LMF used for LCS-UP signalling. The detection may be based on e.g. UE capabilities, UE location, subscription information, LMF load and LMF capabilities. Further at AMF relocation, the target AMF needs to inform the LMF using LCS-UP signalling about the AMF change.\n2.\tThe AMF sends a Nlmf_Location_UPConfig Request towards the LMF to request set up of a LCS-UP connection. The message may include e.g. a temporary UE identifier.\n3.\tThe LMF sends a LCS UP Info message to the UE via the serving AMF by invoking the Namf_Communication_N1N2MessageTransfer service operation. The LCS UP Info message may include e.g. IP or FQDN address of LMF,  temporary UE identifier and security credentials.\n4.\tThe AMF forwards the LCS UP Info in a DL NAS TRANSPORT message.\n5.\tThe UE and LMF establish a secure connection.\n6.\tThe LMF sends Nlmf_Location_UPConfig Response message to AMF to inform of outcome of connection setup.\n7.\tThe AMF stores the LCS-UP connection context as part of UE context.\nAfter establishing the connection, UE and LMF may maintain the connection for later message transfer via user plane.\nThe flow below shows how a secure LCS-UP connection between UE and LMF is modified. Flow describes change of LMF but applies also when source and target LMF is the same. The procedure can also be used to terminate LCS-UP connection to Source LMF by AMF not selecting any Target LMF.\nThe figure depicts a connection modification between an UE (User Equipment) and a Local Multipoint (LMF) in a 5G network. The modification involves the use of a 5G-specific protocol, which allows for efficient data transmission and improved network performance. The figure illustrates the process of connecting the UE to the LMF, highlighting the importance of this connection in ensuring reliable and high-speed data transmission.\nFigure 6.1.3.2-1: Connection modification between UE and LMFs\n1a.\t[Conditional] The LMF discovers a need to change LMF or re-establish LCS-UP connection. The LMF sends an Nlmf_Location_UPNotify message that includes UP Info that indicates the reason for modification. The address of the AMF was provided to LMF as a \"Notification Target Address\" in latest Nlmf_Location_UPConfig message.\n1b.\t[Conditional] At applicable Registration events and when an LCS procedure is initiated, AMF may detect a need to reselect LMF used for LCS-UP signalling. The detection may be based on e.g. UE capabilities, UE location, subscription information and LMF capabilities. Further at AMF relocation the target AMF needs to inform the LMF using LCS-UP signalling of the AMF change.\n2.\t[Conditional] If AMF reallocation has occurred this step is skipped. Otherwise, steps 2 to 7 of clause 6.1.3.1 are performed between AMF, UE, and Target LMF with addition that UE also terminate connection to Source LMF.\n3.\tThe AMF sends a Nlmf_Location_UPConfig Request towards the source LMF. The message may include a request for the Source LMF to terminate a specific LCS-UP connection to the UE if connection is still active. Alternatively, it may include information about AMF reallocation.\n4.\t[Conditional] If the LCS-UP connection to source LMF is still active source LMF terminates the connection to the UE.\n5.\tThe LMF sends Nlmf_Location_UPConfig Response message to AMF to confirm connection termination or acknowledge change of AMF.\nThe flow below shows a positioning procedure used by an LMF to support UE based positioning, UE assisted positioning and delivery of assistance data. The procedure is based on use of the LPP protocol defined in TS 37.355 [15] between the LMF and UE.\nThe figure depicts a positioning procedure for a UE (User Equipment) in a 5G network, where the UE is assisted and based on the LCS-UP (Local Coverage Subnet) to determine its position. The figure illustrates the use of LCS-UP to provide coverage and improve positioning accuracy.\nFigure 6.1.3.3-1: UE Assisted and UE Based Positioning Procedure over LCS-UP\n1.\tThe LMF use the LCS-UP connection to transfer of a Downlink (DL) UP TRANSFER message to the UE. The message includes a LPP message. The LPP message may request location information from the UE, provide assistance data to the UE or query for the UE capabilities.\n2.\tThe UE stores any assistance data provided in the Downlink Positioning message and performs any positioning measurements and/or location computation requested by the Downlink Positioning message.\n3.\t[Conditional] The UE use the LCS-UP connection to transfer of a Uplink (UL) UP TRANSFER message carrying includes a LPP message to the LMF to return any location information or returns any capabilities.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.4\tImpacts on services, entities, and interfaces",
                            "text_content": "The solution impacts the following network functions:\n-\tAMF that need to support triggering of LCS-UP connection setup, modification & termination. Additionally, AMF also needs to consider at LMF selection that the requested UE has an existing LCS-UP connection with one of the LMFs.\n-\tLMF that need to support procedure to setup, modification & termination of LCS-UP connection. Transfer of LPP messages over LCS-UP.\n-\tUE that need to support: Procedure to setup, modification & termination of LCS-UP connection. Transfer of LPP messages over LCS-UP.\n-\tUDM that need to add info in Subscriber info if LCS-UP transport is supported.\n-\tNRF that need to add info in NF profile LMF support LCS-UP transport.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2\tSolution #2: Discovery of User Plane service Cooperated with 3GPP LCS Features",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tIntroduction",
                            "text_content": "This solution addresses the KI \"Key Issue #1:Architectural Enhancement to support User Plane positioning\".\nThe solution contains mainly two parts:\n1.\tUser Plane feature support with compatibility with OMA standards [13][14]\n2.\tUser Plane service (re-)discovery compatible to TS 23.548 [10].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tFunctional Description",
                            "text_content": "As described in clause 5, User Plane positioning gives benefits including a simpler protocol stack, less overload, better performance, extra LPPe support, etc. When there is overloaded LCS signalling over N1 and/or NL1 interfaces, like massive emergency cases, LMF can offload the traffic to the user plane to enhance capacity.\nLMF can perform legacy 3GPP LCS features independently. User Plane features can also be used independently or cooperated with LMF using OMA User Plane specifications as specified in TS 23.271 [4] and TS 38.305 [6].\nWith many features defined by OMA, since UE can't take uplink measurements, to fulfil positioning methods like RTT, the User Plane has to cooperate with Control Plane LMF to collect both uplink and downlink measurements.\nUser Plane cooperated with the 3GPP LCS control plane can be named 'LCUP' (LCs User Plane).\nLMF and LCUP are two key technologies in the field of optical communication, which can be deployed independently and cooperatively to enhance network performance.\nFigure 6.2.2-1: LMF and LCUP can be deployed independently and can cooperate with each other\nIndependent/legacy LMF handles control plane requests as per legacy 3GPP LCS specifications.\nFor independent User Plane entity, it could perform end to end location service (possibly following legacy OMA specifications) without 5GC impact:\nThe figure depicts an independent user plane in a 5G network, illustrating the separation of the user equipment (UE) and the base station (gNB) in the signal path. The figure shows the UE's path, which includes the gNB, and the path of the signal from the gNB to the UE. The figure also highlights the use of beamforming techniques to mitigate interference.\nFigure 6.2.2-2: Independent user plane\nDetails of independent user plane function is out of this solution scope.\nIn this solution, only user plane invoked by LMF to enhance the 3GPP 5G LCS procedures is referred as 'LCUP'. This solution makes it compatible that LCUP could also act as independent user plane while cooperating with LMF. For LCUP cooperated with LMF, it can achieve the following benefits:\n1.\tBoth uplink and downlink measurements can be collected.\n2.\tUser Plane and Control Plane can have feature reusability, e.g. sharing the same algorithm calculation.\nNOTE 1:\tAs per clause 5.1 of TS 38.305 [6], detailed cooperation interface between LMF and LCUP is out of the solution scope and could be implementation specific.\nTo keep legacy LCS procedures' compatibility, for the cooperated LMF and LCUP instances, LMF should still perform the entry point and response route for 5GS LCS procedures, including MO-LR, MT-LR, Deferred MT-LR and regulatory-related positioning when user plane positioning is involved.\nSince there could be multiple LMF and LCUP instances, when LCUP cooperated with LMF, UE needs to discover the correct instance of LCUP. With 3GPP LCS MT-LR/NI-LR/MO-LR procedures, when AMF has selected an LMF instance - LMFi to serve an LCS request about a UE, when the UE establishes user plane interaction with an LCUP, the UE should perform user plane session with an LCUPi cooperated with LMFi. This means UE should discover the LCUP instance working with the serving LMF instance.\nFor the cooperated case, LMF can perform the offload operation to switch the LPP traffic to User Plane.\nLMF can provide information to UE, and allows the UE to establish a secure UP connection to a proper LCUP over existing or new PDU session through the following options:\n1.\tLMF can send SUPL INIT to UE through OMA-defined push mechanisms and activate the UP session with its cooperated LCUP.\n2.\tFor LPP offload in Rel.18, it is straightforward that the LCUP related information be delivered over LPP itself. LMF can treat cooperated LCUP information and contents in SUPL INIT as part of assistance data in LPP provide assistance message.\na.\tThe provide assistance data message can be unsolicited or in response to a request assistance message from UE.\nb.\tThe LPP offload instruction in the LCUP assistance can be imperative or instructive. Imperative means UE can choose to offload the traffic or receive failure; instructive means UE would better to offload the traffic but may still be served by LMF over control plane.\n3.\tLMF can also provide LCUP information to AMF using Namf_Communication_N1N2MessageTransfer and AMF forward it to UE with DL NAS TRANSPORT.\nBesides the contents in SUPL INIT, LCUP assistance data can also include:\n1.\tThe pre-provisioned or unique FQDN of the LCUP cooperating with serving LMF.\n2.\tSecurity attributes of LCUP for TLS connection establishment.\nNOTE 2:\tThe PDU session (or related DNN) may be used only for LCS UP connection.\nNOTE 3:\tIf any security work with PDU session and/or User Plane connection needed, it should be handled by SA WG3.\nMeanwhile, LCUP service should only be provided to capable UEs. UE capability of User Plane can be exposed in a similar way as its legacy 3GPP LCS capability:\n1.\tThe capabilities of a target UE to support user plane may be signalled by the UE to a serving PLMN or to an SNPN at the AS, NAS during registration of the UE.\n2.\tSome of these positioning capabilities may be transferred subsequently to an LMF with enhanced LPP signalling.\nSuch capability information could be transferred to LMF from:\n1.\tAMF in the DetermineLocation Request enhancement when UE provides the UP capability during registration.\n2.\tLPP message to LMF in capabilities exchange.\nAs per [13][14], UE could use pre-configured FQDN and/or runtime parameter(s) received in SUPL INIT as OMA compliant approach or LPP/NAS assistance as R18 enhancements to discover the LCUP.\nSince UE uses FQDN to discover the User Plane server, URSP, EASDF rules and different FQDN resolution can be used to locate the LCUP:\n1.\tAs one of the Rel-18 enhanced options, each LCUP instance cooperated with the LMF can be assigned to a unique FQDN. LMF can provide the corresponding FQDN as part of the assistance data to the UE. UE can also retry the user plane in case of an overloaded error reply of the control plane request.\n2.\tAs OMA SUPL compliant option, for UEs which can only use provisioned (H-SLP) FQDN and related trusted certificate settings, before the traffic offload, the serving LMF can act as a (backend) DNS server and respond to the DNS query to reply the cooperated LCUP.\na.\tIf LCUP is bounded to certain area like in localized LCS, LMF can use the same serving cell identity to choose the LCUP as its cooperated instance.\nb.\tFor the more specific cases that LMF is pre-configured with LCUP instance, after LMF offload instruction to UE. UE performs the LCUP DNS query. EASDF rules can attach UE IP in the ECS (EDNS Client Subnet) and forward the provisioned FQDN's DNS query to all related LMF instances. LMF could decide the DNS response by combining UP IP with information query from BSF or message contents from IMS. Only when UE IP in ECS exists in the serving UE IP list, the LMF would reply with its cooperated LCUP IP. Then UE can use the LCUP assistance delivered from serving LMF to establish User Plane session with the cooperated LCUP instance.\nIn conclusion, the solution to the cooperation of LMF and LCUP can be summarized as follows:\n1.\tLMF performs the entry point and response route of LCS procedures\n2.\tOAM provisions LMF with the assistance information (including FQDN, etc.) of its cooperated LCUP instance(s).\n3.\tLMF provides LCUP assistance to UE either through OMA defined push mechanism or LPP/NAS assistance delivery\n4.\tWith knowledge of LCUP service, URSP configured in the UE may indicate which existing or new PDU session is used to establish the connection with LCUP.\n5.\tWith Edge DNS Client (EDC) functionality in the UE, EASDF rules has the flexibility to match the DNS query to correct LCUP provisioned to the cooperated LMF instance.\na.\tWhen each cooperated LCUP can have its unique FQDN so that UE can have direct access, it could be pre-configured in LMF for all its LCUP assistance delivery.\nb.\tWhen applying DNS query feature to LMF, when triggered by MT/MO/NI procedures, after offload instruction, serving LMF can reply the DNS query with its cooperated LCUP assistance information based on either serving area or UE IP/identity.\nWhen LCUP is used with 3GPP LCS MT/NI/MO procedures, LMF can offload the LPP traffic to LCUP by the following options to activate UP connection from UE :\n1.\tLMF can use LPP assistance delivery containing LCUP information.\n2.\tLMF can use OMA defined push mechanisms. This is compatible with legacy SUPL capability of UE.\n3.\tLMF can also use Namf_Communication_N1N2MessageTransfer to AMF which forwards LCUP info to UE with DL NAS TRANSPORT.\nAfter UE gets the cooperated LCUP assistance data of its serving LMF:\n1.\tUE starts LCUP DNS query either with pre-provisioned, or from OMA defined push mechanism or LPP assistance delivery:\na.\tIf the FQDN of LCUP could uniquely identify an LCUP instance, such instance would be the serving LCUP cooperated with the currently serving LMF. OAM can perform pre-provision.\nb.\tWith localized LCS cases where LCUP and/or LMF are bounded to the serving area, LMF can use UE's serving cell ID to match its serving area and respond to DNS queries with its cooperated LCUP assistance information.\nc.\tLMF can also maintain serving UE IP list from BSF query or SIP IP header of SIP INVITE with co-location with LRF/RDF in emergency IMS call. LMF can use UE IP to match ECS in LCUP DNS query to know whether it is the serving LMF so that its cooperated LCUP assistance can be replied for the DNS query.\n2.\tUE connects to the LCUP over the user plane through the N6 interface.\n3.\tUE establishes TLS connection possibly with LCUP assistance data or pre-configured trusted certificates.\n4.\tUE can start OMA specified SUPL positioning procedures besides the control plane MT/MO/NI procedures.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tProcedures",
                            "text_content": "LMF offload traffic to cooperated LCUP.\nFigure 6.2.3.1-1: LMF offload traffic to cooperated LCUP\n1.\tThe external location services client sends a request to the GMLC for a location for the target UE identified by an GPSI or an SUPI.\n2.\tThe GMLC invokes a Nudm_UECM_Get service operation towards the home UDM of the target UE to be located with the GPSI or SUPI of this UE.\n3.\tThe UDM returns the network addresses of the current serving AMF.\n4.\tThe GMLC invokes the Namf_Location_ProvidePositioningInfo service operation towards the AMF to request the current location of the UE. The service operation includes the SUPI, and client type and may include the required QoS, Supported GAD shapes and UE UP capability.\n5.\tIf the UE is in CM IDLE state, the AMF initiates a network triggered Service Request procedure as defined in clause 4.2.3.3 of TS 23.502 [3] to establish a signaling connection with the UE.\n6.\tThe AMF selects an LMF based on the available information as defined in clause 5.1 or based on AMF local configuration. The LMF selection takes the 5G-AN currently serving the UE into account. The selection may use an NRF query.\n7.\tThe AMF invokes the Nlmf_Location_DetermineLocation service operation towards the LMF to request the current location of the UE.\n8.\tLMF offloads the LPP traffic to its cooperated LCUP by one of the methods in clause 6.2.2.\n8.a\tThe cooperated LMF can perform one or more of the positioning procedures with RAN defined by 3GPP.\n8.b\tThe cooperated LCUP can perform one or more of the positioning procedures with UE defined by OMA.\nNOTE:\tLPPe can be executed in step 8.b.\n9.\tThe LMF returns the Nlmf_Location_DetermineLocation Response towards the AMF with the combined result from cooperated LMF and LCUP.\n10.\tThe AMF returns the Namf_Location_ProvidePositioningInfo Response towards the GMLC/LRF.\n11.\tThe GMLC sends the location service response to the external location services client.\nThe figure depicts a 5G network with various components such as base stations (gNB), user equipment (UE), and scatterers. The diagram illustrates the signal propagation in a 5G network, highlighting the multi-path signal path and beamforming techniques to mitigate interference. The fiber-optic backbone architecture is shown in Figure 4, with core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are depicted in dashed lines, ensuring failover reliability. The layered design aligns with SDN principles.\nFigure 6.2.3.2-1\n1.\tURSP rules can be provisioned as an example in TS 23.503 [16]:\n\n\n2.\tURSP rules are applied to UE.\n3.\tThe start of 3GPP LCS procedures contained in TS 23.273 [5].\n4.\tRequest comes to LMF with UE identity in inputData of Nlmf_Location_DetermineLocation request. When UE provides the user plane capability in registration, the request could take such capability in its parameters.\na.\tLMF can use UE id to query BSF for UE IP; in emergency IMS call, E-CSCF forwards SIP INVITE to GMLC/LRF. Through GMLC/LRF, LMF can also get the UE IP from SIP header of the SIP INVITE.\nNOTE 1:\tIf authentication work needed, it should be handled by SA WG3.\n5.\tLMF gets UE user plane capability and provides LCUP information through either LPP or NAS. LMF can also reuse legacy 2G/3G/4G SUPL mechanisms by sending SUPL INIT to UE with attempts to activate user plane connection.\na.\tLPP capability exchange is used to fetch UE user plane capability if Nlmf_Location_DetermineLocation doesn't show such capability; LMF can also use solicited or unsolicited assistance data delivery to transfer LCUP information to UE.\nb.\tIn (rare) cases that UE doesn't support LPP but supports user plane, DL_NAS_TRANSPORT can be used to query UE user plane capability and delivery the LCUP assistance information.\nc.\tTo be compatible with legacy SUPL implementation in UE, especially when LMF has knowledge of UE user plane capability by OAM provision or other means, LMF can use OMA defined push mechanisms and send SUPL INIT message to activate the user plane session.\n6, 7, 8.\tPDU session and EASDF rule execution as per TS 23.548 [10].\n9.\tIf FQDN in DNS query is uniquely mapped to one LCUP instance, the LCUP address is replied. This applies to cases when such FQDN is transferred from LMF to UE at step 5. But this may not apply to pre-provisioned H-SLP/E-SLP in UE. Such pre-configuration follows OMA SUPL specifications whose FQDN and trusted certificates override the runtime parameter transferred through step 5 or other means.\na.\tIf FQDN could be mapped to multiple LCUP instances(for example, different LCUP instances in different campus areas), EASDF attached UE address in ECS field and forward the DNS query to related LMF/LCUP instances. Since each LCUP and cooperated LMF can be configured with (e.g. local data network) address ranges, the serving LMF/LCUP instance could match UE address  among its serving UE requests and reply its LCUP address. This address is the cooperated LCUP instance that UE should establish or resume user plane session.\n10.\tDNS result is replied to UE. If the UE has previous TLS context with same FQDN, the TLS handshake workload can be minimized as per clause 6.1.1.4 in OMA-TS-ULP [14].\n11.\tUE continues to establish or resume secure user plane session. After secure connection established, user plane messages can be transferred, e.g. SUPL POS INIT for option c in step 5.\nNOTE 2:\tThe discovery process in above activation procedures follows the EAS discovery and relocation defined in TS 23.548 [10]. It covers both the initial discovery of User Plane service for the UE and also the rediscovery process when UE needs to switch different User Plane services.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.2.4\tImpacts on services, entities, and interfaces",
                            "text_content": "LMF: provides NAS, LPP assistance and acts as backend DNS server for LCS UP server instance.\nFor UE compliant with user plane specified in TS 23.271 [4], TS 38.305 [6]: there is no mandatory changes needed.\nFor UE with Rel-18 enhancement: there can be update to support DL_NAS_TRANSPORT and/or LPP assistance for User Plane assistance.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tSolution #3: User plane location capability transfer and positioning via user plane",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #1 on Positioning via user plane transmission.\nIn this solution, UE 'user plane location capability' can be regarded as a part of 5GMM capability or as a LPP sub-capability. If network determines to use user plane for positioning, the network should send the information (e.g. address information) of the LMF supporting user plane positioning functionality to UE to enable the user plan connection.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tFunctional Description",
                            "text_content": "In this solution, we assume LMF is integrated with a user plane location function , to which UE needs to establish a user plane connection if user plane positioning is to be used.\nBefore a UE establishes the user plane connection, it is required to send user plane location capability to the network so that the network knows that the UE supports positioning via user plane then can determine to use user plane for positioning. Thus, for the 'user plane location capability' awareness, UE can include its 'user plane location capability' as part of the '5GMM Capability' in the Registration Request message (Option 1) or the existing LPP capability transfer should cover the 'user plane location capability' indication (Option 2).\nDuring the MO or MT positioning procedure, after the network determines to use user plane positioning, the network should indicate the UE to use user plane for positioning with the address information of LMF. With the address information, UE can establish a secure connection with the LMF, and via this secure connection, position messages can be transferred between UE and the LMF. The established user plane connection may be reused for subsequent user plane position messages transmission trigged by UE or LMF, e.g. if UE does not move to a new place, does not have new QoS requirements and uses the same positioning method via the user plane.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.3\tProcedures",
                            "text_content": "During the MO-LR or MT-LR procedures, LMF may request the UE to provide the user plane location capability. Figure 6.3.3.1.-1 presents the capability transfer procedure, the ProvideCapabilities message message described in TS 37.355 [15] should support to carry 'user plane location capability' indication.\nThe figure depicts a capability transfer scenario in a 5G network, illustrating how the network's capabilities are transferred between different entities. The diagram shows the various components involved, such as the base station (gNB), user equipment (UE), and other network elements. The figure highlights the importance of network slicing and network slicing functions (NSF) in managing and distributing network resources.\nFigure 6.3.3.1-1: Capability transfer\n1.\tAMF sends Nlmf_Location_DetermineLocation Request to the LMF.\n2-3.\tThe LMF invokes the Namf_Communication_N1N2MessageTransfer service operation towards the AMF to request the transfer of a Downlink (DL) Positioning message to the UE. The Downlink Positioning message queries for the UE capabilities if the UE Positioning Capability is not received from AMF. The AMF forwards the Downlink Positioning message to the UE in a DL NAS TRANSPORT message.\n4-5.\tUE provide its 'user plane location capability' indication in an Uplink Positioning message included in a NAS TRANSPORT message, if it supports user plane positioning method.\nThe figure depicts a 5G-based LTE-U (User Plane) procedure for a 5GC (5G Core) network, illustrating the steps involved in the 5GC-MT-LR (Multi-Terahertz-Band) procedure. The figure includes key components such as the 5G Core, LTE-U, and the 5GC-MT-LR procedure, which is a key component of 5G Core networks. The figure highlights the importance of 5G Core networks in providing high-speed data services and enabling the integration of 5G and LTE technologies.\nFigure 6.3.3.2-1: 5GC-MT-LR Procedure via user plane\n0a.\tUE registration procedure in figure 4.2.2.2.2-1 of TS 23.502 [3]. If Option 1 for UE capability awareness is selected, UE include its 'user plane location capability' indication as part of the '5GMM Capability' in the Registration Request.\n0b.\t[Conditional] AMF may trigger UE to establish a PDU session for later usage based on the capability of UE, UE location, and subscription information if 'user plane location capability' indication is received in step 0a.\n0c.\t[Conditional] UE establishes a PDU session for positioning if receiving the trigger in step 0b.\n1~10.\tSteps 1-10 of figure 6.1.2-1 in TS 23.273 [5]. For the step 10, if UE include its 'user plane location capability' indication as part of the '5GMM Capability' in the Registration Request message (Option 1 for UE user plane location capability awareness), AMF selects a LMF supporting user plane location based on the capability information.\n11.\tThe AMF invokes the Nlmf_Location_DetermineLocation service operation towards the LMF to request the current location of the UE, which carries the 'user plane location capability' information of UE if AMF received it in step 10. AMF also sends its notification URL to LMF in this message for subscription of secure user plane connection status.\n12-13.\t[Conditional] Steps 2-5 of clause 6.3.3.1 for capability transfer, if Option 2 for UE user plane location capability awareness is used and LMF has not obtained the capability of UE.\n14.\tBased on the 'user plane location capability' indication of the UE received in step 11 or step 12-13, the Positioning methods and modes the UE supports, the load of the control plane, service type, Client Type, deferred location type, required location QoS received in step 11, LMF decides whether to continue the position procedure via user plane. Steps 15-20a is skipped if there is already user plane connection context of the target UE in LMF.\n15.\t[Conditional] If LMF decides to utilize user plane and there is no established secure user plane positioning for the UE, LMF sends a user plane positioning information to AMF to indicate UE to use user plane positioning. The user plane positioning information includes the FQDN or IP address of the LMF, the S-NSSAI and DNN for the PDU session used for user plane positioning, a temporary UE identifier and security related information. LMF may send a dedicated DNN for user plane connection. Also, the LMF may require the UE to report the IP address of the PDU session used for user plane positioning. If UE supports more than one positioning methods, LMF may also indicate UE which type of positioning methods should use the user plane connection, while others may still use the control plane (e.g. user plane for sensor method and control plane for NR-based positioning method). The user plane positioning information transfer can be based on NAS signalling or enhanced LPP.\nNOTE:\tLMF can select different positioning methods (e.g. motion sensor-based method) for the user plane and it is based on implementation and local configuration to determine which positioning method to use on user plane.\nEditor's note:\tThe security mechanism and security information provided by LMF to UE is subject to SA WG3's work.\n16.\t[Conditional] When AMF receives the user plane information from LMF in step 15, AMF sends it to UE via a DL NAS TRANSPORT message.\n17.\t[Conditional] The UE starts to establish a secure connection with LMF. If UE finds there is no suitable existing PDU session for user plane positioning, UE should establish a PDU session with the S-NSSAI and DNN received from the positioning information. SMF should select a UPF connecting with the LMF based on S-NSSAI, DNN (maybe a dedicated DNN), and UE location information, etc.\n18.\t[Conditional] If the suitable PDU session exists, UE sends an acknowledgement to LMF through AMF via a UL NAS TRANSPORT message, to confirm that user plane position is chosen, and the IP address of the PDU session may also be included in the acknowledgement. If there is no suitable existing PDU session and the PDU session establishment failed in step 17, a failure indication should be included in the acknowledgement message.\n19.\t[Conditional] AMF sends the acknowledgement received in step 18 to the LMF via Namf_N1messageNotify service.\n20a.\tUE establishes a secure user plane connection with LMF.\n20b.\tLPP message can be transferred between UE and LMF for UE based positioning, UE assisted positioning and delivery of assistance data. If the user plane secure connection has been established, LMF directly sends LPP messages to UE. The message flow of step 20a and 20b is described in clause 6.3.3.4.\n21~23.\tSteps 9~11 of figure 6.1.1-1 in TS 23.273 [5]. In step 21, LMF indicates AMF in the Nlmf_Location_DetermineLocation Response message that a user plane positioning method is used. AMF should store the indication information and LMF ID, which presents that there is a user plane connection between the UE and LMF.\n24. UE and LMF may maintain the secure user plane connection for later message transfer via user plane. If UE or LMF release the connection, LMF should send an Nlmf_Location_EventNotify message to indicate AMF to release related resources. This step can occur at any time after step 21.\nThe figure depicts a 5G-based network architecture, specifically highlighting the use of 5G Core (5GC) for Multi-Rate (MR) and Low-Rate (LR) transmission. It illustrates the user plane's involvement in the 5G network, with 3.3.2a-1 representing the user plane's role in the 5G Core. The figure also includes a 3.3.2a-1-1, which represents the user plane's role in the 5G Core.\nFigure 6.3.3.2a-1: Deferred 5GC-MT-LR via user plane\n0.\tSame with step 0a-0c in figure 6.3.3.2-1 of clause 6.3.3.2.\n1.\tSteps 1-13 of Deferred MT-LR Procedure in clause 6.3.1 of TS 23.273 [5]. In step 13, AMF selects a LMF supporting user plane positioning based on UE capability if received 'user plane location' indication in step 0.\n2-9.\tSame with steps 11-20 in clause 6.3.3.2.\n10a-10c.\tStep 16-18 of Deferred MT-LR Procedure in clause 6.3.1 of TS 23.273 [5] with following differences:\n-\tIn step 18 (step 10c in this figure), LMF indicates AMF in the Nlmf_Location_DetermineLocation Response message that a user plane positioning method is used. AMF should store the indication information, which presents that there is a user plane connection between the UE and LMF.\n-\tFor UE available location event, after step 18, LMF may still maintain the user plane connection for later usage.\n10d.\tSteps 19-21 of Deferred MT-LR Procedure in clause 6.3.1 of TS 23.273 [5] with following difference:\n-\tAfter step 19, besides storing UE user plane positioning context for periodic and trigged event report, AMF should maintain the secure user plane connection status of UE if LMF does not indicate AMF to release it.\n11-15.\tSteps 16-21 of Deferred MT-LR Procedure in clause 6.3.1 of TS 23.273 [5] with following differences:\n-\tThe Event report of step 13-14 and step 15 for UE positioning are performed via user plane.\n-\tTo reduce the event report latency, LMF and UE may maintain the user plane connection thus UE will not be in CM-IDLE state.\n16-17.\tSteps 28-31 of Deferred MT-LR Procedure in clause 6.3.1 of TS 23.273 [5].\nCancellation of event reporting can be initiated by the UE, H-GMLC or LCS Client or AF, using the control plane procedures defined in clauses 6.3.2 and 6.3.3 in TS 23.273 [5] with following differences:\n-\tLMF and UE may still maintain the secure user plane for later positioning session usage after Cancellation of Event Reporting for current positioning session. If LMF decides to release the secure user plane connection, or UE has released the secure user plane connection, LMF sends the Nlmf_Location_EventNotify message to AMF to release the stored information.\nFor MO-LR procedure, the user plane location capability may be included in the MO-LR request message, in this case there is no need for LMF to require UE to report its user plane capability if Option 2 for capability awareness is selected. After receiving the Nlmf_Location_DetermineLocation message, LMF determines whether to utilize user plane for UE positioning.\nFigure 6.3.3.2-2 presents the 5GC-MO-LR procedure via user plane, of which the principle is similar with 5GC-MT-LR Procedure via user plane. The difference is, in step 4, the user plane location capability can be carried by the Nlmf_Location_DetermineLocation message no matter whether Option 1 or Option 2 for UE capability awareness is selected.\nIf the UE has received DNNs/S-NSSAIs used for user plane positioning and established corresponding PDU sessions from previous location procedure, it may directly interact with LMF via the user plane connection for MO-LR, if the requested location service type is either location estimate of the UE or location assistance data. If the MO-LR requesting location transfer to an LCS client or AF, the UE still should send the MO-LR request through AMF, but step 5~9 in figure 6.3.3.2-2 can be skipped after LMF determined to utilize user plane.\nThe figure depicts a 5G-MO-LR procedure, which stands for Mobile-to-Macro-Leveraging-Radio, involving a secure connection between an UE and a macro-cell (LMF) in a 5G network. The figure illustrates the steps involved in establishing a secure connection, including the use of a user plane, which is a critical component in ensuring data security and privacy.\nFigure 6.3.3.3-1: 5GC-MO-LR Procedure via user plane if there is no established user plane secure connection between UE and LMF\n1-4.\tSimilar with steps 1-4 in figure 6.2-1 of clause 6.2 of TS 23.273 [5]. The difference is that the 'user plane location capability' indication can be carried by the Nlmf_Location_DetermineLocation message in step 4 no matter whether Option 1 or Option 2 for UE capability awareness is selected.\n4b-14.\tSame with steps 15-24 in clause 6.3.3.2.\nThis procedure presents the LPP Message transfer between UE and LMF via user plane. The LMF interacts with the UE in order to exchange location information applicable to UE assisted and UE based position methods.\nThe figure depicts a system where a UE (User Equipment) assists in positioning by utilizing user plane positioning (UPP) techniques. This is achieved through the use of a UE-based positioning system, which leverages the UE's own positioning capabilities to improve the accuracy of the positioning. The figure also illustrates the use of a UE-assisted positioning system, where the UE assists in positioning by using the UE's own positioning capabilities. This system is designed to improve the accuracy of the positioning by leveraging the UE's own positioning capabilities.\nFigure 6.3.3.4-4: UE assisted and UE based positioning via user plane\n1.\tBefore the LPP message transfer, UE and LMF should has established a secure connection.\n2.\tLMF send LPP Message to UE via DL UP LPP TRANSFER, which may request location information from the UE, provide assistance data to the UE or query for the UE capabilities.\n3.\tAfter receiving the downlink LPP message, the UE may store assistance data provided by LMF and/or performs positioning measurements and/or location computation.\n4.\tUE may return location information or returns capabilities to LMF via uplink LPP message.\nEditor's note:\tThe user plane transport protocol and security aspects for LPP re-use solution#1 and the conclusion of SA WG3.\nThe LMF Change procedure supports change of a serving LMF during a deferred 5GC-MT-LR procedure for periodic, or triggered location events via user plane as described in clause 6.3.2.2.a.\nWhen the there is no ongoing positioning sessions, AMF may also trigger the LMF re-selection to transfer the maintained secure user-plane connection to a new LMF.\nLMF Change Procedure with User Plane Positioning\nFigure 6.3.3.5-1: LMF Change Procedure with user plane positioning\n1.\t[Conditional] At applicable Registration events, AMF may decides to reselect a new LMF as there is a MT-LR positioning session for periodic or triggered events report via user plane of UE or there is a secure user plane connection between UE and LMF.\n2.\t[Conditional] AMF sends the Nlmf_Location_LMFRelocation request to LMF1, carrying the information of the selected new LMF2.\n3.\t[Conditional] The old LMF1 may decide to use a new LMF2 for user plane positioning.\n4-5.\tIf the old LMF1 decides to change LMF with user plane positioning, the old LMF1 sends a user plane positioning information message to AMF to include the information of new LMF2.\n6.\tUE decides whether or not the old PDU Session associated with old LMF1 for user plane positioning can be reused for the new LMF2. If not, the UE establishes the new PDU session associated with the information of new LMF2.\n7-8.\tUE sends a user plane positioning information message to AMF to acknowledge the update of new LMF2 information.\n9-10.\tThe old LMF1 performs context transfer and send the request to the new LMF2 selected in step 1 or step 3 as specified in steps 6-7 of clause 6.4 of TS 23.273 [5].\n11-12.\tAfter finishing the Location context switch, the new LMF2 sends a user plane positioning information message to AMF to indicate the accomplishment of LMF change with user plane positioning. AMF updates the routing information of serving LMF for the UE.\n13.\tThe UE utilizes the new LMF2 and PDU Session if possible for the transmission of Event report message and deletes the old PDU Session associated with the old LMF1 if possible.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.4\tImpacts on services, entities, and interfaces",
                            "text_content": "The solution impact the following network functions:\n-\tUE supports to send user plane location capability to LMF, receives user plane positioning information from LMF, support setup and release of UP connection and supports to perform positioning via user plane location connection;\n-\tLMF supports user plane location service and supports to transfer the user plane positioning information to UE.\n-\tAMF supports to trigger UE to establish a PDU session for user plane positioning based on UE capability and store the secure user plane connection status of UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tSolution #4: Direct communication between LMF and RAN node",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4.1\tIntroduction",
                            "text_content": "This solution aims to address the key issues#2: enhanced positioning architecture for NPN deployment. Particularly this solution address the following questions:\n-\tHow to realize low latency positioning procedure under NPN deployment.\n-\tHow to achieve reliable and secure location result delivery and exposure, e.g. UE location not exposed to the public network.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.2\tFunctional Description",
                            "text_content": "The following is the architecture figure in this solution.\nThe figure depicts a reference architecture for Location Services, illustrating the various components and their interconnections. It includes a base station (BS), a mobile device (MD), and a location server (LS). The BS serves as the central hub for location-related services, while the MD and LS provide location-based services to users. The architecture is designed to support location-based services, such as navigation, indoor positioning, and indoor mapping, by leveraging the capabilities of the BS, MD, and LS.\nFigure 6.4.2: Reference architecture for Location Services\nIn this solution, the LMF communicates with the RAN node via a local AMF. The LMF exchanges Network Positioning Message with RAN for Non-UE Associated Network Assistance Data procedure, without going through the AMF. The LMF directly communicates with the GMLC to exposure the UE location to GMLC directly without going through the AMF. For network assisted or network based positioning procedure, the LMF sends the Network Positioning Message(request) toward the RAN via the serving AMF. The RAN sends the Network Positioning Message(response or notification) towards LMF via the Local AMF.\nThe interface between local AMF and LMF is NL1, as defined in TS 23.273 [5]. The local AMF needs not retain state information for Network Assisted Positioning procedure and Non-UE Associated Network Assistance Data procedure, e.g. can treat any response from NG-RAN as a separate non-associated transfer.\nThe Local AMF supports the management of N2 interface, i.e. the TNL association between the RAN node and Local AMF. The TNL association between the RAN node and the local AMF is pre-established via configuration. The weight factor of TNL association with the Local AMF shall be set to zero so the RAN node shall not select the Local AMF for initial N2.\nOther functionalities supported by the serving AMF defined in TS 23.501 [2] may not be needed in local AMF.\nThe GMLC notification address is provided from AMF to LMF. The LMF notifies the UE location estimation towards the GMLC directly.\nNOTE 1:\tThis solution assumes that the LMF/Local AMF and the RAN node are in the same trusted domain.\nNOTE 2:\tIn order to reduce the latency the local AMF and LMF can be deployed together. The local AMF address is local configured in the LMF.\nNOTE 3:\tThe user plane based solution in KI#1 can be used for UE Assisted and UE Based Positioning.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.3\tProcedures",
                            "text_content": "The figure depicts a mobile terminated network assisted positioning procedure, illustrating the steps involved in positioning a mobile terminal (MT) in a network. The figure includes a schematic representation of the network, with various components such as mobile terminals (MTs), base stations (BSs), and network elements. The positioning procedure is shown in a step-by-step manner, with each step highlighted and labeled. The figure also includes a legend to aid in understanding the different components and their functions. Overall, the figure provides a clear and concise visual representation of the positioning procedure, making it easy to follow and understand.\nFigure 6.4.3-1: Mobile Terminated Network Assisted Positioning Procedure\n1.\tBased on configuration the TNL association may be pre-established between the RAN node and the Local AMF.\n2.\tThe GMLC invokes the Namf_Location_ProvidePositioningInfo service operation towards the AMF to request the current location of the UE. The service operation includes the SUPI, and client type and may include the required QoS and Supported GAD shapes.\n3.\tIf the UE is in CM IDLE state, the AMF initiates a network triggered Service Request procedure as defined in clause 4.2.3.3 of TS 23.502 [3] to establish a signalling connection with the UE.\n4.\tThe AMF selects the LMF and invokes the Nlmf_Location_DetermineLocation service operation towards the LMF to request the current location of the UE.. This service operation may also include the GMLC notification address to receive the UE location.\n5.\tThe LMF response Nlmf_Location_DetermineLocation response.\n6.\tThe AMF response Namf_Location_ ProvidePositioningInfo response with success indication.\n7.\tThe LMF sends a Namf_Communication_N1N2MessageTransfer(Network Positioning message) to the serving AMF.\n8. The serving AMF sends DOWNLINK UE ASSOCIATED NRPPA TRANSPORT via the TNL association to the RAN node to request position related information from the RAN node. The N2 Transport message includes the Routing ID of the LMF.\n9.\tThe target RAN node determines the Local AMF based on the configuration or Routing ID of the LMF, and returns any position related information to the Local AMF in a Network Positioning message included in an UPLINK UE ASSOCIATED NRPPA TRANSPORT message. The N2 Transport message includes the Routing ID of the LMF received from the serving AMF. The AMF NGAP UE ID is set to one received from the serving AMF.\n10.\tThe Local AMF sends Namf_Communication_N2InfoNotify(Network Positioning message) to the LMF identified by the Routing ID.\n11.\tThe LMF invokes the Nlmf_Location_EventNotify service operation towards the GMLC notification address received from AMF in step 4.\nThe figure depicts a network assistance data procedure for non-UE associated network assistance, with a focus on the steps involved in providing assistance to a non-UE network. The figure includes a flowchart with various steps, such as identifying the non-UE network, initiating the assistance process, and providing the necessary data. The figure also includes a legend to clarify the different types of data being presented. Overall, the figure provides a clear and concise visual representation of the network assistance data procedure, making it easy to understand and follow.\nFigure 6.4.3.2: Non-UE Associated Network Assistance Data procedure\n1.\tBased on configuration the TNL association may be pre-established between the RAN node and the LMF/Local AMF.\n2.\tThe LMF decides the Local AMF and invokes Namf_Communication_NonUeN2MessageTransfer service operation in the Local AMF. 3.\tThe Local AMF sends a Network Positioning message in the DOWNLINK NON UE ASSOCIATED NRPPA TRANSPORT message via the TNL association to the RAN node to request position related information from the RAN node.\n4.\tThe target RAN node returns any position related information to the LMF in a Network Positioning message included in an UPLINK NON UE ASSOCIATED NRPPA TRANSPORT message.\n5.\tThe Local AMF invokes the Namf_Communication_N2InfoNotify service operation to the LMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.4\tImpacts on services, entities, and interfaces",
                            "text_content": "LMF:\n-\tExchange the Non-UE associated Network Positioning message with RAN node via the Local AMF.\n-\tSend the UE location directly to the GMLC.\nLocal AMF:\n-\tReceives UE or non-UE associated Network Positioning message from the RAN node.\n-\tForward the UE or non-UE associated Network Positioning message towards the LMF identified by the Routing ID.\nRAN node:\n-\tSends UE or non-UE associated Network Positioning message towards the Local AMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tSolution #5: LCS architecture with \"any AMF\"",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tIntroduction",
                            "text_content": "This solution is applicable to LCS procedure including MO-LR, MT-LR, and LDR. When network based positioning method is selected by LMF, the signalling between LMF and NG-RAN, LMF and GMLC, are not transmitted to the AMF in the public network.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tFunctional Description",
                            "text_content": "Architecture for this solution is illustrated as below.\nThe figure depicts the architecture for an NPN (Non-Passive Network) system, illustrating the various components and their interconnections. The NPN system is designed to support high-speed data transmission and is characterized by its non-passive nature, which means that it does not rely on passive components such as optical fibers or passive optical network (PON) elements. The figure shows the various layers of the system, including the core switches, optical line terminals (OLTs), and distributed nodes, which are interconnected to ensure efficient data transmission. The layered design of the NPN system aligns with the principles of Software-Defined Networking (SDN), which allows for the control and management of network functions through a centralized software platform.\nFigure 6.5.2-1: Architecture for NPN\nWhen UE registers to the network, NG-RAN 1 is the serving RAN node for the UE. NG-RAN 1 shall select an AMF in the public network'. It is assumed, by means of configuration, that \"any AMF\" cannot be selected as the serving AMF of the UE.\nMultiple RAN nodes are deployed in the campus network. At a given time, only a certain RAN (e.g. RAN 1 in the figure) is the serving RAN of the UE. Other RAN nodes may be selected by the LMF to measure the UE positioning signal.\nIt is assumed all RAN nodes in the campus network have TNL association and NG-AP connection with the \"any AMF\".\nCurrent LCS design assumes NG-RAN report UE measurement to AMF (NRPPa message) and then to LMF. Because the NG-AP message may not be cyphered, it is likely the information will be sniffed by other entity in the transport network, which leads to exposure concern.\nIt is proposed to update the NRPPa signalling as follows:\nDuring the location request procedure, if network based positioning method is selected by LMF, for UE associated NRPPa signalling, it is transmitted via the serving AMF. For non UE associated NRPPa signalling, it is transmitted using \"any AMF\" deployed in the campus network.\nThe description of using \"any AMF\" is specified in TS 38.305 [6]:\nAn LMF can interact with any gNB reachable from any of the AMFs with signalling access to the LMF in order to obtain location related information to support the NR RAT-Dependent positioning methods. The information can include timing information for the TRP in relation to either absolute GNSS time or timing of other TRPs and information about the supported cells and TRPs including PRS schedule.\nSignalling access between the LMF and gNB may be via any AMF with signalling access to both the LMF and gNB.\n\"any AMF\" is an AMF defined in TS 23.501, and needs to support the following functionality in this solution.\n-\thandling of Namf_nonUEN2message transfer service from LMF;\n-\tNG-AP message capsulation and decapsulation for UL and DL non UE associated NRPPa message.\nOther functionalities supported by the AMF may not be needed in \"any AMF\".\nNOTE 1:\tBased on configuration by the campus network, the NG-RAN(s) are configured with the \"any AMF\" address, and establish NG-AP association with the any AMF.\nTopology of NG-RAN, \"any AMF\" and LMF are configured by the operator. LMF is configured with \"any AMF\" address. NG-RAN nodes in the campus network establishes TNL association with \"any AMF\" in the campus network.\nNOTE 2:\tthis solution is for the positioning procedure using UL positioning method. Regarding the positioning procedure using DL positioning method, solution#3 can be a candidate.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tProcedures",
                            "text_content": "Same as clause 6.11.2 of TS 23.273 [5].\nThe AMF illustrated in this call flow is the serving AMF of the UE.\nThe figure depicts a network-assisted positioning procedure, illustrating the steps taken to ensure accurate and reliable positioning in a wireless network. The diagram includes various components such as base stations (BSs), mobile devices (MDs), and satellites (SUs), all working together to provide accurate location information. The figure highlights the importance of network-assisted positioning in today's wireless communication systems, as it helps to overcome the challenges posed by obstacles and interference.\nFigure 6.5.3.1-1: Network assisted positioning procedure\nSame as clause 6.11.3 of TS 23.273 [5].\nThe AMF illustrated in this call flow is \"any AMF\" deployed in the campus network. LMF is configured with \"any AMF\" address. NG-RAN nodes in the campus network establishes TNL association with \"any AMF\" in the campus network.\nThe figure depicts a network assistance data collection system, illustrating the process of obtaining non-UE associated network assistance data. The system includes a network assistance data collection device (NDCD), a network assistance data collection server (NDDS), and a network assistance data collection application (NDSA). The NDCD collects data from the network assistance device (NDD) and sends it to the NDDS, which then processes and stores the data. The NDSA is a user interface application that allows network assistance users to access and view the collected data. The figure also includes a network assistance data collection system diagram (NDSDS) and a network assistance data collection system flowchart (NDSACF).\nFigure 6.5.3.2-1: Obtaining Non-UE associated network assistance data\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.4\tImpacts on services, entities, and interfaces",
                            "text_content": "LMF:\n-\tconfigured with \"any AMF\" address.\n-\tif network based positioning method is selected by LMF, for UE associated NRPPa signalling, it is transmitted via the serving AMF. For non UE associated NRPPa signalling, it is transmitted using \"any AMF\" deployed in the campus network.\nNG-RAN:\n-\testablishes TNL association with \"any AMF\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.6\tSolution #6: LMF selection based on LMF ID",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tIntroduction",
                            "text_content": "This solution aims to address the key issues#3: Local Area Restriction for an LMF and GMLC. In this solution the LMF discovery and selection mechanism is enhanced to use LMF ID as input parameter.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.2\tFunctional Description",
                            "text_content": "In this solution, the GMLC is configured with an LMF ID of the LMF located within the same local area of the GMLC. The LMF may register itself in the NRF. The GMLC provides the LMF ID to AMF in Namf_Location_ProvidePositioningInfo service operation. The AMF uses the LMF ID to discover the LMF via NRF query or local configuration and invokes the Nlmf_Location_DetermineLocation service operation to request the current location of the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.3\tProcedures",
                            "text_content": "The figure depicts a 3-1 5GC-MT-LR procedure, which is a method used in 5G Cellular Network (5GC) to manage and maintain the network's load balancing and resource allocation. The figure illustrates the steps involved in the procedure, including the use of load balancing algorithms, network resource allocation, and the management of network resources. The figure is important for understanding the 5G network's load balancing and resource allocation processes, as well as the importance of these processes in maintaining the network's performance and reliability.\nFigure 6.6.3-1: 5GC-MT-LR procedure\n1.\tThe external location services client sends a request to the GMLC for a location for the target UE identified by an GPSI or an SUPI.\n2.\tThe GMLC invokes a Nudm_UECM_Get service operation towards the home UDM of the target UE to be located with the GPSI or SUPI of this UE.\n3.\tThe UDM returns the network addresses of the current serving AMF.\n4.\tThe GMLC invokes the Namf_Location_ProvidePositioningInfo service operation towards the AMF to request the current location of the UE. The service operation includes the SUPI, and client type and may include the required QoS and Supported GAD shapes. The service operation may also include the LMF ID if it is configured in the GMLC.\n5.\tIf the UE is in CM IDLE state, the AMF initiates a network triggered Service Request procedure as defined in clause 4.2.3.3 of TS 23.502 [3] to establish a signalling connection with the UE.\n6.\tThe AMF selects the LMF based on the LMF ID received from GMLC. The selection may use a NRF query or local configuration.\n7-11.\tSame steps 7-11 in clause 6.1.1 of TS 23.273 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.4\tImpacts on existing entities and interfaces",
                            "text_content": "GMLC:\n-\tConfigured with LMF ID in the same location area.\n-\tSend the LMF ID to AMF in Namf_Location_ProvidePositioningInfo service operation.\nAMF:\n-\tSelect the LMF according to the LMF ID received from the GMLC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tSolution #7: LMF selection based on client or AF identifier",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.7.1\tIntroduction",
                            "text_content": "This solution is to address KI#3: Local Area Restriction for an LMF and GMLC.\nLMF selection functionality is used by the AMF to determine an LMF for location estimation of the target UE. In some local cases, operators may deploy specific LMF and GMLC for enterprises for some customized or privacy requirements. But the UEs of different enterprises may share the same AMF or AMF pool. In order to select the right LMF for specific enterprise, AMF could use new identifiers which can map between enterprise and specific LMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.2\tFunctional Description",
                            "text_content": "Based on the scenarios mentioned above, AMF may use client identifiers or AF identifiers as one of the additional factors during the LMF selection, as specified in clause 5.1 in TS 23.273 [5]. The client and AF request the location information of the target UE, whose identifiers are assigned by the operator. The selection policy can be configured locally at AMF, or by querying NRF.\nIf the LMF selection is performed at the AMF by querying NRF, LMF shall register with the client or AF identifier(s) that the LMF can serve.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.3\tProcedures",
                            "text_content": "N/A.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.4\tImpacts on services, entities, and interfaces",
                            "text_content": "AMF:\n-\tTake AF or client identifier(s) into account during the LMF selection.\nAF:\n-\tProvide the AF identifier(s) in location service procedures.\nUE:\n-\tProvide the client or AF identifier(s) to AMF in location service procedures.\nLMF:\n-\tRegister in NRF with serving AF or client identifier(s).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.8\tSolution #8: LMF Selection based on GMLC service area",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tIntroduction",
                            "text_content": "This solution addresses KI#3: Local Area Restriction for an LMF and GMLC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tFunctional Description",
                            "text_content": "The existing LMF selection mechanism is re-used with the following enhancements:\n-\tWhen AMF selects LMF: a new factor considered for LMF selection is added, i.e. GMLC service area consisting of one or more TA(s) which is locally configured in AMF.\n-\tWhen AMF selects target LMF: if the GMLC is restricted to supporting local services in a local area, it selects target LMF able to support location in the same local area.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.3\tProcedures",
                            "text_content": "The existing LMF Change Procedure in clause 6.4 in TS 23.273 [5] is re-used.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.4\tImpacts on services, entities, and interfaces",
                            "text_content": "AMF:\n-\tConsider GMLCS service area when selecting LMF.\nLMF:\n-\tIf the LMF is restricted to supporting local services in a local area, it selects target LMF in the same local area.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.9\tSolution #9: local LMF and GMLC selection",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.9.1\tIntroduction",
                            "text_content": "This solution enables dedicated LMF and GMLC selection for the UE positioning in the local network. The solution addresses key issue 1 and key issue 3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.2\tFunctional Description",
                            "text_content": "Three options are proposed for the AMF to select a local LMF and local GMLC:\n-\tBased on operator's configuration. An example could be a mapping table of UE identity e.g. GPSI and LMF/GMLC address is stored at AMF.\n-\tFetch from UDM, UE LCS subscription storing its serving local LMF and local GMLC address.\n-\tUE LCS subscription data indicate a set of parameters including the dedicated DNN, UPF, and LMF/GMLC. When retrieved by AMF, User Plane positioning is determined for UE positioning. AMF triggers the PDU session establishment by indicating SMF with the UPF, and LMF/GMLC identifier. For example, in solution#3 step 0c, when AMF receives the PDU session request from UE, AMF includes the UPF, and LMF/GMLC identifier to the SMF, when invoking a Nsmf_session create service operation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.3\tProcedures",
                            "text_content": "Is clause 6.1.2 of TS 23.273 [5].\nThe figure depicts a local multi-level frequency selection (LMF) procedure for the commercial location service, highlighting the importance of selecting the appropriate frequency bands for each location. The figure illustrates the selection process, with different levels of frequency bands (e.g., 100 MHz, 200 MHz, 300 MHz, etc.) and the corresponding selection criteria (e.g., minimum, maximum, and average power). The figure also includes a legend to help understand the different selection levels and their corresponding selection criteria. Overall, the figure provides a clear and concise visual representation of the local LMF selection process for the commercial location service.\nFigure 6.9.3.1-1: Local LMF selection during 5GC-MT-LR procedure for the commercial location service\nOther steps are same as in TS 23.273 [5], except step 10:\n10.\tAMF, based on local configuration, e.g. mapping table mapping table of UE identity e.g. MSISDN and LMF address, or the UE LCS subscription data where includes a dedicated LMF ID, selects an LMF.\nDuring the UE initial registration procedure, AMF retrieves the UE LCS subscriber data from UDM. If the subscriber data includes the DNN, UPF, and LMF/GMLC, AMF determines to trigger the PDU session establishment for user plane positioning using these parameters. Procedures are described in solution#3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.4\tImpacts on services, entities, and interfaces",
                            "text_content": "AMF:\n-\tconfigured locally, a mapping table of UE identity e.g. MSISDN and LMF/GMLC address is stored at AMF.\n-\tFetch from UDM, UE LCS subscription storing its serving local LMF and local GMLC address.\n-\tDetermine the LMF for the location request.\nUDM:\n-\tStores UE LCS subscriber data including:\n-\tserving local LMF and local GMLC address;\n-\ta set of parameters including the dedicated DNN, UPF, and LMF/GMLC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.10\tSolution #10: Support interaction between location service and NWDAF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.10.1\tIntroduction",
                            "text_content": "This solution addresses KI#4: Interaction between Location Service and NWDAF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.2\tFunctional Description",
                            "text_content": "This solution reuses the existing architecture and interfaces to support interaction between location service and NWDAF:\n-\tBased on description in clause 4.3.2 of TS 23.273 [5], the LCS service supports NFs to access LCS services from a GMLC. So the Ngmlc interface is re-used when NWDAF obtains UE location by invoking LCS services.\n-\tBased on description in clause 4.2.0 of TS 23.288 [9], any 5GC NF can request network analytics information from NWDAF. So the Nnwdaf interface is re-used when LMF obtains data analytics from the NWDAF. In this solution, the LMF selects positioning method based on WLAN performance analytics from the NWDAF.\n-\tThe existing privacy check mechanism is re-used with enhancements of introducing the following new LCS Client Type and Service Type which are used by NWDAF to request UE location:\n-\tnew LCS Client Types for PLMN Operator Class:\n-\tNWDAF client in the HPLMN (when the UE is currently being served by the HPLMN);\n-\tNWDAF client in the VPLMN；\n-\texempted NWDAF client in the HPLMN (when the UE is currently being served by the HPLMN);\n-\texempted NWDAF client in the VPLMN.\nNOTE:\tFor the exempted NWDAF client in the HPLMN and the exempted NWDAF client in the VPLMN, which may indicate the privacy check is performed on the NWDAF side, then the privacy check procedure in LCS will be skipped in some scenarios with the signalling reduction purpose. Performing the privacy check on the NWDAF side needs coordination work with eNA_Ph3.\n-\tnew standardized Service Type for Tracking Services:\n-\tAnalytics;\n-\tModel training.\n-\tThe NWDAF may invoke LCS services for a SUPI, a list of SUPI or an internal group identifier. The NWDAF determines the identifier as described in TS 23.288 [9].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.3\tProcedures",
                            "text_content": "The figure depicts a network-wide location service (NWDAF) access mechanism, which utilizes existing mechanisms to access location services. The NWDAF is designed to provide location-based services to users, enabling them to access information about their location and nearby points of interest. The figure shows the various components and connections involved in the NWDAF access process, including the location service provider (LSP), the location service request (LSR), and the location service response (LRS). The figure also illustrates the communication paths and connections between the LSP, LSR, and LRS, as well as the network infrastructure that supports the NWDAF access mechanism.\nFigure 6.10.3.1-1: NWDAF accesses location service based on existing mechanism\n1.\tNWDAF invokes Ngmlc_Location_ProvideLocation Request to GMLC.\nThe NWDAF includes the LCS Client Type, Service Type, LCS QoS and UE identifier in the Request.\nThe LCS Client Type is NWDAF client in the HPLMN (when the UE is currently being served by the HPLMN) or NWDAF client in the VPLMN. The Service Type is analytics or model training. The UE identifier is SUPI, SUPI list or an internal group identifier.\nIf the NWDAF requests location of any UE within an Area of Interest, it provides the Area of Interest instead of UE identifier.\n2.\tThe GMLC performs steps 2-23 in clause 6.1.2, or steps 2-29 in clause 6.3.1, or triggers the procedure in clause 6.8 of TS 23.273 [5].\nIf the UE identifier is SUPI, the GMLCS performs steps 2-23 in clause 6.1.2, or steps 2-29 in clause 6.3.1 of TS 23.273 [5]. If the UE identifier is SUPI list, the GMLC performs the procedure above for each SUPI in the list. If the UE identifier is an internal group identifier, the GMLC performs the procedure in clause 6.8 of TS 23.273 [5].\nIf the NWDAF provides an Area of Interest in step 1, the GMLC obtains from AMF a list of UEs located within the Area of Interest and then performs step 2.\n3.\tThe GMLC sends Ngmlc_Location_ProvideLocation Response to NWDAF.\nThe procedure in clause 6.11.4 of TS 23.288 [9] can be re-used.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.4\tImpacts on services, entities, and interfaces",
                            "text_content": "LMF:\n-\tSelects positioning method based on data analytics from NWDAF.\nGMLC:\n-\tIf the UE identifier is SUPI list in the Ngmlc_Location_ProvideLocation Request, the GMLC triggers the existing positioning procedure for each SUPI in the list.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.11\tSolution #11: Interaction Enhancement between LCS and NWDAF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.11.1\tIntroduction",
                            "text_content": "This solution addresses the KI \"Key Issue #4: Interaction between Location Service and NWDAF\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.2\tFunctional Description",
                            "text_content": "TS 23.273 [5] defines LCS QoS to have the following attributes:\n-\tLocation Accuracy.\n-\tResponse time.\n-\tQoS Class.\nAmong these, the QoS Class attribute gives the requirement on the other attributes like accuracy or response time. It could take values Best Effort, Multiple QoS Class or Assured. While the Best Effort class is the least stringent one, the other two require the LMF to determine how accurate its location estimate is.\nFor example:\n-\tIn the case of \"Multiple QoS Class\", if the accuracy is less than what is required, the LMF shall rerun the estimate with more measurements etc. to achieve the accuracy required.\n-\tIn the case of \"Assured\" QoS Class, the procedure fails if the accuracy required is not met.\nThis is a data analytics-based solution that shall run in the NWDAF where a Machine Learning model is trained using data like positioning estimate, positioning method used, assistance data, UE ID, time of the day etc. and corresponding accuracy. This model is then subsequently used by the LMF to determine if its location estimate meets the accuracy required and take appropriate action. To enable this, the LMF makes use of a Service Based API that is exposed by the NWDAF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.3\tProcedure",
                            "text_content": "The figure depicts a positioning accuracy assessment using machine learning (ML) algorithms. It illustrates the accuracy of the positioning system in a real-world scenario, with various scenarios and their corresponding positioning accuracy metrics. The figure provides a visual representation of the positioning accuracy, highlighting the importance of ML algorithms in improving positioning accuracy in real-world applications.\nFigure 6.11.3-1: ML based positioning accuracy\nStep 0.1:\tThe LMF invokes NWDAF API to subscribe to the Analytics ID corresponding to Location Accuracy for a given target area, this acts as a trigger for the NWDAF to do the offline training of the corresponding ML model.\nEditor's note:\tWhether to use new Analytics ID or reuse existing one is FFS and may need to be decided in coordination with eNA_ph3.\nStep 0.2:\tThe NWDAF performs the offline training of the model using supervised data. It may also access labelled data collected from eg.MDT for its training purposes. The training is complete waiting for analytics request from the LMF for that Analytics ID.\nStep 1:\tLCS Client requests UE location with QoS Class as either \"Multiple QoS Class\" or \"Assured\" along with the location accuracy required. The expected behaviour from the LMF is as given in clause 6.11.2.\nStep 2:\tThe LMF initiates the LCS session as given in TS 23.273 [5] and derives the UE location estimate\nStep 3:\tThe LMF then queries the NWDAF for the location estimate accuracy giving as inputs the subscribed Analytics ID, location estimate and other parameters like UE ID, assistance data, time of the day etc. The NWDAF uses the corresponding model trained in Step: 0.2 and provides the location accuracy as the output to the LMF.\nNOTE 1:\tThe training done in step 0.2 gives the ML model the ability to predict the location accuracy without the need for a reference location estimate. This is made possible by the extensive training done using various accuracy/reference values, which result in the computing of weights in the ML model. Such a trained model can then be used for an inference/prediction of the location accuracy in this step. An internal PoC has shown very encouraging results using such an ML model\nNOTE 2:\tThe NWDAF and related aspects of this solution to be further discussed in FS_eNA_Ph3, as part of Key Issue #9: Enhancement of NWDAF with finer granularity of location information given in TR 23.700-81 [23].\nStep 4:\tLMF compares the location accuracy got in step 3 with the required location accuracy got in step 1 from the LCS Client.\nStep 5:\tIf the required location accuracy is not met, the LMF may take subsequent actions like re-executing the LCS procedure with more stringent parameters (for example: higher periodicity measurements).\nStep 6:\tThe LMF returns the location estimate with the required accuracy.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.4\tImpacts on services, entities, and interfaces",
                            "text_content": "LMF:\n-\tTo request and receive analytics corresponding to Location Accuracy for a given target area from NWDAF.\n-\tTo decide whether the required location accuracy is met or not based on the analytics provided by NWDAF.\nNWDAF:\n-\tTo support Analytics ID corresponding to Location Accuracy for a give target area.\n-\tTo provide the Location Accuracy analytics to LMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.12\tSolution #12: Supporting analytics for location accuracy",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.12.1\tDescription",
                            "text_content": "As part of the location services requirements defined in TS 22.071 [18], one of the main requirements for the LCS service is the support of Location Accuracy.\nThe location accuracy is provided in terms of horizontal, vertical accuracy and response time. In general the accuracy of the location depends on the positioning technology used, the varying radio environments (e.g. considering multipath propagation), the type of environment where the location is measured (dense urban area or rural area).\nThe location accuracy required by each service varies and can vary from location accuracy up to 200km for weather services to location accuracy of up to 50m for Asset Location, route guidance, navigation. Further information is provided in Table 4.1 of TS 22.071 [18].\nWhen a location client requires a location accuracy the location client may include in the request to the GMLC:\n-\tA response time (no delay, low delay, delay tolerant).\n-\tHorizontal and/or vertical accuracy requirements (in meters).\n-\tLCS QoS Class (best effort, assured or multiple QoS corresponding to a priority of QoS accuracy).\nWhen the LMF determines the location the LMF also determines the accuracy of the location and also whether the location requirements are met which are sent to the GMLC. The GMLC responds to the client the accuracy of the location measurement can be met.\nAnalytics from the NWDAF can be enhanced to allow a location client to be aware if a location accuracy can be met. Example consumers of such analytics is as follows:\n-\tLMF uses the analytics to identify the best positioning method to use to determine a location in a specific area, taking into account UE capabilities, QoS requirements and operator policies.\n-\tThe location client can determine to upgrade/downgrade the requested LCS QoS taking into account the analytics of location accuracy.\n-\tThe location client can adapt the application service accordingly. For example, a navigation service can take into account areas where location accuracy cannot be met when providing route guidance.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.2\tProcedures",
                            "text_content": "A consumer (e.g. a location client) requests from the NWDAF analytics for \"Location Accuracy Sustainability\". The request may also include the following as Analytic Filters:\n-\tA target area.\n-\tA target UE (not applicable for option 1), group of UEs (not applicable for option 1) or any UE.\n-\tTime of Day.\n-\tAn LCS QoS Class or Horizontal/Vertical Accuracy requirement (denotes the requested LCS QoS or Horizontal/Vertical accuracy requirement.\n-\tOptionally a positioning method used.\n-\tA location accuracy threshold, i.e. report accuracy analytics only if the location accuracy exceed an horizontal or a vertical accuracy threshold (in meters).\nThe analytics consumer may also include as Analytic Filters within the location request the following:\n-\tAn indication to report the ratio of UEs using LOS/NLOS measurements in a target area.\nTwo options are available from the NWDAF to collect input data for Location Measurement Accuracy:\n-\tOption 1: Data Producer is the LMF (applicable when an analytics consumer requests Location Accuracy Analytics for any UE for a specific Target Area).\n-\tOption 2: Data Producer is the GMLC.\nData collection for Option 1:\nThe NWDAF finds the LMF that servers a target area. The NWDAF then invokes a new SBI (e.g. Nlmf_Event_Exposure) and requests data from the LMF identified by a new Event ID, e.g. \"Location Measurement Accuracy request\". The LMF based on the Event ID requested provides information on accuracy of a measurement of a location when a location measurement is made by the LMF.\n'The LMF provides measurements reports to the NWDAF as follows:\n-\tThe LMF provides measurements report for any location request received by the LMF by a location client (the request is received via the GMLC).\n-\tIf the request includes a requested LCS QoS class or horizontal/vertical accuracy the LMF provides a measurements report when the LMF receives a location request from a location client with the requested accuracy.\n-\tIf the request includes a positioning method, the LMF provides measurements report when the LMF determines the location using the position method used.\n-\tIf the request includes an LOS/NLOS ratio the LMF triggers the UEs to report whether a measurement was made according to LOS or NLOS measurements.\nThe procedure is shown below:\nThe figure depicts a procedure to derive analytics for location accuracy sustainability, with a focus on Option 1. It illustrates the steps involved in analyzing location accuracy, including data collection, data analysis, and decision-making. The figure is a visual representation of the process, making it easy to understand and follow.\nFigure 6.12.2-1: Procedure to derive analytics for location accuracy sustainability(Option 1)\n1.\tA Consumer requests analytics for location accuracy sustainability from the NWDAF. The request may include a target area, a time of day, a target UE (or group of UEs or any UE). The request may also include, to report analytics for a specific LCS QoS requirement or horizontal/vertical accuracy.\n2.\tThe NWDAF finds the LMF serving the UE target area (Option 1) by querying the NRF.\n3.\tThe NWDAF sends a request to the LMF to provide location measurement accuracy data (the request may be a subscription or a one-time request). The NWDAF includes in the request to the LMF information to satisfy the requirements of the consumer in step 1.\n4a-4c.\tThe LMF is triggered to provide a location from a location client as per procedure in TS 23.273 [5]. The LMF derives the location of the UE.\n5.\tThe LMF determines that the location measured is in an area where the NWDAF has subscribed to report location measurements. The LMF reports the location accuracy to the NWDAF.\n6.\tThe data are provided to the NWDAF.\n7.\tThe NWDAF derives analytics for location accuracy.\n8.\tThe NWDAF provides analytics to the consumer.\nData collection for Option 2:\nThe NWDAF subscribes from GMLC to obtain location data for a UE or any UE. The NWDAF discovers GMLC from NRF and invokes (via a new SBI) to retrieve data about the location measurement accuracy (optionally per positioning method).\nThe GMLC provides measurements report to the NWDAF as follows:\n-\tIf the request target any UE the GMLC provides measurements report for any location request received by a location client\n-\tIf the request target a specific UE, the GMLC provides measurements report when the GMLC receives a location request from a location client that targets the specific UE.\n-\tIf the request includes a requested LCS QoS class or horizontal/vertical accuracy the GMLC provides measurements report when the GMLC receives a location request from a location client with the requested accuracy\n-\tIf the request includes a positioning method, the GMLC provides measurements report when the GMLC receives information (from the AMF) on the positioning method used by the LMF to determine the location of the UE.\nThe procedure is shown below:\nThe figure depicts a procedure to derive analytics for location accuracy sustainability, specifically focusing on Option 2. It illustrates the steps involved in analyzing location accuracy sustainability, including data collection, data analysis, and decision-making processes. The figure is a visual representation of the methodology, providing a clear and concise overview of the process.\nFigure 6.12.2-2: Procedure to derive analytics for location accuracy sustainability (Option 2)\n1.\tA Consumer requests analytics for location accuracy sustainability from the NWDAF. The request may include a target area, a time of day, a target UE (or group of UEs or any UE). The request may also include, to report analytics for a specific LCS QoS requirement or horizontal/vertical accuracy.\n2.\tThe NWDAF finds the GMLC from the NRF\n3.\tThe NWDAF sends a request to the GMLC to provide location measurement accuracy data (the request may be a subscription or a one-time request). The NWDAF includes in the request to the GMLC information to satisfy the requirements of the consumer in step 1.\n4a-4b.\tThe GMLC is triggered to provide a location from a location client as per procedure in TS 23.273 [5]. The GMLC invokes a location request to the AMF/LMF according to TS 23.273 [5]. The GMLC receives location information from the AMF/LMF including information indicating if the location accuracy requested has been met and the positioning method used.\n5.\tThe GMLC determines to report the location information to the NWDAF.\n6.\tThe data are provided to the NWDAF\n7.\tThe NWDAF derives analytics for location accuracy .\n8.\tThe NWDAF provides analytics to the consumer.\nThe following input data are required by the NWDAF to measure location measure accuracy.\nTable 6.12.2-1: Location measurement accuracy data collected by NWDAF\n\nThe analytics output to the consumer may include one of the following:\nTable 6.12.2-2: \"Location Accuracy Sustainability\" statistics\n\nTable 6.12.2-3: \"Location Accuracy Sustainability\" predictions\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.12.2-1: Location measurement accuracy data collected by NWDAF",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.12.2-2: \"Location Accuracy Sustainability\" statistics",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.12.2-3: \"Location Accuracy Sustainability\" predictions",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.12.3\tImpacts on services, entities and interfaces",
                            "text_content": "-\tApplicable to Option 1: New Nlmf event notification service to allow the NWDAF to retrieve location measurement reports from the LMF.\n-\tApplicable to Option 2: NWDAF support Ngmlc service based interfaces to retrieve location information for a UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.13\tSolution #13: Architecture enhancement for the interaction between LCS and NWDAF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.13.1\tIntroduction",
                            "text_content": "The solution is intended to address and resolve Key Issue 4: Interaction between Location Service and NWDAF.\nHere are three schemes that can be a potential basis to support the finer granularity location information interaction between LCS and NWDAF, i.e. AMF interacts with NWDAF, GMLC interacts with NWDAF, and LMF interacts with NWDAF. This solution aims to enhance the interfaces between AMF and NWDAF with the consideration of the reduction of the time latency and the signalling flows.\nThe interaction between AMF and NWDAF is enhanced to support the delivery of the finer granularity location information, including the finer geographical location, velocity, accuracy, and other necessary information. When the location information request is received in AMF from NWDAF, the AMF has a responsibility to distinct the requested granularity to determine whether it is necessary to initiate a request to LMF. If the granularity is TA/cell level, the AMF returns the TA/cell level location to the NWDAF as specified in TS 23.288 [9]. If the granularity is finer than the TA/cell level and other requirements are received in the requested message, the AMF initiates a location request to LMF.\nTo solve the aforementioned issue, this solution proposes a scheme to support location information delivery between LCS architecture and NWDAF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.2\tArchitecture",
                            "text_content": "The figure depicts the interaction between the Local Communication System (LCS) and the Network Wide Area Network (NWDAF) architecture, highlighting the key components and their roles in the communication network.\nFigure 6.13.2-1: Interaction between LCS and NWDAF architecture\nFigure 6.13.2-1 is similar to Figure 4.2.1-1 in TS 23.273 [5] and additionally supports the enhancement of the service-based interface between AMF and NWDAF.\n'Enhanced Service Based Interfaces proposed in this solution comprise:\nNnwdaf:\tService-based interface exhibited by NWDAF.\nNamf:\tService-based interface exhibited by AMF.\nIn addition, this solution utilizes the existing service operations defined in TS 23.502 [3] and TS 23.273 [5] for the Nlmf and Nudm service based interfaces.\nAs for privacy check for location service, this solution supports performing privacy check on the NWDAF side in some scenarios with the signalling reduction purpose. The NWDAF sends location requests for the SUPI with an indication to exempt the privacy check in LCS only when the user consent and the privacy check of this SUPI are all passed on the NWDAF side. The LCS architecture skips the privacy check accordingly. Otherwise, the NWDAF will not initiate the location request for the SUPI.\nNOTE:\tPerforming the privacy check on the NWDAF side needs coordination work with eNA_Ph3.\nIn detail, if the result of the privacy check for call/session unrelated class is \"Location allowed without notification\" then the NWDAF acquires the UE location as normal without notifying the UE. If the indicator of privacy check indicates the UE must either be notified or notified with privacy verification, then the NWDAF request to the AMF with an indication of a privacy related action and the AMF sends a notification invoke message to the target UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.3\tProcedures",
                            "text_content": "Figure 6.13.3.1-1 illustrates the one-time data collection from NWDAF to LCS architecture. In this scenario, it is assumed that the target UE(s) is identified using a SUPI or GPSI. This procedure is applicable to a request from NWDAF for immediately location collection.\nThe figure depicts a network architecture with various components, including a base station (gNB), user equipment (UE), and a network location information (NWDAF) system. The AMF (Access Point Location Information) component provides UE location information to the NWDAF system, which is responsible for one-time collection of location data.\nFigure 6.13.3.1-1: AMF provides UE location information to NWDAF (One-time Collection)\n1.\tThe NWDAF invokes a Nudm_UECM_Get service operation towards the home UDM of the target UE to be located with the GPSI or SUPI of the UE. If the NWDAF needs to have a trajectory or the location of the target UE and the user consent has been checked to allow the NWDAF to collect and use the location information, then the NWDAF process this procedure.\n2.\tThe UDM returns the address of the current serving AMF for the target UE.\n3.\tThe NWDAF invokes the location information request towards the AMF to request the location of the UE. The service operation includes the SUPI, the required location granularity, and may include the collection type, an indication of velocity information and the required QoS, which includes accuracy, latency, and QoS class.\n4.\tThe AMF determines whether the required location granularity can be provided by AMF itself. If the finer granularity location is required, the AMF selects an LMF based on NRF query or configuration in AMF.\n5.\tThe AMF invokes the Nlmf_Location_DetermineLocation service operation towards the LMF to request the location information of the UE. The service operation includes an LCS Correlation identifier, the access type and may include the required QoS, which includes accuracy, latency, and QoS class.\n6.\tThe LMF initiates the positioning procedure toward UE.\n7.\tThe LMF returns the Nlmf_Location_DetermineLocation Response towards the AMF to return the location information of the UE. The service operation includes the location estimate and may include velocity estimate, the age of location information, the timestamp, achieved QoS, which includes accuracy, latency and QoS class.\n8.\tThe AMF returns the Namf_Location_ProvideLocation Response towards the NWDAF to return the location information of the UE.\nFigure 6.13.3.2-1 illustrates the continuous data collection from NWDAF to LCS architecture using event reporting. In this architecture, it is assumed that the target UE(s) is identified using a SUPI or GPSI. This procedure is applicable for the request from NWDAF for the deferred location reporting.\nThe figure depicts a network architecture with a focus on location information provided by the Advanced Mobile Location Service (AMLS) to the National Wide Area Network (NWDAF). The AMLS is a location-based service that provides real-time location information to mobile devices, enabling them to navigate and access services more efficiently. The figure shows the flow of information between the AMLS and NWDAF, with the AMLS providing location data to the NWDAF, which then uses this information to provide location-based services to the users. This system is designed to improve the user experience and enable more efficient use of mobile devices in various applications.\nFigure 6.13.3.2-1: AMF provides UE location information to NWDAF (Continuous Collection)\n1.\tThe NWDAF invokes a Nudm_UECM_Get service operation towards the home UDM of the target UE to be located with the GPSI or SUPI of the UE. If the NWDAF needs to collect the trajectory or the location of the target UE and the user consent has been checked to allow the NWDAF to collect and use the location information, then the NWDAF process this procedure.\n2.\tThe UDM returns the address of the current serving AMF of the target UE.\n3.\tThe NWDAF invokes the location information request towards the AMF to request the location of the UE. The service operation includes the SUPI, the required location granularity and may include the collection type, the event type, an indication of velocity information and the required QoS, which includes accuracy, latency, and QoS class.\nThe NWDAF includes trigger or periodic event types in the location information request message. The AMF delivers event types to LMF and then LMF sends to the UE are specified as the current deferred MT-LR procedure.\n4.\tThe AMF determines whether the required location granularity can be provided by AMF itself. If the finer granularity location is required the AMF selects an LMF based on NRF query or configuration in AMF.\n5.\tThe AMF invokes the Nlmf_Location_DetermineLocation service operation towards the LMF to request the location information of the UE. The service operation includes an LCS Correlation identifier, the access type and may include the event type, the required QoS, which includes accuracy, latency, and QoS class.\n6.\tThe LMF initiates the positioning procedure towards UE.\n7-8.\tThe AMF includes in the notification to the UE the type of deferred location request in the case of periodic or triggered location. The UE returns a result to the LMF.\n9-10.\tThe LMF may report the current location information, including the age of location information, the timestamp, event type, location estimate, velocity estimate, achieved QoS accuracy and QoS class, to the AMF and then to the NWDAF according to the periodic location reporting rule.\n11.\tThe UE monitors for the occurrence of the trigger or periodic event requested in step 7. When a trigger or periodic event is detected, the UE needs to connect to LMF and report its location information.\n12-13.\tThe UE sends an event reporting to the LMF. This event report may include the event type, location estimate, velocity estimate.\n14.\tOne or more UE positioning may be needed in this scenario.\n15-16.\tThe LMF reports the current location information, which may include the age of location information, the timestamp, event type, location estimate, velocity estimate, achieved QoS accuracy and QoS class.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.4\tImpacts on existing entities and interfaces",
                            "text_content": "-\tProvides to NWDAF with finer granularity location data than TA/cell level and other information, e.g. location estimate, velocity estimate, timestamp, achieved QoS information.\n-\tEnhanced interface with AMF to request finer granularity location data than TA/cell level.\n-\tEnable NWDAF to perform user consent and privacy check when requiring the finer granularity location data than TA/cell level.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.14\tSolution #14: Unawareness positioning",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.14.1\tIntroduction",
                            "text_content": "This solution addresses KI#6: UE Positioning without UE/User Awareness.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.14.2\tFunctional Description",
                            "text_content": "The principles of the solution are as follows:\n-\tUE unaware positioning:\n-\tIf the UE is in CM_IDLE or RRC_INACTIVE state, the UE cannot be paged during the positioning procedure. In this case, the 5GC provides the latest stored UE location information to the LCS Client/AF if the requested accuracy is achieved.\n-\tIf the UE is in CM_CONNECTED state, the LMF selects uplink positioning method (e.g. Uplink E-CID, Uplink NR-E-CID, UL-TDOA, UL-AoA) which requires the NG-RAN configures the UE to report the measurement information, e.g. E-UTRA RSRP, E-UTRA RSRQ measurements in UL E-CID. From UE point of view, it has no idea that the measurement is related to positioning, so UE unawareness can be achieved. Furthermore, the privacy check which requires interaction with UE is also skipped.\n-\tThe UE unaware positioning can be applied to the 5GC-MT-LR and NI-LR procedures.\n-\tUser unaware positioning:\n-\tIf the UE is in CM_IDLE or RRC_INACTIVE state, the UE can be paged during the positioning procedure.\n-\tThe User unaware positioning can be applied to any existing positioning procedure with the exception that the privacy check which requires interaction with user is skipped.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.14.3\tProcedures",
                            "text_content": "To support UE unaware positioning, enhancements to the existing 5GC-MT-LR procedure and NI-LR procedure are described in this clause.\nEnhancements to 5GC-MT-LR procedure for the regulatory location service in clause 6.1.1 of TS 23.273 [5] are as follows:\n-\tStep 1: the LCS Service Request includes the UE unaware indication.\n-\tStep 4: the Namf_Location_ProvidePositioningInfo Request includes the UE unaware indication.\n-\tIf the UE is in CM_IDLE or RRC_INACTIVE state (if known by AMF by requesting the NG-RAN to report RRC state information), the enhancements to steps 5-11 are as follows:\n-\tSteps 5-9 are skipped.\n-\tStep 10: the AMF rejects the location request with appropriate rejection cause or returns the Namf_Location_ProvidePositioningInfo Response which includes the latest UE location information.\n-\tStep 11: the GMLC rejects the LCS Service Request if there is no UE location can fulfil the QoS. Otherwise, the GMLC returns the LCS Service Response with latest UE location.\n-\tIf the UE is in CM_CONNECTED state, the enhancements to steps 5-11 are as follows:\n-\tStep 7: the Nlmf_Location_DetermineLocation Request includes the UE unaware indication. The LMF selects positioning method based on the UE unaware indication.\n-\tIf the UE is in RRC_INAVTIVE state (from AMF point of view, UE is CM-CONNECTED), the enhancements to steps 5-11 are as follows:\n-\tStep 7: the Nlmf_Location_DetermineLocation Request includes the UE unaware indication. The LMF selects positioning method based on the UE unaware indication.\n-\tStep 8: The LMF sends NRPPa message including UE unaware indication to RAN. Because UE cannot be paged, RAN rejects the NRPPa message.\n-\tStep 9: The LMF rejects the Nlmf_Location_DetermineLocation Reject with appropriate rejection cause.\n-\tStep 10: the AMF rejects the location request with appropriate rejection cause or returns the Namf_Location_ProvidePositioningInfo Response which includes the latest UE location information.\n-\tStep 11: the GMLC rejects the LCS Service Request if there is no UE location can fulfil the QoS. Otherwise, the GMLC returns the LCS Service Response with latest UE location.\nEnhancements to 5GC-MT-LR procedure for the commercial location service in clause 6.1.2 of TS 23.273 [5] are as follows:\n-\tSteps 1a, 1b-1, 1b-2, 4, 5: the corresponding message includes the UE unaware indication.\n-\tIf the UE is in CM_IDLE or RRC_INACTIVE state(if known by AMF by requesting the NG-RAN to report RRC state information), the enhancements to steps 6-24 are as follows:\n-\tSteps 5-21 are skipped.\n-\tStep 22: the AMF rejects the location request with appropriate rejection cause or returns the Namf_Location_ProvidePositioningInfo Response which includes the latest UE location information.\n-\tStep 23-24: the GMLC rejects the LCS Service Request if there is no UE location can fulfil the QoS. Otherwise, the latest UE location is returned to LCS Client or AF.\n-\tIf the UE is in CM_CONNECTED state, the enhancements to steps 6-24 are as follows:\n-\tSteps 7-9 are skipped.\n-\tStep 11: the Nlmf_Location_DetermineLocation Request includes the UE unaware indication. The LMF selects positioning method based on the UE unaware indication.\n-\tSteps 20-21 are skipped.\n-\tIf the UE is in RRC_INAVTIVE state (from AMF point of view, UE is CM-CONNECTED), the enhancements to steps 6-24 are as follows:\n-\tStep 11: the Nlmf_Location_DetermineLocation Request includes the UE unaware indication. The LMF selects positioning method based on the UE unaware indication.\n-\tStep 12: The LMF sends NRPPa message including UE unaware indication to RAN. Because UE cannot be paged, RAN rejects the NRPPa message.\n-\tStep 13: The LMF rejects the Nlmf_Location_DetermineLocation Reject with appropriate rejection cause.\n-\tStep 14: the AMF rejects the location request with appropriate rejection cause or returns the Namf_Location_ProvidePositioningInfo Response which includes the latest UE location information.\n-\tStep 16-23 are skipped.\n-\tStep 24: the GMLC rejects the LCS Service Request if there is no UE location can fulfill the QoS. Otherwise, the GMLC returns the LCS Service Response with latest UE location.\nEnhancements to 5GC-NI-LR procedure in clause 6.10.1 of TS 23.273 [5] are as follows:\n-\tStep 1: the AMF decides that the positioning is UE unaware based on configuration.\n-\tStep 2: the Nlmf_Location_DetermineLocation Request includes the UE unaware indication. The LMF selects positioning method based on the UE unaware indication.\nTo support user unaware positioning, enhancements to the existing procedures are described in this clause.\nEnhancements to 5GC-MT-LR procedure for the commercial location service in clause 6.1.2 of TS 23.273 [5] are as follows:\n-\tSteps 1a, 1b-1, 1b-2, 4, 5: the corresponding message includes the user unaware indication.\n-\tSteps 7-9, 20-21 are skipped.\nEnhancements to Deferred 5GC-MT-LR procedure for Periodic, Triggered and UE Available Location Events in clause 6.3 of TS 23.273 [5] are as follows:\n-\tSteps 1a, 1b-1, 1b-2, 4, 5: the corresponding message includes the user unaware indication.\n-\tSteps 11-12 are skipped.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.14.4\tImpacts on services, entities, and interfaces",
                            "text_content": "GMLC:\n-\tTo support UE unaware positioning: receive UE unaware positioning indication from LCS Client and send the indication to AMF.\n-\tTo support user unaware positioning: receive user unaware positioning indication from LCS Client and send the indication to AMF.\nAMF:\n-\tTo support UE unaware positioning:\n-\tIf UE is in CM_IDLE or RRC_INACTIVE state (if known by AMF), the AMF does not page UE. The AMF rejects the request or returns the latest UE location to GMLC.\n-\tIf UE is in CM_CONNECTED state, the AMF sends the UE unaware indication to LMF.\n-\tTo support user unaware positioning: the AMF does not send the NAS Location Notification Invoke Request to UE.\nLMF:\n-\tTo support UE unaware positioning:\n-\tReceives the UE unaware indication from AMF and selects positioning method based on the indication.\n-\tSends the UE unaware indication included in the NRPPa message to NG-RAN.NG-RAN:\n-\tTo support UE unaware positioning: receives the UE unaware indication from LMF and rejects the NRPPa request if UE is in RRC_INACTIVE state.\nLCS Client/AF:\n-\tTo support UE unaware positioning: send UE unaware positioning indication to GMLC.\n-\tTo support user unaware positioning: send user unaware positioning indication to GMLC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.15\tSolution #15: PRU assisted LCS architecture and procedure",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.15.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #7, especially on the enable of the PRU management in 5GC and utilize the PRU to enhance the LCS procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.15.2\tFunctional Description",
                            "text_content": "The procedures in clause 6.15.3.1 is used for 5GC to obtain the available PRU(s) information. The procedures in clauses 6.15.3.2 and 6.15.3.3 are used for the 5GC to choose the candidate PRU(s) and to use the candidate PRU(s) to enhance the location service procedure.\nThe PRU information consists the following aspects:\n-\tCapability: indicate the capability a PRU supports positioning signal transmission capability and positioning measurement capability on Uu and PC5, based on that information, PRUs could be selected as candidate PRUs to assist the positioning of other UE.\nNOTE 1:\tThe positioning signal transmission capability and signal measurement capability on PC5 relates to the study in RAN WG.\n-\tLocation information, e.g. whether absolute location coordinates are available and to which degree of accuracy. This is required if a PRU to be utilized for timing calibration or to be utilized to complete the insufficient LoS path. The location information may include other parameters, such as velocity information, time stamps or duration of valid location information etc.\n-\tMobility state, whether a PRU is fixed or mobile.\n-\tState indication, e.g. ON/OFF: this indicates whether a PRU is enabled to assist positioning of the other UEs.\nPRU information could be obtained by 5GC via three different ways:\ni.\tRegistration to AMF:\nA UE can be registered as a PRU. When a PRU registers to the network, the PRU information may be included in the UE context data and obtained by the AMF. After receive the PRU registration, the AMF sends message to NRF to indicate PRU existence in certain area (e.g. the TAI of the PRU location).\nii.\tRegistration to LMF:\nA UE can be configure as a PRU by a NF, e.g. LMF. LMF obtains PRU information via AMF. This information may be provided by the UE via LPP procedure. After receive the PRU registration, LMF sends message to NRF to indicate PRU existence in certain area (e.g. the TAI of the PRU location).\niii.\tSubscription to UDM:\nA UE may be pre-configured as a PRU. Then, the PRU information may be included in the UE subscription data as a new parameter set and stored in UDM/UDR.\nTo save power, the PRU may not always be activated. 5GC may activate or deactivate the PRU(s) based on the location service requirements. This can be enabled by updating the state indication in the PRU information. For instance, LMF may determine to de/activate PRUs via AMF.\nTo fully utilize the PRU(s) in the same camping cell of target UE, target UE AMF can send the PRU wake up indication to the target UE NG-RAN, then target UE NG-RAN broadcast this information in target UE camping cell, then all candidate PRU(s) could listen this information and go back to connected state.\nNOTE 1:\tRAN WG coordination is needed.\nNOTE 2:\tThis clause does not support the function to fully utilize the PRUs in the neighbour cells of target UE and in CM-IDLE/RRC-inactive state.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.15.3\tProcedures",
                            "text_content": "It is assumed to reuse the existing architecture defined in Rel-17 LCS work (see TS 23.273 [5]).\nThe figure depicts a simplified architecture of a 5G network, illustrating the various components and their interactions. It includes a base station (gNB), user equipment (UE), and scatterers, highlighting the importance of beamforming techniques to mitigate interference. The figure also shows the use of redundancy paths to ensure failover reliability.\nFigure 6.15.3.1-0: Architecture Assumption\nThe PRU management procedure is used by 5GC to obtain the PRU information and to become aware which PRU(s)) are available in the network.\nTo manage PRU, three options could be considered:\n-\tOption A: PRU registration to AMF.\n-\tOption B.1: PRU registration to LMF.\n-\tOption B.2: LMF obtains available PRU information via LPP procedures.\n-\tOption C: PRU information are pre-configured in the UDM.\nThe figure depicts a 15-node PRU management system, illustrating the various components and their interconnections. The system includes a central processor, a set of PRUs, and a network interface controller (NIC). The PRUs are responsible for processing and forwarding data, while the NIC manages the network interface and ensures data transmission. The figure also highlights the importance of network management and the role of the central processor in maintaining the system's stability and performance.\nFigure 6.15.3.1-1: PRU Management\nOption A: PRU registration to AMF\n1a~2a.\tPRU initiate the registration procedure to the AMF, including the PRU capability as well as the User Location Information (i.e. CGI and TAI). The PRU may also include the mobility state (e.g. mobile or static) in its registration, so AMF can maintain all the available PRU with related information dynamically.\n3a.\tAfter receive the PRU information, the AMF invokes the Nnrf_NFManagement_NFUpdate Request (PRU location, PRU existence indication) to NRF to indicate the PRU existence in certain areas (e.g. in one or multiple TAI(s)).\nOption B.1: PRU registration to LMF\n1b~2b.\tThe UE provides an indication to the serving AMF whether it can function as a PRU. The serving AMF then registers the PRU to an LMF.\n3b.\tAfter receive the PRU information, the LMF invokes the Nnrf_NFManagement_NFUpdate Request (PRU location, PRU existence indication) to NRF to indicate the PRU existence in certain areas (e.g. in one or multiple TAI(s)).\nOption B.2: PRU registration to LMF\n1b.\tLMF obtains available PRU information via LPP procedures.\n2b.\tThis step is same as step 3b in OptionB.1.\nOption C: PRUs information are maintained at the UDM.\nA UE may be pre-configured as a PRU with the PRU information included in the UE subscription data as a new parameter set and stored in UDM.\nPRU activation/deactivation procedure is used by 5GC to enable/disable the candidate PRU(s) for assisting location service.\nThe figure depicts a PRU (Physical Resource Unit) activated or deactivated status, indicating the status of a specific physical resource unit in a network. The figure shows a graphical representation of the PRU, with a green background indicating that it is activated and a red background indicating that it is deactivated. The status is represented by a status bar at the bottom of the figure, with a green checkmark indicating that the PRU is active and a red checkmark indicating that the PRU is deactivated. The figure is used to monitor the status of PRUs in a network and to ensure that they are functioning properly.\nFigure 6.15.3.2-1: PRU activated or deactivated\n1.\tActivation/deactivation of PRU(s) is triggered by LMF, such as based on LCS requirements, e.g. LCS QoS of target UEs cannot be met, or based on the location service procedure in clause 6.15.3.3.\n2.\tLMF invokes the PRU activation request towards the PRU AMF. The operation request may include target UE location, PRU(s) information and triggering conditions.\n3.\tAMF invokes a Nudm_SDM_Get service operation towards the UDM to obtain the privacy settings of the PRU(s). The UDM returns the PRU(s) privacy setting. AMF checks the PRU(s) Privacy profile.\n4.\tAMF performs privacy check if the privacy profile indicates that the PRU(s) must be either notifies or verified.\n5.\tAMF invokes the context management update operation request to UDM to update the PRU state information.\n6.\tAMF receives the response from UDM.\n7.\tThe AMF activates the candidate PRU.\n8.\tAMF returns PRU activation response towards LMF.\nThis clause describes the location service procedure with the assistance of PRU. Clauses 6.15.3.3.1 and 6.15.3.3.2 are based on the prerequisite that PRU(s) are managed by AMF, i.e. the AMF-centric. Clauses 6.15.3.3.3 and 6.15.3.3.4 are based on the prerequisite that PRU(s) are managed by LMF, i.e. the LMF-centric.\nThe AMF-centric MT-LR requests PRU AMF to provide one or multiple candidates PRU(s) in the vicinity of target UE, e.g. the same cell or the neighbour cell, to improve positioning accuracy.\n6.15.3.3.1.1\tMT-LR procedure based on Option A in clause 6.15.3.1\nThe figure depicts a 15-step procedure for the MT-LR (Maximum Throughput Least-Resource) procedure, which is a method used in the context of a 5G network. The figure illustrates the steps involved in the procedure, including the use of a PRU (Passive Radio Unit) and AMF (Active Medium Filtering) techniques. The figure also includes a legend to help understand the different components and their functions.\nFigure 6.15.3.3-1: MT-LR procedure using PRU (AMF-centric)\nThe following additions apply to step 1~4 compared to steps 1-5 defined in clause 6.1.1 of TS 23.273 [5].\n3b.\tAfter target UE AMF receive step 3a, if the target UE support positioning by PRU, e.g. based on the target UE subscription information or the information in target UE context, or based on the target UE positioning capability, e.g. whether target UE support NR positioning, the AMF send an indication to NG-RAN to trigger NG-RAN broadcast the PRU wake up information in target UE camping cell, e.g. the per PLMN indication in posSIB. For those PRU(s) in CM-IDLE/RRC-inactive state, after receive this information, those PRU(s) trigger the service request/RRC-resume to go back to CM-CONNECTED as described in clause 4.2.3.2 of TS 23.502 [3] or clause 9.2.2.4 of TS 38.300 [22].\n5.\tThe LMF invokes the Nnrf_NFDiscovery_Request Request towards NRF to request the PRU AMF. The service operation includes the target UE location information (e.g. the TAI of target UE), the indication to find the PRU AMF which could serve in the area around the target UE.\n6.\tBased on the PRU AMF discovery indication and the target UE location information, the NRF return one or multiple PRU AMF(s) via Nnrf_NFDiscovery_Request Response.\n7.\tLMF sends the PRU discovery request to PRU AMF to request the candidate PRU. The message includes the target UE location information and the target UE vicinal location (e.g. the neighbour cell of target UE).\n8.\tBased on the message in step 7, the PRU AMF choose one or multiple candidate PRU(s) based on the target UE location, the target UE vicinal location, and the mobile state of PRU. The PRU AMF invokes PRU discovery response to LMF, includes one or multiple candidate PRU(s).\n9.\tThe LMF performs the activation procedure as defined in clause 6.15.3.2 to activate the desired PRU(s). LMF also performs one or more of the positioning procedures towards PRU as described in clauses 6.11.1, 6.11.2 and 6.11.3 of TS 23.273 [5].\n10.\tThe LMF performs one or more of the positioning procedures towards target UE as described in clauses 6.11.1, 6.11.2 and 6.11.3 of TS 23.273 [5].\n6.15.3.3.1.2\tMT-LR procedure based on Option C in clause 6.15.3.1\nThe figure depicts a 15-step procedure for the MT-LR (Maximum Throughput Least-Resource) procedure, which is a method used in the context of a 5G network. The figure illustrates the steps involved in the procedure, including the use of a PRU (Passive Radio Unit) and AMF (Active Medium Filtering) techniques. The figure also includes a legend to help understand the different components and their functions.\nFigure 6.15.3.3-2: MT-LR procedure using PRU (AMF-centric)\nThe following additions apply to steps 1~3 compared to steps 1~4 defined in clause 6.1.1 of TS 23.273 [5].\n3b.\tAfter target UE AMF receive step 3a, if the target UE support positioning by PRU, e.g. based on the target UE subscription information or the information in target UE context, or based on the target UE positioning capability, e.g. whether target UE support NR positioning, the AMF send an indication to NG-RAN to trigger NG-RAN broadcast the PRU wake up information in target UE camping cell, e.g. the per PLMN indication in posSIB. For those PRU(s) in CM-IDLE/RRC-inactive state, after receive this information, those PRU(s) trigger the service request/RRC-resume to go back to CM-CONNECTED as described in clause 4.2.3.2 of TS 23.502 [3] or clause 9.2.2.4 of TS 38.300 [22].\n4.\tThe AMF invokes Nudm_SDM_Get request to UDM to request PRU information of the UE(s) in the same or vicinal location with the target UE, e.g. within the target UE TAI(s).\n5.\tUDM sends the Nudm_SDM_Get response to AMF, includes PRU information in the subscription information of the UE(s) in the same or vicinal location with the target UE. The AMF choose one or multiple candidate PRU(s) from those UE(s) in step 5, such as, based on the target UE location, PRU capability, location information and mobility state.\n6.\tThe target UE AMF invokes Nlmf_Location_DetermineLocation Request towards LMF, includes one or multiple candidate PRU information.\n7.\tThe LMF performs the activation procedure as defined in clause 6.15.3.2 to activate the desired PRU(s). LMF also performs one or more of the positioning procedures towards PRU(s) as described in clauses 6.11.1, 6.11.2 and 6.11.3 of TS 23.273 [5].\n8.\tThe LMF performs one or more of the positioning procedures towards target UE as described in clauses 6.11.1, 6.11.2 and 6.11.3 of TS 23.273 [5].\nThe AMF-centric MO-LR requests PRU AMF to provide one or multiple candidates PRU(s) in the vicinity of target UE to improve positioning accuracy.\n6.15.3.3.2.1\tMO-LR procedure based on Option A in clause 6.15.3.1\nThe figure depicts a MO-LR procedure using PRU/AMF-centric, illustrating the steps involved in the MO-LR process. The figure includes a flow chart, which outlines the steps from start to finish, and a legend to clarify the different components and their functions. The figure is a visual representation of the MO-LR procedure, providing a clear and concise understanding of the process.\nFigure 6.15.3.3-3: MO-LR procedure using PRU/ (AMF-centric)\nSteps 1~4 are same as steps 1~4 defined in clause 6.2 of TS 23.273 [5].\nSteps 5~10 are same as steps 5~10 in clause 6.15.3.3.1.1.\n6.15.3.3.2.2\tMO-LR procedure based on Option C in clause 6.15.3.1\nThe figure depicts a MO-LR procedure using PRU (AMF-centric) in a 15 GHz frequency band. The MO-LR procedure is a method for frequency reuse in the 15 GHz band, which is a key component of the 5G network. The figure shows the steps involved in the procedure, including the use of PRU (Power-Efficient Radio Unit) and AMF (Adaptive Frequency-Division Multiplexing) techniques. The figure also includes a visual representation of the frequency reuse process, which is an essential aspect of the 5G network's design.\nFigure 6.15.3.3-4: MO-LR procedure using PRU (AMF-centric)\nSteps 1~2 are same as the steps 1~2 defined in clause 6.2 of TS 23.273 [5].\nSteps 3~7 are same as steps 4~8 in clause 6.15.3.3.1.2.\nThe LMF-centric MT-LR requests PRU LMF to provide one or multiple candidates PRU(s) in the vicinity of target UE to improve positioning accuracy. This procedure based on option B in clause 6.15.3.1.\nThe figure depicts a 15-step procedure for the MT-LR (Maximum Likelihood Estimation) method, which is a key component in the analysis of optical communication systems. The figure illustrates the steps involved in the procedure, including the use of a PRU (Point-to-Point Relays) and a LMF (Linear Modulation Function) to estimate the channel parameters. The figure is important for understanding the MT-LR method and its application in optical communication systems.\nFigure 6.15.3.3-5: MT-LR procedure using PRU (LMF-centric)\nThe following additions apply to steps 1~4 compared to steps 1~5 defined in clause 6.1.1 of TS 23.273 [5].\n3b.\tAfter AMF receive step 3a, if the target UE support positioning by PRU, e.g. based on the target UE subscription information or the information in target UE context, or based on the target UE positioning capability, e.g. whether target UE support NR positioning, the AMF send an indication to NG-RAN to trigger NG-RAN broadcast the PRU wake up information in target UE camping cell, e.g. the per PLMN indication in posSIB. For those PRU(s) in CM-IDLE/RRC-inactive state, after receive this information, those PRU(s) trigger the service request/RRC-resume to go back to CM-CONNECTED as described in clause 4.2.3.2 of TS 23.502 [3] or clause 9.2.2.4 of TS 38.300 [22].\n5.\tThe LMF invokes the Nnrf_NFDiscovery_Request Request towards NRF to request the PRU LMF. The service operation includes the target UE location information (e.g. the TAI(s) of target UE), the indication to find the PRU LMF which could serve the target UE positioning.\n6.\tBased on the PRU LMF discovery indication and the target UE location information, the NRF return one or multiple PRU UE LMF(s) via Nnrf_NFDiscovery_Request Response.\n7.\tLMF sends PRU discovery request to PRU LMF to request the PRU information. The message includes the target UE location information and the target UE vicinal location (e.g. the neighbour cell of target UE).\n8.\tThe PRU LMF choose one or multiple candidate PRU(s) based on the target UE location, PRU capability, location information and mobility state. The PRU LMF invokes PRU discovery response to LMF, includes one or multiple candidate PRU(s).\n9.\tThe LMF performs the activation procedure as defined in clause 6.15.3.2 to activate the desired PRU(s). LMF also performs one or more of the positioning procedures towards PRU(s) as described in clauses 6.11.1, 6.11.2 and 6.11.3 of TS 23.273 [5].\n10.\tThe LMF performs one or more of the positioning procedures towards target UE as described in clauses 6.11.1, 6.11.2 and 6.11.3 of TS 23.273 [5].\nThe LMF-centric MO-LR request PRU LMF to provide one or multiple candidates PRU(s) in the vicinity of target UE to improve the positioning accuracy.\nThe figure depicts a MO-LR procedure using PRU (LMF-centric) in a 15 GHz frequency band. The procedure involves the use of a PRU (Power-on-Line) to enhance the signal quality and reduce interference. The figure illustrates the step-by-step process, including the selection of the PRU, the selection of the modulation scheme, and the selection of the modulation format. The figure also includes a visual representation of the PRU's performance in terms of signal strength and interference.\nFigure 6.15.3.3-6: MO-LR procedure using PRU (LMF-centric)\nSteps 1~4 are same as the steps 1~4 defined in clause 6.2 of TS 23.273 [5].\nSteps 5~10 are same as in clause 6.15.3.3.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.15.4\tImpacts on services, entities, and interfaces",
                            "text_content": "UE:\n-\tSupport operate as PRU and send PRU information to 5GC.\nAMF:\n-\tstore PRU information in the UE context.\n-\twhen receive the PRU registration, sends message to NRF to indicate PRU existence in certain area.\n-\taware of the PRU information if there are UE(s) can be operated as PRU(s).\n-\tchoose one or multiple candidate PRU(s) and response to LMF.\n-\tAfter target UE positioning is triggered, the target UE AMF send an PRU wake up indication to NG-RAN to trigger NG-RAN broadcast this information in target UE camping cell.\nLMF:\n-\tstore PRU information.\n-\twhen receive the PRU registration, send message to NRF to indicate PRU existence in certain area.\n-\taware of the PRU information if there are UE(s) can be operated as PRU(s).\n-\tchoose one or multiple candidate PRU(s).\nNRF:\n-\tSupport NF profile update once receive the PRU existence indication.\n-\tSupport selection of AMF(s)/LMF(s) that have registered with PRU.\nUDM:\n-\tstore PRU(s) information.\nNG-RAN:\n-\tSupport broadcast the PRU wake up information in target UE camping cell.\nUE:\n-\tAfter receive the PRU wake up indication, trigger to perform the service request/RRC resume procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.16\tSolution #16: Support of Positioning Reference Units",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.16.1\tIntroduction",
                            "text_content": "This solution addresses the questions related to Positioning Reference Units (PRU) in KI#7: support of Positioning Reference Units and Reference UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.16.2\tFunctional Description",
                            "text_content": "PRU Capability Verification:\n-\tDuring Registration procedure, the UE includes PRU capability in the Registration Request. The AMF verifies the capability based on the subscription data received from UDM.\nPRU Information Storage:\n-\tThe PRU information is stored in the LMF: after successful Registration procedure of PRU, the AMF initiates the 5GC-NI-LR procedure (only steps 2 - 4 of the procedure are performed) to store PRU information in the LMF.\n-\tThe PRU information is stored in the NRF: in order to support that the PRU assists positioning of all UEs, but not the UEs in the service area of the LMF storing the PRU information, the LMF may further store PRU information in the LMF profile in the NRF.\n-\tThe PRU information includes LCS correlation ID, serving cell ID, serving AMF ID, PRU measurements and PRU location.\nPRU Utilization:\n-\tThe LMF decides to use the PRU to assist UE positioning based on the required QoS.\n-\tThe LMF obtain PRU measurements by initiating PRU positioning or request the information from the serving LMF of the PRU. The LMF obtains the serving LMF of the PRU from NRF.\n-\tTo fully utilize the PRU(s) in the same camping cell of target UE, target UE AMF can send the PRU wake up indication to the target UE NG-RAN, then target UE NG-RAN broadcast this information in target UE camping cell, then all candidate PRU(s) could listen this information and go back to connected state.\nEditor's note:\tRAN WG coordination is needed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.16.3\tProcedures",
                            "text_content": "The figure depicts a 16x3x1-1 PRU registration procedure, illustrating the steps involved in registering a PRU (Physical Resource Unit) in a 16x3x1-1 network. The figure includes a flowchart, a list of steps, and a legend to clearly illustrate the process.\nFigure 6.16.3.1-1: PRU Registration procedure\n1.\tPRU sends Registration Request to AMF. The message includes PRU capability.\n2.\tThe AMF invokes a Nudm_SDM_Get service operation towards the UDM to obtain subscription data of the UE to verify whether the subscription data includes the PRU subscription. If not, the AMF rejects the Registration Request.\n3.\tThe AMF returns Registration Accept to PRU.\n4.\tAfter the successful registration of PRU, the AMF invokes a Nlmf_Location_DetermineLocation Request to LMF. The request includes PRU indication and LCS correlation ID.\n5.\tThe LMF triggers UE positioning procedure to obtain measurements and location of PRU. The LMF stores the PRU information locally, e.g. PRU serving cell ID, serving AMF ID, LCS correlation ID, PRU measurements, PRU location.\n6.\tThe LMF invokes a Nlmf_Location_DetermineLocation Response to AMF.\n7.\t[Conditional] If the LMF decides to store PRU information in the NRF, e.g. the serving cell of the PRU is near the boundary of the service area of the LMF, the PRU measurements can also be used by other LMF to assist UE positioning, the LMF invokes a Nnrf_NFManagement_NFUpdate Request to NRF. The service operation includes NF type=LMF, supported PRU information, e.g. PRU serving cell ID, PRU location, LCS correlation ID, serving AMF ID.\n8.\t[Conditional] If step 7 is performed, the NRF returns a Nnrf_NFManagement_NFUpdate Response to LMF.\n\nThe figure depicts a 16x3x2 matrix with 16 rows and 3 columns, representing the utilization and registration procedure of a PRU (Physical Resource Unit) in a 16-port 10G network. The matrix shows the utilization of the PRU, which is a crucial component in 10G networks, and the registration process, which ensures the proper allocation of resources to the PRU. The figure provides a visual representation of the complex network architecture and the importance of PRU utilization and registration in maintaining network performance.\nFigure 6.16.3.2-1: PRU Utilization Registration procedure\n0a.\tThe trigger for target UE positioning happens, e.g. the AMF receives Namf_Location_ProvidePositioningInfo Request service operation from GMLC or receives MO-LR Request from UE.\n0b.\tIf the target UE support positioning by PRU, e.g. based on the target UE subscription information or the information in target UE context, or based on the target UE positioning capability, e.g. whether target UE support NR positioning, the AMF send an indication to NG-RAN to trigger NG-RAN broadcast the PRU wake up information in target UE camping cell, e.g. the per PLMN indication in posSIB. For those PRU(s) in CM-IDLE/RRC-inactive state, after receive this information, those PRU(s) trigger the service request/RRC-resume to go back to CM-CONNECTED as described in clause 4.2.3.2 of TS 23.502 [3] or clause 9.2.2.4 of TS 38.300 [22].\n1.\tThe AMF invokes a Nlmf_Location_DetermineLocation Request to LMF.\n2.\tThe LMF triggers UE positioning procedure to obtain measurements from PRU.\n3.\t[Conditional] If the LMF decides to obtain PRU information from NRF, e.g. the PRU(s) stored in the LMF is not available to assist UE positioning, the LMF invokes a Nnrf_NFDiscovery Request to NRF. The request includes NF type=LMF, cell ID or cell list, PRU indication.\n4.\t[Conditional] The NRF returns a Nnrf_ NFDiscovery Response to LMF. The response includes LMF ID and PRU information.\n5.\t[Conditional] If LMF receives PRU information and the serving LMF of the PRU from NRF, the LMF sends the Nlmf_Location_DetermineLocation Request to the serving LMF of the PRU.\n6.\t[Conditional] If step 5 is performed, the serving LMF of PRU triggers UE positioning procedure to obtain measurements from PRU.\n7.\t[Conditional] If step 6 is performed, the serving LMF of PRU sends the Nlmf_Location_DetermineLocation Response to the serving LMF.\n8.\tThe LMF calculates UE location based on the measurements obtained from PRU in step 4 and step 7 and invokes a Nlmf_Location_DetermineLocation Response to AMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.16.4\tImpacts on services, entities, and interfaces",
                            "text_content": "AMF:\n-\tDuring Registration procedure, receive PRU capability from PRU and verify the capability using the subscription data.\n-\tAfter PRU successful registration, AMF initiates the 5GC-NI-LR procedure (only steps 2 - 4 are performed) to store PRU information in LMF. The AMF includes PRU indication in step 2 of the 5GC-NI-LR procedure.\n-\tAfter target UE positioning is triggered, the target UE AMF send an PRU wake up indication to NG-RAN to trigger NG-RAN broadcast this information in target UE camping cell.\nLMF:\n-\tDuring the 5GC-NI-LR procedure, if PRU indication is received from AMF, the LMF stores PRU information locally or stores PRU information in NRF.\n-\tDecide to use PRU to assist UE positioning based on the required QoS, obtain available PRU based on the locally stored information or from NRF.\n-\tTo obtain PRU measurements to assist UE positioning, initiate positioning procedure for PRU or request PRU measurements from serving LMF of the PRU based on the received information from NRF.\nPRU:\n-\tSend Registration Request including PRU capability to AMF.\nNRF:\n-\tStore information of the PRU which is in the service area of LMF in LMF profile.\n-\tProvides PRU information to LMF.\nNG-RAN:\n-\tSupport broadcast the PRU wake up information in target UE camping cell.\nUE:\n-\tAfter receive the PRU wake up indication, trigger to perform the service request/RRC resume procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.17\tSolution #17: Support for 5GS Localization via Reference UE",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.17.1\tIntroduction",
                            "text_content": "This solution to KI#7 as described in clause 5.7 proposes a mechanism for the 5GS to assist determining the location of a set of UEs via another UE known as reference UE. The solution addresses use cases mentioned in clause 5.7 such as the set of UEs not having LoS path with the RAN node(s), or the opportunity to reduce the signalling involved in providing location services including positioning and tracking to a set of UEs. Multiple reference UEs may also be utilized to assist with the location of the target UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.2\tFunctional Description",
                            "text_content": "At a high level, the functional description of this solution is as follows:\n-\tThe LCS architecture is leveraged to provide location services to a target UE assisted by one or multiple reference UE(s).\nThe solution requires LMF to support location requests via reference UE and processing of the location estimation results.\n-\tA reference UE in this solution could be co-located with a PRU since both entities behave like UEs assisting with the positioning performance of a target UE.\nNOTE:\tIn this solution it is assumed that reference UEs have known location obtained via Uu positioning.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.3\tProcedures",
                            "text_content": "The figure depicts a support system for 5G Localization, which utilizes a reference UE (User Equipment) to provide localization services. The system includes a reference UE, a base station (gNB), and a network simulator. The reference UE is equipped with a GPS receiver and a GNSS receiver, enabling it to provide accurate location information to the gNB. The gNB then uses the reference UE's location data to calculate the position of the UE, which is then used to generate a localization solution. The system is designed to be robust and reliable, with redundancy paths to ensure failover in case of any failure.\nFigure 6.17.3-1: Support for 5GS Localization via Reference UE\n0.\t'The reference and target UEs register to the network. An indication identifying reference UE(s) may be provided to LMF by AMF.\n1.\tThe LCS client request location services for a target UE to the 5GS.\n2.\tAfter receiving the location request from the LCS client, the LMF starts the localization procedures as in a default scenario as shown in clause 6.1.2 of TS 23.273 [5].\n3.\tThe LMF may identify one or a set of references UEs suitable to provide location information and/or assistance location data related to the target UE\n4.\tOptionally, ProSe capabilities (e.g. for ranging or sidelink positioning) may be used by the reference UEs to collect location information or location assistance data from the target UE.\nNOTE 1:\tThe functionality in step 4 is out of scope of this study but details can be found in TR 23.700-86 [17].\n5.\tThe LMF sends location request for a target UE to one or multiple reference UEs using LPP.\nNOTE 2:\tAS level procedures required between NG-RAN and the reference UE are determined by RAN WGs.\n6.\tThe reference UE(s) will initiate the positioning of the target UE. This can include providing target UE related location measurements or assistance data. The target UE will provide the location assistance data (or measurements) to the one or multiple reference UEs.\nNOTE 3:\tThis solution is agnostic as to what type of positioning mechanism is employed between reference UEs and target UE, e.g. Uu based positioning, sidelink positioning, etc.\n7.\tThe reference UE(s) will relay location reporting data back to the LMF via LPP.\n8.\tThe LMF will process the data to combine and/or downselect multiple inputs from multiple Reference UE to generate the best possible estimate of the target UE location.\n9-11.\tLocation information is passed onto the LCS client through the AMF and GMLC. These steps are not changed from the default location responses in clause 6.1.2 of TS 23.273 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.4\tImpacts on services, entities and interfaces",
                            "text_content": "AMF\n-\tTo support registration of reference UEs.\nLMF\n-\tTo support location request  via multiple reference UEs.\n-\tTo support processing of multiple location estimations of same target UE via multiple reference UEs.\nUE\n-\tAs a reference UE to be able to provide location related measurements or any assistance data w.r.t. a target UE to 5GC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.18\tSolution #18: Location Verification for Satellite Access assisted by NWDAF Analytics",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.18.1\tIntroduction",
                            "text_content": "This solution proposes a mechanism for location verification of the UE location provided via satellite access by leveraging NWDAF analytics in the 5GC. The solution addresses KI#9 as it enables the AMF to receive statistics and predictions on the UE location, hence making it easier to determine whether the potentially inaccurate location information provided by the UE is reliable and trustable or not.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.18.2\tFunctional description",
                            "text_content": "At a high level, the functional description of this solution is as follows:\n-\tThe UE provides an initial location to NG-RAN/AMF via satellite access, and the location verification process at the 5GC is triggered.\n-\tThe AMF discovers an NWDAF instance capable of providing UE related analytics on the UE that provided its location via satellite access. If available, the selected NWDAF instance should have analytics aggregation analytics to retrieve UE related analytics from other NWDAF instances.\n-\tIf the selected NWDAF instance has aggregator capabilities, it discovers and collects UE related analytics from other NWDAF instance(s) following the procedures specified in TS 23.288 [9].\n-\tThe NWDAF instance with potential aggregator capabilities aggregates analytics (if collected), derives its own analytics, and delivers them to the AMF.\n-\tThe AMF uses the received analytics as part of its decision on whether the UE location should be accepted or rejected as provided by the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.18.3\tProcedures",
                            "text_content": "The figure depicts a procedure for location verification for satellite access assisted by NWDAF analytics. It illustrates the steps involved in determining the satellite's position using the North Western Data Assimilation Facility (NWDAF) analytics. The figure includes a map with various markers representing different locations, and arrows indicating the direction of the satellite's movement. The figure also includes a legend to explain the symbols used in the map, such as the \"+\" and \"-\" symbols, which represent the satellite's position and the direction of its movement, respectively. The figure is a visual representation of the complex process of satellite location verification, highlighting the importance of NWDAF analytics in ensuring accurate and reliable satellite communication.\nFigure 6.18.2-1: Procedure for location verification for satellite access assisted by NWDAF analytics\n1.\tUE reports location to the NG-RAN via satellite access.\n2.\tNG-RAN selects a suitable AMF based on reported UE location (e.g. AMF A, serving Country A).\n3.\tNG-RAN indicates to the AMF the need to verify/confirm the UE location provided via satellite access.\n4.\tAMF retrieves the subscriber profile of the UE from the UDM.\n5.\tIf not done previously, AMF discovers NWDAF according to clause 5.2 of TS 23.288 [9] and clause 6.3.13 of TS 23.501 [2], if available supporting analytics aggregation as described in clause 6.1A.2 of TS 23.288 [9]. In addition, AMF uses NWDAF Serving Area information, and NWDAF location information to select the appropriate NWDAF instance.\n6.\tAMF requests or subscribes to UE related analytics (e.g. expected UE behaviour, abnormal behaviour, UE mobility) for one or more Analytic IDs in a given Area of Interest from a NWDAF that covers the country where the UE reported its location. When the AMF requests or subscribes to analytics containing UE location information, it may use the Analytics ID \"UE Mobility\" supported in Release 17 with location information granularity of TA or cell. In addition, to increase the accuracy and reliability, the AMF may use other Analytics IDs supported in Release 18 with finer location information granularity than TA or cell.\nNOTE 1:\tThe available granularity of UE location information will be decided when FS_eNA_ph3 reaches conclusions, and which fine granularity Analytics ID can be consumed by AMF for location verification purposes in satellite access depend on such conclusion and will be finalized during normative work.\n7.\t[OPTIONAL] The selected NWDAF instance may register with the UDM for the UE that it is collecting data for and for the related Analytic ID(s).\n8.\t[OPTIONAL] If needed and the selected NWDAF instance has analytics aggregation capability, the NWDAF for which the AMF requested analytics discovers other NWDAF instances that may provide relevant UE related analytics on the UE ID that provided its location in step 1.\n9.\t[OPTIONAL] The aggregator NWDAF requests UE related analytics from other NWDAF(s) on the UE which initially provided its location information to NG-RAN.\n10.\t[OPTIONAL] If needed, other NWDAFs contacted by the aggregator NWDAF may collect data from other NFs (AMFs, SMFs, etc.) related to this UE (e.g. previous locations in other countries, any reported UE abnormal behaviour, etc.).\n11.\t[OPTIONAL] The NWDAF(s) contacted by the aggregator NWDAF derive(s) UE related analytics for the UE in the area it is responsible for, e.g. (part of) a country.\n12.\t[OPTIONAL] The NWDAF(s) contacted by the aggregator NWDAF report(s) their analytics (UE mobility, UE abnormal behaviour, etc.) to the aggregator NWDAF.\n13.\tThe aggregator NWDAF performs aggregation of the reported analytics and derives analytics.\n14.\tThe aggregator NWDAF provides (potentially aggregated) analytics to the AMF.\n15.\tAMF decides whether the UE should or should not be allowed access given the currently reported location.\n16.\tAMF interacts with NG-RAN and/or the UE to convey the decision. For example, based on the reported UE analytics (e.g. UE behaviour, UE location), the AMF and/ or NG-RAN may behave as follows:\na)\tIn case of UE in initial access, the AMF may accept or reject UE Registration Request to the UE reported location. In case of rejection, the AMF may provide a cause value to the UE and/or NG-RAN (e.g. \"inaccurate/wrong Location\", \"Location is not supported\", or any other naming).\nb)\tAMF may forward the full, part or a modified version of the analytics (e.g. UE behaviour, UE location) to NG-RAN which may act upon it. For example, NG-RAN may release the UE in case of an \"unexpected UE location\".\nc)\tAMF may decide to initiate UE release procedure with the NG-RAN, and indicates the cause of UE context release as UE (e.g. \"inaccurate/wrong/unexpected UE Location\", \"UE Location is not supported\", or any other naming).\nNOTE 2:\tThe AMF may use additional information other than analytics to increase the reliability of location verification for satellite access. It is up to RAN WGs to decide if additional information to AMF is provided by NG-RAN.\nNOTE 3: To which extent NWDAF analytics can enhance the reliability of the location verification is for RAN WGs to verify.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.18.4\tImpacts on services, entities and interfaces",
                            "text_content": "AMF:\n-\tTo trigger UE related analytics request/subscription after NG-RAN requests AMF UE location verification for satellite access.\n-\tTo discover an NWDAF instance with aggregator capabilities for UE related analytics.\n-\tTo verify UE location provided via satellite access based on NWDAF analytics, report to NG-RAN and/or UE, and initiate any necessary action.\nNWDAF:\n-\tTo support aggregation of UE related analytics for location verification purposes.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.19\tSolution #19: Support of Low Latency via User Plane",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.19.1\tIntroduction",
                            "text_content": "This solution addresses KI#1 (Architectural Enhancement to support User Plane positioning and KI#10 (Support of Reduced Latency).\nThe main principles of this solution are as follows:\n1.\tThe solution applies to event reporting for a periodic or triggered deferred 5GC-MT-LR.\n2.\tThe target UE uses a user plane connection to report events to the LCS Client or AF, either directly or via the LMF or H-GMLC.\n3.\tWhen reporting directly to the LCS Client or AF or reporting via an H-GMLC, the UE sends a supplementary services event report (e.g. as defined in TS 24.080 [21]) over the user plane connection with a location estimate included. This could significantly reduce end-to-end latency because the event report no longer needs to be transferred via control plane through the NG-RAN, AMF, LMF, GMLC and possibly NEF. Signalling efficiency is likewise increased.\n4.\tWhen reporting via the LMF, the UE sends a supplementary services event report over the user plane connection to the LMF with one or more LPP messages included in the event report. The LMF then verifies or determines a location estimate and sends the event report with the location estimate to the LCS Client or AF over a second user plane connection. This can still reduce latency and increase signalling efficiency.\n5.\tThe control plane associations between the UE and LMF, LMF and V-GMLC/H-GMLC and H-GMLC and LCS Client or NEF and AF are retained to allow the status of event reporting to be conveyed to the H-GMLC (and NEF if used) and to support cancellation of event reporting using the existing control plane procedures in clauses 6.3.2 and 6.3.3. in TS 23.273 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.19.2\tFunctional Description",
                            "text_content": "There are no changes to 5GS architecture as defined in TS 23.501 [2] and TS 23.273 [5].\nLocation event reports are transferred from a UE to an LCS Client or AF using data transport through a UPF. Transfer can be direct or can be via an LMF or H-GMLC. Transfer via an LMF allows the LMF to determine or verify a location estimate and, if needed, exchange LPP messages with the target UE via user plane to perform positioning of the target UE. Transfer via an H-GMLC enables the H-GMLC to monitor event reporting by the target UE and to avoid direct UE to LCS Client or AF data interaction which might be a security risk to either entity.\nThe associated protocol layering is shown in Figure 6.19.2.2-1. A version of TLS (e.g. TLS 1.2 defined in RFC 5246 [20]) is used to enable secure data connection. The LMF or H-GMLC shown in Figure 6.19.2.2-1 is only present when event reports are transferred through the LMF or H-GMLC and not directly to the LCS Client or AF.\nNOTE:\tSecurity aspects of reporting location to an AF or LCS Client via a user plane will need to be verified or defined by SA WG3.\nThe figure depicts a protocol layering for user plane transfer of event reports in a 5G network. It illustrates the various layers, including the user plane, network plane, and transport layer, with their respective protocols and functions. The figure highlights the importance of protocol layering in ensuring efficient and reliable communication between different layers of the network.\nFigure 6.19.2.2-1: Protocol Layering for User Plane Transfer of Event Reports\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.19.3\tProcedures",
                            "text_content": "Figure 6.19.3.1-1 shows a procedure for event reporting from a UE directly to an LCS Client or AF when a User Plane connection is established directly from the UE to the LCS Client or AF with no intermediate LMF or H-GMLC. This procedure is applicable when UE based position methods or standalone position methods are used by the UE.\nThe figure depicts a simplified representation of an event reporting system from a UE (User Equipment) directly to an LCS (Local Controller System) client or AF (Access Facilitator). The system is designed to facilitate efficient communication between the UE and the LCS, ensuring smooth and reliable data transmission. The figure includes various components such as the UE, LCS, and AF, as well as the event reporting system itself. The system is designed to be modular and scalable, allowing for easy expansion and modification as needed.\nFigure 6.19.3.1-1: Event Reporting from a UE directly to an LCS Client or AF\n1.\tSteps 1-21 for the deferred 5GC-MT-LR procedure for periodic or triggered location events in clause 6.3.1 of TS 23.273 [5] are performed with the following differences.\n-\tAt step 1, the LCS Client or AF includes a request for user plane reporting in the Location Request and includes an IP address or FQDN for the user plane connection and security information to enable a secure connection.\n-\tAt steps 4, 5, 14 and 16, the request for user plane reporting and the IP address or FQDN and the security information are forwarded in sequence to the V-GMLC (if used), AMF, LMF and target UE. The type of user plane connection (direct to the LCS Client or AF) and criteria for sending cumulative event reports at step 9 are also conveyed to the target UE from the H-GMLC. The criteria can include a periodic time interval or the sending of a certain number of event reports via user plane at step 6.\n-\tAt steps 17-21, the target UE indicates to the LMF, H-GMLC and LCS Client or AF whether event reporting via user plane can be supported by the target UE. If event reporting via user plane cannot be supported, the target UE uses the procedure in clause 6.3.1 of TS 23.273 [5] to send events reports via Control Plane.\n2.\tThe UE establishes a secure TCP/IP connection to the LCS Client or AF using the IP address or FQDN and security information received at step 1.\n3.\tIf the UE needs assistance data to help determine a location later at step 5, the UE may send a positioning LPP request to the LMF via Control Plane using the deferred Routing ID received in step 16 of the procedure in clause 6.3.1 in TS 23.273 [5] to identify and route the request to the correct LMF. The LMF then provides the requested assistance data to the UE by returning an LPP positioning message via Control Plane. Preferably, the UE requests assistance data some time before location determination is needed to avoid increasing latency. The LMF may use the LMF change procedure in clause 6.4 in TS 23.273 [5] to forward the request for assistance data to a better LMF if the current LMF cannot provide assistance data for the current UE location (e.g. the current UE TAI or CGI). In this case, the new LMF can return the assistance data to the UE via the original LMF to avoid changing the LMF association in the UE and H-GMLC or V-GMLC.\n4.\tThe UE monitors for and detects the occurrence of a trigger or periodic event as described for step 22 of the procedure in clause 6.3.1 of TS 23.273 [5].\n5.\tThe UE obtains location measurements and determines a current location, possibly using assistance data obtained at step 3.\nNOTE:\tObtaining a location at step 5 limits the UE to using UE based or standalone position methods. If UE assisted position methods need to be used, the LMF can use the procedure described in clause 6.19.3.3 instead of the procedure in this clause.\n6.\tThe UE sends a supplementary services Event Report to the LCS Client or AF over the secure TCP/IP Connection established at step 2. The event report indicates the type of event being reported and includes the location determined at step 5.\n7.\tThe LCS Client or AF returns a supplementary services Event Report Acknowledgment to the UE over the secure TCP/IP Connection established at step 2.\n8.\tThe UE continues to monitor for and detect further trigger or periodic events as at step 4 and repeats steps 5-7 for each detected trigger or periodic event.\n9.\tBased on the criteria received by the UE for sending of cumulative event reports (e.g. the expiration of a periodic timer or the sending of certain number of event reports at step 6), the UE sends a cumulative event report to the LMF, H-GMLC and LCS Client or AF over the control plane portion of the periodic or triggered deferred 5GC-MT-LR using steps 25-30 of the procedure in clause 6.3.1 of TS 23.273 [5]. The cumulative event report indicates to the LMF, H-GMLC and External LCS Client or AF that the control plane portion of the periodic or triggered deferred 5GC-MT-LR is still operational, that the UE is still reporting events (e.g. is still powered on and in network coverage) and may include statistics on the events reported since the last cumulative event report was sent (e.g. the number of event reports).\nFigure 6.19.3.2-1 shows a procedure for event reporting from a UE to an LCS Client or AF when a User Plane connection is established to the LCS Client or AF via the H-GMLC. This procedure is applicable when UE based position methods or standalone position methods are used by the UE.\nThe figure depicts a network scenario where an event is reported from a UE (User Equipment) to an LCS (Local Controller System) client or AF (Access Facilitator) via the H-GMLC (Hybrid GMPLS Control Channel). The figure illustrates the communication path, including the H-GMLC, which is a hybrid GMPLS control channel. The figure also shows the event reporting mechanism, with the UE sending the event to the LCS client or AF, and the LCS client or AF receiving the event and forwarding it to the appropriate network control center (NCC) for further processing.\nFigure 6.19.3.2-1: Event Reporting from a UE to an LCS Client or AF via the H-GMLC\n1.\tSteps 1-21 for the deferred 5GC-MT-LR procedure for periodic or triggered location events in clause 6.3.1 of TS 23.273 [5] are performed with the following differences.\n-\tAt step 1, the LCS Client or AF includes a request for user plane reporting in the Location Request and includes an IP address or FQDN for the user plane connection and security information to enable a secure connection.\n-\tAt steps 4, 5, 14 and 16, the request for user plane reporting and an IP address or FQDN and security information for the H-GMLC are forwarded in sequence to the VGMLC (if used), AMF, LMF and target UE. The H-GMLC also retains the IP address or FQDN and security information for the LCS Client or AF that was received at step 1. The type of user plane connection (via the H-GMLC)) is also conveyed to the LMF and target UE from the H-GMLC. The H-GMLC can decide to use this procedure (rather than either of the other procedures) prior to step 4 or step 5 of the procedure in clause 6.3.1 of TS 23.273 [5].\n-\tAt step 17-21, the target UE indicates to the LMF, H-GMLC and LCS Client or AF whether event reporting via user plane can be supported by the target UE. If event reporting via user plane cannot be supported, the target UE uses the procedure in clause 6.3.1 of TS 23.273 [5] to send events reports via Control Plane.\n2.\tThe UE establishes a secure TCP/IP connection to the H-GMLC using the IP address or FQDN and security information received by the UE at step 1.\n3.\tThe H-GMLC establishes a secure TCP/IP connection to the LCS Client or AF H-GMLC using the IP address or FQDN and security information received by the H-GMLC at step 1.\n4.\tIf the UE needs assistance data to help determine a location later at step 6, the UE performs step 3 in clause 6.19.3.1 to obtain assistance data from the LMF using control plane.\n5.\tThe UE monitors for and detects the occurrence of a trigger or periodic event as described for step 22 of the procedure in clause 6.3.1 of TS 23.273 [5].\n6.\tThe UE obtains location measurements and determines a current location, possibly using assistance data obtained at step 3.\nNOTE 1:\tObtaining a location at step 6 limits the UE to using UE based or standalone position methods. If UE assisted position methods need to be used, the LMF can use the procedure described in clause 6.19.3.3 instead of the procedure in this clause.\n7.\tThe UE sends a supplementary services Event Report to the H-GMLC over the secure TCP/IP Connection established at step 2. The event report indicates the type of event being reported and includes the location determined at step 6.\n8.\tThe H-GMLC forwards the supplementary services Event Report to LCS Client or AF over the secure TCP/IP Connection established at step 3.\n9.\tThe LCS Client or AF returns a supplementary services Event Report Acknowledgment to the H-GMLC over the secure TCP/IP Connection established at step 3.\n10.\tThe H-GMLC returns the supplementary services Event Report Acknowledgment to the UE over the secure TCP/IP Connection established at step 2.\n11.\tThe UE continues to monitor for and detect further trigger or periodic events as at step 5 and repeats steps 6-10 for each detected trigger or periodic event.\nNOTE 2:\tA cumulative event report from the UE, as at step 9 in the procedure in clause 6.19.3.1, should not be needed when event reports are sent via the H-GMLC, as the H-GMLC is already aware of the status of event reporting and would know if the UE had ceased reporting events.\nFigure 6.19.3.3-1 shows a procedure for event reporting from a UE to an LCS Client or AF when a User Plane connection is established to the LCS Client or AF via the LMF. This procedure is applicable when UE assisted position methods are used by the UE.\nNOTE:\tThis procedure does not support transfer of event reporting to a new LMF. While such support could be added, it could substantially increase latency as well as add more impacts for the target UE, LMF and LCS Client or AF. Environments where very low latency is needed can include factories, warehouses and industrial plants where a single LMF might support the entire UE coverage area, thereby making LMF change unnecessary. In other environments, where an LMF change could be needed, the procedure in clauses 6.19.3.1 or 6.19.3.2 could be used instead.\nThe figure depicts a network event reporting from a UE (User Equipment) to an LCS (Local Multipoint Distribution System) client or AF (Access Facilitator) via the LMF (Local Multipoint Function). The event is reported in a format that is easy to understand and interpret, with the UE sending the event to the LCS client or AF, and the LCS client or AF sending the event to the appropriate network management center (NMC) for further analysis. The figure provides a clear visual representation of the communication process, allowing network operators to quickly identify and resolve any issues that may arise.\nFigure 6.19.3.3-1: Event Reporting from a UE to an LCS Client or AF via the LMF\n1.\tSteps 1-21 for the deferred 5GC-MT-LR procedure for periodic or triggered location events in clause 6.3.1 of TS 23.273 [5] are performed with the following differences:\n-\tAt step 1, the LCS Client or AF includes a request for user plane reporting in the Location Request and includes an IP address or FQDN for the user plane connection and security information to enable a secure connection.\n-\tAt steps 4, 5 and 14, the request for user plane reporting and the IP address or FQDN and the security information are forwarded in sequence to the V-GMLC (if used), AMF and LMF. The criteria for sending cumulative event reports at step 14 are also conveyed to the LMF. The criteria can include a periodic time interval or the sending of a certain number of event reports via user plane at steps 7 and 11.\n-\tAt step 16, the request for user plane reporting and an IP address or FQDN and security information for the LMF are sent to target UE. The LMF also retains the IP address or FQDN and security information for the LCS Client or AF that was received at step 14. The type of user plane connection (via the LMF) is also conveyed to the target UE at step 16. The LMF can decide to use this procedure (rather than either of the other procedures) prior to step 16 of the procedure in clause 6.3.1 of TS 23.273 [5] and only if the H-GMLC had decided not to use event reporting via the H-GMLC.\n-\tAt step 17-21, the target UE indicates to the LMF, H-GMLC and LCS Client or AF whether event reporting via user plane can be supported by the target UE. If event reporting via user plane cannot be supported, the target UE uses the procedure in clause 6.3.1 of TS 23.273 [5] to send events reports via Control Plane.\n2.\tThe UE establishes a secure TCP/IP connection to the LMF using the IP address or FQDN and security information received by the UE at step 1.\n3.\tThe LMF establishes a secure TCP/IP connection to the LCS Client or AF using the IP address or FQDN and security information received by the LMF at step 1.\n4.\tIf the UE needs assistance data to help obtain location measurements later at step 6, the UE performs step 3 in clause 6.19.3.1 to obtain assistance data from the LMF using control plane.\n5.\tThe UE monitors for and detects the occurrence of a trigger or periodic event as described for step 22 of the procedure in clause 6.3.1 of TS 23.273 [5].\n6.\tThe UE obtains location measurements and possibly determines a location, and possibly using assistance data obtained at step 4.\n7.\tThe UE sends a supplementary services Event Report to the LMF over the secure TCP/IP Connection established at step 2. The event report indicates the type of event being reported and includes an embedded LPP message with the location measurements or location estimate obtained at step 6.\n8.\tThe LMF returns a supplementary services Event Report Acknowledgment to the UE over the secure TCP/IP Connection established at step 2.\n9.\tIf the LMF needs additional location measurements or a location estimate from the UE, the LMF exchanges LPP messages with the UE over the secure TCP/IP Connection established at step 2 to request and receive the additional location measurements or location estimate from the UE.\n10.\tBased on the location measurements or location estimate received from the UE at step 7 and/or step 9, the LMF determines or verifies a location estimate for the UE.\n11.\tThe LMF sends a supplementary services Event Report to the LCS Client or AF over the secure TCP/IP Connection established at step 3 and includes the type of event report and the location estimate determined or verified at step 10.\n12.\tThe LCS Client or AF returns a supplementary services Event Report Acknowledgment to the LMF over the secure TCP/IP Connection established at step 3.\n13.\tThe UE continues to monitor for and detect further trigger or periodic events as at step 5 and repeats steps 6-12 for each detected trigger or periodic event.\n14.\tBased on the criteria received by the LMF for sending of cumulative event reports (e.g. the expiration of a periodic timer or the sending of certain number of event reports), the LMF sends a cumulative event report to the H-GMLC and LCS Client or AF over the control plane portion of the periodic or triggered deferred 5GC-MT-LR using steps 28-30 of the procedure in clause 6.3.1 of TS 23.273 [5]. The cumulative event report indicates to the H-GMLC and External LCS Client or AF that the control plane portion of the periodic or triggered deferred 5GC-MT-LR is still operational, that the UE is still reporting events (e.g. is still powered on and in network coverage) and may include statistics on the events reported since the last cumulative event report was sent (e.g. the number of event reports).\nCancellation of event reporting can be initiated by the UE, H-GMLC or LCS Client or AF using the control plane procedures defined in clauses 6.3.2 and 6.3.3 in TS 23.273 [5]. The only change to these procedures is that the user plane connection(s) established for the procedures in clauses 6.19.3.1, 6.19.3.2 and 6.19.3.3 are also released. The user plane connection(s) may be released by either end once cancellation at the control plane level has occurred.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.19.4\tImpacts on services, entities, and interfaces",
                            "text_content": "UE:\n-\tSupport control plane signalling transfer of information related to user plane transfer (e.g. IP address, FQDN, security information).\n-\tSupport user plane connection establishment and release to an LMF, H-GMLC or LCS Client or AF.\n-\tSupport sending event reports via the user plane connection.\n-\tSupport cumulative event reporting to an LMF via control plane.\nLMF:\n-\tsupport control plane signalling transfer of information related to user plane transfer (e.g. IP address, FQDN, security information).\n-\tSupport user plane connection establishment and release to a UE and an LCS Client or AF (this is optional).\n-\tSupport receiving and sending event reports via the user plane connections (this is optional).\n-\tSupport receiving and sending cumulative event reports via control plane.\nH-GMLC:\n-\tsupport control plane signalling transfer of information related to user plane transfer (e.g. IP address, FQDN, security information).\n-\tSupport user plane connection establishment and release to a UE and an LCS Client or AF (this is optional).\n-\tSupport receiving and sending event reports via the user plane connections (this is optional).\n-\tSupport receiving and sending cumulative event reports via control plane.\nLCS Client or AF:\n-\tsupport control plane signalling transfer of information related to user plane transfer (e.g. IP address, FQDN, security information).\n-\tSupport user plane connection establishment and release to a UE, H-GMLC or LMF.\n-\tSupport receiving event reports via the user plane connection.\n-\tSupport receiving cumulative event reports via control plane.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.20\tSolutions 20: NWDAF based Indoor or Outdoor in Location Services",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.20.1\tIntroduction",
                            "text_content": "The FS_eLCS_Ph3 of this TR includes the following agreed aspect to study as part of key Issue #4: Interaction between Location Service and NWDAF:\n-\tIdentify use cases where new or existing data analytics from the NWDAF can be used for improving location service performance. Regulatory requirements (e.g. different location accuracy requirements from FCC in different cases) will be taken into account.\nNOTE:\tCoordinated activities between the study FS_eNA_Ph3 and this study are needed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.20.2\tSolution Description",
                            "text_content": "As part of the Regulatory requirements, for example FCC \"Wireless E911 Location Accuracy Requirements\" which requires ±3 meters accuracy for indoor cases. However, currently, LMF output does not contain indoor/outdoor level indication. For example, police or lawful agency wants to know if user/victim is inside the building or outside the building, according, they approach the user. Additionally, knowledge of such UE status helps LMF to use most optimal positioning method and optimization to calculate UE's indoor and/or outdoor position. (e.g. different location accuracy requirements from FCC in different cases), it is required to determine if a particular user is located indoor or outdoor. Such information of user can then be used by rescue team to take appropriate action. This clause provides high level solution, and detail procedures are for further studies.\nThis solution allows an regulatory AF/LCS client to request UE's indoor or outdoor location in the \"LCS Service Request\".\nSuch request triggers LMF to request/subscribe to analytics data from NWDAF. This is to request analytics information from NWDAF to assist LMF in determining whether UE is indoor or not.\nSince indoor/outdoor information is regulatory requirements about accuracy and could assist in better accuracy of final result, to support this, NWDAF can use the same interface of regulatory AF/LCS Client to fetch both accurate result and indoor/outdoor information. NWDAF can also implement new analytics determination logic in order to determine indoor-outdoor prediction of the UE. This fits the KI#9 in eNA study.\nAs proposed by other solutions of KI#4, using GMLC/NEF interface, NWDAF can get the better accurate information for machine learning of both accurate position and indoor/outdoor indication.\n''LMF can optionally decide the indoor/outdoor information by following methods:\n1.\tUE can detect the indoor-only signal including serving cell ID (NCGI) which serves only indoor cases, or indoor WLAN and/or Bluetooth positioning information defined in TS 37.355 [15].\n2.\tLMF can generate the altitude information and identify the UE is below the height of the roof (in SRTM DB, etc).\n3.\tOther implementation specific methods.\nLMF provides all the measurements from RAN node/UE and optional indoor/outdoor indication to NWDAF:\n-\tWhen indoor/outdoor indication is provided to NWDAF, NWDAF can perform the learning process to correlate the positioning measurements with indoor/outdoor result.\n-\tWhen indoor/outdoor indication is absent, LMF can use the measurements to query NWDAF for the indoor/outdoor decision result.\nNWDAF generates analytics data and with certain confidence level, provides as output to LMF indicating whether UE is indoor or outdoor.\nLMF based on its own decision or the received analytics result includes whether UE is indoor or outdoor, LMF can reply the information to AF/LCS Client to meet the regulatory requirements through AMF/GMLC/NEF; LMF can also determines most suitable positioning method e.g. optimized to indoor positioning or outdoor positioning.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.20.3\tProcedures",
                            "text_content": "'The figure depicts a network-wide analytics solution provided by NWDAF, which includes in/out-door analytics. It shows the various components and their functionalities, such as network traffic analysis, anomaly detection, and security monitoring. The solution is designed to provide real-time insights into network performance and security threats, helping network operators make informed decisions.\nFigure 6.20.3-1: In/out-door analytics provided by NWDAF\nStep 1:\tRegulatory (LI or Emergency) NI-LR or MT-LR procedure as defined in TS 23.273 [5]. NWDAF can also use GMLC to fetch finer granularity information with indoor/outdoor indication in response.\nStep 2:\tLMF receives the request which requires indoor and outdoor indication.\nStep 3:\tLMF performs positioning procedures (using LPP with UE or NRPPa with RAN nodes).\nStep 3.1:\tLMF may decide indoor and outdoor decision by its own positioning procedures/measurements. This could also be carried out in non-regulatory procedures to enrich the NWDAF dataset.\nStep 3.2.a:\tWhen LMF decides the indoor/outdoor indication, it can feed the measurements and result to NWDAF for learning process.\nStep 3.2.b:\tWhen LMF can't decide the indoor/outdoor indication, it can use its measurements to query NWDAF.\nStep 3.3:\tNo matter indoor/outdoor decision is made by LMF or NWDAF, LMF can use the information to optimize its positioning methods or procedures.\nStep 4~5:\tindoor and outdoor information can be forwarded back to various client to meet the regulatory requirements.\nStep 6:\tThe indoor/outdoor information can be included in the response if needed. NWDAF can get the indoor/outdoor indication when better accurate information than TA/CI is needed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.20.4\tImpacts on services, entities, and interfaces",
                            "text_content": "LCS Client: support indication of indoor/outdoor in the LCS Service Request.\nLMF: support determination of UE's indoor or outdoor location.\nNWDAF: support new analytics of indoor and outdoor decision.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.21\tSolution #21: Collection of nearby GNSS assistance data",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.21.1\tIntroduction",
                            "text_content": "This solution addresses KI#5 about how LMF to obtain nearby GNSS assistance data.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.2\tFunctional Description",
                            "text_content": "Normally, a serving area of a GNSS reference station can cover one TA or multiple TAs (i.e. its GNSS assistance data applies to one TA or multiple TAs). When LMF collects GNSS assistance data, it requests corresponding data which can serve its serving area. The collection may be performed on a periodic basis.\nWith different GNSS reference deployment scenarios, how LMF obtain GNSS assistance data can be different. In this solution, following cases are considered:\n-\tGNSS reference stations are third party functions co-located with gNBs and LMF collects data from AFs.\nLMF gets GNSS assistance data through AF event exposure service as described in clause 5.2.19.2 of TS 23.502 [3], LMF may also get the precise global coordinates of GNSS reference stations. In this case, LMF is enhanced to support utilize the Naf_EventExposure service. LMFs collected GNSS assistance data may update its NF profile in NRF by indicating the TAs of which corresponding GNSS assistance data exists, which can be discovered and used by other LMFs not having corresponding GNSS assistance data.\n-\tFor a trusted AF, AF registers at the NRF with its serving area (e.g. TAs or geographical location). LMF discovers trusted AFs which can cover its serving area through NRF and subscribes to GNSS assistance data exposure from discovered trusted AFs.\n-\tFor a third-part AF, AF registers at the NEF with its serving area (e.g. geographical location) and NEF registers itself with the serving area information (mapped into TAs) to NRF. LMF discovers corresponding NEFs which can cover its serving area through NRF then subscribes GNSS assistance data through the discovered NEFs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.3\tProcedures",
                            "text_content": "The procedure in Figure 6.21.3.1a-1 is used by LMF to collect GNSS assistance information from AFs via the NEF, which is similar with NWDAF collecting data from untrusted AF described in clause 6.2.2.3 of TS 23.288 [9].\nThe figure depicts a GNSS assistance data collection system, illustrating the various components involved in collecting and processing GNSS signals. The system includes a GNSS receiver, a GNSS signal processing unit, and a GNSS data collection module. The GNSS receiver captures GNSS signals, while the GNSS signal processing unit processes the data, and the GNSS data collection module collects and stores the collected data. The system is designed to ensure reliable and accurate GNSS data collection, with redundancy paths to ensure failover in case of signal loss.\nFigure 6.21.3.1a-1: GNSS assistance data collection\n1a-1c.\tSimilar with steps 1a-1c in figure 6.2.2.3-1 of TS 23.288 [9]. The difference is that AF should also provide its serving area to NEF. NEF should map the serving area into TA(s) if it is presented as geographical location and update the NEF profile in NRF including the serving area information.\n1d-1e.\tSimilar with steps 1d-1e in figure 6.2.2.3-1 of TS 23.288 [9]. The difference is that LMF may additionally provide TAs to discover specific NEFs.\n2-5.\tSimilar with steps 2-5 in figure 6.2.2.3-1 of TS 23.288 [9]. The difference is that besides available GNSS assistance data, AF further provide associated serving area of the GNSS assistance data and optional precise global coordinates of the source of the GNSS assistance data. NEF may map the serving area into a TA or TA list.\nFor trusted AFs, LMF should collect GNSS assistance data through AFs directly. LMF discovers trusted AFs covering LMF serving area through NRF and subscribes to GNSS assistance data exposure from discovered trusted AFs.\nThe figure depicts a GNSS measurement transfer process, with the GNSS receiver (RF) registering with the National Reference Frame (NRF) at the National Reference Point (NRP) with its serving area (e.g., TA). This process is crucial for accurate positioning and navigation in GNSS-based systems.\nFigure 6.21.3.1b-1: GNSS measurements transfer1a-1c. AF registers at the NRF\nwith its serving area (e.g. TAs)\n1d-1e.\tLMF provide TAs to discover AFs.\n2-3.\tLMF subscribes AF for GNSS assistance collection. Besides available GNSS assistance data, AF further provides associated serving area of the GNSS assistance data and optional precise global coordinates of the source of the GNSS assistance data.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.4\tImpacts on services, entities, and interfaces",
                            "text_content": "LMF:\n-\tSupport to collect and store GNSS assistance data from AF, RAN or UE.\n-\tWhen receive GNSS assistance data, send message to NRF to indicate GNSS assistance data existence in certain area.\nAF:\n-\tSupport exposure of GNSS assistance data associated with geographical location.\nNEF:\n-\tSupport exposure of GNSS assistance data associated with geographical location from AF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.22\tSolution #22: Support of LCS mobility when UE moves between NG-RAN nodes",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.22.1\tIntroduction",
                            "text_content": "This solution addresses the KI \"Key Issue #8: support of location service continuity in case of UE mobility\".\nContinuity of certain basic services like a PDU session during mobility is defined currently. However, the handling of an LCS session during mobility procedures is not specified currently. In particular, there is no specification on whether an ongoing LCS session shall be terminated or continued with after the mobility and if continued, how the continuity shall work. There can be many effects due to this missing part:\n-\tLCS sessions may be terminated at mobility with the LCS Client having to re-initiate the session after the procedure.\n-\tThe LMF may not be aware of the mobility at all, leading to inaccurate positioning estimates.\n-\tSince there are no clear specifications, inter-vendor tests could fail.\n-\tLCS sessions could be enabled as part of other critical services (like emergency calls) - those services could be impacted due to the current specifications - leading to regulatory issues.\nAll of the above issues could be prevented if there is a clear specification on how LCS sessions are to be handled in different mobility procedures and in particular, if continuity can be guaranteed by the network.\nWe describe the additional handling required at LMF change for LCS Continuity in both the scenarios - Xn based HO and NG based HO.\nIt is noted that clause 6.4 of TS 23.273 [5] describes LMF change handling already. But this is for the case where the AMF detects the need for LMF change (possibly due to UE mobility) before the LCS session is started. In the scenario that solution 22 addresses, the HO happens after the LCS session is started. So, the existing solution will not address this scenario.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.22.2\tFunctional Description",
                            "text_content": "This proposal provides a solution for the intra-5GS mobility across NG-RAN nodes.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.22.3\tProcedure",
                            "text_content": "The figure depicts a handover scenario in a 5G network, illustrating the use of the Long-Term Evolution (LTE) technology. The figure shows the handover process, with the user equipment (UE) transitioning from the 3GPP Release 15 (R15) to the 5G NR (New Radio) standard. The figure includes key elements such as the base station (gNB), user equipment, and the network, highlighting the importance of handover in ensuring reliable communication.\nFigure 6.22.3-1: Xn Based Handover – LCS Continuity\nDescription:\nSteps 1-12 describe the normal LCS session and Xn based HO procedures.\nSome of the key steps are described below.\nStep 4: AMF knows the LCS Correlation ID of the UE for which the LCS session is being initiated - it stores the same.\nStep 12: AMF comes to know of the completion of the Xn based HO. The Target gNB also sends the old NGAP : AMF UE ID assigned by the AMF in the message (Target gNB gets it from Source gNB in step 7).\nStep 13: The AMF checks if this UE ID has an associated LCS session that is active (by checking for the corresponding LCS Correlation ID).\nStep 14: If such an LCS session exists, then the AMF shall invoke a notification towards the LMF indicating the completion of the ongoing mobility procedure. This could be an existing API enhanced or a new API.\nAMF determines that the existing LMF cannot serve the LCS session anymore due to UE mobility (this could be based on an internal configuration); it then selects a new LMF and provides this LMF address in the mobility completion notification to the old LMF.\nThe old LMF then invokes the Nlmf_Location_LocationContextTransfer procedure to the new LMF and transfers the LCS Session context.\nStep 16: When the LMF receives the notification for mobility completion, it will keep all the active LCS sessions on, but requests for updated information to make the measurements accurate. The LMF may communicate with the Target gNB through the AMF for this purpose.\nThe new LMF then initiates the LCS session (using the target NG-RAN).\nThis could be the modified list of TRPs, assistance information etc. and then subsequently, a fresh request for measurements based on the updated information.\nAs can be observed, the entire procedure is done in a way where GMLC and/or LCS Client is not aware of the mobility handling and the LCS session continuity is ensured.\nThe figure depicts a handover scenario in a Next Generation (NG) network, specifically focusing on the Layer 22.3-2 (LCS Continuity) handover. It illustrates the process of transitioning from a legacy network to a new one, with the use of Layer 22.3-2 (LCS) handover protocols. The figure shows the handover process, including the use of handover frames, handover frames, and handover frames, to ensure a smooth transition.\nFigure 6.22.3-2: NG Based Handover - LCS Continuity\nDescription:\nSteps 1-16 describe the normal LCS session and NG based HO procedures. Some key steps are highlighted below.\nStep 4: Source AMF knows the LCS Correlation ID of the UE for which the LCS session is being initiated - it stores the same.\nStep 9: The Source AMF adds the LCS Session information corresponding to all the active LCS sessions to the Target AMF along with the assigned old NGAP AMF UE ID.\nS-AMF already sends the Target RAN ID to the T-AMF as part Namf_CreateUEContextRequest. It could add the S-LMF Address in the same. The T-SMF then determines if the same LMF can continue to serve the UE post HO (possibly based on internal configuration).\nStep 10: The Target AMF assigns a new NGAP AMF UE ID for the UE as per HO signalling.\nStep 12: T-AMF may then select a different LMF(T-LMF) and indicates this to the S-AMF in Namf_CreateUEContextResponse. If a new LMF is indicated, then the S-AMF requests the S-LMF to initiate LMF context transfer using the Nlmf_Location_CancelLocation. This triggers the S-LMF to start Nlmf_Location_LocationContextTransfer procedure to the T-LMF and transfers the LCS Session context.\nStep 16: The HO completes and Target AMF gets the notification with the new NGAP AMF UE ID.\nStep 17: It then checks if that UE had an existing LCS Session on the Source AMF (using the data it got in step 9).\nStep 18: If such an LCS session exists, then the AMF shall invoke a notification towards the LMF indicating the completion of the ongoing mobility procedure. This could be an existing API enhanced or a new API.\nThe LMF may then choose to do the same actions as described for the Xn based HO to keep the LCS session active, but with updated, more accurate parameters and measurements. The LMF may communicate with the Target gNB through the Target AMF for this purpose. This completes the LCS session continuity for NG based HO.\nThe T-LMF shall then wait HO completion notification and then re-initiates the LCS session with the T-gNB.\nNOTE 1:\tThe above solutions are applicable to:\n-\tUL or DL or UL+DL positioning methods.\n-\tMTLR/MOLR/NILR LCS sessions.\nNOTE 2:\tIn both the solutions, the LMF is assumed to remain the same. Handling of LCS session during LMF change is already specified in TS 23.273 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.22.4\tImpacts on services, entities, and interfaces",
                            "text_content": "AMF: Check if the UE has an existing LCS Session after HO. If yes, invoke a notification towards the LMF indicating the completion of the ongoing mobility procedure.\nLMF: Receive notification indicating the completion of the ongoing mobility procedure and initiate the LCS session using the target NG-RAN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.23\tSolution #23: Location Verification for Satellite Access assisted by TN access",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.23.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #9 on support of positioning requirements related to satellite access.\nWhen a UE using NR satellite access, the UE should first determine a most suitable PLMN based on its own physical location determination. As there may be border cases where the UE cannot determine sufficiently accurate or sufficiently precise in which country it is, in order to meet the regulatory requirements, the network needs to verify whether the PLMN selected by the UE is allowed to operate in the country of the UE location based on the UE location information. But the UE location information may not reliable since it was determined by gNB based on UE-generated location information (e.g. GNSS/A-GNSS ).\nSuch verification becomes essential in the country borders, especially in terrestrial border. There is usually terrestrial cellular network coverage in such areas. This solution provides a method to do NTN location verification for UE using satellite access based on the UE location provided by TN access (e.g. NR) and based on the following assumptions:\n-\tThe UE has the capability to support both TN access and NTN access.\n-\tThe area of the UE present location has both TN and NTN network coverage.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.23.2\tFunctional Description",
                            "text_content": "The high level functional description of this solution is as follows:\n-\tDuring the registration procedure through NR satellite access, the UE indicates the capability of supporting TN access (e.g. NR).\n-\tIf the network intends to do NTN location verification for UE using satellite access, it requests UE to initiate registration via TN access.\n-\tThe UE initiates Registration through TN access. The TN access (e.g. gNB) provides UE location information to the network through NGAP message. After receiving the UE location, the network responds Registration Reject to the UE.\n-\tThe AMF verifies the PLMN selected by the UE is whether allowed to operate in the country of the UE present location based on the UE location receiving from TN access.\nNOTE 1:\tSolution works in areas covered by both TN access and NTN access and the UE has the capability of supporting both TN access and NTN access.\nNOTE 2:\tHow to support emergency service is out of scope in this solution.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.23.3\tProcedures",
                            "text_content": "The figure depicts a procedure for location verification for satellite access assisted by TN access, illustrating the steps involved in verifying the satellite's location. The figure includes a diagram of the TN access system, a schematic of the satellite's communication path, and a flowchart to guide the verification process. The figure is crucial for understanding the satellite's location and ensuring reliable communication.\nFigure 6.23.3-1: Procedure for location verification for satellite access assisted by TN access\n1.\tFor a UE accessing to 5GC using NR satellite access, the UE sends a registration request message to AMF1. As per existing procedure, parameters such as registration type, SUCI or 5G-GUTI, etc, are contained in the message. Besides that, if the UE supports 3GPP TN access (e.g. NR), the capability is also included in the message.\n2.\tThe AMF1 registrates to the UDM using Nudm_UECM_Registration message as described in clause 4.2.2.2.2 of TS 23.502 [3].\n3.\tThe AMF1 determines NTN location verification for NR satellite access is needed, it returns the Registration Accept message to the UE with an indication to request the UE to access via TN access.\n4.\tThe UE sends registration request via TN access to AMF2 which includes \"NTN location verification\" to indicate the registration procedure is used to provide UE location for NTN location verification. The TN RAN (e.g. gNB) sends the UE location information in NGAP to the AMF2. The AMF1 and the AMF2 selected by the UE via NTN and TN access may belong to different PLMNs.\n5.\tThe AMF2 registers with the UDM using Nudm_UECM_Registration. The UDM stores the UE location information received from TN access.\nIf the TN access and NTN access selected by the UE belong to different PLMNs, it can be seen as the PLMN selected by UE via NTN access is home PLMN while the PLMN selected by UE via NTN access is Serving PLMN. The AMF2 in the serving PLMN will selects UDM in the Home PLMN based on the UDM selection as specified in clause 6.3.8 in TS 23.501 [2] during initial registration. Then the AMF2 provides the UE location information in TN access to the UDM for preserve.\n6.\tThe AMF2 sends registration reject message to UE with a suitable cause value indicating NTN location verification.\n7.\tThe UDM sends Nudm_SDM_Notification to provide the UE location receiving from TN access to the registered AMF1.\n8.\tBased on the UE location receiving from TN access, the AMF1 can verify whether the UE is allowed to operate in the country/area of the UE present location.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.23.4\tImpacts on services, entities, and interfaces",
                            "text_content": "UE:\n-\tCapability to support both TN access and NTN access, inform this capability to the network.\nAMF:\n-\tBased on the UE capability, requests UE to initiate registration through TN access.\n-\tRequests UE location information from UDM.\n-\tBased on the UE location information receiving from TN access, verifies the PLMN selected by UE is whether allowed to operate in the country of the UE location.\nUDM:\n-\tReceives and Stores UE location information through registration procedure via TN access.\n-\tProvides the UE location information to the AMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.24\tSolution #24: UE Location Verification based on Obtained Information",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.24.1\tIntroduction",
                            "text_content": "This solution addresses KI#9: Support of Positioning Requirements Related to Satellite Access.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.24.2\tFunctional Description",
                            "text_content": "In Rel-17, as described in clause 5.4.11.4 in TS 23.501 [2], if the AMF is not able to determine the UE's location with sufficient accuracy based on the ULI, the AMF proceeds with the Mobility Management or Session Management procedure and may initiate UE location procedure after the Mobility Management or Session Management procedure is complete, as specified in clause 6.10.1 of TS 23.273 [5], to determine the UE location. The AMF shall be prepared to deregister the UE if the information received from LMF indicates that the UE is registered to a PLMN that is not allowed to operate in the current UE location.\nIn this solution, it is proposed to optimize the mechanism for UE location verification, as follows:\n-\tIf NG-RAN can verify UE location, the NG-RAN provides assistance information including the verification result  to AMF.\n-\tWhen the assistance information indicates that UE location is reliable, the AMF skips the UE location verification mechanism in Rel-17.\n-\tWhen the assistance information indicates that UE location is not reliable, the following scenario may happen:\n-\tIf the country of the UE reported location is the same as the country of the network verified UE location, the AMF triggers LCS procedure to obtain UE location and notify the UE location to NFs which have subscribed the related event.\n-\tIf the country of the UE reported location is different from the country of the network verified UE location, the AMF initiates deregistration procedure with a suitable cause value.\nNOTE:\tWhether and what assistance information can be provided by NG-RAN depends on the conclusion of the network verified UE location objective in Rel-18 NR_NTN_enh WID in RAN WG.\n-\tOtherwise, the existing UE location verification mechanism in Rel-17 is re-used.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.24.3\tProcedures",
                            "text_content": "The figure depicts a location verification system for a user's location, utilizing a combination of location-based services (LBS) and location-based advertising (LBA) to provide accurate and reliable location information. The system utilizes a combination of LBS and LBA to provide location-based services, such as navigation, location-based advertising, and location-based services. The system also includes a location-based advertising system, which uses location-based services to provide location-based advertising. The system also includes a location-based advertising system, which uses location-based services to provide location-based advertising.\nFigure 6.24.3.1-1: UE Provided Location Verification based on Obtained Information\n1.\tThe UE sends UE location information (i.e. GNSS info) to NG-RAN over NR-Uu via satellite access.\n2.\t[Conditional] If the NG-RAN can verify UE location, it verifies the reported UE location.\nNOTE:\tWhether NG-RAN can verify UE location and how to verify the UE location  depends on the conclusion of the network verified UE location objective in Rel-18 NR_NTN_enh WID in RAN WG.\n3.\t[Conditional] If the step 2 is performed, the NG-RAN sends N2 message including the assistance information.\n4.\t[Conditional] If assistance information provided by NG-RAN indicates that UE location is not-reliable, and the country of the UE reported location is the same as the country of the network verified UE location, and there is NF(s) has subscribed UE location event report, the AMF triggers the 5GC-NI-LR procedure in clause 6.10.1 of TS 23.273 [5] to obtain UE location.\n5.\t[Conditional] If the step 4 is performed , the AMF notifies the UE location to the NF(s)..\n6.\t[Conditional] If assistance information provided by NG-RAN indicates that UE location is not-reliable and the country of the UE reported location is different from the country of the network verified UE location, the AMF deregisters the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.24.4\tImpacts on services, entities, and interfaces",
                            "text_content": "AMF: receive assistance information from NG-RAN and behaves accordingly.\nNG-RAN: verifies the UE location reported by the UE and provides  assistance information to AMF.\nNOTE:\tWhether and what assistance information can be provided by NG-RAN depends on the conclusion of the network verified UE location objective in Rel-18 NR_NTN_enh WID in RAN WG.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.25\tSolution #25: Event Report in an Allowed Area",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.25.1\tIntroduction",
                            "text_content": "This solution addresses KI#11: Enhance the Triggered Location for UE power saving purpose.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.25.2\tFunctional Description",
                            "text_content": "To support tracking UE location in a pre-defined area, an event report allowed area is introduced in this solution. Only when a UE is in the area, it is allowed to send the event report.\nThe event report allowed area can be provided by UE or LCS Client/AF:\n-\tThe UE provided area is stored in UDM; and/or\n-\tThe LCS Client/AF can provide the event report allowed area in the LCS Service Request.\nIf GMLC receives both areas above, the overlap of the areas is the event report allowed area. If there is no overlap, the GMLC rejects the LCS Service Request. The GMLC is responsible to determine a TA/cell list based on the event report allowed area.\nNOTE:\tTo support power saving, the UE can set the event report allowed area to a small geographical area.\nThe event report allowed area determined by GMLC is sent to UE via the LCS Periodic-Triggered Invoke Request message. When the UE detects the trigger or periodic event happens, if the UE is in the event report allowed area, then it obtains location measurements, calculates the location estimate and sends the event report. Otherwise, the UE behaviours above are not performed to save power. If the time period to the last time that the UE sent the event report or to the time that the UE receives the LCS Periodic-Triggered Invoke Request message reaches a certain threshold (e.g. the maximum reporting time for area or motion event type, implementation dependent threshold for UE available or periodic event type), the UE initiates the cancellation procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.25.3\tProcedures",
                            "text_content": "The figure depicts a location verification system for a user equipment (UE) in a 5G network. It shows the UE's location based on the information it has received from the base station (gNB). The system uses a combination of signal strength, Doppler shift, and other factors to determine the UE's location. The figure also includes a legend to explain the different symbols used in the system.\nFigure 6.25.3.1-1: UE Provided Location Verification based on Obtained Information\n1.\tIf the UE has generated or updated the event report allowed area, the UE sends the event report allowed area to the AMF via UE Location Privacy Setting Request.\n2.\tThe AMF invokes a Nudm_ParameterProvision_Update service operation towards the UDM and the service operation carries the event report allowed area. The UDM stores or updates the event report allowed area in the UDR by invoking a Nudr_DM_Update (SUPI, Subscription Data) service operation accordingly.\n3.\tThe AMF responses to the UE via UE Location Privacy Setting Response.\nTo support the event report allowed area, the enhancements to the existing Initiation and Reporting of Location Events in clause 6.3.1 of TS 23.273 [5] are as follows:\n-\tStep 1a: LCS Client includes the event report allowed area in the LCS Service Request.\n-\tStep 1b: the event report allowed area is included in the Nnef_EventExposure_Subscribe Request and Ngmlc_Location_ProvideLocation Request.\n-\tStep 2: the event report allowed area is included in Nudm_SDM_Get Response.\nIf the event report allowed areas received in step 1 and step 2 are not overlapped, the GMLC rejects the location request, the left steps are skipped. Otherwise the event report allowed area is the overlapped area and enhancements to the left steps are as follows:\n-\tSteps 4, 5, 14 and 16 are enhanced to include the event report allowed area parameter. In step 4, the GMLC is responsible to determine the cell/TA list based on the overlapped area and include the cell/TA list in the event report allowed area.\n-\tStep 22: When UE detects the event happens, it further checks whether it is in the event report allowed area. If yes, the steps 23 to 30b-2 are performed. Otherwise, the steps 23 to 30b-2 are skipped.\nA new trigger is added for UE to cancel Reporting of Location Events procedure in clause 6.3.2 in TS 23.273 [5]:\n-\tIf the time period to the last time that the UE sent the event report or to the time that the UE receives the LCS Periodic-Triggered Invoke Request message reaches a certain threshold (e.g. the maximum reporting time for area or motion event type, implementation dependent threshold for UE available or periodic event type), the UE initiates the cancellation procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.25.4\tImpacts on services, entities, and interfaces",
                            "text_content": "GMLC:\n-\tReceive the event report allowed area from LCS Client/AF and/or UDM and decide the final event report allowed area based on the received area(s).\n-\tSend the event report allowed area to AMF.\nUDM:\n-\tReceive the event report allowed area from UE and store the parameter.\n-\tProvide the event report allowed area to GMLC.\nAMF: Receives the event report allowed area from GMLC and send the parameter to LMF.\nLMF: send the event report allowed area to UE.\nUE: Receive the event report allowed area from LMF and enforce the parameter.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.26\tSolution #26: LPHAP requirement awareness by LMF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.26.1\tIntroduction",
                            "text_content": "The solution addresses key issue #12, support of low power and/or high accuracy positioning. In particular, the issue \"whether new information is needed in subscription data for low power and/or high accuracy positioning\" is clarified its necessity.\nWhen RAN discussed low power and high accuracy positioning (LPHAP) in the workshop (RWS-210573), people believe the UE requiring low power and high accuracy positioning can be a new UE type, or based on Redcap UE or eMBB UE. It means low power and high accuracy positioning is not a \"label\" to differentiate UE, but actually a location service requirement for both UE impact and service performance.\nWith the introduction of LPHAP, location procedure in rel-18 needs to be enhanced to satisfy the requirement. In terms of \"HA(high accuracy\", currently it is identified by LCS QoS, and optionally provided by the LCS client/AF. If the LCS QoS is not provided, the LMF will treat the location request with a default accuracy.\nOn the other hand, LPHAP also reflects the expected UE impact when being positioned, i.e. low power consumption. LMF is responsible for positioning method selection. Usually UE-based positioning will consume more power than NW-based one. Therefore LMF should take into account the LPHAP requirement when determine the positioning method.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.2\tFunctional Description",
                            "text_content": "In UE LCS subscription data, it may include \"LPHAP indication\". During UE registration, AMF fetches the UE LCS subscription data to the LMF.\n-\tAMF includes the LPHAP indication to LMF when forwards the location request message.\n-\tAMF provisions RAN with LPHAP indication during UE registration procedure and/or LMF provides RAN with LPHAP indication during positioning procedure. This is used by RAN to determine positioning measurement method to the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.3\tProcedures",
                            "text_content": "The figure depicts a 26.3-1 LPHAP requirement awareness by LMF, highlighting the importance of this metric in the context of network management and performance monitoring.\nFigure 6.26.3-1: LPHAP requirement awareness by LMF\n1.\t(registration phase) UE sends requisition request message to AMF.\n2.\tAMF request UDM for UE subscriber data.\n3.\tUDM returns UE subscriber data including LCS relevant parameter, i.e. LPHAP indication.\n4.\tAMF sends the LPHAP indication to RAN in the UE context modification message.\n5.\t(Location procedure) LCS client sends location request to GMLC.\n6.\tGMLC forwards the location request to AMF.\n7.\tAMF sends location request to LMF including LPHAP indication.\n8.\tLMF determines suitable positioning method, by taking into account the LPHAP requirement.\n9.\tIf NW based is determined in step8, LMF sends the LPHAP indication to RAN, in the NRPPa message.\n10.\t(rest of the positioning procedure).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.4\tImpacts on services, entities, and interfaces",
                            "text_content": "UDM:\n-\tLPHAP indication in the UE LCS subscription data.\nAMF:\n-\tRetrieve from UDM LPHAP indication in the UE LCS subscription data.\n-\tProvides to LMF LPHAP indication, in the location request.\n-\tProvisions RAN with LPHAP indication.\nLMF:\n-\tReceive from AMF LPHAP indication in the location request.\n-\tDetermine positioning method, by taking into account the LPHAP requirement.\n-\tsends LPHAP indication to RAN.\nRAN:\n-\tReceive from AMF LPHAP indication in the UE registration procedure and based on it to determine the handling of NRPPa request from LMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.27\tSolution #27: Use Group Information to Correlate GMLC and LMF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.27.1\tIntroduction",
                            "text_content": "This solution addresses the key issue #3: Local Area Restriction for an LMF and GMLC. In this solution, the LMF discovery and selection mechanism by AMF is enhanced to use Group Information as a way to select a \"local LMF\" for local requests whose LMF should be \"local\".\nFor example, it may be desirable to handle location requests targeting a UE belonging to a factory by using a \"local\" LMF associated with the factory i.e. possibly hosted on the factory premises, allowing to keep information related with location of the factory users within entities controlled by the factory. Conversely, the location of UE, not members of the factory (users passing by near or within the factory but not members of the factory staff), should not be handled by LMF resources of the factory.\nAnother example is the ProSe [19]/Ranging services within the local area, after discovery process, the group information can be exposed to AS/AF through PC1/SR1 interface. Based on the information exposed, AS/AF can update the group and its member information by group management through NEF according to TS 23.501 [2]. When the group information has been aligned, AS/AF can use the group parameter in LCS request to the paired GMLC and LMF in the local area.\nThe group information may be transferred directly from AF/LCS Client or derived from the LCS request by AMF. With the group information, which shows the location service requires a local LMF, AMF select a local LMF.\nGMLC/NEF may derive group information from the attributes in the request; when the slice information is correlated to the group communication, AMF may derive the group information from the slice information of the UE.\nSuch information can also be used by LMF to select GMLC of the same area to perform event/periodic reporting.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.27.2\tFunctional Description",
                            "text_content": "AF/LCS Client Provides Group Parameter\nAF/LCS Client issues LCS request through NEF or GMLC. It may provide an external group ID in the location request as a parameter for LMF selection by AMF.\nNOTE:\tDetailed definition and/or parameters of group information can be decided during normative phase and/or stage 3 process.\nGMLC/NEF Forwards or Derives Group Information\nGMLC and NEF can forward the group information from LCS Client/AF to AMF.\nGMLC and NEF can also derive the group information from following parameters in the LCS request:\n-\tGroup id (ExternalGroupId from AF/LCS Client) may be transferred to AMF through GMLC/NEF (using e.g. Ngmlc_Location_ProvideLocation service operation defined in clause 8.4.2 of TS 23.273 [5]), as a complementary information to the UE ID.\n-\tThe ServiceIdentity/Serviceid/svcId in the request from AF/LCS Client. When it is the local service in the local area, NEF or GMLC can derive the group information from the AF/LCS Client information from the request (e.g. LCS Client Identification or ServiceIdentity/Serviceid in Ngmlc_Location_ProvideLocation service operation defined in clause 8.4.2 of TS 23.273 [5] or \"svcId\" in MonitoringEventSubscription of TS 29.522 [24]) and forward the derived target group information to AMF.\n-\tA local (corporate or local service related) GMLC instance may be configured to always add a Group attribute in the LCs requests sent to the AMF\n-\tIn some cases (like NI-LR), NEF or GMLC may know the serving TAI/NCGI when receiving the LCS request, and can derive the area information where the GMLC/LMF correlation should be performed. The local group information can be derived independently or can also be queried from UDM.\n-\tThrough AF/AS(LCS Client) profile which can be derived by client connection, GMLC/NEF may be aware all the requests from such clients should be restricted to the area. The group information of the area can be attached before the request forwarded to AMF.\nThrough above information, GMLC/NEF can instruct AMF to perform the LMF selection logic of the same area.\nAMF Selection Logic with Group and/or Slice Information\nThe AMF may use group information received in a location request to select the LMF.\nSince slicing information is already defined as NF related NRF registration and discovery information, when dedicated slices allocated to the service area and LMF profile in NRF has configured same area (which could be used to drive such GMLC/LMF correlation), AMF could also lookup the LMF instance through the slice information to ensure the LMF of the specific area/service is chosen.\nFor the serving TAI/NCGI in the area where the GMLC/LMF correlation should be performed. The local group information can be derived or can be queried from UDM.\nLMF Registration to NRF\n-\tThe Group ID is added to LMF related NRF registration and discovery Information.\n-\tBased on multiple trigger criteria, the AMF determines whether a group is to be related with a LCS request, and uses this information to select the proper LMF.\nLMF Selection of GMLC in Event/Periodic Reporting\nWhen selected, LMF receives the group information from the AMF LCS request. The group information is used in GMLC selection in case of event/periodic report in deferred location process:\n-\tLMF may be configured with local GMLC address when area correlation is used in the location request.\n-\tLMF may use the group service area to derive the GMLC address for event/periodic reporting, and/or verify the GMLC address in the request and decides accordingly with implementation logic.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.27.3\tProcedures",
                            "text_content": "LMF selection based on group information is a crucial aspect of network management, as it determines the optimal path for data transmission. In this figure, we see a network with multiple paths, each represented by a different color. The selection of the path is based on the group information, which is a measure of the network's capacity and reliability. This helps in optimizing the network's performance and ensuring data transmission reliability.\nFigure 6.27.3-1: LMF selection based on group information\nStep 1:\tMT-LR procedure started as defined in TS 23.273 [5]. The service uses local GMLC (or through NEF). AF/LCS Client may take group information in the request parameters.\nStep 2:\tLocal GMLC may use the group information in the request or derive the group information from the context or parameters of the request.\nStep 3:\tAMF receives the request.\nStep 3.1:\tFor local/edge service, AMF could also use the slice information to select/lookup LMF instance (from NRF).\nSteps 4~6:\tLMF performs the LCS session.\nStep 7:\tLMF select the paired GMLC for reporting. When multiple criteria exist, the GMLC selection logic is implementation specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.27.4\tImpacts on services, entities, and interfaces",
                            "text_content": "AS/AF/LCS Client:\n-\tmay provide group information in an LCS request.\nGMLC/NEF:\n-\tMay propagate group information received from AS/AF/LCS Client or may determine group information based on the received location request.\nAMF:\n-\tSelect the LMF according to the group information received from the GMLC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.28\tSolution #28: Support of PRUs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.28.1\tIntroduction",
                            "text_content": "This solution addresses KI#7 - support of Positioning Reference Units (PRUs) according to the definition in TS 38.305 [6] which is as follows:\n\n\nThe definition shows that a PRU can be a supported as a UE since positioning measurements and SRS transmission can correspond to what is defined for a UE.\nThe main principles of this solution are as follows:\n1.\tTreat PRUs the same as normal UEs from an architectural perspective.\n2.\tAvoid impacting an AMF, NG RAN node, UDM or any existing non-eLCS interface or reference point.\n3.\tMake use of a Supplementary Service protocol (e.g. the protocol defined in TS 24.080 [21]) to enable interaction between a PRU and an LMF that is transparent to other entities.\nNOTE:\tIt is assumed that a PRU can only operate when in coverage of the PLMN to which it belongs or with which it is associated.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.28.2\tFunctional Description",
                            "text_content": "The non-roaming reference architecture shown in Figure 4.2.1-1 in TS 23.273 [5] is modified as shown in Figure 6.28.2.1-1 to support a PRU.\nThe figure depicts a non-roaming reference architecture for a Personalized Radio Unit (PRU) in a 28 GHz frequency band. The architecture includes a Non-Line Switching Unit (NLSU), a Personalized Radio Unit (PRU), and a Personalized Radio Unit (PRU) for each user. The PRU is designed to provide personalized radio services, including voice, data, and multimedia services. The architecture is designed to support multiple users and ensure seamless communication.\nFigure 6.28.2.1-1: Non-roaming reference architecture for a PRU\nA PRU interacts with an LMF using the protocol layering shown in Figure 6.28.2.2-1. This is the same protocol layering defined in clause 6.4.1 of TS 38.305 [6] for LMF to UE interaction except for allowing a supplementary services protocol and other positioning protocols besides LPP to be used between an LMF and a PRU at the top level.\nThe figure depicts a protocol layering diagram for LMF to PRU signalling, illustrating the various layers and their interactions. The diagram includes the protocol, the signaling, and the control layers, with the protocol layer at the top and the control layer at the bottom. The layers are interconnected through the signaling layer, which is responsible for transmitting the protocol commands to the PRU. The diagram also shows the communication paths between the layers, with the control layer at the bottom and the signaling layer at the top. The figure is a visual representation of the layered architecture of the LMF to PRU signalling protocol, providing a clear understanding of the communication flow and the interconnections between the different components.\nFigure 6.28.2.2-1: Protocol Layering for LMF to PRU Signalling\nThe top protocol layer between the PRU and the LMF is a supplementary services protocol (e.g. as defined in TS 24.080 [21]) or a positioning protocol (e.g. LPP).\nA PRU can be registered with more than one LMF to enable multiple LMFs to obtain location related information from or for the PRU. This is no different to a normal target UE being positioned by different LMFs (e.g. at the same time or at different times). A PRU may be configured with a limit on the number of LMFs that it is allowed to register with. When a PRU receives a conflicting location related request from an LMF (e.g. a request to obtain measurements at the same time as obtaining measurements for another LMF), the PRU can reject the request. The sharing of a PRU by several LMFs might occur in a border area between areas supported by the different LMFs.\nPRU registration in more than one LMF can be avoided or reduced if PRUs are deployed to support only one LMF or if multiple LMF registration is restricted to just a small fraction of PRUs located in border areas shared by two or more LMFs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.28.3\tProcedures",
                            "text_content": "Figure 6.28.3.1-1 shows a registration procedure used by a PRU to register with an LMF. The procedure is used for initial registration when a PRU first starts to access its associated PLMN - e.g. following an initial deployment and initial power on. The procedure can also be used subsequently to perform a registration update to inform the LMF of the continued availability of the PRU or to inform the LMF of some change to the PRU such as a change of location (e.g. a change of tracking area or change of serving AMF) or change of the PRU positioning capabilities.\nThe figure depicts a registration procedure for a PRU, which is a key component in a 5G network. The PRU is responsible for receiving and processing radio signals, ensuring they are correctly registered and transmitted to the appropriate network nodes. The figure illustrates the process with a step-by-step guide, including the use of a registration table, which is a crucial step in the PRU's operation.\nFigure 6.28.3.1-1: Registration Procedure for a PRU\nPrecondition:\nFor initial Registration, a Routing Identifier has been configured in the PRU indicating an LMF. For subsequent Registration, a Routing ID indicating an LMF has been returned to the PRU at step 6a or 6b of a previous Registration.\nNOTE 1:\tA Correlation ID and a Routing ID are different terms for the same identifier. The term \"Correlation ID\" is used for an identifier in NL1 service operations between an AMF and LMF while the term \"Routing ID\" is used for an identifier in a NAS message sent over the N1 reference point between a PRU and AMF.\n1.\tThe PRU performs a UE Triggered Service Request if in CM IDLE state.\n2.\tThe PRU sends a supplementary services Registration Request to the serving AMF in an UL NAS TRANSPORT message and includes the preconfigured Routing ID for an initial Registration or the Routing ID received at step 6a or step 6b for the previous Registration. The Registration Request is included in the UL NAS TRANSPORT message as a \"Location services message container\" at the NAS level which means that an AMF can transfer the message to the LMF at step 3 without a new AMF impact. The Registration Request may include an identity for the PRU (e.g. a SUPI, a PEI or a serial number), a reason for the Registration (e.g. initial Registration, a Registration update, a manually invoked Registration), a location of the PRU if available, optional authentication information, a type of PRU (e.g. whether the PRU is fixed or mobile) and capabilities of the PRU. The capabilities can include capabilities to perform positioning activities associated with a UE. Capabilities to perform positioning activities associated with a UE may be indicated by including one or more embedded LPP messages as defined in TS 37.355 [15] in the Registration Request.\n3.\tThe AMF selects an LMF based on the Routing ID and transfers the Registration Request to the LMF. The LMF may be selected based on the Routing ID and the current TAI and/or CGI for the PRU.\nNOTE 2:\tThe AMF sees the PRU as just a normal UE. However, an operator can assign reserved Routing IDs to a PRU different to Routing IDs used for other UEs. For example, all PRUs might be configured with a Routing ID A. The operator can then configure this Routing ID in an AMF such that the AMF selects a preferred LMF for Routing ID A. This may not require any new functionality in an AMF.\n4.\tThe LMF authenticates the PRU and verifies that it is a legitimate for this PLMN. This may use one of the following methods.\nMethod A:\nThe AMF includes the SUPI of the PRU at step 3 and the LMF verifies that the SUPI matches a SUPI of a legitimate PRU configured in the LMF.\nMethod B:\nThe PRU includes an identification and authentication information at step 2 which the LMF verifies against expected authentication information configured in the LMF for a PRU with this identification. The authentication information might include a ciphering of the PRU identity and/or a current date and time (e.g. UTC) based on a private key stored in secure memory of the PRU.\nMethod C:\nThe LMF sends an authentication challenge to the PRU via the AMF as a DL supplementary services message and receives an authentication response from the PRU sent as an UL supplementary services message, where the authentication response is based on a private ciphering key held in secure memory in the PRU. If the LMF is able to store/update PRU information in other LMFs, the serving LMF need not provide Routing IDs for additional LMFs to the UE.\n5a.\tIf the LMF is able to authenticate the PRU at step 4 and can accept the Registration, the LMF returns a Registration Response to the serving AMF as a location services supplementary services message and includes a Correlation ID. The Correlation ID is assigned by the LMF to identify the LMF and the PRU. The Registration Response may indicate conditions for performing another Registration with the LMF (e.g. a periodic Registration timer or Registration based on a change of location, change of TAI or change of serving AMF for the PRU). The Registration Response may also provide Routing IDs for additional LMFs with each of which the PRU shall perform a separate Registration.\nNOTE 3:\tA PRU may be fixed, with re-Registration of the PRU only needed at long periodic intervals. A PRU could instead be mobile (e.g. attached to a vehicle), with re-Registration then minimally needed whenever the serving AMF changes to enable the LMF to reach the PRU for the procedures in clause 6.28.3.2 and 6.28.3.3. If the LMF selected by the new AMF then changes, the previous LMF would discover this from an error response from the previous AMF when instigating the procedure in clause 6.28.3.2 or clause 6.28.3.3.\nNOTE 4:\tProvision of additional LMFs at step 5a can be implementation and operator dependent. As one example, if a PRU is located in an area supported by both the LMF and one or more other LMFs, the LMF may provide indications of the other LMFs to the PRU.\n6a.\tThe serving AMF forwards the Registration Response and a Routing ID equal to the Correlation ID to the PRU. The PRU stores the Routing ID which is used for any repeated Registration with this LMF. If Routing IDs for other LMFs are included in the Registration Response, the PRU performs a Registration with each of these LMFs.\n5b.\tIf the LMF is unable to authenticate the PRU at step 4 or cannot accept the Registration for some other reason (e.g. the LMF is the wrong LMF), the LMF sends a Registration Reject to the serving AMF and may include the Routing ID of another LMF with which the PRU shall perform a Registration.\n6b.\tThe serving AMF forwards the Registration Reject to the PRU. If a Routing ID is included, the PRU performs a Registration with the LMF associated with this Routing ID.\nNOTE 5:\tThe PRU may be configured with a limit on the number or duration of Registration attempts performed unsuccessfully. When this limit is reached, the PRU may send an indication to some entity in the PLMN. The indication might be a text message or an HTTPS message, for example.\n7.\tIf Registration is performed successfully as in steps 5a and 6a, the LMF may optionally instigate positioning procedures for the PRU as described in clause 6.28.3.3. For example, the positioning procedures may be used to obtain or verify a location of the PRU or obtain the positioning capabilities of the PRU. The LMF also stores information for the PRU including the PRU identity, the Correlation ID assigned at step 5a and the serving AMF instance.\nNOTE 6:\tPositioning at step 7 may be performed prior to step 5 as an option - e.g. if PRU location needs to be verified before accepting the Registration.\nFigure 6.28.3.2-1 shows a Registration Modification procedure used by an LMF to change the Registration status of a PRU. The change in status can include deregistering the PRU, changing the conditions for sending Registration updates by the PRU or requesting the PRU to register with additional LMFs.\nThe figure depicts a registration modification procedure for a PRU, which is a key component in a 5G network. The PRU is responsible for receiving and processing radio signals, ensuring they are correctly registered and transmitted. The figure shows the step-by-step process, including the use of a registration table, which is a crucial part of the PRU's functionality. The figure also highlights the importance of proper communication between the PRU and the base station (gNB) to ensure reliable communication.\nFigure 6.28.3.2-1: Registration Modification Procedure for a PRU\nPrecondition:\nThe PRU has previously successfully registered with the LMF using the procedure in clause 6.28.3.1.\n1.\tThe LMF sends a Registration Modification to the serving AMF as a location services supplementary services message and includes the identity of the PRU (e.g. the SUPI) and a Correlation ID identifying the LMF and the PRU. The Registration Modification may indicate to the PRU new conditions for performing Registration updates with the LMF (e.g. a periodic Registration timer or Registration based on a change of location for the PRU). The Registration Modification may also provide Routing IDs for other LMFs with each of which the PRU shall perform a separate Registration. The Registration Modification may further indicate a deregistration of the PRU with the LMF.\n2.\tIf the PRU is in CM IDLE state, the serving AMF performs a Network Triggered service request to place the PRU in CM CONNECTED state.\n3.\tThe serving AMF forwards the Registration Modification and a Routing ID equal to the Correlation ID to the PRU.\n4.\tThe PRU returns a supplementary services Registration Modification response to the serving AMF in an UL NAS TRANSPORT message and includes the Routing ID received in step 3. The Registration Modification response confirms receipt of the information in the Registration Modification at step 3.\n5.\tThe serving AMF forwards the Registration Modification response to the LMF indicated by the Routing ID received at step 4 and includes a Correlation ID equal to the Routing ID.\nFigure 6.28.3.3-1 shows a positioning procedure used by an LMF to obtain location related information from or for a PRU.\nThe figure depicts a positioning procedure for a Positioning Reference Unit (PRU) in a 28 GHz frequency band. The PRU is a key component in a 5G network, responsible for determining the position of the transmitter and receiver. The figure illustrates the steps involved in positioning, including the use of a 3D antenna array, which is crucial for accurate positioning. The positioning procedure is crucial for ensuring reliable communication in a 5G network, as it helps to ensure the correct location of the transmitter and receiver.\nFigure 6.28.3.3-1: Positioning Procedure for a PRU\nPrecondition:\nThe PRU has successfully registered with the LMF using the procedure in clause 6.28.3.1.\n1.\tThe LMF may use the UE Assisted and UE Based Positioning Procedure defined in clause 6.11.1 of TS 23.273 [5] to request positioning capabilities from, provide assistance data to or request location measurements from a PRU when functioning as a target UE. The LMF can access the PRU through the serving AMF identified during Registration.\n2.\tThe LMF may use the Network Assisted Positioning Procedure defined in clause 6.11.2 of TS 23.273 [5] to send or request location information related to the PRU to or from the serving NG-RAN node for the PRU. The LMF can access the NG-RAN through the serving AMF identified during Registration.\n3.\tThe LMF may use the Obtaining Non-UE Associated Network Assistance Data procedure defined in clause 6.11.3 of TS 23.273 [5] to send or request location information related to the PRU to or from one or more NG-RAN nodes. The LMF can access the NG-RAN nodes through the serving AMF identified during Registration.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.28.4\tImpacts on services, entities, and interfaces",
                            "text_content": "PRU:\n-\tSupport Registration and Registration Modification Procedures.\nLMF:\n-\tSupport Registration and Registration Modification Procedures for a PRU.\nAMF:\n-\tno impact.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.29\tSolution #29: Use PRU in 5G LCS Procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.29.1\tIntroduction",
                            "text_content": "This solution addresses KI#7, support of Positioning Reference Units and Reference UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.29.2\tFunctional Description",
                            "text_content": "PRU can claims its location or capabilities' attributes during registration process, whether it is static or mobile; these attributes can also be provisioned by OAM so that 5GC components can fetch the information using its identity.\n-\tThe location and capabilities of static PRU can either be claimed by itself in the registration phase or provisioned by OAM.\n-\tThe initial location and capabilities of mobile PRU can be identified in same way as static PRU in registration attributes or from OAM; it can also be identified in LPP by triggering an NI-LR process during the registration phase.\nLMF may perform the positioning procedures to PRU during the positioning process of target UE. But LMF may not always use PRU. It depends on the positioning request (QoS requirements, etc), environment profile or UE positioning capabilities and measurements. LMF takes the decision to use PRU and perform the query/discovery process of available/useful PRU instances.\nAnd there is no conclusion that LCS providers want to use full PRU capabilities to all LCS requests of all UEs. So, PRU usage is decided and its information is needed during the request procedures. They are on the request level instead of subscription level.\nFor request level information, GMLC is the legacy portal for all LCS related queries. For future flexibility, GMLC performs the storage and query/discovery procedures of PRUs.\nGMLC can provides different PRU features to different client profiles and/or request attributes. PRU capabilities can be discovered differently according to different deployment or LCS provider policies.\nPRU information includes the following attributes stored in GMLC to be discovered/queried:\n1.\tPRU location information and its mobility and static attributes.\n2.\tPRU capability and optionally, some measurements which don't change for different target UE transactions, like TA value of static PRU against static TRP.\n3.\tServing AMF and LMF instance of the PRU.\nDue to different LMF selection criteria in clause 5.1 of TS 23.273 [5] and solution to KI#3. When positioning procedures include both target UE and PRU, the serving LMF for UE and PRU may not be the same LMF instance. This solution provides inter-LMF communications.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.29.3\tProcedures",
                            "text_content": "The figure depicts the PRU information update procedure, which is a crucial component of a 5G network. It illustrates the steps taken by the PRU to collect and update the status of the network. The figure shows the PRU's role in ensuring the network's reliability and performance.\nFigure 6.29.3.1-1: PRU information update procedure\nStep 1:\tPRU performs registration. The registration may contain PRU attributes (including location estimate, capabilities).\nStep 2:\tAMF select LMF instance based on PRU attributes or other criteria. If PRU attributes are available, they are forwarded to LMF.\nStep 3:\tWhen necessary PRU attributes are missing, LMF perform LCS procedures to PRU to fetch these attributes.\nStep 4:\tLMF may notify GMLC directly with PRU information or indirectly through AMF.\nOption a:\tIf PRU takes GMLC address in registration, LMF gets the information from AMF or LMF can derive GMLC address, the GMLC address can be used directly to send Nlmf_Location_EventNotify with PRU information to GMLC.\nOption b:\tLMF may use AMF to forward the PRU information to GMLC. AMF may derive the GMLC address.\nNOTE 1:\tNlmf_Location_DetermineLocation response takes not only location result, but also additional information of PRU.\nNOTE 2:\tAMF selection of LMF, LMF/AMF selection of GMLC could be implementation specific.\n\nThe figure depicts a positioning procedure with a Positioning Reference Unit (PRU) in a 5G network. The PRU is used to determine the position of the receiver, which is crucial for accurate signal transmission. The figure shows the PRU's position relative to the base station (gNB) and the receiver, and the steps involved in positioning the receiver.\nFigure 6.29.3.2-1: Positioning procedure with PRU\nStep 1:\tLCS NI-LR, MO-LR or MT-LR as defined in TS 23.273 [5].\nStep 2:\tRequest arrives to serving LMF of UE.\nSteps 3.1~3.2:\tLMF may decide to use PRU before/during/after positioning procedure of target UE.\nStep 3.3:\tLMF queries the GMLC for PRU discovery. It may use the target UE information or serving TAI/NCGI information as discovery parameters. LMF may get the GMLC information of the PRU by following ways.\n-\tLMF could query NRF using serving TAI/NCGI of target UE.\n-\tLMF could get the serving GMLC if they are correlated as per solutions of KI#3 of certain local area.\n-\tLMF may use implementation specific methods to get GMLC instance.\nStep 3.4:\tBased on PRU capabilities, with AMF information of PRU attributes, LMF for target UE sends request to serving AMF of PRU with requested positioning information of PRU.\nNOTE 1:\tWith implementation specific policy, the serving LMF of PRU during its registration phase can be used. In this case, LMF for target UE should still send the request through AMF in case PRU is in CM-IDLE/RRC-INACTIVE state.\nSteps 3.5~3.7:\tServing LMF of PRU performs the requested procedures and replies the necessary information back to the serving LMF of target UE.\nNOTE 2:\tDifferent PRU may use different LMF instances. The LMF instance decided by serving AMF may not be same as serving LMF during the registration phase.\nStep 3.8:\tLMF for target UE may use the result from PRU session to optimize its positioning procedures.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.29.4\tImpacts on services, entities, and interfaces",
                            "text_content": "AMF: Notify PRU info to GMLC.\nGMLC:\n-\tReceive PRU info from AMF or LMF.\n-\tProvide PRU info to LMF based on request from LMF.\nLMF:\n-\tNotify PRU info to GMLC.\n-\tRequest PRU info from GMLC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.30\tSolution #30: location service continuity for UE moves between NG-RAN nodes",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.30.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #8, mainly focus on the deferred 5GC-MT-LR Procedure for Periodic, Triggered and UE Available Location Events procedure and the location service continuity for UE moves between NG-RAN nodes.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.30.2\tFunctional description",
                            "text_content": "The procedures in clause 6.30.3.1~6.30.3.3 are used for the location service continuity for UE moves between NG-RAN nodes, under the following mobility cases:\n-\tMoving in RRC-inactive for UL and DL positioning: with anchor NG-RAN relocation, target NG-RAN acquire the positioning related information via the retrieve UE context message, target NG-RAN update the positioning related configuration and sends the latest configuration to LMF. AMF or old LMF determines whether need trigger the LMF change procedure and enable the latest configuration reach to the correct LMF. After handover complete, AMF notify LMF the target cell ID and/or the target NG-RAN ID, based on that information, LMF configures the selected neighbour NG-RANs with the latest configuration.\n-\tMoving in CM-connected with RRC-connected for UL and DL positioning: during the handover preparation phase, source NG-RAN sends the positioning related information to target NG-RAN via the handover message, target NG-RAN updates the positioning related configuration and sends the latest configuration to LMF. AMF or old LMF determine whether need trigger the LMF change procedure and enable the latest configuration reach to the correct LMF. AMF notify LMF the target cell ID and/or the target NG-RAN ID, based on that information, LMF configures the selected neighbour NG-RANs with the latest configuration.\nNOTE:\tRAN WG coordination is needed.\n-\tMoving in CM-IDLE: during the registration procedure, after new AMF receive the UE context information from old AMF, if AMF finds UE has positioning related information, AMF sends the new AMF instance ID to LMF via the next periodical N1messageNotify.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.30.3\tProcedures",
                            "text_content": "The figure depicts a location service continuity for an UE moving in a RRC-inactive area, highlighting the importance of maintaining reliable communication in such scenarios.\nFigure 6.30.3.1-1: Location Service Continuity for UE moves in RRC-inactive\n1.\tDeferred 5GC-MT-LR for periodic, triggered and UE available location events procedure, as defined in steps 1~21 in clause 6.3.1 of TS 23.273 [5].\n2~4.\tUE in RRC-inactive sate and finds event is triggered, UE sends the RRC Resume to target NG-RAN.\n5.\tWith anchor NG-RAN relocation, target NG-RAN acquire the old LMF ID and the positioning related information (based on the RAN 17 conclusion, see clause 9.2.1.13 and clause 9.2.3.168 of TS 38.423 [25]), target NG-RAN update the positioning configuration (e.g. SRS configuration) based on the positioning related information (e.g. the requested SRS Transmission Characteristics).\n6.\tTarget NG-RAN sends the N2 Path Switch Request to AMF, based on the UE location information (i.e. the ULI in path switch request), either AMF or old LMF can determine whether LMF need change (i.e. clause 6.4 of TS 23.273 [5]), if AMF determine LMF change, steps 7~15 are performed and steps 16~23 are skipped, after LMF change complete, the AMF need store the mapping relationship between the source LMF ID and the new LMF ID. Otherwise, if old LMF determine LMF change, steps 7~15 are skipped and steps 16~23 are performed.\nIf AMF determine the LMF change (i.e. as described in TS 23.273, clause 6.4, step 4~7), the following steps 7~15 are performed and steps 16~23 are skipped.\nNOTE 1:\tNo sequence restrict for step 7 and step 8, step 7 and step 8 may perform in parallel.\n8~9.\tTarget NG-RAN invokes the Uplink UE associated NRPPa transport message to AMF, includes the routing ID (i.e. the old LMF ID), the NRPPa PDU (i.e. the Positioning Information Update (includes the positioning configuration)).\n10.\tIf AMF finds the LMF is changed, the AMF determine the source LMF ID corresponding new LMF ID, then sends the NRPPa PDU to the new LMF.\n11.\tAMF invokes Namf_Communication_N2InfoNotify to new LMF, includes the NRPPa PDU (e.g. the update positioning configuration), the NG-RAN node ID and/or the target cell ID, the handover complete notification.\n12.\tThe new LMF invokes the Namf_Communication_N1N2MessageTransfer to AMF, includes the NRPPa PDU (e.g. the Positioning Information Activation), the LCS correlation ID.\n13.\tAfter receive the Namf_Communication_N1N2MessageTransfer from new LMF, the AMF invokes Downlink UE associated NRPPa transport message to target NG-RAN, includes the new LMF ID, the indication to indicates a change of LMF.\n14.\tBased on the handover complete notification and the target cell ID and/or the target NG-RAN node ID, the new LMF configure the selected neighbour NG-RAN nodes with the latest positioning configuration.\nNOTE 2:\tNo sequence restrict for steps 12~15 and step 14, steps 12~15 and step 14 may perform in parallel.\n15.\tThe target NG-RAN update the LMF ID.\nIf old LMF determines the LMF change (i.e. as described in step 4~7 in clause 6.4 of TS 23.273 [5]), the following steps 16~23 are performed and steps 7~15 are skipped.\n17.\tTarget NG-RAN invokes the Uplink UE associated NRPPa transport message to AMF, includes the routing ID (i.e. the old LMF ID), the NRPPa PDU (i.e. the Positioning Information Update (includes the positioning configuration)).\n18.\tThe AMF invokes Namf_Communication_N2InfoNotify to new LMF, includes the NRPPa PDU (e.g. the update positioning configuration), the NG-RAN node ID and/or the target cell ID, the handover complete notification.\n20.\tThe new LMF invokes the Namf_Communication_N1N2MessageTransfer from new LMF, includes the new LMF ID, the indication to indicate a change of LMF.\n21.\tThe AMF invokes Downlink UE associated NRPPa transport message to target NG-RAN, includes the new LMF ID, the indication to indicates a change of LMF.22. Based on the handover complete notification and the target cell ID and/or the target NG-RAN node ID, the new LMF configure the selected neighbour NG-RAN nodes with the latest positioning configuration.\n23.\tThe target NG-RAN update the LMF ID.\nNOTE 3:\tNo sequence restrict for step 22 and steps 20~23, step 22 and steps 2-~23 may perform in parallel.\nThe figure depicts a location service continuity for an UE moving in a CM-connected network with a RRC-connected-Xn handover. The continuity is achieved through the use of a handover mechanism, which ensures that the UE can continue to receive location services even if the RRC-connected-Xn node is unavailable. The figure illustrates the handover process, including the handover request, the handover decision, and the handover execution.\nFigure 6.30.3.2.1-1: Location Service Continuity for UE moves in CM-connected with RRC-connected-Xn handover\n1.\tDeferred 5GC-MT-LR for periodic, triggered and UE available location events procedure, as defined in steps 1~21 in clause 6.3.1 of TS  23.273 [5].\n2~4.\tTarget NG-RAN acquire the old LMF ID and the positioning related information (e.g. via the handover request message), target NG-RAN update the positioning configuration based on the positioning related information and sends the update positioning configuration to UE.5. Target NG-RAN sends the N2 Path Switch Request to AMF, based on clause 6.4 of TS 23.273 [5], either AMF or old LMF can determine whether LMF need change, if AMF determine LMF change, steps 6~14 are performed and steps 15~19 are skipped, if old LMF determine LMF change, steps 6~14 are skipped and steps 15~19 are performed.\n6~14.\tSame as steps 7~19 as described in clause 6.30.3.1.\n15~19.\tSame as steps 16~23 as described in clause 6.30.3.1.\nThe figure depicts a location service continuity for an UE moving in a CM-connected network with a RRC connected-N2 handover. The continuity is ensured by the use of a location service, which provides a reliable path for the UE to move between different locations. The figure also shows the handover process, which involves the RRC connecting to the N2 network and the UE moving to a new location.\nFigure 6.30.3.2.2-2: Location Service Continuity for UE moves in CM-connected with RRC connected-N2 handover\n1.\tDeferred 5GC-MT-LR for periodic, triggered and UE available location events procedure, as defined in steps 1~21 in clause 6.3.1 of TS  23.273 [5].\n2~4.\tTarget NG-RAN acquire the old LMF ID and the positioning related information (e.g. via the handover required and handover request message), target NG-RAN update the positioning configuration based on the positioning related information and sends the update positioning configuration to UE.5. Target NG-RAN sends the Handover Notify to AMF, based on clause 6.4 of TS 23.273 [5], either AMF or old LMF can determine whether LMF need change, if AMF determine LMF change, steps 6~14 are performed and steps 15~19 are skipped, if old LMF determine LMF change, steps 6~14 are skipped and steps 15~19 are performed.\nNOTE\tThe AMF in figure 6.30.3.2.2-2 can be referred to the T-AMF, i.e. T-AMF determines whether the LMF need change based on the ULI (i.e. the target cell ID) included in handover notify message.\n6~13.\tSame as steps 7~15 as described in clause 6.30.3.1.\n14~17.\tSame as steps 16~23 as described in clause 6.30.3.1.\nThe figure depicts a location service continuity for UE moves in CM-IDLE, illustrating the various locations where the UE can move to maintain service continuity. The figure includes different locations such as CM-IDLE, CM-IDLE-1, CM-IDLE-2, and CM-IDLE-3, each with their respective locations and service continuity status. The figure also includes a legend to help users understand the different locations and their corresponding service continuity status.\nFigure 6.30.3.3-1: Location Service Continuity for UE moves in CM-IDLE\n1.\tDeferred 5GC-MT-LR for periodic, triggered and UE available location events procedure, as defined in steps 1~21 in clause 6.3.1 of TS 23.273 [5].\n2.\tPeriodic event triggered, UE sends the event report to 5GC, as described in steps 22~30 in clause 6.3.1 of TS 23.273 [5].\n3.\tBefore next time periodic event triggered, UE may go to CM-IDLE state.\n4~8.\tAs UE moving, registration procedure may performed, as defined in steps 1~5 in clause 4.2.2.2.2 of TS 23.502 [3].\n9.\tAfter retrieve the UE context information, if AMF finds UE has positioning related information (i.e. if AMF has stored the periodic/deferred location service context), AMF sends the new AMF instance ID to LMF, e.g. via the next periodical N1messageNotify in step 12.\n10~11.\tSame as steps 22~25 as defined in clause 6.3.1 of TS 23.273 [5].\n12.\tAMF sends the Namf_N1MessageNotify to LMF, includes the new AMF instance ID, based on the received message, the LMF update the location context, i.e. substitute the old AMF instance ID to the new AMF instance ID.\n13.\tSame as steps 26~30 in clause 6.3.1 of TS 23.273 [5].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.30.4\tImpacts on services, entities, and interfaces",
                            "text_content": "NG-RAN:\n-\texchange the positioning related information and positioning related configuration during the handover preparation phase.\n-\tAfter positioning configuration update, trigger to sends the latest positioning configuration to LMF.\nLMF:\n-\tAfter receive the positioning configuration and the target cell ID/target NG-RAN node ID, select and configure the candidate neighbour NG-RAN with the latest positioning configuration.\n-\tIf LMF determine the LMF change, the new LMF invokes the Namf_Communication_N1N2MessageTransfer to AMF, includes the new LMF ID, the indication to indicate a change of LMF.\nAMF:\n-\tAfter receive the Uplink UE associated NRPPa transport, if UE has positioning related information and if AMF is changed, indicates the new AMF instance ID to LMF.- After retrieve the UE context information, if UE has positioning related information and if LMF is changed, map the source LMF ID to the new LMF ID and sends the NRPPa PDU to the new LMF.\n-\tAfter handover complete, notify LMF the target cell ID and/or the target NG-RAN node ID.\n-\tAfter receive downlink UE associated NRPPa transport, notify the new LMF ID and the LMF change indication to NG-RAN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.31\tSolution #31: location service continuity between EPS and 5GS (bi-direction)",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.31.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #8, mainly focus on the location service continuity between EPS and 5GS (bi-direction).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.31.2\tFunctional description",
                            "text_content": "This solution include following procedures:\n-\tLocation service continuity from 5GS to EPS:\nDuring periodic location service triggered, if AMF/LMF finds the UE reporting type includes \"EUTRAN\" and if the required \"LCS QoS class\" is \"multiple QoS class\", the AMF/LMF determines the corresponding location QoS can be applicable to EPS, e.g. AMF or LMF map the QoS class to \"Best Effort\" and choose the most stringent value from the \"LocationQoS\" as the QoS requirement, LMF sends these parameters to UE and AMF if AMF does not determine the location QoS applicable to EPS.\nAfter receive the handover required, if AMF finds UE can support interworking between 5GS and EPS, AMF sends the 5GS location QoS corresponding EPS location QoS to GMLC.\nAfter handover complete, if UE finds periodical event is triggered and if UE finds it has moved to EPS, the UE sends LCS MO-LR Invoke message, carry the location QoS can be applicable to EPS.\n-\tLocation service continuity from EPS to 5GS:\nAfter receive the handover required message, if MME finds UE has positioning related information, MME trigger to send the handover to 5GC notification to GMLC.\nAfter handover complete, if UE finds periodical event is triggered and if UE finds it has moved to 5GS, UE sends event report message to 5GS.\nNOTE 1:\tIf UE finds handover is not complete but the event is triggered, UE need wait handover complete to sends the event report message in 5GS or sends the LCS MO-LR Invoke message in EPS.\nNOTE 2:\tThe procedures can be applied to all types of Location service. For deferred/periodic MT-LR, the core network also need coordinate with UE to enable UE sends the suitable signalling message and carry the suitable location QoS after the location event is triggered.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.31.3\tArchitecture Assumption",
                            "text_content": "It is assumed to use the co-located GMLC.\nThe figure depicts a simplified architecture of a 31.3-1 network, illustrating the key components and their interconnections. The network is designed to support various services, including voice, video, and data transmission. The figure includes a base station (gNB), a set of distributed nodes, and a set of optical line terminals (OLTs). The architecture is designed to be flexible and scalable, allowing for easy expansion and modification as needed. The figure also includes a layer of redundancy to ensure the network's reliability and resilience.\nFigure 6.31.3-1: Architecture Assumption\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.31.4\tProcedures",
                            "text_content": "The figure depicts the location service continuity from 5G to Enhanced Positioning System (EPS), illustrating the transition from 5G to a more advanced positioning system.\nFigure 6.31.4.1-1: Location Service Continuity from 5GS to EPS\n1.\tSteps 1-15 defined in clause 6.3.1 of TS 23.273 [5] with the following additions: after receive Namf_Location_ProvidePositioningInfo Request, if AMF determine the access type supported by UE for event reporting includes \"EUTRAN\" and if the required LCS QoS class in location QoS is \"multiple QoS class\", the AMF determines its corresponding location QoS can be applicable to EPS, i.e. determine two set of location QoS, one used for 5GS and its corresponding used for EPS (i.e. the location QoS applicable to EPS). If AMF determines the 5GS corresponding location QoS applicable to EPS, AMF notifies that information to LMF via Nlmf_Location_DetermineLocation Request message. Otherwise, if AMF does not do that processing, the LMF could perform that processing as described in step 2.\n2.\tAfter receive Nlmf_Location_DetermineLocation Request, if LMF determines the access type supported by UE for event reporting includes \"EUTRAN\" , e.g. the reporting type includes \"EUTRAN\" and if the required LCS QoS class in location QoS is \"multiple QoS class\", the LMF determines its corresponding location QoS can be applicable to EPS, i.e. determine two set of location QoS, one used for 5GS and its corresponding used for EPS (i.e. the location QoS applicable to EPS). For example, choose the most stringent values from the \"LocationQoS\" and set the \"LcsQoSClass\" in \"LocationQoS\" as the \"Best Effort\" (since the \"LCS QoS class\" is defined as an enumerate data type and MME only understand the enumerated value {\"assured\" and \"best effort\"}, it does not understand the enumerated value \"multiple qos\").\nNOTE 1:\tEither AMF or LMF could determine the location QoS applicable to EPS if the UE reporting type includes \"EUTRAN\" and if the required \"LCS QoS class\" is \"multiple QoS class\".\n3-4.\tLMF sends the LCS Periodical-Triggered Invoke Request, includes the location QoS used for 5GS and the its corresponding location QoS used for EPS. UE response to LMF with the LCS Periodical-Triggered Invoke Return Result\n5.\tLMF sends the Nlmf_Location_DermineLocation Response to AMF, if AMF does not determine the 5GS location QoS corresponding location QoS applicable to EPS, i.e. AMF does not perform the processing as illustrated in step 1, the LMF includes the location QoS used for 5GS and the its corresponding location QoS used for EPS to AMF. After receive that information, the AMF should keep the positioning related information and do not release.\n6~9.\tAfter AMF receives the handover required message, if AMF finds UE can support interworking between 5GS and EPS, e.g. AMF can determine whether UE can be interworking between 5GS and EPS based on whether receive the location QoS used for 5GS and the its corresponding location QoS used for EPS from LMF or based on the UE subscription information or based on whether the UE reporting type includes \"EUTRAN\", AMF sends the Namf_LocationEventNotify to GMLC, includes the MME ID/address, the handover to EPS notification, location QoS used in 5GS and its corresponding location QoS applicable to EPS. Alternatively, AMF can perform step 8 and step 9 after receive Relocation response message (i.e. step 9 in clause 4.11.1.2.1 of TS 23.502 [3]) or Relocation Complete Notification message (i.e. step 12c in clause 4.11.1.2.1 of TS 23.502 [3]) from MME.\nNOTE 2:\tNo step sequence restrict between step 9 and steps 10~14, step 9 and steps 10~14 can be performed in parallel.\n10-14:\t5GS to EPS handover.\n15.\tIf UE finds periodical event triggered and if the UE has moved to EPS, the UE sends LCS MO-LR Invoke message, carry the location QoS can be applicable to EPS. The UE can determine whether it has moved to EPS based on the message received from target access network during handover, e.g. based on the \"target RAT=eutran\" included in message\"MobilityFromNRCommand\" or can based on the RRC message type, e.g. for NR-NR handover, UE will receive the RRCReconfiguration from target NG-RAN, for EUTRAN-EUTRAN handover, UE will receive the RRCConnectionreconfiguration from target EUTRAN, for NG-RAN to EUTRAN handover, UE will receive the MobilityFromNRCommand from target EUTRAN.\nNOTE 3:\tIf UE finds handover is not complete but the event is triggered, i.e. step 16 happens before step 13, the UE need wait handover complete to send the triggered LCS MO-LR Invoke message.\nThen, as UE moving, UE may moves from EPS back to 5GS, in that case, if UE finds periodical event triggered and if the UE has moved to 5GS, the UE sends Event Report message, carry the location QoS can be applicable to 5GS. Also, the MME need notify GMLC the handover to 5GS notification.\nThe figure depicts the location service continuity from EPS (Enhanced Packet Service) to 5GS (5G Service), illustrating the network's ability to maintain connectivity in the event of a disruption. The figure shows the various components involved in the location service, including the EPS, 3GPP (3rd Generation Partnership Project), and 5G network, as well as the various paths and paths to the 5GS. The figure highlights the importance of network redundancy and failover mechanisms to ensure uninterrupted service.\nFigure 6.31.4.2-1: Location Service Continuity from EPS to 5GS\nSince all the \"LCS QoS class\" in \"location QoS\" supported by EPS can also supported by 5GS, there is no need do the location QoS class mapping processing as described in clause 6.31.4.1.\n3-4.\tAfter MME receives the handover required message, if MME finds UE has positioning related information, MME trigger to send Subscriber Location Report to GMLC, includes the AMF ID/address, the LDR Reference number, the handover to 5GS notification. Alternatively, MME can perform step 3 and step 4 after receive Forward Relocation Response message (i.e. step 14 in clause 4.11.1.2.2.2 of TS 23.502 [3]) or Forward Relocation Complete Notification (i.e. step 5 in clause 4.11.1.2.2.3 of TS 23.502 [3]) message from AMF.\n10.\tIf UE finds periodical event triggered and if the UE has moved to 5GS, the UE sends event report message to 5GS. The UE can determine whether it has moved to 5GS based on the message receive from target access network during handover, e.g. based on the RRC message type, e.g. for NR-NR handover, UE will receive the RRCReconfiguration from target NG-RAN, for EUTRAN-EUTRAN handover, UE will receive the RRCConnectionreconfiguration from target EUTRAN, for NG-RAN to EUTRAN handover, UE will receive the MobilityFromNRCommand from target EUTRAN.\nNOTE 1:\tIf UE finds handover is not complete but the event is triggered, i.e. step 10 happens before step 8, the UE need wait handover complete to send the triggered Event Report message.\nNOTE 2:\tNo step sequence restrict between step 4 and steps 5~9, step 4 and steps 5~9 can be performed in parallel.\nThen, as UE moving, UE may moves from 5GS back to EPS, in that case, if UE finds periodical event triggered and if the UE has moved to EPS, the UE sends the LCS MO-LR Invoke message, carry the location QoS can be applicable to EPS. Also, the AMF need notify GMLC the handover to EPS notification.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.31.5\tImpacts on services, entities, and interfaces",
                            "text_content": "UE:\n-\tAfter periodic event triggered, support differentiate whether move to EPS or 5GS and determine the suitable messages and location QoS sends to 5GS/EPS.\nLMF:\n-\tSupport aware whether UE can support the interworking between 5GS and EPS.\n-\tSupport determine the 5GS location QoS corresponding location QoS can be applicable to EPS, and send this information to UE and AMF.\nAMF:\n-\tSupport determine the 5GS location QoS corresponding location QoS can be applicable to EPS, and send this information to LMF.\n-\tAfter receive handover required, instigate Namf_LocationEventNotify to GMLC to notify the handover and the 5GS location QoS corresponding location QoS can be applicable to EPS if UE can support interworking between 5GS and EPS.\nMME:\n-\tAfter receive handover required, instigate the Subscriber Location Report to GMLC to notify the handover if UE can support interworking between EPS and 5GS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.32\tSolution #32: LCS continuity Support for N26 based Handover",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.32.1\tIntroduction",
                            "text_content": "This solution addresses KI#8: support of location service continuity in case of UE mobility.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.32.2\tFunctional Description",
                            "text_content": "The interworking between 5GS and EPS with N26 interface is specified in clause 5.17.2.2 of TS 23.501 [2], and the handover procedure via is specified in clause 4.11.1.2 of TS 23.502 [3]. During that handover procedure, location request from LCS Client may arrive at 5GC or EPS core network entities, e.g. AMF or MME. Or after core network entities received Location Request from GMLC and before actual positioning procedure finish, the handover required message maybe received from RAN.\nSince those handover procedure is on-going, continue performing positioning procedure within the source RAN may have problems, e.g. such positioning procedure may not able be finished due to UE moved to target side; the positioning result from the source side may not be accurate due to UE mobility. In such handover and location service simultaneously on-going scenarios, forwarding arrived location request to target side and trigger actual positioning procedure at target side has benefits over simply reject the location request. The benefits including that network can provide UE location timely and accurately.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.32.3\tProcedures",
                            "text_content": "Within below figure 6.32.3.1-1, the MT-LR location request arrives at AMF (e.g. Step 4 of clause 6.1.1 of TS 23.273 [5], Namf_Location_Provide Request from V-GMLC), and this would trigger the positioning procedure. When such MT-LR procedure is still on-going, the NG-RAN may decides that a Handover is required.\nThe figure depicts a 32-bit LCS support during handover from 5GS to EPS, highlighting the importance of LCS in ensuring reliable handover in a 5G network.\nFigure 6.32.3.1-1: LCS support during handover from 5GS to EPS\nStep A-1: During the 5GC-MT-LR procedure, e.g. in clause 6.1.1 of TS 23.273 [5], step 4, the AMF received Namf_Location_ProvidePositioningInfo request from V-GMLC, which includes the SUPI, and client type and may include the required QoS parameters. The LMF is then contacted to perform one or more of the positioning procedures described in clause 6.11.1 and 6.11.2 of TS 23.273 [5].\nStep A-2.\tTake the clause 6.1.1 of TS 23.273 [5] as an example, the step 1 of this procedure is triggered. The LMF invokes the Namf_Communication_N1N2MessageTransfer service operation towards the AMF.\nStep B: Before the complete of procedure triggered in StepA-2, or before Step A-2 but after Step A-1, the NG-RAN may decide to initiate the Handover. The AMF receives the Handover Required from NG-RAN as defined in clause 4.11.1.2.1 of TS 23.502 [3], step 1.\nStep C-1:\tReplace the step 10 in 6.1.1 of TS 23.273 [5], the AMF returns the Namf_Location_ProvidePositioningInfo Response towards the V-GMLC, to indicate that there is a Handover.\nStep C-2:\tThe AMF invokes the Namf_Communication_N1MessageNotify service operation towards the LMF, to indicate that there is a Handover, and the abort of positioning procedure.\nStep D: The AMF needs to indicate the MME to preform Location Procedure in EPS and return the result, via N26 interface. The AMF may map the Namf_Location_ProvidePositioningInfo request message received to the message Provide Subscriber Location message, and send this message to MME by piggybacking in the Relocation Required, which is step 3 of procedure in 4.11.1.2.1 of TS 23.502 [3]. The MME assumes such Provide Subscriber Location is come from a GMLC, and triggers the Step F-1. At the same time, the handover procedure continues, as defined in 4.11.1.2.1 of TS 23.502 [3].\nStep E-1: The MME send Location request to E-SMLC, as defined in clause 9.1.15 of TS 23.271 [4].\nStep F-1: The E-SMLC performs the step 7 of clause 9.1.15 of TS 23.271 [4].\nStep G-1: The E-SMLC performs the step 8 of clause 9.1.15 of TS 23.271 [4]. In this step, the MME receives the Location Response message from E-SMLC. That means the positioning result is from the target side.\nStep H: The positioning result is return to AMF via N26 interface. The context request/response pair message could to re-use with some modification, or defines new messages for this purpose.\nStep J: Like the step 10 in clause 6.1.1 of TS 23.273 [5], the AMF returns the Namf_Location_ProvideLocation Response towards the V-GMLC, to return the UE location to V-GMLC.\nWithin below figure 6.22.3.2-1, the MT-LR location request (e.g. Provide Subscriber Location Request sent by VGMLC in step 2 of clause 9.1.15 of TS 23.271 [4]) arrives at MME, and this would trigger the positioning procedure. When such MT-LR procedure is still on-going, the NG-RAN decides that a Handover is required.\nThe figure depicts a 32-bit LCS support during handover from EPS to 5GS, highlighting the importance of LCS in ensuring reliable handover in 5G networks.\nFigure 6.32.3.2-1: LCS support during handover from EPS to 5GS\nStep A: During the EPS-MT-LR procedure, e.g. procedure in 9.1.15 of TS 23.271 [4], step 2, GMLC sends a Provide Subscriber Location message to the MME. This message carries the type of location information requested (e.g. current location and optionally, velocity), the UE subscriber's IMSI, LCS QoS information (e.g. accuracy, response time) and an indication of whether the LCS client has the override capability. The procedure may continue and step 6 of 9.1.15 of TS 23.271 [4] happens.\nStep B: Before the complete of procedure triggered in Step A, the E-UTRAN may decide to initiate the Handover. The MME receives the Handover Required from NG-RAN as defined in clause 4.11.1.2.2.2 of TS 23.502 [3], step 2.\nStep C-1:\tIn such case, since the Handover is going to happen, continuing positioning at EPS side become useless, so the MME may send Location Abort to E-SMLC.\nStep C-2:\tThe MME may also send Subscriber Location Report to V-GMLC, to indicate that there is a Handover imminent.\nStep D: The MME needs to indicate the AMF to preform Location Procedure in 5GS and return the result, via N26 interface. The MME send the Provide Subscriber Location message to AMF, by piggybacking it in the Forward Relocation Request message, which is step 3 of procedure in 4.11.1.2.2.2 of TS 23.502 [3].\nAfter receive this message, the AMF needs map the Provide Subscriber Location message to Namf_Location_ProvideLocation request message, and the MME assumes such Namf_Location_ProvideLocation is come from a V-GMLC, and triggers the Step E. At the same time, the handover procedure continues, as defined in 4.11.1.2.2 of TS 23.502 [3].\nStep E: As step 6 in clause 6.1.1 of TS 23.273 [5], the AMF selects an LMF based on NRF query or configuration in AMF and invokes the Nlmf_Location_DetermineLocation service operation towards the LMF to request the current location of the UE.\nStep F-1: As step 8 in clause 6.1.1 of TS 23.273 [5], the LMF performs one or more of the positioning procedures described in clause 6.11.1, 6.11.2 of TS 23.273 [5]. This step F-1 shows that clause 6.1.1 as an example.\nStep F-2: As step 9 in clause 6.1.1 of TS 23.273 [5], the LMF returns the Nlmf_Location_DetermineLocation Response towards the AMF to return the current location of the UE.\nStep G: The positioning result is return to MME via N26 interface. The context request/response pair message could to re-use with some modification, or defines new messages for this purpose.\nStep H: Like the step 9a in in 9.1.15 of TS 23.271 [4], the MME send a Subscriber Location Report to the V-GMLC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.32.4\tImpacts on services, entities, and interfaces",
                            "text_content": "Impacted entities:\n-\tAMF: forward LCS related message to MME, and receive such message from MME, to trigger positioning procedure; to forward positioning result to MME; mapping the Provide Subscriber Location message to and from the Namf_Location_ProvideLocation request message.\n-\tMME: forward LCS related message to AMF, and receive such message from MME, to trigger positioning procedure; to forward positioning result to AMF.\nImpacted interfaces:\n-\tN26, forwarding LCS related messages between AMF and MME.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.33\tSolution #33: Support of LCS mobility when UE moves between 5GS and EPS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.33.1\tIntroduction",
                            "text_content": "This solution addresses the KI \"Key Issue #8: support of location service continuity in case of UE mobility\".\nContinuity of certain basic services like a PDU session during mobility is defined currently. However, the handling of an LCS session during mobility procedures is not specified. In particular, there is no specification on whether an ongoing LCS session shall be terminated or continued with after the mobility and if continued, how the continuity shall work. There can be many effects due to this missing part:\n-\tLCS sessions may be terminated at mobility with the LCS Client having to re-initiate the session after the procedure.\n-\tThe LMF may not be aware of the mobility at all, leading to inaccurate positioning estimates.\n-\tSince there are no clear specifications, inter-vendor tests could fail.\n-\tLCS sessions could be enabled as part of other critical services (like emergency calls) - those services could be impacted due to the current specifications - leading to regulatory issues.\nAll of the above issues could be prevented if there is a clear specification on how LCS sessions are to be handled in different mobility procedures and in particular, if continuity can be guaranteed by the network.\nThe main considerations in the solution are:\n-\tKeep the changes minimal in EPC so that legacy functionality requires only a small incremental change\n-\tNot needing a standardized interface between the EPC-GMLC and 5GC-GMLC. According to clause 4.2a of TS 23.273 [5], this interface, denoted as Lr' is not standardized and in case EPC-GMLC and 5GC-GMLC are co-located, Lr' is not needed altogether. This solution doesn't require the standardization of this interface.\n-\tprovide a common procedure for all types of Location Request (MO-LR/MT-LR with/without deferred location).\n-\tprovide a simple solution that works regardless of the current status of the on-going location procedure when the mobility event occurs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.33.2\tFunctional Description",
                            "text_content": "This proposal provides solutions for mobility between 5GS and EPS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.33.3\tProcedure",
                            "text_content": "The figure depicts a LCS Continuity Solution for 5GS to EPS Mobility, illustrating the various components and their interconnections. The solution includes a 5G base station (gNB), an edge server (ES), and a mobile edge computing (MEC) server. The diagram highlights the use of LCS (Layer 2 Carrier Sense) to ensure reliable communication in the 5G network.\nFigure 6.33.3-1 : LCS Continuity Solution for 5GS to EPS Mobility\nDescription:\nSteps 1-4 describe the normal MT-LR LCS session on 5GS (similar to steps 1.a. to 12 in Figure 6.1.2-1 in TS 23.273 [5].\nSteps 5-14 describe the normal 5GS to EPS HO procedure (similar to steps 1 to 12.b in Figure 4.11.1.2.1-1 in TS 23.502 [3].\nThe AMF could initiate steps 15 and 17 in parallel to step 11 when it receives the Relocation Response (step 10).\nNOTE 1:\tSteps 15/16 is meant to be completed before the UE is handed over to LTE. If it is determined to be too close to the HO procedure, then the normative phase could choose to trigger step 15 in parallel with step 7.\nSteps 15-16: The LCS Session on 5GS is cancelled.\nStep 17: The AMF indicates failure to the 5GC-GMLC with reason \"HO to EPC\" and including the target MME ID.\nStep 18: The 5GC-GMLC forwards the location request to the EPC-GMLC including all the parameters of the LCS Request and the target MME ID.\nSteps 19-24: The LCS Session is started on EPS (similar to steps 1-10 in Figure 9.18 in TS 23.271 [4]).\nSteps 25-26: The UE location estimate is returned by the EPC-GMLC to the 5GC-GMLC which then forwards the same to the LCS Client.\nNOTE 2:\tAs can be observed, the entire procedure is done in a way where the LCS Client is not aware of the mobility handling and the LCS session continuity is ensured.\nNOTE 3:\tThere could be a mapping of LCS QoS (from the values defined for 5GS to values defined in 4GS) - this could be done by the GMLC.\n-\tFor QoS attributes that are common between 5GS and EPS, the original LCS QoS defined values can be used as is in EPS.\n-\tFor QoS attributes that are specific to 5GS -> the QoS mapping could be done to the most stringent QoS value with best effort handling in QoS Class. If an LCS session was active over user plane in 5GS when the HO is triggered, the AMF/LMF share assistance data to the UE that minimizes the TLS handshake workload according to clause 6.1.1.4 of OMA-TS-ULP-V2_0_6 [14] specification, once the UE moves to EPS.\nThe figure depicts a LCS Continuity Solution for EPS to 5GS Mobility, illustrating the various components and their interconnections. The solution includes a LCS (Local Continuity Solution) for EPS (Enhanced Power Saving) to 5GS (5th Generation) Mobility, which ensures uninterrupted communication in the event of a power outage. The figure also shows the interconnection of the LCS with the EPS, illustrating the seamless integration of these technologies to provide reliable communication in various network scenarios.\nFigure 6.33.3-2: LCS Continuity Solution for EPS to 5GS Mobility\nDescription:\nSteps 1-4 describe the normal MT-LR LCS session on EPS (similar to steps 1 to 3 in Figure 6.1.2-1 in TS 23.271 [4].\nSteps 5-14 describe the normal EPS to 5GS HO procedure (similar to steps 1 to 16 in Figure 4.11.1.2.2.2-1 and steps 1-4 in Figure 4.11.1.2.2.3-1 in TS 23.502 [3]).\nThe MME could initiate steps 15 and 17 in parallel to step 11 when it receives the Forward Relocation Response (step 10).\nSteps 15-16: The LCS Session on EPS is cancelled.\nStep 17: The MME indicates failure to the EPC-GMLC with reason \"HO to EPC\" and including the target AMF ID.\nStep 18: The EPC-GMLC forwards the location request to the 5GC-GMLC including all the parameters of the LCS Request and the target AMF ID.\nSteps 19-24: The LCS Session is started on 5GS (similar to steps 1-23 in Figure 6.1.2-1 in TS 23.273 [5]).\nSteps 25-26: The UE location estimate is returned by the 5GC-GMLC to the EPC-GMLC which then forwards the same to the LCS Client.\nNOTE 1:\tAs can be observed, both the procedures are defined in a way to keep the LCS Client unaware of the mobility signalling and the LCS session continuity is ensured.\nNOTE 2:\tThere could be a mapping of LCS QoS (from the values defined for 5GS to values defined in 4GS or vice versa) - this could be done by the GMLC.\n-\tFor QoS attributes that are common between 5GS and EPS, the original LCS QoS defined values can be used as is in 5GS.\n-\tFor QoS attributes that are specific to EPS -> the QoS mapping could be done to the most stringent QoS value with best effort handling in QoS Class.\n-\tIf the LMF is configured to use LCS over user plane in 5GS, then LMF will choose to initiate the LCS session over user plane at step 24.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.33.4\tImpacts on services, entities, and interfaces",
                            "text_content": "Table 6.33.4-1: Impacts on services, entities and interfaces\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.33.4-1: Impacts on services, entities and interfaces",
                                    "table number": 10,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "6.34\tSolution #34: UE location determination for Mobility Restriction enforcement",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.34.1\tIntroduction",
                            "text_content": "Using UE-generated location information (e.g. GNSS/A-GNSS) to determine the TAI where the UE is geographically located can be accurate but may be unreliable as has been evaluated by SA WG3.\nTo perform precise Mobility Restriction enforcement, this solution propose to use NI-LR procedure to determine the TAI where the UE is geographically located, when NG-RAN reports multiple TAIs to AMF and any but not all of them are Forbidden Area or Non-allowed area.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.34.2\tFunctional Description",
                            "text_content": "This solution proposes to utilize NI-LR procedure to determine the TAI where the UE (with satellite access) is geographically located, NG-RAN reports multiple TAIs to AMF (not indicating the TAI in which the UE is located) and any but not all of the reported TAIs are Forbidden Area or Non-allowed area.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.34.3\tProcedure",
                            "text_content": "The figure depicts a location determination system for mobile network users, utilizing a novel location-based approach. The system uses a combination of Non-Intrusive Localization (NI-LR) and Localization-by-Reflection (LBR) techniques to determine the location of mobile users. The figure shows the system's architecture, including the location determination algorithm, the location-based user location, and the location-based user location determination. The system is designed to ensure the accuracy and reliability of location determination, especially in cases of mobility restrictions.\nFigure 6.34.2-1: NI-LR based UE location determination for Mobility Restriction enforcement\n1.\tAMF receives a NGAP message containing User Location Information for a UE using NR satellite access during a Mobility Management or Session Management procedure. The ULI information contains multiple TAIs.\nNOTE 1:\tIn step 1, NG-RAN does not indicate the TAI in which the UE is located as part of the ULI.\n2.\tAMF determines to initiate NI-LR procedure if any but not all of the received TAIs in step 1 is Forbidden or Not-Allowed.\n3.\tAMF sends Nlmf_location_DetermineLocation request to LMF including a UE TAI determination indication.\n4.\tBased on the indication of step 3, LMF may do not select UE standalone or UE-based positioning mode for UE positioning, or also may restrict the usage of UE-assisted method, which can ensure that network verification of UE location is performed with a reliable method.\nNOTE 2:\tThe positioning method mode selection needs coordination with RAN TSG WG and depends on RAN supported methods.\n5.\tLMF sends the UE location estimate to AMF via Nlmf_location_DetermineLocation response.\n6.\tAMF maps the UE location into TAI and performs mobility restriction based on clause 5.3.4.1 of TS 23.501 [2].\nNOTE 3:\tAMF is configured with TAI geographic information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.34.4\tImpacts on services, entities, and interfaces",
                            "text_content": "AMF:\n-\tTriggers NI-LR procedure when NG-RAN reports multiple TAIs (not indicating the TAI in which the UE is located) and any but not all of the reported TAIs are Forbidden Area or Non-allowed area) and any but not all of them are Forbidden Area or Non-allowed area.\n-\tIndicates to LMF in the NI-LR request that the request is for UE TAI determination.\n-\tAMF is configured with TAI geographic information.\nLMF:\n-\tMay select a reliable positioning method supported by RAN based on the UE TAI determination indication.\n-\tRAN:NTN-based NG-RAN needs to support reliable positioning methods.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.35\tSolution #35: Support reporting the UE location only when the UE locates the target area defined with the finer granularity",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.35.1\tIntroduction",
                            "text_content": "This solution addresses KI#4: Interaction between Location Service and NWDAF, and KI#11: Enhance the Triggered Location for UE power saving purposes.\nWith the requirements from the NWDAF or some power saving requirements, the LCS architecture is required to report the UE location only when the UE locates in the exact target area to accomplish the power-saving purpose or signalling reduction purpose.\nThis solution addresses the following two points on the LCS side:\n1)\tdelivers the detailed target area information from LCS service demander including NWDAF to the UE;\n2)\tenables the UE to trigger the area event reporting only when the UE locates in the exact target area or enables the LMF to judge whether the UE location is in the target area or not, which is defined with the finer granularity.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.35.2\tFunctional Description",
                            "text_content": "This solution proposes that the LCS architecture delivers the detail of the target geographical area to the UE including the shape of the target area, the coordinates of latitude and longitude, area accuracy and other information. The area accuracy is used to allow the LCS architecture to report the UE location within the tolerant granularity. Besides, two approaches (i.e. decided by UE and decided by NF) are proposed to address how to report the UE location only when the UE locates the target area defined with the finer granularity:\n-\tApproach A: Decided by UE. The UE knows the exact target area with finer granularity and triggers area event reporting when the UE can calculate its location (e.g. RAT-independent positioning) and the UE locates in the exact target area;\n-\tApproach B: Decided by NF. The NF (e.g. LMF) determines whether the UE location is in the exact target area or not when the UE can not calculate its exact location (e.g. UL positioning) or the NF (e.g. LMF) receives the request from the UE side to help to make a judgment. Then the NF (e.g. LMF) makes the judgment based on the UE location and the target area The judgment means the NF (e.g. LMF) only counts and reports the valid UE location data to the NWDAF or other LCS clients.\nBesides, if the LCS service demander including NWDAF indicates explicitly in the request that there is no need to implement the exact area event reporting, the UE would handle the area event reporting as cell and TA granularity although the target area is defined with the finer granularity.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.35.3\tProcedures",
                            "text_content": "Figure 6.3.1-1 in clause 6.3.1 of TS 23.273 [5] is reused with the following enhancements:\nThe figure depicts a 5G-based network architecture, illustrating the various components involved in the network's operation, such as base stations (gNB), user equipment (UE), and scatterers. The diagram highlights the use of beamforming techniques to mitigate interference, and the presence of redundant paths to ensure failover reliability. The layered design of the network aligns with SDN principles, allowing for efficient network management and control.\nFigure 6.35.3.1-1 (Figure 6.3.1-1): Deferred 5GC-MT-LR for periodic, triggered and UE available location events\n1.\tFor area event reporting, the LCS client (e.g. NWDAF) provides to the GMLC the details of the target area and may include the requirement of area reporting (e.g. reporting based on the cell or TA level as the Rel-17 does, reporting only when the UE locates in the exact target area, multiple scheme reporting). In this step, if the target area is defined with finer granularity, the area accuracy may be included to allow the LCS architecture to report the UE location within the tolerant granularity.\n4&5.\tThe GMLC delivers the target area information received in step 1 to the AMF. If the requirement of area report is indicated with reporting only when the UE locates in the exact target area, the GMLC may not convert the target area into the cell or TA lists and just notifies the target area to the UE.\n14&16.\tThe AMF delivers the target area information received in step 1 to the LMF and then the LMF notifies the UE in the LCS trigger invoke request message.\n22.\tThe UE detects the target area. If the UE obtains its exact location, the UE compares the location with the target area. The UE triggers area event reporting only when the UE locates in the exact target area. If the UE cannot calculate its exact location, the UE may request the NF (e.g. LMF) to assist in confirming and comparing the location with the target area.\n25.\tThe UE triggers area event reporting. Optionally, the UE may send temporary area event reporting to the LMF with an indication to request the LMF to confirm and compare location when the UE cannot calculate its exact location.\n28.\tThe LMF sends the area event reporting. If the temporary area event reporting is received in step 25, the LMF compares the location with the target area. This procedure will be terminated and the reporting status will not be updated if the UE doesn't locate in the exact target area.\nThe procedure mentioned (i.e. Figure 6.13.3.2-1) in sol#13 is reused with the following step enhancements:\nThe figure depicts a network architecture with various components, including a base station (gNB), user equipment (UE), and distributed nodes. The figure illustrates the fiber-optic backbone with core switches, optical line terminals (OLTs), and distributed nodes. Redundancy paths are shown in dashed lines, ensuring failover reliability. The layered design aligns with SDN principles.\nFigure 6.35.3.1-1 (Figure 6.13.3.2-1): AMF provides UE location information to NWDAF (Continuous Collection)\n3.\tThe NWDAF provides to the AMF the details of the target area and may include the requirement of area reporting (e.g. reporting based on the cell or TA level as the Rel-17 does, reporting only when the UE locates in the exact target area, multiple scheme reporting). In this step, if the target area is defined with finer granularity, the area accuracy may be included to allow the LCS architecture to report the UE location within the tolerant granularity.\n5&7.\tThe AMF delivers the target area information received in step 3 to the LMF and then the LMF notifies the UE in the LCS trigger invoke request message.\n11.\tThe UE detects the target area. If the UE obtains its location, the UE compares the location with the target area. The UE triggers area event reporting only when the UE locates in the exact target area. If the UE cannot calculate its exact location, the UE may request the NF (e.g. LMF) to assist in confirming and comparing the location with the target area.\n12.\tThe UE triggers area event reporting. Optionally, the UE may send temporary area event reporting to the LMF with an indication to request the LMF confirm and compare location when the UE cannot calculate its exact location.\n15.\tThe LMF sends the area event reporting. If the temporary area event reporting is received in step 12, the LMF compares the location with the target area. This procedure will be terminated and the reporting status will not be updated if the UE doesn't locate in the exact target area.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.35.4\tImpacts on services, entities, and interfaces",
                            "text_content": "GMLC/AMF/LMF:\n-\tSupports delivering the detailed target area information defined with finer granularity to the UE.\nLMF:\n-\tDetermines whether the UE location is in the exact target area or not when the UE can not calculate its exact location or receives the request from the UE side to help to make a judgment.\n-\tUpdate the reporting status only when the UE location is in the exact target area.\nUE:\n-\tSupports triggering area event reporting only when the UE can calculate its exact location and the UE locates in the exact target area defined with finer granularity\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tEvaluation",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tKey Issue #1: Architectural Enhancement to support User Plane positioning",
                    "description": "",
                    "summary": "",
                    "text_content": "The following solutions address KI#1.\n-\tSolution #1: Positioning protocol transport over User Plane.\n-\tSolution #2: Discovery of User Plane service Cooperated with 3GPP LCS Features.\n-\tSolution #3: User plane location capability transfer and positioning via user plane.\n-\tSolution #19: Support of Low Latency via User Plane.\nKI#1 identifies the following benefit of user plane positioning:\n-\tIt has a more efficient communication overload with a direct connection from LCS server to UE.\n-\tIt may not require gNodeB, AMF, LMF signalling processing of RRC, NG-AP and HTTP/2 protocol stacks. A single session may handle all the transactions.\nAn additional benefits can be reduced latency which is covered by KI#10, applicability in local service covered in KI#2, mobility support covered in KI#8, power saving covered by KI#11 and KI#12.\nSolutions need to be evaluated against these benefits.\nUE Impact\nAs a \"direct connection from LCS server to UE\", UE impact is of first priority. In R16 and R17, UE compliant with TS 38.305 [6] and related specifications has already specified user plane support.\nAs the considerations in KI#1 \"emergency/non-emergency, other regulatory cases like lawful interception\", whether legacy Rel-16/Rel-17 compatible UE can directly use the user plane service in this study is important for emergency and/or regulatory use cases.\nSolution#1 introduced a new protocol which requires UE with a new communication method. Solution#2 takes SUPL compliance with same reference as TS 38.305 [6]. Solution#3 supports 'secure user plane' and it depends on NAS to activate the user plane connection from UE; The detailed protocol between UE and LMF in solution#19 and solution#3 is unknown whether it is a new protocol to be defined from scratch or reusing SUPL.\nIn summary:\nTable 7.1-1: Comparison of solutions on UE Impact\n\nNOTE 1:\tThe main optional enhancement update to UE includes the DL_NAS_TRANSPORT or extension to LPP. These enhancements are needed in solution#1 and solution#3, optional to solution#2.\nDelay Analysis\nThe protocol of solution#1 doesn't have details for analysis. There are no enough details for comparison between 'lightweight' protocol in solution#1, OMA ULP in solution#2, 'secure user plane' in solution#3 and \"User Plane Transfer of Event Reports\" in solution#19. Although solution#19 improves legacy supplementary service, but it has two segments of secure connection. So, latency analysis doesn't have comparable result.\nMobility Support\n\"mobility support covered in KI#8\" has both EPS to 5GS mobility and inter-RAN node mobility.\nSince data channel should not have impact when UE moves from one RAN node to another, the analysis focuses on EPS and 5GS mobility.\nIn EPS, user plane is specified in TS 23.271 [4] as same SUPL reference to TS 38.305 [6]. The mobility switches over with different cases as following summary:\nSince solution#19 doesn't cover handover or mobility contents, the EPS/5GS mobility in this solution is TBD.\nTable 7.1-2: Comparison of solutions on how to support EPS and 5GS mobility\n\nLocal/Edge LCS Support\n\"Applicability in local service covered in KI#2\" is taken as dependencies in solution# 4 and solution#5.\nIt is also described in KI statements \"deployed the edge data network…. and fits into the architecture in TS 23.548 [10]\". TS 23.548 [10] mainly contains discovery and relocation features which maps to user plane function discovery and UE mobility to Edge Hosting Environment.\nSince solution#19 doesn't cover handover or mobility contents, the discovery and DN mobility in this solution is TBD.\nTable 7.1-3: Comparison of solutions on Edge/Local LCS Support\n\nNOTE 2:\tThe UE mobility can cover the following cases:\n1.\tUE may move between central data network (C-DN) and local data network (L-DN)).\n2.\tUE may move between different local data networks (L-DN).\nOther Aspects\nAmong all solutions of KI#1, power saving is not addressed.\nWith Solution #1, a LCS-UP connection over a PDU session is established between the UE and an LMF. During the registration procedure or the initiation of an LCS procedure, AMF decides to select an LMF and request the UE and the selected LMF to establish an LCS-UP connection. LMF sends its user plane location address to UE via existing procedures, and a lightweight LPP transfer protocol is to be introduced. User Plane connection establishment is initiated by the UE and can be transferred to another LMF by the AMF. An LMF can also transfer a user plane connection it has to a UE to a different LMF. User plane establishment and transfer requires extra signalling but should reduce signalling when used to transfer positioning messages between the UE and LMF. However, it is not clear how an AMF can determine which UEs will benefit from a user plane connection. If applied to all UEs, there could more signalling overall and not less signalling. If applied to UEs which perform the most positioning, there might be less signalling overall. But there is no analysis of this. In this solution, it is LMF to decide whether or not utilize the user plane positioning method after receiving a request from AMF. The user plane connection would not be used if LMF decides to use control plane for UE positioning.\nWith Solution #2, an LMF can transfer control plane positioning of a UE to a separate SUPL user plane connection between the UE and a separate but associated LCUP server. In this solution, it is LMF to decide whether or not utilize the user plane positioning method after receiving a request from AMF. SUPL based push mechanism or LPP itself is used to trigger the establishment of UP connection if there is no available one. There would be extra signalling to setup the SUPL user plane connection but, once setup, transfer of SUPL positioning messages could use less signalling. The user plane server (LCUP) might possibly be part of an LMF. The solution also requires some clarification of how the SUPL user plane connection would be used. For example, a SUPL user plane connection is normally released after a UE location is obtained, as its emphasized OMA SUPL compliance, it should use minimized handshake feature defined in clause 6.1.1.4 of OMA ULP specification if the SUPL user plane connection ends then can be resumed for a later positioning of the UE. URSP including user plane positioning related DNN/S-NSSAI is used for PDU session establishment.\nWith Solution #3, an LMF can trigger a UE to establish a user plane secure connection with the LMF and then exchange LPP messages with the UE over the user plane secure connection. An LMF can also use an already established user plane secure connection with a UE to transfer LPP messages. The protocols to securely support the user plane connection and conditions for releasing the user plane connection re-uses the solution#1. Establishing a user plane will add extra signalling, thus AMF may trigger UE to establish the PDU session when UE registers, considering UE capability, location and subscription information, etc. to reduce signalling.\nWith Solution #19, user plane positioning is used only for a periodic or triggered MT-LR to return location event reports to an LCS Client or AF. The user plane connection is between the UE and LCS Client or AF and comprises either a single direct connection or two concatenated user plane connections through an intermediate entity that is either the LMF or the H-GMLC. For UE assisted position methods, positioning (e.g. LPP) messages can be exchanged between the UE and LMF over one user plane connection, with an event report later sent by the LMF to the LCS Client or AF over a second user plane connection. For UE based position methods, no signalling between the UE and LMF is needed and a single direct user plane connection or two concatenated user plane connections through an H-GMLC can be used. Although there is extra signalling to establish and later release the user plane connection(s), signalling would be reduced for reporting of location events which would reduce overall signalling as long as event reports are sent. The 'second user plane connection' in this solution does not use the SBA pattern and exposures the address information of LMF directly to AF and LCS Client. In this solution, UE assisted and UE-based/UE standalone positioning methods utilize different procedures, which does not involve LMF to make the decision to select the positioning method and mode. The solution impacts the UE, AMF, LMF, GMLC, LCS client, AF.\nIn general, use plane based solutions can reduce the communication overload and signalling cost of control plane, i.e. AMF not involved for LPP message transfer. In all solutions, there are no limitations on deployment scenario, i.e. the LMF or LCUP can be deployed at centre or edge.\nIn summary, the comparison of solutions for KI#1 is listed in the Table 7.1-4.\nTable 7.1-4: Comparison of solutions of Key Issue #1\n\n",
                    "tables": [
                        {
                            "description": "Table 7.1-1: Comparison of solutions on UE Impact",
                            "table number": 11,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "Table 7.1-2: Comparison of solutions on how to support EPS and 5GS mobility",
                            "table number": 12,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "Table 7.1-3: Comparison of solutions on Edge/Local LCS Support",
                            "table number": 13,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "Table 7.1-4: Comparison of solutions of Key Issue #1",
                            "table number": 14,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tKey Issue #2: enhanced positioning architecture for NPN deployment",
                    "description": "",
                    "summary": "",
                    "text_content": "The clause evaluates the solutions for KI#2 as following.\nSolution#4 and #5 addresses key issue#2: enhanced positioning architecture for NPN deployment. Both solutions propose the following principles:\n-\tAMF (in the public network) for general service operation, local AMF/any AMF for LCS operation.\n-\tUE location result is transmitted from LMF to GMLC, not via AMF (in the public network).\n-\tNon-UE NRPPa messages are transmitted between LMF and local AMF/any AMF.\n-\tUE associated NRPPa Requested message are transmitted via AMF in public network.\nOpen issue of this key issue is the method for UE associated NRPPa Response message transmission. Two options are for discussion:\n-\tSolution#4: via local AMF. The latency is reduced than legacy network, The impacts are on Local AMF, and RAN.\n-\tSolution#5: via AMF in the public network. The latency is same as legacy network. No new impact.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.3\tKey Issue #3: Local Area Restriction for an LMF and GMLC",
                    "description": "",
                    "summary": "",
                    "text_content": "The clause evaluates the solutions for KI#3 as following.\nSolution#6, #7, #8, #9 are all addressing key issue#3: Local Area Restriction for an LMF and GMLC. Three aspects \"parameter configuration\", \"parameter exchange\", and \"LMF selection logic\" are used to summarize the solutions:\nTable 7.3-1: Comparison of solutions of Key Issue #3\n\n",
                    "tables": [
                        {
                            "description": "Table 7.3-1: Comparison of solutions of Key Issue #3",
                            "table number": 15,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.4\tKey Issue #4: Interaction between Location Service and NWDAF",
                    "description": "",
                    "summary": "",
                    "text_content": "Key issue#4 details the questions to be studied for WT#2 in FS_eLCS_Ph3 SID which includes the following aspects:\n-\tAspect#1: how the location services can benefit from NWDAF;\n-\tAspect#2: how the NWDAF use cases can benefit from location service; and\n-\tAspect#3: how to provide location information to NWDAF.\nAccordingly, the solutions for the key issue#4 can also be classified based on the three aspects above, as shown in the Table 7.4-1.\nTable 7.4-1: Solution Classification for KI#4\n\nThe evaluation of solutions (i.e. solution#11, solution#12 and solution#20) related to aspect#1 is as follows:\n-\tLMF subscribes from NWDAF to obtain Location Accuracy analytics. NWDAF obtains data from OAM (MDT data) or historical LMF output. LMF improves the location accuracy by leveraging the location estimation from the NWDAF (Solution#11).\n-\tNWDAF can optionally provide indoor/outdoor information based on available measurements to assist LMF in above process (Solution#20).\nThe evaluation of solutions (i.e. solution#12, solution#20) related to aspect#2 is as follows:\n-\tAnalytics consumer requests Location Accuracy analytics. NWDAF obtains data from GMLC/LMF to identify location accuracy (e.g. vertical/horizontal accuracy) for a positioning method (Solution 12).\nNOTE 1:\tSolution#59 in eNA_Ph3 study TR 23.700-81 [17] provides corresponding solution on NWDAF.\n-\tinformation fed to NWDAF from GMLC/LMF could contain the indoor/outdoor information so that NWDAF can provide such feature in aspect#1.\nThe evaluation of solutions (i.e. solution#10, solution#35 and solution#13) related to aspect#3 is as follows:\n-\tIn solution#10 and Solution#35, NWDAF requests UE location from GMLC, i.e. the NWDAF acts as an AF which can request UE location using the existing location service. In Solution#10, the only enhancement to existing location service is to introduce new LCS Client Type and Service Type for NWDAF. In Solution#35, the NWDAF requests (or collects) the location information of a UE within a target geographical area from LCS system via GMLC. The enhancement to existing location service is to provide a target geographical area, which can be any shape comparing to current cell or TA concept, and a new location event reporting condition(i.e. reporting only when the UE locates in the exact target geographical area) from NWDAF to LMF.\nNOTE 2:\tThe requirement why the NWDAF requests the finer granularity location information from LCS system originates from FS_eNA_Ph3 KI#9. How to provide location information to NWDAF in a target geographical area finer than TA/cell should be determined in this FS_eLCS_Ph3.\n-\tIn solution#13, NWDAF requests UE location from AMF, so GMLC is not involved. The solution can reduce location service latency because not involving GMLC leads to reducing signalling flows especially in the roaming scenarios. Some enhancements to NWDAF and AMF to help complete the privacy check. It is an optional choice to realize data collection between NWDAF and LCS.\n",
                    "tables": [
                        {
                            "description": "Table 7.4-1: Solution Classification for KI#4",
                            "table number": 16,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.5\tKey Issue #5: Assistance data provisioning for low power high accuracy GNSS positioning",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause provides evaluation of Candidate Solutions for Key Issue #5.\nA unique Candidate Solution has been proposed:\n-\tCandidate Solution #21- Collection of nearby GNSS assistance data. The following concepts are proposed within the solution.\n-\tLMF collects GNSS assistance data and coordinates of GNSS reference stations from AF(s) through AF event exposure service as described in clause 5.2.19.2 of TS 23.502 [3].\n-\tLMFs collected GNSS assistance data may update its NF profile in NRF by indicating the TAs of which corresponding GNSS assistance data exists, which can be discovered and used by other LMFs not having corresponding GNSS assistance data.\nSolution #21 reuses the AF event exposure service to collect GNSS assistance data, this solution only has some small impacts on LMF, NRF and AF functionality.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.6\tKey Issue #6: UE Positioning without UE/User Awareness",
                    "description": "",
                    "summary": "",
                    "text_content": "There is one solution in the present TR, i.e. sol#14, related to key issue#6 which aims to support UE not notified by any means during the LCS session, especially when UE is in CM_IDLE or RRC_INACTIVE state.\nTo support key issue#6, two indications (i.e. UE unaware indication and user unaware indication) are introduced in sol#14. When UE unaware indication is provided by LCS Client/ AF, if target UE is in CM_IDLE or RRC_INACTIVE state, the target UE is not paged. When user unaware indication is provided by LCS Client/ AF, the only exception with the existing positioning procedure is that interaction between network and user, i.e. privacy check requiring such interaction, is skipped. Thus the function of the two indications is different. The impacts to NFs of the two indications are further analyzed in Table 7.6-1.\nTable 7.6-1: Impacts to NFs of Different Indications in Solution#14\n\nBased on the analyses in Table 7.6-1, user unaware indication requires the network to page UE when UE is in CM_IDLE or RRC_INACTIVE state during the positioning procedure which is not required by UE unaware indication. Thus the user unaware indication can only support user unawareness, the UE unaware indication can support both UE and user unawareness.\n",
                    "tables": [
                        {
                            "description": "Table 7.6-1: Impacts to NFs of Different Indications in Solution#14",
                            "table number": 17,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.7\tKey Issue #7: Support of Positioning Reference Units and Reference UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.7.1\tEvaluation of solutions for PRU",
                            "text_content": "There are four solutions related to Positioning Reference Units (PRU) of KI#7, i.e. solution#15, #16, #28, #29 . Solution#15 includes three options from PRU Information Acquisition perspective, which are referred as solution#15-AMF, solution#15-LMF and solution#15-UDM.\nThe comparison of solutions is shown in Table 7.7.1-1.\nTable 7.7.1-1: Comparison of solutions to PRU of KI#7\n\nSolution #15 supports multiple alternatives and impacts multiple entities besides PRUs (AMF, LMF, NRF, UDM). There are also separate procedures defined for supporting an MT-LR and MO-LR and for activating and deactivating PRUs which add more impact. Option A (PRU registration to AMF) impacts the AMF which needs to indicate a PRU to the NRF after which an LMF would need to discover PRUs from the NRF. However, PRUs are not NFs but more part of the NG-RAN making NRF support possibly unnecessary. Option B (PRU registration to LMF) is more direct and impacts the PRU, LMF and possibly NRF. Option C (PRUs information are maintained at the UDM) requires an AMF to query the UDM for available PRUs and then indicate these to an LMF. It is not clear how a UDM would know about PRU availability since a PRU could be powered off, out of coverage or undergoing maintenance. Of these options, option B looks simplest.\nSolution #16 uses the NAS Registration procedure to indicate a PRU to an AMF which then indicates the PRU to an LMF via an Nlmf location request. There is no direct confirmation back to the PRU that the AMF was able to indicate the PRU to an LMF, so if the LMF rejects the Nlmf location request or if the AMF cannot find a suitable LMF, the PRU would not know. However such failure case is in scope of stage 3, e.g. AMF could send the UCU to PRU to notify the PRU registration failure. LMF utilization of a PRU to support location of a target UE (in clause 6.16.3.2) includes UE positioning in steps 2 and 6 for Figure 6.16.3.2-1. However, no details are provided concerning how the PRU would help position the target UE. Positioning of a target UE by a PRU is not so far defined by RAN, so it is unclear whether these steps are feasible and what might be the impacts to the LMF, target UE and PRU. The use of an NRF to discover other PRUs managed by another LMF to assist with the location of a target UE would add additional impacts to an LMF and NRF.\nSolution #28 avoids any impact to an AMF or NRF. A PRU registers with one or more LMFs using a supplementary services protocol. The PRU can be used by an LMF to obtain measurements of RAN nodes in the same was as from a normal UE using LPP. These measurements and a location of the PRU can be used to determine correction terms (e.g. timings and internal delays) of RAN nodes, as defined in TS 38.305 [6]. Extension of the solution to support Reference UEs could be possible later. The PRU updates the registration in LMF based on conditions received from LMF, e.g. periodically or triggered by location change. When the PRU registers with more LMFs, each LMF stores the same PRU information which leads to duplicated storage of the same information in the LMFs. In this case, the PRU has to update the registration when needed to all LMFs storing the PRU information, so more signalling cost is introduced. Furthermore, the PRU authentication would need to be performed in each LMF separately. This duplication of storage and authentication among multiple LMFs should not be significant if PRUs are few in number compared to UEs or if duplicate PRU storage and authentication only occurs for PRUs in border areas between LMF serving areas.\nSolution #29 stores the PRU information in GMLC. When LMF decides to perform the positioning procedures to PRU during the positioning process of target UE, the LMF always obtains PRU information from the GMLC. Considering that the PRU is introduced to improve positioning accuracy which is the responsibility of LMF and is transparent to GMLC, in order to avoid dispersing the same function in different network functions, it is better to store PRU information in LMF or the LMF profile stored in NRF.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 7.7.1-1: Comparison of solutions to PRU of KI#7",
                                    "table number": 18,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "7.7.2\tEvaluation of solutions for Reference UE",
                            "text_content": "There is one solution related to Reference UE of KI#7, i.e. solution#17.\nSolution #17 is based on use of sidelink positioning and ProSe. There seems to be no Uu (UL/DL) level positioning. This means the solution should be part of sidelink positioning and ranging in Release 18 and cannot be evaluated separately, e.g. in case it duplicates or conflicts with other sidelink positioning and ranging solutions for Release 18.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.8\tKey Issue #8: support of location service continuity in case of UE mobility",
                    "description": "",
                    "summary": "",
                    "text_content": "Table 7.8-1: Comparison of solutions to 5GS<>EPS Mobility\n\nTable 7.8-2: Comparison of solutions to NG-RAN node mobility\n\n",
                    "tables": [
                        {
                            "description": "Table 7.8-1: Comparison of solutions to 5GS<>EPS Mobility",
                            "table number": 19,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "Table 7.8-2: Comparison of solutions to NG-RAN node mobility",
                            "table number": 20,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.9\tKey Issue #9: Support of Positioning Requirements Related to Satellite Access",
                    "description": "",
                    "summary": "",
                    "text_content": "The clause evaluates the solutions for KI#9 as following.\nThere are 4 candidate solutions proposed to address positioning requirements related to satellite access.\nSolution overview:\n-\tSolution #18: Location Verification for Satellite Access assisted by NWDAF Analytics.\nNWDAF is involved to provide analytics with statistics and predictions of the UE location which can assist with the network verification task that is required when a UE provides its location to the network via satellite access.\n-\tSolution #23: Location Verification for Satellite Access assisted by TN access.\nLocation verification for UE using satellite access is enforced based on the UE location provided through TN access. If the AMF decides to do such verification, it indicates UE to do registration via TN access. The UE location in TN access can be delivered to the AMF through registration procedure.\n-\tSolution #24: UE Location Verification based on Obtained Information.\nThis solution depends on the NG-RAN providing assistance information to do location verification. The reliability of verification can be enhanced by means of the assistance information, but whether and what assistance information can be provided by NG-RAN should depends on RAN WGs conclusion.\n-\tSolution #34: UE location determination for Mobility Restriction enforcement\nThis solution proposes AMF to invoke NI-LR procedure to determine the UE located TAI in the case of not all of the NG-RAN reporting TAIs are in Forbidden Area or Non-allowed area. AMF can perform precise Mobility Restriction based on the TAI determined through NI-LR procedure. The positioning method mode selection needs coordination with RAN WGs and depends on RAN supported methods.\nAll the solutions can be evaluated based on the following factors:\n-\tSolution assumptions or restrictions.\n-\tThe reliability of UE location verification.\n-\tRAN dependency for proposed solution.\n-\tFunctionality(entity, interface) impact.\nBased on the solution whether to resolve reliability issue, whether the solution has RAN dependency and functionality impacts, solutions can be evaluated as follows:\nTable 7.9-1: Candidate Solutions evaluation\n\n1)\tSolution assumptions and restrictions\nThere is no assumption or restriction on solution #18, #24 and #34.\nSolution #23 works under the conditions that 1) the area that the UE located is covered by both TN access (e.g. LTE, NR) and NR satellite access and 2) UE has the capability of supporting both TN access and NR satellite access. Considering the user location verification under satellite access often needs to be performed in national cross borders, and some of the boundary areas have TN and NR satellite coverage, this solution is feasible in some cases.\n2)\tThe reliability of UE location verification.\nSolution #18 relies on NWDAF providing location statistics and analytics to the AMF to assist with location verification. While location verification relying only on analytics may not always be fully reliable (e.g. predictions on UE location may not be accurate), they will certainly enhance the reliability of the location verification process when combined with additional assistance information and/or procedures. Hence, in most cases, this can enhance the reliability of verification.\nSolution #23 relies on UE location in TN access to do verification. Since the UE location (e.g. the cell the UE is camping on) is reported by RAN rather than generated by the UE, besides, the UE location in TN access represents a smaller range of location area than that in NR satellite access, based on above, it can be seen as reliable when used for verification.\nThe premise of solution #24 relies on RAN providing reliable assistance information.\nSolution #34 relies on NR Satellite-based RAN position method to obtain reliable UE location.\n3)\tRAN dependency for proposed solution.\nGetting reliable UE location through RAN position will increase the time latency. Especially the latency of satellite communication is more serious, RAN position will aggravate the time delay. Besides, satellite resource may be scare, RAN position will increase resource consumption.\nSolution #18 and solution #23 has no RAN dependency.\nSolution #24 and solution #34 relies on RAN providing reliable location information. The feasibility of the solutions depends on RAN conclusion.\n4)\tFunctionality(entity, interface) impact.\nSolution #18 requires NWDAF to do UE location analytic with the request from AMF and provide it to the AMF. No other enhancement is needed.\nSolution #23 requires AMF to indicate UE to register on TN access when location verification is determined to perform by AMF. UE location in TN access is reported to UDM via registration procedure and is further delivered to AMF. UE, AMF and UDM are involved to convey such location information, existing procedure can be reused.\nSolution #24 requires RAN to provide location assistant information to the AMF. N2 interface need to be enhanced, existing procedure can be reused.\nSolution #34 requires AMF to indicate to the LMF that reliable position method is required. Existing procedure can be reused with no more enhancement.\n",
                    "tables": [
                        {
                            "description": "Table 7.9-1: Candidate Solutions evaluation",
                            "table number": 21,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.10\tKey Issue #10: Support of Reduced Latency",
                    "description": "",
                    "summary": "",
                    "text_content": "By supporting user plane-based positioning, Sol#1, Sol#2, Sol#3 and Sol#19 can reduce the latency of LPP or Supplementary service transfer between UE and LMF, in particular when UPF and LMF are located at edge while serving AMF are located at centre (i.e. the LPP message or Supplementary service not to be relayed by centre AMF through control plane).\n-\tCompared with control plane based mode, the user plane mode may introduce extra signalling latency, e.g. there will be a PDU session/UP connection establishment procedure if there is no available proper PDU session/UP connection, when a LCS request is received by LMF. Sol#1 and Sol#3 considers to trigger LCS-UP connection/PDU session establishment at application registration events, which aims to establish LCS-UP connection/PDU session in advance to reduce latency. Sol#1 and Sol#3 also proposed to maintain the established user plane connection for the sake of low latency of subsequent LCS request.\n-\tSol#19 proposed a 'second user plane' between LMF/GMLC and AF or LCS client, which aims to bypass GMLC to reduce latency when reporting UE location to LCS client. However, exposure of LMF address information directly to LCS client and AF may cause security risks. By co-deployment of GMLC and LMF at edge, the latency between GLMC and LMF may be reduced.\n-\tSol#19 proposed a user plane connection between the UE and AF or LCS client for a periodic or triggered MT-LR which can minimize end to end latency when the target UE (rather than LMF) determines location estimates.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.11\tKey Issue #11: Enhance the Triggered Location for UE power saving purpose",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause provides the evaluation of Candidate Solution (i.e. solution#25 and solution#35) for Key Issue #11.\nPower saving purpose is achieved by allowing the UE to report location only when the UE is in the pre-defined area. The location event report has dependency on the pre-defined area. Both Solution#25 and Solution#35 proposed that the pre-defined area can be requested by an LCS Client/AF and sent to the UE via LCS Periodic-Triggered Invoke Request message.\nIn Solution #25:\n-\tthe pre-defined area will be translated by GMLC to a geographical area as defined in TS 23.032 [26] and converted to a TA/cell list. The UE received pre-defined area named \"event report allowed area\" is a TA/cell list. The UE periodically monitors cell ID and/or TAI as broadcasted by RAN, by simply comparing with the received \"event report allowed area\", UE can decide it is in the area or not.\n-\tOnly when the UE is in the area, the UE needs to detect whether the event happens. So the event report allowed area is used to reduce UE power consumption by reducing the number of event report and the number of UE positioning procedures which may be triggered by the event report.\n-\tThe event report allowed area can be applied to all event types, and the UE can adjust the area based on the power status, e.g. if the power status of UE is low, the UE can set the area to a small area.\n-\tSolution #25 also contains two ambiguous aspects concerning whether a UE should occasionally send event reports when outside an allowed area to show an HGMLC and LCS Client that event reporting is still active in the UE and on whether an allowed area can be used in an opposite sense where a UE only reports when outside a certain area (e.g. where a UE spends most time in the area but UE location is only needed when the UE is outside the area).\nIn Solution #35:\n-\tthe pre-defined area can be any shape as requested by LCS client/AF, or the translated geographical area as defined in TS 23.032 [26]. The UE received pre-defined area named \"exact target area\" is with finer granularity than TA/cell list and can be any shape.\n-\tThe \"exact target area\" is an enhancement to area type event report, that the UE location is only reported when the UE is exactly in the \"exact target area\"\n-\tTo achieve this, either UE or LMF needs to compare the UE location and the \"exact target area\" with the UE location measurement. Only when the UE is in the \"exact target area\", UE/LMF reports the event.\n-\tPower saving can be achieved only with Solution #25, i.e. after UE detects it is in the TA/cell list (\"event report allowed area\") and obtains the Location Measurement as specified in step 23) in clause 6.3.1 TS 23.273 [5]. By further comparing the location with the \"exact target area\", UE/LMF can decide that the UE is in the area or not, i.e. Case II mentioned area as shown in Figure 7.11-1, the area identified by cell/TA, but not in the pre-defined area.\nThe figure depicts a detailed illustration of a pre-defined area, event report allowed area, and finer granularity area, highlighting the various zones and their respective functionalities.\nFigure 7.11-1: Illustration of pre-defined area, event report allowed area, and finer granularity area\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "8\tConclusions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "8.1\tKey Issue #1: Architectural Enhancement to support User Plane positioning",
                    "description": "",
                    "summary": "",
                    "text_content": "-\tA user plane connection may be used between a UE and LMF with the following properties.\n-\tThe UE uses the URSP which includes user plane positioning related PDU session parameters (e.g. DNN and S-NSSAI) to establish the PDU session for user plane positioning.\n-\tIt is LMF to decide whether to use user plane or control plane positioning mode when receiving positioning requests from AMF.\n-\tIf LMF decides to utilize user plane positioning, the LMF sends its UP positioning address and security related information to UE to trigger the UP connection if it is not available.\n-\tLMF and UE may maintain the established user plane connection between UE and LMF for subsequent LCS session. Protocol to be used for User Plan connection may be decided by SA WG3 and by Stage 3 based on considering the proposed alternatives:\n-\tThe user plane connections can be supported using other transport decided by CT WG1 and common security procedures and protocol to be determined by SA WG3.\n-\tAs per both TS 38.305 [6] from RAN and TS 23.271 [4] for GERAN/UTRAN/E-UTRAN, the User Plane work aligned with both RAN and 2G/3G/4G may use solution#2.\n-\tThe UP connection between UE and LMF supports LPP message transfer and Supplementary service.\n-\tA user plane connection may be used between a UE and AF or LCS Client as defined in Solution #19 for a periodic or triggered MT-LR for the case where UE based location is used and where the UE determines location estimates. The AF or LCS Client address and security related information is then provided to the UE in the MT-LR request. The UE establishes the user plane connection to the AF or LCS Client and uses it to send event reports to the AF or LCS Client.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.2\tKey Issue #2: enhanced positioning architecture for NPN deployment",
                    "description": "",
                    "summary": "",
                    "text_content": "The Local AMF/Any AMF in NPN deployment is used to transfer the Non-UE Associated Network Assistance Data between the RAN and LMF, as described in solution 4 and solution 5.\nFor UE Associated Network Positioning procedure, the LMF sends the UE Associated Network Positing message towards the RAN via the serving AMF. RAN responds UE Associated Network Positioning message to LMF via the serving AMF.\nThe LMF notifies the UE location to GMLC directly, i.e. without going through the serving AMF.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.3\tKey Issue #3: Local Area Restriction for an LMF and GMLC",
                    "description": "",
                    "summary": "",
                    "text_content": "The following aspects are concluded for normative work:\nAspect 1: Provisioning of LMF ID:\n1.\tLCS Data in the GMLC for an LCS Client/AF, maybe enhanced by adding the following parameters:\n-\tLMF ID;\n-\tGroup ID and its correlating LMF ID.\nWhen the GMLC receives a MT location request from LCS client/AF, GMLC determines the LMF ID based on the LCS Data context per LCS client/AF.\nIf that group ID can be provided or derived from the LCS request, GMLC determines the LMF ID based on the provisioned Group ID.\n2.\tGMLC may be configured with an LMF ID, and irrelevant to any LCS client/AF. When the GMLC receives a MT location request from LCS client/AF, GMLC determines the LMF ID for all LCS client/AF.\n3.\tUDM may be enhanced in the UE LCS subscriber data by adding a correlating LMF ID, and GMLC fetches it when interacting with UDM.\n4.\tAMF maybe configured locally, a mapping table of UE identity e.g. MSISDN and LMF/GMLC address, When receiving a MO-LR, AMF determines LMF and GMLC based on local configuration.\nAspect 2: LMF selection:\n-\tThe GMLC provides LMF ID to AMF or AMF determines the LMF ID based on aspect 1. The AMF uses the LMF ID to select the LMF.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.4\tKey Issue #4: Interaction between Location Service and NWDAF",
                    "description": "",
                    "summary": "",
                    "text_content": "Key issue#4 details the questions to be studied for WT#2 in FS_eLCS_Ph3 SID which includes the following three aspects:\n-\tAspect#1: how the location services can benefit from NWDAF;\n-\tAspect#2: how the NWDAF use cases can benefit from location service; and\n-\tAspect#3: how to provide location information to NWDAF.\nThe interim conclusion for aspect#1 is as follows:\nNOTE 1:\tIn this aspect, as the beneficiary is LCS system, LCS will do the conclusion and inform FS_eNA_Ph3 about the requirements to NWDAF (eNA_Ph3 Key Issue#9) for the enhancement of LCS system.\n-\tNWDAF provides new analytics for Location Estimation Accuracy. The location accuracy analytics include  horizontal or vertical accuracy, indoor/outdoor indication.\n-\tSolutions 11 and 20 will be used as a basis to derive location estimation accuracy analytics. Further details on input data for the new location accuracy analytics will be determined during the normative phase in coordination with eNA_Ph3.\n-\tLMF as a NWDAF consumer of such analytics uses Location Estimation Accuracy analytics to determine Position Method in the area where a UE is located.\n-\tLocation client as a consumer of such analytics uses Location Estimation Accuracy to determine a requested LCS QoS class or adjust application specific parameters (out of scope of 3GPP).\nThe interim conclusion for aspect#2 is as follows:\nNOTE 2:\tIn this aspect, as the beneficiary is NWDAF, NWDAF (FS_eNA_Ph3 Key Issue#9) is expected be informed with the possibilities and benefits from LCS.\nNOTE 3:\tFS_eNA_Ph3 Key Issue#9 required enhancements to LCS system will be evaluated, coordinated in this aspect based on coordination decision.\n-\tThe NWDAF can retrieve indoor/outdoor indication if it can be decided by LMF.\n-\tThe NWDAF can provide as part of Location Estimation Accuracy a ratio of NLOS/LOS measurements, if LMF receives the NLOS/LOS measurement indicator from the UE in the measurement report.\nThe interim conclusion for aspect#3 is as follows:\n-\tThe NWDAF retrieves location data from the GMLC using the Ngmlc services.\n-\tTo support privacy check, new LCS Client Type and Service Type is introduced and is used by NWDAF to request UE location:\n-\tnew LCS Client Types for PLMN Operator Class:\n-\tNWDAF client in the HPLMN (when the UE is currently being served by the HPLMN);\n-\tNWDAF client in the VPLMN.\n-\tnew standardized Service Type for Tracking Services:\n-\tAnalytics;\n-\tModel training.\n-\tTo support reporting of finer granularity UE location information in a target geographical area in form of any shape comparing with TA/cell to the NWDAF, the enhancements for LCS system include:\n-\tThe NWDAF provides to LCS system a target geographical area and a new location event reporting condition, i.e. reporting only when the UE locates in the exact target geographical area;\n-\tBy comparing UE location information with the target geographical area, the LCS system reports the UE location information to the NWDAF once UE locates in the target geographical area.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.5\tKey Issue #5: Assistance data provisioning for low power high accuracy GNSS positioning",
                    "description": "",
                    "summary": "",
                    "text_content": "LMF reuses the AF event exposure service to collect nearby GNSS assistance data.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.6\tKey Issue #6: UE Positioning without UE/User Awareness",
                    "description": "",
                    "summary": "",
                    "text_content": "For key issue #6, it is concluded that solution#14 (UE unaware indication) is used as the baseline for normative work.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.7\tKey Issue #7: Support of Positioning Reference Units and Reference UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "To support PRU, the conclusions are as follows:\n-\tFor PRU Registration, the  conclusions include:\n-\tUE sends UL NAS Transport including PRU Registration Request to AMF.\n-\tThe PRU Registration is an LCS supplementary service message and has no new AMF impact.\n-\tAMF sends the PRU Registration Request to LMF and may include a UE verification indication indicating whether this UE can serve as a PRU.\n-\tPRU Registration Request includes PRU information.\n-\tPRU information may include PRU's positioning capability, location information (if known), type and state of the PRU (e.g. mobile/static type, on/off state)\n-\tThe PRU may register with multiple LMFs. e.g. for the case a PRU is in multiple LMF overlapped serving areas.\n-\tLMF may indicate to NRF the PRU information or may store PRU information locally based on operator policy.\n-\tLMF stores PRU information and may indicate to NRF the PRU existence in its NF profile.\n-\tWhen the PRU information is provided to the NRF:\n-\tThe serving LMF invokes the Nnrf_NFManagement_NFUpdate service operation to store the PRU information in the LMF profile already stored in the NRF.\n-\tWhen other LMF needs to obtain the PRU information for a certain area, the LMF just invokes the Nnrf_NFDiscovery including NF type which is set to LMF and indicates the area. NRF will return the profile including PRU information of the LMFs covering the area.\n-\tThe target UE serving LMF may obtain PRU information locally, or may obtain PRU information and a PRU serving LMF from an NRF.\n-\tA mobile PRU may lead to the update of registration at serving LMF and/or registration at a new LMF.\n-\tA serving LMF of PRU obtains PRU location measurements as described in clause 5.4.5 of TS 38.305 [6] by triggering the existing procedures defined in clause 6.11 of TS 23.273 [5]:\n-\tTo improve target UE positioning, the serving LMF of the target UE may obtain PRU location measurements from a serving LMF of PRU.\nTo support Reference UE, the interim conclusion is as follows:\n-\tIn this study, the Reference UE is the PRU.\nNOTE:\tThe above Reference UE conclusion applies only to FS_eLCS_Ph3. Other uses of Reference UE as defined in other R18 studies do not require Reference UE to be a PRU.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.8\tKey Issue #8: Support of location service continuity in case of UE mobility",
                    "description": "",
                    "summary": "",
                    "text_content": "Normative work will take place according to principles described in this clause:\nFor 5GS -> EPS mobility:\n-\t(During Hand-over) The source AMF shall cancel the LCS session (e.g. to LMF), responding to GMLC with a new cause for HO and with the target MME ID.\n-\tGMLC then initiates a new location request to the target MME identified in AMF message cancelling the LCS session over 5GS possibly translating location parameters such as QoS, user Id (no privacy check is needed).\n-\tThe location procedure takes place in EPS ; location estimation is returned to GMLC which returns the estimate to LCS Client.\nNOTE:\tThis ensures a common procedure for all types of location and positioning methods (and regardless of where the hand-over takes place in the on-going location procedure) with no impacts to EPS.\nFor EPS -> 5GS mobility:\n-\t(During Hand-over) The source MME shall cancel the LCS session over EPS as currently specified, and responds to GMLC with a new cause for HO and with the target AMF ID.\n-\tGMLC then initiates location request to target AMF identified in MME cancel message possibly translating location parameters such as QoS, user Id (no privacy check is needed).\n-\tThe location procedure takes place in 5GS ; location estimation is returned to GMLC which returns the estimate to LCS Client.\nFor both direction of mobility between 5GS and EPS, the GMLC used over 5GS (respectively EPS) can issue location request over EPS (respectively 5GS).\nBased on operator policy, the following alternative solution could be considered.\n-\tFor periodic/deferred location service continuity from 5GS to EPS:\n-\tThe LMF should determine whether UE can move between 5GS and EPS and notify UE the corresponding location QoS can be applied to EPS.\n-\tAfter the location event is triggered, the UE should determine and send the suitable event triggered message and carry the suitable location QoS which can be applicable to EPS.\n-\tFor periodic/deferred location service continuity from EPS to 5GS:\n-\tAfter the location event is triggered, the UE should determine and send the suitable event triggered message which can be applicable to 5GS.\n-\tFor both non-periodic/deferred location service continuity and periodic/deferred location service continuity:\n-\tThe LMF should determine the location information including the location QoS can be applicable to EPS, GMLC notify this information to E-SMLC to trigger the location procedure start in EPS.\n-\tAfter handover complete, the AMF/MME should notify GMLC.\nFor mobility between NG-RAN nodes in connected mode:\n-\tS-AMF shares LCS session details to T-AMF as part of HO preparation.\n-\tT-AMF notifies to LMF after HO completion.\n-\tLMF continues with the LCS Session with new configuration.\n-\tLMF responds with UE location to the T-AMF which responds to the LCS Client via the GMLC(s).\nFor mobility between NG-RAN node while the UE was RRC-INACTIVE:\n-\tThe current solution defined in R17 (clauses 6.7.3, 6.7.4, 6.7.5 of TS 23.273 [5]) is reused.\nFor mobility in RRC-IDLE:\n-\tReuse of the solution 22 (where location transfer happens from the old AMF to new AMF), as defined for connected mode in Solution #22, is used.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.9\tKey Issue #9: Support of Positioning Requirements Related to Satellite Access",
                    "description": "",
                    "summary": "",
                    "text_content": "Based on the KI#9 evaluation documented in clause 7.9, the following aspects are concluded as basis for normative work:\n-\tVerification of UE location provided via satellite access should be performed leveraging the LCS framework at the 5GC.\n-\tThe AMF is the entity in charge of providing the location verification decision, in line with Rel-17 mechanism of UE location verification:\n-\tThe AMF may trigger location service procedures as defined in TS 23.273 [5] to determine the UE location verification decision and optional TAI determination. Location information received at AMF is provided by LMF via the NI-LR procedure. The LMF may decide specific positioning methods to be used for verification based on RAN WG decisions.\n-\tThe AMF may receive assistance information from NWDAF (i.e. analytics containing UE location information) to perform the location verification decision.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.10\tKey Issue #10: Support of Reduced Latency",
                    "description": "",
                    "summary": "",
                    "text_content": "It is proposed to concluded as follows for KI#10:\n-\tWhen UPF and LMF are located at edge while AMF at centre, user plane based positioning can reduce the LPP message transfer latency between UE and LMF.\n-\tBy co-deployment of GMLC and LMF at edge, the latency of periodic or deferred location report from LMF to AF/LCS client through GMLC can be reduced.\n-\tBy using a user plane connection between a UE and an AF or LCS Client, end to end latency for a periodic or triggered MT-LR can be minimized if a target UE is able to determine the location estimates.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.11\tKey Issue #11: Enhance the Triggered Location for UE power saving purpose",
                    "description": "",
                    "summary": "",
                    "text_content": "For key issue #11, it is concluded that solution#25 (Event Report in an Allowed Area) is used as the baseline for normative work with the two ambiguous aspects identified in clause 7.11 also being resolved in the normative phase.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.12\tKey Issue #12: support of low power and/or high accuracy positioning",
                    "description": "",
                    "summary": "",
                    "text_content": "The following aspects are concluded for normative work:\n-\tUDM is enhanced to include LPHAP indication in the UE LCS subscription data.\n-\tDuring the positioning procedure, AMF provides the LPHAP indication to the LMF, either obtaining from the GMLC, or in the UE LCS context which received during UE registration procedure.\n-\tLMF is enhanced to receive from AMF of the LPHAP indication in the location request, and determine positioning method, by taking into account the LPHAP requirement. LMF also sends LPHAP indication to RAN in the NRPPa message.\nNOTE:\tRAN impact needs to coordinate with RAN WG, e.g. whether LPHAP indication needs to be sent to RAN at an earlier time, before positioning procedure is triggered.\n\n",
                    "tables": [
                        {
                            "description": "",
                            "table number": 22,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        }
    ]
}