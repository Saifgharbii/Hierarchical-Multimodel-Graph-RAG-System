{
    "document_name": "24302-i40.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document specifies the discovery and network selection procedures for access to 3GPP Evolved Packet Core (EPC) via non-3GPP access networks and includes Authentication and Access Authorization using Authentication, Authorization and Accounting (AAA) procedures used for the interworking of the 3GPP EPC and the non-3GPP access networks.\nThe present document also specifies the Tunnel management procedures used for establishing an end-to-end tunnel from the UE to the ePDG to the point of obtaining IP connectivity and includes the selection of the IP mobility mode.\nThe non-3GPP access networks considered in this present document are cdma2000® HRPD and Worldwide Interoperability for Microwave Access (WiMAX), and any access technologies covered in 3GPP TS 23.402 [6]. The present document also specifies UE access to PLMN IP-based services via restrictive non-3GPP access networks covered in 3GPP TS 33.402 [15]. These non-3GPP access networks can be trusted or untrusted access networks.\nThe present document is applicable to the UE and the network. In this technical specification the network is the 3GPP EPC.\nNOTE:\tcdma2000® is a registered trademark of the Telecommunications Industry Association (TIA-USA).\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\tVoid.\n[2A]\t3GPP TS 23.002: \"Network architecture\".\n[3]\t3GPP TS 23.003: \"Numbering, addressing and identification\".\n[4]\t3GPP TS 23.122: \"Non-Access-Stratum (NAS) functions related to Mobile Station (MS) in idle mode\".\n[5]\tVoid.\n[5A]\t3GPP TS 23.203: \"Policy and Charging Control Architecture\".\n[6]\t3GPP TS 23.402: \"Architecture enhancements for non-3GPP accesses\".\n[6A]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[7]\tVoid.\n[8]\tVoid.\n[9]\t3GPP TS 24.234 v12.2.0: \"3GPP System to Wireless Local Area Network (WLAN) interworking; WLAN User Equipment (WLAN UE) to network protocols\".\n[10]\t3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet System (EPS)\".\n[11]\t3GPP TS 24.303: \"Mobility management based on Dual-Stack Mobile IPv6\".\n[12]\t3GPP TS 24.304: \"Mobility management based on Mobile IPv4; User Equipment (UE) - Foreign Agent interface\".\n[13]\t3GPP TS 24.312: \"Access Network Discovery and Selection Function (ANDSF) Management Object (MO)\".\n[14]\t3GPP TS 25.304: \"User Equipment (UE) procedures in idle mode and procedures for cell reselection in connected mode\".\n[14A]\t3GPP TS 25.331: \"Radio Resource Control (RRC); Protocol Specification\".\n[15]\t3GPP TS 33.402: \"3GPP System Architecture Evolution: Security aspects of non-3GPP accesses\".\n[16]\t3GPP TS 36.304: \"Evolved Universal Terrestrial Radio Access (E-UTRA); User Equipment (UE) procedures in idle mode\".\n[16A]\t3GPP TS 45.008: \"Radio Access Network; Radio subsystem link control\".\n[16B]\t3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA) Radio Resource Control (RRC); Protocol specification\".\n[17]\t3GPP TS 29.273: \"Evolved Packet System; 3GPP EPS AAA Interfaces\".\n[18]\t3GPP TS 29.275: \"Proxy Mobile IPv6 (PMIPv6) based Mobility and Tunnelling protocols\".\n[19]\t3GPP TS 29.276: \"Optimized Handover Procedures and Protocols between EUTRAN Access and cdma2000 HRPD Access\".\n[20]\t3GPP2 X.S0057-B v2.0: \"E-UTRAN - HRPD Connectivity and Interworking: Core Network Aspects\".\n[21]\t3GPP2 C.S0087-A v4.0: \"E-UTRAN – HRPD and CDMA2000 1x Connectivity and Interworking: Air Interface Aspects\".\n[22]\tVoid.\n[23]\t3GPP2 C.S0024-B v3.0: \"cdma2000® High Rate Packet Data Air Interface Specification\".\n[23A]\t3GPP2 C.S0016-D v1.0: \"Over-the-Air Service Provisioning of Mobile Stations in Spread Spectrum Standards\".\n[24]\tWiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 2: \"Architecture Tenets, Reference Model and Reference Points\", November 2007.\n[25]\tWiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 3: \"Detailed Protocols and Procedures\", November 2007.\n[26]\tWiMAX Forum  System Profile Release 1.0 Approved Specification Revision 1.4.0, April 2007.\n[27]\tIEEE Std 802.16e-2005 and IEEE Std 802.16-2004/Cor1-2005: \"IEEE Standard for Local and Metropolitan Area Networks, Part 16: Air Interface for Fixed and Mobile Broadband Wireless Access Systems Amendments 2 and Corrigendum 1\", February 2006.\n[28]\tIETF RFC 7296 7296 (October 2014): \"Internet Key Exchange Protocol Version 2 (IKEv2)\".\n[29]\tIETF RFC 3748 (June 2004): \"Extensible Authentication Protocol (EAP)\".\n[30]\tIETF RFC 4301 (December 2005): \"Security Architecture for the Internet Protocol\".\n[31]\tIETF RFC 4555 (June 2006): \"IKEv2 Mobility and Multihoming Protocol (MOBIKE)\".\n[32]\tIETF RFC 4303 (December 2005): \"IP Encapsulating Security Payload (ESP)\".\n[33]\tIETF RFC 4187 (January 2006): \"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)\"\n[34]\tIETF RFC 3629 (November 2003): \"UTF-8, a transformation format of ISO 10646\".\n[35]\tIETF RFC 1035 (November 1987): \"DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION\".\n[36]\tVoid.\n[37]\tIETF RFC 6153 (February 2011): \"DHCPv4 and DHCPv6 Options for Access Network Discovery and Selection Function (ANDSF) Discovery\".\n[38]\tIETF RFC 5448 (May 2009): \"Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')\".\n[39]\tOMA-ERELD-DM-V1_2: \"Enabler Release Definition for OMA Device Management\".\n[40]\tVoid\n[41]\t\"Unicode 5.1.0, Unicode Standard Annex #15; Unicode Normalization Forms\", March 2008. .\n[42]\t3GPP TS 33.220: \"Generic Authentication Architecture (GAA); Generic bootstrapping architecture\".\n[43]\t3GPP TS 29.109: \"Generic Authentication Architecture (GAA); Zh and Zn Interfaces based on the Diameter protocol\".\n[44]\t3GPP TS 33.222: \"Generic Authentication Architecture (GAA); Access to network application functions using Hypertext Transfer Protocol over Transport Layer Security (HTTPS)\".\n[45]\t3GPP TS 31.102: \"Characteristics of the Universal Subscriber Identity Module (USIM) application\".\n[46]\t3GPP TS 24.008: \" radio interface Layer 3 specification; Core network protocols; Stage 3\".\n[47]\t3GPP TS 33.223: \"Generic Authentication Architecture (GAA); Generic Bootstrapping Architecture (GBA) Push function\".\n[48]\t3GPP TS 24.007: \" radio interface signalling layer 3; General aspects\".\n[49]\tIETF RFC 4739: \"Multiple Authentication Exchanges in the Internet Key Exchange (IKEv2) Protocol\".\n[50]\t3GPP TS 29.274: \"Tunnelling Protocol for Control plane (GTPv2-C)\".\n[51]\t3GPP TS 24.139: \"3GPP System-Fixed Broadband Access Network Interworking; Stage 3\".\n[52]\t3GPP TS 24.109: \"Bootstrapping interface (Ub) and network application function interface (Ua); Protocol details\".\n[53]\tIETF RFC 2817 (May 2000): \"Upgrading to TLS Within HTTP/1.1\".\n[54]\tVoid.\n[55]\tVoid.\n[56]\t3GPP TS 24.244: \"Wireless LAN control plane protocol for trusted WLAN access to EPC\".\n[57]\tIEEE Std 802.11-2016: \"IEEE Standard for Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks - Specific requirements - Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications\".\n[58]\tIEEE Std 802-2014: \"IEEE Standard for Local and Metropolitan Area Networks: Overview and Architecture\", 30th June 2014.\n[59]\tVoid.\n[60]\tIETF RFC 4284 (January 2006): \"Identity Selection Hints for the Extensible Authentication Protocol (EAP)\".\n[61]\tIEEE Std 802.1X™-2010: \"IEEE Standard for Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks - Port-based Network Access Control\".\n[62]\tIETF RFC 4282: \"The Network Access Identifier\".\n[63]\tITU-T Recommendation E.212: \"The international identification plan for mobile terminals and mobile users\".\n[64]\tIETF RFC 7651 (September 2015): \"3GPP IP Multimedia Subsystems (IMS) Option for the Internet Key Exchange Protocol Version 2 (IKEv2)\".\n[65]\t3GPP TS 33.310: \"Network Domain Security (NDS); Authentication Framework (AF)\".\n[66]\t3GPP TS 23.380: \"IMS Restoration Procedures\".\n[67]\t3GPP TS 24.229: \"IP multimedia call control protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".\n[68]\t3GPP TS 23.161: \"Network-Based IP Flow Mobility (NBIFOM); Stage 2\".\n[69]\t3GPP TS 24.161: \"Network-Based IP Flow Mobility (NBIFOM); Stage 3\".\n[70]\t3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Overall description; Stage 2\".\n[70A]\tIETF RFC 4309 (December 2005): \"Internet Key Exchange Protocol Version 2 (IKEv2)\".\n[70B]\tIETF RFC 7296 (October 2014): \"Internet Key Exchange Protocol Version 2 (IKEv2)\".\n[71]\tIETF RFC 6696 (July 2012): \"EAP Extensions for the EAP Re-authentication Protocol (ERP)\".\n[72]\tIETF RFC 3948 (January 2005): \"UDP Encapsulation of IPsec ESP Packets\".\n[73]\tIETF RFC 2234 (November 1997): \"Augmented BNF for Syntax Specification: ABNF\".\n[74]\tIETF RFC 5279 (July 2008): \"A Uniform Resource Name (URN) Namespace for the 3rd Generation Partnership Project (3GPP)\".\n[75]\tIETF RFC 2474 (December 1998): \"Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers\".\n[76]\t3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS); Stage3\".\n[77]\t3GPP TR 24.502: \"Access to the 3GPP 5G Core Network (5GCN) via non-3GPP access networks\".\n[78]\t3GPP TS 33.501: \"Security architecture and procedures for 5G System\".\n[79]\t3GPP TS 24.193: \"Access Traffic Steering, Switching and Splitting (ATSSS); Stage 3\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tDefinitions",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms and definitions given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].\nAccess Network Discovery and Selection Function: In this specification, Access Network Discovery and Selection Function (ANDSF) is a network element specified in 3GPP TS 23.402 [6]. Unless otherwise specified, the term ANDSF is used to refer to both Home and Visited ANDSF.\nANDSF rules: In this specification, ANDSF rules refers to the set of ANDSF policies defined in 3GPP TS 24.312 [13] for WLAN access selection and traffic routing between E-UTRAN or UTRAN and WLAN. ANDSF rules can contain RAN validity conditions for RAN-assisted WLAN interworking.\nEmergency session: In this specification, an emergency session refers to an emergency PDN connection established in E-UTRAN and handed over to a S2a based cdma2000® HRPD access network, or an emergency PDN connection established over trusted or untrusted WLAN access, or an emergency PDN connection established in 3GPP access and handed over to trusted or untrusted WLAN access.\nEquivalent home service provider: In this specification, equivalent home service provider is a service provider that is equivalent to HPLMN in regard to service provider selection over WLAN.\nEquivalent visited service provider: In this specification, equivalent visited service provider is a service provider that is equivalent to the V-PLMN in regard to service provider selection over WLAN.\nHome ANDSF: In this specification, the Home ANDSF (H-ANDSF) is an ANDSF element located in the home PLMN of a UE.\nOffload Preference Indicator (OPI): In this specification, Offload Preference Indicator (OPI) is a bitmap (i.e. a one-dimensional bit array) that can be used by UEs in an E-UTRA or UTRA cell to determine when to move certain traffic (e.g. certain IP flows) to WLAN access or to 3GPP access. The meaning of each bit in this bitmap is operator specific and is not defined in 3GPP specifications.\nOffloadable PDN connection: In this specification, an offloadable PDN connection is a PDN connection, established in (or previously handed over to) 3GPP access, such that:\n-\tthe WLAN offload indication information element (see 3GPP TS 24.301 [10] and 3GPP TS 24.008 [46]) last received for the PDN connection has the \"offloading the traffic of the PDN connection via a WLAN when in S1 mode is acceptable\" value and the UE is in S1 mode; or\n-\tthe WLAN offload indication information element (see 3GPP TS 24.301 [10] and 3GPP TS 24.008 [46]) last received for the PDN connection has the \"offloading the traffic of the PDN connection via a WLAN when in UTRAN Iu mode is acceptable\" value and the UE is in UTRAN Iu mode.\nPreferred Service Providers List (PSPL): In this specification, the Preferred Service Providers List refers to a prioritized list of service provider realms other than equivalent home service providers preferred by the UE's 3GPP home operator for WLAN.\nSet of Access network discovery information: In this specification, a set of Access network discovery information is the access network discovery information from a single ANDSF.\nSet of Inter-system mobility policy: In this specification, a set of Inter-system mobility policy is the inter-system policy information received from a single ANDSF.\nVisited ANDSF: In this specification, the Visited ANDSF (V-ANDSF) is an ANDSF element located in the visited PLMN of a UE.\nRAN Assistance Information: In this specification, RAN Assistance Information refers to the set of thresholds and parameters that can be provided by E-UTRAN or UTRAN to the UE for assisting WLAN access selection and traffic routing. The RAN assistance information can include 3GPP access thresholds, WLAN access thresholds, an Offload Preference Indicator (OPI) value and WLAN identifiers as defined in 3GPP TS 25.331 [14A] and 3GPP TS 36.331 [16B].\nRAN rules: In this specification, RAN rules refers to the set of RAN assistance parameter and RAN steering command handling, access network selection and traffic steering procedures defined in 3GPP TS 36.304 [16], 3GPP TS 25.304 [14] and 3GPP TS 36.331 [16B] for the steering of traffic between E-UTRAN or UTRAN and WLAN associated with RAN-controlled LTE-WLAN interworking or RAN-assisted WLAN interworking.\nRestrictive non-3GPP access network type I: a non-3GPP access network forwarding IP packets of TCP connections initiated by a served UE, with destination port 443, and with destination address outside of the non-3GPP access network, and discarding IP packets of some or all other TCP connections initiated by the served UE, with destination address outside of the non-3GPP access network.\nRestrictive non-3GPP access network type II: a non-3GPP access network discarding IP packets of TCP connections initiated by a served UE, with destination address outside of the non-3GPP access network, where the non-3GPP access network contains HTTP proxy supporting HTTP CONNECT method for URIs with port 443 and with host outside of the non-3GPP access network.\nRestrictive non-3GPP access network: restrictive non-3GPP access network type I or restrictive non-3GPP access network type II.\nFirewall traversal tunnel (FTT): a TCP connection with TLS connection enabling passing of messages between UE in restrictive non-3GPP access network and ePDG.\nFirewall traversal tunnel keep-alive time (FTT KAT): a maximum time between two subsequent messages sent by UE in the firewall traversal tunnel.\nUnauthenticated IMSI: In this specification, the term \"unauthenticated IMSI\" or the term \"IMSI is unauthenticated\" is only pertinent to the network. The knowledge that a UE's IMSI is unauthenticated or that the UE has an unauthenticated IMSI, is not available to the UE.\nWLAN Selection Policy (WLANSP): In this specification, the WLAN Selection Policy is a set of operator-defined rules that determine how the UE selects/reselects a WLAN access network.\nWLAN selection information: In this specification, WLAN selection information refers to the information received from ANDSF including WLAN Selection Policy (WLANSP), rule selection information, Home Network Preference information and Visited Network Preference information as specified in 3GPP TS 24.312 [13].\nVisited PLMNs with preferred rules: In this specification, visited PLMNs with preferred rules included in the rule selection information refers to a list of identifiers of visited PLMNs provided by HPLMN, so that the UE roaming in such visited PLMN prefers ISMP, ISRP or WLANSP rules provided by the visited PLMN over ISMP, ISRP or WLANSP rules provided the HPLMN. In ANDSF MO, the visited PLMNs with preferred rules correspond to the ANDSF/RuleSelectionInformation/VPLMNswithPreferredRules interior node.\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.122 [4] apply:\nAcceptable cell\nEHPLMN\nHome PLMN\nLimited service state\nRPLMN\nVisited PLMN\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.402 [6] apply:\nIFOM capable UE\nInter-APN routing capable UE\nLocal Operating Environment Information\nMAPCON capable UE\nS2a\nS2b\nS2c\nNon-seamless WLAN offload capable UE\nSingle-connection mode (SCM)\nTransparent single-connection mode (TSCM)\nMulti-connection mode (MCM)\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 29.273 [17] apply:\nSTa\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 24.301 [10] apply:\nEvolved packet core network\nEvolved packet system\nFor the purposes of the present document, the following terms and definitions given in WiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 3 [25] apply:\nNetwork Access Provider\nNetwork Service Provider\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 33.402 [15] apply:\nExternal AAA server\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 24.312 [13] apply:\nActive rule\nValid rule\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.003 [3] that relate to access to 3GPP evolved packet core via non-3GPP access networks, apply:\nNAI\nAlternative NAI\nDecorated NAI\nEmergency NAI\nFast-Reauthentication NAI\nPseudonym Identity\nRoot NAI\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.002 [2A] apply:\n3GPP AAA Proxy\n3GPP AAA Server\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.161 [68] apply:\nNBIFOM\nRouting Rule\nUE-inititaed NBIFOM\nNetwork-initiated NBIFOM\nMulti-access PDN connection\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 24.501 [76] apply:\nN1 mode\nPDU session ID\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\nAAA\tAuthentication, Authorization and Accounting\nACL\tAccess Control List\nAKA\tAuthentication and Key Agreement\nANDSF\tAccess Network Discovery and Selection Function\nANDSF-SN\tAccess Network Discovery and Selection Function Server Name\nANID\tAccess Network Identity\nANQP\tAccess Network Query Protocol\nAPN\tAccess Point Name\nDHCP\tDynamic Host Configuration Protocol\nDM\tDevice Management\nDNS\tDomain Name System\nDSCP\tDifferentiated Services Code Point\nDSMIPv6\tDual-Stack MIPv6\neAN/PCF\tEvolved Access Network Packet Control Function\nEAP\tExtensible Authentication Protocol\nEPC\tEvolved Packet Core\nePDG\tEvolved Packet Data Gateway\nEPS\tEvolved Packet System\nERP\tEAP Re-authentication Protocol\nESP\tEncapsulating Security Payload\nFQDN\tFully Qualified Domain Name\nGAA\tGeneric Authentication Architecture\nGBA\tGeneric Bootstrapping Architecture\nHA\tHome Agent\nH-ANDSF\tHome-ANDSF\nHRPD\tHigh Rate Packet Data\nHSGW\tHRPD Serving Gateway\nIEEE\tInstitute of Electrical and Electronics Engineers\nIFOM\tIP Flow Mobility\nIKEv2\tInternet Key Exchange version 2\nIARP\tInter-APN Routing Policy\nIPMS\tIP Mobility Mode Selection\nISMP\tInter-system Mobility Policy\nISRP\tInter-system Routing Policy\nIANA\tInternet Assigned Numbers Authority\nI-WLAN\tInterworking – WLAN\nMAPCON\tMulti Access PDN Connectivity\nMCM\tMulti-connection mode\nMO\tManagement Object\nMPS\tMultimedia Priority Service\nNAI\tNetwork Access Identifier\nNAP\tNetwork Access Provider\nNBIFOM\tNetwork-Based IP Flow Mobility\nNBM\tNetwork based mobility management\nNSP\tNetwork Service Provider\nNSSAI\tNetwork Slice Selection Assistance Information\nNSWO\tNon-Seamless WLAN Offload\nNSWOF\tNon-Seamless WLAN Offload Function\nOMA\tOpen Mobile Alliance\nOPI\tOffload Preference Indicator\nPCO\tProtocol Configuration Options\nP-GW\tPDN Gateway\nPDU\tProtocol Data Unit\nPSPL\tPreferred Service Provider List\nQoS\tQuality of Service\nSCM\tSingle-connection mode\nS-GW\tServing Gateway\nS-NSSAI\tSingle NSSAI\nSPI\tSecurity Parameters Index\nTFT\tTraffic Flow Template\nTSCM\tTransparent single-connection mode\nUE\tUser Equipment\nUICC\tUniversal Integrated Circuit Card\nV-ANDSF\tVisited-ANDSF\nW-APN\tWLAN APN\nWiMAX\tWorldwide Interoperability for Microwave Access\nWLAN\tWireless Local Area Network\nWLANSP\tWLAN Selection Policy\nWLCP\tWLAN Control Protocol\nWMF\tWiMAX Forum\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tGeneral",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tTrusted and untrusted accesses",
                    "description": "",
                    "summary": "",
                    "text_content": "The HPLMN operator of the EPC selects whether a connected non-3GPP IP access network is a trusted or untrusted IP access network.\nFor a trusted non-3GPP IP access network the communication between the UE and the EPC is secure. For an untrusted non-3GPP IP access network the communication between the UE and the EPC is not trusted to be secure.\nFor a trusted non-3GPP IP access network, all communication between the access network and the EPC is transferred over pre-established secure links. For an untrusted non-3GPP IP access network, to secure communication between the UE and the EPC:\n-\ta single IPSec tunnel needs to be established to the ePDG for all PDN connections when the UE accesses EPC via S is used; or\n-\tan IPSec tunnel needs to be established with the same ePDG for each PDN connection when the UE accesses EPC via S2b is used.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tcdma2000® HRPD Access System",
                    "description": "",
                    "summary": "",
                    "text_content": "The cdma2000® HRPD system is a wireless mobile system developed under the auspices of 3GPP2. The cdma2000® HRPD system and its access network subsystem is compliant with 3GPP2 X.S0057 [20] and 3GPP2 C.S0087 [21], which define the core network and air interface aspects, respectively.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.3\tWiMAX Access System",
                    "description": "",
                    "summary": "",
                    "text_content": "The WiMAX system is a wireless mobile broadband system developed under the auspices of the WMF and the IEEE. The WiMAX system and its access network subsystem are compliant with WiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 2 [24]. The protocol architecture and signalling of the WiMAX system is specified in WiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 3 [25] which supports the air interface defined in WiMAX Forum Mobile System Profile Release 1.0 Approved Specification Revision 1.4.0 [26] specifying selected profiles of IEEE Std 802.16e-2005 and IEEE Std 802.16-2004/Cor1-2005 [27] that are to be supported. The WiMAX access system correspond to the WiMAX Access Service Network (ASN) and to relevant interfaces, as defined in WiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 3 [25].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.3A\tWLAN",
                    "description": "",
                    "summary": "",
                    "text_content": "WLAN is an access network developed under the auspices of IEEE Computer Society. WLAN is compliant with IEEE Std 802.11 [57], which define air interface aspects.\nIEEE Std 802.11 [57] defines Access Network Query Protocol (ANQP). A UE can receive from an AP ANQP-elements in response to an ANQP query. The ANQP query response is received in a generic advertisement service response frame or a protected management frame.\nWhere needed, the current specification further describes the structure and contents of payload of ANQP-elements specified in IEEE Std 802.11 [57] (see annex H and annex I).\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.4\tIdentities",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.4.1\tUser identities",
                            "text_content": "The user identification shall be either the root NAI, or the decorated NAI, when the UE accesses the EPC via non-3GPP access networks, and gets authentication, authorization and accounting services from the EPC.\nFor emergency services over WLAN:\n-\tif IMSI is not available (i.e. a UE without USIM), the IMEI shall be used for the identification, as user part of the emergency NAI and the UE shall use a specific domain in the realm part of the NAI as specified in 3GPP TS 23.003 [3]; or\n-\tif the UE has an IMSI, it shall use the IMSI for the identification, as user part of the emergency NAI.\nNOTE 1:\tIf the IMSI is unauthenticated on the network side and the network supports emergency session for unauthenticated IMSI, the IMEI is used for the identification on the network side (see clause 6.4.3.1A).\nFor handover of an emergency session from E-UTRAN to a S2a based cdma2000® HRPD access network, if IMSI is not available (i.e. a UE without USIM) or IMSI is unauthenticated, the IMEI shall be used for the identification, as part of the emergency NAI as defined.\nThe UE's Mobile Identity IMEI or IMEISV is conveyed to the network (see clause 6.4 and clause 7) and used to enable consistent services for the UE accessing the network via non-3GPP access or to support the emergency services over WLAN for the unauthenticated UEs.\nNOTE 2:\tIMEI and IMEISV are untrusted identities stored on the UE.\nUser identification in non-3GPP accesses may require additional identities that are out of the scope of 3GPP.\nIETF RFC 4187 [33] and 3GPP TS 23.003 [3] provide definitions for UE and user identities although they use slightly different terms. Similar terms are also used in 3GPP TS 33.402 [15]. The following list provides term equivalencies and describes the relation between various user identities.\n-\tThe Root NAI is to be used as the permanent identity as specified in 3GPP TS 33.402 [15].\n-\tThe Fast-Reauthentication NAI is to be used as the Fast-Reauthentication Identity or the re-authentication ID as specified in 3GPP TS 33.402 [15].\n-\tThe Pseudonym Identity is to be used as the Pseudonym as specified in 3GPP TS 33.402 [15].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.2\tIdentification of IP Services/PDN connections",
                            "text_content": "For access to EPC the Access Point Name (APN) is used for identifying IP services/PDN connections. The detailed definition of APN as used for access to EPC is specified in 3GPP TS 23.003 [3]. APN is conveyed in the IKEv2 signaling during tunnel establishment when S2b interface is used for UE to access EPC. When UE accesses EPC via S2a using trusted WLAN access network, APN is conveyed in EAP-AKA' signaling for single-connection mode (SCM) or in WLAN Control Protocol (WLCP) signaling (see 3GPP TS 24.244 [56]) for multi-connection mode (MCM)\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.3\tFQDN for ePDG Selection",
                            "text_content": "An ePDG Fully Qualified Domain Name (ePDG FQDN) is either provisioned by the home operator or constructed by UE in either the Operator Identifier FQDN format or the Tracking/Location Area Identity FQDN format as described in clause 4.5.4.2 of 3GPP TS 23.402 [6], and used as input to the DNS mechanism for ePDG selection.\nThe detailed format of this ePDG FQDN is specified in 3GPP TS 23.003 [3].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.4\tAccess Network Identity",
                            "text_content": "For access to EPC via S2a using a trusted non-3GPP access network, the UE uses the Access Network Identity (ANID) in the key derivation (see 3GPP TS 33.402 [15]). The handling of the Access Network Identity is described in clause 6.4.2.4 and the generic format and specific values for the Access Network Identity are defined in clause 8.1.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.5\tANDSF Server Name",
                            "text_content": "The ANDSF Server Name (ANDSF-SN) is used for ANDSF discovery. The detailed rules are defined in clause 6.8.2.2.1 and the format of the ANDSF-SN is specified in 3GPP TS 23.003 [3].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.6\tHome Agent address(es)",
                            "text_content": "If DSMIPv6 is used, the Home Agent IPv6 address (and optionally an IPv4 address) are needed. Within this specification, Home Agent address(es) signalling via IKEv2 between the UE and the ePDG is defined in clause 7.4.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.7\tSecurity Parameters Index",
                            "text_content": "The Security Parameters Index (SPI, see IETF RFC 4301 [30]) identifies uniquely a security association between the UE and the ePDG. For the case of NBM using S2b a one to one mapping between SPI and PDN connection applies.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.5\tFixed Broadband Access System",
                    "description": "",
                    "summary": "",
                    "text_content": "The fixed broadband access system is a type of high-speed Internet access for multi-service broadband packet networking. The fixed broadband access system is specified by the Broadband Forum, including addressing interoperability, architecture and management.\nFor support of fixed broadband access interworking, the EPC network procedures are specified in 3GPP TS 24.139 [51].\nThe UE procedures for support of fixed broadband access are specified in 3GPP TS 24.139 [51] and can be used when the EPC network uses the fixed broadband access interworking or the fixed broadband access convergence.\nThe architecture of the fixed broadband access convergence is specified in 3GPP TS 23.203 [5A].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.6\tRestrictive non-3GPP access networks",
                    "description": "",
                    "summary": "",
                    "text_content": "An untrusted non-3GPP access network can be a restrictive non-3GPP access network. When the UE is served by a restrictive non-3GPP access network, the UE and the ePDG follow the additional procedures described in the annex F.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.7\tProvision and handling of local emergency numbers",
                    "description": "",
                    "summary": "",
                    "text_content": "It is a UE implementation option to support the procedures of this clause.\nOnce the UE has a secure connection to a PLMN through non-3GPP access, the UE supports obtaining local emergency numbers by one of the following ways:\ni)\twhen the UE is connected to a PLMN through trusted non-3GPP access, the local emergency numbers is provided through ANQP, within the ANQP payload. The signalling protocol and methods for use of ANQP is as specified in IEEE Std 802.11 [57]. See also annex I;\nii)\twhen the UE is connected to a PLMN through untrusted non-3GPP access, local emergency numbers can be provided through DNS query. See annex J; or\niii)\twhen the UE is connected to a PLMN through untrusted non-3GPP access, local emergency numbers can be provided through IKEv2. See annex K.\nUpon receiving the local emergency numbers through any of the methods indicated above, the UE shall store the local emergency numbers:\na)\tif the Non-3GPP emergency number indicator within the Non-3GPP NW provided policies IE through registration procedures over 3GPP access is set to \"use of non-3GPP emergency numbers permitted\", and:\n-\tif the UE is connected to a PLMN through non-3GPP access and also registered to same PLMN or different PLMN through 3GPP access in the same country, then provide these local emergency numbers to upper layers for the detection of UE initiated emergency call;\n-\tif the UE is connected to a PLMN through non-3GPP access but is also registered to different PLMN through 3GPP access that is not in the same country, then do not use the received local emergency numbers;\nb)\tif the Non-3GPP emergency number indicator within the Non-3GPP NW provided policies IE through registration procedures over 3GPP access is set to \"use of non-3GPP emergency numbers not permitted\", or if no Non-3GPP NW provided policies IE was provided through registration procedures over 3GPP access, then:\n-\tdo not use the received local emergency numbers for the detection of UE initiated emergency call over 3GPP access; and\nc)\tif the UE:\n-\tis connected to a PLMN through non-3GPP access;\n-\tis not registered to any PLMN through 3GPP access;\n-\tis not in limited service state camped on an acceptable cell of any PLMN through 3GPP access; and\n-\tcan determine that the MCC information of the local emergency numbers received over non-3GPP access corresponds to the country in which the UE is located;\nthen, as an implementation option, provide these local emergency numbers to upper layers for the detection of UE initiated emergency call.\nNOTE:\tThe UE determination of the country in which the UE is located, is UE implementation specific.\nThe local emergency numbers, received in any of the methods indicated above:\n-\tare only valid in the country where these local emergency numbers were provided;\n-\treplace only the stored local emergency numbers received over non-3GPP access, if any;\n-\tshall be deleted when UE moves to a country different from where the local emergency numbers were received; and at switch off or removal of the USIM.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.8\tQuality of service support",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.8.1\tGeneral",
                            "text_content": "QoS differentiation may be supported for both trusted WLAN and untrusted WLAN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.8.2\tQoS differentiation in trusted WLAN",
                            "text_content": "For trusted WLAN, QoS differentiation may be supported if Multi-Connection mode (MCM) based access to EPC is used.\nAs part of EAP-AKA' authentication via TWAN, the UE and the TWAN first negotiates TWAN connection mode usage as described in clause 6.4.\nDuring PDN connection establishment, the UE indicates to the TWAG whether WLCP multiple bearer PDN connectivity capability is supported or not, as specified in 3GPP TS 24.244 [56]:\n-\tif the UE does not indicate that WLCP multiple bearer PDN connectivity is supported, or if the UE indicates that WLCP multiple bearer PDN connectivity is supported but the TWAG does not support WLCP multiple bearer PDN connectivity, then QoS differentiation is not supported. Single point-to-point PDN connection is used to carry all S2a bearers traffic between the UE and TWAG; or\n-\tif WLCP multiple bearer PDN connectivity is supported by both the UE and TWAN, then QoS differentiation is supported and multiple bearer PDN connectivity shall be used between the UE and TWAG:\n-\tDuring PDN connection establishment, the TWAG shall establish a default WLCP bearer for the PDN connection. The default WLCP bearer remains established throughout the lifetime of the PDN connection; and\n-\tThe TWAG shall establish a separate WLCP bearer for each additional S2a dedicated bearer of the PDN connection using WLCP signalling as specified in 3GPP TS 24.244 [56]. Each WLCP bearer is associated with TFT and bearer level QoS (i.e. QCI, GBR and MBR) for one-to-one mapping between WLCP bearer and S2a bearer. The TWAG shall maintain the WLCP bearer to the S2a bearer mapping table.\nIf WLCP multiple bearer PDN connectivity is used:\n-\tFor uplink packets, the UE shall select a WLCP bearer based on the uplink packet filters in the TFTs. If no match is found, the UE shall select the WLCP bearer that does not have any uplink packet filter assigned. If all bearers have been assigned an uplink packet filter, the UE shall discard the uplink data packet. The UE shall then use the most recent DSCP value received in the same WLCP bearer from the TWAG or the QCI in WLCP bearer level QoS information to derive the DSCP value for uplink packets. The UE shall provide the user plane connection ID to the lower layers to be used as the MAC address of the TWAG associated with the WLCP bearer. The TWAG shall then route the uplink packets to the corresponding S2a bearers based on the WLCP bearer and the S2a bearer mapping table.\nNOTE 1:\tThe UE can map QCIs to DSCP values, for example, by using the mapping between standardized QCI values and Release 99 3GPP QoS parameter values specified in 3GPP TS 23.401 [4] table E.3, and the mapping between Release 99 3GPP QoS parameter values and DSCP values specified in IEEE Std. 802.11-2012 [57] table V-1.\nNOTE 2:\tThe UE can send the same DSCP as that received in the downlink, in case the privacy of the user is to be protected.\nNOTE 3:\tWhether the UE determines DSCP based on the most recent DSCP value received in the same WLCP bearer from the TWAG or on the QoS mapping is left to the implementation.\n-\tFor downlink packets, the PDN GW routes the packets to S2a bearers based on the downlink packet filters in the TFTs assigned to each of the S2a bearers. The TWAG then selects the corresponding WLCP bearer for the downlink packets based on the the WLCP bearer and the S2a bearer mapping table. The TWAG shall, based on operator policy, use the QCI and the ARP in WLCP bearer level QoS information to derive the DSCP value for downlink packets. The TWAG shall provide the user plane connection ID to the lower layers to be used as the MAC address of the TWAG associated with the WLCP bearer.\nNOTE 4:\tThe TWAG can map QCI to DSCP value, for example, by using the mapping between standardized QCI values and Release 99 3GPP QoS parameter values specified in 3GPP TS 23.401 [4] table E.3, and the mapping between Release 99 3GPP QoS parameter values and DSCP values specified in IEEE Std 802.11 [57] table R-1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.8.3\tQoS differentiation in untrusted non-3GPP access",
                            "text_content": "For untrusted non-3GPP access, QoS differentiation is provided if the UE and the ePDG supports the IKEv2 multiple bearer PDN connectivity and the IKEv2 multiple bearer PDN connectivity is used in the PDN connection as defined in clause 7.2.7 and clause 7.4.6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "5\tNetwork Discovery and Selection",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.0\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The following aspects are included when selecting an EPC network and routing traffic via the EPC network:\n-\taccess network discovery and selection procedures as defined in clause 5.1;\n-\tEPC network selection as defined in clause 5.2; and\n-\tdata traffic routing of IP flows as defined in clause 5.4.\nIf the UE perform reselection of the access network as defined in clause 5.3 and the UE reselects to a different access network, the UE performs the second item and third item of the above bulleted list.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.1\tAccess network discovery and selection procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.1.1\tGeneral",
                            "text_content": "If PLMN selection specified in 3GPP TS 23.122 [4] is applicable (e.g., at switch-on, recovery from lack of 3GPP coverage, or user selection of applicable 3GPP access technology), the PLMN selection to select the highest priority PLMN according to these specifications is performed before any access network discovery. Procedures for EPC selection over non-3GPP access are specified in clause 5.2. In particular, for WLAN access, service provider selection function is specified in the WLAN specific procedures in clause 5.2.3.2\nIn the access network discovery procedure the UE may get from the ANDSF information on available access networks in its vicinity. The UE may obtain this information by querying the ANDSF, and may use this information when determining the presence of operator preferred access networks. Determination of the presence of access networks requires using radio access specific procedures, which are not further described here.\nThe UE determines the presence of several access networks and then selects between them. If a higher priority access network is found connected to the selected service provider or a higher priority service provider, the UE will attempt to attach via that access network.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.2\tAccess network discovery procedure",
                            "text_content": "The UE may initiate communications with the ANDSF for operator preferred access network discovery:\n-\twhen conditions set up within the policies available in the UE are met; or\n-\twhen a user requests for manual selection.\nNOTE 1:\tThe minimum allowed time interval between two consecutive UE initiated requests towards the ANDSF can be set by operator policies.\nNOTE 2:\tThe UE changing of access networks can override the minimum allowed time interval setting.\nThe UE may apply the techniques specific to the non-3GPP access technologies to discover available non-3GPP access networks. Such techniques will not be further described here.\nIn addition, the UE may signal to the ANDSF to obtain information on operator preferred access networks. The discovery of the ANDSF by the UE, the connection to the ANDSF by the UE and the signalling between the UE and the ANDSF are given in clause 6.8.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.3\tAccess network selection procedure",
                            "text_content": "The access network selection may be classified as inter-technology or intra-technology.\nThe UE can use information received from ANDSF for inter-technology access network selection.\nIf the RAN rules control the WLAN access selection and traffic routing as described in clause 6.10.2, the UE uses the information described in clause 6.10.4 for inter-technology access network selection.\nOther mechanisms for inter-technology access network selection are out of scope of this specification.\nIn this release of the specification the use of the following specific intra-technology access network selection procedures is specified.\nThe access network selection process for cdma2000® HRPD access networks shall follow 3GPP2 X.S0057 [20].\nThe access network selection process for WiMAX which encompasses the NAP discovery and access, shall follow the WiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 3 [25].\n5.1.3.2.3.1\tGeneral\nThe purpose of this procedure is to create a prioritized list of selected WLAN(s).\nThe user preferences are used to select between the automatic WLAN selection procedure or the manual WLAN selection procedure.\nThe UE shall determine the prioritized list of selected WLAN(s):\n1)\tif user preferences are present, in accordance with the manual mode WLAN selection procedure (see clause 5.1.3.2.3.2); and\n2)\tif user preferences are not present, in accordance with the automatic mode WLAN selection procedure (see clause 5.1.3.2.3.3).\nThe UE shall use the prioritized list of selected WLAN(s) to select the service provider in the procedure in clause 5.2.3.2.\n5.1.3.2.3.2\tManual mode WLAN selection\nThe UE creates a prioritized list of selected WLAN(s). The creation of the prioritized list is implementation specific.\n5.1.3.2.3.3\tAutomatic mode WLAN selection\nIf the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2, then the selected WLAN(s) are WLAN(s) that fulfil the selection criteria with the highest priority configured in the active ANDSF WLANSP rule.\nIf the RAN rules control the WLAN access selection and traffic routing as described in clause 6.10.2, then the selected WLAN(s) are WLAN(s) matching WLAN identifiers in an entry of the list of the WLAN identifiers received along with the move-traffic-to-WLAN indication as described in clause 6.10.4.\nThe UE determines the selected WLAN(s) according to the following steps:\n1)\tthe UE shall construct prioritized list of available WLANs as follows:\na)\tif the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2, the UE shall use the procedures specified in IEEE Std 802.11 [57] to discover the available WLANs. The UE may perform ANQP procedures as specified in IEEE Std 802.11 [57] to discover the attributes and capabilities of available WLANs. The UE shall compare the attributes and capabilities of the available WLANs with the highest priority selection criterion that has not been used yet in the active WLANSP rule, and construct a prioritized list of available WLANs that fulfil the selection criteria. If there are multiple highest priority selection criteria, it is up to the UE implementation which one to use. In particular, if:\n-\tthe group of selection criteria include the HomeNetworkIndication and it is set to \"1\" (see 3GPP TS 24.312 [13]); and\n-\tthe HomeNetworkPreference:\ni)\tdoes not include 3GPP_RPLMN_Preferred; or\nii)\tincludes 3GPP_RPLMN_Preferred and it is set to \"0\" (see 3GPP TS 24.312 [13]);\nthen a WLAN is included, if:\n-\tthe other selection criteria in the active WLANSP rule are met; and\n-\tthe domain name list (see IEEE Std 802.11 [57]) includes:\ni)\tthe home domain name derived from its IMSI; or\nii)\tany realm in the EquivalentHomeSPs as specified in 3GPP TS 24.312 [13].\nThe priority of a WLAN in the list is set to the WLAN priority defined in the preferredSSIDlist of the matching selection criteria. There may be one or more selected WLANs in the list; and\nb)\tif the RAN rules control the WLAN access selection and traffic routing as described in clause 6.10.2, the UE shall use the procedures specified in IEEE Std 802.11 [57] to discover available WLANs. The UE shall construct a prioritized list of available WLANs and populate it with each discovered WLAN which matches all WLAN identifiers included in an entry of the list of the WLAN identifiers received along with the move-traffic-to-WLAN indication as described in clause 6.10.4. The priority of a discovered WLAN in the prioritized list of available WLANs is decided by the UE in an implementation specific way;\n2)\tif the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2, and if the following conditions are fulfilled:\n-\tthe UE supports the PDN connection establishment over WLAN using the applicable S2a procedures specified in 3GPP TS 23.402 [6];\n-\tthe \"S2a connection preference\" indicator exists and indicates that PDN connection establishment over WLAN using the applicable S2a procedures specified in 3GPP TS 23.402 [6] is preferred; and\n-\tone or more WLANs in the list constructed in step 1) is a trusted non-3GPP IP access network;\nthen the UE considers the WLANs that have the highest priority and indicate the HPLMN or RPLMN in the PLMN list with S2a connectivity IE (see annex H) as the selected WLAN(s).\nOtherwise, the UE considers the WLAN(s) that has or have the highest priority as the selected WLAN(s). And\nNOTE 1:\tWLAN advertises PLMN(s) towards which the S2a connectivity is supported using ANQP-element \"3GPP Cellular Network\" with the PLMN List with S2a Connectivity IE in the payload, according to annex H.\nNOTE 2:\tAdvertising S2a connectivity over a WLAN using EAP signalling is not supported in this version of the specification.\n3)\tif the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2, if there are no WLAN(s selected in step 2), the UE may repeat the procedure from step 1) taking into consideration selection criteria with lower priority from the active WLANSP rule.\nNOTE 3:\tUE implementation can optimize the steps described above, e.g. by combining the ANQP procedures.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.2\tEPC network selection over non-3GPP access",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tGeneral",
                            "text_content": "The following EPC network selection procedures over non-3GPP access are defined:\n1)\tWiMAX specific;\n2)\tEPC network selection via cdma2000® HRPD access is given in 3GPP TS 23.122 [4] with any exceptions detailed in clause 5.3.4;\n3)\tWLAN specific procedures in clause 5 apply: the procedures detail selecting one or more WLANs and (subsequently) selecting one service provider offering services via the WLAN (see clause 5.2.3.2). When the operator of the WLAN requires authentication and the authentication succeeds (see clause 6.4 and 6.5.1), the UE follows the procedures defined for connecting with the EPC. When the UE is connected to EPC through WLAN access, the tunnel is set-up with the ePDG (as described in clause 7 of this document) using a root NAI as defined in 3GPP TS 23.003 [3] or with the HA (as described in 3GPP TS 24.303 [11]); and\n4)\tgeneric EPC network selection for other access technologies not listed above.\nThe UE performs the appropriate EPC selection procedure over non-3GPP access when the non-3GPP radio becomes enabled. If the UE needs to establish emergency session over untrusted access, the UE shall select an ePDG that supports emergency services as described in clause 7.2.1 and 3GPP TS 23.402 [6].\nNOTE:\tThe UE can perform the appropriate EPC selection procedure over non-3GPP access based on other implementation-specific triggers, e.g. regaining non-3GPP access network coverage or connectivity.\nThe UE can utilize information received from ANDSF to which EPCs an access network is connected as described in 3GPP TS 24.312 [13]. Additionally, any technology specific means can be employed to acquire such information, but these are out of scope of this specification.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tGeneric EPC network selection procedure over non-3GPP access",
                            "text_content": "The identification of EPC shall be based on one of the following:\n-\tPLMN-Id (i.e. pair of MCC+MNC), as specified in 3GPP TS 23.003 [3]; or\n-\tHome/Visited Network Realm/Domain, as specified in 3GPP TS 23.003 [3].\nTwo modes of EPC network selection are defined, manual and automatic. The UE shall select the EPC network according to the selected operating mode.\nThe UE shall present the list of available EPC networks, to which connectivity is provided through the selected non-3GPP access network, to the user. If UE's HPLMN or PLMNs equivalent to it are in this list, they shall be shown in the highest ranking order. The ordering of the rest of entries in the list is implementation dependent. If available, the UE should display names and/or realms/domains.\nIf multiple equivalent HPLMNs are available, then the display order among them is UE implementation specific.\nThe UE may use locally stored data for selecting between EPC networks available for connectivity via the currently selected non-3GPP access network.\nThe UE shall select a PLMN according to the PLMN selection procedures of the selected non-3GPP access network.\nAdditional criteria are out of scope of this specification and remain implementation specific.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.3\tAccess technology specific EPC network selection procedures",
                            "text_content": "With WiMAX as a non-3GPP access network, the WiMAX NSP is mapped onto the EPC network operator. The NSP indication can be provided to the UE in accordance to WiMAX Forum Network Architecture Release 1.0 version 1.2 [25]. The WiMAX access network should advertise the NSP identity of the EPC in the MCC, MNC format.\n5.2.3.1.2.1\tUE selection modes\nThere are two modes of network selection, namely, manual network selection and automatic network selection. The UE shall follow one of the following two procedures depending on its operating mode.\n5.2.3.1.2.2\tManual EPC network selection\nThe manual network selection for WiMAX access shall follow the WiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 3 [25] with the following exceptions and additions:\n-\tWhen presenting the list of available networks for user selection, the UE shall provide the network name of the related MCC + MNC pair. If that is not possible, the UE shall provide the MCC + MNC pair; and\n-\tIf the UE is unable to register to the user selected NSP, further UE action is implementation dependent.\n5.2.3.1.2.3\tAutomatic EPC network selection\nThe automatic network selection for WiMAX access shall follow the WiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 3 [25] without any exceptions or additions.\nThere are two modes of service provider selection, namely, manual service provider selection and automatic service provider selection.\nThe UE follows one of the following two procedures defined in clause 5.2.3.2.2 and 5.2.3.2.3 depending on its implementation.\nThe service provider selected in accordance with these procedures determines the WLAN that is selected. When the selected WLAN is a trusted WLAN IP access and the UE decides to access EPC via S2a using trusted WLAN IP access, the UE shall derive a NAI from the identity of the selected service provider and use the NAI as the identity for authentication and authorization with the service provider and usage of the WLAN (see clause 6.4).\nThe UE shall determine which service providers are available from the available list of WLANs as constructed using the WLAN selection procedure described in clause 5.1.3.2.3 using following procedures:\ni)\tthe UE selects a WLAN from the list of selected WLAN(s) constructed using the WLAN selection procedure described in clause 5.1.3.2.3;\nii)\tif the WLAN selected in step i):\na)\tsupports ANQP specified in IEEE Std 802.11 [57] and if the UE did not obtain a list of realms using ANQP in clause 5.1.3.2.3.3 item 1, the UE sends an ANQP request for a list of realms (i.e. ANQP-elements \"NAI Realm\") and/or PLMN identities (i.e. ANQP-element \"3GPP Cellular Network\"); and\nNOTE 1:\tThe UE uses procedures defined in IEEE Std 802.11 [57] to determine if the WLAN supports ANQP and to send the ANQP query request for ANQP-elements \"NAI Realm\" and/or \"3GPP Cellular Network\", as specified in IEEE Std 802.11 [57].\nb)\tdoes not support ANQP (see IEEE Std 802.11 [57]) or the UE does not receive a list of realms in item a), an EAP-Request/Identity is received and the EAP-request/Identity does not include one or more of realms and/or PLMN identities of service providers (encoded in accordance with IETF RFC 4284 [60]), the UE supports IEEE 802.1x authentication (see IEEE Std 802.1X™-2010 [61]), the UE shall request a list of realms and/or PLMN identities of service providers interworking with that WLAN by sending the EAP-Response/Identity message including as identity the alternative NAI; and\niii)\tthe UE repeats this procedure for all WLANs from the available list of WLANs as constructed using the WLAN selection procedure described in clause 5.1.3.2.3.\nNOTE 2:\tThe list with realms and/or PLMN identities of service providers received in accordance with procedures in IETF RFC 4284 [60], is of limited size and might not contain all the realms and/or PLMN identities of service providers available via the WLAN.\nThe UE shall convert any received PLMN identities into PLMN realms using the rules defined in 3GPP TS 23.003 [3].\nThe UE indicates to the user the service providers which are available for WLAN. The UE may obtain the service providers available for WLAN using procedures as described in clause 5.2.3.2.1A. The UE will select the service provider based on the user preference.\nThe purpose of this procedure is to:\n-\tselect a service provider over WLAN; and\n-\tconstruct a NAI for use with authentication signalling with the selected service provider in order for the UE to be authorised to use the WLAN.\nIf the RAN rules control the WLAN access selection and traffic routing as described in clause 6.10.2:\n-\tif the RPLMN or an equivalent PLMN (see 3GPP TS 24.301 [10] or 3GPP TS 24.008 [46]) is available as described in clause 5.2.3.2.1A via a WLAN from the selected WLAN(s) constructed using the WLAN selection procedure described in clause 5.1.3.2.3, the highest priority service provider is the RPLMN or an equivalent PLMN (see 3GPP TS 24.301 [10] or 3GPP TS 24.008 [46]);\n-\tif the RPLMN and an equivalent PLMN (see 3GPP TS 24.301 [10] or 3GPP TS 24.008 [46]) are not available as described in clause 5.2.3.2.1A via a WLAN from the selected WLAN(s) constructed using the WLAN selection procedure described in clause 5.1.3.2.3 and Home PLMN or an EHPLMN is available, the highest priority service provider is Home PLMN or an EHPLMN; and\n-\tif the RPLMN, an equivalent PLMN (see 3GPP TS 24.301 [10] or 3GPP TS 24.008 [46]), Home PLMN and an EHPLMN are not available as described in clause 52.3.2.1A via a WLAN from the selected WLAN(s) constructed using the WLAN selection procedure described in clause 5.1.3.2.3, the highest priority service provider is a PLMN selected in an implementation-dependent way.\nIf the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2, a service provider is the highest priority service provider if the service provider is available via a WLAN from the selected WLAN(s) constructed using the WLAN selection procedure described in clause 5.1.3.2.3 and if:\ni)\tthe service provider is selected in item 3; or\nii)\tthe conditions in item 3 are not met, and:\n-\tthe service provider is the HPLMN;\n-\tthe service provider is an equivalent home service provider (i.e. the service provider's realm matches a realm in the EquivalentHomeSPs as specified in 3GPP TS 24.312 [13]); or\n-\tno WLAN of the selected WLAN(s) provides access to a higher priority service provider.\nUntil the highest priority service provider is found, the UE shall verify if a service provider available over a WLAN of the selected WLAN(s) is the highest priority service provider:\n1)\tVoid\n2)\tUsing the service providers which are available for WLAN as described in clause 5.2.3.2.1A, the UE uses the PLMN realms as the service provider realms in the remaining steps of this clause.\n3)\tIf the following conditions are fulfilled:\n-\tthe \"3GPP RPLMN preferred\" indicator is configured to prioritize 3GPP RPLMN; and\n-\tthe realm of the RPLMN or the realm of an equivalent visited service provider included in the EquivalentVisitedSPs as specified in 3GPP TS 24.312 [13] is included in the list of realms created in clause 5.2.3.2.1A, step ii);\nthen the UE shall select the RPLMN or the equivalent visited service provider. The RPLMN shall be selected with higher priority than the equivalent visited service provider. If the RPLMN is selected, the UE shall convert the RPLMN identity into selected PLMN realm using the rules defined in 3GPP TS 23.003 [3] and use it as the service provider realms in the remaining steps of this clause.\n4)\tif the condition in step 3) is not satisfied, the UE shall select a service provider in the following order:\ni)\tHPLMN matching a realm in the list of realms received in step ii) as described in clause 5.2.3.2.1A;\nii)\trealm found both in the list of realms received in step ii) as described in clause 5.2.3.2.1A and in the EquivalentHomeSPs as specified in 3GPP TS 24.312 [13]; and\niii)\trealm found both in the list of realms received in step ii) as described in clause 5.2.3.2.1A and in the PSPL as specified in 3GPP TS 24.312 [13] with the priority higher than any other service provider's priority indicated as available via the WLAN.\nIf a UE used the procedures in IETF RFC 4284 [60] (see clause 5.2.3.2.1A) to obtain a list of service providers, then the UE is only required to select the HPLMN (if available) or an available equivalent home service provider.\nNOTE 1:\tA UE using procedures in IETF RFC 4284 [60] to obtain a list of service providers is only required to select the HPLMN (if available) or an available equivalent home service provider. If the UE selects another service provider, the UE could be roaming even though the HPLMN or equivalent home service provider is available at the access point.\nThe UE shall select the WLAN providing access to the highest priority service provider.\nIf a highest priority service provider could not be determined, the UE proceeds in implementation-dependent way.\nThe UE shall construct a NAI for authentication with the highest priority service provider as described in 3GPP TS 23.003 [3]. Specifically, the UE constructs the:\na)\troot NAI corresponding to the HPLMN, if the highest priority service provider is the HPLMN advertised using a PLMN identity;\nb)\tdecorated NAI with double decoration including the realm of the highest priority service provider and the realm of the RPLMN, if the highest priority service provider is an equivalent visited service provider; or\nc)\tdecorated NAI including the realm of the highest priority service provider, otherwise.\nNOTE 2:\tUE implementation can optimize the steps described above, e.g. by combining the ANQP procedures described in clause 5.2.3.2.1A with the ANQP procedures in clause 5.1.3.2.3.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tAccess Network reselection",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "General",
                            "text_content": "The network reselection procedure shall be executed based on the user's request or the operator's policy. Such operator policy for supporting network reselection can be provided by the ANDSF or can be pre-provisioned in the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "UE procedures",
                            "text_content": "The UE may retrieve information from ANDSF, which includes available access network and operator's policy as specified in clause 6.8.2.\nThe information which is retrieved from the ANDSF shall not impact the PLMN selection and reselection procedures specified in 3GPP TS 23.122 [4]. For WLAN access, the UE configured with a WLANSP rule specified in 3GPP TS 24.312 [13], shall use the access network selection procedure and a PLMN selection procedure defined in this document which are different from and shall not be used in conjunction with the procedures for I-WLAN access specified in 3GPP TS 24.234 [9].\nThe network reselection procedure can be in automatic mode or manual mode dependent on UE configuration settings. For WiMAX access, the manual mode reselection shall follow the behaviour described in clause 5.2.3.1.2.2 and the automatic mode reselection shall follow the behaviour described in clause 5.2.3.1.2.3.\nIf the RAN rules control the WLAN access selection and traffic routing as described in clause 6.10.2, if the UE receives move-traffic-to-WLAN indication, along with the list of the WLAN identifiers as described in clause 6.10.4, the UE shall perform the procedure in clause 6.10.4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "EPC procedures",
                            "text_content": "The ANDSF shall send available access network(s) and operator's policy to the UE in response to the UE's request or based on the network triggers as specified in clause 6.8.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.4\tPeriodic EPC network reselection attempts",
                            "text_content": "In automatic mode, when UE is not in its HPLMN or one of its equivalent HPLMNs, the UE shall make a periodic attempt to return to its HPLMN or one of its equivalent HPLMNs. For this purpose the timer value given in the EFHPPLMN as defined in 3GPP TS 31.102 [45] shall be used with the following exceptions:-\n-\tFor UE accessing the EPC via cdma2000® HRPD access networks, the UE's search for a more preferred system shall abide by the parameters and procedures defined in 3GPP2 C.S0016 [23a].\n-\tFor UE accessing the EPC via WiMAX access networks, the time period between periodic network searches is implementation specific.\n-\tFor UE accessing the EPC via any other non-3GPP access networks, unless the UE has availability to EFHPPLMN, the time period between periodic network searches is implementation specific but shall not be less than 30 minutes.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "5.4\tData traffic routing of IP flows",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "6\tUE – EPC Network protocols",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.2\tTrusted and Untrusted Accesses",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tGeneral",
                            "text_content": "For a UE, the trust relationship of a non-3GPP IP access network is determined by the home PLMN operator. That trust relationship is indicated to the UE via the following methods:\n-\tPre-configured policies in the UE by the home PLMN operator.\n-\tDynamic indication during 3GPP-based access authentication.\nFor a trusted non-3GPP IP access network, the UE shall follow the access methods given in clause 6.4. For an untrusted non-3GPP IP access network, the UE shall follow the access methods given in clause 6.5.\nIf the dynamic trust relationship indication is received during 3GPP-based access authentication, the UE shall rely on the dynamic trust relationship indication. Otherwise the UE shall follow the pre-configured policies for a specific non-3GPP access network. If no dynamic indicator is received, and no pre-configured policy matches a specific non-3GPP access network where the UE attempts to access, the UE shall follow the procedure defined in clause 6.2.4.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tPre-configured policies in the UE",
                            "text_content": "The following types of policies can be pre-configured on the UE by the home PLMN operator:\n-\tPre-configured trust relationship policies for specific non-3GPP access technologies and/or PLMNs. For example, the UE may be configured to use the procedures for trusted access networks as described in clause 6.4 as follows:\n-\tan access network of access technology X1 from PLMN Y1 is trusted; and/or\n-\tany access network of access technology X2 is trusted; and/or\n-\tany access network from PLMN Y2 is trusted; and/or\n-\tany access network is trusted.\nThe format of the pre-configured policies is not specified in this release of this specification.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tDynamic Indication",
                            "text_content": "If the UE performs 3GPP-based access authentication, the 3GPP AAA server may send a trust relationship indicator of the non-3GPP access network to the UE during the EAP-AKA, EAP-AKA' or EAP-3GPP-LimitedService based access authentication (i.e. EAP-AKA, EAP-AKA' or EAP-3GPP-LimitedService) as specified in 3GPP TS 33.402 [15]. If non-3GPP access network is trusted, the 3GPP AAA server shall send this trust relationship indicator as specified in 3GPP TS 29.273 [17]. The indicator is sent using a AT_TRUST_IND attribute, by extending the EAP-AKA (and EAP-AKA' and EAP-3GPP-LimitedService) protocol as specified in clause 8.2 of IETF RFC 4187 [33]. This attribute is provided in EAP-Request/AKA-Challenge or EAP- Request/AKA'-Challenge or EAP-Request/3GPP-LimitedService-Init-Info message payload respectively. The detailed coding of this attribute is described in clause 8.2.3.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.4\tNo trust relationship information",
                            "text_content": "If no dynamic indicator is received, and no pre-configured policies matches a specific non-3GPP access network where the UE attempts to access, the UE shall consider it as untrusted network and operate based on clause 6.5.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tIP Mobility Mode Selection",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tGeneral",
                            "text_content": "The IP mobility mechanisms supported between 3GPP and non-3GPP accesses within an operator and its roaming partner's network may be based on either:\na)\tStatic Configuration; or\nb)\tDynamic Configuration.\nThe choice between a) and b) depends upon operators' preferences or roaming agreement or both.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tStatic configuration of inter-access mobility mechanism",
                            "text_content": "For networks deploying a single IP mobility management mechanism, the statically configured mobility mechanism can be access type or roaming agreement specific or both. The information about the mechanism to be used in such scenario is expected to be provisioned into the terminal and the network.\nIn static configuration, if there is a mismatch between the IP mobility mode mechanism parameters pre-configured in the network and in the UE, the UE may not be able to access the EPC. If the UE is able to access the EPC even if there is a mismatch between the IP mobility mode mechanisms, the network may not be able to provide session continuity for the UE. More details of the possible cases of mismatch between the IP mobility mode mechanism are described in the informative annex D.\nIf the network is configured with a static mobility mechanism and the AAA server implements protocol extensions for a dynamic IP Mobility Mode Selection (IPMS) exchange, the AAA server shall send to the UE an AT_RESULT_IND attribute during the authentication procedure as it is described in clause 6.3.3.1.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.3\tDynamic configuration of inter-access mobility mechanism",
                            "text_content": "Dynamic IP Mobility Mode Selection (IPMS) consists of:\n-\tIP mobility management protocol selection between Network Based Mobility (NBM), DSMIPv6 or MIPv4; and\n-\tDecision on IP address preservation if NBM is selected\nUpon initial attachment to a non-3GPP access and upon handoff to non-3GPP accesses, the UE performs IPMS by providing an indication during network access authentication for EPC. For trusted access, the indication is provided before an IP address is allocated to the UE, while in untrusted access network, the indication is provided during IKEv2 signalling for IPSec tunnel establishment with the ePDG.\nWhen the UE provides an explicit indication for IPMS, then the network shall provide the indication to the UE identifying the selected mobility management mechanism.\nWhen the dynamic IP mobility mode selection is used if the UE does not receive any indication of a selected mobility protocol after the UE provided an explicit indication, it is considered as an abnormal case and the UE may not get connectivity to the EPC.\nNOTE:\tThe scenarios for mobility mode selection are described in clause 4.1.3 of 3GPP TS 23.402 [6].\nDuring network access authentication, UE may provide an explicit indication to the 3GPP AAA server about the supported mobility protocol by using an attribute in the EAP-AKA and EAP-AKA' protocols, to extend these protocols as specified in clause 8.2 of IETF RFC 4187 [33]. This attribute is provided in EAP-Response/AKA-Challenge and corresponding EAP-AKA' message payload.\nThe UE may provide the indication for IPMS using AT_IPMS_IND attribute in EAP-AKA or EAP-AKA' if the UE receives the AT_RESULT_IND attribute within the EAP-Request/AKA-Challenge message, or the EAP-Request/AKA'-Challenge message (when EAP-AKA' is used). If the UE provides the AT_IPMS_IND attribute within the EAP-Response/AKA-Challenge message payload or within the EAP-Response/AKA'-Challenge message payload (when EAP-AKA' is used), the UE shall also provide the AT_RESULT_IND attribute within the message.\nIf the UE supports IPMS indication, it shall indicate support for one or more mobility protocols in AT_IPMS_IND attribute as follows:\n-\tthe UE shall indicate support for DSMIPv6 if the UE supports DSMIPv6; and\n-\tthe UE shall indicate support for MIPv4 if the UE supports MIPv4; and\n-\tduring initial attach, the UE should indicate support for NBM if the UE supports address preservation based on NBM between the access it is attaching to and all other accesses that the UE supports.; or\n-\tupon handover, the UE shall indicate support for NBM if the UE supports address preservation based on NBM while moving from source access network to target non-3GPP access network that the UE is attaching to.\nNOTE: The UE can be configured not to use IPMS indication, e.g. the UE is DSMIP capable only.\nIf the UE does not support any mobility protocol then the UE shall not send the AT_IPMS_IND attribute to the 3GPP AAA server.\nThe preference of protocol may be indicated based on the policies configured on the UE. The detailed coding of this attribute is described in clause 8.2.1.1.\nA 3GPP AAA server supporting IPMS shall include the AT_RESULT_IND attribute within the EAP-Request/AKA-Challenge and corresponding EAP-AKA' message payload.\nIf the UE provided an explicit indication as described in clause 6.3.3, the 3GPP AAA server shall inform the UE of its decision on the mobility protocol and IP preservation mode by invoking an EAP-Request/AKA-Notification dialogue when EAP-AKA is used or an EAP-Request/AKA'-Notification dialogue when EAP-AKA' is used.\nOn selecting the mobility protocol based on UE indication, access network capabilities and network policies, the 3GPP AAA server shall indicate the selected protocol to the UE by using the AT_IPMS_RES attribute. If the 3GPP AAA server does not receive any indication from the UE but knows the UE's policies allow the usage of NBM and knows the home and access network supports NBM, the network shall use NBM shall be used for providing connectivity to the UE.\nIf the AT_IPMS_RES attribute indicates DSMIPv6 then the UE shall follow the procedures defined in 3GPP TS 24.303 [11].\nIf the AT_IPMS_RES attribute indicates MIPv4 support, then the UE shall follow the procedures defined in 3GPP TS 24.304 [12].\nThe detailed coding of this attribute is described in clause 8.2.1.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tAuthentication and authorization for accessing EPC via a trusted non-3GPP access network",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4.1\tGeneral",
                            "text_content": "For access to the EPC via a trusted non-3GPP access network, a connection shall be established between the UE and the trusted non-3GPP access network using signalling procedures specific to the trusted non-3GPP access network, which are out of scope of this present document.\nAccess authentication signalling for access to the EPC shall be executed between the UE and 3GPP AAA server to ensure mutual authentication of the user and the EPC, with the exception of UEs without IMSI (see clauses 4.4.1 and 6.6.3.2) or UEs initiating emergency session but whose IMSI authentication cannot proceed. Such authentication is based on IETF protocols as specified in 3GPP TS 33.402 [15].\nEAP-AKA' is used for access authentication in the trusted access network, according to 3GPP TS 33.402 [15], clause 6.2. According to 3GPP TS 33.402 [15], clause 6.1, EAP-AKA' can be skipped if conditions listed in clause 9.2.2.1 or conditions described in clause 13.4 of 3GPP TS 33.402 [15] are met.\nIf the access network does not support EAP-AKA or EAP-AKA' and the UE considers the access network as trusted, the UE shall access to the EPC only via S2c and any authentication method (EAP-based or otherwise) can be used for access authentication as long as the criteria set in 3GPP TS 33.402 [15], clause 9.2.2.1 are met.\nWhen the UE decides to access EPC via S2c using non-3GPP IP access, EAP-AKA authentication is performed between the UE and the PDN-GW as specified in 3GPP TS 24.303 [11] and 3GPP TS 33.402 [15].\nThe UE may support ERP as described in IETF RFC 6696 [71] and 3GPP TS 33.402 [15]. In this release of this specification, only the ERP Implicit Bootstrapping mode defined in IETF RFC 6696 [71] is supported.\nAfter a UE successfully completes authentication and authorization for accessing EPC via the trusted non-3GPP access network, the UE may receive as part of an ANQP query to the access point, an ANQP-element in a protected frame with management frame protection enabled. If the ANQP-element is an Emergency Call Number ANQP-element encoded in accordance with Annex I, the UE considers the content of the Emergency Call Number field valid.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.1A\tTWAN connection modes",
                            "text_content": "As part of EAP-AKA' authentication via TWAN or EAP-3GPP-LimitedService authentication via TWAN, the UE and the network can negotiate usage of either the single-connection mode (SCM) or the multi-connection mode (MCM) as described in 3GPP TS 23.402 [6].\nNOTE:\tUE requesting neither SCM nor MCM acts in transparent single-connection mode (TSCM). No UE extensions are needed for TSCM.\nThe negotiation consists of the following steps:\na)\tThe 3GPP AAA server indicates support of TSCM, SCM, MCM or any combination of them as described in clause 6.4.3.5.\nb)\tThe UE requests usage of SCM or MCM as described in clause 6.4.2.6.2 and clause 6.4.2.6.3, acts in TSCM or aborts the EAP authentication as described in clause 6.4.2.6.4.\nc)\tThe 3GPP AAA server either accepts or rejects the UE request as described in clause 6.4.3.5.\nIf EAP-AKA' authentication is skipped during emergency call via TWAN for unauthenticated UEs and the EAP-3GPP-LimitedService authentication via TWAN is performed, the UE and the network can negotiate usage of either the single-connection mode (SCM) or the multi-connection mode (MCM) as follows:\na)\tThe 3GPP AAA server indicates support of SCM, MCM or any combination of them as described in clause 6.4.3.5.1A.\nb)\tThe UE requests usage of SCM or MCM as described in clause 6.4.2.6.2A and clause 6.4.2.6.3A, or aborts the EAP authentication as described in clause 6.4.2.6.4.\nc)\tThe 3GPP AAA server either accepts or rejects the UE request as described in clause 6.4.3.5.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.2\tUE procedures",
                            "text_content": "The user identities to be used by the UE in the authentication and authorization for accessing EPC via a trusted non-3GPP access are the Root-NAI (permanent identity), decorated NAI, Fast-Reauthentication NAI (Fast-Reauthentication Identity) and Pseudonym Identity and these identities are described in clause 4.4.\nIf the UE supports ERP, the identity to be used by the UE during the re-authentication procedure using ERP is the \"KeyName-NAI\" as described in 3GPP TS 23.003 [3].\nWhen initiating emergency session via trusted non-3GPP access, if the UE has no valid subscriber data available (USIM not available, or USIM is considered invalid by the UE), the UE shall provide its IMEI in an EAP Response/Identity message based on emergency NAI format specified in 3GPP TS 23.003 [3].\nIf the UE receives EAP-Request/3GPP-LimitedService-Init-Info message from the network requesting IMEI, the UE provides IMEI as specified in clause 6.4.2.7.\nThe UE shall support EAP-AKA based authentication as specified in IETF RFC 4187 [33] and EAP-AKA' based authentication as specified in IETF RFC 5448 [38]. 3GPP TS 33.402 [15] specifies the conditions under which one or the other of these two methods is used.\nDuring network access authentication, the UE may provide an explicit indication for IPMS by adding an attribute in the EAP-AKA or EAP-AKA' payload as defined in clause 6.3.3.\nDuring network access authentication, the 3GPP AAA server may provide the ANID to the UE, see clause 6.4.2.4.\nFor WLAN access, after the UE has been successfully authenticated from WLAN, if the UE receives EAP-Request/AKA'-Notification dialogue with AT_NOTIFICATION attribute value 1031 \"User has not subscribed to the requested service\" as defined in IETF RFC 4187 [33], the UE shall not initiate the EPC access procedure to the same WLAN until switching off or the UICC containing the USIM is removed.\nNOTE:\tSwitching off and USIM change conditions are implemented taking into consideration the user experience aspect.\nThe UE shall support both full authentication and fast re-authentication for EAP AKA as specified in IETF RFC 4187 [33] and for EAP-AKA' as specified in IETF RFC 5448 [38].\nFull authentication is performed to generate new keys. The initial authentication shall be a full authentication as specified in 3GPP TS 33.402 [15]. For a full authentication either the Permanent Identity or the Pseudonym Identity is used.\nAccording to 3GPP TS 33.402 [15] the fast re-authentication procedure uses the Fast Re-authentication Identity and is used for renewing the session keys.\nThe Permanent Identity is based on the IMSI of the UE. The Fast Re-authentication Identity is provided to the UE by the 3GPP AAA server during the previous authentication procedure. The UE shall use the Fast Re-authentication Identity only once. A Pseudonym Identity provided to the UE by the 3GPP AAA Server during a previous authentication procedure can be reused in later authentications until the UE receives a new Pseudonym identity from the 3GPP AAA Server.\nNOTE:\tThe 3GPP AAA Server will assign a new Pseudonym Identity with a frequency dictated by operator's policy. The allocation of new pseudonyms is required to prevent that the user's movements are tracked by an unauthorized party.\nIf during an authentication request, the UE receives an EAP-Request/AKA-Identity message containing AT_PERMANENT_ID_REQ, the UE shall return the Permanent Identity in the AT_IDENTITY attribute of the EAP-Response/AKA_Identity. If the UE receives an EAP-Request/AKA'-Identity message containing AT_PERMANENT_ID_REQ, the UE shall return the Permanent Identity in the AT_IDENTITY attribute of the EAP- Response /AKA'-Identity message.\nIf during an authentication request, the UE receives an EAP-Request/AKA-Identity message which contains AT_FULLAUTH_ID_REQ, the UE shall return the Pseudonym Identity as the AT_IDENTITY within EAP-Response/AKA_Identity message if available. If the UE receives an EAP-Request/AKA'-Identity message containing AT_FULLAUTH_ID_REQ, the UE shall return the Pseudonym Identity as the AT_IDENTITY within the EAP- Response /AKA'-Identity message if available. Otherwise the UE shall return the Permanent Identity.\nIf during an authentication request, the UE receives an EAP-Request/AKA-Identity message or EAP-Request/AKA'-Identity message respectively, which contains AT_ANY_ID_REQ, the UE shall return the Fast Re-authentication Identity if available as the AT_IDENTITY. Otherwise the UE shall return the Pseudonym Identity.\nIf the UE's USIM file indicates that the UE is a UE configured for high priority access in the selected PLMN as specified in 3GPP TS 31.102 [35], the UE shall inform the TWAN by returning an AT_HPA_INFO element in the EAP-response as defined in clause 8.2.11.\nThe 3GPP AAA server provides the UE with the ANID in EAP signalling. The UE can also obtain the ANID by access network specific means, which are out of scope of the present document. For some access networks the ANID can also be configured into the UE and the 3GPP AAA server.\nNOTE:\tAccording to 3GPP TS 33.402 [15], the ANID is used by HSS and UE to generate transformed authentication vectors and therefore the ANID needs to be identical in the HSS and in the UE. The trusted non-3GPP access network first sends the ANID to the 3GPP AAA server via the STa reference point and the 3GPP AAA server sends the ANID to HSS via the SWx reference point, see 3GPP TS 29.273 [17], and to the UE as specified in this specification.\nWhen the 3GPP AAA server sends an EAP Request' or AKA-Challenge' message to the UE, the 3GPP AAA server shall include the ANID to be used when generating transformed authentication vectors, using the AT_KDF_INPUT attribute as described in clause 8.2.2. The value and coding of this attribute is described in clause 8.1.1.\nThe UE shall apply the rules for comparison of the locally determined ANID and the one received over EAP-AKA' as specified in IETF RFC 5448 [38]. The UE, or the user, may use the ANID as a basis for an optional decision whether the access network is authorized to serve the UE. E.g. the UE may compare the ANID against a list of preferred or barred ANIDs.\nWhen the UE can locally determine based on physical layer or access network procedures that the UE is connected to a eHRPD network, the locally determined ANID is \"HRPD\". If the comparison check is successful and if either the optional access network authorization decision in the UE is positive or is not performed, the UE shall proceed; otherwise the UE shall abort the access procedure.\nThe UE shall apply the rules for comparison of the locally determined ANID and the one received over EAP-AKA' as specified in IETF RFC 5448 [38]. The UE, or the user, may use the ANID as a basis for an optional decision whether the access network is authorized to serve the UE. E.g. the UE may compare the ANID against a list of preferred or barred ANIDs.\nWhen the UE can locally determine based on physical layer or access network procedures that the UE is connected to a WiMAX access network, the locally determined ANID is \"WIMAX\". If the comparison check is successful and if either the optional access network authorization decision in the UE is positive or is not performed, the UE shall proceed; otherwise the UE shall abort the access procedure.\nThe UE shall apply the rules for comparison of the locally determined ANID and the one received over EAP-AKA' as specified in IETF RFC 5448 [38]. The UE, or the user, may use the ANID as a basis for an optional decision whether the access network is authorized to serve the UE. E.g. the UE may compare the ANID against a list of preferred or barred ANIDs.\nWhen the UE can locally determine based on physical layer or access network procedures that the UE is connected to a WLAN network, the locally determined ANID is \"WLAN\". If the comparison check is successful and if either the optional access network authorization decision in the UE is positive or is not performed, the UE shall proceed; otherwise the UE shall abort the access procedure.\nThe UE shall apply the rules for comparison of the locally determined ANID and the one received over EAP-AKA' as specified in IETF RFC 5448 [38]. The UE, or the user, may use the ANID as a basis for an optional decision whether the access network is authorized to serve the UE. E.g. the UE may compare the ANID against a list of preferred or barred ANIDs.\nWhen the UE can locally determine based on physical layer or access network procedures that the UE is connected to a Ethernet network, the locally determined ANID is \"ETHERNET\". If the comparison check is successful and if either the optional access network authorization decision in the UE is positive or is not performed, the UE shall proceed; otherwise the UE shall abort the access procedure.\nWhen receiving the EAP-Request/AKA-Challenge message when the EAP-AKA is used or the EAP-Request/AKA'-Challenge message when the EAP-AKA' is used, and the AT_FULL_NAME_FOR_NETWORK attribute, the AT_SHORT_NAME_FOR_NETWORK attribute or both are included, then the UE may use the contents to update appropriate information stored within the UE.\nThe UE may support SCM. The UE may support MCM.\nNOTE 1:\tThe UE is allowed to support both MCM and SCM. The UE is allowed to support neither MCM nor SCM.\nNOTE 2:\tNo UE extensions are needed for TSCM.\nIf:\na)\tthe UE supports the SCM;\nb)\tthe EAP-Request/AKA'-Challenge message includes the AT_TWAN_CONN_MODE attribute as described in clause 8.2.7.1 wherein the message field as described in clause 8.1.4.1:\n1)\tcontains the message type field indicating CONNECTION_CAPABILITY; and\n2)\tcontains the item list field:\nA)\tincluding the CONNECTION_MODE_CAPABILITY item as described in clause 8.1.4.8 indicating support of SCM; and\nB)\tif the UE requests an emergency attach or an emergency handover, including the CONNECTION_MODE_CAPABILITY item as described in clause 8.1.4.8 indicating that emergency services are supported; and\nc)\tthe UE requests usage of the SCM;\nthen the UE:\na)\tshall include the AT_TWAN_CONN_MODE attribute according to clause 8.2.7.1 in the EAP-Response/AKA'-Challenge message. In the message field according to clause 8.1.4.1 of the AT_TWAN_CONN_MODE attribute, the UE shall:\n1)\tset the message type field to SCM_REQUEST; and\n2)\tin the item list field:\nA)\tinclude a CONNECTIVITY_TYPE item according to clause 8.1.4.3 indicating the requested connectivity type - PDN connection, or NSWO; and\nB)\tif a PDN connection is requested:\ni)\tinclude a ATTACHMENT_TYPE item according to clause 8.1.4.4 indicating whether an initial attach, a handover attach, an emergency attach, or an emergency handover is requested;\nii)\tif a PDN connection for an APN other than the default APN is requested and either an initial attach or a handover attach is requested, include an APN item according to clause 8.1.4.5 indicating the requested APN;\niii)\tif the initial attach or the emergency attach is requested, include a PDN_TYPE item according to clause 8.1.4.6 indicating the requested PDN type;\niv)\tif the handover attach or the emergency handover is requested, include a PDN_TYPE item according to clause 8.1.4.6 indicating the PDN type supported in the PDN connection to be handed over; and\nv)\tif the UE wishes to transmit (protocol) data (e.g. configuration parameters, error codes or messages/events) to the network, include a PROTOCOL_CONFIGURATION_OPTIONS item according to clause 8.1.4.9; and\nb)\tif a PDN connection is requested, shall include the AT_RESULT_IND attribute in the EAP-Response/AKA'-Challenge message.\nNOTE 1:\tIf the UE does not include the AT_RESULT_IND attribute in the EAP-Response/AKA'-Challenge message, in case of successful authentication, then EAP-Request/AKA'-Notification message is not received and the UE is only informed about success using EAP-Success.\nUpon receiving the EAP-Request/AKA'-Notification message including the AT_TWAN_CONN_MODE attribute as described in clause 8.2.7.1 wherein the message field as described in clause 8.1.4.1:\n-\tcontains the message type field indicating SCM_RESPONSE; and\n-\tcontains the item list field;\nthe UE:\na)\tif the AT_NOTIFICATION attribute indicates success, shall determine the authorized connectivity type in the CONNECTIVITY_TYPE item as described in clause 8.1.4.3 included in the item list field. If the authorized connectivity type is PDN connection, the UE:\n1)\tif the initial attach, or the handover attach is requested, shall determine the selected APN in the APN item as described in clause 8.1.4.5 included in the item list field;\n2)\tshall determine the PDN type supported in the PDN connection in the PDN_TYPE item as described in clause 8.1.4.6 included in the item list field;\n3)\tif a PROTOCOL_CONFIGURATION_OPTIONS item as described in clause 8.1.4.9 is included in the item list field, shall determine the protocol configuration options in the PROTOCOL_CONFIGURATION_OPTIONS item;\n4)\tif a IPV4_ADDRESS item as described in clause 8.1.4.11 is included in the item list field, shall determine the IPv4 address allocated to the UE for the PDN connection in the IPV4_ADDRESS item;\n5)\tif a IPV6_INTERFACE_IDENTIFIER item as described in clause 8.1.4.12 is included in the item list field, shall determine the IPv6 interface identifier allocated to the UE for the PDN connection in the IPV6_INTERFACE_IDENTIFIER item and shall use it when building the IPv6 link local address; and\n6)\tshall determine the TWAG user plane MAC address in the TWAG_UP_MAC_ADDRESS item as described in clause 8.1.4.14 included in the item list field, and shall use the TWAG user plane MAC address for encapsulating user plane packets according to 3GPP TS 23.402 [6]; and\nb)\tif the AT_NOTIFICATION attribute indicates failure with value 0 \"General failure after authentication\" or value 16384 - \"General failure\" as defined in IETF RFC 4187 [33] and the ACCESS_CAUSE item is included:\n1)\tshall determine the cause of failure in the ACCESS_CAUSE item as described in clause 8.1.4.17 included the item list field:\n2)\tif the initial attach, or the handover attach is requested, and the cause of failure is #2 \"Non-3GPP access to EPC not allowed\" as defined in clause 8.1.4.17, shall not retry the authentication procedure to any WLANs until switching off or the UICC containing the USIM is removed;\n3)\tif the cause of failure is #11 \"PLMN _NOT_ALLOWED\" as defined in clause 8.1.4.17, shall not retry the authentication procedure from the same PLMN via WLANs according to the network selection procedures as defined in clause 5.2.2;\n4)\tif the initial attach, or the handover attach is requested, and the cause of failure is #3 \"RAT type not allowed\" as defined in clause 8.1.4.17, the UE shall not retry the authentication procedure to any WLANs until switching off or the UICC containing the USIM is removed;\n5)\tif the cause of failure is #6 \"Illegal ME\" as defined in clause 8.1.4.17, shall not retry the authentication procedure from the same PLMN until switching off or the UICC containing the USIM is removed; and\nNOTE 2:\tSwitching off and USIM change conditions are implemented taking into consideration the user experience aspect.\nc)\tif the AT_NOTIFICATION attribute indicates failure as defined in bullet b) and the CAUSE item is included:\n1)\tshall determine the cause of failure in the CAUSE item as described in clause 8.1.4.10 included the item list field;\n2)\tif the initial attach, or the handover attach is requested, the cause of failure is #26 \"Insufficient resources\" and the Tw1 item is included in the item list field, shall take different actions depending on the timer value received in the Tw1 item as follows:\nA)\tif the timer value indicates neither zero nor deactivated, shall stop timer Tw1 associated with the corresponding APN, if it is running. The UE shall start timer Tw1 (see 3GPP TS 24.244 [56]) with the value provided in the Tw1 value IE and not send another SCM_REQUEST message with the CONNECTIVITY_TYPE item indicating PDN connection and with APN item indicating the same APN until timer Tw1 expires, the timer Tw1 is stopped, or the USIM is removed;\nB)\tif the timer value indicates that this timer is deactivated, shall not send another SCM_REQUEST message with the CONNECTIVITY_TYPE item indicating PDN connection and with APN item indicating the same APN until the UE is switched off or the USIM is removed;\nC)\tif the timer value indicates zero, may send another SCM_REQUEST message with the CONNECTIVITY_TYPE item indicating PDN connection and with APN item indicating the same APN; and\nD)\tif the WLAN radio is disabled when the timer Tw1 is running and if the USIM in the UE remains the same when the WLAN radio is enabled, shall behave as follows when the WLAN radio is enabled:\n-\tlet t1 be the time remaining for Tw1 timeout when the WLAN radio was disabled and let t be the time elapsed since the WLAN radio was disabled until the WLAN radio was enabled. If t1 is greater than t, then the timer shall be restarted with the value t1 – t. If t1 is equal to or less than t, then the timer need not be restarted. If the UE is not capable of determining t, then the UE shall restart the timer with the value t1;\n3)\tif the cause of failure is #26 \"Insufficient resources\" and the Tw1 item is not included in the item list field, may send a SCM_REQUEST message with the CONNECTIVITY_TYPE item indicating PDN connection and with APN item indicating the same APN;\n4)\tif the initial attach, or the handover attach is requested, and the cause of failure is #38 \"Network failure\" as defined in clause 8.1.4.10.2:\nA)\tif the Tw1 item is included in the item list field, shall behave as follows:\ni)\tif the timer value received in the Tw1 item indicates neither zero nor deactivated, shall start the Tw2 timer with the timer value provided in the Tw1 item, and shall not try again until the backoff timer expires or the UE is switched off or the UICC containing the USIM is removed;\nii)\tif the timer value received in the Tw1 item indicates that this timer is deactivated, shall not try again until the UE is switched off or the UICC containing the USIM is removed; and\niii)\tif the timer value received in the Tw1 item indicates zero, may send another SCM_REQUEST message with the CONNECTIVITY_TYPE item indicating PDN connection and with APN item indicating the same APN; and\nB)\tif the Tw1 item is not included in the item list field, shall start an implementation specific backoff timer and not try again until the backoff timer expires or the UE is switched off or the UICC containing the USIM is removed; and\nNOTE 3:\tExisting Tw1 item can be reused by the network to provide back off timer value to start Tw2 timer.\n5)\tif the initial attach, or the handover attach is requested, and the cause of failure is #27 \"Unknown APN\" as defined in clause 8.1.4.10.2:\na)\tif the Tw1 item is included in the item list field, shall behave as follows:\ni)\tif the timer value received in the Tw1 item indicates neither zero nor deactivated, shall start the Tw2 timer with the timer value provided in the Tw1 item, and shall not send another SCM_REQUEST message with the CONNECTIVITY_TYPE item indicating PDN connection and with APN item indicating the same APN to the same PLMN until the backoff timer expires or the UE is switched off or the UICC containing the USIM is removed;\nii)\tif the timer value received in the Tw1 item indicates that this timer is deactivated, shall not send another SCM_REQUEST message with the CONNECTIVITY_TYPE item indicating PDN connection and with APN item indicating the same APN to the same PLMN until the UE is switched off or the UICC containing the USIM is removed; and\niii)\tif the timer value received in the Tw1 item indicates zero, may send another SCM_REQUEST message with the CONNECTIVITY_TYPE item indicating PDN connection and with APN item indicating the same APN; and\nb)\tif the Tw1 item is not included in the item list field, shall not retry the authentication procedure with the same WLAN for the same APN to the same PLMN until the UE is switched off or the UICC containing the USIM is removed, unless the UE has an implementation specific backoff timer. In that case, the UE shall not retry until that implementation specific timer expires.\nIf the UE needs to establish an IMS emergency session over trusted WLAN access, the UE shall:\n1)\tif the UE already has active PDN connection, the UE shall detach first (see 3GPP TS 23.402 [6]) and then follow item 2) below to start initial attach procedure for emergency service; and\n2)\tif the UE does not have an active PDN connection and requests usage of the SCM, the UE shall start initial attach procedure for emergency service using the procedures specified in clause 6.4.2.6.2. In addition,\na)\tupon receiving EAP-Request/AKA'-Challenge message:\n-\tif the CONNECTION_MODE_CAPABILITY item in the item list field indicates support of emergency services, the UE shall respond with the EAP-Response/AKA'-Challenge message with the ATTACHMENT_TYPE item in the item list field set to \"emergency attach\" or \"emergency handover\"; or\n-\tif the CONNECTION_MODE_CAPABILITY item in the item list field does not indicate support of emergency services, the UE shall respond with the EAP-Response/AKA'-Client-Error message as described in clause 6.4.2.6.4. The UE shall re-initiate initial attach procedure for emergency service by selecting a different WLAN supporting emergency service; or\nb)\tupon receiving EAP-Request/3GPP-LimitedService-Init-Info message including the AT_TWAN_CONN_MODE attribute with the message type of message field indicating CONNECTION_CAPABILITY and message field contains CONNECTION_MODE_CAPABILITY item in the item list field indicating support of SCM and emergency services,\n-\tif the UE supports the SCM and requests the usage of the SCM, the UE shall respond with the EAP-Response/3GPP-LimitedService-Init-Info message and shall include the AT_TWAN_CONN_MODE attribute with the message type field set to SCM_REQUEST and in the item list field shall:\ni)\tinclude a ATTACHMENT_TYPE item indicating whether an emergency attach or emergency handover is requested;\nii)\tif emergency attach is requested, include a PDN_TYPE item according to clause 8.1.4.6 indicating the requested PDN type;\niii)\tif emergency handover attach is requested, include a PDN_TYPE item according to clause 8.1.4.6 indicating the PDN type supported in the PDN connection to be handed over; and\niv)\tif the UE wishes to transmit (protocol) data (e.g. configuration parameters, error codes or messages/events) to the network, include a PROTOCOL_CONFIGURATION_OPTIONS item according to clause 8.1.4.9; and\nc)\tupon receiving the EAP-Request/3GPP-LimitedService-Notif message including the AT_TWAN_CONN_MODE attribute with the message type field of the message field indicating SCM_RESPONSE and the item list field:\n-\tthe UE shall:\ni)\tdetermine the PDN type supported in the PDN connection in the PDN_TYPE item as described in clause 8.1.4.6 included in the item list field;\nii)\tdetermine the protocol configuration options in the PROTOCOL_CONFIGURATION_OPTIONS item if a PROTOCOL_CONFIGURATION_OPTIONS item as described in clause 8.1.4.9 is included in the item list field;\niii)\tif a IPV4_ADDRESS item as described in clause 8.1.4.11 is included in the item list field, determine the IPv4 address allocated to the UE for the PDN connection in the IPV4_ADDRESS item;\niv)\tif a IPV6_INTERFACE_IDENTIFIER item as described in clause 8.1.4.12 is included in the item list field, determine the IPv6 interface identifier allocated to the UE for the PDN connection in the IPV6_INTERFACE_IDENTIFIER item and use it when building the IPv6 link local address; and\nv)\tdetermine the TWAG user plane MAC address in the TWAG_UP_MAC_ADDRESS item as described in clause 8.1.4.14 included in the item list field, and use the TWAG user plane MAC address for encapsulating user plane packets according to 3GPP TS 23.402 [6]; and\nd)\tif the UE had requested emergency attach or emergency handover of an emergency session, upon receiving the EAP-Request/AKA'-Notification message, if the AT_NOTIFICATION attribute indicates failure, the UE shall detach and then perform initial attach procedure for emergency service by selecting a different WLAN supporting emergency service.\nIf:\na)\tthe UE supports the MCM;\nb)\tthe EAP-Request/AKA'-Challenge message includes the AT_TWAN_CONN_MODE attribute as described in clause 8.2.7.1 wherein the message field as described in clause 8.1.4.1:\n1)\tcontains the message type field indicating CONNECTION_CAPABILITY; and\n2)\tcontains the item list field:\nA)\tincluding the CONNECTION_MODE_CAPABILITY item as described in clause 8.1.4.8 indicating support of MCM;\nB)\tincluding the SUPPORTED_WLCP_TRANSPORTS item as described in clause 8.1.4.15; and\nC)\tif the UE requests an emergency attach or an emergency handover, including the CONNECTION_MODE_CAPABILITY item as described in clause 8.1.4.8 indicating that emergency services are supported;\nc)\tat least one WLCP transport indicated as supported in the SUPPORTED_WLCP_TRANSPORTS item is also supported by the UE; and\nd)\tthe UE requests usage of the MCM;\nthen the UE:\na)\tshall include the AT_TWAN_CONN_MODE attribute according to clause 8.2.7.1 in the EAP-Response/AKA'-Challenge message. In the message field according to clause 8.1.4.1 of the AT_TWAN_CONN_MODE attribute, the UE:\n1)\tshall set the message type field to MCM_REQUEST; and\n2)\tin the item list field:\nA)\tif the UE requests an emergency attach or an emergency handover, shall include an ATTACHMENT_TYPE item according to clause 8.1.4.4 indicating whether an emergency attach, or an emergency handover is requested; and\nb)\tshall include the AT_RESULT_IND attribute in the EAP-Response/AKA'-Challenge message.\nUpon receiving the EAP-Request/AKA'-Notification message including the AT_TWAN_CONN_MODE attribute as described in clause 8.2.7.1 where the message field as described in clause 8.1.4.1:\n-\tcontains the message type field indicating MCM_RESPONSE; and\n-\tcontains the item list field;\nthe UE:\na)\tif the AT_NOTIFICATION attribute indicates success:\n1)\tshall determine the NSWO authorization in the AUTHORIZATIONS item as described in clause 8.1.4.7 included in the item list field;\n2)\tshall determine the TWAG control plane address(es) in the TWAG_CP_ADDRESS item as described in clause 8.1.4.13 included in the item list field; and\n3)\tshall derive the WLCP key as described in Annex A.3 in 3GPP TS 33.402 [15]; and\nNOTE:\tAfter receiving EAP Success message terminating the EAP procedures after successful authentication and authorization for MCM access to EPC, the UE establishes a DTLS connection with the TWAG and initiates WLCP procedures according to 3GPP TS 24.244 [56].\nb)\tif the AT_NOTIFICATION attribute indicates failure, shall determine the cause of failure in the ACCESS_CAUSE or CAUSE item as described in clause 8.1.4.17 and 8.1.4.10 included in the item list field.\nIf the UE needs to establish an IMS emergency session over trusted WLAN access, the UE shall:\n1)\tif the UE already has active PDN connection:\n-\tif the TWAN does not supports emergency service, the UE shall detach first and then follow item 2) below to start initial attach procedure for emergency service and selecting a WLAN supporting Emergency service; or\n-\tif the connected TWAN supports emergency service, the UE shall initiate PDN connectivity establishment procedures as specified in 3GPP TS 24.244 [56].\n2)\tif the UE does not have an active PDN connection and requests usage of the MCM, the UE shall start initial attach procedure for emergency service using the procedures specified in clause 6.4.2.6.3. In addition,\na)\tupon receiving EAP-Request/AKA'-Challenge message:\n-\tif the CONNECTION_MODE_CAPABILITY item in the item list field indicates support of emergency services, the UE shall respond with the EAP-Response/AKA'-Challenge message with the ATTACHMENT_TYPE item in the item list field set to \"emergency attach\" or \"emergency handover\"; or\n-\tif the CONNECTION_MODE_CAPABILITY item in the item list field does not indicate support of emergency services, the UE shall respond with the EAP-Response/AKA'-Client-Error message as described in clause 6.4.2.6.4. The UE shall re-initiate initial attach procedure for emergency service by selecting a different WLAN supporting emergency service; or\nb)\tupon receiving EAP-Request/3GPP-LimitedService-Init-Info message including the AT_TWAN_CONN_MODE attribute with the message type of message field indicating CONNECTION_CAPABILITY and message field contains CONNECTION_MODE_CAPABILITY item in the item list field indicating support of MCM and emergency services,\n-\tif the UE supports the MCM and requests the usage of the MCM and\ni)\tmessage field of the AT_TWAN_CONN_MODE attribute contains SUPPORTED_WLCP_TRANSPORTS item as described in clause 8.1.4.15; and\nii)\tat least one WLCP transport indicated as supported in the SUPPORTED_WLCP_TRANSPORTS item is also supported by the UE,\nthe UE shall respond with the EAP-Response/3GPP-LimitedService-Init-Info message and shall:\ni)\tinclude the AT_TWAN_CONN_MODE attribute with the message type field set to MCM_REQUEST;\nc)\tupon receiving the EAP-Request/3GPP-LimitedService-Notif message including the AT_TWAN_CONN_MODE attribute with the message type of message field indicating MCM_RESPONSE and the item list field:\n-\tthe UE shall:\ni)\tdetermine the TWAG control plane address(es) in the TWAG_CP_ADDRESS item as described in clause 8.1.4.13 included in the item list field;\nii)\tderive the WLCP key as described in Annex A.3 in 3GPP TS 33.402 [15].\nNOTE:\tAfter receiving EAP Success message terminating the EAP procedures after successful authentication and authorization for MCM access to EPC, the UE establishes a DTLS connection with the TWAG and initiates WLCP procedures according to 3GPP TS 24.244 [56].\nd)\tif the UE had requested emergency attach or emergency handover of an emergency session, upon receiving the EAP-Request/AKA'-Notification message, if the AT_NOTIFICATION attribute indicates failure, the UE shall detach and then perform initial attach procedure for emergency service by selecting a different WLAN supporting emergency service.\nThe emergency session is not supported for the UE using TSCM mode.\nNOTE:\tIf the UE in TSCM mode already has active PDN connection, the UE remains connected.\nIf the EAP-Request/AKA'-Challenge message does not include the AT_TWAN_CONN_MODE attribute as described in clause 8.2.7.1, then only TSCM is available.\nIf the UE supports SCM, the UE does not support MCM, and the EAP-Request/AKA'-Challenge message includes the AT_TWAN_CONN_MODE attribute as described in clause 8.2.7.1 wherein the message field as described in clause 8.1.4.1:\n1)\tcontains the message type field indicating CONNECTION_CAPABILITY; and\n2)\tcontains the item list field including the CONNECTION_MODE_CAPABILITY item as described in clause 8.1.4.8 not indicating support of SCM;\nthen only TSCM is available.\nIf the UE does not support SCM, the UE supports MCM, and the EAP-Request/AKA'-Challenge message includes the AT_TWAN_CONN_MODE attribute as described in clause 8.2.7.1 wherein the message field as described in clause 8.1.4.1:\n1)\tcontains the message type field indicating CONNECTION_CAPABILITY; and\n2)\tcontains the item list field including the CONNECTION_MODE_CAPABILITY item as described in clause 8.1.4.8 not indicating support of MCM;\nthen only TSCM is available.\nIf the UE does not support SCM, the UE supports MCM, the EAP-Request/AKA'-Challenge message includes the AT_TWAN_CONN_MODE attribute as described in clause 8.2.7.1 wherein the message field as described in clause 8.1.4.1:\n1)\tcontains the message type field indicating CONNECTION_CAPABILITY; and\n2)\tcontains the item list field:\nA)\tincluding the CONNECTION_MODE_CAPABILITY item as described in clause 8.1.4.8 indicating support of MCM; and\nB)\tincluding the SUPPORTED_WLCP_TRANSPORTS item as described in clause 8.1.4.15;\nand none of the WLCP transport indicated as supported in the SUPPORTED_WLCP_TRANSPORTS item is also supported by the UE, then only TSCM is available.\nIf only TSCM is available:\na)\tif the UE does not request an emergency attach, the UE does not request an emergency handover and the UE is willing to use TSCM, the UE shall act as in TSCM; and\nb)\tif the UE requests an emergency attach or the UE requests an emergency handover or the UE is unwilling to use TSCM, the UE shall send EAP-Response/AKA'-Client-Error message.\nNOTE:\tIn TSCM, successful EAP-AKA' authentication triggers creation of a PDN connection to the default APN. The UE can be unwilling to use the PDN connection to the default APN e.g. because the UE needs to perform handover of a PDN connection, because the UE needs to establish a PDN connection to an APN other than the default APN, because the UE needs to establish multiple PDN connections, or because the UE has no usage for the PDN connection to the default APN and wants to avoid any possible charges related to the PDN connection to the default APN.\nIf the UE requests an emergency attach or an emergency handover, and the EAP-Request/AKA'-Challenge message includes the AT_TWAN_CONN_MODE attribute as described in clause 8.2.7.1 wherein the message field as described in clause 8.1.4.1:\n1)\tcontains the message type field indicating CONNECTION_CAPABILITY; and\n2)\tcontains the item list field including the CONNECTION_MODE_CAPABILITY item as described in clause 8.1.4.8 not indicating support of emergency services;\nthen the UE shall send EAP-Response/AKA'-Client-Error message.\nIf the UE receives:\n-\tan EAP-Request/AKA'-Challenge message; or\n-\tan EAP-Request/3GPP-LimitedService-Init-Info message;\ncontaining the AT_DEVICE_IDENTITY attribute and the Identity Type field of the received AT_DEVICE_IDENTITY attribute is set to either 'IMEI' or 'IMEISV' and the Identity Value field is empty, then if the UE's Mobile Equipment Identity IMEI or IMEISV is available, the UE shall include IMEI or IMEISV in the AT_DEVICE_IDENTITY attribute in:\n-\tthe EAP-Response/AKA'-Challenge message; or\n-\tthe EAP-Response/3GPP-LimitedService-Init-Info message;\nas follows:\n-\tif IMEISV are available, the UE shall include IMEISV in the AT_DEVICE_IDENTITY attribute. The Identity Type field of the AT_DEVICE_IDENTITY attribute shall be set to 'IMEISV': and\n-\tif IMEI is available and IMEISV is not available, the UE shall include IMEI in the AT_DEVICE_IDENTITY attribute. The Identity Type field of the AT_DEVICE_IDENTITY attribute shall be set to 'IMEI'.\nThe AT_DEVICE_IDENTITY attribute shall be sent as an encrypted attribute and included in the value field of the AT_ENCR_DATA attribute as described in IETF RFC 4187 [33].\nThe detailed coding of the AT_DEVICE_IDENTITY attribute is described in clause 8.2.8.1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.3\t3GPP AAA server procedures",
                            "text_content": "The 3GPP AAA selects the pseudonym identity or the Fast Re-authentication Identity and returns the identity to the UE during the Authentication procedure as specified in 3GPP TS 33.402 [15]. The 3GPP AAA server shall maintain a mapping between the UE's permanent identity and the pseudonym identity and between the UE's permanent identity and the Fast Re-authentication Identity.\nUpon receiving a request from the UE for emergency session establishment, if\n-\tIMSI is provided to the network but IMSI authentication cannot proceed or IMSI authentication has failed or the 3GPP AAA server cannot determine if authentication is successful; and\n-\tthe 3GPP AAA server is configured to accept unauthenticated emergency session over WLAN,\nthe 3GPP AAA server requests IMEI from the UE as specified in clause 6.4.3.6 using the EAP-Request/3GPP-LimitedService-Init-Info message.\nThe 3GPP AAA server shall support EAP AKA based authentication as specified in IETF RFC 4187 [33] and EAP-AKA' based authentication as specified in IETF RFC 5448 [38]. 3GPP TS 33.402 [15] specifies the conditions under which one or the other of these two methods is used. If the UE provides an explicit indication for the supported mobility protocols and the network supports multiple IP mobility mechanisms, the network shall select the protocol to be used and communicate the decision to the UE as defined in clause 6.3.3.1.2.\nFor WLAN access, after the UE has been successfully authenticated and the EPC access and Non-Seamless WLAN Offload are not authorized for the UE, the 3GPP AAA Server shall invoke an EAP-Request/AKA'-Notification dialogue and indicate this to the UE by using the AT_NOTIFICATION attribute value 1031 – \"User has not subscribed to the requested service\" as defined in IETF RFC 4187 [33].\nThe 3GPP AAA shall support full re-authentication and fast re-authentication as specified in IETF RFC 4187 [33].\nThe decision to use the fast re-authentication process is taken by the home network (i.e. the 3GPP AAA server) and is based on operator policies. If fast re-authentication is to be used, the home network shall indicate this to the UE by providing the Fast Re-authentication Identity to the UE during the authentication process.\nWhen initiating an authentication, the home network shall indicate the type of authentication required by including either AT_PERMANENT_ID_REQ or AT_FULLAUTH_ID_REQ for Full authentication and AT_ANY_ID_REQ for Fast re-authentication in the EAP-Request/AKA_Identity message or the EAP-Request/AKA'-Identity message respectively.\nThe home network (i.e. the 3GPP AAA server) may upon receiving the Fast Re-authentication Identity in AT_IDENTITY, decide to proceed with the fast re-authentication or choose instead to initiate a full authentication. This decision is based on operator policies.\nThe 3GPP AAA server may include the AT_FULL_NAME_FOR_NETWORK attribute, the AT_SHORT_NAME_FOR_NETWORK attribute or both in the EAP-Request/AKA-Challenge message when the EAP-AKA is used and in the EAP-Request/AKA'-Challenge message when the EAP-AKA' is used.\nThe detailed coding of the AT_FULL_NAME_FOR_NETWORK attribute and the AT_SHORT_NAME_FOR_NETWORK is described in clause 8.2.5.\nThe 3GPP AAA server may support the single-connection mode (SCM).\nThe 3GPP AAA server may support the multi-connection mode (MCM).\nIf the network supports SCM, MCM or both, the 3GPP AAA server shall include the AT_TWAN_CONN_MODE attribute according to clause 8.2.7.1 and the AT_RESULT_IND attribute in the EAP-Request/AKA'-Challenge message. In the message field according to clause 8.1.4.1 of the AT_TWAN_CONN_MODE attribute, the 3GPP AAA server shall:\na)\tset the message type field to CONNECTION_CAPABILITY; and\nb)\tin the item list field:\n1)\tinclude a CONNECTION_MODE_CAPABILITY item according to clause 8.1.4.8 indicating whether the network supports TSCM, SCM, MCM or any combination of them and indicating whether the network supports the emergency services; and\n2)\tif the network supports MCM, include a SUPPORTED_WLCP_TRANSPORTS item according to clause 8.1.4.15 indicating WLCP transport(s) supported by the TWAG.\nIf the 3GPP AAA server is configured to accept unauthenticated emergency session over WLAN and IMEI was received or IMSI was received but IMSI authentication cannot proceed, the 3GPP AAA server shall initiate connection mode negotiation with the UE as follows:\n-\tif the 3GPP AAA server supports SCM, MCM or both, the 3GPP AAA server shall include the AT_TWAN_CONN_MODE attribute according to clause 8.2.7.1 in the EAP-Request/3GPP-LimitedService-Init-Info message. In the message field according to clause 8.1.4.1 of the AT_TWAN_CONN_MODE attribute, the 3GPP AAA server shall:\na)\tset the message type field to CONNECTION_CAPABILITY; and\nb)\tin the item list field:\n1)\tinclude a CONNECTION_MODE_CAPABILITY item according to clause 8.1.4.8 indicating whether the network supports SCM, MCM or any combination of them, and indicating emergency service is supported; and\n2)\tif the network supports MCM, include a SUPPORTED_WLCP_TRANSPORTS item according to clause 8.1.4.15 indicating WLCP transport(s) supported by the TWAG.\nIf\n-\tthe 3GPP AAA server supports SCM;\n-\tthe EAP-Response/AKA'-Challenge message includes the AT_TWAN_CONN_MODE attribute as described in clause 8.2.7.1 wherein the message field as described in clause 8.1.4.1 contains the message type field indicating SCM_REQUEST; and\n-\tthe authentication was successful;\nthen the 3GPP AAA server:\n-\tif the ATTACHMENT_TYPE item according to clause 8.1.4.4 indicating an emergency attach, or an emergency handover is included in the item list field of the message field, shall identify that the attach is for emergency services; and\n-\tshall trigger the TWAN to establish the connectivity of the requested connectivity type according to 3GPP TS 23.402 [6].\nIf:\n-\tthe 3GPP AAA server authorizes the requested connectivity; and\n-\tthe EAP-Response/AKA'-Challenge message includes the AT_RESULT_IND attribute;\nthen the 3GPP AAA server shall invoke an EAP-Request/AKA'-Notification dialogue. The 3GPP AAA server shall construct the EAP-Request/AKA'-Notification message as follows:\na)\tindicate success in the AT_NOTIFICATION attribute; and\nb)\tinclude the AT_TWAN_CONN_MODE attribute described in clause 8.2.7.1. In the message field according to clause 8.1.4.1 of the AT_TWAN_CONN_MODE attribute, the 3GPP AAA server shall:\n1)\tset the message type field to SCM_RESPONSE; and\n2)\tin the item list field:\nA)\tinclude a CONNECTIVITY_TYPE item as described in clause 8.1.4.3 indicating the authorized connectivity type. Only one connectivity type is indicated; and\nB)\tif a PDN connection was authorized:\ni)\tif the initial attach, or the handover attach is requested, include an APN item according to clause 8.1.4.5 indicating the APN of the authorized PDN connection;\nii)\tinclude a PDN_TYPE item according to clause 8.1.4.6 indicating the PDN type(s) selected in the authorized PDN connection;\niii)\tif the 3GPP AAA server wishes to transmit (protocol) data (e.g. configuration parameters, error codes or messages/events) to the UE, include a PROTOCOL_CONFIGURATION_OPTIONS item according to clause 8.1.4.9;\niv)\tif an IPv4 address is allocated to the UE for the PDN connection, include a IPV4_ADDRESS item according to clause 8.1.4.11;\nv)\tif an IPv6 interface identifier is allocated to the UE for the PDN connection, include a IPV6_INTERFACE_IDENTIFIER item according to clause 8.1.4.12; and\nvi)\tinclude a TWAG_UP_MAC_ADDRESS item according to clause 8.1.4.14.\nIf the UE is a UE configured for high priority access as specified in clause 6.4.2.3, if allowed by operator policy, the 3GPP AAA server shall not deny the authorization for the requested connectivity due to a #26 \"Insufficient resources\" failure unless doing so would cause system instability.\nIf the 3GPP AAA server does not authorize the requested connectivity and if:\n-\tthe attach is not for emergency session; or\n-\tthe attach is for emergency session and if the 3GPP AAA server is not configured to accept unauthenticated emergency session over WLAN,\nNOTE:\tThe case where the 3GPP AAA server does not authorize the request but is configured to accept unauthenticated emergency session over WLAN is specified in clause 6.4.3.5.2A.\nthen the 3GPP AAA server shall invoke an EAP-Request/AKA'-Notification dialogue. The 3GPP AAA server shall construct the EAP-Request/AKA'-Notification message as follows:\na)\tindicate failure in the AT_NOTIFICATION attribute; and\nb)\tinclude the AT_TWAN_CONN_MODE attribute described in clause 8.2.7.1. In the message field according to clause 8.1.4.1 of the AT_TWAN_CONN_MODE attribute, the 3GPP AAA server shall:\n1)\tset the message type field to SCM_RESPONSE;\n2)\tin the item list field, include an ACCESS_CAUSE or CAUSE item according to clause 8.1.4.17 and 8.1.4.10 indicating the cause of failure;\n3)\tif the initial attach, or the handover attach is requested, the cause of failure is #26 \"Insufficient resources\" and a value of backoff timer is to be provided to the UE for the PDN connection, include a Tw1 item according to clause 8.1.4.16. If the UE is a UE configured for high priority access as specified in clause 6.4.2.3, if allowed by operator policy, the 3GPP AAA server shall not include a Tw1 item in the message;\n3A)\tif the initial attach, or the handover attach is requested, the cause of failure is #38 \"Network failure\" or #27 \"unknown APN\" and a value of backoff timer is to be provided to the UE for the PDN connection, include a Tw1 item according to clause 8.1.4.16;\n4)\tif the 3GPP AAA Server receives DIAMETER_ERROR_USER_NO_NON_3GPP_SUBSCRIPTION sent by the HSS as specified in 3GPP TS 29.273 [17], indicate this to the UE by using \"Non-3GPP access to EPC not allowed\" value in the ACCESS_CAUSE item;\n5)\tif the 3GPP AAA Server receives DIAMETER_ERROR_ROAMING_NOT_ALLOWED sent by the HSS as specified in 3GPP TS 29.273 [17], indicate this to the UE by using \"PLMN not allowed\" value in the ACCESS_CAUSE item;\n6)\tif the 3GPP AAA Server receives DIAMETER_ERROR_USER_NO_APN_SUBSCRIPTION sent by the HSS as specified in 3GPP TS 29.273 [17], indicate this to the UE by using #27 \"Unknown APN\" value in the CAUSE item;\n7)\tif the 3GPP AAA Server receives DIAMETER_ERROR_RAT_TYPE_NOT_ALLOWED sent by the HSS as specified in 3GPP TS 29.273 [17], indicate this to the UE by using #3 \"RAT type not allowed\" value in the ACCESS_CAUSE item; and\n8)\tif the 3GPP AAA Server receives DIAMETER_UNABLE_TO_COMPLY sent by HSS as specified in 3GPP TS 29.273 [17], indicate this to the UE by using #38 \"Network failure\" in the CAUSE item.\nIf the 3GPP AAA Server supports IMS Emergency sessions over WLAN, the 3GPP AAA server shall:\n-\tif IMSI was received and IMSI authentication can proceed, the 3GPP AAA server invokes an EAP-Request/AKA'-Notification dialogue to indicate success or failure to the UE as described in clause 6.4.3.5.2;\n-\tif IMSI was received but IMSI authentication cannot proceed, then\nA)\tif the 3GPP AAA server is configured to accept unauthenticated emergency session over WLAN:\na)\tthe 3GPP AAA server sends EAP Request/3GPP-LimitedService-Init-Info message as specified in clause 6.4.3.5.1A;\nb)\tupon receiving the EAP-Response/3GPP-LimitedService-Init-Info message including the AT_TWAN_CONN_MODE attribute with the message type of message field indicating SCM_REQUEST and the item list field, the 3GPP AAA server shall include the AT_TWAN_CONN_MODE attribute according to clause 8.2.7.1 in the EAP-Request/3GPP-LimitedService-Notif message. In the message field according to clause 8.1.4.1 of the AT_TWAN_CONN_MODE attribute, the 3GPP AAA server shall:\ni)\tset the message type field to SCM_RESPONSE; and\nii)\tin the item list field:\n1)\tinclude the PDN type supported in the PDN connection in the PDN_TYPE item as described in clause 8.1.4.6 in the item list field;\n2)\tinclude the protocol configuration options in the PROTOCOL_CONFIGURATION_OPTIONS item if a PROTOCOL_CONFIGURATION_OPTIONS item as described in clause 8.1.4.9 is in the item list field;\n3)\tif an IPv4 address is allocated to the UE for the PDN connection, include a IPV4_ADDRESS item according to clause 8.1.4.11;\n4)\tif an IPv6 interface identifier is allocated to the UE for the PDN connection, include a IPV6_INTERFACE_IDENTIFIER item according to clause 8.1.4.12; and\n5)\tinclude a TWAG_UP_MAC_ADDRESS item according to clause 8.1.4.14; and\nc)\tupon receiving the EAP-Response/3GPP-LimitedService-Notif message, the 3GPP AAA server shall generate the MSK using IMEI as described in clause 13.4 in 3GPP TS 33.402 [15] and send EAP Success message to the UE to allow the UE to proceed with emergency session establishment; or\nB)\tif the 3GPP AAA server is not configured to accept unauthenticated emergency session over WLAN, the 3GPP AAA server shall reject the emergency session request and return an EAP Failure message to the UE; or\n-\tif IMEI was received,\nA)\tif the 3GPP AAA server is configured to accept unauthenticated emergency session over WLAN:\na), the 3GPP AAA server sends EAP Request/3GPP-LimitedService-Init-Info message to as specified in clause 6.4.3.5.1A;\nb)\tupon receiving the EAP-Response/3GPP-LimitedService-Init-Info message including the AT_TWAN_CONN_MODE attribute with the message type of message field indicating SCM_REQUEST and the item list field, the 3GPP AAA server shall include the AT_TWAN_CONN_MODE attribute according to clause 8.2.7.1 in the EAP-Request/3GPP-LimitedService-Notif message. In the message field according to clause 8.1.4.1 of the AT_TWAN_CONN_MODE attribute, the 3GPP AAA server shall:\ni)\tset the message type field to SCM_RESPONSE; and\nii)\tin the item list field:\n1)\tinclude the PDN type supported in the PDN connection in the PDN_TYPE item as described in clause 8.1.4.6 in the item list field;\n2)\tinclude the protocol configuration options in the PROTOCOL_CONFIGURATION_OPTIONS item if a PROTOCOL_CONFIGURATION_OPTIONS item as described in clause 8.1.4.9 is in the item list field;\n3)\tif an IPv4 address is allocated to the UE for the PDN connection, include a IPV4_ADDRESS item according to clause 8.1.4.11;\n4)\tif an IPv6 interface identifier is allocated to the UE for the PDN connection, include a IPV6_INTERFACE_IDENTIFIER item according to clause 8.1.4.12; and\n5)\tinclude a TWAG_UP_MAC_ADDRESS item according to clause 8.1.4.14; and\nc)\tupon receiving the EAP-Response/3GPP-LimitedService-Notif message, the 3GPP AAA server shall generate the MSK using IMEI as described in clause 13.4 in 3GPP TS 33.402 [15] and send EAP Success message to the UE to allow the UE to proceed with emergency session establishment; or\nB)\tif the 3GPP AAA server is not configured to accept unauthenticated emergency session over WLAN, the 3GPP AAA server shall reject the emergency session request and return an EAP Failure message to the UE.\nIf:\na)\tthe 3GPP AAA server supports MCM;\nb)\tif the EAP-Response/AKA'-Challenge message includes:\n1)\tthe AT_TWAN_CONN_MODE attribute as described in clause 8.2.7.1 wherein the message field as described in clause 8.1.4.1 contains the message type field indicating MCM_REQUEST; and\n2)\tthe AT_RESULT_IND attribute;\nc)\tthe 3GPP AAA server authorizes the request. If the ATTACHMENT_TYPE item according to clause 8.1.4.4 indicating an emergency attach, or an emergency handover is included in the item list field of the message field, the 3GPP AAA server shall identify that the attach is for emergency services; and\nd)\tthe authentication was successful;\nthen the 3GPP AAA server shall invoke an EAP-Request/AKA'-Notification dialogue. The 3GPP AAA server shall construct the EAP-Request/AKA'-Notification message as follows:\na)\tindicate success in the AT_NOTIFICATION attribute; and\nb)\tinclude the AT_TWAN_CONN_MODE attribute according to clause 8.2.7.1. In the message field according to clause 8.1.4.1 of the AT_TWAN_CONN_MODE attribute, the 3GPP AAA server shall:\n1)\tset the message type field to MCM_RESPONSE; and\n2)\tin the item list field:\nA)\tinclude an AUTHORIZATIONS item according to clause 8.1.4.7 indicating whether UE is authorized to use NSWO; and\nB)\tinclude a TWAG_CP_ADDRESS item according to clause 8.1.4.13 indicating the TWAG control plane address.\nIf the 3GPP AAA server does not authorize the request and if\n-\tthe attach is not for emergency services; or\n-\tthe attach is for emergency services and if the 3GPP AAA server is not configured to accept unauthenticated emergency session over WLAN,\nNOTE:\tThe case where the 3GPP AAA server does not authorize the request but is configured to accept unauthenticated emergency session over WLAN is specified in clause 6.4.3.5.3A.\nthen the 3GPP AAA server shall invoke an EAP-Request/AKA'-Notification dialogue. The 3GPP AAA server shall construct the EAP-Request/AKA'-Notification message as follows:\na)\tindicate failure in the AT_NOTIFICATION attribute; and\nb)\tinclude the AT_TWAN_CONN_MODE attribute described in clause 8.2.7.1. In the message field according to clause 8.1.4.1 of the AT_TWAN_CONN_MODE attribute, the 3GPP AAA server shall:\n1)\tset the message type field to MCM_RESPONSE;\n2)\tin the item list field, include a ACCESS_CAUSE or CAUSE item according to clause 8.1.4.17 and 8.1.4.10 indicating the cause of failure;\n3)\tif the 3GPP AAA Server receives DIAMETER_ERROR_USER_NO_NON_3GPP_SUBSCRIPTION sent by the HSS as specified in 3GPP TS 29.273 [17], indicate this to the UE by using \"Non-3GPP access to EPC not allowed\" value in the ACCESS_CAUSE item;\n4)\tif the 3GPP AAA Server receives DIAMETER_ERROR_ROAMING_NOT_ALLOWED sent by the HSS as specified in 3GPP TS 29.273 [17], indicate this to the UE by using \"PLMN not allowed\" value in the ACCESS_CAUSE item;\n5)\tif the 3GPP AAA Server receives DIAMETER_ERROR_USER_NO_APN_SUBSCRIPTION sent by the HSS as specified in 3GPP TS 29.273 [17], indicate this to the UE by using #27 \"Unknown APN\" value in the CAUSE item;\n6)\tif the 3GPP AAA Server receives DIAMETER_ERROR_RAT_TYPE_NOT_ALLOWED sent by the HSS as specified in 3GPP TS 29.273 [17], indicate this to the UE by using #3 \"RAT type not allowed\" value in the ACCESS_CAUSE item; and\n7)\tif the 3GPP AAA Server receives DIAMETER_UNABLE_TO_COMPLY sent by HSS as specified in 3GPP TS 29.273 [17], indicate this to the UE by using #38 \"Network failure\" in the CAUSE item.\nIf the 3GPP AAA Server supports IMS Emergency sessions over WLAN, the 3GPP AAA server shall:\n-\tif IMSI was received and IMSI authentication can proceed, the 3GPP AAA server invokes an EAP-Request/AKA'-Notification dialogue to indicate success to the UE as described in clause 6.4.3.5.3;\n-\tif IMSI was received but IMSI authentication cannot proceed, then\nA)\tif the 3GPP AAA server is configured to accept unauthenticated emergency session over WLAN:\na), the 3GPP AAA server sends EAP Request/3GPP-LimitedService-Init-Info message as specified in clause 6.4.3.5.1A;\nb)\tupon receiving the EAP-Response/3GPP-LimitedService-Init-Info message including the AT_TWAN_CONN_MODE attribute with the message type of message field indicating SCM_REQUEST and the item list field, the 3GPP AAA server shall include the AT_TWAN_CONN_MODE attribute according to clause 8.2.7.1 in the EAP-Request/3GPP-LimitedService-Notif message. In the message field according to clause 8.1.4.1 of the AT_TWAN_CONN_MODE attribute, the 3GPP AAA server shall:\ni)\tset the message type field to SCM_RESPONSE; and\nii)\tin the item list field:\n1)\tinclude the TWAG control plane address(es) in the TWAG_CP_ADDRESS item as described in clause 8.1.4.13 in the item list field; and\nc)\tupon receiving the EAP-Response/3GPP-LimitedService-Notif message, the 3GPP AAA server shall generate the MSK using IMEI as described in clause 13.4 in 3GPP TS 33.402 [15] and send EAP Success message to the UE to allow the UE to proceed with emergency session establishment; or\nB)\tif the 3GPP AAA server is not configured to accept unauthenticated emergency session over WLAN, the 3GPP AAA server shall reject the emergency session request and return an EAP Failure message to the UE; or\n-\tif IMEI was received,\nA)\tif the 3GPP AAA server is configured to accept unauthenticated emergency session over WLAN:\na), the 3GPP AAA server sends EAP Request/3GPP-LimitedService-Init-Info message as specified in clause 6.4.3.5.1A;\nb)\tupon receiving the EAP-Response/3GPP-LimitedService-Init-Info message including the AT_TWAN_CONN_MODE attribute with the message type of message field indicating MCM_REQUEST and the item list field, the 3GPP AAA server shall include the AT_TWAN_CONN_MODE attribute according to clause 8.2.7.1 in the EAP-Request/3GPP-LimitedService-Notif message. In the message field according to clause 8.1.4.1 of the AT_TWAN_CONN_MODE attribute, the 3GPP AAA server shall:\ni)\tset the message type field to MCM_RESPONSE; and\nii)\tin the item list field:\n1)\tinclude the TWAG control plane address(es) in the TWAG_CP_ADDRESS item as described in clause 8.1.4.13 in the item list field; and\nc)\tupon receiving the EAP-Response/3GPP-LimitedService-Notif message, the 3GPP AAA server shall generate the MSK using IMEI as described in clause 13.4 in 3GPP TS 33.402 [15] and send EAP Success message to the UE to allow the UE to proceed with emergency session establishment; or\nB)\tif the 3GPP AAA server is not configured to accept unauthenticated emergency session over WLAN, the 3GPP AAA server shall reject the emergency session request and return an EAP Failure message to the UE.\nThe emergency session is not supported for the UE using TSCM mode.\nNOTE:\tIf the network does not support a TWAN connection mode and the UE needs to request usage of the not supported TWAN connection mode, upon sending EAP-Request/AKA'-Challenge message, the network receives EAP-Response/AKA'-Client-Error message. Handling defined in IETF RFC 5448 [38] applies for the EAP-Response/AKA'-Client-Error message.\nIf the network supports Mobile Equipment Identity signalling over trusted WLAN, the 3GPP AAA server shall include the AT_DEVICE_IDENTITY attribute in:\n-\tthe EAP-Request/AKA'-Challenge message; or\n-\tthe EAP-Request/3GPP-LimitedService-Init-Info message;\nwith the Identity Type field set to either 'IMEI' or 'IMEISV' and an empty Identity Value field to request the UE to provide the Mobile Equipment Identity indicated in the Identity Type.\nUpon receiving:\n-\tthe EAP-Response/AKA'-Challenge message; or\n-\tthe EAP-Response/3GPP-LimitedService-Init-Info message;\nfrom the UE, if the AT_DEVICE_IDENTITY attribute is included and Identity Type field is set to either 'IMEI' or 'IMEISV', then the 3GPP AAA server shall forward the received Mobile Equipment Identity to the TWAN as specified in 3GPP TS 29.273 [17].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.4\tMultiple PDN support for trusted non-3GPP access",
                            "text_content": "Connectivity to multiple PDNs via trusted non-3GPP access is supported in the EPS when the network policies, the non-3GPP access and the user subscription allow it.\nNOTE 1:\tIn 3GPP, there is a limitation to the maximum number of simultaneous PDN connections per UE caused by the number of EPS bearer identities (see clause 11.2.3.1.5 of 3GPP TS 24.007 [48]). Not complying with this limitation when accessing non-3GPP access can lead to unexpected consequences, e.g. connectivity loss in case of handover to 3GPP access. The maximum number of PDN connection via trusted non-3GPP access is independent from the maximum number of active EPS bearer contexts for 3GPP access (see clause 6.5.1A of 3GPP TS 24.301 [10]).\nIf the UE supports dynamic mobility management selection the UE shall use the same mobility protocol when multiple connections are established, see 3GPP TS 23.402 [6].\nWhen the UE accesses EPC via S using trusted non-3GPP IP access and establishes connections to additional PDNs, the UE shall send a trigger for additional PDN connectivity specific to the non-3GPP access. The UE shall include an APN in this trigger to connect to the desired PDN. The UE shall also indicate the Attach Type to the trusted non-3GPP access during additional PDN connectivity. The Attach Type shall distinguish between Initial Attach and H Attach. For the multi-connection mode used via trusted WLAN access network, the PDN connection establishment procedures are specified in 3GPP TS 24.244 [56].\nNOTE 2:\tThe indication about Attach Type is non-3GPP access network specific and its coding is out of scope of this specification.\nNOTE 3:\tThe trigger for additional PDN connectivity is non-3GPP access network specific and its coding is out of scope of this specification.\nWhen the UE accesses EPC via S using non-3GPP IP access, the UE shall follow the procedures described in 3GPP TS 24.303 [11] to connect to multiple PDNs.\nIf the UE accesses EPC via S2a using non-3GPP IP access and it is handing over from a source access network to a target non-3GPP IP access and the UE has more than one PDN connection to a given APN in the source access network, the UE shall transfer all the PDN connections for the given APN to the target trusted non-3GPP access network as specified in 3GPP TS 23.402 [6].\nIf multiple PDN connections to a single APN are not supported over the target trusted non-3GPP access network, only one PDN connection to the given APN shall be established in the target non-3GPP access as specified in 3GPP TS 23.402 [6]. If multiple PDN connection requests to the same APN are received but the target trusted non-3GPP access network does not support multiple PDN connections to the same APN, the network shall reject the additional PDN connection requests to the same APN received from the UE when one PDN connection to the same APN has already been established. The UE shall determine which PDN connection is re-established in the non-3GPP access based on the home address information (i.e. IPv4 address or IPv6 prefix or both) provided by the network.\nNOTE 4:\tThe protocol details of the PDN connection reject procedure is non-3GPP access network specific and its coding is outside the scope of this specification. For the multi-connection mode used via trusted WLAN access network, the protocol details of the PDN connection reject procedure is specified in 3GPP TS 24.244 [56]\nNOTE 5:\tWhen UE supporting IP address preservation for NBM with multiple PDN connections to the same APN hands over to the non-3GPP access network, the UE can, as an implementation option, prioritise the re-establishment for a particular PDN connection before re-establishing the remaining PDN connections. The way a UE prioritizes a particular PDN connection is non-3GPP access network specific and its coding is out of scope of this specification. Another implementation option can be to send multiple re-establishment requests concurrently.\nNOTE 6:\tAny unsuccessful re-establishment of any of the multiple PDN connections to the same APN can be managed in an implementation specific manner avoiding UE making repeated re-establishment attempts to the network.\nIf the UE did not handover all the PDN connections for a given APN to the target trusted non-3GPP access network, the network may disconnect the remaining PDN connections for that given APN after an implementation dependent time.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tAuthentication and authorization for accessing EPC via an untrusted non-3GPP access network",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tGeneral",
                            "text_content": "In order to attach to the evolved packet core network (EPC) via untrusted non-3GPP IP access, the UE first needs to be configured with a local IP address from the untrusted non-3GPP access network.\nDuring the attach to the untrusted non-3GPP access, the operator of the non-3GPP access network may optionally require to perform a 3GPP based access authentication as specified in 3GPP TS 33.402 [15].\nOnce the UE is configured with a local IP address, the UE shall select the Evolved Packet Data Gateway (ePDG) as described in clause 7.2.1 and shall initiate the IPsec tunnel establishment procedure as described in clause 7.2.2. During these steps authentication and authorization for access to EPC shall be performed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tFull authentication and authorization",
                            "text_content": "During the establishment of the IPSec tunnel between the UE and the ePDG, 3GPP based authentication signalling for untrusted non-3GPP access to the EPC shall be exchanged between the UE and the 3GPP AAA server in the EPC to ensure mutual authentication of the user and the EPC.\nAuthorization of EPC access shall be performed by the 3GPP AAA server upon successful user authentication.\nThe access authentication signalling between the UE, ePDG and the 3GPP AAA server shall be based on EAP-AKA as specified in IETF RFC 4187 [33] and is further detailed in 3GPP TS 33.402 [15], 3GPP TS 29.273 [17] and procedural descriptions in clauses 6.5.2.2, 6.5.2.4 and 6.5.2.3.\nWhen accessing the EPC via the ePDG, the UE shall exchange EAP-AKA signalling with the 3GPP AAA server as specified in 3GPP TS 33.402 [15].\nNOTE:\tthe EAP payload exchanged between UE and 3GPP AAA server is transported within the IKEv2 messages exchanged with ePDG as described in clause 7.2.2.\nAfter the UE has been successfully authenticated, if the UE receives EAP-Request/AKA-Notification dialogue with AT_NOTIFICATION attribute value 1031 – \"User has not subscribed to the requested service\" as defined in IETF RFC 4187 [33], the UE shall not initiate the EPC access procedure to same ePDG until switching off or the UICC containing the USIM is removed.\nNOTE: Swittching off and USIM change conditions are implemented taking into consideration the user experience aspect.\n6.5.2.2.2.1\tIdentity management\nThe support of user identity privacy as defined in IETF RFC 4187 [33] and based on temporary identity is mandatory for the UE.\nAs defined in 3GPP TS 33.402 [15], the UE sends the user identity (in the IDi payload) in the first message of the IKE_AUTH phase. The user identity sent by the UE in the IDi payload depends on the presence of the temporary identity as defined in IETF RFC 4187 [33]:\n-\tIf valid fast re-authentication identity is available, the UE shall use the fast re-authentication NAI;\n-\tOtherwise if valid pseudonym is available, the UE shall use the pseudonym NAI;\n-\tOtherwise the UE shall use the permanent IMSI-based or IMEI-based NAI.\nThe temporary identities shall be in the form of a NAI, as specified in 3GPP TS 23.003 [3] clause 19. The permanent identity shall be in the form of a NAI in which username is derived from IMSI or IMEI as defined in 3GPP TS 23.003 [3]. IETF RFC 4187 [33] defines the leading digits to identify the authentication mechanism. The leading digit defined for EAP-AKA authentication shall be used in the NAI for both the temporary identities and the permanent identity.\nThe UE after successful EAP authentication may store the new temporary identity(ies) received in AT_ENCR_DATA attribute together with the fast re-authentication parameters (new master key, transient EAP keys and counter value) in the non-volatile memory of the UE or in the USIM as specified in 3GPP TS 31.102 [45]. In this later case the pseudonym is stored in the \"Pseudonym\" data file and the fast re-authentication identity, new master key, transient EAP keys and counter value in the \"Re-authentication identity\" data file.\nIf no new temporary identity was received in AT_ENCR_DATA attribute of a successful EAP authentication, the stored temporary identity becomes invalid and the UE shall not send this temporary identity at the next EAP authentication. In case the temporary identity is stored in the USIM, the UE shall set the username of the corresponding temporary identity field to the \"deleted\" value (hexadecimal value FF) to indicate that this temporary identity is invalid as specified in 3GPP TS 23.003 [3].\n6.5.2.2.2.2\tProtected result indications\nThe UE shall support protected result indications (i.e. MAC protected) as specified in IETF RFC 4187 [33].\nDuring the authentication of the UE for accessing the EPC via the ePDG, the 3GPP AAA server shall initiate EAP-AKA based authentication with the UE as specified in 3GPP TS 33.402 [15].\nAfter the UE has been successfully authenticated and the EPC access is not authorized for the UE, the 3GPP AAA Server shall invoke an EAP-Request/AKA-Notification dialogue and indicate this to the UE by using the AT_NOTIFICATION attribute value 1031 – \"User has not subscribed to the requested service\" as defined in IETF RFC 4187 [33].\n6.5.2.3.2.1\tIdentity management\nThe support of user identity privacy is mandatory for the 3GPP AAA server. The usage of this feature depends on operator's policies.\nIf user identity privacy is used, the 3GPP AAA server shall send new encrypted temporary identity (pseudonym and/ or fast re-authentication identity) to the UE in every EAP authentication procedure. The 3GPP AAA selects the pseudonym identity or the Fast Re-authentication Identity and returns the identity to the UE during the Authentication procedure as specified in 3GPP TS 33.402 [15]. The 3GPP AAA server shall maintain a mapping between the UE's permanent identity and the pseudonym identity and between the UE's permanent identity and the Fast Re-authentication Identity.\n6.5.2.3.2.2\tEAP AKA based authentication\nThe 3GPP AAA server shall support EAP AKA based authentication as specified in IETF RFC 4187 [33].\n6.5.2.3.2.3\tFast re-authentication\nThe 3GPP AAA server shall support fast re-authentication as specified in the IETF RFC 4187 [33]. Fast re-authentication should be enabled in the 3GPP AAA server. The decision of using fast re-authentication is taken in the 3GPP AAA server depending on operator's policies. The 3GPP AAA server indicates to the UE the decision of using fast re-authentication by means of sending the fast re-authentication identity in the EAP authentication procedure (i.e. in EAP-Request/AKA/Challenge or EAP-Request/AKA-re-authentication). When the 3GPP AAA server sends a fast re-authentication identity to the UE, the 3GPP AAA server shall also include a pseudonym when allowed by the IETF RFC 4187 [33]. In this way, the UE retains a pseudonym if the 3GPP AAA server defers to full authentication.\n6.5.2.3.2.4\tProtected result indications\nThe 3GPP AAA server should support protected result indications (i.e. MAC protected) for EAP AKA as specified in IETF RFC 4187 [33]. The usage of this feature depends on operator's policies.\nDuring the authentication of the UE for accessing the EPC via the ePDG, the ePDG shall initiate EAP-AKA based authentication between the UE and the 3GPP AAA server as specified in 3GPP TS 33.402 [15]. The ePDG shall extract the EAP messages received from the UE over IKEv2, and send them to the 3GPP AAA Server and shall send the EAP message received from the 3GPP AAA Server to the UE over IKEv2 messages as defined in 3GPP TS 33.402 [15].\nAt the reception of the first message of the IKE_AUTH phase from the UE, indicating to the ePDG that the UE wants to use EAP over IKEv2 (i.e. AUTH parameter absent), the ePDG sends the Authentication and Authorization request to the 3GPP AAA server including the EAP_resp/Identity in the EAP payload, with the User Identity retrieved from the IDi payload and the APN information retrieved from the IDr payload of the incoming message from the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tMultiple PDN support for untrusted non-3GPP access network",
                            "text_content": "Connectivity to multiple PDNs via untrusted non-3GPP access is supported in the EPS when the network policies, the non-3GPP access and the user subscription allow it.\nNOTE 1:\tIn 3GPP, there is a limitation to the maximum number of simultaneous PDN connections per UE caused by the number of EPS bearer identities (see clause 11.2.3.1.5 of 3GPP TS 24.007 [48]) or by the number of PDU session IDs (see clause 11.2.3.1b of 3GPP TS 24.007 [48]). Not complying with this limitation when accessing non-3GPP access can lead to unexpected consequences, e.g. connectivity loss in case of handover to 3GPP access. The maximum number of PDN connection via untrusted non-3GPP access is independent from the maximum number of active EPS bearer contexts for 3GPP access (see clause 6.5.1A of 3GPP TS 24.301 [10]).\nIf the UE supports dynamic mobility management selection the UE shall use the same mobility protocol when multiple connections are established, see 3GPP TS 23.402 [6].\nWhen the UE accesses EPC via S2b using untrusted non-3GPP IP access, and the UE establishes additional PDN connections, the UE shall establish a new IPSec tunnel with the same ePDG for each PDN connection. For each tunnel establishment procedure, the UE shall indicate to the ePDG an APN to the desired PDN and an attach type indication as specified in clause 7.2.2. When establishing an additional PDN connection, the UE shall not indicate the INITIAL_CONTACT notification.\nNOTE 2:\tWhen using the S2b interface to establish an additional PDN connection, the new IPSec tunnel establishment includes a new IKEv2 authentication and security association establishment as specified in clause 7.2.2.\nWhen the UE accesses EPC via S using untrusted non-3GPP IP access, the UE shall follow the procedures described in 3GPP TS 24.303 [11] when establishing multiple PDN connections. For multiple PDN connections, the UE shall establish only one IPsec tunnel to the ePDG.\nIf the UE had more than one PDN connection to a given APN in the source access network and the UE is performing a handover to a target untrusted non-3GPP access network via an ePDG that supports accessing an EPC via S2b-interface, the UE shall transfer all the PDN connections for the given APN to the target untrusted non-3GPP access network as specified in 3GPP TS 23.402 [6].\nIf multiple PDN connections to a single APN are not supported over the target untrusted non-3GPP access network, only one PDN connection to that given APN shall be established in the target non-3GPP access network as specified in 3GPP TS 23.402 [6] if NBM is used. The UE, if supporting IP address preservation for NBM, shall include the home address information during the tunnel establishment procedure as specified in clause 7.2.2. If multiple PDN connection requests to the same APN are received but the network does not support multiple PDN connections to the same APN, the ePDG shall reject the additional PDN connection requests to the same APN received from the UE as described in clause 7.4.1, in the following circumstances:\n-\twhen one PDN connection to the same APN has already been established;\n-\tonly after the network has successfully established one PDN connection in the case that the additional PDN connections requests were received prior to the successful establishment of a single PDN connection.\nIn the above cases, the UE shall determine which PDN connection is re-established in the non-3GPP access based on the home address information provided by the network.\nThe UE behaviour, when PDN connection re-establishment is rejected by the network during handover to the untrusted non-3GPP access network, is described in clause 7.2.2.\nNOTE 3:\tWhen a UE supporting IP address preservation for NBM with multiple PDN connections to the same APN hands over to the non-3GPP access network, the UE can, as an implementation option, prioritise the re-establishment for a particular PDN connection before re-establishing the remaining PDN connections. The UE indicates the prioritised PDN connection by including both the APN in the IDr payload and the home address information in the Handover Attach indicator as specified in clause 7.2.2. Another implementation option can be to send multiple re-establishment requests concurrently.\nIf the UE did not handover all the PDN connections for a given APN to the target untrusted non-3GPP access network, the source network may disconnect the remaining PDN connections for that given APN after an implementation dependent time.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.6\tUE - 3GPP EPC (cdma2000® HRPD Access)",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tGeneral",
                            "text_content": "3GPP2 X.S0057 [20] defines the interworking architecture for access to the EPC via cdma2000® HRPD access networks. In particular, 3GPP2 X.S0057 [20] describes support for a UE using the cdma2000® HRPD air interface to access the EPC architecture defined in 3GPP TS 23.402 [6] by:\n-\tspecifying the use of the interface between the 3GPP2 HRPD Serving Gateway (HSGW) and the PDN Gateway (P-GW) in the EPC by referencing 3GPP TS 29.275 [18], when the HSGW supports UEs accessing EPC via S2a;\n-\tspecifying the use of the interface across the S101 reference point between the eAN/PCF in the 3GPP2 HRPD access network and the MME in the EPC by referencing 3GPP TS 29.276 [19];\n-\tspecifying the use of the user plane interface across the S103 reference point between the EPC Serving Gateway (S-GW) and the HSGW by referencing 3GPP TS 29.276 [19]; and\n-\tdescribing the internal functions and responsibilities of the HSGW.\n3GPP2 C.S0087 [21] defines the signalling requirements and procedures for UEs accessing the EPC via 3GPP2 HRPD access networks using the cdma2000® HRPD air interface. In particular, 3GPP2 C.S0087 [21]:\n-\tdefines the signalling extensions to the cdma2000® HRPD air interface defined in 3GPP2 C.S0024 [23] necessary to support interworking with the EPC and E-UTRAN; and\n-\tdefines the UE and eAN/PCF procedures and signalling formats to support bidirectional handoff between E-UTRAN and cdma2000® HRPD.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.2\tNon-emergency case",
                            "text_content": "Clauses 6.6.2.2 through 6.6.2.7 describe the particular requirements for access to the EPC via a cdma2000® HRPD access network in support of non-emergency accesses and services.\nThe UE and network shall use the root NAI as specified in 3GPP TS 23.003 [3] for EPC access authentication when the UE obtains service via a cdma2000® HRPD access network connected to an EPC in the UE's HPLMN.\nAdditionally, the UE and network shall use the Fast-Reauthentication NAI and the Pseudonym Identity as described in clause 4.4.\nThe access network identity is described in 3GPP TS 23.003 [3] and in clause 6.4.2.4 of this specification. For a cdma2000® HRPD network, the value and encoding of the access network identity is described in clause 8.1.1. The 3GPP AAA server, HSS, and any visited network AAA proxy shall use the access network identity during EAP-AKA' authentication procedures (see 3GPP TS 33.402 [15]).\nThe UE shall rely on information provisioned by the home operator to facilitate the PLMN system selection process described in 3GPP TS 23.122 [4].\nThe UE shall determine the trust relationship for access to the EPC via a cdma2000® HRPD access network as described in clause 4.1.\nThe UE and network shall perform IP mobility mode selection as described in clauses 6.3.3.1 and 6.4.3.2\nThe UE and 3GPP AAA server shall perform authentication and authorization procedures for access to the EPC as defined in 3GPP TS 33.402 [15].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.3\tEmergency case",
                            "text_content": "Clauses 6.6.3.2 through 6.6.3.3 describe the particular requirements for access to the EPC via a cdma2000® HRPD access network in support of an emergency session in course of handover from E-UTRAN to HRPD.\nIn this release of the specification no emergency session related handling other than the handover of an emergency session from E-UTRAN to an cdma2000® HRPD access network supporting access S-GW or PDN GW via S2a-interface is specified.\nWhen the UE obtains emergency services via a cdma2000® HRPD access network connected to an EPC in the UE's HPLMN, then the UE and the network shall use the NAI for EPC access authentication as follows:\n-\tif IMSI is available and authenticated , then the UE and the network shall use the root NAI;\n-\tif IMSI is not available or unauthenticated, then the emergency NAI shall be used.\nAdditionally, the UE and the network shall use the Fast-Reauthentication NAI and the Pseudonym Identity as described in clause 4.4.1.\nIf IMSI is available, then the authentication and authorization procedures via STa are executed if the local regulation and network operator option requires authenticating the UE.\nIf the authentication and authorization procedures fail, then it depends on local regulation and network operator option to allow or reject the emergency services for the UE.\nIf IMSI is not available, the authentication and authorization procedures via STa are not executed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tUE - 3GPP EPC (WiMAX Access)",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.7.1\tGeneral",
                            "text_content": "The WiMAX system and its access network subsystem are described within WiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 2 [24]. The protocol architecture and signalling of the WiMAX system is specified in WiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 3 [25]. This protocol architecture and signalling supports the air interface defined in WiMAX Forum Mobile System Profile Release 1.0 Approved Specification Revision 1.4.0 [26] which specifies selected profiles of IEEE Std 802.16e-2005 and IEEE Std 802.16-2004/Cor1-2005 [27].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.2\tNon-emergency case",
                            "text_content": "Clauses 6.7.2.2 through 6.7.2.7 describe the particular requirements for access to the EPC via a WiMAX access network in support of non-emergency accesses and services.\nThe UE and network shall use the root NAI as specified in 3GPP TS 23.003 [3] for EPC access authentication when the UE obtains service via a WiMAX access network connected to an EPC in the UE's HPLMN.\nAdditionally, the UE and network shall use the Fast-Reauthentication NAI and the Pseudonym Identity as described in clause 4.4.\nThe access network identity is described in 3GPP TS 23.003 [3] and in clause 6.4.2.4 of this specification. For a WiMAX network, the value and encoding of the access network identity is described in clause 8.1.1. The 3GPP AAA server, HSS, and any visited network AAA proxy shall use the access network identity during EAP-AKA authentication procedures (see 3GPP TS 33.402 [15]).\nThe UE shall use WIMAX-specific procedures described in WiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 3 [25] to discover and select the highest priority Network Service Provider (NSP) which is available and allowable.\nThe UE shall determine the trust relationship for access to the EPC via a WiMAX access network as described in clause 4.1.\nThe UE and network shall perform IP mobility mode selection as described in clauses 6.3.3.1 and 6.4.3.2.\nNOTE:\tIn line with 3GPP TS 33.402 [15], in this present specification, no particular security provisions are specified for interworking between WiMAX and EPS. Any access specific security procedures for WiMAX as a non-3GPP access network to EPC will be in accordance with WiMAX Forum Network Architecture Release 1.0 version 1.2 – Stage 3 [25] and WiMAX Forum Mobile System Profile Release 1.0 Approved Specification Revision 1.4.0 [26].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.3\tEmergency case",
                            "text_content": "NOTE:\tProcedures for handling emergency accesses or services are not specificed within this release of the specification\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.8\tCommunication over the S14",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tGeneral",
                            "text_content": "In order to assist the UE with performing access network discovery and selection, ANDSF provides a set of information to the UE. This information contains:\n-\tthe access network discovery and selection information to assist the UE with selecting the access network;\n-\tISMP to control and assist the UE with performing the inter-system change;\n-\tISRP information to control and assist a UE with selecting the access network to be used for routing different IP flows over different access networks, establishing PDN connections and identifying IP flows applicable for non-seamless WLAN offload;\n-\tIARP information to control and assist a UE with selecting a prioritised APN which is associated with an existing PDN connection for routing different IP flows. The IARP provided by ANDSF can also include information for identifying IP flows applicable for non-seamless WLAN offload.\n-\tWLAN Selection Policy to assist the UE with selecting the WLAN access network;\n-\tHome Network Preference information to assists the UE in selecting a WLAN and a service provider for 3GPP-based authentication over WLAN;\n-\tVisited Network Preference information to assist the UE in selecting a WLAN and a service provider for 3GPP-based authentication over WLAN when the UE is roaming in a V-PLMN; or\n-\tRule selection information to assist the roaming UE with selecting the active ANDSF rules to be used.\nThe ANDSF can provide ISRP rules to a UE independently of the UE's support for IFOM, MAPCON, NSWO, RAT differentiation in ISRP or RAN-assisted WLAN interworking. Handling of ISRP nodes unsupported by the UE is described in in 3GPP TS 24.312 [13].\nThe ANDSF can provide IARP rules to a UE independently of the UE's support for NSWO, Inter-APN routing or RAN-assisted WLAN interworking. Handling of IARP nodes unsupported by the UE is described in in 3GPP TS 24.312 [13].\nThis set of information can either be provisioned in the UE by the home operator, or provided to the UE by the ANDSF over the S14 reference point via pull or push mechanisms as defined in 3GPP TS 23.402 [6] by means of the access network discovery and selection procedures as described in clause 6.8.2. While roaming, the UE can receive a set of information from H-ANDSF or V-ANDSF or both. The V-ANDSF shall not provide any IARP or rule selection information to a roaming UE. If the roaming UE receives any IARP or rule selection information delivered by a V-ANDSF then the roaming UE shall ignore it.\nThe UE, located in the home PLMN, needs to discover the H-ANDSF by means of the discovery procedure as described in clause 6.8.2.2.1. The UE, located in the visited PLMN, needs to discover the H-ANDSF or V-ANDSF or both by means of the discovery procedure as described in clause 6.8.2.2.1.\nThrough push mechanisms the ANDSF can provide assistance information to the UE e.g. if the UE has previously used pull based ANDSF procedure or if OMA-DM bootstrapping is used as described in clause 6.8.2.2.1A. Through pull mechanisms the UE can send a request to the ANDSF in order to get assistance information for access network discovery and selection.\nANDSF shall comply with local, national and regional requirements regarding the privacy and confidentiality of location information.\nNOTE:\tThe regulation and legislations of the home operator of the ANDSF server determines whether the ANDSF server can store the user's location information.\nIf the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2, then the access stratum layer of the 3GPP access can provide RAN assistance parameters and corresponding (E-)UTRAN measurements which are used in accordance with the ANDSF MO defined in 3GPP TS 24.312 [13].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tInteraction with the Access Network Discovery and Selection Function",
                            "text_content": "The S14 interface enables IP level communication between the UE and ANDSF. The protocols supported by the S14 interface are realized above the IP level. Both pull and push mechanisms may be supported for communication between the UE and the ANDSF. A combination of pull and push mechanisms may also be supported. The communication security over the S14 interface is specified in 3GPP TS 33.402 [15].\nThe UE, located in a home PLMN, can communicate securely with the H-ANDSF. The UE, located in a visited PLMN, can communicate securely with H-ANDSF or V-ANDSF or both.\nThe information is transferred between the UE and ANDSF using OMA DM as defined in OMA-ERELD-DM-V1_2 [39] with the management object as specified in 3GPP TS 24.312 [13].\nThe IP address of the H-ANDSF can be configured in the UE by the home operator.\nWhen the UE is in its HPLMN or equivalent HPLMN, the UE may use DNS lookup as specified in IETF RFC 1035 [35] or DHCP query as specified in IETF RFC 6153 [37] to discover the IP address of the H-ANDSF. If the UE implements DHCP query, the preference between DNS lookup and DHCP query is UE implementation dependent. .\nWhen the UE is in a visited PLMN, the UE shall use DNS lookup to discover the IP address of the ANDSF.\nWhen performing a DNS lookup resolution for ANDSF, the UE shall apply the following procedures:\n-\tFor the H-ANDSF discovery, the UE shall build a Fully Qualified Domain Name (FQDN) that shall be set to the ANFSF-SN FQDN as defined in 3GPP TS 23.003 [3] for the DNS request and select the IP address of the H-ANDSF included in the DNS response message.\n-\tFor the V-ANDSF discovery, the V-ANDSF IP address by which the UE can contact the V-ANDSF is obtained by the UE through a DNS lookup by name as specified in IETF RFC 1035 [35]. The QNAME shall be set to the ANDSF-SN FQDN and included in the DNS Request as defined in 3GPP TS 23.003 [3], and select the IP address of the V-ANDSF included in the DNS response message.\nAccording to 3GPP TS 33.402 [15], for the pull model, the UE and ANDSF shall use PSK TLS with GBA based shared key-based mutual authentication to establish a secure connection between UE and ANDSF as specified by clause 5.4 of 3GPP TS 33.222 [44].\nAccording to 3GPP TS 33.402 [15], for the push model, the UE and ANDSF shall use PSK TLS with GBA push based shared key-based mutual authentication to establish a secure connection between the UE and the ANDSF as specified by clause 5.1 of 3GPP TS 33.223 [47].\nIn accordance with 3GPP TS 29.109 [43], the BSF shall provide either the UE's IMSI or IMPI to NAF, ie the ANDSF server.\nOMA-DM's application level authentication mechanism does not need to be used with ANDSF, since mutual security association is already established on transport level using PSK-TLS as specified in 3GPP TS 33.402 [15]. According to OMA-ERELD-DM-V1_2 [39], however, each Managed Object (MO) shall have an access control list (ACL) that lists authorized OMA DM servers. In order to comply with OMA-ERELD-DM-V1_2 [39], the ANDSF-SN FQDN shall be used as server name in the ACL list.\nIf the UE does not support the ANDSF security mechanism as specified in 3GPP TS 33.402 [15], or if the operator does not implement the GAA bootstrap framework specified in 3GPP TS 33.220 [42], appropriate communication security can be established with the ANDSF using OMA-DM's bootstrap, secure http (https) mechanism and WAP Push according to OMA-ERELD-DM-V1_2 [39].\nThe UE shall implement the push model of ANDSF in accordance with OMA-ERELD-DM-V1_2 [39] using WAP Push, which is applicable for 3GPP access networks only.\nIf the UE operates according to the GAA bootstrap framework specified in 3GPP TS 33.220 [42] and if the UE supports GBA Push as specified in 3GPP TS 33.223 [47], the UE shall accept the SMS as a valid ANDSF notification SMS if:\n-\tthe notification SMS contains valid GBA Push Information (GPI) as specified in 3GPP TS 24.109 [52],\n-\tthe X-WAP-Application-ID field (Push Application ID) in the WSP header indicates ANDSF,\n-\tthe WSP payload contains only the header part defined in 3GPP TS 24.109 [52] and the GPI parameter without any additional identifiers and\n-\tthe NAF FQDN in GPI conforms to the ANDSF-SN specified in 3GPP TS 23.003 [3].\nThe short code for the X-WAP-Application-ID is specified in clause 8.1.3.\nIf the UE operates according to OMA DM bootstrap procedures as specified in OMA DM Enabler Release v.1.2, see OMA-ERELD-DM v1_2 [39], the UE shall accept the SMS as a valid ANDSF notification SMS if it contains an OMA DM General Package #0 message according to OMA-ERELD-DM v1_2 [39].\nIn the push model of communication, if the UE receives a valid ANDSF notification SMS from the ANDSF, the UE shall establish a secure data connection using the information received in the notification SMS.\nIf the UE receives an invalid ANDSF notification SMS it shall be ignored by the UE.\nUpon establishing a secure connection between the UE and ANDSF, the UE may be provided with updated ISMP, ISRP, IARP, WLANSP and information about available access networks. The list of the information is described in clause 6.8.1 and 6.8.2.3.3 and the correspondent  is defined in 3GPP TS 24.312 [13].\nIn the pull model of communication, the UE sends a query to ANDSF to retrieve or update inter-system mobility policy or information about available access networks in its vicinity or inter-APN routing policy or any combination of them. A UE supporting IFOM, MAPCON, NSWO or any combination of these may also request ISRP. A UE may request IARP. The UE will wait for an implementation dependent time for an answer from the ANDSF. If ANDSF does not respond within that time, further action by the UE is implementation dependent. The UE may provide to ANDSF the UE's location information including, if available, the location parameters (for example, cell identities or the MAC address of the WLAN AP) associated with the Radio Access Networks the UE has discovered in its current location at the time the UE sends a query to ANDSF; the format of the location information is described as UE_Location in  defined in 3GPP TS 24.312 [13].\nAfter communicating with ANDSF, the UE may be provided with updatedISMP, ISRP, IARP, WLANSP and information about available access networks. The list of the information is described in clause 6.8.1 and 6.8.2.3.3 and the correspondent  is defined in 3GPP TS 24.312 [13].\nThe UE may start Pull model communication with ANDSF based upon the information previously received from the ANDSF (e.g. based on the value of UpdatePolicy leaf defined in 3GPP TS 24.312 [13]). The UE capable of IFOM, MAPCON, or non-seamless WLAN offload (or any combination of these capabilities) can have all these capabilities disabled and have no ISRP. If the UE enables one (or more) of these capabilities, the UE may start Pull model communication with ANDSF. The UE capable of IFOM, MAPCON, or non-seamless WLAN offload (or any combination of these capabilities) can have one (or more) of these capabilities enabled and have no ISMP. If the UE disables all these capabilities, the UE may start Pull model communication with ANDSF. If the UE has no IARP, the UE may start Pull model communication with ANDSF.\nNOTE:\tMechanisms to limit the frequency of queries transmission from the UE to the ANDSF are implementation dependant.\n6.8.2.2.4.1\tGeneral\nANDSF may provide various types of information to the UE, including access network discovery information, WLAN selection information, ePDG configuration information, inter-system mobility policy, the inter-system routing policies and the inter-APN routing policies. The UE may retain and use this ANDSF information until new or updated information is received.\nNetwork detection and selection shall take into account the access network specific requirements and the UE's local policy, e.g. user preference settings, access history, etc, along with the information provided by the ANDSF when discovering and selecting an access network. The local policy and the information provided by the ANDSF shall be used by the UE in an implementation dependent way to limit the undesired alternating between access systems, e.g. ping-pong type of inter-system changes. However, the use of such information from the ANDSF shall not be in contradiction to functions specified in 3GPP TS 23.122 [4], 3GPP TS 25.304 [14] and 3GPP TS 36.304 [16].\nIf the UE is roaming in a VPLMN, the UE may receive Inter-system mobility policies or Access network discovery information or ISRP or combinations of these from H-ANDSF or V-ANDSF or both. The UE may also receive the IARP from H-ANDSF. If IARP is received from V-ANDSF, the UE shall ignore it. The UE may also receive WLAN selection information including WLAN Selection Policy (WLANSP) from H-ANDSF or V-ANDSF or both, rule selection information, and Home Network Preference information from H-ANDSF. The UE may receive Visited Network Preference information from V-ANDSF. The UE may also receive ePDG configuration information from H-ANDSF. The formats of the above information are defined in 3GPP TS 24.312 [13].\nThe maximum number of sets of Inter-system mobility polices or Access network discovery information or ISRP or IARP or combinations of these that the UE may keep is implementation dependent. However, the UE shall retain at least one set of Inter-system mobility policies and one set of Access network discovery information from the same ANDSF. In addition, a UE supporting IFOM, MAPCON, or non-seamless WLAN offload shall retain at least one ISRP rule from the same ANDSF. Additionally, a UE shall retain at least one set of IARP received from the H-ANDSF.\nIf a UE supporting IFOM, MAPCON, or non-seamless WLAN offload (or any combination of these featureshas ISMP and ISRP available, and if the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2, then ISRP shall be used for the routing of IP traffic. The relation between ISRP and user preferences is described in clause 5.4.2.\nFor a UE with IFOM, MAPCON or non-seamless WLAN offload (or any combination of these capabilities) enabled, if ISMP, ISRP and IARP are available, and if the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2, then IARP and ISRP shall be used. In this case, the UE shall first apply IARP followed by ISRP as follows:\n-\tIf non-seamless WLAN offload is selected by IARP then the IP flow is routed to the non-seamless WLAN offload and ISRP shall not be used for the routing of IP traffic.\n-\tIf a certain APN is selected by IARP then the IP flow is routed to the PDN connections corresponding to this APN. If there is a ForFlowBased ISRP rule matching the IP flow after the APN is selected, then the UE shall use the ForFlowBased ISRP rule matching the IP flow to select the access for this IP flow.\n-\tIf neither certain APN nor non-seamless WLAN offload is selected by IARP or one or more APNs are restricted by the IARP for routing the IP flow, then ISRP shall be used for the routing of IP traffic. When one or more APNs are restricted by the IARP, if a rule for NSWO is matched in the active ISRP rule that restricts the use of the selected WLAN (or any WLAN) for routing the IP flow, then the UE selects a not restricted APN to route the IP flow.\nThe relation between IARP and user preferences is described in clause 5.4.2.\nFor a UE not supporting any of IFOM, MAPCON or non-seamless offload capabilities or with all those capabilities disabled, if ISMP and ISRP are available, and if the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2, the ISMP shall be used.\nFor a UE not supporting any of IFOM, MAPCON capabilities or with all those capabilities disabled, if ISMP, ISRP and IARP are available, and if the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2, the IARP and ISMP shall be used. In this case, the UE shall firstly apply ISMP followed by IARP as follows:\n-\tIf the 3GPP access is selected by ISMP policy, then the UE shall use the active IARP rule to determine if the IP flow is routed to the PDN connection corresponding to a certain APN. The non-seamless WLAN offload policy, defined in the IARP, shall not be used for routing of IP traffic; and\n-\tIf the WLAN access is selected by ISMP policy, then the UE shall use the active IARP rule to determine if the IP flow is routed to the PDN connection corresponding to a certain APN or using the non-seamless WLAN offload.\nThis information shall be deleted if there is a change of USIM. This information may be deleted when UE is switched off.\nIf the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2, irrespective of whether any rule in ANDSF policies is 'active' or not, the UE shall periodically re-evaluate ANDSF policies. The value of the periodic re-evaluation timer is implementation dependant. The additional trigger for (re-)evaluating rules is that the 'active' rule becomes invalid (conditions no longer fulfilled), or other manufacturer specific trigger. When the UE receives ANDSF information it shall re-evaluate the available rules along with the new information.\n6.8.2.2.4.2\tUse of Inter-system Mobility Policy\nThis clause applies if the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2.\nIf more than one set of Inter-system mobility policies is available in the UE, the UE shall only use one set of Inter-system mobility policies at any one time.\nWhen the UE is roaming and receives Inter-system Mobility Policies from both H-ANDSF and V-ANDSF, the set of Inter-system Mobility Policies used by the UE is selected as follows:\n-\tIf there is rule selection information provisioned in the UE by the H-ANDSF, and if the RPLMN identity is equal to one of the VPLMNs included in the visited PLMNs with preferred rules, the set of Inter-system Mobility Policies from V-ANDSF is selected by the UE.\nIf the preferred access technology according to the Inter-system Mobility Policy is WLAN access technology, and if there is no WLANs matching the WLANSP rule(s) from the V-ANDSF, the set of of Inter-system Mobility Policies from H-ANDSF is selected by the UE. However, if at least one WLAN matching one or more groups of selection criteria in the VPLMN's WLANSP rule becomes available, the UE should re-use the WLANSP policies and Inter-system Mobility Policies from V-ANDSF.\n-\tIf there is rule selection information provisioned in the UE by the H-ANDSF, and if the RPLMN identity is not equal to any of the VPLMNs included in the visited PLMNs with preferred rules, the set of Inter-system Policies from H-ANDSF is selected by the UE.\nIf the preferred access technology according to the Inter-system Mobility Policy is WLAN access technology, and if there is no WLANs matching the WLANSP rule(s) from the H-ANDSF, the set of of Inter-system Mobility Policies from V-ANDSF is selected by the UE. However, if at least one WLAN matching one or more groups of selection criteria in the HPLMN's WLANSP rule becomes available, the UE should re-use the WLANSP policies and Inter-system Mobility Policies from H-ANDSF.\nNOTE:\tHow frequently the UE performs the discovery and reselection procedure depends on the UE implementation.\nThe Inter-system Mobility Policy with the highest priority among the set of Inter-system Mobility Policies selected above is selected as the active Inter-system Mobility Policy. A UE uses the ISMP to decide if the most preferred available WLAN based on the WLANSP rule has higher priority than the 3GPP RAT. If so, the UE shall connect to EPC via WLAN access. Otherwise, the UE shall connect to EPC via 3GPP access. The prioritized list of WLAN in the active ISMP rule shall not be used for WLAN selection.\nWhen applying the Inter-system mobility policy the following requirements apply:-\n-\tthe requirements on periodic network reselection as described in clause 5.3.4 of the present specification;\n-\tthe PLMN selection rules specified in 3GPP TS 23.122 [4] and in clause 5.2.3.2;\n-\tthe selection rules specified in 3GPP2 C.P0016-D [23a]; and\n-\tthe 3GPP RAT selection, cell selection and reselection rules specified in 3GPP TS 25.304 [14], 3GPP TS 36.304 [16] and 3GPP TS 45.008 [16a].\n6.8.2.2.4.3\tUse of Access Network Discovery Information\nThe UE may use the received Access network discovery information of both the H-ANSDF and V-ANDSF for network discovery and detection. The Access network discovery information received from:-\na)\tthe H-ANDSF provides guidance for the UE on access networks that have connectivity to the HPLMN or equivalent HPLMNs or both; and\nb)\tthe V-ANDSF provides guidance for the UE on access networks that have connectivity to the corresponding VPLMN or equivalent PLMNs or both.\n6.8.2.2.4.4\tUse of Inter-System Routing Policies\nThis clause applies if the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2.\nA UE supporting IFOM, MAPCON, or non-seamless WLAN offload (or any combination of these features) shall use the ISRP if available.\nA UE supporting IFOM uses the ISRP to:\n-\tselect an access technology or an access network or both for routing user plane traffic matching specific IP flows on a specific or any APN identified in the ISRP. 3GPP RATs can be prioritized with respect to WLAN access but this prioritization does not influence 3GPP RAT selection; WLAN access networks can be prioritized with respect to 3GPP RATs but those WLANs do not influence WLAN selection; and\n-\tdecide if an access technology or access network or both are restricted for a specific IP flows on a specific or any APN identified in the ISRP.\nA UE supporting MAPCON uses the ISRP to:\n-\tselect an access technology or an access network or both for routing user plane traffic matching a specific APN or any APN identified in the ISRP. 3GPP RATs can be prioritized with respect to WLAN access but this prioritization does not influence 3GPP RAT selection; WLAN access networks can be prioritized with respect to 3GPP RATs but those WLANs do not influence WLAN selection; and\n-\tdecide if an access technology or an access network or both are restricted for a specific APN or any APN identified in the ISRP.\nNOTE:\tAfter selecting WLAN access for routing user plane traffic by this prioritised list of access technologies, a UE can use an implementation dependent way to prevent the traffic from being routed back to the original RAT again in a short period of time to avoid ping-pong behaviour.\nA UE supporting non-seamless WLAN offload uses the ISRP to:\n-\tselect a WLAN access network for routing, without traversing the EPC, user plane traffic matching specific IP flows for a specific APN or any APN identified in the ISRP; WLAN access networks defined in routing rule do not influence WLAN selection; and\n-\tdecide if the selected WLAN access network is restricted for routing, without traversing the EPC, a specific IP flows for a specific APN or any APN identified in the ISRP. If not, the selected WLAN can be used to perform NSWO.\nWhen the UE supporting IFOM identifies an access technology or an access network or both over which an IP flow can be routed based on the ISRP, the UE shall apply the IFOM procedures specified in 3GPP TS 24.303 [11] to move an on-going IP flow from the source access technology or access network to the identified access technology or access network, if required.\nIf more than one set of ISRP is available in the UE, the UE shall only use one ISRP at any one time.\nWhen the UE is roaming and receives Inter-system Routing Policies from both H-ANDSF and V-ANDSF, the set of Inter-system Routing Policies used by the UE is selected as follows:\n-\tIf there is rule selection information provisioned in the UE by the H-ANDSF, and if the RPLMN identity is equal to one of the VPLMNs included in the visited PLMNs with preferred rules, the set of Inter-system Routing Policies fromV-ANDSF is selected by the UE.\nIf there is no WLANs matching the WLANSP rule(s) from the V-ANDSF, the set of Inter-system Routing Policy from the H-ANDSF is re-selected. However, if at least one WLAN matching one or more groups of selection criteria in the WLANSP rule of the VPLMN becomes available, the UE should re-use the WLANSP policies and Inter-system Routing Policies from V-ANDSF.\n-\tIf there is rule selection information provisioned in the UE by the H-ANDSF, and if the RPLMN identity is not equal to any of the VPLMNs included in the visited PLMNs with preferred rules, the set of Inter-system Routing Policies from H-ANDSF is selected by the UE,\nIf there is no WLANs matching the WLANSP rule(s) from the H-ANDSF, the set of Inter-system Routing Policy from the V-ANDSF is be re-selected. However, if at least one WLAN matching one or more groups of selection criteria in the WLANSP rule of the HPLMN becomes available, the UE should re-use the WLANSP policies and Inter-system Routing Policies from H-ANDSF.\nNOTE:\tHow frequently the UE performs the discovery and reselection procedure depends on the UE implementation.\nThe Inter-system Routing Policy with the highest priority among the set of Inter-system Routing Policies selected above is selected as the active Inter-system Routing Policy.\nThe UE shall periodically re-evaluate the flow distribution rules of the 'active' ISRP rule. The value of the periodic re-evaluation timer is implementation dependant.\n6.8.2.2.4.5\tUse of Inter-APN Routing Policies\nThe UE shall use the IARP for APN if available.\nThe UE shall use the IARP for non-seamless WLAN offload if available, and the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2.\nA UE uses the IARP to:\n-\tselect an APN or non-seamless WLAN offload for routing user plane traffic matching specific IP flows; and\n-\tdecide if an APN or non-seamless WLAN offload is restricted for routing a specific IP flows.\nAn IARP for APN can be applied only when it steers IP traffic to an existing (i.e. already established) PDN connection. Also, the scenario where multiple PDN connections via the same access network are associated with the same APN is not specified in the present document.\nWhen applying IARP the same requirements defined for inter-system mobility policy in clause 6.8.2.2.4.2 applies with the exception that the UE shall apply IARP provided by the H-ANDSF.\nIf no valid IARP present, then Inter-APN routing policy configuration is UE implementation dependent.\n6.8.2.2.4.6\tUse of WLAN selection information\nThe UE uses the WLAN selection information provided by ANDSF to determine the selected WLAN and the selected service provider.\nThe UE first uses WLAN Selection Policy (WLANSP) and the visited PLMNs with preferred rules to determine the active WLANSP rule. When roaming, if the UE is configured to prefer WLAN selection rules provided by the HPLMN, WLANSP provided by HPLMN is used. Otherwise, WLANSP provided by VPLMN is used. The UE selects the highest priority and valid WLANSP rule as the active WLANSP rule.\nDuring power-up, while the UE has not registered to any PLMN, the UE shall use WLANSP provided by the HPLMN as valid.\nThe UE determines the selected WLAN(s) as specified in clause 5.1.3.2. If there are no selected WLANs according to active WLANSP rule of the VPLMN/HPLMN, then the UE uses the WLANSP policies from the HPLMN/VPLMN as active WLANSP rule. However, if at least one WLAN that matches one or more groups of selection criteria in the WLANSP rule of the VPLMN or the /HPLMN becomes available, the UE should re-use the WLANSP policies from the VPLMN or the HPLMN as active WLANSP rule.\nNOTE:\tHow frequently the UE performs the discovery and reselection procedure depends on the UE implementation.\nHome Network Preference information and Visited Network Preference information can be configured in the ANDSF MO to assist the UE in selecting a service provider over the selected WLAN(s) and constructing an appropriate NAI when attempting authentication with the selected service provider.\nThe UE uses the list of selected WLANs and the Home Network Preference information (or the Visited Network Preference information if available and if the UE is roaming) to select a WLAN service provider as specified in clause 5.2.3.2.\n6.8.2.2.4.7\tUse of ePDG information\nIf the UE accesses EPC via the ePDG, the UE shall use the ePDG configuration information during the tunnel establishment procedure to determine the home operator preference on ePDG connection as described in clause 7.2.1.\n6.8.2.2.4.8\tUse of LWA co-existence Information\nThe H-ANDSF can configure the LWA co-existence information about the preference between the WLANSP, ISRP and IARP for NSWO rules, on the one hand, and the LWA/RCLWI/LWIP procedures defined in the RAN, on the other hand, according to TS 23.402 [6]. The LWA co-existence information is configured in the ANDSF/HomeNetworkPreference/RanMobilitySetUsed node.\nIf the UE:\n-\thas not selected a WLAN according to the WLANSP rules or user preferences, including when the UE has not selected any WLAN; or\n-\thas selected a WLAN according to the WLANSP rules and is connected to a PLMN/WLAN combination configured in the ANDSF/HomeNetworkPreference/RanMobilitySetUsed node,\nthe UE shall use the WLAN mobility set (see 3GPP TS 36.300 [70]) and ignore the WLANSP, ISRP and IARP for NSWO rules. In order to apply the WLAN mobility set, the UE may disconnect from the WLAN it is currently connected to and connect to a WLAN identified by the RAN-configured WLAN mobility set.\nIf the UE:\n-\thas selected a WLAN according to the WLANSP rules and is not connected to a PLMN/WLAN combination configured in the ANDSF/HomeNetworkPreference/RanMobilitySetUsed node; or\n-\thas selected a WLAN based on user preferences,\nthe UE shall ignore the WLAN mobility set and apply the WLANSP, ISRP and IARP for NSWO rules.\nBoth the H-ANDSF and the V-ANDSF can provide information about inter-system mobility policy or information about available access networks in the vicinity of the UE or ISRP for the UE or combinations of these. The H-ANDSF may also provide IARP for the UE. The V-ANDSF shall not provide any IARP to a roaming UE. The inter-system mobility policies may be organized in a hierarchy and a priority order among multiple policies may determine which policy has the highest priority. The policies may indicate preference of one access network over another or may restrict inter-system mobility to a particular access network under certain conditions. The ANDSF may also specify validity conditions which indicate when a policy is valid. Such conditions may be based on time duration, location, RAN validity condition. The ANDSF may limit the information provided to the UE. This can be based on UE's current location, UE capabilities other than the capability of routing IP traffic simultaneously over multiple radio access interfaces (e.g. IFOM capability or MAPCON capability or non-seamless WLAN offload capability), etc. How the ANDSF decides how much information to provide to the UE is dependent on network implementation.\nIf there is no existing valid PSK TLS connection between the UE and ANDSF, the ANDSF, not implementing GBA Push, may send a notification SMS to the UE, without establishing a data connection with the UE.\nIf there is no existing valid PSK TLS connection between the UE and ANDSF, the ANDSF, implementing GBA Push, shall send a message via SMS to the UE to establish a secure connection between the UE and ANDSF. The contents of the message shall contain a GBA Push Information as specified in 3GPP TS 33.223 [47].\nAfter a secure connection is established according to clause 6.8.2.2.1A, or if there is a valid PSK TLS connection between the UE and ANDSF, the ANDSF shall use the connection to provision ANDSF information to the UE.\nWhen the UE connects to an ANDSF, the ANDSF may provide the UE with ISMP, ISRP, IARP, WLANSP or information related to available access networks in the vicinity of the UE, or combinations of these. In case of information about available access networks, the ANDSF provides the following information about each available access network in the form of a list containing:\n1)\tType of Access network (e.g. WLAN, WiMAX);\n2)\tLocation of Access Network (e.g. 3GPP location, WLAN location);\n3)\tAccess Network specific information (e.g WLAN information, WiMAX information); and\n4)\tOperator differentiated text field (if supported, e.g. if  defined in 3GPP TS 24.312 [13] is used).\nThe detailed list of information is described in 3GPP TS 24.312 [13].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.9\tHandling of Protocol Configuration Options information",
                    "description": "",
                    "summary": "",
                    "text_content": "The Protocol Configuration Options (PCO) information element is specified in 3GPP TS 24.008 [46].\nThe support of PCOs is optional for the UE and the non-3GPP access network.\nExcept for the trusted WLAN access, the content syntax of PCOs for the non-3GPP access UE and non-3GPP access network is access network specific and not in the scope of 3GPP, but if PCO is supported, the UE and the PDN-GW shall handle the PCO contents in accordance with 3GPP TS 24.008 [46].\nPCO information is exchanged between the UE and the PDN-GW, see 3GPP TS 23.402 [6], 3GPP TS 29.274 [50] and 3GPP TS 29.275 [18]. Except for the trusted WLAN access, the specification of PCO signalling in the non-3GPP access network is access network specific and not in the scope of 3GPP.\nWhen the UE access EPC via trusted WLAN access network,\n-\tif SCM is used, the PCO is supported as described in clause 6.4.2.6, 3GPP TS 29.274 [50] and 3GPP TS 29.275 [18];\n-\tif MCM is used, the PCO is supported as described in 3GPP TS 24.244 [56], 3GPP TS 29.274 [50] and 3GPP TS 29.275 [18];and\n-\tif TSCM is used, the PCO is not supported by the UE.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.10\tIntegration with access stratum layer of 3GPP access",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.10.1\tGeneral",
                            "text_content": "The clause describes the additional procedures for integration with access stratum layer of 3GPP access.\nIf the RAN assistance information is supported by the UE and the E-UTRAN or UTRAN, the E-UTRAN or UTRAN can provide RAN assistance information to the UE as described in 3GPP TS 25.331 [14A] and 3GPP TS 36.331 [16B].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.2\tSelection of control of WLAN access selection and traffic routing",
                            "text_content": "The WLAN access selection and traffic routing can be controlled either by ANDSF rules or by RAN rules.\nThe ANDSF rules control the WLAN access selection and traffic routing if:\na)\tthe UE has ANDSF rules but no RAN rules; or\nb)\tthe UE has both ANDSF rules and RAN rules; and:\n1)\tthe UE is not capable to simultaneously route IP traffic to both 3GPP access and WLAN; and:\nA)\tthe UE is not roaming and the UE has at least one ISMP rule from HPLMN;\nB)\tthe UE is roaming in a VPLMN contained in the visited PLMNs with preferred rules and the UE has at least one ISMP rule from VPLMN; or\nC)\tthe UE is roaming in a VPLMN not contained in the visited PLMNs with preferred rules and the UE has at least one ISMP rule from HPLMN; or\n2)\tthe UE is capable to simultaneously route IP traffic to both 3GPP access and WLAN; and:\nA)\tthe UE is not roaming and the UE has an valid ISRP rule from HPLMN;\nB)\tthe UE is roaming in a VPLMN contained in the visited PLMNs with preferred rules and the UE has a valid ISRP rule from VPLMN; or\nC)\tthe UE is roaming in a VPLMN not contained in the visited PLMNs with preferred rules and the UE has a valid ISRP rule from HPLMN.\nThe RAN rules control the WLAN access selection and traffic routing if:\na)\tthe UE has RAN rules but no ANDSF rules; or\nb)\tthe UE has both ANDSF rules and RAN rules; and:\n1)\tthe UE is not capable to simultaneously route IP traffic to both 3GPP access and WLAN; and:\nA)\tthe UE is not roaming and the UE has no ISMP rules from HPLMN;\nB)\tthe UE is roaming in a VPLMN contained in the visited PLMNs with preferred rules and the UE has no ISMP rules from VPLMN; or\nC)\tthe UE is roaming in a VPLMN not contained in the visited PLMNs with preferred rules and the UE has no ISMP rules from HPLMN; or\n2)\tthe UE is capable to simultaneously route IP traffic to both 3GPP access and WLAN, and:\nA)\tthe UE is not roaming and the UE has no valid ISRP rule from HPLMN;\nB)\tthe UE is roaming in a VPLMN contained in the visited PLMNs with preferred rules and the UE has no valid ISRP rule from VPLMN; or\nC)\tthe UE is roaming in a VPLMN not contained in the visited PLMNs with preferred rules and the UE has no valid ISRP rule from HPLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.3\tAdditional procedures when WLAN access selection and traffic routing is controlled by ANDSF rules",
                            "text_content": "If the ANDSF rules control the WLAN access selection and traffic routing as described in clause 6.10.2, the access stratum layer of the 3GPP access provides the received RAN assistance parameters to this layer and the UE shall store the RAN assistance parameters and then use the RAN assistance information together with ANDSF rules specified in 3GPP TS 24.312 [13] and measurements results to make traffic routing decisions to move traffic to WLAN or to E-UTRAN or UTRAN by:\n-\tcomparing the received RAN assistance thresholds with corresponding measurement results; and\n-\tcomparing the received OPI value with the provisioned OPI value provided by the ANDSF.\nThe following thresholds can be used for traffic routing from E-UTRAN or UTRAN to WLAN:\n-\tThreshServingOffloadWLANLowP;\n-\tThreshServingOffloadWLANLowQ;\n-\tThreshChUtilWLANLow;\n-\tThreshBackhRateDLWLANHigh;\n-\tThreshBackhRateULWLANHigh; and\n-\tThreshBeaconRSSIWLANHigh.\nThe following thresholds can be used for traffic routing from WLAN to E-UTRAN or UTRAN:\n-\tThreshServingOffloadWLANHighP;\n-\tThreshServingOffloadWLANHighQ;\n-\tThreshChUtilWLANHigh;\n-\tThreshBackhRateDLWLANLow;\n-\tThreshBackhRateULWLANLow; and\n-\tThreshBeaconRSSIWLANLow.\nOffload Preference Indication (OPI) parameter can be used for traffic routing in both directions, from E-UTRAN or UTRAN to WLAN or from WLAN to E-UTRAN or UTRAN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.4\tAdditional procedures when WLAN access selection and traffic routing is controlled by RAN rules",
                            "text_content": "This clause applies if the RAN rules control the WLAN access selection and traffic routing as described in clause 6.10.2.\nThe access stratum layer of the 3GPP access can provide:\n1)\tmove-traffic-to-WLAN indication, along with list of WLAN identifiers. An entry in the list of the WLAN identifiers consists of SSID, BSSID, HESSID, or any combination of them; and\n2)\tmove-traffic-from-WLAN indication.\nThe user preferences take precedence over the indications provided by the access stratum layer of the 3GPP access.\nNOTE 1:\tHandling of the move-traffic-from-WLAN indication and the move-traffic-to-WLAN indication for a multi-access PDN connection where the network-initiated NBIFOM mode is the selected NBIFOM mode, is specified in 3GPP TS 24.161 [69].\nUpon:\n-\treceiving move-traffic-to-WLAN indication, along with the list of the WLAN identifiers, if the user preferences are not present; or\n-\testablishment of a new PDN connection in 3GPP access, if the PDN connection is an offloadable PDN connection, the access stratum indicated move-traffic-to-WLAN, the access stratum has not indicated the move-traffic-from-WLAN indication after indicating of the move-traffic-to-WLAN indication and the user preferences are not present;\nand:\n-\tthe UE is capable to simultaneously route IP traffic to both 3GPP access and WLAN and has at least one PDN connection which is not a multi-access PDN connection or where the UE-initiated NBIFOM mode is the selected NBIFOM mode as specified in 3GPP TS 24.161 [69]; or\n-\tthe UE is not capable to simultaneously route IP traffic to both 3GPP access and WLAN, and all the PDN connections of the UE in 3GPP access are offloadable PDN connections;\nthe UE:\na)\tshall perform the procedure in clause 5.1.3.2.3 and in clause 5.2.3.2 to select the selected WLAN and the NAI for authentication;\nb)\tif not authenticated yet with the selected WLAN using the NAI for authentication in clause 6.4, shall authenticate with the selected WLAN using the NAI for authentication in clause 6.4. During authentication, if the selected WLAN is a trusted WLAN, SCM is supported by both UE and network, MCM is not supported by UE, network or both, and if:\n-\tthe UE is capable to simultaneously route IP traffic to both 3GPP access and WLAN and has at least one PDN connection which is not a multi-access PDN connection or where the UE-initiated NBIFOM mode is the selected NBIFOM mode as specified in 3GPP TS 24.161 [69]; or\n-\tthe UE is not capable to simultaneously route IP traffic to both 3GPP access and WLAN, and the UE has only one PDN connection;\nshall handover one PDN connection:\n-\twhich is an offloadable PDN connection; and\n-\twhich is not a multi-access PDN connection or where the UE-initiated NBIFOM mode is the selected NBIFOM mode as specified in 3GPP TS 24.161 [69];\nfrom 3GPP access to the WLAN access using procedures in clause 6.4.2.6.2;\nNOTE 2:\tWhen the UE already has one PDN connection established via WLAN in SCM, and if move-traffic-to-WLAN indication is received, it is up to the UE implementation to determine whether to offload a PDN connection from 3GPP access to WLAN. In that case, it is also up to the UE implementation to determine which one of the offloadable PDN connections will be offloaded.\nc)\tif the selected WLAN is a trusted WLAN, and MCM is supported by both UE and network, shall handover all the PDN connections:\n-\twhich are offloadable PDN connections; and\n-\twhich are not a multi-access PDN connection or where the UE-initiated NBIFOM mode is the selected NBIFOM mode as specified in 3GPP TS 24.161 [69];\nfrom 3GPP access to the WLAN access using procedures of 3GPP TS 24.244 [56];\nd)\tif the selected WLAN is an untrusted WLAN, and if the UE supports access to EPC via untrusted WLAN, shall handover all the PDN connections:\n-\twhich are offloadable PDN connections; and\n-\twhich are not a multi-access PDN connection or where the UE-initiated NBIFOM mode is the selected NBIFOM mode as specified in 3GPP TS 24.161 [69];\nfrom 3GPP access to the WLAN access using procedures in clause 7.2.1 and clause 7.2.2; and\ne)\tif the UE has a valid IARP rule for APN, shall use the IARP for APN using the procedures in clause 6.8.2.2.4.5.\nUpon receiving move-traffic-from-WLAN indication, and if the user preferences are not present, the UE shall handover all the PDN connections:\n-\testablished in (or previously handed over to) WLAN access; and\n-\twhich are not a multi-access PDN connection or where the UE-initiated NBIFOM mode is the selected NBIFOM mode as specified in 3GPP TS 24.161 [69];\nfrom WLAN access to the 3GPP access using procedures in 3GPP TS 24.301 [10].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tTunnel management procedures",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The purpose of tunnel management procedures is to define the procedures for establishment or disconnection of an end-to-end tunnel between the UE and the ePDG. The tunnel establishment procedure is always initiated by the UE, whereas the tunnel disconnection procedure can be initiated by the UE or the ePDG.\nThe tunnel is an IPsec tunnel (see IETF RFC 4301 [30]) established via an IKEv2 protocol exchange IETF RFC 7296 [28] between the UE and the ePDG. The UE may indicate support for IETF RFC 4555 [31]. The security mechanisms for tunnel setup using IPsec and IKEv2 are specified in 3GPP TS 33.402 [15].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tUE procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.2.1\tSelection of the ePDG",
                            "text_content": "If the UE does not supports ePDG selection according to 3GPP TS 24.502 [77], the UE performs ePDG selection based on the ePDG configuration information configured by the home operator in the UE either via H-ANDSF or via USIM or via implementation specific means. Implementation specific means apply only if the configurations via H-ANDSF and USIM are not present. The ePDG configuration information may consist of home ePDG identifier or ePDG selection information or both:\n-\twhen available in ANDSF MO, the ePDG configuration information is provisioned in ePDG node under Home Network Preference as specified in 3GPP TS 24.312 [13]; and\n-\twhen available in USIM, the ePDG configuration information is provisioned in EFePDGId and EFePDGSelection files as specified in 3GPP TS 31.102 [45].\nThe ePDG configuration information provided by ANDSF may also be pre-configured by the home operator on the ME or provisioned on the UICC. The UE shall use the information in the following order of precedence:\n1)\tePDG configuration information provided by the ANSDF server to the ME;\n2)\tePDG configuration information configured on the UICC;\n3)\tePDG configuration information pre-configured on the ME.\nThe UE shall support the implementation of standard DNS mechanisms in order to retrieve the IP address(es) of the ePDG. The input to the DNS query is an ePDG FQDN as specified in clause 4.4.3 and in 3GPP TS 23.003 [3].\nIf the UE supports ePDG selection according to 3GPP TS 24.502 [77], then the UE selects the ePDG according to 3GPP TS 24.502 [77].\nIf the UE cannot determine whether it is located in the home country or in a visited country, as required by the ePDG selection procedure specified in 3GPP TS 23.402 [6], the UE shall stop the ePDG selection.\nNOTE:\tIt is out of scope of the present specification to define how the UE determines whether it is located in the home country or in a visited country or in a location that does not belong to any country. When the UE is in coverage of a 3GPP RAT, it can, for example, use the information derived from the available PLMN(s). In this case, the UE can match the MCC of the PLMN to which a cell belongs, broadcast on the BCCH of the 3GPP access, against the UE's IMSI to determine if they belong to the same country, as defined in 3GPP TS 23.122 [4]. If the UE is not in coverage of a 3GPP RAT, the UE can use other techniques, including user-provided location.\nThe UE shall proceed as follows:\n1)\tif the UE is located in its home country and\na)\tif the ePDG selection information is provisioned in the ePDG configuration information and if an entry for the HPLMN is available in the ePDG selection information, the UE shall construct an ePDG FQDN based on configured FQDN format of HPLMN as described in 3GPP TS 23.402 [6] and encoding in 3GPP TS 23.003 [3]:\nb)\tif the ePDG selection information is not provisioned in the ePDG configuration information or if the ePDG selection information is provisioned and an entry for the HPLMN is not available in the ePDG selection information, the UE shall:\ni)\tif Home ePDG identifier is provisioned in the ePDG configuration information, use the configured IP address to select the ePDG, or if configured IP address is not available, construct an ePDG FQDN using the configured FQDN; and\nii)\tif the Home ePDG identifier is not provisioned in the ePDG configuration information, construct an ePDG FQDN based on the Operator Identifier FQDN format using the PLMN ID of the HPLMN as described in 3GPP TS 23.003 [3];\nc)\tif the ePDG configuration information is not configured on the UE, or the ePDG configuration information is configured but empty, the UE shall construct the ePDG FQDN based on the Operator Identifier FQDN format using the PLMN ID of the HPLMN stored on the USIM; and\nd)\tIf the ePDG selection is for establishing emergency bearer services and the UE is not equipped with a UICC, the UE may construct the Operator Identifier FQDN format based on a PLMN ID obtained via implementation specific means,\nand for the cases a) through d), the UE shall use the DNS server function to resolve the contructed ePDG FQDN to the IP address(es) of the ePDG(s). The UE shall select an IP address of an ePDG with the same IP version as its local IP address;\n2)\tif the UE is not located in its home country and\na)\tif the ePDG selection information is provisioned in the ePDG configuration information and if the UE is attached to a VPLMN via 3GPP access:\ni)\tif an entry for the VPLMN is available in the ePDG selection information, the UE shall construct an ePDG FQDN based on configured FQDN format of the VPLMN as described in 3GPP TS 23.402 [6] and encoding in 3GPP TS 23.003 [3];\nii)\tif an entry for the VPLMN is not available in the ePDG selection information, and an 'Any_PLMN' entry is available in the ePDG selection information, the UE shall construct an ePDG FQDN based on the configured FQDN format of the 'Any_PLMN' entry as described in 3GPP TS 23.402 [6] and encoding in 3GPP TS 23.003 [3],\nand for case i) and ii), the UE shall use the DNS server function to resolve the contructed ePDG FQDN to the IP address(es) of the ePDG(s). The UE shall select an IP address of an ePDG with the same IP version as its local IP address; and\nb)\tif one of the following is true:\n-\tthe UE is not attached to a PLMN via 3GPP access and the UE uses WLAN;\n-\tthe ePDG configuration information is not configured;\n-\tthe ePDG selection information is not provisioned in the ePDG configuration information; or\n-\tthe UE is attached to a VPLMN via 3GPP access and an entry for the VPLMN is not available in the ePDG selection information and an 'Any_PLMN' entry is not available in the ePDG selection information,\nthe UE shall perform a DNS query (see 3GPP TS 23.003 [3]) as specified in clause 7.2.1.4 to determine if the visited country mandates the selection of ePDG in this country:\ni)\tif selection of ePDG in visited country is mandatory:\n-\tif the UE is attached to a VPLMN via 3GPP access and the PLMN ID of VPLMN is included in one of the returned DNS records, the UE shall select an ePDG in this VPLMN by constructing an ePDG FQDN based on the Operator Identifier FQDN format using the PLMN ID of the VPLMN as described in 3GPP TS 23.003 [3]; and\n-\tif the UE is not attached to a PLMN via 3GPP access or the UE is attached to a VPLMN via 3GPP access and the PLMN ID of VPLMN is not included in any of the DNS records:\n-\tif the ePDG selection information is provisioned, the UE shall select an ePDG from a PLMN included in the DNS response that has highest PLMN priority (see 3GPP TS 24.312 [13]) in the ePDG selection information and construct an ePDG FQDN based on the configured FQDN format of the PLMN entry as described in 3GPP TS 23.402 [6] and encoding in 3GPP TS 23.003 [3]; and\n-\tif the ePDG selection information is not provisioned or the ePDG selection information does not contain any of the PLMNs in the DNS response, selection of the PLMN is UE implementation specific. The UE shall select an ePDG from a PLMN included in the DNS response and construct an ePDG FQDN based on the Operator Identifier FQDN format using the PLMN ID of the PLMN as described in 3GPP TS 23.003 [3],\nand for the above cases, the UE shall use the DNS server function to resolve the contructed ePDG FQDN to the IP address(es) of the ePDG(s). The UE shall select an IP address of an ePDG with the same IP version as its local IP address;\nii)\tif the DNS response contains no records, selection of ePDG in visited country is not mandatory:\n-\tif the ePDG selection information is provisioned and contains one or more PLMNs in the visited country, the UE shall select an ePDG from a PLMNs that has highest PLMN priority (see 3GPP TS 24.312 [13]) in the ePDG selection information;\n-\tif the ePDG selection information is not provisioned or if the ePDG selection information is provisioned and contains no PLMNs in the visited country, the UE shall select an ePDG in the HPLMN as follows:\n-\tif the Home ePDG identifier is provisioned in the ePDG configuration information (see 3GPP TS 24.312 [13]), the UE shall use the configured IP address to select the ePDG, or if configured IP address is not available, use the configured FQDN and run DNS query to obtain the IP address(es) of the ePDG(s); and\n-\tif the Home ePDG identifier is not provisioned in the ePDG configuration information, the UE shall construct an ePDG FQDN based on the Operator Identifier FQDN format using the PLMN ID of the HPLMN as described in 3GPP TS 23.003 [3], and\n-\tif the ePDG selection is for establishing emergency bearer services and the UE is not equipped with a UICC, the UE may construct the Operator Identifier FQDN format based on a PLMN ID obtained via implementation specific means.\nand for the above cases, the UE shall use the DNS server function to resolve the contructed ePDG FQDN to the IP address(es) of the ePDG(s). The UE shall select an IP address of an ePDG with the same IP version as its local IP address; and\niii)\tif no DNS response is received, the UE shall terminate the ePDG selection procedure.\nIf selecting an ePDG in the HPLMN fails, and the selection of ePDG in the HPLMN is performed using Home ePDG identifier configuration and there are more pre-configured ePDGs in the HPLMN, the UE shall repeat the tunnel establishment attempt using the next FQDN or IP address(es) of the ePDG in the HPLMN.\nUpon reception of a DNS response containing one or more IP addresses of ePDGs, the UE shall select an IP address of ePDG with the same IP version as its local IP address. If the UE does not receive a response to an IKE_SA_INIT request message sent towards to any of the received IP addresses of the selected ePDG, then the UE shall repeat the ePDG selection as described in this clause, excluding the ePDG for which the UE did not receive a response to the IKE_SA_INIT request message.\nNOTE 1:\tThe time the UE waits before reattempting access to another ePDG or to an ePDG that it previously did not receive a response to an IKE_SA_INIT request message, is implementation specific.\nThe UE shall select only one ePDG also in case of multiple PDN connections.\nIn order to determine if the visited country mandates the selection of ePDG in this country (see 3GPP TS 23.402 [6]), the UE shall perform the DNS NAPTR query using Visited Country FQDN as specified in 3GPP TS 23.003 [3].\nIf the result of this query is:\n-\ta set of one or more records containing the service instance names of the form \"epdg.epc.mnc<MNC>.mcc<MCC>.pub.3gppnetwork.org\", the UE shall determine thst the visited country mandates the selection of the ePDG in this country; and\nNOTE:\tThe (<MCC>, <MNC>) pair in each record represents PLMN Id (see 3GPP TS 23.003 [3]) in the visited country which can be used for ePDG selection in clause 7.2.1.3.\n-\tno records containing the service instance names of the form \"epdg.epc.mnc<MNC>.mcc<MCC>.pub.3gppnetwork.org\", the UE shall determine that the visited country does not mandate the selection of the ePDG in this country.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.1A\tSelection of the ePDG for emergency bearer services",
                            "text_content": "The UE performs ePDG selection for emergency bearer services based on the ePDG configuration information provided by the home operator in the UE via H-ANDSF or via USIM, or via implementation specific means.\nThe ePDG configuration information used for selecting the ePDG for emergency bearer services includes:\n-\twhen available in ANDSF MO, Emergency_ePDG_Identifier and ePDG selection information are provisioned in ePDG node under Home Network Preference as specified in 3GPP TS 24.312 [13]; and\n-\twhen available in the USIM, the Emergency ePDG Identifier and ePDG selection information are provisioned in EFePDGIdEm and EFePDGSelection files as specified in 3GPP TS 31.102 [45].\nNOTE:\tImplementation specific means apply only if the configurations via H-ANDSF and USIM are not present.\nWhen performing ePDG selection for establishing emergency bearer services, the UE shall proceed by following the general ePDG selection procedure specified in clause 7.2.1 except:\n-\tEmergency_ePDG_Identifier shall be used instead of Home ePDG identifier;\n-\tAll ePDG FQDNs and visited country FQDNs for DNS query shall be constructed based on the ePDG FQDN format defined for emergency services as defined in 3GPP TS 23.003 [3]; and\n-\tIf the ME is not equipped with a UICC, the UE shall consider the ePDG configuration information as not available.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.2\tTunnel establishment",
                            "text_content": "Once the ePDG has been selected, the UE shall initiate the IPsec tunnel establishment procedure using the IKEv2 protocol as defined in IETF RFC 7296 [28] and 3GPP TS 33.402 [15].\nThe UE shall send an IKE_SA_INIT request message to the selected ePDG in order to setup an IKEv2 security association. Upon receipt of an IKE_SA_INIT response, the UE shall send an IKE_AUTH request message to the ePDG, including:\n-\tThe type of IP address (IPv4 address or IPv6 prefix or both) that needs to be configured in an IKEv2 CFG_REQUEST Configuration Payload. If the UE requests for both IPv4 address and IPv6 prefix, the UE shall send two configuration attributes in the CFG_REQUEST Configuration Payload: one for the IPv4 address and the other for the IPv6 prefix;\n-\tThe \"IDr\" payload, containing the APN in the Identification Data, for non-emergency session establishment. For emergency session establishment, the UE shall format the \"IDr\" payload according to clause 7.2.5. The UE shall set the ID Type field of the \"IDr\" payload to ID_FQDN as defined in IETF RFC 7296 [28]. The UE indicates a request for the default APN by omitting the \"IDr\" payload, which is in accordance with IKEv2 protocol as defined in IETF RFC 7296 [28]; and\n-\tThe \"IDi\" payload containing the NAI.\nThe IKE_AUTH request message may also contain:\n-\tAn indication in a notify payload that MOBIKE is supported by the UE;\n-\tThe INTERNAL_IP6_DNS or the INTERNAL_IP4_DNS attribute in the CFG_REQUEST Configuration Payload. The UE can obtain zero or more DNS server addressed in the CFG_REPLY payload within the IKE_AUTH response message as specified in IETF RFC 7296 [28]; or\n-\tThe P_CSCF_IP6_ADDRESS attribute, the P_CSCF_IP4_ADDRESS attribute or both in the CFG_REQUEST Configuration Payload. The UE can obtain zero or more P-CSCF server addresses in the CFG_REPLY Configuration Payload within the IKE_AUTH response message as specified in IETF RFC 7651 [64].\nIf the UE's USIM indicates that the UE is a UE configured for high priority access in the selected PLMN as specified in 3GPP TS 31.102 [35], the UE shall send the HPA_INFO Notify payload, as defined in clause 8.1.2.3, within the IKE_AUTH request message, with the MPS_PRI bit and AC_PRI bit set as defined in clause 8.2.9.22.\nThe UE may support the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute as specified in clause 8.2.4.2. If the UE supports the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute, the UE shall include the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute indicating support of receiving timeout period for liveness check in the CFG_REQUEST configuration payload within the IKE_AUTH request message. If the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute as specified in clause 8.2.4.2 indicating the timeout period for the liveness check is included in the CFG_REPLY configuration payload within the IKE_AUTH response message or if the UE has a pre-configured timeout period, the UE shall perform the tunnel liveness checks as described in clause 7.2.2A.\nNOTE 1:\tThe timeout period for liveness check is pre-configured in the UE in implementation-specific way.\nIf the UE supports N1 mode and N1 mode capability is enabled, the UE shall indicate the PDU session ID in the IKE_AUTH request message during the IKEv2 authentication and tunnel establishment for initial attach.\nIf the UE supports N1 mode and N1 mode capability is disabled, the UE may indicate the PDU session ID in the IKE_AUTH request message during the IKEv2 authentication and tunnel establishment for initial attach.\nIf the UE supports N1 mode, regardless whether the N1 mode capability is enabled or disabled, the UE shall indicate the PDU session ID in the IKE_AUTH request message during the IKEv2 authentication and tunnel establishment for handover of an existing PDN connection from EPS which the PDU session ID is associated with, or for transferring of an existing PDU session from 5GS.\nIf the UE supports N1 mode, regardless whether the N1 mode capability is enabled or disabled, the UE shall not indicate the PDU session ID in the IKE_AUTH request message during the IKEv2 authentication and tunnel establishment for handover of a PDN connection which no PDU session ID is associated with.\nIn order to indicate the PDU session ID in the IKE_AUTH request message, the UE shall include the N1_MODE_CAPABILITY Notify payload as defined in clause 8.2.9.15 in the IKE_AUTH request message and shall:\n-\tif the UE is establishing a PDN connection not related to any existing PDU session or any existing PDN connection, allocate a PDU session ID which is not currently being used by another PDU session over either 3GPP access or non-3GPP access, set the PDU Session ID field of the N1_MODE_CAPABILITY Notify payload to the allocated PDU session ID, and associate the allocated PDU session ID with the PDN connection that is being established;\nif the UE is transferring an existing PDU session from 5GS, set the PDU Session ID field of the N1_MODE_CAPABILITY Notify payload to the PDU session ID of the existing PDU session that is being transferred, and associate the PDU session ID with the PDN connection that is being established. If the existing PDU session is a non-emergency PDU session, the UE shall in addition associate the S-NSSAI of the existing PDU session that is being transferred and the related PLMN ID with the PDN connection that is being established; or\n-\tif the UE is transferring an existing PDN connection from EPS and a PDU session ID is associated with the PDN connection that is being transferred, set the PDU Session ID field of the N1_MODE_CAPABILITY Notify payload to the PDU session ID associated with the existing PDN connection. If the existing PDN connection is a non-emergency PDN connection and an S-NSSAI and a related PLMN ID are associated with the existing PDN connection, the UE shall in addition associate the S-NSSAI and the related PLMN ID with the PDN connection that is being established.\nDuring the IKEv2 authentication and security association establishment, if the UE supports explicit indication about the supported mobility protocols, it shall provide the indication as described in clause 6.3.\nDuring the IKEv2 authentication and tunnel establishment for initial attach, the UE shall provide an indication about Attach Type, which indicates Initial Attach. To indicate attach due to initial attach, the UE shall include either the INTERNAL_IP4_ADDRESS or the INTERNAL_IP6_ADDRESS attribute or both in the CFG_REQUEST Configuration Payload within the IKE_AUTH request message. The INTERNAL_IP4_ADDRESS shall contain no value and the length field shall be set to 0. The INTERNAL_IP6_ADDRESS shall contain no value and the length field shall be set to 0.\nDuring the IKEv2 authentication and tunnel establishment for handover, the UE not supporting IP address preservation for NBM shall indicate Initial Attach as described in the previous paragraph.\nNOTE 2:\tThe UE cannot handover PDN connection with PDN type \"Ethernet\" or \"non-IP\" from E-UTRAN to an ePDG because PDN connections with PDN type \"Ethernet\" or PDN type \"non-IP\" are not supported over ePDG.\nDuring the IKEv2 authentication and security association establishment for handover, the UE supporting IP address preservation for NBM, shall provide an indication about Attach Type, which indicates Handover Attach. During the IKEv2 authentication and security association establishment for transfer of an existing PDU session from 5GS, the UE shall provide an indication about Attach Type, which indicates Handover Attach. To indicate attach due to handover, the UE shall include the previously allocated home address information during the IPSec tunnel establishment. Depending on the IP version, the UE shall include either the INTERNAL_IP4_ADDRESS or the INTERNAL_IP6_ADDRESS attribute or both in the CFG_REQUEST Configuration Payload within the IKE_AUTH request message to indicate the home address information which is in accordance with IKEv2 protocol as defined in IETF RFC 7296 [28]. If the previously allocated home address information consists of both an IPv4 address and an IPv6 prefix, then the UE shall include the INTERNAL_IP4_ADDRESS attribute and the INTERNAL_IP6_ADDRESS attribute in the CFG_REQUEST configuration payload within the IKE_AUTH request message. If the previously allocated home address information consists of an IPv4 address only, then the UE shall include the INTERNAL_IP4_ADDRESS attribute and shall not include the INTERNAL_IP6_ADDRESS attribute in the CFG_REQUEST configuration payload within the IKE_AUTH request message. If the previously allocated home address information consists of an IPv6 prefix only, then the UE shall include the INTERNAL_IP6_ADDRESS attribute and shall not include the INTERNAL_IP4_ADDRESS attribute in the CFG_REQUEST configuration payload within the IKE_AUTH request message. The UE shall support IPSec ESP (see IETF RFC 4303 [32]) in order to provide secure tunnels between the UE and the ePDG as specified in 3GPP TS 33.402 [15].\nThe UE may support multiple authentication exchanges in the IKEv2 protocol as specified in IETF RFC 4739 [49] in order to support authentication and authorization with an external AAA server allowing the UE to support PAP authentication procedure, or CHAP authentication procedure, or both, as described in 3GPP TS 33.402 [15].\nIf NBM is used and the UE wishes to access an external PDN and therefore needs to perform authentication and authorization with an external AAA server, the UE shall:\n-\tIf the IKE_SA_INIT response contains a \"MULTIPLE_AUTH_SUPPORTED\" Notify payload, then include a \"MULTIPLE_AUTH_SUPPORTED\" Notify payload in the IKE_AUTH request as described in IETF RFC 4739 [49] and perform the additional authentication steps as specified in 3GPP TS 33.402 [15]; and\n-\tIf the IKE_SA_INIT response does not contain a \"MULTIPLE_AUTH_SUPPORTED\" Notify payload, then perform the UE initiated disconnection as defined in clause 7.2.4.1. The subsequent UE action is implementation dependent (e.g. select a new ePDG).\nAfter the successful authentication with the 3GPP AAA server, the UE receives from the ePDG an IKE_AUTH response message containing a single CFG_REPLY Configuration Payload including the assigned remote IP address information (IPv4 address or IPv6 prefix) as described in clause 7.4.1. Depending on the used IP mobility management mechanism the following cases can be differentiated:\n-\tIf DSMIPv6 is used for IP mobility management, the UE configures a remote IP address based on the IP address information contained in the INTERNAL_IP4_ADDRESS or INTERNAL_IP6_SUBNET attribute of the CFG_REPLY Configuration Payload. The UE uses the remote IP address as Care-of-Address to contact the HA.\n-\tIf NBM is used for IP mobility management and the UE performs an initial attach, the UE configures a home address based on the address information from the CFG_REPLY Configuration Payload. Otherwise, if NBM is used and the UE performs a handover attach, the UE continues to use its IP address configured before the handover, if the address information provided in the CFG_REPLY Configuration Payload does match with the UE's IP address configured before the handover. If the UE's IP address (IPv4 address or IPv6 prefix) does not match with the address information of the CFG_REPLY Configuration Payload, the UE shall configure a new home address based on the IP address information contained in the INTERNAL_IP4_ADDRESS, INTERNAL_IP6_SUBNET or INTERNAL_IP6_ADDRESS attribute of the CFG_REPLY Configuration Payload. In the latter case, the IP address preservation is not possible.\nNOTE 3:\tIn case of IPv6 address, the UE performs the match only on the IPv6 prefix provided within the CFG_REPLY Configuration Payload contained in the INTERNAL_IP6_SUBNET or INTERNAL_IP6_ADDRESS.\nIf the UE receives a PDN_TYPE_IPv4_ONLY_ALLOWED Notify payload or a PDN_TYPE_IPv6_ONLY_ALLOWED Notify payload, then the UE shall not subsequently initiate another UE requested PDN connectivity procedure specific to the non-3GPP access to the same APN to obtain a PDN type different from the one allowed by the network until:\n-\tthe UE is switched off;\n-\tthe UICC containing the USIM is removed; or\n-\tthe network initiated the deactivation of the PDN connectivity to the given APN.\nIf the UE supports DSMIPv6, the UE may request the HA IP address(es), by including a corresponding CFG_REQUEST Configuration Payload containing a HOME_AGENT_ADDRESS attribute within the IKE_AUTH request message. The HOME_AGENT_ADDRESS attribute content is defined in clause 8.2.4.1. The HA IP address(es) requested in this attribute are for the APN for which the IPsec tunnel with the ePDG is set-up. In the CFG_REQUEST within the IKE_AUTH request message, the UE sets respectively the IPv6 address field and the optional IPv4 address field of the HOME_AGENT_ADDRESS attribute to 0::0 and to 0.0.0.0. If the UE can not obtain the IP addresses of the HA via IKEv2 signalling, it uses the home agent address discovery as specified in 3GPP TS 24.303 [11].\nIn case the UE wants to establish multiple PDN connections and if the UE uses DSMIPv6 for mobility management, the UE shall use DNS as defined in 3GPP TS 24.303 [11] to discover the HA IP address(es) for the additional PDN connections after IKEv2 security association was established to the ePDG.\nDuring the IKEv2 authentication and security association establishment, following the UE's initial IKE_AUTH request message to the ePDG, if the UE subsequently receives an IKE_AUTH response message from the ePDG containing the EAP-Request/AKA-Challenge, after verifying the received authentication parameters and successfully authenticating the ePDG as specified in 3GPP TS 33.402 [15], the UE shall send a new IKE_AUTH request message to the ePDG including the EAP-Response/AKA-Challenge. In addition, the UE shall provide the requested mobile device identity if available, as specified in clause 7.2.6.\nIf the UE supports P-CSCF restoration extension for untrusted WLAN as specified in 3GPP TS 23.380 [66], the UE shall send its capability indication of the support of P-CSCF restoration to the ePDG by including the P-CSCF_RESELECTION_SUPPORT Notify payload within an IKE_AUTH request message. The content of the P-CSCF_RESELECTION_SUPPORT Notify payload is described in clause 8.2.9.4.\nIf:\n-\tthe UE supports N1 mode; or\n-\tN1 mode capability is disabled and the UE indicated the PDU session ID in the IKE_AUTH request message;\nand the UE receives the N1_MODE_INFORMATION Notify payload as defined in clause 8.2.9.16 in the IKE_AUTH response message, the UE shall delete the associated S-NSSAI, if any, and (re-)associate the S-NSSAI in the S-NSSAI Value field of the N1_MODE_INFORMATION Notify payload with the PDU session associated with the IKEv2 security association that was established, and if the UE receives the N1_MODE_S_NSSAI_PLMN_ID Notify payload as defined in clause 8.2.9.17 in the IKE_AUTH response message, the UE shall delete the associated PLMN ID, if any, and (re-)associate the PLMN ID that the S-NSSAI relates to in the S-NSSAI PLMN ID field of the N1_MODE_S_NSSAI_PLMN_ID Notify payload with the PDU session associated with the IKEv2 security association that was established.\nIf the UE supports DNS over (D)TLS, the UE shall include the DNS_SRV_SEC_INFO_IND Notify payload as defined in clause 8.2.9.18 in the IKE_AUTH request message and, if the UE wishes to indicate which security protocol type(s) are supported by the UE, the UE may indicate the supported DNS server security protocols in the DNS_SRV_SEC_INFO_IND Notify payload.\nIf the UE included the DNS_SRV_SEC_INFO_IND Notify payload in the IKE_AUTH request message and receives the DNS_SRV_SEC_INFO Notify payload as defined in clause 8.2.9.19 in the IKE_AUTH response message, the UE shall pass to the upper layer contents of the one or more DNS server security information fields of the DNS_SRV_SEC_INFO Notify payload.\nIf the UE receives the IKE_AUTH response message from an ePDG of the HPLMN including a Notify payload with a Private Notify Message Type NON_3GPP_ACCESS_TO_EPC_NOT_ALLOWED or USER_UNKNOWN or PLMN_NOT_ALLOWED or AUTHORIZATION_REJECTED or RAT_TYPE_NOT_ALLOWED or ILLEGAL_ME as defined in clause 8.1.2, then after the UE authenticates the network by using ePDG certificate and AUTH parameters as specified in 3GPP TS 33.402 [15], the UE shall close the related IKEv2 security association states and shall not retry the authentication procedure to an ePDG from the same PLMN until switching off or the UICC containing the USIM is removed.\nIf the above Private Notify Message Type is received from the VPLMN's ePDG and the UE authenticates the network by using ePDG certificate and AUTH parameters as specified in 3GPP TS 33.402 [15]:\n-\tIf the received Notify Message Type is NON_3GPP_ACCESS_TO_EPC_NOT_ALLOWED or USER_UNKNOWN or AUTHORIZATION_REJECTED or RAT_TYPE_NOT_ALLOWED or ILLEGAL_ME, the UE may retry the authentication procedure with an ePDG deployed by the HPLMN if allowed according to the ePDG selection procedure in clause 7.2.1 and clause 7.2.1A; or\n-\tIf the received Private Notify Message Type is PLMN_NOT_ALLOWED, the UE should retry the authentication procedure with an ePDG deployed by the HPLMN if allowed according to the ePDG selection procedure in clause 7.2.1 and clause 7.2.1A.\nIf the UE receives from the ePDG the IKE_AUTH response message, including a Notify payload with a Private Notify Message Type \"NETWORK_FAILURE\" as defined in clause 8.1.2 then after the UE authenticates the network, the UE shall close the related IKEv2 security association states and:\na)\tif the received IKE_AUTH response message from ePDG contains a Notify payload with the BACKOFF_TIMER Notify payload as defined in clause 8.2.9.1, the UE shall behave as follows:\ni)\tif the timer value indicates neither zero nor deactivated, start the Tw3 timer with the value provided and not retry the authentication procedure to the same ePDG until timer Tw3 expires or the UE is switched off or the UICC containing the USIM is removed;\nii)\tif the timer value indicates that this timer is deactivated, not retry the authentication procedure to the same ePDG until the UE is switched off or the UICC containing the USIM is removed; and\niii)\tif the timer value indicates zero, may retry the authentication procedure to an ePDG from the same PLMN; or\nb)\tif the BACKOFF_TIMER Notify payload is not included in the received IKE_AUTH response message from ePDG, the UE shall start an implementation specific backoff timer. The UE shall not re-try the authentication procedure with the same ePDG until the backoff timer expires or the UE is switched off or the UICC containing the USIM is removed.\nIf the UE receives from the ePDG an IKE_AUTH response message including a Notify Payload with a Private Notify Message Error Type \"NO_APN_SUBSCRIPTION\" as defined in clause 8.1.2 then after the UE authenticates the network, the UE shall close the related IKEv2 security association states and:\na)\tif the received IKE_AUTH response message from ePDG contains a Notify payload with the BACKOFF_TIMER Notify payload as defined in clause 8.2.9.1, the UE shall behave as follows:\ni)\tif the timer value indicates neither zero nor deactivated, start the Tw3 timer with the value provided and not retry the authentication procedure to the same PLMN for the same APN until timer Tw3 expires or the UE is switched off or the UICC containing the USIM is removed;\nii)\tif the timer value indicates that this timer is deactivated, not retry the authentication procedure to the same PLMN for the same APN until the UE is switched off or the UICC containing the USIM is removed; and\niii)\tif the timer value indicates zero, may retry the authentication procedure to an ePDG from the same PLMN for the same APN; or\nb)\tif the BACKOFF_TIMER Notify payload is not included in the received IKE_AUTH response message from ePDG, the UE shall not retry the authentication procedure with the same PLMN for the same APN the UE is switched off or the UICC containing the USIM is removed, unless the UE has an implementation specific backoff timer. In that case, the UE shall not retry until that implementation specific timer expires.\nNOTE 1:\tThe UE can perform NSWO from the current untrusted WLAN access network even though the tunnel establishment procedure to the ePDG is not accepted by the network.\nNOTE 2:\tSwitching off and USIM change conditions are implemented taking into consideration the user experience aspect.\nIf NBM is used and if the UE receives from the ePDG an IKE_AUTH response message containing a Notify payload with a Private Notify Message Type PDN_CONNECTION_REJECTION as specified in clause 8.1.2 that includes an IP address information in the Notification Data field, the UE shall not attempt to re-establish this PDN connection with the same IP address while connected to the current ePDG and the UE shall close the related IKEv2 security association states.\nIf NBM is used and if the UE receives from the ePDG an IKE_AUTH response message containing a Notify payload with a Private Notify Message Type PDN_CONNECTION_REJECTION as specified in clause 8.1.2 and no Notification Data field, then after the UE authenticates the network, the UE shall not attempt to establish additional PDN connections to this APN while connected to the current ePDG. The UE shall close the related IKEv2 security association states. Subsequently, the UE can attempt to establishment additional PDN connections to the given APN if one or more existing PDN connections to the given APN are released. While connected to the current ePDG, if this PDN connection is the first PDN connection for the given APN, the UE shall not attempt to establish PDN connection to the given APN.\nIf NBM is used and if the UE receives from the ePDG an IKE_AUTH response message containing a Notify payload with a Private Notify Message Type MAX_CONNECTION_REACHED as specified in clause 8.1.2, then after the UE authenticates the network, the UE shall not attempt to establish any additional PDN connections while connected to the current ePDG. The UE shall close the related IKEv2 security association states. Subsequently, the UE can attempt to establishment additional PDN connections via the ePDG if one or more existing PDN connections via the ePDG are released.\nIf the UE includes the DNS_SRV_SEC_INFO_IND Notify payload as defined in clause 8.2.9.18 in the IKE_AUTH request message, the ePDG may include the DNS_SRV_SEC_INFO Notify payload as defined in clause 8.2.9.19 in the IKE_AUTH response message.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.2A\tLiveness check procedure",
                            "text_content": "If the UE supports the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute as specified in clause 8.2.4.2 and the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute as specified in clause 8.2.4.2 was included in the CFG_REPLY configuration payload within the IKE_AUTH response message received in clause 7.2.2 the UE shall set the timeout period for the liveness check to the value of the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute.\nIf the UE does not support the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute as specified in clause 8.2.4.2 or the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute as specified in clause 8.2.4.2 was not included in the CFG_REPLY configuration payload within the IKE_AUTH response message received in clause 7.2.2 then:\n1)\tif the LivenessCheckPeriod node as specified in 3GPP TS 24.312 [13] is configured, the UE shall use the timeout period for the liveness check indicated by the LivenessCheckPeriod node; and\n2)\tif the LivenessCheckPeriod node as specified in 3GPP TS 24.312 [13] is not configured, the UE shall use the pre-configured value of the timeout period for liveness check.\nNOTE:\tThe timeout period is pre-configured in the UE in implementation-specific way.\nIf the UE has not received any cryptographically protected IKEv2 or IPSec message for the duration of the timeout period for liveness check, the UE shall send an INFORMATIONAL request with no payloads as per IETF RFC 7296 [28]. If an INFORMATIONAL response is not received, the UE shall deem the IKEv2 security association to have failed, and shall discard all states associated with the IKE SA and any child SAs that were negotiated using that IKE SA as specified in IETF RFC 7296 [28].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.2B\tHandling of NBIFOM",
                            "text_content": "If the IKEv2 authentication and security association establishment is triggered by procedures in 3GPP TS 24.161 [69], the UE shall include the NBIFOM_GENERIC_CONTAINER Notify payload (see clause 8.1.2.3)in the IKE_AUTH request message. The UE shall set the NBIFOM container contents field of the NBIFOM_GENERIC_CONTAINER Notify payload as specified in 3GPP TS 24.161 [69].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.2C\tRekeying procedure",
                            "text_content": "The UE may support rekeying as defined in IETF RFC 7296 [28].\nTo trigger rekeying, the UE shall use the rekeying time parameter (see IETF RFC 7296 [28]) if it is configured by the RekeyingTime node as specified in 3GPP TS 24.312 [13], If the rekeying time parameter is not configured, the UE shall use an implementation-specific rekeying time (e.g. 18 hours).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.2D\tNAT keep alive procedure",
                            "text_content": "The UE may support NAT keep alive handling as defined in IETF RFC 7296 [28] and IETF RFC 3948 [72].\nTo control the NAT-keepalive packet sending, the UE shall use the parameter M (see IETF RFC 3948 [72]]) if it is configured by the NATKeepAliveTime node as specified in 3GPP TS 24.312 [13], If the parameter M is not configured, the UE shall use an implementation-specific time.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.3\tTunnel modification",
                            "text_content": "This procedure is used if MOBIKE as defined in IETF RFC 4555 [31] is supported by the UE.\nWhen there is a change of local IP address for the UE, the UE shall update the IKE security association with the new address, and shall update the IPsec security association associated with this IKE security association with the new address. The UE shall then send an INFORMATIONAL request containing the UPDATE_SA_ADDRESSES notification to the ePDG.\nIf, further to this update, the UE receives an INFORMATIONAL request with a COOKIE2 notification present, the UE shall copy the notification to the COOKIE2 notification of an INFORMATIONAL response and send it to the ePDG.\nThis procedure is also used during the UE-initiated IP flow mobility procedure (see clause 6.3.3.3 of 3GPP TS 23.161 [68]) or the NBIFOM IP flow mapping procedure (see clause 6.4.3 of 3GPP TS 23.161 [68]).\nIf the UE-initiated modification is triggered by procedures in 3GPP TS 24.161 [69], the UE shall include the NBIFOM_GENERIC_CONTAINER Notify payload (see clause 8.1.2.3) in the INFORMATIONAL request to the ePDG. The UE shall set the NBIFOM container contents field of the NBIFOM_GENERIC_CONTAINER Notify payload as specified in 3GPP TS 24.161 [69].\nThis procedure is used if P-CSCF restoration extension for untrusted WLAN is supported as specified in 3GPP TS 23.380 [66].\nIf the UE receives the P_CSCF_IP6_ADDRESS attribute, the P_CSCF_IP4_ADDRESS attribute or both as specified in IETF RFC 7651 [64] in the CFG_REQUEST configuration payload within the INFORMATIONAL request from the ePDG and the UE supports P-CSCF restoration extension for untrusted WLAN as specified in 3GPP TS 23.380 [66], the UE shall reply with an INFORMATIONAL response and proceed as specified in clause 5.6.5.2 of 3GPP TS 23.380 [66]. The INFORMATIONAL response shall include the received P_CSCF_IP6_ADDRESS attribute or the P_CSCF_IP4_ADDRESS attribute or both in the CFG_REPLY Configuration Payload. The P_CSCF_IP6_ADDRESS attribute shall contain no value and the length field shall be set to 0. The P_CSCF_IP4_ADDRESS shall contain no value and the length field shall be set to 0.\nUpon of receipt of the NBIFOM_GENERIC_CONTAINER Notify payload (see clause 8.1.2.3) in an INFORMATIONAL request, the UE shall reply with an INFORMATIONAL response and if required by procedures in 3GPP TS 24.161 [69], the UE shall include the NBIFOM_GENERIC_CONTAINER Notify payload (see clause 8.1.2.3) in the INFORMATIONAL response. The UE shall set the NBIFOM container contents field of the NBIFOM_GENERIC_CONTAINER Notify payload as specified in 3GPP TS 24.161 [69].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.4\tTunnel disconnection",
                            "text_content": "The UE shall use the procedures defined in the IKEv2 protocol (see IETF RFC 7296 [28]) to disconnect one or more IPsec tunnels to the ePDG. The UE shall close the incoming security associations associated with the tunnel and instruct the ePDG to do the same by sending the INFORMATIONAL request message including a \"DELETE\" payload. The DELETE payload shall contain either:\ni)\tProtocol ID set to \"1\" and no subsequent Security Parameters Indexes (SPIs) in the payload. This indicates closing of IKE security association, and implies the deletion of all IPsec ESP security associations that were negotiated within the IKE security association;\nii)\tif the IKEv2 multiple bearer PDN connectivity is not supported or not used in the PDN connection as determined in clause 7.2.7, Protocol ID set to \"3\" for ESP. The Security Parameters Indexes included in the payload shall correspond to the particular incoming ESP security associations at the UE for the given tunnel in question; or\niii)\tif the IKEv2 multiple bearer PDN connectivity is used in the PDN connection as determined in clause 7.2.7, the Protocol ID field of the DELETE payload is set to \"3\" for ESP and the SPI field of the DELETE payload includes UE's ESP SPIs of all bearer contexts of the PDN connection.\nOn receipt of the INFORMATIONAL request message including \"DELETE\" payload, indicating that the ePDG is attempting tunnel disconnection, the UE shall:\ni)\tClose all security associations identified within the DELETE payload (these security associations correspond to outgoing security associations from the UE perspective). If no security associations were present in the DELETE payload, and the protocol ID was set to \"1\", the UE shall close the IKE security association, and all IPsec ESP security associations that were negotiated within it towards the ePDG; and\nii)\tThe UE shall delete the incoming security associations corresponding to the outgoing security associations identified in the \"DELETE\" payload.\nThe UE shall send an INFORMATIONAL response message. If the INFORMATIONAL request message contained a list of security associations, the INFORMATIONAL response message shall contain a list of security associations deleted in step (ii) above.\nIf the UE is unable to comply with the INFORMATIONAL request message, the UE shall send INFORMATION response message with either:\ni)\tA NOTIFY payload of type \"INVALID_SPI\", for the case that it could not identify one or more of the Security Parameters Indexes in the message from the ePDG; or\nii)\tA more general NOTIFY payload type. This payload type is implementation dependent.\nIf the INFORMATIONAL request message including the DELETE payload contains the REACTIVATION_REQUESTED_CAUSE Notify payload, the UE shall re-establish the IPsec Tunnel for the corresponding PDN connection after its release. The coding of the P-CSCF_RESELECTION_SUPPORT Notify payload is described in clause 8.2.9.6.\nNOTE:\tFor an IMS PDN connection, the re-establishment of the IPSec tunnel is part of the \"Re-establishment of the IP-CAN used for SIP signalling procedure\" specified in 3GPP TS 24 229 [67] clause R.2.2.1B.\nA PDN connection over untrusted WLAN over S2b can be released locally in the UE, i.e. without any peer-to-peer signalling between the ePDG and the UE, based on the trigger received from the 3GPP access, e.g. during the P-CSCF restoration procedure for NBIFOM PDN connections (see 3GPP TS 23.380 [66]).\nUpon receiving over the 3GPP access:\n-\ta DEACTIVATE EPS BEARER CONTEXT REQUEST message with the EPS bearer context of a default EPS bearer context and ESM cause #39 \"reactivation requested\" (see 3GPP TS 24.301 [10]); or\n-\ta DETACH REQUEST message with the detach type \"re-attach required\" (see 3GPP TS 24.301 [10])\nto release the resources for a PDN connection over the 3GPP access, the UE shall:\na)\tclose the related IKEv2 security association for the IPsec tunnel associated with this PDN connection; and\nb)\tconsider that the ePDG is no longer responding (see RFC 7296 [28]) and not send any messages to the ePDG.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.5\tEmergency session establishment",
                            "text_content": "If the UE needs to establish an IMS emergency session over untrusted non-3GPP access as specified in 3GPP TS 24.229 [67], the UE shall:\n-\tif the UE is not connected to an ePDG yet, select an ePDG that supports emergency services as described in clause 7.2.1A;\n-\tif the UE is already connected to an ePDG that has indicated its capability of support emergency services as specified in clause 7.4.1.1 and the ePDG is located in the same country where the UE is currently located, reuse ePDG for emergency session; and\n-\tif the UE is already connected to an ePDG but the ePDG does not support the emergency services or ePDG is not located in the same country where the UE is currently located, first follow procedure described in clause 7.2.4.1 to disconnect existing IPsec tunnel. The UE shall then select an ePDG that supports emergency services as described in clause 7.2.1A.\nOnce the UE selects an ePDG that supports emergency services as specified in clause 7.2.1A, or if the UE is already connected to an ePDG and the ePDG is reused for emergency session, the UE shall initiate an IKEv2 tunnel establishment procedure towards this ePDG as described in clause 7.2.2. Upon receipt of an IKE_SA_INIT response, the UE shall send an IKE_AUTH request message to the ePDG according to clause 7.2.2.1 with the \"IDr\" payload containing the string \"EMERGENCY\", using capital letters only, in the Identification Data. The UE shall set the ID Type field of the \"IDr\" payload to ID_FQDN.\nNOTE:\tIn this procedure, the only scenario in which the UE is not in the same country as the ePDG it is connected to, is when the UE is not in the country of its HPLMN and the ePDG is in the country of the HPLMN.\nIn order to establish a new emergency session over an untrusted WLAN, the UE shall include:\n-\tan INTERNAL_IP4_ADDRESS attribute with the length field set to zero;\nan INTERNAL_IP6_ADDRESS attribute with the length field set to zero; or\n-\tboth of the above;\nin the CFG_REQUEST Configuration Payload within the IKE_AUTH request message.\nIn order to perform handover of an emergency session from a 3GPP access network to untrusted WLAN, the UE shall include:\n-\tthe INTERNAL_IP4_ADDRESS attribute set to the IPv4 address of the previously allocated home address information;\nthe INTERNAL_IP6_ADDRESS attribute set to the IPv6 address of the previously allocated home address information; or\n-\tboth of the above;\nin the CFG_REQUEST Configuration Payload within the IKE_AUTH request message. If the previously allocated home address information consists of both an IPv4 address and an IPv6 prefix, then the UE shall include the INTERNAL_IP4_ADDRESS attribute and the INTERNAL_IP6_ADDRESS attribute in the CFG_REQUEST configuration payload within the IKE_AUTH request message.\nIf the UE does not receive a response to an IKE_SA_INIT request message sent towards the selected ePDG, then the UE shall repeat the ePDG search as described in 3GPP TS 23.402 [6], excluding the ePDG for which the UE did not receive a response to the IKE_SA_INIT request message. The UE shall stop the establishment of emergency session if it is unable to select an ePDG for emergency bearer services.\nIf after sending an IKE_AUTH request message to the ePDG to initiate emergency session, the UE receives IKE_AUTH response message from the ePDG containing a Notify payload with a Private Notify Message Type \"UNAUTHENTICATED_EMERGENCY_NOT_SUPPORTED\", the UE shall follow the steps above to select a new ePDG for emergency session establishment by excluding the ePDGs from which the emergency session request was previously not accepted or by implementation specific means.\nIf the UE receives the Notify Message Type IMEI_NOT_ACCEPTED as defined in clause 8.1.2.2, the UE shall not retry the authentication procedure from the same PLMN until switching off, the UICC containing the USIM is replaced, or a UICC containing the USIM is inserted.\nIf the UE is already connected to an ePDG selected by the procedure in clause 7.2.1A, the UE is considered as attached for emergency bearer services. In such a case, the UE shall not initiate any addtional IKEv2 tunnel establishment procedure.\nIf the UE is connected to an ePDG selected by the procedure in clause 7.2.1, and the ePDG has indicated its capability of support emergency service to the UE as specified in clause 7.4.1.1 and is located in the same country where the UE is currently located, the UE, when it requires emergency services, shall initiate an IKEv2 tunnel establishment procedure towards the same ePDG to request for emergency session as specified in clause 7.2.2 provided that an emergency PDN connection is not already active.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.6\tMobile identity signaling",
                            "text_content": "During the IKEv2 authentication and security association establishment, if the UE:\n-\treceives IKE_AUTH response message from ePDG containing a Notify payload with the DEVICE_IDENTITY Notify Message Type and the Identity Type field of the DEVICE_IDENTITY Notify payload is set to either 'IMEI' or 'IMEISV' and the Identity Value field is empty;\n-\tsuccessfully authenticates the network or requests emergency session; and\n-\thas Mobile Equipment Identity IMEI or IMEISV available,\nthe UE shall include the DEVICE_IDENTITY Notify payload in the new IKE_AUTH request message.\nAt any time after successful tunnel establishment, if the UE:\n-\treceives INFORMATIONAL request message from ePDG containing a Notify payload with the DEVICE_IDENTITY Notify Message Type and the Identity Type field of the DEVICE_IDENTITY Notify payload is set to either 'IMEI' or 'IMEISV' and the Identity Value field is empty; and\n-\thas the UE's Mobile Equipment Identity IMEI or IMEISV available,\nthe UE shall send INFORMATIONAL response containing a DEVICE_IDENTITY Notify payload.\nThe UE shall set the DEVICE_IDENTITY as follows:\n-\tif IMEISV is available, the UE shall include IMEISV in the DEVICE_IDENTITY Notify payload. The Identity Type field of the DEVICE_IDENTITY Notify payload shall be set to 'IMEISV': and\n-\tif IMEI is available and IMEISV is not available, the UE shall include IMEI in the DEVICE_IDENTITY attribute. The Identity Type field of the DEVICE_IDENTITY Notify payload shall be set to 'IMEI'.\nThe detailed coding of the DEVICE_IDENTITY Notify payload is described in clause 8.2.9.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.2.7\tIKEv2 multiple bearer PDN connectivity",
                            "text_content": "The UE may support the IKEv2 multiple bearer PDN connectivity.\nIf the UE supports the IKEv2 multiple bearer PDN connectivity, then the UE shall perform handling specified in the present clause. Otherwise the UE does not perform handling specified in the present clause and remaining clauses of the parent clause of the present clause.\nThe UE shall include an IKEV2_MULTIPLE_BEARER_PDN_CONNECTIVITY Notify payload as specified in clause 8.2.9.9 within an IKE_AUTH request message establishing an IKE SA of a PDN connection. If the IKE_AUTH response message contains an EPS_QOS Notify payload as specified in clause 8.2.9.10, the UE shall consider that the IKEv2 multiple bearer PDN connectivity is used in the PDN connection.\nIf the IKEv2 multiple bearer PDN connectivity is used in the PDN connection, then the UE shall perform the handling specified in remaining clauses of the parent clause of the present clause. Otherwise the UE does not perform the handling specified in remaining clauses of the parent clause of the present clause.\nThe UE shall maintain one or more bearer contexts for the PDN connection. Each bearer context consists of a UE's ESP SPI, an ePDG's ESP SPI, an EPS QoS, an extended EPS QoS, a TFT, an APN-AMBR, an extended APN-AMBR, and an indication whether the bearer context is the default bearer context. The TFT can be absent only in the default bearer context. The extended EPS QoS can be absent for any bearer context. The APN-AMBR and the extended APN-AMBR are absent for bearer contexts which are not the default bearer context. The APN-AMBR can be present or absent for the default bearer context. The extended APN-AMBR can be present for the default bearer context only if the APN-AMBR is present for the default bearer context.\nParent clause of the present clause describe control plane procedures for the IKEv2 multiple bearer PDN connectivity.\nNOTE:\tInclusion of a IKEV2_MULTIPLE_BEARER_PDN_CONNECTIVITY Notify payload in an IKE_AUTH request message is specified in clause 7.2.7.1.\nUpon receiving the IKE_AUTH response message establishing the IKE SA of the PDN connection, the UE shall add a new bearer context to the PDN connection. The new bearer context shall consist of the UE's ESP SPI created by the IKE_AUTH request/response pair, the ePDG's ESP SPI created by the IKE_AUTH request/response pair, the EPS QoS indicated in the EPS_QOS Notify payload, the extended EPS QoS indicated in the EXTENDED_EPS_QOS Notify payload (if included in the IKE_AUTH response message), the APN-AMBR indicated in the APN_AMBR Notify payload (if included in the IKE_AUTH response message), and the extended APN-AMBR indicated in the EXTENDED_APN_AMBR Notify payload (if included in the IKE_AUTH response message) of the IKE_AUTH response message, and the indication that the bearer context is the default bearer context.\nUpon receiving a CREATE_CHILD_SA request message in the IKE SA of the PDN connection, with an EPS_QOS Notify payload as specified in clause 8.2.9.10, with a TFT Notify payload as specified in clause 8.2.9.11, and without a REKEY_SA Notify payload, if the UE sends a CREATE_CHILD_SA response message without an IKEv2 notify payload indicating an error, the UE shall add a new bearer context to the PDN connection. The new bearer context shall consist of the UE's ESP SPI created by the CREATE_CHILD_SA request/response pair, the ePDG's ESP SPI created by the CREATE_CHILD_SA request/response pair, the EPS QoS indicated in the EPS_QOS Notify payload of the CREATE_CHILD_SA request message, the extended EPS QoS indicated in the EXTENDED_EPS_QOS Notify payload (if included in the CREATE_CHILD_SA request message), the TFT indicated in the TFT Notify payload of the CREATE_CHILD_SA request message, and the indication that the bearer context is not the default bearer context.\nUpon receiving a CREATE_CHILD_SA request message in the IKE SA of the PDN connection, with an EPS_QOS Notify payload as specified in clause 8.2.9.10, with a TFT Notify payload as specified in clause 8.2.9.11, and without a REKEY_SA Notify payload:\na)\tthe UE checks for semantic errors in TFT operations as follows:\n1)\tif the TFT operation in the TFT Notify payload is an operation other than \"Create a new TFT\", the UE shall send a CREATE_CHILD_SA response message with the SEMANTIC_ERROR_IN_THE_TFT_OPERATION Notify payload;\nb)\tthe UE checks for syntactical errors in TFT operations as follows:\n1)\tif the TFT operation in the TFT Notify payload is \"Create a new TFT\" and the packet filter list in the TFT Notify payload is empty, the UE shall send a CREATE_CHILD_SA response message with the SYNTACTICAL_ERROR_IN_THE_TFT_OPERATION Notify payload; and\n2)\tif there are other types of syntactical errors in the coding of the TFT Notify payload, such as a mismatch between the number of packet filters subfield, and the number of packet filters in the packet filter list, the UE shall send a CREATE_CHILD_SA response message with the SYNTACTICAL_ERROR_IN_THE_TFT_OPERATION Notify payload;\nc)\tthe UE checks for semantic errors in packet filters as follows:\n1)\tif a packet filter consists of conflicting packet filter components which would render the packet filter ineffective, i.e. no IP packet will ever fit this packet filter, the UE shall send a CREATE_CHILD_SA response message with the SEMANTIC_ERRORS_IN_PACKET_FILTERS Notify payload. How the UE determines a semantic error in a packet filter is outside the scope of the present document; and\n2)\tif the resulting TFT does not contain any packet filter which applicable for the uplink direction, the UE shall send a CREATE_CHILD_SA response message with the SEMANTIC_ERRORS_IN_PACKET_FILTERS Notify payload;\nd)\tthe UE checks syntactical errors in packet filters as follows:\n1)\tif the TFT operation in the TFT Notify payload is \"Create a new TFT\" and two or more packet filters in the resultant TFT would have identical packet filter identifiers, the UE shall send a CREATE_CHILD_SA response message with the SYNTACTICAL_ERRORS_IN_PACKET_FILTERS Notify payload;\n2)\tif the TFT operation in the TFT Notify payload is \"Create a new TFT\" and two or more packet filters in all TFTs associated with this PDN connection would have identical packet filter precedence values:\ni)\tif the old packet filters do not belong to the default bearer contex, the UE shall send a CREATE_CHILD_SA response message with the SYNTACTICAL_ERRORS_IN_PACKET_FILTERS Notify payload; and\nNOTE:\tthe UE is not expected to be able to release a particular bearer context.\nii)\tif one or more old packet filters belong to the default bearer context, the UE shall release the PDN connection as specified in clause 7.2.4.1; and\n3)\tif there are other types of syntactical errors in the coding of packet filters, such as the use of a reserved value for a packet filter component identifier, the UE shall send a CREATE_CHILD_SA response message with the SYNTACTICAL_ERRORS_IN_PACKET_FILTERS Notify payload.\nUpon receiving an INFORMATIONAL request message in the IKE SA of the PDN connection, with a DELETE payload indicating an ePDG's ESP SPI of a bearer context of the PDN connection, the UE shall send an INFORMATIONAL response message without an IKEv2 notify payload indicating an error and the UE shall remove the bearer context from the PDN connection.\nUpon receiving an INFORMATIONAL request message the IKE SA of the PDN connection, with a MODIFIED_BEARER Notify payload as specified in clause 8.2.9.12 indicating an ePDG's ESP SPI of a bearer context of the PDN connection, if the UE sends an INFORMATIONAL response message without an IKEv2 notify payload indicating an error:\na)\tif the EPS_QOS Notify payload as specified in clause 8.2.9.10 is included in the INFORMATIONAL request message:\n1)\tthe UE shall update the bearer context with the EPS QoS indicated in the EPS_QOS Notify payload; and\n2)\tif the EXTENDED_EPS_QOS Notify payload as specified in clause 8.2.9.10A is included in the INFORMATIONAL request message, the UE shall update the bearer context with the extended EPS QoS indicated in the EXTENDED_EPS_QOS Notify payload;\nb)\tif the TFT Notify payload as specified in clause 8.2.9.11 is included in the INFORMATIONAL request message, the UE shall update the bearer context with the TFT indicated in the TFT Notify payload; and\nc)\tif the bearer context is the default bearer context and the APN_AMBR Notify payload as specified in clause 8.2.9.13 is included in the INFORMATIONAL request message:\n1)\tthe UE shall update the bearer context with the APN-AMBR indicated in the APN_AMBR Notify payload; and\n2)\tif the EXTENDED_APN_AMBR Notify payload as specified in clause 8.2.9.14 is included in the INFORMATIONAL request message, the UE shall update the bearer context with the extended APN-AMBR indicated in the EXTENDED_APN_AMBR Notify payload.\nUpon receiving an INFORMATIONAL request message the IKE SA of the PDN connection, with a MODIFIED_BEARER Notify payload as specified in clause 8.2.9.12 indicating an ePDG's ESP SPI of a bearer context of the PDN connection, and with a TFT Notify payload as specified in clause 8.2.9.11:\na)\tthe UE checks for semantic errors in TFT operations as follows:\n1)\tif the TFT operation in the TFT Notify payload is \"Create a new TFT\" and there is already an existing TFT for the bearer context, the UE shall further process the new activation request and, if it was processed successfully, delete the old TFT;\n2)\tif the TFT operation in the TFT Notify payload is an operation other than \"Create a new TFT\" and there is no TFT for the bearer context, the UE shall not diagnose an error and perform the following actions to resolve the inconsistency:\ni)\tif the TFT operation is \"Delete existing TFT\" or \"Delete packet filters from existing TFT\", and if no error according to items b, c, and d was detected, consider the TFT as successfully deleted; and\nii)\tif the TFT operation is \"Add packet filters in existing TFT\" or \"Replace packet filters in existing TFT\", the UE shall process the new request as an activation request;\n3)\tif the TFT operation in the TFT Notify payload is \"Delete packet filters from existing TFT\" and it would render the TFT empty:\ni)\tif the packet filters belong to a bearer context which is not the default bearer context, the UE shall process the new deletion request and, if no error according to items b, c, and d was detected, the UE shall send an INFORMATIONAL response message with the SEMANTIC_ERROR_IN_THE_TFT_OPERATION Notify payload; and\nii)\tif the packet filters belong to a bearer context which is the default bearer context, the UE shall process the new deletion request and if no error according to items b, c, and d was detected then delete the existing TFT; and\n4)\tif the TFT operation in the TFT Notify payload is \"Delete existing TFT\" and the bearer context is not the default bearer context, the UE shall send an INFORMATIONAL response message with the SEMANTIC_ERROR_IN_THE_TFT_OPERATION Notify payload;\nb)\tthe UE checks for syntactical errors in TFT operations as follows:\n1)\tif the TFT operation in the TFT Notify payload is \"Create a new TFT\", \"Add packet filters in existing TFT\", \"Replace packet filters in existing TFT\" or \"Delete packet filters from existing TFT\" and the packet filter list in the TFT Notify payload is empty, the UE shall send an INFORMATIONAL response message with the SYNTACTICAL_ERROR_IN_THE_TFT_OPERATION Notify payload;\n2)\tif TFT operation in the TFT Notify payload is \"Delete existing TFT\" or \"No TFT operation\" with a non-empty packet filter list in the TFT Notify payload, the UE shall send an INFORMATIONAL response message with the SYNTACTICAL_ERROR_IN_THE_TFT_OPERATION Notify payload;\n3)\tif TFT operation in the TFT Notify payload is \"Replace packet filters in existing TFT\" when the packet filter to be replaced does not exist in the original TFT, the UE shall not diagnose an error, further process the replace request and, if no error according to items c and d was detected, include the packet filters received to the existing TFT;\n4)\tif TFT operation in the TFT Notify payload is \"Delete packet filters from existing TFT\" when the packet filter to be deleted does not exist in the original TFT, the UE shall not diagnose an error, further process the deletion request and, if no error according to items c and d was detected, consider the respective packet filter as successfully deleted;\n5)\tif TFT operation in the TFT Notify payload is \"Delete packet filters from existing TFT\" with a packet filter list also including packet filters in addition to the packet filter identifiers, the UE shall send an INFORMATIONAL response message with the SYNTACTICAL_ERROR_IN_THE_TFT_OPERATION Notify payload; and\n6)\tif there are other types of syntactical errors in the coding of the TFT Notify payload, such as a mismatch between the number of packet filters subfield, and the number of packet filters in the packet filter list, the UE shall send an INFORMATIONAL response message with the SYNTACTICAL_ERROR_IN_THE_TFT_OPERATION Notify payload;\nc)\tthe UE checks for semantic errors in packet filters as follows:\n1)\tif a packet filter consists of conflicting packet filter components which would render the packet filter ineffective, i.e. no IP packet will ever fit this packet filter, the UE shall send an INFORMATIONAL response message with the SEMANTIC_ERRORS_IN_PACKET_FILTERS Notify payload. How the UE determines a semantic error in a packet filter is outside the scope of the present document; and\n2)\tif the resulting TFT, which is assigned to a bearer context which is not the default bearer context, does not contain any packet filter applicable for the uplink direction among the packet filters created on request from the network, the UE shall send an INFORMATIONAL response message with the SEMANTIC_ERRORS_IN_PACKET_FILTERS Notify payload; and\nd)\tthe UE checks for syntactical errors in packet filters as follows:\n1)\tif the TFT operation in the TFT Notify payload is \"Create a new TFT\", \"Add packet filters to existing TFT\", and two or more packet filters in the resultant TFT would have identical packet filter identifiers:\ni)\tif two or more packet filters with identical packet filter identifiers are contained in the new request, the UE shall send an INFORMATIONAL response message with the SYNTACTICAL_ERRORS_IN_PACKET_FILTERS Notify payload; and\nii)\tif two or more packet filters with identical packet filter identifiers are not contained in the new request, the UE shall not diagnose an error, further process the new request and, if it was processed successfully, delete the old packet filters which have the identical packet filter identifiers;\n2)\tif the TFT operation in the TFT Notify payload is \"Create a new TFT\", \"Add packet filters to existing TFT\" or \"Replace packet filters in existing TFT\", and two or more packet filters among all TFTs associated with this PDN connection would have identical packet filter precedence values:\ni)\tif the old packet filters do not belong to the default bearer contex, the UE shall send an INFORMATIONAL response message with the SYNTACTICAL_ERRORS_IN_PACKET_FILTERS Notify payload; and\nNOTE:\tthe UE is not expected to be able to release a particular bearer context.\nii)\tif one or more old packet filters belong to the default bearer context, the UE shall release the PDN connection as specified in clause 7.2.4.1; and\n3)\tif there are other types of syntactical errors in the coding of packet filters, such as the use of a reserved value for a packet filter component identifier, the UE shall send an INFORMATIONAL response message with the SYNTACTICAL_ERRORS_IN_PACKET_FILTERS Notify payload.\nUpon receiving a CREATE_CHILD_SA request message in the IKE SA of the PDN connection, with a REKEY_SA Notify payload indicating an ePDG's ESP SPI of a bearer context of the PDN connection, if the UE sends a CREATE_CHILD_SA response message without an IKEv2 notify payload indicating an error, the UE shall set the UE's ESP SPI of the bearer context to the UE's ESP SPI created by the CREATE_CHILD_SA request/response pair and shall set the ePDG's ESP SPI of the bearer context to the ePDG's ESP SPI created by the CREATE_CHILD_SA request/response pair.\nUpon receiving a CREATE_CHILD_SA response message without an IKEv2 notify payload indicating an error, for a CREATE_CHILD_SA request message sent in the IKE SA of the PDN connection, with a REKEY_SA Notify payload indicating an UE's ESP SPI of a bearer context of the PDN connection, the UE shall set the UE's ESP SPI of the bearer context to the UE's ESP SPI created by the CREATE_CHILD_SA request/response pair and shall set the ePDG's ESP SPI of the bearer context to the ePDG's ESP SPI created by the CREATE_CHILD_SA request/response pair.\nParent clause of the present clause describe user plane procedures for the IKEv2 multiple bearer PDN connectivity.\nIf an uplink IP packet to be sent via a PDN connection:\n-\tmatches the packet filters applicable for the uplink direction of the TFT of a bearer context of the PDN connection, the UE shall forward the uplink IP packet using the ePDG's ESP SPI of the bearer context. The UE shall use the most recent DSCP value received in the same IPSec SA from the ePDG or the QCI in the EPS QoS of the bearer context to derive the DSCP value for uplink packets and set the DSCP field as specified in IETF RFC 2474 [75] of the outer IP header of the ESP packet.\n-\tdoes not match the packet filters applicable for the uplink direction of the TFT of any bearer context of the PDN connection and a bearer context without the TFT exists in the PDN connection, the UE shall forward the uplink IP packet using the ePDG's ESP SPI of the bearer context without the TFT. The UE shall set the DSCP field as specified in IETF RFC 2474 [75] of the outer IP header of the ESP packet to the DSCP value in a QoS mapping with the QCI indicated in the EPS QoS of the bearer context without the TFT.\n-\tdoes not match the packet filters applicable for the uplink direction of the TFT of any bearer context of the PDN connection and a bearer context without the TFT does not exist in the PDN connection, the UE shall discard the uplink IP packet.\nNOTE 1:\tThe UE can map QCI to DSCP value, for example, by using the mapping between standardized QCI values and Release 99 3GPP QoS parameter values specified in 3GPP TS 23.401 [4] table E.3, and the mapping between Release 99 3GPP QoS parameter values and DSCP values specified in IEEE Std 802.11 [57] table R-1.\nNOTE 2:\tThe TSi payload and the TSr payloads are not used for selection of ESP SPI for the uplink IP packet.\nNOTE 3:\tWhether the UE determines DSCP based on the DSCP value received in the same IPSec SA from the ePDG or on the QoS mapping is left to the implementation.\nNOTE 4:\tThe UE can apply a different DSCP value in the outer IP header than the DSCP value applied in the inner IP header.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.3\t3GPP AAA server procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "The UE – 3GPP AAA server procedures are as specified in 3GPP TS 29.273 [17] and 3GPP TS 33.402 [15].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.4\tePDG procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.4.1\tTunnel establishment",
                            "text_content": "Upon receipt of an IKE_AUTH request message from the UE requesting the establishment of a tunnel, the ePDG shall proceed with authentication and authorization. The basic procedure described in 3GPP TS 33.402 [15], while further details are given below.\nUpon receipt of an IKE_AUTH request message with the HPA_INFO Notify payload (see clause 8.1.2.3) indicating high priority access, based on operator policy, the ePDG should treat the UE with priority, e.g., with overload control for Diameter messages as defined in Annex C and Annex D in 3GPP TS 29.273 [17].\nNOTE 1:\tAlternatively, the ePDG can give priority to this UE after the network has successfully authenticated the UE as described in 3GPP TS 29.273 [17], at which time the ePDG handles all subsequent messages with priority.\nDuring the UE's authentication and authorization procedure, the 3GPP AAA server provides to the ePDG an indication about the selected IP mobility mechanism as specified in 3GPP TS 29.273 [17].\nThe ePDG shall proceed with IPsec tunnel setup completion and shall relay in the IKEv2 Configuration Payload (CFG_REPLY) of the final IKE_AUTH response message:\n-\tThe remote IP address information to the UE as follows:\n-\tIf NBM is used as IP mobility mechanism, the ePDG shall assign either an IPv4 address or an IPv6 Home Network Prefix or both to the UE via a single CFG_REPLY Configuration Payload. If the UE requests for both IPv4 address and IPv6 prefix, but the ePDG only assigns an IPv4 address or an IPv6 Home Network Prefix due to subscription restriction or network preference, the ePDG shall include the assigned remote IP address information (IPv4 address or IPv6 prefix) via a single CFG_REPLY Configuration Payload and should add the corresponding PDN_TYPE_IPv4_ONLY_ALLOWED Notify payload, or PDN TYPE_IPv6_ONLY_ALLOWED Notify payload. If the ePDG assigns an IPv4 address, the CFG_REPLY contains the INTERNAL_IP4_ADDRESS attribute. If the ePDG assigns an IPv6 Home Network Prefix, the CFG_REPLY contains the INTERNAL_IP6_SUBNET or INTERNAL_IP6_ADDRESS configuration attributes. The ePDG obtains the IPv4 address and/or the IPv6 Home Network Prefix from the PDN GW; or\nNOTE 2:\tIn case of IPv6 address, if CFG_REPLY Configuration Payload contains the INTERNAL_IP6_SUBNET or INTERNAL_IP6_ADDRESS, the UE considers only IPv6 Home Network Prefix defined by the prefix length value.\n-\tIf DSMIPv6 is used as IP mobility mechanism, depending on the information provided by the UE in the CFG_REQUEST payload the ePDG shall assign to the UE either a local IPv4 address or local IPv6 address (or a local IPv6 prefix) via a single CFG_REPLY Configuration Payload. If the ePDG assigns a local IPv4 address, the CFG_REPLY contains the INTERNAL_IP4_ADDRESS attribute and should add the corresponding PDN TYPE_IPv4_ONLY_ALLOWED Notify payload or PDN TYPE_IPv6_ONLY_ALLOWED Notify payload. If the ePDG assigns a local IPv6 address or a local IPv6 prefix the CFG_REPLY contains correspondingly the INTERNAL_IP6_ADDRESS or the INTERNAL_IP6_SUBNET attribute; and\n-\tIf the UE included the INTERNAL_IP6_DNS or the INTERNAL_IP4_DNS in the CFG_REQUEST Configuration payload, the ePDG shall include the same attribute in the CFG_REPLY Configuration payload including zero or more DNS server addresses as specified in IETF RFC 7296 [28];\n-\tIf the UE included the P_CSCF_IP6_ADDRESS attribute, the P_CSCF_IP4_ADDRESS attribute or both in the CFG_REQUEST configuration payload, the ePDG may include one or more instances of the same attribute in the CFG_REPLY configuration payload as specified in IETF RFC 7651 [64]; and\n-\tThe ePDG may include the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute as specified in clause 8.2.4.2 indicating the timeout period for liveness check in the CFG_REPLY configuration payload. Presence of the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute in the IKE_AUTH request can be used as input for decision on whether to include the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute.\nIf the UE does not provide an APN to the ePDG during the tunnel establishment of a non-emergency session, the ePDG shall include the default APN in the \"IDr\" payload of the IKE_AUTH response message. If the UE provided an APN to the ePDG during the tunnel establishment, the ePDG shall not change the provided APN and shall include the APN in the IDr payload of the IKE_AUTH response message. The ePDG shall set the ID Type field of the \"IDr\" payload to ID_FQDN as defined in IETF RFC 7296 [28]. Handling of \"IDr\" payload in case of an emergency session is specified in clause 7.4.4. An IPsec tunnel is now established between the UE and the ePDG.\nIf the UE indicates Handover Attach by including the previously allocated home address information and the ePDG obtains one or more PDN GW identities from the 3GPP AAA server, the ePDG shall use these identified PDN GWs in the subsequent PDN GW selection process. If the UE indicates Initial Attach i.e. home address information not included:\n-\tif the PDN GW allocation type received from the 3GPP AAA server indicates the static allocation type, the received PDN GW identities shall be used to select PDN-GW; and\n-\tif the PDN GW allocation type received from the 3GPP AAA server indicates the dynamic allocation type, the PDN GW is selected based on DNS query via the UE requested APN.\nThe ePDG shall support IPSec ESP (see IETF RFC 4303 [32]) in order to provide secure tunnels between the UE and the ePDG as specified in 3GPP TS 33.402 [15].\nDuring the IKEv2 authentication and tunnel establishment, if the UE requested the HA IP address(es) and if DSMIPv6 was chosen and if the HA IP address(es) are available, the ePDG shall provide the HA IP address(es) (IPv6 address and optionally IPv4 address) for the corresponding APN as specified by the \"IDr\" payload in the IKE_AUTH request message by including in the CFG_REPLY Configuration Payload a HOME_AGENT_ADDRESS attribute. In the CFG_REPLY, the ePDG sets respectively the IPv6 Home Agent address field and optionally the IPv4 Home Agent address field of the HOME_AGENT_ADDRESS attribute to the IPv6 address of the HA and to the IPv4 address of the HA. If no IPv4 HA address is available at the ePDG or if it was not requested by the UE, the ePDG shall omit the IPv4 Home Agent Address field. If the ePDG is not able to provide an IPv6 HA address for the corresponding APN, then the ePDG shall not include a HOME_AGENT_ADDRESS attribute in the CFG_REPLY.\nThe ePDG may support multiple authentication exchanges in the IKEv2 protocol as specified in IETF RFC 4739 [49] in order to support additional authentication and authorization of the UE with an external AAA server.\nIf the ePDG supports authentication and authorization of the UE with an external AAA server, on receipt of an IKE_SA_INIT message the ePDG shall include a Notify payload of type \"MULTIPLE_AUTH_SUPPORTED\" in the IKE_SA_INIT response message to the UE.\nOn successful completion of authentication and authorization procedure of the UE accessing EPC and on receipt of an IKE_AUTH request containing a Notify payload of type \"ANOTHER_AUTH_FOLLOWS\", the ePDG shall send an IKE_AUTH response containing the \"AUTH\" payload.\nUpon receipt of a subsequent IKE_AUTH request from the UE containing the user identity in the private network within the \"IDi\" payload, the ePDG shall:\n-\tif PAP authentication is required, then send an EAP-GTC request to the UE within an IKE_AUTH response message. Upon receipt of an EAP-GTC response from the UE, the ePDG shall use the procedures defined in 3GPP TS 29.275 [18] and 3GPP TS 29.274 [50] to authenticate the user with the external AAA server; and\n-\tif CHAP authentication is required, then send an EAP MD5-Challenge request to UE. Upon receipt of EAP MD5-Challenge response within an IKE_AUTH request message from the UE, the ePDG shall use the procedures defined in 3GPP TS 29.275 [18] and 3GPP TS 29.274 [50] to authenticate the user with the external AAA server. If the ePDG receives Legacy-Nak response containing EAP–GTC type from the UE (see IETF RFC 3748 [29]) the ePDG may change the authentication and authorization procedure. If the ePDG does not change the authentication and authorization procedure or if the ePDG receives a Legacy-Nak response not containing EAP-GTC, the ePDG shall send an EAP-Failure to the UE.\nNOTE:\tThe signalling flows for authentication and authorization with an external AAA server are described in 3GPP TS 33.402 [15].\nIf the IKE_AUTH request message contains a P-CSCF_RESELECTION_SUPPORT Notify payload as described in clause 8.2.9.4 and if the ePDG supports the P-CSCF restoration extension (see 3GPP TS 23.380 [66]), the ePDG shall send a P-CSCF_RESELECTION_SUPPORT indication to the PGW.\nIf the ePDG supports emergency service, the ePDG shall send its capability indication of support emergency service to the UE by including the EMERGENCY_SUPPORT Notify payload within an IKE_AUTH response message. The content of the EMERGENCY_SUPPORT Notify payload is described in clause 8.2.9.7.\nDuring the tunnel establishment procedures, if the ePDG receives from the AAA Server the Authentication and Authorization Answer message with the Result code IE (as specified in 3GPP TS 29.273 [17]):\na)\tDIAMETER_ERROR_USER_NO_NON_3GPP_SUBSCRIPTION, the ePDG shall include, in the IKE_AUTH response message to the UE, a Notify payload with a Private Notify Message Type NON_3GPP_ACCESS_TO_EPC_NOT_ALLOWED as defined in clause 8.1.2;\nb)\tDIAMETER_ERROR_USER_UNKNOWN, the ePDG shall include, in the IKE_AUTH response message to the UE, a Notify payload with a Private Notify Message Type USER_UNKNOWN as defined in clause 8.1.2;\nc)\tDIAMETER_AUTHORIZATION_REJECTED, the ePDG shall include, in the IKE_AUTH response message to the UE, a Notify payload with a Private Notify Message Type AUTHORIZATION_REJECTED as defined in clause 8.1.2;\nd)\tDIAMETER_ERROR_RAT_TYPE_NOT_ALLOWED, the ePDG shall include, in the IKE_AUTH response message to the UE, a Notify payload with a Private Notify Message Type RAT_TYPE_NOT_ALLOWED as defined in clause 8.1.2;\ne)\tDIAMETER_UNABLE_TO_ COMPLY, the ePDG shall include, in the IKE_AUTH response message to the UE, a Notify payload with a Private Notify Message Type NETWORK_FAILURE as defined in clause 8.1.2 and the ePDG may also include a BACKOFF_TIMER Notify payload of the IKE_AUTH response message;\nf)\tDIAMETER_ERROR_ROAMING_NOT_ALLOWED, the ePDG shall include, in the IKE_AUTH response message to the UE, a Notify payload with a Private Notify Message Type PLMN_NOT_ALLOWED as defined in clause 8.1.2;\ng)\tDIAMETER_ERROR_ USER_NO_APN_SUBSCRIPTION, the ePDG shall include, in the IKE_AUTH response message to the UE, a Notify Payload with a Private Notify Message Type NO_APN_SUBSCRIPTION as defined in clause 8.1.2 and the ePDG may also include a BACKOFF_TIMER Notify payload of the IKE_AUTH response message; or\nh)\tDIAMETER_ERROR_ILLEGAL_EQUIPMENT, the ePDG shall include, in the IKE_AUTH response message to the UE, a Notify payload with a Private Notify Message Type ILLEGAL_ME as defined in clause 8.1.2.\nNOTE:\tIn the cases a) through h), the ePDG still provides to the UE the information needed to authenticate the ePDG.\nDuring the tunnel establishment procedures when the ePDG is congested, if the UE is a UE configured for high priority access as specified in clause 6.4.2.3, and if allowed by operator policy, the ePDG shall attempt to complete the procedure unless doing so would cause system instability.\nDuring the tunnel establishment procedures, when the network has determined that the requested procedure cannot be completed successfully due to a network failure, e.g. due to ePDG congestion, the ePDG:\na)\tshall include in the IKE_AUTH response message to the UE a Notify payload with a Private Notify Message Type NETWORK_FAILURE as defined in clause 8.1.2; and\nb)\tmay also include a BACKOFF_TIMER Notify payload of the IKE_AUTH response message.\nIf NBM is used and if the ePDG needs to reject a PDN connection due to conditions as specified in 3GPP TS 29.273 [17] or the network policies or the ePDG capabilities to indicate that no more PDN connection request of the given APN can be accepted for the UE, the ePDG shall include, in the IKE_AUTH response message, a Notify payload with a Private Notify Message Type PDN_CONNECTION_REJECTION as specified in clause 8.1.2. Additionally if the IKE_AUTH request message from the UE indicated Handover Attach as specified in clause 7.2.2, and the ePDG needs to reject a PDN connection for example due to the corresponding PDN GW identity not received for the APN, the ePDG shall include, in the IKE_AUTH response message, a Notify payload with a Private Notify Message Type \"PDN_CONNECTION_REJECTION\" as specified in clause 8.1.2 and the Notification Data field with the IP address information from the Handover Attach indication. If the UE indicated Initial Attach, the Notification Data field shall be omitted.\nIf the ePDG needs to reject a PDN connection due to the network policies or capabilities to indicate that no more PDN connection request with any APN can be accepted for the UE, the ePDG shall include in the IKE_AUTH response message containing the IDr payload a Notify payload with a Private Notify Message Type MAX_CONNECTION_REACHED as specified in clause 8.1.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.1A\tLiveness check",
                            "text_content": "If the ePDG has not received any cryptographically protected IKEv2 or IPSec message for the duration of the timeout period for liveness check selected according to the local policy, the ePDG shall send an INFORMATIONAL request with no payloads IETF RFC 7296 [28]. If an INFORMATIONAL response is not received, the ePDG shall deem the IKEv2 security association to have failed, shall discard all states associated with the IKE SA and any child SAs that were negotiated using that IKE SA as specified in IETF RFC 7296 [28] and shall inform the PGW and the 3GPP AAA Server that the connection has been released.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.1B\tHandling of NBIFOM",
                            "text_content": "If the UE included the NBIFOM_GENERIC_CONTAINER Notify payload (see clause 8.1.2.3) within the IKE_AUTH request message, and if required by procedures in 3GPP TS 24.161 [69], the ePDG shall include the same Notify payload within the IKE_AUTH response message as specified in 3GPP TS 24.161 [69]. The ePDG shall set the NBIFOM container contents field of the NBIFOM_GENERIC_CONTAINER Notify payload as specified in 3GPP TS 24.161 [69].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.1C\tHandling of N1 mode support",
                            "text_content": "If the UE included the N1_MODE_CAPABILITY Notify payload (see clause 8.1.2.3) within the IKE_AUTH request message, the ePDG may include the N1_MODE_INFORMATION Notify payload and the N1_MODE_S_NSSAI_PLMN_ID Notify payload within the IKE_AUTH response message. The ePDG shall set the S-NSSAI Value field of the N1_MODE INFORMATION Notify payload to the S-NSSAI for the PDU session associated with the IKEv2 security association if the ePDG receives the S-NSSAI information as specified in 3GPP TS 29.274 [50] for the PDU session indicated in the PDU session ID field of the N1_MODE_CAPABILITY Notify payload. The ePDG shall set the S-NSSAI PLMN ID field of the N1_MODE_S_NSSAI_PLMN_ID Notify payload to the PLMN ID that the S-NSSAI relates to for the PDU session associated with the IKEv2 security association if the ePDG receives the PLMN ID that the S-NSSAI relates to as specified in 3GPP TS 29.274 [50] for the PDU session indicated in the PDU session ID field of the N1_MODE_CAPABILITY Notify payload.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.2\tTunnel modification",
                            "text_content": "The ePDG shall forward the list of available P-CSCF addresses received from the P-GW by including the P_CSCF_IP6_ADDRESS attribute, the P_CSCF_IP4_ADDRESS attribute or both as specified in IETF RFC 7651 [64] in the CFG_REQUEST configuration payload within the INFORMATIONAL request to the UE as specified in 3GPP TS 23.380 [66].\nIf the ePDG-initiated modification procedure is triggered by NBIFOM procedures in 3GPP TS 24.161 [69], the ePDG shall include the NBIFOM_GENERIC_CONTAINER Notify payload (see clause 8.1.2.3) in the INFORMATIONAL request. The ePDG shall set the NBIFOM container contents field of the NBIFOM_GENERIC_CONTAINER Notify payload as specified in 3GPP TS 24.161 [69].\nIf the ePDG-initiated modification is initiated by a UE-initiated modification, i.e. by a received INFORMATIONAL request message, then the ePDG shall include in the sent INFORMATIONAL request message a PTI Notify payload as specified in clause 8.1.2.3 with the Related Message ID field set to the Message ID field of the received INFORMATIONAL request message.\nWhen receiving an INFORMATIONAL request containing the UPDATE_SA_ADDRESSES notification, the ePDG shall check the validity of the IP address and update the IP address in the IKE security association with the values from the IP header. The ePDG shall reply with an INFORMATIONAL response.\nThe ePDG may initiate a return routability check for the new address provided by the UE, by including a COOKIE2 notification in an INFORMATIONAL request and send it to the UE. When the ePDG receives the INFORMATIONAL response from the UE, it shall check that the COOKIE2 notification payload is the same as the one it sent to the UE. If it is different, the ePDG shall close the IKE security association by sending an INFORMATIONAL request message including a \"DELETE\" payload.\nIf no return routability check is initiated by the ePDG, or if a return routability check is initiated and is successfully completed, the ePDG shall update the IPsec security associations associated with the IKE security association with the new address.\nUpon of receipt of the NBIFOM_GENERIC_CONTAINER Notify payload (see clause 8.1.2.3)in an INFORMATIONAL request, the ePDG shall reply with an INFORMATIONAL response and if required by procedures in 3GPP TS 24.161 [69], the ePDG shall include the NBIFOM_GENERIC_CONTAINER Notify payload in the INFORMATIONAL response. The ePDG shall set the NBIFOM container contents field of the NBIFOM_GENERIC_CONTAINER Notify payload as specified in 3GPP TS 24.161 [69].\nBased on operator policy, under general overload conditions the ePDG should not reject requests from UEs which the ePDG is treating with high priority access according to 3GPP TS 29.273 [17], up to the point where further exemption would cause network instability.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.3\tTunnel disconnection",
                            "text_content": "The ePDG shall use the procedures defined in the IKEv2 protocol (see IETF RFC 7296 [28]) to disconnect one or more IPsec tunnels to the UE. The ePDG shall close the incoming security associations associated with the tunnel and instruct the UE to do likewise by sending the INFORMATIONAL request message including a \"DELETE\" payload. The DELETE payload shall contain either:\ni)\tProtocol ID set to \"1\" and no subsequent Security Parameter Indexes in the payload. This indicates that the IKE security association, and all IPsec ESP security associations that were negotiated within it between ePDG and UE shall be deleted;\nii)\tif the IKEv2 multiple bearer PDN connectivity is not supported or not used in the PDN connection as determined in clause 7.4.6, the Protocol ID set to \"3\" for ESP. The SECURITY PARAMETERS INDEXES s included in the payload shall correspond to the particular incoming ESP SECURITY ASSOCIATION at the ePDG for the given tunnel in question; or\niii)\tif the IKEv2 multiple bearer PDN connectivity is used in the PDN connection as determined in clause 7.4.6, the Protocol ID field of the DELETE payload is set to \"3\" for ESP and the SPI field of the DELETE payload includes ePDG's ESP SPIs bound to each the S2b bearers of the PDN connection.\nThe INFORMATIONAL request message, in addition of the DELETE payload, may include the REACTIVATION_REQUESTED_CAUSE Notify payload.\nIf the ePDG receives the reactivation requested cause in a Delete Bearer Request over S2b, the ePDG shall include the REACTIVATION_REQUESTED_CAUSE Notify payload in the INFORMATIONAL request message containing a DELETE payload.\nOn receipt of the INFORMATIONAL request message including \"DELETE\" payload indicating that the UE is initiating tunnel disconnect procedure, the ePDG shall:\ni)\tClose all security associations identified within the DELETE payload (these security associations correspond to outgoing security associations from the ePDG perspective). If no security associations were present in the DELETE payload, and the protocol ID was set to \"1\", the ePDG shall close the IKE security association, and all IPsec ESP security associations that were negotiated within it towards the UE; and\nii)\tThe ePDG shall delete the incoming security associations corresponding to the outgoing security associations identified in the \"DELETE\" payload.\nThe ePDG shall send an INFORMATIONAL response message. This shall contain a list of security associations deleted in step (ii) above.\nIf the ePDG is unable to comply with the INFORMATIONAL request message, the ePDG shall send INFORMATION response message with either:\ni)\ta NOTIFY payload of type \"INVALID_SPI\", for the case that it could not identify one or more of the SECURITY PARAMETERS INDEXES in the message from the UE; or\nii)\ta more general NOTIFY payload type. This payload type is implementation dependent.\nA PDN connection over untrusted WLAN over S2b can be released locally in the ePDG, i.e. without any peer-to-peer signalling between the ePDG and the UE, based on the trigger received from the PGW, e.g. during the P-CSCF restoration procedure for NBIFOM PDN connections (see 3GPP TS 23.380 [66]).\nUpon receiving a request from PGW to release the resources for a PDN connection with cause \"local release\" (see 3GPP TS 29.274 [50]) the ePDG shall:\na)\tclose the related IKEv2 security association for the IPsec tunnel associated with this PDN connection; and\nb)\tconsider that the UE is no longer responding (see RFC 7296 [28]) and not send any messages to the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.4\tEmergency session establishment",
                            "text_content": "If the \"IDr\" payload containing the string \"EMERGENCY\", using capital letters only, in the Identification Data is included in the IKE_AUTH request message from the UE, the ePDG shall:\na)\tif:\n1)\tan INTERNAL_IP4_ADDRESS attribute with the length field set to zero;\n2)\tan INTERNAL_IP6_ADDRESS attribute with the length field set to zero; or\n3)\tboth of the above;\nare included in the CFG_REQUEST Configuration Payload within the IKE_AUTH request message, handle the session establishment as an emergency session establishment;\nb)\tif:\n1)\tan INTERNAL_IP4_ADDRESS attribute with the length field set to non-zero;\n2)\tan INTERNAL_IP6_ADDRESS attribute with the length field set to non-zero; or\n3)\tboth of the above;\nare included in the CFG_REQUEST Configuration Payload within the IKE_AUTH request message, handle the session establishment as a handover of an emergency session;\nc)\tin the IKE_AUTH response message, the ePDG shall not include the APN in the \"IDr\" payload; and\nd)\tignore the fact that the \"EMERGENCY\" string does not comply with the ID_FQDN ID Type, as described in IETF RFC 7296 [28].\nIn addition, if the IKE tunnel establishment is initiated for emergency session:\n1)\tif IMSI is provided to the network but the ePDG receives from the AAA Server the Authentication and Authorization Answer message with the Result code IE indicating DIAMETER_ERROR_USER_UNKNOWN (see 3GPP TS 29.273 [17]), and thus the network considers the IMSI is unauthenticated:\n-\tif the ePDG is configured to support unauthenticated emergency session over WLAN and Mobile Equipment Identity signalling over untrusted WLAN, the ePDG shall request the IMEI from the UE using the Mobile Equipment Identity signalling procedure by including the DEVICE_IDENTITY Notify payload in the IKE_AUTH response message as specified in clause 7.4.5; or\n-\tif the ePDG is not configured to support unauthenticated emergency session over WLAN or the ePDG is not configured to support Mobile Equipment Identity signalling over untrusted WLAN, the ePDG shall reject the requested PDN connection for emergency session. The ePDG shall include, in the IKE_AUTH response message, a Notify payload with a Private Notify Message Type \"UNAUTHENTICATED_EMERGENCY_NOT_SUPPORTED\" as specified in clause 8.1.2; or\n2)\tif IMSI is not provided to the network and the UE's IMEI is used as the User Identity in the IDi payload of the IKE_AUTH request message:\n-\tif the ePDG is configured to support emergency services from unauthenticated UE and the local policies and regulations allow unauthenticated emergency sessions, the ePDG sends an EAP payload with the NAI in the IDi payload received from the UE to the 3GPP AAA Server serving the specific domain indicated in the realm part of NAI in the IDr payload. If the ePDG receives the Authentication and Authorization Answer message with the Result code IE indicating DIAMETER_ERROR_USER_UNKNOWN (see 3GPP TS 29.273 [17]), the ePDG shall reject the emergency services request from the UE with the Notify Message Type IMEI_NOT_ACCEPTED as specified in clause 8.1.2.2; or\n-\tif the ePDG is not configured to support emergency services from unauthenticated UE or if the local policies and regulations do not allow unauthenticated emergency sessions, the ePDG shall reject the emergency services request from the UE with the Notify Message Type IMEI_NOT_ACCEPTED as specified in clause 8.1.2.2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.5\tMobile identity signaling",
                            "text_content": "If the network supports Mobile Equipment Identity signalling over untrusted WLAN, the ePDG may request the UE to provide the Mobile Equipment Identity by including the DEVICE_IDENTITY Notify payload with the Identity Type field set to either 'IMEI' or 'IMEISV' and an empty Identity Value field in:\n-\tthe IKE_AUTH response message to the initial IKE_AUTH request message received from the UE during the IKEv2 authentication and security association establishment; or\n-\tthe INFORMATIONAL request message at any time after successful IPSec tunnel establishment.\nIf the ePDG receives the following response message from the UE:\n-\tthe IKE_AUTH request message with the DEVICE_IDENTITY Notify payload; or\n-\tthe INFORMATIONAL response message with the DEVICE_IDENTITY Notify payload,\nand the Identity Type field set to either 'IMEI' or 'IMEISV' and the Identity Value is not empty, the ePDG shall forward the received IMEI or IMEISV identity to the 3GPP AAA server as specified in 3GPP TS 29.273 [17] and to the PDN GW as specified in 3GPP TS 29.275 [18] and 3GPP TS 29.274 [50].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.4.6\tIKEv2 multiple bearer PDN connectivity",
                            "text_content": "The ePDG may support the IKEv2 multiple bearer PDN connectivity.\nIf the ePDG supports the IKEv2 multiple bearer PDN connectivity, then the ePDG shall perform handling specified in the present clause. Otherwise the ePDG does not perform handling specified in the present clause and remaining clauses of the parent clause of the present clause.\nIf the IKE_AUTH request message contains an IKEV2_MULTIPLE_BEARER_PDN_CONNECTIVITY Notify payload as specified in clause 8.2.9.9 and the ePDG decides to use the IKEv2 multiple bearer PDN connectivity in the PDN connection of the IKE SA being established by the IKE_AUTH request message according to local policy, the ePDG shall consider that the IKEv2 multiple bearer PDN connectivity is used in the PDN connection.\nIf the IKEv2 multiple bearer PDN connectivity is used in the PDN connection, then the ePDG shall perform the handling specified in remaining clauses of the parent clause of the present clause. Otherwise the ePDG does not perform the handling specified in remaining clauses of the parent clause of the present clause.\nThe ePDG shall maintain a binding of an ePDG's ESP SPI and a UE's ESP SPI to each S2b bearer of the PDN connection.\nParent clause of the present clause describe control plane procedures for the IKEv2 multiple bearer PDN connectivity.\nIn the IKE_AUTH response message establishing an IKE SA of the PDN connection:\na)\tthe ePDG shall include an EPS_QOS Notify payload as specified in clause 8.2.9.10 indicating the EPS QoS of the default S2b bearer of the PDN connection;\nb)\tthe ePDG may include an EXTENDED_EPS_QOS Notify payload as specified in clause 8.2.9.10A indicating the extended EPS QoS of the default S2b bearer of the PDN connection;\nc)\tthe ePDG may include an APN_AMBR Notify payload as specified in clause 8.2.9.13 indicating the APN-AMBR of the PDN connection; and\nd)\tif the APN_AMBR Notify payload is included, the ePDG may include an EXTENDED_APN_AMBR Notify payload as specified in clause 8.2.9.14 indicating the extended APN-AMBR of the PDN connection\n.Upon sending the IKE_AUTH response message, the ePDG shall bind the ePDG's ESP SPI created by the IKE_AUTH request/response pair and the UE's ESP SPI created by the IKE_AUTH request/response pair to the default S2b bearer of the PDN connection.\nIf a dedicated S2b bearer of the PDN connection is activated, the ePDG shall send a CREATE_CHILD_SA request message in the IKE SA of the PDN connection. In the CREATE_CHILD_SA request message:\na)\tthe ePDG shall include an EPS_QOS Notify payload as specified in clause 8.2.9.10 indicating the EPS QoS of the dedicated S2b bearer of the PDN connection;\nb)\tthe ePDG may include an EXTENDED_EPS_QOS Notify payload as specified in clause 8.2.9.10A indicating the extended EPS QoS of the dedicated S2b bearer of the PDN connection; and\nc)\tthe ePDG shall include an TFT Notify payload as specified in clause 8.2.9.11 indicating the TFT of the dedicated S2b bearer of the PDN connection.\nUpon receiving a CREATE_CHILD_SA response message without an IKEv2 notify payload indicating an error, the ePDG shall accept the dedicated S2b bearer activation and shall bind the ePDG's ESP SPI created by the CREATE_CHILD_SA request/response pair and the UE's ESP SPI created by the CREATE_CHILD_SA request/response pair to the dedicated S2b bearer of the PDN connection.\nUpon receiving a CREATE_CHILD_SA response message with an IKEv2 notify payload indicating an error, the ePDG shall reject the dedicated S2b bearer activation.\nIf a dedicated S2b bearer of the PDN connection is deactivated, the ePDG shall send a INFORMATIONAL request message in the IKE SA of the PDN connection. In the INFORMATIONAL request message, the ePDG shall include an DELETE payload indicating the ePDG's ESP SPI bound to the dedicated S2b bearer.\nUpon receiving of a INFORMATIONAL response message, the ePDG shall acknowledge deactivation of the dedicated S2b bearer.\nIf an S2b bearer of the PDN connection is modified, the ePDG shall send a INFORMATIONAL request message in the IKE SA of the PDN connection. In the INFORMATIONAL request message, the ePDG shall include an MODIFIED_BEARER Notify payload as specified in clause 8.2.9.12 indicating the ePDG's ESP SPI bound to the S2b bearer. In the INFORMATIONAL request message:\na)\tthe ePDG may include an EPS_QOS Notify payload as specified in clause 8.2.9.10 indicating the EPS QoS of the S2b bearer of the PDN connection;\nb)\tif the EPS_QOS Notify payload is included, the ePDG may include an EXTENDED_EPS_QOS Notify payload as specified in clause 8.2.9.10A indicating the extended EPS QoS of the default S2b bearer of the PDN connection;\nc)\tthe ePDG may include an TFT Notify payload as specified in clause 8.2.9.11 indicating the TFT of the S2b bearer of the PDN connection; and\nd)\tif the S2b bearer is the default S2b bearer:\n1)\tthe ePDG may include an APN_AMBR Notify payload as specified in clause 8.2.9.13 indicating the APN-AMBR of the PDN connection; and\n2)\tif the APN_AMBR Notify payload is included, the ePDG may include an EXTENDED_APN_AMBR Notify payload as specified in clause 8.2.9.14 indicating the extended APN-AMBR of the PDN connection.\nUpon receiving a INFORMATIONAL response message without an IKEv2 notify payload indicating an error, the ePDG shall accept the S2b bearer modification.\nUpon receiving a INFORMATIONAL response message with an IKEv2 notify payload indicating an error, the ePDG shall reject the S2b bearer modification.\nUpon receiving a CREATE_CHILD_SA response message without an IKEv2 notify payload indicating an error, for a CREATE_CHILD_SA request message sent in the IKE SA of the PDN connection, with a REKEY_SA Notify payload indicating an ePDG's ESP SPI bound to an S2b bearer of the PDN connection, the ePDG shall set the ePDG's ESP SPI bound to the S2b bearer to the ePDG's ESP SPI created by the CREATE_CHILD_SA request/response pair and shall set the UE's ESP SPI bound to the S2b bearer to the UE's ESP SPI created by the CREATE_CHILD_SA request/response pair.\nUpon receiving a CREATE_CHILD_SA request message in the IKE SA of the PDN connection, with a REKEY_SA Notify payload indicating an UE's ESP SPI bound to an S2b bearer of the PDN connection, if the ePDG sends a CREATE_CHILD_SA response message without an IKEv2 notify payload indicating an error, the ePDG shall set the ePDG's ESP SPI bound to the S2b bearer to the ePDG's ESP SPI created by the CREATE_CHILD_SA request/response pair, and shall set the UE's ESP SPI bound to the S2b bearer to the UE's ESP SPI created by the CREATE_CHILD_SA request/response pair.\nParent clause of the present clause describe user plane procedures for the IKEv2 multiple bearer PDN connectivity.\nThe ePDG shall forward a downlink IP packet received via an S2b bearer of the PDN connection using a UE's ESP SPI bound to the S2b bearer. The ePDG shall, based on operator policy, use the QCI and ARP of S2b bearer via which the downlink packet was received to derive the DSCP value for downlink packets and set the DSCP field as specified in IETF RFC 2474 [75] of the outer IP header of the ESP packet.\nNOTE:\tThe ePDG can map QCI to DSCP value, for example, by using the mapping between standardized QCI values and Release 99 3GPP QoS parameter values specified in 3GPP TS 23.401 [4] table E.3, and the mapping between Release 99 3GPP QoS parameter values and DSCP values specified in IEEE Std 802.11 [57] table R-1.\nThe ePDG shall forward an uplink IP packet received via an ePDG's ESP SPI bound to an S2b bearer of the PDN connection using the S2b bearer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "8\tPDUs and parameters specific to the present document",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "8.0\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The least significant bit of a field is represented by the lowest numbered bit of the highest numbered octet of the field. When the field extends over more than one octet, the order of bit values progressively decreases as the octet number increases.\nFigure 8.0-1 shows an example of a field where the most significant bit of the field is marked MSB and the least significant bit of the field is marked LSB.\nFigure 8.0-1: Example of bit ordering of a field\nNOTE:\tIETF RFCs adopted different numbering of bits, such that the least significant bit of a field is represented by the highest numbered bit of the field.\n",
                    "tables": [
                        {
                            "description": "Figure 8.0-1 shows an example of a field where the most significant bit of the field is marked MSB and the least significant bit of the field is marked LSB.",
                            "table number": 3,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.1\t3GPP specific coding information defined within present document",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.1.1\tAccess Network Identity format and coding",
                            "text_content": "The Access Network Identity shall take the generic format of an octet string without terminating null characters. The length indicator for the ANID is 2 bytes long, see IETF RFC 5448 [38]. Representation as a character string is allowed, but this character string shall be converted into an octet string of maximum length 253 according to UTF-8 encoding rules as specified in IETF RFC 3629 [34] before the Access Network Identity is input to the Key Derivation Function, as specified in 3GPP TS 33.402 [15], used in the Access Network Identity indication from 3GPP AAA server to UE, cf. clause 8.2.2 or during authentication for NSWO in 5GS as specified in annex S of 3GPP TS 33.501 [78]. The ANID is structured as an ANID Prefix and none, one or more ANID additional character strings separated by the colon character \":\". In case additional ANID strings are not indicated the complete ANID consists of the ANID Prefix character string only. The ANID shall be represented by Unicode characters encoded as UTF-8 as specified in IETF RFC 3629 [34] and formatted using Normalization Form KC (NFKC) as specified in Unicode 5.1.0, Unicode Standard Annex #15; Unicode Normalization Forms [41].\nTable 8.1.1.2-1 specifies the list of Access Network Identities defined by 3GPP in the context of non-3GPP access to EPC.\nTable 8.1.1.2-1: Access Network Identities in the context of non-3GPP access to EPC\n\nTable 8.1.1.2-2 specifies the list of Access Network Identities defined by 3GPP in the context of access to 5GCN.\nTable 8.1.1.2-2: Access Network Identities in the context of access to 5GCN\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.1.1.2-1: Access Network Identities in the context of non-3GPP access to EPC",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.1.2-2: Access Network Identities in the context of access to 5GCN",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.1.2\tIKEv2 Notify Message Type value",
                            "text_content": "The IKEv2 Notify Message Type is specified in IETF RFC 7296 [28].\nThe Notify Message Type with a value (in decimal) between 8192 and 16383 is reserved for private error usage.\nThe Notify Message Type with a value (in decimal) between 40960 and 65535 is reserved for private status usage.\nOnly the private IKEv2 Notify Message Types used for this specification are specified in this clause.\nThe Private Notify Message, Error Types defined in table 8.1.2.2-1 are error notifications which indicates an error while negotiating an IKEv2 SA for the PDN connection to the APN requested by the UE. Refer to table 8.1.2.2-1 for more details on what each error type means.\nTable 8.1.2.2-1: Private Error Types\n\nThe private notify message error type values:\n-\tbetween 9950 and 9999;\n-\tbetween 10950 and 10999;\n-\tbetween 11950 and 11999;\n-\tbetween 12950 and 12999;\n-\tbetween 13950 and 13999;\n-\tbetween 14950 and 14999; and\n-\tbetween 15500 and 15599;\nwill not be allocated to a Notify payload defined in the present specification.\nThe private notify message error type values between 15500 and 15599 shall be allocated in 3GPP TS 24.502 [77].\nThe Private Notify Message Status Types defined in table 8.1.2.3-1 are used to indicate status notifications or additional information in a Notify payload which may be added to an IKEv2 message or IKE_AUTH request or IKE_AUTH response message according to the procedures described in the present document. Refer to table 8.1.2.3-1 for more details on what each status type means.\nTable 8.1.2.3-1: Private Status Types\n\nThe private notify message status type values:\n-\tbetween 49950 and 49999;\n-\tbetween 50950 and 50999;\n-\tbetween 51950 and 51999;\n-\tbetween 52950 and 52999;\n-\tbetween 53950 and 53999;\n-\tbetween 54950 and 54999; and\n-\tbetween 55500 and 55599;\nwill not be allocated to a Notify payload defined in the present specification.\nThe private notify message status type values between 55500 and 55599 shall be allocated in 3GPP TS 24.502 [77].\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.1.2.2-1: Private Error Types",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.2.3-1: Private Status Types",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.1.3\tANDSF Push Information",
                            "text_content": "The values of the ANDSF Push Information sent to the UE using the GAA bootstrap framework for ANDSF Push as specified in clause 6.8.2.2.2 are defined in this clause.\nThe ANDSF Push Information defined in table 8.1.3.2-1 indicates the X-WAP-Application-ID field (Push Application ID) for ANDSF in the WSP header.\nTable 8.1.3.2-1: ANDSF Push Information values\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 8.1.3.2-1: ANDSF Push Information values",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.1.4\tPDUs for TWAN connection modes",
                            "text_content": "The PDUs defined in this clause are used when SCM, MCM or both are supported.\nThe sending entity shall set value of spare bit to zero. The receiving entity shall ignore value of spare bit\nThe message is coded according to figure 8.1.4.1-1 and table 8.1.4.1-1.\nFigure 8.1.4.1-1: Message\nTable 8.1.4.1-1: Message\n\nTable 8.1.4.1-2: Message type\n\nThe Item is coded according to figure 8.1.4.2-1 and table 8.1.4.2-1:\nFigure 8.1.4.2-1: Item\nTable 8.1.4.2-1: Item\n\nTable 8.1.4.2-2: Types of item\n\nWhen the Type field of this item, according to clause 8.1.4.2, indicates the CONNECTIVITY_TYPE, then the Length field of this item is set to 1 and the Value field of this item is coded according to table 8.1.4.3-1.\nTable 8.1.4.3-1: CONNECTIVITY_TYPE value\n\nWhen the Type field of this item according to clause 8.1.4.2 indicates the ATTACHMENT_TYPE, then the Length field of this item is set to 1 and the Value field of this item is coded according to table 8.1.4.4-1.\nTable 8.1.4.4-1: ATTACHMENT_TYPE value\n\nWhen the Type field of this item according to clause 8.1.4.2 indicates the APN, then the Value field of this item contains the APN as described in 3GPP TS 23.003 [3]. When received by the 3GPP AAA server, it indicates the requested APN. When received by the UE, it indicates the selected APN.\nWhen the Type field of this item according to clause 8.1.4.2 indicates the PDN_TYPE, then the Length field of this item is set to 1 and the Value field of this item is coded according to table 8.1.4.6-1.\nTable 8.1.4.6-1: PDN_TYPE value\n\nWhen the Type field of this item according to clause 8.1.4.2 indicates the AUTHORIZATIONS, then the Length field of this item is set to 1 and the Value field of this item is coded according to figure 8.1.4.7-1 and table 8.1.4.7-1.\nFigure 8.1.4.7-1: AUTHORIZATIONS value\nTable 8.1.4.7-1: AUTHORIZATIONS value\n\nWhen the Type field of this item according to clause 8.1.4.2 indicates the CONNECTION_MODE_CAPABILITY, then the Length field of this item is set to 1 and the Value field of this item is coded according to figure 8.1.4.8-1 and table 8.1.4.8-1.\nFigure 8.1.4.8-1: CONNECTION_MODE_CAPABILITY value\nTable 8.1.4.8-1: CONNECTION_MODE_CAPABILITY value\n\nWhen the Type field of this item according to clause 8.1.4.2 indicates the PROTOCOL_CONFIGURATION_OPTIONS, then the Value field of this item is coded as the value part (as specified in 3GPP TS 24.007 [48] for type 4 IE) of the protocol configuration options information element defined in 3GPP TS 24.008 [46] clause 10.5.6.3.\nNOTE:\tThe protocol configuration options IEI field and the length of protocol configuration options contents field of the protocol configuration options information element are not included in the Value field of the PROTOCOL_CONFIGURATION_OPTIONS item.\nWhen the Type field of this item according to clause 8.1.4.2 indicates the CAUSE, then the Length field of this item is set to 1 and the Value field of this item is coded according to table 8.1.4.10-1. If the CAUSE item is received by the 3GPP AAA server, the item is ignored.\nSemantics of the Cause values are defined in clause 8.1.4.10.2.\nTable 8.1.4.10-1: CAUSE value\n\nCause #8 - Operator determined barring\nThis cause is used by the network to indicate that the requested service was rejected due to operator determined barring.\nCause #26 - Insufficient resources\nThis cause is used by the network to indicate that the requested service cannot be provided due to insufficient resources.\nCause #27 - Unknown APN\nThis cause is used by the network to indicate that the requested service was rejected because the access point name could not be resolved.\nCause #28 - Unknown PDN type\nThis cause is used by the network to indicate that the requested service was rejected by the external packet data network because the PDN type could not be recognised.\nCause #29 - User authentication failed\nThis cause is used by the network to indicate that the requested service was rejected by the external packet data network due to a failed user authentication.\nCause #30 - Request rejected by PDN GW\nThis cause is used by the network to indicate that the requested service or operation was rejected by the PDN GW.\nCause #31 - Request rejected, unspecified\nThis cause is used by the network to indicate that the requested service or operation was rejected due to unspecified reasons.\nCause #32 - Service option not supported\nThis cause is used by the network when the UE requests a service which is not supported by the PLMN.\nCause #33 - Requested service option not subscribed\nThis cause is sent when the UE requests a service option for which it has no subscription.\nCause #34 - Service option temporarily out of order\nThis cause is sent when the network cannot service the request because of temporary outage of one or more functions required for supporting the service.\nCause #38 - Network failure\nThis cause is used by the network to indicate that the requested service was rejected due to an error situation in the network.\nCause #50 - PDN type IPv4 only allowed\nThis value is used by the network to indicate that only PDN type IPv4 is allowed for the requested PDN connectivity.\nCause #51 - PDN type IPv6 only allowed\nThis value is used by the network to indicate that only PDN type IPv6 is allowed for the requested PDN connectivity.\nCause #54 – PDN connection does not exist\nThis value is used by the network at handover from a 3GPP access network to indicate that the network does not have any information about the requested PDN connection.\nCause #111 - Protocol error, unspecified\nThis value is used to report a protocol error event only when no other value applies.\nCause #113 - Multiple accesses to a PDN connection not allowed\nThis value is used by the network to indicate that an additional access to the PDN connection as specified in 3GPP TS 24.161 [69] is not allowed.\nThis clause shows the numbers in the decimal numeration system.\nWhen the Type field of this item according to clause 8.1.4.2 indicates the IPV4_ADDRESS, then the Length field of this item is set to 4 and the Value field of this item contains an IPv4 address allocated to the UE for the PDN connection.\nWhen the Type field of this item according to clause 8.1.4.2 indicates the IPV6_INTERFACE_IDENTIFIER, then the Length field of this item is set to 8 and the Value field of this item contains an IPv6 interface identifier allocated to the UE for the PDN connection to be used to build the IPv6 link local address.\nWhen the Type field of this item according to clause 8.1.4.2 indicates the TWAG_CP_ADDRESS, then the Value field of this item contains one or two TWAG control plane addresses and is coded according to figure 8.1.4.13-1 and table 8.1.4.13-1.\nFigure 8.1.4.13-1: TWAG_CP_ADDRESS item value\nTable 8.1.4.13-1: TWAG_CP_ADDRESS item value\n\nWhen the Type field of this item according to clause 8.1.4.2 indicates the TWAG_UP_MAC_ADDRESS, then the Length field of this item is set to 6 and the Value field of this item contains a TWAG user plane MAC address allocated to the PDN connection. The MAC address is defined in clause 8 of IEEE Std 802 [58].\nWhen the Type field of this item according to clause 8.1.4.2 indicates the SUPPORTED_WLCP_TRANSPORTS, then the Length field of this item is set to 1 and the Value field of this item is coded according to figure 8.1.4.15-1 and table 8.1.4.15-1.\nFigure 8.1.4.15-1: SUPPORTED_WLCP_TRANSPORTS value\nTable 8.1.4.15-1: SUPPORTED_WLCP_TRANSPORTS value\n\nWhen the Type field of this item according to clause 8.1.4.2 indicates the Tw1, then the Value field of this item is coded as the value part (as specified in 3GPP TS 24.007 [48] for type 4 IE) of the GPRS timer 3 information element defined in 3GPP TS 24.008 [46] clause 10.5.7.4a.\nNOTE:\tThe GPRS Timer 3 IEI field and the length of GPRS Timer 3 contents field of the GPRS timer 3 information element are not included in the Value field of the Tw1 item.\nWhen the Type field of this item according to clause 8.1.4.2 indicates the ACCESS_CAUSE, then the Length field of this item is set to 1 and the Value field of this item is coded according to table 8.1.4.17-1.\nTable 8.1.4.17-1: ACCESS_CAUSE value\n\nAccess cause #2- Non-3GPP access to EPC not allowed\nThis cause is used by the network to indicate that the requested service was rejected due to the user subscription data does not support EPS services from non-3GPP access.\nAccess cause #3- RAT type not allowed\nThis cause is used by the network to indicate that the requested service was rejected due to the WLAN is not allowed.\nAccess cause #6- Illegal ME\nThis cause is sent to the UE if the ME used is not acceptable to the network, e.g. prohibit listed.\nAccess cause #11- PLMN not allowed\nThis cause is used by the network to indicate that the requested service was rejected due to the PLMN where the UE is roaming into is not allowed.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The message is coded according to figure 8.1.4.1-1 and table 8.1.4.1-1.",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.1-1: Message",
                                    "table number": 10,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.1-2: Message type",
                                    "table number": 11,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "The Item is coded according to figure 8.1.4.2-1 and table 8.1.4.2-1:",
                                    "table number": 12,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.2-1: Item",
                                    "table number": 13,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.2-2: Types of item",
                                    "table number": 14,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.3-1: CONNECTIVITY_TYPE value",
                                    "table number": 15,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.4-1: ATTACHMENT_TYPE value",
                                    "table number": 16,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.6-1: PDN_TYPE value",
                                    "table number": 17,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "When the Type field of this item according to clause 8.1.4.2 indicates the AUTHORIZATIONS, then the Length field of this item is set to 1 and the Value field of this item is coded according to figure 8.1.4.7-1 and table 8.1.4.7-1.",
                                    "table number": 18,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.7-1: AUTHORIZATIONS value",
                                    "table number": 19,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "When the Type field of this item according to clause 8.1.4.2 indicates the CONNECTION_MODE_CAPABILITY, then the Length field of this item is set to 1 and the Value field of this item is coded according to figure 8.1.4.8-1 and table 8.1.4.8-1.",
                                    "table number": 20,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.8-1: CONNECTION_MODE_CAPABILITY value",
                                    "table number": 21,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.10-1: CAUSE value",
                                    "table number": 22,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "When the Type field of this item according to clause 8.1.4.2 indicates the TWAG_CP_ADDRESS, then the Value field of this item contains one or two TWAG control plane addresses and is coded according to figure 8.1.4.13-1 and table 8.1.4.13-1.",
                                    "table number": 23,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.13-1: TWAG_CP_ADDRESS item value",
                                    "table number": 24,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "When the Type field of this item according to clause 8.1.4.2 indicates the SUPPORTED_WLCP_TRANSPORTS, then the Length field of this item is set to 1 and the Value field of this item is coded according to figure 8.1.4.15-1 and table 8.1.4.15-1.",
                                    "table number": 25,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.15-1: SUPPORTED_WLCP_TRANSPORTS value",
                                    "table number": 26,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.1.4.17-1: ACCESS_CAUSE value",
                                    "table number": 27,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "8.2\tIETF RFC coding information defined within present document",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.2.1\tIPMS attributes",
                            "text_content": "\nFigure 8.2.1.1: AT_IPMS_IND attribute\n\nTable 8.2.1.1: AT_IPMS_IND attribute\n\n\nFigure 8.2.1.2: AT_IPMS_RES attribute.\n\nTable 8.2.1.2: AT_IPMS_RES attribute\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 28,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.1.1: AT_IPMS_IND attribute",
                                    "table number": 29,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 30,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.1.2: AT_IPMS_RES attribute",
                                    "table number": 31,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.2.2\tAccess Network Identity indication attribute",
                            "text_content": "The Access Network Identity is indicated in the Network Name Field of the AT_KDF_INPUT attribute as specified in IETF RFC 5448 [38]. The Network Name Field shall contain the Access Network Identity as specified in clause 8.1.1 of this specification.\nNOTE:\tIETF in IETF RFC 5448 [38] refers to this specification for the value of the Network Name field.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.2.3\tTrust relationship indication attribute",
                            "text_content": "\nFigure 8.2.3.1-1: AT_TRUST_IND attribute\n\nTable 8.2.3.1-1: AT_TRUST_IND attribute\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 32,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.3.1-1: AT_TRUST_IND attribute",
                                    "table number": 33,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.2.4\tIKEv2 Configuration Payloads attributes",
                            "text_content": "The HOME_AGENT_ADDRESS attribute is shown in figure 8.2.4.1-1. The length of the HOME_AGENT_ADDRESS attribute is 16 or 20 bytes. The IPv4 Home Agent Address field is optional. The HA's IPv6 and IPv4 addresses are laid out respectively in IPv6 Home Agent Address and IPv4 Home Agent Address fields in big endian order (aka most significant byte first, or network byte order), see IETF RFC 7296 [28].\nFigure 8.2.4.1-1: HOME_AGENT_ADDRESS attribute\nThe R bit in the first octet is defined in IETF RFC 7296 [28].\nThe Attribute Type indicating HOME_AGENT_ADDRESS is of the value 19.\nThe TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute is coded according to figure 8.2.4.2-1 and table 8.2.4.2-1.\n\n\nFigure 8.2.4.2-1: TIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute\nTable 8.2.4.2-1: TIMEOUT_PERIOD_FOR_LIVENESS_CHECK value\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The HOME_AGENT_ADDRESS attribute is shown in figure 8.2.4.1-1. The length of the HOME_AGENT_ADDRESS attribute is 16 or 20 bytes. The IPv4 Home Agent Address field is optional. The HA's IPv6 and IPv4 addresses are laid out respectively in IPv6 Home Agent Address and IPv4 Home Agent Address fields in big endian order (aka most significant byte first, or network byte order), see IETF RFC 7296 [28].",
                                    "table number": 34,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 35,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.4.2-1: TIMEOUT_PERIOD_FOR_LIVENESS_CHECK value",
                                    "table number": 36,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.2.5\tFull name for network and short name for network",
                            "text_content": "The AT_FULL_NAME_FOR_NETWORK attribute is coded according to figure 8.2.5.1-1 and table 8.2.5.1-1.\nFigure 8.2.5.1-1: AT_FULL_NAME_FOR_NETWORK attribute\nTable 8.2.5.1-1: AT_FULL_NAME_FOR_NETWORK attribute\n\nThe AT_SHORT_NAME_FOR_NETWORK attribute is coded according to figure 8.2.5.2-1 and table 8.2.5.2-1.\nFigure 8.2.5.2-1: AT_SHORT_NAME_FOR_NETWORK attribute\nTable 8.2.5.2-1: AT_SHORT_NAME_FOR_NETWORK attribute\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The AT_FULL_NAME_FOR_NETWORK attribute is coded according to figure 8.2.5.1-1 and table 8.2.5.1-1.",
                                    "table number": 37,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.5.1-1: AT_FULL_NAME_FOR_NETWORK attribute",
                                    "table number": 38,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "The AT_SHORT_NAME_FOR_NETWORK attribute is coded according to figure 8.2.5.2-1 and table 8.2.5.2-1.",
                                    "table number": 39,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.5.2-1: AT_SHORT_NAME_FOR_NETWORK attribute",
                                    "table number": 40,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.2.6\tHandling of the unknown protocol data",
                            "text_content": "If the receiving entity receives an unknown value in a recognized skippable attribute in an EAP-AKA or EAP-AKA' message, the receiving entity shall ignore the attribute and shall handle the rest of the message. The definition of skippable attribute see the RFC 4187 [33]. The receiving entity handling of the unrecognized skippable attribute is as specified in RFC 4187 [33].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.2.7\tAttributes for TWAN connection modes",
                            "text_content": "The AT_TWAN_CONN_MODE attribute is coded according to figure 8.2.7.1-1 and table 8.2.7.1-1.\nFigure 8.2.7.1-1: AT_TWAN_CONN_MODE attribute\nTable 8.2.7.1-1: AT_TWAN_CONN_MODE attribute\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The AT_TWAN_CONN_MODE attribute is coded according to figure 8.2.7.1-1 and table 8.2.7.1-1.",
                                    "table number": 41,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.7.1-1: AT_TWAN_CONN_MODE attribute",
                                    "table number": 42,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.2.8\tDevice Identity",
                            "text_content": "The AT_DEVICE_IDENTITY attribute is coded according to figure 8.2.8.1-1 and table 8.2.8.1-1.\nFigure 8.2.8.1-1: AT_DEVICE_IDENTITY attribute\nTable 8.2.8.1-1: AT_DEVICE_IDENTITY attribute\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The AT_DEVICE_IDENTITY attribute is coded according to figure 8.2.8.1-1 and table 8.2.8.1-1.",
                                    "table number": 43,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.8.1-1: AT_DEVICE_IDENTITY attribute",
                                    "table number": 44,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.2.9\tIKEv2 Notify payloads",
                            "text_content": "The BACKOFF_TIMER Notify payload is used to indicate the value of the backoff timer. The BACKOFF_TIMER Notify payload type is 41041 (see clause 8.1.2.3). The length of the BACKOFF_TIMER Notify payload is 6 octets.\nNOTE:\tThe ePDG can include a BACKOFF_TIMER Notify payload with any error type when needed.\nThe BACKOFF_TIMER Notify payload is coded according to figure 8.2.9.1-1 and table 8.2.9.1-1.\n\nFigure 8.2.9.1-1: BACKOFF_TIMER Notify payload format\nTable 8.2.9.1-1: BACKOFF_TIMER Notify payload value\n\nThe DEVICE_IDENTITY Notify payload is used to indicate the device identity. The DEVICE_IDENTITY Notify payload type is 41101 (see clause 8.1.2.3).\nThe DEVICE_IDENTITY Notify payload is coded according to figure 8.2.2.9-1 and table 8.2.2.9-1.\n\n\nFigure 8.2.9.2-1: DEVICE_IDENTITY Notify payload format\nTable 8.2.9.2-1: DEVICE_IDENTITY Notify payload value\n\nThe NBIFOM_GENERIC_CONTAINER Notify payload is used to contain the NBIFOM parameters.\nThe NBIFOM_GENERIC_CONTAINER Notify payload is coded according to figure 8.2.9.3-1 and table 8.2.9.3-1.\n\nFigure 8.2.9.3-1: NBIFOM_GENERIC_CONTAINER Notify payload\nTable 8.2.9.3-1: NBIFOM_GENERIC_CONTAINER Notify payload\n\nThe P-CSCF_RESELECTION_SUPPORT Notify payload is used to indicate the support by the UE of the P-CSCF restoration extension for untrusted WLAN.\nThe P-CSCF_RESELECTION_SUPPORT Notify payload is coded according to figure 8.2.9.4-1 and table 8.2.9.4-1.\n\nFigure 8.2.9.4-1: P-CSCF_RESELECTION_SUPPORT Notify Payload format\nTable 8.2.9.4-1: P-CSCF_RESELECTION_SUPPORT Notify Payload field values\n\nThe PTI Notify payload is used to indicate that an INFORMATIONAL request message of an ePDG-initiated modification procedure is initiated by another INFORMATIONAL request message of an UE-initiated modification procedure.\nThe PTI Notify payload is coded according to figure 8.2.9.5-1 and table 8.2.9.5-1.\n\nFigure 8.2.9.5-1: PTI Notify payload\nTable 8.2.9.5-1: PTI Notify payload\n\nThe REACTIVATION_REQUESTED_CAUSE Notify payload is used to indicate the UE to re-establish the IPSec tunnel for the corresponding PDN connection after its release.\nThe REACTIVATION_REQUESTED_CAUSE Notify payload is coded according to figure 8.2.9.6-1 and table 8.2.9.6-1.\n\nFigure 8.2.9.6-1: REACTIVATION_REQUESTED_CAUSE Notify payload format\nTable 8.2.9.6-1: REACTIVATION_REQUESTED_CAUSE Notify payload field values\n\nThe EMERGENCY_SUPPORT Notify payload is used to indicate the ePDG support of emergency service.\nThe EMERGENCY_SUPPORT Notify payload is coded according to figure 8.2.9.7-1 and table 8.2.9.7-1.\n\n\nFigure 8.2.9.7-1: EMERGENCY_SUPPORT Notify Payload format\nTable 8.2.9.7-1: EMERGENCY_SUPPORT Notify Payload field value\n\nThe EMERGENCY_CALL_NUMBERS Notify payload is used:\na)\tby the ePDG to provide local emergency call numbers for use within the country indicated by the MCC information; and\nb)\tby the UE to indicate support of retrieval of local emergency call numbers via IKEv2 procedures.\nThe EMERGENCY_CALL_NUMBERS Notify payload is coded according to figure 8.2.9.8-1 and table 8.2.9.8-1 with a minimum length of 4 octets and a maximum length of 55 octets.\n\nFigure 8.2.9.8-1: EMERGENCY_CALL_NUMBERS Notify payload\nTable 8.2.9.8-1: EMERGENCY_CALL_NUMBERS Notify payload\n\nThe format of the MCC information item is shown in figure 8.2.9.8-2. Table 8.2.9.8-2 shows the coding of the MCC in the MCC information item.\n\nFigure 8.2.9.8-2: MCC information item\nTable 8.2.9.8-2: MCC information item\n\nThe IKEV2_MULTIPLE_BEARER_PDN_CONNECTIVITY Notify payload is used to indicate UE's support of the IKEv2 multiple bearer PDN connectivity.\nThe IKEV2_MULTIPLE_BEARER_PDN_CONNECTIVITY Notify payload is coded according to figure 8.2.9.9-1 and table 8.2.9.9-1.\n\n\nFigure 8.2.9.9-1: IKEV2_MULTIPLE_BEARER_PDN_CONNECTIVITY Notify Payload format\nTable 8.2.9.9-1: IKEV2_MULTIPLE_BEARER_PDN_CONNECTIVITY Notify Payload field value\n\nThe EPS_QOS Notify payload is used to indicate EPS QoS.\nThe EPS_QOS Notify payload is coded according to figure 8.2.9.10-1 and table 8.2.9.10-1.\n\n\nFigure 8.2.9.10-1: EPS_QOS Notify payload format\nTable 8.2.9.10-1: EPS_QOS Notify payload value\n\nThe EXTENDED_EPS_QOS Notify payload is used to indicate the extended EPS QoS.\nThe EXTENDED_EPS_QOS Notify payload is coded according to figure 8.2.9.10A-1 and table 8.2.9.10A-1.\n\n\nFigure 8.2.9.10A-1: EXTENDED_EPS_QOS Notify payload format\nTable 8.2.9.10A-1: EXTENDED_EPS_QOS Notify payload value\n\nThe TFT Notify payload is used to indicate TFT.\nThe TFT Notify payload is coded according to figure 8.2.9.11-1 and table 8.2.9.11-1.\n\n\nFigure 8.2.9.11-1: TFT Notify payload format\nTable 8.2.9.11-1: TFT Notify payload value\n\nThe MODIFIED_BEARER Notify payload is used to indicate ePDG's ESP SPI of the modified child SA.\nThe MODIFIED_BEARER Notify payload is coded according to figure 8.2.9.12-1 and table 8.2.9.12-1.\n\n\nFigure 8.2.9.12-1: MODIFIED_BEARER Notify payload format\nTable 8.2.9.12-1: MODIFIED_BEARER Notify payload value\n\nThe APN_AMBR Notify payload is used to indicate the APN-AMBR.\nThe APN_AMBR Notify payload is coded according to figure 8.2.9.13-1 and table 8.2.9.13-1.\n\n\nFigure 8.2.9.13-1: APN_AMBR Notify payload format\nTable 8.2.9.13-1: APN_AMBR Notify payload value\n\nThe EXTENDED_APN_AMBR Notify payload is used to indicate the extended APN-AMBR.\nThe EXTENDED_APN_AMBR Notify payload is coded according to figure 8.2.9.14-1 and table 8.2.9.14-1.\n\n\nFigure 8.2.9.14-1: EXTENDED_APN_AMBR Notify payload format\nTable 8.2.9.14-1: EXTENDED_APN_AMBR Notify payload value\n\nThe N1_MODE_CAPABILITY Notify payload is used to indicate support of N1 mode or N1 mode capability is disabled, and to indicate the PDU session ID allocated to the PDU session associated with the IKEv2 security association being established by the IKEv2 message carrying the N1_MODE_CAPABILITY Notify payload.\nThe N1_MODE_CAPABILITY Notify payload is coded according to figure 8.2.9.15-1 and table 8.2.9.15-1.\n\n\nFigure 8.2.9.15-1: N1_MODE_CAPABILITY Notify payload format\nTable 8.2.9.15-1: N1_MODE_CAPABILITY Notify payload value\n\nThe N1_MODE_INFORMATION Notify payload is used to indicate the S-NSSAI for the PDU session associated with the IKEv2 security association established by the IKEv2 message carrying the N1_MODE_INFORMATION Notify payload.\nThe N1_MODE_INFORMATION Notify payload is coded according to figure 8.2.9.16-1 and table 8.2.9.16-1.\n\n\nFigure 8.2.9.16-1: N1_MODE_INFORMATION Notify payload format\nTable 8.2.9.16-1: N1_MODE_INFORMATION Notify payload value\n\nThe N1_MODE_S_NSSAI_PLMN_ID Notify payload is used to indicate the PLMN ID that the S-NSSAI relates to for the PDU session associated with the IKEv2 security association established by the IKEv2 message carrying the N1_MODE_S_NSSAI_PLMN_ID Notify payload.\nThe N1_MODE_S_NSSAI_PLMN_ID Notify payload is coded according to figure 8.2.9.17-1 and table 8.2.9.17-1.\n\n\nFigure 8.2.9.17-1: N1_MODE_S_NSSAI_PLMN_ID Notify payload format\nTable 8.2.9.17-1: N1_MODE_S_NSSAI_PLMN_ID Notify payload value\n\nThe DNS_SRV_SEC_INFO_IND Notify payload is used to indicate that the UE supports receiving DNS server security information.\nThe DNS_SRV_SEC_INFO_IND Notify payload is coded according to figure 8.2.9.18-1 and table 8.2.9.18-1.\n\n\nFigure 8.2.9.18-1: DNS_SRV_SEC_INFO_IND Notify payload format\nTable 8.2.9.18-1: DNS_SRV_SEC_INFO_IND Notify payload value\n\nThe DNS_SRV_SEC_INFO Notify payload is used to indicate the DNS server security information.\nThe DNS_SRV_SEC_INFO Notify payload is coded according to figure 8.2.9.19-1, figure 8.2.9.19-2, table 8.2.9.19-1 and table 8.2.9.19-2.\n\n\nFigure 8.2.9.19-1: DNS_SRV_SEC_INFO Notify payload format\nTable 8.2.9.19-1: DNS_SRV_SEC_INFO Notify payload value\n\n\nFigure 8.2.9.19-2: DNS server security parameter\nTable 8.2.9.19-2: DNS server security parameter\n\nThe ATSSS_REQUEST Notify payload is used to indicate the ATSSS request information for user plane resources of the MA PDU session associated with the IKEv2 security association established by the IKEv2 message carrying the ATSSS_REQUEST Notify payload.\nThe ATSSS_REQUEST Notify payload is coded according to figure 8.2.9.20-1 and table 8.2.9.20-1.\n\n\nFigure 8.2.9.20-1: ATSSS_REQUEST Notify payload format\nTable 8.2.9.20-1: ATSSS_REQUEST Notify payload value\n\nThe ATSSS_RESPONSE Notify payload is used to indicate the ATSSS response information for user plane resources of the MA PDU session associated with the IKEv2 security association established by the IKEv2 message carrying the ATSSS_REQUEST Notify payload.\nThe ATSSS_RESPONSE Notify payload is coded according to figure 8.2.9.21-1, figure 8.2.9.21-2 and table 8.2.9.21-1.\n\nFigure 8.2.9.21-1: ATSSS_RESPONSE Notify payload format\nFigure 8.2.9.21-2: ATSSS response information\nTable 8.2.9.21-1: ATSSS_RESPONSE Notify payload value\n\nThe HPA_INFO Notify payload is used to indicate high priority access (e.g., MPS) related parameters.\nThe HPA_INFO Notify payload is coded according to Figure 8.2.9.22-1 and Table 8.2.9.22-1.\nFigure 8.2.9.22-1: HPA_INFO Notify payload format\nTable 8.2.9.22-1: HPA_INFO Notify payload value\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 45,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.1-1: BACKOFF_TIMER Notify payload value",
                                    "table number": 46,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 47,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.2-1: DEVICE_IDENTITY Notify payload value",
                                    "table number": 48,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "The NBIFOM_GENERIC_CONTAINER Notify payload is coded according to figure 8.2.9.3-1 and table 8.2.9.3-1.",
                                    "table number": 49,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.3-1: NBIFOM_GENERIC_CONTAINER Notify payload",
                                    "table number": 50,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 51,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.4-1: P-CSCF_RESELECTION_SUPPORT Notify Payload field values",
                                    "table number": 52,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "The PTI Notify payload is coded according to figure 8.2.9.5-1 and table 8.2.9.5-1.",
                                    "table number": 53,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.5-1: PTI Notify payload",
                                    "table number": 54,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 55,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.6-1: REACTIVATION_REQUESTED_CAUSE Notify payload field values",
                                    "table number": 56,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 57,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.7-1: EMERGENCY_SUPPORT Notify Payload field value",
                                    "table number": 58,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 59,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.8-1: EMERGENCY_CALL_NUMBERS Notify payload",
                                    "table number": 60,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "The format of the MCC information item is shown in figure 8.2.9.8-2. Table 8.2.9.8-2 shows the coding of the MCC in the MCC information item.",
                                    "table number": 61,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.8-2: MCC information item",
                                    "table number": 62,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 63,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.9-1: IKEV2_MULTIPLE_BEARER_PDN_CONNECTIVITY Notify Payload field value",
                                    "table number": 64,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 65,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.10-1: EPS_QOS Notify payload value",
                                    "table number": 66,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 67,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.10A-1: EXTENDED_EPS_QOS Notify payload value",
                                    "table number": 68,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 69,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.11-1: TFT Notify payload value",
                                    "table number": 70,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 71,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.12-1: MODIFIED_BEARER Notify payload value",
                                    "table number": 72,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 73,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.13-1: APN_AMBR Notify payload value",
                                    "table number": 74,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 75,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.14-1: EXTENDED_APN_AMBR Notify payload value",
                                    "table number": 76,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 77,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.15-1: N1_MODE_CAPABILITY Notify payload value",
                                    "table number": 78,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 79,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.16-1: N1_MODE_INFORMATION Notify payload value",
                                    "table number": 80,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 81,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.17-1: N1_MODE_S_NSSAI_PLMN_ID Notify payload value",
                                    "table number": 82,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 83,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.18-1: DNS_SRV_SEC_INFO_IND Notify payload value",
                                    "table number": 84,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 85,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.19-1: DNS_SRV_SEC_INFO Notify payload value",
                                    "table number": 86,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 87,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.19-2: DNS server security parameter",
                                    "table number": 88,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 89,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.20-1: ATSSS_REQUEST Notify payload value",
                                    "table number": 90,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 91,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Figure 8.2.9.21-1: ATSSS_RESPONSE Notify payload format",
                                    "table number": 92,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.21-1: ATSSS_RESPONSE Notify payload value",
                                    "table number": 93,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "The HPA_INFO Notify payload is coded according to Figure 8.2.9.22-1 and Table 8.2.9.22-1.",
                                    "table number": 94,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.9.22-1: HPA_INFO Notify payload value",
                                    "table number": 95,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.2.10\tEAP-3GPP-LimitedService method",
                            "text_content": "The messages of EAP-3GPP-LimitedService method are EAP requests and EAP responses as specified in IETF RFC 3748 [29] clause 4.1 and use coding of the expanded method type as described in IETF RFC 3748 [29] clause 5.7.\nThe sending entity shall set value of a spare bit to zero. The receiving entity shall ignore value of a spare bit.\nEAP-Request/3GPP-LimitedService-Init-Info message is coded as specified in figure 8.2.10.2.1-1 and table 8.2.10.2.1-1.\nFigure 8.2.10.2.1-1: EAP-Request/3GPP-LimitedService-Init-Info message\nTable 8.2.10.2.1-1: EAP-Request/3GPP-LimitedService-Init-Info message\n\nEAP-Response/3GPP-LimitedService-Init-Info message is coded as specified in figure 8.2.10.2.2-1 and table 8.2.10.2.2-1.\nFigure 8.2.10.2.2-1: EAP-Response/3GPP-LimitedService-Init-Info message\nTable 8.2.10.2.2-1: EAP-Response/3GPP-LimitedService-Init-Info message\n\nEAP-Request/3GPP-LimitedService-Notif message is coded as specified in figure 8.2.10.2.3-1 and table 8.2.10.2.3-1.\nFigure 8.2.10.2.3-1: EAP-Request/3GPP-LimitedService-Notif message\nTable 8.2.10.2.3-1: EAP-Request/3GPP-LimitedService-Notif message\n\nEAP-Response/3GPP-LimitedService-Notif message is coded as specified in figure 8.2.10.2.4-1 and table 8.2.10.2.4-1.\nFigure 8.2.10.2.4-1: EAP-Response/3GPP-LimitedService-Notif message\nTable 8.2.10.2.4-1: EAP-Response/3GPP-LimitedService-Notif message\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "EAP-Request/3GPP-LimitedService-Init-Info message is coded as specified in figure 8.2.10.2.1-1 and table 8.2.10.2.1-1.",
                                    "table number": 96,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.10.2.1-1: EAP-Request/3GPP-LimitedService-Init-Info message",
                                    "table number": 97,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "EAP-Response/3GPP-LimitedService-Init-Info message is coded as specified in figure 8.2.10.2.2-1 and table 8.2.10.2.2-1.",
                                    "table number": 98,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.10.2.2-1: EAP-Response/3GPP-LimitedService-Init-Info message",
                                    "table number": 99,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "EAP-Request/3GPP-LimitedService-Notif message is coded as specified in figure 8.2.10.2.3-1 and table 8.2.10.2.3-1.",
                                    "table number": 100,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.10.2.3-1: EAP-Request/3GPP-LimitedService-Notif message",
                                    "table number": 101,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "EAP-Response/3GPP-LimitedService-Notif message is coded as specified in figure 8.2.10.2.4-1 and table 8.2.10.2.4-1.",
                                    "table number": 102,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.10.2.4-1: EAP-Response/3GPP-LimitedService-Notif message",
                                    "table number": 103,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "8.2.11\tAT_HPA_INFO attribute",
                            "text_content": "The AT_HPA_INFO attribute is coded according to Figure 8.2.11-1 and Table 8.2.11-1.\nThe AT_HPA_INFO attribute conveys the UE's priority subscription information from the USIM file as specified in 3GPP TS 31.102 [35].\nFigure 8.2.11-1: AT_HPA_INFO attribute\n\nTable 8.2.11-1: AT_HPA_INFO attribute\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The AT_HPA_INFO attribute conveys the UE's priority subscription information from the USIM file as specified in 3GPP TS 31.102 [35].",
                                    "table number": 104,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 8.2.11-1: AT_HPA_INFO attribute",
                                    "table number": 105,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "title": "A.1\tScope of signalling flows",
            "description": "This annex gives examples of signalling flows for mobility between 3GPP and non-3GPP systems. These signalling flows provide as example detailed information on Network Discovery and Selection aspects involving the use of ANDSF.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.2\tSignalling flow for inter-system change between 3GPP access network and non-3GPP access network",
            "description": "Figure A1 below shows an inter-system change procedure between 3GPP access network and non-3GPP access network using information obtained from ANDSF.\nIn this example the UE uses DHCP query to obtain the IP address of the ANDSF.\nIn this example flow, the communication between the UE and ANDSF does not imply use of any specific protocol.\nThe steps involved in inter-system change between 3GPP access network and non-3GPP access network are as follows.\n\nThe figure depicts a procedure for inter-system change between 3GPP access and non-3GPP using ANDSF (Access and Non-3GPP Switching Function). It illustrates the process of changing between the two systems, highlighting the use of ANDSF to ensure compatibility and interoperability.\nFigure A1. Procedure for Inter-system change between 3GPP access and non-3GPP using ANDSF\n1.\tInitial connectivity\nThe UE is connected to 3GPP network. The current applications are supported over the 3GPP access network.\nNOTE:\tThe procedure remains the same if the UE is initially connected to non-3GPP access network and wants to change to 3GPP access network.\n2.\tPre-provisioned policies\nThe inter-system mobility policy is pre-provisioned on the UE. Based on pre-provisioned operator policies the UE has preference for different non-3GPP networks such as WLAN, and WiMAX. The UE can select these access networks when they are available.\n3.\tANDSF Discovery\nANDSF discovery is performed as described in clause 6.8.2.2.1. The UE can discover ANDSF using DHCP query options as specified in IETF RFC 6153 [37], where ANDSF may be identified with a specific sub-option code. Optionally, the home operator can use OMA-DM's bootstrap mechanism as specified in OMA-ERELD-DM-V1_2 [39] to provide ANDSF information and security parameters for application layer authentication. Transport security is ensured by establishing an https tunnel between the UE and ANDSF,\n4.\tPolicy Update based on Network Triggers\nBased on network triggers the ANDSF sends an updated inter-system mobility policy to the UE. The inter-system mobility policy includes validity conditions, i.e. conditions indicating when the policy is valid. Such conditions can include time duration, location area, etc.\n5.\tEvaluate which non-3GPP networks to discover\nThe inter-system mobility policies specify the access networks that the UE can select; the UE has both WLAN and WiMAX radios. In this case, the inter-system mobility policy provided by the operator allows the UE to select either WLAN or WiMAX networks under all conditions. The UE, taking into account of the UE's local policy, e.g. user preference settings, access history, obtains information about availability of both WLAN and WiMAX access networks in its vicinity.\n6.\tAccess Network Information Request\nThe UE sends a request to ANDSF to get information about available access networks. The UE also includes its location information in the request. ANDSF can limit the information sent to UE based on internal settings.\n7.\tAccess Network Information Response\nThe ANDSF sends a response to the UE which includes the list of available access networks types (in order of operator preferences), access network identifier and PLMN identifier. In this case the ANDSF responds with availability of both WLAN and WiMAX network in the vicinity of the UE.\n8.\tEvaluate candidate non-3GPP networks\nBased on the received information and UE's local policy, the UE evaluates if it is within the coverage area of the available access networks in the order of preferences. In this case,based on the history and radio quality of WiMAX, the UE prefers WiMAX over WLAN access type. The UE powers on the WiMAX radio and checks for the presence of WiMAX network. The UE can listen to WiMAX broadcast messages (uplink/downlink channel data messages) and determines the presence of WiMAX network. Since the WiMAX network is the preferred network and since the UE has verified the presence of WiMAX network, the UE does not check for presence of WLAN network.\n9.\tNon-3GPP Network Selection\nThe UE selects the most preferred available access network for inter-system mobility. In this case the UE selects the WiMAX access network.\n10.\tInter-system change Procedure\nThe UE initiates inter-system change procedure to the selected non-3GPP access network. The details of the inter-system change procedure are described elsewhere, see 3GPP TS 23.402 [6].\nThis annex describes the recommended assignment procedure of Access Network Identities within 3GPP.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "B.1\tAccess Network Identities",
            "description": "According to 3GPP TS 23.003 [3] the encoding of the Access Network Identity is specified within 3GPP, but the Access Network Identity definition for each non-3GPP access network is under the responsibility of the corresponding standardisation organisation respectively.\nIf a standardisation organisation for a non-3GPP access network determines they need to define a new Access Network Identity Prefix or additional ANID strings, they can contact the 3GPP TSG-CT WG 1 via a Liaison Statement and indicate the specific values of the Access Network Identity Prefixes or the specific values of, or construction principles for, the additional ANID strings to be specified by 3GPP and give reference to the corresponding specification(s) of the requesting organisation. 3GPP TSG CT WG 1 will then specify the values for the Access Network Identities by updating Table 8.1.1.2 in this specification and inform the requesting standardisation organisation.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "C.1\tScope of ANDSF Example",
            "description": "This Annex gives an example of organization of ANDSF database and how it can be used to discover access network information. In this example the UE is in 3GPP network and is trying to discover available WiMAX networks. The ANDSF database is provided by the 3GPP operator with PLMN = PLMN_3GPP.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "C.2\tOrganization of ANDSF Coverage Map for WiMAX Network discovery",
            "description": "Table C1 illustrates the organization of ANDSF database for discovering WiMAX and WiFi networks. The ANDSF database provides the coverage mapping information for WiMAX and WiFi networks based on 3GPP cell identifiers. In this example the UE_Location can be specified either in terms of 3GPP parameters (PLMN + Cell Identifier) or in terms of geo spatial co-ordinates.\nTable C1: ANDSF Database Organization for PLMN = PLMN_3GPP\n\nFor WiMAX network the database provides information about WiMAX NSP and NAP that provide coverage in respective 3GPP cells. Thus for example in 3GPP Cell_1, WiMAX Service provider NSP_1 provides service to WiMAX radio access providers NAP_1 and NAP-2. Similarly WiMAX Service Provider NSP_2 provides service to Network access providers NAP-2 and NAP_3 as well. Similarly in 3GPP Cell_2 WiMAX Network Service Provider NSP_2 provides service to network Access Provider NAP_3. Further it can be seen that no WiMAX coverage is available in 3GPP cell Cell_3.\n",
            "summary": "",
            "tables": [
                {
                    "description": "Table C1: ANDSF Database Organization for PLMN = PLMN_3GPP",
                    "table number": 106,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "C.3\tParameters in Pull mode",
            "description": "The UE is currently in 3GPP network. The UE sends a query to OMA ANDSF server as follows:\nANDSF_Query ( UE_Location, AccessNetworkType=WiMAX )\nThe UE specifies the UE_Location information in terms of current 3GPP Cell Id (e.g. Cell_2)\nOn receipt of the query message the ANDSF looks up the UE_Location (Cell_2) in the ANDSF database and searches for a prospective WiMAX entry. In this case the ANDSF retrieves WiMAX Service provider identifier (NSP-ID) NSP_2 and WiMAX Network Access Provider Identifier (NAP-ID) NAP_3. The ANDSF retrieves the network parameters for this combination. The ANDSF fills these parameters in the WNDS MO and sends the information back to the UE.\nANDSF_Response ( UE_Location, =WIMAXNDS).\nThis annex describes the possible cases of mismatch between the statically configured mobility mechanisms in the UE and in the EPC as shown in table D1. Additionally the table shows whether the UE would be able to access EPC services as a consequence of the mismatch.\n\nTable D1: Mismatch of static configuration of mobility mechanism in the UE and in the network\n\nThe flow diagrams in figure E-1 and figure E-2 show examples of the procedures that the UE can follow in order to establish a PDN connection based on information available to the UE about the authentication method, received or pre-configured access network trust relationship information or received or preconfigured IP mobility mode selection information.\nThe following symbols are used:\nAN_TRUST\ttrust relationship between the non-3GPP access network and the 3GPP EPC, considered to be applicable by the UE\nIPMM\tIP mobility mode, considered applicable by the UE\n\nInitially, at the entry to flow chart the UE has established contact with the non-3GPP access network, but the UE does not know whether it is in a trusted or untrusted non-3GPP IP access access network.\n\nThe figure depicts a series of procedures to be followed by the UE (User Equipment) depending on the received and preconfigured information. Part 1 of the procedures involves the UE receiving the preconfigured information and then following the instructions to perform the necessary actions.\nFigure E-1. Procedures to be followed by the UE depending on received and preconfigured information - part 1\n\nThe figure depicts a series of procedures to be followed by the UE (User Equipment) depending on the received and preconfigured information. Part 2 of the figure illustrates the steps for the UE to follow when receiving preconfigured information.\nFigure E-2. Procedures to be followed by the UE depending on received and preconfigured information - part 2\n\n",
            "summary": "",
            "tables": [
                {
                    "description": "Table D1: Mismatch of static configuration of mobility mechanism in the UE and in the network",
                    "table number": 107,
                    "summary": "",
                    "name": ""
                }
            ],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "F.1\tGeneral",
            "description": "This annex specifies protocol for access to EPC via restrictive non-3GPP access network.\nThe procedures are specified for UE and ePDG. The UE may support the procedures for access to EPC via restrictive non-3GPP access network. The ePDG may support the procedures for access to EPC via restrictive non-3GPP access network.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "F.2\tUE – EPC network protocols",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "F.2.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "In order to access to EPC via restrictive non-3GPP access network, the UE and the ePDG shall establish a firewall traversal tunnel (FTT) using the UE requested FTT establishment procedure according to clause F.2.2. Once the FTT is established, the UE shall initiate establishment of an IPSec tunnel via an IKEv2 protocol exchange according to IETF RFC 7296 [28].\nThe UE and the ePDG shall construct the IKEv2 messages according to clause 7 and according to clause F.2.3.\nThe UE and the ePDG shall send the IKEv2 messages using the IKEv2 message transport procedure according to clause F.2.2.3.\nThe UE and the ePDG shall send the encapsulating security payloads using the encapsulating security payload transport procedure according to clause F.2.2.4.\nIf the UE has not sent a message over the FTT in the last FTT KAT seconds, the UE shall perform the UE requested keep-alive procedure according to clause F.2.2.5.\nWhen all IKEv2 security associations are closed, the UE shall perform the UE requested FTT release procedure according to clause F.2.2.6.\nWhen all IKEv2 security associations are closed, the network can perform the network requested FTT release procedure according to clause F.2.2.7.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "F.2.2\tFTT protocol",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "F.2.2.1\tGeneral",
                            "text_content": "The FTT protocol consists of the UE requested FTT establishment procedure, the IKEv2 message transport procedure, the encapsulating security payload transport procedure, the UE requested keep-alive procedure, the UE requested FTT release procedure and the network requested FTT release procedure.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "F.2.2.2\tUE requested FTT establishment procedure",
                            "text_content": "The purpose of the UE requested FTT establishment procedure is to establish an FTT between the UE and the ePDG.\nIf the UE is not configured with an HTTP proxy address, the UE shall follow the procedures in clause F.2.2.2.3.\nIf the UE is configured with an HTTP proxy address, the UE shall follow the procedures in clause F.2.2.2.4.\nNOTE:\tUE configuration of an HTTP proxy address is out of scope of 3GPP.\nIn order to establish an FTT, the UE shall establish a TCP connection to the ePDG address and destination port 443.\nIf the TCP connection establishment is successful, the UE shall establish a TLS connection over the TCP connection according to the TLS profile specified in 3GPP TS 33.310 [65] annex E. If the ePDG address is a FQDN, the UE shall include a TLS extension of type \"server_name\" in the TLS client hello message according to the TLS profile specified in 3GPP TS 33.310 [65] annex E.\nThe ePDG shall handle the TCP connection setup and shall handle the TLS connection establishment according to the TLS profile specified in 3GPP TS 33.310 [65] annex E.\nIf the UE is configured with HTTP proxy address, in order to establish an FTT, the UE shall send HTTP CONNECT request to the HTTP proxy address according to IETF RFC 2817 [53]. The UE shall populate Request-URI of the HTTP CONNECT request with the ePDG address and port 443.\nUpon receiving HTTP 2xx response to HTTP CONNECT request, the UE shall establish TLS connection according to the TLS profile specified in 3GPP TS 33.310 [65] annex E over the TCP connection used for the HTTP CONNECT request transport. If the ePDG address is a FQDN, the UE shall include a TLS extension of type \"server_name\" in the TLS client hello message according to the TLS profile specified in 3GPP TS 33.310 [65] annex E.\nThe ePDG shall handle the TCP connection setup and the TLS connection establishment according to the TLS profile specified in 3GPP TS 33.310 [65] annex E.\nWhen TLS Finished message is sent over the TCP connection according to the TLS profile specified in 3GPP TS 33.310 [65] annex E, the ePDG shall use the connection as the FTT.\nWhen valid TLS Finished message is received over the TCP connection, the UE shall use the connection as the FTT.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "F.2.2.3\tIKEv2 message transport procedure",
                            "text_content": "The purpose of the IKEv2 message transport procedure is to transport an IKEv2 message over an FTT.\nIn order to send an IKEv2 message, the UE or the ePDG shall create an IKEv2 envelope as described in clause F.3.2.2, shall populate the Non-ESP marker field with zero value and shall populate the IKEv2 message field of the IKEv2 envelope with the IKEv2 message.\nThe UE shall send the IKEv2 envelope as TLS application data according to the TLS profile specified in 3GPP TS 33.310 [65] annex E:\n-\tif the IKEv2 message is an IKEv2 request, over an FTT of the UE; and\n-\tif the IKEv2 message is an IKEv2 response of an IKEv2 request, over the FTT over which the IKEv2 request was received.\nThe ePDG shall send the IKEv2 envelope as TLS application data according to the TLS profile specified in 3GPP TS 33.310 [65] annex E:\n-\tif the IKEv2 message is an IKEv2 request of an IKEv2 security association, over the FTT associated with the IKEv2 security association; and\n-\tif the IKEv2 message is an IKEv2 response of an IKEv2 request, over the FTT over which the IKEv2 request was received.\nUpon receiving the IKEv2 envelope as TLS application data over the FTT, the ePDG or the UE shall extract the IKEv2 message from the IKEv2 envelope as described in clause F.3.2.2 and shall handle it according to IETF RFC 7296 [28]. If the IKEv2 message is a validated IKEv2 packet, the ePDG shall associate the FTT with the IKEv2 security association of the validated packet (replacing any FTT previously associated with the IKEv2 security association).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "F.2.2.4\tEncapsulating security payload transport procedure",
                            "text_content": "The purpose of the encapsulating security payload transport procedure is to transport an encapsulating security payload over an FTT.\nIn order to send an encapsulating security payload, the UE or the ePDG shall create a ESP envelope as described in clause F.3.2.3 and shall populate the ESP message field of the ESP envelope with the encapsulating security payload.\nThe UE shall send the ESP envelope as TLS application data according to the TLS profile specified in 3GPP TS 33.310 [65] annex E over an FTT of the UE.\nThe ePDG shall send the ESP envelope as TLS application data according to the TLS profile specified in 3GPP TS 33.310 [65] annex E over the FTT associated with the IKEv2 security association which established the child security association of the encapsulating security payload.\nUpon receiving the ESP envelope over the FTT, the ePDG or the UE shall extract the encapsulating security payload from the ESP envelope as described in clause F.3.2.3 and shall handle it according to IETF RFC 4303 [32].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "F.2.2.5\tUE requested keep-alive procedure",
                            "text_content": "The purpose of the UE requested keep-alive procedure is to refresh binding in firewall (possibly including NAT) deployed between the restrictive non-3GPP access network and the EPC.\nIn order to send a keep-alive, the UE shall create a keep-alive envelope as described in clause F.3.2.4.\nThe UE shall send the keep-alive envelope as TLS application data according to the TLS profile specified in 3GPP TS 33.310 [65] annex E over an FTT of the UE.\nThe ePDG shall discard any keep-alive envelope received over the FTT.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "F.2.2.6\tUE requested FTT release procedure",
                            "text_content": "The purpose of the UE requested FTT release procedure is to release an FTT when all IKEv2 security associations are closed.\nIn order to release the FTT, the UE shall send TLS close_notify alert according to the TLS profile specified in 3GPP TS 33.310 [65] annex E.\nThe ePDG shall handle the TLS close_notify alert according to the TLS profile specified in 3GPP TS 33.310 [65] annex E.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "F.2.2.7\tNetwork requested FTT release procedure",
                            "text_content": "The purpose of the network requested FTT release procedure is to release an FTT when all IKEv2 security associations are closed.\nIn order to release the FTT, the ePDG shall send TLS close_notify alert according to the TLS profile specified in 3GPP TS 33.310 [r33310] annex E.\nThe UE shall handle the TLS close_notify alert according to the TLS profile specified in 3GPP TS 33.310 [65] annex E.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "F.2.3\tAdditional IKEv2 procedures when FTT is used",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "F.2.3.1\tFTT KAT negotiation during tunnel establishment",
                            "text_content": "The UE shall include the FTT_KAT configuration attribute according to clause F.3.3.1 in the IKEv2 CFG_REQUEST configuration payload of the IKE_AUTH request message sent via FTT.\nIf the FTT_KAT configuration attribute is included in the IKEv2 CFG_REQUEST configuration payload, ePDG shall include the FTT_KAT configuration attribute according to clause F.3.3.1 in the IKEv2 CFG_REPLY configuration payload.\nIf the FTT_KAT configuration attribute is not included in the IKEv2 CFG_REPLY configuration payload, the UE shall determine the firewall traversal tunnel keep-alive time (FTT KAT) as a random number uniformly distributed between lower bound and higher bound. The default value for lower bound is 672 seconds and the default value for higher bound is 840 seconds.\nIf the FTT_KAT configuration attribute is included in the IKEv2 CFG_REPLY configuration payload, the UE shall set the FTT KAT to the value of the Keep-alive time field of the FTT_KAT configuration attribute.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "F.3\tPDUs and parameters specific to the present annex",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "F.3.1\tVoid",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "F.3.2\tMessage types of FTT messages",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "F.3.2.1\tGeneric FTT envelope",
                            "text_content": "Generic FTT envelope is coded according to figure F.3.2.1-1 and table F.3.2.1-1.\nFigure F.3.2.1-1: Generic FTT envelope\nTable F.3.2.1-1: Generic FTT envelope\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Generic FTT envelope is coded according to figure F.3.2.1-1 and table F.3.2.1-1.",
                                    "table number": 108,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table F.3.2.1-1: Generic FTT envelope",
                                    "table number": 109,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "F.3.2.2\tIKEv2 envelope",
                            "text_content": "IKEv2 envelope is coded according to figure F.3.2.2-1 and table F.3.2.2-1.\nFigure F.3.2.2-1: IKEv2 envelope\nTable F.3.2.2-1: IKEv2 envelope\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "IKEv2 envelope is coded according to figure F.3.2.2-1 and table F.3.2.2-1.",
                                    "table number": 110,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table F.3.2.2-1: IKEv2 envelope",
                                    "table number": 111,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "F.3.2.3\tESP envelope",
                            "text_content": "ESP envelope is coded according to figure F.3.2.3-1 and table F.3.2.3-1.\nFigure F.3.2.3-1: ESP envelope\nTable F.3.2.3-1: ESP envelope\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "ESP envelope is coded according to figure F.3.2.3-1 and table F.3.2.3-1.",
                                    "table number": 112,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table F.3.2.3-1: ESP envelope",
                                    "table number": 113,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "F.3.2.4\tKeep-alive envelope",
                            "text_content": "Keep-alive envelope is coded according to figure F.3.2.4-1 and table F.3.2.4-1.\nFigure F.3.2.4-1: keep-alive envelope\nTable F.3.2.4-1: keep-alive envelope\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Keep-alive envelope is coded according to figure F.3.2.4-1 and table F.3.2.4-1.",
                                    "table number": 114,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table F.3.2.4-1: keep-alive envelope",
                                    "table number": 115,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "F.3.3\tIKEv2 configuration attributes",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "F.3.3.1\tFTT_KAT configuration attribute",
                            "text_content": "The FTT_KAT configuration attribute is coded according to figure F.3.3.1-1 and table F.3.3.1-1.\nFigure F.3.3.1-1: FTT_KAT configuration attribute\nTable F.3.3.1-1: FTT_KAT configuration attribute\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The FTT_KAT configuration attribute is coded according to figure F.3.3.1-1 and table F.3.3.1-1.",
                                    "table number": 116,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table F.3.3.1-1: FTT_KAT configuration attribute",
                                    "table number": 117,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "title": "G.1\tGeneral",
            "description": "This annex contains information needed for registrations with IANA.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "G.2\tEAP-AKA attributes",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "G.2.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause contains information needed for registrations of EAP-AKA attributes with IANA.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.2.2\tAT_TWAN_CONN_MODE EAP-AKA attribute",
                    "description": "",
                    "summary": "",
                    "text_content": "In order to register the AT_TWAN_CONN_MODE attribute, the following information will be inserted in form at http://www.iana.org/cgi-bin/assignments.pl:\nContact name:\n<MCC Name>\nContact Email:\n<MCC email>\nWhat type of assignment/registration are you requesting?\nNew item in the \"Attribute Types (Skippable Attributes 128-255)\" of the \"EAP-AKA and EAP-SIM Parameters\" as shown at http://www.iana.org/assignments/eapsimaka-numbers/eapsimaka-numbers.xml#eapsimaka-numbers-3 and as specified in RFC 4187.\nWhich registry are you requesting this assignment/registration be made in?\nThe \"Attribute Types (Skippable Attributes 128-255)\" of the \"EAP-AKA and EAP-SIM Parameters\" as shown at http://www.iana.org/assignments/eapsimaka-numbers/eapsimaka-numbers.xml#eapsimaka-numbers-3 and as specified in RFC 4187.\nIf possible, please give a brief description of why you need this assignment/registration:\nFurther information needs to be provided during authentication using EAP-AKA'.\nAdditional Information. Please include a reference to the specification or RFC (if available) that defines this number or name space:\nRFC 4187 defines the registry for the \"Attribute Types (Skippable Attributes 128-255)\" of the \"EAP-AKA and EAP-SIM Parameters\".\nThe following attribute is requested to be registered:\n-\tnumbering space: EAP-AKA and EAP-SIM Parameters, Attribute Types (Skippable Attributes 128-255)\n-\tattribute description: AT_TWAN_CONN_MODE\n-\treference to specification where the attribute is described: http://www.3gpp.org/ftp/Specs/html-info/24302.htm\n-\tattribute type: (number to be assigned by IANA)\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.2.3\tAT_DEVICE_IDENTITY EAP-AKA attribute",
                    "description": "",
                    "summary": "",
                    "text_content": "In order to register the AT_DEVICE_IDENTITY attribute, the following information will be inserted in form at http://www.iana.org/cgi-bin/assignments.pl:\nContact name:\n<MCC Name>\nContact Email:\n<MCC email>\nWhat type of assignment/registration are you requesting?\nNew item in the \"Attribute Types (Skippable Attributes 128-255)\" of the \"EAP-AKA and EAP-SIM Parameters\" as shown at http://www.iana.org/assignments/eapsimaka-numbers/eapsimaka-numbers.xml#eapsimaka-numbers-3 and as specified in RFC 4187.\nWhich registry are you requesting this assignment/registration be made in?\nThe \"Attribute Types (Skippable Attributes 128-255)\" of the \"EAP-AKA and EAP-SIM Parameters\" as shown at http://www.iana.org/assignments/eapsimaka-numbers/eapsimaka-numbers.xml#eapsimaka-numbers-3 and as specified in RFC 4187.\nIf possible, please give a brief description of why you need this assignment/registration:\nFurther information needs to be provided during authentication using EAP-AKA'.\nAdditional Information. Please include a reference to the specification or RFC (if available) that defines this number or name space:\nRFC 4187 defines the registry for the \"Attribute Types (Skippable Attributes 128-255)\" of the \"EAP-AKA and EAP-SIM Parameters\".\nThe following attribute is requested to be registered:\n-\tnumbering space: EAP-AKA and EAP-SIM Parameters, Attribute Types (Skippable Attributes 128-255)\n-\tattribute description: AT_DEVICE_IDENTITY\n-\treference to specification where the attribute is described: http://www.3gpp.org/ftp/Specs/html-info/24302.htm\n-\tattribute type: (number to be assigned by IANA)\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.2.4\tAT_HPA_INFO EAP-AKA attribute",
                    "description": "",
                    "summary": "",
                    "text_content": "Editor’s note [WI: MPS_WLAN, CR: 0769]:\tMCC is requested to register this attribute with IANA when the MPS_WLAN work item progress reaches 100%.\nIn order to register the AT_HPA_INFO attribute, the following information will be inserted in form at http://www.iana.org/cgi-bin/assignments.pl:\nContact name:\n<MCC Name>\nContact Email:\n<MCC email>\nWhat type of assignment/registration are you requesting?\nNew item in the \"Attribute Types (Skippable Attributes 128-255)\" of the \"EAP-AKA and EAP-SIM Parameters\" as shown at http://www.iana.org/assignments/eapsimaka-numbers/eapsimaka-numbers.xml#eapsimaka-numbers-3 and as specified in IETF RFC 4187.\nWhich registry are you requesting this assignment/registration be made in?\nThe \"Attribute Types (Skippable Attributes 128-255)\" of the \"EAP-AKA and EAP-SIM Parameters\" as shown at http://www.iana.org/assignments/eapsimaka-numbers/eapsimaka-numbers.xml#eapsimaka-numbers-3 and as specified in IETF RFC 4187.\nIf possible, please give a brief description of why you need this assignment/registration:\nUE's priority subscription information needs to be provided during authentication using EAP-AKA'.\nAdditional Information. Please include a reference to the specification or RFC (if available) that defines this number or name space:\nIETF RFC 4187 defines the registry for the \"Attribute Types (Skippable Attributes 128-255)\" of the \"EAP-AKA and EAP-SIM Parameters\".\nThe following attribute is requested to be registered:\n-\tnumbering space: EAP-AKA and EAP-SIM Parameters, Attribute Types (Skippable Attributes 128-255)\n-\tattribute description: AT_HPA_INFO\n-\treference to specification where the attribute is described: http://www.3gpp.org/ftp/Specs/html-info/24302.htm\n-\tattribute type: (number to be assigned by IANA)\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "G.3\tIKEv2 configuration attributes",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "G.3.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "This clause contains information needed for registrations of IKEv2 configuration attributes with IANA.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "G.3.2\tTIMEOUT_PERIOD_FOR_LIVENESS_CHECK attribute",
                    "description": "",
                    "summary": "",
                    "text_content": "In order to register the TIMEOUT_PERIOD_FOR_LIVENESS_CHECK IKEv2 attribute, the following information will be inserted in form at http://www.iana.org/cgi-bin/assignments.pl:\nContact name:\n<MCC Name>\nContact Email:\n<MCC email>\nWhat type of assignment/registration are you requesting?\nNew item in the \"IKEv2 Configuration Payload Attribute Types\" of the \"Internet Key Exchange Version 2 (IKEv2) Parameters\" as shown at http://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml#ikev2-parameters-21 and as specified in IETF RFC 4306 [70A] and updated by IETF RFC 7296 [28] and IETF RFC 7296 [70B].\nWhich registry are you requesting this assignment/registration be made in?\nThe \"IKEv2 Configuration Payload Attribute Types\" of the \"Internet Key Exchange Version 2 (IKEv2) Parameters\" as shown at http://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml#ikev2-parameters-21 and as specified in IETF RFC 4306 [70A] and updated by IETF RFC 7296 [28] and IETF RFC 7296 [70B].\nIf possible, please give a brief description of why you need this assignment/registration:\nThis IKEv2 attribute is used to provide configuration for performing the liveness checks.\nAdditional Information. Please include a reference to the specification or RFC (if available) that defines this number or name space:\nIETF RFC 4306 [70A] defines the registry for the \"IKEv2 Configuration Payload Attribute Types\". IETF RFC 7296 [70B] and IETF RFC 7296 [28] refer to IETF RFC 4306 for the definition of the registry.\nThe following attribute is requested to be registered:\n-\tvalue: (number to be assigned by IANA)\n-\tattribute type: TIMEOUT_PERIOD_FOR_LIVENESS_CHECK\n-\tmulti-valued: no\n-\tlength: 4 octets\n-\treference: http://www.3gpp.org/ftp/Specs/html-info/24302.htm\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "H.1\tGeneral",
            "description": "This clause describes the structure and contents of the generic container used as the payload in the 3GPP Cellular Network ANQP-element specified in IEEE Std 802.11 [57].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "H.2\tGeneral structure",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "H.2.1\tStructure",
                    "description": "",
                    "summary": "",
                    "text_content": "The general structure of the generic container is shown in figure H.2.1-1.\n\nFigure H.2.1-1 – Structure of IEEE Std 802.11 Generic Container\n",
                    "tables": [
                        {
                            "description": "The general structure of the generic container is shown in figure H.2.1-1.",
                            "table number": 118,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "H.2.2\tGeneric container User Data (GUD)",
                    "description": "",
                    "summary": "",
                    "text_content": "Indicates the protocol version of the generic container\n00000000\tVersion 1\n00000001\nTo\n11111111\tReserved\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "H.2.3\tUser Data Header Length (UDHL)",
                    "description": "",
                    "summary": "",
                    "text_content": "Indicates the number of octets in the generic container after the UDHL. This indication is encoded in binary format.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "H.2.4\tInformation Elements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "H.2.4.1\tInformation Element Identity (IEI)",
                            "text_content": "Indicates the information element identity. The following values for IEI are defined in this version of the specification:\n00000000\tPLMN List\n00000001\tPLMN List with S2a connectivity\n00000010\tPLMN List with trusted 5G connectivity\n00000011\tPLMN List with trusted 5G connectivity-without-NAS\n00000100\tPLMN List with AAA connectivity to 5GC\n00000101\nTo\n00011111\tReserved\n00100000\tSNPN List with trusted 5G connectivity\n00100001\tSNPN List with AAA connectivity to 5GC\n00100010\tSNPN List with trusted 5G connectivity-without-NAS\n00100011\nTo\n11111111\tReserved\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "H.2.4.2\tPLMN List IE",
                            "text_content": "The PLMN List information element is used by a WLAN to indicate the PLMNs, for which the WLAN supports AAA connectivity to EPC, see clause 6.3.12.1 in 3GPP TS 23.501 [6A]. The format of the PLMN List information element coded according to 3GPP TS 24.007 [48] clause 11.2.2.1 is shown in figure H.2.4.2-1.\nFigure H.2.4.2-1: PLMN List information element\n\nFigure H.2.4.2-1a: PLMN List\nThe \"Number of PLMNs\" (octet 3) contains the number of PLMN information items in the list. Bit 7 of octet 3 is the most significant bit and bit 0 of octet 3 the least significant bit.\nThe format of the PLMN information item according to 3GPP TS 24.007 [48] clause 112.2.1 is shown in figure H.2.4.2-2:\n\nFigure H.2.4.2-2: PLMN information item of the PLMN List\nTable H.2.4.2-1 shows the coding of the MCC and MNC in the PLMN information item.\nTable H.2.4.2-1: PLMN information item of PLMN List\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The PLMN List information element is used by a WLAN to indicate the PLMNs, for which the WLAN supports AAA connectivity to EPC, see clause 6.3.12.1 in 3GPP TS 23.501 [6A]. The format of the PLMN List information element coded according to 3GPP TS 24.007 [48] clause 11.2.2.1 is shown in figure H.2.4.2-1.",
                                    "table number": 119,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 120,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "The format of the PLMN information item according to 3GPP TS 24.007 [48] clause 112.2.1 is shown in figure H.2.4.2-2:",
                                    "table number": 121,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table H.2.4.2-1: PLMN information item of PLMN List",
                                    "table number": 122,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "H.2.4.3\tPLMN List with S2a connectivity IE",
                            "text_content": "The PLMN List with S2a connectivity information element is used by the WLAN to indicate the PLMNs to which the WLAN provides S2a connectivity.\nThe format of the PLMN List with S2a connectivity information element is shown in Figure H.2.4.3-1.\nFigure H.2.4.3-1: PLMN List with S2a connectivity information element\nThe format of the PLMN List is identical to the format of the PLMN List defined in figure H.2.4.2-1a.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The format of the PLMN List with S2a connectivity information element is shown in Figure H.2.4.3-1.",
                                    "table number": 123,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "H.2.4.4\tPLMN List with trusted 5G connectivity IE",
                            "text_content": "The PLMN List with trusted 5G connectivity information element is used by the WLAN to indicate the PLMNs for which the WLAN provides connectivity to a 5GCN, using trusted non-3GPP access.\nThe format of the PLMN List with trusted 5G connectivity information element is shown in Figure H.2.4.4-1.\nFigure H.2.4.4-1: PLMN List with trusted 5G connectivity information element\nThe format of the PLMN List is identical to the format of the PLMN List defined in figure H.2.4.2-1a.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The format of the PLMN List with trusted 5G connectivity information element is shown in Figure H.2.4.4-1.",
                                    "table number": 124,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "H.2.4.5\tPLMN List with trusted 5G connectivity-without-NAS IE",
                            "text_content": "The PLMN List with trusted 5G connectivity-without-NAS information element is used by the WLAN to indicate the PLMNs for which the WLAN provides connectivity to a 5GCN, for devices without NAS capability, using trusted non-3GPP access.\nThe format of the PLMN List with trusted 5G connectivity-without-NAS information element is shown in Figure H.2.4.5-1.\nFigure H.2.4.5-1: PLMN List with trusted 5G connectivity-without-NAS information element\nThe format of the PLMN List is identical to the format of the PLMN List defined in figure H.2.4.2-1a.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The format of the PLMN List with trusted 5G connectivity-without-NAS information element is shown in Figure H.2.4.5-1.",
                                    "table number": 125,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "H.2.4.6\tPLMN List with AAA connectivity to 5GC IE",
                            "text_content": "The PLMN List with AAA connectivity to 5GC information element is used by the WLAN to indicate the PLMNs, which support NSWO in 5GS as specified in annex S of 3GPP TS 33.501 [78], for a UE served by the WLAN.\nThe format of the PLMN List with AAA connectivity to 5GC information element is shown in Figure H.2.4.6-1.\nFigure H.2.4.6-1: PLMN List with AAA connectivity to 5GC information element\nThe format of the PLMN List is identical to the format of the PLMN List information element defined in figure H.2.4.2-1a.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The format of the PLMN List with AAA connectivity to 5GC information element is shown in Figure H.2.4.6-1.",
                                    "table number": 126,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "H.2.4.7\tSNPN List with trusted 5G Connectivity IE",
                            "text_content": "The SNPN List with trusted 5G Connectivity information element is used by the network to indicate the SNPNs that can be selected from the WLAN. The SNPN List with trusted 5G Connectivity information element optionally includes per SNPN access information, per SNPN supported GINs, per SNPN human-readable network name, and a GIN list. The SNPN List with trusted 5G Connectivity information element is type 6 information element of format TLV-E according to 3GPP TS 24.007 [48] and is coded as shown in figure H.2.4.7-1, figure H.2.4.7-2, figure H.2.4.7-3, figure H.2.4.7-4, figure H.2.4.7-5, figure H.2.4.7-6, figure H.2.4.7-7, figure H.2.4.7-8, figure H.2.4.7-9, figure H.2.4.7-10 and table H.2.4.7-1.\nFigure H.2.4.7-1: SNPN List with trusted 5G Connectivity information element\n\nFigure H.2.4.7-2: SNPN information List\nFigure H.2.4.7-3: SNPN information entry\n\nFigure H.2.4.7-4: SNPN identity\n\nFigure H.2.4.7-5: SNPN access information\nFigure H.2.4.7-6: Supported GINs\n\nFigure H.2.4.7-6a: HRNN\n\nFigure H.2.4.7-7: GIN list\n\nFigure H.2.4.7-8: GIN information entry\nFigure H.2.4.7-9: NID list\n\nFigure H.2.4.7-10: NID identity\n\nTable H.2.4.7-1: SNPN List with trusted 5G Connectivity information element\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "The SNPN List with trusted 5G Connectivity information element is used by the network to indicate the SNPNs that can be selected from the WLAN. The SNPN List with trusted 5G Connectivity information element optionally includes per SNPN access information, per SNPN supported GINs, per SNPN human-readable network name, and a GIN list. The SNPN List with trusted 5G Connectivity information element is type 6 information element of format TLV-E according to 3GPP TS 24.007 [48] and is coded as shown in figure H.2.4.7-1, figure H.2.4.7-2, figure H.2.4.7-3, figure H.2.4.7-4, figure H.2.4.7-5, figure H.2.4.7-6, figure H.2.4.7-7, figure H.2.4.7-8, figure H.2.4.7-9, figure H.2.4.7-10 and table H.2.4.7-1.",
                                    "table number": 127,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 128,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Figure H.2.4.7-2: SNPN information List",
                                    "table number": 129,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 130,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 131,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Figure H.2.4.7-5: SNPN access information",
                                    "table number": 132,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 133,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 134,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 135,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Figure H.2.4.7-8: GIN information entry",
                                    "table number": 136,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "",
                                    "table number": 137,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table H.2.4.7-1: SNPN List with trusted 5G Connectivity information element",
                                    "table number": 138,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "H.2.4.8\tSNPN List with AAA connectivity to 5GC IE",
                            "text_content": "The SNPN List with AAA connectivity to 5GC information element is used by the WLAN to indicate the SNPNs that can provide UE authentication for NSWO in 5GS as specified in annex S of 3GPP TS 33.501 [78].\nThe SNPN List with AAA 5G connectivity to 5GC information element is type 6 information element of format TLV-E according to 3GPP TS 24.007 [48] and is coded as shown in figure H.2.4.X-1. The SNPN List with AAA connectivity to 5GC information element optionally includes:\n-\tSNPN information list, containing the list of SNPNs and coded according to figure H.2.4.7-2; and\n-\tGIN list, containing the list of GINs and coded according to figure H.2.4.7-7.\nFigure H.2.4.9-1: SNPN List with AAA connectivity to 5GC information element\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "-\tGIN list, containing the list of GINs and coded according to figure H.2.4.7-7.",
                                    "table number": 139,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "H.2.4.9\tSNPN List with trusted 5G Connectivity-without-NAS IE",
                            "text_content": "The SNPN List with trusted 5G Connectivity-without-NAS information element is used by the network to indicate the SNPNs for which the WLAN provides connectivity to a 5GCN, for devices without NAS capability, that can be selected from the WLAN. The format of the SNPN List with trusted 5G Connectivity-without-NAS information element is identical to the format of the SNPN List with trusted 5G Connectivity information element defined in clause H.2.4.7.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "I.1\tGeneral",
            "description": "The Emergency Call Number field is a variable-length UTF-8 (see RFC 3629 [34]) formatted field. The purpose of this field is to encode emergency call number(s) for use within the country where the field is received.\nThis clause describes the formatting of the Emergency Call Number Unit field used in the Emergency Call Number ANQP-element specified in IEEE Std 802.11 [57].\nNOTE:\tAccording to IEEE Std 802.11 [57] an ANQP server is not necessarily collocated with an AP. Where the TWAN provides access to multiple PLMNs, where a PLMN has configured the TWAN to provide different emergency numbers compared to another PLMN, it is an implementation option to ensure the Emergency Call Number field includes the emergency numbers configured by the PLMN the UE successfully authenticated and authorized with.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "I.2\tFormatting",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "J.1\tGeneral",
            "description": "This clause describes the retrieval of the Emergency Call Numbers field using DNS procedures.\nThe UE performs this procedure with a DNS server only, if the DNS server address is acquired from the ePDG using procedures in 3GPP TS 24.302 [156] clause 7.2.2.1 and clause 7.4.1, contained in the CFG_REPLY Configuration payload, and after mutual authentication of the UE and the network.\nNOTE:\tThe message carrying the emergency information is sent through the established IPsec tunnel to the 3GPP network.\nThe related Country based Emergency Numbers FQDN is specified in 3GPP TS 23.003 [3].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "J.2\tRetrieval of emergency call numbers",
            "description": "When a UE is connected to WLAN access, the UE may support the DNS mechanisms specified in this Annex to retrieve emergency call numbers and service types for use within the country indicated by the MCC information.\nThe UE shall construct an emergency number FQDN based on the Country based Emergency Numbers FQDN format as specified in 3GPP TS 23.003 [3] and then perform the DNS NAPTR query using the constructed emergency number FQDN as input.\nIf the result of this query is:\n-\ta set of one or more records containing the replacement field of the form \"<emergency-type>.<emergency-number>.sos.en.epc.mcc<MCC>.visited-country.pub.3gppnework.org\", the UE shall consider the list of emergency-number(s) and type(s) as valid additional emergency call number(s) for the country indicated by the MCC information and store the emergency call number(s) and type(s) received;\nNOTE:\tEven though a label named \"visited-country\" is present in the replacement field, the UE can use the mechanism to obtain emergency numbers and associated type(s) even when the UE is in its home country.\n-\tno records containing the replacement field of the form \"<emergency-number>.<emergency-type>.sos.en.epc.mcc<MCC>.visited-country.pub.3gppnework.org\", the UE shall replace a Local Emergency Numbers List storing emergency call number(s) and type(s) received over WLAN with an empty Local Emergency Numbers List.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "J.3\tVoid",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "K.1\tGeneral",
            "description": "This clause describes the retrieval of the local emergency call numbers using IKEv2 procedures.\nThe ePDG may support downloading local emergency call numbers using IKEv2 procedures.\nThe UE may support retrieval of local emergency call numbers using IKEv2 procedures.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "K.2\tRetrieval of local emergency call numbers",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "K.2.1\tUE procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "During the tunnel establishment procedure (see clause 7.2.2), if the UE supports retrieval of local emergency call numbers via IKEv2 procedures, it shall include the EMERGENCY_CALL_NUMBERS Notify payload without the MCC information field, Length field and Local emergency numbers field (i.e. the octet 5 to octet x in figure 8.2.9.8-1) in the IKE_AUTH request message to indicate the support of retrieval of local emergency call numbers via IKEv2 procedures.\nAfter the successful authentication with the 3GPP AAA server, the UE receives from the ePDG an IKE_AUTH response message, if:\na)\tthe EMERGENCY_CALL_NUMBERS Notify payload is included in that IKE_AUTH response message; and\nb)\tthe UE supports retrieval of local emergency call numbers via IKEv2 procedures,\nthe UE shall store the local WLAN emergency call numbers and corresponding emergency service categories contained in the EMERGENCY_CALL_NUMBERS Notify payload as additional emergency call numbers and categories. The additional emergency call numbers and categories can be used to detect a UE initiated emergency call if the MCC information in the EMERGENCY_CALL_NUMBERS Notify payload corresponds to the country in which the UE is located. The local WLAN emergency call numbers and corresponding emergency service categories stored in the user equipment shall be replaced on each receipt of an EMERGENCY_CALL_NUMBERS Notify payload with a MCC information field that has a non-zero value Length field.\nIf:\n-\tno MCC information field;\n-\tno Length field; or\n-\ta Length field, set to a non-zero value, is present but no Local emergency numbers field;\nis present in a received EMERGENCY_CALL_NUMBERS Notify payload, then the local WLAN emergency call numbers and corresponding emergency service categories, if available in the user equipment, shall be kept.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "K.2.2\tePDG procedures",
                    "description": "",
                    "summary": "",
                    "text_content": "The ePDG may be configured by the operator with the local emergency call numbers and associated emergency service types along with the corresponding country information.\nAfter the successful authentication between the UE and the 3GPP AAA server, if:\na)\tthe ePDG is configured with the local emergency call numbers information; and\nb)\tthe ePDG supports downloading of local emergency call numbers via IKEv2;\nthe ePDG shall based on local policy:\na)\tif the UE has indicated support of retrieval of local emergency call numbers via IKEv2 procedures,\ni)\tderive the current visited country from the IP address of the IKEv2 message, i.e. the IP address contained in the out most IP header field of the received IKEv2 message; and\nii)\tinclude the configured local emergency call numbers and the associated emergency service categories of the derived country, if available, in the EMERGENCY_CALL_NUMBERS Notify payload in the final IKE_AUTH response message; or\nb)\talways\ni)\tderive the current visited country from the IP address of the IKEv2 message, i.e. the IP address contained in the out most IP header field of the received IKEv2 message; and\nii)\tinclude the configured local emergency call numbers and the associated emergency service categories of the derived country, if available, in the EMERGENCY_CALL_NUMBERS Notify payload in the final IKE_AUTH response message.\n\n\n",
                    "tables": [
                        {
                            "description": "",
                            "table number": 140,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 141,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        }
    ]
}