{
    "document_name": "23700-48-i00.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Report has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\tindicates that something is possible\ncannot\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document describes key issues and solutions for the phase 2 of the system enhancements for Edge Computing in 5GS.\nEdge Computing is supported in 5GS since Rel-15. During Rel-17 FS_enh_EC study described in TR 23.748 [4] , further enhancements for supporting Edge Computing have been studied, including discovery and re-discovery of EAS, edge relocation etc. 4 key issues from FS_enh_EC study have been concluded and progressed in TS 23.548 [3]. Some other issues were raised during the Rel-17 study but not studied due to the time limitation in Rel-17.\nThis technical report will document the study of potential system enhancements for enhanced edge computing support, including:\n-\timprovements to roaming, to support access to EHE in a VPLMN (WT#1);\n-\tdefining use cases that may benefit from exposure of additional data via the Local UPF/NEF including describing (on a high level) the characteristics of the data and data delivery to fulfil the use cases; investigating the solutions and their feasibility and suitability for improved network exposure of UE traffic related information to common Edge Application Server via Local UPF/NEF, such as network congestion status (WT#3);\nNOTE 1:\tXR/media and AI/ML services specific QoS information exposure are to be studied in corresponding study items with considering the same exposure framework as defined by this study.\nNOTE 2:\tThis objective will look at the use cases and the data to be exposed but not at the actual UPF exposure mechanism or UPF-originated data, if/when already covered by FS_UPEAS.\n-\tinvestigating the potential need and solutions for supporting offload policies to match more granular sets of UE(s) without exposing operator-internal configurations to 3rd party AFs (WT#5);\n-\tinvestigating the potential need and solutions to influence of PSA-UPF and EAS (re)location for collection of UEs, e.g. in scenarios when UE(s) should use the same EAS and are not members of a pre-defined group (WT#6);\n-\tinvestigating potential impacts related to the GSMA Operator Platform Group work, and potential improvements related with 5GC and EHE being operated by different organizations (WT#7);\n-\tinvestigating the potential need and solutions to avoid the UE to switch the EC traffic away from the EC PDU Session and 5GS altogether, due to conflicting connectivity preferences in the device (e.g. via means outside of 3GPP connectivity, e.g. non-integrated Wifi) (WT#8);\n-\tinvestigating the potential solutions for the AF to be able to obtain/determine the DNAI that is associated to a certain selected EAS, for subsequent use with already defined services provided to the AF (WT#9).\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.501: \"System architecture for the 5G System (5GS)\".\n[3]\t3GPP TS 23.548: \"5G System Enhancements for Edge Computing; Stage 2\".\n[4]\t3GPP TR 23.748: \"Study on enhancement of support for Edge Computing in 5G Core network (5GC)\".\n[5]\tGSMA OPG.02: \"Operator Platform Telco Edge Requirements\", https://www.gsma.com/futurenetworks/wp-content/uploads/2021/07/GSMA-OPG-Telco-Edge-Requirements-2021.pdf.\n[6]\tSP-210583: \"Reply LS to GSMA Operator Platform Group on edge computing definition and integration\", SA#92e.\n[7]\tIETF RFC 5681: \"TCP Congestion Control\".\n[8]\t3GPP TS 26.247: \"Transparent end-to-end Packet-switched Streaming Service (PSS); Progressive Download and Dynamic Adaptive Streaming over HTTP (3GP-DASH)\".\n[9]\t3GPP TS 23.502: \"Procedures for the 5G System (5GS)\".\n[10]\t3GPP TR 23.700-85: \"Study on enhancement of 5G User Equipment (UE) policy\".\n[11]\t3GPP TS 24.526: \"User Equipment (UE) policies for 5G System (5GS); Stage 3\".\n[12]\t3GPP TS 23.122: \"Non-Access-Stratum (NAS) functions related to Mobile Station (MS) in idle mode\".\n[13]\t3GPP TS 23.503: \"Policy and charging control framework for the 5G System (5GS)\".\n[14]\t3GPP TS 38.415: \"NG-RAN; PDU session user plane protocol\".\n[15]\t3GPP TS 38.413: \"NG-RAN; NG Application Protocol (NGAP)\".\n[16]\t3GPP TS 23.003: \"Numbering, addressing and identification\".\n[17]\t3GPP TS 29.519: \"Usage of the Unified Data Repository Service for Policy Data, Application Data and Structured Data for Exposure\".\n[18]\t3GPP TS 29.503: \"Unified Data Management Services\".\n[19]\t3GPP TS 23.288: \"Architecture enhancements for 5G System (5GS) to support network data analytics services\".\n[20]\tS2-2203633: \"LS on UPF selection based on DNAI\", SA2#151e.\n[21]\t3GPP TR 23.700-60: \"Study on XR (Extended Reality) and media services\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in TR 21.905 [1], TS 23.501 [2], TS 23.548 [3] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in TR 21.905 [1].\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tVoid",
                    "description": "",
                    "summary": "",
                    "text_content": "\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.3\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in TR 21.905 [1], TS 23.501 [2], TS 23.548 [3] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905 [1].\nEACI\tECS Address Configuration Information\nEDI\tEdge Deployment Information\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tArchitectural assumptions and principles",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tArchitectural Assumptions",
                    "description": "",
                    "summary": "",
                    "text_content": "Existing solutions defined in Rel-15, Rel-16 and Rel-17 will be considered as baseline in this study.\nThe architecture for support of Edge Computing in 5GC shall be based on the following architecture assumptions:\n-\tthe architecture for Edge computing specified in Release 17 is used as basis for further potential enhancement;\n-\tthe Edge Hosting Environment (EHE) can be under the control of the serving network operator or a 3rd party;\n-\tinterconnectivity between EHEs of different operators cannot be assumed to be available for all deployments.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tArchitectural Requirements",
                    "description": "",
                    "summary": "",
                    "text_content": "-\tThe solutions should minimize the impact on the application layer.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "5\tKey issues",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tKI#1: Accessing EHE in a VPLMN when roaming",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.1.1\tDescription",
                            "text_content": "The purpose of this key issue is to define 5GS improvements to support the UE access to an EHE in a VPLMN.\nTwo scenarios (i.e. UE accessing EHE in VPLMN via an LBO PDU Session and UE accessing EHE in VPLMN via a PDU Session established as HR) are described in clause 5.1.2.\nFor the scenario using LBO PDU Session, potential solutions should address the following:\n-\thow to establish the LBO PDU Session towards the correct S-NSSAI/DNN pair in order to access an EHE in the VPLMN;\n-\thow to support Rel-17 edge computing related procedures, such as EAS (re-)discovery, as specified in clause 6 of TS 23.548 [3].\nFor the scenario using a PDU Session with a PSA in the HPLMN, potential solutions should address the following:\n-\thow to authorize the PDU Session to support local traffic routing to access an EHE in the VPLMN;\n-\twhether and how to support charging for the local traffic of a PDU Session that supports local traffic routing to access an EHE in the VPLMN;\n-\thow to support Rel-17 edge computing related procedures, such as EAS (re-)discovery, as specified in clause 6 of TS 23.548 [3];\n-\thow to ensure proper policy control and QoS enforcement;\n-\tpotential impact on Policy and QoS control;\n-\thow to configure the VPLMN ECS address to UE in roaming scenarios;\n-\thow to support the edge relocation in roaming scenarios.\nNOTE 1:\tInteraction with SA5 is expected regarding charging aspects where needed.\nNOTE 2:\tLatency needs to be considered and addressed for all scenarios.\nNOTE 3:\tIn Rel-17, the ECS address is provided by UDM, which requires further consideration in scenarios with ECS in a VPLMN. This may need some coordination with SA WG6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.2\tScenarios",
                            "text_content": "For a roaming UE, accessing to EHE in VPLMN might be needed to fulfil use cases requiring edge computing. Two main scenarios should be considered:\n1)\tUE accessing V-EHE via a Local Breakout (LBO) PDU Session:\nThe scenario supports all connectivity models and assumes that an LBO PDU Session is used to access an EHE in VPLMN for EC applications.\nWith a LBO PDU Session, the UE can access an EHE in VPLMN.\nNOTE 1:\tTwo different PDU Sessions are required to access an EHE in VPLMN and Home DN in HPLMN simultaneously.\n2)\tUE accessing V-EHE via a Home Routed (HR) PDU Session (i.e. with PSA in HPLMN):\nThis scenario assumes the session breakout for the HR PDU Session is used to access EHE in VPLMN for EC application.\nWith a single PDU Session, UE can access an EHE in VPLMN and also the DN in HPLMN.\nNOTE 2:\tWith a single PDU Session and (DNN+S-NSSAI), it can support both EC and non-EC applications in either roaming or non-roaming case.\nTo support such PDU Session, it needs to be studied how the UE can access the V-EHE via a HR PDU Session. Two sub-scenarios may be considered:\n2.1)\tHPLMN has the knowledge of EAS deployment information in VPLMN for specific services. The HPLMN triggers EAS discovery and local traffic routing in VPLMN.\n2.2)\tHPLMN does not have the knowledge of EAS deployment information in VPLMN. The VPLMN triggers EAS discovery and local traffic routing in VPLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.1.3\tAssumptions",
                            "text_content": "The solutions do not have to restrict any deployment option or solution options allowed in the previous releases for both for VPLMN and HPLMN. In other words, all deployment options or solution options that are allowed in the previous releases can be assumed. Also, VPLMN and HPLMN may have different deployment options, for example, various EAS (re-)discovery options specified in clause 6 of TS 23.548 [3] or whether to deploy the dynamic PCC.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.2\tKI#2: Fast and efficient network exposure improvements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tDescription",
                            "text_content": "This key issue addresses improvements to fast and efficient network exposure of UE traffic related information to Edge Application Server via Local UPF/NEF to support additional information, such as network congestion status.\nThis key issue defines use cases that may benefit from exposure of additional data via the Local UPF/NEF including describing (on a high level) the characteristics of the data and data delivery to fulfil the use cases.\nBased on the use cases, this key issue investigates solutions and their feasibility and suitability for improved network exposure of UE traffic related information to common Edge Application Server via Local UPF/NEF, such as network congestion status. In this case, the following issues should be studied:\n-\twhich information and at which level (e.g. per QoS Flow, per cell) needs to be provided to AF via local UPF/NEF?\n-\thow the above information is obtained?\nNOTE 1:\tXR/media and AI/ML services specific QoS information exposure are to be studied in corresponding study items with considering the same exposure framework as defined by this study.\nNOTE 2:\tThis key issue will look at the use cases and the data to be exposed but not at the actual UPF exposure mechanism or UPF-originated data, if/when already covered by the FS_ UPEAS. UPF exposure mechanism to be discussed in FS_UPEAS is possibly reused.\nNOTE 3:\tThe aim is to, whenever possible, re-use information already defined in existing 3GPP specifications.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tUse cases and scenarios",
                            "text_content": "Observation of the link characteristics is widely used to adjust the transmission behaviour in different scenarios. For example:\n-\tFor some transport layer protocols, e.g. TCP, QUIC, congestion control algorithms can be used to control packets transmission via 5GS based on e.g. observing packet loss and take it as indication of network congestion. For example, TCP congestion control algorithm defined in RFC 5681 [7] uses different ways to adjust congestion window, perform slow start, congestion avoidance, fast retransmit, and fast recovery, which leads to classic \"sawtooth\" congestion window.\n-\tMedia based services can benefit by low and consistent latency. This can be achieved by rate adaptation by the endpoints.\nFor Edge computing scenarios, most applications, e.g. autonomous automotive vehicles, real-time mobile gaming, cloud gaming, robotic applications, interactive video, are sensitive to the change of network latency and throughput. When network congestion happens, if the application can be notified in a fast and efficient way (e.g. within a RTT of user packet transmission), these services can react to the change of network congestion status more agilely.\nNOTE:\tThe solution in the following clause 6 will use the use case(s) in this clause as guidance to judge the feasibility and suitability.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tKI#3: Policies for finer granular sets of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tDescription",
                            "text_content": "This key issue investigates the potential need and solutions for supporting offload policies for more granular sets of UE(s).\nThis key issue will study the following aspects:\n-\thow to identify set of UEs at a finer granularity that are associated with a dedicated offload policy, and how to express the set of UE in the offload policy;\n-\timpacts to 5GS needed to support providing traffic offload policy for such a set of UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.2\tScenarios",
                            "text_content": "Considering limited or expensive EC resources, the application service provider or the operator may consider to provide EC services for certain users only under certain conditions, e.g. within a specific geographical area, or at specific time, etc. The AFs can provide the request to support some offload policies only for certain set of UE(s) following a set of specific criteria.\nThere are cases that traffic offload policy aims at a finer sets of UE(s), for instance, UEs satisfying a combination of criteria:\nCase a:\tUEs within a specific geographical area and have been associated with specific service provided by operator or application service provider;\nCase b:\tUEs that have been associated with a combination of services provided by operator or application service provider;\nCase c:\tUEs within a specific geographical area and have been associated with a combination of services provided by operator or application service provider;\nCase d:\tat specific time, UEs that have been associated with specific service or a combination of services provided by operator or application service provider;\nCase e:\tUEs belongs to both group-A and group-B, or UEs belongs to group-A and associated with specific service. It is possible that these users belong to pre-defined groups or do not belong to any pre-defined groups.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.3\tAssumptions",
                            "text_content": "Operator-internal configurations shall not be exposed to 3rd party AFs.\nThe application can be deployed in both central location(s) and edge cloud(s).\nThe application service provider is expected to be able to interact with the operator regarding setting the offload policies.\nSolutions for this KI will identify their support for the following:\n-\tAF under operator control;\n-\tAF under 3rd party control.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.4\tKI#4: Influencing UPF and EAS (re)location for collections of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.4.1\tDescription",
                            "text_content": "Investigate the potential need and solutions to influence of PSA-UPF and EAS (re)location for collection of UEs, e.g. in scenarios when UE(s) should use the same EAS and are not members of a pre-defined group.\nIn particular, the key issue will study the following aspects:\n-\twhether and how to define a collection of UEs forming a dynamic ad-hoc group that should use the same EAS and/or same local part of DN and/or same DNAI and how the collection is identified;\n-\twhether and how to influence UPF and EAS (re)location for a collection of UEs that should use the same EAS and/or same local part of DN and/or same DNAI;\n-\thow to decide on a common local part of DN for the collection of UEs;\n-\tfor a given collection of UEs defined in the above, whether and how to determine if any UE in this collection have no access to EAS or local part of DN, and whether and how to define any specific treatments for such UE if any;\n-\thow to handle coordination of the UPF(s) and EAS (re)location for collections of UEs;\n-\twhether and how existing mechanisms suffice;\n-\twhether and what improvements are required for EAS discovery and re-discovery for UEs belonging to a collection of UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.2\tScenarios",
                            "text_content": "There are use cases that UEs belonging to a non-predefined dynamic group should be treated the same way, and members of the dynamic group is likely to change dynamically, e.g. UE could join/leave the group randomly. For example:\n-\tMulti-user low latency Gaming: In such use cases, the Application client running on the UE are served by a particular application server which is the corresponding game hosting server i.e. Edge Application Server (EAS). This EAS provides gaming services and maintains individual UEs gaming profile, user level registration details, etc. These members could change dynamically over period of time. Also, due to maintenance purposes or due to overload situation EAS would require to be relocated to another one, thus moving all registered users to the new EAS.\n-\tPlatooning: In case of platooning use case, all the member UEs involved have similar attributes and requirements, for example, all UEs in a particular platoon have similar mobility characteristics i.e. moving in the same direction and with similar speed, located in proximity to each other, and so on.\n-\tXR application which consists of a group of application components on multiple UEs: In the use case, the XR application consists of multiple application components running on different UEs for different purposes e.g. recognizing, modelling, rendering of a group of objects. The application components processing for the group of UEs should be run on a single EAS instance.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.4.3\tAssumptions",
                            "text_content": "For the dynamic group management, coordination between FS_EDGE_Ph2 and FS_GMEC might be needed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.5\tKI#5: GSMA OPG impacts and improvements for EHE operated by separate party",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.5.1\tDescription",
                            "text_content": "As indicated in the LS out to GSMA Operator Platform Group (OPG) in SP-210583 [6], the ongoing GSMA OPG work may have impacts on 5G architecture.\nGSMA OPG introduced the concept of Federation of Operator Platforms introduced in GSMA OPG.02 [5], to allow Application Providers to reach a wider geographical area and user base. The following aspects shall be studied:\n-\tinvestigate potential impacts related to the GSMA Operator Platform Group work, and potential improvements related with 5GC network and EHE being operated by different organizations;\n-\tinvestigate potential impacts related to the GSMA Operator Platform Group work on EAS discovery;\n-\thow the 5GS facilitates edge relocation between an EAS deployed by a source EHE provider to another EHE deployed by a target EHE provider, even in scenarios when EHEs are operated by different service providers.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.2\tScenarios",
                            "text_content": "Clause 3.3.5 of the GSMA OPG.02 [5] requirement document introduces the Edge Node Sharing scenario in which EAS A (hosted by one partner, e.g. 3rd party or another Operator) is to be accessed by the other partners, e.g. Operator B's network (see figure 2 in clause 3.3.5 of GSMA OPG.02 [5]). The same modelling and solutions of a 3rd party provider hosting the EHE are considered. Under such circumstances, mechanisms should be available to allow a PLMN to use EHE resources shared by another MNO appropriately, i.e. allow a UE in PLMN B to access efficiently the EAS in PLMN A located in close proximity and to route the UE traffic to the identified EAS.\nThe following terms defined in the GSMA OPG.02 [5] requirement document are used:\nE/WBI\tEast/Westbound Interface\nOP\tOperator Platform\nSBI-CR\tSouthbound Interface – Cloud Resources\nSBI-NR\tSouthbound Interface – Network Resources\nUNI\tUser to Network Interface\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.5.3\tAssumptions",
                            "text_content": "Edge Node Sharing is a deployment option based on agreements between two or more parties (the operator providing the connectivity and one or more 3rd parties or other operators providing the Edge Cloud Compute Resources.\nTo support the Edge Node Sharing scenario in which EAS's are hosted by one or more partners (3rd party or another Operator), the East/Westbound interface (defined by GSMA OPG) can be used to provide the serving operator with application instance access information. This approach allows the serving Operator to performing service discovery and delivery as when the application was delivered from an EHE in the serving Operator's own network.\nThe Edge Node sharing allows the Home and Visited PLMN to incorporate EASs that are hosted on Edge Node sharing partners Edge compute resources without impact on the roaming solutions.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.6\tKI#6: Avoiding UE to switch away from EC PDU Session",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.6.1\tDescription",
                            "text_content": "This key issue investigates the potential need and solutions to avoid the UE to switch the EC traffic away from the EC PDU Session and 5GS altogether, due to conflicting connectivity preferences in the device (e.g. via means outside of 3GPP connectivity, e.g. non-integrated Wi-Fi).\nIn particular, this key issue will address:\n-\thow to determine what traffic is using the 5G System to access edge computing resources, and specifically in what granularity the traffic can be identified (e.g. Flow and/or PDU Session);\n-\twhat actions might be taken when some application traffic is currently using the 5G System to access edge computing resources and connectivity outside of 5GS becomes available.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6.2\tScenarios",
                            "text_content": "5GS may provide a number of enablers for Edge Computing, those for 3GPP Rel-17 being specified in TS 23.548 [3]. For example:\n-\tEAS (Re-)discovery for Distributed Anchor and Multiple PDU Sessions Connectivity Model;\n-\tEAS (Re-)discovery over Session Breakout Connectivity Model;\n-\tEdge Relocation Involving AF Change.\nIn some scenarios, these Edge Computing enablers cannot be used if the UE switches to an access for all UP traffic that is not integrated with 5GS or does not provide the expected characteristics. Problematic cases include:\n-\tnon-integrated access, where re-connecting to the 5GS is not possible, e.g. because lack of UE support or an N3IWF could not be discovered or connected to and these Edge Computing enablers can only be reached via the 5GS;\n-\tre-connecting to the 5GS is possible but results in long UP paths because of e.g. a centralized N3IWF;\n-\tsession breakout scenarios where an UL-CL and L-PSA is used to obtain EC connectivity and switching to an access that is not integrated with 5GS would therefore break the EC connectivity.\nA UE may use a PDU Session to access Edge Computing Services. When non-integrated connectivity becomes available for the UE, the UE's connectivity preferences may dictate that the UE use the non-integrated connectivity for traffic that is currently accessing Edge Computing Services via the 5G System.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.6.3\tAssumptions",
                            "text_content": "This key issue should consider all of the connectivity models that are described in clause 4.3 of TS 23.548 [3] (i.e. Distributed Anchor Point, Session Breakout, and Multiple PDU Session).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.7\tKI#7: Obtain and maintain mapping table between IP address/IP range with DNAI",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.7.1\tDescription",
                            "text_content": "For edge computing scenarios, it is important for AF to obtain target DNAI in order to determine the target new EAS for edge relocation. Up to Rel-17, it has been assumed that the AF has been provisioned with the proper DNAI information if it is required to use it during its interactions with the 5GC. This key issue will investigate the potential solutions for the AF to be able to obtain/determine the DNAI that is associated to a certain selected EAS, for subsequent use with already defined services provided to the AF.\nThe following aspects shall be studied:\n-\twhat information the AF should provide to 5GC (e.g. IP address or range thereof (i.e.IPv4 subnetwork and IPv6 prefixes) , FQDN) and how it should provide it to help determine proper DNAI if the AF does not have knowledge of the DNAI information;\n-\twhether and how the 5GC can provide a DNAI to AF to help the subsequent AF influence/request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.2\tScenarios",
                            "text_content": "What we have met in the real network is that the AF does not understand the DNAI information. All the DNAIs are created by operators and transmitted to AF based on offline configuration. The DNAI information has been supported since Rel-15 by TS 23.501 [2] AF influence procedure.\nHowever, there still existing the scenario that the AF has not been provided beforehand with DNAI information and needs to know the DNAI(s) associated with the EAS(s) in the EHE under its responsibility.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.7.3\tAssumptions",
                            "text_content": "The existing service operations used by the AF and making use of DNAI shall not be impacted by this new functionality.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tSolutions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.0\tSolution-Key issue matrix",
                    "description": "",
                    "summary": "",
                    "text_content": "The solutions in clause 6 can apply to one or more key issues described in clause 5 of this report. Table 6.0-1 describes the relationship between solutions and key issues.\nTable 6.0-1: Solution-Key issue matrix\n\n",
                    "tables": [
                        {
                            "description": "Table 6.0-1: Solution-Key issue matrix",
                            "table number": 3,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.1\tSolution 01 (KI#1): EAS discovery in Home Routed roaming scenario",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.1.1\tDescription",
                            "text_content": "This solution is for Key Issue #1, which addresses 5GS improvements to support the UE access to an EHE in a VPLMN using a PDU Session with a PSA in the HPLMN including aspects related to:\n-\tHow to authorize the PDU Session to support local traffic routing to access an EHE in the VPLMN;\n-\tHow to support Rel-17 edge computing related procedures, such as EAS (re-)discovery, as specified in clause 6 of TS 23.548 [3].\nThe current standards only depict 5GS architecture for non-roaming and LBO roaming scenario supporting with UL-CL/BP. For Home Routed roaming scenario, the data flow of the UE needs to pass through the UPF of the VPLMN to the UPF of the HPLMN, the routing is controlled by SMF of the HPLMN, therefore the local traffic routing in the VPLMN cannot be achieved.\nThis solution proposes several ways to support UE access to VPLMN EHE in HR roaming scenarios according to different scenarios.\nWhen H-AF has the knowledge of V-AF request, it creates a new request with carrying V-AF application requirement, and the H-AF configures it to the H-SMF according to the AF requests to influence traffic routing procedure defined in clause 4.3.6.2 of TS 23.502 [9]. H-SMF will send the PCC rule related with the AF request about the HR PDU Session to V-SMF, H-SMF also sends the VPLMN ECS address and local traffic routing indication to V-SMF, and V-SMF will perform the EAS discovery and local traffic routing in VPLMN as described in clause 6.2.3.2.3 of TS 23.548 [3].\nWhen HPLMN does not have the knowledge of EAS deployment information in VPLMN, after the H-SMF authorizes the V-SMF to perform local traffic routing, V-SMF retrieves the EAS deployment information of the VPLMN from the V-NEF and performs EAS discovery according to the EAS discovery procedure described in TS 23.548 [3].\nIn addition, the V-AF can also configure the V-SMF according to the AF influence on traffic routing procedure. In this case, during the HR PDU Session establishment, the V-SMF needs to select a PCF in the VPLMN to establish the SM Policy Association. V-PCF may send the VPLMN ECS address obtained from V-AF to V-SMF.\nThe charging at VPLMN can be applied by V-UPF reporting usage information to V-SMF to V-CHF, and the usage information also needs to be reported by V-UPF to H-SMF via V-SMF, and H-SMF reports the usage to H-CHF for charging at HPLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.2\tProcedures",
                            "text_content": "The figure depicts a HPLMN triggered EAS discovery in a HR roaming scenario, illustrating the process of detecting and responding to EAS alerts in a mobile network. The figure shows the HPLMN (High-Performance Local Network) as the primary network, with the EAS (Emergency Alert System) triggered by the HPLMN. The EAS alert is then detected and responded to by the network, which includes the HPLMN, the EAS server, and the EAS controller. The figure also shows the network's response to the EAS alert, including the routing of the signal to the EAS server and the activation of the EAS controller.\nFigure 6.1.2.1-1: HPLMN triggered EAS discovery in HR roaming scenario\n1.\tH-AF creates a new request with carrying V-AF application requirement and invokes a Nnef_TrafficInfluence_Create service operation and influences the traffic as described in steps 1-4 in clause 4.3.6.2 of TS 23.502 [9]. It is assumed that EAS deployment information of VPLMN is not contained in AF request.\nNOTE 1:\tHow V-AF sends application related information to H-AF is in SA6 scope. As an alternative, the V-AF may, depending on operator agreement, act as a non-trusted AF of the HPLMN (using NEF).\n2.\t5GS establishes a Home Routed PDU Session. During PDU Session establishment, H-SMF retrieves the PCC rules for which PDU Session may be impacted by the H-AF request for VPLMN from H-PCF using Rel-17 Npcf mechanisms, and sends Nsmf_PDUSession_Create response to V-SMF, which also includes an indication to authorize V-SMF to perform local traffic routing in VPLMN and VPLMN ECS address. The indication and VPLMN ECS address are obtained by H-SMF from H-UDM.\nNOTE 2:\tThe PCC rules are sent from H-SMF to V-SMF over N16.\n3.\tSteps 1-6 in clause 6.2.3.2.3 of TS 23.548 [3] are performed. In step 1 of clause 6.2.3.2.3, UL-CL will be inserted by V-SMF.\nNOTE 3:\tThe local DNS server IP address will be configured to UE by V-SMF as described in Option C in clause 6.2.3.2.3 of TS 23.548 [3] based on the information provided in the AF request in step 1.\nThe figure depicts a VPLMN triggered EAS discovery in a HR roaming scenario, illustrating the process of detecting and responding to EAS alerts in a mobile network. The diagram shows the VPLMN (Virtual Private LAN) network, the EAS (Emergency Alert System) system, and the HR (Handover Reconciliation) process. The figure highlights the importance of EAS in ensuring network security and user safety during mobile network operations.\nFigure 6.1.2.2-1: VPLMN triggered EAS discovery in HR roaming scenario\n1.\tEAS deployment Information provisioned from AF via NEF as described in clause 6.2.3.4.2 of TS 23.548 [3].\n2-3.\tIt is assumed that V-SMF has subscribed to EAS Deployment Information Change Notification from the V-NEF. The V-NEF invokes Nnef_EASDeployment_Notify to the SMF to provide the EAS Deployment Information.\n4.\tIf V-AF related information changes, V-AF creates a new request and invokes a Nnef_TrafficInfluence_Create service operation and influences the traffic as described in steps 1-4 in clause 4.3.6.2 of TS 23.502 [9].\n5.\tUE establishes Home Routed PDU Session. During the HR PDU Session establishment, UE uses a DNN which supports local traffic routing in VPLMN for Home Routed PDU Sessions. When V-SMF recognises the DNN, it will select a PCF in VPLMN and establish a SM Policy Association with it. The PCC instructions sent by V-PCF to V-SMF and PCC instructions sent by H-PCF to H-SMF will be translated into QoS rules respectively and both stored in V-SMF until being updated by new policy such as when step 10 happens.\n6.\tUE sends DNS Query message to V-UPF.\n7.\tV-UPF will detect the DNS query based on the V-SMF configured data forwarding rule to the V-UPF for the traffic to be offloaded and notify V-SMF.\n8.\tV-SMF requests to do the local traffic routing in VPLMN and V-SMF selects V-EASDF before the authorization, in order to support including V-EASDF/Local DNS address information in PCO generated from HPLMN.\n9-\tV-SMF sends the request of local traffic routing in VPLMN to H-SMF via Nsmf_PDUSession_Update request, with including V-EASDF/Local DNS address information, and also sends the capability of supporting EASDF indication to H-SMF. According to the feature and principle of Home Routed PDU Session, H-SMF should have the control of PDU Session, so V-SMF should request local traffic routing from H-SMF first and then request the policy from V-PCF as described in step 10. This requires operators in VPLMN to enhance the control of V-SMF and optimize the protocol with operator in HPLMN.\n10.\tH-SMF sends the indication to authorize V-SMF to perform local traffic routing in VPLMN and the H-DNS for the traffic to be routed to HPLMN via or Nsmf_PDUSession_Update response. The indication is obtained by H-SMF from H-UDM. H-SMF also includes V-EASDF/Local DNS address information in PCO via Nsmf_PDUSession_Update response.\n11-12.\tV-SMF sends Npcf_SMPolicyControl_Create request to V-PCF to retrieve the new policy impacted by the AF request. After this step, V-SMF gets two kinds of policies, one is from V-PCF and one is from H-PCF.\n13.\tThe V-SMF invokes Neasdf_DNSContext_Create Request to the selected V-EASDF. The DNS messages for the EC service to be offloaded to the VPLMN are configured to be handled as step 15a-16a. For other DNS messages, they are configured to be forwarded to the DNS server related to the HPLMN.\n14.\tThe EASDF invokes the service operation Neasdf_DNSContext_Create Response.\n15a.\tIf V-SMF has received the EAS deployment information in steps 2-3, V-SMF sends the PCO generated by H-SMF to UE and indicates UE to resend the DNS Query message to V-EASDF.\n16a.\tSteps 7-19 in clause 6.2.3.2.2 of TS 23.548 [3] are performed.\n15b.\tIf V-SMF did not receive the EAS deployment information in steps 2-3, and V-SMF received the application related information (e.g. DNAI, local DNS server address), V-SMF sends the PCO generated by H-SMF to UE and indicates UE to resend the DNS Query message to local DNS server.\n16b.\tSteps 1-6 in clause 6.2.3.2.3 of TS 23.548 [3] are performed.\nAfter the whole above procedure, if the UE sends out a DNS query which intends for Home PLMN DNS processing, while using the V-EASDF or Local DNS server address as the target IP address (since in step 15a and 15b the UE PCO is updated with V-EASDF or Local DNS server address), the V-UL-CL and V-UPF should identify the FQDN and decide whether the DNS query should be sent to Home PLMN network. If yes, V-UPF should send the DNS query to H-UPF, and H-UPF should change the target IP address in the DNS query into Home PLMN DNS address, based on the N4 rule from H-SMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.1.3\tImpacts on services, entities and interfaces",
                            "text_content": "For 6.1.2.1\nH-SMF:\n-\tobtains the indication to authorize V-SMF to perform local traffic routing in VPLMN and VPLMN ECS address from UDM;\n-\tSends the indication and VPLMN ECS address to V-SMF\nH-UDM:\n-\tIn the UE subscription data, the indication and VPLMN ECS address are configured.\nV-SMF:\n-\tobtains the indication to perform local traffic routing in VPLMN from H-SMF;\n-\tobtains VPLMN ECS address from H-SMF;\n-\tsupports to insert UL-CL and local PSA UPF for local traffic routing in VPLMN.\nFor 6.1.2.2\nV-SMF:\n-\tWhen V-SMF recognises the DNN, it will select a PCF in VPLMN and establish a SM Policy Association with the V-PCF;\n-\tV-SMF sends the V-PCF related PCC rules to V-UPF through N4;\n-\tinteracts with V-EASDF by reusing the interface between SMF and EASDF defined in TS 23.548 [3];\n-\trequests local traffic routing from H-SMF;\n-\tsends the V-EASDF address/local DNS address to H-SMF.\nV-PCF:\n-\tinvolved with the HR PDU Session and provides PCC instructions to V-SMF.\nV-UPF:\n-\tdetects the DNS query and notifies the V-SMF.\nH-SMF:\n-\tsends the indication to authorize V-SMF to perform local traffic routing in VPLMN;\n-\tH-SMF gets this indication from H-UDM.\n-\tcreates the PCO including V-EASDF/Local DNS address;\n-\tconfigures the H-UPF with changing the target IP address of the DNS query into Home PLMN DNS address.\nH-UPF:\n-\tchanges the target IP address of the DNS query into Home PLMN DNS address.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.2\tSolution 02 (KI#1): Session Breakout in Visited PLMN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tDescription",
                            "text_content": "This solution corresponds to KI#1 and addresses the scenario 2.2, that is, UE accessing V-EHE via a Home Routed (HR) PDU Session (i.e. with PSA in HPLMN) where HPLMN does not have the knowledge of EAS deployment information in VPLMN as described in clause 5.1.2.\nThis solution corresponds to KI#1 and addresses the following aspects for the scenario using a PDU Session with a PSA in the HPLMN:\n-\thow to authorize the PDU Session to support local traffic routing to access an EHE in the VPLMN;\n-\thow to support Rel-17 edge computing related procedures, such as EAS (re-)discovery, as specified in clause 6 of TS 23.548 [3].\nWhen roaming, the UE establishes a Home Routed Session that is capable of supporting session breakout in V-PLMN based on the subscription. In this scenario, the Home PLMN and Visited PLMN have an agreement on the support of the session breakout for the home routed session.\n1)\tDuring the establishment of Home Routed PDU Session, Home PLMN allows the roaming UE to access the local part of DN identified by DNN based on its HPLMN subscription.\n2)\tV-SMF in V-PLMN executes the session breakout procedure for the UE to access the local part of DN where the EAS in EHE is located in VPLMN. This can be triggered by the EAS discovery procedure using V-EASDF.\n3)\tThrough a Home Routed Session, the UE can access EAS deployed in EHE in VPLMN while the UE can also access the Home DN in the Home PLMN.\nNOTE:\tThe companion solution #26 in clause 6.26 explains the policy and charging aspect of this solution.\nThe architecture for Home Routing Session Breakout in Visited PLMN is depicted in Figure 6.2.1-1, illustrating the various components and their interconnections. The figure shows the home router (HR) as the central node, responsible for routing packets to the appropriate PLMN. The HR is connected to the PLMN through a series of hops, including the PLMN's home gateway (HG), the PLMN's home router (HR), and the PLMN's home gateway (HG). The figure also includes the PLMN's home gateway (HG), the PLMN's home router (HR), and the PLMN's home gateway (HG) as part of the network. The figure highlights the importance of network segmentation and the use of routing protocols to ensure efficient and reliable communication.\nFigure 6.2.1-1: Architecture for Home Routing Session Breakout in Visited PLMN\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tProcedure",
                            "text_content": "The figure depicts the PDU Session Establishment Procedure for HR Session Breakout in a VPLMN (Virtual Private LAN). It illustrates the steps involved in initiating a new HR Session Breakout in a VPLMN, including the PDU Session Establishment, PDU Session Initiation, and PDU Session Termination. The figure includes a flowchart and a diagram of the VPLMN, highlighting the key components and their interactions.\nFigure 6.2.2-1: PDU Session Establishment Procedure for HR Session Breakout in VPLMN\n1-4.\tDuring the registration procedure, the UDM sends the Home Routed Visited SBO (HR-VSBO) allowed indication to the AMF.\n5-8.\tDuring the PDU Session establishment procedure, if the AMF receives the HR-VSBO allowed indication and AMF selects V-SMF supporting UL-CL with V-EASDF interaction, the AMF sends the HR VSBO allowed indication to the V-SMF.\n9.\tIf the V-SMF decides to create HR VSBO session, V-SMF sends the VSBO request and V-EASDF/DNS server address of VPLMN to the H-SMF. The HPLMN allowed local DN configuration is configured with the V-SMF per DNN/S-NSSAI.\n10-11.\tThe H-SMF checks whether the HR-VSBO is allowed based on its local configuration or subscription.\n12.\tThe H-SMF establishes N4 session with H-UPF.\n13.\tH-SMF checks whether the HR VSBO is allowed for the UE. If allowed, the H-SMF sends the VSBO grant indication with DNS server address set to the V-EASDF in PCO and Home DNS Server address to the V-SMF. The H-SMF may send the HPLMN allowed V-SBO information to the V-SMF. The HPLMN allowed V-SBO information includes the IP address ranges and DNS domain name range within which the V-SMF is allowed to route traffic.\nNOTE 1:\tIf the H-SMF grants the HR-VSBO request, the V-SMF is allowed to offload for accessing the EHE in VPLMN without further control from HPLMN.\n14-15.\tThe V-SMF may perform the Local UPF insertion (or UL-CL insertion) procedure. The V-SMF determines the UL-CL filters based on the V-SBO information provided by the H-SMF in step 13. Steps 14 and 15 show how local UPF insertion can be performed in the middle of the PDU Session Establishment.\n16.\tAfter the V-SMF performs Local UPF insertion for the local part of DN, the V-SMF performs the DNSContext creation procedure to send the DNS Message Handling Rules and Home DNS Server Address to the V-EASDF.\nNOTE 2:\tWith configured DNS Message Handling Rules configured to V-EASDF, all the DNS Queries using this PDU Session go to the V-EASDF, and DNS resolution for the local routed traffic is handled based on the Rel-17 mechanism for EAS discovery using EASDF. DNS Queries that do not match the rule configured by V-SMF go to the Home DNS Server.\nNOTE 3:\tStep 12 can be performed when the Local UPF insertion procedure after the PDU Session Establishment.\nNOTE 4:\tV-SMF can use the EAS Deployment Information provisioned from the AF using the existing procedures described in the clauses 6.2.3.4.2, 6.2.3.4.3 of TS 23.548 [3] to determine DNS Message Handling Rules. V-SMF also uses the V-SBO information provided by H-SMF for DNS Message Handling Rules.\n17-18.\tThe AMF forwards the PDU Session Establishment Accept/Reject to the UE.\n19-21.\tThe EAS (re)-discovery over Session Breakout Connectivity Model as specified in clause 6.2.3 of TS 23.548 [3] can be performed among the UE, V-SMF and V-EASDF based on the UE DNS Query so the UE can access EHE in VPLMN. With the same PDU Session, the UE can still access DN in HPLMN at the same time. Receiving the DNS Query from the UE, the V-EASDF checks whether FQDN can be locally served. If FQDN is for visited network, the V-EASDF exchanges DNS Query and Response with Visited DNS server. Otherwise, the V-EASDF exchanges DNS Query and DNS Response with Home DNS server.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tImpacts on services, entities and interfaces",
                            "text_content": "AMF:\n-\tThe AMF is required to select the V-SMF supporting Visited Session Breakout for Home Routed Session and forward the Home Routed Session Breakout indication to the V-SMF.\nV-SMF:\n-\tThe V-SMF is required to request the Visited Session Breakout with the V-EASDF/DNS server address of VPLMN to the H-SMF.\n-\tThe V-SMF is required to interact with V-EASDF by reusing the interface between SMF and EASDF defined in TS 23.548 [3], including creating DNS message handling Rules using the received DNS server address using the DNS server address of HPLMN provided by the H-SMF.\nH-SMF:\n-\tThe H-SMF is required to authorize the V-SMF request for Visited Session Breakout.\n-\tThe H-SMF is required to send the V-SMF provided V-EASDF/DNS server address to the UE via V-SMF.\n-\tThe H-SMF is required to provide the DNS Server address of HPLMN to the V-SMF.\n-\tThe H-SMF is required to provide HPLMN allowed Visited Session Breakout information including the range of IP addresses and FQDN during the establishment of the Home Routed Session to the V-SMF.\nUDM:\n-\tThe subscription information of UDM is required to support the indication for Home Routed Session Breakout.\nV-EASDF:\n-\tThe V-EASDF is required to support the DNS message rule including the default DNS server address indicating all DNS Queries that do not match other rules should be forwarded.\nNOTE:\tIt is assumed that the functionalities of SMF and EASDF in Rel-17 to support edge computing in home network for non-roaming scenario are also required to be supported by V-SMF and V-SMF in VPLMN for roaming scenario.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tSolution 03 (KI#1): EAS (re)discovery procedure in roaming scenario",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tDescription",
                            "text_content": "KI#1 proposes the scenario: Accessing EHE in a VPLMN when roaming. This solution addresses one of these specific scenarios, i.e. UE accessing V-EHE for a PDU Session with a PSA in HPLMN and assumes that HPLMN does not have the knowledge of EAS deployment information in VPLMN.\nThis solution proposes EAS (re)discovery procedure in V-EHE by transmitting a newly defined EC enabling indicator between V-SMF and H-SMF and using the V-EASDF. The UL-CL functionality is used to combine the features of HR and LBO roaming and steer local traffic to the local V-PSA. To minimize the impact of UE, UE is not aware of DNS server changing in HR roaming scenario.\nNOTE 1:\tAccording to the roaming agreement between HPLMN and VPLMN, DNS security issue (i.e. using EASDF IP replacement mechanism) can be resolved based on mutual trust between operators.\nNOTE 2:\tThis EC enabling indicator means that VPLMN can apply the traffic offload related to EC service (e.g. UL-CL insertion for EC traffic) without any further HPLMN control.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tProcedures",
                            "text_content": "When a UE that has established an HR PDU Session expects to use edge computing service, the UE may send a DNS query to the DNS server, the corresponding EAS discovery procedure is shown in figure 6.3.2.1-1:\nThe figure depicts the EAS (Emergency Alert System) discovery procedure in a roaming scenario, where the EAS is accessed to detect and alert users in case of an emergency. The figure shows the steps involved in the EAS discovery process, including the use of V-EHE (Vehicle-to-Electronic Head-Up Display) technology. The figure also highlights the importance of proper EAS setup and maintenance to ensure effective communication and alerting capabilities.\nFigure 6.3.2.1-1: EAS discovery procedure accessing V-EHE in roaming scenario\n1.\tUE requests PDU Session establishment for HR roaming as described in clause 4.3.2.2.2 of TS 23.502 [9]. During the PDU Session Establishment procedure, the H-SMF may consider the UE subscription information to select a H-DNS server for the PDU Session. H-SMF sends H-DNS server IP address included in PCO to UE via V-SMF.\nH-SMF may indicate to the UE either that for the PDU Session the use of the EDC functionality is allowed or that for the PDU Session the use of the EDC functionality is required.\nIf V-SMF does not store the EC enabling indicator per PDU Session level, V-SMF sends an EC enabling indicator request to H-SMF.\nH-SMF respond with a positive EC enabling indicator to V-SMF to indicate that the HPLMN authorizes VPLMN to manage the EC service according to the roaming agreement between these two operators and UE is unaware of potential DNS server changing. H-SMF also sends the IP address of H-DNS server to V-SMF.\nAccording to the roaming agreement, a FQDN list for EC service in VPLMN is preconfigured on the V-SMF. And V-SMF selects V-EASDF based on the local configuration. V-SMF drives related DNS message handling rule based on EAS deployment information provided by V-PLMN AF and/or local configuration and sends this DNS message handling rule to V-EASDF via Neasdf_DNSContext_Create request.\nNOTE 1:\tV-EASDF selection is triggered in HR PDU Session establishment procedure based on the roaming agreement and the positive EC enabling indicator.\nV-SMF uses the FQDN list to derive a traffic routing rule. This traffic routing rule is provided to V-UPF (with UL-CL functionality), e.g. V-UPF routes DNS Queries for an FQDN (range) query to V-EASDF, and routes other traffic to H-PSA.\nV-SMF configures V-UPF with EASDF IP replacement information (i.e. H-DNS server IP address and port number, V-EASDF IP address and port number). In uplink direction, V-UPF replaces the destination address of the DNS query with corresponding FQDN from H-DNS server to V-EASDF; in downlink direction, V-UPF replaces the source address of the DNS response with corresponding FQDN from V-EASDF to H-DNS server so that the UE is not aware of the change of DNS server.\nNOTE 2:\tThis configuration refers to the option D of session breakout connectivity model in TS 23.548 [3] and assumes that V-UPF (with UL-CL functionality) steering is based on L4 information (i.e. DNS port number) and that V-UPF (with UL-CL functionality) has visibility of the DNS traffic (i.e. FQDN in the DNS Query message).\n2.\tUE sends DNS query to H-DNS server.\n3a.\tIf the DNS query does not match the FQDN list, V-UPF delivers the DNS query to H-PSA via N9 tunnel and H-PSA delivers the DNS query to H-DNS server.\n3b.\tIf the DNS query matches the FQDN list, V-UPF delivers the DNS query to V-EASDF using EASDF IP replacement. The following EAS discovery procedure is based on step 3b.\n4.\tIf the DNS Query message matches a DNS message detection template of DNS message handling rule for reporting, the V-EASDF sends the DNS message report to V-SMF by invoking Neasdf_DNSContext_Notify Request.\n5.\tV-SMF responds with Neasdf_DNSContext_Notify Response.\n6.\tV-SMF updates DNS message handling rule if needed. V-SMF sends this DNS message handling rule to V-EASDF via Neasdf_DNSContext_Update request.\n7.\tV-EASDF responds with Neasdf_DNSContext_Update response.\n8.\tV-EASDF handles the DNS query according to the DNS message handling rule and sends the DNS query to the DNS server in VPLMN, the V-DNS server returns the DNS response including EAS IP address and FQDN to V-EASDF.\n9.\tV-EASDF sends the DNS response to the V-SMF by invoking Neasdf_DNSContext_Notify request including EAS information if the EAS IP address or the FQDN in the DNS response matches the DNS message detection template provided by the V-SMF as described in clause 6.2.3.2.2 of TS 23.548 [3], and V-EASDF buffers this DNS response.\n10.\tV-SMF responds with Neasdf_DNSContext_Notify Response.\n11.\tBased on EAS information received from the V-EASDF in Neasdf_DNSContext_Notify and other UPF selection criteria, V-SMF may determine the DNAI and determine the associated N6 traffic routing information for the DNAI based on local configuration. V-SMF may perform V-UL-CL and V-PSA selection and insertion as described in TS 23.502 [9].\nV-SMF configures the V-UL-CL with CN tunnel info provided by V-UPF and V-PSA and with AN tunnel info provided by serving AN. The traffic routing rules are provided to V-UL-CL based on EAS information, e.g. V-UL-CL routes the traffic to V-PSA if the IP packet has a destination address of V-EAS and routes other traffic to V-UPF.\nV-SMF configures the Usage Report Rule on V-PSA for traffic charging. V-PSA collects and reports the charging information between UE and V-EAS based on the corresponding URR.\n12. V-SMF invokes Neasdf_DNSContext_Update Request (DNS message handling rule). The DNS message handling rule with the Control Action \"Send the buffered DNS response(s) message to UE\" indicates the V-EASDF to send the DNS response buffered in step 9 to UE via V-UPF.\n13.\tV-EASDF responds with Neasdf_DNSContext_Update response.\n14.\tIf it is indicated to send the buffered DNS response to UE in step 12, the V-EASDF sends the DNS response to the V-UPF. V-UPF replaces the source address from V-EASDF to H-DNS server in the DNS response based on the V-SMF instructions and sends this DNS response to the UE via V-UL-CL.\n15.\tFor traffic charging between UE and V-EAS, V-PSA collects and reports the charging information based on the corresponding URR.\nThe support for EAS rediscovery indication procedure enables the UE to refresh stale EAS information stored locally so that the UE can trigger EAS discovery procedure to discover new EAS information as described in clause 6.2.3.3 of TS 23.548 [3]. The corresponding EAS rediscovery procedure is shown in figure 6.3.2.2-1:\nThe figure depicts the EAS rediscovery procedure in a roaming scenario, showing the steps taken to access V-EHE (Virtual Enhanced High-Energy) in the EAS (Enhanced Airborne System) network. The figure illustrates the process of rediscovery, which involves identifying and reactivating the EAS system in the event of a lost or degraded signal. The steps include checking the EAS status, identifying the affected area, and initiating the rediscovery process. The figure also shows the use of V-EHE, which is a high-energy signal used in the EAS system, to enhance the signal quality in the affected area.\nFigure 6.3.2.2-1: EAS rediscovery procedure accessing V-EHE in roaming scenario\n0.\tThe procedure in clause 6.3.2.1 executes with following difference to apply to EAS rediscovery:\nIn step 1, the UE may indicate its support for refreshing stale EAS information stored locally corresponding to the impact field per the EAS rediscovery indication from network to the V-SMF during the HR PDU Session Establishment procedure.\nNOTE 1:\tIf the UE indicates such support, V-SMF may store this indication in the PDU Session context.\n1a.\tDue to the UE mobility the V-SMF triggers V-PSA insertion, change or removal for the PDU Session. The insertion, change or removal of V-PSA triggers EAS rediscovery.\nNOTE 2:\tThis solution does not cover EAS rediscovery scenario triggered by AF.\n2.\tV- SMF sends PDU Session Modification Command (EAS rediscovery indication, [impact field]) to UE as described in step 2 of clause 6.2.3.3 of TS 23.548 [3], with the following differences:\nV-SMF sends the impact field with the EAS rediscovery indication if the UE supports this indication.\nIf V-SMF chooses new V-EASDF for the PDU Session, it does not provide the V-EASDF IP address to UE. V-SMF may configure V-UPF with the updated traffic routing rule (e.g. V-UPF routes DNS Queries for an FQDN (range) query to the new V-EASDF) and with corresponding EASDF IP replacement information (i.e. H-DNS server IP address and port number, new V-EASDF IP address and port number) as described in step 1 of clause 6.3.2.1.\nUE refreshes DNS record according to EAS rediscovery indication received from V-SMF.\n3.\tUE may trigger EAS discovery procedure to get new EAS information. This DNS query is sent to corresponding DNS server using IP address replacement in VPLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.3\tImpacts on existing entities and interfaces",
                            "text_content": "H-SMF:\n-\tsends H-DNS server IP address and an EC enabling indicator to V-SMF in the HR PDU Session establishment procedure.\nV-SMF:\n-\tidentifies the EC enabling indicator and manages the EC service for UE in VPLMN;\n-\tselects and inserts the V-UL-CL and V-PSA based on local policy and does not need to interact with H-SMF;\n-\tstores the indication which indicates that UE supports to refresh stale EAS information stored locally corresponding to the impact field per the EAS rediscovery indication from network in the PDU Session context;\n-\tsends the EAS rediscovery indication including the impact field to UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.4\tSolution 04 (KI#1): Support EAS (re-)discovery in VPLMN via HR PDU Session",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.4.1\tDescription",
                            "text_content": "This solution corresponds to KI#1. The scenarios 2.1 and 2.2 are described in clause 5.1.2.\nAs described in clause 5.1.2, a roaming UE may access V-EHE via an established HR PDU Session. To support such scenario, session breakout to access EHE in VPLMN is used. The following aspects are included:\n-\tThe H-PCF provides authorization policy which indicates local traffic routing in VPLMN is authorized for the UE accessing the VPLMN.\n-\tUL-CL/BP and local PSA insertion.\nThe V-SMF performs selection and insertion of UL-CL/BP and local PSA based on UE location when receiving the authorization policy from H-SMF without considering EAS deployment information in VPLMN. In this case, UL-CL/BP is selected based on UE location.\nFor scenario 2.1, the V-SMF may select and insert UL-CL/BP and local PSA based on UE location and target DNAI after PDU Session is established. The V-SMF selects target DNAI based on DNAIs received from H-SMF. The DNAIs are determined by H-SMF based on EAS IP report from H-EASDF. In this case, UL-CL/BP is selected based on UE location and selected EAS IP address.\n-\tEAS discovery using H-EASDF.\nFor scenario 2.1, the H-SMF obtains ECS option/local DNS server from V-SMF during DNS based EAS discovery procedure and send it to H-EASDF. The H-EASDF handles DNS queries including FQDNs deployed in VPLMN based on the ECS option/local DNS server as defined in TS 23.548 [3]. In this case, different FQDNs may use different ECS option/local DNS Server.\nFor scenario 2.2, the H-SMF obtains ECS option/local DNS server from V-SMF during PDU Session Establishment and send it to H-EASDF. The H-EASDF handles all DNS queries of the UE based on this ECS option/local DNS server. In this case, all DNS queries requested by the UE will share same ECS option/local DNS server.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.2\tProcedures",
                            "text_content": "Figure 6.4.2.1-1 shows the procedure of EAS discovery in VPLMN via HR PDU Session.\nThe figure depicts the EAS discovery process in a VPLMN (Virtual Private LAN) network, highlighting the use of HR PDU Session for efficient discovery of Enhanced Air Traffic Management (EAS) systems.\nFigure 6.4.2.1-1: EAS discovery in VPLMN via HR PDU Session\n1.\tUE sends PDU Session establishment request to V-SMF.\n2.\tThe V-SMF sends Nsmf_PDUSession_Create Request to H-SMF.\nFor scenario 2.2 where HPLMN does not have the knowledge of EAS deployment in VPLMN, the V-SMF may, based on UE location, send information to build ECS option/local DNS server for the VPLMN from V-SMF to H-SMF.\n3.\tThe H-SMF receives authorization policy which indicates whether local traffic routing in the VPLMN is authorized from H-PCF.\nThe content of authorization policy includes the following information:\n-\tLocal Traffic Routing Authorization Indication. The indication is used to indicate whether local traffic routing in VPLMN is authorized.\n-\tTraffic description information, e.g. FQDN(s), EAS IP(s). The traffic description information is used to indicate the corresponding specific traffic is authorized to perform local traffic routing in VPLMN.\n4.\tH-SMF invokes Neasdf_DNSContext_Create Request including DNS handling rule to H-EASDF.\nFor scenario 2.2, the H-SMF may send the information to build ECS option/local DNS server as described in step 2 to the H-EASDF.\n5.\tThe H-SMF sends Nsmf_PDUSession_Create Response including authorization policy to the V-SMF.\nThe H-SMF sends H-EASDF address to the V-SMF.\n6.\t[Conditional] The V-SMF performs UL-CL/BP and local PSA selection and insertion if the authorization policy indicates local traffic routing in the VPLMN is authorized for the traffic indicated by Traffic description information in the authorization policy. In this case, the V-SMF selects DNAI for the UL-CL/BP insertion based on UE location.\nThe V-SMF also interacts with H-SMF to establish N9 tunnel between the UL-CL/BP and PSA controlled by H-SMF. Details can be found in steps 4-5 in clause 4.23.9.1 of TS 23.502 [9] by replacing I-SMF with V-SMF and SMF with H-SMF.\nTo support charging in both PLMNs, the V-SMF provides Usage Reporting Rules to the UL-CL/BP and local PSA to collect Usage Report for charging in VPLMN.\nNOTE 1:\tThe interactions between H/V-SMF and H/V-CHF are not in the scope of SA2.\nThe V-SMF forwards the Usage Report to the H-SMF. The H-SMF aggregates and constructs usage reports towards H-CHF.\n7.\tThe V-SMF sends PDU Session Establishment accept message including the H-EASDF address to UE.\n8.\tUE sends DNS query which includes FQDN deployed in the VPLMN to the H-EASDF.\nFor scenario 2.1, H-SMF may obtain ECS option/local DNS server from V-SMF by performing steps 9-12:\n9.\tThe H-EASDF reports the FQDN to H-SMF by invoking Neasdf_DNSContext_Notify Request.\nH-SMF determines candidate DNAIs of VPLMN corresponding the FQDN based on the EAS deployment information in the VPLMN. H-SMF may consider UE location to select the candidate DNAIs of VPLMN in this step. (steps 10-12)\n10.\tThe H-SMF initiates Nsmf_PDUSession_Update Request service including FQDN to the V-SMF.\n11.\tV-SMF determines the target DNAI based on UE location and provides information to build ECS option or local DNS server to H-SMF based on the target DNAI.\n12.\tH-SMF invokes Neasdf_DNSContext_Update Request to H-EASDF including updated DNS handling rule, e.g. information to build ECS option or local DNS server.\n13.\tThe H-EASDF adds ECS option into the DNS query and sends it to C-DNS server, or sends the DNS query to the local DNS server if the DNS query matches the DNS handling rule as described in clause 6.2.3 of TS 23.548 [3].\nH-EASDF receives the DNS Response including EAS IP address which is determined by the DNS system.\nFor scenario 2.1, H-SMF may trigger V-SMF selecting and inserting UL-CL/BP and local PSA by performing steps 14-16:\n14.\tThe H-EASDF invokes Neasdf_DNSContext_Notify Request including EAS IP to the H-SMF based on DNS handling rule.\n15.\tThe H-SMF triggers the V-SMF to perform UL-CL/BP and local PSA selection and insertion as described in step 6 of clause 4.23.9.1 in TS 23.502 [9] by replacing I-SMF as V-SMF and SMF as H-SMF.\nH-SMF determines target DNAI of VPLMN corresponding the EAS IP based on the EAS deployment information in the VPLMN.\nThe H-SMF initiates Nsmf_PDUSession_Update Request service including target DNAI of VPLMN to the V-SMF.\nThe V-SMF selects and inserts UL-CL/BP and local PSA based on the target DNAI.\nThe V-SMF also interacts with H-SMF to establish N9 tunnel between the UL-CL/BP and PSA controlled by H-SMF. Details can be found in steps 4-5 in clause 4.23.9.1 of TS 23.502 [9] by replacing I-SMF with V-SMF and SMF with H-SMF.\nThe V-SMF sends Nsmf_PDUSession_Update Response to H-SMF.\n16.\tThe H-SMF invokes Neasdf_DNSContext_Update Request to trigger the H-EASDF sending DNS response to UE.\n17.\tThe H-EASDF sends the DNS response including the EAS IP to UE.\nFigure 6.4.2.2-1 shows the procedure of EAS rediscovery in VPLMN via HR PDU Session.\nThe figure depicts the rediscovery of Enhanced Access Services (EAS) in a Virtual Private LAN/Multi-Tenant Network (VPLMN) via a Hybrid Radio PDU Session (HR PDU). The diagram illustrates the process of rediscovery, which involves identifying and reactivating EAS services in a VPLMN. The figure includes key components such as the EAS rediscovery process, the Hybrid Radio PDU Session, and the reactivation of EAS services.\nFigure 6.4.2.2-1: EAS rediscovery in VPLMN via HR PDU Session\nWhen UE moves with V-SMF insertion/change/remove, the procedure is performed from step 1. When UE moves without V-SMF change, the procedure is performed from step 2.\n1.\tThe procedure described in clause 4.23.7 (N2 based handover) or 4.23.11 (Xn based handover) of TS 23.502 [9] is performed by replacing I-SMF with V-SMF and SMF with H-SMF.\n1a1.\t(V-SMF insertion) The (target) V-SMF retrieves SM context requests SM context from H-SMF.\n1a2.\t(V-SMF change) The target V-SMF retrieves SM context from the source V-SMF.\n1b.\tSMF (H-SMF / source V-SMF) to target V-SMF: Nsmf_PDUSession_Context Response including the N9 FTEID/IP address of the H-UPF. The SMF responds with the requested SM context which includes authorization policy from H-SMF. The SM context also includes impact field corresponding to the old target DNAI if it has been inserted by H-SMF. Additionally, in case the PLMN ID received from the V-SMF in Nsmf_PDUSession_Context Request is different from H-SMF's own PLMN ID, the H-SMF provides the N9 FTEID/IP address of the H-UPF to the Target V-SMF.\n1c.\tThe target V-SMF selects a target V-UPF: based on the received SM context, e.g. S-NSSAI and UE location information, and the N9 FTEID/IP address of the H-UPF, the target V-SMF selects a target V-UPF complying with the QoS/delay requirements.\nFor the V-SMF remove case, step 2 and steps 4-5 are skipped, only steps 3 and 6 are performed.\nAfter the handover procedure, the (target) V-SMF performs UL-CL/BP and local PSA insertion/change/removal as described in clause 4.23.9 of TS 23.502 [9] by replacing I-SMF with V-SMF and SMF and H-SMF. Differences are shown as steps 2 to 5:\n2.\tThe (target) V-SMF invokes Nsmf_PDUSession_Update Request (new target DNAI if available and corresponding information to build ECS option) to SMF.\nFor the case of local PSA removal, the request message is sent to SMF without including any DNAI.\n3.\tThe H-SMF determines DNAI is changed and updates DNS handling rules towards the H-EASDF by invoking Neasdf_DNSContext_Update service.\n4.\tThe H-SMF initiates Nsmf_PDUSession_Update Request towards the (target) V-SMF.\n5.\tThe V-SMF initiates PDU Session Modification command (EAS rediscovery indication and impact field) to UE.\nThe impact field corresponds to the new target DNAI and old target DNAI.\nFor the case of local PSA insertion/change, the (target) V-SMF determines the impact field based on the new target DNAI. Based on the received impact field in step 1 corresponding to old target DNAI, the target V-SMF determines the final impact field corresponding to the new target DNAI and old target DNAI.\nFor the case of local PSA removal, as there is no new target DNAI, there is no impact field corresponding to the new target DNAI.\n6.\t(V-SMF removal case) The H-SMF initiates PDU Session Modification command to UE.\nFor scenario 2.1, as the H-SMF has the knowledge of EAS deployment information in VPLMN, the H-SMF determines the impact field corresponding to old target DNAI inserted by the removed V-SMF. Then the H-SMF sends EAS rediscovery indication and the impact field to the UE.\nFor scenario 2.2, as the H-SMF does not have the knowledge of EAS deployment information in VPLMN, the H-SMF only sends EAS rediscovery indication to the UE.\nFor EAS rediscovery triggered by AF, if the AF can interact with the HPLMN via H-NEF, the EAS re-discovery procedure is performed from step 4.\nNOTE:\tFor the AF that cannot interact with HPLMN via H-NEF, the EAS rediscovery triggered by AF is not supported in this Release.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.4.3\tImpacts on services, entities and interfaces",
                            "text_content": "EAS discovery:\nH-PCF:\n-\tretrieves and sends authorization policy to H-SMF which indicates local traffic routing in VPLMN is authorized.\nH-SMF:\n-\tsends H-EASDF address to V-SMF;\n-\tsends authorization to V-SMF;\n-\treceives information to build ECS option/local DNS server from V-SMF;\n-\treceives Usage Report corresponds to local routed traffic in VPLMN from V-SMF;\n- \tin case the PLMN ID sent by V-SMF is different from H-SMF's own PLMN ID, the H-SMF provides in Nsmf_PDUSession_Context Response the N9 FTEID/IP address of the H-UPF to the target V-SMF;\n-\tfor scenario 2.1:\n-\tsends FQDN to V-SMF.\n-\tfor scenario 2.2:\n-\tconfigured with information to build ECS option/local DNS server.\nV-SMF:\n-\treceives H-EASDF address from H-SMF;\n-\treceives authorization policy from H-SMF;\n-\tsends Usage Report corresponds to local routed traffic in VPLMN;\n-\tthe target V-SMF selects a target V-UPF based on the received SM context, e.g. S-NSSAI and UE location information, and the N9 FTEID/IP address of the H-UPF;\n-\tfor scenario 2.1:\n-\treceives FQDN from H-SMF;\n-\tdetermines information to build ECS option/local DNS server based on candidate DNAIs and UE location;\n-\tsends information to build ECS option/local DNS server to H-SMF;\n-\treceives target DNAI from H-SMF and perform UL-CL/BP insertion.\n-\tfor scenario 2.2:\n-\tsends ECS Option/local DNS server of the VPLMN to H-SMF;\n-\tdetermines DNAI and perform UL-CL/BP insertion based on the UE location and authorization policy.\nV-NRF:\n-\tadditionally receives the N9 IP address of the H-UPF in NRF discovery request from target V-SMF;\n-\tprovides candidate list of V-UPFs to target V-SMF based on S-NSSAI and UE location information, and the N9 IP address of the H-UPF.\nEAS rediscovery:\nV-SMF:\n-\t(V-SMF insertion/change) receives SM context including authorization policy and impact field corresponding to old target DNAI from source V-SMF/H-SMF;\n-\t(V-SMF insertion/change) determines impact field based on new target DNAI and impact field received from V-SMF/H-SMF.\nH-SMF:\n-\t(V-SMF insertion) sends SM context including authorization policy and impact field corresponding to old target DNAI to V-SMF;\n-\t(V-SMF removal) initiates PDU Session modification procedure for EAS rediscovery.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.5\tSolution 05 (KI#1): Accessing V-EHE via HR PDU Session",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.5.1\tDescription",
                            "text_content": "The following solution corresponds to the key issue #1 on Accessing EHE in a VPLMN when roaming as specified in clause 5.1.\nThe UE establishes a Home Routed PDU Session using session breakout to access the EHE in VPLMN. The V-SMF determines the HR PDU Session for V-EHE should be activated based on the EAS information and roaming offload policy received from H-PCF via H-SMF, and configures the traffic routing rule and Usage Report Rule to assist traffic offload to V-EAS and usage information report from UL-CL V-UPF or BP V-UPF to H-SMF via V-SMF for offline and online charging.\nThe figure depicts a scenario where UP traffic and CP signalling are used for accessing V-EHE via a HR PDU session. It illustrates the flow of data between the UP and CP, highlighting the use of signalling protocols for reliable communication.\nFigure 6.5.1-1: UP traffic and CP signalling for scenario of accessing V-EHE via a HR PDU Session\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.2\tProcedures",
                            "text_content": "The figure depicts a V-EHE (Virtual-Equipment-to-Equipment) session, where a V-EHE device is connected to a HR PDU (Human Resources) device. The session is accessed via a S (Session) device, which is connected to the HR PDU. The figure illustrates the communication path and the connections between the V-EHE device and the HR PDU.\nFigure 6.5.2.1-1: Accessing V-EHE via a HR PDU Session\n1.\tThe UE initiates a Home Routed PDU Session establishment procedure with V-SMF.\n2.\tThe V-SMF sends Nsmf_PDUSession_Create Request to H-SMF.\n3.\tThe H-PCF may provide the authorized roaming offload policy to V-SMF via H-SMF. The roaming offload policy includes the specific Application Identifier(s) or FQDN set or IP range, and indicates if the Application Identifier or FQDN or EAS IP is satisfied, the HR PDU Session for V-EHE is activated (e.g. inserts a V-UPF accessing EAS). The H-SMF may also send the IP address of Home DNS server to V-SMF.\n4.\tThe V-SMF selects a V-EASDF, and the EAS Deployment Information in VPLMN is provisioned as specified in clause 6.2.3 of TS 23.548 [3]. The V-SMF includes the IP address of the V-EASDF as DNS server/resolver for the UE in the PDU Session Establishment Accept message. According to the roaming offload policy and the EAS Deployment Information, the V-SMF configures DNS message handling rules to V-EASDF. The V-EASDF handles all DNS queries based on the DNS message handling rules. If the requested FQDN matches the DNS message handling rule for VPLMN traffic routing, the V-EASDF decides to send the DNS Query to Local DNS server or C-DNS server (adding EDNS Client Subnet option). If the requested FQDN matches the DNS message handling rule for HPLMN traffic routing, the V-EASDF may send it to Home DNS server. The Home DNS server could be locally configured at V-SMF or received from H-SMF in step 3.\n5.\tThe UE sends a DNS Query message to the V-EASDF, and the V-EASDF performs EAS discovery as specified in clause 6.2.3 of TS 23.548 [3]. The discovered EAS information is reported to V-SMF.\n6.\tBased on the received EAS information (e.g. EAS IP address) and the roaming offload policy, the V-SMF decides to insert or relocate UL-CL/BP V-UPF and PSA V-UPF for traffic offload to the V-EAS.\n7.\tThe V-SMF configures traffic routing rule and Usage Report Rule on the UL-CL V-UPF or the BP V-UPF. The traffic routing rule includes EAS IP (for UL-CL) or IP prefix @local PSA (for BP) to route traffic towards the V-EAS. The Usage Report Rule is to request the report of the relevant usage information via monitoring traffic from UE to V-EAS, which is used for offline and online charging.\n8.\tUL and DL traffic routed between UE and V-EAS via UL-CL V-UPF or BP V-UPF. The UL-CL V-UPF or V-UPF collects and reports the usage information to V-SMF.\n9. The V-SMF sends usage information received from V-UPF to the H-SMF, and the H-SMF generates charging information. Alternatively, the V-SMF may generate the charging information, and sends both usage information and charging information to H-SMF.\nFigure 6.5.2.2-1 shows the procedure of EAS rediscovery in VPLMN via HR PDU Session.\nThe figure depicts the rediscovery of Enhanced Access Services (EAS) in a Virtual Private LAN/Multi-Tenant Network (VPLMN) via a Hybrid Radio PDU Session (HR PDU). The diagram illustrates the process of rediscovery, which involves identifying and reactivating EAS services in a VPLMN. The figure includes key components such as the EAS rediscovery process, the Hybrid Radio PDU Session, and the reactivation of EAS services.\nFigure 6.5.2.2-1: EAS rediscovery in VPLMN via HR PDU Session\n1a.\tDue to the UE mobility, the V-SMF insertion/change/remove is triggered, the procedure is performed as described in step 1 of clause 6.4.2.2 (solution #04).\n1b.\tIf the AF triggers EAS relocation, the H-AF provides the EAS deployment information and IP address of target EAS to network.\nThe H-SMF determines the target DNAI based on the EAS deployment information and IP address of target EAS. The H-SMF sends the target DNAI to the H-AMF by invoking Nsmf_PDUSession_SMContextStatusNotify service operation. The H-AMF selects V-SMF based on the target DNAI as described in clause 4.23.5.4 of TS 23.502 [9].\nIn the case of V-SMF insertion, the target V-SMF retrieves SM context which includes roaming offload policy and the information for EAS relocation from H-SMF. In case of V-SMF change, the target V-SMF retrieves SM context which includes roaming offload policy and the information for EAS relocation from the source V-SMF.\n2.\tThe procedure is performed as described in step 2 of clause 6.2.3.3 of TS 23.548 [3], with the following differences:\n-\tIn the case of V-PSA insertion/change, the (target) V-SMF determines the impact field based on the new target DNAI.\nAccording to the roaming offload policy and new target DNAI, the V-SMF may select a new V-EASDF and configures DNS message handling rules to (new) V-EASDF. The (new) V-EASDF handles all DNS queries based on the DNS message handling rules as described in clause 6.5.2.1.\n3.\tThe V-SMF sends PDU Session Modification Command (EAS rediscovery indication, [impact field]) to UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.5.3\tImpacts on services, entities and interfaces",
                            "text_content": "V-SMF:\n-\treceives the roaming offload policy included in PCC rule from H-PCF via H-SMF;\n-\tgenerates the DNS message handling rules according to the roaming offload policy and the EAS Deployment Information;\n-\tgenerates traffic routing rule and Usage Report Rule according to EAS information and roaming offload policy;\n-\tsends usage information (and charging information, if it is generated by V-SMF) to H-SMF;\n-\tinteracts with V-EASDF using the interface defined between SMF and EASDF in TS 23.548 [3], including configuring DNS message handling rules to EASDF according to the roaming offload policy;\n-\treceives the information for EAS relocation from source V-SMF/H-SMF.\nV-PCF:\n-\tcreates PCC rule that includes roaming offload policy.\nH-SMF:\n-\tsends the roaming offload policy to V-SMF;\n-\tsends the information for EAS relocation to V-SMF;\n-\treceives usage information (and charging information, if it is generated by V-SMF) from V-SMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.6\tSolution 06 (KI#1): URSP solution to support roamers access to EHE in a VPLMN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.6.1\tDescription",
                            "text_content": "UE not served by their home network should where possible (when allowed by their home network) benefit from traffic offload and Edge Computing capabilities deployed by their serving network.\nA solution is to leverage clause 6.6 of TS 23.548 [3] \"Support of AF Guidance to PCF Determination of Proper URSP Rules\" and clause 4.15.6.10 of TS 23.502 [9] \"Application guidance for URSP rules determination mechanisms\" as defined for Rel-17. This is to guide UE for traffic to be offloaded in the VPLMN to use a specific DNN and slice deployed in LBO mode while the rest of he traffic can use HR PDU Session(s).\nAn AF belonging to the VLMN reaching the NEF of the HPLMN (a roaming partner) indicates the (VPLMN) DNN and slices related with traffic offload / EC that it supports (according to clause 6.6 of TS 23.548 [3] and clause 4.15.6.10 of TS 23.502 [9]) this indication can be leveraged by the PCF of the HPLMN to (if authorized by HPLMN policies) provide dedicated URSP rules applicable to relevant users of the HPLMN when they are roaming in that VPLMN. These URSP may have a validity condition corresponding to the VPLMN location but should refer to S-NSSAI(s) defined by the HPLMN.\nNOTE 1:\tThe interaction from AF in VPLMN to the NEF in HPLMN does not involve the SEPP.\nThis interaction between the AF belonging to the VPLMN and the HPLMN NEF is not related to a specific UE, but is meant to cover all UEs matching the VPLMN related location criteria.\nThe AF belonging to the VPLMN provides HPLMN S-NSSAI(s) (that are determined from the VPLMN S-NSSAI(s)).\nNOTE 2:\tAs the VPLMN has the translation between HPLMN S-NSSAI(s) and the VPLMN S-NSSAI(s), translation is needed in the VPLMN to serve the HPLMN users.\nThe H-PCF may, based on local policies, determine whether to always send the URSP rules immediately to the UE or to send these rules only when the UE is served by the corresponding serving PLMN, e.g. waiting to be triggered from a V-PCF of that PLMN in step 3 of clause 4.6.11 of TS 23.502 [9].\nThe PCF of the HPLMN when it sends such URSP update to a UE, needs, as for Rel-17, to ensure that the DNN, S-NSSAI provided in the URSP rules sent to the UE is allowed in LBO mode in the user subscription (in UDM/UDR) even when the UE is roaming in that VPLMN.\nNOTE 3:\tThis solution can also apply for UEPO (see TR 23.700-85 [10]).\nThe VPLMN may provide Geographical or VPLMN location (e.g. VPLMN TAI or cells) related validity conditions for the URSP to apply. When the AF belonging to the VPLMN provides the HPLMN with VPLMN validity conditions, the VPLMN location information (e.g. VPLMN TAI or cells) contains a VPLMN ID that may be used by the H-PCF to understand that this information is specific for a VPLMN.\nDepending on H-PCF policies (on when to deliver URSP(s) valid in remote PLMN(s)) and on the situation (e.g. UE arriving rapidly in a new PLMN when for example the user arrives by plane in a remote country), it may take some time before URSP rules take effect in UE: it may happen that the UE gets URSP(s) applicable to the VPLMN while HR PDU Sessions have already been established. As defined in TS 23.503 [13], \"For every newly detected application the UE evaluates the URSP rules in the order of Rule Precedence and determines if the application is matching the Traffic descriptor of any URSP rule.\" Thus, it may happen that some traffic has started using HR PDU Sessions, but as soon as new application interactions start, corresponding traffic will gradually be moved to LBO PDU Sessions in the serving PLMN while already started IP flows may go on using the H-UPF.\nIt can happen that traffic that used to be served by a unique PDU Session while the UE was served by its HPLMN becomes served by 2 PDU Sessions when the UE roams in a VPLMN for which URSP guides it to use a LBO PDU Session for an application while it should use the initial PDU Session in HR mode for the rest of the traffic.\nNOTE 4:\tThis can happen regardless of Edge Computing.\nNOTE 5:\tBefore concluding this solution for normative work, alignment check with FS_eUEPO shall be done in order to avoid any conflict with the conclusion of KI#1 in TR 23.700-85 [10]. Final decision on generic URSP enhancement for supporting LBO roaming case should be made within FS_eUEPO study.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.2\tProcedures",
                            "text_content": "The solution reuses existing procedures.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.6.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "-\tThe VPLMN and the HPLMN as part of the roaming agreement need to ensure that an AF belonging to the VPLMN can contact the NEF of the HPLMN to use the API defined in clause 4.15.6.10 of TS 23.502 [9].\n-\tPotential UDM impact to ensure that the DNN, S-NSSAI provided in the URSP rules sent to the UE is allowed in LBO mode in the user subscription (in UDM/UDR) even when the UE is roaming in that VPLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.7\tSolution 07 (KI#1): Using URSP Rules to Establish an LBO PDU Session",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.7.1\tDescription",
                            "text_content": "This solution addresses that part of Key Issue #1 that considers how to establish the LBO PDU Session towards the correct S-NSSAI/DNN pair in order to access an EHE in the VPLMN.\nThe principles of this solution are:\n-\tIn Rel-17, a URSP rule can already be configured with Location Criteria that indicates to the UE that the route (i.e. PDU Session) should only be established, or used, when the UE served by certain cell(s), RAN node(s), or TAIs. This feature can be used to cause the UE to select a DNN/S-NSSAI combination that is appropriate for the PLMN where the UE is registered (e.g. an LBO Session). Location criteria is defined in TS 24.526 [11] and may be a list of cell(s), RAN node(s), or TAI(s). This solution proposes that Location Criteria can also include PLMN ID(s).\nNOTE:\tWhether a PLMN ID can be encoded as part of Location Criteria or encoded as a new validation criteria information element is left to stage 3.\n-\tWhen a route includes Location Criteria, a \"Revaluation Suggested\" indication can be added to the RSD. A \"Revaluation Suggested\" indication in the RSD indicates to the UE that the UE should re-evaluate URSP rules for traffic that uses the PDU Session if the Location Criteria becomes invalid and release the PDU Session no traffic is using the PDU Session after re-evaluation. In other words, the PDU Session may be released when the UE leaves the PLMN, cell(s), RAN node(s), or TAI(s) where the location criteria is valid and all traffic is moved to a different PDU Session (e.g. an LBO PDU Session).\n-\tTriggering re-evaluation will cause the UE to select a new route. The new route may include location criteria for the UE's new location and a PDU Session will be established with a DNN/S-NSSAI combination that is better suited for the UE's new location (e.g. for the PLMN where the UE is now registered).\nNOTE:\tIt is a UE implementation decision when to re-evaluate URSP rules. The indication is used to by the UE to help determine if it should re-evaluate.\nThe UE receives URSP rules. Some URSP rules may have Traffic Descriptors that are associated with edge services. The RSDs of these URSP rules may include Location Criteria. By including Location Criteria, the URSP rule can be configured such that the UE will select a DNN/S-NSSAI combination for PDU Session Establishment based on the UE's cell, RAN Node, TAI or PLMN ID. Thus, the UE will use a DNN/S-NSSAI combination based on the PLMN that the UE is registered with. For example, the route will only be considered valid if the PLMN ID in the Location Criteria matches the PLMN ID of the PLMN where the UE is currently registered or if the PLMN ID in the Location Criteria is an equivalent PLMN of the PLMN where the UE is currently registered.\nExisting Rel-17 behaviour is that when the UE leaves the cell, RAN Node, or tracking area, the UE will continue to use the PDU Session until URSP Rules are re-evaluated. However, the UE is not required to re-evaluate URSP rules for the traffic.\nThis solution proposes that the RSD(s) also include a \"Revaluation Suggested\" indication. When a change of cell, RAN node, TAI, or PLMN occurs, the existing PDU Session will be released if no longer needed and the UE will re-evaluate URSP rules. URSP re-evaluation will cause the UE to choose a new RSD for the traffic. The location criteria in the new RSD will cause the UE to select a DNN/S-NSSAI that is associated with the PLMN where the UE is currently registered.\nNOTE:\tBefore concluding this solution for normative work, alignment check with FS_eUEPO shall be done in order to avoid any conflict with the conclusion of KI#1 in TR 23.700-85 [10]. Final decision on generic URSP enhancement for supporting LBO roaming case should be made within FS_eUEPO study.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.7.2\tImpacts on services, entities and interfaces",
                            "text_content": "PCF:\n-\tcan include the \"Revaluation Suggested\" indication in RSDs or URSPs;\n-\tcan include PLMN ID(s) in location criteria.\nUE:\n-\tcan receive the \"Revaluation Suggested\" indication in RSDs or URSPs;\n-\tcan use the \"Revaluation Suggested\" indication to decide when to trigger URSP re-evaluation;\n-\tcan receive PLMN ID(s) in location criteria.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.8\tSolution 08 (KI#1): V-ECS Discovery during Steering of Roaming",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.8.1\tDescription",
                            "text_content": "This solution addresses that part of Key Issue #1 that considers how to how to configure the VPLMN ECS address to UE in roaming scenarios.\nThe principle of this solution is that the Steering of Roaming framework that is specified in TS 23.122 [12] can be extended to provide information to the UE so that the EEC can communicate with an ECS in VPLMN (i.e. a V-ECS). This solution explains how the SoR transparent container can be used to provide information to the UE that can be used to establish an LBO PDU Session that is used to reach a V-ECS.\nNOTE:\tCT1 has stage 2 and stage 3 responsibility for the Steering of Roaming feature. If this solution is selected for normative work, coordination with CT1 would be required.\nAs one option, the SoR transparent container can be used to provide an FQDN or an IP Address of a V-ECS to the UE. When the UE accesses the provided FQDN or IP Address, URSP rules may steer the UE to use a DNN/S-NSSAI combination that can be used to reach the ECS (e.g. an LBO Session).\nAs a second option, the SoR transparent container can be used to provide a DNN/S-NSSAI combination to the EEC. In this case, the DNN/S-NSSAI combination may be used to send a PDU Session Establishment Request in the VPLMN that will result in an LBO PDU Session. The SMF in the VPLMN may then send ECS Address Configuration Information to the UE as described in TS 23.548 [3]. The EEC may then use the ECS FQDN or IP Address from the ECS Address Configuration Information.\nFigure 6.8.1.2-1 procedure illustrates a procedure for this solution.\nThe figure depicts the V-ECS (Virtual-to-ECS) discovery process during the steering of roaming in a 5G network. It illustrates the steps taken by the network to identify and authenticate the V-ECS, ensuring seamless roaming experiences for users. The figure highlights the importance of network security and the role of V-ECS in enabling efficient roaming.\nFigure 6.8.1.2-1: V-ECS Discovery during Steering of Roaming\n1.\tThe UE receives the SoR Transparent Container. The SoR Transparent Container may include a new information element called ECS Discovery Information. The ECS Discovery Information may include ECS Contact Information (O), ECS Provider ID (O), DNN (O), and S-NSSAI (O). The network may have been pre-provisioned with the ECS Discovery information (e.g. via OAM) and what ECS Discovery information is sent to the UE may be based on roaming agreement (e.g. the roaming agreement may allow the HPLMN to point the UE to an ECS in the EHE of the VPLMN).\n2.\tAs described in TS 23.122 [12], the reception of the SoR Transparent Container triggers the UE to perform PLMN Selection.\n3.\tThe UE registers with a PLMN that was provided in the SoR Transparent Container.\n4.\tThe UE establishes an LBO PDU Session that will be used to communicate with the V-ECS and/or to obtain ECS Contact Information from the VPLMN.\nOption A: The ECS Discovery Information from step 1 may have included only ECS Contact Information (i.e. an FQDN of an ECS in the VPLMN). In this case, URSP rules may steer the UE to use a DNN/S-NSSAI combination that can be used to reach the ECS (e.g. an LBO Session).\nOption B: The ECS Discovery Information from step 1 may have included only a DNN / S-NSSAI combination. In this case, the combination may be used to send a PDU Session Establishment Request that will result in an LBO session. The SMF in the VPLMN may then send ECS Address Configuration Information to the UE as described in TS 23.548 [3].\n5.\tThe EEC sends a Service Provisioning Request to an ECS in the visited network. The ECS address was obtained in step 1 or step 4.\n6.\tThe EEC receives a Service Provisioning Response.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.8.2\tImpacts on services, entities and interfaces",
                            "text_content": "SoR-AF:\n-\tcan provide ECS Discovery Information.\nUE:\n-\tcan receive the ECS Discovery Information in the SoR Transparent Container.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.9\tSolution 09 (KI#1): PDU Session configuration from EASDF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.9.1\tDescription",
                            "text_content": "This solution addresses KI#1: Accessing EHE in a VPLMN when roaming.\nIn this solution, the UE uses a predefined FQDN to the EASDF that is shared between operators. For example, GSMA could host the root entry for this Global EASDF. This solution is based on that the Global EASDF supports either configuration for a local EASDF or configuration for the UE to set up a new PDU Session.\nFor a specific VPLMN, if the HPLMN requires the UE to use a new (LBO) PDU Session to access the V-PLMN's EHE, then the HPLMN will configure the Global EASDF with configuration for the UE to use to set up a new PDU Session. When the UE initiates the new PDU Session, then the UE will receive all needed configuration from the V-SMF for EAS discovery in the V-PLMN's network. If the HPLMN instead uses HR PDU Session, then it will configure the Global EASDF with the IP address of the EASDF in the V-PLMNs network. The UE will then use that one to discover EAS(s) in the V-PLMN. This allows the V-PLMN to utilize local traffic routing to the V-PLMNs EHE according to the agreement between them.\nThe Global EASDF acts as a DNS server to provide the UE with either the IP address of the EASDF that the UE should use in the V-PLMN or the S-NSSAI/DNN combination that the UE will use to set up a PDU Session.\nThis solution does not utilize URSP rules for the UE to retrieve and set up new PDU Session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.2\tProcedures",
                            "text_content": "The figure depicts a PDU (Power Distribution Unit) session configuration from EASDF, which is a standard for managing power distribution in Ethernet networks. The figure shows the various components and their connections, including the PDU, switch, and other network devices. The configuration is essential for ensuring the proper functioning of the network and for managing power distribution.\nFigure 6.9.2-1: PDU Session configuration from EASDF\n0.\tPre-requisites: The UE has a Home Routed PDU Session and the HPLMN has configured the Global EASDF with appropriate configuration for supported Visitors EHE(s).\n1.\tThe UE performs a DNS query to the Global EASDF. Since this is a public FQDN to the Global EASDF, the UE may use any locally configured DNS Server that in turn will use next DNS server in the DNS hierarchy until it goes to the Global EASDF.\n2.\tThe Global EASDF responds with either the configuration the UE needs to set up a PDU Session in the V-PLMN or the IP address of the local EASDF.\nIf the V-PLMN uses existing PDU Session (HR PDU Session with local traffic routing) then the Global EASDF is configured with the V-PLMN's EASDF. If the operators require a new LBO PDU Session, then the Global EASDF is only configured with the configuration the UE needs to set up the new PDU Session.\nNOTE:\tWhen the HR PDU Session with local traffic routing is used, the V-EASDF sent to the UE via DNS response applies to the DNS query being handled. The subsequent DNS queries are sent to the Global EASDF for further handling, which may repeat step 2.\n3.\tIf PDU Session configuration was received, then the UE initiates a PDU Session Establishment procedure with the configuration received in previous step. The V-SMF initiates and configures the EASDF selection and related DNS handling rules when the UE initiates the PDU Session Establishment procedure to the V-PLMN. The SMF may indicate to the UE the EASDF that the UE shall use for this PDU Session according to steps 1 and 2 in clause 6.2.3.2.2 of TS 23.548 [3].\n4.\tThe UE performs EAS Discovery, same as step 7 in clause 6.2.3.2.2 of TS 23.548 [3]. If the UE received an EASDF address during step 2 above, then the UE uses that address instead of the one provided by the PDU Session establishment.\n5.\tEASDF sends the DNS Response(s) to the UE, same as step 19 in clause 6.2.3.2.2 of TS 23.548 [3].\n6.\tThe UE application starts to utilize the provided EAS.\nThe DNS structure uses the following format:\neasdf.cmnc<CMNC>.cmcc<CMCC>.mnc<MNC>.mcc<MCC>.<root FQDN>\nThe <MNC> is replaced by the UE with the Mobile Network Code from the subscription.\nThe <MCC> is replaced by the UE with the Mobile Country Code from the subscription.\nThe <CMNC> is replaced by the UE with the (Current) Mobile Network Code the UE is roaming into.\nThe <CMCC> is replaced by the UE with the (Current) Mobile Country Code the UE is roaming into.\nThe MNC/MCC pair represents the H-PLMN\nThe CMNC/CMCC pair represents the V-PLMN\nWith this structure, each H-PLMN decides and manages what configuration should be included for each roaming partner since all configuration for each V-PLMN is encoded as sub-domain for the H-PLMN.\nThe following DNS record types is used:\nCNAME OR A Record:\nThis type is used by the operator to configure which local EASDF the UE should use when the H-PLMN utilises HR PDU Session with local traffic routing in that specific V-PLMN.\nSRV Record:\nThis type should be used by the operator to configure the UE with the PDU Session configuration to set up a local PDU Session that terminates in V-PLMN. The following syntax is used for the SRV record:\n\"_dnn._tcp.<operators domain name>.\"\nThe <operators domain name> is replaced with any domain name that the operator owns. The SRV Record target syntax is <Slice Differentiator>.<DNN>. The SD (Slice Differentiator) should always be included and according to clause 28.4.2 of TS 23.003 [16] a reserved value is defined (\"FFFFFF\") when no SD is defined. The SST shall be set as port number.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.9.3\tImpacts on services, entities and interfaces",
                            "text_content": "UE:\n-\tconfigured with the FQDN of the Global EASDF;\n-\tneeds to receive PDU Session configuration in an SRV record and use information from the record to establish a PDU Session;\n-\twhen existing PDU Session should be used, then the UE uses the IP Address from the Global EASDF instead of the one provided in the ePCO from the PDU Session establishment procedure for the EASDF.\nGlobal EASDF:\n-\tacts as a DNS Server and responds to the DNS Queries from the UE. The DNS is configured with standard DNS SRV records that contains PDU Session configuration.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.10\tSolution 10 (KI#1): LBO PDU Session establishment using PLMN criteria in RSD",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.10.1\tDescription",
                            "text_content": "This solution corresponds to KI#1, and addresses the scenario which UE accessing EHE in VPLMN using LBO PDU Session.\nFor better illustration, it is assumed that Service 1 is deployed in both HPLMN and EHE in VPLMN, and Service 2 is deployed only in HPLMN (or deployed in EHE in VPLMN, but the UE is not allowed to access to EHE in VPLMN for Service 2).\nWhen UE accesses to VPLMN, UE may access to EHE in VPLMN via a LBO PDU Session, and access to HPLMN via a HR PDU Session. That means URSP rules with different RSDs shall be used for Service 1 accessing to EHE in VPLMN and Service 2 accessing to HPLMN.\nWhen UE access to HPLMN, it is unnecessary to access to Service 1 and Service 2 via different PDU Sessions. That means URSP rules with same RSD shall be used for Service 1 and Service 2.\nAdding Route Selection Validation Criteria related to PLMN(s) is a way to meet both requirements on S-NSSAI/DNN pair mentioned above. Table 6.10.1-1 illustrates the enhanced RSD, and Table 6.10.1-2 gives an example of the enhanced RSD for Service 1.\nTable 6.10.1-1: Route Selection Descriptor with PLMN criteria\n\nTable 6.10.1-2: An example of RSDs with PLMN criteria\n\nNOTE:\tBefore concluding this solution for normative work, alignment check with FS_eUEPO shall be done in order to avoid any conflict with the conclusion of KI#1 in TR 23.700-85 [10]. Final decision on generic URSP enhancement for supporting LBO roaming case should be made within FS_eUEPO study.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.10.1-1: Route Selection Descriptor with PLMN criteria",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.10.1-2: An example of RSDs with PLMN criteria",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.10.2\tProcedure",
                            "text_content": "The provision of the enhanced URSP with PLMN criteria re-uses the procedure in current specification TS 23.502 [9], or UE may be pre-configured the URSP. In order to determine PLMN criteria, H-PCF shall get the information related to PLMN(s) which the service deployed. The information can be either pre-configured in H-PCF or provisioned by AF. When UE triggers PDU Session selection or PDU Session establishment based on URSP, the UE takes the serving PLMN into consideration.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.10.3\tImpacts on services, entities and interfaces",
                            "text_content": "PCF:\n-\tcontrols the UE to use different DNN+S-NSSAI in different PLMN by including PLMN Criteria in URSP RSDs.\nUE:\n-\tshall consider the serving PLMN when it determines whether to re-use or establish PDU Session, if PLMN Criteria is included in the selected Route Selection Descriptor.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.11\tSolution 11 (KI#2): Exposure of Network Congestion",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.11.0\tGeneral",
                            "text_content": "This solution corresponds to KI#2 on Fast and efficient network exposure improvements.\nBased on the use cases and scenarios in clause 5.2.2, the following network congestion information needs to be exposed to AF via local UPF/NEF:\n-\tQoS Notification Control. For GBR QoS Flow, RAN exposes \"GFBR can no longer be guaranteed\" (or \"GFBR can be guaranteed\"), as well as the reference to the matching Alternative QoS Profile to AF via local UPF/NEF.\n-\tNetwork Congestion indication. For non-GBR QoS Flow, RAN exposes network congestion indication that indicates network congestion occurrence or recovery to AF via local UPF/NEF.\n-\tNetwork Congestion Level. This indicates the degree of RAN congestion. RAN exposes network congestion level to AF via local UPF/NEF.\nNOTE 1:\tHow to determine the network congestion level of a RAN node is up to RAN implementation.\nNOTE 2:\tThis solution targets services with user plane packet transmission.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.1\tProcedure",
                            "text_content": "Figure 6.11.1-1 shows the call flow for exposing network congestion information to AF via local UPF/NEF.\nThe figure depicts a network congestion information exposure to AF (Air Force) via local UPF/NEF (User Peripheral Facility/Network Element Forwarding). The visual representation shows the network congestion information in the form of a heat map, with the AF highlighted in red, indicating the highest congestion levels. The figure also includes a legend to explain the different colors and symbols used to represent different types of congestion, such as congestion points, congestion density, and congestion severity. The figure provides a clear and concise visual representation of the network congestion information, allowing network operators to quickly identify and address congestion issues.\nFigure 6.11.1-1: Network Congestion Information Exposure to AF via local UPF/NEF\nThe procedure is based on the Network exposure to Edge Application Server procedure in clause 6.4.2.1 of TS 23.548 [3].\n0.\tThe UE establishes a PDU Session as defined in clause 4.3.2.2.1 of TS 23.502 [9]. A local PSA UPF is selected for this PDU Session.\n1.\tAF initiates setting up an AF session with required QoS procedure as defined in clause 6.4.2.1 of TS 23.548 [3].\nThe AF may subscribe to direct notification of network congestion for the service data flow to PCF.\nThe AF may also send a report updating threshold to the PCF. When the difference between latest and previous reported network congestion information exceeds the report updating threshold, the local PSA exposes the latest network congestion information to the AF.\nIf QoS notification control trigger is provisioned and the Alternative QoS parameter set(s) are authorized within the PCC rule, the PCF shall include the reference to the Alternative QoS requirement within each corresponding Alternative QoS parameter set.\nNOTE 1:\tThe need for this optional Report updating threshold to the PSA UPF is to be decided during conclusion phase.\n2.\tThe PCF makes policy information based on the AF request and/or local configuration and initiates PDU Session Modification procedure as described in clause 4.3.3.2 of TS 23.502 [9], steps 1b, 3b, 4-8b. The PCF sends policy information to SMF. The policy information may include a report updating threshold which is received from AF or determined by the PCF.\nIf the SMF receives the indication of direct notification of network congestion, the SMF invokes Namf_Communication_N1N2MessageTransfer service of AMF, and AMF sends N2 PDU Session Request to RAN to indicate the RAN to expose network congestion information via local UPF. Based on local configuration, the SMF can further determine whether to enable direct notification of network congestion for this QoS Flow to NG-RAN. The SMF provisions the target local NEF or local AF address to the local PSA included in the PCC rule.\nIf QoS notification control trigger is provisioned and the Alternative QoS parameter set(s) are authorized within the PCC rule, the SMF shall also provision the mapping between the reference to the Alternative QoS Profile and the reference to the Alternative QoS requirement to the local PSA.\nNOTE 2: With this enhancement, the PCF can be configured to only enable the Notification control over User Plane for the QoS Flow subject to edge computing.\nThe SMF sends network congestion detection indication to UPF to enable network congestion notification detection. A report updating threshold may be informed to the UPF.\nThe N2 SM information also includes measure frequency, report threshold.\nIf there is no corresponding UL service data flow template for the service data flow, e.g. the service data flow has different QoS requirements for uplink and downlink, the SMF also indicates a different QoS Flow with corresponding UL service data flow template to the RAN for the reporting. The RAN exposes network congestion information via UL packets corresponding to the indicated QoS Flow.\n3.\tBased on local configuration and step 2, the RAN determines network congestion information when network congestion occurs. The network congestion information can be any information listed in clause 6.11.0.\n4.\tIn case the reporting condition is met, the RAN sends the network congestion information to the local PSA via the GTP-U header of corresponding UL packet.\nIf the RAN is requested to report the network congestion information via a different QoS flow, the RAN sends the network congestion information via UL packets corresponding to the QoS Flow indicated by the SMF.\nIf no UL packet can be used when report is needed, RAN generates a dummy UL packet for the report.\nAs described in clause 6.11.0, the network congestion information includes QoS Notification Control information (for GBR QoS Flow) and network congestion level/indication (for non-GBR QoS Flow).\nNOTE 3:\tIn order to avoid a too frequent report to the Local PSA, it is assumed that NG-RAN implementation can apply hysteresis (e.g. via a configurable update condition) before notifying a changed network congestion information to the local PSA.\nNOTE 4:\tRAN can repeat the network congestion information to the local PSA multiple times to avoid loss of the report.\n5.\tThe local PSA exposes/updates the network congestion information to AF as described in step 4 of Figure 6.4.2.1-1 of TS 23.548 [3].\nIf a report updating threshold is informed by the SMF in step 2, local PSA updates the latest network congestion information to the AF when the difference between latest and previous reported network congestion information exceeds the report updating threshold.\nThe local PSA sends the notification to the target local NEF or local AF address corresponding to the QoS flow. If the reference to the Alternative QoS Profile is also received within the notification, the local PSA shall also include the reference to the Alternative QoS requirement corresponding to the reference in the notification sent to the target local NEF or local AF address.\nNOTE 5:\tThe AF logic after receiving the network congestion information is not in the scope of this study.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.11.2\tImpacts on services, entities and interfaces",
                            "text_content": "AF:\n-\tsubscribes direct notification of network congestion information from 5GC.\nPCF:\n-\tincludes the reference to the Alternative QoS requirement within each corresponding Alternative QoS parameter set.\nSMF:\n-\tindicates RAN to expose network congestion information via local UPF;\n-\tindicates a UL QoS Flow for RAN to be used to expose network congestion information when there is no UL QoS Flow of the service data flow;\n-\tprovisions the associated target local NEF or local AF address for this network congestion information reporting;\n-\tprovisions the mapping between the reference to the Alternative QoS Profile and the reference to the Alternative QoS requirement to the local UPF.\nUPF:\n-\treceives the mapping between the reference to the Alternative QoS Profile and the reference to the Alternative QoS requirement;\n-\texposes the reference to the Alternative QoS requirement to local NEF/AF.\nRAN:\n-\tsupports exposing network congestion information via local UPF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.12\tSolution 12 (KI#2): Efficient exposure of RAN information",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.12.1\tKey Issue mapping",
                            "text_content": "The solution applies to KI#2: Fast and efficient network exposure improvements.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.2\tDescription",
                            "text_content": "In general, the application server support monitoring the data rate of the link between the client and server. The application server uses the monitored result to adjust service data throughput and the handling within the server. There are many factors impacting on the data rate of the link, e.g. the congestion of the transport network. The 5GS link is partial segment of the link between the client and server. Reporting network resource congestion of the 5GS can help the application server to estimate the bottle neck is in 5GS or other part between the server and the client, when the link data rate decreases outstandingly.\nHence, it is proposed to expose the network congestion of the 5GS to the application server.\nIn general, the bottleneck of the network congestion is the RAN congestion since the time-frequency resource is limited. However, the RAN does not support service-based interface and it is not efficient to expose RAN's congestion from RAN to AF via AMF-SMF-PCF-NEF.\nIn order to support efficient exposure of RAN's congestion, it is proposed to considered to expose RAN's congestion via user plane, as shown in figure 6.12.2-1.\nThe figure depicts a network's exposure to congestion, showing the number of active users and the number of active connections. The congestion is measured in terms of the number of active users and the number of active connections, with a focus on the number of active users.\nFigure 6.12.2-1: exposure RAN's congestion\nThe solution is based on the existing Network Exposure functionality with the following enhancement:\n-\tThe AF subscribes the network congestion with a UE address.\n-\tThe PCF generates a PCC rule for RAN to report RAN's congestion.\n-\tThe SMF generates a QoS flow's QoS profile for RAN report.\n-\tThe RAN reports RAN Congestion Start, RAN Congestion End, RAN's congestion level from the UL data in the QoS flow for RAN report.\n-\tThe UPF detects the RAN Congestion Start, RAN Congestion End, RAN's congestion level from the UL data in the QoS flow for RAN report.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.3\tProcedures",
                            "text_content": "The figure depicts a network event log for a normal data transmission interruption, with the date rate being the most significant feature.\nFigure 6.12.3.1-1: Subscribing Normal Data Transmission Interruption event and Date Rate\n1.\tThe AF subscribes the Network Congestion (e.g. RAN congestion) by sending Nnef_EventExposure_Subscribe request (UE address, event ID(s)).\n2.\tThe NEF authorizes the AF request.\n3.\tThe NEF interacts with the PCF by triggering a Npcf_PolicyAuthorization_Subscribe request to the Network Congestion (e.g. RAN congestion).\n4.\tUpon reception of the subscribe request of Network Congestion for a UE address, the PCF generates a QoS rule for RAN to report RAN's congestion. The PCC rule includes an indication that the PCC rule is used for RAN report information.\nThe PCF also generates a QoS monitoring policy for network congestion measurement.\n5.\tThe PCF responds to the NEF a Npcf_Policy Authorization_Create response.\n6.\tThe NEF sends a Nnef_AFsessionWithQoS_Create response message to the AF.\n7.\tThe PCF initiates SM Policy Association Modification Request (PCC rule) to the SMF.\nThe SMF maps a QoS flow for the PCC rule from the PCF. The QoS flow's QoS profile includes the indication that the QoS flow is used for RAN report information.\nThe SMF generates the QoS Monitoring configuration for UPF: RAN congestion detection indication.\nThe SMF generates the QoS Monitoring configuration for RAN: RAN congestion measurement indication, measure frequency, report threshold.\n8.\tThe SMF replies SM Policy Association Modification Response to the PCF.\n9.\tThe SMF initiates N4 Session Modification Request (QoS Monitoring configuration, QoS rule) to the UPF.\nUpon reception of QoS Monitoring configuration, the UPF enables the RAN's congestion detection and report.\n10.\tThe UPF(s) respond to the SMF.\n11.\tFor SMF requested modification, the SMF invokes Namf_Communication_N1N2MessageTransfer ([N2 SM information] (PDU Session ID, QFI(s), QoS Profile(s), QoS Monitoring configuration), N1 SM container)).\n12.\tThe AMF may send N2 ([N2 SM information received from SMF], NAS message (PDU Session ID, N1 SM container (PDU Session Modification Command))) Message to the (R)AN.\nUpon reception of QoS flow's QoS profile and the indication that the QoS flow is used for RAN report information, the RAN skips to map DRB for the QoS flow and makes the QoS flow terminated between the RAN and the UPF.\nUpon reception of QoS Monitoring configuration, the RAN enables the RAN congestion measurement and report.\n14.\tThe (R)AN may acknowledge N2 PDU Session Request by sending a N2 PDU Session Ack Message to the AMF.\n15-16.\tThe AMF forwards the N2 SM information and the User location Information received from the AN to the SMF via Nsmf_PDUSession_UpdateSMContext service operation. The SMF replies with a Nsmf_PDUSession_UpdateSMContext Response.\n17-18.\tThe SMF may update N4 session of the UPF(s) that are involved by the PDU Session Modification by sending N4 Session Modification Request message to the UPF.\nThe figure depicts a normal data transmission interruption event, with the measured Date Rate indicating the duration of the interruption.\nFigure 6.12.3.2-1: Normal Data Transmission Interruption event and measured Date Rate\n1&2.\tWhen the RAN congestion starts or congestion level reaches the report threshold, the NG-RAN indicates the RAN Congestion Start and RAN congestion level in the GTP-U header of the UL data.\n3.\tUpon detection of the RAN Congestion Start and RAN congestion level from the UL data, the UPF triggers the Nupf_EventExposure_Notify message to report the RAN Congestion Start and RAN congestion level.\n4.\tThe NEF sends a Nnef_Nnef_EventExposure_Notify (RAN Congestion Start and RAN congestion level) message to the AF.\n5&6.\tWhen the RAN congestion ends, the NG-RAN indicates the RAN Congestion End in the GTP-U header of the UL data.\n7.\tUpon detection of the RAN Congestion End from the UL data, the UPF triggers the Nupf_EventExposure_Notify message to report the RAN Congestion End.\n8.\tThe NEF sends a Nnef_Nnef_EventExposure_Notify (RAN Congestion End) to the AF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.12.4\tImpacts on services, entities and interfaces",
                            "text_content": "AF:\n-\tsubscribes network congestion information from 5GC.\nPCF:\n-\tgenerates a PCC rule for RAN to report RAN's congestion. The PCC rule includes an indication that the QoS rule is used for RAN report information;\n-\tgenerates a QoS monitoring policy for RAN congestion information measurement.\nSMF:\n-\tindicates RAN to expose RAN congestion information via UPF;\n-\tsets up a QoS flow between the RAN and UPF for RAN to report RAN congestion information.\nRAN:\n-\tsets up a QoS flow between the RAN and UPF for RAN to report RAN congestion information;\n-\tdetects and reports RAN congestion information to UPF.\nUPF:\n-\tdetects and exposes RAN congestion information to AF/NEF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.13\tSolution 13 (KI#2): Fast and efficient network exposure improvements",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.13.1\tIntroduction",
                            "text_content": "This solution addresses the KI#2: Fast and efficient network exposure improvements. This solution reuses mechanism defined to establish QoS Monitoring as specified in clause 5.33.3 of TS 23.501 [2], clause 4.3.3 of TS 23.502 [9] and support of network exposure with low latency to local AF as specified in clause 6.4.2 of TS 23.548 [3].\nThe solution is based on following principles:\n-\tThe local AF subscribes the low latency exposure of cell ID, etc. from the PCF via a local NEF.\n-\tNG-RAN provides information such as cell ID(s) as requested by the SMF.\n-\tUPF exposes received information as defined in clause 5.2.26 of TS 23.502 [9] and further enhanced in FS_UPEAS to local NEF/AF.\n-\tThe local AF may use received information about the cell(s) currently serving a UE to retrieve current and predicted UE and cell radio conditions from RAN. Such information may be used by local AF and applications, for instance, to trigger video codec rate adaption and prevent user experience degradation.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.2\tFunctional Description",
                            "text_content": "This solution addresses KI#2 and the following principles are used:\n1.\tThe local AF subscribes using Nnef_AFSessionWithQoS / Npcf_PolicyAuthorization_Subscribe service the low latency exposure of cell ID(s), etc. from the PCF via a local NEF as defined in clause 6.4.2.1 of TS 23.548 [3]. The local AF may also subscribe direct event notification from the UPF to the local AF as defined in clause 6.4.2.1 of TS 23.548 [3].\n2.\tPCF sends this subscription to SMF as defined in clause 6.4.2.1 of TS 23.548 [3], together with requested information.\n3.\tThe SMF configures NG-RAN via AMF, and the UPF over N4 for the UPF, with the requested to notify AF.\n4.\tNG-RAN node sends the requested information e.g. cell ID(s) in NG-RAN UL (Uplink) over GTP-u to UPF. Requested information may be sent, e.g. using UL PDU Session Information as defined in TS 38.415 [14] for QoS Monitoring information.\nNOTE:\tAF may use e.g. Cell ID to obtain additional information e.g. using APIs defined by ETSI MEC, etc. but these are outside the scope of this solution.\n5.\tThis SMF provided configuration is transferred to the new/target NG-RAN node when the UE has been handed over to a the new/target NG-RAN node.\n6.\tIf the serving cell Id(s) has changed (and upon receiving the SMF request), the NG-RAN provides the latest/new serving cell Id(s).\n7.\tThe UPF exposes received information to local NEF/AF as defined in clause 5.2.26 of TS 23.502 [9] and further enhanced in FS_UPEAS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.3\tProcedures",
                            "text_content": "This procedure is based on clause 6.4.2.1 of TS 23.548 [3] for Network Exposure to Edge Application Server and further enhanced in FS_UPEAS as follows:\nThe figure depicts a network architecture with a central controller (NG) and radio access network (RAN) components. The RAN includes radio base stations (RBs), radio access network (RAN) elements, and radio network elements (RNE). The figure illustrates the reporting information by the NG to the local AF, which is a crucial step in network management and troubleshooting.\nFigure 6.13.3-1: Reporting information by the NG-RAN to local AF.\n0.\tThe UE establishes a PDU Session as defined in clause 4.3.2.2.1 of TS 23.502 [9]. A L-PSA UPF is assigned for this PDU Session.\n1.\tThe AF initiates setting up an AF session with required QoS procedure as defined in clause 4.15.6.6 of TS 23.502 [9].\nIn the request, the AF may subscribe to direct notification of requested information such as Cell ID(s), for the service data flow to PCF possibly via Local NEF or NEF.\nThe AF may also first initiate an AF Session with PCF and later subscribe to direct notification of requested information to PCF by invoking Npcf_PolicyAuthorization_Subscribe service operation.\nThe local AF or NEF may discover a local NEF as specified in step 1 in clause 6.4.2.1 of TS 23.548 [3].\n2.\tThe PCF makes the policy decision and initiates the PDU Session modification procedure as defined in clause 4.3.3.2 of TS 23.502 [9], steps 1b, 3b, 4-8b.\nIf the direct notification is subscribed, the PCF includes the indication of direct event notification (including target local NEF or local AF address) for the service data flow within the PCC rule.\nIf the SMF receives (2a) the indication of direct event notification from the PCF and the SMF determines that the L-PSA UPF supports such reporting, the SMF sends (2b) requested information indication and associates the indication with the target local NEF or local AF address to the L-PSA UPF via N4 rules.\nThe SMF sends (2c) via N2 to NG-RAN within a PDU Session resource Create/Modify (defined in TS 38.413 [15]) a request to send to the UPF requested information that contains e.g. the cell(s) currently serving a PDU Session, etc.\n3.\tThe L-PSA UPF obtains requested information sent in GTP-u by NG-RAN.\nIf the SMF had beforehand requested that the NG-RAN sends an indication and the PDU Session resources have been released in the NG-RAN, the NG-RAN needs to send to the UPF an indication that the cell(s) currently serving the PDU Session and /or the UE identity as handled by the NG-RAN are no longer valid.\nIf there is no UL traffic, the NG-RAN may send a GTP-u packet with no user plane traffic (dummy UL packet).\nThe NG-RAN may send updated serving cell Id(s) and/or UE identity as handled by the NG-RAN in multiple UL packet sent over 5GS N3 interface (in order to not lose the information if some UL traffic was discarded between the NG-RAN and the UPF responsible of the reporting to the EC AF).\n4.\tThe L-PSA UPF sends the notification related requested information over Nupf_EventExposure_Notify service operation as specified in step 4 (a, b) in clause 6.4.2.1 of TS 23.548 [3].\n5-8. may follow as specified in clause 6.4.2.1 of TS 23.548 [3].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.13.4\tImpacts on services, entities and interfaces",
                            "text_content": "Proposed information exposure impacts the same entities and interfaces as QoS monitoring defined in Rel-16.\nNG-RAN:\n-\tshould support exposing of requested information such as Cell ID(s) in GTP-u packets.\nUPF:\n-\tshould support exposing of requested information such as Cell ID(s) in GTP-u packets;\n-\tshould support exposing requested information which includes cell ID(s) in Nupf_Event_Exposure_Notify.\nNEF, PCF, SMF:\n-\tshould support indication of RAN assistance information in Nnef_AFSessionWithQoS / Npcf_PolicyAuthorization_Subscribe.\nSMF and UPF:\n- N4 should support indication of requested information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.14\tSolution 14 (KI#4): Group Management",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.14.1\tIntroduction",
                            "text_content": "This solution addresses the Key Issue #4, and in particular how to define a collection of UEs forming a dynamic ad-hoc group. This dynamic ad-hoc group may be then used to identify the users that should use the same EAS and/or same local part of DN and/or same DNAI.\nThis solution makes the following assumptions:\n-\tAF determines the identities of the UEs that should be part of the collection and creates an ad-hoc group for this collection to the 5GC. The AF includes an External Group ID in the group creation request. The AF can add or remove users in the group in dynamic manner. 5GC stores the group members with associated Internal and External Group IDs.\n-\tThe AF uses the Traffic Influence and EAS Deployment services to submit edge service related data for the given ad-hoc group as identified by the External Group ID. No impact to Rel-17 is foreseen.\n-\tThe 5GC is responsible to determine and select a common local part of the DN for the group members. This step is not in the scope of this solution proposal.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.14.2\tFunctional Description",
                            "text_content": "The solution is based on the following principles:\n-\tIn this solution, the AF is responsible to create and maintain the ad-hoc group data in 5GC. NEF provides a generic Group Management service for the AF to create, modify and delete ad-hoc groups in 5GC. Generic here means that the group data does not contain any service specific data, but instead any service data can be associated with the corresponding group identifier. This solution proposal describes how the traffic influence service data and EAS Deployment Information data can be associated with the group data, but the same principle could be used with any other service data.\n-\tUpon receiving a request to include a user into a group (i.e. when the group is created or a new user is added to the group), the UDM ensures that the group data and individual subscription data are aligned; i.e. the UDM updates the individual user subscription data for the group member to contain the Internal Group ID of the group. In similar manner, when the AF requests a user to be removed from a group, the UDM removes the corresponding Internal Group ID from the individual user subscription data. A user may belong to more than one group.\n-\tNnef_TrafficInfluence service as specified in Rel-17 is used to store the DNN/S-NSSAI and the Internal Group ID. The service data may contain an \"Indication of traffic correlation\" parameter as defined in clause 5.6.7 in TS 23.501 [2] to indicate that a common local part of DN should be selected. The service data is applicable for all members of the given group using the given DNN/S-NSSAI.\n-\tNnef_EASDeployment service as specified in clause 6.2.3.4 in TS 23.548 [3] is used to store the EAS Deployment Information in the NEF and UDR. The SMF retrieves the EAS Deployment Information from the NEF and configures the DNS handling rules to EASDF correspondingly. EAS Deployment Information can contain an Internal Group ID as described in Table 6.2.3.4-1 in TS 23.548 [3]. The service data is applicable for all members of the given group using the given DNN/S-NSSAI.\n-\tA single DNN/S-NSSAI may be used by multiple ad-hoc groups. In this case the groups may be controlled by the same or different AFs, each submitting a different traffic influence service data containing the same DNN/S-NSSAI.\nNOTE:\tThe solution assumes that the principle in Rel-17 holds, where multiple AFs that manage different services can submit traffic influence data for the same user with the same DNN/S-NSSAI.\nThe figure 6.14.2-1 illustrates the overall structure of the Group management data, Traffic Influence data, and EAS Deployment Information data.\nThe figure depicts the overall structure of the Group management data and Traffic Influence data, illustrating the various components and their relationships.\nFigure 6.14.2-1: Overall structure of the Group management data and Traffic Influence data\nThe NEF provides three distinct services: 1) generic Group Management service, 2) Traffic Influence service, and 3) EAS Deployment service.\nFor the Group Management service, either a new service needs to be specified, or the existing Nnef_ParameterProvision service is used as specified in clause 5.29.2 in TS 23.501 [2]. In the latter case, the Nnef_ParameterProvision service shall be generalized so that it can be used also for groups that are not specific for 5G VN group communication service. This means that the group data should not be required to contain any service specific data, as the group data can be referenced from any service.\nAs specified in clause 5.29.2 in TS 23.501 [2], the UDM ensures that the group data and user subscription data are aligned, i.e. the user who is listed as a member in the group data should have the same group identity in the user subscription data.\nFor the Traffic Influence and EAS deployment services, the existing procedures are used to store the traffic influence data and EAS Deployment Information data into UDR. The traffic influence data and EAS Deployment Information data can contain a DNN/S-NSSAI and Internal Group ID that the service data is applicable for.\nThe figure 6.14.2-2 illustrates how the UDMs can align the group data and individual subscription data in a case where the group data and individual user subscription data are served by different UDMs.\nThe figure depicts a network with multiple User Datagram Multicast (UDM) servers, each serving a different user or group. The servers are distributed across the network, ensuring efficient and reliable communication.\nFigure 6.14.2-2: Different UDMs serving the user(s) and group\nAF invokes a group creation or update request to the NEF (not shown in the figure). The NEF discovers the UDM-1 based on the External Group ID. The UDM-1 receives the group creation request from the NEF. UDM-1 discovers the UDR based on External Group ID and stores the group data into UDR-1. UDM-1 uses the SUPI to discover the UDR for each member (UDR-2). UDM-1 updates the user subscription data for the member's SUPI and adds the Internal Group ID of the group to the user subscription data. If the user subscription data is updated via OAM, the UDM-2 updates the user subscription data in UDR-2 and UDR-2 notifies the UDM-1 for the data change.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.14.3\tProcedures",
                            "text_content": "Figure 6.14.3-1 describes an overview of the procedure to create an ad-hoc group that is used to determine the collection of users that should have a common local part of DN.\nThe figure depicts a group creation process, where a local part of DN is selected using the group. This is crucial for selecting the local part of DN in a distributed network.\nFigure 6.14.3-1: Creation of a group and using it for selecting the local part of DN\n1.\tGroup Management:\nThe AF invokes a group creation request to the NEF. The group creation request contains an External Group ID and list of GPSIs that are members in the group. NEF uses an UDM service to create the group. The group data contains the members (SUPIs) and External Group ID. The UDM discovers an UDR based on the External Group ID and stores the group data into UDR. The UDR assigns an Internal Group ID for the group and stores it to the group data.\nUpon receiving a request to include a user into a group, the UDM updates the individual user subscription data for the group members in the corresponding UDR(s) to contain the Internal Group ID of the group.\nNOTE:\tA single UDR should serve the group data for a particular External Group ID. How the UDR ensures that the Internal Group ID is unique is left up to implementation, as long as the format defined in clause 19.9 in TS 23.003 [16] is followed.\n2.\tEdge service management (no impact):\nAF uses the Nnef_TrafficInfluence service as specified in clause 4.3.6.2 in TS 23.502 [9] to influence SMF routeing decisions for User Plane traffic of PDU Sessions. AF uses the Nnef_EASDeployment service as specified in clause 6.2.3.4 in TS 23.548 [3]. The AF may include an External Group ID to the service requests. If the AF requires that the same local part of DN is used for the group members when they access the given DNN/S-NSSAI, the AF includes the \"Indication of traffic correlation\" parameter to the Nnef_TrafficInfluence service request.\nThe NEF uses the Nudm_SDM_Get (Group Identifier Translation, External Group ID) service to resolve the External Group ID to Internal Group ID, as specified in Rel-17. The NEF stores the TrafficInfluence service information and EAS Deployment Information in the UDR. The service data contains the DNN/S-NSSAI and Internal Group ID as specified in Rel-17. The PCF(s) that have subscribed for the Traffic Influence data for the matching DNN/S-NSSAI and Internal Group ID receive a notification from the UDR.\n3.\tPDU Session establishment (not in the scope of this solution):\nUpon PDU Session establishment, the SMF retrieves the user subscription data from the UDM. The user subscription data may contain one or more Internal Group IDs. The SMF passes the DNN/S-NSSAI and Internal Group ID(s) to the PCF as specified in clause 4.16.4 in TS 23.502 [9]. If the PCF does not have the traffic influence service data for the given DNN/S-NSSAI and Internal Group ID, the PCF retrieves it from the UDR.\nThe SMF retrieves the EAS Deployment Information for the given DNN/S-NSSAI and Internal Group ID(s) from the NEF as described in clause 6.2.3.4 in TS 23.548 [3].\n4.\tSelecting the common local part of DN (not in the scope of this solution):\nIf the traffic influence service data contains the \"Indication of traffic correlation\" parameter, 5GC determines and selects a common local part of the DN for all PDU Sessions that use the given DNN/S-NSSAI where the user is a member in the given group.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.14.4\tImpacts on services, entities and interfaces",
                            "text_content": "Assuming that the existing Nnef_ParameterProvision service is used as specified in clause 5.29.2 in TS 23.501 [2] to provide a generic Group Management service, the impacts are limited to the generalization of the Nnef_ParameterProvision service as described below.\nNEF:\n-\tNnef_ParameterProvision service is enhanced to remove a requirement to provide any service specific data in group creation. At least DNN and S-NSSAI are currently mandatory parameters in the Nnef_ParameterProvision_Create service operation when a 5G VN group is created.\nUDM:\n-\tNudm_ParameterProvision service is enhanced to remove a requirement to provide any service specific data in group creation. At least DNN and S-NSSAI are currently mandatory parameters in the Nudm_ParameterProvision_Create service operation when a 5G VN group is created.\nUDR:\n-\tNudr_DataManagement service is used to manage the group data in the UDR. The service is enhanced to remove a requirement to provide any service specific data when the group data is stored in UDR. At least DNN and S-NSSAI are currently mandatory parameters in the Group Data Subset in subscription dataset for a 5G VN group. The UDR stores the Internal/External Group IDs and the member list (list of SUPIs).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.15\tSolution 15 (KI#4): Selection of common DNAI",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.15.1\tIntroduction",
                            "text_content": "This solution aims to address the KI#4 created for WT#6 related to the influence on UPF and EAS (re)location for a collection of UEs in scenarios when the UEs should use the same EAS and are not members of a pre-defined group.\nAs addressed under the key issue description, the UPF selection and relocation, and deciding on a common local part of DN are the focus of this solution. In practice, an optimal common local part of DN would be needed to make the service experience best for all UEs in the group.\nHow to define a collection of UEs forming a dynamic ad-hoc group is not in the scope of this solution proposal.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.15.2\tFunctional Description",
                            "text_content": "The solution is based on the following principles:\n-\tSession Collection Management Function (SCMF) entity is introduced to determine the location of the common local part of DN (L-DN) and used for common DNAI selection.\n-\tIndividual SMFs one by one add more sessions to the collection of PDU Sessions that is managed by the SCMF, and SCMF selects the common DNAI for this collection of PDU Sessions. SCMF can re-consider the common DNAI whenever a new PDU Session \"joins\" to an existing collection of PDU Sessions.\n-\tThe interface between SMF and SCMF can be based on subscribe/notify model, so even if the SCMF fails to select the common DNAI in some error case, the individual SMFs can proceed as with regular UPF/DNAI selection as a fallback.\n-\tSCMF can make the decision on the common DNAI based on the information it receives from individual SMFs. Then, each SMF selects the location of the UPF based on the common DNAI and relocates the UPF on PDU Session basis.\n-\tFor selecting the common DNAI, SCMF may further use Analytics services from NWDAF for determining service experience between the gNB and candidate UPFs.\n-\tNnef_TrafficInfluence service as specified in TS 23.501 [2] is used to store the DNN/S-NSSAI, Internal Group ID, and a list of DNAIs. The traffic influence data may contain an \"Indication of traffic correlation\" parameter as defined in clause 5.6.7 in TS 23.501 [2] to indicate that a common DNAI should be selected. PCF retrieves the traffic influence data from UDR and constructs the PCC Rules accordingly. No impact to Nnef_TrafficInfluence service is foreseen.\n-\tNnef_EASDeployment service as specified in clause 6.2.3.4 in TS 23.548 [3] is used to store the EAS Deployment Information in the NEF and UDR. The SMF retrieves the EAS Deployment Information from the NEF and configures the DNS handling rules to EASDF correspondingly. EAS Deployment Information can contain an Internal Group ID as described in Table 6.2.3.4-1 in TS 23.548 [3]. No impact to Nnef_EASDeployment service is foreseen.\n-\tThe solution proposes to enhance the PCC Rules by adding a new identifier \"influence-id\", which is associated with the list of DNAIs in the PCC Rules. UDR assigns the \"influence-id\" for each entry in the traffic influence data in the UDR when the entry is created as specified in Rel-17. In this solution, the PCF retrieves the \"influence-id\" from the UDR as part of the traffic influence data and includes it to the PCC Rules. This is necessary when the same DNN/S-NSSAI is used by multiple ad-hoc groups (Internal Group IDs), where each group has different traffic influence service data (e.g. list of DNAIs) containing the same DNN/S-NSSAI. In this case the PCC Rules will contain multiple lists of DNAIs and the \"influence-id\" is used to determine the lists of DNAIs in different PDU Sessions that are related to each other.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.15.3\tProcedures",
                            "text_content": "The overall procedure is described in figure 6.15.3.1-1.\nThe figure depicts the overall procedure for a 5G network, illustrating the signal propagation, signal strength, and signal quality. It highlights the importance of signal reflection off buildings and the use of beamforming techniques to mitigate interference.\nFigure 6.15.3.1-1: Overall procedure\n1.\tPrerequisite: AF has created an ad-hoc group in 5GC. AF submits the traffic influence data and EAS Deployment Information data for the group to 5GC. This step is out of scope of this solution.\n2.\tUpon PDU Session establishment, the SMF retrieves the user subscription data from the UDM. The user subscription data may contain one or more Internal Group IDs. The SMF passes the DNN/S-NSSAI and Internal Group ID(s) to the PCF as specified in clause 4.16.4 in TS 23.502 [9]. If the PCF does not have the traffic influence service data for the given DNN/S-NSSAI and Internal Group ID(s), the PCF retrieves the data from the UDR. The PCF creates or updates the PCC Rules to the SMF.\nThe PCC Rules contain a list of DNAIs associated with the \"Indication of traffic correlation\" and with \"influence-id\". The PCF retrieves the \"influence-id\" from the UDR, thus the value of \"influence-id\" remains the same across all PDU Sessions that use the same traffic influence data.\nNOTE:\tSMF indicates the Internal Group ID(s) and DNN/S-NSSAI to PCF, and PCF uses these to retrieve the corresponding traffic influence data from UDR, as specified in Rel-17, clause 6.4.2.2 of TS 29.519 [17].\n[Optional] If the DNS queries are to be used to influence to the EAS address selection as described in clauses 6.15.3.2 and 6.15.3.3, the SMF retrieves the EAS Deployment Information as described in TS 23.548 [3].\n3.\tSMF(s) invoke the SCMF for selection of the common DNAI. This is described in clause 6.15.3.2.\nDepending on the variation of the procedure, the SMF(s) may invoke the SCMF either based on the user subscription and service data as received in steps 1 and 2, or alternatively the SMF(s) invoke SCMF in dynamic manner based on DNS Query from the UE.\nRest of the clauses describes the following procedures:\n-\tClause 6.15.3.2 \"Selection of the common DNAI\" describes the core procedure in the solution how SCMF selects the common DNAI. This procedure is part of all solution variants.\n-\tClause 6.15.3.3 \"EAS selection and re-selection using ECS option, preconfigured\" describes a solution variant where SMF(s) invoke the SCMF based on the preconfigured user subscription and service data before any DNS Query from the UE. ECS option in DNS request is used to indicate the common DNAI to the DNS server.\n-\tClause 6.15.3.4 \"EAS selection and re-selection using ECS option, dynamic invoke of SCMF\" describes a solution variant where SMF(s) invoke the SCMF based on a DNS Query from the UE. ECS option in DNS request is used to indicate the common DNAI to the DNS server.\n-\tClause 6.15.3.5 \"EAS selection and re-selection via application layer\" describes a solution variant where SMF(s) invoke the SCMF based on the user subscription and service data. Early/late UP path change notifications are used to indicate the common DNAI to the application layer.\nFigure 6.15.3.2-1 describes a procedure for selection of common DNAI for the collection of UEs that should use a common local part of DN and common EAS.\nThe figure depicts a selection of common DNAI (Digital Video Interleave) symbols, which are used in the transmission of video signals over a network. The symbols are arranged in a grid format, with each row representing a different video frame. The figure is used to illustrate the process of selecting the appropriate DNAI symbols for a specific video frame, which is an essential step in the video transmission process.\nFigure 6.15.3.2-1: Selection of the common DNAI\n1.\tSMF receives the user subscription data and PCC Rules as described in step 2 in clause 6.15.3.1. Based on the \"Indication of traffic correlation\" and \"influence-id\" associated with a list of DNAIs in the PCC Rules, SMF knows that it needs to discover a SCMF for a selection of a common DNAI. SMF discovers the SCMF from NRF. SMF discovers one SCMF for each \"influence-id\" associated with a list of DNAIs in the PCC Rules.\nBSF can be used to ensure that the same SCMF is selected for all PDU Sessions with the same \"influence-id\"; SMF uses the \"influence-id\" to retrieve the SCMF identity from the BSF. If the registration in BSF for the given \"instance-id\" does not exist, the SMF discovers the SCMF from NRF, using e.g. the DNN/S-NSSAI as a discovery factor. SCMF registers the \"influence-id\" to BSF after SCMF has been selected for the first PDU Session for an \"influence-id\".\n2.\tThe SMF invokes the SCMF and indicates the \"influence-id\", SUPI, DNN/S-NSSAI, and a list of DNAIs for the given \"influence-id\" as received in the PCC Rules to the SCMF. The SMF invokes the SCMF for each \"influence-id\" associated with a list of DNAIs in the PCC Rules.\n3.\tFor the selection of the common DNAI for a collection of PDU Sessions associated with the same \"influence-id\", the SCMF may consider the UE locations, network topology, or the current Analytics from NWDAF for service experience between the gNB and candidate UPFs. SCMF can subscribe for UE location info (UE mobility events) for the SUPI from the AMF. Based on the current Rel-17 procedures, there are two options for the SCMF to subscribe the mobility event for a UE:\n-\tthe SCMF uses Nudm_EventExposure_Subscribe service operation from UDM for a SUPI, and UDM continues the rest, i.e. knows the AMF for the SUPI;\n-\tthe SCMF manages a certain area and subscribes mobility events for any UE from all AMFs serving this area.\nIf the SCMF uses Analytics services from NWDAF, the SCMF invokes the NWDAF on PDU Session and \"influence-id\" basis.\n4.\tSCMF determines the common DNAI per each \"influence-id\" and notifies the SMF(s) of the corresponding \"influence-id\" for the result. Based on the notification from the NWDAF, or any internal trigger, SCMF can reselect a new common DNAI, and notify the SMF(s) for the change of the common DNAI accordingly.\n5.\tThe SMF(s) select and relocate the UPF based on the notifications from SCMF. The SMF configures the UPF to route the UL traffic towards the EAS in the L-DN. The details depend on how the EAS is discovered and is described in clause 6.15.3.2.\n6.\tWhenever a new UE that belongs to the same Internal Group ID initiates a PDU Session with the given DNN/S-NSSAI, the steps 2-5 are performed for the new PDU Session.\nIf the SCMF determines a new common DNAI for the group, the SMF(s) of the existing PDU Sessions are notified by the SCMF for a new common DNAI. This may be done e.g. due to a new PDU Session joining to the group, or one of the existing PDU Sessions are released, or one or more of the UEs in the group are moving and the SCMF finds a more optimal DNAI.\nFigure 6.15.3.3-1 describes a procedure for EAS selection and re-selection for a group of UEs when DNS queries from the UE influence to the EAS selection. EDNS Client Subnet option in the DNS Query is used to indicate the common DNAI to the DNS server. The SMF subscription for the common DNAI from SCMF is done based on the pre-configured edge service data that is applicable for the PDU Session, i.e. traffic influence data and EAS Deployment Information as described in TS 23.548 [3].\nThe flow is applicable for all connectivity models described in TS 23.548 [3]. UPF in the figure corresponds to PSA UPF in the local site (L-PSA UPF). In case of Session Breakout connectivity model, the UL-CL or BP is used although not shown in the figure. In case of Distributed Anchor connectivity model, instead of EASDF a DNS resolver that is preconfigured with the ECS Option may be used.\nThe figure depicts a selection process for Enhanced Air Traffic System (EAS) using the Enhanced Circuit Selection (ECS) option, which is preconfigured for optimal performance. The ECS option allows for efficient re-selection of EAS signals, ensuring a smooth and reliable air traffic control system.\nFigure 6.15.3.3-1: EAS (re-)selection using ECS option, preconfigured\nPre-requisite: SMF receives the user subscription data and PCC Rules as described in step 2 in clause 6.15.3.1. SMF has invoked the SCMF as described in clause 6.15.3.2. SCMF notifies the SMF for the common DNAI.\n1.\tThe SMF uses the common DNAI to select the UPF. The SMF configures the EASDF for the DNS message handling rules using the EAS Deployment Information as described in TS 23.548 [3]. The SMF may notify the AF for UP path change events via early and/or late notifications as described in clause 4.3.6.3 in TS 23.502 [9], based on subscriptions in the PCC Rules. The notifications indicate the common DNAI as a target DNAI.\n2.\tWhen the UE initiates a DNS Query, the EASDF matches it against the rules it has received from the SMF. Based on the DNS message handling rules from SMF, the EASDF inserts an EDNS Client Subnet option to the DNS Query. The EDNS Client Subnet option refers to a location that is topologically close to the common DNAI. The DNS server may resolve the EAS IP address considering the EDNS Client Subnet option and sends the DNS Response via the EASDF and UPF1 to the UE.\n3.\tApplication client and EAS transmit data via the user plane via UPF.\n4.\tIf the SCMF determines a new common DNAI as described in step 6 in clause 6.15.3.2, the SCMF notifies all SMF(s) that have subscribed for the given \"instance-id\". The SMF(s) reselect the UPF accordingly. SMF(s) notify the AF as in step 2.\nThe SMF(s) trigger an EAS rediscovery procedure with the UE(s). In case of Distributed Anchor Point connectivity model as described in TS 23.548 [3], when the SMF relocates the UPF, the UE detects that the PDU Session is released or new IP prefix is allocated within the PDU Session, and the UE removes the old DNS cache related to old/removed IP address/prefix as described in clause 6.2.2. in TS 23.548 [3].\nIn case of Session Breakout connectivity model as described in TS 23.548 [3], the SMF sends PDU Session Modification Command (EAS rediscovery indication, [impact field]) to UE as described in in clause 6.2.3.3 in TS 23.548 [3]. The EAS rediscovery indication indicates to refresh the cached EAS information. The UE behaves as described in TS 23.548 [3].\nThe UE(s) resolve the new EAS address as in step 2. Application client and the new EAS transmit data via the user plane via new UPF.\nIf the PCC Rules indicate multiple \"influence-ids\" with Session Breakout connectivity model, the SMF(s) may assign a separate local PSA for each common DNAI, if necessary. In Distributed Anchor connectivity model, the SMF(s) can assign a local PSA that is most optimal for any of the common DNAIs.\nFigure 6.15.3.4-1 describes a procedure for EAS selection and re-selection for a group of UEs when DNS queries from the UE influence the EAS selection. EDNS Client Subnet option in the DNS Query is used to indicate the common DNAI to the DNS server. The invoke of the SCMF is done in dynamic manner based on the DNS Queries from the UE, in addition to edge service data that is applicable for the PDU Session, i.e. traffic influence data and EAS Deployment Information as described in TS 23.548 [3].\nThe flow is applicable for all connectivity models described in TS 23.548 [3]. In case of Session Breakout connectivity model the UL-CL or BP is used although not shown in the figure.\nThe figure depicts a schematic representation of an EAS (Enhanced Active Surveillance) system, highlighting the ECS (Enhanced Control System) option and dynamic model. The ECS option allows for re-selection of the EAS system based on the detected threats, while the dynamic model ensures that the system adapts to changing conditions. The figure illustrates the various components and their interconnections, including the ECS, EAS, and the dynamic model, which are crucial for the effective operation of the EAS system.\nFigure 6.15.3.4-1: EAS (re-)selection using ECS option, dynamic model\nPre-requisite: SMF receives the user subscription data and PCC Rules as described in step 2 in clause 6.15.3.1.\n1.\tThe SMF configures the EASDF for the DNS message handling rules using the EAS Deployment Information as described in TS 23.548 [3].\n2.\tThe SMF assigns a central UPF (C-UPF) for the PDU Session.\n3.\tWhen the UE initiates a DNS Query, the EASDF matches it against the rules it has received from the SMF.\n4.\tBased on the DNS message handling rules from SMF, the EASDF reports the FQDN to the SMF. The SMF uses the user subscription data and edge service data as described in clause 6.15.3.1 step 3 to determine that the FQDN is related to a group service where a SCMF needs to be invoked.\nThe SMF invokes the SCMF as described in clause 6.15.3.2. The SMF selects the UPF based on the common DNAI as described in clause 6.15.3.2.\nIn case of Session Breakout connectivity model, the SMF configures the EASDF to insert an EDNS Client Subnet option to the DNS Query, as described in step 2 in clause 6.15.3.3.\nIn case of Distributed Anchor connectivity model, the SMF triggers an EAS rediscovery procedure with the UE as described in step 4 in clause 6.15.3.3.\n5.\tIn case of Distributed Anchor connectivity model, the UE re-initiates a DNS Query as in step 4 in clause 6.15.3.3. The EASDF matches it against the rules it has received from the SMF.\nBased on the DNS message handling rules from SMF, the EASDF inserts an EDNS Client Subnet option to the DNS Query. The DNS server returns the EAS address to the UE.\n6.\tApplication client and EAS transmit data via the user plane via L-UPF.\n7.\tIf the SCMF determines a new common DNAI as described in step 6 in clause 6.15.3.2, the SCMF notifies all SMF(s) that have subscribed for the given \"instance-id\". The SMF(s) reselect the UPF accordingly. UE(s) perform an EAS reselection as described in step 4 in clause 6.15.3.2.\nNOTE:\tSignalling storm can be avoided especially at race conditions by implementing a threshold so that common DNAI does not change back and forth frequently among a group of DNAIs.\nIf the PCC Rules indicate multiple \"influence-ids\" with Session Breakout connectivity model, the SMF(s) may assign a separate local PSA for each common DNAI, if necessary. In Distributed Anchor connectivity model, the SMF(s) can assign a local PSA that is most optimal for any of the common DNAIs.\nFigure 6.15.3.5-1 describes a procedure for EAS selection and re-selection for a group of UEs when application layer protocols are used to redirect the application client in the UE to an EAS serving the group. In this case, DNS queries from the UE do not influence to the EAS selection. The flow is applicable for all connectivity models described in TS 23.548 [3]. In case of Session Breakout model, the UPFs in the figure correspond to PSA UPF in the local site (L-PSA UPF).\nIn this procedure, the EASDF is not involved and the Nnef_EASDeployment service is not used.\nThe figure depicts the EAS (re-)selection process, which involves the application layer. The figure shows a selection process where the EAS (re-)selection is performed on the application layer. This process is crucial for ensuring the security and integrity of the network.\nFigure 6.15.3.5-1: EAS (re-)selection via application layer\nPre-requisite: SMF receives the user subscription data and PCC Rules as described in step 2 in clause 6.15.3.1. SMF has invoked the SCMF as described in clause 6.15.3.2. SCMF notifies the SMF for the common DNAI.\n1.\tThe SMF uses the common DNAI to select the UPF. The SMF notifies the AF for UP path change events via early and/or late notifications as described in clause 4.3.6.3 in TS 23.502 [9]. The notifications indicate the common DNAI as a target DNAI.\n2.\tThe application layer informs the UE for the group FQDN that corresponds to the current common DNAI. The UE resolves the EAS address via DNS Query. Alternatively, the application layer can inform the EAS IP address(es) directly via application layer. This step is out of scope of 3GPP.\n3.\tApplication client and EAS transmit data via the user plane via UPF.\n4.\tIf the SCMF determines a new common DNAI, the SCMF notifies all SMF(s)that have subscribed for the given \"instance-id\". The SMF(s) reselect the UPF accordingly. SMF(s) notify the AF as in step 1. The UE(s) resolve the new EAS address as in step 2. Application client and new EAS transmit data via the user plane via new UPF.\nIf the PCC Rules indicate multiple \"influence-ids\" with Session Breakout connectivity model, the SMF(s) may assign a separate local PSA for each common DNAI, if necessary. In Distributed Anchor connectivity model, the SMF(s) can assign a local PSA that is most optimal for any of the common DNAIs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.15.4\tImpacts on services, entities and interfaces",
                            "text_content": "SCMF:\n-\ta new function;\n-\tdetermines the common DNAI for a collection of UEs;\n-\tnotifies the SMF(s) that have subscribed for the common DNAI;\n-\thas similar information about the network topology and DNAIs as the SMF has;\n-\tregisters to the BSF using the Nbsf_Management_Register service operation;\n-\timplements a threshold so that the common DNAI does not change back and forth between the same DNAIs;\n-\tdelays the individual notifications it generates to the SMFs if the group is big.\nBSF:\n-\tNbsf_Management_Register is enhanced for the SCMF to be able to register the SCMF ID and the influence-id to the BSF;\n-\tNbsf_Management_Discovery service operations is enhanced to be able to discover the SCMF ID based on the influence-id.\nSMF:\n-\tdiscovers and invokes the SCMF;\n-\tdiscovers the SCMF from BSF using the Nbsf_Management_Discovery service operation;\n-\tselects the UPF based on the common DNAI as notified by the SCMF.\nPCF:\n-\treceives the \"influence-id\" from UDR and includes it into PCC Rules as part of traffic influence data.\nUDR:\n-\tindicates the \"influence-id\" to the PCF in Nudm_DataManagement service response for each entry in the traffic influence data in the UDR.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.16\tSolution 16 (KI#4): Selecting the same EAS/DNAI for collection of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.16.1\tDescription",
                            "text_content": "This solution corresponds to KI#4:\n-\twhether and how to define a collection of UEs forming a dynamic ad-hoc group that should use the same EAS and/or same local part of DN and/or same DNAI and how the collection is identified;\n-\twhether and what improvements are required for EAS discovery and re-discovery for UEs belonging to a collection of UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.16.2\tProcedures",
                            "text_content": "The following is the procedure for selecting the same EAS for collection of UEs accessing the same application. The procedures defined in figure 4.3.6.2-1 in TS 23.502 [9] and figure 6.2.3.2.2-1 in TS 23.548 [3] are reused.\nThere could be only one SMF for serving the collection of UEs that connecting to the same EAS/DNAI for accessing the same application, or there could be multiple SMFs for different UEs in the collection. AF could provide the common EAS/DNAI in AF request, in which case, SMF(s) select the common EAS/DNAI provided by AF. If AF does not provide the common EAS/DNAI, then SMF selects the common EAS/DNAI and stores it in the corresponding AF traffic influence request information in UDR.\nThe figure depicts a schematic representation of the discovery procedure for selecting the same EAS/DNAI for collection of UEs. It illustrates the steps involved in selecting an EAS/DNAI, including the selection of the EAS/DNAI, the selection of the EAS/DNAI for collection, and the selection of the EAS/DNAI for collection of UEs. The figure also includes a legend to help users understand the different symbols and their meanings.\nFigure 6.16.2.1-1: Discovery procedure for selecting the same EAS/DNAI for collection of UEs\n1.\tThe AF request in step 1 of figure 4.3.6.2-1 in TS 23.502 [9] is used to request selecting the same EAS or same DNAI for UEs accessing the application as identified in the AF Request.\nAn eas_correlation indication or dnai_correlation indication is provided for indicating selecting the same EAS or the same DNAI (i.e. selecting EAS corresponding to the same DNAI) for collection of UEs accessing the same application (e.g. FQDN), Spatial Validity Condition could be provided for limiting the location of the UEs, and also \"any UE\" or an UE list or group ID will be provided for defining UE collection accessing the same EAS or the same DNAI.\n-\tIn the case of selecting the same DNAI, the DNAI could be determined and provided by AF to PCF and then to SMF.\n-\tIn the case of selection the same EAS, the EAS could be determined and provided by AF to PCF and then to SMF.\nA Correlation ID is included in AF Request for identifying the UE collection.\nIn step 5 of figure 4.3.6.2-1 of TS 23.502 [9], PCF determines the UEs influenced by the AF Request, and based on AF request, PCF creates PCC rule with FQDN, Correlation ID, and eas_correlation indication or dnai_correlation indication to SMF.\n2.\tThe same as steps 1~9 in figure 6.2.3.2.2-1 of TS 23.548 [3].\n3.\tIf FQDN in Neasdf_DNSContext_Notify Request is for the application (e.g. FQDN) indicated in AF request, and if eas_correlation indication is set, SMF determines the UE belongs to collection of UEs accessing the application and determines the UE needs to select the same EAS as UEs in the UE collection; or if dnai_correlation indication is set, SMF determines the UE belongs to collection of UEs accessing the application and determines the UE needs to select EAS corresponding to the same DNAI as UEs in the UE collection.\n4.\tIf EAS IP/DNAI has not been determined, or SMF could not make sure the selected EAS IP/DNAI is the one that is stored in UDR, then SMF synchronizes with UDR and receives EAS IP or DNAI for the UE collection, as defined in clause 6.16.2.2. UDR maintains EAS IP or DNAI for the UE collection.\n5.\tBased on steps 10~19 in figure 6.2.3.2.2-1 of TS 23.548 [3]:\nFor selecting the same EAS case: if the same EAS for the UE collection has not been determined yet, steps 10~15 are used for discovering an EAS, and between step 14 and step 16, SMF could send the selected EAS IP to UDR; When the same EAS for the UE collection has been determined, in step 17, SMF sends DNS message handling rule with IP address for the EAS instructing EASDF to return the IP address for the EAS to UE in step 19, steps 10~15 are skipped;\nFor selecting EAS corresponding to the same DNAI case: if no DNAI for the UE collection has been determined, in step 10 SMF determines DNAI for the UE collection and selects information to build ECS option or Local DNS server based on the DNAI. When DNAI for the UE collection has been determined, in step 10 SMF determines information to build ECS option or local DNS server related to the DNAI, and sends DNS message handling rule with the information to build ECS option or local DNS server.\n6.\tIf EAS IP/DNAI has not been determined, or SMF could not make sure the selected EAS IP/DNAI is the one that stored in UDR, then SMF synchronizes EAS IP/DNAI with UDR via NEF, as defined in clause 6.16.2.2.\nThe figure depicts a synchronization procedure for EAS IP/DNAI, which is a protocol used in IP-based security systems. The figure shows a flowchart with various steps, such as data transmission, data processing, and data storage, to ensure the synchronization of the system. The figure is important for understanding the steps involved in the synchronization process and for implementing the protocol in a secure manner.\nFigure 6.16.2.2-1: Synchronization Procedure for EAS IP/DNAI\n1-4.\tIn case a new EAS/DNAI has been determined, SMF sends the EAS/DNAI, Resource URI to PCF by invoking Npcf_SMPolicyControl_Update Request, triggering the PCF to update the corresponding AF traffic influence request information with common EAS/DNAI in UDR and UDR will lock the data to prevent the data to be modified to other EAS/DNAI by other PCF providing different EAS/DNAI for the same UE collection. PCF updates PCC rule to SMF including the common EAS/DNAI of AF traffic influence request information in UDR.\nIn case SMF decides to trigger EAS rediscovery for UE collection, SMF removes the common EAS/DNAI from AF traffic influence request information, UDR notifies PCF, and then PCF updates SMF with updated PCC rule removing the common EAS/DNAI, and triggers other SMF for EAS rediscovery.\nNOTE 1:\tNpcf_SMPolicyControl_Update is proposed to be used for updating EAS/DNAI in UDR, but a new service or operation, instead of reusing Npcf_SMPolicyControl_Update could also be a candidate.\nNOTE 2:\tThe common EAS/DNAI for collection of UEs could be deleted in case the AF traffic influence request information is removed by AF.\n5-7.\tIn case the common EAS/DNAI for collection of UEs is created/deleted, UDR notifies PCFs and then PCF will update PCC rules.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.16.3\tImpacts on services, entities and interfaces",
                            "text_content": "AF:\n-\tto be updated with eas_correlation indication/ dnai_correlation indication for indicating selecting the same EAS/DNAI for collection of UEs accessing the application;\n-\tproviding UE ID list, Correlation ID in AF Request.\nNEF:\n-\tNnef_TrafficInfluence service is impacted to include \"eas_correlation indication\" or \"dnai_correlation indication\", list of FQDNs and list of UE identitities.\nSMF:\n-\tto be updated for storing and retrieving the EAS/DNAI from UDR;\n-\tusing the retrieved EAS/DNAI when selecting the same EAS/DNAI for collection of UEs;\n-\twhen deciding to trigger EAS rediscovery, SMF requests to remove the common EAS/DNAI from AF traffic influence request information;\n-\tinitializes EAS rediscovery when receiving updated PCC rule removing the common EAS/DNAI.\nUDR:\n-\tto be updated for maintaining common EAS/DNAI for the collection of UEs in AF traffic influence request information for the application.\nEASDF:\n-\tto be updated for create and send DNS response to UE.\nPCF:\n-\tNpcf_SMPolicyControl_UpdateNotify service is to be updated to transmit PCC rule with eas_correlation indication/ dnai_correlation indication, Correlation ID, common EAS/common DNAI, Resource URI and FQDN(s);\n-\treceiving EAS/DNAI from SMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.17\tSolution 17 (KI#4): Application layer EAS selection for collections of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.17.1\tIntroduction",
                            "text_content": "This solution corresponds to KI #4. This solution assumes that the AF is responsible for generating the collection of the UEs and select the same EAS for the collection of the UEs. The SMF(s) selects the candidate DNAI(s) for the UE(s) and exposes them to the AF. The AF determines the common DNAI considering the candidate DNAI(s) from different SMFs, then the AF can select the proper EAS with the common DNAI for the collection of the UEs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.2\tFunctional Description",
                            "text_content": "This solution is based on the following principles:\n-\tThe AF can determine the user list and sends the UE list and available DNAI list to 5GC to query the candidate DNAI(s) for the UEs.\n-\tSMF decides the candidate DNAI(s) for the UE(s) in the UE list served by the SMF according to the location of the UE(s) and the DNAI topology.\nNOTE:\tThe UEs of the group may be served by multiple SMFs.\n-\tThe AF can determine the common DNAI based on candidate DNAIs from SMF(s) and then discover an EAS and notify the UEs about the selected EAS via the application layer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.3\tProcedures",
                            "text_content": "This solution focuses on the EAS selection for multiple UE based application layer.\nThe figure depicts a simplified application layer implementation for EAS selection, illustrating the process of selecting an EAS based on various criteria such as signal strength, noise, and interference. The figure includes a flowchart and a matrix to represent the selection process, with arrows indicating the flow of information from the application layer to the EAS selection. The figure is a visual representation of the complex process of EAS selection, providing a clear and concise overview of the steps involved.\nFigure 6.17.3.1-1: Application layer implementation for EAS selection\n1.\tThe AF groups the UEs and generates the UE list (UE addresses) of the collection of UEs according to its application logic. The AF sends Nbsf_management_Discovery request(s) to the BSF to retrieve the PCF(s) for each UE in the UE list.\n2\tFor each UE, AF sends AF retrieve request to the PCF to query the candidate DNAI(s). The AF request may include the available DNAI list where EAS instances are deployed. The AF request may also include the UE list. The AF may send the AF request to PCF directly, or via the NEF.\n3.\tPCF sends the DNAI retrieve request to SMF.\n4.\tSMF selects the candidate DNAI(s). The SMF may consider the UE location and available DNAI list provided by AF to select the closest available DNAI(s) as candidate DNAI(s). The SMF may also provide the DNAI(s) in a prioritized order.\n5.\tSMF notifies the AF (optionally via NEF) about the candidate DNAI(s) of the UE.\n6.\tAfter receiving the candidate DNAI(s) of each UE in the list, the AF selects a proper EAS and a common DNAI according to the DNAI(s).\n7.\tAF initiates AF influence on traffic routing procedure as defined in clause 4.3.6.4 of TS 23.502 [9] for each UE in the UE list to route the application traffic to the common DNAI.\n8.\tThe AF notifies the UEs about the selected EAS via application layer.\n9.\tThe users connect to the same EAS via the common DNAI and start the service.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.17.4\tImpacts on services, entities and interfaces",
                            "text_content": "AF/NEF:\n-\tsupports sending new AF retrieve request to query the candidate DNAI(s) of a list of UEs.\nPCF:\n-\tsupports handling the AF retrieve request and sending corresponding DNAI retrieve request to SMF.\nSMF:\n-\tsupports selecting the candidate DNAI(s) for the UE according to the location of the UE(s) and the DNAI topology;\n-\tsupports notifying the AF about the candidate DNAI(s) of the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.18\tSolution 18 (KI#4): Discovery of the same EAS for collections of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.18.1\tDescription",
                            "text_content": "In order to realize the discovering the same EAS to collections of UEs, the following conditions should be satisfied:\n-\tThe same FQDN in DNS query or a group of FQDNs that can be resolved to a certain EAS IP address by DNS server. The same EAS can be mapped to one FQDNs or a group of FQDNs. Only the collections of the UEs request the same DNS query with these FQDNs, that the DNS server can provide the same EAS IP address.\n-\tThe collections of the UEs have the similar UE location. For example, in a stadium, some of the players can access the 5GC by the same gNB or a group of gNBs, UEs are located in a specific location area. According to the UE location information, the 5GC can identify that these UEs should be served by the same EAS.\n-\tThe collections of the UEs are identified by UE Identifiers, e.g. UEs belong to an Ad-hoc group.\nAn AF request may be created to include indication of EAS correlation and pre-conditions as defined in step 1 of figure 4.3.6.2-1 of TS 23.502 [9], which is used to request selecting the same EAS for a collection of UEs. The pre-conditions indicate the conditions whether a UE belongs to a collection of UEs. The pre-conditions may reuse the information elements as defined in clause 5.6.7 of TS 23.501 [2], which includes Spatial Validity Condition (e.g. Area of Interest(s)), FQDN(s)/Application Identifier(s), Target UE Identifier(s). The PCF creates the PCC rule based on information provided in AF request, and sends the PCC rule to SMF.\nThe pre-conditions may also be a local policy preconfigured on SMF. The SMF determines whether the pre-conditions are satisfied, and which UE collection the UE belongs to, according to the pre-conditions and received information (e.g. UE location is in the Area of Interest, requested FQDN in DNS query).\nIf the Spatial Validity Condition is provided in AF request as the pre-condition, the PCF subscribes to the SMF to receive notifications about change of UE location in an area of interest. The SMF is aware the UE location is in or out of the subscribed area of interest and sends notifications to the PCF, as specified in clause 5.6.7.1 of TS 23.501 [2]. If the FQDN(s)/Application Identifier(s) is provided in AF request as the pre-condition, it is carried in the PCC rule as Service data flow template. If the indication of EAS correlation is included in the PCC rule, then SMF determines which UE collection the UE belongs to, accordingly.\nNOTE 1:\tTarget UE Identifier(s) can be group identifier and stored in UDR as current mechanism.\nNOTE 2:\tFor multiple SMFs situation, the updated information (e.g. common EAS/DNS server) are stored in UDR and synchronize the data to other SMFs.\nWhen the pre-conditions above are guaranteed, that for the 5GC side, the following procedures can be used to realize to discover the same EAS for these UEs:\n-\tUse the same DNS server to resolve the FQDN. It needs the 5GC to deliver the same DNS server IP address to these UEs, for example, the EASDF or local DNS server.\n-\tIf the same local DNS server is selected, that whether the EAS will be resolved depends on the DNS server's mechanism that is out of scope.\n-\tIf the same EASDF is selected, that all these DNS query should be treated with the same way, that applied to the same DNS message handling rules. Whether and how the C-DNS or L-DNS to resolve the same EAS depends on the DNS server's mechanism that is out of scope.\n-\tDirectly responds to the DNS query to UE. This way only applies to the EASDF. That if the EASDF identifies that the UE's DNS query should be replied with the same EAS that other UEs use, the EASDF can directly respond with the DNS query without having the DNS related procedure to DNS server. The SMF may determine a timer to update the IP address of EAS in DNS message handling rule using the Neasdf_DNSContext_Update Service. How the SMF determines the timer is by implementation.\nTable 6.18.1-1: Example of pre-conditions of configured the same EAS\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.18.1-1: Example of pre-conditions of configured the same EAS",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.18.2\tProcedures",
                            "text_content": "The figure depicts a procedure for discovering the same EAS, which is an essential aspect of EASDF related procedures. The figure includes a flowchart and a list of steps, illustrating the step-by-step process to identify and resolve EAS issues.\nFigure 6.18.2.1-1: EASDF related procedure to discover the same EAS\n0.\tThe AF may request the indication of EAS correlation and pre-conditions and the PCF creates the PCC rule correspondingly as described in clause 6.18.1.\n0.\tThe SMF determines the pre-conditions of the UEs that should be configured with the same EAS. The pre-conditions may be a local policy or derived based on PCC rule received from PCF. The pre-conditions are defined below:\n-\tThe same FQDN in DNS query or range of FQDNs that can be resolved to a certain EAS IP address by DNS server. The same EAS can be mapped to one FQDNs or a group of FQDNs. Only the collections of the UEs request the same DNS query with these FQDNs, that the DNS server can provide the same EAS IP address(es).\n-\tThe collections of the UEs have the similar UE location, for example, the same UE location or the UE location in the Area of Interest. According to the UE location information or UE is IN/OUT of Area(s) of Interest, the 5GC can identify that these UEs should be served by the same EAS. The UE location includes: Cell ID, range of Cell ID, TAI lists, DNAI, range of DNAI, gNB ID, range of gNB ID, DNN, S-NSSAI.\nNOTE 1:\tIf the pre-conditions are provided by AF and include location information, then the SMF is aware the UE location is in or out of the subscribed area of interest and sends notifications to the PCF, and the SMF determines which UE collection the UE belongs to, as described in clause 6.18.1.\n0.\tThe 5GC can deliver the same DNS server IP address to these UEs that satisfy the pre-conditions, for example, the EASDF.\n1.\tThe UE sends a DNS Query message to the EASDF.\n2.\tThe same procedure as step 8 defined in figure 6.2.3.2.2-1 of TS 23.548 [3]. The EASDF provides the FQDN in DNS query to SMF.\n3.\tThe same procedure as step 9 defined in figure 6.2.3.2.2-1 of TS 23.548 [3].\n4.\t[Conditional] The SMF determines the Area(s) of Interest and subscribes to UE mobility event notification from the AMF (e.g. location reporting, UE moving into or out of Area of Interest), or the UE location from AMF by Namf_EventExposure_Subscribe (event ID = UE moving in or out of Area of Interest, UE location). The UE location information and UE presence IN or OUT of Area of Interest can be used by SMF to identify whether this UE should be configured with the same EAS.\n5.\t[Conditional] The AMF responds to SMF.\n6.\t[Conditional] The AMF notifies the SMF of UE(s) presence (IN, OUT, or UNKNOWN) in the Area(s) of Interest or the UE location information, including: TAI, Cell ID and etc.\n7.\tSMF determines whether the UE is satisfied with the pre-conditions, according to UE location information and/or FQDN(s). If the UE location information is in the scope of UE location that defined in pre-conditions, and the FQDN is also in the scope of pre-defined scope, the SMF determines:\n-\tuse the same DNS server to resolve the FQDN. The DNS query should be treated with the same way, that applied to the same DNS message handling rules, e.g. the same DNS server address or information of EDNS Client Subnet option is indicated in the Forwarding Action.\n-\tdirectly responds to the DNS query to UE. This way only applies to the EASDF. That if the SMF identifies that the UE's DNS query should be replied with the same EAS that other UEs use, the SMF can set the DNS message handling rules to EASDF to directly respond with the DNS query without having the DNS related procedure to DNS server, e.g. add a new action for Forwarding Action: forward the DNS response with specific EAS IP address to UE. The SMF should update the IP address of EAS in DNS message handling rule using the Neasdf_DNSContext_Update Service based on the timer retrieved by implementation.\nNOTE 2:\tFor the load balance of service, the DNS server can reply different IP address of EAS. But, these IP addresses still stay in the same IP range or in the similar IP range.\n8.\tThe SMF updates the DNS message handling rule to guarantee the same EAS discovery for this UE. The SMF invokes Neasdf_DNSContext_Update Request (DNS message handling rules) to EASDF, and the DNS message handling rules are the same as pre-defined of other UEs.\nFor Option A, the DNS handling rule includes the same corresponding IP address to be used to build the EDNS Client Subnet option. For Option B, the DNS handling rule includes corresponding Local DNS Server IP address which is also the same as other UEs.\n9-15.\tThe same procedure from step 11 to step 19 as defined in figure 6.2.3.2.2-1 of TS 23.548 [3].\nAccording to the enhancement from SMF, this UE can receive the same EAS IP address as other UEs which satisfies the pre-condition.\nThe figure depicts a direct DNS response to an UE, illustrating the communication path from the source to the destination. The figure shows the path from the source to the destination, with the DNS response highlighted in red, indicating the path taken by the data. The figure also includes the source IP address and the destination IP address, providing a clear visual representation of the communication path.\nFigure 6.18.2.2-1: Direct DNS response to UE\n0-6.\tThe same procedure as indicated in Figure 6.18.2.1-1 from step 0 to step 6.\n7.\tSMF determines whether the UE is satisfied with the pre-conditions, according to UE location information and/or FQDN. The SMF can also recover the DNAI, PSA ID, DNN, S-NSSAI of the UE or the UE's PDU Sessions. If the UE location information in the scope of pre-defined UE location, and the FQDN is also in the scope of pre-defined scope, the SMF determines to discover the same EAS to this UE as other UEs in group. SMF decides to have a direct DNS response to the UE.\n8-9.\tThe same procedure as indicated in Figure 6.18.2.1-1 from step 8 to step 9. But SMF invokes Neasdf_DNSContext_Update Request (DNS message handling rules) to EASDF to directly respond to the UE DNS query with the same EAS IP address that other UEs are served. The SMF should update the IP address of EAS in DNS message handling rule using the Neasdf_DNSContext_Update Service based on the timer retrieved by implementation.\n10.\tThe EASDF sends the DNS Response(s) to the UE with the same EAS IP address that other UEs are served.\nThe figure depicts the EAS (Emergency Alert System) discovery procedure, which involves the use of a local DNS server/resolver to identify and locate the local DNS server. The figure illustrates the steps involved in the EAS discovery process, including the use of a local DNS server to resolve the domain name, and the process of updating the DNS server's cache with the new domain name. The figure also includes a diagram of the EAS system, showing the various components and their connections.\nFigure 6.18.2.3-1: EAS Discovery Procedure with Local DNS Server/Resolver\n1.\tThe UE sends a PDU Session establishment request to SMF.\n2.\tSMF determines whether the UE is satisfied with the pre-conditions, according to UE location information and FQDN. The SMF can also recover the DNAI, PSA ID, DNN, S-NSSAI of the UE or the UE's PDU Sessions. If the UE location information in the scope of pre-defined UE location, and the FQDN is also in the scope of pre-defined scope, the SMF determines to discover the same EAS to this UE as other UEs in group. The SMF determines the DNAI and selects corresponding PSA UPF serves the DNAI, and determines DNS server(s) to ensure a dynamic group uses the same EAS and/or same DNAI.\n3.\tOptionally, the SMF selects and inserts UL-CL/BP. The SMF configures the UL-CL/BP for DNS Query handling.\n4.\tThe SMF includes the IP address of Local DNS Server in PDU Session Establishment Accept message.\n5.\tThe EAS information (e.g. EAS IP address) is resolved by Local DNS Server and sent the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.18.3\tImpacts on services, entities and interfaces",
                            "text_content": "SMF:\n-\tdetermines the pre-conditions of whether the collections of the UE should be configured with the same EAS.\n-\tdetermines whether the UE is satisfied with the pre-conditions, according to UE location information and FQDN.\n-\tdecides to have a direct DNS response to the UE or configure the same DNS message handling rule to this UE DNS query, according to the configurations in the pre-conditions;\n-\tupdates the IP address of EAS in DNS message handling rule using the Neasdf_DNSContext_Update Service based on the timer retrieved by implementation.\nEASDF:\n-\tdirectly responds to the UE DNS query with the EAS IP address that other UEs are served.\nAF:\n-\tsends the indication of EAS correlation.\nPCF:\n-\tcreates PCC rule based on information provided in AF request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.19\tSolution 19 (KI#4): Influencing UPF and EAS (re)location for collections of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.19.1\tIntroduction",
                            "text_content": "This solution aims to address the technical requirements related to key issue #4. In particular, it proposes for certain Edge Application use case e.g. all users playing a certain online game and registered to a particular EAS, or all UEs in a platoon, how these UEs collectively for an ad hoc and dynamic group, how to identify such group, how to handle coordination of the UPF(s) and EAS (re)location for the UEs belonging to the same group.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.19.2\tFunctional Description",
                            "text_content": "The following are the main principles of the solution:\n-\tApplication Function creates an ad hoc group of collection of UEs specific to specific use cases and based on its respective criteria, for example: all Users served by the same EAS that hosts an online gaming application, and ad hoc group of UEs of a Platoon..\n-\tApplication Function creates an ad hoc group of collection of UEs, and provides to 5GC, either directly or via NEF, the necessary group specific information, together with (external) group ID.\n-\tNEF performs AF request authorization and provides necessary mappings, and configures UDM with the ad hoc group information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.19.3\tProcedure",
                            "text_content": "The figure 6.19.3.1-1 below provides a detailed call flow on ad hoc group and group specific attributes provisioning by AF.\nThe figure depicts a network setup with a provisioned ad hoc group information. It shows the AF (Access Facilitation) provisioned group information, which is a crucial component in the network's security and performance. The AF provisioned group information is used to ensure that the network can provide secure and reliable communication services to its users. The figure also includes the AF provisioned group information, which is a key component in the network's security and performance. The AF provisioned group information is used to ensure that the network can provide secure and reliable communication services to its users. The figure also includes the AF provisioned group information, which is a key component in the network's security and performance. The AF provisioned group information is used to ensure that the network can provide secure and reliable communication services to its users. The figure also includes the AF provisioned group information, which is a key component in the network's security and performance. The AF provisioned group information is used to ensure that the network can provide secure and reliable communication services to its users. The figure also includes the AF provisioned group information, which is a key component in the network's security and performance. The AF provisioned group information is used to ensure that the network can provide secure and\nFigure 6.19.3.1-1: AF Provisioning Ad-hoc Group Information\n1.\tApplication Function configures an ad hoc dynamic group of a collection of UEs. These collection of UEs are based on common use case or application. e.g. all users registered on a particular gaming server (EAS) or all UEs in a platoon. AF assigns an (external) Group ID to this collection of UEs. AF provisions this group information to 5GC either directly or via NEF and provides required details including: (external) group ID, Group Type (this is to differentiate with static groups based on user subscriptions), collection of UEs IDs forming the group, i.e. list of group members, and group property or attributes such as all users to be served by the same EAS.\nAlternatively, AF may use new API e.g. Nnef_GroupParameterProvision_Create/update/delete to provision these information.\nGroup Type indicates specific ad hoc groups e.g. an ad hoc group specific to platooning or an ad hoc group of UEs playing online game and registered to a particular gaming server/EAS. Group Type may be used by NEF to translate group specific 5GC internal requirements and store in the UDM/UDR as group attribute information, for example:\n-\tall group members to be served by same SMF. This may be based on indication from AF such as Specific Application e.g. platooning and/or based on preconfigured logic of the NEF;\n-\tsame PSA-UPF and DNAI for all UEs in the group. This may be based on indication from AF such as same EAS, or Specific Application e.g. online gaming or based on preconfigured logic on NEF.\n2.\tNEF after authorizing the AF request, creates or updates these information in UDM. It translates AF provided information into corresponding 5GC internal information such as external Group ID into an internal group ID. The Group Attributes are group specific information such as indication to use same EAS for all group members, or same PSA UPF.\nNEF stores (or updates) these in UDM.\nAs specified in clause 4.15.6.2 of TS 23.502 [9], and clause 6.5.6.2.6 of TS 29.503 [18], UDM/UDR assigns/allocates a unique Internal Group ID.\n3-4.\tUDM uses Nudr_DM_Query/Update to UDR. UDR stores the data as part of the Group subscription data and responds with Nudr_DM_Create/Update/Delete Response message.\nTable 6.19.3-1: Ad hoc group data\n\nTable 6.19.3-2: Ad hoc group membership management parameters\n\n5.\tUDM responds with Nudm_ParameterProvision_Create/Update/Delete Response.\n6.\tNEF responds to AF with Nnef_ParameterProvision_Create/Update/Delete Response.\n7.\tUDM notifies to the subscribed Network Function e.g. AMF and SMF, of the Group subscription data via Nudm_SDM_Notification Notify message. The SMF stores the received parameters and associates them with a PDU Session based on the DNN and S-NSSAI included in the message from UDM.\nThe group information is used e.g. by SMF to ensure collective and common behaviour and treatment to the member UEs of the ad hoc group. For example, all the UEs of a particular ad hoc group are (re-)located in the same EAS instance as in solution 6.37.\nFor certain group applications e.g. platooning, network can improve and optimize services and possibly reduce management/signalling overhead by ensuring same SMF (or SMF instances belonging to the same SMF set) serves all the group member UEs. This SMF then provides common and coordinated treatment of the group member UEs.\nBelow figure 6.19.3.2-1 provides details to allow the serving SMF to register itself in the UDM/UDR updating the particular group information.\nThe figure depicts a network setup with multiple SMF registers, UDM/UDR, and a UPC. The UPC is responsible for managing the signaling and data traffic, while the SMF registers are responsible for managing the signaling and data traffic. The UDM/UDR is responsible for managing the signaling and data traffic for the UPC. The figure shows the network's architecture and how the different components work together to provide a reliable and efficient communication network.\nFigure 6.19.3.2-1: Serving SMF registers to the UDM/UDR\n1-2.\tSame as in TS 23.502 [9].\n3.\tSMF registers SMF ID and/or SMF Set ID (serving the group), to UDM/UDR and/or to NEF.\n-\tSMF uses Nudm_UECM_Registration API or a new message/API to register SMF ID and/or SMF set ID to the particular ad hoc group ID.\n-\tAlternatively, SMF may update its SMF ID and/or SMF set ID for the particular ad hoc group to UDR via NEF.\n4-5.\tUDM may further store this information in UDR by Nudr_DM_Update, thus updating ad hoc group attributes to indicate the serving SMF for the particular Group.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.19.3-1: Ad hoc group data",
                                    "table number": 7,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.19.3-2: Ad hoc group membership management parameters",
                                    "table number": 8,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.19.4\tImpacts on services, entities and interfaces",
                            "text_content": "AF:\n-\tprovisions ad hoc group information to the 5GC.\nNEF:\n-\tauthorizes, translates and stores ad hoc group information to UDM/UDR.\nSMF:\n-\tsubscribes to the ad hoc group subscription data, and also updates its ID in the group information stored in the UDM/UDR.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.20\tSolution 20 (KI#5): Global EASDF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.20.1\tDescription",
                            "text_content": "This solution addresses KI#5: GSMA OPG impacts and improvements for EHE operated by separate party.\nIn this solution, the UE uses a predefined EASDF that is global between operators. For example, GSMA could host this with the URL:\nhttp://easdf.mnc<MNC>.mcc<MCC>.pub.3gppnetwork.org\nEach operator that wants to support separate party's EHE into their network will then add these EHEs entry points into the DNS entry owned by themselves in the Global EASDF. There are two alternatives to do this, either they add the EAS entry point directly into the Global EASDF. The other alternative is to add the entry point to another EASDF into the Global EASDF. With the second alternative then the UE shall now use that received IP address as EASDF to discover the appropriate EAS according to existing procedures. Since the Global EASDF is based on standard DNS infrastructure that allows an operator to specify which order the UE shall select EAS/EASDF in the different separate party's operated EHEs. If we allow both alternatives, then it is up to each operator to decide which method they want to use as long as we specify that the UE shall support both methods. The second alternative with discovering another EASDF allows more static configuration in the Global EASDF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.20.2\tProcedures",
                            "text_content": "The figure depicts a global EASDF (Emergency Alert System Distribution Function) network, illustrating the distribution of EASDF signals across different regions. The network is composed of various components, including EASDF transmitters, receivers, and relay stations, all interconnected through a network of fiber-optic cables. The figure highlights the importance of redundancy and failover mechanisms to ensure the reliability of the EASDF system in case of any disruptions or failures.\nFigure 6.20.2-1: Global EASDF\n0.\tPre-requisites: HPLMN has configured the Global EASDF with appropriate entries for all separate party's EASDF and/or their EAS they want to enable in their network.\n1.\tExisting PDU Session establishment procedure according to step 1 in clause 6.2.3.2.2 of TS 23.548 [3].\n2.\tFor Option A, the UE performs a DNS query to the Global EASDF. Since this is a public FQDN to the Global EASDF, the UE may use any locally configured DNS Server that in turn will use next DNS server in the DNS hierarchy until it goes to the Global EASDF.\nNOTE 1:\tThe unique identifier to use for querying another EASDF will be specified during the normative phase.\nNOTE 2:\tThe structure of the DNS Query is the same as defined in solution#09 in clause 6.9.\n3.\tThe Global EASDF responds with the IP address of the EASDF that the UE should use in next step.\n4.\tThe UE performs EAS Discovery, as specified in step 7 in clause 6.2.3.2.2 of TS 23.548 [3] except that it uses the IP address received in step 3 as DNS server for the DNS query instead of the one received during PDU Session establishment procedure.\n5.\tEASDF sends the DNS Response to the UE, as specified in step 19 in clause 6.2.3.2.2 of TS 23.548 [3].\n6.\tFor Option B, The UE performs EAS Discovery, as specified in step 7 in clause 6.2.3.2.2 of TS 23.548 [3] and uses the IP address of the Global EASDF instead of the one received during PDU Session establishment procedure.\n7.\tEASDF sends the DNS Response to the UE, as specified in step 19 in clause 6.2.3.2.2 of TS 23.548 [3].\n8.\tThe UE application starts to utilize the provided EAS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.20.3\tImpacts on services, entities and interfaces",
                            "text_content": "UE:\n-\tconfigured with the FQDN for the Global EASDF. The UE allows to perform a EASDF Discovery from the EASDF address that the UE received from the Global EASDF.\nGlobal EASDF:\n-\tacts as a DNS Server and responds to the DNS Queries from the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.21\tSolution 21 (KI#5): EAS Deployment information differentiated by PLMN ID",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.21.1\tIntroduction",
                            "text_content": "This solution proposes an EAS discovery method for the scenario described in clause 2.1.5 of GSMA OPG.02 [5] that an OP deploys applications provided by Application Providers on another OP. This solution focuses on the scenario that the OPs are different PLMNs. In this case, the problem is to ensure the EAS deployed by HPLMN in VPLMN's EHE should only be discovered and accessed by the UE of the HPLMN roaming to the VPLMN and using LBO PDU Session. This solution introduces how to handle the DNS requests to ensure an EAS deployed by a PLMN can only be accessed by the UE of same PLMN.\nThis solution corresponds to KI#5.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.2\tFunctional Description",
                            "text_content": "This solution is based on the following principles:\n-\tThe EAS Deployment information provided by AF contains the EAS provider's ID (i.e. PLMN ID) to differentiate the EAS deployment information of different PLMNs. Different EAS providers (PLMNs) may use different DNS servers (e.g. C-DNS server or Local DNS server) to discover the EAS deployed by the PLMNs.\n-\tDuring the PDU Session Establishment procedure, the SMF selects the proper PLMN's EAS Deployment Information based on UE's HPLMN ID and then generates corresponding DNS message handling rule to handle DNS messages related to the roaming UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.3\tProcedures",
                            "text_content": "The EAS Deployment Information Provision procedure reuses the procedure defined in clause 6.2.3.4.2 of TS 23.548 [3]. The enhancement is that the EAS Deployment information provided by AF in step 1 includes PLMN ID to differentiate EAS deployment information of different PLMNs. EAS deployment information of different PLMNs may contain different DNS servers (e.g. C-DNS server or Local DNS server) or different ECS options.\nThe EAS Deployment Information Management in the SMF reuses the procedure defined in clause 6.2.3.4.3 of TS 23.548 [3].\nThe EAS discovery procedure with EASDF defined in clause 6.2.3.2.2 of TS 23.548 [3] is reused to discover the EAS(s) deployed by different providers. The enhancement is that the during the PDU Session Establishment procedure, the SMF selects the proper provider based on HPLMN ID. The SMF queries the UDR via NEF with the HPLMN ID to get the EAS Deployment information and configures the EASDF with DNS message handling rules to handle DNS messages related to the UE. Then the following steps in clause 6.2.3.2.2 of TS 23.548 [3] are reused for DNS queries and UL-CL/BP insertion.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.21.4\tImpacts on services, entities and interfaces",
                            "text_content": "AF:\n-\tsupports sending EAS Deployment information with PLMN ID to differentiate the EAS deployment information of different providers.\nSMF:\n-\tsupports selecting proper provider based on roaming UE's HPLMN ID and configures the EASDF according to the EAS Deployment information of the HPLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.22\tSolution 22 (KI#5): EAS discovery for Edge Node Sharing",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.22.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #5 and allows the discovery of an Edge Application Server (EAS) in case of Edge Node Sharing. In this solution, it is assumed that the EAS is hosted by a different PLMN than the PLMN that is serving the UE.\nNOTE:\tIt is assumed that the EAS is hosted by a different PLMN than the PLMN serving the UE, and that the two PLMNs have IP connection at the edge area.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.22.2\tFunctional description",
                            "text_content": "This solution is based on the Rel-17 EAS based discovery procedures with the assumption that the SMFs of each PLMN Sharing Edge Node need to be configured with the DNAI values associated to the EAS' hosted by the other Operators. More in details:\n-\tthe SMF needs to know the EAS deployment information of the EAS running on other PLMN's edge infrastructure e.g. IP address range(s)/FQDN(s).\nFor example, if the EAS is running in MNO 2's PLMN#2, when the EAS discovery is triggered the EASDF in MNO 1's PLMN#1 will receive the DNS response from the DNS server knowing the EAS' address and will forward the EAS' address to the SMF in PLMN#1.\n-\tAt this point, after the SMF gets the IP address of EAS running in PLMN#2, in order to know that the EAS is instantiated in PLMN#2's edge infrastructure, it is required that the SMF knows the mapping between the PLMN ID of the PLMN hosting the EAS and the corresponding IP address received as a result of the DNS query so that the SMF can steer the user plane path towards the PLMN#2's domain. This may require an update of the SMF each time an EAS is added or removed.\nThis option is based on the concept of shared EAS Discovery Function (shared EASDF), which is a new network entity shared among multiple operators and used to support the discovery of EAS for shared Edge Nodes.\nThe figure depicts a network architecture with deployed Shared EASDF (Energy Access Service Delivery Function) components, illustrating the interconnection of various network elements.\nFigure 6.22.2.1-1: Architecture with deployed Shared EASDF\nThe Shared EASDF is a new network entity deployed in the core network and shared among the PLMNs of the MNOs that support Edge Node Sharing. The shared EASDF is hosted by one PLMN. The PLMN hosting the shared EASDF is the anchor PLMN. The communication between other PLMNs and the shared EASDF takes place via the serving EASDF (sEASDF) and the serving SMF (sSMF), that is via the EASDF and the SMF of the PLMN serving the UE. The sSMF handles the DNS context on the shared EASDF in a similar way as for the sEASDF, i.e. via the Neasdf_DNSContext_Create service.\nThe shared EASDF stores EAS deployment information such as EAS address hosted by other PLMNs. An operator needs to update its EAS information in the shared EASDF any time a change is applied (e.g. an EAS is added/modified/removed, or an MNO joins or leaves sharing of Edge Node).\nThis solution option is based on the communication between the EASDFs of the different PLMNs of the MNOs that support sharing of Edge Nodes. The EASDF of a PLMN manages information for EAS' that are hosted by the Edge Data Network of that PLMN, and the EASDF of a PLMN can interact with other PLMNs' EASDFs to support Edge Node Sharing.\nArchitecture\nThe figure depicts a network architecture with per-PLMN EASDF (Enhanced Access Service Delivery Function) for enhanced service delivery. The architecture includes various components such as EASDF, EASDF-B, EASDF-C, and EASDF-D, which are used to deliver enhanced services to users. The figure also includes a network diagram with various layers, such as the core network, access network, and service network, which are interconnected to provide a comprehensive network infrastructure.\nFigure 6.22.2.2-1: Architecture with per-PLMN EASDF\nIn the figure above:\n-\tserving EASDF (sEASDF) and the serving SMF (sSMF) are, respectively, the EASDF and the SMF of the PLMN that is currently serving the UE;\n-\tpartner EASDF (pEASDF) is the EASDF of the partner PLMN which hosts the Edge Application Server whose service is desired.\nEAS Deployment Information extension\nBy using the Nnef_EASDeployment APIs, the AF provides to the CN the EAS Deployment Information (see table 6.2.3.4-1 of TS 23.548 [3]). Such information needs to be associated to the additional PLMN ID(s) and FQDN filter/DNS server address filter(s) to help the SMF identify, during EAS discovery, where the EAS is located. Table 6.22.2.2-1 shows the filtering information used to select the proper EAS and table 6.22.2.2-2 shows some examples of FQDN/DNS server address filter(s).\nTable 6.22.2.2-1: NEW: Filtering table for EAS Deployment Information\n\nTable 6.22.2.2-2: NEW: Examples of Filters for EAS Deployment Information\n\nEAS Discovery\nThe EAS discovery is based on the existing EAS discovery procedures described in TS 23.548 [3], with the following changes:\n-\tprovisioning of EAS deployment information to 5GS:\n-\tFor each of its EASs, the application service provider (via the AF) provides each PLMN Sharing Edge Nodes with the EAS deployment information with PLMN ID, DNAI, and (list of) FQDNs necessary to discover the EAS. Such information is stored in the UDR following the EAS Deployment Information Provision from AF via NEF procedure (clause 6.2.3.4.2 of TS 23.548 [3]).\n-\tThe SMF retrieves the EAS deployment information from the UDR (clause 6.2.3.4.3 of TS 23.548 [3]) and provides the following pieces of information to the EASDF (clause 6.2.3.4.4 of TS 23.548 [3]):\na)\tFQDN filter: the list of filters regarding FQDN in the DNS query from the UE;\nb)\tDNS server address filter: the list of filters regarding DNS server address in the DNS query from the UE;\nc)\tPLMN ID associated with the FQDN filter or DNS server address;\nd)\tAction: DNS query forwarding to the target pEASDF, reporting to the SMF.\n-\tEAS discovery:\n-\tAt EAS discovery (clause 6.2.3.2.2 of TS 23.548 [3]), the sEASDF determines the target pEASDF associated with the PLMN ID, if the received DNS query (from the UE) meets the following conditions:\n-\tthe FQDN in the DNS query matches with the configured FQDN filter associated with the DNAI/PLMN ID;\n-\tthe DNS server address in the query matches with the configured DNS address filter with the DNAI/PLMN ID.\n-\tBased on the indication by the sSMF, the sEASDF forwards the query to target pEASDF.\n-\tTarget pEASDF replies with the specific DNAI/PLMN ID result.\n-\tThe result is reported to the sSMF.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.22.2.2-1: NEW: Filtering table for EAS Deployment Information",
                                    "table number": 9,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table 6.22.2.2-2: NEW: Examples of Filters for EAS Deployment Information",
                                    "table number": 10,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.22.3\tProcedures",
                            "text_content": "This option re-uses the EAS discovery procedure defined in clause 6.2.3.2.2 of TS 23.548 [3].\nFigure 6.22.3.1-1 describes a modified EAS discovery procedure based on the Rel-17 procedure described in TS 23.548 [3].\nThe figure depicts a modified EAS discovery process for Option 1, which is a part of TS 23.548. The figure shows the steps involved in the EAS discovery process, including the use of a modified clause to ensure the discovery of Option 1 is successful. The figure also includes a visual representation of the EAS discovery process, with arrows indicating the flow of information from the source to the destination.\nFigure 6.22.3.1-1: Modified EAS discovery (clause 6.2.3.2.2 of TS 23.548 [3]) for Option 1\nThe procedure is based on the EAS discovery procedure defined in clause 6.2.3.2.2 of TS 23.548 [3], with the following changes:\n-\tnew step 9a: based on the DNS message report sent by the sEASDF in steps 8/9, the SMF selects the shared EASDF.\n-\tnew step 9b/c: the sSMF creates the DNS context in the shared EASDF.\nNOTE 1:\tIn case of IPv4, it is assumed that the SMF knows the UE's public IP address. This can be done based on interaction with the NAT server and/or on implementation specific ways.\n-\tsteps 10/11: the sSMF instructs the sEASDF to forward the DNS query to the shared EASDF. The sSMF provides to the serving EASDF the FQDN filter (e.g. FQDN ranges) to be reported. The FQDN filter indicates that the shared EASDF needs to be contacted to resolve the DNS query.\n-\tnew step 11a: the sEASDF forwards the DNS query to the shared EASDF.\nNOTE 2:\tWhile the sEASDF matches the DNS query with the DNS context for the UE (as per Rel-17), the Shared EASDF does not need to do that because it uses the DNS ECS option to select the most appropriate EAS. In that sense the Shared EASDF behaves as a regular DNS server. The need to have a DNS UE context in the Shared EASDF for UE accessing from partner PLMNs can be discussed in the normative phase.\n-\tnew step 13a: the shared EASDF resolves the DNS query and sends the DNS reply to the sEASDF.\nNOTE 2:\tAlternatively to steps 11a/13a, the DNS query can be forwarded by the sEASDF to the shared EASDF via the SMF.\nFigure 6.22.3.2-1 describes the modified EAS discovery procedure based on the Rel-17 procedure described in TS 23.548 [3].\nThe figure depicts a modified EAS discovery process for Option 2, which is a part of TS 23.548. The figure shows the steps involved in the EAS discovery process, including the use of a modified clause to ensure compliance with the specified requirements. The figure is a visual representation of the process, allowing for easy understanding and comparison with other EAS discovery processes.\nFigure 6.22.3.2-1: Modified EAS discovery (clause 6.2.3.2.2 of TS 23.548 [3]) for Option 2\nThe procedure is based on the EAS discovery procedure defined in clause 6.2.3.2.2 of TS 23.548 [3], with the following changes:\n-\tin step 3: the sSMF may provide to the serving EASDF the Filters for EAS Deployment Information (e.g. FQDN ranges) to be reported.\n-\tnew step 9a: based on the DNS message report sent by the sEASDF in steps 8/9 and on mapping criteria (see e.g. clause 6.40) or local configuration (i.e. a list of preconfigured, per partner PLMN DNS servers), the SMF selects the pEASDF or the preconfigured DNS server, respectively.\n-\tsteps 10/11: the sSMF instructs the sEASDF to forward the DNS query to the selected partner EASDF or to at least one preconfigured DNS server in the partner PLMNs.\n-\tnew step 11a: the sEASDF forwards the DNS query to the pEASDF or to at least one preconfigured DNS server in the partner PLMNs.\nNOTE: \tWhile the sEASDF matches the DNS query with the DNS context for the UE (as per Rel-17), the partner EASDF does not need to do that because it uses the DNS ECS option to select the most appropriate EAS. In that sense, the pEASDF behaves as a regular DNS server. The need to have a DNS UE context in the pEASDF for UE accessing from partner PLMNs can be discussed in the normative phase.\n-\tnew step 13a: the pEASDF resolves the DNS query and sends the DNS reply to the sEASDF. In case of multiple replies to the sEASDF, the sEASDF selects (based on internal logic) which pEASDF (and, consequently, which partner PLMN) is to be used for the EAS selection.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.22.4\tImpact on existing entities and interfaces",
                            "text_content": "SMF:\n-\tneeds to know EAS deployment information (IP address range(s)/FQDN(s)) of each EAS running in the PLMNs of the operators supporting Edge Node Sharing;\n-\tneeds to be configured with mapping between EAS deployment information and PLMN ID. If EAS' are added or removed, the configuration information needs to be updated.\nEASDF:\n-\trequires capability to communicate with shared-EASDF forward DNS query to and receive DNS response.\nShared-EASDF:\n-\tneeds to be configured with IP range/FQDN of list of all EAS' running in PLMNs of operators participating in the Edge Node Sharing.\nSMF:\n-\tneeds to be configured with shared-EASDF address.\nEASDF:\n-\trequires capability to communicate with EASDFs of another PLMN to forward DNS query to and receive DNS response.\nSMF:\n-\tneeds to be configured per-PLMN EASDF addresses.\nAF:\n-\tprovides CN with EAS Deployment Information with PLMN ID(s) and/or Filters.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.23\tSolution 23 (KI#5): Improvements for EHE operated by separate party",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.23.1\tIntroduction",
                            "text_content": "This solution aims to address the technical requirements related to key issue #5. In particular, it provides solutions to, among others, how the 5GS facilitates edge relocation between an EAS deployed by a source EHE provider to another EHE deployed by a target EHE provider, even in scenarios when EHEs are operated by different service providers. This solution has following architecture assumptions:\n-\tthe architecture for Edge computing specified in Rel-17 is used as basis;\n-\tthe Edge Hosting Environment (EHE) can be under the control of the serving network operator or a 3rd party;\n-\tthe target and source AFs communicate with the SMF/NEF of a single PLMN;\n-\tinterconnectivity between EHEs of different operators is available, thus those deployments that does not support this would need further enhancements.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.23.2\tFunctional Description",
                            "text_content": "The following are the main principles of the solution:\n-\tIn case of multiple and/or different EHE providers, it is possible that there is no cooperation and agreements among different Edge domains, thus implying that source EHE is unaware of other/target EHE specific deployment details. In such cases, specific to Edge relocation scenarios, source AF is unaware of suitable target AF and/or target EAS. Thus, source AF is not always able to assist suitable AF and EAS relocation as per clause 4.3 of TS 23.548 [3].\n-\tEHE providers likely have some kind of agreements with the 5GS, thus enabling 5GS to know respective EHE domain deployment details and corresponding AF, service area, TAI, application supported, etc.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.23.3\tSolution Details",
                            "text_content": "-\tThe selection of the target EHE, and corresponding AF/EAS is triggered due to multiple reasons, for example UE mobility, EAS overload, etc.\n-\tSMF is able to know AF in the target EHE. This may be possible with either NRF or NEF maintaining AF list indicating for each AF one or more of these parameters: EHE domain it supports, service area, application supported, etc. This list could be based on e.g. pre-configuration and SLA with the EHE domain. Accordingly, SMF selects suitable target AF based on e.g. UE current location.\nThe figure 6.23.3-1 below provides call flow where AF and EAS relocations are performed during early and late notifications.\nThe figure depicts a procedure to support EAS and/or AF relocation between EHEs from different providers. It illustrates the steps involved in relocating EAS and/or AF systems, including the use of a relocation table, communication with the relevant provider, and coordination with the network team.\nFigure 6.23.3-1: Procedure to support EAS and/or AF relocation between EHE from different provider\n0.\tSMF decides to relocate AF and/or EAS based on different criteria such as UE new location, Anchor UPF relocation and so on.\n1.\tAs part of early notification, SMF provides target AF ID i.e. ID of the AF responsible for the new/target EC Domain corresponding to UE new location. SMF also provides source AF transaction ID. These are provided in the Nsmf_eventExposure_Notify and/or Nnef_TrafficInfluence_Notify.\n2.\tSource AF on receipt of message in step 1 above, initiates AF context exchange and provides to target AF these information: source EAS ID, Service ID, etc.\n3.\tTarget AF responds by sending Relocation Reply with target EAS ID and Service ID.\n4.\tEAS is relocated and if required application layer context are also exchanged.\nNOTE:\tThis may require some application layer exchange between source and target EAS/AFs. How these information are exchanged are outside the scope of SA2.\n5.\tSource AF Acknowledges to SMF by sending Nnef_EventExposure_AppRelocationInfo and Nsmf_EventExposure_AppRelocation_Info messages.\n6.\tAfter confirmation from AF and considering information provided by AF, SMF may re-configure user plane path, etc. as required.\n7.\tSMF sends Late notification to target AF in Nsmf_eventExposure_Notify and/or Nnef_TrafficInfluence_Notify.\n8.\tTarget AF sends acknowledgement to received late notification from SMF. New traffic descriptors are provided to replace the old ones which were provided earlier by the source AF.\n9.\tTarget AF sends Relocation Complete to the source AF so that the later deletes (relocated) EAS contexts.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.24\tSolution 24 (KI#1): Reuse Option D after UL-CL Insertion",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.24.1\tDescription",
                            "text_content": "This solution addresses the following aspect in KI#1:\n-\thow to support Rel-17 edge computing related procedures, such as EAS (re-)discovery, as specified in clause 6 of TS 23.548 [3].\nOption D is specified in clause 6.2.3.2.3 of TS 23.548 [3] to support EAS Discovery procedure with Local DNS Server/Resolver.\nThis solution addresses the scenario 2.2 of clause 5.1.2, that is, UE accessing V-EHE via a Home Routed (HR) PDU Session (i.e. with PSA in HPLMN) where HPLMN does not have the knowledge of EAS deployment information in VPLMN.\nThis solution assumes that the V-SMF in the VPLMN is authorized by HPLMN to insert the UL-CL and Local PSA during or after PDU Session Establishment based on the VPLMN operator's configuration, which can be based on the conclusion on other solutions for this key issue. With this assumption, Option D can work for both LBO and HR roaming cases.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.24.2\tProcedure",
                            "text_content": "The figure depicts a simplified representation of the EAS (Emergency Alert System) discovery process, with a Local DNS server/resolver as the primary component. The figure illustrates the steps involved in identifying and resolving the EAS signal, including the use of a Local DNS server/resolver to perform DNS lookups and resolve the EAS signal. The figure also highlights the importance of proper DNS configuration and maintenance to ensure the EAS system's functionality and reliability.\nFigure 6.24.2-1: EAS discovery with Local DNS server/resolver\n1.\tUL-CL and Local PSA are inserted by V-SMF. This procedure can happen during PDU Session establishment or can be triggered by DNS messages as defined in clause 6.2.3.2.2 of TS 23.548 [3]. During this procedure, the V-SMF instructs the UL-CL the traffic routing rule to route the DNS Query for an FQDN (range) to a local DNS Server/Local DNS Resolver.\nNOTE 1:\tOption D assumes that UL-CL steering is based on L4 information (i.e. DNS port number) and that UL-CL has visibility of the DNS traffic (i.e. FQDN in the DNS Query message). The UPF may be instructed by the SMF to apply different forwarding of non-ciphered UL DNS traffic based on the target domain of the DNS Query. Option D requests modification of destination IP address of DNS messages. Whether this is allowed or not is subject to local regulations. Option D does not apply to DoH or DoT messages.\n2.\tThe DNS Query message is sent by UE. The UL-CL locally routes the DNS Query message to Local PSA.\n3.\tThe Local PSA sends the DNS traffic to the Local DNS Server that resolves the FQDN target of the DNS Query by itself or that communicates with a C-DNS server to recursively resolve the EAS IP address.\nNOTE 2:\tThe Local PSA can send the DNS traffic to the Local DNS Server via tunnelling or via IP address replacement. If IP address replacement is used, the SMF sends the IP address of the Local DNS Server to the Local PSA and instructs the Local PSA to modify the packet's destination IP address (corresponding to EASDF) to that of the Local DNS Server.\n4.\tThe Local PSA receives DNS Response message from Local DNS server, it forwards it to the UL-CL/BP and the UL-CL/BP forwards the DNS Response message to UE.\nNOTE 3:\tIf IP address replacement has been enforced at step 3, the Local PSA replaces the source IP address to EASDF IP according to SMF instruction.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.24.3\tImpacts on services, entities, and interfaces",
                            "text_content": "V-SMF:\n-\tsupports UL-CL/Local PSA insertion, traffic routing rule configuration on UL-CL to route the DNS Query for an FQDN (range) to a local DNS Server/Resolver.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.25\tSolution 25 (KI#1): EAS discovery in VPLMN via V-EASDF for a HR PDU Session",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.25.1\tHigh level description",
                            "text_content": "The solution addresses a scenario where the UE accesses EHE in VPLMN via a HR PDU Session for the two sub-scenarios 2.1 and 2.2. in clause 5.1.2. In addition, the solution includes an option that allows the HPLMN to monitor, assist and validate VPLMN decisions for accessing EHE when that has been triggered by HPLMN (scenario 2.1).\nThe authorization for the traffic offload for a HR PDU Session with given S-NSSAI and DNN is received by the AMF from the UDM, based on a \"HR-LBO allowed\" indication in the UE subscription data.\nIn scenario 2.1, HPLMN has the knowledge of EAS Deployment information (EDI) in VPLMN for specific areas. In this solution, EDI Information structure in TS 23.548 [3] table 6.2.3.4-1 does not require VPLMN DNAIs, which simplifies the information exchanged between all parties (VPLMN DNAIs in EDI to HPLMN require that Home MNO understands the VPLMN DNAIs, that HPLMN shares them then with the Service providers (SPs) it has agreements with, and that SPs provide EDI related to VPLMN DNAIs and modify it if VPLMN DNAIs change). In this solution, EDI information is structured and grouped based on common steering needs, e.g. same SP EHE. As part of SLA between the HPLMN and VPLMN, HPLMN provides the list of EC FQDNs and/or traffic descriptors (e.g. destination IP ranges) for the traffic that would require access to EHE in VPLMN to trigger EAS Discovery and local traffic routing in VPLMN. This information is used to set the UL-CL filters and also to provision V-EASDF in the case of dynamic PSA insertion by DNS-based EAS discovery. Alternatively, this information can be conveyed to V-SMF by H-SMF during PDU Session establishment or update. AF can use clause 6.2.3.4 in TS 23.548 [3] EAS Deployment Information Management mechanisms to create/update/delete HPLMN knowledge of EAS Deployment information of specific services relevant for HPLMN roamers in VPLMN. A common steering identifier can be used instead of DNAI.\nFor scenario 2.1, when HPLMN wishes to monitor, assist and validate VPLMN decisions when HPLMN has triggered accessing EHE in VPLMN, the common steering identifier refers to Geo Location Area in VPLMN. This alternative requires that HPLMN knows how VPLMN ECSs map to the VPLMN Geo Location Areas.\nFor scenario 2.2, VPLMN has the knowledge of EAS Deployment information in VPLMN for specific areas. Clause 6.2.3.4 in TS 23.548 [3] EAS Deployment Information Management mechanisms can be used by AF to provide and keep updated EDI in VPLMN via V-NEF, and by V-SMF to retrieve that data and use in EAS Discovery procedures. Information can also be locally configured.\nAt HR PDU Session establishment, the HPLMN (H-SMF) receives V-EASDF address from V-SMF. For V-EASDF to be the DNS resolver for the EC FQDNs, there are two options:\n-\tA. H-SMF configures V-EASDF in the UE as DNS server for the PDU Session. V-SMF may insert a UL-CL/BP and local PSA to reach the V-EASDF, to eliminate DNS traffic tromboning. V-SMF gets the HPLMN DNS Resolver.\n-\tB. V-SMF receives the EC FQDNs (either by OAM or from H-SMF at PDU Session establishment), and it configures a local UL-CL for replacement of the destination IP address of DNS queries with EC FQDN to V-EASDF IP.\nNOTE 1:\tThe above solution is known as option D described in clause 6.2.3.2.3 in TS 23.548 [3]. Option D assumes that UL-CL steering is based on L4 information (i.e. DNS port number) and that UL-CL has visibility of the DNS traffic (i.e. FQDN in the DNS Query message). The UPF can be instructed by the SMF to apply different forwarding of unencrypted UL DNS traffic based on the target domain of the DNS Query. Option D requests modification of destination IP address of DNS messages. Whether this is allowed or not is subject to local regulations. Option D does not apply to DoH or DoT messages.\nV-SMF selects and inserts UL-CL/L-PSA for the DNS traffic at PDU Session establishment and for the EC application traffic either statically at PDU Session establishment, or dynamically, based on interaction with V-EASDF.\nFor scenario 2.2 in clause 5.1.2, dynamic EAS discovery and insertion of UL-CL and local PSA happens in the V-PLMN based on V-EASDF as defined in TS 23.548 [3]. HPLMN does not need to know the EC deployment in VPLMN, VPLMN has the knowledge of EAS Deployment information in VPLMN, and the selection is made by V-SMF considering this information.\nFor scenario 2.1 in clause 5.1.2, the VPLMN does not know the EC deployment in VPLMN (it is known by HPLMN), and V-SMF selects the L-PSA based on UE location only. V-SMF selects the UL-CL and L-PSA based on V-EASDF notification as defined in TS 23.548 [3], but without considering the EAS deployment information. V-SMF uses information provided by HPLMN to set the UL-CL filters and to provision V-EASDF.\nFor scenario 2.1, if Home MNO monitors, assists and validates the decisions related to applications for which it has triggered user access to EHE in VPLMN, H-SMF selects an H-EASDF that monitors the DNS resolution for those applications and that validates the selected L-PSA. The address of the H-EASDF for the PDU Session is sent to V-SMF as a next HPLMN DNS Resolver after V-EASDF, which triggers validation in the following way:\n-\tV-EASDF appends to the UE DNS queries for EC FQDNs (agreed in the SLA, or provided at session establishment) an ECS option based on current UE location and sends it to H-EASDF.\n-\tH-EASDF notifies H-SMF of the query, also sending the ECS option received, based on which H-SMF identifies the UE Geo Location Area and may select a local DNS server for the query and provide it to H-EASDF.\n-\tBased on the information received from the H-SMF, the H-EASDF forwards the query according to instruction, setting the next DNS server to the local DNS server if one received\n-\tThe DNS response is then received by H-EASDF, which notifies H-SMF. If an EAS has been selected, H-SMF may instruct H-EASDF to include ECS back in the response (the one provided by VPLMN in the DNS Query or one corresponding to the EAS IP selection) and to forward the DNS Response to V-EASDF.\n-\tIf the ECS is inserted in the response, this means that it has been used in EAS selection. V-SMF then selects and inserts UL-CL and local PSA based on notification received from V-EASDF considering the ECS received if any.\nThe solution is based on the Session breakout connectivity model in VPLMN.\nIn scenario 2.1, as part of SLA between the HPLMN and VPLMN, HPLMN may also provide QoS policies for specific Applications to VPLMN. V-SMF may be configured with limitations for roamers (and DNN/S-NSSAI) it enforces on HPLMN provided policies. Alternatively, QoS rules can be conveyed to V-SMF by H-SMF during PDU Session establishment or update as specific information or as an indication to V-SMF to store the information sent to the UE in the NAS message and the QoS profile sent to gNB.\nIn scenario 2.2, V-PCF may provide PCCs to V-SMF during PDU Session Establishment.\nTo support charging in both PLMNs, the V-SMF provides Usage Reporting Rules to the UL-CL/BP and local PSA to collect Usage Reports for charging in VPLMN that it conveys to H-SMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.25.2\tProcedures",
                            "text_content": "The solution is shown in figure 6.25.2.1-1 below.\nThe figure depicts the EAS discovery process in a VPLMN (Virtual Private LAN) scenario, where the EAS (Enhanced Airborne Surveillance) is used to detect and track threats. The figure shows the EAS discovery process, including the detection of a PDU (Session) session, the identification of the EAS, and the subsequent transmission of the EAS data to the relevant authorities. The figure is a crucial component in ensuring the security of the network and the protection of the users.\nFigure 6.25.2.1-1: EAS discovery in VPLMN via HR PDU Session\n0.\tAt UE registration procedure, the AMF receives a \"HR-LBO allowed\" indication from the UDM for a given S-NSSAI and DNN. This is used by the AMF to select a V-SMF with the required capability during the PDU Session establishment procedure.\n1.\tUE sends PDU Session establishment request to V-SMF selected by the AMF. AMF appends HR-LBO authorization indication to V-SMF.\n2.\tV-SMF takes into account the HR-LBO indication and may create an association with V-PCF for local traffic offload policies. For scenario 2.2, it may contact V-NEF to retrieve EAS Deployment Information. V-SMF selects UPF and V-EASDF in VPLMN (that could be based on the policies fetched from V-PCR) and sends Nsmf_PDUSession_Create Request to H-SMF, in which it indicates support for EC, and also provides the V-EASDF address to H-SMF and recommended indication for EDC usage for the PDU Session.\n3.\tH-SMF retrieves subscription information and policies for this UE and PDU Session, and selects and configures UPF in HPLMN as in steps 7-12 in clause 4.3.2.2.2 of TS 23.502 [9], but the subscription information and policies include the information related to the EC traffic that could be directed to EHE in VPLMN. For scenario 2.1, H-SMF may contact H-NEF to retrieve EAS Deployment Information.\n4.\t[Conditional] For scenario 2.1 in clause 5.1.2 if HPLMN monitoring, assisting and validation, the H-SMF selects an H-EASDF and configures the DNS handling rules in H-EASDF, via Neasdf_DNSContext_Create.\n5.\tThe H-SMF sends Nsmf_PDUSession_Create Response to the V-SMF. H-SMF provides V-SMF with the H-DNS server as resolver for non-EC FQDNs (in case of Option A from clause 6.25.1). For scenario 2.1, the H-SMF response may include QoS rules for this PDU Session. According to UE support, the H-SMF response may also include in e PCO the vECS (Edge Configuration Server) information and indication for EDC usage for the PDU Session for the UE. The DNS server information in the PCO includes one of:\na.\tV-EASDF IP address (in case of Option A from clause 6.25.1); or\nb.\ta H-DNS server (in case of Option B from clause 6.25.1).\nFor scenario 2.1, H-SMF may provide V-SMF with information of applications for which to trigger routing to EHE in VPLMN (IP ranges and DNS domain name ranges).\n[Conditional] For scenario 2.1 if HPLMN monitoring, assisting and validation, H-SMF also provides the address of the selected H-EASDF.\n6.\tThe V-SMF performs UL-CL/BP and local PSA selection and insertion. The V-SMF also provisions V-EASDF and UL-CL/BP to steer DNS traffic (only certain FQDNs if Option B) towards V-EASDF IP address and local PSA.\n7.\tV-SMF configures the DNS handling rules in V-EASDF, via Neasdf_DNSContext_Create.\n8.\tV-SMF sends PDU Session Establishment accept message including the PCO received from H-SMF to the UE.\n9.\tUE sends a DNS query which includes FQDN for an EHE deployed in the VPLMN. The query reaches V-EASDF via the local UL-CL and PSA (in case of both Options A and B from clause 6.25.1).\n10.\t[Conditional] For scenario 2.2 and 2.1 in clause 5.1.2 without HPLMN monitoring, assisting and validation, the EAS discovery and UL-CL/BP and local PSA selection is performed as described in steps 8–19 from clause 6.2.3.2.2 in TS 23.548 [3], though information available in each scenario varies. For scenario 2.1, V-SMF does not have EDI, and decision is mainly based on UE location.\nSteps 11-16. [Conditional] For scenario 2.1 in clause 5.1.2 with HPLMN monitoring, assisting and validation:\n11.\tThe DNS query triggers notification from V-EASDF to V-SMF, which provides message handling rules to V-EASDF as described in steps 8-11 from clause 6.2.3.2.2 of TS 23.548 [3]. The rules include an ECS to append to the DNS query corresponding to the candidate local PSA and H-EASDF as next DNS server to send the query to. V-SMF does not have EDI, and decision is mainly based on UE location.\n12.\tThe DNS query is forwarded from V-EASDF to H-EASDF using the ECS received from V-SMF in step 11.\n13.\tThe procedure in steps 8-15 from clause 6.2.3.2.2 of TS 23.548 [3] is repeated, where the DNS query triggers notification from H-EASDF to H-SMF, and H-EASDF sends the DNS query to H-SMF together with the ECS received. This triggers a validation process in H-SMF for UE Geo Location Area corresponding to the received ECS. The SMF may instruct H-EASDF to send the query to a Local DNS in the DNS handling rule. H-EASDF then handles the DNS resolution and notifies the response to the H-SMF that may also validate the response. Note that H-SMF does not deploy any UL-CL/BP and local PSA. H-SMF may instruct H-EASDF to include ECS back in the response (the one provided by VPLMN in the DNS Query or one corresponding to the EAS IP selection) and to forward the DNS Response to V-EASDF.\n14.\tThe DNS response is sent back the V-EASDF.\n15.\tV-EASDF notifies V-SMF that takes into account ECS and may modify the UP path to steer application traffic to another L-PSA as in steps 14-18 from clause 6.2.3.2.2 of TS 23.548 [3].\n16.\tIf indicated so, the DNS response is sent back to the UE.\nThe support for EAS rediscovery indication procedure enables the UE to refresh stale EAS information stored locally so that the UE can trigger EAS discovery procedure to discover new EAS information as described in clause 6.2.3.3 of TS 23.548 [3]. The corresponding EAS rediscovery procedure is shown in figure 6.25.2.2-1:\nThe figure depicts the EAS rediscovery procedure due to UE mobility, illustrating the steps taken to locate and rediscover the EAS (Enhanced Active Surveillance) system. The figure shows the EAS system's location and the steps taken to locate and rediscover it, including the use of a mobile UE (User Equipment) to help locate the system. The figure also shows the steps taken to rediscover the EAS system, including the use of a mobile UE to help locate the system.\nFigure 6.25.2.2-1: EAS rediscovery procedure due to UE mobility\n0.\tThe procedure in clause 6.25.2.1 is executed with the following differences required for EAS rediscovery:\nIn step 1, the UE may indicate its support for refreshing stale EAS information stored locally corresponding to the impact field per the EAS rediscovery indication from network.\nIf the UE indicates such support, then in step 5, H-SMF conveys this indication to V-SMF and V-SMF stores this indication.\n1.\tDue to the UE mobility or AF influence on traffic routing to VPLMN (which happens through V-NEF and V-PCF for scenario 2.2), the V-SMF triggers L-PSA insertion, change or removal for the PDU Session.\n2.\tV- SMF sends PDU Session Nsmf_PDUSession_Update Request to H-SMF, including:\n-\tan EAS rediscovery needed indication;\n-\tinformation about the impacted EAS(s);\n-\t[conditionally] if V-EASDF relocation is also needed, the new V-EASDF IP address.\n3.\tH- SMF sends PDU Session Modification Command (EAS rediscovery indication, [impact field]) to UE as described in step 2 of clause 6.2.3.3 of TS 23.548 [3]. The EAS rediscovery indication indicates to refresh the cached EAS information. The impact field is used to identify which EAS(s) information needs to be refreshed.\n4.\tH- SMF sends PDU Session Nsmf_PDUSession_Update Response to V-SMF.\n5.\tUE may trigger EAS discovery procedure to get new EAS information.\nNOTE:\tFor scenario 2.1, AF request to influence traffic routing towards the HPLMN (H-SMF) is not possible if the EDI does not include DNAIs. The Application mobility will in general not imply UL-CL/BP and L-PSA relocation for scenario 2.1, as the L-PSA is selected based on UE location.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.25.3\tImpacts on services, entities and interfaces",
                            "text_content": "UDM:\n-\tUE subscription information enhanced for authorizing the \"HR-LBO\".\nAMF\n-\thandles \"HR-LBO\" in UE Subscription and takes it into account for V-SMF selection.\nV-SMF:\n-\tindicating support for EC and providing V-EASDF IP address and recommended EDC usage indication to H-SMF;\n-\tsupporting V-EASDF selection and interaction with V-EASDF using Neasdf interface as in TS 23.548 [3];\n-\tsupporting interaction with NEF in VLPMN to retrieve EDI as in TS 23.548 [3] (only scenario 2.2);\n-\tsupporting UL-CL/BP and L-PSA selection and provisioning for session breakout in HR PDU Session based for example on local configuration, and user session information from policy association with VPCF, from HPLMN H-SMF, and/or from V-EASDF;\n-\tsending EAS rediscovery needed indication and impacted EAS(s) information;\n-\tsupporting V-EASDF interaction including instructions for tunnelling DNS messages towards a next H-EASDF (only scenario 2.1 with HPLMN monitoring, assisting and validation).\nH-SMF:\n-\tprovisions UE using (e)PCO via V-SMF with V-EASDF for the EC related DNS queries (using option A from clause 6.25.2.1), EDC usage indication (considering V-SMF recommendation) and vECS information for the VPLMN;\n-\tsends to V-SMF information related to local traffic routing such as the IP address ranges and DNS domain name ranges for EC applications for which to trigger steering to EHE in VPLMN. Information is based on HPLMN knowledge of EDI (only scenario 2.1). It also sends the H-DNS;\n-\tsends H-EASDF IP address to V-SMF (including any tunnelling information) and with H-EASDF it inspects/replaces/restores ECS information in received DNS messages from VPLMN to monitor, assist and validate selected L-PSA vs the selected EAS location (only for scenario 2.1 with HPLMN monitoring and validation).\nV-PCF:\n-\tprovides local policies to V-SMF for HR-PDU Sessions.\nEASDF:\n-\tsends DNS query/response over a tunnel (between V-EASDF and H-EASDF). EASDF instructions include tunnelling information (only for scenario 2.1 with HPLMN monitoring and validation).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.26\tSolution 26 (KI#1): SM Policy for HR Session Breakout in VPLMN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.26.1\tDescription",
                            "text_content": "This solution addresses the following aspects in KI#1 for the scenario where Home Routed PDU Session is used with a PSA in the HPLMN:\n-\thow to authorize the PDU Session to support local traffic routing to access an EHE in the VPLMN;\n-\thow to ensure proper policy control and QoS enforcement;\n-\tpotential impact on Policy and QoS control.\nThis solution proposes how to obtain and apply Session Management policy when a roaming UE establishes a Home Routed PDU Session supporting session breakout in VPLMN to access EHE in VPLMN, assuming that HPLMN and VPLMN have an agreement on supporting HR session breakout.\nIn this scenario, Session Management policy is created and applied for the HR Session supporting session breakout as follows:\n1)\tDuring the establishment of Home Routed PDU Session, if the roaming UE is allowed to access the local part of DN, V-SMF selects a V-PCF that is capable of providing SM policy for HR session breakout and requests, to the selected V-PCF, SM policy for HR session breakout via SM policy association procedure.\n2)\tThe V-PCF provides SM Policy to the V-SMF based on the VPLMN operator policy (option 1) or interaction with H-PCF (option 2).\n3)\tThe V-SMF executes the session breakout procedure and configures V-UPF acting as UL-CL/BP, V-PSA (connected to local part of DN), and V-UPF (connected with H-UPF for home routed session), respectively based on the SM Policy. For example, usage monitoring control and QoS information can be applied differently for the session toward the H-UPF and the local session to the local part of DN (i.e. HR breakout session). Thus, different usage monitoring control related information and QoS information such as Session-AMBR are provisioned to the V-UPF connected with the H-UPF and the V-PSA providing access to local part of DN, respectively.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.2\tProcedures",
                            "text_content": "The figure depicts a simplified representation of the HR Session Breakout process in a VPLMN (Virtual Private LAN). It illustrates the steps involved in associating a Session Management Policy (SMP) with a HR Session in a VPLMN. The figure shows the flow of data from the source to the destination, including the use of Session Management Policies (SMPs) to control the flow of data. The figure is a simplified representation, and the actual process may vary depending on the specific VPLMN configuration and the requirements of the HR Session Breakout process.\nFigure 6.26.2.1-1: Option 1: SM Policy Association Procedure for HR Session Breakout in VPLMN\n1.\tDuring the PDU Session establishment procedure, the AMF indicates to the SMF that the HR session breakout is allowed.\n2.\tIf the V-SMF is indicated by the AMF that the HR session breakout is allowed, the V-SMF sends Session Management Policy Association Establishment request to the V-PCF. The V-SMF provides the V-PCF with the indication to request HR session breakout related policy.\n3.\tThe V-PCF makes the authorization and the policy decision for HR session breakout, and sends SM Policy Establishment response to the V-SMF. The V-PCF provides policy information that may include QoS constraints (e.g. including HR breakout session AMBR constraint) or usage monitoring control related information (e.g. AMBR and volume threshold for the session toward the local part of the DN) for the HR breakout session.\n4.\tThe V-SMF sends PDU Session Create Request to H-SMF. The V-SMF provides the H-SMF with the VPLMN-provided policy information for the HR breakout session.\n5.\tThe H-SMF retrieves Session Management subscription data related to the HR breakout session (e.g. Subscribed HR breakout session AMBR from UDM) for the VPLMN. The Session Management subscription data related to the HR breakout session may be associated with PLMN ID (i.e. VPLMN ID).\n6.\tThe H-SMF performs SM Policy Association Establishment with the H-PCF. The H-SMF provides the H-PCF with the received VPLMN-provided policy information for the HR breakout session and Subscribed HR breakout session AMBR retrieved from UDM. The H-PCF executes the authorization and the policy decision for HR roaming session with taking VPLMN-provided policy information and Subscribed HR breakout session AMBR retrieved from UDM into account. The H-PCF provides the authorized SM policy information to the H-SMF as the response to the SM Policy Association Establishment request.\n7.\tThe H-SMF sends PDU Session Create Response to V-SMF. The H-SMF provides HPLMN-authorized policy information.\n8.\tThe V-SMF performs SM Policy Association Modification with V-PCF based on the policy information from the H-SMF. The V-SMF performs the insertion of V-UPF acting as UL-CL with configuring the authorized SM policy (e.g. HR breakout session AMBR) into it.\nThe figure depicts a simplified representation of the Human Resource Policy Association Procedure (HR-PAP) for Session Breakout in a Virtual Private LAN (VPLMN). It illustrates the steps involved in the HR-PAP process, including the establishment of a session, the selection of a session breakpoint, and the execution of the HR-PAP procedure. The figure is a simplified representation, with only the most critical steps highlighted.\nFigure 6.26.2.2-1: Option 2: SM Policy Association Procedure for HR Session Breakout in VPLMN\n0.\tDuring the Registration procedure, the AMF is indicated by the UDM that the HR session breakout is allowed. This indication can be per DNN/S-NSSAI. The AMF performs discovery and selection of the H-PCF that is capable of providing SM Policy for HR session breakout if the AMF receives the HR session breakout allowed indication from the UDM.\n1.\tDuring the PDU Session establishment procedure, the AMF sends Session Management Context Create Request including the selected H-PCF information and the indication to the SMF that the HR session breakout is allowed.\n2.\tIf the V-SMF is indicated by the AMF that the HR session breakout is allowed, the V-SMF sends Session Management Policy Association Establishment request to the V-PCF. The V-SMF provides the V-PCF with the indication to request HR session breakout related policy and the H-PCF information.\n3.\tThe V-PCF determines to interact with the H-PCF identified by the AMF-provided H-PCF information and sends SM Policy Establishment request. The V-PCF provides the H-PCF with the VPLMN-supported policy information that may include QoS constraints or usage monitoring control related information (e.g. AMBR and volume threshold for the session toward the local part of the DN) for the HR breakout session in VPLMN.\n4.\tThe H-PCF executes the authorization and the policy decision for HR roaming session with taking the received policy information into account. The H-PCF provides the authorized SM policy information to the V-PCF as the response to the SM Policy Association Establishment request.\n5.\tThe V-PCF forwards the received SM policy information to the V-SMF.\n6.\tThe V-SMF sends PDU Session Create Request to H-SMF after UPF selection and configuration in VPLMN based on the received SM policy information. The V-SMF provides the H-SMF with the applied SM policy information in VPLMN and information of the H-PCF that establishes SM Policy Association with the V-PCF.\n7.\tThe H-SMF retrieves Session Management subscription data related to the HR breakout session (e.g. Subscribed HR breakout session AMBR from UDM) for the VPLMN. The Session Management subscription data related to the HR breakout session may be associated with PLMN ID (i.e. VPLMN ID).\n8.\tThe H-SMF performs SM Policy Association Establishment with the H-PCF of which information is provided by the V-SMF. The H-PCF executes the authorization and the policy decision for HR roaming session with taking the VPLMN-provided policy information into account. The H-PCF provides the authorized SM policy information to the H-SMF as the response to the SM Policy Association Establishment request.\n9.\tThe H-SMF sends PDU Session Create Response to V-SMF. The V-SMF performs the insertion of V-UPF acting as UL-CL with configuring the authorized SM policy (e.g. HR breakout session AMBR) into it.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.26.3\tImpacts on existing entities and interfaces",
                            "text_content": "V-SMF:\n-\tsupports SM Policy Association with the V-PCF for the HR PDU Session;\n-\tsupports to provide VPLMN-provided policy information to the H-SMF;\n-\tsupports to insert the V-UPF acting as UL-CL for the HR PDU Session and provide enforcement rule information (e.g. HR breakout session AMBR).\nV-PCF:\n-\tsupports SM Policy Association with the V-SMF, authorization and policy decision for the HR Session breakout in VPLMN;\n-\tsupports SM Policy Association with the H-PCF (for option 2).\nH-SMF/H-PCF:\n-\tsupports SM Policy Association with taking VPLMN-provided SM Policy information into account;\n-\t(H-SMF) supports to retrieve the subscription information related to HR session breakout.\nAMF:\n-\tsupports to indicate V-SMF that HR session breakout is allowed;\n-\tsupports discovery and selection of SM PCF in HPLMN (for option 2).\nUDM:\n-\tsupports to store the subscription information for whether HR session breakout is allowed and indicate AMF that HR session breakout is allowed based on the stored information;\n-\tsupports to store the subscription information for QoS constraints on HR breakout session such as Subscribed HR breakout session AMBR.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.27\tSolution 27 (KI#1): EAS discovery with dynamic setup of a LBO PDU Session",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.27.1\tHigh level description",
                            "text_content": "The solution addresses a scenario where the UE accesses EHE in VPLMN via a LBO PDU Session.\nUE initially connects to the HPLMN. The transition from a HR PDU Session to a LBO PDU Session takes place based on a trigger to the H-SMF, which may be e.g. a DNS query from the UE towards an EC FQDN or an AF influence of traffic routing for the UE. The latter may be issued by an AF of the VPLMN too. H-SMF determines that a LBO PDU Session to the VPLMN is needed, based on:\n-\tInformation provided by VPLMN at PDU Session Establishment, like indication of support for Dynamic set up of LBO for the PDU Session and information related to supported edge computing applications, i.e. Application IDs, or FQDN ranges;\n-\tthe FQDN in the UE DNS query and EDI available in HPLMN for the given FQDN, where the DNAI is relevant for a certain PLMN in the EDI, i.e. there is an associated information in the EDI stating which PLMN is relevant for the DNAI;\n-\tthe DNAI in the N6 routing information in the AF influence of traffic routing, where the DNAI has associated PLMN information;\n-\tpolicy information available in the H-SMF (that could be provided by H-PCF) regarding the requested FQDN or DNAI.\nThen, H-SMF sends a LBO session authorization indication to the AMF via V-SMF – optionally including a DNAI e.g. if previously received from the AF in the N6 routing information – and then it requests the PDU Session release with indication that PDU Session re-establishment to the same DN is required.\nNOTE 1:\tThe LBO session authorization indication overrides the subscription data.\nNOTE 2:\tThe HPLMN ensures that there are no URSP rules in the UE conflicting with the LBO authorization for this PDU Session, e.g. no other traffic that requires HR PDU Session should be mapped to the same DNN and S-NSSAI that could be authorized for LBO. If the information related to supported Edge Computing applications sent by the VPLMN is in collision with the current URSP rules in HPLMN for some application, then the HPLMN can just omit this information and not authorize the PDU Session for LBO for the given application.\nNOTE 3:\tTerminating the HR PDU Session before establishing the LBO PDU Session as in SSC#2 impacts the ongoing traffic on that PDU Session, e.g. TCP connections break and QUIC connections are interrupted until the connectivity is re-established on the new LBO PDU Session.\nThe AMF decides to set up a LBO PDU Session for the next UE PDU Session establishment request from the UE for the same DNN and S-NSSAI, based on the authorization indication received from the H-SMF. Then it selects V-SMF based on internal configuration or target DNAI received and it also conveys a target DNAI to V-SMF corresponding to the DNAI received from H-SMF. The V-SMF selects a PSA based on the DNAI information received from AMF (if available) or based on policy information and may also configure a V-EASDF if dynamic EAS discovery is to be used.\nNOTE 4:\tAn LBO PDU Session can be established for this DNN, and it is assumed that configuration in VPLMN for this DNN has been set accordingly.\nThe solution requires a H-EASDF is selected for this HR PDU Session in HPLMN for the case of LBO PDU Session dynamically triggered by DNS EAS discovery and EAS discovery can be applied for all connectivity models in V-PLMN, in the following way:\n-\tin case of Distributed anchor and Multiple PDU Sessions connectivity models, the V-SMF selects a local anchor to the UE's current location based on policies for this DNN. EAS (re-)discovery happens as described in clause 6.2.2 of TS 23.548 [3];\n-\tin case of Session Breakout, the V-SMF selects an UL-CL/BP and local anchor based on:\n-\tthe DNAI received from the AF in the AF influence of traffic routing if a DNAI for an N6 routing is specified; or\n-\tthe FQDN of a subsequent UE DNS query, as described in clause 6.2.3.2.2 in TS 23.548 [3].\nV-SMF may initiate termination of the LBO PDU Session if traffic ceases towards the EHE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.27.2\tProcedures",
                            "text_content": "The solution is shown in figure 6.27.2-1 below.\nThe figure depicts a VPLMN (Virtual Private LAN) setup with dynamic discovery of EAS (Enhanced Airborne Surveillance) using a LBO (Local Business) PDU Session. The figure illustrates the process of configuring the LBO PDU Session to discover EAS signals and the associated EAS parameters. The figure also shows the connection between the LBO PDU Session and the EAS system, highlighting the importance of proper setup and configuration for effective EAS detection and management.\nFigure 6.27.2-1: EAS discovery in VPLMN with dynamic setup of a LBO PDU Session\n1.\tHR PDU Session Establishment to H-SMF and UPF1, according to the procedure described in clause 4.3.2.2.2 of TS 23.502 [9] with the difference that AMF or V-SMF, based on configuration, sends indication to support Dynamic set up of LBO for this PDU Session. Optionally, based on configuration, V-SMF also sends information related to supported edge computing applications, i.e. Application IDs, or FQDN ranges. In case of dynamic setup of a LBO PDU Session by DNS, allocation of an H-EASDF and sending rules to the EASDF also happens according to steps 1-6 in the clause 6.2.3.2.2 for EAS Discovery Procedure with EASDF for Session Breakout connectivity model in TS 23.548 [3].\n2a.\t[Conditional] The UE sends a DNS Query message for an FQDN to the EASDF via Central PSA. Steps 7-11 in the procedure in clause 6.2.3.2.2 in TS 23.548 [3] for EAS Discovery Procedure with EASDF for Session breakout Connectivity are applied. That is, the H-EASDF checks the DNS Query against the DNS Handling Rules in the DNS Context and reports to H-SMF.\n2b.\t[Conditional] The AF sends a request on traffic routing for the UE as specified in clauses 4.3.6.2 or 4.3.6.4 of TS 23.502 [9], impacting the existing PDU Session. Therefore, H-PCF updates the H-SMF with corresponding new policy information about the PDU Session by invoking Npcf_SMPolicyControl_UpdateNotify service operation as described in steps 5 and 6 in clause 4.16.5 of TS 23.502 [9].\n3.\tBased on either 2a or 2b, H-SMF determines that an LBO PDU Session to the VPLMN is needed, as described in clause 6.27.1 above. If 2a, H-SMF removes the Session Context in H-EASDF and the DNS Query is discarded.\n4.\tH-SMF invokes Nsmf_PDUSession_StatusNotify service operation to the V-SMF, sending an indication that LBO is authorized for the next PDU Session establishment for this UE, DNN and S-NSSAI, and optionally also sending a target DNAI to the AMF for the local PSA to be selected for the next PDU Session request from the UE for the same DNN and S-NSSAI. H-SMF sends an \"AMF acknowledgment requested\" indication within this message and a validity indication that shows for how long the AMF should keep the information received and apply it for the next PDU Session.\n5.\tV-SMF invokes Nsmf_PDUSession_SMContextStatusNotify service operation to the AMF including the received indication that LBO is authorized and target DNAI. V-SMF acknowledges the notification from step 4 after receiving the AMF acknowledgment to this notification.\n6.\tH-SMF triggers a PDU Session change from HR (UPF1) to LBO (UPF2), using one of the procedures below:\n-\tSSC#2: H-SMF triggers a HR PDU Session release, as described in clause 4.3.4.3 of TS 23.502 [9]. Indication that PDU Session re-establishment to the same DN is required is included.\nAt the next UE request for PDU Session establishment for the same DNN and S-NSSAI, based on the LBO authorization indication and target DNAI received in step 5, AMF decides on a LBO PDU Session establishment towards a proper V-SMF and UPF 2, as specified in clause 4.3.2.2 of TS 23.502 [9]. EAS discovery then happens as described in clause 6.27.1 above.\n-\tSSC#3: H-SMF triggers a HR PDU Session modification, as described in clause 4.3.3.3 of TS 23.502 [9]. where PDU Session ID indicates the existing PDU Session to be relocated and Cause indicates that a PDU Session re-establishment to the same DN is required. A PDU Session Address Lifetime value may also be provided.\nThe UE may decide to initiate the PDU Session Establishment request to the same DNN and S-NSSAI described in clause 4.3.2.2 of TS 23.502 [9], with the differences described in clause 4.3.5.2 of TS 23.502 [9]. Based on the LBO authorization indication and target DNAI received in step 5, AMF decides on a LBO PDU Session establishment towards a proper V-SMF and UPF 2, as specified in clause 4.3.2.2 of TS 23.502 [9].\nThe old PDU Session may be released as described in clause 4.3.4.3 either by the UE before the timer provided in step 3 expires (e.g. once the UE has consolidated all traffic on new PDU Session or if the session is no more needed) or by the H-SMF upon expiry of this timer.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.27.3\tImpacts on services, entities and interfaces",
                            "text_content": "H-SMF:\n-\tdetermines that a LBO PDU Session to the VPLMN is needed for a given UE and PDU Session;\n-\tsends an indication to AMF that LBO is authorized for the next PDU Session establishment and a validity indication.\nAMF:\n-\tlogic to switch to LBO PDU Session for a PDU Session establishment request based on the LBO authorization and validity indications previously received from the H-SMF via V-SMF.\nAMF or V-SMF:\n-\tindication to support dynamic set up of LBO for this PDU Session.\nV-SMF:\n-\tsends information related to supported edge computing applications, i.e. Application IDs, or FQDN ranges.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.28\tSolution 28 (KI#1): Support edge computing in Roaming",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.28.1\tDescription",
                            "text_content": "When the UE powers on in visited PLMN and does not have initial registration, the following procedures are performed:\n-\tWhen the UE registers in the visited PLMN, the updated URSP rules is provided by H-PCF via V-PCF. In the updated URSP rules, the EAS IP address which located in the visited PLMN is included, and the URSP rules can trigger to establish an LBO session or apply the application traffic which connects to EAS in visited PLMN by LBO PDU Session.\n-\tIf the URSP rules in visited PLMN are not updated timely, or the URSP rules related to EAS in visited PLMN do not exist, the UE should establish the PDU Session either LBO PDU Session or HR PDU Session. The UE should be configured with the DNS server in visited PLMN scenarios and triggers the DNS query of FQDN.\nIn the LBO PDU Session, the V-SMF delivers the DNS server IP address to UE via NAS messages. For the HR session, the H-SMF is responsible for configuring the DNS server IP address to UE via NAS messages.\nIn the LBO PDU Session, the UE can connect to EAS in visited PLMN via visited local PSA. But for the HR session, after DNS server responds with the DNS response, the home PLMN should trigger a UL-CL insertion for the local breakout session to offload the UE traffic to visited EAS.\nTo support EDGEAPP in SA6, the UE in visited PLMN should receive the ECS configuration information Configuration Information.\nWhen UE in LBO session, the V-SMF retrieves the UE subscription data in UDM and delivers the ECS configuration information to UE in ePCO.\nWhen UE in HR session, the H-SMF checks the UE subscription in UDM and retrieves the ECS configuration information. After that, the H-SMF delivers the ECS configuration information to V-SMF, and the V-SMF delivers the ECS configuration information to UE in ePCO.\nAll of the ECS configuration information above should be retrieved per VPLMN ID.\nAlso, in order to support to establish the LBO PDU Session to ECS, the 5GC can also support to distribute the updated URSP rules to UE. When UE has the traffic towards ECS in visited PLMN, the URSP rules with ECS configuration information can trigger an LBO PDU Session establishment or apply the traffic to LBO PDU Session.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.28.2\tProcedures",
                            "text_content": "The figure depicts a network setup with multiple layers, including a base station (BS), user equipment (UE), and a virtual private LAN (VPLMN) and Universal Resource Pool (URSP). The figure illustrates the process of registering UE in the VPLMN and updating the URSP rules in real-time. This setup is designed to ensure timely updates and efficient communication in a 5G network.\nFigure 6.28.2.1-1: UE registers in VPLMN and URSP rules updated timely\n1.\tUE powers on in roaming PLMN initially.\n2.\tThe UE registers into the visiting PLMN, and the URSP rules are delivered from 5GC to UE timely. Some of the URSP rules which related to the EAS located in VPLMN and ECS are provided by 5GC.\n3.\tThe application on UE has the traffic to be sent to EAS 1, and the UE uses the URSP rules to trigger a new LBO PDU Session establishment.\n4.\tUE triggers to establish an LBO PDU Session with the parameters that provided by the RSD in URSP rules which the URSP rules is related to EAS l located in VPLMN.\n5.\tDuring the LBO PDU Session establishment procedure, the V-SMF is responsible for selecting local DNS server (e.g. V-EASDF) for UE in VPLMN. Also, the V-SMF should retrieve the UE subscription data from UDM to obtain the ECS configuration information. Each ECS configuration information is associated with the visiting PLMN ID. The related UPF should be configured with the routing rules to route the UE DNS query to local DNS server. Also, the V-SMF should authorize in UDM that whether the UE can consume the EASDF to discovery the EAS in VPLMN.\n6.\tThe V-SMF delivers the local DNS server IP address and ECS configuration information to UE in ePCO via DL NAS messages.\n7.\tThe IP connection between UE and EAS 1 is established.\n8.\tFor EAS 2 deployed in VPLMN, if there is no such URSP rules related to EAS 2 in UE, the UE can only receive the FQDN related to EAS 2 to trigger DNS query towards the local DNS server received from V-SMF via ePCO in step 7.\n9.\tThe DNS query is routed to local DNS server via local PSA in VPLMN. If the V-EASDF is selected for the UE in VPLMN, the V-EASDF should use the Rel-17 mechanism to apply the DNS message handling rules to DNS query.\n10.\tThe UE receives the DNS response from local DNS server.\n11.\tThe IP connection between UE and EAS 2 is established.\nIf the UE registers to 5GS and the URSP rules which related to the EAS deployed in VPLMN not timely, and the UE has the DNN, S-NSSAI in VPLMN, the UE can only establish an LBO PDU Session with the DNN, S-NSSAI in VPLMN.\nDuring the LBO PDU Session establishment, the V-SMF delivers the local DNS server IP address and ECS configuration information to UE in ePCO via DL NAS messages. UE triggers the DNS query to local DNS server with the FQDN, and the local DNS server responds with the EAS IP address.\nThe overall procedures are similar to the procedure in clause 6.28.2.1 from step 4 to 11 without step 7.\nIf the UE registers to 5GS and the URSP rules which related to the EAS are deployed in VPLMN not timely, and the UE does not have the DNN, S-NSSAI in VPLMN, the UE can only establish an HR PDU Session with the DNN, S-NSSAI in HPLMN. During the HR session, the edge computing features can be guaranteed.\nIn this procedure, it is supposed that the HPLMN can obtain the EDI from VPLMN.\nThe figure depicts a session between an HR (Human Resources) application and an Edge computing application, illustrating the communication between the two systems. The session is designed to support Edge computing, enabling the HR application to process data in the cloud while the Edge computing application processes the data locally. This collaboration between the HR application and Edge computing application is crucial for the efficient processing of large amounts of data in real-time, improving the overall performance of the system.\nFigure 6.28.2.3-1: HR session to support Edge computing\nThe overall procedure in figure 6.28.2.3-1 are similar as the procedure in figure 4.3.2.2.2-1 of TS 23.502 [9], but with the following changes and differences:\n12.\tThe H-SMF retrieves the subscription data in UDM. The subscription data includes two parts. The first one is, whether the UE is authorized for the edge computing service in VPLMN. Some of the traffic should be offloaded in VPLMN, not re-routed to the HPLMN. The second one is, the H-SMF retrieves the ECS configuration information from UDM, per VPLMN.\n14.\tH-SMF selects the H-EASDF for the UE.\n15-18.\tDue to the H-SMF should configure the baseline DNS pattern in the H-EASDF or the DNS handling rules, the EDI is required. But the EDI related to VPLMN is stored in V-UDR and the H-SMF should retrieve the EDI in VPLMN.\nThe H-SMF triggers the V-NEF discovery to H-NRF using the Nnrf_NFDiscovery_Request, and the H-NRF invokes the Nnrf_NFDiscovery_Request service to vNRF. The association between H-NRF and V-NRF are referred to the procedure in figure 4.3.2.2.3.3-1 of TS 23.502 [9]. The V-NRF responds with the IP address of V-NEF to H-NRF, to H-SMF.\n19-23.\tAfter the V-NEF is discovered, the H-SMF subscribes or gets the EDI from V-UDR via V-NEF. These procedures are similar to the procedure in TS 23.548 [3].\n24-25.\tAfter the retrieving the EDI from VPLMN, the H-SMF configures the baseline DNS pattern towards H-EASDF.\n29.\tThe H-SMF configures the routing rules in H-UPF to route the UE DNS query towards H-EASDF.\n31.\tThe H-SMF responds to V-SMF with Nsmf_PDUSession_Create response. In the response, the ECS configuration information and H-EASDF IP address are included.\nFor the situation when the UE moves into the VPLMN and the original EC session will be influenced. The UE should re-discover another EAS from the DNS procedure.\nIn order to not stop the traffic and business, the UE should discover a new EAS and performs the EAS relocation procedure.\nThe details of the procedure are listed below:\nThe figure depicts the relocation of EAS (Emergency Alert System) from the Emergency Public Land Mobile Network (EPLMN) to the Virtual Public Land Mobile Network (VPLMN) in the European Radio Network (HPLMN). The figure illustrates the steps involved in the relocation process, including the use of EAS repeaters and the establishment of a new EPLMN. The relocation aims to improve the reliability and coverage of EAS signals in the VPLMN, ensuring that emergency alerts can be delivered to the public.\nFigure 6.28.2.4-1: EAS relocation from EAS in HPLMN to VPLMN\n1.\tThe UE is the status of roaming in VPLMN, and the original PDU Session to EAS in HPLMN are influenced, for example, the EAS in HPLMN becomes suboptimum for UE to connect.\n2.\tThe HR session is established to continue the old PDU Session to EAS in HPLMN.\n3a.\tThe 5GC triggers an indication to UE to refresh the DNS cache that the old cache still reflects the mapping table between FQDN and EAS IP address located in HPLMN.\n3b.\tIf the HR session changes the IP address of PDU Session, for example, due to the relocation of PSA in HPLMN and the IP address of PDU Session is changed, the UE refreshes the DNS cache stored in HPLMN.\n4.\tThe DNS cache is cleared or refreshed.\n5.\tThe UE triggers a new DNS query with the FQDN towards the local DNS server or H-EASDF.\n6.\tThe old EAS deployed in HPLMN relocates to the new EAS located in VPLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.28.3\tImpacts on services, entities and interfaces",
                            "text_content": "H-SMF:\n-\tretrieves the EDI from V-UDR via V-NEF;\n-\tretrieves the indication of whether the EC feature is supported in VPLMN and ECS address from UDM.\nV-UDR:\n-\tsupports to provide the EDI in VPLMN to HPLMN.\nV-SMF:\n-\tsupports to retrieve the ECS address from UDM;\n-\tdelivers the DNS server IP address to UE via NAS messages.\nUDM:\n-\tstores the ECS configuration information by PLMN basis.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.29\tSolution 29 (KI#3): Use of Internal Group ID and constraints in EDI",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.29.1\tHigh level description",
                            "text_content": "To identify a finer granularity of UEs, Internal Group ID is to be used. There is no practical limit for how many Internal group IDs that can be assigned in a 5GS. The structure of an Internal Group ID is as follows:\nThe figure depicts the internal group ID structure of a network, showing the hierarchical organization of network elements. The structure is organized into groups, each with a unique identifier, which allows for efficient network management and efficient routing of data.\nFigure 6.29.1-1: Internal Group ID structure\nA UE can be associated with a number of Internal Group IDs as per TS 23.501 [2]. Stage 3 has not specified any limit for how many internal groups a UE can be associated with.\nTo support different constraints related to EC, the solution uses EDI, which is enhanced with a constraints field that tells under which constraints the EDI record applies. The EDI can be provisioned by an operator though OAM to UDR (or via NEF) or the EDI can be provided by an AF.\nExample of the updated EDI from table 6.2.3.4-1 in TS 23.548 [3]:\nTable 6.29.1-1: EDI parameters\n\nNOTE:\tExternal/Internal Group IDs in this solution are all provisioned via OAM procedures to UDM.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.29.1-1: EDI parameters",
                                    "table number": 11,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.29.2\tImpacts on services, entities and interfaces",
                            "text_content": "SMF:\n-\tneeds to take the constraints into account when constructing DNS handling rules to EASDF, and action taken when EASDF notifies SMF due to a DNS handling rule.\nUDR:\n-\tnew data in EDI.\nNEF:\n-\tNnef_EASDeployment service: new data in EDI.\nAF:\n-\tnew data in EDI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.30\tSolution 30 (KI#3): Policies referring to \"Allowed services\" and/or \"Subscriber categories\"",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.30.1\tDescription",
                            "text_content": "The solution aims at supporting AF request for specific traffic routing (as defined for Nnef_TrafficInfluence_Create / Update in clause 5.6.7 of TS 23.501 [2]) targeting a category of users or users having subscribed to specific services (basically for users having subscribed to specific tariff plans).\nNOTE 1:\tVery local traffic offload can be expensive (the more locally CPU is deployed, e.g. to support EAS, the more expensive this CPU is) and it may be useful to apply very local offload only for users with specific tariff plans (e.g. users having subscribed to a \"game boost\" offer). The goal is also to avoid the burden to define dedicated DNN and/or slices for these cases.\nAF guidance is needed as it is the AF that knows the relative cost of deploying very local EAS capabilities.\nThe solution adds a new kind of targets (beyond a UE, a group of UE, Any UE) for AF requests for traffic routing Nnef_TrafficInfluence_Create/Update where this new kind of targets may correspond to one of \"Allowed services\" and/or \"Subscriber categories\" as defined in TS 23.503 [13] table 6.2-2: PDU Session policy control subscription information.\nThe AF requests is provided to the PCF as defined in clause 4.3.6.2 of TS 23.502 [9]. When the SMF invokes an SM Policy Association Establishment as defined in clause 4.16.4 of TS 23.502 [9], the PCF looks up the UDR to check whether the corresponding user subscription maps to one of \"Allowed services\" and/or \"Subscriber categories\" of the AF policies received by the PCF (from the UDR as defined in clause 4.3.6.2 of TS 23.502 [9]).\nAllowed services and Subscriber categories as defined in table 6.2-2 of TS 23.503 [13] cannot be sent on roaming interfaces as they refer to subscription plans of a given operator; this is not an issue as Nnef_TrafficInfluence_Create/Update and NWDAF services are not defined on roaming interfaces.\nAn external AF (an AF from a third party with no specific agreement with the 5GC operator) cannot use \"Allowed services\" and/or \"Subscriber categories\" targets whose set of values are not defined by 3GPP and left for deployment definition (values defined by the 5GC operator). The NEF may have local policies allowing it to map the information included in an AF request from an external AF to identify the more granular sets of UE(s) into operator defined \"Allowed services\" and/or \"Subscriber categories\" values. The information included in an AF request to identify the more granular sets of UE(s) can include AF identifier and/or MTC Provider Information (identifying the MTC/non-MTC Service Provider and/or MTC/non-MTC Application).\nNOTE 2:\tNOTE 5 in clause 4.15.6.10 of TS 23.502 [9] states \"The MTC Provider Information can be used by any type of Service Providers (MTC or non-MTC) or Corporate or External Parties for, e.g. to distinguish their different customers\". So, the MTC Provider Information can also be used to carry information for non-MTC service.\nNOTE 3:\tDifferent values of the allowed services parameter (in PCF subscription data stored in UDR) can based on local operator configuration to distinguish between subscription allowing to benefit from edge computing or even from deep edge computing (using more expensive compute resources at the RAN site) from subscription not allowing not to benefit from edge computing for some services. For example, the operator may associate some \"game boost\" tariff plan with values of the allowed services parameter in PCF subscription data (stored in UDR) allowing the users to have a better gaming experience as the gaming application they would use would be very local.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.30.2\tProcedures",
                            "text_content": "Clause 4.3.6.2 of TS 23.502 [9] \"Processing AF requests to influence traffic routing for Sessions not identified by an UE address\" is modified as described below:\nThe figure depicts a flowchart illustrating the process of processing AF requests to influence traffic routing for Sessions not identified by an UE address. The flowchart includes steps such as identifying the Session, determining the UE address, and determining the traffic routing. The figure is used to demonstrate the flow of information and the steps involved in processing AF requests to influence traffic routing.\nFigure 6.30.2-1: Processing AF requests to influence traffic routing for Sessions not identified by an UE address\n-\tIn step 1, the target of the AF request may refer a set of UEs as described in clause 6.30.1.\n-\tIn step 3 and 4, the data stored in UDR and the information sent to the PCF may refer to one of \"Allowed services\" and/or \"Subscriber categories\" as defined in TS 23.503 [13] table 6.2-2.\nClause 4.3.6.2 of TS 23.502 [9] \"SM Policy Association Establishment\" is modified as follows:\nThe figure depicts the process of establishing a policy association in a network, illustrating the steps involved in establishing a policy association. The figure shows the network topology, the network devices, and the network policies. The figure is used to demonstrate the process of establishing a policy association in a network, which is an important step in network management and security.\nFigure 6.30.2-2: SM Policy Association Establishment\n-\tIn step 2, the PCF looks up the UDR PDU Session policy control subscription information as defined in table 6.2-2 of TS 23.503 [13] to check whether the corresponding user subscription maps to one of \"Allowed services\" and/or \"Subscriber categories\" of the AF policies received by the PCF as defined in clause 4.3.6.2 of TS 23.502 [9]. If there is a match, the PCF uses this information of the AF policies for its policy rules determination.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.30.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "AF and NEF:\n-\tsupport the new target (\"Allowed services\" and/or \"Subscriber categories\") in Nnef_TrafficInfluence_Create / Update in clause 5.6.7 of TS 23.501 [2].\nUDR:\n-\tstorage of the new target type of \"Allowed services\" and/or \"Subscriber categories\" in data set \"Application data\" and Data Subset \"AF traffic influence request information\".\nPCF:\n-\tlooks up the UDR PDU Session policy control subscription information defined in table 6.2-2 of TS 23.503 [13] to check whether the user subscription corresponding to a SM Policy Association maps to one of \"Allowed services\" and/or \"Subscriber categories\" received from the \"AF traffic influence request information\" policies in UDR.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.31\tSolution 31 (KI#3): Providing traffic offload policy for a set of UEs with service information",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.31.1\tDescription",
                            "text_content": "To provide the traffic routing policy for a set of UEs at a finer granularity, the set of UEs at a finer granularity can be identified using a pre-defined group of UEs or a dynamic group of UEs. The set of UEs can be decided by the network administrator or by the application. For example, the set of UEs can be a pre-defined group which is configured by the operator. The set of UEs can be decided by the application side. For example, only certain users under certain conditions can access the application with edge computing service due to limited or expensive EC resource, considering the service agreement among the EC provider(s), application provider, network provider and the users. The set of UEs can be decided dynamically when the related conditions are met, e.g. the application client with specific service level can use edge computing service under certain conditions.\nFor providing the traffic routing policy for a set of UEs within a pre-defined group, or a dynamic group reusing 5G VN group management mechanism as defined in clause 6.14, it can be implemented using Application Function influence on traffic routing procedure targeting a group of UEs.\nFor providing the traffic routing policy for a set of UEs with associated with the same service information, e.g. the same application client category, it can be implemented reusing the existing Application Function influence on traffic routing mechanism with additionally including the following:\n-\tThe traffic routing policy information is provisioned associated a set of UEs with the same service information.\n-\tThe UE accessing the application with the matched Service information can apply the traffic routing policy information provisioned associated a set of UEs with the service information.\nNOTE:\tThe service information, for example, can be Target Category information that is an abstract value associated with 1) Allowed services for accessing applications with additional conditions e.g. allowed applications to be accessed, allowed application to be accessed using edge computing; or 2) Subscriber categories of the UE defined by the operator or of application users defined by the application provider, or 3) other service information acting as condition to group the set of UEs, e.g. the application decided service information such as application level client category for the application clients.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.31.2\tProcedures",
                            "text_content": "The following figure shows the solution providing the traffic routing policy for a set of UE with associated with the same service information.\nThe figure depicts a simplified representation of a Tr Affic routing policy provisioning for a set of UE with associated service information. It illustrates the process of configuring Tr Affic routing policies for each UE, which is crucial for efficient network management and service delivery. The figure includes various elements such as the Tr Affic routing policy, the service information, and the associated UE, all of which are essential for understanding the Tr Affic routing policy provisioning process.\nFigure 6.31.2-1 Traffic routing policy provisioning for a set of UE with associated with service information\n0.\tThe UE initiates the PDU Session establishment procedure.\n1.\tAF request with traffic routing information is sent to the PCF targeting UE(s) with service information. For the Target UE Identifier(s), the service information, acting as the criteria to identify the UE(s) that the request is targeting, so the traffic routing information can only be applied to the PDUs which are allowed to access the application with service information. The related information is sent via NEF and stored in the UDR, and delivered to the PCF following the existing Application Function influence on traffic routing procedure. Data Key = AF Transaction Internal ID, S-NSSAI and DNN and the service information for the application. For management of the targeting UE(s) with specific service information for the application(s), the specific internal group ID may be allocated by the UDM corresponding to the targeting UEs with specific service information as which is done for the 5G VN group management.\n2.\tThe SMF retrieves the SM policy using SM Policy Association Establishment procedure during the PDU Session establishment procedure. The traffic routing information for the specific application in step 1 is not sent to the SMF for the PDU Session because no service information matched.\n3.\tApplication Client with service information requests the IP address of app server and logs in, the user-plane communication takes place between the Application Client in UE and Application Server via the C-UPF. In this step, the application layer can decide that the service information the application client associated with based on the configuration or application subscription information.\n4.\tOptionally, the AF gets the service information for the accessing application client reusing the procedure of Service specific parameter provisioning defined in clause 4.15.6.7 of TS 23.502 [9] one of the following procedures with service information. If the internal group ID is associated with UE for the accessing application client, the internal group ID is stored as information of the subscription data of the UE.\nNOTE:\tThe service information in this solution is notified to the SM-PCF to influence the PCC Rules instead of AM-PCF delivered to the UE as defined in clause 4.15.6.7 of TS 23.502 [9].\n5-6.\tThe PCF makes the decision to modify the SM policy for the application within the PDU Session based on the traffic routing information targeting the set of UEs received in step 1, and the related information for the PDU Session including \"Allowed services\" and/or \"Subscriber categories\" as defined in \"PDU Session policy control subscription information\" in TS 23.503 [13] table 6.2-2 and/or the service information for the PDU Session received in step 4, and the routing policy related to the traffic routing information is sent to the SMF.\n7.\tThe UE enters the service area of the edge DN.\n8-10.\tThe SMF decides to establish a new PDU Session Anchor e.g. due to UE mobility as described in step 7, and based on the latest traffic routing policy received in step 6.\n11.\tUser-plane communication takes place between the Application Client in UE and Edge Application Server via the local UPF.\n12-13.\tThe AF decides to delete the service specific parameter, e.g. when the AC with service information logs out of the application or the IP flows of the application are terminated. The delete procedure is similar to the create procedure described in step 4, the only difference is that it is to delete the related information.\n14-15.\tThe PCF makes the decision to modify the SM policy for the application within the PDU Session, and the related traffic routing policy is deleted in the SMF.\n16-18.\tIf another Application Client without service information requests the IP address of app server and logs in in the PDU Session of the UE, the User-plane communication takes place between the Application Client in UE and Application Server via the C-UPF. As there is no related traffic routing information matched for this application client, no traffic routing policy is applied to the application for this UE in this case.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.31.3\tImpacts on services, entities and interfaces",
                            "text_content": "The following impacts are involved to support providing the traffic routing policy for a set of UE associated with the same service information:\nAF/NEF/UDR:\n-\tservice information is supported while providing traffic routing policy information in the procedure of AF influence traffic routing, wherein the service information can be the Target Category information associated with \"Allowed services\" and/or \"Subscriber categories\" and/or the application decided service information such as application level client category;\n-\tservice information of the UE accessing the application is optionally provided using the procedure of Service specific parameter provisioning.\nPCF:\n-\tthe traffic routing policy for a set of UE associated with service information is received;\n-\tservice information of the UE accessing the application is notified;\n-\tassociates the UE accessing the application with the set of UEs using Service information, and sends the PCC rule to the SMF for the PDU Session of the UE with the traffic routing policy information provisioned associated a set of UEs with the service information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.32\tSolution 32 (KI#3): Offload policy for finer granular set of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.32.1\tDescription",
                            "text_content": "This solution corresponds to KI#3, which addresses offload policy for finer granular set of UEs related to:\n-\thow to identify set of UEs at a finer granularity that are associated with a dedicated offload policy, and how to express the set of UE in the offload policy;\n-\timpacts to 5GS needed to support providing traffic offload policy for such a set of UEs.\nBased on the existing traffic influence procedure, this solution introduces \"subscribed services\", which is used for expressing a set of UEs at a finer granularity, and the Spatial Validity Condition and Temporal Validity Condition in AF request is reused for expressing location and time period for definition of set of UEs.\nThe \"subscribed services\" includes logical combination of criteria, for instance:\n-\tAllowed Service#1 AND Allowed Service#2;\n-\tGroup#1 AND Group#2;\n-\tAllowed Service#1 AND Group#1;\n-\tGroup#1 AND (NOT Group#2);\n-\tSubscriber category#1 AND Group#1;\n-\tPLMN ID (the offload policy is to UEs subscribed to PLMN identified by PLMN ID);\n-\tetc.\nThe criterion (e.g. Allowed Service, Subscriber category, Group ID etc) is maintained in UE subscription, and when the \"subscribed services\" is included in traffic influence, then the traffic influence applies to UE(s) whose subscription information matching with the \"subscribed services\" logically, for example, the \"subscribed services\" is \"Allowed Service#1 AND Group ID#1\" then traffic influence is for UEs whose subscription including both Allowed Service#1 and Group ID#1; the \"subscribed services\" is \"Allowed Service#1 AND (NOT Group ID#1)\", then traffic influence is for UEs whose subscription including Allowed Service#1 but not Group ID#1.\nNOTE 1:\tIf one criterion belongs to MNO's internal information, then it could only be used by an AF belonging to the MNO.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.32.2\tProcedures",
                            "text_content": "The following is the procedure for providing traffic offload policy to UEs matching with \"subscribed service\".\nThe procedure of \"Processing AF requests to influence traffic routing for Sessions not identified by an UE address\" as defined in clause 4.3.6.2 of TS 23.502 [9] is reused with the following updates:\n-\tin step 2: AF includes \"subscribed services\" in the AF request. The \"subscribed services\" can be indicated, for example, by including one or more of the following information or by other means:\n-\tAllowed Service;\n-\tSubscriber category;\n-\tGroup ID;\n-\tPLMN ID.\n-\tin step 5: Based on received AF request, PCF creates PCC rule for UEs whose subscription information matching with the \"subscribed services\", for example, the \"subscribed services\" is \"Allowed Service#1 AND Group ID#1\", then PCC rule is created for UEs whose subscription including both Allowed Service#1 and Group ID#1; the \"subscribed services\" is \"Allowed Service#1 AND (NOT Group ID#1)\", then PCC rule is created for UEs whose subscription including Allowed Service#1 but not Group ID#1.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.32.3\tImpacts on services, entities and interfaces",
                            "text_content": "AF, NEF, PCF and UDR is to be updated for supporting \"subscribed services\".\nNnef_TrafficInfluence Service is extended with new parameter \"subscribed services\".\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.33\tSolution 33 (KI#3): AF requests offload policy for sets of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.33.1\tDescription",
                            "text_content": "The following solution corresponds to the key issue #3 on Policies for finer granular sets of UEs as specified in clause 5.3.\nIt is using the AF influence traffic mechanism to route the traffic for a collection of UEs. The AF provides the Category information in AF request to indicate which information elements (e.g. Spatial Validity Condition, Application Identifier, FQDN range, Temporal Validity Condition, Target UE Identifier) are used to determine the collection of UEs for traffic offload.\nThe information elements defined in clause 5.6.7 in TS 23.501 [2] can be reused, the categories include:\n-\tCategory 1: Spatial Validity Condition (Area of Interest, geographical area etc.), e.g. the traffic routing mechanism is applied to the UEs located in the same Area of Interest.\n-\tCategory 2: Application Identifier/FQDN range, e.g. the traffic routing mechanism is applied to the UEs that are using the same application.\n-\tCategory 3: Temporal Validity Condition, e.g. the traffic routing mechanism is applied to the UEs that use the same application during the specific time interval.\n-\tCategory 4: Target UE Identifier(s), e.g. the traffic routing mechanism is applied to the UEs that are associated with a specific External Group Identifier.\nOther categories: combinations of category 1-4, it may include:\n-\tCategory 5: Spatial Validity Condition AND Application Identifier/FQDN range, e.g. the traffic routing mechanism is applied to the UEs located in the same Area of Interest and using the same application.\n-\tCategory 6: Combination of different groups, e.g. UEs that are associated with both External Group Identifier A and External Group Identifier B.\n-\tetc.\nBased on the Category information in AF request, the PCF generates PCC rule(s) and sends it to the SMF. The SMF determines that the UE belongs to the collection of UEs for traffic offload, and reconfigures the UP per PCC rule(s).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.33.2\tProcedures",
                            "text_content": "The figure depicts a network architecture with multiple layers, including a core switch, optical line terminals (OLTs), and distributed nodes. Redundancy paths are shown in dashed lines to ensure failover reliability. The layered design aligns with SDN principles.\nFigure 6.33.2-1: Processing AF requests to influence traffic routing for Sessions associates with a collection of UEs (reuse the figure 4.3.6.2-1 of TS 23.502 [9])\nThe solution reuses the procedure of AF requests to influence traffic routing as described in clause 4.3.6.2 of TS 23.502 [9], with the following enhancements:\n-\tIn step 1, the AF requests the offload policy with Category information that indicates the collection of UEs for traffic offload, and the content of offload policy is as described in clause 6.33.1.\n-\tIn step 2, the offload policy is included in the AF request message.\n-\tIn step 5, the PCF determines which UE belongs to the collection of UEs for traffic offload and generates PCC rule(s) for PDU Session of UEs in the UE collection based on the Category information in AF request.\n-\tIn step 6, based on the received PCC rule(s) from PCF, the SMF reconfigures the User plane of the PDU Session correspondingly.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.33.3\tImpacts on services, entities and interfaces",
                            "text_content": "AF:\n-\tprovides the Category information in AF request.\nPCF:\n-\tcreates PCC rule based on the Category information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.34\tSolution 34 (KI#4): Selecting the same EAS/DNAI for collection of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.34.1\tDescription",
                            "text_content": "This solution is based on solution 16, described in clause 6.16.\nThis solution uses EDI to make sure a collection defined by an AF uses the same DNAI and/or EAS. By this EDI is updated with EAS address field per DNAI and an indicator if the DNAI is selected for a group. The data in EDI is also updated with a Dynamic External Group Id that can be per DNAI or per application ID. The AF can use the Dynamic External Group ID and external application id to influence routing for a collection of UEs. The dynamic external group id is an identifier that is generated by the AF, i.e. it is not to be confused with the external group id configured in UDM. The AF associates a list of UEs with the dynamic external group id when requesting in AF influence on routing that the list of UEs should be using the same EAS and/or DNAI.\nExample of EDI record before any group has been requested through traffic influence:\nDNN-1/S-NSSAI-1:\nApplicationID-1\nFQDN\nDynExtGrID-1\nDynExtGrID-2\nDNAI-1\nDynExtGrID-4\nDynExtGrID-5\nDNAI-2\nDynExtGrID-5\netc.\nExample of EDI record before after some groups have been requested through traffic influence:\nDNN-1/S-NSSAI-1:\nApplicationID-1\nFQDN\nDynExtGrID-1\nDNAI-55\nEASaddr-1\nDynExtGrID-2\nDNAI-1\nDynExtGrID-4\nDNAI selection indicator\nEASaddr-3\nDynExtGrID-5\nDNAI-2\nDynExtGrID-5\nEASaddr-2\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.34.2\tProcedure",
                            "text_content": "The following is the procedure for selecting the same EAS for collection of UEs accessing the same application. The procedures defined in figure 4.3.6.2-1 in TS 23.502 [9] and figure 6.2.3.2.2-1 in TS 23.548 [3] are reused.\nThe figure depicts a simplified process for selecting the same EAS/DNAI for collection of UEs, illustrating the steps involved in the discovery procedure. The figure includes a flowchart with arrows indicating the sequence of actions, and a legend to clarify the different types of EAS/DNAI. The figure is a visual representation of the process, making it easy to understand and follow.\nFigure 6.34.2-1: Discovery procedure for selecting the same EAS/DNAI for collection of UEs\n1.\tAF provides EDI and SMF may get the EDI according to TS 23.548 [3]. AF includes a Dynamic External Group ID per DNAI or per External Application ID, if on External application ID, then it is relevant for all DNAIs. There may be a list of Dynamic External Group IDs on both levels. See example in clause 6.16.2.1.\n2.\tThe AF request in step 1 of figure 4.3.6.2-1 in TS 23.502 [9] is used to request selecting the same EAS and/or same DNAI for a collection of UEs accessing the application as identified by external application ID in the AF Request. The AF provides a DNAI correlation indication and/or EAS correlation indication. The correlation indications are used as a means to request a common DNAI and/or a common EAS for the UEs. Spatial Validity Condition could be provided for limiting the location of the UEs, and also \"any UE\" or an UE list or group ID will be provided for defining UE collection accessing the same EAS or the same DNAI.\nNEF maps external application ID to application ID.\nAF will also indicate if re-discovery is needed to NEF, this can only be used if a list if UEs is provided. This is to ensure that a common EAS will be used by the concerned UEs.\nIn step 5 of figure 4.3.6.2-1 of TS 23.502 [9], PCF determines the UEs influenced by the AF Request, and based on AF request, PCF creates PCC rule with application ID and the Dynamic External Group ID and DNAI correlation indication and/or EAS correlation indication.\nIf not already subscribed to receive updates events of the EDI for the concerned DNN and S-NSSAI, SMF does that as per TS 23.548 [3] to retrieve the EDI.\n3\tIf re-discovery is requested, SMF does a PDU Session modification to trigger EAS re-discovery as per clause 6.2.3.3 in TS 23.548 [3].\n4.\tThe same as steps 1-9 in figure 6.2.3.2.2-1 in TS 23.548 [3].\n5.\tIf the notified FQDN from EASDF to SMF is related to the Application ID that is associated with a Dynamic External Group ID, and that DNAI and/or EAS correlation information was received in step 2, the SMF determines that the UE should be part of a dynamic group with same DNAI and/or same EAS (depending on what the AF originally requested). Using the data received in step 2, SMF determines if any of the DNAI has been selected for the group by checking the EDI. If so, the SMF uses this DNAI in step 7. and if EAS correlation indication was received from PCF, and if there is an EAS address associated with the Dynamic External Group ID SMF uses this in step 7.\n6.\tThe following cases can occur:\n-\tIf no DNAI could be used in step 5, SMF selects a DNAI and if a common DNAI should be selected indicated via the DNAI correlation indicator in step 2, SMF updates the EDI with the selected DNAI, either with an indicator or the actual DNAI depending on which level the dynamic external group id was provided on (SMFs subscribing to update events to the EDI change will be notified).\n-\tIf EAS correlation indication was set in step 2 and SMF did not have any EAS address available in step 5, SMF provides the EAS address that was received from EASDF. If multiple EAS addresses were received, SMF selects one. SMF updates EDI with the EAS address. SMF uses this in step 7.\n7.\tBased on steps 10-19 in figure 6.2.3.2.2-1 in TS 23.548 [3]. i.e. updates of the DNS handling rules with the EAS address, and breaking out the session at selected DNAI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.34.3\tImpacts on services, entities and interfaces",
                            "text_content": "AF:\n-\tto be updated with Dynamic External Group ID, EAS correlation indicator, and DNAI correlation indicator.\nNEF:\n-\tNnef_TrafficInfluence service (or new) as per AF new information;\n-\tnew data in EDI.\nSMF:\n-\tusing PCC rule to associate UEs to a dynamic group of UEs, based on the original AF provided information given by PCF. Using and updating data in EDI.\nUDR:\n-\tnew data in EDI.\nEASDF:\n-\tmay need to be updated for create and send DNS response to UE.\nPCF:\n-\tservices related to AF influence on routing to be updated with Dynamic External Group ID, EAS correlation ID, DNAI correlation ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.35\tSolution 35 (KI#4): Providing dedicated (re)location information as traffic routing information",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.35.1\tDescription",
                            "text_content": "To provide the dedicated (re)location information for a collection of UEs, the collection of UEs can be a pre-defined group of UEs or a dynamic group of UEs, the dedicated (re)location information can be the target DNAI or the target EAS which is shared by the collection of UEs. The collection of UEs can be decided by the network administrator or by the application. The collection of UEs can be a pre-configured group which is be configured by the operator, which is already supported and out of scope of KI#4. The collection of UEs can also be decided by the application.\nThe target DNAI or target EAS can be decided by the AF based on the edge relocation triggered by AF or can be received by the AF via the User Plane Management events notification to the AF from the CN, or can be received by the AF via application layer. AF Providing the dedicated (re)location information for the identified collection of UEs, the existing Application Function influence on traffic routing mechanism is reused with additionally including the following:\n-\tThe target DNAI/EAS is provisioned for a collection of UEs, not only targeting an individual UE.\n-\tThe collection of UEs can be identified by dynamic group ID managed with 5G VN group management mechanism as defined in clause 6.14, or the UEs shares the same service information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.35.2\tProcedures",
                            "text_content": "The following figure shows the solution providing the dedicated (re)location information for a collection of UE within the same dynamic group or associated with the same service information.\nThe figure depicts a server discovery scenario with dedicated (re)location information. It shows a server with a unique identifier (ID) and a location identifier (LI). The server is located at a specific location (LI) and has a dedicated (re)location information. This information is used to determine the server's location and to provide a unique identifier for the server.\nFigure 6.35.2-1: Server Discovery with dedicated (re)location information\n1.\tThe UE1 establishes the PDU Session with C-UPF.\n2.\tUE1 enters the EDN Service Area and initiates one application e.g. starts one game and target EAS is discovered for the game.\n3.\tThe dedicated relocation information is included in step 3, which targets the collection of UEs. The traffic correlation can be explicitly indicated by the traffic correlation indication, or implicitly indicated by the dedicated relocation information for the collection of UEs. AF request with traffic routing information is used to provide the dedicated relocation information, and is sent to the Core network for the specific application with the application ID, targeting a collection of UE(s). The collection of UEs can be identified by the group ID (the group can be dynamically managed with the existing mechanism), or by the target UEs with service information (e.g. the application instance identifier identifying the application instance a collection of UEs are accessing, which means all the UEs accessing the identified application instance). If it targets a group of UEs with the service specific information, it means the UE with the service specific information in the group can apply the receive traffic routing information received. The dedicated relocation information should be stored as associated data for the collection of UEs.\n3a.\tStep 3a is used for sending the information of a specific UE to associate the UE with the collection of UEs, if the group ID is used to identify the collection of UEs and the UEs belong to the group are preconfigured in 5GC, step 3a is skipped. Otherwise, if the collection of UEs is identified with the service information provided in step 3, the procedure of Service specific parameter provisioning defined in clause 4.15.6.7 of TS 23.502 [9] can be used to send the service specific information of the UE, for example indicating the UE is accessing the application with service specific information (e.g. joining the game).\nIf the collection of UEs is identified by the group ID within 5GC, the group ID can be sent to the SMF while retrieving the SM subscription data, and the SMF retrieves the PCC rule with the group ID from the PCF for each UE, and the UE accesses the application will be matched whether it belongs to the group, if so, the traffic of the UE for the application should be correlated with the group of UEs accessing the application in the PCF.\nNOTE:\tThe service information in this solution is notified to the SM-PCF to influence the PCC Rules instead of AM-PCF delivered to the UE as defined in clause 4.15.6.7 of TS 23.502 [9].\n4.\tBased on the information received in step 3 and/or step 3a, the related policy with traffic correlation and the dedicated relocation information is sent to the SMF. The traffic correlation information is optional, if it is included, all the PDU Sessions with the same traffic correlation information can be correlated together to relocate the related traffic to the target DNAI/EAS. The SMF manages the PDU Session considering the target DNAI/EAS, which includes the routing decisions for traffic of PDU Session and the DNS handling rule decision.\n5-7.\tThe SMF controls the traffic routing based on the received traffic routing with dedicated relocation information accordingly. BP and L-UPF are inserted based on the edge relocation information e.g. the target DNAI/EAS received in step 4 if available. User-plane communication takes place between the Application Client in UE1 and Edge Application Server the local UPF after the application relocation to the EAS, the new UE IP address is used if multi-homing is used.\n8.\tUE2 Session Establishment with C-UPF to access the DN, and EASDF is configured with DNS handling rules.\n9.\tUE2 sends DNS query for the application.\n10a-10b.\tCondition triggered, the related policy with traffic correlation and the target DNAI/EAS is generated. The condition triggered includes one of the following:\n-\tSpecific service information matched, in this case, the specific service information of UE2 accessing the application is sent to the PCF in step 10a which is similar to step 3a.\n-\tUE2 belongs to the same group as UE1, the target DNAI/EAS information is associated with the group as described in step 3-4.\n11-12.\tThe related policy with traffic correlation and the target DNAI/EAS is sent to the SMF. The traffic correlation information is optional, if it is included, all the PDU Sessions with the same traffic correlation information will be correlated together to relocate the related traffic to the target DNAI/EAS. The SMF manages the PDU Session considering the target DNAI/EAS, which includes the routing decisions for traffic of PDU Session and the DNS handling rule decision.\n13.\tUL-CL/BP insertion based on the target DNAI/EAS received in step 11.\n14.\tReceiving the DNS query message for UE2 for the application as described in step 9, if the DNS Query message matches a DNS message detection template of DNS message handling rule for reporting, the EASDF sends the DNS message report to SMF.\n15.\tThe SMF decides the DNS handling rule based on the target DNAI/EAS received in step 11:\n-\tIf the dedicated relocation information is target DNAI, the SMF selects the EDNS Client Subnet option or the local DNS server based on the target DNAI, and sends the DNS handling rule accordingly.\n-\tIf the dedicated relocation information is target EAS, the SMF indicates the EASDF to response the DNS query with the target EAS, by adding one more action of responding with indicated EAS in the DNS handling rule.\n16.\tOptionally, the EASDF handles the DNS Query message.\n17.\tThe EASDF sends the DNS response to the UE with the EAS within the target DNAI or with the target EAS directly.\n18.\tUser-plane communication takes place between the Application Client in UE2 and Edge Application Server via the local UPF after the application relocation to the EAS.\n19-22.\tWhen the condition changes, it should be supported that the Association of the collections of UEs can be updated or disassociated for EAS (re)location, for example the collection of UEs can be updated, the dedicated relocation information can be updated, the association of the collection of UEs can be disassociated.\nStep 19-22 gives the example that the association of the collection of UEs can be disassociated when the game is over. The game is over. The delete procedure is similar to the create procedure described in step 4, the only difference is that it is to delete the related information and the PCF makes the decision to modify the SM policy for the application within the PDU Session accordingly.\nIf the association of the collections of UEs are updated, the AF update is executed and the PCF updates the related SM policy accordingly.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.35.3\tImpacts on services, entities and interfaces",
                            "text_content": "The following impacts are involved to support providing the traffic routing policy for a set of UE with associated with the same service information:\nAF/NEF/UDR:\n-\tdedicated (re)location information is provided as traffic routing information;\n-\tservice information is optionally supported to associate a specific UE with a collection of UEs;\n-\ttraffic correlation information to differentiate different collections of UEs may be supported.\nPCF:\n-\tthe dedicated (re)location information for a set of UEs is received;\n-\tservice information is optionally supported to associate a specific UE with a set of UEs;\n-\tassociates the UE accessing the application with the set of UEs, and sends the PCC rule to the SMF for the PDU Session of the UE with the traffic routing policy information with the dedicated (re)location information;\n-\ttraffic correlation information to differentiate different set of UEs may be supported.\nSMF:\n-\tmanages the PDU Session considering the received dedicated (re)location information, which includes the routing decisions for traffic of PDU Session and the DNS handling rule decision;\n-\tall the PDU Sessions with the same traffic correlation information will be correlated together to use the same traffic correlation information.\nEASDF:\n-\tsends the DNS response to the UE with the EAS indicated by the SMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.36\tSolution 36 (KI#4): Providing dedicated (re)location information as EAS Deployment information",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.36.1\tDescription",
                            "text_content": "To provide the dedicated (re)location information for a collection of UEs for server discovery, the collection of UEs can be a pre-defined group of UEs or a dynamic group of UEs, the dedicated (re)location information can be the target DNAI or the target EAS which is shared by the collection of UEs. The collection of UEs can be decided by the network administrator or by the application. The collection of UEs can be a pre-configured group which is be configured by the operator, which is already supported and out of scope of KI#4. The collection of UEs can also be decided by the application.\nThe target DNAI or target EAS can be decided by the AF based on the edge relocation triggered by AF or can be received by the AF via the User Plane Management events notification to the AF from the CN, or can be received by the AF via application layer. AF Providing the dedicated (re)location information for the identified collection of UEs, the EAS Deployment Information Management mechanism is reused with additionally including the following:\n-\tThe target DNAI/EAS is provisioned for a collection of UEs.\n-\tThe collection of UEs can be identified by pre-configured group ID, dynamic group ID managed with 5G VN group management mechanism as defined in clause 6.14, or the UEs shares the same service information.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.36.2\tProcedures",
                            "text_content": "The following figure shows the solution providing the dedicated (re)location information for a collection of UE within the same dynamic group or associated with the same service information.\nThe figure depicts a server discovery scenario with dedicated (re)location information as EAS Deployment Information. It illustrates the process of server discovery, where a server is identified and its location is provided to the EAS system. The figure shows the server's location information, which is crucial for the EAS system to accurately identify and track the server.\nFigure 6.36.1: Server Discovery with dedicated (re)location information as EAS Deployment Information\n1.\tThe UE1 establishes the PDU Session with C-UPF.\n2.\tUE1 enters the EDN Service Area and initiates one application e.g. starts one game and target EAS is discovered for the game.\n3.\tThe dedicated relocation information is sent to the SMF to improve the PSA/application relocation. All the UEs within the game are required to access the application according to the dedicated relocation information, which is the same DNAI/EAS. The SMF manages the PDU Sessions considering the target DNAI, which includes the routing decisions for traffic of PDU Session and the DNS handling rule decision.\nAF request to Provide EAS Deployment information with dedicated relocation information is sent to the Core network for the specific application(s) with the application ID(s), targeting a collection of UE(s) using the EAS Deployment Information Management procedure defined in clause 6.2.3.4 of TS 23.548 [3]. The collection of UEs can be identified by the group ID (the group can be dynamically managed similar with the 5GVN group management mechanism), or by the target UEs with service information (e.g. the application instance identifier identifying the application instance a collection of UEs are accessing, which means all the UEs accessing the identified application instance). If it targets a group of UEs with the service specific information, it means the UE with the service specific information in the group can apply the dedicated relocation information received.\n4.\tIf the group ID is used to identify the collection of UEs and the UEs belong to the group are preconfigured in 5GC, step 3a for sending the information of a specific UE to associate the UE with the collection of UEs is skipped. If the collection of UEs is identified with the service information provided in step 3, the procedure of Service specific parameter provisioning defined in clause 4.15.6.7 of TS 23.502 [9] can be used to send the service specific information of the UE, for example indicating the UE is accessing the application with service specific information (e.g. joining the game).\nNOTE:\tThe service information in this solution is notified to the SM-PCF to influence the PCC Rules instead of AM-PCF delivered to the UE as defined in clause 4.15.6.7 of TS 23.502 [9].\nIf the collection of UEs is identified by the group ID within 5GC, the group ID can be sent to the SMF while retrieving the SM subscription data, and the SMF retrieves the PCC rule with the group ID from the PCF for each UE, and the UE accesses the application will be matched whether it belongs to the group, if so, the traffic of the UE for the application should be correlated with the group of UEs accessing the application.\n5-7.\tThe SMF controls the traffic routing based on the received information of dedicated relocation information (the target DNAI) accordingly. BP and L-UPF are inserted based on the dedicated relocation information e.g. the target DNAI. User-plane communication takes place between the Application Client in UE1 and Edge Application Server the local UPF after the application relocation to the EAS, the new UE IP address is used if multi-homing is used.\n8.\tUE2 Session Establishment with C-UPF to access the DN, and EASDF is configured with DNS handling rules.\n9.\tUE2 sends DNS query for the application.\n10a-10.\tCondition triggered, the related information of the target DNAI/EAS are received by the SMF. The condition triggered includes one of the following:\n-\tspecific service information matched; in this case, the specific service information of UE2 accessing the application is sent to the SMF in step 10a which is similar as step 4;\n-\tUE2 belongs to the same group with UE1, the target DNAI/EAS information is associated with the group as described in step 3-4.\n11.\tBP insertion based on the target DNAI for the PDU Session received in step 10a-10 if needed.\n12.\tReceiving the DNS query message for UE2 for the application as described in step 9, if the DNS Query message matches a DNS message detection template of DNS message handling rule for reporting, the EASDF sends the DNS message report to SMF.\n13.\tThe SMF decides the DNS handling rule based on the target DNAI/EAS as described in step 10a-10, including:\n-\tif the dedicated relocation information is target DNAI, the SMF selects the EDNS Client Subnet option or the local DNS server based on the target DNAI, and sends the DNS handling rule accordingly to the EASDF;\n-\tif the dedicated relocation information is target EAS, the SMF indicates the EASDF to response the DNS query with the target EAS, by adding one more action of responding with indicated EAS in the DNS handling rule.\n14.\tThe EASDF handles the DNS Query message. Optionally, the EASDF forwards the DNS query message.\n15.\tThe EASDF sends the DNS response to the UE with the EAS within the target DNAI or with the target EAS directly.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.36.3\tImpacts on services, entities and interfaces",
                            "text_content": "The following impacts are involved to support providing the traffic routing policy for a set of UE with associated with the same service information:\nAF/NEF/UDR:\n-\tdedicated (re)location information is provided as EAS Deployment information;\n-\tservice information is optionally supported to associate a specific UE with a collection of UEs.\nSMF:\n-\tthe EAS Deployment information with dedicated (re)location information for a set of UEs is received;\n-\tservice information is optionally supported to associate a specific UE with a set of UEs;\n-\tassociates the UE accessing the application with the set of UEs using service information if received;\n-\tmakes the DNS handling rule decision for the PDU Session associated with the set of UEs considering the received dedicated (re)location information.\nEASDF:\n-\tsends the DNS response to the UE with the EAS indicated by the SMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.37\tSolution 37 (KI#4): (Re)location of same EAS and coordination across UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.37.1\tIntroduction",
                            "text_content": "This solution aims to address the technical requirements related to key issue #4. In particular, it provides solutions to, among others, how the 5GS facilitates EAS (re)location of EAS for the collection of UEs. The procedure defined in figure 6.2.3.2.2-1 in TS 23.548 [3] is reused. Also, procedure for ad hoc group provisioning and group information management/storing in the UDM/UDR are assumed, for example solution 19 in clause 6.19.\nThere could be one SMF serving the collection of UEs that connects the same EAS/DNAI for accessing the same application, or there could be multiple SMFs for different UEs in the collection. For the latter case, UDM is used for coordination between SMFs to make sure selecting the same EAS/DNAI for UEs in the ad hoc group, i.e. SMF updates the selected EAS IP/DNAI to UDM or SMFs gets the EAS IP/DNAI information from UDM.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.37.2\tFunctional Description",
                            "text_content": "The following are the main principles of the solution:\n-\tProcedure for ad hoc group provisioning and group information management/storing in the UDM/UDR are re-used for example based on solution 19 in clause 6.19.\n-\tEAS ID is determined based on the procedure in clause 6.2.3.2.2-1 in TS 23.548 [3].\n-\tSMF updates the ad hoc group information in the UDM/UDR with the EAS ID.\n-\tSMFs subscribes to the UDM to get notification on any changes to the ad hoc group data.\n-\tFor the subsequent ad hoc group member UEs DNS request, SMF(s) instructs the EASDF to provide the already determined EAS IP address in the DNS response for DNS queries.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.37.3\tSolution Details",
                            "text_content": "The figure 6.37.3.1-1 below provides a detailed call flow on the (re)location of the same EAS to the all the UEs of the ad hoc group.\nAlthough the figure below does not explicitly indicate the same DNAI, but the same is applicable in case of common/same DNAI requirement. For example, initial/first SMF selects a DNAI and updates to the group information in the UDM/UDR. UDM/UDR then notifies to other SMFs (if subscribed). This DNAI may change e.g. using existing procedures due to UE mobility and/or AF influence and so on. If so, respective SMF updates to the group information in the UDM/UDR newly selected DNAI using Nudm_ParameterProvision. This ensures that the same DNAI is applied to all the group members, and also allows DNAI change.\nThe figure depicts the re-location of EAS (Enhanced Active Antennas) to the ad-hoc group member UEs, illustrating the process of reconfiguring the EAS system to accommodate the new group members.\nFigure 6.37.3.1-1: EAS (re)location to the ad hoc group member UEs\n1.\tAd hoc group provisioning and group information management/storing in the UDM/UDR, for example:\n-\tas in solution 19 in clause 6.19 or based on details in clause 6.37.3.3. Nnef_ParameterProvision_Create request is used to provision group attributes like group ID, member UEs, FQDN, etc. SMF subscribed to the Group subscription data via Nudm_SDM_Notification Notify message.\n2.\tThe same as steps 1~15 in figure 6.2.3.2.2-1 in TS 23.548 [3].\n3.\tThis step may possibly/also occur before step 2, where SMF learns via Nudm_SDM_Notification Notify that UE belongs to the ad hoc group provisioned by the AF for certain application that requires same application server/EAS.\n4.\tSMF uses Nudm_ParameterProvision to update ad hoc group subscription data in the UDM/UDR to include EAS ID.\n5. Based on steps 16~19 in figure 6.2.3.2.2-1 in TS 23.548 [3]:\nIn step 17, SMF sends DNS message handling rule with IP address for the EAS instructing EASDF to return the IP address for the EAS to UE in step 19.\n6.\tAll the SMFs subscribed to the notification of the Group subscription data are notified of the changes using Nudm_SDM_Notification Notify, and thus learn EAS ID applicable to the ad hoc group member UEs.\n7. For the Group of UEs, if another UE of Group of UEs sends DNS request, based on steps 1~9 in figure 6.2.3.2.2-1 in TS 23.548 [3]:\nSteps 10 to 15 are skipped and in step 16 the UL-CL UPF is selected by SMFx for EAS ID notified by UDM and at step 17, SMFx sends DNS message handling rule with IP address for the EAS instructing its EASDFx to return the IP address for the EAS to UE in step 19.\nIn cases such as where multiple UEs of the same group send DNS queries almost simultaneously, and subsequently resolved to different EAS ID, it is possible that respective SMF may try to update the EAS ID of the ad hoc group. For this kind of race condition, the procedures below are proposed:\n-\tSMF creates/modifies the correlation of an EAS ID with a Group ID and FQDN in the UDM/UDR as explained in clause 6.37.3.1. The binding information may include an FQDN for which the binding exists and/or SMF ID and/or SMF set ID;\n-\tSMF subscribes to the UDM/UDR for notification of change of creation/deletion/modification of the correlation of EAS ID with Group ID;\n-\tBased on the binding information that includes an FQDNs for which the binding exists and/or SMF ID and/or SMF set ID, UDM/UDR evaluates new creation/deletion/modification of the correlation of EAS ID with Group ID in order to avoid overwriting the initially stored EAS ID and accordingly UDM/UDR rejects creation/deletion/modification of the correlation of EAS ID with Group ID by sending the stored EAS ID to the subsequent SMF, i.e. SMF2;\n-\tSMF2 accepts the response to the creation/update of the correlation of EAS ID with Group ID from UDM/UDR with an EAS ID (i.e. if already stored in the group data) different from the EAS ID provided by the SMF2 to the database;\n-\tSMF evaluates the EAS ID received in the response from the UDM/UDR and re-selects and re-configures DNAI / UL-CL UPF and PSA UPF (before instructing the EASDF to reply with DNS response towards the UE).\nThis clause relates to 5GC initiated ad hoc group creation/update/deletion, i.e. SMF may form a dynamic ad hoc group of a collection of UEs that could be subject to collective and common treatment. This collection of UEs may be based on specific criteria, for example all the UEs in this group use the same EAS and/or same DNAI and/or same PSA UPF and/or UEs in a specific geographical area.\nIn case of ad hoc group consisting of UEs using the same EAS, SMF may interact with EASDF to form this group. Thus, SMF determines the collection of UEs based on the DNS response messages provided by EASDF to SMF.\nAs per existing specification, SMF instructs EASDF to report DNS responses matching one or more specific FQDNs and/or EAS IP addresses. EASDF notifies SMF per UE's PDU Session when such DNS response is received. Once SMF receives the notification from EASDF for each PDU Session, then SMF can group them based on the grouping criteria. Alternatively, the SMF may instruct the EASDF to report DNS responses matching one or more specific FQDNs and/or EAS IP addresses for any PDU Session of ANY UE possibly matching certain criteria (e.g. a specific S-NSSAI and DNN). Once SMF receives notification from the EASDF, SMF assigns an ad hoc group ID for the same and may store group information in the UDM/UDR, together with Group ID and list of UEs, etc. SMF may also report this group ID/info to AF based on AF notification criteria, thus allowing AF to make an offloading decision subsequently.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.37.4\tImpacts on services, entities and interfaces",
                            "text_content": "SMF:\n-\tsubscribes to the ad hoc group subscription data;\n-\tupdates UDM/UDR with EAS ID/DNAI information in the ad hoc group subscription data;\n-\tinteractions between SMF and EASDF related to clause 6.37.3.3.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.38\tSolution 38 (KI#5): EAS Discovery for EHE shared with other PLMN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.38.1\tDescription",
                            "text_content": "In Key Issue#5, the following aspects shall be studied:\n-\tinvestigate potential impacts related to the GSMA Operator Platform Group work on EAS discovery.\nEdge Node Sharing scenario is one use case defined in clause 3.3.5 of GSMA OPG.02 [5], in which case EAS A (hosted by Operator A) is to be accessed by Operator B's network. This solution aims to solve the EAS discovery for the Edge Node Sharing scenario. From Operator B's point of view, the EAS deployed in Operator A's network is equivalent to the case that 3rd party provider hosting the EHE. Application provider (AF) creates EDI (EAS Deployment Information) corresponding to Operator A's network, and Operator A forward EDI to Operator B instead of the application provider.\nThere are two candidate options to provision EDI to serving Operator:\n1)\tbased on interaction between NEFs from different PLMNs;\n2)\tbased on EWBI interface defined by GSMA OPG.02 [5].\nOption1 - NEF-based EDI provision to serving Operator:\nOperator A needs to translate the EDI provided by AF to an EDI corresponding to Operator B's network, and also N6 traffic routing requirements could be included in EDI for instructing how to route traffic from Operator B's network to the Operator A's EHE. It is assumed that AF only has agreement with Operator A. NEF is in charge of translation between EDIs, it translates DNAI corresponding to Operator A's network to DNAI corresponding to Operator B's network.\nNOTE 1:\tThe translation of DNAI could be based on configured relationship between DNAIs from different operators, or NEF could retrieve Operator B's DNAI dynamically, e.g. based on solutions from KI#7 described in clause 5.7. The N6 traffic routing requirements could be determined based on SLA between Operators (similar to the way how AF configures N6 traffic routing requirements currently).\nOption2 - EWBI-based EDI provision to serving Operator:\nEWBI defined by GSMA OPG.02 [5] is used for exchange EDI information between PLMNs, and it assumes EWBI support the capability for exchanging application instance access information between PLMNs. The OPG platform could interact with NEF of serving PLMN via SBI-NR interface for provision of EDI.\nNOTE 2:\tPer SLA agreement between operator one dedicated IP connection can be established between Operators, which will be in charge of satisfy the end-to-end QoS requirement when the traffic routing from Operator B's UPF to Operator A's DN, and UPF could mark the packets with appropriate pre-configured DSCP value for traffic routing Qos fulfilment between PLMNs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.38.2\tProcedures",
                            "text_content": "The EAS discovery procedure for Edge Node Sharing scenario is defined below.\nThe figure depicts the EAS (Electronic Attack and Defense) discovery procedure, which involves the detection and identification of electronic threats. The figure shows a schematic representation of the EAS system, including various components such as the EAS controller, EAS sensor, and EAS alerting system. The figure illustrates the flow of data from the EAS sensor to the controller, which then triggers the alerting system to send an alert to the appropriate authorities. The figure is crucial for understanding the EAS system's architecture and its role in protecting critical infrastructure from electronic attacks.\nFigure 6.38.2.1-1: EAS discovery procedure\n1.\tAF invokes the Nnef_EASDeployment_Create operation with EDI1 corresponding to Operator A.\n2.\tNEF of Operator A translates the received EDI1 from AF to a new EDI2 corresponding to Operator B:\n-\tNEF translates DNAI in the received EDI1 to the DNAI of Operator B, and includes the DNAI of Operator B in the new EDI2.\n-\t(optional) NEF adds N6 traffic routing information in the new EDI2.\nNOTE 1:\tThe translation of DNAI could be based on configured relationship between DNAIs from different operators, or NEF could retrieve Operator B's DNAI dynamically, e.g. based on solution from KI#7, described in clause 5.7. The N6 traffic routing requirements could be determined based on SLA between operators.\n3.\tThe NEF of Operator A sends Nnef_EASDeployment_Create Response to the AF.\n4~7.\tThe same as steps in EAS Deployment Information management in the AF procedure as defined in figure 6.2.3.4.2-1 in TS 23.548 [3]. In step 3, EDI2 corresponding to Operator B is included in the Nnef_EASDeployment_Create operation. In step 4, NEF#B could do authorization on the request from NEF#A.\n8.\tThe same as EAS Deployment Information management in the SMF procedure as defined in figure 6.2.3.4.3-1 in TS 23.548 [3].\n9.\tStep 3~19 of EAS Discovery procedure in figure 6.2.3.2.2-1 in TS 23.548 [3] is reused, with the following difference:\nIn step 16, after determining the DNAI, SMF could determine the N6 traffic routing information for the DNAI based on the N6 routing Information in EDI.\nThe figure depicts the EAS (Electronic Attack Surface) discovery procedure based on the EWBI (Electronic Warfare Body of Information) methodology. It illustrates the steps involved in identifying and categorizing electronic threats, such as radio frequency (RF) signals, microwave emissions, and other electromagnetic emissions. The figure includes a schematic representation of the EAS discovery process, with various components like RF sensors, microwave detectors, and signal processing algorithms. The figure is crucial for understanding the EAS discovery process in the context of electronic warfare, and it provides a visual representation of the steps involved in identifying and categorizing electronic threats.\nFigure 6.38.2.2-1: EAS discovery procedure based on EWBI\nNOTE 1:\tThe serving PLMN gets EDI of PLMN, which shares the EHE, via EWBI interface, and GSMA OP platform could act the role of AF. It assumes EWBI supports the capability for exchanging application instance access information between PLMNs.\n1.\tAF invokes the Nnef_EASDeployment_Create operation with EDI1 corresponding to PLMN hosting EHE. The EDI1 contains DNAI(s) corresponding to PLMN hosting EHE.\n2.\tNEF translates the received EDI1 from AF to a new EDI2 corresponding to UE's serving PLMN:\n-\tNEF translates DNAI in the received EDI1 to the DNAI of serving PLMN, and includes the DNAI of serving PLMN in the new EDI2;\n-\t(optional) NEF adds N6 traffic routing information in the new EDI2.\nNOTE 2:\tThe translation of DNAI could be based on configured relationship between DNAIs from different PLMNs, or NEF could retrieve serving PLMN's DNAI dynamically, e.g. based on solution from KI#7, described in clause 5.7. The N6 traffic routing requirements could be determined based on SLA between operators.\n3.\tThe NEF of Operator A sends Nnef_EASDeployment_Create Response to the AF.\n4-5.\tNEF stores the received EDI into UDR.\n6.\tThe same as EAS Deployment Information management in the SMF procedure as defined in figure 6.2.3.4.3-1 in TS 23.548 [3].\n7.\tSteps 3-19 of EAS Discovery procedure in figure 6.2.3.2.2-1 in TS 23.548 [3] is reused, with the following difference:\n-\tIn step 16, after determining the DNAI, SMF could determine the N6 traffic routing information for the DNAI based on the N6 routing Information in EDI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.38.3\tImpacts on services, entities and interfaces",
                            "text_content": "EAS Deployment Information (EDI) is extended with N6 traffic routing Information for DNAI.\nNEF:\n-\tsupports EDI translation.\nAF:\n-\tsupports the new EDI.\nSMF:\n-\tsupports N6 traffic routing Information in EDI.NEF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.39\tSolution 39 (KI#1, KI#5): Support EAS relocation of inter-PLMN",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.39.1\tDescription",
                            "text_content": "The following solution corresponds to the key issue #1 on Accessing EHE in a VPLMN when roaming as specified in clause 5.1 \"how to support the edge relocation in roaming scenarios\" and key issue #5 on GSMA OPG impacts and improvements for EHE operated by separate party as specified in clause 5.5 \"how the 5GS facilitates edge relocation between an EAS deployed by a source EHE provider to another EHE deployed by a target EHE provider, even in scenarios when EHEs are operated by different service providers\".\nThis solution makes the following assumptions:\n-\tthe EAS relocation is triggered by AF (e.g. due to the load balance between EAS instances in the EHE);\n-\tan OP to deploy EAS on another OP, and these OPs are different PLMNs;\n-\tthe EAS is relocated from VPLMN/HPLMN to HPLMN/VPLMN.\nThe solution is to address EAS relocation of different PLMNs, and it is illustrated as the scenario of figure 6.39.2.1-1. The EHE1 is operated by OP1 in PLMN1. In the EHE1, there is a EAS1 deployed by OP1 and a EAS4 deployed by OP2. The EHE2 is operated by OP2 in PLMN2. In the EHE2, there is a EAS2 deployed by OP1 and a EAS3 deployed by OP2.\nThe figure depicts a scenario of EAS relocation from a VPLMN (Virtual Private LAN) to a HPLMN (Hybrid Public LAN) network. The diagram illustrates the steps involved in the relocation process, including the relocation of EAS equipment, the establishment of a new VPLMN, and the integration of the new HPLMN into the existing network. The figure also highlights the importance of proper planning and coordination to ensure a smooth and efficient relocation.\nFigure 6.39.1-1: Scenario of EAS relocation from VPLMN to HPLMN\nThe figure depicts a scenario of EAS relocation from HPLMN to VPLMN, illustrating the process of moving the equipment from one location to another. The diagram shows the various components involved, such as the EAS, HPLMN, VPLMN, and the network infrastructure. The figure provides a visual representation of the steps involved in the relocation process, including the planning, execution, and monitoring of the relocation.\nFigure 6.39.1-2: Scenario of EAS relocation from HPLMN to VPLMN\nThe figure depicts a scenario of EAS relocation between operators via N6, illustrating the process of moving EAS equipment between different operators. The figure shows the various components involved, such as the EAS equipment, the relocation path, and the communication network. The figure provides a visual representation of the complex process of EAS relocation, highlighting the importance of proper planning and coordination to ensure the smooth operation of the communication network.\nFigure 6.39.1-3: Scenario of EAS relocation between operators via N6\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.39.2\tProcedures",
                            "text_content": "The figure depicts the relocation of EAS (Emergency Alert System) from a VPLMN (Virtual Public Land Mobile Network) to a HPLMN (Hybrid Public Land Mobile Network) in a 5G network. The diagram illustrates the process of moving EAS from one location to another, highlighting the need for redundancy and failover mechanisms to ensure the system's reliability.\nFigure 6.39.2.1-1: EAS relocation from VPLMN to HPLMN\n0.\tWhen UE is roaming to VPLMN, it establishes a LBO PDU Session to access the source EAS (EAS2), which is deployed by OP1 in VPLMN (EHE of OP2), e.g. OP1 and OP2 have a federation agreement.\n1.\tWhen the EAS relocation is triggered, AF determines the source EAS should be relocated to the target EAS (e.g. EAS 1) deployed by OP1 in HPLMN (e.g. based on a federation agreement). The AF invokes Nnef_TrafficInfluence_Create or Nnef_TrafficInfluence_Update service operation to send the request message to NEF, or invokes Npcf_PolicyAuthorization_Create or Npcf_PolicyAuthorization_Update to send the request message to the PCF directly. The request message includes the PLMN ID, which indicates the EAS should be relocated to the target PLMN (identified by PLMN ID).\nIf 5GC supports EAS IP replacement mechanism, the EAS IP replacement information (i.e. source EAS IP address and port number, target EAS IP address and port number) is sent to the V-SMF as specified in clause 6.3.3 of TS 23.548 [3]. Alternatively, the AF sends the EAS information (e.g. EAS IP address) to network and to UE via application layer.\n2.\tThe PCF creates and sends the PCC rule to the V-SMF by invoking Npcf_SMPolicyControl_UpdateNotify service operation. The PCC rule includes the PLMN ID.\n3.\tV-SMF discovers the H-SMF.\nIf the V-SMF has knowledge of EAS deployment information in HPLMN, the V-SMF determines the target DNAI based on the EAS deployment information and IP address of target EAS. V-SMF sends the target DNAI to the V-AMF by invoking Nsmf_PDUSession_SMContextStatusNotify service operation. Then, V-AMF selects H-SMF based on the target DNAI. Then, H-SMF sends Nsmf_PDUSession_Context Request to V-SMF.\nAlternatively, the V-SMF sends discovery request to vNRF by invoking Nnrf_NFDiscovery_Request (serving PLMN ID, home PLMN ID), and discovers the H-SMF as specified in clause 4.17.5 in TS 23.502 [9].\n4.\tThe V-SMF inserts or changes the UL-CL/BP V-UPF. The V-SMF sends an inter-PLMN relocation indicator to H-SMF by Nsmf_PDUSession_Update Request. The inter-PLMN relocation is to indicate the EAS is relocated from VPLMN to HPLMN.\n5.\tThe H-SMF selects the H-PSA UPF based on the EAS IP replacement information/EAS information. H-SMF configures the H-PSA UPF for traffic routing towards target EAS. If the EAS IP replacement information is received, the H-SMF configures H-PSA UPF with EAS IP replacement information.\n6.\tThe H-SMF sends the acknowledgement message to the V-SMF, which includes the tunnel information towards H-PSA UPF.\n7.\tWhen V-SMF receives the acknowledgement, V-SMF configures the UL-CL/BP V-UPF for traffic routing towards H-PSA UPF if the destination address is the IP address of source EAS or target EAS.\nThe figure depicts the relocation of EAS (Emergency Alert System) from HPLMN (High-Priority Local Network) to VPLMN (Very-High-Priority Local Network) in a 5G network. The diagram illustrates the process of moving EAS from one network to another, highlighting the need for redundancy and failover mechanisms to ensure the system's reliability.\nFigure 6.39.2.2-1: EAS relocation from HPLMN to VPLMN\n0.\tThe UE establishes PDU Session to access the source EAS (EAS1).\n1.\tWhen the EAS relocation is triggered, AF determines the source EAS should be relocated to the target EAS (e.g. EAS 2) deployed by OP1 in VPLMN (e.g. based on a federation agreement). The AF invokes Nnef_TrafficInfluence_Create or Nnef_TrafficInfluence_Update service operation to send the request message to NEF, or invokes Npcf_PolicyAuthorization_Create or Npcf_PolicyAuthorization_Update to send the request message to the PCF directly. The request message includes the PLMN ID, which indicates the EAS should be relocated to the target PLMN (identified by PLMN ID).\nIf 5GC supports EAS IP replacement mechanism, the EAS IP replacement information (i.e. source EAS IP address and port number, target EAS IP address and port number) is sent to the V-SMF as specified in clause 6.3.3 of TS 23.548 [3]. Alternatively, the AF sends the EAS information (e.g. EAS IP address) to network and to UE via application layer.\n2.\tIf the PCF authorizes the traffic routing in the VPLMN is allowed, the PCF creates and sends the PCC rule to the V-SMF by invoking Npcf_SMPolicyControl_UpdateNotify service operation. The PCC rule includes the PLMN ID.\n3.\tH-SMF discovers the V-SMF.\nIf the H-SMF has knowledge of EAS deployment information in VPLMN, the H-SMF determines the target DNAI based on the EAS deployment information and IP address of target EAS. H-SMF sends the target DNAI to the H-AMF by invoking Nsmf_PDUSession_SMContextStatusNotify service operation. Then, H-AMF selects V-SMF based on the target DNAI. Then, V-SMF sends Nsmf_PDUSession_Context Request to H-SMF.\nAlternatively, the H-SMF sends discovery request to hNRF by invoking Nnrf_NFDiscovery_Request (home PLMN ID, serving PLMN ID), and discovers the V-SMF as specified in clause 4.17.5 in TS 23.502 [9].\n4.\tThe H-SMF inserts or changes the UL-CL/BP H-UPF. The H-SMF sends an inter-PLMN relocation indicator to V-SMF by Nsmf_PDUSession_Update Request. The inter-PLMN relocation indicator is to indicate the EAS is relocated from HPLMN to VPLMN. Optionally, the H-SMF may check with H-UDM whether UE is authorized to access VPLMN.\n5.\tThe V-SMF selects the V-PSA UPF based on the EAS IP replacement information/EAS information. V-SMF configures the V-PSA UPF for traffic routing towards target EAS. If the EAS IP replacement information is received, the V-SMF configures V-PSA UPF with EAS IP replacement information.\n6.\tThe V-SMF sends the acknowledgement message to the H-SMF, which includes the tunnel information towards V-PSA UPF.\n7.\tWhen H-SMF receives the acknowledgement, H-SMF configures the UL-CL/BP H-UPF for traffic routing towards V-PSA UPF if the destination address is the IP address of source EAS or target EAS.\nThe figure depicts the EAS relocation between operators via N6, illustrating the process of moving the Emergency Alert System (EAS) signal from one operator to another. The figure shows the EAS signal, the N6 frequency, and the relocation path, with the signal being moved from one operator to another.\nFigure 6.39.2.3-1: EAS relocation between operators via N6\n0.\tThe UE establishes PDU Session to access the source EAS (EAS1) in PLMN1.\n1.\tWhen the EAS relocation is triggered, AF determines the source EAS should be relocated to the target EAS (e.g. EAS 2 as shown in figure 6.39.1-3) deployed by OP2 in target PLMN2 (e.g. based on a federation agreement). The AF invokes Nnef_TrafficInfluence_Create or Nnef_TrafficInfluence_Update service operation to send the request message to NEF, or invokes Npcf_PolicyAuthorization_Create or Npcf_PolicyAuthorization_Update to send the request message to the PCF directly. The request message includes the PLMN ID, which can be used as an inter-PLMN relocation indicator and indicates the EAS should be relocated to the target PLMN (identified by PLMN ID).\nIf 5GC supports EAS IP replacement mechanism, the EAS IP replacement information (i.e. source EAS IP address and port number, target EAS IP address and port number) is sent to the V-SMF as specified in clause 6.3.3 of TS 23.548 [3]. Alternatively, the AF sends the EAS information (e.g. EAS IP address) to network and to UE via application layer.\n2.\tIf the PCF authorizes the traffic routing in the PLMN1 (serving PLMN) is allowed, the PCF creates and sends the PCC rule to the SMF by invoking Npcf_SMPolicyControl_UpdateNotify service operation. The PCC rule includes the PLMN ID.\n3.\tBased on the received PLMN ID, the SMF can differentiate the EAS deployment information of different PLMNs (the PLMN ID is included in the EAS deployment information) and determine the target DNAI corresponding to PLMN1, and then SMF inserts or changes the PSA UPF that supports target DNAI to access target EAS via controlled IP network. The SMF configures the PSA UPF for traffic routing towards target EAS. If the EAS IP replacement information is received, the SMF configures UPF with EAS IP replacement information.\n4.\tUE accesses the EAS deployed in PLMN2 using PSA UPF via N6.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.39.3\tImpacts on services, entities and interfaces",
                            "text_content": "AF:\n-\tdetermines the target EAS and sends corresponding PLMN ID.\nV-SMF:\n-\tdetermines target DNAI based on EAS information and EAS deployment information;\n-\tsends an inter-PLMN relocation indicator to H-SMF;\n-\tconfigures the UL-CL/BP V-UPF for traffic routing towards H-PSA UPF if the destination address is the IP address of source EAS or target EAS.\nH-SMF:\n-\tdetermines target DNAI based on EAS information and EAS deployment information;\n-\tsends an inter-PLMN relocation indicator to V-SMF;\n-\tconfigures the UL-CL/BP H-UPF for traffic routing towards V-PSA UPF if the destination address is the IP address of source EAS or target EAS.\nPCF:\n-\tauthorizes the traffic routing in the target PLMN is allowed;\n-\tcreates the PCC rule, which includes the PLMN ID.\nH-AMF:\n-\tselects V-SMF based on the target DNAI received from H-SMF.\nEAS Deployment information:\n-\tadding PLMN ID.\nAF:\n-\tdetermines the target EAS and sends corresponding PLMN ID.\nPCF:\n-\tauthorizes the traffic routing in the target PLMN is allowed;\n-\tcreates the PCC rule, which includes the PLMN ID.\nEAS Deployment information:\n-\tadding PLMN ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.40\tSolution 40 (KI#5): EAS discovery for shared EHE",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.40.1\tIntroduction",
                            "text_content": "This solution addresses Key Issue #5 and allows the discovery of an Edge Application Server (EAS) within a set of Operators sharing the EHE. It is assumed that the EAS is hosted by a different PLMN than the PLMN that is serving the UE, and the two PLMNs have IP connection at edge area.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.40.2\tFunctional description",
                            "text_content": "In this solution description, it is assumed that the EAS is deployed in MNO2's PLMN2 and that the UE is connected to MNO1's PLMN1 (see figure 6.40.2-1). The solution is based on the following two steps:\nStep 1: Configuration phase\nThe MNO2 AF provides the DNS query filtering information for PLMN2 EHE as well as the EASDF Deployment information for PLMN2 described in table 6.40.2-1 to EASDF1 in PLMN1 before the PDU Session establishment.\nStep 2: After PDU Session establishment\nWhen a DNS query from UE is intended for a specific application at edge, but EASDF1 in PLMN1 finds that the application cannot be found in current PLMN1's edge platform but can be found in PLMN2's DNS query filtering information, the EASDF1 will send (UE IP address, DNS handling rule) created by SMF1 to the selected EASDF2 through SEPP through control plane. Then, EASDF1 forwards the DNS Query message to EASDF2 through user plane. EASDF2 then sends the DNS query to DNS server in PLMN2 for EAS discovery.\nDNS query filtering information includes the PLMN2's supported EAS FQDN(s).\nThe EASDF2 is selected by EASDF1 based on UE location, EASDF2 serving area, EDI information for PLMN2 EHE, and the N6 Transmission requirement.\nEASDF1 sends DNS query to EASDF2 through user plane. The DNS query is transmitted in the path of EASDF1→UPF1→UPF2→EASDF2. The UPF1 and UPF2 are locally configured to support the DNS message transmission between two PLMNs.\nThe indication of supporting shared EAS discovery will be included in UE SM subscription data. SMF1 gets this information from UDM1 during the PDU Session establishment. SMF1 may select the proper UPF(s) to support the DNS message transmission via two PLMNs. The UPF(s) in PLMN1which support access to PLMN2 domain, may support to add DSCP value in IP layer to guarantee the transmission between two PLMNs.\nMNO2 AF may create an External Group ID to show that these UE(s) support the interaction between different PLMNs.\nThe figure depicts a complex telecommunication architecture, specifically focusing on the Operator Platform. It illustrates the various components and their interconnections, including the Operator Platform, which is a crucial component for managing and controlling the network. The Operator Platform is responsible for managing the network, ensuring its smooth operation, and providing a user-friendly interface for network operators. The figure also highlights the importance of redundancy in the network, as it is shown with multiple paths and redundant paths, ensuring that the network can continue to function even if one path is compromised. Overall, the figure provides a comprehensive overview of the Operator Platform's role in the telecommunication network.\nFigure 6.40.2-1: Architecture with Operator Platform\nEASDF Deployment Information\nEASDF1 finds EASDF2 based on EASDF Deployment Information (EDI) information including UE location, serving area of EASDF2 in PLMN2, N6 transmission requirement of PLMN2.\nTable 6.40.2-1: EASDF Deployment Information\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.40.2-1: EASDF Deployment Information",
                                    "table number": 12,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.40.3\tProcedures",
                            "text_content": "The figure depicts a shared EAS scenario, where EAS discovery is performed by the EAS server. The EAS server is responsible for identifying and locating EAS devices, which are typically located in the vicinity of the EAS receiver. The figure shows the EAS server's interface, which includes a user interface for EAS discovery, a database for storing EAS information, and a server for processing EAS data. The figure also includes a diagram of the EAS receiver, which is responsible for receiving and processing EAS data. The EAS server is connected to the EAS receiver via a network, and the network is designed to ensure reliable communication and data transfer.\nFigure 6.40.3-1: EAS discovery in shared EAS scenario\n1.\tSteps 1-6 are the same as EAS discovery procedure in clause 6.2.3.2.2 of TS 23.548 [3].\n2.\tUE sends DNS query to EASDF1.\n3.\tIf EASDF1 finds the DNS Query message cannot be resolved by PLMN1's DNS server, but matches a PLMN2's FQDN(s) information, EASDF1 sends the DNS Query Message to SMF with providing indication that EASDF2 in PLMN2 should be selected.\nNOTE:\tWhen EASDF receives multiple DNS Query messages from one UE, if EASDF detects that these DNS Query messages are the same, EASDF will only send the Neasdf_DNSContext_Notify Request once to SMF for these DNS Query messages.\n4.\tThe SMF responds with Neasdf_DNSContext_Notify Response.\n5.\tEASDF1 invokes Neasdf_DNSContext_Create Request (UE IP address, PLMN1 ID, notification endpoint, (DNS message handling rules)) to the selected EASDF2 in PLMN2.\nThe EASDF2 creates a DNS context for the PDU Session and stores the UE IP address, PLMN1 ID, notification endpoint, (DNS message handling rules) into the context.\nThe DNS handling rule is created by SMF and redirected to EASDF1 and EASDF1 sends this to EASDF2. In this handling rule, option A is used to forward the DNS message with the EDNS Client Subnet option that is updated to UE location information. Option B is not supported since the EASDF1 does not have DNS address in PLMN2.\n6.\tThe EASDF2 invokes the service operation Neasdf_DNSContext_Create Response.\n7.\tEASDF1 sends DNS query to EASDF2 through user plane. The DNS query may pass though UPF1 which is able to access UPF2 in PLMN2. The DSCP value can be added by UPF1 in DNS query IP layer to satisfy transmission requirement with low latency between two PLMNs.\n8-9.\tThe same as steps 12-13 in clause 6.2.3.2.2 in TS 23.548 [3].\n10.\tEASDF2 returns DNS response (EAS IP address or FQDN) to EASDF1.\n11-12.\tThe same as steps 14-15 in clause 6.2.3.2.2 in TS 23.548 [3].\n13.\tThe SMF may perform UL-CL/BP and Local PSA selection and insert UL-CL/BP and Local PSA.\n14-16.\tThe same as steps 17-19 in clause 6.2.3.2.2 in TS 23.548 [3].\nDuring PDU Session Release procedure, the SMF triggers the removal of the DNS context by invoking Neasdf_DNSContext_Delete service from EASDF1 to EASDF2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.40.4\tImpacts on existing entities and interfaces",
                            "text_content": "EASDF:\n-\tenhanced to support to communicate with EASDFs in other PLMN to transform DNS handling rule and related information;\n-\tneeds to be configured with EASDF Deployment information to discover other PLMN's EASDF.\nUDM:\n-\tUE authorization for EAS discovery via other PLMN's EASDF.\nUPF:\n-\tenhanced to support the addition of N6 Transmission requirement (e.g. DSCP) into IP-layer to ensure low latency.\nAF:\n-\tcan configure other PLMN's DNS query filtering information and EASDF deployment information in serving PLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.41\tSolution 41 (KI#6): Controlling non-3GPP access of EC traffic via URSP and ATSSS",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.41.1\tHigh level description",
                            "text_content": "If a network is to apply EC-related functionality such as providing connectivity to the edge for all or part of the traffic for a given PDU Session, and the EC-related functionality requires specific consideration of traffic steering to the non-3GPP access, then the network re-configures the URSP rules in the UE for the RDS corresponding to the EC traffic. Examples of useful URSP rules:\n-\tsetting the Access Type Preference to \"3GPP\" for the given EC traffic descriptors, DNN and S-NSSAI. This will result in setting up the PDU Session carrying the EC traffic on the 3GPP access.\n-\tsetting the Access Type Preference to \"Multi-access\" for the given traffic descriptors, DNN and S-NSSAI.\nThe latter is used when a refined control of traffic steering over the 3GPP and non-3GPP accesses is needed, based on appropriate ATSSS rules for the PDU Session provided by the network (SMF). Examples of useful ATSSS rules to control steering EC traffic to non-3GPP access (see clause 5.32.8 of TS 23.501 [2]):\n-\tSteering Mode=Active-Standby, Active=3GPP & no Standby (octet f+4=0000001): it results in steering the related traffic within the PDU Session (described by the traffic descriptors) always to the 3GPP access;\n-\tSteering Mode=Load Balancing allows for using a the non-3GPP access based on latency and loss thresholds.\nNOTE 1:\tSMF may change the access network over which the traffic of a GBR QoS flow is transmitted, and in this way it can both select the access for this QoS flow and provide bandwidth guarantees.\nThe solution may be applied for all connectivity models.\nNOTE 2:\tHow the URSP settings interact with built-in UE policies or user preferences to influence the UE's decision to use connectivity outside of 5GC is out of scope.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.41.2\tProcedures",
                            "text_content": "For Multiple Sessions and Distributed Anchor connectivity models, the existing procedures are applicable, where the following options may be used:\n-\tthe URSP rules and ATSSS rules are configured in the UE before or during the setup of the PDU Session, if the corresponding non-3GPP access related policies are already available;\n-\tif the URSP rules are dynamically updated (based on Application guidance for URSP determination clause 4.15.6.10 in TS 23.502 [9]) while some EC traffic is ongoing on a PDU Session, the updated rules might not be enforced by the UE immediately for this traffic, but they will be applied for any application traffic that will start later. Updating the URSP rules requires SMF notification towards the UE PCF.\nFor the Session Breakout scenario, only the 3GPP access should be allowed for the EC traffic, because the UL-CL is reachable only through that access, since there are no ATSSS procedures that would ensure that an UL-CL can be on path when the UE connects through a non-3GPP access. Based on the received EC related policy and deployment information the SMF may, however, select an UL-CL based on existing procedures if the UE connects through a 3GPP access. One simple solution to keep the EC traffic to 3GPP access is to set the Access Type Preference to \"3GPP\" in the corresponding URSP rule for this PDU Session. To avoid other, non-EC traffic be constrained to the 3GPP access, WIFI offload can be setup for that traffic using the \"Non-Seamless Offload indication\" as route selection in the corresponding URSP rule. An example URSP rule set is given in table 6.41.2-1. Note that the traffic descriptors in the URSP rules may need to be updated, e.g. based on AF Application guidance for URSP determination, resulting that the updated URSP rules might not be immediately enforced for some ongoing traffic.\nTable 6.41.2-1: Example URSP rules to restrict EC traffic to 3GPP access in the Session Breakout model\n\nA specific case in the Session Breakout model is when the EC traffic shares the PDU Session with other traffic that requires traffic steering based on ATSSS. In that case the Access Type Preference in the URSP rule for this traffic is set to \"Multi-access\", based on which the UE sets up a MA PDU Session for this DNN and S-NSSAI on all available accesses. The MA PDU Session is set up to a C-PSA, where the ATSSS functionality is applied for the non-EC traffic. The SMF configures ATSSS rules for the EC traffic (identified by Application ID or IP ranges in route descriptors) that steer the traffic always to the 3GPP access (using Steering Mode=Active-Standby, see clause 6.41.1). Other traffic may be allowed to be offloaded to WIFI by URSP rules as described above.\nFor Dynamic PSA distribution using EASDF, URSP rules could be set similarly as for the Session Breakout Scenario, see table 6.41.2-1, assuming that the PCF knows the traffic descriptors of the EC applications. Further flexibility for the EC applications may be achieved by using the ATSSS rules. An example solution based on ATSSS rules is depicted in the generic figure below:\nThe figure depicts a solution for controlling non-3GPP usage for Dynamic PSA distribution, which is a crucial aspect of ATSSS (Automatic Traffic System Services) in the context of 4G and 5G networks. The solution involves the use of ATSSS, which stands for Automatic Traffic System Services, to manage the distribution of Dynamic PSA services. This solution ensures that the services are only used by authorized users and does not interfere with 3GPP-compliant services. The figure shows the various components involved in the ATSSS solution, such as the ATSSS controller, the Dynamic PSA service, and the network infrastructure. The figure also highlights the importance of proper network management and control to ensure the smooth operation of the ATSSS system.\nFigure 6.41.2-1: ATSSS solution for controlling non-3GPP usage for Dynamic PSA distribution\n1.\tUE sets up a PDU Session. The session is initially set up to a C-PSA and the URSP rules in the UE need not contain any constraints related to non-3GPP usage. The UE may indicate in the session establishment message its ATSSS capability and that \"MA-PDU Network upgrade allowed\" for this PDU Session, which can help selecting an ATSSS capable SMF for this PDU Session. SMF creates/updates the EASDF context for this PDU Session.\n2.\tA DNS query for the EAS discovery from the UE APP triggers dynamic PSA change in the SMF.\n3.\tSMF initiates a PDU Session modification or PDU Session release depending on the SSC Mode selected.\n4.\tThe UE initiates a PDU Session establishment, where the UE indicates in the session establishment message its ATSSS capability and that \"MA-PDU Network upgrade allowed\" for this PDU Session. The SMF (that may be a new SMF that receives indication to provide connectivity to the edge from the AMF in the form of a DNAI) selects an edge UPF (L-PSA), and it provisions the DNS settings in the UE, as described in clause 6.2.2.4 of TS 23.548 [3]. The SMF also upgrades the session to a MA PDU Session, based on related policy rules that may be received from the PCF. If UE is registered to non-3GPP access, then the UE initiates a MA PDU Session establishment also on this leg. Otherwise, it initiates another MA PDU Session establishment when it connects to the non-3GPP.\n5.\tSMF configures ATSSS rules for this MA PDU Session that will define how the different accesses may be used by the EC application.\n6.\tUE starts applying the ATSSS rules for this PDU Session. The EC application traffic will be routed to the EAS through the L-PSA from either allowed access.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.41.2-1: Example URSP rules to restrict EC traffic to 3GPP access in the Session Breakout model",
                                    "table number": 13,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.41.3\tImpacts on services, entities and interfaces",
                            "text_content": "UE:\n-\tURSP support, and (conditionally, if ATSSS rules apply) ATSSS support.\nNOTE 1:\tIt is expected that the UE supports the URSP rules for non-seamless offload as specified in clause 6.1.2.2.1 of TS 23.503 [13].\nSMF:\n-\t(conditionally, if dynamic update to URSP rules apply) notification towards the UE PCF about the EC traffic handling that may be mediated by SM PCF.\nNOTE 2:\tIt is expected that the SMF supports the procedure for EAS discovery in the Session Breakout model as described in TS 23.548 [3] also for the MA PDU Sessions with 3GPP access.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.42\tSolution 42 (KI#6): Network-guided EC traffic switching",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.42.1\tGeneral",
                            "text_content": "The KI#6 deals with the scenario where Edge computing enablers cannot be served to the UE when the UE has taken a decision to switch application traffic to a route that is not integrated with MNO. In a typical scenario, UE considers multiple inputs before choosing the best of the available routes for application traffic. The range of inputs include user and application preferences, power consumption status of the UE, delay status in both routes, server loading status, etc.\nWhen the 5G connectivity offers additional benefits for edge computing traffic, this information will be critical to the UE before making the decision to switch away traffic that is benefitting from MNO's edge deployments.\nThis solution assumes that the EAS is also reachable via Internet, and that the UE application is aware of this and that the UE would not switch the traffic away from 3GPP access if it is not the case.\nThe current edge enablers in 5G network are often not visible to the UE. For example, a UE does not know if the application traffic is being carried over a PDU Session that has access to edge data centre. Similarly, whether a PDU Session has a UL-CL and L-PSA inserted for local routing of certain application traffic is not known to the UE. This information is foreseen as an important parameter that UE should consider before deciding on which access to use for certain application traffic, when all other things are equal.\nIn the URSP rules today, there is only a possibility to indicate if a given traffic can be offloaded to WLAN. The presence of the route selection component \"Non-Seamless Offload indication\" in a Route Selection Descriptor and the priority of the Route selection descriptor for a URSP rule informs UE when the corresponding traffic can be offloaded to a non-integrated non-3gpp access.\nHowever, this method is a static guidance on whether traffic can be routed over non-integrated path corresponding to the priority of the RSD.\nFor edge computing traffic, whether the network is currently offering any of the edge optimized routing in the network is an aspect that varies dynamically. To enable the UE to make an informed decision, additional evaluations may be required according to the current nature of traffic routing.\nThe URSP information can provide a static guidance to the UE, so that it evaluates the use of edge enablers at the time when traffic switching is decided. A new route selection component in the Route Selection Descriptor is introduced for this purpose.\nTable 6.42.1.3-1: Addition to table 6.6.2.1-3 of TS 23.503 [13]: Route Selection Descriptor\n\nThe conditions for switching the traffic are dynamic indications that the network provides to the UE.\nDynamic conditions are indicated to the UE using the following information.\nFirst one is an indication that network is using any of the edge enablers for the SDF corresponding to the edge application. This could be for example, the use of L-PSA providing access to an EAS in a local Edge Hosting Environment or a UL-CL with traffic offload in a session break-out model.\nThe second component of dynamic condition is a configuration to measure latency experienced by the Edge application. For an application, one of the most important benefits of connecting to an Application Server in edge hosting environment is latency. When the UE has alternate paths to reach an application server, it would be an important parameter to measure the round-trip time for these alternate paths. During the PDU Session establishment/modification, the network configures the UE with necessary measurement configuration to do an RTT measurement (similar to the performance measurement for ATSSS) to the EAS in Edge Hosting environment. The UE triggers measurement on the cellular path and evaluates RTT on alternate paths before deciding which one should be selected to meet applications' requirement.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.42.1.3-1: Addition to table 6.6.2.1-3 of TS 23.503 [13]: Route Selection Descriptor",
                                    "table number": 14,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.42.2\tProcedures",
                            "text_content": "The following call flow illustrates the procedure for traffic offload guidance.\nThe figure depicts a network guided EC traffic switching scenario, where EC traffic is guided through a network of switches to ensure efficient routing and prioritization. The figure shows a network with multiple EC switches, each responsible for routing EC traffic to the appropriate destination. The switches are interconnected, allowing for efficient traffic switching and routing. The figure also includes a visual representation of the EC traffic flow, showing how EC traffic is routed through the network. Overall, the figure provides a clear and concise representation of network guided EC traffic switching in a 42.21.1 network.\nFigure 6.42.2 1: Network guided EC traffic switching\n1.\tThe UE evaluates URSP rules on receiving an application PDU.\n2.\tThe UE triggers a PDU Session Establishment/Modification request to carry the application traffic.\n3.\tThe SMF fetches appropriate SM Policies for adding this SDF to a QoS Flow. This may also need insertion of UL-CL/BP for the UE. SMF requests UPF to perform RTT measurements to Application Server. The Application Server information for RTT measurement is provided by the AF as part of TrafficInfluence rules.\n4.\tSMF sends PDU Session Establishment Accept or Modification Command to the UE. If UE is configured with edge enablers (e.g. L-PSA or UL-CL/BP) for any traffic carried in this PDU Session, SMF includes an \"EC indication\" marked per SDF. In this message, SMF also includes performance measurement rules applicable for this SDF, measured RTT value between UPF and Edge Application Server, Traffic offload rule. The traffic offload rule can be either an absolute threshold or factor by which non-3GPP RTT shall be better than 3GPP RTT before UE offloads traffic.\n5.\tUE detects availability of an alternate non-3GPP path that is suitable for this application traffic.\n6.\tUE performs RTT measurement in the UE-UPF path over 3GPP link.\n7.\tUE computes the aggregate RTT on the 3GPP path as the sum of measured RTT on UE-UPF link and the UPF-AS RTT indicated by the SMF.\nNOTE:\tThe RTT between UPF and an application server in Edge Hosting Environment is considered as a static component of the overall RTT.\n8.\tUE performs RTT computation between UE and the Application Server over the non-3GPP link.\n9.\tUE applies the network provided traffic offload rule provided by the network to the decision matrix for traffic offload.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.42.3\tImpacts to existing nodes",
                            "text_content": "SMF:\n-\tprovides an EC indication per SDF if any edge enablers are configured for the traffic;\n-\tprovides RTT measurement rules to the UE, instructs UPF for RTT measurement to the AS.\nPCF:\n-\tprovides \"WLAN Offload guidance\" as part of RSD in URSP rules for a traffic descriptor that may be subject to dynamic evaluation of edge performance prior to traffic offload;\n-\tprovides SM Policy rules with information for UPF-AS RTT measurement to the SMF.\nUPF:\n-\tperforms UPF-AS RTT measurements;\n-\tenables UE-UPF performance measurements.\nUE:\n-\tunderstands the URSP rules with traffic offload guidance;\n-\tperforms performance measurement and applies the results according to the configured traffic offload rules.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.43\tSolution 43 (KI#6): Network-based solution for keeping EC traffic on 3GPP Access",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.43.1\tDescription",
                            "text_content": "When UE has several available access types in the UE location, the UE may switch from 3GPP access to non-3GPP access; for example, at home, the non-3GPP usually has better performance or non-3GPP has higher priority than 3GPP access.\nBut for the EC traffic on UE, if the traffic is switched from 3GPP access to non-3GPP access, the EC features might not be maintained, for example, the N3IWF is located in the central, and the traffic should be routed to central PSA and routed back to EAS in the local area.\nOne of the solutions is, when UE triggers PDU Session establishment using the PDU Session ID of EC traffic towards 5GC in non-3GPP access, the 5GC can judge this PDU Session is an EC PDU Session, and rejects the PDU Session establishment request. So, the UE can keep the EC PDU Session to not switched to non-3GPP access, and still use this EC PDU Session to communicate with EAS via 3GPP access.\nNOTE:\tThis solution applies to the situation of 5GC controlled non-3GPP access procedure, also called integrated non-3GPP.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.43.2\tProcedures",
                            "text_content": "The figure depicts a network-based solution for keeping EC traffic on 3GPP Access, highlighting the use of 3GPP Access as the primary access method for EC traffic. The solution includes the use of 3GPP Access, which is a standard for mobile network access, and 3GPP Access Core, which is a core component of the network. The figure also shows the use of 3GPP Access Core, which is a core component of the network, and 3GPP Access, which is a standard for mobile network access. The figure also shows the use of 3GPP Access Core, which is a core component of the network, and 3GPP Access, which is a standard for mobile network access. The figure also shows the use of 3GPP Access Core, which is a core component of the network, and 3GPP Access, which is a standard for mobile network access. The figure also shows the use of 3GPP Access Core, which is a core component of the network, and 3GPP Access, which is a standard for mobile network access. The figure also shows the use of 3GPP Access Core, which is a core component of the network, and\nFigure 6.43.2.1-1: Network-based solution for keeping EC traffic on 3GPP Access\n1.\tIf the UE is not registered via non-3GPP access, the UE shall initiate Registration procedure as defined in clause 4.12.2 (untrusted non-3GPP access) of TS 23.502 [9] or as defined in clause 4.12a.2.2 of TS 23.502 [9].\n2.\tThe UE performs PDU Session Establishment procedure in non-3GPP Access with the PDU Session ID of the PDU Session to be moved as specified from step 1 to step 2a in clause 4.12.5 of TS 23.502 [9] or in clause 4.12a.5 of TS 23.502 [9]. At this stage, the PDU Session ID includes both the EC PDU Session to EAS and non-EC PDU Session to non-EAS.\nThe UE can have an indication of the preference of whether the some of the PDU Sessions should be switched to non-3GPP access or not, to 5GC, essentially the PDU Session ID of EC PDU Session towards EAS. There exists the situation that user's preference is to access non-3GPP, and not to keep the EC PDU Session at 5GS.\n3.\tThe SMF receives the PDU Session establishment request from UE, that includes multiple PDU Session IDs. The SMF can identify the PDU Session is EC or non-EC, according to PDU Session ID. Also, SMF can identify the PDU Session is EC or non-EC PDU, according to the PDU Session parameters that PDU Session ID refers to, that helps SMF to identify whether it is EC PDU Session or not:\n-\tS-NSSAI: The SMF identifies the whether the S-NSSAI the PDU Session access is local or not.\n-\tDNN: The SMF identifies the whether the DNN the PDU Session selects is local or not.\n-\tPSA IP address: The SMF checks the PSA IP address that serves the UE, and decides whether the PSA IP address is located in the IP range of local area or local data network.\n4.\tAccording to the PDU Session ID, the PDU Session parameters that PDU Session ID and user's preference, the SMF may reject the PDU Session establishment request, if:\n-\tPDU Session ID represents an EC PDU Session;\n-\tthere is no user preference of whether the EC PDU Session switch from 3GPP access to non-3GPP access towards the EC PDU Session.\nThe SMF sends the rejection of the PDU Session ID that EC PDU Session refers to, to UE via NAS message. The reason of rejection in NAS message is: the PDU Session over non-3GPP Access is not allowed.\nAfter UE receives the rejection, the UE can keep the EC PDU Session on 3GPP access which the rejection of PDU Session ID refers to in the NAS message.\nIn study of Rel-18 FS_AIMLsys, the UE obtaining the NWDAF analytics is discussed and the UE can acquire the analytics from NWDAF via DCAF or NAS messages.\nIn Rel-17, the NWDAF can provide the analytics of service experience in both 3GPP Access and non-3GPP Access according to the table 6.4.3-1 of TS 23.288 [19].\nTable 6.43.2.2-1: Service Experience statistics (Referred to table 6.4.3-1 of TS 23.288 [19])\n\nAlso, the NWDAF can provide WLAN performance in certain area or under certain SSID as indicated in table 6.11.3-1 of TS 23.288 [19].\nThe performance of different Access mode includes: QoS flow Bit Rate, QoS flow Packet Delay, Packet retransmission, UL/DL data rate, etc.\nWhen UE obtains the analytics above from NWDAF in certain UE location and time range, the UE can decide whether to handover the EC-PDU Session from 5GC to non-3GPP access according to the performance. For example, if in the certain UE location and time, the EC-PDU Session in 3GPP Access has better performance than the non-3GPP Access, for example, the lower packet loss and higher UL/DL data rate, the UE can decide to not handover the EC-PDU Session to non-3GPP Access, and vice versa.\nThe figure depicts a network-wide solution for maintaining EC traffic not being handed over to non-3GPP Access, utilizing NWDAF (Network Wide Dynamic Access Facade) technology. The solution includes a combination of network-wide access control, network-wide traffic management, and network-wide traffic steering. This ensures that EC traffic is not handed over to non-3GPP Access, while also managing the traffic in a way that minimizes handover and maximizes network efficiency.\nFigure 6.43.2.2-1: NWDAF based solutions for keeping EC traffic not handover to non-3GPP Access\n1.\tIf the UE is not registered via non-3GPP access, the UE shall initiate Registration procedure as defined in clause 4.12.2 (untrusted non-3GPP access) of TS 23.502 [9] or as defined in clause 4.12a.2.2 of TS 23.502 [9].\n2.\tUE obtains the analytics from NWDAF. The Analytic ID includes Service Experience, WLAN Performance. After UE obtains the analytics from NWDAF, the UE can receive both of the performance under 3GPP Access and non-3GPP Access in certain UE location and time range, for example, the QoS flow Bit Rate, QoS flow Packet Delay, Packet retransmission, UL/DL data rate, etc.\n3.\tUE compares the performance between 3GPP Access and non-3GPP Access of a certain EC PDU Session.\n4.\tIf the UE decides that an EC PDU Session established in 3GPP Access has better performance than non-3GPP Access, the UE decides to not handover this PDU Session from 3GPP Access (for example, 5GS) to non-3GPP Access. If the PDU Session established in 3GPP Access has worse performance than non-3GPP Access, the PDU Session ID which the PDU Session referred to should be selected out, and to be used in step 5, to handover to non-3GPP Access to acquire better performance.\n5.\tThe UE performs PDU Session Establishment procedure in non-3GPP Access with the PDU Session ID selected by UE in step 4 of the PDU Session to be moved as specified from step 1 to step 2a in clause 4.12.5 of TS 23.502 [9] or in clause 4.12a.5 of TS 23.502 [9].\nAt this stage, the PDU Session which has worse performance in non-3GPP Access should not be included in the PDU Session Establishment procedure.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.43.2.2-1: Service Experience statistics (Referred to table 6.4.3-1 of TS 23.288 [19])",
                                    "table number": 15,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.43.4\tImpacts on services, entities and interfaces",
                            "text_content": "UE:\n-\tprovides the user's preference in NAS messages which access type are preferred or whether the PDU Session is expected to switched to non-3GPP or not.\nSMF:\n-\taccording to the user's preference and the PDU Session ID, the SMF identifies the EC PDU Session and rejects the PDU Session establishment request from UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.44\tSolution 44 (KI#6): EAS traffic switching avoidance",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.44.1\tDescription",
                            "text_content": "This solution addresses Key Issue #6: Avoiding UE to Switch away from EC PDU Session.\nThis solution considers a scenario where a UE discovers an EAS with assistance of 5GC and uses a PDU Session for the data traffic exchange between application in the UE and the discovered EAS. When non-integrated connectivity becomes available for the UE, the UE connectivity setting (e.g. WiFi is on) may induce that the data traffic for the EAS is switched from the PDU Session to other session associated to the connectivity which is outside of 5GS. Then, local access via UL-CL/BP and local PSA to the EAS cannot be supported for the UE. To prevent this, 5GC may indicate to the UE that the traffic for EAS discovered via 5GC assistance (e.g. with EASDF) shall not be switched away from the PDU Session to other session associated to the access (e.g. non-integrated Wi-Fi) that is not integrated with 5GS even if the non-integrated connectivity becomes available for the UE. Such indication is based on the UE subscription information and delivered by the SMF during the establishment procedure for the PDU Session to which the EAS traffic is mapped. Additionally, the UE needs to support a capability to prevent switching away the EAS traffic according to the indication from the SMF.\nIn this regard, this solution proposes a procedure to address the following aspects: (i) how to determine what EAS traffic is targeted for avoidance of switching away from the 5GS for edge computing service and (ii) how to indicate to UE such determination and the related information for the targeted application traffic in order to prevent from switching away from the PDU Session used for edge computing when connectivity outside 5GS (e.g. non-integrated Wi-Fi) becomes available.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.44.2\tProcedures",
                            "text_content": "The figure depicts the EAS traffic switching information provisioning process during PDU Session Establishment, illustrating the flow of data between the EAS and the network. The figure shows the various stages of the process, including the EAS receiving the PDU, processing the data, and sending it to the network. The figure also includes a flow chart to illustrate the steps involved in the process.\nFigure 6.44.2-1: EAS traffic switching information provisioning during PDU Session Establishment\n1-2.\tDuring the PDU Session Establishment procedure, UE may indicate to the SMF its capability to support the EDC functionality and to control application traffic switching via PCO.\n3.\tThe SMF invokes Nudm_SDM_Get to retrieve the UE subscription information from the UDM.\n4.\tThe UDM provides the SMF with the UE subscription information that may include an indication on UE authorization for EAS discovery via EASDF and EAS traffic switching information. The EAS traffic switching information indicates that the traffic for EAS discovered via 5GC assistance (e.g. with EASDF) shall be delivered over 5GS access without being switched away from the PDU Session to other session associated to the access that is not integrated with 5GS (e.g. non-integrated Wi-Fi) even if the non-integrated connectivity becomes available for the UE.\n5.\tThe SMF selects an EASDF and perform DNS context creation at the selected EASDF.\n6-7.\tThe SMF may decide to indicate to the UE either that the use of the EDC functionality is allowed for this PDU Session or that the use of the EDC functionality is required for this PDU Session. If the UE subscription information retrieved in step 4 includes EAS traffic switching information, the SMF indicates to UE that EAS traffic switching control is required via AMF (by invoking Namf_Communication_N1N2MessageTransfer service) as follows:\n-\tIf the SMF decides to indicate that EDC functionality is allowed, the SMF indicates that EAS traffic switching control is required for the traffic of the application(s) that is mapped onto the PDU Session and explicitly requests the use of the EDC functionality.\n-\tIf the SMF decides the use of EDC functionality is required for the PDU Session, the SMF indicates to UE that EAS traffic switching control is required for all the traffic of the application mapped onto the PDU Session.\n-\tIf the UE does not indicate its capability to support EDC functionality (i.e. does not support EDC functionality), the SMF indicates to UE that EAS traffic switching control is required for all the traffic of applications that are mapped onto the PDU Session and whose DNS resolution is performed via EASDF.\n8.\tAfter the successful PDU Session Establishment, the UE informs upper layer with the EAS traffic switching information indicated by the SMF in step 6-7.\nThe UE performs EAS traffic switching avoidance for the application traffic associated to the PDU Session and indicated by the SMF as follows:\n-\tWhen the connectivity that is not integrated with 5GS becomes available, the UE keeps the 5GS connectivity for the established PDU Session and does not perform the switching the traffic away from the PDU Session for the following application(s):\n-\tapplication(s) that explicitly requests the use of the EDC functionality if the SMF indicates that EDC functionality is allowed and that EAS traffic switching control is required for the traffic of the application(s) that is mapped onto the PDU Session;\n-\tall the applications that are mapped onto the PDU Session and of which traffic is transmitted over the PDU Session if the SMF indicates the use of EDC functionality is required for the PDU Session;\n-\tapplication(s) that are mapped onto the PDU Session and of which DNS resolution is performed via EASDF if the UE does not support EDC functionality and if the SMF indicates that EAS traffic switching control is required.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.44.3\tImpacts on existing entities and interfaces",
                            "text_content": "UE:\n-\tindicates to the SMF its capability to control application traffic switching via PCO;\n-\tperforms EAS traffic switching avoidance for the application traffic based on the information provided by SMF.\nUDM:\n-\tprovides SMF with an indication on UE authorization for EAS traffic switching information.\nSMF:\n-\tdetermines to indicate UE that EAS traffic switching control.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.45\tSolution 45 (KI#1, KI#6): Application selected PDU Session",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.45.1\tDescription",
                            "text_content": "This solution addresses KI#6: Avoiding UE to switch away from EC PDU Session. This solution also addresses some parts of KI#1: Accessing EHE in a VPLMN when roaming.\nThis solution is based on the existing functionalities in smartphones which allows a UE application to ignore the UE OS preference on preferred connectivity (3GPP vs non-integrated Wi-Fi). The UE Application will instead decide which connectivity (PDU Session) to be used regardless if for example Wi-Fi will become available or not. In current smartphones, the UE application can either use UE OS Preference for data connectivity and then the UE OS will automatically select the \"best\" connectivity when they become available. Alternatively, the UE Application selects a specific network interface, which corresponds to a specific PDU Session. In this case, the UE Application will always use that network interface regardless of other applications or if the UE OS connectivity preference is changing. When the UE Application has selected a specific network interface (PDU Session) then the smartphone supports the exposure of the operator provided DNS Server for that network interface. In this solution, the UE Application should discover EAS from the EASDF according to existing procedure and in addition, use the same PDU Session for all edge related connectivity, not only for the DNS Query as specified in clause 5.2 of TS 23.548 [3]$.\nNOTE:\tThis solution is applicable when the UE Application is aware that the UE Application uses an EC service.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.45.2\tProcedures",
                            "text_content": "The figure depicts a procedure for selecting a PDU session in an application selected PDU (Application Selected PDU) session. The figure shows a flowchart with various steps, such as selecting the PDU, setting the session type, and selecting the session type. The steps are numbered and labeled, making it easy to follow the process. The figure also includes a legend to help understand the different options available for selecting the PDU session. Overall, the figure provides a clear and concise guide for selecting a PDU session in an application selected PDU session.\nFigure 6.45.2-1: Procedure for Application selected PDU Session\n1.\tExisting PDU Session establishment procedure according to step 1 in clause 6.2.3.2.2 of TS 23.548 [3] where the SMF indicates to the UE that this PDU Session is to be used for the EDC functionality.\n2.\tThe UE Application selects the appropriate network interface for all edge related communication to be used as long as it is available.\n3.\tThe UE Application uses the selected network interface for the EAS Discovery and Re-discovery as specified in clause 6.2.4 of TS 23.548 [3].\n4.\tThe UE application uses the selected network interface for all communication to the EAS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.45.3\tImpacts on services, entities and interfaces",
                            "text_content": "UE:\n-\tThe UE Application is expected to select a specific network interface for all edge related communications.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.46\tSolution 46 (KI#6): Avoid UE switching on-going EC traffic away from 3GPP access",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.46.1\tDescription",
                            "text_content": "As described in clause 5.6.2, the existing edge computing enablers cannot be used if the UE switches to an access that is not integrated with 5GS or does not provide the expected characteristics. The on-going EC traffic in a PDU Session may suffer an interruption or a bad user experience due to long UP path. This solution avoids UE switching the on-going EC traffic away from 3GPP access.\nNOTE:\tThis solution applies to options A and B as described in TS 23.548 [3].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.46.2\tProcedure",
                            "text_content": "Figure 6.46.2-1 shows the call flow of avoiding UE switching on-going EC traffic away from 3GPP access.\nThe figure depicts a network scenario where a UE (User Equipment) is switching EC (Enhanced Customer) traffic away from the network. This is a common practice in 5G networks to improve network performance and reduce congestion. The figure shows the UE's signal strength and the EC traffic, indicating the importance of maintaining a balanced network.\nFigure 6.46.2-1: Avoid UE switching EC traffic away\n1.\tUE establishes a PDU Session as defined in clause 4.3.2.2.1 of TS 23.502 [9].\n2.\tUE sends DNS query including FQDN to EASDF.\n3.\tEASDF reports the FQDN to the SMF.\n4.\tThe SMF determines the FQDN corresponds to EC service based on EAS deployment information as described in clause 6.2.3.4 of TS 23.548 [3]. The SMF initiates PDU Session Modification procedure.\n5.\tThe SMF sends PDU Session Medication Command including an indicator that it requests the UE to avoid switching traffic corresponding to the FQDN away from the 3GPP access.\nBased on the received indicator, the UE shall avoid switching away the on-going traffic corresponding to the FQDN away from the 3GPP access even though non-3GPP access is available and has a higher priority than 3GPP access.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.46.3\tImpacts on services, entities and interfaces",
                            "text_content": "SMF:\n-\tsends an indicator to UE by initiating PDU Session Modification procedure.\nUE:\n-\tavoids switching on-going EC traffic corresponding to the FQDN in DNS query away from the 3GPP access.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.47\tSolution 47 (KI#6): Avoiding Switch Away Based on an SMF Indication",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.47.1\tDescription",
                            "text_content": "This solution addresses Key Issue #6 for the cases where the Distributed Anchor Point, Session Breakout, and Multiple PDU Session connectivity models are used.\nThe premise of the solution is that the SMF is aware of whether the PDU Session uses a PSA UPF in local site and the SMF can send an \"edge-anchored\" indication to the UE that indicates that the PDU Session uses a PSA UPF that is in a local site and also a \"5GC-preference\" indication that indicates that the network prefers to keep the traffic in the 5GC, or a \"3GPP-access-preference\" indication that indicates that the network prefers to keep the traffic on the 3GPP access. The indications may be coupled with descriptors of the impacted traffic. The UE can use the \"edge-anchored\" indication to notify any subscribed consumer (e.g. an application) mapped into the PDU Session about the local PSA. Also, when non-integrated connectivity becomes available for the UE, the UE can use the \"5GC-preference\" indication from the SMF to help determine whether to use the non-integrated connectivity for the traffic that is currently associated with a PSA UPF in a local site.\nNOTE:\tThe user preferences that are associated with the UE should be taken into account and how this is done is not specified. For example, the user preferences may indicate that all traffic should use non-integrated connectivity when it is available. In such a scenario, this indications from the SMF would be ignored.\nIn the case when the network provides connectivity to the edge for all or part of the traffic for a given PDU Session, the SMF may include an \"edge-anchored\" and \"5GC-preference\" or \"3GPP-access-preference\" indications in the ePCO of the PDU Session Establishment Accept message or PDU Session Modification Command. The \"edge-anchored\" indication indicates to the UE that the that the PDU Session has a local PSA UPF. The \"5GC-preference\" indication indicates that the 5GC prefers that the traffic stays within the 5GC (e.g. because the services are only available via the 5GC). The \"3GPP-access-preference\" indication indicates that the network prefers to keep the traffic on the 3GPP access.\nThe trigger for the SMF providing connectivity to the edge and sending the \"edge-anchored\" and/or \"5GC-preference\" indication or \"3GPP-access-preference\" indication in the ePCO may be:\n-\tA PDU Session Establishment request arriving from the UE through the AMF in a Nsmf_PDUSession_CreateSMContext request message, where the SMF decides to provide connectivity to the edge for all or part of this PDU Session. The indications in the ePCO are sent by the SMF in the PDU Session Establishment Accept message.\n-\tAn EAS discovery message from the UE that is triggering in the SMF (via from EASDF) a selection of a local PSA. The indications in the ePCO are sent by the SMF in a PDU Session Modification Command message.\n-\tAn AF traffic influence request via the NEF and PCF that is targeting connectivity to the edge for some traffic within an existing PDU Session (conveyed via a Npcf_SMPolicyControl_UpdateNotify message from the PCF). The indications in the ePCO message are sent by the SMF in a PDU Session Modification Command.\nOnce the PDU Session is established, if the SMF (re)selects a PSA UPF for the PDU Session and there is no longer any local PSA UPF for the PDU Session, then the SMF may send a PDU Session Modification Command to indicate in the ePCO that the PDU Session should no longer be considered \"edge-anchored\".\nOnce the PDU Session is established, if none of the PSA UPF(s) are deployed in a local site and the SMF (re)selects a PSA UPF for the PDU Session and the new PSA UPF is deployed in a local site, then the SMF may send a PDU Session Modification Command to the UE and indicate in the ePCO that the PDU Session should now be considered \"edge-anchored\". The SMF may also send the \"5GC-preference\" indication if there is a preference to keep the traffic within the 5GC. Alternatively, the SMF may also send \"3GPP-access-preference\" indication if there is a preference to keep the traffic on the 3GPP access.\nThe UE may use the \"edge-anchored\" indication to notify any subscribed consumer (e.g. an application) mapped into the PDU Session about the local PSA. The consumer (application) could use this information to perform actions to maintain proper connectivity to edge computing resources, such as keeping the 3GPP access active, monitoring non-3GPP access performance and taking traffic routing decisions.\nWhen the SMF has information about the impacted traffic or applications, e.g. it has configured a branching point UPF or an uplink classifier UPF for the PDU Session such that only some traffic is routed towards a PSA UPF in a local site, then the \"edge-anchored\" and \"5GC-preference\" or \"3GPP-access-preference\" indications may be sent to the UE in the ePCO with the Flow Descriptor(s) (e.g. Packet Filters derived from the PDR(s) that were sent to the branching point UPF or uplink classifier UPF to be used to detect which traffic should be forwarded to the local site. The UE may use the Flow Descriptor(s) to determine which traffic from the PDU Session is associated with a PSA that is in a local site and may use this to notify the specific applications.\nIn some cases, AF may become aware of the alternate connectivity options for a UE and determines that a connectivity through 5GS is optimal. AF may request 5GS to provide the traffic guidance to the UE through a policy control update procedure. The SMF may decide to send the \"edge-anchored\" and \"5GC-preference\" or \"3GPP-access-preference\" indication once the traffic corresponding to the SDF is detected based on this policy setting requested by the AF. If the AF determines that an alternate connectivity is better, it may request 5GS to stop providing traffic switching guidance to the UE.\nWhen connectivity outside of 5GC becomes available for the UE, the UE may use the \"5GC-preference\" or \"3GPP-access-preference\" indication and any associated Flow Descriptor(s) to decide if the traffic that is currently associated with a PDU Session should be transferred to connectivity outside of 5GC.\nNOTE 1:\tHow the \"edge anchored\" and \"5GC-preference\" or \"3GPP-access-preference\" indications interact with user preferences to influence the UE's decision to use connectivity outside of 5GC is out of scope.\nNOTE 2:\tThe SMF does not send an \"edge-anchored\" indication every time there is branching point UPF or an uplink classifier UPF for the PDU Session; the SMF only sends the \"edge-anchored\" indication when the branching point UPF or uplink classifier UPF is being used to access edge computing services. The SMF knows based on configuration (e.g. per DNAI) whether a branching point UPF or an uplink classifier UPF is being used to access edge computing services.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.47.2\tImpacts on services, entities and interfaces",
                            "text_content": "SMF:\n-\tsends the \"edge-anchored\" and \"5GC-preference\" or \"3GPP-access-preference\" indications and associated Flow Descriptor(s) in the ePCO of the PDU Session Establishment Accept and PDU Session Modification Command messages.\nUE:\n-\treceives the \"edge-anchored\" and \"5GC-preference\" or \"3GPP-access-preference\" indications and associated Flow Descriptor(s) in the ePCO of the PDU Session Establishment Accept and PDU Session Modification Command messages and provides functionality to notify relevant applications to consider avoiding connectivity to non-integrated access.\nPCF:\n-\tevaluates and provides to SMF the policy configured by the AF to generate traffic switching guidance indications.\nNEF:\n-\tprovides interface to an AF to update the policy for edge traffic switching.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.48\tSolution 48 (KI#6): Avoiding Switch Away Based on an Indication in the URSP",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.48.1\tDescription",
                            "text_content": "This solution addresses Key Issue #6 for the cases where URSP Rules are used, and it is known that certain DNN/S-NSSAI combinations will use PSA UPFs that are in a local site.\nThe premise of the solution is that an indication may be added to the URSP Rules to indicate that any PDU Session that is associated with an RSD may be using a PSA UPF that is in a local site. When non-integrated connectivity becomes available for the UE, the UE may use the indication to help determine whether to use the non-integrated connectivity for the traffic that is currently associated with the PDU Session.\nNOTE:\tThe user preferences that are associated with the UE should be taken into account and how this is done is not specified. For example, the user preferences may indicate that all traffic should use non-integrated connectivity when it is available. In such a scenario, this indication in the RSD would be ignored.\nThe Route Selection Descriptor of a URSP Rule may include an \"edge-anchored\" indication. The UE may consider any PDU Session that is established with the RSD to be \"edge-anchored\". Whether the PCF includes the \"edge-anchored\" indication in an RSD, may be based on configuration (e.g. OAM). For example, the PCF may be configured to know that certain DNN / S-NSSAI combinations should be considered to be \"edge-anchored\".\nNOTE 1:\tThis solution assumes that the inclusion of the \"edge-anchored\" indication in the RSD indicates that the DNN / S-NSSAI combination should always be considered to be \"edge-anchored\".\nWhen connectivity outside of 5GS becomes available for the UE, the UE may use \"edge-anchored\" indication to decide if the traffic that is currently associated with a PDU Session should be transferred to connectivity outside of 5GS.\nNOTE 2:\tHow the \"edge-anchored\" indication influences the UE's decision to use connectivity outside of 5GS is out of scope.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.48.2\tImpacts on services, entities and interfaces",
                            "text_content": "PCF:\n-\tmay include the \"edge-anchored\" indication in RSD(s) of URSP Rules.\nUE:\n-\treceives the \"edge-anchored\" indication in RSD(s) of URSP Rules.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.49\tSolution 49 (KI#6): URSP based solution to avoid UE to switch away from Edge PDU Session",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.49.1\tIntroduction",
                            "text_content": "This solution enables UE to avoid switching the EC traffic away from the EC PDU Session and 5GS altogether, for example due to connectivity to non-integrated Wi-Fi). In particular it addresses below identified problems:\n-\thow to determine what traffic is using the 5G System to access edge computing resources, and specifically in what granularity the traffic can be identified (e.g. Flow and/or PDU Session);\n-\twhat actions might be taken when some application traffic is currently using the 5G System to access edge computing resources and connectivity outside of 5GS becomes available.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.49.2\tFunctional Description",
                            "text_content": "The following are the main principles of the solution:\n-\tProviding URSP rules to the UE with extended Route Selection Descriptor to indicate EC traffic to the local part of the DN i.e. RSD is extended with an EC tag indicating Edge computing offload to local DN.\n-\tThe PCF for a UE triggers an update of the URSP rules to the UE when it is notified of an EC traffic to a local Data Network. This could be due to:\n-\tAF, as part of Application Guidance for URSP determination as described in clause 4.15.6.10 of TS 23.502 [9], request URSP with EC tag e.g. if AF is aware of requirement due to ongoing EC traffic;\n-\tPCF for the PDU Session subscribes to the SMF and is notified about EC traffic to the local part of the DN e.g. DNAI change or Local PSA UPF selection. Also, the PCF for a UE (i.e. the PCF that is responsible for provisioning the URSP rules to a UE) subscribes to the PCF for a PDU Session for such events. When a PCF for a UE is notified of EC traffic to a local Data Network, it may determine and trigger an update of the URSP rules to the UE.\n-\tIf the PCF for the UE and the PCF for the PDU Session are different PCFs, the PCF for the UE is informed when a SM Policy Association is established or released by subscription to the BSF. PCF for the UE may subscribe to the BSF to be notified when a PCF for the PDU Session is registered in the BSF as defined for AM policy use cases in TS 23.502 [9] clause 4.16.14. The (DNN, S-NSSAI) combinations may be configured in the PCF for the UE or retrieved from the UDR as part of the Application Data Set. If the PCF for the UE subscribed to the BSF, the BSF notifies that a PCF for the PDU Session is registered in the BSF.\n-\tWith received indication in the URSP, and considering its user preferences, the UE may accordingly decide to continue using the ongoing PDU Session for EC traffic.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.49.3\tProcedure",
                            "text_content": "Figure 6.49.3-1 below shows the detailed procedure to allow PCF of the UE to be informed of EC traffic thus PCF triggering an update to URSP rule with extended Route Selection Descriptor indicating EC traffic to the local part of the DN is being performed.\nThe figure depicts a PCF (Policy-based Charging) mechanism for a UE (User Equipment) to subscribe to events indicating edge computing session and trigger a UE Policy modification. This mechanism is designed to ensure efficient resource allocation and optimize the network's performance.\nFigure 6.49.3-1: PCF for a UE subscribes to Events that indicate edge computing session and triggers UE Policy modification\nThe Events indicating EC traffic that can be subscribed in the above figure 6.49.3-1 may be implemented as an extension of the User Plane Management Events specified in TS 23.502 [9], extended to include events that indicate that the SMF has established a local or Edge PDU Session (e.g. via selection of the PSA UPF and/or UL-CL UPF for EC traffic) or any of the Edge Computing connectivity models described in clause 4.3 of TS 23.548 [3], i.e. Distributed Anchor Point, Session Breakout, Multiple PDU Sessions.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.49.4\tImpacts on services, entities and interfaces",
                            "text_content": "PCF:\n-\tsubscribes to receive indication on EC traffic to local part of the DN, and accordingly updates URSP rule.\nSMF:\n-\tnew event type in the User Plane Management event exposure.\nUE:\n-\treceives URSP with RSP indicating ECtraffic. With received indication in the URSP, and considering its user preferences, the UE may accordingly decide to continue using the ongoing PDU Session for EC traffic.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.50\tSolution 50 (KI#7): Obtain and maintain mapping table between IP address/IP range with DNAI",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.50.1\tKey Issue mapping",
                            "text_content": "This solution addresses Key Issue #7 with following aspects:\n-\twhat information the AF should provide to 5GC (e.g. IP address or range thereof (i.e. IPv4 subnetwork and IPv6 prefixes), FQDN) and how it should provide it to help determine proper DNAI if the AF does not have knowledge of the DNAI information;\n-\twhether and how the 5GC can provide a DNAI to AF to help the subsequent AF influence/request.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.50.2\tDescription",
                            "text_content": "When AF does not have DNAI information, based on the AF request, the 5GS should help determine proper DNAI(s) and notify the information to AF. DNAI information implies the proper UPF which should be selected for the UE's PDU Session, and the proper UPF should be located in the same or nearby area to the target EAS. Therefore, it is possible that the AF will provide AF/EAS IP address or AF/EAS IP address range to help 5GS determine the DNAI.\nWhen NEF gets the AF request for determine DNAI information with the AF/EAS IP address or AF/EAS IP address range, optionally with the target geographic area, DNN, S-NSSAI. The NEF can map the geographic area into TA list. The NEF may find the target SMF(s) through NRF, with using the TA list, DNN, S-NSSAI. Then, the NEF requests the SMF with the AF/EAS IP address range, optionally TA list, DNN, S-NSSAI, in order to find the suitable DNAI(s).\nThe NEF may store the mapping relationship between the DNAI(s) and the AF/EAS IP address/IP address range, in order to help the subsequent AF request for DNAI determination.\nSMF is locally configured with the mapping information between the DNAI(s) and the AF/EAS IP address/IP address range, no matter whether the AF/EAS IP address/IP address range is public or private IP address.\nAF may subscribe the mapping information modification with NEF/SMF. When the configuration information (relationship between DNAI and EAS IP address/IP address range) is changed, the SMF can notify the new mapping information to NEF, and NEF forwards this notification to AF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.50.3\tProcedures",
                            "text_content": "The figure depicts a 5G signal path, illustrating the multi-path signal propagation in a 5G network. It shows how signals reflect off buildings (NLOS) and combine at the receiver. Key components include the base station (gNB), user equipment (UE), and scatterers. The diagram highlights beamforming techniques to mitigate interference.\nFigure 6.50.3-1: 5GS determines the DNAI based on AF request\n1.\tAF invokes Nnef_EventExposure service to subscribe for DNAI determination. The request includes EAS IP address or IP address range, may include geographic area. AF may also subscribe the DNAI information modification in NEF.\n2.\tNEF finds the corresponding SMF based on the S-NSSAI, DNN, TA. Then, NEF invokes the Nsmf_EventExposure service to get the suitable DNAI(s) based on the EAS IP address or IP address range, TA list, S-NSSAI or DNN. NEF can also subscribe the DNAI information modification in SMF.\n3-4.\tSMF notifies the DNAI(s) information/the changed DNAI information (optionally with the EAS IP address or IP address range) to AF/NEF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.50.4\tImpacts on existing entities and interfaces",
                            "text_content": "NEF:\n-\tinformation exposure enhancement to support the DNAI exposure;\n-\tcapability enhancement to store the relationship between DNAI and IP address mapping.\nSMF:\n-\tfinds the corresponding DNAI based on the EAS IP address/IP address range;\n-\tnotifies the new DNAI information, optionally with the EAS IP address or IP address range, once the mapping relationship between DNAI and the EAS IP address/IP address range changed.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.51\tSolution 51 (KI#7): EDI holding the IP address to DNAI mapping",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.51.1\tHigh level description",
                            "text_content": "OAM provisions EDI either to UDR or to NEF where NEF may store it in UDR. For this purpose, EDI shall at least contain DNN and S-NSSAI and IP address range(s) per DNAI, but other EDI information may also be present.\nFurthermore, SMF can also interrogate NEF for EDI to get use this EDI information for option A when assigning a ECS options IP address.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.51.2\tHigh level procedures",
                            "text_content": "The provisioned EDI for this purpose contains at least DNN and S-NSSAI, and IP address range(s) (IPv4 subnetwork(s) and/or IPv6 prefix(es)).\nThe figure depicts a network provisioning process for DNAI (Digital Network Access Interface) from NEF (Network Element Facility). It illustrates the steps involved in setting up the necessary network elements, such as NEF, to enable DNAI services. The figure includes a flowchart and a list of steps, providing a clear and concise overview of the process.\nFigure 6.51.2.1-1: Provisioning of DNAI from NEF\n1a\tEDI creating/updating/deleting through OAM procedure to UDR.\n1b\tEDI creating/updating/deleting through OAM procedures to NEF.\n2b.\tThe NEF invokes the Nudr_DM_Create/Update/Delete to the UDR if it is authorized.\n3b.\tThe UDR stores/updates/removes the corresponding information (and responds a Nudr_DM_Create/Update/Delete Response to the NEF).\nThe figure depicts a graphical representation of DNAI information, which is a crucial component in the analysis of DNA-based fingerprints. The figure shows the various layers and components involved in the DNAI process, including the DNA template, the DNA primer, the DNA polymerase, and the DNA sequencing machine. The figure provides a clear and concise visual representation of the complex process, making it easier to understand the steps involved in obtaining DNAI information.\nFigure 6.51.2.2-1: Getting DNAI information\n1\tAF queries NEF for translation of IP address to DNAI using Nnef_IPtoDNAI_Get Request (IP address(es)).\n2\tNEF checks whether the AF is authorized to perform the request. The NEF derives DNN and S-NSSAI from the AF-Service-Identifier if not received explicitly.\n3\tNEF queries UDR for records related to the received IP address(es) using Nudr_DM_Get Request (DNN, S-NSSAI, IP address(es)).\n4\tUDR responds with related records holding IP address per DNAI information Nudr_DM_Get Response (EDI records).\n5\tNEF formats result to an IP address(es) to DNAI mapping table.\n6\tNEF sends the result to AF Nnef_IPtoDNAI_Get Request (IP address(es) per DNAI).\nNOTE:\tNEF can cache any received result from UDR to reduce signalling load towards UDR.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.51.3\tImpacts on services, entities and interfaces",
                            "text_content": "NEF:\n-\tnew service.\nEDI:\n-\tFQDN not required.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.52\tSolution 52 (KI#7): AF obtaining target DNAI provided by NEF",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.52.1\tDescription",
                            "text_content": "This solution corresponds to KI#7: Obtain and maintain mapping table between IP address/IP range with DNAI.\nThe AF may provide one or more the following information set to 5GC, in order to request for target DNAI(s):\n-\tEHE information, including one or more of the following:\n-\tEAS IP address/IP range: the IP address or IP range of the requested EAS;\n-\tFQDN(s): the FQDN (list) of the requested EAS;\n-\t(Local) DNS server information: the (L-)DNS server address for each DNAI.\n-\tDNN(s): the DNN(s) related to the requested EAS;\n-\tS-NSSAI(s) (optional): the S-NSSAI(s) related to the requested EAS.\nAfter receiving the information above, the 5GC determines and sends the DNAI to the AF by the following way:\n-\tNEF may determine target DNAI based on NF local configuration;\n-\tNEF may obtain target DNAI from UDR.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.52.2\tProcedure",
                            "text_content": "The figure depicts the procedure of AF (Air Force) obtaining target DNAI (DNA Interferometric Data). The figure shows a step-by-step process, including the use of a DNAI (DNA Interferometric Data) acquisition system, a target, and a DNAI acquisition system. The figure illustrates the importance of proper system calibration and alignment to ensure accurate and reliable DNAI data acquisition.\nFigure 6.52.2-1: Procedure of AF obtaining target DNAI\n1.\tThe AF has the requirement to obtain target DNAI, and creates an AF request, which may include the following information to 5GC, in order to request for target DNAI:\n-\tEHE information, including one or more of the following:\n-\tEAS IP address/IP range: the IP address or IP range of the requested EAS;\n-\tFQDN(s): the FQDN (list) of the requested EAS;\n-\t(Local) DNS server information: the (L-)DNS server address for each DNAI.\n-\tDNN(s): the DNN(s) related to the requested EAS;\n-\tS-NSSAI(s) (optional): the S-NSSAI(s) related to the requested EAS.\n2.\tThe AF invokes Nnef_EASDeployment_Query Request service to send its request to the NEF. The NEF authorizes the AF request.\nThe NEF may determine the target DNAI by local configuration, or obtain the DNAI from UDR, as described in steps 3-4.\n3.\tThe NEF invokes Nudr_DM_Query Request service to request for target DNAI, including information received in the AF request.\n4.\tThe UDR sends Nudr_DM_Query Response to the NEF, including the target DNAI.\n5.\tThe NEF sends Nnef_EASDeployment_Query Response to the AF, including the target DNAI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.52.3\tImpacts on services, entities and interfaces",
                            "text_content": "AF:\n-\tprovides EHE information (described in clause 6.52.2), DNN(s), S-NSSAI(s) via invoking Nnef_EASDeployment_Query service.\nNEF:\n-\tprovides target DNAI in Nnef_EASDeployment_Query Response;\n-\trequests DNAI information (described in clause 6.52.2) via invoking Nudr_DM_Query service.\nUDR:\n-\tprovides target DNAI in Nudr_DM_Query Response.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.53\tSolution 53 (KI#1): EDC-based EAS discovery for HR PDU Session with Session Breakout",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.53.1\tHigh level description",
                            "text_content": "This solution is based on Solution 25 (see clause 6.25) and enables the UE to select which DNS resolver (between H-EASDF/H-DNS resolver and V-EASDF) to be used for a certain application. The solution works as follows:\n1.\tDuring the PDU Session Establishment/Modification, the H-SMF provides via ePCO the UE with both the H-EASDF/H-DNS resolver's IP address (as per Rel-17) and the V-EASDF's IP address. In addition, the H-SMF may include a preference indication indicating which one of the two DNS resolvers the HPLMN would like the UE to use. If no preference indication is included, it means that the HPLMN does not have a preference.\nNOTE 1:\tFor backward compatibility, if the H-SMF includes only one IP address in the ePCO (i.e. the one of the H-EASDF/-HDNS resolver), then the UE behaves as per Rel-17 (see EDC functionality in TS 23.548 [3] clauses 5.2.1 and 6.2.4). In that case the H-SMF will not include in the preference indication in the ePCO.\nNOTE 2:\tAs described in Solution 25 in clause 6.25, this assumes that the V-SMF provides the H-SMF with the IP address of the V-EASDF. The H-SMF can provide the V-SMF with the IP address of the H-EASDF/H-DNS resolver so that, if needed, it can be configured to forward potential unresolvable DNS queries.\n2.\tThe EDC functionality in the UE, once received the two addresses, takes the optional preference indication from the HPLMN into account and, based on local logic (e.g. whether a certain application can use Edge Computing services in the VPLMN, user preferences, etc.), selects to use either the H-EASDF/H-DNS resolver (as per Rel-17) or the V-EASDF to resolve a specific DNS query.\n3.\tDepending on the selected DNS resolver, the DNS query is sent to the HPLMN or to the VPLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.53.2\tProcedures",
                            "text_content": "Figure 6.53.2-1 represents a simplified signalling flow for discovering the EAS in case of HR PDU Session with Session Breakout in the VPLMN.\nThe figure depicts a scenario where an EAS (Electronic Attack Suppression) is triggered in a network, specifically in the case of a HR (High-Rate) PDU (Power-Down) Session. The figure illustrates the discovery of the EAS in the VPLMN (Virtual Private LAN) by the EAS system, which is a crucial component in network security. The figure also shows the session breakout in the VPLMN, indicating that the EAS is triggered due to the presence of a high-rate PDU session. This scenario highlights the importance of EAS systems in protecting networks from potential cyber threats.\nFigure 6.53.2-1: EAS discovery in in case of HR PDU Session with Session Breakout in the VPLMN\n0.\tThe UE registers to the network and the AMF in the V-PLMN receives an \"HR-SBO allowed\" indication.\n1-2.\tAt PDU Session establishment request, the V-PLMN CN decides to establish a Session Breakout for the HR PDU Session. This is possible because the H-PLMN previously sent the \"HR-SBO allowed\" indication. The V-SMF sends to the H-SMF the address of the V-EASDF.\nNOTE 1:\tIf the V-SMF does not include the V-EASDF's IP address in step 2, it means that the V-PLMN does not want to establish a Session Breakout for the HR PDU session and the following steps do not apply.\n3-4.\tThe H-SMF retrieves the subscription/policy information from the UDM and create the DNS context in the H-EASDF.\n5.\tThe H-SMF sends Nsmf_PDUSession_Create Response to the V-SMF. H-SMF provides H-EASDF reachability/IP address to VPLMN. The DNS server information in the ePCO includes both the:\na.\tH-EASDF/H-DNS resolver's IP address; and\nb.\tV-EASDF's IP address.\nThe H-SMF may include in the ePCO an indication of which DNS resolver the HPLMN prefers the UE to use for resolving the DNS query. If no preference indication is included in the ePCO, it means that the HPLMN has no preference. The preference indication may be:\n-\tpreference to use the H-EASDF/H-DNS resolver,\n-\tpreference to use the V-EASDF.\nNOTE 2:\tFor backward compatibility, if the H-SMF includes only one IP address in the ePCO (i.e. the one of the H-EASDF/-HDNS resolver), then the UE behaves as per Rel-17 (see EDC functionality in TS 23.548 [3] clauses 5.2.1 and 6.2.4). In that case the H-SMF will not include in the preference indication in the ePCO.\n6-8.\tThe V-SMF inserts the UL-CL/BP and local PSA, creates the DNS context in the V-EASDF and forwards the PDU Session Establishment Accept message to the UE including the addresses of both V- and H-EASDF and the preference indication from the H-PLMN.\nOption A\n9A.\tThe EDC functionality in the UE takes the optional preference indication from the H-SMF into account and, based on local logic, it selects to use the V-EASDF as resolver for the DNS queries.\n10A.\tThe UE sends the DNS query to the V-EASDF.\n11.A\tThe DNS query triggers steps 8-18 of TS 23.548 [3] clause 6.2.3.2.2 executed in the in V-PLMN. If UL-CL/local PSA have been inserted in step 6, then it is not executed now.\n12.A\tThe V-EASDF resolves the DNS query and sends the DNS response to the UE.\nOption B\n9B.\tThe EDC functionality in the UE takes the optional preference indication from the H-SMF into account and, based on local logic, it selects to use the H-EASDF/H-DNS resolver (i.e. the address indicated as per Rel-17) as resolver for the DNS queries.\n10B.\tThe UE sends the DNS query to the H-EASDF/H-DNS resolver.\n11B.\tThe DNS query triggers steps 8-18 of TS 23.548 [3] clause 6.2.3.2.2 executed in the in H-PLMN.\n12B.\tThe H-EASDF/H-DNS resolver resolves the DNS query and sends the DNS response to the UE.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.53.3\tImpacts on services, entities and interfaces",
                            "text_content": "H-SMF:\n-\tsends authorization for \"HR-LBO\" to V-EASDF;\n-\tsends H-EASDF/H-DNS resolver's IP address to V-SMF to configure the V-EASDF, if needed;\n-\tprovides to the UE address of H-EASDF/H-DNS Resolver and of V-EASDF (via ePCO);\n-\toptionally provides to the UE preference on which address to use for DNS resolution (via ePCO).\nV-SMF:\n-\tindicates support for EC and providing V-EASDF IP address to H-SMF;\n-\tsupports interaction with V-EASDF using Neasdf interface.\nUE:\n-\tindicates capability to CN;\n-\treceives in ePCO two IP addresses and preference indication;\n-\tconsiders precedence indication when selecting IP address for DNS resolution.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.54\tSolution 54 (KI#4): PCF controlling common DNAI",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.54.1\tDescription",
                            "text_content": "This solution addresses KI#4. The solution addresses how 5GC can select a common DNAI for a set of UEs.\nIt is assumed that the AF/EASs solves the issue with a common EAS for the set of UEs.\nThe set of UEs is identified by the AF by the external group ID. It is assumed that the AF creates the UE set (group) by e.g. as per solution 14, in clause 6.14.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.54.2\tProcedure",
                            "text_content": "The AF will request a common DNAI from 5GC in AF influence on routing by indicating correlation of traffic for a group of UEs. The group is identified by the External Group ID, which is translated by 5GC (UDM via NEF) to an Internal Group ID.\nThe request for influencing traffic ends up in PCF, via UDR, see TS 23.502 [9] clause 4.3.6.2. Once PCF has received the request for the group of UEs, it will need to send PCC rules to the concerned PDU sessions. PCF starts with sending the PCC rule via Npcf_SMPolicyControl_UpdateNotify including indication of traffic correlation and the related Internal Group ID to the SMF having most of the PDU Sessions that should be correlated. SMF determines the common DNAI for the Internal Group and responds with the selected DNAI to the PCF. PCF then sends Npcf_SMPolicyControl_UpdateNotify with indication of traffic correlation, the related Internal Group and selected DNAI to the rest of the PDU Sessions for the UEs identified by the Internal Group ID.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.54.3\tImpacts on Existing Nodes and Functionality",
                            "text_content": "SMF:\n-\tselects common DNAI, gives it to PCF, uses selected DNAI when ordered from PCF.\nPCF:\n-\tselects the SMF with most PDU Sessions for the concerned group of UEs, receives and sends selected DNAI.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.55\tSolution 55 (KI#5): Access the shared EAS via N9 tunnel",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.55.1\tDescription",
                            "text_content": "As indicated in LS S2-2203633 [20], the 5GAA has requirements to allow a PLMN to use EHE resources shared by another MNO appropriately, i.e. allow a UE in PLMN B to access efficiently the EAS in PLMN A located in close proximity and route the UE traffic to the identified EAS.\nAs some of the MNOs do not have local edge resources, in order to consume the edge service from other PLMN, the issues below should be resolved:\n-\thow can the UE in PLMN B discover the EAS deployed in PLMN A by a 3GPP-defined mechanism;\n-\tafter having determined the EAS IP address deployed in PLMN A, how to determine the target DNAI. The EAS deployed in PLMN A may refer to the target DNAI defined in PLMN A, and the SMF in PLMN B cannot directly determine the target DNAI;\n-\thow to select the UPF in PLMN A. In order to access the EAS deployed in PLMN A, the PLMN B where the UE is located should trigger the UPF selection in PLMN A and configure the N4 rules and N9 tunnel information to UPF in PLMN A. This procedure refers to the interoperability across PLMNs.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.55.2\tProcedure",
                            "text_content": "As the EAS shared by PLMN A can be accessed via N9 tunnel by UE in PLMN B, the target DNAI related to EAS IP address should be determined. The DNAI is used or defined per PLMN, and as the EAS is deployed in another PLMN, the SMF in PLMN B cannot directly determine the target DNAI in PLMN A.\nSome information should be provided by PLMN A to assist SMF in PLMN B to determine the target DNAI in PLMN A. The AF in PLMN A can provide such information to AF in PLMN B, which is the application layer procedure. The AF in PLMN B reuses the EDI procedure.\nThere exists a relationship between the EAS IP address(range)/FQDN and target DNAI in PLMN A. The information used to determine target DNAI in PLMN A are listed in table 6.55.2.1-1.\nTable 6.55.2.1-1 Mapping table between target DNAI and IP range provided by AF\n\nThe procedure where AF provides the mapping table to 5GC is in Figure 6.55.2.1-1.\nThe mapping table in Figure 6.55.2.1-1 illustrates the relationship between target DNAI (Digital Network Interface) in other PLMN (Physical Local Network) and IP range in the AF (Access Procedure) procedure. This table is crucial for understanding the network topology and ensuring efficient communication between different network elements.\nFigure 6.55.2.1-1: Mapping table between target DNAI in other PLMN and IP range in the AF procedure\n1.\tThe AF invokes the service operation to provide the mapping table between target DNAI in other PLMN and EAS IP range/address.\n2.\tNEF checks whether the AF is authorized to perform the request, and authorised to provision the mapping table to UDR based on the operator policies.\n3.\tThe NEF invokes the Nudr_DM_Create/Update/Delete to the UDR if it is authorized.\n4.\tThe UDR stores/updates/removes the corresponding information and responds a Nudr_DM_Create/Update/Delete Response to the NEF.\n5.\tThe NEF sends Nnef_EASDeployment_Create/Update/Delete Response to the AF.\nAfter receiving the EAS IP address from EASDF, the SMF cannot determine the target DNAI, because this DNAI is referred to the other PLMN ID. So, the SMF should check the mapping table in UDR and convert the received EAS IP address to target DNAI in other PLMN, and trigger the UPF selection in other PLMN.\nThe figure depicts a 55.2.2-1 SMF (Service Mobility Framework) environment or obtain the mapping table. It illustrates the process of setting up and managing a Service Mobility Framework environment, including the necessary steps and tools required to obtain the mapping table.\nFigure 6.55.2.2-1: SMF recovers or obtain the mapping table\n1.\tThe SMF receives the EAS IP address from EASDF, but the SMF cannot decide the target DNAI according to EAS IP address, because this IP address corresponds to the target DNAI which is supported by another PLMN.\n2-3.\tThe SMF subscribes to the mapping table Change Notification from the NEF or obtains the mapping table from NEF.\n4-5.\tThe NEF invokes the Nudr_DM_Query/Subscribe to the UDR for the mapping table.\n6.\tThe NEF sends notification or Response to the SMF for the mapping table between EAS IP address/range and target DNAI.\nThe EAS deployed in PLMN A can be shared to UE in PLMN B to provide the edge services. PLMN A has already provided the mapping table between IP address/range and target DNAI in PLMN A as indicated in clause 6.55.2.1.\nThe figure depicts the EAS discovery procedure and access the shared EAS via N9 tunnel, illustrating the steps involved in establishing and accessing the EAS. The figure includes a diagram of the EAS, a tunnel, and a network interface card (NIC) to demonstrate the connection between the EAS and the network.\nFigure 6.55.2.3-1: EAS discovery procedure and access the shared EAS via N9 tunnel\n0.\tFor some of the FQDNs that can only be resolved in the PLMN B. So, the PLMN B can provide the EDI related to such FQDNs to PLMN A.\n1-11.\tThese procedures are the same as the procedures listed steps 1 to 13 in figure 6.2.3.2.2-1 of TS 23.548 [3] with the exception below:\n5-6.\tAfter receiving the EDI from PLMN B, the SMF retrieves the EDI from UDR via NEF, and configures the DNS message handling rules to EASDF, to handle some of the FQDNs related to PLMN B.\n8-11.\tIf EASDF receives the DNS query which contains an FQDN deployed in PLMN B or PLMN B can resolve, the EASDF reports the FQDN to SMF, the SMF recovers the EDI from UDR provided by PLMN B, and SMF configures the DNS message handling rules.\n12.\tAccording to the DNS handling rules, the EASDF delivers the DNS query to DNS server. This DNS message handling rules are generated by the PLMN B EDI.\n13.\tThe DNS server delivers the DNS response to EASDF in PLMN A.\n14-15.\tThe EASDF sends DNS message reporting to the SMF by invoking Neasdf_DNSContext_Notify request, including EAS information if the EAS IP address or the FQDN in the DNS Response message matches the DNS message detection template provided by the SMF. SMF cannot decide the target DNAI according to the EAS IP address or the FQDN in the DNS response.\n16.\tThe SMF recovers or obtains the mapping table from UDR via NEF, which can be used to determine the target DNAI. The SMF uses the mapping table to decide that the EAS IP address corresponds to the target DNAI in PLMN A.\n17.\tThe SMF may perform UL-CL/BP and Local PSA selection according to the target DNAI.\n23-25.\tThese procedures are the same as the procedures listed in steps 17-19 in figure 6.2.3.2.2-1 of TS 23.548 [3].\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table 6.55.2.1-1 Mapping table between target DNAI and IP range provided by AF",
                                    "table number": 16,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        },
                        {
                            "title": "6.55.3\tImpacts on services, entities and interfaces",
                            "text_content": "SMF:\n-\treceives the mapping table from UDR via NEF, and transfers the EAS IP address to target DNAI;\n-\tgenerates the DNS handling rules according to the EDI from PLMN B, and configures the EASDF with DNS message handling rules.\nUDR:\n-\tstores the mapping table between EAS IP address/range and target DNAI.\nAF:\n-\tprovides the mapping table between EAS IP address/range and target DNAI to 5GC;\n-\tprovides the EDI from other PLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tEvaluation",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tEvaluation for KI#1: Accessing EHE in a VPLMN when roaming",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "7.1.1\tEvaluation for scenario 1 (via LBO PDU Session)",
                            "text_content": "Solutions #6, #7, #8, #9, #10, #27, #28, and #39 all cover the scenario where the EHE is accessed via an LBO PDU Session.\nFor how to establish the LBO PDU Session towards the correct S-NSSAI/DNN pair, updating the URSP rules in the UE is regarded as the general solution to establish the LBO PDU Session with proper DNN, S-NSSAI for the traffic that needs EC treatment. The generation of URSP rules that apply in the VPLMN and their provisioning to the roaming UE is part of scope of FS_eUEPO KI#1. TR 23.700-85 [10] includes several solutions in this area, and the solutions in FS_EDGE_Ph2 for this topic do basically overlap with solutions in FS_eUEPO report.\nThe proposal is to leave to FS_eUEPO Study Item the definition of the solution that guarantees that it is possible to provision the UE with URSPs that allow that for a given EC application, UE selects the correct S-NSSAI/DNN that can trigger vPLMN to establish and use a LBO PDU Session to access the VPLMN EHE. That includes scenarios where vAF sends guidance for determination of proper URSP in VPLMN.\nSolutions #6, #7, and #10 share some common points and all relate to URSP enhancements. Solution #7 extends Location Criteria, while solution #10 defines PLMN Criteria as new validity criteria. Considering PLMN is not kind of location, e.g. multiple PLMNs can cover same location, PLMN ID is recommended as a new criterion besides Location Criteria in RSD.\nIn solution #6, an AF of the VPLMN contacts the NEF of the HPLMN to use the API defined in clause 4.15.6.10 of TS 23.502 [9], \"Application guidance for URSP rules determination mechanisms\". This allows the VPLMN to influence the URSP Rules to guide UE for traffic to be offloaded in the VPLMN to use a specific DNN and slice deployed in LBO mode while the rest of the traffic can use HR PDU Session(s). The H-PCF may, based on local policies, determine whether to always send the URSP rules immediately to the UE or to send these rules only when the UE is served by the corresponding serving PLMN, e.g. waiting to be triggered from a V-PCF of that PLMN in step 3 of TS 23.502 [9], clause 4.6.1. If the URSP rules are sent immediately (i.e. before the UE is being served by the VPLMN), then the new rules may trigger the UE to re-evaluate URSP rules and select DNN/S-NSSAI combinations that are not optimal. If the URSP rules are sent by the H-PCF when triggered by the V-PCF, then there will be some delay between when the UE is roaming and actually receiving policies that can be used to access the EHE.\nInstead of introducing a new \"Revaluation Suggested\" indication, updating to condition for UE to re-evaluate URSP rules in clause 6.6.2.3 of TS 23.503 [13] can achieve the purpose.\nSolution #7 proposes 2 changes to URSP Rules:\n-\tSolution #7 proposes that PLMN ID(s) can be part of Location Criteria in the Validation Criteria. This will allow the UE to be sent URSP rules that will work in the VPLMN before the UE is served by the VPLMN and prevent the UE from establishing a PDU Session with the RSD unless the UE is actually served by the VPLMN.\n-\tSolution #7 also proposes that the RSD(s) can also optionally include a \"Revaluation Suggested\" indication. This indication may be included to indicate to the UE that URSP Re-evaluation should take place if the Validation Criteria is no longer met. This is needed because Rel-17 behaviour, as described in TS 23.503 [13] is that \"The Time Window and Location Criteria are not required to be checked again during the lifetime of the PDU Session.\"\nSolution #6 and Solution #7 can be paired in the sense that Solution #6 can be used to allow an AF in the VPLMN to provide the H-PCF with information that can be used to build URSP rules that include PLMN ID(s) in the Location Criteria and use the \"Revaluation Suggested\" indication to ensure that URSP rules are re-evaluated when appropriate. Thus, the network can send the URSP rules when they are immediately available and the UE will not attempt to establish PDU Sessions with the VPLMN DNN/S-NSSAI combinations until the UE is served by the VPLMN.\nSolution #10 is similar to Solution #7 because it also proposes that PLMN ID(s) can be part of the Validation Criteria. Since the UE only uses the Route Selection Validation Criteria to determine whether a PDU Session should be established and the Time Window and Location Criteria are not required to be checked again during the lifetime of the PDU Session, this solution would benefit from additionally including the \"Revaluation Suggested\" indication that is included in Solution #7. The \"Revaluation Suggested\" indication can be used to ensure that URSP rules are re-evaluated when the serving PLMN changes.\nSolution #8 deals specifically with V-ECS discovery when roaming. Solution #8 proposes that the SoR Transparent Container can include either:\n-\tan FQDN or an IP Address of a V-ECS to the UE. When the UE accesses the provided FQDN or IP Address, URSP rules may steer the UE to use a DNN/S-NSSAI combination that can be used to reach the ECS (e.g. an LBO Session); or\n-\ta DNN/S-NSSAI combination. In this case, the DNN/S-NSSAI combination may be used to send a PDU Session Establishment Request in the VPLMN that will result in an LBO PDU Session. The SMF in the VPLMN may then send ECS Address Configuration Information to the UE as described in TS 23.548 [3]. The EEC may then use the ECS FQDN or IP Address from the ECS Address Configuration Information.\nSolution #9 relies on the UE using a predefined FQDN to the EASDF that is shared between operators. The Global EASDF acts as a DNS server to provide the UE with either the IP address of the EASDF that the UE should use in the VPLMN or the S-NSSAI/DNN combination that the UE will use to set up a PDU Session. It is not clear how the Global EASDF obtains the information to determine that a new LBO PDU Session is needed, and extending DNS Response message for such an indication is not specified in our specification. It is unclear why URSPs do not suffice and why an alternative mechanism is needed, neither which mechanism in UE will determine which applications shall use this DNN/S-NSSAI.\nIn Solution #27, the H-SMF detects that a HR PDU Session would be better served by an LBO PDU Session. This detection is based on DNS query from the UE towards an EC FQDN or an AF influence of traffic routing for the UE. When the H-SMF detects that the UE should switch to an LBO PDU Session, the H-SMF will terminate the HR PDU Session and inform the AMF that the DNN/S-NSSAI combination should trigger an LBO PDU Session when the UE attempts to re-establish the PDU Session. According to current Rel-17 specification, whether to establish a LBO PDU Session is determined by UE subscription based on DNN+S-NSSAI. Other applications using same DNN+S-NSSAI as per URSP will be forced to use the same LBO PDU Session even if they may need a HR Session to access services. Terminating the HR PDU Session impacts the ongoing traffic on that PDU Session, e.g. TCP connections break and QUIC connections are interrupted until the connectivity is re-established on the new LBO PDU Session. Solution #27 requires that the HPLMN ensures that there are no URSP rules in the UE conflicting with the LBO authorization for this PDU Session, e.g. no other traffic that requires HR PDU Session should be mapped to the same DNN and S-NSSAI that could be authorized for LBO. Solution #27 also allows the V-SMF to send information related to supported edge computing applications, i.e. Application IDs or FQDN ranges.\nIn Solution #28, in order to support to establish the LBO PDU Session to ECS, the 5GC can support to distribute the updated URSP rules to UE. When UE has the traffic towards ECS in visited PLMN, the URSP rules with ECS configuration information can trigger an LBO PDU Session establishment or apply the traffic to LBO PDU Session. During LBO PDU Session establishment procedure, SMF selects EASDF, and sends EASDF address to UE via NAS message, and/or delivers ECS configuration information to UE in ePCO. Then UE may perform EAS discovery with the EASDF. The LBO procedure of solution #28 re-uses Rel-17 non-roaming EAS discovery procedure.\nSolution #39 deals with the case where the EAS is relocated between the VPLMN and HPLMN. When moving from the VPLMN to the HPLMN, the V-SMF determines target DNAI based on EAS information and EAS deployment information, sends an inter-PLMN relocation indicator to H-SMF, and configures the UL-CL/BP V-UPF for traffic routing towards H-PSA UPF if the destination address is the IP address of source EAS or target EAS. The same approach is taken when moving from the HPLMN to the VPLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.1.2\tEvaluation for scenario 2 (via HR PDU Session)",
                            "text_content": "In this clause, we evaluate the solutions addressing KI#1 scenario 2: #1, #2, #3, #4, #5, #24, #25, #26, #28 HR part and #53.\n1.\tRegarding the technical aspect on how to authorize the PDU Session to support local traffic routing to access an EHE in the VPLMN, there are three categories of solutions as follows:\n1)\tWith #2, #25 and #53, the authorization information is stored in UDM. During the UE registration procedure, the UDM sends the allowed indication to the AMF in VPLMN.\n2)\tWith #1 and #3, the authorization information is stored in UDM or is configured in H-SMF locally according to roaming agreement. During the PDU Session Establishment procedure, the H-SMF sends the indication to allow local traffic routing to the V-SMF.\n3)\tWith #4 and #5, H-PCF provides the policy to V-SMF via H-SMF.\nUDM-based approaches can be used where no dynamic PCC is deployed. The allowed indication sent to the AMF can be used to assist the AMF to select the V-SMF.\n2.\tRegarding the technical aspect on whether and how to support charging for the local traffic of a PDU Session that supports local traffic routing to access an EHE in the VPLMN, there are six solutions (#1, #2, #3, #4, #5 and #25) addressing VPLMN charging.\n-\tWith #1, V-UPF reports the usage and charging records to the V-SMF. V-SMF sends the charging information to V-CHF and also sends the usage records to the H-SMF.\n-\tWith #2 and #3, V-PSA collects and reports it.\n-\tWith #4 and #5, V-SMF configures the traffic routing rule and Usage Report Rule to assist traffic offload to V-EAS and usage information report from UL-CL V-UPF or BP V-UPF to H-SMF via V-SMF for offline and online charging.\n-\tSolution #25 proposes that the V-SMF provides Usage Reporting Rules to the UL-CL/BP and local PSA to collect Usage Reports for charging in VPLMN that it conveys to H-SMF.\nBoth VPLMN and HPLMN need to store charging records, it is reasonable that V-SMF sends the records to H-SMF.\n3.\tRegarding the technical aspect on how to support Rel-17 edge computing related procedures, such as EAS (re-) discovery, as specified in clause 6 of TS 23.548 [3], there are seven solutions (#1, #2, #3, #4, #5, #24, and #25).\n1)\tScenario 2.1: #1, #4, #5, and #25\n-\t#1. H-AF requests influence traffic routing and H-SMF sends local routing indication to the V-SMF.\n-\t#4. H-EASDF is used. The V-SMF performs selection and insertion of UL-CL/BP and local PSA based on DNAIs received from H-SMF. The DNAIs are determined by H-SMF based on EAS IP report from H-EASDF, which implies interaction between H-SMF and V-SMF in every DNS resolution to trigger V-SMF actions related to local UL-CL/PSA selection and configuration and unnecessary involvement of HPLMN for scenario 2.2.\n-\t#5. The V-SMF determines the HR PDU Session for V-EHE should be activated based on the EAS information and roaming offload policy received from H-PCF via H-SMF, and configures the traffic routing rule to assist traffic offload to V-EAS.\n-\t#25. H-SMF and Home DNS/H-EASDF may monitor, assist and validate the L-PSA selected by the V-SMF, based on H-EASDF trigger.\n#4 supports the dynamic EAS (re-)discovery by H-SMF based on interaction with EASDF.\nIn #1, #5 and #25, HPLMN sends an offload policy/configuration to the V-SMF, and V-SMF performs the UL-CL and local PSA selection at EAS (re-)discovery.\n2)\tScenario 2.2: #1, #2, #3, #4, #5, #24, #25, #28 HR part\n-\t#1. V-SMF retrieves the EAS deployment information of the VPLMN from the V-NEF and performs EAS discovery according to the EAS discovery procedure.\n-\t#2. Based on V-EASDF trigger, the V-SMF decides the Session Breakout using EAS Deployment Information provisioned from the AF and V-SBO information provided by the H-SMF.\n-\t#3. V-SMF uses a pre-configured list of FQDNs subject to EC services to derive a traffic routing rule and configures it to the V-UPF so that the V-UPF can route DNS queries (corresponding to FQDNs) to V-EASDF reusing IP replacement mechanism of Option D. After the V-UPF routes DNS queries (corresponding to FQDNs) to V-EASDF, the EAS discovery procedure with V-EASDF which implements the functions of EASDF refers to TS 23.548 [3]. For the DNS query requiring DNS resolution in the HPLMN, the DNS resolution path is same as the normal path in the HR PDU Session. Based on EAS information received from the V-EASDF and UE location, V-SMF may perform V-ULCL and V-PSA selection and insertion.\n-\t#4. V-SMF performs V-UL-CL/V-BP and V-local PSA selection and insertion based on UE location. The H-SMF obtains ECS option/local DNS server from V-SMF during PDU Session Establishment and send it to H-EASDF. The H-EASDF handles all DNS queries of the UE based on this ECS option/local DNS server.\n-\t#5. Based on the received EAS information (e.g. EAS IP address) and the roaming offload policy, the V-SMF decides to insert or relocate UL-CL/BP V-UPF and PSA V-UPF for traffic offload to the V-EAS. According to the roaming offload policy and the EAS Deployment Information, the V-SMF configures DNS message handling rules to V-EASDF.\n-\t#24. During the PDU Session establishment procedure, the V-SMF instructs the UL-CL the traffic routing rule to route the DNS Query for an FQDN (range) to a local DNS Server/Local DNS Resolver (Re-use Option D).\n-\t#25. Dynamic EAS discovery and insertion of UL-CL and local PSA happens in the V-PLMN based on available EC application information and related policies and trigger from V-EASDF.\n-\t#28 HR part. The HPLMN obtains EDI from VPLMN via interaction between H-NEF and V-NEF.\nV-SMF decides UL-CL and local UPF insertion based on V-EASDF notification (#1, #2, #3, #5, #25) while in #4, H-SMF determines the DNAI of VPLMN.\nV-SMF configures V-EASDF based on roaming offload policy from H-SMF and EAS deployment Information (#1, #2, #3, #5, #25).\nSolutions address how to forward DNS query:\n-\tuse V-EASDF handling rule by the V-SMF (#2, #5, #25 opt A);\n-\tuse Option C (#1);\n-\tV-UPF to forward the DNS queries to local DNS server/V-EASDF or home DNS server/H-EASDF (i.e. Option D) (#3, #24, #25 Opt B);\n-\talways use H-EASDF (#4, #28 HR part).\nIn solution 53, the solution describes that the network sides provide multiple DNS server IP address to UE with the precedence. One is the DNS server in VPLMN and the other is in HPLMN. Together with the DNS server from network, the precedence of each DNS server is also provided to UE. When UE triggers the DNS query, according to the precedence, the UE selects one of the DNS servers to trigger the DNS query.\nHowever, this design has some problematic and unclear issue:\n-\tFirst, if the MNO has the precedence of DNS server, why does the MNO not directly indicate the DNS server to UE and instead let the UE select?\n-\tSecond, to indicate which DNS server to select is only by the preference. However, the UE still does not know the logic why the DNS server A has higher priority than DNS server B. Also, which DNS server to select is the role of MNO, not of the UE. So, it is not needed for UE to make the choice via a complex design.\n-\tFinally, which DNS server is better to use depends on whether this FQDN in the DNS query can be resolved as an EAS IP address. This is fully internal 5GC strategy, which the UE does not understand. So, as the precedence does not have a relationship with the FQDN, and the precedence alone cannot reflect which DNS server is better to resolve the FQDN, this design does not bring much enhancement.\n4.\tRegarding the technical aspect on how to ensure proper policy control and QoS enforcement, there are four solutions (#1, #4, #5 and #26)\nWith #1, #4 and #5, regarding HPLMN policy, V-SMF receives the roaming offload policy/rules from H-PCF via H-SMF, while regarding VPLMN policy, with #26, V-SMF receives its VPLMN policy from V-PCF.\nSolution #25 proposes that in scenario 2.1, HPLMN may provide QoS policies for specific applications in the SLA, and then this will be configured in V-SMF with limitation to roamers. Alternatively, QoS rules can be conveyed to V-SMF by H-SMF during PDU Session establishment or update as specific information or as an indication to V-SMF to store the information sent to the UE in the NAS message and the QoS profile sent to gNB. In scenario 2.2, V-PCF provides local policies for V-SMF.\nIt is reasonable to support both HPLMN and VPLMN policy respectively and both can co-exist.\n5.\tRegarding the technical aspect on potential impact on Policy and QoS control:\nThe technical aspects 2 and 4 address this aspect.\n6.\tRegarding the technical aspect on how to configure the VPLMN ECS address to UE in roaming scenarios, one solution (#1) addresses this issue.\nWith #1, H-SMF sends VPLMN ECS address stored in UDM to UE via V-SMF.\n7.\tRegarding the technical aspect on how to support the edge relocation in roaming scenarios, #39 (clauses 6.39.2.1 and 6.39.2.2) addresses this issue.\nIt supports the AF triggered EAS relocation between different PLMNs. The AF sends PLMN ID corresponding to target EAS to the network, which assists to select SMF and UPF, and indicates SMF to configure traffic rule on UPF to access target PLMN. It is reasonable to support this scenario.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "7.1.3\tEvaluation for ECS address delivery aspects",
                            "text_content": "For the ECS address delivery in roaming situation (including both HR and LBO), according to and following the conclusion in Rel-17, some of the issues should be discussed:\n1.\tWhen home routed, how the AF in visited network provides the ECS address to 5GC in HPLMN, and how the AF in visited network provides the ECS address to 5GC in visited PLMN when local breakout.\n2.\tFor both HR and LBO, how to recover the UE subscription data from UDM and get the ECS address.\n3.\tHow to send ECS address to UE in both HR and LBO.\n4.\tHow to identify the ECS address to be used for UEs in different VPLMN.\nFor each of the bullets, there are two categories, including home-routed situation and LBO situation.\nFor bullet #1, the ECS address can be provided by 3rd party AF via parameter provisioning procedure, which is the Rel-17 conclusion. In Rel-18, the conclusion can still be followed:\n1a.\tFor LBO situation, the AF in the visited PLMN provides the ECS address by parameter provisioning procedure to UDM. This principle follows the design in Rel-17.\n1b.\tFor HR situation, as the home PLMN should configure the ECS address to UE in roaming, the HPLMN should obtain the ECS address provided by VPLMN in advance. There are two categories: HPLMN has the knowledge of ECS address in VPLMN and HPLMN does not have the knowledge of ECS address in VPLMN:\n-\tCategory A: In this category, HPLMN has the knowledge of ECS address in VPLMN including Sol#1 and Sol#28. Sol#1 and Sol#28: The V-AF sends application related information to H-AF, which includes the ECS address. This procedure is in scope of SA6.\n-\tCategory B: In this category, HPLMN does not have the knowledge of ECS address in VPLMN including Sol#1. Sol#1: The V-AF configures the V-SMF according to the AF influence on traffic routing procedure. In this case, during the HR PDU Session establishment, the V-SMF needs to select a PCF in the VPLMN to establish the SM Policy Association. V-PCF may send the VPLMN ECS address obtained from V-AF to V-SMF. The V-SMF sends the ECS address to H-SMF during PDU Session establishment procedure.\nFor bullet #2, as the ECS address is one of the UE subscription data stored in UDM, how to recover this information can follow the Rel-17 principle:\n2a.\tFor LBO situation, Sol#28: When UE in LBO session, the V-SMF retrieves the UE subscription data from UDM.\n2b.\tThere are two categories: HPLMN has the knowledge of ECS address in VPLMN and HPLMN does not have the knowledge of ECS address in VPLMN:\n-\tCategory A: In this category, HPLMN has the knowledge of ECS address in VPLMN including Sol#1 and Sol#28. Sol#1 and Sol#28: The H-SMF retrieves the UE subscription data including ECS address from UDM.\n-\tCategory B: In this category, HPLMN does not have the knowledge of ECS address in VPLMN including Sol#1. Sol#1: The V-SMF sends the ECS address to H-SMF during PDU Session establishment procedure. The H-SMF does not recover the UE subscription data from UDM.\nFor bullet #3, after receiving or obtaining the ECS address, the ECS address should be delivered to UE. For both the LBO and HR situations, there are two categories for UE receiving the ECS address:\n3a.\tIn Sol#28, it follows the Rel-17 principle that the V-SMF or H-SMF sends the ECS address in ePCO to UE via DL NAS message.\n3b.\tIn Sol#8, the SoR transparent container can be used to provide an FQDN or an IP Address of a V-ECS. This is a new feature to be introduced in Rel-18.\nAs the SoR has the specific function, the information in SoR transparent container is used for PLMN selection when UE in roaming. Certainly, the SoR is not designed or enhanced to support any general application layer connection. Also, the SoR is used for HPLMN to deliver the information that is unknown to VPLMN or that the HPLMN does not want the VPLMN to know. Certainly, the ECS address does not belongs to the unknown information or the information that the HPLMN does not want VPLMN to know. At last, there is no defect of delivering ECS address in ePCO to UE to solve the situation in UE roaming.\nBased on the evaluation above, there is no need to enhance the SoR. The Rel-17 principle of delivering ECS address in ePCO via DL NAS message to UE should be reused.\nFor bullet #4, as the UE can roam to different PLMNs, the ECS address should also be coordinated with the different PLMNs. For both the LBO and HR situations:\n-\tIn Sol#28: All of the ECS configuration information above should be retrieved per VPLMN ID. The AF should also provide the ECS address that is paired to the PLMN ID to UDM, and the SMF can decide to retrieve the different ECS address when UE roaming in different PLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "7.2\tEvaluation for KI#2: Fast and efficient network exposure improvements",
                    "description": "",
                    "summary": "",
                    "text_content": "Key Issue #2 is for fast and efficient network exposure improvements. Solutions #11, #12 and #13 are proposed to solve this KI.\nExposure information\nIn solutions #11 and #12, network congestion indication/level is exposed to AF by extending GTP-U header and UPF/L-NEF exposure services, same as the exposure path used in clause 6.4 of TS 23.548 [3]. Furthermore, solution #11 proposes to expose QNC for GBR QoS Flow via this path.\nReport updating threshold as proposed in Solution#11is provided to RAN, and optionally it may be provided to the PSA UPF, but the need and benefits are not clear for the second case, as pointed out in Note 1 in clause 6.11.1.\nIn solution #12, a specific QoS flow is used to expose the above information.\nIn solution #13, cell ID is exposed to AF via user plane. The current specification defined exposure of cell ID to AF as part of UE location as specified in clause 4.15.3.1 of TS 23.502 [9] is not the most optimal and efficient.\nSubscribe service\nIn solutions #11 and #13, AF uses Nnef_AFSessionWithQoS to subscribe the above information exposed by 5GC, same as local exposure mechanism defined in TS 23.548 [3]. While in solution#12, AF uses Nnef_EventExposure_Subscribe to subscribe information exposed by 5GC.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.3\tEvaluation for KI#3: Policies for finer granular sets of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "The following solutions address Key Issue 3:\n-\t#29: Use of Internal Group ID and constraints in EDI;\n-\t#30: Policies referring to \"Allowed services\" and/or \"Subscriber categories\";\n-\t#31: Providing traffic offload policy for a set of UEs with service information;\n-\t#32: Offload policy for finer granular set of UEs;\n-\t#33: AF requests offload policy for sets of UEs.\nRules to control which PDU Sessions of which users are subject to Edge computing are carried via Nnef_TrafficInfluence service and target the PCF.\n-\tSolution 30 uses \"allowed services\" and \"subscribed services\" as a means for addressing a finer granularity of UEs;\n-\tSolution 31 adds a \"service information\" as a means for selecting a finer granularity of UEs;\n-\tSolution 32 introduces \"subscribed services\" which is a logical combination of criteria, e.g. group1 AND group2;\n-\tSolution 33 introduces category information to indicate which information elements (e.g. spatial validity condition, application id…) determine the collection of UEs. Logical combinations are also possible.\nSolution 31 and part of solution 30 and/or use of External/Internal group IDs should sufficiently support the Key Issue, which means that an AF can identify a finer granularity set of UEs by means of:\n-\tExternal Group ID or a list of Exernal Group IDs;\n-\texternal representation if needed of \"Subscriber categories\" (e.g. gold / silver / bronze users);\n-\tservice information like application client category, or application-decided service level. This can be matched against allowed services by PCF.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.4\tEvaluation for KI#4: Influencing UPF and EAS (re)location for collections of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "For KI#4, the key points to address the issues include:\n1.\tHow to define and identify a collection of UEs forming a dynamic ad-hoc group that should use the same EAS and/or same local part of DN and/or same DNAI. The dynamic ad-hoc group, agreed between the 5GC and the AF (e.g. as part of a SLA) can be managed only by AF or be synchronized by both AF and 5GC using agreed targeting information.\n2.\tHow to inform the SMF the information of the same EAS and/or same local part of DN and/or same DNAI to be used. The information of the same EAS and/or same local part of DN and/or same DNAI to be used can be determined by the AF and sent to the 5GC for maintaining and using (corresponding to AF selection of common EAS/DNAI), or can be determined by the 5GC and maintained within 5GC (corresponding to 5GC selection of common EAS/DNAI). For the AF-determined DNAI/EAS, it can be sent to the UE via application layer which is out of scope of 3GPP SA2, it can also be sent to the 5GC for the routing decisions for traffic of PDU Session and the DNS handling rule decision.\nIn TS 23.548 [3], the mechanism to support \"Edge Relocation Triggered by AF\" is defined. The AF may invoke the AF request targeting an individual UE address procedure as described in TS 23.502 [9] clause 4.3.6.4 (the AF influence on traffic routing procedure), due to EAS relocation.\nIn TS 23.548 [3] and TS 23.502 [9], the solution for \"EAS (re-)discovery over Session Breakout Connectivity Model\" is described. The SMF interacts with EASDF and provides the ECS option or the Local DNS server address, related to candidate DNAI(s) for that FQDN for the UE location, as part of the rules to handle DNS queries from the UE to the EASDF, the EASDF sends DNS message to the local DNS server or sends DNS message to the centralized DNS server with ECS option. The rules to handle DNS queries from the UE can be updated based on the notified DNS Query with certain FQDN, UE mobility or PSA relocation. For the selection of the candidate DNAI for a FQDN for the UE, the SMF may consider the UE location, network topology, EAS Deployment Information and related policy information for the PDU Session provided as defined in TS 23.503 [13] clause 6.4 or be preconfigured into the SMF. The EAS Deployment Information used to construct the rule can be set per group.\nSolutions of KI#4 address one or more of the following aspects: UE collection definition, 5GC selection of common EAS/DNAI, AF selection of common EAS/DNAI.\nTable 7.4-1: Solutions addressing KI#4\n\nThus, based on the issues for KI#4 and to reuse the existing mechanism as much as possible and solve the issue for KI#4, the solutions are analysed with focus on the above three aspects.\nAspect 1: UE collection definition\nSolution #14 performs UE collection definition by group management. It utilizes Nnef_ParameterProvision (or new defined) service for AF to send GPSI list and external group ID. UDM aligns the group data and UE subscription data. UDR generates internal group ID, and stores SUPI list, internal group ID and external group ID.\nIf Nnef_ParameterProvision service is used, it shall be enhanced to support dynamic UE group management, which only supports 5G VN group or MBS group management in current specification.\nSolution #19 performs UE collection definition by group management. AF uses Nnef_ParameterProvision (or new defined) service to send group management information, including group member management parameters and group data:\n-\tGroup member management parameters: GPSI list, external group ID;\n-\tGroup data: DNN/S-NSSAI, Group Type (i.e. ad-hoc group for gaming/platooning/etc.), EAS ID, Group Attributes (e.g. same EAS/same PSA is needed/etc.).\nNEF translates external group ID into internal group ID, and stores this information in UDM.\nSolution #16, #18 and #34 use UE list, group ID or any UE, and Spatial Validity Condition to define the UE collection of specific application, which is identified by FQDN or Application ID.\nSolution #35 and #36, the collection of UEs can be identified using explicit group management extending the 5GVN group management which is similar as that described for Solution #14 and #19. The collection of UEs can also be identified with target UEs with service information. The PCF or SMF associates the UE with the collection based on the group ID or the service information via traffic routing information or EDI, and the specific service information for each PDU session received via the procedure of Service specific parameter provisioning.\nAspect 2: 5GC selection of common EAS/DNAI\nSolution #16 proposes that the SMF determines that UE belongs to the dynamic UE group when steps 1-9 of clause 6.2.3.2.2 of TS 23.548 [3] are performed, and the SMF obtains common EAS/DNAI of the UE collection, locally or retrieving from UDR. If the common EAS/DNAI has not been determined for UE collection, the SMF determines the common EAS/DNAI via the Rel-17 EAS discovery procedure, and synchronizes to UDR with the common EAS/DNAI.\nSolution #34 EDI is used for maintaining the common EAS/DNAI. SMF synchronizes common EAS/DNAI by updating EDI to NEF/UDR.\nSolution #37 UDM/UDR is used for maintaining the common DNAI/EAS as part of group information. The difference is, when common EAS/DNAI is synchronized, the UDM/UDR shall send notification to the SMF(s) that subscribed the group data (see solution #19, clause 6.19), including the common EAS/DNAI.\nSolution #15 introduces a new network function SCMF to manage the common DNAI. SMF may obtain the common DNAI either when PDU Session is established (pre-invoke of SCMF) or when reported DNS Query by EASDF (dynamic invoke of SCMF). The SMF sends EASDF information to build ECS option or L-DNS server address according to the common DNAI. Then rest of procedure in clause 6.2.3.2.2 of TS 23.548 [3] are performed. Solution #15 only deals with common DNAI case.\nSolution #18 assumes that the UE group is served by a single SMF. When reported DNS Query, the SMF responds to the EASDF with either the common EAS, or the same information to build ECS option or L-DNS server address as other member(s) of the dynamic UE group.\nAspect 3: AF selection of common EAS/DNAI\nSolution #15 proposes both 5GC and AF selection ways, and only AF selection procedure is evaluated in this aspect.\nSMF selects UPF according to common DNAI obtained from SCMF, and notifies the common DNAI to AF as target DNAI via UP path change event. Then AF sends \"group FQDN\" corresponding to the common DNAI to UE via application layer. UE solves common EAS via DNS. If common DNAI is updated, SMF gets notified by SCMF, and the above is repeated.\nSolution #17 proposes that AF determines members of the dynamic UE group. For each group member UE, AF sends request to the SMF for candidate DNAI(s) via PCF. SMF notifies AF the candidate DNAI(s). AF selects common DNAI and common EAS according to the candidate DNAI(s) from all the SMF(s). Then AF sends the common DNAI to each SMF via AF influence traffic procedure, and sends the address of the common EAS to each UE via application layer.\nSolution #35 and #36 propose a solution to support the case that AF determines common EAS/DNAI for certain application for dynamic UE group. The common EAS/DNAI is sent to the SMF via PCC rule or EAS Deployment Information, and the SMF uses the common DNAI/EAS for the routing decisions for traffic of PDU Session and the DNS handling rule decision. In Solution #35, the common EAS/DNAI for the collection of UEs is received via traffic routing information. The PCF associates the UE accessing the application with the collection of UEs using the same DNAI/EAS, and the PCF sends the PCC rule with the common EAS/DNAI to the SMF. In Solution #36, the common EAS/DNAI for the collection of UEs is received via EAS Deployment Information, and the SMF associates the UE accessing the application with the collection of UEs using the same DNAI/EAS.\n",
                    "tables": [
                        {
                            "description": "Table 7.4-1: Solutions addressing KI#4",
                            "table number": 17,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.5\tEvaluation for KI#5: GSMA OPG impacts and improvements for EHE operated by separate party",
                    "description": "",
                    "summary": "",
                    "text_content": "The solutions addressing Key Issue #5 can be split into two categories:\n1.\tsolutions that enable the discovery of an EAS deployed in another PLMN than the one serving the UE, and\n2.\tsolutions that facilitate the edge relocation between PLMNs.\nSolutions to enable the discovery of an EAS deployed in another PLMN than the one serving the UE.\nThis category of solutions encompasses Solution #20, Solution #21, Solution #22, Solution #38 and Solution #40. All solutions assume that the involved PLMNs are part of an GSMA OP federation and/or that there is a controlled inter-PLMN IP connectivity between the PLMN serving the UE and the PLMN hosting the EAS.\nSolution #20 is based on the usage of the newly defined Global EASDF which can directly resolve the DNS query sent by the UE to discover the shared EAS (which can be deployed in any PLMN) or can first resolve the DNS query sent by the UE to discover the EASDF able to provide the IP address of the shared EAS. Both options require the UE to be configured with the Global EASDF's URL and to resolve it to obtain the Global EASDF's IP address. Because of that these two options are inconsistent with the Rel-17 EAS discovery procedure described in TS 23.548 [3] clause 6.2.3.2.2 (which, on the contrary, assumes that the EASDF's IP address is provided by the SMF via ePCO during PDU Session establishment/modification). In addition, the second option is incompatible with the Rel-17 EAS discovery because it requires the UE to obtain the EASDF's IP address by sending a DNS query to the Global EASDF, while the Rel-17 EASDF in the PLMN has no role to play.\nSolution #22 describes three alternative options: Option 0 (based on the SMF configuration to know the EAS deployment information of the EAS running on other PLMN's edge infrastructure, e.g. IP address range(s)/FQDN(s)), Option 1 (based on the usage of the Shared EASDF which stores the EDI of each EAS running in each PLMN sharing Edge Nodes) and Option 2 (which relies on inter-PLMN inter-EASDF communication to resolve the DNS Query for an EAS hosted by another PLMN). Option 2 requires storing in the NEF/UDR/SMF/EASDF an additional filtering information (PLMN ID and DNS server address/FQDN filter) for the EAS' deployed in another PLMN – such information is essential to locate the EAS during the EAS discovery procedure. Solution #22 has no impact on the UE, but, depending on the option, it affects the CN entities to different degrees.\nSolution #38 relies on the AF to provide extended EAS Deployment Information (EDI) which includes N6 traffic routing information to the PLMN hosting the EHE. After having been translated by the NEF of the original PLMN and sent to the PLMN serving the UE, the extended EDI is stored in the UDR of the PLMN serving the UE. The SMF of the serving PLMN can then use such EDI to find the EAS hosted in the other PLMN. Similar to Solution #22, this solution has no UE impacts.\nSolution #40 has a similar concept to Option 2 of Solution #22, in that it forwards the DNS query from the EASDF of the PLMN serving the UE to the EASDF of the PLMN hosting the EHE, if the former cannot find it. Differently from Solution #22 though, the inter-EASDF communication takes place via SMF and NEF. In addition, Solution #40 proposes the use of additional information (S-NSSAI, DNN, UE location and External Group ID) to allow the SMF in the PLMN hosting the EHE to find the proper EASDF.\nSolution #21 ensures that an EAS deployed by a certain operator in a VPLMN's EHE can only be discovered and accessed by the UE of that operator while roaming in local breakout to the VPLMN. To do this, the solution the AF to provide, together with the EAS Deployment Information, the PLMN ID of the EAS owner so that the SMF can match it with the UE's HPLMN ID when the EAS discovery is triggered. This solution, however, does not seem to address the ENS (Edge Node Sharing) deployment which allows OP B to deploy Edge Computing applications in the Operator A's EHE, without restricting the access to it to only OP B's UEs.\nSolutions to enable the EAS relocation for shared EHE\nSolution #23 proposes to support the scenario of EAS relocation between EHE deployed by a source EHE provider to another EHE deployed by a target EHE provider, even in scenarios when EHEs are operated by different service providers. It needs the NRF or NEF maintains parameters for each AF, e.g. EHE domain it supports, service area, etc. Then SMF selects suitable target AF. The impact is introduced on 5GC and no impact on UE.\nSolution #39 proposes to support the scenario EAS relocation between EHEs deployed in different PLMNs. The AF sends corresponding PLMN ID to network to indicate the EAS should be relocated to the target PLMN, and based on retrieval of PLMN ID, SMF selects UPF to access target EAS via controlled IP network. The impact is introduced on 5GC and no impact on UE.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.6\tEvaluation for KI#6: Avoiding UE to switch away from EC PDU Session",
                    "description": "",
                    "summary": "",
                    "text_content": "There are nine solutions provided for this key issue, Solutions #41 to #49.\nClause 5.6.2 lists some problematic scenarios that should be covered:\n-\tnon-integrated access, where re-connecting to the 5GS is not possible, e.g. because lack of UE support or an N3IWF could not be discovered or connected to and these Edge Computing enablers can only be reached via the 5GS;\n-\tre-connecting to the 5GS is possible but results in long UP paths because of e.g. a centralized N3IWF;\n-\tsession breakout scenarios where an UL-CL and L-PSA is used to obtain EC connectivity and switching to an access that is not integrated with 5GS would therefore break the EC connectivity.\nIn the first case, connecting to non-integrated WIFI access should be avoided if the 5GS applies Edge Computing enablers. This could be achieved, as different solutions propose, e.g. by an indication from the 5GC to the UE to avoid switching away to non-integrated WIFI access.\nWhether the application still gets access to application server via non-integrated access can depend also on factors outside of 5GC control, such as the IP latency form the WIFI POP to the EHE, the EHE connectivity configuration or transport protocol used between the UE applications and local application server (e.g. QUIC can provide service continuity during access change, but TCP cannot). It may depend on application functionality (e.g. RTT measurements over the different accesses) whether the application could leverage on using non-integrated WIFI. The application may, however, benefit from an indication whether the 5GC currently applies EC treatment: this may trigger the application logic to control its traffic over different accesses, e.g. based on latency monitoring as proposed in Solution #42.\nIn the second and third cases above, even (re-)connecting to 5GC via non-3GPP access should be avoided. In these cases, the 5GC has the information to decide whether this is needed or not so the 5GS may again send an indication to the UE to avoid switching to non-3GPP access.\nThere are different alternatives proposed to send an indication from 5GS to avoid switching away to non-integrated WIFI access:\n1.\tvia existing URSP rules: Solution #41 proposes to apply the existing URSP rules to control non-seamless WIFI offload. As stated in clause 6.1.2.2.1 of TS 23.503 [13]: \"If the UE has an URSP rule (except the URSP rule with the \"match all\" Traffic descriptor) that matches the application as defined in clause 6.6.2.3, the UE shall perform the association of the application to the corresponding PDU Session or to Non-Seamless Offload or ProSe Layer-3 UE-to-Network Relay Offload according to this rule\". That is, if 5GC defines policy rules for non-seamless offload for some traffic in the RSD, then the UE should apply these rules for that traffic in the corresponding PDU Session. For session breakout, if an update of traffic descriptors in URSP rules is required, the resulting rule will possibly not be acted upon by the UE immediately. The ATSSS rules can be configured for more refined control of traffic steering if the conflicting non-3GPP access is integrated. The solution can achieve this outcome without any impacts to the specifications. However, in this solution, the UE is not made aware whether any of the edge enablers are configured for the 3GPP access.\n2.\tvia a new attribute in URSP rules: Solution #48 proposes an \"edge-anchored\" indication in URSP RSD(s). The principle of Solution #48 is that an indication may be added to the URSP Rules to indicate that any PDU Session that is associated with the RSD is possibly using a PSA UPF that is in a local site. Solution #48 only applies to the scenario where it is known that a PDU Session that is associated with certain Traffic Descriptors or DNN/S-NSSAI combinations will always access edge computing resources that cannot be accessed if the UE switches to an access that is not integrated with the 5GS. The solution makes no reference whether the URSP can be updated based on the AF guidance at run time. Solution #49 proposes to dynamically indicate \"ongoing traffic offload\" in the RSD. This is based on AF provisioning as part of Application Guidance for URSP determination as described in clause 4.15.6.10 of TS 23.502 [9], and/or based on PCF decision due to an offloading of EC traffic to a local Data Network. With received indication in the URSP, and considering its user preferences, the UE may accordingly decide to continue using the ongoing PDU Session for EC traffic.\n3.\tas a new indication via PCO: the principle of Solution #47 is that the SMF is aware of whether the PDU Session uses a PSA UPF in local site and the SMF can send an \"edge-anchored\" indication to the UE that indicates that the PDU Session uses a PSA UPF that is in a local site and also a \"5GC-preference\" indication that indicates that the network prefers to keep the traffic in the 5GC. The indications can be per Flow Descriptor(s).\n4.\tas a new indication coupled to EDC attributes: Solution #44 proposes that the ability for network to control UE's traffic offloading decision is dependent on UE capability and UE's subscription. The UE may indicate to the SMF its capability to support the EDC functionality and to control application traffic switching via ePCO. If the UE subscription information includes EAS traffic switching information, the SMF indicates to UE that EAS traffic switching control is required. The solution proposes this capability to be linked to the EDC functionality, but EDC which is handling DNS queries from the UE will possibly not have visibility of the actual application traffic and cannot enforce traffic routing rules.\nNOTE 1:\tSolution #44 is similar to Solution #47. Solution#46 also proposes indication to the UE that the PDU Session is using edge computing functionality of the network, but it is not explicitly stated how this indication is conveyed. The UE decision of traffic switching cannot be enforced as stated in the solution since it may happen in upper layers.\nThere are two potential alternatives to send the indication to UE whether the 5GC currently applies EC treatment for some traffic:\n1.\tas a new indication via PCO. Solution#47 proposes an \"Edge-anchored\" indication;\n2.\tvia a new attribute in URSP rules. See point 2 above.\nProviding an indication to the UE to avoid switching to non-3GPP access has been proposed in two solutions:\n-\tSolution#41 proposes to apply the existing URSP rules for this, i.e. setting the Access Type Preference to \"3GPP\" for the given EC traffic. Besides, for MA PDU sessions, it proposes to use the ATSSS rules to avoid going to non-3GPP access.\n-\tSolution #47 proposes that this type of indication could be also sent via PCO. This could be needed in the cases when a dynamic update needed for an existing PDU session where URSP rules would be difficult to update.\nOther solutions include:\n-\tSolution#42 proposes a new \"WLAN Offload Guidance\" indication in the Route Selection Descriptor to indicate to the UE that offloading edge computing traffic matching the Traffic Descriptor for this URSP rule to integrated non-3GPP access is conditional to the evaluation of conditions informed by the network. The UE may then perform RTT measurements on the non-3GPP path and use the measurements to help decide if integrated non-3GPP access should be used. It is not clear what the benefit of this approach is compared to when the application measures RTT directly to EAS over the different accesses. This solution requires that Application Server also supports the best path selection in the UE by configuring performance measurement parameters to compute RTT over 3GPP and non-3GPP paths.\n-\tSolution#43 provides two approaches:\n1.\tSMF rejects the PDU Session establishment from non-3GPP access if it is handling EC traffic. This reuses the handover procedure defined in clause 4.9.2 of TS 23.502 [9]. If the UE uses the PDU Session ID of 3GPP access to trigger the PDU Session establishment in non-3GPP, the SMF rejects this establishment and the EC-session is still kept in 3GPP access. This requires UE support, i.e. keeping the old PDU Session on the 3GPP access while attempting to establish a PDU Session on the non-3GPP access, which likely requires multi PDU Session capable UEs. The SMF can know whether this session is EC or not according to the former notification from EASDF about the FQDN and EAS IP address. The SMF which decides the rejection and the SMF involved in session creation during the DNS related procedure are the same. This requires a new logic in the SMF.\n2.\tThe UE decides to perform a PDU Session handover according to NWDAF analytics. This does not require the UE registration to non-3GPP, only if there is another device available that the analytics can rely on. The analytics can either the historic/real-time analytics or the prediction but the real-time analytics is what could provide sufficient reliability. The analytics can indicate to the UE or 5GC which kind of access is better for the EAS. This will avoid that the EC-traffic is directly kept unconditionally on 5GS, as the 5GS might have low coverage or poor signal. Performance comparation between the non-3GPP access and 5GS is necessary.\n-\tSolution#45 proposes an application-based solution to select/bind to a proper network interface for communication. This solution does not require SA2 standardization. Note that it assumes that the application is aware that it uses an EC service, which also calls for an indication to the UE (conveyed by the UE to the Application) that the 5GC currently applies EC treatment. It should also be noted that for operator deployed services, application clients can be designed to use this mechanism.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.7\tEvaluation for KI#7: Obtain and maintain mapping table between IP address/IP range with DNAI",
                    "description": "",
                    "summary": "",
                    "text_content": "There are 3 solutions (solutions #50, #51 and #52) addressing KI#7: \"Obtain and maintain mapping table between IP address/IP ranges with DNAI\".\nThe main differences among these solutions are two aspects:\n1.\twhich NF determines DNAI,\n2.\twhat parameter(s) AF provides to NEF.\nFor aspect 1:\n- \tSolution #50 proposes that SMF is configured with mapping information between EAS IP address(es)/IP range(s) and DNAI(s), and determine DNAI. NEF can cache the mapping information.\n-\tSolution #51 proposes that UDR/NEF stores EDI. NEF determine target DNAI based on EAS IP address in AF queries.\n-\tSolution #52 proposes that NEF determines target DNAI based on NF local configuration. NEF may obtain target DNAI from UDR.\nFor aspect 2:\n-\tSolution #50: (mandatory) EAS IP address/IP range, (optional) DNN, S-NSSAI, geographical area.\n-\tSolution #51: (mandatory) EAS IP address/IP range, (optional) DNN, S-NSSAI.\n-\tSolution #52: (mandatory) EHE information (i.e. at least one of EAS IP address/IP range, FQDN(s), (local) DNS server address), (optional) DNN, S-NSSAI.\nEvaluation of the solutions\nFor aspect 1, on which NF determines DNAI:\n-\tSince mapping relationship between IP address/FQDN and DNAI is kind of network deployment information and independent from session management, SMF is not the proper NF for the determination of DNAI. AF can request such a map without any PDU Session established beforehand. Therefore, NEF is more suitable for such a mapping service.\nFor aspect 2, on what parameter(s) AF provide to NEF:\n-\tAccording to the description of the key issue, IP address/IP range or FQDN may be provided by AF to obtain DNAI. DNN, S-NSSAI, and geographical area can be used optionally to obtain corresponding DNAI.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "8\tConclusions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "8.1\tConclusion for KI#1: Accessing EHE in a VPLMN when roaming",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "8.1.1\tConclusion for scenario 1 (via LBO PDU Session)",
                            "text_content": "To support the establishment of an LBO PDU Session towards the correct DNN/S-NSSAI to access an EHE in the VPLMN, URSP based solution is preferred. Key Issue 1 of TR 23.700-85 [10] is studying URSP rule provisioning and updating procedures in roaming scenarios. Therefore, the conclusions of Key Issue 1 of TR 23.700-85 [10] will take in account the conclusions of this clause.\nIn order to support scenarios where the EHE is accessed via an LBO PDU Session, it is concluded that URSP related procedures should be enhanced as follows:\n-\tPLMN ID(s) should be sent with URSP rules. How the PLMN ID(s) are included is defined in the conclusion of Key Issue #1 of TR 23.700-85 [10].\n-\tWhether the UE can be sent URSP rules that is applicable in the VPLMN before the UE is served by the VPLMN will be defined in the conclusion of Key Issue #1 of TR 23.700-85 [10].\nNOTE 1:\tNormative work for the bullets above will take place within the scope of a WID that is based on the conclusions of FS_eUEPO Key Issue #1. It will be decided in FS_eUEPO Key Issue #1 whether a new trigger for URSP re-evaluation is needed.\nNOTE 2:\tThe agreement that the normative work for this KI#1/LBO will take place within the WID for FS_eUEPO depends on whether the conclusion for KI#1 FS_eUEPO fulfils the conclusion listed in this clause. If this is not the case, the normative work to fulfil this conclusion will have to take place within the WID for EDGE_Ph2.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.1.2\tConclusion for scenario 2 (via HR PDU Session)",
                            "text_content": "Regarding KI#1 scenario 2, it is concluded with the following principles:\n1.\tAuthorization:\nAMF can get SMF Selection Subscription data with indication for HR-local traffic routing allowed during registration procedure, in order to help AMF select the proper SMF. V-SMF sends the HR PDU session establishment request to H-SMF, H-SMF authorizes the local traffic routing request for this PDU Session based on subscription data and provides HR-local traffic offloading authorization information (e.g. allowed FQDN ranges) to V-SMF. The V-SMF configures V-EASDF taking into account this authorization information.\nAfter authorizing the local traffic routing in VPLMN, the H-SMF sends VPLMN-specific roaming offload policy including traffic description information, e.g. FQDN range, EAS IP range and the session-related policy to the V-SMF if configured in HPLMN based on the service level agreement between VPLMN and HPLMN.\n2.\tCharging.\nNOTE 1:\tIt will be described how V-SMF supports charging for the local traffic of a PDU Session that supports local traffic routing to access an EHE in the VPLMN and whether it reports to V-CHF as well as to H-SMF in coordination with SA5 during normative phase.\n3.\tEAS discovery:\nV-SMF decides UL-CL/BP and local UPF insertion based on V-EASDF notification and UE location. The V-SMF interacts with the H-SMF for UL CL/BP and local UPF insertion as described in clause 4.23.9.1 of TS 23.502 [9] by replacing I-SMF with V-SMF and SMF with H-SMF.\nFor Options A and B as specified in clause 6.2.3.2.2 of TS 23.548 [3], with the following differences:\nV-SMF configures V-EASDF based on roaming offload policy from H-SMF and EAS Deployment Information from AF deployed in VPLMN via V-NEF and/or local configuration in V-SMF and the DNS server address of HPLMN received from HPLMN.\nThe V-SMF sends the V-EASDF address to the H-SMF for the H-SMF to create PCO for the UE during PDU Session Establishment/Modification procedure.\nOptions C and D specified in clause 6.2.3.2.3 of TS 23.548 [3] can be used to route some unencrypted DNS messages after the UL-CL is inserted for the PDU Session for HR roaming scenarios, with the following differences:\n-\tFor Option C, the V-SMF sends the local DNS server address to the H-SMF for the H-SMF to create PCO for the UE during PDU Session Establishment/Modification procedure.\n-\tFor Option D, the H-SMF sends H-DNS server address included in PCO to UE via V-SMF during PDU Session Establishment/Modification procedure. The DNS query related to the edge computing (corresponding to FQDNs) can be routed to V-EASDF/Local DNS server in the VPLMN reusing IP replacement mechanism. In case of routing to V-EASDF, V-UPF replaces the destination IP address of DNS query (corresponding to FQDNs) to V-EASDF and routes this DNS query to V-EASDF, the EAS discovery procedure with V-EASDF which implements the functions of EASDF refers to TS 23.548 [3]. For the DNS query requiring DNS resolution in the HPLMN, the DNS resolution path is same as the normal path in the HR PDU Session. The procedure and restriction of Option D defined in clause 6.2.3.2.3 of TS 23.548 [3] still apply in the HR roaming case.\n4.\tEAS (Re-)discovery:\nFor UE mobility triggered EAS Re-discovery for both inter-PLMN and intra-PLMN:\nThe V-SMF uses the existing procedure defined in clause 4.23.9 of TS 23.502 [9] by replacing I-SMF with V-SMF and SMF with H-SMF to send target DNAI (if available), with the difference that V-SMF may optionally send also the impact field and optionally target V-EASDF to the H-SMF.\nThe H-SMF triggers the PDU Session Modification procedure as described in TS 23.502 [9] and TS 23.548 [3] to send EAS rediscovery indication, optionally impact field and optionally V-EASDF to UE.\nFor AF triggered EAS Re-discovery for an AF interacting with HPLMN:\nThe AF deployed in VPLMN acting as 3rd party AF interacts with H-SMF via H-NEF and provides the target DNAI to the H-SMF.\nThe H-SMF sends target DNAI information including the target DNAI to the V-SMF that relays this information to the AMF, and the AMF uses the target DNAI to select a target V-SMF as described in clause 4.23.5.4 of TS 23.502 [9] by replacing I-SMF with V-SMF, SMF with H-SMF.\nThe target V-SMF selects target V-EASDF based on the target DNAI as described in clause 6.3.23 of TS 23.501 [2] and initiates PDU Session Modification procedure to trigger EAS re-discovery.\nNOTE 2:\tThe baseline procedure for AF triggered EAS Re-discovery for an AF interacting with VPLMN will be determined in normative phase.\n5.\tFor edge relocation in roaming scenarios, the AF sends PLMN ID corresponding to target EAS to the network, and an inter-PLMN relocation indicator is transferred between V-SMF and H-SMF to indicate that the EAS relocation is between HPLMN and VPLMN.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "8.1.3\tConclusion for ECS Address Configuration Information delivery",
                            "text_content": "1.\tECS Address Configuration Information (EACI) provision by the AF to 5GC:\n-\tFor the LBO case, the AF in the visited PLMN provides the EACI by using the parameter provisioning procedure to UDM. This principle follows the design in Rel-17.\n-\tFor the HR case when access to EHE in VPLMN is allowed, there are two categories:\n1.\tthe HPLMN has the knowledge of EACI in the VPLMN.\nIn this case, it is assumed that an AF deployed in the HPLMN provides the EACI to the HPLMN (i.e. UDM) as per Rel-17.\nNOTE:\tSA WG2 is not going to define how an AF deployed in the HPLMN can know the EACI that applies in a given VPLMN.\nIn the UDM and UDR, the subscription data of EACI is stored per PLMN ID.\n2.\tHPLMN does not have the knowledge of EACI in VPLMN.\nIn this case, the AF deployed in the VPLMN provides the EACI in the VPLMN to the V-SMF via the V-NEF. During the HR PDU Session establishment, the V-SMF sends the VPLMN EACI obtained from V-AF to the H-SMF.\n2.\tProvision of the EACI to the UE:\n-\tThe V-SMF (for the LBO case) or the H-SMF via the V-SMF (for the HR case) provides the UE with the EACI as indicated in step 11 in figure 4.3.2.2.1-1 of TS 23.502 [9].\n-\tFor the HR case, the V-SMF does not modify, but just delivers the EACI provided by the H-SMF.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "8.2\tConclusion for KI#2: Fast and efficient network exposure improvements",
                    "description": "",
                    "summary": "",
                    "text_content": "To support fast and efficient network exposure the conclusion for Key Issue #3 of TR 23.700-60 [21] (5GS information exposure for XR/media Enhancements) is endorsed.\nNOTE 1:\tNormative work will take place within the scope of a WID that is based on the conclusions of FS_XRM Key Issue #3.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.3\tConclusion for KI#3: Policies for finer granular sets of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "Normative specifications related to KI#3 will be based on following principles:\n1)\tthe 5GC and the AF may (as part of a SLA) agree on a Target Category information that is an abstract value (whose values are not specified by 3GPP) and that may represent a combination of a list of External group Identifiers or any UE, and (\"Subscriber categories\" and/or service information).\nWhether 5GC actually exposes the internal representation of \"subscriber categories\" or some external representation is to be used, will be decided in normative phase.\nThe combination may e.g. refer to users members of Group Id = X and Y and also having a certain \"Subscriber category\" for example \"Gold\", or any UE having subscriber category set to e.g. \"Silver\".\n2)\tThe NEF may, based on local policies, determine a combination of a list of group Identifiers or any UE, and (\"Subscriber categories\" and/or service information), that is to be associated with the Target Category in an incoming Nnef_TrafficInfluence service request.\nOnly the NEF needs to be aware of Target Category and SLA with the application.\nNOTE:\tThe NEF is the 5GC NF where policies per AF are configured.\n3)\tAF may provide a list of group IDs in AF request for providing policy for UEs belong to all the groups in the list.\n4)\tThe data stored by NEF in UDR (as part of step 3a of figure 4.3.6.2-1 of TS 23.502 [9]) and the information sent by UDR to the PCF (as part of step 4 of figure 4.3.6.2-1of TS 23.502 [9]) may refer to a combination of Group Ids or any UE, and (service information and/or \"Subscriber categories\").\n5)\tThe PCF is impacted by the work on this key issue as the policies it gets from UDR may refer to a combination of a list of Group Ids or any UE and (service information and/or \"Subscriber categories\").\n6)\tThe SMF, EASDF and UPF are not impacted by normative work on this KI.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.4\tConclusion for KI#4: Influencing UPF and EAS (re)location for collections of UEs",
                    "description": "",
                    "summary": "",
                    "text_content": "KI#4 shall be concluded by the three aspects: UE collection definition, 5GC selection of common EAS/DNAI, AF selection of common EAS/DNAI.\nUE collection definition\nThe selection of a common DNAI/EAS map apply to a collection of PDU Sessions that are accessing the same application and are using the same DNN, and are established by UEs in the UE collection.\nThe UEs in the UE collection are identified by a UE list, group ID or any UE may be used. Optionally, Spatial Validity Condition, may be used to limit the UEs in the UE collection to a specific area.\nThe dynamic group management may be used to manage the UEs in the UE collection, and Nnef_ParameterProvision service for 5G VN group management is extended to support the dynamic group management other than that specific for 5G VN group.\nNOTE 1:\tThe details to differentiate 5GVN group and general dynamic group, e.g. using Group Type indication, can be decided in the normative phase.\nIndication for traffic correlation, and optionally with Correlation ID, for using common DNAI/EAS as part of the Traffic influence information is provided to indicating the UE collection using common DNAI/EAS.\nThe SMF determines that the UE belongs to a collection of UEs accessing the application based on the following:\n-\tthe indication for traffic correlation in the PCC Rule with eas_correlation indication/dnai_correlation indication, Correlation ID, and:\n1)\tthe FQDN in the DNS Query reported to the SMF matched with FQDN(s) as indicated in the EAS Deployment Information and the Service data flow template of the PCC Rule with the indication for traffic correlation; or\n2)\tthe traffic to be routed matched with the Service data flow template of the PCC Rule with the indication for traffic correlation.\nNOTE 2:\tWhether correlation ID as a generic value, or Internal Group ID will be used to correlate a collection of UEs will be decided in normative phase.\n5GC selection and enforcement of common EAS/DNAI\nFor solutions using 5GC NFs to manage the common EAS/DNAI, it is concluded that:\n-\t5GC selection of the common DNAI for UE collection shall be supported;\n-\t5GC selection of a common EAS for a collection of UEs shall be supported;\n-\tUDM/UDR is used for storing the common EAS/DNAI.\nFor the common EAS/DNAI selection, it is concluded that:\n-\tSMF selects the common EAS/DNAI considering both multiple SMFs and single SMF cases.\nNOTE 3:\tThe detailed procedure to be used to consider multiple SMFs for common DNAI/EAS selection in 5GC is decided in normative phase.\nFor the common EAS/DNAI maintenance within 5GC, it is concluded that:\n-\tUDM/UDR is used for storing the common EAS/DNAI;\n-\t5GC enforcement of common EAS/DNAI is applicable to single as well as multiple SMFs cases.\nFor the using of common DNAI/EAS, it is concluded that:\n-\tfor using common DNAI for Traffic routing handling:\n-\tin case of Distributed Anchor connectivity model, the SMF may change the PSA of the PDU Session to a PSA that provides connectivity to the common DNAI;\n-\tin case of Session Breakout connectivity model, the SMF triggers UL-CL/BP and L-PSA insertion as specified in clause 6.2.3.2.2 in TS 23.548 [3].\n-\tfor using common DNAI/EAS for EAS (re)discovery:\n-\tfor EAS (Re-)discovery over Session Breakout Connectivity Model using EASDF, the common DNAI can be used as input for DNS handling rule construction:\n-\tfor Option A, the SMF configures the EASDF to insert an EDNS Client Subnet option to the DNS Query. The EDNS Client Subnet option refers to a location that is topologically close to the common DNAI;\n-\tfor Option B, the SMF configures the EASDF to forward the DNS Query to a common Local DNS server or a Local DNS related to the common DNAI;\n-\tfor Option C, the SMF provides the address of Local DNS server corresponds to common DNAI to UE;\n-\tif a common EAS IP address is applicable to the collection of UEs and if the IP address of the common EAS is determined e.g. using EAS discovery procedure, the SMF configures the EASDF with DNS handling rules for the collection of UEs to directly respond with the IP address of the common EAS in response to the DNS Query;\n-\tfor common EAS, the SMF may initiate EAS re-discovery to the UE.\nNOTE 4:\tThe control of the validity of the common EAS stored in 5GC can be discussed and decided in normative phase.\nAF selection of common EAS/DNAI\nAs an option, AF could determine the common EAS/DNAI for the UE collection and provide the common EAS/DNAI to 5GS. For this aspect, it is proposed that:\n-\tAF selection of the common EAS/DNAI for UE collection shall be supported by 5GC;\n-\tAF can determine the common EAS/DNAI, e.g. based on candidate DNAI(s) obtained from SMF(s);\nNOTE 5:\tThe information used by the AF to determine common DNAI/EAS to be standardised is to be decided in normative phase.\n-\tAF may provide common DNAI/EAS for the UE collection as part of AF traffic influence data, or AF provides common EAS ID applicable to the group as part of group provisioning procedure.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.5\tConclusion for KI#5: GSMA OPG impacts and improvements for EHE operated by separate party",
                    "description": "",
                    "summary": "",
                    "text_content": "To enable the discovery of an EAS deployed by the serving Operator's OP on cloud resources provided by another PLMN or partner (i.e. the Edge Node Sharing Scenario as described in GSMA OPG.02 [5], the following is recommended as baseline for normative work.\nEAS Deployment Provision\nThe serving PLMN is provided with the information needed to support UEs to discover and connect to the shared EHE deployed in the hosting network. In particular, the serving SMF may either store:\n-\tthe FQDN(s), DNS Server Information, and/or DNAI(s) of the EAS Deployment Information (EDI, see TS 23.548 [3] clause 6.2.3.4-1). Depending on GSMA OPG feedback, a Partner ID (e.g. PLMN ID) to identify to which partner that EDI corresponds to may also be included. Such EDI information can be preconfigured in the serving SMF or provided by the AF.\nThe serving SMF configures EASDF according to EDI based on Rel-17 methods (see TS 23.548 [3]).\nThe DNS server can be selected by SMF by considering the UE location as described in Rel-17 TS 23.548 [3].\nEAS Discovery Procedure\nThe EAS discovery procedure defined in TS 23.548 [3] will be reused.\nTraffic transmission between two PLMNs\nWhen the traffic transmitted between two PLMNs, the UPF in serving PLMN should support mechanisms to facilitate low latency transmission. N6 routing information (as defined in TS 23.501 [2] clause 5.6.7) could be included in EDI for routing specific edge.\nNOTE:\tHow to support charging in EHE sharing scenario will be specified by considering GSMA OPG's feedback. Some cooperation with SA5 may be needed.\nEdge Relocation\nFor edge relocation in GSMA OPG scenario, the EAS reselection methods should be the same as the initial selection.\nEdge relocation within the same hosting PLMN's EHE is supported, with the principles below:\n1)\tSMF initiates AF/EAS relocation and selection of the target EHE e.g. due to UE mobility;\n2)\tSMF determines AF in the target EHE domain corresponding to the UE target location based on service area or EHE domain supported by AF;\n3)\tnotification of User plane management event procedure is enhanced to support AF/EAS change (Sol #23, see clause 6.23).\nEAS relocation between different PLMNs' EHE depends on GSMA feedback. Depending on the feedback, for different PLMNs case:\n1)\tthe AF initiates EAS relocation (e.g. due to AF internal triggers) and sends PLMN ID corresponding to target EAS to the network for indicating the EAS should be relocated to the target PLMN (identified by PLMN ID);\n2)\tthe PCF creates the PCC rule including PLMN ID (if PCF authorizes that the traffic routing in the target PLMN is allowed);\n3)\tthe SMF determines the target DNAI for accessing target PLMN.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.6\tConclusion for KI#6: Avoiding UE to switch away from EC PDU Session",
                    "description": "",
                    "summary": "",
                    "text_content": "It has been concluded not to pursue KI#6 for the normative phase.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "8.7\tConclusion for KI#7: Obtain and maintain mapping table between IP address/IP range with DNAI",
                    "description": "",
                    "summary": "",
                    "text_content": "The following are recommended as baseline for normative work:\n-\tNEF/UDR is configured by OAM with the mapping information between EAS IP/IP range and DNAI.\n-\tAF requests to NEF to obtain DNAI by providing EAS IP/IP range and/or FQDN and optionally DNN, S-NSSAI, and geographical area. NEF checks the authorization of AF and obtains DNAI locally or from UDR. NEF responses DNAI to AF.\n-\tOnce the mapping information between DNAI(s) and EAS IP /IP range is changed or removed, AF can get the notification from NEF.\n\n\n",
                    "tables": [
                        {
                            "description": "",
                            "table number": 18,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        }
    ]
}