{
    "document_name": "33515-i10.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\nIn the present document, modal verbs have the following meanings:\nshall\t\tindicates a mandatory requirement to do something\nshall not\tindicates an interdiction (prohibition) to do something\nThe constructions \"shall\" and \"shall not\" are confined to the context of normative provisions, and do not appear in Technical Reports.\nThe constructions \"must\" and \"must not\" are not used as substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as possible, and they are not used in a normative context except in a direct citation from an external, referenced, non-3GPP document, or so as to maintain continuity of style when extending or modifying the provisions of such a referenced document.\nshould\t\tindicates a recommendation to do something\nshould not\tindicates a recommendation not to do something\nmay\t\tindicates permission to do something\nneed not\tindicates permission not to do something\nThe construction \"may not\" is ambiguous and is not used in normative elements. The unambiguous constructions \"might not\" or \"shall not\" are used instead, depending upon the meaning intended.\ncan\t\tindicates that something is possible\ncannot\t\tindicates that something is impossible\nThe constructions \"can\" and \"cannot\" are not substitutes for \"may\" and \"need not\".\nwill\t\tindicates that something is certain or expected to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nwill not\t\tindicates that something is certain or expected not to happen as a result of action taken by an agency the behaviour of which is outside the scope of the present document\nmight\tindicates a likelihood that something will happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nmight not\tindicates a likelihood that something will not happen as a result of action taken by some agency the behaviour of which is outside the scope of the present document\nIn addition:\nis\t(or any other verb in the indicative mood) indicates a statement of fact\nis not\t(or any other negative verb in the indicative mood) indicates a statement of fact\nThe constructions \"is\" and \"is not\" do not indicate requirements.\n\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document contains requirements and test cases that are specific to the SMF network product class. It refers to the Catalogue of General Security Assurance Requirements and formulates specific adaptions of the requirements and test cases given there, as well as specifying requirements and test cases unique to the SMF network product class.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TS 23.501: \"System Architecture for the 5G System\".\n[2]\t3GPP TS 33.117: \"Catalogue of general security assurance requirements\".\n[3]\t3GPP TS 23.060: \"General Packet Radio Service\".\n[4]\t3GPP TR 33.926: \"Security Assurance Specification (SCAS) threats and critical assets in 3GPP network product classes\".\n[5]\t3GPP TS 29.281: \"General Packet Radio System (GPRS) Tunnelling Protocol User Plane (GTPv1-U) \".\n[6]\t3GPP TS 32.255: \"Charging Management; 5G Data Connectivity Domain Charging\".\n[7]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[8]\t3GPP TS 33.501: \"Security architecture and procedures for 5G system\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions of terms, symbols and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tTerms",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms given in 3GPP TR 21.905 [7] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [7].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tSymbols",
                    "description": "",
                    "summary": "",
                    "text_content": "Void.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.3\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the abbreviations given in 3GPP TRÂ 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\nCHF\tCharging Function\nSCAS\tSecurity Assurance Specification\nSMF\tSession Management Function\nTEID\tTunnel Endpoint Identifier\nUDM\tUnified Data Management Function\nUPF\tUser Plane Function\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tSMF-specific security requirements and related test cases",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "4.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "SMF specific security requirements include both SMF-specific security functional requirements in relevant specifications as well as security requirements introduced in the present document derived from the threats specific to SMF as described in TR 33.926 [4].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "4.2\tSMF-specific adaptations of security functional requirements and related test cases",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.2.1\tIntroduction",
                            "text_content": "Present clause contains SMF-specific security functional adaptations of requirements and related test cases.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.2\tSecurity functional requirements on the SMF deriving from 3GPP specifications and related test cases",
                            "text_content": "The general approach in TS 33.117 [2] clause 4.2.2.1 and all the requirements and test cases in TS 33.117 [2] clause 4.2.2.2 related to SBA/SBI aspect apply to the SMF network product class.\nRequirement Name: Priority of UP security policy\nRequirement Reference: TS 23.501 [1], clause 5.10.3\nRequirement Description: User Plane Security Policy from UDM takes precedence over locally configured User Plane Security Policy as specified in TS 23.501 [1], clause 5.10.3\nThreat References: TR 33.926 [4], clause J.2.2.1 Non-compliant UP security policy handling\nTest Case:\nTest Name: TC_UP_POLICY_PRECEDENCE_SMF\nPurpose:\nVerify that the user plane security policy from the UDM takes precedence at the SMF under test over locally configured user plane security policy.\nPre-Conditions:\nTest environment with AMF and UDM may be simulated.\nBoth UDM and SMF under test are configured with UP security policy, and the UP security policies are different.\nThere is no Session Management Subscription data in SMF.\nExecution Steps\n1)\tThe tester triggers PDU session establishment procedure by sending Nsmf_PDUSession_CreateSMContext Request message to the SMF.\n2)\tThe SMF under test retrieves the Session Management Subscription data using Nudm_SDM_Get service from UDM, where the Session Management Subscription data includes the user plane security policy stored in UDM.\n3)\tThe tester captures the Namf_Communication_N1N2MessageTransfer message sent from the SMF under test to the AMF.\nExpected Results:\nThere is a Security Indication IE in the N2 SM information contained in the Namf_Communication_N1N2MessageTransfer message, which is the same with the UP security policy configured in the UDM.\nExpected format of evidence:\nEvidence suitable for the interface, e.g., Screenshot containing the operational results.\nRequirement Name: UP security policy check.\nRequirement Reference: TS 33.501 [8], clause 6.6.1\nRequirement Description: According to TS 33.501 [8], clause 6.6.1,the SMF verifies that the UE's UP security policy received from the target ng-eNB/gNB is the same as the UE's UP security policy that the SMF has locally stored. If there is a mismatch, the SMF sends its locally stored UE's UP security policy of the corresponding PDU sessions to the target gNB. This UP security policy information, if included by the SMF, is delivered to the target ng-eNB/gNB in the Path-Switch Acknowledge message. The SMF logs capabilities for this event and may take additional measures, such as raising an alarm.\nThreat References: TR 33.926 [4], clause J.2.2.4, Unchecked UP security policy.\nTEST CASE:\nTest Name: TC_UP_SECURITY_POLICY _SMF\nPurpose:\nVerify that the SMF checks the UP security policy that is sent by the ng-eNB/gNB during handover.\nPre-Conditions:\nThe SMF under test is preconfigured with a UE UP security policy.\nExecution\n1. The tester sends the Nsmf_PDUSession_UpdateSMContext Request message to the SMF under test. A UE UP security policy different than the one preconfigured at the SMF under test is included in the Request message.\n2. The tester captures the Nsmf_PDUSession_UpdateSMContext Response message sent from the SMF under test.\nExpected Results:\nThe preconfigured UE security policy is contained in the ân2SmInfoâ IE in the captured Response message.\nExpected format of evidence:\nFiles containing the triggered HTTP messages (e.g. pcap trace).\nRequirement Name: Charing ID uniqueness.\nRequirement Reference: TS 32.255 [6], clause 5.1.2\nRequirement Description: According to TS 32.255 [6], clause 5.1.2:\n-\tThe SMF supports PDU session charging using service based interface.\n-\tThe SMF collects charging information per PDU session for UEs served under 3GPP access and non-3GPP access.\n- Every PDU session is assigned a unique identity number for billing purposes per PLMN. (i.e. the Charging Id).\nThreat Reference: TR 33.926 [4], clause J.2.2.3, \"Failure to assign unique Charging ID for a session\"\nTEST CASE:\nTest Name: TC_CHARGING_ID_UNIQUENESS_SMF\nPurpose:\nVerify that the charging ID generated by the SMF for each PDU session is unique.\nPre-Conditions:\nTest environment is set up with a Charging Function (CHF), which may be real or simulated, and the SMF under test. The tester is able to capture the traffic between the SMF under test and the CHF.\nExecution Step\n1)\tThe tester intercepts the traffic between the SMF under test and the CHF.\n2)\tThe tester triggers the establishment of the maximum number of concurrent PDU sessions that the SMF under test can handle.\n3)\tThe tester captures each Charging Data Request [initial] sent from the SMF under test to the CHF, and verifies the charging ID contained in the âPDU Session Charging Informationâ IE in each Charging Data Request [initial] is unique.\nExpected Results:\nThe charging ID in each Charging Data Request [initial] is unique.\nExpected format of evidence:\nFiles containing the Charging Data Request [initial] messages (e.g. pcap trace).\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.3\tTechnical Baseline",
                            "text_content": "The present clause provides baseline technical requirements.\nThere are no SMF-specific additions to clause 4.2.3.2.1 of TS 33.117 [2].\nThere are no SMF-specific additions to clause 4.2.3.2.2 of TS 33.117 [2].\nThere are no SMF-specific additions to clause 4.2.3.2.3 of TS 33.117 [2].\nThere are no SMF-specific additions to clause 4.2.3.2.4 of TS 33.117 [2].\nThere are no SMF-specific additions to clause 4.2.3.2.5 of TS 33.117 [2].\nThere are no SMF-specific additions to clause 4.2.3.3 of TS 33.117 [2].\nThere are no SMF-specific additions to clause 4.2.3.4 of TS 33.117 [2].\nThere are no SMF-specific additions to clause 4.2.3.5 of TS 33.117 [2].\nThere are no SMF-specific additions to clause 4.2.3.6 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.4\tOperating Systems",
                            "text_content": "There are no SMF-specific additions to clause 4.2.4 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.5\tWeb Servers",
                            "text_content": "There are no SMF-specific additions to clause 4.2.5 of TS 33.117 [2]\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.6\tNetwork Devices",
                            "text_content": "There are no SMF-specific additions to clause 4.2.6 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.2.7\tVoid",
                            "text_content": "\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.3\tSMF-specific adaptations of hardening requirements and related test cases",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.3.1\tIntroduction",
                            "text_content": "The present clause contains SMF-specific adaptations of hardening requirements and related test cases.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.2\tTechnical baseline",
                            "text_content": "There are no SMF-specific additions to clause 4.3.2 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.3\tOperating systems",
                            "text_content": "There are no SMF-specific additions to clause 4.3.3 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.4\tWeb servers",
                            "text_content": "There are no SMF-specific additions to clause 4.3.4 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.5\tNetwork devices",
                            "text_content": "There are no SMF-specific additions to clause 4.3.5 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.3.6\tNetwork functions in service-based architecture",
                            "text_content": "There are no SMF-specific additions to clause 4.3.6 of TS 33.117 [2].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "4.4\tSMF-specific adaptations of basic vulnerability testing requirements and related test cases",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "4.4.1\tIntroduction",
                            "text_content": "There are no SMF specific addtions to clause 4.4.1 of TS 33.117 [2].\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.2\tPort Scanning",
                            "text_content": "There are no SMF specific addtions to clause 4.4.2 of TS 33.117 [2].\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.3\tVulnerability scanning",
                            "text_content": "There are no SMF specific addtions to clause 4.4.3 of TS 33.117 [2].\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "4.4.4\tRobustness and fuzz testing",
                            "text_content": "The test cases under clause 4.4.4 of TS 33.117 [2] are applicable to SMF.\n\nThe interfaces defined for the SMF are defined in clause 4.2.3 of TS 23.501 [1].\n\nAccording to clause 4.4.4 of TS 33.117 [2], the transport protocols available on the interfaces providing IP-based protocols need to be robustness tested. Following TCP/IP layer model and considering all the protocols over transport layer, for SMF, the following interfaces and protocols are in the scope of the testing:\n\n-\tFor Nsmf: The TCP, HTTP2 and JSON protocols.\n-\tFor N4: The UDP and PFCP procotols.\n\nNOTE: There could be other interfaces and/or protocols requiring testing under clause 4.4.4 of TS 33.117 [2]\n\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "",
                                    "table number": 1,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}