{
    "document_name": "24141-i00.docx",
    "content": [
        {
            "title": "Foreword",
            "description": "This Technical Specification has been produced by the 3rd Generation Partnership Project (3GPP).\nThe contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval. Should the TSG modify the contents of the present document, it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows:\nVersion x.y.z\nwhere:\nx\tthe first digit:\n1\tpresented to TSG for information;\n2\tpresented to TSG for approval;\n3\tor greater indicates TSG approved document under change control.\ny\tthe second digit is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc.\nz\tthe third digit is incremented when editorial only changes have been incorporated in the document.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "1\tScope",
            "description": "The present document provides the protocol details for the presence service within the IP Multimedia (IM) Core Network (CN) subsystem based on the Session Initiation Protocol (SIP) and SIP Events as defined in 3GPP TS 24.229 [9].\nWhere possible the present document specifies the requirements for this protocol by reference to specifications produced by the IETF within the scope of SIP and SIP Events, either directly, or as modified by 3GPP TS 24.229 [9].\nRequirements for manipulation of presence data are defined by use of a protocol at the Ut reference point based on XML Configuration Access Protocol (XCAP) (RFC 4825 [33]).\nThe present document is applicable to Application Servers (ASs) and User Equipment (UE) providing presence functionality.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "2\tReferences",
            "description": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 22.141: \"Presence Service; Stage 1\".\n[3]\t3GPP TS 23.002: \"Network architecture\".\n[4]\t3GPP TS 23.141: \"Presence service; Architecture and functional description; Stage 2\".\n[5]\t3GPP TS 23.218: \"IP Multimedia (IM) session handling; IM call model; Stage 2\".\n[6]\t3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".\n[7]\t3GPP TS 24.109: \"Bootstrapping interface (Ub) and Network application function interface (Ua); Protocol details\".\n[8]\t3GPP TS 24.228 Release 5: \"Signalling flows for the IP multimedia call control based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".\n[9]\t3GPP TS 24.229: \"Internet Protocol (IP) multimedia call control protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".\n[10]\t3GPP TS 29.228: \"IP Multimedia (IM) Subsystem Cx and Dx Interfaces; Signalling flows and message contents\".\n[11]\t3GPP TS 33.222: \"Generic Authentication Architecture (GAA); Access to network application functions using Hypertext Transfer Protocol over Transport Layer Security (HTTPS)\".\n[12]\tIETF RFC 2664 (1999): \"FYI on Questions and Answers - Answers to Commonly asked New Internet User Questions\".\n[13]\tVoid.\n[14]\tIETF RFC 2387 (August 1998): \"The MIME Multipart/Related Content-type\".\n[15]\tVoid.\n[15A]\tVoid.\n[16]\tIETF RFC 2778 (2000): \"A Model for Presence and Instant Messaging\".\n[17]\tIETF RFC 3261 (June 2002): \"SIP: Session Initiation Protocol\".\n[18]\tIETF RFC 3263 (June 2002): \"Session Initiation Protocol (SIP): Locating SIP Servers\".\n[19]\tIETF RFC 6665 (July 2012): \"SIP-Specific Event Notification\".\n[20]\tIETF RFC 3310 (2002): \"Hypertext Transfer Protocol (HTTP) Digest Authentication Using Authentication and Key Agreement (AKA)\".\n[21]\tIETF RFC 3863 (August 2004): \"Presence Information Data Format (PIDF)\".\n[22]\tIETF RFC 4662 (August 2006): \"A Session Initiation Protocol (SIP) Event Notification Extension for Resource Lists\".\n[23]\tIETF RFC 3903 (October 2004): \"Session Initiation Protocol (SIP) for Event State Publication\".\n[24]\tIETF RFC 5263 (September 2008): \"Session Initiation Protocol (SIP) extension for Partial Notification of Presence Information\".\n[25]\tIETF RFC 5196 (September 2008): \"Session Initiation Protocol (SIP) User Agent Capability Extension to Presence Information Data Format (PIDF)\".\n[26]\tIETF RFC 4480 (July 2006): \"RPID: Rich Presence Extensions to the Presence Information Data Format (PIDF)\".\n[27]\tIETF RFC 3856 (August 2004): \"A Presence Event Package for the Session Initiation Protocol (SIP)\".\n[28]\tIETF RFC 3857 (August 2004): \"A Watcher Information Event Template-Package for the Session Initiation Protocol (SIP)\".\n[29]\tIETF RFC 3858 (August 2004): \"An Extensible Markup Language (XML) Based Format for Watcher Information\".\n[30]\tIETF RFC 4661 (September 2006): \"An Extensible Markup Language (XML) Based Format for Event Notification Filtering\".\n[31]\tIETF RFC 4660 (September 2006): \"Functional Description of Event Notification Filtering\".\n[32]\tIETF RFC 4482 (July 2006): \"CIPID: Contact Information for the Presence Information Data Format\".\n[33]\tIETF RFC 4825 (May 2007): \"The Extensible Markup Language (XML) Configuration Access Protocol (XCAP)\".\n[34]\tIETF RFC 4827 (May 2007): \"An Extensible Markup Language (XML) Configuration Access Protocol (XCAP) Usage for Manipulating Presence Document Contents\".\n[35]\tIETF RFC 5025 (December 2007): \"Presence Authorization Rules\".\n[35A]\tIETF RFC 4745 (February 2007): \"Common Policy: A Document Format for Expressing Privacy Preferences\".\n[36]\tIETF RFC 4826 (May 2007): \"An Extensible Markup Language (XML) Formats for Representing Resource Lists\".\n[37]\tIETF RFC 4119 (December 2005): \"A Presence-based GEOPRIV Location Object Format\".\n[38]\tIETF RFC 5262 (September 2008): \"Presence Information Data Format (PIDF) Extension for Partial Presence\".\n[39]\tIETF RFC 5874 (May 2010): \"An Extensible Markup Language (XML) Document Format for Indicating a Change in XML Configuration Access Protocol (XCAP) Resources\".\n[40]\tIETF RFC 4483 (May 2006): \"A Mechanism for Content Indirection in Session Initiation Protocol (SIP) Messages\".\n[41]\tVoid.\n[42]\tVoid.\n[43]\tIETF RFC 5875 (May 2010): \"An Extensible Markup Language (XML) Configuration Access Protocol (XCAP) Diff Event Package\".\n[44]\tIETF RFC 4479 (July 2006): \"A Data Model for Presence\".\n[45]\tIETF RFC 5264 (September 2008): \"Publication of Partial Presence Information\".\n[46]\t3GPP2 X.S0027-004: \"Network Presence\".\n[47]\tVoid\n[48]\t3GPP2 S.S0109: \"Generic bootstrapping architecture\"\n[49]\t3GPP2 S.S0114: \"Security mechanisms using GBA\"\n[50]\tVoid\n[51]\t3GPP TS 33.310: \"Network Domain Security (NDS); Authentication Framework (AF)\".\n[52]\tIETF RFC 9110 (June 2022): \"HTTP Semantics\".\n[53]\tIETF RFC 7616 (September 2015): \"HTTP Digest Access Authentication\".\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "3\tDefinitions and abbreviations",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "3.1\tDefinitions",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the terms and definitions given in 3GPP TR 21.905 [1] and the following apply:\nsubscription authorization policy: a policy that determines which watchers are allowed to subscribe to diffa presentity's presence information\nThe subscription authorization policy also determines to which presentity's presence information the watcher has access.\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.141 [4] apply:\nPresence list server\nPresence Network Agent (PNA)\nPresence Server (PS)\nPresence User Agent (PUA)\nFor the purposes of the present document, the following terms and definitions from RFC 2778 [16] apply:\nPresence tuple\nPresentity\nFor the purposes of the present document, the following terms and definitions from RFC 3903 [23] apply:\nEvent Publication Agent (EPA)\nEvent State Compositor (ESC)\nFor the purposes of the present document, the following terms and definitions from RFC 4825 [33] apply:\nXCAP client\nXCAP server\nFor the purposes of the present document, the following terms and definitions from RFC 4662 [22] apply:\nResource List Server (RLS)\nFor the purposes of the present document, the following terms and definitions given in RFC 1594 [12].\nFully-Qualified Domain Name (FQDN)\nFor the purposes of the present document, the following terms and definitions given in RFC 3261 [17] apply:\nFinal response\nHeader\nHeader field\nMethod\nRequest\nResponse\n(SIP) transaction\nStatus-code (see RFC 3261 [17], subclause 7.2)\nTag (see RFC 3261 [17], subclause 19.3)\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.002 [3], subclauses 4.1.1.1 and 4a.7 apply:\nCall Session Control Function (CSCF)\nHome Subscriber Server (HSS)\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.218 [5], subclause 3.1 apply:\nFilter criteria\nInitial filter criteria\nSubsequent request\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.228 [6], subclauses 4.3.3.1 and 4.6 apply:\nInterrogating-CSCF (I-CSCF)\nProxy-CSCF (P-CSCF)\nServing-CSCF (S-CSCF)\nFor the purposes of the present document, the following terms and definitions given in 3GPP TR 21.905 [1] apply:\nUser Equipment (UE)\nFor the purposes of the present document, the following terms and definitions from 3GPP TS 33.222 [11] apply:\nAuthentication Proxy\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "3.2\tAbbreviations",
                    "description": "",
                    "summary": "",
                    "text_content": "For the purposes of the present document, the following abbreviations apply:\nAS\tApplication Server\nAUID\tApplication Unique ID\nCN\tCore Network\nCPIM\tCommon Profile for Instant Messaging\nCSCF\tCall Session Control Function\nEPA\tEvent Publication Agent\nESC\tEvent State Compositor\nHSS\tHome Subscriber Server\nHTTP\tHyperText Transfer Protocol\nI-CSCF\tInterrogating - CSCF\nIM\tIP Multimedia\nIOI\tInter Operator Identifier\nIP\tInternet Protocol\nMIME\tMultipurpose Internet Mail Extensions\nP-CSCF\tProxy - CSCF\nPIDF\tPresence Information Data Format\nPNA\tPresence Network Agent\nPS\tPresence Server\nPSI\tPublic Service Identity\nPUA\tPresence User Agent\nRLMI\tResource List Meta-Information\nRLS\tResource List Server\nRPID\tRich Presence Information Data\nS-CSCF\tServing - CSCF\nSIP\tSession Initiation Protocol\nTLS\tTransport Layer Security\nUE\tUser Equipment\nURI\tUniversal Resource Identifier\nXCAP\tXML Configuration Access Protocol\nXML\tExtensible Markup Language\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "4\tPresence service overview",
            "description": "The presence service provides the ability for the home network to manage presence information of a user's device, service or service media even whilst roaming. A user's presence information may be obtained through input from the user, information supplied by network entities or information supplied by elements external to the home network. Consumers of presence information, watchers, may be internal or external to the home network. The architecture for the 3GPP presence service is specified in 3GPP TS 23.141 [4].\nSIP and XCAP provide means to manipulate the presence status of a user. For details on the differences between those means refer to RFC 3903 [23] and RFC 4827 [34]. For details on the relationship of XCAP server to other roles see subclause 6.2.2.\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "5\tSIP related procedures",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "5.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "5.2\tFunctional entities",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.2.1\tUser Equipment (UE)",
                            "text_content": "A UE shall implement the role of a PUA (see subclause 5.3.1), a watcher (see subclause 5.3.2) or both.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.2.2\tApplication Server (AS)",
                            "text_content": "An AS may implement one or more of the roles of a PUA (see subclause 5.3.1), watcher (see subclause 5.3.2), PS (see subclause 5.3.3), RLS (see subclause 5.3.4), or PNA (see subclause 5.3.5).\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "5.3\tRoles",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "5.3.1\tPresence User Agent (PUA)",
                            "text_content": "A PUA is an entity that provides presence information to a PS.\nIn addition to the procedures specified in subclause 5.3.1, the PUA shall support the procedures specified in 3GPP TS 24.229 [9] appropriate to the functional entity in which the PUA is implemented.\nWhen the PUA intends to publish its own view of the presentity's presence information, it shall generate a PUBLISH request by acting as an Event Publication Agent (EPA) in accordance with RFC 3903 [23].\nNOTE 1:\tThe contents of the presence event package containing the event state of the EPA, and how such information is constructed, are outside the scope of this version of the specification. However implementations will need to take into account the reporting needs of the EPA, and also the needs of the EPA to override information published by another EPA relating to the same presentity.\nThe PUA shall implement the \"application/pidf+xml\" content type as described in RFC 3863 [21] ,the Presence Information Data Format (PIDF) extensions defined in RFC 4480 [26].\nThe PUA may implement the PIDF extensions defined in RFC 4482 [32].\nThe PUA may implement location information according to the format defined in RFC 4119 [37].\nNOTE 2:\tThe categorization of presence attributes to generic information attributes and communication address specific attributes is done using the <person> and <tuple> elements as defined in RFC 4479 [44].\nThe PUA shall implement RFC 5196 [25] if it wants to make use of SIP user agent capabilities in the presence document. The extension may be used for describing the type of the service described by the presence tuple.\nThe PUA may implement RFC 5264 [45] if it wants to use the partial publication mechanism. The first partial PUBLISH request shall contain the full state. The PUA uses the \"application/pidf-diff+xml\" content type as described in RFC 5262 [38].\nThe PUA shall update the presence information, either 600 s before the publication expiration time if the publication period indicated from the PS in the response to the PUBLISH request was for greater than 1 200 s, or when half of the time has expired if the publication period was for 1 200 s or less, unless the PUA has determined that an update to the presence information is not required.\nWhen the PUA intends to show different value of the same presence attribute to different watchers, the PUA shall publish a tuple or person element for every value it intends to show, all including a different value of the same presence attribute. The PUA shall label different information with different value of the <class> element in every published tuple or person element as defined in RFC 4480 [26]. The PUA shall also authorize different tuples to different watchers or watcher groups by manipulating the subscription authorization policy as defined in subclause 6.3.1.2.\nIf a local configuration information limiting the rate at which PUA is allowed to generate PUBLISH requests is available, then PUA shall take that information into account. Such local configuration information could be e.g. the shortest time period between consecutive PUBLISH requests.\nThe eXtensible Markup Language (XML) Schema Definition of the \"application/pidf+xml\" format covers the definition of the 3GPP subscriber's presence attributes and the PUA shall perform the following mapping:\n-\tthe communication address (containing communication means, status and contact address) attribute and the priority attribute are represented by a <tuple> element including a basic <status> element and a <contact> elements containing a priority attribute as defined in RFC 3863 [21].\nThe PUA represents subscriber specific information  by including a <person> element defined in RFC 4479 [44]. The person element may contain e.g. <activities> and <place-type> elements both defined in RFC 4480 [26]. Further PIDF extensions as defined in RFC 4482 [32] can also be used.\nNOTE 1:\tRFC 4479 [44] defines also a <device> element which can be used to present device specific information.\n-\tthe text attribute is represented by the <note> element as defined in RFC 3863 [21] for <tuple> elements and in RFC 4479 [44] for <person> and <device> elements; and\n-\tthe location attribute is represented by the elements defined in RFC 4119 [37] and the <place-type> element defined in RFC 4480 [26].\nNOTE 2:\tOnly information elements either relevant for the application or recommended by the presence-data model RFC 4479 [44] are included in the PUBLISH request. Attributes not relevant or available (e.g. the text attribute or the location attribute) are omitted.\nAdditional extensions can be used to express application specific attributes, but their usage is outside the scope of this version of the specification.\nThe PUA shall implement the \"multipart/related\" content type as described in RFC 2387 [14] if it wants to aggregate other Multipurpose Internet Mail Extensions (MIME) objects with the \"application/pidf+xml\" content type.\nWhen a presence attribute has a value of a MIME object, the PUA shall either:\na)\tpublish the presence document and the MIME object utilizing the \"multipart/related\" content-type in the PUBLISH request; or\nb)\tmake use of content indirection.\nWhen the PUA decides to use the content indirection mechanism for publishing an initial or modified value of a presence attribute the PUA shall:\na)\tstore the MIME object behind an HTTP URI on the PS or ensure that the MIME object and a HTTP URL pointing to that MIME object already exists on the PS; or\nb)\tuse the \"multipart/related\" content type as described in RFC 2387 [14] with the content indirection mechanism as specified in RFC 4483 [40] for the publication of presence information format as follows:\n-\tset a CID URI referencing to other MIME multipart body. The other multipart body contains the content indirection information which is represented as the value of an XML element;\n-\tinclude the presence document of the format \"application/pidf+xml\" or \"application/pidf-diff+xml\" in the root of the body of the \"multipart/related\" content; and\n-\tspecify the part having information about the MIME object by using the \"message/external-body\" content type, defining the HTTP URI, versioning information and other information about the MIME object as described in RFC 4483 [40].\nNOTE 1:\tThe versioning information is used for determining whether or not the MIME object indirectly referenced by a URI has changed or not;\nWhen storing a MIME object on the PS the PUA shall:\na)\tconstruct as many HTTP URIs as the number of objects to be stored; and\nb)\tformulate every HTTP URI according to a predefined directory structure.\nNOTE 2:\tThe PUA  has the root directory for storing the MIME objects on the PS preconfigured.\nNOTE 3:\tThe PUA needs to store the MIME objects on the PS behind the HTTP URI(s) created previously using standard HTTP procedures as defined in RFC 9110 [52].\nUpon activation of the presence service, the PUA application may subscribe for the watcher information state changes in accordance with RFC 3857 [28] and RFC 3858 [29]. Subscription is according to RFC 6665 [19] as per 3GPP TS 24.229 [9].\nThe PUA application may include filters in the body of the SUBSCRIBE request in accordance with RFC 4661 [30], and RFC 4660 [31] as updated by RFC 6665 [19].\nIn order to get notifications of changes to XML documents manipulated via the Ut reference point the PUA may generate a SUBSCRIBE request in accordance with RFC 5875 [43] and RFC 6665 [19].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.2\tWatcher",
                            "text_content": "A watcher is an entity that subscribes to or requests presence information about a presentity from the PS.\nIn addition to the procedures specified in subclause 5.3.2, the watcher shall support the procedures specified in 3GPP TS 24.229 [9] appropriate to the functional entity in which the watcher is implemented.\nWhen the watcher intends to subscribe for presence information state changes of a presentity, it shall generate a SUBSCRIBE request in accordance with RFC 6665 [19] and RFC 3856 [27].\nThe watcher shall implement the \"application/pidf+xml\" content type as described in RFC 3863 [21] , the PIDF extensions defined in RFC 4480 [26].\nThe watcher may implement the PIDF extensions defined in RFC 4482 [32].\nThe watcher may implement location information according to the format defined in RFC 4119 [37].\nThe watcher shall implement RFC 5196 [25] if it wants to make use of SIP user agent capabilities extensions included in the presence document. The extension may be used by the watcher for interpreting the type of the service described by the presence tuple.\nThe watcher may include filters in the body of the SUBSCRIBE request in accordance with RFC 4661 [30], and RFC 4660 [31] as updated by RFC 6665 [19].\nThe watcher may indicate its support for partial notification using the Accept header field in accordance with RFC 5263 [24].\nThe watcher shall interpret the received presence information according to RFC 4479 [44] and the following:\na)\ta <person> element as defined in RFC 4479 [44] means information about the presentity;\nb)\ta tuple including a <relationship> element defined in RFC 4480 [26] means information about an alternate contact to the presentity;\nc)\ta tuple contains communication means specific information. The communication means described by the tuple is deduced from the URI scheme of the contact address information present in the <contact> element as defined in RFC 3863 [21]. If the URI scheme of the contact address information provides ambiguous information about the communication means, the watcher shall further examine other elements of the tuple to decide the communication mean. Such elements can be the <methods> element, any of the different media type specific elements as defined in RFC 5196 [25].\nd)\ta <device> element as defined in RFC 4479 [44] means information about a device.\nAdditional extensions can be used to express application specific attributes, but their usage is outside the scope of this version of the specification.\nWhen the watcher intends to subscribe for presence information state changes of a presentity collection, it shall generate a SUBSCRIBE request in accordance with RFC 4662 [22], additionally to the procedures described in subclause 5.3.2.2.\nUpon activation of the presence service, the watcher may subscribe recursively for the watcher information state changes in accordance with RFC 3857 [28] and RFC 3858 [29]. Subscription is according to RFC 6665 [19] as per 3GPP TS 24.229 [9].\nThe watcher may include filters in the body of the SUBSCRIBE request in accordance with RFC 4661 [30], and RFC 4660 [31] as updated by RFC 6665 [19].\nIn order to get notifications of changes to XML documents manipulated via the Ut reference point the watcher may generate a SUBSCRIBE request in accordance with RFC 5875 [43] and RFC 6665 [19] as per 3GPP TS 24.229 [9].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.3\tPresence Server (PS)",
                            "text_content": "A PS is an entity that accepts, stores, and distributes presence information.\nIn addition to the procedures specified in subclause 5.3.3, the PS shall support the procedures specified in 3GPP TS 24.229 [9] appropriate to the functional entity in which the PS is implemented.\nWhen the PS receives a SUBSCRIBE request for the presence information event package, the PS shall first attempt to verify the identity of the source of the SUBSCRIBE request as described in 3GPP TS 24.229 [9] subclause 5.7.1.4, then perform authorization according to 3GPP TS 24.229 [9] subclause 5.7.1.5. In case of successful subscription, the PS shall generate a response to the SUBSCRIBE request and notifications in accordance with RFC 6665 [19] and RFC 3586 [27].\nAdditionally, in the special case of a watcher subscription if the subscription authorization policy results in the action to confirm the watcher subscription from the PUA and the PUA has a valid watcher information subscription, see RFC 3857 [28], then, the PS shall inform the PUA about the watcher subscription attempt.\nIf the watcher has indicated the need for partial notification using the Accept header field, then the PS shall generate partial notifications in accordance with RFC 5263 [24] and RFC 5262 [38].\nIf the body of the SUBSCRIBE request from the watcher contains filters, the PS shall apply the requested filtering function on notifications in accordance with RFC 4661 [30], and RFC 4660 [31] as updated by RFC 6665 [19].\nIf the watcher has indicated support for the \"multipart/related\" content type using the Accept header field, then the PS may generate notifications using \"multipart/related\" content type which aggregates \"application/pidf+xml\" formatted presence information with other MIME objects in accordance with RFC 2387 [14]. In this case, the PS shall modify the value of the presence attribute in the PIDF document to refer to the MIME object included in the corresponding MIME multipart body. If the watcher has not indicated support for the \"multipart/related\" or a MIME object cannot be accessed by the PS, the PS should exclude the presence attribute from the notification.\nNOTE:\tHow the PS takes presence information from various presence sources, in order to generate a final presence document, is outside the scope of this version of the specification. Implementations need a flexible approach to composition policy and therefore to the collection, filtering and composition of presence documents.\nThe PS shall act as an Event State Compositor (ESC).\nWhen the PS receives a PUBLISH request, the PS shall first verify the identity of the source of the PUBLISH request as described in 3GPP TS 24.229 [9] subclause 5.7.1.4, then perform authorization according to 3GPP TS 24.229 [9] subclause 5.7.1.5. In case of successful authentication and authorization, the PS shall process the PUBLISH request in accordance with RFC 3903 [23].\nIf the PUBLISH request contains the \"application/pidf-diff+xml\" content-type as described in RFC 5262 [38], the PS shall process the PUBLISH request in accordance with RFC 3903 [23] and RFC 5264 [45].\nIf the PUBLISH request contains the \"multipart/related\" content type and the PS supports the content type, the PS shall process the content as follows:\n-\tif a MIME multipart contains a MIME object of a content type supported by the PS, either store the MIME object in case of initial publication or replace an existing content in case of modify operation; and\n-\tif a multipart includes the \"message/external-body\" content type and the content indirection as described in RFC 4483 [40] is supported by the PS, ensure that it has access to the MIME object indicated by the URI and that the MIME object exists; and associate the value of the presence attribute that refers to the MIME object with the MIME object and additional information about it.\nIf the PS does not support the content type used for publishing MIME objects then the PS shall send a 415 (Unsupported Media Type) response and indicate the supported content types in the Accept header.\nNOTE:\tIf the PS receives a HTTP request for storing a MIME object on the PS, meaning that the HTTP URI points to a predefined directory reserved for storing MIME objects and the request is an HTTP PUT request, the PS replaces any existing content referenced by the Request-URI with the content of the request. If the Request-URI points to an uncreated directory, the PS creates the directory, stores the content there and associates the content with the Request-URI. For all requests, i.e. HTTP PUT, HTTP GET and HTTP DELETE requests, the PS generates an appropriate response in accordance with RFC 9110 [52].\nTo receive 3GPP2 IP-CAN network presence information from the PNA, the PS shall support the XML extension defined in 3GPP2 X.S0027-004 [46].\nWhen the PS receives a SUBCRIBE request for the watcher information event template package, the PS shall first verify the identity of the source of the SUBSCRIBE request as described in 3GPP TS 24.229 [9] subclause 5.7.1.4, then perform authorization according to 3GPP TS 24.229 [9] subclause 5.7.1.5. In case of successful subscription, the PS shall generate a response to the SUBSCRIBE request and notifications in accordance with RFC 6665 [19], RFC 3857 [28] and RFC 3858 [29].\nIf the body of the SUBSCRIBE request from the PUA contains filters, the PS shall apply the requested filtering function on notifications in accordance with RFC 4661 [30], and RFC 4660 [31] as updated by RFC 6665 [19].\nWhen the PS receives a SUBSCRIBE request having the Event header value \"xcap-diff\", the PS shall first verify the identity of the source of the SUBSCRIBE request as described in 3GPP TS 24.229 [9] subclause 5.7.1.4, then it shall perform authorization as described in 3GPP TS 24.229 [9] subclause 5.7.1.5. Afterwards, the PS shall generate a response to the SUBSCRIBE request and notifications in accordance with RFC 5875 [43] and RFC 6665 [19].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.4\tResource List Server (RLS)",
                            "text_content": "The Resource List Server (RLS) is an implementation of the presence list server. The RLS is an entity that accepts subscriptions to resource lists and sends notifications to update subscribers of the state of the resources in a resource list.\nIn addition to the procedures specified in subclause 5.3.4, the RLS shall support the procedures specified in 3GPP TS 24.229 [9] appropriate for an AS in which the RLS is implemented.\nWhen the RLS receives a SUBSCRIBE request for the presence information event package of a presentity collection, the RLS shall first verify the identity of the source of the SUBSCRIBE request as described in 3GPP TS 24.229 [9] subclause 5.7.1.4, then perform authorization according to 3GPP TS 24.229 [9] subclause 5.7.1.5. In case of successful subscription, the RLS shall generate a response to the SUBSCRIBE request and notifications in accordance with RFC 6665 [19] and RFC 4662 [22] by adding a Require header field with value \"eventlist\".\nIf the body of the SUBSCRIBE request from the watcher contains filters, the RLS shall apply the requested filtering function on notifications in accordance with RFC 4661 [30], and RFC 4660 [31] as updated by RFC 6665 [19].\nWhen the RLS receives a SUBSCRIBE request for the presence information event package of a presentity collection and installs the corresponding subscription, the RLS shall resolve the list URI to individual URIs and generate SUBSCRIBE requests for each of the individual URIs as per the procedures in RFC 6665 [19], RFC 3856 [27] and RFC 4662 [22] if the state information for the resource represented by the individual URI is otherwise not available.\nFor internal virtual subscriptions, the detection of loops potentially caused by lists of lists is possible in RLS. However for back-end subscriptions (see RFC 4662 [22]), the detection of such situations is not possible in RLS. To prevent loops in subscriptions to non-local resources the RLS shall not insert \"eventlist\" in the \"Supported\" header of back-end subscriptions.\nWhen the RLS receives a SUBSCRIBE request having the Event header value \"xcap-diff\", the RLS shall first verify the identity of the source of the SUBSCRIBE request as described in 3GPP TS 24.229 [9] subclause 5.7.1.4, then it shall perform authorization as described in 3GPP TS 24.229 [9] subclause 5.7.1.5. Afterwards, the RLS shall generate a response to the SUBSCRIBE request and notifications in accordance with RFC 5875 [43] and RFC 6665 [19].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "5.3.5\tPresence Network Agent (PNA)",
                            "text_content": "In addition to the procedures specified in subclause 5.3.5, the PNA shall support the procedures specified in 3GPP TS 24.229 [9] appropriate to the functional entity in which the PNA is implemented.\nThe PNA can collect presence information about the presentity from a number of core network entities. The PNA can combine information from various core network entities to form more complete presence information.\nAmong these core network entities, the S-CSCF uses SIP to deliver presence information to the PNA over the Pi reference point as specified in subclause 5.3.5.2.\nNOTE:\tAs part of the configuration of AS to provide a presence system, appropriate settings are downloaded to the initial filter criteria in the S-CSCF to ensure this occurs. The PNA will receive third-party REGISTER requests as specified in 3GPP TS 24.229 [9] subclauses 5.4.1.7 and 5.7.1.1.\nOn receiving a third-party REGISTER request which contains an Expires header with a non-zero value, the PNA shall, if no subscription already exists, subscribe to the reg event package for a particular user at the S-CSCF, as described in 3GPP TS 24.229 [9] subclause 5.7.1.1. As a result, the S-CSCF will then provide the presence-related information as reg event packages in NOTIFY requests to the PNA.\nOn receiving a third-party REGISTER request, the PNA may, if a subscription already exists, resubscribe to the reg event package for a particular user at the S-CSCF, as described in 3GPP TS 24.229 [9] subclause 5.7.1.1. As a result, the S-CSCF will then provide the presence-related information as reg event packages in NOTIFY requests to the PNA.\nTo publish network presence information received from 3GPP2 IP-CAN, the PNA shall follow the procedures defined in 3GPP2 X.S0027-004 [46].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "6\tProtocol for data manipulation at the Ut reference point",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "6.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "XML Configuration Access Protocol (XCAP) is used to store, alter and delete data related to the presence service. XCAP is designed according to the Hypertext Transfer Protocol (HTTP) framework, and uses the HTTP methods PUT, GET and DELETE for communication over the Ut reference point. The general information that can be manipulated is user groups, subscription authorization policy, resource lists, hard state presence publication, MIME objects referenced from the hard state presence information, etc. Soft state presence information manipulated with a PUBLISH request is not manipulated by the mechanism provided over the Ut reference point.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "6.2\tFunctional entities",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.2.1\tUser Equipment (UE)",
                            "text_content": "The UE implements the XCAP client role as described in subclause 6.3.1.\nFor accessing presence servers in 3GPP system:\n1)\tThe UE shall implement HTTP digest AKA (see RFC 3310 [20]) and it shall initiate a bootstrapping procedure with the bootstrapping server function located in the home network, as described in 3GPP TS 24.109 [7].\n2)\tThe UE shall acquire the subscriber's certificate from PKI portal by using a bootstrapping procedure, as described in 3GPP TS 24.109 [7];\n3)\tThe UE shall implement HTTP digest authentication (see RFC 7616 [53]); and\n4)\tThe UE shall implement Transport Layer Security (TLS) according to the TLS profile specified in 3GPP TS 33.310 [r33310] annex E. The UE shall be able to authenticate the network application function based on the received certificate during TLS handshaking phase.\nFor accessing presence servers in 3GPP2 system, the subscriber shall be authenticated by the presence server. subscriber authentication may be performed by the operator using proprietary or non-3G standardized methods. GBA defined in 3GPP2 S.S0109 [48] may also be used. If GBA based subscriber authentication is used, then the following shall apply:\n1)\tThe UE shall implement bootsrapping procedures as specified in 3GPP2 S.S0109 [48]; and\n2)\tThe UE shall implement TLS with pre-shared keys method specified in clause 5 of 3GPP2 S.S0114 [49].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.2\tApplication Server (AS)",
                            "text_content": "If an AS implements the role of a PS (see subclause 5.3.3) or of a RLS (see subclause 5.3.4), then the AS shall also implement the role of a XCAP server (see subclause 6.3.2).\nIf there is no authentication proxy in the network, then the AS in 3GPP system shall:\n1)\timplement the role of a network application function, as described in 3GPP TS 24.109 [7];\n2)\timplement TLS according to the TLS profile specified in 3GPP TS 33.310 [51] annex E;\n3)\timplement HTTP digest authentication (see RFC 7616 [53]); and\n4)\tsupport certificate authentication.\nFor 3GPP2 system, the authentication proxy does not apply. If GBA based authentication is used by an AS in 3GPP2 system, then the AS shall:\n1)\timplement the role of a network application function, as described in 3GPP2 S.S0114 [49]; and\n2)\timplement TLS with pre-shared keys method specified in clause 5 of 3GPP2 S.S0114 [49].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.2.3\tAuthentication proxy",
                            "text_content": "For 3GPP2 system, this subclause does not apply.\nThe generic requirements for an authentication proxy are defined in 3GPP TS 24.109 [7].\nIn addition an authentication proxy acting within the scope of presence shall:\n1)\tverify the content of the \"X-3GPP-Intended-Identity\" header in case it is available in HTTP requests; and\n2)\tindicate an asserted identity of the user in the \"X-3GPP-Asserted-Identity\" header in HTTP requests sent to the AS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "6.3\tRoles",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "6.3.1\tXCAP client",
                            "text_content": "The XCAP client is a logical function as defined in RFC 4825 [33]. The XCAP client provides the means to manipulate the data such as user groups, subscription authorization policy, resource lists, hard state presence infromation, MIME objects referenced from the hard state presence information, etc.\nNOTE:\tIn order to be able to manipulate data stored on the XCAP server, the XCAP client has the root directory on the XCAP server pre-configured or uses some means to discover it. Discovery mechanisms are outside the scope of the present document.\nWhen the XCAP client intends to manipulate a resource list, it shall generate an HTTP PUT, HTTP GET or HTTP DELETE request in accordance with RFC 9110 [52], RFC 4825 [33] and RFC 4826 [36].\nWhen the XCAP client intends to manipulate the subscription authorization policy, it shall generate an HTTP PUT, HTTP GET or HTTP DELETE request in accordance with RFC 9110 [52], RFC 4825 [33], RFC 4745 [35A], and RFC 5025 [35].\nWhen the XCAP client intends to authorize particular watchers or watcher groups, the XCAP client shall authorize those watchers in <one> and <many> child elements of the <identity> element as specified in RFC 4745 [35A].\nWhen the XCAP client intends to time-restrict presence attributes, the XCAP client shall define time periods in <validity> elements as specified in RFC 4745 [35A].\nWhen the XCAP client intends to provide certain presence attributes to particular watchers or watcher groups and not others, the XCAP client shall permit those presence attributes in the <transformations> element as specified in RFC 5025 [35].\nWhen the XCAP client intends to authorize providing a particular presence attribute to different watchers or watcher groups depending on the value of that attribute, the XCAP client shall specify those attribute values in the <transformations> element as specified in RFC 5025 [35].\nThe XCAP client shall implement RFC 4827 [34] in order to be able to manipulate  hard state presence information. Hard state presence information uses the same format as soft state information, namely \"application/pidf+xml\" content type as described in RFC 3863 [21] together with any of its extensions.\nWhen the hard state presence information contains one or more MIME objects to be aggregated with the \"application/pidf+xml\" content type and any of its extensions, the XCAP client shall:\na)\tconstruct as many HTTP URIs as the number of objects to be stored and formulate every HTTP URI according to a predefined directory structure;\nNOTE:\tIn order to be able to manipulate data stored on the XCAP server, the XCAP client has the root directory on the XCAP server pre-configured or use some means to discover it. Discovery mechanisms are outside the scope of the present document.\nb)\tstore the objects on the XCAP server behind the HTTP URI(s) created in the previous step using standard HTTP procedures as defined in RFC 9110 [52];\nc)\tinclude every HTTP URI as a value of the corresponding XML element in the published \"application/pidf+xml\" presence document referencing the stored object(s) in the previous step; and\nd)\tpublish the hard state presence information according to RFC 4827 [34].\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "6.3.2\tXCAP server",
                            "text_content": "The XCAP server is a logical function as defined in RFC 4825 [33]. The XCAP server can store data such as user groups, subscription authorization policy, resource lists, hard state presence information, MIME objects referenced from the hard state presence information, etc.\nWhen the XCAP server receives an HTTP PUT, HTTP GET or HTTP DELETE request for manipulating or fetching a resource list, the XCAP server shall first authenticate the request in accordance with 3GPP TS 24.109 [7] and then perform authorization. Afterwards the XCAP server shall perform the requested action and generate a response in accordance with RFC 9110 [52], RFC 4825 [33] and RFC 4826 [36].\nWhen the XCAP server receives an HTTP PUT, HTTP GET or HTTP DELETE request for manipulating or fetching of the subscription authorization policy, the XCAP server shall first authenticate the request in accordance with 3GPP TS 24.109 [7] and then perform authorization. Afterwards the XCAP server shall perform the requested action and generate a response in accordance with RFC 9110 [52], RFC 4825 [33], RFC 4745 [35A], and RFC 5025 [35].\nWhen the XCAP server receives an HTTP PUT, HTTP GET or HTTP DELETE request for publishing, fetching or deleting of hard state presence information, the XCAP server shall first authenticate the request in accordance with 3GPP TS 24.109 [7] and then perform authorization. Afterwards the XCAP server shall:\na)\tif the HTTP URI points to a predefined directory reserved for storing MIME objects and the request is an HTTP PUT request, replace any existing content referenced by the Request-URI with the content of the request;\nb)\tif the Request-URI points to an uncreated directory and the request is HTTP PUT, create the directory, store the content there and associate the content with the Request-URI. For all requests, i.e. HTTP PUT, HTTP GET and HTTP DELETE requests, generate an appropriate response in accordance with RFC 9110 [52]; or\nc)\tif the HTTP URI points to an XCAP directory and the Application Unique ID (AUID) part of the HTTP URI is set to \"pidf-manipulation\", process the request and generate an appropriate response in accordance with RFC 4825 [33], RFC 4827 [34] and RFC 9110 [52].\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "7\tPresence information model of the 3GPP subscriber",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "7.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "Void.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.2\tXML schema definitions",
                    "description": "",
                    "summary": "",
                    "text_content": "Void.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "7.3\tXML schema descriptions",
                    "description": "",
                    "summary": "",
                    "text_content": "Void.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.1\tScope of signalling flows",
            "description": "This annex gives examples of signalling flows for the presence service within the IP Multimedia (IM) Core Network (CN) subsystem based on the Session Initiation Protocol (SIP) and SIP Events.\nThese signalling flows provide detailed signalling flows, which expand on the overview information flows provided in 3GPP TS 23.141 [4].\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.2\tIntroduction",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.2.1\tGeneral",
                    "description": "",
                    "summary": "",
                    "text_content": "The signalling flows provided in this annex follow the methodology developed in 3GPP TS 24.228 [8]. The following additional considerations apply:\na)\t3GPP TS 24.228 [8] shows separate signalling flows with no configuration hiding between networks, and with configuration hiding between networks. There is no presence specific functionality associated with this hiding, and therefore such separate signalling flows are not show in the present document; and\nb)\t3GPP TS 24.228 [8] does not show the functionality between the S-CSCF and the AS. As the presence service depends on the functionality provided by various AS, the signalling flows between S-CSCF and AS are shown in the present document.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.2.2\tKey required to interpret signalling flows",
                    "description": "",
                    "summary": "",
                    "text_content": "The key to interpret signalling flows specified in 3GPP TS 24.228 [8] subclauses 4.1 and 4.2 applies with the additions specified below.\n-\trls.home1.net: an RLS in the home network of the watcher;\n-\trls.home2.net: an RLS in the home network of the service provider, but not the home network of the watcher;\n-\tps.home1.net: a PS in the home network of the publisher;\n-\tps.home2.net: a PS in the home network of the service provider, but not in that of the watcher;\n-\tuser1_list1@home1.net: a resource list being subscribed to on a RLS in the home network;\n-\tuser2_list1@home2.net: a resource list being subscribed to on a RLS in the home network of the service provider, but not the home network of the subscriber;\n-\tuser1_public1@home1.net: presentity being watched, own watcher list;\n-\tuser3_public1@home3.net: presentity being watched.\nAs in 3GPP TS 24.228 [8], in order to differentiate between SIP methods and other protocol messages, the message name is preceded with the associated protocol for all non-SIP messages. Where the XCAP is used to map an HTTP URI to an XML document, the protocol name \"XCAP\" is used for both the HTTP request and HTTP response.\nEach signalling flow table contains descriptions for headers where the content of the header is new to that signalling flow, as is already performed in 3GPP TS 24.228 [8].\nHowever, 3GPP TS 24.228 [8] includes extensive descriptions for the contents of various headers following each of the tables representing the contents of the signalling flows. Where the operation of the header is identical to that shown in 3GPP TS 24.228 [8], then such text is not reproduced in the present document.\nAdditional text may also be found on the contents of headers within 3GPP TS 24.228 [8] in addition to the material shown in the present document.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.3\tSignalling flows demonstrating how watchers subscribe to presence event notification",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.3.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "The subclause covers the signalling flows that show how watchers can request presence information about a presentity.\nFor the routing of the Public Service Identity (PSI) towards the AS, there are two scenarios:\nSubclause A.3.3.2 shows the case where the I-CSCF forwards the SUBSCRIBE request directly to the RLS when the RLS is located within the same network. There is another scenario where the I-CSCF forwards the SUBSCRIBE request towards the RLS, being involved with the S-CSCF located in the same network, but this scenario is not described in the present document.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.3.2\tWatcher and presentity in different networks, UE in home network",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "A.3.2.1\tSuccessful subscription",
                            "text_content": "Figure A.3.2.1-1 illustrates a watcher subscribing for presence information in a network. The figure depicts the watcher, represented by a circle, actively requesting presence updates from various nodes, denoted by squares. The presence information is transmitted through a series of interconnected lines, symbolizing the network's communication channels. The watcher's subscription process is crucial for maintaining real-time awareness of other nodes' statuses, enabling efficient communication and coordination within the network.\nFigure A.3.2.1-1: Watcher subscribing for presence information\nFigure A.3.2.1-1 shows a watcher subscribing to presence event notification about a presentity. The presentity is in a different IM CN subsystem. The details of the signalling flows are as follows:\n1.\tSUBSCRIBE request (UE (watcher) to P-CSCF) - see example in table A.3.2.1-1\nA watcher agent in a UE wishes to watch a presentity, or certain presence information of the presentity. To initiate a subscription, the UE generates a SUBSCRIBE request containing the \"presence\" event that it wishes to be notified of, together with an indication of the length of time this periodic subscription should last and the support for partial notification.\nTable A.3.2.1-1: SUBSCRIBE request (UE (watcher) to P-CSCF)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nMax-Forwards: 70\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nRoute: <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>, <sip:orig@scscf1.home1.net;lr>\nP-Preferred-Identity: <sip:user1_public1@home1.net>\nPrivacy: none\nFrom: <sip:user1_public1@home1.net>;tag=31415\nTo: <sip:user2_public1@home2.net>\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 61 SUBSCRIBE\nRequire: sec-agree\nProxy-Require: sec-agree\nSecurity-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432; spi-s=87654321; port-c=8642; port-s=7531\nEvent: presence\nExpires: 7200\nAccept: application/pidf+xml;q=0.3, application/pidf-diff+xml;q=1\nContact: <sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp>\nContent-Length: 0\n\nRequest-URI:\tPublic user identity whose events the subscriber subscribes to.\nEvent:\tThis field is populated with the value \"presence\" to specify the use of the presence package.\nAccept:\tThis field is populated with the value 'application/pidf+xml' and 'application/pidf-diff+xml', latter one with higher preference.\nTo:\tSame as the Request-URI.\n2.\tSUBSCRIBE request (P-CSCF to S-CSCF) - see example in table A.3.2.1-2\nThe P-CSCF looks up the serving network information for the public user identity that was stored during the registration procedure. The SUBSCRIBE request is forwarded to S-CSCF. A Route header is inserted into SUBSCRIBE request. The information for the Route header is taken from the service route determined during registration.\nTable A.3.2.1-2: SUBSCRIBE request (P-CSCF to S-CSCF)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Access-Network-Info:\nMax-Forwards: 69\nP-Asserted-Identity: <sip:user1_public1@home1.net>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"\nPrivacy:\nRoute: <sip:orig@scscf1.home1.net;lr>\nRecord-Route: <sip:pcscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nAccept:\nContact:\nContent-Length:\n\n3.\tEvaluation of initial filter criteria\nS-CSCF#1 validates the service profile of this subscriber and evaluates the initial filter criteria.  In this example, no AS is assumed to be involved.\n4.\tSUBSCRIBE request (S-CSCF to I-CSCF) - see example in table A.3.2.1-4\nS-CSCF#1 performs an analysis of the destination address, and determines the network operator to whom the destination subscriber belongs. Since the originating operator does not desire to keep their internal configuration hidden, S-CSCF#1 forwards the SUBSCRIBE request directly to the I-CSCF in the destination network.\nTable A.3.2.1-4: SUBSCRIBE (S-CSCF to I-CSCF)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;;branch=z9hG4bKnashds7\nMax-Forwards: 68\nP-Asserted-Identity: <sip:user1_public1@home1.net>, <tel:+1-212-555-1111>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"; orig-ioi=home1.net\nPrivacy:\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nAccept:\nContact:\nContent-Length:\n\n5.\tCx: User Location Query procedure\nThe I-CSCF sends a query to the HSS to find out the S-CSCF of the called user. The HSS responds with the address of the current S-CSCF for the terminating subscriber.\nFor detailed message flows see 3GPP TS 29.228 [10].\nTable A.3.2.1-5a provides the parameters in the SIP SUBSCRIBE request (flow 4), which are sent to the HSS.\nTable A.3.2.1-5a: Cx: User location query procedure (I-CSCF to HSS)\n\nTable A.3.2.1-5b provides the parameters sent from the HSS that need to be mapped to the SIP SUBSCRIBE request (flow 6) and sent to the S-CSCF.\nTable A.3.2.1-5b: Cx: User location query procedure (HSS to I-CSCF)\n\n6.\tSUBSCRIBE request (I-CSCF to S-CSCF) - see example in table A.3.2.1-6\nThe I-CSCF forwards the SUBSCRIBE request to the S-CSCF (S-CSCF#2) that will handle the termination.\nTable A.3.2.1-6: SUBSCRIBE request (I-CSCF to S-CSCF)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP icscf2_s.home2.net;branch=z9hG4bK871y12.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nMax-Forwards: 67\nP-Asserted-Identity:\nP-Charging-Vector:\nPrivacy:\nRoute: <sip:scscf2.home2.net;lr>\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nAccept:\nContact:\nContent-Length:\n\nNOTE:\tThe I-CSCF does not add itself to the Record-Route header, as it has no need to remain in the signalling path for the subsequent requests.\n7.\tEvaluation of initial filter criteria\nS-CSCF#2 validates the service profile of this subscriber and evaluates the initial filter criteria. For sip:user2_public1@home2.net S-CSCF#2 has termination initial filter criteria with Service Point Trigger of Method = SUBSCRIBE and Event = \"presence\" that informs the S-CSCF to route the SUBSCRIBE request to the AS ps.home2.net. The S-CSCF#2 has preconfigured information not to create a Record-Route entry for this request.\n8.\tSUBSCRIBE request (S-CSCF to PS) – see example in table A.3.2.1-8\nThe S-CSCF forwards the SUBSCRIBE request to the PS.\nTable A.3.2.1-8: SUBSCRIBE request (S-CSCF to PS)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK764z87.1, SIP/2.0/UDP icscf2_s.home2.net;branch=z9hG4bK871y12.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nMax-Forwards: 66\nP-Asserted-Identity:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nPrivacy:\nRoute: <sip:ps.home2.net;lr>, <sip:scscf2.home2.net;lr>\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nAccept:\nContact:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header and removes the terminating IOI parameter.\nP-Charging-Function-Addresses:\tThe S-CSCF populates the P-Charging-Function-Addresses header field to be passed to the PS.\n9.\tAuthorization of watcher\nThe PS performs the necessary authorization checks on the originator to ensure it is allowed to watch the presentity. In this example all privacy conditions are met, so the PS sends a 200 (OK) response to the S-CSCF.\nIn the case where the privacy/authorization checks failes, then a necessary 2xx or 4xx response will be sent to the S-CSCF. The selection of the correct response code depends on the presentity's subscription authorization policy document.\n10.\t200 (OK) response (PS to S-CSCF) - see example in table A.3.2.1-10\nThe PS sends the response to S-CSCF#2.\nTable A.3.2.1-10: 200 (OK) response (PS to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK764z87.1, SIP/2.0/UDP\nicscf2_s.home2.net;branch=z9hG4bK871y12.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"; orig-ioi=home1.net; term-ioi=home2.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRecord-Route:\nFrom:\nTo: <sip:user2_public1@home2.net>;tag=151170\nCall-ID:\nCSeq:\nExpires:\nContact: <sip:ps.home2.net>\nContent-Length:\n\nP-Charging-Vector:\tThe PS stores the originating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe PS stores the P-Charging-Function-Addresses header field and passes this header to the S-CSCF.\n11.\t200 (OK) response (S-CSCF to I-CSCF) - see example in table A.3.2.1-11\nS-CSCF#2 forwards the response to I-CSCF#2.\nTable A.3.2.1-11: 200 (OK) response (S-CSCF to I-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP icscf2_s.home2.net;branch=z9hG4bK871y12.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Charging-Vector:\nP-Charging-Function-Addresses:\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the I-CSCF.\n12.\t200 (OK) response (I-CSCF to S-CSCF) - see example in table A.3.2.1-12\nI-CSCF#2 forwards the response to S-CSCF#1.\nTable A.3.2.1-12: 200 (OK) response (I-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Charging-Vector:\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\n13.\t200 (OK) response (S-CSCF to P-CSCF) - see example in table A.3.2.1-13\nS-CSCF#1 forwards the response to P-CSCF#1.\nTable A.3.2.1-13: 200 (OK) response (S-CSCF to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\n14.\t200 (OK) response (P-CSCF to UE) - see example in table A.3.2.1-14\nP-CSCF#1 forwards the response to the watcher agent in the UE.\nTable A.3.2.1-14: 200 (OK) response (P-CSCF to UE)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nRecord-Route: <sip:orig@scscf1.home1.net;lr>, <sip:pcscf1.home1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\n15.\tNOTIFY request (PS to S-CSCF) - see example in table A.3.2.1-15\nAs soon as the PS sends a 200 (OK) response to accept the subscription, it sends a NOTIFY request with the current state of the presentity's presence information that the watcher has subscribed and been authorized to. The NOTIFY request is sent to S-CSCF#1. Based on the Accept header field of the SUBSCRIBE request, the PS decides to use partial notification to provide changes of presence information.\nTable A.3.2.1-15: NOTIFY request (PS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=123551024\"; orig-ioi=home2.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.home1.net;lr>\nFrom: <sip:user2_public1@home2.net>;tag=151170\nTo: <sip:user1_public1@home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 42 NOTIFY\nSubscription-State: active ;expires=7200\nEvent: presence\nContact: <sip:ps.home2.net>\nContent-Type: application/pidf-diff +xml\nContent-Length: (...)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<diff:pidf-full xmlns=\"urn:ietf:params:xml:ns:pidf\"\nxmlns:diff=\"urn:ietf:params:xml:ns:pidf-diff\"\nxmlns:rpid=\"urn:ietf:params:xml:ns:pidf:rpid\"\nxmlns:dm=\"urn:ietf:params:xml:ns:pidf:data-model\"\nxmlns:pcp=\"urn:ietf:params:xml:ns:pidf:caps\"\nxmlns:c=\"urn:ietf:params:xml:ns:pidf:cipid\"\nentity=\"pres:user2_public1@home2.net\"\nversion=\"1\">\n\n<tuple id=\"a8098a.672364762364\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:class>sip</rpid:class>\n<rpid:privacy><text/></rpid:privacy>\n<rpid:status-icon>http://example.com/~user2/icon.gif</rpid:status-icon>\n<pcp:servcaps>\n<pcp:video>false</pcp:video>\n<pcp:audio>true</pcp:audio>\n</pcp:servcaps>\n<contact priority=\"0.8\">sip:user2_public1@home2.net</contact>\n<note xml:lang=\"en\">Don't Disturb Please!</note>\n<note xml:lang=\"fr\">Ne derangez pas, s'il vous plait</note>\n<timestamp>2003-08-27T11:49:29Z</timestamp>\n</tuple>\n\n<tuple id=\"jklhgf9788934774.78\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:class>assistant</rpid:class>\n<rpid:relationship><rpid:assistant/></rpid:relationship>\n<contact priority=\"1.0\">tel:+1-212-555-2222</contact>\n<note xml:lang=\"en\">She's my secretary</note>\n<timestamp>2003-08-27T11:49:29Z</timestamp>\n</tuple>\n\n<dm:person id=\"s438\">\n<rpid:class>presentity</rpid:class>\n<c:homepage>http://example.com/~user2</c:homepage>\n<c:card>http://example.com/~user2/card.vcd</c:card>\n<rpid:activities><rpid:meeting/></rpid:activities>\n<rpid:place-type until=\"2003-08-27T17:30:00Z\"><rpid:office/></rpid:place-type>\n</dm:person>\n\n</diff:pidf-full>\n\nP-Charging-Vector:\tThe PS populates the icid parameter with a globally unique identifier and adds the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe PS populates the P-Charging-Function-Addresses header field to be passed to the S-CSCF.\nContent-Type:\tSet to the preferred value of the Accept header received in the SUBSCRIBE request.\nThe message body in the NOTIFY request that carries the presence information of the presentity is formed as indicated in RFC 3863 [21], RFC 4480 [26], RFC 5196 [25], RFC 4482 [32], RFC 5263  [24] and RFC 4479 [44].\n16.\tNOTIFY request (S-CSCF to P-CSCF) - see example in table A.3.2.1-16\nThe S-CSCF#1 forwards the NOTIFY request to P-CSCF#1.\nTable A.3.2.1-16: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nMax-Forwards: 69\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=123551024\"\nP-Charging-Function-Addresses:\nPrivacy:\nRecord-Route: <sip:scscf1.home1.net;lr>\nRoute: sip:<pcscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter of this header and removes the parameter from this header.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the P-CSCF.\n17.\tNOTIFY request (P-CSCF to UE) - see example in table A.3.2.1-17\nThe P-CSCF forwards the NOTIFY request to the watcher in the UE.\nTable A.3.2.1-17: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nMax-Forwards: 68\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.home1.net:7531;lr;comp=sigcomp>\nPrivacy:\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\n18.\t200 (OK) response (UE to P-CSCF) - see example in table A.3.2.1-18\nThe UE generates a 200 (OK) response to the NOTIFY request.\nTable A.3.2.1-18: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK764z87.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n19.\t200 (OK) response (P-CSCF to S-CSCF) – see example in table A.3.2.1-19\nThe P-CSCF forwards the 200 (OK) response to S-CSCF#1.\nTable A.3.2.1-19: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nP-Access-Network-Info:\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n20.\t200 (OK) response (S-CSCF to P-S) - see example in table A.3.2.1-20\nS-CSCF#2 forwards the 200 (OK) response to the PS.\nTable A.3.2.1-20: 200 (OK) response (S-CSCF to PS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.3.2.1-5a: Cx: User location query procedure (I-CSCF to HSS)",
                                    "table number": 1,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.3.2.1-5b: Cx: User location query procedure (HSS to I-CSCF)",
                                    "table number": 2,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "A.3.3\tWatcher subscribing to resource list, UE in visited network",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "A.3.3.1\tWatcher subscribing to his own resource list, UE in visited network - Successful subscription",
                            "text_content": "Figure A.3.3.1-1 illustrates a watcher subscribing to a resource list, depicting the process of a watcher entity in a network communication system. The figure shows the watcher initiating a subscription request to a resource list, which is managed by a resource manager. The resource manager is responsible for maintaining and organizing the resources available in the network, ensuring efficient allocation and management. The watcher, after successfully subscribing to the resource list, will receive updates on the available resources and their corresponding properties, enabling it to make informed decisions regarding resource usage and allocation. The figure highlights the importance of resource management in network systems, emphasizing the need for a centralized entity to manage and distribute resources effectively.\nFigure A.3.3.1-1: Watcher subscribing to resource list\nFigure A.3.3.1-1 shows a watcher subscribing to resource list event notification. The details of the signalling flows are as follows:\n1.\tSUBSCRIBE request (UE to P-CSCF) – see example in table A.3.3.1-1\nA watcher agent in a UE wishes to watch a number of presentities, or certain presence information of these presentities. The list of presentities are identified by a SIP URI. In order to initiate a subscription to the RLS, the UE generates a SUBSCRIBE request indicating support for \"eventlist\", together with an indication of the length of time this periodic subscription should last.\nTable A.3.3.1-1: SUBSCRIBE request (UE to P-CSCF)\nSUBSCRIBE sip:user1_list1@home1.net SIP/2.0\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nMax-Forwards: 70\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nRoute: <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>, <sip:orig@scscf1.home1.net;lr>\nP-Preferred-Identity: <sip:user1_public1@home1.net>\nPrivacy: none\nFrom: <sip:user1_public1@home1.net>;tag=31415\nTo: <sip:user1_list1@home1.net>\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 123 SUBSCRIBE\nRequire: sec-agree\nProxy-Require: sec-agree\nSecurity-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432; spi-s=87654321; port-c=8642; port-s=7531\nEvent: presence\nSupported: eventlist\nExpires: 7200\nAccept: application/pidf+xml, application/rlmi+xml, multipart/related\nContact: <sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp>\nContent-Length: 0\n\nRequest-URI:\tSIP URI of the resource list representing the collection of public user identities whose events the subscriber subscribes to.\nEvent:\tThis field is populated with the value \"presence\" to specify the use of the presence package.\nAccept:\tThis field is populated with the value \"application/pidf+xml\", \"application/rlmi+xml\" and \"multipart/related\" indicating that the UE supports both body types for the eventlist extension additionally to PIDF.\nSupported:\tThis field is populated with the value \"eventlist\" to specify the support for the eventlist extension.\nTo:\tSame as the Request-URI.\n2.\tSUBSCRIBE request (P-CSCF to S-CSCF) – see example in table A.3.3.1-2\nThe P-CSCF looks up the serving network information for the public user identity that was stored during the registration procedure. The SUBSCRIBE request is forwarded to S-CSCF#1. A Route header is inserted into SUBSCRIBE request. The information for the Route header is taken from the service route determined during registration.\nTable A.3.3.1-2: SUBSCRIBE request (P-CSCF to S-CSCF)\nSUBSCRIBE sip:user1_list1@home1.net SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Access-Network-Info:\nRoute: <sip:orig@scscf1.home1.net;lr>\nMax-Forwards: 69\nP-Asserted-Identity: <sip:user1_public1@home1.net>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"\nPrivacy:\nRecord-Route: <sip:pcscf1.visited1.net;lr>\nRoute: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nSupported:\nExpires:\nAccept:\nContact:\nContent-Length:\n\n3.\tEvaluation of initial filter criteria\nThe S-CSCF validates the service profile of this subscriber and evaluates the initial filter criteria. Assuming that sip:user1_list1@home1.net is a statically created PSI, sip:user1_list1@home1.net is included in the service profile as part of an originating initial Filter Criteria with Service Trigger Point of Method = SUBSCRIBE AND Supported = \"eventlist\" AND Request-URI = sip:user1_list1@home1.net that informs the S-CSCF to route the SUBSCRIBE request to the AS sip:rls.home1.net.\nIf there is no initial filter criteria for this PSI (sip:user1_list1@home1.net), the assumption is that the PSI is a sub domain-based PSI. The procedure defined in RFC 3263 [18] with DNS NAPTR and SRV queries may then be used to get the IP address of the AS home1.net.\n4.\tSUBSCRIBE request (S-CSCF to RLS) – see example in table A.3.3.1-4\nThe S-CSCF forwards the SUBSCRIBE request to the RLS.\nTable A.3.3.1-4: SUBSCRIBE request (S-CSCF to RLS)\nSUBSCRIBE sip:user1_list1@home1.net SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK344a65.1, SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nMax-Forwards: 68\nP-Access-Network-Info:\nP-Asserted-Identity: <sip:user1_public1@home1.net>, <tel:+1-212-555-1111>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nPrivacy:\nRecord-Route: <sip:orig@scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nRoute: <sip:rls.home1.net;lr>, <sip:orig@scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nSupported:\nExpires:\nAccept:\nContact:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe S-CSCF populates the P-Charging-Function-Addresses header field to be passed to the RLS.\n5.\tAuthorization of watcher\nThe RLS performs the necessary authorization checks on the originator to ensure that he/she is authorized to use the resource list. In this example this condition has been met, so the PS sends a 200 (OK) response to the S-CSCF. If the previous condition failed, then a 403 (Forbidden) response would be sent to the S-CSCF.\n6.\t200 (OK) response (RLS to S-CSCF) - see example in table A.3.3.1-6\nThe RLS sends the response to the S-CSCF.\nTable A.3.3.1-6: 200 (OK) response (RLS to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK344a65.1, SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"; orig-ioi=home1.net; term-ioi=home1.net\nRecord-Route:\nFrom:\nTo: <sip:user1_list1@home1.net>;tag=151170\nCall-ID:\nCSeq:\nRequire: eventlist\nExpires:\nContact:\nContent-Length: 0\n\nP-Charging-Vector:\tThe RLS stores the terminating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\n7.\t200 (OK) response (S-CSCF to P-CSCF) - see example in table A.3.3.1-7\nThe S-CSCF forwards the response to the P-CSCF.\nTable A.3.3.1-7: 200 (OK) response (S-CSCF to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nRequire:\nExpires:\nContact:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the terminating Inter Operator Identifier (IOI) parameter received.\n8.\t200 (OK) response (P-CSCF to UE) - see example in table A.3.3.1-8\nThe P-CSCF forwards the response to the watcher agent in the UE.\nTable A.3.3.1-8: 200 (OK) response (P-CSCF to UE)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nRecord-Route: <sip:orig@scscf1.home1.net;lr>, <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nRequire:\nExpires:\nContact:\nContent-Length:\n\n9.\tNOTIFY request (RLS to S-CSCF) - see example in table A.3.3.1-9\nThe RLS generates a NOTIFY request including the RLMI document as a result of the SUBSCRIBE request.\nTable A.3.3.1-9 NOTIFY request (RLS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom: <sip:user1_list1@home1.net>;tag=151170\nTo: <sip:user1_public1@home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 89 NOTIFY\nSubscription-State: active;expires=7200\nRequire: eventlist\nEvent: presence\nContact: <sip:rls.home1.net>\nContent-Type: application/rlmi+xml;charset=\"UTF-8\"\nContent-Length:\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<list xmlns=\"urn:ietf:params:xml:ns:rmli\"\nuri=\"sip:user1_list1@home1.net\" version=\"1\" fullState=\"true\">\n<resource uri=\"pres:user2_public1@home2.net\">\n<name>Kovacs Janos</name>\n<instance id=\"hqzsuxtfyq\" state=\"active\" cid=\"ZvSvkz@rls.home1.net\"/>\n</resource>\n<resource uri=\"pres:user3_public1@home3.net\">\n<name>Szabo Bela</name>\n<instance id=\"aakdsjklsa\" state=\"active\" cid=\"HJjbssk@rls.home1.net\"/>\n</resource>\n</list>\n\nP-Charging-Vector:\tThe RLS inserts this header and populates the icid parameters with a globally unique value and adds the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe RLS populates the P-Charging-Function-Addresses header field to be passed to the S-CSCF.\n10.\tNOTIFY request (S-CSCF to P-CSCF) - see example in table A.3.3.1-10\nThe S-CSCF forwards the NOTIFY request to the P-CSCF.\nTable A.3.3.1-10: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 69\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"\nP-Charging-Function-Addresses:\nRoute: <sip:pcscf1.visited1.net;lr>\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nRequire:\nEvent:\nContact:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF stores originating Inter Operator Identifier (IOI) parameter received.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the P-CSCF.\n11.\tNOTIFY request (P-CSCF to UE) – see example in table A.3.3.1-11\nThe P-CSCF forwards the NOTIFY request to the watcher in the UE.\nTable A.3.3.1-11: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 68\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nRequire:\nEvent:\nContact:\nContent-Length:\n\n(…)\n\n12.\t200 (OK) response (UE to P-CSCF) – see example in table A.3.3.1-12\nThe UE acknowledges the NOTIFY request with a 200 (OK) response to the P-CSCF.\nTable A.3.3.1-12: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n13.\t200 (OK) response (P-CSCF to S-CSCF) – see example in table A.3.3.1-13\nThe P-CSCF forwards the 200 (OK) response to the S-CSCF.\nTable A.3.3.1-13: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n14.\t200 (OK) response (S-CSCF to RLS) - see example in table A.3.3.1-14\nThe S-CSCF#2 forwards the response to the RLS in the home network of the UE.\nTable A.3.3.1-14: 200 (OK) response (S-CSCF to RLS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"; orig-ioi=home1.net; term-ioi=home1.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF inserts the originating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\n15.\tSubscriptions and notifications on presence event package\nAfter the RLS generated a NOTIFY request to inform the UE about the subscription state, the RLS generates the necessary SUBSCRIBE requests to the presentities present in the resource list as described in subclause A.3.4.1. As soon as it receives NOTIFY request(s) about a state change in one or more presentities, it generates a NOTIFY request.\n16.\tNOTIFY request (RLS to S-CSCF) – see example in table A.3.3.1-16\nThe RLS copies the body of the incoming NOTIFY request(s) into the body of the outgoing NOTIFY request using MIME type multipart/related. Further notification sent by the RLS may contain either the full or the partial set of presence information (only the presence information that has changed since the last notification) as described in RFC 4662 [22].\nIn this example it is assumed that the RLS has received two NOTIFY requests from presentities sip:user2_public1@home2.net and sip:user3_public1@home3.net before generating the NOTIFY request in table A.3.3.1-16 to the UE.\nTable A.3.3.1-16 NOTIFY request (RLS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=423551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom: <sip:user1_list1@home1.net>;tag=151170\nTo: <sip:user1_public1.home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 90 NOTIFY\nSubscription-State: active;expires=5000\nRequire: eventlist\nEvent: presence\nContact: <sip:rls.home1.net>\nContent-Type: multipart/related;type=\"application/rlmi+xml\"; start=\"<nXYxAE@rls.home1.net>\";boundary=\"50UBfW7LSCVLtggUPe5z\"\nContent-Length: (...)\n\n--50UBfW7LSCVLtggUPe5z\nContent-Transfer-Encoding: binary\nContent-ID: <nXYxAE@rls.home1.net>\nContent-Type: application/rlmi+xml;charset=\"UTF-8\"\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<list xmlns=\"urn:ietf:params:xml:ns:rmli\"\nuri=\"sip:user1_list1@home1.net\" version=\"1\" fullState=\"true\">\n<resource uri=\"pres:user2_public1@home2.net\">\n<name>Kovacs Janos</name>\n<instance id=\"hqzsuxtfyq\" state=\"active\" cid=\"ZvSvkz@rls.home1.net\"/>\n</resource>\n<resource uri=\"pres:user3_public1@home3.net\">\n<name>Szabo Bela</name>\n<instance id=\"aakdsjklsa\" state=\"active\" cid=\"HJjbssk@rls.home1.net\"/>\n</resource>\n</list>\n\n--50UBfW7LSCVLtggUPe5z\nContent-Transfer-Encoding: binary\nContent-ID: <ZvSvkz@rls.home1.net>\nContent-Type: application/pidf+xml;charset=\"UTF-8\"\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<presence xmlns=\"urn:ietf:params:xml:ns:pidf\"\nxmlns:rpid=\"urn:ietf:params:xml:ns:pidf:rpid\"\nxmlns:dm=\"urn:ietf:params:xml:ns:pidf:data-model\"\nxmlns:pcp=\"urn:ietf:params:xml:ns:pidf:caps\"\nxmlns:c=\"urn:ietf:params:xml:ns:pidf:cipid\"\nentity=\"pres:user2_public1@home2.net\">\n\n<tuple id=\"a8098a.672364762364\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:class>sip</rpid:class>\n<rpid:privacy><text/></rpid:privacy>\n<rpid:status-icon>http://example.com/~user2/icon.gif</rpid:status-icon>\n<pcp:servcaps>\n<pcp:video>false</pcp:video>\n<pcp:audio>true</pcp:audio>\n</pcp:servcaps>\n<contact priority=\"0.8\">sip:user2_public1@home2.net</contact>\n<note xml:lang=\"en\">Don't Disturb Please!</note>\n<note xml:lang=\"fr\">Ne derangez pas, s'il vous plait</note>\n<timestamp>2003-08-27T11:49:29Z</timestamp>\n</tuple>\n\n<tuple id=\"jklhgf9788934774.78\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:class>assistant</rpid:class>\n<rpid:relationship><rpid:assistant/></rpid:relationship>\n<contact priority=\"1.0\">tel:+1-212-555-2222</contact>\n<note xml:lang=\"en\">She's my secretary</note>\n<timestamp>2003-08-27T11:49:29Z</timestamp>\n</tuple>\n\n<dm:person>\n<rpid:class>presentity</rpid:class>\n<c:homepage>http://example.com/~user2</c:homepage>\n<c:card>http://example.com/~user2/card.vcd</c:card>\n<rpid:activities><rpid:meeting/></rpid:activities>\n<rpid:place-type until=\"2003-08-27T17:30:00Z\"><rpid:office/></rpid:place-type>\n</dm:person>\n\n</presence>\n\n--50UBfW7LSCVLtggUPe5z\nContent-Transfer-Encoding: binary\nContent-ID: <ZvSvkz@pres.example.com>\nContent-Type: application/pidf+xml;charset=\"UTF-8\"\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<presence xmlns=\"urn:ietf:params:xml:ns:pidf\"\nxmlns:rpid=\"urn:ietf:params:xml:ns:pidf:rpid\"\nxmlns:dm=\"urn:ietf:params:xml:ns:pidf: data-model\"\nxmlns:pcp=\"urn:ietf:params:xml:ns:pidf:caps\"\nentity=\"pres:user3_public1@home3.net\">\n\n<tuple id=\"h7833hjkk.dsajfjdsaf\">\n<status>\n<basic>closed</basic>\n</status>\n<rpid:class>sip</rpid:class>\n<rpid:privacy><rpid:text/></rpid:privacy>\n<pcp:servcaps>\n<pcp:video>false</pcp:video>\n<pcp:audio>true</pcp:audio>\n</pcp:servcaps>\n<contact priority=\"0.8\">sip:user3_public1@home3.net</contact>\n<note xml:lang=\"en\">Don't Disturb Please!</note>\n<note xml:lang=\"hu\">Senki se merjen zavarni!</note>\n<timestamp>2003-08-27T11:48:59Z</timestamp>\n</tuple>\n\n<tuple id=\"sajdhdsahjh75vvcb774.78\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:class>supervisor</rpid:class>\n<rpid:relationship><rpid:supervisor/></rpid:relationship>\n<contact priority=\"1.0\">tel:+1-858-204-9141</contact>\n<note xml:lang=\"en\">He's my supervisor</note>\n<timestamp>2003-08-27T11:48:59Z</timestamp>\n</tuple>\n\n<dm:person>\n<c:homepage>http://example.com/~user3</c:homepage>\n<c:card>http://example.com/~user3/card.vcd</c:card>\n<rpid:class>presentity</rpid:class>\n<rpid:activities><rpid:vacation/></rpid:activities>\n<rpid:place-type until=\"2003-09-10T17:30:00Z\"><rpid:ship/></rpid:place-type>\n</dm:person>\n\n</presence>\n\n--50UBfW7LSCVLtggUPe5z--\n\nP-Charging-Vector:\tThe RLS inserts this header and populates the icid parameters with a globally unique value and adds the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe RLS populates the P-Charging-Function-Addresses header field to be passed to the S-CSCF.\nContent-Type:\tSet to the value of the Accept: header received in the SUBSCRIBE request.\nThe message body in the NOTIFY request that carries the presence information of the presentity is formed as indicated in RFC 4662 [22], RFC 4479 [44], RFC 4480 [26], RFC 4482 [32] and RFC 5196 [25].\n17.\tNOTIFY request (S-CSCF to P-CSCF) - see example in table A.3.3.1-17\nThe S-CSCF forwards the NOTIFY request to the P-CSCF.\nTable A.3.3.1-17: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 69\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=423551024\"\nP-Charging-Function-Addresses:\nRoute: <sip:pcscf1.visited1.net;lr>\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nRequire:\nEvent:\nContact:\nContent Type:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe RLS stores the originating Inter Operator Identifier (IOI) parameter received.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the P-CSCF.\n18.\tNOTIFY request (P-CSCF to UE) - see example in table A.3.3.1-18\nThe P-CSCF forwards the NOTIFY request to the watcher in the UE.\nTable A.3.3.1-18: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 68\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nRequire:\nEvent:\nContent-Type:\nContent-Length:\n\n(…)\n\n19.\t200 (OK) response (UE to P-CSCF) – see example in table A.3.3.1-19\nThe UE acknowledges the NOTIFY request with a 200 (OK) response to the P-CSCF.\nTable A.3.3.1-19: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n20.\t200 (OK) response (P-CSCF to S-CSCF) - see example in table A.3.3.1-20\nThe P-CSCF forwards the 200 (OK) response to the S-CSCF.\nTable A.3.3.1-20: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=423551024\"\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n21.\t200 (OK) response (S-CSCF to RLS) - see example in table A.3.3.1-21\nThe S-CSCF#2 forwards the response to the RLS in the home network of the UE.\nTable A.3.3.1-21: 200 (OK) response (S-CSCF to RLS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=423551024\"; orig-ioi=home1.net; term-ioi=home1.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF inserts the originating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\n",
                            "figures_meta_data": [],
                            "tables": []
                        },
                        {
                            "title": "A.3.3.2\tWatcher subscribing to a resource list, UE in visited network - successful subscription",
                            "text_content": "Figure A.3.3.2-1 illustrates a watcher subscribing to a resource list in a network management system. The figure depicts the interaction between the watcher and the network management system, showing the process of the watcher requesting and receiving resources from the system. Key components include the watcher, resource list, and network management system. The figure highlights the importance of efficient resource management in network operations.\nFigure A.3.3.2-1 Watcher subscribing to resource list\nFigure A.3.3.2-1 shows a watcher subscribing to resource list event notification. The details of the signalling flows are as follows:\n1.\tSUBSCRIBE request (UE to P-CSCF) - see example in table A.3.3.2-1\nA watcher agent in a UE wishes to watch a number of presentities, or certain presence information of these presentities. The list of presentities are identified by a SIP URI. In order to initiate a subscription to the RLS, the UE generates a SUBSCRIBE request indicating support for \"eventlist\", together with an indication of the length of time this periodic subscription should last.\nTable A.3.3.2-1: SUBSCRIBE request (UE to P-CSCF)\nSUBSCRIBE sip:user2_list1@home2.net SIP/2.0\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nMax-Forwards: 70\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nRoute: <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>, <sip:orig@scscf1.home1.net;lr>\nP-Preferred-Identity: <sip:user1_public1@home1.net>\nPrivacy: none\nFrom: <sip:user1_public1@home1.net>;tag=31415\nTo: <sip:user2_list1@home1.net>\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 123 SUBSCRIBE\nRequire: sec-agree\nProxy-Require: sec-agree\nSecurity-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432; spi-s=87654321; port-c=8642; port-s=7531\nEvent: presence\nSupported: eventlist\nExpires: 7200\nAccept: application/pidf+xml, application/rlmi+xml, multipart/related\nContact: <sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp>\nContent-Length: 0\n\nRequest-URI:\tSIP URI of the resource list representing the collection of public user identities whose events the subscriber subscribes to.\nEvent:\tThis field is populated with the value \"presence\" to specify the use of the presence package.\nAccept:\tThis field is populated with the value \"application/pidf+xml\", \"application/rlmi+xml\" and \"multipart/related\" indicating that the UE supports the eventlist extension additionally to PIDF.\nSupported:\tThis field is populated with the value \"eventlist\" to specify the support for the eventlist extension.\nTo:\tSame as the Request-URI.\n2.\tSUBSCRIBE request (P-CSCF to S-CSCF) - see example in table A.3.3.2-2\nThe P-CSCF looks up the serving network information for the public user identity that was stored during the registration procedure. The SUBSCRIBE request is forwarded to S-CSCF#1. A Route header is inserted into SUBSCRIBE request. The information for the Route header is taken from the service route determined during registration.\nTable A.3.3.2-2: SUBSCRIBE request (P-CSCF to S-CSCF)\nSUBSCRIBE sip:user2_list1@home2.net SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Access-Network-Info:\nRoute: <sip:orig@scscf1.home1.net;lr>\nMax-Forwards: 69\nP-Asserted-Identity: <sip:user1_public1@home1.net>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"\nPrivacy:\nRecord-Route: <sip:pcscf1.visited1.net;lr>\nRoute: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nSupported:\nExpires:\nAccept:\nContact:\nContent-Length:\n\n3.\tEvaluation of initial filter criteria\nS-CSCF#1 validates the service profile of this subscriber and evaluates the initial filter criteria.  In this example, no AS is assumed to be involved.\n4.\tSUBSCRIBE request (S-CSCF to I-CSCF) - see example in table A.3.3.2-4\nS-CSCF#1 performs an analysis of the destination address. As the destination address points to a resource that is in a different network as the S-CSCF, the S-CSCF sends the request to the I-CSCF of home2.net.\nTable A.3.3.2-4: SUBSCRIBE request (S-CSCF to I-CSCF)\nSUBSCRIBE sip:user2_list1@home2.net SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK344a65.1, SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nMax-Forwards: 68\nP-Asserted-Identity: <sip:user1_public1@home1.net>, <tel:+1-212-555-1111>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nPrivacy:\nRecord-Route: <orig@sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nSupported:\nExpires:\nAccept:\nContact:\nContent-Length:\n\n5.\tPSI location query\nThe I-CSCF sends a query to the HSS to find the RLS where sip:user2_list1@home2.net is hosted. The HSS responds with the address of the RLS.\nFor detailed message flows see 3GPP TS 29.228 [10].\nTable A.3.3.2-5a provides the parameters in the SIP SUBSCRIBE request (flow 4), which are sent to the HSS.\nTable A.3.3.2-5a Cx: User location query procedure (I-CSCF to HSS)\n\nTable A.3.3.2-5b provides the parameters sent from the HSS that need to be mapped to SIP SUBSCRIBE (flow 6) and sent to S-CSCF.\nTable A.3.3.2-5b Cx: User location query procedure (HSS to I-CSCF)\n\n6.\tSUBSCRIBE request (I-CSCF to RLS) - see example in table A.3.3.2-6\nThe I-CSCF forwards the SUBSCRIBE request to the RLS.\nTable A.3.3.2-6: SUBSCRIBE request (I-CSCF to S-CSCF)\nSUBSCRIBE sip:user2_list1@home2.net SIP/2.0\nVia: SIP/2.0/UDP icscf2_s.home2.net;branch=z9hG4bK871y12.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK344a65.1, SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nMax-Forwards: 67\nP-Asserted-Identity:\nP-Charging-Vector:\nPrivacy:\nRecord-Route:\nRoute: <sip:rls.home2.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nSupported:\nExpires:\nAccept:\nContact:\nContent-Length:\n\n7.\tAuthorization of watcher\nThe RLS performs the necessary authorization checks on the originator to ensure that he/she is authorized to use the resource list. In this example this condition has been met, so the PS sends a 200 (OK) response to the S-CSCF. If the previous condition failed, then a 403 (Forbidden) response would be sent to the S-CSCF.\n8.\t200 (OK) response (RLS to I-CSCF) - see example in table A.3.3.2-8\nThe RLS sends the response to the S-CSCF.\nTable A.3.3.2-8: 200 (OK) response (RLS to I-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP icscf2_s.home2.net;branch=z9hG4bK871y12.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK344a65.1, SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"; orig-ioi=home1.net; term-ioi=home2.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRecord-Route:\nFrom:\nTo: <sip:user2_list1@home2.net>;tag=151170\nCall-ID:\nCSeq:\nRequire: eventlist\nExpires:\nContact: <sip:rls.home2.net>\nContent-Length: 0\n\nP-Charging-Vector:\tThe RLS stores the originating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe RLS stores the P-Charging-Function-Addresses header field and passes this header to the I-CSCF.\n9.\t200 (OK) response (I-CSCF to S-CSCF) - see example in table A.3.3.2-9\nThe I-CSCF forwards the response to the S-CSCF.\nTable A.3.3.2-9: 200 (OK) response (I-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK344a65.1, SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Charging-Vector:\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nRequire:\nExpires:\nContact:\nContent-Length: 0\n\nP-Charging-Vector:\tThe RLS stores the header and passes this header to the S-CSCF.\n10.\t200 (OK) response (S-CSCF to P-CSCF) - see example in table A.3.3.2-10\nThe S-CSCF forwards the response to the P-CSCF.\nTable A.3.3.2-10: 200 (OK) response (S-CSCF to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nRequire:\nExpires:\nContact:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the terminating Inter Operator Identifier (IOI) parameter.\n11.\t200 (OK) response (P-CSCF to UE) - see example in table A.3.3.2-11\nThe P-CSCF forwards the response to the watcher agent in the UE.\nTable A.3.3.2-11: 200 (OK) response (P-CSCF to UE)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nRecord-Route: <sip:orig@scscf1.home1.net;lr>, <sip:pcscf1.home1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nRequire:\nExpires:\nContact:\nContent-Length:\n\n12.\tNOTIFY request (RLS to S-CSCF) – see example in table A.3.3.2-12\nThe RLS generates a NOTIFY request including the RLMI document as a result of the SUBSCRIBE request.\nTable A.3.3.2-12: NOTIFY request (RLS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP rls.home2.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=123551024\"; orig-ioi=home1.net\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom: <sip:user2_list1@home1.net>;tag=151170\nTo: <sip:user1_public1.home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 89 NOTIFY\nSubscription-State: active;expires=5000\nRequire: eventlist\nEvent: presence\nContact: <sip:rls.home1.net>\nContent-Type: application/rlmi+xml;charset=\"UTF-8\"\nContent-Length: (...)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<list xmlns=\"urn:ietf:params:xml:ns:rmli\"\nuri=\"sip:user1_list1@home1.net\" version=\"1\" fullState=\"true\">\n<resource uri=\"pres:user2_public1@home2.net\">\n<name>Kovacs Janos</name>\n<instance id=\"hqzsuxtfyq\" state=\"active\" cid=\"ZvSvkz@rls.home2.net\"/>\n</resource>\n<resource uri=\"pres:user3_public1@home2.net\">\n<name>Szabo Bela</name>\n<instance id=\"aakdsjklsa\" state=\"active\" cid=\"HJjbssk@rls.home2.net\"/>\n</resource>\n</list>\n\nP-Charging-Vector:\tThe RLS populates the icid parameter with a globally unique value and  populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\n13.\tNOTIFY request (S-CSCF to P-CSCF) - see example in table A.3.3.2-13\nThe S-CSCF#1 forwards the NOTIFY request to the P-CSCF.\nTable A.3.3.2-13: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home2.net;branch=z9hG4bK240f34.1\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=123551024\"\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nMax-Forwards: 69\nRecord-Route: <sip:scscf1.home1.net;lr>\nRoute: <sip:pcscf1.visited1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nRequire:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter.\nP-Charging-Function-Addresses:\tThe RLS populates the P-Charging-Function-Addresses header field to be passed to the I-CSCF.\n14.\tNOTIFY request (P-CSCF to UE) - see example in table A.3.3.2-14\nThe P-CSCF forwards the NOTIFY request to the watcher in the UE.\nTable A.3.3.2-14: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home2.net;branch=z9hG4bK240f34.1\nMax-Forwards: 68\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.home1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nRequire:\nEvent: Contact:\nContent-Type:\nContent-Length:\n\n(…)\n\n15.\t200 (OK) response (UE to P-CSCF) - see example in table A.3.3.2-15\nThe UE acknowledges the NOTIFY request with a 200 (OK) to the P-CSCF.\nTable A.3.3.2-15: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home2.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n16.\t200 (OK) response (P-CSCF to S-CSCF) – see example in table A.3.3.2-16\nThe P-CSCF forwards the 200 (OK) response to the S-CSCF#1.\nTable A.3.3.2-16: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home2.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=123551024\"\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n17.\t200 (OK) response (S-CSCF to RLS) - see example in table A.3.3.2-17\nThe S-CSCF#1 forwards the response to the RLS in the home network of the UE.\nTable A.3.3.2-17: 200 (OK) response (S-CSCF to RLS)\nSIP/2.0 200 OK\nVia: SP/2.0/UDP rls.home2.net;branch=z9hG4bK240f34.1\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=123551024\"; orig-ioi=home1.net: term-ioi=home1.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF inserts the originating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\n18.\tSubscriptions and notifications on presence event package\nAfter the RLS generated a 200 (OK) response to the SUBSCRIBE request from the UE, it generates the necessary SUBSCRIBE requests to the presentities present in the resource list as described in subclause A.3.4.1. As soon as it receives NOTIFY request(s) about a state change in one or more presentities, it generates a NOTIFY request.\n19.\tNOTIFY request (RLS to S-CSCF) – see example in table A.3.3.2-19\nThe RLS copies the body of the incoming NOTIFY request(s) into the body of the outgoing NOTIFY request using MIME type multipart/related. Further notification sent by the RLS contain may contain either the full or the partial set of presence information (only the presence information that has changed since the last notification) as described in RFC 4662 [22].\nIn this example it is assumed that the RLS receives two NOTIFY requests from presentities sip:user2_public1@home2.net and sip:user3_public1@home3.net before generating the NOTIFY request in subclause A.3.3.2-23 to the UE.\nTable A.3.3.2-19: NOTIFY request (RLS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP rls.home2.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"; orig-ioi=home1.net\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom: <sip:user2_list1@home1.net>;tag=151170\nTo: <sip:user1_public1.home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 89 NOTIFY\nSubscription-State: active;expires=5000\nRequire: eventlist\nEvent: presence\nContact: <sip:rls.home2.net>\nContent-Type: multipart/related;type=\"application/rlmi+xml\";\nstart=\"<nXYxAE@rls.home2.net>\";boundary=\"50UBfW7LSCVLtggUPe5z\"\nContent-Length: (...)\n\n--50UBfW7LSCVLtggUPe5z\nContent-Transfer-Encoding: binary\nContent-ID: <nXYxAE@rls.home2.net>\nContent-Type: application/rlmi+xml;charset=\"UTF-8\"\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<list xmlns=\"urn:ietf:params:xml:ns:rmli\"\nuri=\"sip:user1_list1@home1.net\" version=\"1\" fullState=\"true\">\n<resource uri=\"pres:user2_public1@home2.net\">\n<name>Kovacs Janos</name>\n<instance id=\"hqzsuxtfyq\" state=\"active\" cid=\"ZvSvkz@rls.home2.net\"/>\n</resource>\n<resource uri=\"pres:user3_public1@home3.net\">\n<name>Szabo Bela</name>\n<instance id=\"aakdsjklsa\" state=\"active\" cid=\"HJjbssk@rls.home2.net\"/>\n</resource>\n</list>\n\n--50UBfW7LSCVLtggUPe5z\nContent-Transfer-Encoding: binary\nContent-ID: <ZvSvkz@rls.home2.net>\nContent-Type: application/pidf+xml;charset=\"UTF-8\"\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<presence xmlns=\"urn:ietf:params:xml:ns:pidf\"\nxmlns:rpid=\"urn:ietf:params:xml:ns:pidf:rpid\"\nxmlns:dm=\"urn:ietf:params:xml:ns:pidf:data-model\"\nxmlns:pcp=\"urn:ietf:params:xml:ns:pidfcaps\"\nxmlns:c=\"urn:ietf:params:xml:ns:pidf:cipid\"\nentity=\"pres:user2_public1@home2.net\">\n\n<tuple id=\"a8098a.672364762364\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:class>sip</rpid:class>\n<rpid:privacy><text/></rpid:privacy>\n<rpid:status-icon>http://example.com/~user2/icon.gif</rpid:status-icon>\n<pcp:servcaps>\n<pcp:video>false</pcp:video>\n<pcp:audio>true</pcp:audio>\n</pcp:servcaps>\n<contact priority=\"0.8\">sip:user2_public1@home2.net</contact>\n<note xml:lang=\"en\">Don't Disturb Please!</note>\n<note xml:lang=\"fr\">Ne derangez pas, s'il vous plait</note>\n<timestamp>2003-08-27T11:49:29Z</timestamp>\n</tuple>\n\n<tuple id=\"jklhgf9788934774.78\">\n<status>\n<basic>open</basic>\n</status>\n<rp:class>assistant</rp:class>\n<rpid:relationship><rpid:assistant/></rpid:relationship>\n<contact priority=\"1.0\">tel:+1-212-555-2222</contact>\n<note xml:lang=\"en\">She's my secretary</note>\n<timestamp>2003-08-27T11:49:29Z</timestamp>\n</tuple>\n\n<dm:person>\n<rpid:class>presentity</rpid:class>\n<c:homepage>http://example.com/~user2</c:homepage>\n<c:card>http://example.com/~user2/card.vcd</c:card>\n<rpid:activities><rpid:meeting/></rpid:activities>\n<rpid:place-type until=\"2003-08-27T17:30:00Z\"><rpid:office/></rpid:place-type>\n</dm:person>\n\n</presence>\n\n--50UBfW7LSCVLtggUPe5z\nContent-Transfer-Encoding: binary\nContent-ID: <ZvSvkz@pres.example.com>\nContent-Type: application/pidf+xml;charset=\"UTF-8\"\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<presence xmlns=\"urn:ietf:params:xml:ns:pidf\"\nxmlns:rpid=\"urn:ietf:params:xml:ns:pidf:rpid\"\nxmlns:dm=\"urn:ietf:params:xml:ns:pidf:data-model\"\nxmlns:pcp=\"urn:ietf:params:xml:ns:pidf:caps\"\nentity=\"pres:user3_public1@home3.net\">\n\n<tuple id=\"h7833hjkk.dsajfjdsaf\">\n<status>\n<basic>closed</basic>\n</status>\n<rpid:class>sip</rpid:class>\n<rpid:privacy><rpid:text/></rpid:privacy>\n<pcp:servcaps>\n<pcp:video>false</pcp:video>\n<pcp:audio>true</pcp:audio>\n</pcp:servcaps>\n<contact priority=\"0.8\">sip:user3_public1@home3.net</contact>\n<note xml:lang=\"en\">Don't Disturb Please!</note>\n<note xml:lang=\"hu\">Senki se merjen zavarni!</note>\n<timestamp>2003-08-27T11:48:59Z</timestamp>\n</tuple>\n\n<tuple id=\"sajdhdsahjh75vvcb774.78\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:class>supervisor</rpid:class>\n<rpid:relationship><rpid:supervisor/></rpid:relationship>\n<contact priority=\"1.0\">tel:+1-858-204-9141</contact>\n<note xml:lang=\"en\">He's my supervisor</note>\n<timestamp>2003-08-27T11:48:59Z</timestamp>\n</tuple>\n\n<dm:person>\n<c:homepage>http://example.com/~user3</c:homepage>\n<c:card>http://example.com/~user3/card.vcd</c:card>\n<rpid:class>presentity</rpid:class>\n<rpid:activities><rpid:vacation/></rpid:activities>\n<rpid:place-type until=\"2003-09-10T17:30:00Z\"><rpid:ship/></rpid:place-type>\n</dm:person>\n\n</presence>\n\n--50UBfW7LSCVLtggUPe5z--\n\nP-Charging-Vector:\tThe RLS  populates the icid parameter with a globally unique value and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nContent-Type:\tSet to the value of the Accept: header received in the SUBSCRIBE request.\nThe message body in the NOTIFY request that carries the presence information of the presentity is formed as indicated in RFC 4662 [22], RFC 4479 [44], RFC 4480 [26], RFC 4482 [32] and RFC 5196 [25].\n20.\tNOTIFY request (S-CSCF to P-CSCF) - see example in table A.3.3.2-20\nThe S-CSCF#1 forwards the NOTIFY request to the P-CSCF.\nTable A.3.3.2-20: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home2.net;branch=z9hG4bK240f34.1\nMax-Forwards: 69\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:pcscf1.visited1.net;lr>\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nRequire:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF stores the terminating Inter Operator Identifier (IOI) parameter received.\nP-Charging-Function-Addresses:\tThe S-CSCF populates the P-Charging-Function-Addresses header field to be passed to the P-CSCF.\n21.\tNOTIFY request (P-CSCF to UE) - see example in table A.3.3.2-21\nThe P-CSCF forwards the NOTIFY request to the watcher in the UE.\nTable A.3.3.2-21: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1SIP/2.0/UDP rls.home2.net;branch=z9hG4bK240f34.1\nMax-Forwards: 68\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.home1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nRequire:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\n22.\t200 (OK) response (UE to P-CSCF) - see example in table A.3.3.2-22\nThe UE acknowledges the NOTIFY request with a 200 (OK) to the P-CSCF.\nTable A.3.3.2-22: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1SIP/2.0/UDP rls.home2.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n23.\t200 (OK) response (P-CSCF to S-CSCF) – see example in table A.3.3.2-23\nThe P-CSCF forwards the 200 (OK) response to the S-CSCF#1.\nTable A.3.3.2-23: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home2.net;branch=z9hG4bK240f34.1\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\", orig-ioi=hom1.net, term-ioi=visited1.net\nP-Access-Network-Info:\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n24.\t200 (OK) response (S-CSCF to RLS) – see example in table A.3.3.2-24\nThe S-CSCF#2 forwards the response to the RLS in the home network of the UE.\nTable A.3.3.2-24: 200 (OK) response (S-CSCF to RLS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP rls.home2.net;branch=z9hG4bK240f34.1\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\", orig-ioi=hom1.net; term-ioi=home1.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF inserts the originating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.3.3.2-5a Cx: User location query procedure (I-CSCF to HSS)",
                                    "table number": 3,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.3.3.2-5b Cx: User location query procedure (HSS to I-CSCF)",
                                    "table number": 4,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "A.3.4\tRLS subscribing to presentities in different network",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "A.3.4.1\tSuccessful subscription",
                            "text_content": "Figure A.3.4.1-1 illustrates the process of a Resource Load Sharing (RLS) subscribing to presentities in a different network. The figure depicts the interaction between the RLS and the presentities, showing how the RLS requests and receives network resources from the presentities. The figure highlights the importance of efficient resource allocation and management in network operations.\nFigure A.3.4.1-1 RLS subscribing to presentities in different network\nFigure A.3.4.1-1 shows the RLS subscribing to presence event notification about a presentity. The presentity is in a different IM CN subsystem. The details of the signalling flows are as follows:\n1.\tSUBSCRIBE request (RLS to S-CSCF) – see example in table A.3.4.1-1\nThe RLS resolves the watcher's resource address (the address is received according to subclause A.3.3) and subscribes to presence event notification at all the presentities that are represented by the resource list SIP URI. The home network of these presentities can be different or in the same network, as the RLS. In this example only a single subscription is shown where the home network of the presentity is another network. Subscriptions to other presentities follow a similar procedure. To initiate a subscription, the RLS generates a SUBSCRIBE request containing the \"presence\" event that it wishes to be notified of, together with an indication of the length of time this periodic subscription should last. The RLS sends the SUBSCRIBE request to the S-CSCF of \"sip:user1_public1@home1.net\" (S-CSCF#1). The address of S-CSCF#1 is either remembered from previous transactions (when \"sip:user1_public1@home1.net\" has subscribed for the resource list) or queried by the RLS using the Sh interface.\nTable A.3.4.1-1 SUBSCRIBE request (RLS to S-CSCF)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP rls.home1.net;branch=z9hG4bKehuefdam\nMax-Forwards: 70\nRoute: <sip:scscf1.home1.net;lr>\nP-Asserted-Identity: <sip:user1_public1@home1.net>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nFrom: <sip:user1_public1@home1.net>;tag=31415\nTo: <sip:user2_public1@home2.net>\nCall-ID: q987a9a87g087abgf7qyg7ag\nCSeq: 123 SUBSCRIBE\nEvent: presence\nExpires: 7200\nAccept: application/pidf+xml\nContact: <sip:rls.home1.net>\nContent-Length: 0\n\nRequest-URI:\tPublic user identity whose events the RLS subscribes to.\nP-Charging-Vector:\tThe RLS populates the icid parameter with a new globally unique value and populates the originating Inter Operator Identifier (IOI) parameter with the identifier of its own network of RLS.\nP-Charging-Function-Addresses:\tThe RLS populates the P-Charging-Function-Addresses header field to be passed to the S-CSCF.\nTo:\tSame as the Request-URI.\nEvent:\tThis field is populated with the value \"presence\" to specify the use of the presence package.\nAccept:\tThis field is populated with the value \"application/pidf+xml\".\n2.\tEvaluation of initial filter criteria\nS-CSCF#1 validates the service profile of this subscriber and evaluates the initial filter criteria.  In this example, no AS is assumed to be involved.\n3.\tSUBSCRIBE request (S-CSCF to I-CSCF) – see example in table A.3.4.1-3\nS-CSCF#1 performs an analysis of the destination address, and determines the network operator to whom the destination subscriber belongs. S-CSCF#1 forwards the request to the I-CSCF.\nTable A.3.4.1-3 SUBSCRIBE request (S-CSCF to I-CSCF)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bKehuehjgt, SIP/2.0/UDP rls.home1.net;branch=z9hG4bKehuefdam\nMax-Forwards: 69\nRecord-Route: <sip:orig@scscf1.home1.net;lr>\nP-Asserted-Identity:\nP-Charging-Vector:\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nAccept:\nContact:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter received.\n4.\tCx: User Location Query procedure\nThe I-CSCF sends a query to the HSS to find out the S-CSCF of the presentity. The HSS responds with the address of the current S-CSCF for the presentity.\nFor detailed message flows see 3GPP TS 29.228 [10].\nTable A.3.4.1-4a provides the parameters in the SIP SUBSCRIBE request (flow 3), which are sent to the HSS.\nTable A.3.4.1-4a: Cx: User location query procedure (I-CSCF to HSS)\n\nTable A.3.4.1-4b provides the parameters sent from the HSS that need to be mapped to SIP SUBSCRIBE request (flow 5) and sent to the S-CSCF.\nTable A.3.4.1-4b: Cx: User location query procedure (HSS to I-CSCF)\n\n5.\tSUBSCRIBE request (I-CSCF to S-CSCF) - see example in table A.3.4.1-5\nThe I-CSCF forwards the SUBSCRIBE request to the S-CSCF#2 that will handle the termination.\nTable A.3.4.1-5: SUBSCRIBE request (I-CSCF to S-CSCF)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP icscf2_s.home2.net;branch=z9hG4bKj5hgrt2o, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bKehuehjgt, SIP/2.0/UDP rls.home1.net;branch=z9hG4bKehuefdam\nMax-Forwards: 68\nP-Asserted-Identity:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"; orig-ioi=home1.net;\nRoute: <sip:scscf2.home2.net;lr>\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nAccept:\nContact:\nContent-Length:\n\n6.\tEvaluation of initial filter criteria\nS-CSCF#2 validates the service profile of this subscriber and evaluates the initial filter criteria. For sip:user2_public1@home2.net the S-CSCF has Termination initial Filter Criteria with Service Point Trigger of Method = SUBSCRIBE AND Event = \"presence\" that informs the S-CSCF to route the SUBSCRIBE request to the AS ps.home2.net. The S-CSCF#2 has preconfigured information not to create a Record-Route entry for this request.\n7.\tSUBSCRIBE request (S-CSCF to PS) - see example in table A.3.4.1-7\nThe S-CSCF#2 forwards the SUBSCRIBE request to the PS.\nTable A.3.4.1-7 SUBSCRIBE request (S-CSCF to PS)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK344a65.1, SIP/2.0/UDP icscf2_s.home2.net;branch=z9hG4bKj5hgrt2o, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bKehuehjgt, SIP/2.0/UDP rls.home1.net;branch=z9hG4bKehuefdam\nMax-Forwards: 67\nP-Asserted-Identity:\nP-Charging-Vector:\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:ps.home2.net;lr>, <sip:scscf2.home2.net;lr>\nRecord-Route: <sip:orig@scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nAccept:\nContact:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe S-CSCF populates the P-Charging-Function-Addresses header field to be passed to the PS.\n8.\tAuthorization of watcher\nThe PS performs the necessary authorization checks on the originator to ensure it is allowed to watch the presentity. In this example all privacy conditions are met, so the PS sends a 200 (OK) response to the S-CSCF.\nIn the case where the privacy/authorization checks fails, then a necessary 2xx or 4xx response will be sent to the S-CSCF. The selection of the correct response code depends on the presentity's subscription authorization policy document.\n9.\t200 (OK) response (PS to S-CSCF) - see example in table A.3.4.1-9\nThe PS sends the response to S-CSCF#2.\nTable A.3.4.1-9: 200 (OK) response (PS to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK344a65.1, SIP/2.0/UDP icscf2_s.home2.net;branch=z9hG4bKj5hgrt2o, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bKehuehjgt, SIP/2.0/UDP rls.home1.net;branch=z9hG4bKehuefdam\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"; orig-ioi=home2.net:term-ioi=home2.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRecord-Route:\nFrom:\nTo: <sip:user2_public1@home2.net>;tag=151170\nCall-ID:\nCSeq:\nExpires:\nContact: <sip:ps.home2.net;lr>\nContent-Length: 0\n\nP-Charging-Vector:\tThe PS stores the originating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe PS stores the P-Charging-Function-Addresses header field and passes this header to the S-CSCF.\n10.\t200 (OK) response (S-CSCF to I-CSCF) - see example in table A.3.4.1-10\nS-CSCF#2 forwards the response to the I-CSCF.\nTable A.3.4.1-10: 200 (OK) response (S-CSCF to I-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP icscf2_s.home2.net;branch=z9hG4bKj5hgrt2o, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bKehuehjgt, SIP/2.0/UDP rls.home1.net;branch=z9hG4bKehuefdam\nP-Charging-Vector:\nP-Charging-Function-Addresses:\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the terminating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the I-CSCF.\n11.\t200 (OK) response (I-CSCF to S-CSCF) - see example in table A.3.4.1-11\nThe I-CSCF forwards the response to S-CSCF#1.\nTable A.3.4.1-11: 200 (OK) response (I-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bKehuehjgt, SIP/2.0/UDP rls.home1.net;branch=z9hG4bKehuefdam\nP-Charging-Vector:\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\n12.\t200 (OK) response (S-CSCF to RLS) - see example in table A.3.4.1-12\nS-CSCF#1 forwards the response to the RLS.\nTable A.3.4.1-12: 200 (OK) response (S-CSCF to RLS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP rls.home1.net;branch=z9hG4bKehuefdam\nP-Charging-Vector:\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the terminating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the RLS.\n13.\tNOTIFY request (PS to S-CSCF) - see example in table A.3.4.1-13\nAs soon as the PS sends a 200 (OK) response to accept the subscription, it sends a NOTIFY request with the current state of the presentity's presence information that the watcher has subscribed and been authorized to. The NOTIFY request is sent to S-CSCF#1.\nTable A.3.4.1-13: NOTIFY request (PS to S-CSCF)\nNOTIFY sip:rls.home1.net SIP/2.0\nVia: SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nMax-Forwards: 70\nRoute: <sip:scscf1.home1.net;lr>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=423551024\"; orig-ioi=home2.net\nFrom: <sip:user1_public1@home2.net>;tag=151170\nTo: <sip:rls.home1.net>;tag=31415\nCall-ID: q987a9a87g087abgf7qyg7ag\nCSeq: 42 NOTIFY\nSubscription-State:active;expires=7200\nEvent: presence\nContact: <sip:ps.home2.net>\nContent-Type: application/pidf+xml\nContent-Length: (...)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<presence xmlns=\"urn:ietf:params:xml:ns:pidf\"\nxmlns:rpid=\"urn:ietf:params:xml:ns:pidf:rpid\"\n\nxmlns:dm=\"urn:ietf:params:xml:ns:pidf:data-model\"\nxmlns:pcp=\"urn:ietf:params:xml:ns:pidf:caps\"\nxmlns:c=\"urn:ietf:params:xml:ns:pidf:cipid\"\nentity=\"pres:user2_public1@home2.net \">\n\n<tuple id=\"a8098a.672364762364\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:class>sip</rpid:class>\n<rpid:privacy><text/></rpid:privacy>\n<rpid:status-icon>http://example.com/~user2/icon.gif</rpid:status-icon>\n<pcp:servcaps>\n<pcp:video>false</pcp:video>\n<pcp:audio>true</pcp:audio>\n</pcp:servcaps>\n<contact priority=\"0.8\">im:user2_public1@home2.net</contact>\n<note xml:lang=\"en\">Don't Disturb Please!</note>\n<note xml:lang=\"fr\">Ne derangez pas, s'il vous plait</note>\n<timestamp>2003-08-27T11:49:29Z</timestamp>\n</tuple>\n\n<tuple id=\"jklhgf9788934774.78\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:class>assistant</rpid:class>\n<rpid:relationship><rpid:assistant/></rpid:relationship>\n<contact priority=\"1.0\">tel:+1-212-555-2222</contact>\n<note xml:lang=\"en\">She's my secretary</note>\n<timestamp>2003-08-27T11:49:29Z</timestamp>\n</tuple>\n\n<dm:person>\n<rpid:class>presentity</rpid:class>\n<c:homepage>http://example.com/~user2</c:homepage>\n<c:card>http://example.com/~user2/card.vcd</c:card>\n<rpid:activities><rpid:meeting/></rpid:activities>\n<rpid:place-type until=\"2003-08-27T17:30:00Z\"><rpid:office/></rpid:place-type>\n</dm:person>\n\n</presence>\n\nP-Charging-Vector:\tThe PS populates the icid parameter with a globally unique value and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nContent-Type:\tSet to the value of the Accept header received in the SUBSCRIBE request or \"application/pidf+xml\".\nThe message body in the NOTIFY request that carries the presentity's presence state is formed as indicated in RFC 3863 [21], RFC 4479 [44], RFC 4480 [26], RFC 4482 [32] and RFC 5196 [25].\n14.\tNOTIFY request (S-CSCF to RLS) - see example in table A.3.4.1-14\nThe S-CSCF#1 forwards the NOTIFY request to the RLS.\nTable A.3.4.1-14: NOTIFY request (S-CSCF to RLS)\nNOTIFY sip:rls.home1.net SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bKehuehjgt, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nMax-Forwards: 69\nP-Charging-Vector:\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe S-CSCF populates the P-Charging-Function-Addresses header field to be passed to the RLS.\n15.\t200 (OK) response (RLS to S-CSCF) – see example in table A.3.4.1-15\nThe RLS generates a 200 (OK) response to the NOTIFY request.\nTable A.3.4.1-15: 200 (OK) response (RLS to S-CSCF)\nSIP/2.0 200 OK\nVia:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=423551024\"; orig-ioi=home1.net:term-ioi=home1.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\nP-Charging-Vector:\tThe RLS stores the originating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\n16.\t200 (OK) response (S-CSCF to PS) – see example in table A.3.4.1-16\nThe S-CSCF#1 forwards the 200 (OK) response to the PS.\nTable A.3.4.1-16: 200 (OK) response (S-CSCF to PS)\nSIP/2.0 200 OK\nP-Charging-Vector:\nVia: SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\nP-Charging-Vector:\tThe S-CSCF stores the terminating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\n",
                            "figures_meta_data": [],
                            "tables": [
                                {
                                    "description": "Table A.3.4.1-4a: Cx: User location query procedure (I-CSCF to HSS)",
                                    "table number": 5,
                                    "summary": "",
                                    "name": ""
                                },
                                {
                                    "description": "Table A.3.4.1-4b: Cx: User location query procedure (HSS to I-CSCF)",
                                    "table number": 6,
                                    "summary": "",
                                    "name": ""
                                }
                            ]
                        }
                    ]
                },
                {
                    "title": "A.3.5\tNetwork based watcher subscribing on behalf of IMS watcher to IMS presentities",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure A.3.5-1 illustrates a network-based watcher subscribing on behalf of an IMS watcher for presence information of IMS presentities. The figure depicts the interaction between different entities in an IMS (IP Multimedia Subsystem) network, highlighting the role of the network watcher in monitoring and relaying presence information to the IMS watcher. Key components include the network watcher, IMS watcher, and IMS presentities, which work together to ensure seamless communication and presence management within the network.\nFigure A.3.5-1: Network based watcher subscribing on behalf of IMS watcher\nfor presence information of IMS presentities\nFigure A.3.5-1 shows a trusted network based watcher subscribing on behalf of an IMS watcher to presence event notification about an IMS based presentity. The presentity is in a different IM CN subsystem than the network based watcher and the signalling flow assumes that the IMS watcher on whose behalf the network based watcher subscribes is registered to the IMS network. The details of the signalling flows are as follows:\n1.\tSh: User Location Query procedure\nThe network based watcher sends a query to the HSS to find out the S-CSCF of the user on whose behalf the subscription is initiated. The HSS responds with the address of the current S-CSCF for the originating subscriber.\n2.\tSUBSCRIBE request (Network based watcher to S-CSCF) - see example in table A.3.5-2\nThe SUBSCRIBE request is constructed and forwarded to S-CSCF. The S-CSCF is inserted into the Route header of the SUBSCRIBE request.\nTable A.3.5-2: SUBSCRIBE request (network watcher to S-CSCF)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP watcher.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nMax-Forwards: 69\nP-Asserted-Identity: <sip:user1_public1@home1.net>\nPrivacy: none\nRoute: <sip:scscf1.home1.net;lr;orig>\nFrom: <sip:user1_public1@home1.net>;tag=31415\nTo: <sip:user2_public1@home2.net>\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 61 SUBSCRIBE\nEvent:PRESENCE\nExpires: 7200\nAccept: application/pidf+xml;q=0.3, application/pidf-diff+xml;q=1\nContact: <sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp>\nContent-Length: 0\n\nRequest-URI:\tPublic user identity of the user to whose events the subscriber subscribes to.\nP-Asserted-Identity:\tThe network based watcher inserts the public user identity of the watcher on whose behalf the subscription is made into the P-Asserted-Identity header field.\nRoute:\tThe Route header is populated with the address of the S-CSCF obtained from the response to the user location query performed by the network based watcher on the Sh interface.\nEvent:\tThis field is populated with the value \"presence\" to specify the use of the presence package.\nContact:\tThe contact information of the network based watcher.\n3.\tEvaluation of initial filter criteria\nS-CSCF#1 validates the service profile of the subscriber identified in the P-Asserted-Identity header field and evaluates the initial filter criteria.  In this example, no AS is assumed to be involved.\n4.\tSUBSCRIBE request (S-CSCF to I-CSCF) - see example in table A.3.5-4\nS-CSCF#1 performs an analysis of the destination address, and determines the network operator to whom the destination subscriber belongs. Since the originating operator does not desire to keep their internal configuration hidden, S-CSCF#1 forwards the SUBSCRIBE request directly to the I-CSCF in the destination network.\nTable A.3.5-4: SUBSCRIBE (S-CSCF to I-CSCF)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP network.home1.net;branch=z9hG4bK240f34.1,\nMax-Forwards: 68\nP-Asserted-Identity: <sip:user1_public1@home1.net>\nPrivacy:\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nAccept:\nContact:\nContent-Length:\n\n5.\tCx: User Location Query procedure\nThe I-CSCF sends a query to the HSS to find out the S-CSCF of the called user. The HSS responds with the address of the current S-CSCF for the terminating subscriber.\nFor detailed message flows see 3GPP TS 29.228 [10].\nTable A.3.5-5a provides the parameters in the SIP SUBSCRIBE request (flow 4), which are sent to the HSS.\nTable A.3.5-5a: Cx: User registration location procedure (I-CSCF to HSS)\n\nTable A.3.5-5b provides the parameters sent from the HSS that need to be mapped to the SIP SUBSCRIBE request (flow 6) and sent to the S-CSCF.\nTable A.3.5-5b: Cx: User location query procedure (HSS to I-CSCF)\n\n6.\tSUBSCRIBE request (I-CSCF to S-CSCF) - see example in table A.3.5-6\nThe I-CSCF forwards the SUBSCRIBE request to the S-CSCF (S-CSCF#2) that will handle the termination.\nTable A.3.5-6: SUBSCRIBE request (I-CSCF to S-CSCF)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP icscf2_s.home2.net;branch=z9hG4bK871y12.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP network.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 67\nP-Asserted-Identity:\nPrivacy:\nRoute: <sip:scscf2.home2.net;lr>\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nAccept:\nContact:\nContent-Length:\n\nNOTE:\tThe I-CSCF does not add itself to the Record-Route header, as it has no need to remain in the signalling path for the subsequent requests.\n7.\tEvaluation of initial filter criteria\nS-CSCF#2 validates the service profile of this subscriber and evaluates the initial filter criteria. For sip:user2_public1@home2.net S-CSCF#2 has termination initial filter criteria with Service Point Trigger of Method = SUBSCRIBE and Event = \"presence\" that informs the S-CSCF to route the SUBSCRIBE request to the AS ps.home2.net. The S-CSCF#2 has preconfigured information not to create a Record-Route header for this request.\n8.\tSUBSCRIBE request (S-CSCF to PS) - see example in table A.3.5-8\nThe S-CSCF forwards the SUBSCRIBE request to the PS.\nTable A.3.5-8: SUBSCRIBE request (S-CSCF to PS)\nSUBSCRIBE sip:user2_public1@home2.net SIP/2.0\nVia: SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK764z87.1, SIP/2.0/UDP icscf2_s.home2.net;branch=z9hG4bK871y12.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP network.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 66\nP-Asserted-Identity:\nPrivacy:\nRoute: <sip:ps.home2.net;lr>, <sip:scscf2.home2.net;lr>\nRecord-Route: <sip: scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nAccept:\nContact:\nContent-Length:\n\n9.\tAuthorization of watcher\nThe PS performs the necessary authorization checks on the watcher whose behalf the subscription is being made to ensure it is allowed to watch the presentity. In this example all privacy conditions are met, so the PS sends a 200 (OK) response to the S-CSCF.\nIn the case where the privacy/authorization checks fails, then a necessary 2xx or 4xx response will be sent to the S-CSCF. The selection of the correct response code depends on the presentity's authorization policy document.\n10.\t200 (OK) response (PS to S-CSCF) - see example in table A.3.5-10\nThe PS sends the response to S-CSCF#2.\nTable A.3.5-10: 200 (OK) response (PS to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK764z87.1, SIP/2.0/UDP\nicscf2_s.home2.net;branch=z9hG4bK871y12.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP network.home1.net;branch=z9hG4bK240f34.1\nRecord-Route:\nFrom:\nTo: <sip:user2_public1@home2.net>;tag=151170\nCall-ID:\nCSeq:\nExpires:\nContact: <sip:ps.home2.net>\nContent-Length:\n\n11.\t200 (OK) response (S-CSCF to I-CSCF) - see example in table A.3.5-11\nS-CSCF#2 forwards the response to I-CSCF#2.\nTable A.3.5-11: 200 (OK) response (S-CSCF to I-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP icscf2_s.home2.net;branch=z9hG4bK871y12.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP network.home1.net;branch=z9hG4bK240f34.1\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\n12.\t200 (OK) response (I-CSCF to S-CSCF) - see example in table A.3.5-12\nI-CSCF#2 forwards the response to S-CSCF#1.\nTable A.3.5-12: 200 (OK) response (I-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP network.home1.net;branch=z9hG4bK240f34.1\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\n13.\t200 (OK) response (S-CSCF to network watcher) - see example in table A.3.5-13\nS-CSCF#1 forwards the response to request originator.\nTable A.3.5-13: 200 (OK) response (S-CSCF to network watcher)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP network.home1.net;branch=z9hG4bK240f34.1\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\n14.\tNOTIFY request (PS to S-CSCF) - see example in table A.3.5-14\nAs soon as the PS sends a 200 (OK) response to accept the subscription, it sends a NOTIFY request with the current state of the presentity's presence information that the watcher has subscribed and been authorized to. The NOTIFY request is sent to S-CSCF#1. Based on the Accept header field of the SUBSCRIBE request, the PS decides to use partial notifications to provide further changes of presence information. The first notification always contains the full state. The 'application/pidf-diff +xml' content type is used.\nTable A.3.5-14: NOTIFY request (PS to S-CSCF)\nNOTIFY sip: network.home1.net;branch=z9hG4bK240f34.1 SIP/2.0\nVia: SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nMax-Forwards: 70\nRoute: <sip:scscf1.home1.net;lr>\nFrom: <sip:user2_public1@home2.net>;tag=151170\nTo: <sip:user1_public1@home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 42 NOTIFY\nSubscription-State: active; expires=7200\nEvent: presence\nContact: <sip:ps.home2.net>\nContent-Type: application/pidf-diff +xml\nContent-Length: (...)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n< diff:pidf-full xmlns=\"urn:ietf:params:xml:ns:pidf\"\nxmlns:rpid=\"urn:ietf:params:xml:ns:pidf:rpid\"\nxmlns:diff=\"urn:ietf:params:xml:ns:pidf:pidf-diff\"\nxmlns:dm=\"urn:ietf:params:xml:ns:pidf:data-model\"\nxmlns:pcp=\"urn:ietf:params:xml:ns:pidf:caps\"\nxmlns:c=\"urn:ietf:params:xml:ns:pidf:cipid\"\nentity=\"pres:user2_public1@home2.net\"version=\"1\">\n\n<tuple id=\"a8098a.672364762364\">\n<status>\n<basic>open</basic>\n<rpid:privacy><text/></rpid:privacy>\n<rpid:status-icon>http://example.com/~user2/icon.gif</rpid:status-icon>\n</status>\n<rpid:class>sip</rpid:class>\n<pcp:servcaps>\n<pcp:video>false</pcp:video>\n<pcp:audio>true</pcp:audio>\n</pcp:servcaps>\n<contact priority=\"0.8\">sip:user2_public1@home2.net</contact>\n<note xml:lang=\"en\">Don't Disturb Please!</note>\n<note xml:lang=\"fr\">Ne derangez pas, s'il vous plait</note>\n<timestamp>2003-08-27T11:49:29Z</timestamp>\n</tuple>\n\n<tuple id=\"jklhgf9788934774.78\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:class>assistant</rpid:class>\n<rpid:relationship><rpid:assistant/></rpid:relationship>\n<contact priority=\"1.0\">tel:+1-212-555-2222</contact>\n<note xml:lang=\"en\">She's my secretary</note>\n<timestamp>2003-08-27T11:49:29Z</timestamp>\n</tuple>\n\n<dm:person>\n<rpid:class>presentity</rpid:class>\n<c:homepage>http://example.com/~user2</c:homepage>\n<c:card>http://example.com/~user2/card.vcd</c:card>\n<rpid:activities><rpid:meeting/></rpid:activities>\n<rpid:place-type until=\"2003-08-27T17:30:00Z\"><rpid:office/></rpid:place-type>\n</dm:person>\n\n</diff:pidf-full>\n\nFrom:\tThe tag of this field matches that of the To field in the received 200 (OK) response for the SUBSCRIBE request.\nContent-Type:\tSet to the preferred value of the Accept header received in the SUBSCRIBE request.\nThe message body in the NOTIFY request that carries the presence information of the presentity is formed as indicated in RFC 3863 [21], RFC 4480 [26], RFC 4482 [32], RFC 5196 [25], RFC 4479 [44] and RFC 5263 [24].\n15.\tNOTIFY request (S-CSCF to network watcher) - see example in table A.3.5-15\nThe S-CSCF#1 forwards the NOTIFY request to the network watcher\nTable A.3.5-15: NOTIFY request (S-CSCF to network watcher)\nNOTIFY sip: network.home1.net;branch=z9hG4bK240f34.1SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nMax-Forwards: 69\nPrivacy:\nRecord-Route: <sip:scscf1.home1.net;lr>\n\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\n16.\t200 (OK) response (network watcher to S-CSCF) – see example in table A.3.5-16\nThe network watcher forwards the 200 (OK) response to S-CSCF#1.\nTable A.3.5-16: 200 (OK) response (network watcher to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nP-Access-Network-Info:\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n17.\t200 (OK) response (S-CSCF to PS) – see example in table A.3.5-17\nS-CSCF#2 forwards the 200 (OK) response to the PS.\nTable A.3.5-17: 200 (OK) response (S-CSCF to PS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n",
                    "tables": [
                        {
                            "description": "Table A.3.5-5a: Cx: User registration location procedure (I-CSCF to HSS)",
                            "table number": 7,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "Table A.3.5-5b: Cx: User location query procedure (HSS to I-CSCF)",
                            "table number": 8,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.3.6\tWatcher subscribing to state changes in XML document, UE in visited network",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "A.3.6.1\tWatcher subscribing to changes made via XCAP in his resource list, UE in visited network - Successful subscription",
                            "text_content": "Figure A.3.6.1-1 illustrates a watcher subscribing to changes made via XCAP in his resource list. The figure depicts a network architecture where a watcher is actively monitoring and receiving updates from a central authority regarding changes in the resource list. This process is crucial for maintaining the integrity and synchronization of resources across the network. The watcher's role is to ensure that the information it receives is up-to-date and accurate, enabling efficient resource management and coordination within the network. The figure highlights the importance of real-time communication and synchronization in maintaining the functionality and performance of the network.\nFigure A.3.6.1-1: Watcher subscribing to changes made via XCAP in his resource list\nFigure A.3.6.1-1 shows a watcher subscribing to notifications of state changes made via XCAP in his resource list. The details of the flows as follows:\n1.\tSUBSCRIBE request (UE to P-CSCF) – see example in table A.3.6.1-1\nA watcher agent in a UE wishes to get notification when his resource list gets modified via XCAP. In order to initiate a subscription to XCAP document changes in RLS, the UE generates a SUBSCRIBE request indicating support for \"xcap-diff\", together with an indication of the length of time this periodic subscription should last.\nTable A.3.6.1-1: SUBSCRIBE request (UE to P-CSCF)\nSUBSCRIBE sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nMax-Forwards: 70\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nRoute: <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>, <sip:orig@scscf1.home1.net;lr>\nP-Preferred-Identity: <sip:user1_public1@home1.net>\nPrivacy: none\nFrom: <sip:user1_public1@home1.net>;tag=31415\nTo: <sip:user1_public1@home1.net>\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 123 SUBSCRIBE\nRequire: sec-agree\nProxy-Require: sec-agree\nSecurity-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432; spi-s=87654321; port-c=8642; port-s=7531\nEvent: xcap-diff;diff-processing=aggregate\nExpires: 7200\nAccept: application/xcap-diff+xml\nContact: <sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp>\nContent-Type: application/resource-lists+xml\nContent-Length: (…)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<resource-lists xmlns=\"urn:ietf:params:xml:ns:resource-lists\">\n<list>\n<entry uri=\"resource-lists/users/sip:user1_public1@home1.net/index\"/>\n</list>\n</resource-lists>\n\n\nRequest-URI:\tThe users own SIP URI to get notifications of changes on all lists owned by the user.\nEvent:\tThis field is populated with the value \"xcap-diff\" to specify the use of the xcap-diff package to get notified of changes to XCAP documents.\nAccept:\tThis field is populated with the value \"application/xcap-diff+xml\" indicating that the UE supports the MIME type.\nTo:\tSame as the Request-URI.\n2.\tSUBSCRIBE request (P-CSCF to S-CSCF) - see example in table A.3.6.1-2\nThe P-CSCF looks up the serving network information for the public user identity that was stored during the registration procedure. The SUBSCRIBE request is forwarded to S-CSCF#1. A Route header is inserted into SUBSCRIBE request. The information for the Route header is taken from the service route determined during registration.\nTable A.3.6.1-2: SUBSCRIBE request (P-CSCF to S-CSCF)\nSUBSCRIBE sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Access-Network-Info:\nRoute: <sip:orig@scscf1.home1.net;lr>\nMax-Forwards: 69\nP-Asserted-Identity: <sip:user1_public1@home1.net>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"\nPrivacy:\nRecord-Route: <sip:pcscf1.visited1.net;lr>\nRoute: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nSupported:\nExpires:\nAccept:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\n\n3.\tEvaluation of initial filter criteria\nThe S-CSCF validates the service profile of this subscriber and evaluates the initial filter criteria. For sip:user1_public1@home1.net the S-CSCF has originating initial Filter Criteria with Service Point Trigger of Method = SUBSCRIBE AND Event = \"xcap-diff\" that informs the S-CSCF to route the SUBSCRIBE request to the AS sip:rls.home1.net.\n4.\tSUBSCRIBE request (S-CSCF to RLS) - see example in table A.3.6.1-4\nThe S-CSCF forwards the SUBSCRIBE request to the RLS.\nTable A.3.6.1-4 SUBSCRIBE request (S-CSCF to RLS)\nSUBSCRIBE sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK344a65.1, SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nMax-Forwards: 68\nP-Access-Network-Info:\nP-Asserted-Identity: <sip:user1_public1@home1.net>, <tel:+1-212-555-1111>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nPrivacy:\nRecord-Route: <sip:orig@scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nRoute: <sip:rls.home1.net;lr>, <sip:orig@scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nSupported:\nExpires:\nAccept:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\n\nP-Charging-Vector:\tThe S-CSCF populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe S-CSCF populates the P-Charging-Function-Addresses header field to be passed to the RLS.\n5.\tAuthorization\nThe RLS performs the necessary authorization checks on the originator to ensure that he/she is authorized to subscribe to XML document changes. In this example this condition has been met, so the RLS sends a 200 (OK) response to the S-CSCF.\n6.\t200 (OK) response (RLS to S-CSCF) - see example in table A.3.6.1-6\nThe RLS sends the response to the S-CSCF.\nTable A.3.6.1-6: 200 (OK) response (RLS to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK344a65.1, SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"; orig-ioi=home1.net; term-ioi=home1.net\nRecord-Route:\nFrom:\nTo: <sip:user1_public1@home1.net>;tag=151170\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length: 0\n\n7.\t200 (OK) response (S-CSCF to P-CSCF) - see example in table A.3.6.1-7\nThe S-CSCF forwards the response to the P-CSCF.\nTable A.3.6.1-7: 200 (OK) response (S-CSCF to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\n8.\t200 (OK) response (P-CSCF to UE) - see example in table A.3.6.1-8\nThe P-CSCF forwards the response to the watcher agent in the UE.\nTable A.3.6.1-8: 200 (OK) response (P-CSCF to UE)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nRecord-Route: <sip:orig@scscf1.home1.net;lr>, <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\n9.\tNOTIFY request (RLS to S-CSCF) – see example in table A.3.6.1-9\nThe RLS generates a NOTIFY request including the xcap-diff document as a result of the SUBSCRIBE request. As this is the initial NOTIFY it contains only the new-etag, previous-etag and document-selector elements.\nTable A.3.6.1-9 NOTIFY request (RLS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom: <sip:user1_@home1.net>;tag=151170\nTo: <sip:user1_public1@home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 89 NOTIFY\nSubscription-State: active;expires=7200\nEvent: xcap-diff\nContact: <sip:rls.home1.net>\nContent-Type: application/xcap-diff+xml;charset=\"UTF-8\"\nContent-Length:\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<xcap-diff xmlns=\"urn:ietf:params:xml:ns:xcap-diff\"\n\nxcap-root=\"http://xcap.home1.net/services\">\n\n<document doc-selector=\"resource-lists/users/user1/friends\"\nnew-etag=\"7hahsd\"/>\n</document>\n<document doc-selector=\"resource-lists/users/user1/coworkers\"\nnew-etag=\"ffds66a\">\n</document>\n\n</xcap-diff>\n\nThe content of the document element contains a new-etag and a previous etag element with identical value and no list of instructions. This way it is indicated that this is the reference XML diff document. This documents has only the information about the etags and the document URI's covered by that subscription.\n10.\tNOTIFY request (S-CSCF to P-CSCF) - see example in table A.3.6.1-10\nThe S-CSCF forwards the NOTIFY request to the P-CSCF.\nTable A.3.6.1-10: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 69\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"\nP-Charging-Function-Addresses:\nRoute: <sip:pcscf1.visited1.net;lr>\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Length:\n\n(…)\n\n\n11.\tNOTIFY request (P-CSCF to UE) - see example in table A.3.6.1-11\nThe P-CSCF forwards the NOTIFY request to the watcher in the UE.\nTable A.3.6.1-11: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 68\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Length:\n\n(…)\n\n\n12.\t200 (OK) response (UE to P-CSCF) - see example in table A.3.6.1-12\nThe UE acknowledges the NOTIFY request with a 200 (OK) response to the P-CSCF.\nTable A.3.6.1-12: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n13.\t200 (OK) response (P-CSCF to S-CSCF) – see example in table A.3.6.1-13\nThe P-CSCF forwards the 200 (OK) response to the S-CSCF.\nTable A.3.6.1-13: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n14.\t200 (OK) response (S-CSCF to RLS) - see example in table A.3.6.1-14\nThe S-CSCF#2 forwards the response to the RLS in the home network of the UE.\nTable A.3.6.1-14: 200 (OK) response (S-CSCF to RLS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"; orig-ioi=home1.net; term-ioi=home1.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n15.\tUser retrieves current resource list via XCAP get\nAs user1 does not have a local copy of the resource list identified by the etag he retrieves the corresponding list via XCAP get.\n16.\tResource List gets modified via XCAP\nThe resource list of user1 gets modified via XCAP procedures.\n17.\tNOTIFY request (RLS to S-CSCF) - see example in table A.3.6.1-17\nIn this example it is assumed that the RLS has received a XCAP request to delete user2_public@home1.net from the resource list of user1.\nTable A.3.6.1-17 NOTIFY request (RLS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=423551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom: <sip:user1_public1@home1.net>;tag=151170\nTo: <sip:user1_public1.home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 90 NOTIFY\nSubscription-State: active;expires=5000\nEvent: xcap-diff\nContact: <sip:rls.home1.net>\nContent-Type: application/xcap-diff+xml;charset=\"UTF-8\"\nContent-Length: (...)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<xcap-diff xmlns=\"urn:ietf:params:xml:ns:xcap-diff\"\nxcap-root=\"http://xcap.home1.net/services\">\n\n<document doc-selector=\"resource-lists/users/user1/coworkers\"\nnew-etag=\"aaaab\" previous-etag=\"ffds66a\">\n<change-log>\n<put-eventnode-selector=\"resource-lists/list[@name=&quot;coworkers&quot;]\" content-type=\"application/el+xml\">\n<![CDATA[<entry uri=\"sip:new-worker@example.com\"/>]]>\n</put-event>\n</change-log>\n</document>\n</xcap-diff>\n\nContent-Type:\tSet to application/xcap-diff+xml.\nThe message body in the NOTIFY request contains information of the new-etag of the changed document, the change method and the element that was changed in accordance with RFC 5874 [39].\n18.\tNOTIFY request (S-CSCF to P-CSCF) - see example in table A.3.6.1-18\nThe S-CSCF forwards the NOTIFY request to the P-CSCF.\nTable A.3.6.1-18: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 69\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=423551024\"\nP-Charging-Function-Addresses:\nRoute: <sip:pcscf1.visited1.net;lr>\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent Type:\nContent-Length:\n\n(…)\n\n19.\tNOTIFY request (P-CSCF to UE) – see example in table A.3.6.1-19\nThe P-CSCF forwards the NOTIFY request to the watcher in the UE.\nTable A.3.6.1-19: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 68\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nRequire:\nContent-Type:\nContent-Length:\n\n(…)\n\n20.\t200 (OK) response (UE to P-CSCF) – see example in table A.3.6.1-20\nThe UE acknowledges the NOTIFY request with a 200 (OK) response to the P-CSCF.\nTable A.3.6.1-20: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n21.\t200 (OK) response (P-CSCF to S-CSCF) – see example in table A.3.6.1-21\nThe P-CSCF forwards the 200 (OK) response to the S-CSCF.\nTable A.3.6.1-21: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=423551024\"\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n22.\t200 (OK) response (S-CSCF to RLS) – see example in table A.3.6.1-22\nThe S-CSCF#2 forwards the response to the RLS in the home network of the UE.\nTable A.3.6.1-22: 200 (OK) response (S-CSCF to RLS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=423551024\"; orig-ioi=home1.net; term-ioi=home1.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "A.4\tSignalling flows demonstrating how presentities update presence information",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.4.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "This subclause covers the signalling flows that show how presentities update presence information in the PS.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.4.2\tInitial publication or modification of presence information by UE",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "A.4.2.1\tSuccessful publication",
                            "text_content": "Figure A.4.2.1-1 illustrates the process of a User Equipment (UE) publishing its presence information to a network. The figure depicts the UE as the central node, with various other entities such as the Home Location Register (HLR), Visitor Location Register (VLR), and Serving GPRS Support Node (SGSN) connected to it. The UE sends its presence information through the SGSN, which then relays it to the HLR and VLR. This process ensures that the network is aware of the UE's location and status, allowing for efficient communication and resource allocation.\nFigure A.4.2.1-1: UE publishing presence information\nThe UE may publish the partial presence information or the full presence information about a presentity to the PS.\nIn this example, it is assumed that the UE publishes the full presence information.\nFigure A.4.2.1-1 shows a UE publishing or modifying already existing presence information about a presentity. The details of the signalling flows as follows:\n1.\tPUBLISH request (UE to P-CSCF) - see example in table A.4.2.1-1\nA PUA in a UE wishes to publish presence information. To initiate the publication, the UE generates a PUBLISH request according to RFC 3903 [23] containing the presence information that it wishes to publish.\nTable A.4.2.1-1: PUBLISH request (UE to P-CSCF)\nPUBLISH sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nMax-Forwards: 70\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nRoute: <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>, <sip:orig@scscf1.home1.net;lr>\nP-Preferred-Identity: <sip:user1_public1@home1.net>\nPrivacy: none\nFrom: <sip:user1_public1@home1.net>;tag=31415\nTo: <sip:user1_public1@home1.net>\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 61 PUBLISH\nRequire: sec-agree\nProxy-Require: sec-agree\nSecurity-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432; spi-s=87654321; port-c=8642; port-s=7531\nEvent: presence\nExpires: 7200\nContent-Type: application/pidf+xml\nContent-Length: (...)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<presence xmlns=\"urn:ietf:params:xml:ns:pidf\"\nxmlns:rpid=\"urn:ietf:params:xml:ns:pidf:rpid\"\nxmlns:dm=\"urn:ietf:params:xml:ns:pidf:data-model\"\nxmlns:pcp=\"urn:ietf:params:xml:ns:pidf:caps\"\nxmlns:c=\"urn:ietf:params:xml:ns:pidf:cipid\"\nentity=\"pres:user2_public1@home2.net\">\n\n<tuple id=\"a8098a.672364762364\">\n<status>\n<basic>open</basic>\n\n</status>\n<rpid:class>sip</rpid:class>\n<rpid:privacy><text/></rpid:privacy>\n<rpid:status-icon>http://example.com/~user2/icon.gif</rpid:status-icon>\n<pcp:servcaps>\n<pcp:video>false</pcp:video>\n<pcp:audio>true</pcp:audio>\n</pcp:servcaps>\n<contact priority=\"0.8\">sip:user2_public1@home2.net</contact>\n<note xml:lang=\"en\">Don't Disturb Please!</note>\n<note xml:lang=\"fr\">Ne derangez pas, s'il vous plait</note>\n<timestamp>2003-08-27T11:49:29Z</timestamp>\n</tuple>\n\n<tuple id=\"jklhgf9788934774.78\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:class>assistant</rpid:class>\n<rpid:relationship><rpid:assistant/></rpid:relationship>\n<contact priority=\"1.0\">tel:+1-212-555-2222</contact>\n<note xml:lang=\"en\">She's my secretary</note>\n<timestamp>2003-08-27T11:49:29Z</timestamp>\n</tuple>\n\n<dm:person>\n<rpid:class>presentity</rpid:class>\n<c:homepage>http://example.com/~user2</c:homepage>\n<c:card>http://example.com/~user2/card.vcd</c:card>\n<rpid:place-type until=\"2003-08-27T17:30:00Z\"><rpid:office/></rpid:place-type>\n</dm:person>\n\n</presence>\n\nRequest-URI:\tPublic user identity whose presence information the PUA intends to publish.\nEvent:\tThis field is populated with the value \"presence\" to specify the use of the presence package.\nTo:\tSame as the Request-URI.\nContent-Type:\tSet to the value \"application/pidf+xml\".\nThe message body in the PUBLISH request that carries the presence update state is formed as indicated in RFC 3863 [21], RFC 4480 [26], RFC 5196 [25], RFC 4482 [32], RFC 5263  [24] and RFC 4479 [44].\n2.\tPUBLISH request (P-CSCF to S-CSCF) - see example in table A.4.2.1-2\nP-CSCF looks up the serving network information for the public user identity that was stored during the registration procedure. The PUBLISH request is forwarded to the S-CSCF. A Route header is inserted into PUBLISH request. The information for the Route header is taken from the service route determined during registration.\nTable A.4.2.1-2: PUBLISH request (P-CSCF to S-CSCF)\nPUBLISH sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Access-Network-Info:\nMax-Forwards: 69\nP-Asserted-Identity: <sip:user1_public1@home1.net>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"\nPrivacy:\nRoute: <sip:orig@scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nContent-Type:\nContent-Length:\n\n(…)\n\n3.\tEvaluation of initial filter criteria\nS-CSCF validates the service profile of the publisher and evaluates the initial filter criteria. For user1_public1@home1.net S-CSCF#1 has originating initial Filter Criteria with Service Point Trigger of Method = PUBLISH AND Event = \"presence\" AND Request-URI = \"sip:user1_public1@home1.net\" that informs the S-CSCF to route the PUBLISH request to the PS ps.home1.net.\n4.\tPUBLISH (S-CSCF to PS) - see example in table A.4.2.1-4\nThe S-CSCF#1 forwards the PUBLISH request to the PS.\nTable A.4.2.1-4: PUBLISH request (S-CSCF to PS)\nPUBLISH sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Access-Network-Info:\nMax-Forwards: 68\nP-Asserted-Identity:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nPrivacy:\nRoute: <sip:ps.home1.net;lr>, <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nContent-Type:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF populates the icid parameter with a globally unique value and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe S-CSCF populates the P-Charging-Function-Addresses header field to be passed to the PS.\n5.\tAuthorization of publisher\nThe PS performs the necessary authorization checks on the originator to ensure it is allowed to publish the presentity's presence information. In this example all privacy conditions are met, so the PS sends a 200 (OK) response to the S-CSCF.\n6.\t200 (OK) response (PS to S-CSCF) - see example in table A.4.2.1-6\nThe PS sends the response to S-CSCF.\nTable A.4.2.1-6: 200 (OK) response (PS to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"; orig-ioi=home1.net:term-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nFrom:\nTo: <sip:user1_public1@home1.net>;tag=151170\nCall-ID:\nCSeq:\nExpires: 7200\nSIP-ETag: 123xy\nContent-Length: 0\n\nP-Charging-Vector:\tThe PS stores the originating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe PS stores the P-Charging-Function-Addresses header field and passes this header to the S-CSCF.\nSIP-ETag:\tThis field is populated with a locally unique entity-tag to associate further publications of this event state.\n7.\t200 (OK) response (S-CSCF to P-CSCF) - see example in table A.4.2.1-7\nS-CSCF forwards the response to P-CSCF.\nTable A.4.2.1-7: 200 (OK) response (S-CSCF to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"\nP-Charging-Function-Addresses:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nSIP-ETag:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the terminating Inter Operator Identifier (IOI) parameter and removes the orig-ioi and the term-ioi parameters.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the P-CSCF.\n8.\t200 (OK) response (P-CSCF to UE) - see example in table A.4.2.1-6\nP-CSCF forwards the response to the PUA in the UE.\nTable A.4.2.1-8: 200 (OK) response (P-CSCF to UE)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nSIP-ETag:\nContent-Length:\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "A.4.3\tRefreshing of presence information by UE",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "A.4.3.1\tSuccessful refresh",
                            "text_content": "Figure A.4.3.1-1 illustrates the process of a user equipment (UE) updating its presence information. The figure depicts the interaction between the UE and the network server, showing the exchange of messages to synchronize the UE's status. Key components include the UE, network server, and signaling protocol. The diagram emphasizes the importance of real-time communication for seamless network management and service delivery.\nFigure A.4.3.1-1: UE updating presence information\nFigure A.4.3.1-1 shows an UE refreshing the presence information about a presentity. The details of the signalling flows are as follows:\n1.\tPUBLISH request (UE to P-CSCF) – see example in table A.4.3.1-1\nA PUA in a UE wishes to refresh already existing presence information. To initiate the publication, the UE generates a PUBLISH request according to RFC 3903 [23].\nTable A.4.3.1-1: PUBLISH request (UE to P-CSCF)\nPUBLISH sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nMax-Forwards: 70\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nRoute: <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>, <sip:orig@scscf1.home1.net;lr>\nP-Preferred-Identity: <sip:user1_public1@home1.net>\nPrivacy: none\nFrom: <sip:user1_public1@home1.net>;tag=31415\nTo: <sip:user1_public1@home1.net>\nCall-ID: b89rjhnedlrfjflslj40a111\nCSeq: 61 PUBLISH\nRequire: sec-agree\nProxy-Require: sec-agree\nSecurity-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432; spi-s=87654321; port-c=8642; port-s=7531\nEvent: presence\nSIP-If-Match: 123xy\nExpires: 7200\nContent-Length: 0\n\nRequest-URI:\tPublic user identity whose presence information the PUA intends to publish.\nEvent:\tThis field is populated with the value \"presence\" to specify the use of the presence package.\nTo:\tSame as the Request-URI.\nSIP-If-Match:\tThis field is populated with the entity-tag earlier provided by the PS in the SIP-ETag header field of the previous 200(OK) response and is used as a versioning precondition to the PUBLISH refresh.\n2.\tPUBLISH request (P-CSCF to S-CSCF) - see example in table A.4.3.1-2\nP-CSCF looks up the serving network information for the public user identity that was stored during the registration procedure. The PUBLISH request is forwarded to the S-CSCF. A Route header is inserted into PUBLISH request. The information for the Route header is taken from the service route determined during registration.\nTable A.4.3.1-2: PUBLISH request (P-CSCF to S-CSCF)\nPUBLISH sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Access-Network-Info:\nMax-Forwards: 69\nP-Asserted-Identity: <sip:user1_public1@home1.net>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"\nPrivacy:\nRoute: <sip:orig@scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nSIP-If-Match:\nExpires:\nContent-Length:\n\nP-Charging-Vector:\tThe P-CSCF populates the icid parameter with a globally unique value.\n3.\tEvaluation of initial filter criteria\nS-CSCF#1 validates the service profile of this publisher and evaluates the initial filter criteria. For user1_public1@home1.net the S-CSCF has originating initial Filter Criteria with Service Point Trigger of Method = PUBLISH AND Event = \"presence\" AND Request-URI = \"sip:user1_public1@home1.net\" that informs the S-CSCF to route the PUBLISH request to the PS ps.home1.net.\n4.\tPUBLISH (S-CSCF to PS) – see example in table A.4.3.1-4\nThe S-CSCF forwards the PUBLISH request to the PS.\nTable A.4.3.1-4: PUBLISH (S-CSCF to PS)\nPUBLISH sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Access-Network-Info:\nMax-Forwards: 68\nP-Asserted-Identity:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nPrivacy:\nRoute: <sip:ps.home1.net;lr>, <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nSIP-If-Match:\nExpires:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe S-CSCF populates the P-Charging-Function-Addresses header field to be passed to the PS.\n5.\tAuthorization of publisher\nThe PS performs the necessary authorization checks on the originator to ensure it is allowed to publish the presentity's presence information. In this example all privacy conditions are met, so the PS sends a 200 (OK) response to the S-CSCF.\n6.\t200 (OK) response (PS to S-CSCF) - see example in table A.4.3.1-6\nThe PS sends the response to S-CSCF.\nTable A.4.3.1-6: 200 (OK) response (PS to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023555517\"; orig-ioi=home1.net;term-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nFrom:\nTo: <sip:user1_public1@home1.net>;tag=151170\nCall-ID:\nCSeq:\nExpires: 7200\nSIP-ETag: 345abc\nContent-Length: 0\n\nP-Charging-Vector:\tThe PS stores the originating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe PS stores the P-Charging-Function-Addresses header field and passes this header to the S-CSCF.\nSIP-ETag:\tThis field is populated with a new locally unique entity-tag.\n7.\t200 (OK) response (S-CSCF to P-CSCF) - see example in table A.4.3.1-7\nS-CSCF#1 forwards the response to P-CSCF.\nTable A.4.3.1-7: 200 (OK) response (S-CSCF to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.home1.net;branch=z9hG4bK240f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023555517\"\nP-Charging-Function-Addresses:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nSIP-ETag:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the terminating Inter Operator Identifier (IOI) parameter and removes the orig-ioi and the term-ioi parameters.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the P-CSCF.\n8.\t200 (OK) response (P-CSCF to UE) - see example in table A.4.3.1-6\nP-CSCF#1 forwards the response to the PUA in the UE.\nTable A.4.3.1-8: 200 (OK) response (P-CSCF to UE)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nSIP-ETag:\nContent-Length:\n\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "A.5\tPS notifying watcher of updates to presence information",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.5.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "This subclause covers the signalling flows that show how the PS notifies watchers of updates to presence information.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.5.2\tWatcher and presentity in the different networks, UE in the home network",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "A.5.2.1\tSuccessful notification",
                            "text_content": "Figure A.5.2.1-1 illustrates a notification process in a network, depicting the interaction between a watcher and a visited network. The figure shows the watcher initiating a notification process, which involves several steps such as authentication, message exchange, and acknowledgment. The diagram highlights the role of network protocols and security measures, such as encryption and digital signatures, in ensuring secure communication between the entities. The figure emphasizes the importance of proper network management and communication protocols for efficient and secure data exchange.\nFigure A.5.2.1-1: Notification to watcher in the visited network\nFigure A.5.2.1-1 shows how a watcher is notified of updates to a presentity's presence information. The signalling flow is applicable to the case where the watcher and presentity are in the same or in different IM CN subsystems.\n1.\tNOTIFY request (PS to S-CSCF) – see example in table A.5.2.1-1\nThe PS determines which authorized watchers are entitled to receive the updates of the presence information for this presentity. For each appropriate watcher, the PS sends a NOTIFY request that contains the updated state of presence information. The NOTIFY request may either contain the complete set of presence information, or only the information that has changed since the last notification. In this example, the watcher indicated preference for partial notification in the SUBSCRIBE request, so the NOTIFY request is formulated according to RFC 5263 [24] and RFC 5262 [38] by including only the information that has changed since the last notification. (Note that the first NOTIFY request has contained the full state of the presence information.)\nTable A.5.2.1-1: NOTIFY request (PS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP ps.home2.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=523551024\"; orig-ioi=home2.net\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.home1.net;lr>\nFrom: <sip:user2_public1@home2.net>;tag=151170\nTo: <sip:user1_public1@home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 43 NOTIFY\nSubscription-State: active;expires=5000\nEvent: presence\nContact: <sip:ps.home2.net>\nContent-Type: application/pidf-diff+xml\nContent-Length: (...)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<pidf-diff xmlns=\"urn:ietf:params:xml:ns:pidf-diff\"version=\"1\"\nentity=\"pres:user2_public1@home2.net\">\n\n<add parent=\"presence\" sel=\"*[2]\">\n<![CDATA[\n\n<tuple id=\"xfjsk\">\n<status>\n<basic>open</basic>\n</status>\n<rp:class>voice</rp:class>\n<rp:status-icon>http://example.com/~user2/iconABC.gif</rp:status-icon>\n<contact priority=\"0.2\">tel:40302020@home2.net</contact>\n<note xml:lang=\"en\">This is a new tuple inserted as the 2nd tuple.</note>\n<timestamp>2004-11-01T11:49:29Z</timestamp>\n</tuple>\n]] >\n</add>\n<replace sel=\"presence/tuple[@id=\"a8098a.672364762364\"]/status/basic/text()\">closed\n</replace>\n\n<remove sel=\"presence/dm:person[@id=\"89898\"]/rp:privacy\"/>\n\n<remove sel=\"presence/dm:person[@id=\"89898\"]/rp:activities\"/>\n\n<replace sel=\"presence/tuple[@id=\"a8098a.672364762364\"]/rp:status-icon/text()\">\nhttp://example.com/~user2/iconXYZ.gif</replace>\n\n</pidf-diff>\n\nP-Charging-Vector:\tThe PS populates the icid parameter with a globally unique value and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\n2.\tNOTIFY request (S-CSCF to P-CSCF) - see example in table A.5.2.1-2\nThe S-CSCF forwards the NOTIFY request to the P-CSCF.\nTable A.5.2.1-2: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK764z87.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK240f34.1\nMax-Forwards: 69\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=523551024\"\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:pcscf1.home1.net;lr>\nRecord-Route: <sip:scscf2.home2.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter.\nP-Charging-Function-Addresses:\tThe S-CSCF populates the P-Charging-Function-Addresses header field to be passed to the P-CSCF.\n3.\tNOTIFY request (P-CSCF to UE) - see example in table A.5.2.1-3\nThe P-CSCF forwards the NOTIFY request to the UE.\nTable A.5.2.1-3: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.home1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nMax-Forwards: 68\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.home1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\n4.\t200 (OK) response (UE to P-CSCF) - see example in table A.5.2.1-4\nThe UE acknowledges the NOTIFY request with a 200 (OK) response to the P-CSCF.\nTable A.5.2.1-4: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.home1.net;branch=240f34.1, SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK764z87.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n5.\t200 (OK) response (P-CSCF to S-CSCF) - see example in table A.5.2.1-5\nThe P-CSCF forwards the 200 (OK) response to the S-CSCF.\nTable A.5.2.1-5: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=523551024\"\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n6.\t200 (OK) response (S-CSCF to PS) - see example in table A.5.2.1-6\nThe S-CSCF forwards the 200 (OK) response to the PS.\nTable A.5.2.1-6: 200 (OK) response (S-CSCF to PS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP ps.home2.net;branch=z9hG4bK240f34.1\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=523551024\"; orig-ioi=home1.net:term-ioi=home2.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF inserts the originating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                },
                {
                    "title": "A.5.3\tNotification to resource list in a different network and notification to watcher in the visited network",
                    "description": "",
                    "summary": "",
                    "text_content": "",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": [
                        {
                            "title": "A.5.3.1\tSuccessful notification",
                            "text_content": "Figure A.5.3.1-1 illustrates the process of notifying a resource list in one network and a watcher in another network. The figure depicts the communication flow between the resource list and the watcher, highlighting the exchange of information and the synchronization of resources. The diagram emphasizes the importance of accurate and timely communication between networks for efficient resource management and coordination.\nFigure A.5.3.1-1: Notification to resource list in a different network and\nnotification to watcher in the visited network\nFigure A.5.3.1-1 shows the PS providing presence event notification about a presentity to a RLS in a different network. This notification triggers the RLS to provide presence event notification to the watcher. The details of the signalling flows are as follows:\n1.\tNOTIFY request (PS to S-CSCF) - see example in table A.5.3.1-1\nThe PS determines which authorized watchers are entitled to receive presence information. For each appropriate watcher, the PS sends a NOTIFY request that contains the updated state of presence information. In this example the notification is only sent to the RLS.\nThe NOTIFY request may either contain the complete set of presence information, or only those presence information that have changed since the last notification. In this example, the complete set of presence information is sent.\nTable A.5.3.1-1: NOTIFY request (PS to S-CSCF)\nNOTIFY sip:rls.home1.net SIP/2.0\nVia: SIP/2.0/UDP ps.home2.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=623551024\"; orig-ioi=home12.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:scscf1.home1.net;lr>\nFrom: <sip:user2_public1@home2.net>;tag=151170\nTo: <sip:user1_public1@home1.net>;tag=31415\nCall-ID: gahjt393yhakfh83hfasl98a\nCSeq: 43 NOTIFY\nSubscription-State: active;expires=5000\nEvent: presence\nContact: <sip:ps.home2.net>\nContent-Type: application/pidf+xml\nContent-Length: (...)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<presence xmlns=\"urn:ietf:params:xml:ns:pidf\"\nxmlns:rpid=\"urn:ietf:params:xml:ns:pidf:rpid\"\nxmlns:dm=\"urn:ietf:params:xml:ns:pidf:data-model\"\nxmlns:pcp=\"urn:ietf:params:xml:ns:pidf:caps\"\nxmlns:c=\"urn:ietf:params:xml:ns:pidf:cipid\"\nentity=\"pres:user2_public1@home2.net \">\n\n<tuple id=\"a8098a.672364762364\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:privacy><text/></rpid:privacy>\n<rpid:status-icon>http://example.com/~user2/icon.gif</rpid:status-icon>\n<rpid:class>sip</rpid:class>\n<pcp:servcaps>\n<pcp:video>false</pcp:video>\n<pcp:audio>true</pcp:audio>\n</pcp:servcaps>\n<contact priority=\"0.8>sip:user2_public1@home2.net</contact>\n<note xml:lang=\"en\">Don't Disturb Please!</note>\n<note xml:lang=\"fr\">Ne derangez pas, s'il vous plait</note>\n<timestamp>2003-08-27T17:35:29Z</timestamp>\n</tuple>\n\n<dm:person id=\"438\">\n<rpid:class>presentity</rpid:class>\n<c:homepage>http://example.com/~user2</c:homepage>\n<c:card>http://example.com/~user2/card.vcd</c:card>\n<rpid:activities><rpid:meeting/></rpid:activities>\n<rpid:place-type until=\"2003-08-27T17:30:00Z\"><rpid:office/></rpid:place-type>\n\n</dm:person>\n\n</presence>\n\nP-Charging-Vector:\tThe PS populates the icid parameter with a globally unique value and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe PS populates the P-Charging-Function-Addresses header field to be passed to the S-CSCF.\nThe message body in the NOTIFY request that carries the presence information of the presentity is formed as indicated in RFC 3863 [21], RFC 4480 [26], RFC 5196 [25], RFC 4482 [32], RFC 5263 [24] and RFC 4479 [44].\n2.\tNOTIFY request (S-CSCF to RLS) - see example in table A.5.3.1-2\nThe S-CSCF#1 forwards the NOTIFY request to the RLS.\nTable A.5.3.1-2: NOTIFY request (S-CSCF to RLS)\nNOTIFY sip:rls.home1.net SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bKehuehjgt, SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK764z87.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nMax-Forwards: 69\nP-Charging-Vector:\nP-Charging-Function-Addresses:\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the RLS.\n3.\t200 (OK) response (RLS to S-CSCF) - see example in table A.5.3.1-3\nThe RLS generates a 200 (OK) response to the NOTIFY request.\nTable A.5.3.1-3: 200 (OK) response (RLS to S-CSCF)\nSIP/2.0 200 OK\nVia:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=623551024\"; orig-ioi=home1.net:term-ioi=home1.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\nP-Charging-Vector:\tThe RLS stores the terminating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\n4.\t200 (OK) response (S-CSCF to PS) - see example in table A.5.3.1-4\nThe S-CSCF#1 forwards the 200 (OK) response to the PS.\nTable A.5.3.1-4: 200 (OK) response (S-CSCF to PS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=623551024\"; orig-ioi=home1.net:term-ioi=home1.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the terminating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\n5.\tNOTIFY request (RLS to S-CSCF#1) - see example in table A.5.3.1-5\nThe RLS may decide to wait for other notifications and combine them in a single notification towards the UE or it sends the notification to the UE without any waiting. In this example, the RLS does not wait for other notifications.\nTable A.5.3.1-5: NOTIFY request (RLS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=723551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom: <sip:user1_list1@home1.net>;;tag=151170\nTo: <sip:user1_public1@home1.net>;tag=31415\nCall-ID: gahjt393yhakfh83hfasl98a\nCSeq: 90 NOTIFY\nSubscription-State: active;expires=4500\nRequire: eventlist\nEvent: presence\nContact: <sip:rls.home1.net>\nContent-Type: multipart/related;type=\"application/rlmi+xml\";\nstart=\"<njhhsdhj@rls.home1.net>\";boundary=\"70UBfW7L78hjgfgUPe5z\"\nContent-Length: (...)\n\n--70UBfW7L78hjgfgUPe5z\nContent-Transfer-Encoding: binary\nContent-ID: <njhhsdhj@rls.home1.net>\nContent-Type: application/rlmi+xml;charset=\"UTF-8\"\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<list xmlns=\"urn:ietf:params:xml:ns:rmli\"\nuri=\"sip:user1_list1@home1.net\"\nversion=\"2\"\nfullState=\"false\"\n<resource uri=\"pres:user2_public1@home2.net\">\n<name>Kovacs Janos</name>\n<instance id=\"hqzsuxtfyq\" state=\"active\" cid=\"uhjgfd@rls.home1.net\"/>\n</resource>\n</list>\n\n--70UBfW7L78hjgfgUPe5z\nContent-Transfer-Encoding: binary\nContent-ID: <uhjgfd@rls.home1.net>\nContent-Type: application/pidf+xml;charset=\"UTF-8\"\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<presence xmlns=\"urn:ietf:params:xml:ns:pidf\"\nxmlns:rpid=\"urn:ietf:params:xml:ns:pidf:rpid\"\nxmlns:dm=\"urn:ietf:params:xml:ns:pidf:data-model\"\nxmlns:pcp=\"urn:ietf:params:xml:ns:pidf:caps\"\nxmlns:c=\"urn:ietf:params:xml:ns:pidf:cipid\"\nentity=\"pres:user2_public1@home2.net\">\n\n<tuple id=\"a8098a.672364762364\">\n<status>\n<basic>open</basic>\n</status>\n<rpid:class>sip</rpid:class>\n<rpid:privacy><text/></rpid:privacy>\n<rpid:status-icon>http://example.com/~user2/icon.gif</rpid:status-icon>\n<pcp:servcaps>\n<pcp:video>false</pcp:video>\n<pcp:audio>true</pcp:audio>\n</pcp:servcaps>\n<contact priority=\"0.8>sip:user2_public1@home2.net</contact>\n<note xml:lang=\"en\">Don't Disturb Please!</note>\n<note xml:lang=\"fr\">Ne derangez pas, s'il vous plait</note>\n<timestamp>2003-08-27T17:35:29Z</timestamp>\n</tuple>\n\n<dm:person>\n<rpid:class>presentity</rpid:class>\n<c:homepage>http://example.com/~user2</c:homepage>\n<c:card>http://example.com/~user2/card.vcd</c:card>\n<rpid:activities><rpid:meeting/></rpid:activities>\n<rpid:place-type until=\"2003-08-27T17:30:00Z\"><rpid:office/></rpid:place-type>\n</dm:person>\n\n</presence>\n\n--70UBfW7L78hjgfgUPe5z\n\nP-Charging-Vector:\tThe RLS populates the icid parameter with a globally unique value and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe RLS populates the P-Charging-Function-Addresses header field to be passed to the S-CSCF.\nThe message body in the NOTIFY request that carries the presence information of the presentity is formed as indicated in RFC 3863 [21], RFC 4480 [26], RFC 5196 [25], RFC 4482 [32], RFC 5263 [24] and RFC 4479 [44].\n6.\tNOTIFY request (S-CSCF to P-CSCF) - see example in table A.5.3. 1-6\nThe S-CSCF forwards the NOTIFY request to the P-CSCF.\nTable A.5.3.1-6: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 69\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=723551024\"\nP-Charging-Function-Addresses:\nRoute: <sip:pcscf1.visited1.net;lr>\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nRequire:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the P-CSCF.\n7.\tNOTIFY request (P-CSCF to UE) - see example in table A.5.3.1-7\nThe P-CSCF forwards the NOTIFY request to the UE.\nTable A.5.3.1-7: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 68\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nRequire:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\n8.\t200 (OK) response (UE to P-CSCF) - see example in table A.5.3.1-8\nThe UE acknowledges the NOTIFY request with a 200 (OK) response to the P-CSCF.\nTable A.5.3.1-8: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n9.\t200 (OK) response (P-CSCF to S-CSCF) – see example in table A.5.3.1-9\nThe P-CSCF forwards the 200 (OK) response to the S-CSCF.\nTable A.5.3.1-9: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=723551024\"\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n10.\t200 (OK) response (S-CSCF to RLS) – see example in table A.5.3.1-10\nThe S-CSCF forwards the response to the RLS in the home network of the presentity.\nTable A.5.3.1-10: 200 (OK) response (S-CSCF to RLS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP rls.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=723551024\"; orig-ioi=home1.net:term-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the terminating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the RLS.\n",
                            "figures_meta_data": [],
                            "tables": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "A.6\tPUA subscribing to his own watcher list and receiving notification of new watcher subscriptions",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.6.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "This subclause covers the signalling flows that show how a PUA can subscribe to his own watcher list.\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.6.2\tPUA subscribing to watcher list and receiving a notification of an already pending watcher subscription followed by a notification of a subscription from a new watcher not already in the watcher list",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure A.6.2-1 illustrates the process of a Public Uniform Address (PUA) subscribing to a watcher list and receiving notifications of pending watcher subscriptions and new watcher subscriptions. The figure depicts the interaction between the PUA, watcher list, and the notification process, highlighting the steps involved in managing and monitoring subscriptions in a network. The visual representation emphasizes the importance of real-time communication and coordination in maintaining an efficient and well-organized system.\nFigure A.6.2-1: PUA subscribing to watcher list and receiving a notification\nof an already pending watcher subscription followed by a notification of a subscription\nfrom a new watcher not already in the watcher list\nFigure A.6.2-1 shows a PUA subscribing to the watcher list and receiving a notification of an already pending watcher subscription followed by a notification of a subscription from a new watcher not already in the watcher list. In this example the default watcherinfo subscription filtering policy is applied meaning that a partial state of a watcher-info document is transported in the notifications. The details of the signalling flows as follows:\n1.\tSUBSCRIBE request (UE to P-CSCF) – see example in table A.6.2-1\nThe presentity wishes to watch his own watcher information, therefore he subscribes for the watcher information template-package of presence. The UE generates a SUBSCRIBE request containing the presence.winfo event, together with an indication of the length of time this periodic subscription should last.\nTable A.6.2-1: SUBSCRIBE request (UE to P-CSCF)\nSUBSCRIBE sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nMax-Forwards: 70\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nRoute: <sip:pcscf1.visited1.net:7531;lr;comp=sigcomp>, <sip:orig@scscf1.home1.net;lr>\nP-Preferred-Identity: <sip:user1_public1@home1.net>\nPrivacy: none\nFrom: <sip:user1_public1@home1.net>;tag=31415\nTo: <sip:user1_public1@home1.net>\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 123 SUBSCRIBE\nRequire: sec-agree\nProxy-Require: sec-agree\nSecurity-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432; spi=87654321; port-c=8642; port-s=7531\nEvent: presence.winfo\nExpires: 7200\nAccept: application/watcherinfo+xml\nContact: <sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp>\nContent-Length: 0\n\nRequest URI:\tPublic user identity whose events the subscriber subscribes to. In this case the Public User Identity of the presentity in SIP URI format.\nEvent:\tThis field is populated with the value \"presence.winfo\" to specify the use of the watcher information template-package of presence.\nAccept:\tThis field is populated with the value 'application/watcherinfo+xml' indicating that the UE supports this body type for notification.\nTo:\tSame as the Request-URI.\n2.\tSUBSCRIBE request (P-CSCF to S-CSCF) – see example in table A.6.2-2\nThe P-CSCF looks up the serving network information for the public user identity that was stored during the registration procedure. The SUBSCRIBE request is forwarded to the S-CSCF. A Route header is inserted into SUBSCRIBE request.\nTable A.6.2-2: SUBSCRIBE request (P-CSCF to S-CSCF)\nSUBSCRIBE sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1 ,SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Access-Network-Info:\nMax-Forwards: 69\nP-Asserted-Identity: <sip:user1_public1@home1.net>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"\nPrivacy:\nRoute: <sip:orig@scscf1.home1.net;lr>\nRecord-Route: <sip:pcscf1.visited1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nAccept:\nContact:\nContent-Length:\n\n3.\tEvaluation of initial filter criteria\nThe S-CSCF validates the service profile of this subscriber and evaluates the initial filter criteria. For sip:user1_public1@home1.net the S-CSCF has originating initial Filter Criteria with Service Point Trigger of Method = SUBSCRIBE AND Event = \"presence.winfo\" that informs the S-CSCF to route the SUBSCRIBE request to the AS sip:ps.home1.net.\n4.\tSUBSCRIBE request (S-CSCF to PS) – see example in table A.6.2-4\nThe S-CSCF forwards the SUBSCRIBE request to the PS.\nTable A.6.2-4: SUBSCRIBE request (S-CSCF to PS)\nSUBSCRIBE sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK344a65.1, SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Access-Network-Info:\nMax-Forwards: 68\nP-Asserted-Identity: <sip:user1_public1@home1.net>, <tel:+1-212-555-1111>\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nPrivacy:\nRoute: <sip:ps.home1.net;lr>, <sip:scscf1.home1.net;lr>\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nEvent:\nExpires:\nAccept:\nContact:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF inserts the originating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the PS.\n5.\tAuthorization\nThe PS performs the necessary authorization checks on the originator. In this example, the originator is the owner of the watcher information, so he/she is authorized to see the full watcher information.\nIn other examples (when the originator is not the owner of the watcher information) subscribers are only allowed to monitor the state of their own subscription, which means that they will receive notifications only containing the state of their own subscription. This requires that a terminating initial Filter Criteria with Service Point Trigger of Method = SUBSCRIBE AND Event = \"presence.winfo\" has been defined for the user sip:user1_public1@home1.net.\n6.\t200 (OK) response (PS to S-CSCF) - see example in table A.6.2-6\nThe PS sends the response to the S-CSCF.\nTable A.6.2-6: 200 (OK) response (PS to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK344a65.1, SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"; orig-ioi=home1.net:term-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRecord-Route:\nFrom:\nTo: <sip:user1_public1@home1.net>;tag=151170\nCall-ID:\nCSeq:\nExpires:\nContact: <sip:ps.home1.net>\nContent-Length: 0\n\nP-Charging-Vector:\tThe PS stores the originating Inter Operator Identifier (IOI) parameter and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe PS stores the P-Charging-Function-Addresses header field and passes this header to the S-CSCF.\n7.\t200 (OK) response (S-CSCF to P-CSCF) - see example in table A.6.2-7\nThe S-CSCF forwards the response to the P-CSCF.\nTable A.6.2-7: 200 (OK) response (S-CSCF to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bK120f34.1, SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=023551024\"\nRecord-Route:\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF stores the terminating Inter Operator Identifier (IOI) parameter.\n8.\t200 (OK) response (P-CSCF to UE) - see example in table A.6.2-8\nThe P-CSCF forwards the response to the PUA in the UE.\nTable A.6.2-8: 200 (OK) response (P-CSCF to UE)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKehuefdam\nRecord-Route: <sip:orig@scscf1.home1.net;lr>, <sip:pcscf1.home1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nExpires:\nContact:\nContent-Length:\n\n9.\tNOTIFY request (PS to S-CSCF) - see example in table A.6.2-9\nAfter the PS generated a 200 (OK) response to the SUBSCRIBE request from the UE, it generates a NOTIFY request containing the current state of the watcher information. The watcher information contains one pending subscription.\nTable A.6.2-9 NOTIFY request (PS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=123551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom: <sip:user1_public1@home1.net>;tag=151170\nTo: <sip:user1_public1@home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 89 NOTIFY\nSubscription-State: active;expires=7200\nEvent: presence.winfo\nContact: <sip:ps.home1.net>\nContent-Type: application/watcherinfo+xml\nContent-Length: (...)\n\n<?xml version=\"1.0\"?>\n<watcherinfo xmlns=\"urn:ietf:params:xml:ns:watcherinfo\"\nversion=\"0\" state=\"full\">\n<watcher-list resource=\"sip:user1_public1@home1.net\" package=\"presence\">\n<watcher id=\"77ajsyy76\" event=\"subscribe\"\nstatus=\"pending\">sip:user2_public1@home2.net</watcher>\n</watcher-list>\n</watcherinfo>\n\nP-Charging-Vector:\tThe PS populates the icid parameter with a globally unique value and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe PS populates the P-Charging-Function-Addresses header field to be passed to the S-CSCF.\n10.\tNOTIFY request (S-CSCF to P-CSCF) – see example in table A.6.2-10\nThe S-CSCF forwards the NOTIFY request to the P-CSCF.\nTable A.6.2-10: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 69\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=123551024\"\nP-Charging-Function-Addresses:\nRoute: <sip:pcscf1.visited1.net;lr>\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter received.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the P-CSCF.\n11.\tNOTIFY request (P-CSCF to UE) - see example in table A.6.2-11\nThe P-CSCF forwards the NOTIFY request to the PUA in the UE.\nTable A.6.2-11: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.home1.net:7531;lr;comp=sigcomp>\nMax-Forwards: 68\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\n12.\t200 (OK) response (UE to P-CSCF) – see example in table A.6.2-12\nThe PUA on the UE determines that this is a full state watcher-info document and replaces any current watcher-info with the new document. The UE acknowledges the NOTIFY request with a 200 (OK) response to the P-CSCF.\nTable A.6.2-12: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK764z87.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n13.\t200 (OK) response (P-CSCF to S-CSCF) – see example in table A.6.2-13\nThe P-CSCF forwards the 200 (OK) response to the S-CSCF.\nTable A.6.2-13: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=123551024\"\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n14.\t200 (OK) response (S-CSCF to PS) – see example in table A.6.2-14\nThe P-CSCF forwards the response to the PS in the home network of the UE.\nTable A.6.2-14: 200 (OK) response (S-CSCF to PS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=123551024\"; orig-ioi=home1.net:term-ioi=home1.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF inserts the terminating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\n15.\tAuthorization of watcher\nThe presentity determines to allow the watcher to access the presence information. The PUA modifies the subscription authorization policy by authorizing presence information for sip:user2_public1@home1.net.\n16.\tNOTIFY request (PS to S-CSCF) – see example in table A.6.2-16\nThe authorization event means changes in the watcher information, which triggers a new NOTIFY request. The watcher information included in the NOTIFY request contains only information on the watcher whose state has changed, which in this example is the accepted subscription of sip:user2_public1@home1.net.\nTable A.6.2-16: NOTIFY request (PS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom: <sip:user1_public1@home1.net>;tag=151170\nTo: <sip:user1_public1.home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 90 NOTIFY\nSubscription-State: active;expires=4900\nEvent: presence.winfo\nContact: <sip:ps.home1.net>\nContent-Type: application/watcherinfo+xml\nContent-Length: (...)\n\n<?xml version=\"1.0\"?>\n<watcherinfo xmlns=\"urn:ietf:params:xml:ns:watcherinfo\"\nversion=\"0\" state=\"partial\">\n<watcher-list resource=\"sip:user1_public1@home1.net\" package=\"presence\">\n<watcher id=\"77ajsyy76\" event=\"subscribe\"\nstatus=\"active\">sip:user2_public1@home2.net</watcher>\n</watcher-list>\n</watcherinfo>\n\nP-Charging-Vector:\tThe PS populates the icid parameter with a globally unique value and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe PS populates the P-Charging-Function-Addresses header field to be passed to the S-CSCF.\n17.\tNOTIFY request (S-CSCF to P-CSCF) – see example in table A.6.2-17\nThe S-CSCF forwards the NOTIFY request to the P-CSCF.\nTable A.6.2-17: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 69\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:pcscf1.visited1.net;lr>\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF passes this header received.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the P-CSCF.\n18.\tNOTIFY request (P-CSCF to UE) - see example in table A.6.2-18\nThe P-CSCF forwards the NOTIFY request to the PUA in the UE.\nTable A.6.2-18: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.home1.net:7531;lr;comp=sigcomp>\nMax-Forwards: 68\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContact:\nContent-Type:\nContent-Length:\n\n(…)\n\n19.\t200 (OK) response (UE to P-CSCF) - see example in table A.6.2-19\nThe PUA determines that this is a full state watcher-info document and replaces any current watcher-info with the new document. The UE acknowledges the NOTIFY request with a 200 (OK) response to the P-CSCF.\nTable A.6.2-19: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK764z87.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n20.\t200 (OK) response (P-CSCF to S-CSCF) – see example in table A.6.2-20\nThe P-CSCF forwards the 200 (OK) response to the S-CSCF.\nTable A.6.2-20: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n21.\t200 (OK) response (S-CSCF to PS) – see example in table A.6.2-21\nThe P-CSCF forwards the response to the PS in the home network of the UE.\nTable A.6.2-21: 200 (OK) response (S-CSCF to PS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=223551024\"; orig-ioi=home1.net term-ioi=visited1.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\nP-Charging-Vector:\tThe PS inserts the originating Inter Operator Identifier (IOI) parameter received and.populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\n22.\tPending new watcher subscription\nThe PS receives a SUBSCRIBE request from a new watcher and performs the necessary authorization checks on the originator and determines that this is a new watcher that is not yet in the watcher list.\n23.\tNOTIFY request (PS to S-CSCF) - see example in table A.6.2-23\nThe PS generates a NOTIFY request containing watcher information of the new watcher pending subscription. Thus, the watcher information contains the partial state.\nTable A.6.2-23 NOTIFY request (PS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom: <sip:user1_public1@home1.net>;tag=151170\nTo: <sip:user1_public1.home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 90 NOTIFY\nSubscription-State: active;expires=5000\nEvent: presence.winfo\nContent-Type: application/watcherinfo+xml\nContact: <sip:ps.home1.net;lr>\nContent-Length: (...)\n\n<?xml version=\"1.0\"?>\n<watcherinfo xmlns=\"urn:ietf:params:xml:ns:watcherinfo\"\nversion=\"0\" state=\"partial\">\n<watcher-list resource=\"sip:user1_public1@home1.net\" package=\"presence\">\n<watcher id=\"34bytzx54\" event=\"subscribe\"\nstatus=\"pending\">sip:user3_public1@home3.net</watcher>\n</watcher-list>\n</watcherinfo>\n\nP-Charging-Vector:\tThe PS populates the icid parameter with a globally unique value and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe PS populates the P-Charging-Function-Addresses header field to be passed to the S-CSCF.\n24.\tNOTIFY request (S-CSCF to P-CSCF) - see example in table A.6.2-24\nThe S-CSCF forwards the NOTIFY request to the P-CSCF.\nTable A.6.2-24: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 69\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"\nP-Charging-Function-Addresses:\nRoute: <sip:pcscf1.visited1.net;lr>\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContent-Type:\nContact:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter received.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the P-CSCF.\n25.\tNOTIFY request (P-CSCF to UE) - see example in table A.6.2-25\nThe P-CSCF forwards the NOTIFY request to the PUA in the UE.\nTable A.6.2-25: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nMax-Forwards: 68\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.home1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContent-Type:\nContact:\nContent-Length:\n\n(…)\n\n26.\t200 (OK) response (UE to P-CSCF) - see example in table A.6.2-26\nThe PUA determines that this is a partial state notification of watcher-info and adds the new pending subscription to its existing watcher-info document. The UE acknowledges the NOTIFY request with a 200 (OK) response to the P-CSCF.\nTable A.6.2-26: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK764z87.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n27.\t200 (OK) response (P-CSCF to S-CSCF) - see example in table A.6.2-27\nThe P-CSCF forwards the 200 (OK) response to the S-CSCF.\nTable A.6.2-27: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n28.\t200 (OK) response (S-CSCF to PS) - see example in table A.6.2-28\nThe P-CSCF forwards the response to the PS in the home network of the UE.\nTable A.6.2-28: 200 (OK) response (S-CSCF to PS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=323551024\"; orig-ioi=home1.net; term-ioi=visited1.net\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\nP-Charging-Vector:\tThe S-CSCF insertes the originating Inter Operator Identifier (IOI) parameter received and populates the identifier of its own network to the terminating Inter Operator Identifier (IOI) parameter of this header.\n29.\tAuthorization of watcher\nThe presentity determines to allow the watcher to access the presence information. The PUA modifies the authorization policy by authorizing presence information for sip:user3_public1@home3.net.\n30.\tNOTIFY request (PS to S-CSCF) - see example in table A.6.2-30\nThe authorization event means changes in the watcher information, which triggers a new NOTIFY request. The watcher information included in the NOTIFY request contains the accepted subscription of sip:user3_public1@home3.net.\nTable A.6.2-30 NOTIFY request (PS to S-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 70\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=423551024\"; orig-ioi=home1.net\nP-Charging-Function-Addresses: ccf=[5555::b99:c88:d77:e66]; ccf=[5555::a55:b44:c33:d22]; ecf=[5555::1ff:2ee:3dd:4ee]; ecf=[5555::6aa:7bb:8cc:9dd]\nRoute: <sip:scscf1.home1.net;lr>, <sip:pcscf1.visited1.net;lr>\nFrom: <sip:user1_public1@home1.net>;tag=151170\nTo: <sip:user1_public1.home1.net>;tag=31415\nCall-ID: b89rjhnedlrfjflslj40a222\nCSeq: 90 NOTIFY\nSubscription-State: active;expires=4900\nEvent: presence.winfo\nContent-Type: application/watcherinfo+xml\nContact: <sip:ps.home1.net;lr>\nContent-Length: (...)\n\n<?xml version=\"1.0\"?>\n<watcherinfo xmlns=\"urn:ietf:params:xml:ns:watcherinfo\"\nversion=\"0\" state=\"partial\">\n<watcher-list resource=\"sip:user1_public1@home1.net\" package=\"presence\">\n<watcher id=\"34bytzx54\" event=\"subscribe\"\nstatus=\"active\">sip:user3_public1@home3.net</watcher>\n</watcher-list>\n</watcherinfo>\n\n\nP-Charging-Vector:\tThe PS populates the icid parameter with a globally unique value and populates the identifier of its own network to the originating Inter Operator Identifier (IOI) parameter of this header.\nP-Charging-Function-Addresses:\tThe PS populates the P-Charging-Function-Addresses header field to be passed to the S-CSCF.\n31.\tNOTIFY request (S-CSCF to P-CSCF) – see example in table A.6.2-31\nThe S-CSCF forwards the NOTIFY request to the P-CSCF.\nTable A.6.2-31: NOTIFY request (S-CSCF to P-CSCF)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nMax-Forwards: 69\nP-Charging-Vector: icid-value=\"AyretyU0dm+6O2IrT5tAFrbHLso=423551024\"\nP-Charging-Function-Addresses:\nRoute: <sip:pcscf1.visited1.net;lr>\nRecord-Route: <sip:scscf1.home1.net;lr>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContent-Type:\nContact:\nContent-Length:\n\n(…)\n\nP-Charging-Vector:\tThe S-CSCF stores the originating Inter Operator Identifier (IOI) parameter received.\nP-Charging-Function-Addresses:\tThe S-CSCF stores the P-Charging-Function-Addresses header field and passes this header to the P-CSCF.\n32.\tNOTIFY request (P-CSCF to UE) - see example in table A.6.2-32\nThe P-CSCF forwards the NOTIFY request to the PUA in the UE.\nTable A.6.2-32: NOTIFY request (P-CSCF to UE)\nNOTIFY sip:[5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp SIP/2.0\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK351g45.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nMax-Forwards: 68\nRecord-Route: <sip:scscf1.home1.net;lr>, <sip:pcscf1.home1.net:7531;lr;comp=sigcomp>\nFrom:\nTo:\nCall-ID:\nCSeq:\nSubscription-State:\nEvent:\nContent-Type:\nContact:\nContent-Length:\n\n(…)\n\n33.\t200 (OK) response (UE to P-CSCF) - see example in table A.6.2-33\nThe PUA determines that this is a partial state notification of watcher-info and updates the active subscription to its existing watcher-info document. The UE acknowledges the NOTIFY request with a 200 (OK) response to the P-CSCF.\nTable A.6.2-33: 200 (OK) response (UE to P-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP pcscf1.visited1.net;branch=240f34.1, SIP/2.0/UDP scscf2.home2.net;branch=z9hG4bK764z87.1, SIP/2.0/UDP ps.home2.net;branch=z9hG4bK348923.1\nP-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length: 0\n\n34.\t200 (OK) response (P-CSCF to S-CSCF) - see example in table A.6.2-34\nThe P-CSCF forwards the 200 (OK) response to the S-CSCF.\nTable A.6.2-34: 200 (OK) response (P-CSCF to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1, SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n35.\t200 (OK) response (S-CSCF to PS) - see example in table A.6.2-35\nThe P-CSCF forwards the response to the PS in the home network of the UE.\nTable A.6.2-35: 200 (OK) response (S-CSCF to PS)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP ps.home1.net;branch=z9hG4bK240f34.1\nP-Access-Network-Info:\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Length:\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        },
        {
            "title": "A.7\tPNA subscription for the reg-event package",
            "description": "Figure A.7-1 shows the registration signalling flow for the scenario when the user is not registered. For the purpose of this registration signalling flow, the subscriber is considered to be roaming. This signalling flow also shows the authentication of the private user identity.\nThis is followed by the subscription procedure for the reg-event package, whereby the PNA requests to be notified by the S-CSCF when a registration event has occurred. This is done using the 'reg-event' package as described in 3GPP TS 24.229 [9].\nFigure A.7-1 illustrates the registration signalling process when a user is not registered, depicting the exchange of messages between the network elements involved in the process. The figure shows the initial state where the user is not registered, and the subsequent steps leading to successful registration. Key network elements such as the home agent (HA), home location register (HLR), and authentication center (AUC) are depicted, along with the signalling messages exchanged during the registration process. The figure highlights the importance of accurate and timely communication between these elements to ensure a seamless registration experience for the user.\nFigure A.7-1: Registration signalling: user not registered\n1-22.\tSee 3GPP TS 24.228 [8], subclause 6.2 steps 1 through 22\n23.\tInitial filter criteria\nThe S-CSCF analyses the incoming request against the initial filter criteria and decides to send a third-party REGISTER request to the PNA.\n24.\tREGISTER request (S-CSCF to PNA) - see example in table A.7-24\nThis signalling flow forwards the REGISTER request from the S-CSCF to the PNA.\nTable A.7-24: REGISTER request (S-CSCF to PNA)\nREGISTER sip:ps.home1.net SIP/2.0\nVia: SIP/2.0/UDP sip:scscf1.home1.net\nMax-Forwards: 70\nP-Access-Network-Info:\nP-Visited-Network-ID:\nP-Charging-Vector:\nP-Charging-Function-Addresses:\nFrom: sip:scscf1.home1.net\nTo: <sip:user1_public1@home1.net>\nContact: <sip:scscf1.home1.net>\nExpires: 600000\nCall-ID: apb03a0s09dkjdfglkj49112\nCSeq: 43 REGISTER\nContent-Length: 0\n\n25.\t200 OK response (PNA to S-CSCF) - see example in table A.7-25\nThe PNA sends a 200 (OK) response to the S-CSCF indicating that Registration was successful.\nTable A.7-25: 200 OK response (PNA to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP sip:scscf1.home1.net\nFrom:\nTo:\nCall-ID:\nContact: <sip:scscf1.home1.net>;expires=600000\nCSeq:\nDate: Wed, 11 July 2001 08:49:37 GMT\nContent-Length:\n\n26.\tSUBSCRIBE request (PNA to S-CSCF) - see example in table A.7-26\nThe PNA sends the SUBSCRIBE request for the reg event package.\nTable A.7-26: SUBSCRIBE request (PNA to S-CSCF)\nSUBSCRIBE sip:user1_public1@home1.net SIP/2.0\nVia: SIP/2.0/UDP sip:ps.home1.net\nMax-Forwards: 70\nP-Asserted-Identity: <sip:ps.home1.net>\nPrivacy: none\nFrom: <sip:ps.home1.net>;tag=31415\nTo: <sip:user1_public1@home1.net>\nCall-ID: dre36d2v32gnlgiiomm72445\nCSeq: 61 SUBSCRIBE\nEvent: reg\nExpires: 600000\nAccept: application/reginfo+xml\nContact: <sip:ps.home1.net>\nContent-Length: 0\n\nFrom:\tThis header is populated with the SIP URI that identifies the PNA.\nContact:\tThis is where the NOTIFY requests for this subscription will be sent.\nEvent:\tThis field is set to the value 'reg' to specify the use of the reg event package.\nAccept:\tThis field is set to the value \"application/reginfo+xml\".\n27.\t200 (OK) response (S-CSCF to PNA) - see example in table A.7-27\nThe S-CSCF sends a 200 (OK) response to the PNA indicating that registration was successful.\nTable A.7-27: 200 (OK) response (S-CSCF to PNA)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP sip:ps.home1.net\nP-Asserted-Identity: <sip:scscf1.home1.net>\nPrivacy:\nFrom:\nTo: <sip:user1_public1@home1.net>;tag=151170\nCall-ID:\nCSeq:\nContact: <sip:scscf1.home1.net>\nExpires:\nContent-Length:\n\nExpires:\tIf value of the Expires header in SUBSCRIBE request is different from the one received in REGISTER method, then the value of Expires header in the 200 (OK) response is set to match the value of Expires header in REGISTER method.\n28.\tNOTIFY request (S-CSCF to PNA) - see example in table A.7-28\nThe S-CSCF sends a first NOTIFY request towards the PNA in order to inform the PNA about the registration status of monitored user.\nTable A.7-28: NOTIFY request (S-CSCF to PNA)\nNOTIFY sip:pcscf1.visited1.net SIP/2.0\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1\nMax-Forwards: 70\nFrom: <sip:user1_public1@home1.net>;tag=151170\nTo: <sip:user1_public1@pcscf1.visited1.net>;tag=31415\nCall-ID: dre36d2v32gnlgiiomm72445\nCSeq: 42 NOTIFY\nSubscription-State: active;expires=600000\nEvent: reg\nContent-Type: application/reginfo+xml\nContact: <sip:scscf1.home1.net>\nContent-Length: (...)\n\n<?xml version=\"1.0\"?>\n<reginfo xmlns=\"urn:ietf:params:xml:ns:reginfo\"\nversion=\"1\" state=\"full\">\n<registration aor=\"sip:user1_public1@home1.net\" id=\"a7\" state=\"active\">\n<contact id=\"76\" state=\"active\" event=\"registered\">\n<uri>sip:[5555::aaa:bbb:ccc:ddd]</uri>\n</contact>\n</registration>\n<registration aor=\"sip:user1_public2@home1.net\" id=\"a8\" state=\"active\">\n<contact id=\"77\" state=\"active\" event=\"created\">\n<uri>sip:[5555::aaa:bbb:ccc:ddd]</uri>\n</contact>\n</registration>\n<registration aor=\"tel:+358504821437\" id=\"a9\" state=\"active\">\n<contact id=\"78\" state=\"active\" event=\"created\">\n<uri>sip:[5555::aaa:bbb:ccc:ddd]</uri>\n</contact>\n</registration>\n</reginfo>\n\nFrom:\t\tThe tag of this field matches that of the To; field in the received 200 (OK) response for the SUBSCRIBE request.\nContent-Type:\tSet to the value of the Accept header received in the SUBSCRIBE request or \"application/reginfo+xml\" if the Accept header was not present in the SUBSCRIBE request.\nThe message body in the NOTIFY request that carries the subscriber's registration state is formed as indicated in 3GPP TS 24.229 [9].\n29.\t200 (OK) response (PNA to S-CSCF) - see example in table A.7-29\nPNA sends the 200 (OK) response to the S-CSCF.\nTable A.7-29: 200 (OK) response (PNA to S-CSCF)\nSIP/2.0 200 OK\nVia: SIP/2.0/UDP scscf1.home1.net;branch=z9hG4bK332b23.1\nFrom:\nTo:\nCall-ID:\nCSeq:\nContent-Type:\nContent-Length: 0\n\n",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": []
        },
        {
            "title": "A.8\tExample signalling flows of HTTP based presence service operation",
            "description": "",
            "summary": "",
            "tables": [],
            "figures_meta_data": [],
            "subsections": [
                {
                    "title": "A.8.1\tIntroduction",
                    "description": "",
                    "summary": "",
                    "text_content": "This subclause shows signalling flows relating to the manipulation of presence service data over the Ut reference point using XCAP. The flows only shows the signalling between the XCAP server and the XCAP client, thus possible proxies located in between the entities are not shown in the example signalling flows.\nEach example signalling flow shows several sequences of manipulation of data for the presence service.\nNOTE 1:\tError conditions are not considered in the examples e.g. if authorization checks fail in the XCAP server, XML Schema compliancy checks fail or the file specified by the URI does not exist then an appropriate 4xx response is sent to the client.\nClarifications how XCAP is using HTTP are described in RFC 4825 [33].\nNOTE 2:\tThe authentication proxy resides between UE (XCAP client) and AS (XCAP server), and examples of signalling flows for the authentication proxy are provided in 3GPP TS 24.109 [7].\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.8.2\tSignalling flows demonstrating how XCAP clients manipulate resource lists",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure A.8.2-1 illustrates the interaction between an XCAP client and an XCAP server, where the client is manipulating a resource list on the server. The figure showcases the exchange of messages between the two entities, highlighting the process of resource discovery, request, and response. The visual representation emphasizes the role of the XCAP protocol in managing and organizing resources in a network, ensuring efficient communication and resource allocation.\nFigure A.8.2-1: XCAP client manipulating a resource list on XCAP server\nFigure A.8.2-1 shows a how a XCAP client may manipulate a resource list on a XCAP server. The details of the signalling flows are as follows:\n1.\tXCAP PUT request (XCAP client to XCAP server - see example in table A.8.2-1\nThe XCAP client generates an XCAP PUT request to create a new resource list on the XCAP server. The resource list has one entry.\nTable A.8.2-1: XCAP PUT request (XCAP client to XCAP server)\nPUT http://xcap.home1.net/services/resource-lists/users/user1/pf.xml HTTP/1.1\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 10:13:17 GMT\nContent-Type: application/resource-lists+xml\nContent-Length: (…)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<resource-lists xmlns=\"urn:ietf:params:xml:ns:resource-lists\">\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:schemaLocation=\"urn:ietf:params:xml:ns:resource-lists\">\n<list name=\"Presence_fellows\">\n<entry uri=\"sip:user2_public1@home2.net\">\n<display-name>User2</display-name>\n</entry>\n</list>\n</resource-lists>\n\n2.\tXCAP 201 (Created) response (XCAP server to XCAP client) – see example in table A.8.2-2\nAfter the XCAP server has performed the necessary authorization checks on the originator to ensure the XCAP client is allowed to create a file, the XCAP server sends an XCAP 201 (Created) response to the XCAP client.\nTable A.8.2-2: XCAP 201 (Created) response (XCAP server to XCAP client)\nHTTP/1.1 201 Created\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nEtag: \"aaa\"\nDate: Thu, 08 Jan 2004 10:50:35 GMT\nContent-Length: 0\n\n3.\tXCAP PUT request (XCAP client to XCAP server) – see example in table A.8.2-3\nThe XCAP client adds a new entry to the previously created resource list by generating a new XCAP PUT request.\nTable A.8.2-3: XCAP PUT request (XCAP client to XCAP server)\nPUT http://xcap.home1.net/services/resource-lists/users/user1/pf.xml/~~/resource-lists/list%5b@name=%22Presence_fellows%22%5d/entry HTTP/1.1\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 10:13:17 GMT\nContent-Type: application/xcap-el\nContent-Length: (…)\n\n<entry uri=\"sip:user3_public1@home3.net\">\n<display-name>User3</display-name>\n</entry>\n\n4.\tXCAP 200 (OK) response (XCAP server to XCAP client) - see example in table A.8.2-4\nAfter the XCAP server has performed the necessary authorization checks, XML document validations and XML schema compliancy checks the XCAP server sends an XCAP 200 (OK) response to the XCAP client.\nTable A.8.2-4: XCAP 200 (OK) response (XCAP server to XCAP client)\nHTTP/1.1 200 OK\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nEtag: \"aab\"\nDate: Thu, 08 Jan 2004 10:50:45 GMT\nContent-Length: 0\n\n5.\tXCAP DELETE request (XCAP client to XCAP server) - see example in table A.8.2-5\nThe XCAP client decides to delete the entry \"user2\" from the resource list. The XCAP client generates an XCAP DELETE request.\nTable A.8.2-5: XCAP DELETE request (XCAP client to XCAP server)\nDELETE http://xcap.home1.net/services/resource-lists/users/user1/pf.xml/~~/resource-lists/list%5b@name=%22Presence_fellows%22%5d/entry%5b@name=user2\"%5d HTTP/1.1\nHost: oper.example.com:9999\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 10:14:17 GMT\n\n6.\tXCAP 200 (OK) response (XCAP server to XCAP client) – see example in table A.8.2-6\nAfter the XCAP server has performed the necessary authorization checks on the originator to ensure the XCAP client is allowed to delete an entry from the resource list, the XCAP server sends an XCAP 200 (OK) response.\nTable A.8.2-6: XCAP 200 (OK) response (XCAP server to XCAP client)\nHTTP/1.1 200 OK\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nDate: Thu, 08 Jan 2004 11:00:47 GMT\nContent-Length: 0\n\n7.\tXCAP GET request (XCAP client to XCAP server) – see example in table A.8.2-7\nThe XCAP client wishes to check the result of the previous transaction by generating an XCAP GET request.\nTable A.8.2-7: XCAP GET request (XCAP client to XCAP server)\nGET http://xcap.home1.net/services/resource-lists/users/user1/pf.xml HTTP/1.1\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 11:13:17 GMT\nContent-Length: 0\n\n8.\tXCAP 200 (OK) response (XCAP server to XCAP client) - see example in table A.8.2-8\nAfter the XCAP server has performed the necessary authorization checks on the originator to ensure the XCAP client is allowed to fetch the resource list, the XCAP server sends an XCAP 200 (OK) response to the XCAP client including the resource list in the body of the response.\nTable A.8.2-8: XCAP 200 (OK) response (XCAP server to XCAP client)\nHTTP/1.1 200 OK\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nEtag: \"askdajdsaj\"\nDate: Thu, 08 Jan 2004 11:50:35 GMT\nContent-Type:application/resource-lists+xml\nContent-Length: (…)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<resource-lists xmlns=\"urn:ietf:params:xml:ns:resource-lists\">\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:schemaLocation=\"urn:ietf:params:xml:ns:resource-lists\">\n<list name=\"Presence_fellows\">\n<entry uri=\"sip:user3_public1@home3.net\">\n<display-name>User3</display-name>\n</entry>\n</list>\n</resource-lists>\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.8.3\tSignalling flows demonstrating how XCAP clients manipulate presence authorization policy",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure A.8.3-1 illustrates the process of a XCAP client interacting with a XCAP server to modify presence authorization policy. The figure depicts the client's request to the server, which involves the exchange of authentication and authorization data. The server then processes the request, checking the client's identity and permissions before granting or denying access. The figure emphasizes the importance of secure and controlled access to presence data in XCAP-enabled systems.\nFigure A.8.3-1: XCAP client manipulating presence authorization policy on XCAP server\nFigure A.8.3-1 shows a XCAP client manipulating presence authorization policy on a XCAP server. The details of the signalling flows are as follows:\n1.\tXCAP PUT request (XCAP client to XCAP server) – see example in table A.8.3-1\nThe XCAP client generates an XCAP PUT request to create a presence authorization policy on the XCAP server. The presence authorization policy has one rule allowing for sip:user2_public1@home2.net to see all service information along with the service related servcaps elements defined in RFC 5196 [25].\nTable A.8.3-1: XCAP PUT request (XCAP client to XCAP server)\nPUT http://xcap.home1.net/services/pres-rules/users/user1/ps.xml HTTP/1.1\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 10:13:17 GMT\nContent-Type:application/auth-policy+xml\nContent-Length: (…)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<ruleset xmlns=\"urn:ietf:params:xml:ns:common-policy\"\nxmlns:sc=\"urn:ietf:params:xml:ns:pidf:caps\"\nxmlns:pr=\"urn:ietf:params:xml:ns:pres-rules\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:schemaLocation=\"urn:ietf:params:xml:ns:pres-rules\">\n<rule id=\"dsafa43232\">\n<conditions>\n<identity>\n<id entity=\"user2_public1@home2.net\"/>\n</identity>\n</conditions>\n<actions>\n<pr:sub-handling>allow</pr:sub-handling>\n</actions>\n<transformations>\n<pr:provide-services>\n<pr:all-services/>\n</pr:provide-services>\n<pr:provide-persons><pr:all-persons/></pr:provide-persons>\n<pr:provide-unknown-attribute name=\"sc:servcaps\">true</pr:provide-unknown-attribute>\n</transformations>\n\n</rule>\n</ruleset>\n\n2.\tXCAP 201 (Created) response (XCAP server to XCAP client) - see example in table A.8.3-2\nAfter the XCAP server has performed the necessary authorization checks on the originator to ensure the XCAP client is allowed to create a file, the XCAP server sends an XCAP 201 (Created) response to the XCAP client.\nTable A.8.3-2: XCAP 201 (Created) response (XCAP server to XCAP client)\nHTTP/1.1 201 Created\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nEtag: \"bbb\"\nDate: Thu, 08 Jan 2004 10:50:35 GMT\nContent-Length: 0\n\n3.\tXCAP PUT request (XCAP client to XCAP server) – see example in table A.8.3-3\nThe XCAP client adds a new rule to the previously created presence authorization policy by generating a new XCAP request. The new rule blocks the user named sip:user3_public1@home3.net to see presence information.\nTable A.8.3-3: XCAP PUT request (XCAP client to XCAP server)\nPUT http://xcap.home1.net/services/pres-rules/users/user1/ps.xml/~~/permission-statements/ruleset/rule%5b2%5d HTTP/1.1\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 10:13:27 GMT\nContent-Type: application/xcap-el\nContent-Length: (…)\n\n<rule id=\"fdsjkf\">\n<conditions>\n<identity>\n<id entity=\"user3_public1@home2.net\"/>\n</identity>\n<conditions>\n<actions>\n<pr:sub-handling>block</pr:sub-handling>\n</actions>\n\n4.\tXCAP 200 (OK) response (XCAP server to XCAP client) - see example in table A.8.3-4\nAfter the XCAP server has performed the necessary authorization checks, XML document validations and XML schema compliancy checks the XCAP server sends an XCAP 200 (OK) response to the XCAP client.\nTable A.8.3-4: XCAP 200 (OK) response (XCAP server to XCAP client)\nHTTP/1.1 200 OK\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nEtag: \"bbb2\"\nDate: Thu, 08 Jan 2004 10:50:45 GMT\nContent-Length: 0\n\n5.\tXCAP DELETE request (XCAP client to XCAP server) - see example in table A.8.3-5\nThe XCAP client decides to delete the rule for sip:user2_public1@home2.net from the authorization policy. The XCAP client generates an XCAP DELETE request.\nTable A.8.3-5: XCAP DELETE request (XCAP client to XCAP server)\nDELETE http://xcap.home1.net/services/pres-rules/users/user1/ps.xml/~~/ruleset/rule/statement[@id=\"dsafa43232\"] HTTP/1.1\nHost: oper.example.com:9999\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 10:14:17 GMT\n\n6.\tXCAP 200 (OK) response (XCAP server to XCAP client) – see example in table A.8.3-6\nAfter the XCAP server has performed the necessary authorization checks on the originator to ensure the XCAP client is allowed to delete an entry from the resource list, the XCAP server sends an XCAP 200 (OK) response.\nTable A.8.3-6: XCAP 200 (OK) response (XCAP server to XCAP client)\nHTTP/1.1 200 OK\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nDate: Thu, 08 Jan 2004 11:00:47 GMT\nContent-Length: 0\n\n7.\tXCAP GET request (XCAP client to XCAP server) – see example in table A.8.3-7\nThe XCAP client wishes to check the result of the previous transaction by generating an XCAP GET request.\nTable A.8.3-7: XCAP GET request (XCAP client to XCAP server)\nGET http://xcap.home1.net/services/pres-rules/users/user1/ps.xml HTTP/1.1\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 11:13:17 GMT\nContent-Length: 0\n\n8.\tXCAP 200 (OK) response (XCAP server to XCAP client) – see example in table A.8.3-8\nAfter the XCAP server has performed the necessary authorization checks on the originator to ensure the XCAP client is allowed to fetch the resource list, the XCAP server sends an XCAP 200 (OK) response to the XCAP client including the authorization rules in the body of the response.\nTable A.8.3-8: XCAP 200 (OK) response (XCAP server to XCAP client)\nHTTP/1.1 200 OK\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nEtag: \"eiuuekksks\"\nDate: Thu, 08 Jan 2004 11:50:35 GMT\nContent-Type:application/auth-policy+xml\nContent-Length: (…)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<ruleset xmlns=\"urn:ietf:params:xml:ns:common-policy\"\nxmlns:sc=\"urn:ietf:params:xml:ns:pidf:caps\"\nxmlns:pr=\"urn:ietf:params:xml:ns:pres-rules\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:schemaLocation=\"urn:ietf:params:xml:ns:pres-rules\">\n<rule id=\"fdsjkf\">\n<conditions>\n<identity>\n<id entity=\"user3_public1@home2.net\"/>\n</identity>\n<conditions>\n<actions>\n<pr:sub-handling>block</pr:sub-handling>\n</actions>\n</ruleset>\n\n",
                    "tables": [],
                    "figures_meta_data": [],
                    "subsubsections": []
                },
                {
                    "title": "A.8.4\tStoring external content (successful operation)",
                    "description": "",
                    "summary": "",
                    "text_content": "Figure A.8.4.-1 illustrates the process of a XCAP (XMPP Core API for Publishers and Subscribers) client interacting with a XCAP server to modify a hard-state presence document. The figure showcases the client's ability to update its presence information, which is crucial for real-time communication in XMPP networks. The diagram highlights the exchange of XML-based messages between the client and server, emphasizing the synchronization of presence data. This process is essential for maintaining accurate and up-to-date contact details among XMPP users.\nFigure A.8.4.-1: XCAP client manipulating hard-state presence document on XCAP server\nFigure A.8.4-1 shows a XCAP client manipulating hard-state presence document on a XCAP server when the presence document has an aggregated storing MIME object with the \"application/pidf+xml\" content type and any of its extensions. The details of the signalling flows are as follows:\n1.\tHTTP PUT request (XCAP client to XCAP server) – see example in table A.8.2-1\nIn order to store the content, the XCAP client generates an HTTP PUT request containing the MIME object in the body of the request. The request-URI points to the directory where the content is stored and shows the name of the file to be created.\nTable A.8.4-1: HTTP PUT request (XCAP client to XCAP server)\nPUT http://operator.example.com/services/users/bill/pictureX HTTP/1.1\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 10:13:17 GMT\nContent-Type: image/jpeg\nContent-Length: (…)\n\n{pictureX.jpg}\n\n2.\tHTTP 201 (Created) response (XCAP server to XCAP client) – see example in table A.8.4-2\nAfter the XCAP server has performed the necessary authorization checks on the originator to ensure the XCAP client is allowed to create a file the HTTP server sends an HTTP 201 (Created) response to the client.\nTable A.8.4-2: HTTP 201 (Created) response (XCAP server to XCAP client)\nHTTP/1.1 201 Created\nServer: Apache/1.3.22 (Unix) mod_perl/1.27Content-Type: text/html\nDate: Thu, 08 Jan 2004 10:50:35 GMT\nContent-Length: 0\n\n3.\tXCAP PUT request (XCAP client to XCAP server) - see example in table A.8.2-3\nThe XCAP client generates an XCAP PUT request in order to store XML encoded presence document which includes a URI reference to the MIME object stored on the XCAP server. The AUID part of the request URI is 'pidf-manipulation' as defined in RFC 4827 [34].\nTable A.8.4-3: XCAP PUT request (XCAP client to XCAP server)\nPUT http://xcap.example.com/services/pidf-manipulation/users/bill/pidf.xml HTTP/1.1\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 10:13:27 GMT\nContent-Type: application/pidf+xml\nContent-Length: (…)\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<presence xmlns=\"urn:ietf:params:xml:ns:pidf\"\nxmlns:rp=\"urn:ietf:params:xml:ns:pidf:rpid\"\nxmlns:ext=\"urn:ietf:params:xml:ns:ext-cont\"\nxmlns:p=\"urn:ietf.params:xml:ns:pidf:data-model\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:schemaLocation=\"urn:ietf:params:xml:ns:resource-lists\"\nentity=\"sip:bill@example.com\">\n\n<tuple id=\"123sd\">\n<status>\n<basic>open</basic>\n</status>\n<contact>sip:bill@example.com</contact>\n</tuple>\n\n<p:person>\n<rp:activities><rp:vacation/></rp:activities>\n<ext:photo>\nhttp://operator.example.com/services/users/bill/pictureX.jpg\n</ext:photo>\n</p:person>\n</presence>\n\n4.\tXCAP 201 (Created) response (XCAP server to XCAP client) - see example in table A.8.4-4\nAfter the XCAP server has performed the necessary authorization checks, XML document validations and XML schema compliancy checks the XCAP server sends an XCAP 201 (Created) response to the XCAP client.\nTable A.8.4-4: XCAP 201 (Created) response (XCAP server to XCAP client)\nHTTP/1.1 201 Created\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nEtag: \"ccc1\"\nDate: Thu, 08 Jan 2004 10:50:45 GMT\nContent-Length: 0\n\n5.\tHTTP GET request (XCAP client to XCAP server) – see example in table A.8.4-5\nThe XCAP client wishes to fetch the MIME object from the XCAP server. The client generates an HTTP GET request. The request URI points to the directory where the object is stored and indicates the name of the file to be fetched.\nTable A.8.4-5: HTTP GET request (XCAP client to XCAP server)\nGET http://operator.example.com/services/users/bill/pictureX HTTP/1.1\nHost: oper.example.com:9999\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 10:43:17 GMT\nAccept: image/jpeg\nContent-Length: 0\n\n6.\tHTTP 200 (OK) response (XCAP server to XCAP client) – see example in table A.8.4-6\nAfter the XCAP server has performed the necessary authorization checks on the originator to ensure the XCAP client is allowed to fetch the file the XCAP server sends an HTTP 200 (OK) response having the object in the body to the XCAP client.\nTable A.8.4-6: HTTP 200 (OK) response (XCAP server to XCAP client)\nHTTP/1.1 200 OK\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nDate: Thu, 08 Jan 2004 11:00:47 GMT\nContent-Type: image/jpeg\nContent-Length: (…)\n\n{pictureX}\n\n7.\tHTTP PUT request (XCAP client to XCAP server) – see example in table A.8.4-7\nThe XCAP client wishes to modify the earlier stored MIME object by replacing the picture X with a new picture X with new content. To modify the object the XCAP client generates an HTTP PUT request using the same request URI as has been used for the modified (old) object. The new object is conveyed in the body of the request.\nTable A.8.4-7: HTTP PUT request (XCAP client to XCAP server)\nPUT http://operator.example.com/services/users/bill/pictureX HTTP/1.1\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 11:13:17 GMT\nContent-Type: image/jpeg\nContent-Length: (…)\n\n{pictureX.jpg}\n\n8.\tHTTP 200 (OK) response (XCAP server to XCAP client) – see example in table A.8.4-8\nAfter the XCAP server has performed the necessary authorization checks on the originator to ensure the XCAP client is allowed to replace the existing MIME object with the new one the XCAP server sends an HTTP 200 (OK) response to the XCAP client.\nTable A.8.4-8: HTTP 200 (OK) response (XCAP server to XCAP client)\nHTTP/1.1 200 OK\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nDate: Thu, 08 Jan 2004 11:50:35 GMT\nContent-Length: 0\n\n9.\tXCAP PUT request (XCAP client to XCAP server) – see example in table A.8.4-9\nThe XCAP client wishes to remove the MIME object from his presence information. The XCAP client generates an XCAP PUT request to modify the XML encoded presence document to remove the reference to the MIME object from the presence document. The request URI contains a node selector to the requested tuple according to RFC 4825 [33].\nTable A.8.4-9: XCAP PUT request (XCAP client to XCAP server)\nPUT http://xcap.example.com/services/pidf-manipulation/users/bill/pidf.xml/~~/presence/person HTTP/1.1\nDate: Thu, 08 Jan 2004 11:13:37 GMT\nIf-Match: \"ccc1\"\nContent-Type: application/xcap-el\nContent-Length: (…)\n\n<p:person>\n\n<rp:activities><rp:vacation/></rp:activities>\n\n</ p:person>\n\n10.\tXCAP 200 (OK) response (XCAP server to XCAP client) - see example in table A.8.4-10\nAfter the XCAP server has performed the necessary authorization checks, XML document validations and XML Schema compliancy checks the XCAP server sends an XCAP 200 (OK) response to the XCAP client.\nTable A.8.4-10: XCAP 200 (OK) response (XCAP server to XCAP client)\nHTTP/1.1 200 OK\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nEtag: \"ccc2\"\nDate: Thu, 08 Jan 2004 11:50:59 GMT\nContent-Length: 0\n\n11.\tHTTP DELETE request (XCAP client to XCAP server) – see example in table A.8.4-11\nThe XCAP client removes the MIME object from the XCAP server by generating an HTTP DELETE request.\nTable A.8.4-11: HTTP DELETE request (XCAP client to XCAP server)\nDELETE http://operator.example.com/services/users/bill/pictureX HTTP/1.1\nHost: oper.example.com:9999\nUser-Agent: IMS subscriber\nDate: Thu, 08 Jan 2004 11:52:00 GMT\n\n12.\tHTTP 200 (OK) response (XCAP server to XCAP client) – see example in table A.8.4-12\nAfter the XCAP server has performed the necessary authorization checks on the originator to ensure that the XCAP client is allowed to delete the object, the XCAP server sends an HTTP 200 (OK) response to the XCAP client.\nTable A.8.4-12: HTTP 200 (OK) response (XCAP server to XCAP client)\nHTTP/1.1 200 OK\nServer: Apache/1.3.22 (Unix) mod_perl/1.27\nDate: Thu, 08 Jan 2004 11:52:35 GMT\nContent-Length: 0\n\n\n\n",
                    "tables": [
                        {
                            "description": "",
                            "table number": 9,
                            "summary": "",
                            "name": ""
                        },
                        {
                            "description": "",
                            "table number": 10,
                            "summary": "",
                            "name": ""
                        }
                    ],
                    "figures_meta_data": [],
                    "subsubsections": []
                }
            ]
        }
    ]
}